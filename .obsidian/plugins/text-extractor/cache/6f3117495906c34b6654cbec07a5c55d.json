{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Kimball Martin/Modular Forms/modular forms_files/MF Notes.pdf","text":"Modular Forms Spring 2011 Notes Kimball Martin April 9, 2014 Preface These notes are from a graduate course on modular forms I gave in Spring 2011 at the University of Oklahoma. I have tried to give an introduction to modular forms with a view towards classical applications, such as quadratic forms and functions on Riemann surfaces, as opposed to “modern applications” (in the sense of requiring a more modern perspective) such as Fermat’s last theorem and the congruent number problem. At the same time, I have tried to give a suitable introduction to lead into a one-semester course on automorphic forms and representations (in Fall 2011), which meant a diﬀerence balance of material than in a course wholly focusing on classical modular forms. I also tried to keep the prerequisites as minimal as possible while (attempting to) meet both of these goals. A warning and an apology are in order. The warning: several of the sections were written in a rush, and may have some (hopefully not serious) errors. Please email me if you ﬁnd any mistakes, so I can correct them. The apology: due to weather and travel, we missed many lectures, and as a result there are many things missing that I would have liked to include, such as Siegel modular forms and the structure of modular functions. Further, there are many details that I would like to have included which I had not the time for. In addition, I realize now I could have done a better job ﬁlling in some prerequisite material. Upon teaching this course again, or possibly earlier if I am inspired, I plan to revise these notes. If you have any comments or suggestions, I would be happy to hear them. I would like to thank my students, for asking many questions and pointing out many mistakes in early versions of these notes, in particular: Kumar Balasubramanian, Jeﬀ Breeding, James Broda, Shayna Grove, Catherine Hall, Daniel McLaury and Salam Turki. I am also grateful to Victor Manuel Aricheta for pointing out a mistake. 1 Contents 1 Introduction 3 2 Elliptic functions 7 2.1 Complex analysis review: Holomorphy . . . . . . . . . . . . . . . . . . . . . . . . . . 7 2.2 Complex analysis review II: Zeroes and poles . . . . . . . . . . . . . . . . . . . . . . 10 2.3 Periodic functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12 2.4 Doubly periodic functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15 2.5 Elliptic functions to elliptic curves . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18 3 The Poincaré upper half-plane 21 3.1 The hyperbolic plane . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21 3.2 Fractional linear transformations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23 3.3 The modular group . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25 3.4 Congruence subgroups . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29 3.5 Cusps and elliptic points . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33 4 Modular Forms 38 4.1 Modular curves and functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38 4.2 Eisenstein series . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43 4.3 Modular forms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53 4.4 Theta series . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58 4.5 η and ∆ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63 5 Dimensions of spaces of modular forms 70 5.1 Dimensions for full level . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70 5.2 Finite dimensionality for congruence subgroups . . . . . . . . . . . . . . . . . . . . . 78 6 Hecke operators 83 6.1 Hecke operators for Γ0(N ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83 6.2 Petersson inner product . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93 7 L-functions 99 7.1 Degree 1 L-functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99 7.1.1 The Riemann zeta function . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99 7.1.2 Dirichlet L-functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101 7.2 The philosophy of L-functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102 7.3 L-functions for modular forms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104 2 1 Introduction There are many starting points for the theory of modular forms. They are a fundamental topic lying at the intersection of number theory, harmonic analysis and Riemann surface theory. Even from a number theory point of view, there are several ways to motivate the theory of modular forms. One is via the connection with elliptic curves, made famous through Wiles’ solution to Fermat’s Last Theorem. This connection has many amazing implications in number theory, but we will emphasize the role of modular forms in the theory of quadratic forms. Let Q be a quadratic form of rank k over Z. This means Q is a homogeneous polynomial of degree 2 over Z in k variables with a certain nondegeneracy condition. For example, Q might be a diagonal form Q(x1, . . . , xk) = a1x2 1 + a2x2 2 + · · · + akx2 k (1.1) where each ai ̸= 0; or it may be something like Q(x, y) = x2+2xy+3y2. Regardless, the fundamental question about Q is Question 1.1. What numbers does Q represent? In other words, for which n does Q(x1, . . . , xk) = n have a solution in Z? There is a more quantitative version of this question as follows. Question 1.2. Let rQ(n) denote the number of solutions (in Z) to Q(x1, . . . , xk) = n. Determine rQ(n). Note that an answer to Question 1.2 provides an answer to Question 1.1, since Question 1.1 is simply asking, when is rQ(n) > 0? (Sometimes rQ(n) is inﬁnite, and instead one counts solutions up to some equivalence, but we will not go into this here.) Let us consider the speciﬁc examples of forms Qk(x1, . . . , xk) = x2 1 + x2 2 + · · · + x2 k, and write rQk (n) simply as rk(n). So Question 1.1 is simply the classical question, what numbers are sums of k squares? Lagrange proved that every positive integer can be written as a sum of four squares (and therefore ≥ 4 squares by just taking xi = 0 for i > 4). The cases of sums of two squares and sums of three squares were answered by Fermat and Gauss. So a complete answer to Question 1.1 for the forms Qk has been known since the time of Gauss (who did fundamental work on quadratic forms), but the answer for k > 4 is not so interesting, as it is trivially encoded in the answer for k = 4. Hence at least for these forms, we see the question of determining rk(n) is much more interesting. Furthermore, for more general quadratic forms Q, Question 1.1 is typically much more diﬃcult, and a method for answering Question 1.2 will provide us a way to answer Question 1.1. Now let us brieﬂy explain how one might try to ﬁnd a formula for rk(n). Jacobi considered the theta function ϑ(z) = ∞∑ n=−∞ qn2, q = e2πiz. (1.2) 3 This function is well deﬁned for z ∈ H = {x + iy : x, y ∈ R, y > 0}. Then ϑ2(z) = ( ∞∑ ℓ=−∞ qℓ2) ( ∞∑ m=−∞ qm2) = ∑ ℓ,m qℓ2+m2 = ∑ n≥0 r2(n)qn. Similarly, ϑk(z) = ∑ n≥0 rk(n)qn. (1.3) (More generally, if Q is the diagonal form in (1.1), then we formally have ∏k i=1 ϑ(aiz) = ∑ rQ(n)qn.) It is not too diﬃcult to see that ϑk satisﬁes the identities ϑ(z + 1) = ϑ(z), ϑ ( −1 4z ) = ( 2z i ) k 2 ϑ(z). (1.4) Indeed, the ﬁrst identity is obvious because q is invariant under z 7→ z + 1. The space of (holomorphic) functions on H satisfying the transformation properties is (1.4) is deﬁned to be the space of modular forms Mk/2(4) of weight k/2 and level 4. The theory of modular forms will tell us that Mk/2(4) is a ﬁnite-dimensional vector space. For example, when k = 4, M2(4) is a 2-dimensional vector space, and one can ﬁnd a basis in terms of Eisenstein series. Speciﬁcally, consider the Eisenstein series G(z) = − 1 24 + ∞∑ n=1 σ(n)qn, where σ(n) is the divisor function σ(n) = ∑ d|n d. Then a basis of M2(4) is f (z) = G(z) − 2G(2z), g(z) = G(2z) − 2G(4z). Hence ϑ4(z) is a linear combination of f (z) and g(z). How do we determine what combination? Simply compare the ﬁrst two coeﬃcients of qn in af (z) + bg(z) with ϑ4(z), and one sees that ϑ4(z) = 8f (z) + 16g(z). Expanding this out, one sees that ϑ4(z) = ∑ n≥0 r4(n)qn = 1 + 8 ∑ n≥1 σ(n)qn − 32 ∑ n≥1 σ(n)q4n. (1.5) Consequently r4(n) = { 8σ(n) 4 ∤ n 8σ(n) − 32σ(n/4) 4|n. If one wishes, one can write this as a single formula r4(n) = 8 (2 + (−1) n) ∑ d|n,2∤d d. (1.6) In particular, it is obvious that r4(n) > 0 for all n, in other words, we have Lagrange’s theorem that every positive integer is a sum of four (not necessarily nonzero) integer squares. Furthermore, 4 we have a simple formula for the number of representations of n as a sum of four squares, in terms of the divisors of n. In this course, we will develop the theory of modular forms, and use this to derive various formulas of the above type. Along the way, we will give some other applications of modular forms. We will also introduce the theory of L-functions, which are an important tool in the theory of modular forms, and are fundamental in the connection with elliptic curves. Time permitting, we will introduce generalizations of modular forms, such as Siegel modular forms and automorphic forms. As much as possible, we will try to keep the prerequisites to a minimum. Certainly, working knowledge of linear algebra is expected, as well as some familiarity with groups and rings. Familiarity with elementary number theory is helpful but not necessary (modular arithmetic will be used, as well as some standard notation from elementary number theory). We may at times discuss some aspects of basic algebraic number theory, but these discussions should be suﬃciently limited to not greatly aﬀect the ﬂow of the text if ignored. Particularly in the beginning, we will be discussing geometric ideas, as this provides motivation for studying modular forms (why study functions on the upper-half plane H satisfying seeming strange transformation laws as in (1.4)?). Here, familiarity with such things as Riemann surfaces, isometry groups and universal covers will be helpful, but we will develop the needed tools as we go. Some basic notions of point-set topology (open sets, continuity, etc.) will be assumed. Perhaps most helpful will be a solid course on complex analysis (fractional linear transformations, holomorphy, meromorphy, Cauchy’s integral formula, etc.) and familiarity of Fourier analysis. For those lacking (or forgetting) this analysis background, I will recall the necessary facts as we go, but the reader should refer to texts on complex analysis or Fourier analysis for further details and proofs. There are a variety (but not a plethora) of exercises intertwined with the text. Most of them are not too diﬃcult, and I encourage you to think about all of them, whether or not you decide it’s worth your while to work out the details. I have starred certain exercises which I consider particularly important. You may ﬁnd a larger selection of exercises from the references listed below. There are many good references for the basic theory of modular forms. Unfortunately, none of them do exactly what we want, which is why I am writing my own notes. Also unfortunately, the terminology and notation among the various texts is not standarized. On the other hand, they are better at what they do than my notes (and likely with fewer errors), so you are encouraged to refer to them throughout the course. • [Ser73] Serre, J.P. A course in arithmetic. A classic streamlined introduction to modular forms of level 1. Many of the details you need to work out for yourself. • [Kob93] Koblitz, Neal. Introduction to elliptic curves and modular forms. A solid introduction to modular forms of both integral and half-integral weight (or arbitrary level), if slightly dense. The goal is to present them in connection with elliptic curves and show how they are used in Tunnell’s solution, assuming the weak Birch–Swinnerton-Dyer conjecture, of the ancient congruent number problem. • [Kil08] Kilford, L.J.P. Modular forms: a classical and computational introduction. A new book, and it seems like a good introduction to modular forms. Has errata online. The one thing lacking for our course is that it does not cover L-functions. 5 • [Zag08] Zagier, Don. Elliptic modular forms and their applications, in “The 1-2-3 of modular forms.” A beautiful overview of modular forms (primarly level 1) and their applications. Available online. • [Lan95] Lang, Serge. Introduction to modular forms. It’s Serge Lang. Covers some advanced topics. • [Apo90] Apostol, Tom. Modular functions and Dirichlet series in number theory. A nice classical analytic approach to modular forms. • [Mil] Milne, J.S. Modular functions and modular forms. Online course notes. This treatment, somewhat like [DS05] or [CSS97], has a more geometric focus (e.g., modular curves). • [DS05] Diamond, Fred and Shurman, Jerry. A ﬁrst course in modular forms. An excellent book, perhaps requiring more geometric background than others, focusing on the connections of modular forms, elliptic curves, modular curves and Galois representations. Available online. • [Iwa97] Iwaniec, Henryk. Topics in classical automorphic forms. An excellent and fairly ele- mentary analytic approach using classical automorphic forms. Many interesting applications are presented. • [Miy06] Miyake, Toshitsune. Modular forms. A fairly advanced presentation of the theory of modular forms, starting with automorphic forms on adeles. Contains useful material not easily found in many texts. Available online. • [Bum97] Bump, Daniel. Automorphic forms and representations. A thorough (at least as much as possible in 550 pp.) text on automorphic forms and representations on GL(n). The ﬁrst quarter of the book treats classical modular forms. • [Ste07] Stein, William. Modular forms: a computational approach. Perhaps a useful reference for those wanting to do computations with modular forms. • [CSS97] Cornell, Silverman and Stevens (ed.s). Modular forms and Fermat’s last theorem. A nice collection of articles giving an overview of the theory of elliptic curves, modular curves, modular forms and Galois representations, and how they are used to prove Fermat’s last theorem. 6 2 Elliptic functions Before we introduce modular forms, which, as explained in the introduction, are functions on the upper half-plane, or the hyperbolic plane, satisfying certain transformation laws, it may be helpful to get a basic understanding of elliptic functions, which are functions on C satisfying certain simpler transformation laws. That is our goal for this chapter. Elliptic functions are a classical topic in complex analysis, and their theory can be found in several books on the subject, such as [Ahl78], [Lan99], [FB09] (available online) or [Sta09] (available online), as well as many texts on elliptic curves and modular forms (e.g., [Kob93], [Iwa97]). In fact, the complex analysis books [FB09] and [Sta09] discuss modular forms. Since elliptic functions are not a focus for this course, but rather a tool for motivation of the theory of modular forms, we will not strive for rigorous proofs, but merely conceptual understanding. Put another way, this chapter is a sort of summary of the pre-history of modular forms. We will explain later how the theory of elliptic functions is essentially a “Euclidean version” of the theory of modular forms, and in fact modular forms ﬁrst arose from the study of elliptic functions. 2.1 Complex analysis review: Holomorphy First let us review some basic facts from the theory of functions of one complex variable. Let C denote the complex plane. Throughout these notes, z will denote a complex number, and unless stated otherwise, x and y will denote the real and imaginary parts, x = Re(z) and y = Im(z), of z. I.e., z = x + iy where x, y ∈ R. Let f : C → C. As vector spaces, we clearly have C ≃ R2 via the linear isomorphism z 7→ (x, y), hence we may also view f as a function from R2 to R2. In fact, C and R2 are isomorphic as topological spaces, so the notion of continuity is the same whether we regard f as a function on C or R2. The conceptual diﬀerence between functions on C and R2 arises when we study the notion of diﬀerentiablilty, and the diﬀerence arises because one can multiply complex numbers, but not (naturally) elements of R2. Speciﬁcally, look at the condition f ′(z) = lim h→0 f (z + h) − f (z) h . (2.1) If we want to think of f as truly a function of C, this means we should be taking h ∈ C in the above limit. In other words, unlike in the real case where h can only approach 0 from the left or right, here h can approach 0 along any line or path to the origin in C. In particular, (2.1) should be true for h ∈ R and h = ik ∈ iR. Note, restricting to h ∈ R in the limit above amounts to diﬀerentiating with respect to x, and restricting to h ∈ iR amounts to diﬀerentiating with respect to y. We can write f (z) uniquely as f (z) = u(z) + iv(z) where u : C → R and v : C → R, i.e., u = Re(f ) and v = Im(f ). We also write u(z) = u(x, y) and v(z) = v(x, y). Then condition (2.1) 7 taking h ∈ R means f ′(z) = lim h→0 f (x + h + iy) − f (x + iy) h = lim h→0 u(x + h, y) + iv(x + h, y) − u(x, y) − iv(x, y) h = lim h→0 u(x + h, y) − u(x, y) h + i lim h→0 v(x + h, y) − v(x, y) h = ∂u ∂x + i ∂v ∂x . Similarly, taking h = ik ∈ iR in (2.1) means f ′(z) = lim k→0 f (x + i(y + k)) − f (x + iy) ik = lim k→0 u(x, y + k) + iv(x, y + k) − u(x, y) − iv(x, y) ik = lim k→0 u(x, y + k) − u(x, y) ik + i lim k→0 v(x + k, y) − v(x, y) ik = 1 i ( ∂u ∂y + i ∂v ∂y ) = ∂v ∂y − i ∂u ∂y . Comparing the real and imaginary parts of these 2 expressions for f ′(z) gives the Cauchy–Riemann equations ∂u ∂x = ∂v ∂y , ∂v ∂x = − ∂u ∂y . (2.2) Deﬁnition 2.1.1. Let U ⊆ C be an open set. We say f : U → C is (complex) diﬀerentiable, or holomorphic, at z if the limit limh→0 f (z+h)−f (z) h exists (for h ∈ C). In this case, the derivative f ′(z) is deﬁned to be the value of this limit. We say f is holomorphic on U if f is holomorphic at each z ∈ U . If f is holomorphic on all of C, we say f is entire. As we saw above, being holomorphic on an open set U means that the Cauchy–Riemann equa- tions will hold (and the partial derivatives will be continuous). (This is in fact if and only if.) Contrast this to diﬀerentiable functions on R2: if one knows the partial derivatives exist and are continuous on an open set in R2, the function is (real) diﬀerentiable there. The Cauchy–Riemann equations give a much stronger condition for a function to be complex diﬀerentiable. The biggest consequence of the Cauchy–Riemann equations is that if f is holomorphic on U , so is f ′. Hence being diﬀerentiable once means being inﬁnitely diﬀerentiable. This feature makes complex analysis much nicer than real analysis. In particular, any diﬀerentiable function on U has a Taylor series expansion around any z0 ∈ U : f (z) = f (z0) + f (z − z0) + f ′′(z0) 2! (z − z0) 2 + f ′′′(z0) 3! (z − z0) 3 + · · · . Recall that any power series ∑n≥0 an(z − z0)n has a radius of convergence R ∈ [0, ∞] such that the series converges absolutely for |z − z0| < R and diverges for |z − z0| > R. 8 Deﬁnition 2.1.2. Let U be an open set in C and f : U → C. We say f is analytic at z0 ∈ U if, for some R > 0, we can write f (z) = ∑ n≥0 an(z − z0) n, |z − z0| < R. We say f is analytic on U if f is analytic at each z0 ∈ U . Note if we can write f (z) as a power series ∑ n≥0 an(z − z0)n about z0, and this series has radius of convergence R, then f is analytic on the open disc |z − z0| < R. One of the main theorems of complex analysis is Theorem 2.1.3. Let U be an open set of C and f : U → C. The following are equivalent. (i) f is holomorphic on U ; (ii) f is inﬁnitely diﬀerentiable on U ; (iii) f if analytic on U ; and (iv) If u = Re(f ) and v = Im(f ), then the partial derivatives of u and v with respect to x, y exist, are continuous, and satisfy the Cauchy–Riemann equations. From the deﬁnition, it is clear diﬀerentiation over C satisﬁes the usual diﬀerentiation rules of calculus (sum, product, quotient and chain rules; as well as the power rule and derivative formulas for trigonometric and exponential functions). For n ∈ Z, the power functions f (z) = zn are well deﬁned and entire for n ≥ 0, and holomorphic on the punctured plane C − {0} for n < 0. Exercise 2.1.4. Consider f (z) = 1 z . Show f satisﬁes the Cauchy–Riemann equations. Deduce that it is analytic on its domain, but there is no single power series expansion valid for all z ∈ C − {0}. One can deﬁne ez, sin(z) and cos(z) by the usual Maclaurin series expansions e z = ∞∑ n=0 zn n! , sin(z) = ∞∑ n=0 (−1)nz2n+1 (2n + 1)! , and cos(z) = ∞∑ n=0 (−1)nz2n (2n)! . These series have radius of convergence ∞, and hence deﬁne entire functions. On the other hand, the logarithm cannot be extended to an entire function. The best one can do is make it well deﬁned on the complex plane minus a ray from the origin. This involves choosing a “branch cut.” Unless otherwise speciﬁed, we will chose our branch cuts so that the complex logarithm is holomorphic function on C − R≤0 Power functions for non-integral exponents can be deﬁned in terms of the logarithm. Speciﬁcally, one can formally deﬁne za = ea log z. This will be holomorphic when the logarithm is, which will typically be C − R≤0 for us. Some basic facts about analytic functions are recorded in the following. 9 Theorem 2.1.5. Let z0 ∈ C and f be deﬁned on a neighborhood of z0. Suppose f is analytic at z0. Then f is analytic in a neighborhood U of z0. Furthermore, we have the following. (a) If f is nonconstant on U , then f is conformal, i.e., f preserves angles. (b) If f ′(z0) ̸= 0, then f is locally invertible at z0, i.e., there exist a function g which is analytic near f (z0) such that g ◦ f = id near z0. (c) Let S be a subset of U containing an accumulation point. If g : U → C is analytic and f (z) = g(z) for z ∈ S, then f (z) = g(z) for all z ∈ U . The ﬁrst part of the theorem follows from the fact we already remarked after Deﬁnition 2.1.2. Part (a) says that analytic function preserve a lot of geometry. Even though they do not in general preserve distance, this property of preserving angles forces certain rigid behavior of analytic func- tions. For instance, conformality implies that there is no analytic function mapping an open disc to an open square. Another example of this rigid behaviour is Liouville’s function, which we will state later, but geometrically says that no analytic function can map the complex plane to any bounded region. Part (c) also describes a rigidity feature: an analytic function is determined by its values on merely a countable set of points (which contains an accumulation point). 2.2 Complex analysis review II: Zeroes and poles The most basic analytic information about an analytic function is the location of its zeroes and poles. Let’s start oﬀ discussing zeroes, although there’s not much to say at the moment. Deﬁnition 2.2.1. Let f be analytic at z0 such that f (z0) = 0. We say f has a zero of order m at z0 if limz→z0 f (z) (z−z0)m exists and is nonzero, or, equivalently, if the power series expansion of f at z0 has the form f (z) = ∞∑ n=m an(z − z0) n with am ̸= 0. Note that zeroes of a nonconstant analytic function must be isolated, i.e., they form a discrete set. To see this, suppose f is analytic on U , and let S be the set of zeroes of f . If f is nonconstant and S has an accumulation point, then Theorem 2.1.5(c) implies f ≡ 0 on U . In particular, in any bounded region, an nonzero analytic function has a ﬁnite number of zeroes. Deﬁnition 2.2.2. Let U be a neighborhood of z0 and f be a nonconstant analytic function on U − {z0}. We say f has a pole of order m at z0 if 1 f (z) has a zero of order m at z0, or, equivalently, limz→z0(z − z0)mf (z) exists and is nonzero. In this case, we write f (z) = limz→z0 f (z) = ∞. If one wants to be a little more formal about assigning a value of ∞ to f , consider the Riemann sphere ˆC = P1(C) = C ∪ {∞}. (Here the open sets of ˆC are generated by the open sets of C together with the balls about inﬁnity, {z : |z| > ϵ} ∪ {∞}, for ϵ ∈ R≥0. Hence ˆC is topologically a sphere.) Even though there are inﬁnitely many “real directions” to go oﬀ to inﬁnity in C (meaning picturing C as R2), we think of them all leading to the same point, ∞, on ˆC. In fact, one can push this idea further. If f : C → ˆC, one can deﬁne a value for f (∞) and think of f : ˆC → ˆC, and one can talk about analytic maps from the Riemann sphere to itself. We need a term for analytic functions with poles (since functions are not called analytic, or holomorphic, at their poles). 10 Deﬁnition 2.2.3. Let U ⊆ C be an open set and f : U → ˆC. Let S = f −1(∞) ⊆ U be the set of poles of f in U . If S is discrete and f is analytic on U − S, we say f is meromorphic on U . In particular, if f and g are holomorphic functions on U and g ̸≡ 0, then f /g is meromorphic on U . This follows from the fact that f /g is diﬀerentiable outside of the set of zeroes of S, which we remarked above is discrete. Hence all rational functions are meromorphic on C. Speciﬁcally, if f and g are nonzero polynomials, then the number of zeroes (counting multiplicity, i.e., summing up the orders of zeroes) of f /g is deg(f ) and the number of poles (again counting with multiplicity) is deg(g). Just like a holomorphic function has a power series expansion about any point in its domain, a meromorphic function has a Laurent series expansion around any point in its domain. Suppose f : U → ˆC is meromorphic, and let z0 ∈ C. If f (z0) ̸= ∞, then we just have a usual power series expansion f (z) = ∑∞ n=0 an(z − z0)n valid near z0. Suppose instead f has a pole of order m at z0. Then (z − z0)mf (z) is holomorphic near z0, so we have a power series expansion (z − z0) mf (z) = ∞∑ n=0 an(z − z0)n. This implies, in a neighborhood of z0, we have the following Laurent series expansion f (z) = ∞∑ n=−m an+m(z − z0)n = ∞∑ n=−m bn(z − z0) n, where we put bn = an+m for n ≥ −m. (A Laurent series is simply a series of the above form, i.e., a power series where the exponents are allowed to start at a ﬁnite negative number.) Exercise 2.2.4. Write down a Laurent series for z+2 z2(z+1) about z0 = 0. Proposition 2.2.5. Let z0 ∈ C and U be a neighborhood of C. Suppose f : U − {z0} → C is analytic and limz→z0 |z − z0|m|f (z)| = 0 for some m ∈ N. By deﬁning f (z0) = limz→z0 f (z), the extension f : U → ˆC is meromorphic on U . There are two cases in the proof. Either limz→z0 f (z) exists as a ﬁnite complex number or not. In fact if f (z) is bounded as z → z0, one can use Cauchy’s integral formula (which we will recall later) to show the limit exists and the extension of f to U is analytic at z0. In this case we say f has a removable singularity. Otherwise, g(z) = (z − z0)mf (z) has a removable singularity, so by the above g(z) can be extended to be analytic on U . If g ≡ 0, then f ≡ 0, which cannot happen since we have assumed limz→z0 f (z) is not ﬁnite. Hence g(z) has a zero of some ﬁnite order 0 < k < m at z0. Then 1 f (z) = (z−z0)m g(z) has a zero of order m − k at z0, i.e., f (z) has a pole of order m − k at z0, and is by deﬁnition meromorphic. We remark that if the condition limz→z0 |z − z0|m|f (z)| = 0 does not hold for some m in the above proposition, then f (z) has what is called an essential singularity. One example is e1/z at z = 0. While we do not need this, the behavior at essential singularities is so remarkable, we would be remiss not to point it out. For the next two results we assume U is an open neighborhood of z0 and f : U − {z0} → C is analytic. 11 Theorem 2.2.6. (Weierstrass) Suppose f has an essential singularity at z0. Then on any neighborhood V ⊆ U of z0, the values of f come arbitrarily close to any complex number, i.e., {f (z) : z ∈ V − {z0}} is dense in C. This is a rather surprising result, though it is not too diﬃcult to prove. However, one of the most amazing theorems in complex analysis (or even all of mathematics) is that something much stronger is true. Theorem 2.2.7. (Big Picard). Suppose f has an essential singularity at z0. Then on any neighborhood V ⊆ U of z0, the values of f range over all complex number with at most one possible exception, i.e., | ˆC − f (V )| = 0 or 1. For example, since we know e1/z is never 0 for z ∈ C, Big Picard tells us that in every neigh- borhood of 0, e1/z attains every nonzero complex value! (Note the above theorem is called “Big Picard” because Picard has another beautiful theorem in complex analysis named after him, now called Little Picard, which is a consequence of Big Picard. We will recall Little Picard later.) 2.3 Periodic functions Let ω ∈ C − {0} and Ω a region in C, i.e., Ω is a nonempty connected open subset of C. We assume the map T (z) = Tω(z) = z + ω is an isometry of Ω. Since T preserves distance in C, this simply means T (Ω) = Ω. For instance, if ω = 1 (or any nonzero real number), we could take Ω to be a horizontal strip {a < Im(z) < b} for some ﬁxed a, b. This is clearly invariant under T . a b Ω z T (z) (A slightly stranger looking region for Ω could be the region between the curves y = sin(x) and y = 1 + sin(x).) We say f : Ω → C has period ω if f (z +ω) = f (z) for all z ∈ Ω. Note that if Ω is not preserved by the translation T , then there are no functions with period ω on Ω because f (z) and g(z) := f (z + ω) would have diﬀerent domains. Let Λ be the cyclic group of isometries of Ω generated by T , i.e., Λ = { . . . , T −2, T −1, I = T 0, T, T 2, . . . } = {Tkω : k ∈ Z} , i.e., Λ is the group of all translations on Ω by an integer multiple of ω. Any time we have a group of isometries acting on a metric space, we can consider the quotient, in this case X = Ω/Λ. What this means is the following. Deﬁne two points of Ω to be Λ-equivalent 12 if they diﬀer by some element τ ∈ Λ, i.e., z ∼Λ z′ if τ (z) = z′ for some τ ∈ Λ. Since Λ is a group, ∼Λ is an equivalence relation, and we can let [z] denote the Λ-equivalence class of z. Then the quotient space X = Ω/Λ, as a set, is deﬁned to be the set of Λ-equivalence classes {[z] : z ∈ Ω} of point of Ω. This naturally inherits a topology from Ω, the quotient topology. Speciﬁcally, the open sets of X are of the form {[z] : z ∈ U }, where U is an open set of Ω. Graphically, in the above example where ω = 1 and Ω = {a < Im(z) < b}, we can picture X = Ω/Λ as below. a b X ω Here we identify the left and right borders of X. Topologically this is homeomorphic to S1×(a, b). Precisely, we have a “ﬂat” open cylinder of diameter 1 and height b − a. The adjective “ﬂat” here refers to the fact that, while X is topologically a cylinder, its geometry is Euclidean, i.e., it has no curvature. While X is technically not a subset of Ω, let alone a speciﬁc subset of Ω as above, it is often convenient identify X with a subset of Ω (at least as a set—geometrically, we have to identify the left and right borders of the shaded region above to get X). This is done through the notion of a fundamental domain. Deﬁnition 2.3.1. Let Ω ⊂ C be a region and Λ a group of isometries of Ω. We say a closed subset F of Ω with connected interior is a fundamental domain for Λ (or Ω/Λ) if (i) any z ∈ Ω is Λ-equivalent to some point in F; (ii) no two interior points of F are Λ-equivalent; and (iii) the boundary of F is a ﬁnite union of smooth curves in Ω. (Note: diﬀerent authors impose diﬀerent conditions on fundamental domains. For some, the fundamental domain would be the interior of what we called the fundamental domain. Others may have diﬀerent conditions on the shape of the boundary, or require convexity.) So, in our above example, we can take a fundamental domain F to be the shaded region in the previous picture, including the boundary, i.e., F = {z ∈ C : a < Im(z) < b, 0 ≤ Re(z) ≤ 1} = [0, 1] × (a, b). (While this is not closed in C, it is closed in Ω.) One could of course construct a diﬀerent fundamental domain by translating F to the left or right. A slightly diﬀerent fundamental domain F ′ is pictured below. 13 a b F ′ ω Now we can view a function f : Ω → C with period ω as a function of X since the value of f (z) only depends upon the Λ-equivalence class of z. In particular, in our above example, we can identify continuous functions on Ω with period ω with continuous functions on X, i.e., continuous functions on the fundamental domain F = [0, 1] × (a, b) such that f (iy) = f (1 + iy) for y ∈ (a, b). Moving back to the case of a general region Ω invariant under T = Tω, there are two basic approaches to constructing periodic functions on Ω: (1) Clearly the function e2πiz/ω has period ω. Hence we can use this to construct other functions with period ω. (2) We can start with a function f (z), which decreases suﬃciently fast, such as f (z) = 1 z2 , and average f over all elements of Λ, e.g., ̃f (z) = ∑ n∈Z f (z + nω). The condition on the rate of decay of f will guarantee that ∑ f (z + nω) converges, and it is clear that ̃f (z + ω) = f (z). For now, let’s focus on (1). It turns out that we can write all (analytic) periodic functions in terms of e2πiz/ω, but approach (2) will be useful in more complicated situations. By making a change of variable z 7→ z/ω, which transforms the domain Ω to ω−1Ω, we may assume our period ω = 1. For simplicity, let us assume Ω = C, so X = Ω/Λ = C/Z. Thus, for a fundamental domain F for C/Z is F = {z ∈ C : 0 ≤ Re(z) ≤ 1}, and we identify the sides Re(z) = 0 and Re(z) = 1 to get X. In other words, X is a ﬂat cylinder of inﬁnite height, and X is in bijection with the subset F ∗ = {0 ≤ Re(z) < 1} of C. F ∗ 10 14 Consider the image of F ∗ under the map f (z) = e2πiz. Write z ∈ F ∗ as z = x + iy where 0 ≤ x < 1. Then f (z) = e2πiz = e−2πye2πix = re iθ, where we put r = e−2πy and θ = 2πx mod 2π. Viewing f : z 7→ (r, θ), it is clear that the image of F ∗ under f is (0, ∞) × [0, 2π). Further this map is injective. Thinking back in terms of f : F ∗ → C, we see e2πiz is an analytic one-to-one map of F ∗ onto C× = C − {0}. Suppose g : C → ˆC has period 1. Assuming g is continuous, we have a Fourier expansion g(z) = ∞∑ n=−∞ an(y)e 2πinz, where the n-th Fourier coeﬃcient an(y) is given by an(y) = ˆg(n) = ∫ 1 0 g(z)e −2πinzdx, (z = x + iy). A priori, an(y) is a just function of y. However if g is meromorphic, then we have a stronger result. Put ζ = f (z). Then there is a unique meromorphic G : C× → ˆC such that g(z) = G(ζ). It is natural to ask when G extends to a meromorphic function of C. By Theorem 2.2.5, this is if and only if limζ→0 G(ζ)|ζ|m = 0 for some m. Note that ζ = e2πiz → 0 for z ∈ F ∗ if and only if Im(z) → ∞. Hence we may restate the above condition on G(ζ) being meromorphic at 0 as limIm(z)→∞ g(z)|e2πimz| → 0 for some m, i.e., for Im(z) large, there exists m such that |g(z)| < e 2πmy. (2.3) Since ζ → 0 corresponds to Im(z) → ∞, we say g is meromorphic at i∞ if (2.3) is satisﬁed. Assume now that g is also meromorphic at i∞. Then G(ζ) has a Laurent series expansion about 0, g(z) = G(ζ) = ∞∑ n=−m cnζ n = ∞∑ n=−m cne2πinz, where m is the order of the pole of G at 0. (We can take m = 0 if G does not have a pole at 0.) This must agree with the Fourier expansion above, so we have an(y) = cn for all n ≥ −m and an(y) ≡ 0 for n < −m. Hence for meromorphic periodic functions, the Fourier coeﬃcients are constant (independent of y) and all but ﬁnitely many of the negative Fourier coeﬃcients vanish. These facts about the Fourier expansion will be crucial in our study of modular forms. 2.4 Doubly periodic functions Let ω1, ω2 be two complex periods, i.e., two nonzero complex numbers linearly independent over R. Then they generate a lattice Λ = ⟨ω1, ω2⟩ = {aω1 + bω2 : a, b ∈ Z} ⊂ C. We might picture Λ as “parallelogram grid” follows. 15 ω1 ω2 ω1 + ω2 0 While technically the lattice Λ is only the set of vertices of the above parallelogram grid, it is convenient to draw it as above. Deﬁnition 2.4.1. A meromorphic function f : C → ˆC is elliptic (or doubly periodic) with respect to Λ if f (z + ω) = f (z) for all z ∈ C, ω ∈ Λ. The space of all such functions is denoted E(Λ). Note f ∈ E(Λ) if and only if f (z + ω1) = f (z + ω2) = f (z). As with singly periodic functions, we can identify doubly periodic functions with functions on a quotient space C/Λ. Note this quotient space is a (ﬂat) torus. We can take for a fundamental domain F the (closed) parallelogram whose vertices are drawn above. ω1 ω2 ω1 + ω2 0 F Then C/Λ is identiﬁed with the torus obtained by gluing together both opposite pairs of edges of the fundamental parallelogram F. We remark that elliptic functions were originally studied because they contain, as a special case, the inverse functions of the classical elliptic integrals (integrals involving the square root of a cubic or quartic polynomial, which arise in the problem of ﬁnding the arc length of certain elliptical shapes, such as spirals and cycloids). This is also, as you may guess, the root of the modern terminology. 16 We would like to be able to describe the space of meromorphic functions on C/Λ. Earlier, we suggested two methods for constructing periodic functions: (1) write functions in terms of a simple periodic function you know; and (2) average functions over Λ. Since there are no obvious nonconstant doubly periodic functions, here we’ll start with approach (2). In order to get something that converges, we need to average a function that decays suﬃciently fast. A ﬁrst idea might be to try averaging 1 z2 over the lattice Λ = ⟨1, i⟩. This would be ∑ ω∈Λ 1 (z + ω)2 = ∑ a,b∈Z 1 (z + (a + bi)2) . (2.4) If this converges, it would have a pole of order 2 at each lattice point, and nowhere else. However, it does not converge (absolutely). To see this, take z = 0, and sum up the absolute values of all terms excluding the 1 z2 term to get ∑ (a,b)∈Z2−{(0,0)} 1 |a + bi|2 = ∑ a,b 1 a2 + b2 ≈ 4 ∫ ∞ 1 ∫ ∞ 1 dx dy x2 + y2 ≈ ∫ 2π 0 ∫ ∞ 1 r dr dθ r2 = ∞. (Here of course the approximations are certainly good enough to formally check divergence of the right most integral implies divergence of the sum on the left.) Since (2.4) does not converge absolutely, the next simplest idea would be to consider g(z) = ∑ ω∈Λ 1 (z + ω)3 . Indeed this sum converges absolutely, except of course when z ∈ Λ, in which case we get a pole of order 3. However, it turns out that one can modify the sum in (2.4) to get an elliptic function with only poles of order 2 at each lattice point. Precisely, we deﬁne Weierstrass pe function (with respect to Λ) to be ℘(z) = 1 z2 + ∑ ω∈Λ−{0} ( 1 (z + ω)2 − 1 ω2 ) . This can be shown to converge and although not as obvious as (2.4), to be doubly periodic (see exercises below). Given this, it is clear this has a pole of order 2 at each z ∈ Λ and no poles elsewhere, so ℘ is an elliptic function of order 2. (The order of an elliptic function is the sum of the orders of its poles in C/Λ.) Since ℘ is analytic on C − Λ, it is diﬀerentiable, and on checks that its derivative is ℘ ′(z) = −2g(z) = −2 ∑ ω∈Λ 1 (z + ω)3 , (2.5) which has order 3. Exercise 2.4.2. Show ℘(z) converges absolutely for z ̸∈ Λ and uniformly on compact sets in C − Λ. Exercise 2.4.3. Verify Equation (2.5). Exercise 2.4.4. Use the previous exercise together with the fact that ℘ is even to show ℘ is elliptic with respect to Λ. 17 Now one might ask: are there any (nonconstant) elliptic functions of order 0 or 1? A basic result of complex analysis is the following. Theorem 2.4.5. (Liouville) Any bounded entire function is constant. If f ∈ E(Λ) has no poles, then it must be holomorphic on C, i.e., entire. Further the only values attained by f are the ones attained by restricting f to the fundamental parallelogram F, so f is also bounded. This shows there are no nonconstant elliptic functions of order 0 ( ⇐⇒ holomorphic). Furthermore, one can show there are no elliptic functions of order 1. For those of you who remember your complex analysis, the argument goes as follows. The double periodicity condition, together with Cauchy’s theorem, implies that the integral around any fundamental parallelogram with no poles on the border must be 0. (We may assume by shifting our fundamental domains that there are no poles on these parallelograms.) Hence by the residue theorem, the sum of the residues in any parallelogram must be 0. In particular, we cannot have only one simple pole inside such a parallelogram. The point is that ℘ is the simplest (nonconstant) elliptic function. Furthermore, it is not too diﬃcult to show that the space of elliptic functions E(Λ) is a ﬁeld, and it is generated by ℘ and ℘′, i.e., E(Λ) = C(℘, ℘ ′), i.e., any elliptic function can be expressed as a rational function in ℘ and ℘′. 2.5 Elliptic functions to elliptic curves The theory of elliptic functions gave rise to the modern theory of elliptic curves and to modular forms. This is very beautiful and important mathematics, so despite the fact that it will not be so relevant to our treatment of modular forms, I feel obliged to at least summarize these connections. In this section, x and y do not denote the real and imaginary parts of a complex number z. Deﬁnition 2.5.1. Let F be a ﬁeld. An elliptic curve over F is a nonsingular (smooth) cubic curve in F 2. Theorem 2.5.2. Let F be a ﬁeld of characteristic zero and E/F be an elliptic curve. Then, up to a change of variables, we may express E in Weierstrass form as y2 = x3 + ax + b, (a, b ∈ F ). Furthermore, an equation of the above type deﬁnes an elliptic curve if and only if the discriminant ∆ = ∆(E) = −16(4a3 + 27b2) ̸= 0. The nonzero discriminant condition is what forces the equation to be nonsingular. E.g., the equation y2 = x3 has a cusp at the origin (graph it over R). Actually, one typically wants to consider projective elliptic curves rather than just the aﬃne curves. Suﬃce it to say that, for a curve in Weierstrass form, the projective elliptic curve can be thought of as the aﬃne curve given above together with a point at inﬁnity. It is well known that the points of an elliptic curve form an abelian group, with the point at inﬁnity being the identity element. However to prove it directly from the above deﬁnition is not so easy. 18 Let Λ = ⟨ω1, ω2⟩ be a period lattice in C, and ℘ be the associated Weierstrass pe function. Then for all z ∈ C − Λ, ℘ ′(z) 2 = 4℘(z)3 − 60G4℘(z) − 140G6, where Gk = ∑ ω∈Λ−{0} ω−k. In other words, the map z 7→ (℘(z), ℘′(z)) maps C onto (the aﬃne points) of the elliptic curve EΛ : y2 = 4x3 − 60G4x − 140G6 deﬁned over C, assuming Λ is chosen so that the discriminant of Eλ is nonzero. (Replacing y with 2y puts this in Weierstrass form, if one wishes to do that.) By the periodicity of ℘ and ℘′, this factors through (C − Λ)/Λ. We extend this map to C/Λ by sending Λ to the point at inﬁnity on EΛ. This map gives an analytic isomorphism C/Λ ≃ EΛ from the torus C/Λ to the elliptic curve EΛ. Furthermore, all elliptic curves over C (and consequently all elliptic curves over any subﬁeld of C) arise from some such lattice Λ. Consequently all (projective) elliptic curves over C are topologically tori. Now it is clear that the points on the (projective) elliptic curve EΛ naturally form an additive group because C/Λ is (with respect to addition on C, taken modulo Λ), and the identity of EΛ is the point at inﬁnity, which corresponds to the identity Λ of (C/Λ, +) by construction. Hence elliptic functions (particularly ℘ and ℘′) provide a link between lattices in C and complex elliptic curves. We will now sketch how elliptic functions and elliptic curves lead to the theory modular forms. We say two lattices Λ and Λ′ in C are equivalent if Λ′ = λΛ for some λ ∈ C×. Exercise 2.5.3. Show that if Λ and Λ′ are equivalent, the elliptic functions on Λ′ are simply the elliptic functions on Λ composed with a simple change of variables. Furthermore, Λ and Λ′ being equivalent is the same as the elliptic curves EΛ and EΛ′ being group isomorphic by an analytic map. Write Λ = ⟨ω1, ω2⟩. Clearly Λ is equivalent to the lattice ⟨1, τ ⟩ where τ = ω2/ω1. Since ⟨1, τ ⟩ = ⟨1, −τ ⟩ and τ ̸∈ R, we may assume Im(τ ) > 0, i.e., τ lies in the upper half-plane H = {z ∈ C : Im(z) > 0}. For τ, τ ′ ∈ H, the lattices ⟨1, τ ⟩ and ⟨1, τ ′⟩ are equal if and only if τ ′ ∈ ⟨1, τ ⟩ and τ ∈ ⟨1, τ ′⟩, i.e., if and only if τ ′ = aτ + b and τ = cτ ′ + d for some a, b, c, d ∈ Z. It is easy to see this means τ ′ = τ + b for some b ∈ Z. Hence we may assume τ ∈ H/Z, or more precisely, − 1 2 ≤ Re(τ ) < 1 2 . This means that {±1, ±τ } will be the four nonzero lattice points of ⟨1, τ ⟩ closest to the origin. Hence the only way two lattices ⟨1, τ ⟩ and ⟨1, τ ′⟩ can be equivalent is if λ {±1, ±τ } = {±1, ±τ ′}. It is not hard to see this means either τ ′ = τ or τ ′ = − 1 τ . Exercise 2.5.4. Let τ, τ ′ ∈ H. Fill in the details in the above argument to show that ⟨1, τ ⟩ and ⟨1, τ ′⟩ are equivalent if and only if τ ′ = τ + b or τ ′ = − 1 τ + b, for some b ∈ Z. What the above shows is that equivalence classes of lattices are parametrized by the set of τ ∈ H subject to the conditions either − 1 2 ≤ Re(τ ) < 1 2 and |τ | > 1 or − 1 2 ≤ Re(τ ) ≤ 0 and |τ | = 1. 19 − 1 2 1 2 We will see in the next section that the (closure of the) above region is a fundamental do- main for Γ\\H, where Γ ≃ PSL(2, Z) is the group of (hyperbolic) isometries of H generated by the transformations τ 7→ τ + 1 and τ 7→ − 1 τ . What does all this have to do with modular forms? Well, if you are studying elliptic curves (or even just lattices), one thing you want to look is invariants. For example, given τ ∈ H, consider the map ∆ : τ 7→ Λ = ⟨1, τ ⟩ 7→ EΛ 7→ ∆(Eλ), sending a point in H to the discriminant of the associated elliptic curve. Equivalent (analytically group isomorphic) elliptic curves have essentially the same discriminant, so ∆ is a (holomorphic) function on H satisfying certain transformation properties under Γ. These properties will make ∆ what is called a modular form of weight 12 and level 1. 20 3 The Poincaré upper half-plane There are two basic kinds of non-Euclidean geometry: spherical and hyperbolic. Spherical geometry is easy enough to imagine. Consider the sphere S2 = {(x, y, z) ∈ R3 : x2 + y2 + z2 = 1 }. Then the geodesics (paths which locally minimize distance) are simply the great circles. In other words, for two points P and Q on S2, a shortest path in S2 between them is an arc lying on a great circle connecting P and Q (this great circle will be unique provided P ̸= −Q), and the distance between P and Q in S2 is the (Euclidean) length of this arc. Hyperbolic geometry is a bit harder to picture. Perhaps the easiest way to initially visualize the hyperbolic plane is one sheet of the two-sheeted hyperboloid x2 +y2 −z2 = 1, however this is not the easiest model to work with for many purposes. Just like with the Euclidean plane, the hyperbolic plane has translations, rotations and reﬂections. The two most common models to use, both named after Poincaré, are the Poincaré disc model (due to Beltrami) and the Poincaré upper half-plane model (due to Riemann). The disc model has the advantage of making rotations easy to visualize, and the upper half-plane model has the advantage of making translations easy to visualize. When working with modular forms, one always uses the upper half-plane model. 3.1 The hyperbolic plane Unless stated otherwise, in this chapter z, w ∈ H and x, y ∈ R>0. Deﬁnition 3.1.1. The Poincaré upper half-plane, or hyperbolic plane, is the set H = {z ∈ C : Im(z) > 0} together with the metric given by the distance function d(z, w) = cosh −1 ( 1 + |z − w|2 2 Im(z) Im(w) ) . Angles in the hyperbolic plane H are just taken to be the usual Euclidean angles. We will often write d(z, w) = cosh −1 ( 1 + u(z, w) 2 ) , where u(z, w) = |z − w|2 Im(z) Im(w) . While modular forms will be functions on H satisfying certain transformation laws under isom- etry groups, we do not actually need to know too much about the geometry of H for our study of modular forms. Thus some basic facts about the geometry of H which we do not need, but may help conceptually to be aware of, I will just state without proof. Instead one may refer to basic references on hyperbolic geometry, such as [And05] or [Kat92]. The ﬁrst such fact is the following. Lemma 3.1.2. d(z, w) is a metric on H. 21 To see why this is plausible, ﬁrst notice the argument of cosh−1 always lies in [1, ∞). Recall cosh(x) = ex+e−x 2 so cosh(0) = 1 and cosh is increasing and concave up on [0, ∞). So cosh−1(1) = 0 and cosh−1 is increasing and concave down on [1, ∞) (it grows logarithmically of course). In particular, (i) d(z, w) : H × H → [0, ∞) with d(z, w) = 0 if and only if the argument of cosh −1 is 1, i.e., if and only if u(z, w) = 0, i.e., if and only if z = w. It is also clear that (ii) d(z, w) = d(w, z) for z, w ∈ H since u(z, w) = u(w, z). Thus to show d(z, w) is a metric, it remains to show (iii) the triangle inequality, d(z, w) ≤ d(z, v) + d(v, w), holds for all z, w, v ∈ H. This is somewhat technical (and more easily proven using a diﬀerent formulation of the hyperbolic distance), so I’ll leave it to you to either work out to look up. Another fact one should know, though not formally used in our development of modular forms is the following. Proposition 3.1.3. The geodesics of H are the vertical lines {z ∈ H : Re(z) = x0} and the semi- circles {z ∈ H : |z − z0| = r0} in H which meet R orthogonally. In particular, given any z, w ∈ H, there is a unique geodesic connecting them. 0 Don’t get confused by analogy with the spherical model here. While it’s true that the geodesic arc from z to w is the shortest path between them, the distance between them is not the Euclidean arc length of this arc, but rather the hyperbolic arc length given by (ds)2 = (dx)2+(dy)2 y2 , where z = x + iy. In other words, the hyperbolic distance d(z, w) as deﬁned above does not give you the Euclidean length of geodesic arc from z to w. For instance, the distance from any point z ∈ H to the origin (i.e., limy→0+ d(iy, z)) is inﬁnite. Similarly, the distance from any ﬁnite point z ∈ H to i∞ (i.e., limy→∞ d(iy, z)) is inﬁnite. We compute the case of z = i below. Example 3.1.4. Let y ∈ R>0. Then d(i, iy) = cosh −1 (1 + (y − 1)2 2y ) In fact, since cosh−1(x) = ln(x + √x + 1√x − 1), we can write d(i, iy) = ln ( y2 + 1 2y + |y2 − 1| 2y ) = | ln y|. In particular, we see iy and i/y are equidistant from i, and indeed d(i, 0) := limy→0+ d(i, iy) = ∞ = limy→∞ d(i, iy) =: d(i, i∞). Applying the triangle inequality shows in fact d(z, 0) = d(z, i∞) = ∞ for any z ∈ H. Exercise 3.1.5. For x, y > 0, compute the hyperbolic distance d(ix, iy). Exercise 3.1.6. For z = eiθ ∈ H, compute the hyperbolic distance d(i, z). 22 3.2 Fractional linear transformations In this section, z will denote an element of H, x = Re(z) and y = Im(z) > 0. One nice thing about the upper half-plane model is that there is a nice way to describe the isometries of H in terms of fractional linear transformations (also called Möbius transformations), which you may have encountered in complex analysis. Recall for a ring R, we may deﬁne the 2 × 2 special linear group SL2(R) := {( a b c d ) : a, b, c, d ∈ R, ad − bc = 1 } , as well as the corresponding projective special linear group PSL2(R) := SL2(R)/Z, where Z denotes the (central) subgroup of scalar matrices of SL2(R), i.e., Z = {( a a ) ∈ SL2(R) } = {( a a ) : a ∈ R, a 2 = 1 } . (If you’re not familiar with these, check that these are groups.) The most important cases for us in this course are R = R and R = Z; in both of these cases Z = {±I}. Deﬁnition 3.2.1. A fractional linear transformation of H is a map H → C of the form ( a b c d ) z = az + b cz + d , z ∈ H where ( a b c d ) ∈ SL2(R). (Note one can more generally consider fractional linear transformations ( a b c d ) ∈ GL2(C), but we will always mean elements of SL2(R) by the term fractional linear transformation.) First note that, for c, d ∈ R not both 0, z → az+b cz+d is a rational function of C with at most one pole (of order 1) at −d/c ∈ R if c ̸= 0, fractional linear transformations are holomorphic maps from H to C. Lemma 3.2.2. For σ, τ ∈ SL2(R), the fractional linear transformation σ ◦ τ : H → H given by their composition is equal to the fractional linear transformation στ given by their matrix product. The proof is just a simple computation, which we relegate to Exercise 3.2.3. Prove Lemma 3.2.2. Lemma 3.2.4. Let τ ∈ SL2(R). The fractional linear transformation τ : H → C in fact an analytic automorphism τ : H → H, i.e., τ : H → H an analytic bijection whose inverse is also analytic. Further, τ acts trivially on H if and only if τ = ±I. 23 Proof. Write τ = ( a b c d ) . Then τ (z) = ax + aiy + b cx + ciy + d · cx + d − ciy cx + d − ciy = (ad + bc)x + bd + acy2 + iy(ad − bc) (cx + d)2 + (cy)2 Since ad − bc = 1, we have (a b c d ) z = (ad + bc)x + bd + acy2 + iy (cx + d)2 + (cy)2 = (ad + bc)x + bd + acy2 + iy |cz + d|2 , (3.1) which clearly has positive imaginary part, so τ (H) ⊆ H. To see this is one-to-one, suppose τ (z) = τ (w) for z, w ∈ H. Then cross-multiplying denomina- tors and expanding out az + b cz + d = aw + b cw + d gives adz + bcw = adw + bcz, which says (ad − bc)z = (ad − bc)w, i.e., z = w. Note the identity of SL2(R) acts trivially on H. By the previous lemma, this means τ −1 ◦ τ acts trivially on H. In particular, τ maps onto H. Hence τ : H → H is an analytic automorphism. In order for τ to be the identity on H, looking at the imaginary part of τ (z) shows (cx + d)2 + (cy)2 = 1 for all x ∈ R and y > 0. This implies c = 0 and d = ±1. Then the real part of τ (z) is simply adx + bd. For this to always equal x, we need b = 0 and ad = 1. Hence τ = ±I are the only elements of SL2(R) which act trivially on H. So from now on, we will view fractional linear transformations as analytic automorphisms on H (i.e., holomorphic bijections from H to H whose inverses are also holomorphic). Because composition respects group multiplication, and the only fractional linear transforma- tions acting trivially are ±I, two elements σ, τ ∈ SL2(R) deﬁne the same map if and only if σ = ±τ . This means we can identify the group of fractional linear transformations on H with PSL2(R). De- spite the fact that elements of PSL2(R) are technically not 2×2 matrices, we will still write elements of PSL2(R) as elements of SL2(R) with the convention that −τ is identiﬁed with τ . Now let’s look at a few speciﬁc examples of fractional linear transformations. Let τn = ( 1 n 1 ) , δm2 = ( m m−1 ) , and ι = ( 1 −1 ) . Then τn(z) = ( 1 n 1 ) z = z + n 24 simply translates H to the right by n, δm2(z) = (m m−1 ) z = m 2z dilates, or scales, H outward radially from the origin by m2, and ι(z) = ( 1 −1 ) z = − 1 z inverts H about the semicircle {z ∈ H : |z| = 1}. (Writing z = reiθ may make these latter two trans- formations easier to visualize. The second then becomes obvious, and we see ι(reiθ) = 1 r ei(π−θ).) Note all these transformations map geodesics to geodesics. Furthermore, because they are holomor- phic maps, they are conformal, i.e., they preserve angles. Lemma 3.2.5. The group of fractional linear transformations PSL2(R) acts transitively on H, i.e., for any z, w ∈ H, there exists τ ∈ H such that τ (w) = z. Proof. It suﬃces to show that for any z ∈ H, there exists τ ∈ PSL2(R) such that τ (i) = z. For then there also exists σ ∈ PSL2(R) such that σ(i) = w, so (τ σ−1)(w) = z by the previous lemma. Write z = x + iy with x, y ∈ R and let τ = τxδy. Then τ (i) = τx(iy) = x + iy = z. A basic fact, though we will not need it, is the following. Proposition 3.2.6. The group PSL2(R) of fractional linear transformations on H is precisely the group of orientation-preserving isometries of H. (To obtain the orientation-reversing isometries, one considers 2 × 2-matrices of determinant −1.) We note that since angles in H are simply Euclidean angles, the fact that holomorphic maps are conformal implies fractional linear transformations preserve hyperbolic angles. While we omit the proof, we remark that it is straightforward (though somewhat tedious) to check that all fractional linear transformations are isometries, i.e., they preserve distance, i.e., d(z, w) = d(τ (z), τ (w)) for z, w ∈ H and τ ∈ PSL2(R). However the computations are simpler in the following case. Exercise 3.2.7. Let τ ∈ PSL2(R) and z ∈ H. Show d(z, i) = d(τ (z), τ (i)). (Note it suﬃces to show u(z, i) = u(τ (z), τ (i)).) From now on, we will often write τ (z) simply as τ z for τ ∈ PSL2(R). 3.3 The modular group In this course, we will not work with the group of all fractional linear transformations PSL2(R), but rather certain nice discrete subgroups Γ. First we will study the most basic discrete subgroup, the (full) modular group, PSL2(Z). (Some authors call SL2(Z) the full modular group because they prefer to work in terms of matrices, but we prefer to think in terms of fractional linear transformations of H, so PSL2(Z) is more natural to work with. However, there is no diﬀerence between special linear groups and projective linear groups in terms of fractional linear transformations, so this should not cause any confusion.) 25 Proposition 3.3.1. PSL2(Z) = ⟨S, T ⟩ where S = ( 1 −1 ) and T = ( 1 1 1 ) . Note that S and T are simply the inversion ι and translation τ1 deﬁned in the previous sections, however the notation of S and T is standard for these speciﬁc matrices. Proof. Let Γ = ⟨S, T ⟩. It is clear Γ ⊆ PSL2(Z). Note also that T ∈ Γ implies N = {( 1 x 1 ) : x ∈ Z } ⊆ Γ. Similarly N = {(1 y 1 ) : y ∈ Z } ⊆ Γ, since N is generated by T = S−1T S = ( 1 −1 1 ) ∈ Γ. Now let (a b c d ) ∈ PSL2(Z). We want to show ( a b c d ) ∈ Γ. First note that S−1 ( a b c d ) S = ( d −c −b a ) , we may assume |a| ≤ |d|. Next observe ( a b c d ) ( 1 x 1 ) = ( a ax + b c cx + d ) . Hence by multiplying ( a b c d ) on the right by some element of N , we may assume 0 ≤ b < |a|. Similarly, since (1 y 1 ) ( a b c d ) = ( a b ay + c by + d ) , we may also assume 0 ≤ c < |a|. Hence ad and bc are integers such that ad − bc = 1, |ad| ≥ a2 and |bc| < a2. So we must have ad = 1 and bc = 0. In particular, a = d = ±1, and 0 ≤ b < |a| and 0 ≤ c < |a| then means b = c = 0, i.e., ( a b c d ) = ± ( 1 0 1 ) ∈ Γ. Remark. One can show in fact ⟨S, T |S2 = (ST )3 = 1⟩ is a presentation for PSL2(Z). While we have already deﬁned the notion of a fundamental domain for C, for formality’s sake let us also state the deﬁnition in the case of H. Deﬁnition 3.3.2. Let F ⊂ H be a closed set with connected interior, and Γ a subgroup of PSL2(Z). We say F is a fundamental domain for Γ (or Γ\\H) if (i) any z ∈ H is Γ-equivalent to some point in F; (ii) no two interior points of F are Γ-equivalent; and (iii) the boundary of F is a ﬁnite union of smooth curves in Ω. 26 To clarify for future use, by (ii) we mean that if z, z′ lie in the interior F 0 of F such that γz = z′ for γ ∈ Γ, then z = z′. We do not mean that γz = z′ implies γ = I. However, we will see later (Lemma 3.5.1) that our interpretation of (ii) implies γ = I. Let F = {z ∈ H : |Re(z)| ≤ 1 2 , |z| ≥ 1 } . 0 1 2− 1 2 1−1 F i ζ3 ζ6 (Here ζk = e2πi/k.) Proposition 3.3.3. F is a fundamental domain for PSL2(Z). Proof. Condition (iii) of Deﬁntion 3.3.2 (∂F is a ﬁnite union of smooth curves) is obviously satisﬁed, so we just need to show the ﬁrst two conditions. First we show (i) any point z ∈ H is PSL2(Z)-equivalent to some point in F, i.e., for any z ∈ H, there is some γ = ( a b c d ) ∈ PSL2(Z) such that γz ∈ F. Observe that by (3.1), we have Im(γz) = Im(z) |cz+d|2 . Since c, d ∈ Z and they are not both 0, |cz + d|2 attains a minimum as γ ranges over PSL2(Z). Consequently, we may choose γ such that Im(γz) is maximal. Replacing γ by T nγ for some n ∈ Z shows that we may further assume |Re(γz)| ≤ 1 2 . It remains to show |γz| ≥ 1. Suppose not. Let w = γz and write w = u + iv. Then Sw = −u + iv u2 + v2 . In particular, if |w| < 1, then Im(Sw) > Im(w), i.e., Im(Sγz) > Im(γz), contradicting the maxi- mality of Im(γz). This proves (i). Now we need to show (ii) no two interior points of F are PSL2(Z)-equivalent. Suppose z and w lie in the interior of F, and γz = w for some γ = (a b c d ) ∈ PSL2(Z). We may assume Im(w) ≥ Im(z), 27 or else we could switch z and w and replace γ by γ−1. Since Im(w) = Im(z) |cz+d|2 , this means |cz +d| ≤ 1. In particular |Im(cz + d)| = |c|Im(z) < 1, but z ∈ F implies Im(z) > √3 2 so |c| < 2. First suppose c = 0. Then ad − bc = ad = 1. Multiplying γ by ±1 if necessary (recall we are working in PSL2(Z), so this does not change γ), we may assume a = d = 1 so γ = T n for some n ∈ Z. In this case it is clear we cannot have γz ∈ F. Now suppose c = ±1. Multiplying γ by ±1 if necessary, we may assume c = 1. Note 1 > |cz + d|2 = Re(z + d) 2 + Im(z) 2 > Re(z + d)2 + 3 4 . Hence |Re(z + d)| < 1 2 , which implies d = 0 since |Re(z)| < 1 2 . Then the determinant condition implies b = −1. So γ = ( a −1 1 0 ) , i.e., γz = a − 1 z , which cannot lie in F. This proves (ii). Recall when we deﬁned the notion of a fundamental domain, we said some authors require fundamental domains to be convex. Note that F is convex in H (with respect to the hyperbolic metric), i.e., given any two points in F, one can connect them with a unique geodesic segment, and that segment—either a vertical line segment or a segment of a semicircle centered on the real line—lies entirely in F. Exercise 3.3.4. Show two boundary points z, z′ of F are PSL2(Z)-equivalent if and only if Im(z) = Im(z′) and Re(z) = −Re(z′). The above exercise shows the quotient space PSL2(Z)\\H parametrizes equivalence classes of lattices as described Section 2.5 (cf. ﬁgure at end of Section 2.5). (Note, in contrast to Chapter 2, it is standard to write the quotient by the action of PSL2(Z) on the left here because we think of matrices as acting on H from the left.) Since the fundamental domain F we have given above is universally used, it is called the standard fundamental domain for PSL2(Z). There is a trivial way to cook up other fundamental domains— namely γF is also a fundamental domain for PSL2(Z) for any γ ∈ PSL2(Z). This statement is slightly generalized in the following simple exercise. Exercise 3.3.5. Let Γ ⊆ PSL2(R) be discrete and suppose F ′ is a fundamental domain for Γ. Suppose γ ∈ PSL2(R) such that γ−1Γγ = Γ. Show γF ′ is also a fundamental domain for Γ. *Exercise 3.3.6. (i) Show that the set of γF with γ ∈ PSL2(Z) tile H, i.e., their union covers H and their interiors are pairwise disjoint. (ii) Show the picture below of the partial tiling of H given by γF is correct, where we labelled the region γF simply by γ. (Hint: begin by showing S takes the vertical line x + iR>0 to the upper semicircle passing through 0 and − 1 x .) 28 0 1 2− 1 2 1−1 2−2 1 3 2 3 IT −1 T ST −1S T S ST −1STST S T ST In the above diagram, note ST S = T −1ST −1 and T ST = ST −1S. 3.4 Congruence subgroups From our point of view so far, the simplest kinds of (meromorphic) modular forms (modular func- tions of level one) will be meromorphic functions f : H → ˆC satisfying f (γz) = f (z) for γ ∈ PSL2(Z). (3.2) Note this is a hyperbolic analogue of the deﬁnition of elliptic functions. Speciﬁcally, ﬁx a lattice Λ ⊂ C and let ΓΛ be the group of isometries of C given by γω(z) = z + ω where ω ranges over Λ. Then elliptic functions w.r.t. Λ were simply deﬁned to be the (meromorphic) functions on C satisfying f (γz) = f (z) for γ ∈ ΓΛ. So instead of being functions on C (with Euclidean geometry) invariant under an isometry group ΓΛ corresponding to a lattice Λ, modular functions will be functions on H (with hyperbolic geometry) invariant under a hyperbolic isometry group Γ, with the simplest case being Γ = PSL2(Z). If one wants to think of a hyperbolic analogue of the lattice Λ, there is no issue here. Note one can recover the lattice Λ ⊂ C from the group ΓΛ simply by looking at the ΓΛ-translates of the origin in C. In this way, we see any isometry group of C isomorphic to Z × Z gives a lattice. Similarly, for any (noncyclic) “discrete” isometry group Γ ⊂ PSL2(R) of H, one can think of the corresponding “hyperbolic lattice” as simply the Γ-translates of i. (Note discrete here precisely means the Γ-translates of i form a discrete subset of H, and one excludes the case of cyclic groups Γ as they will correspond to “1-dimensional” lattices in H.) Now the modular functions satisfying (3.2), while certainly very interesting, are not suﬃcient for most number theoretic purposes. There are two ways of generalizing (3.2) that will include many import functions arising naturally in number theory. One way is to loosen the invariance by only requiring f (γz) = α(γ, z)f (z) for some “weight” α(γ, z) (then one calls the resulting functions modular forms). The second way is to not require (3.2) hold for all γ ∈ PSL2(Z), but merely all γ ∈ Γ, where Γ is a suitable subgroup of PSL2(Z). In fact, as alluded to earlier, one could just require that Γ be a noncyclic discrete subgroup of PSL2(R). However the most interesting cases of study for number theory is when Γ is a congruence subgroup of PSL2(Z). 29 Deﬁnition 3.4.1. Let N ∈ N. The modular group of level N is Γ0(N ) = {( a b c d ) ∈ PSL2(Z) : c ≡ 0 mod N } . Note when N = 1, we have Γ0(1) = PSL2(Z), and we sometimes call this the full modular group. It is also clear that Γ0(N ) ⊆ Γ0(M ) if M |N. One also has the more reﬁned congruence subgroups Γ1(N ) = {( a b c d ) ∈ PSL2(Z) : (a b c d ) ≡ (1 b 0 1 ) mod N } and the principal congruence subgroups Γ(N ) = {( a b c d ) ∈ PSL2(Z) : ( a b c d ) ≡ ( 1 0 0 1 ) mod N } . All of these subgroups are ﬁnite index inside PSL2(Z) and have been studied classically in the context of modular forms. Note that Γ(N ) ⊆ Γ1(N ) ⊆ Γ0(N ). In general, a congruence subgroup of PSL2(Z) is a subgroup containing some Γ(N ). However, the most important congruence subgroups are the modular groups Γ0(N ), and we will restrict our focus in this course to them. Unless explicitly stated otherwise, from now on, Γ will always denote a congruence subgroup of PSL2(Z). In order to understand the coset space PSL2(Z)/Γ0(N ), it will be helpful to use the “projective line over Z/N Z.” For (a, c), (a′, c′) ∈ Z/N Z × Z/N Z, we write (a, c) ∼ (a′, c′) if (a′, c′) = (λa, λc) for some λ ∈ (Z/N Z)×. It is clear that ∼ is an equivalence relation. We denote the equivalence class of (a, c) by (a : c), and deﬁne the projective line P1(Z/N Z) = {(a : c)|a, c ∈ Z/N Z, gcd(a, c) = 1} . Here by gcd(a, c) = 1, we mean that there exist ̃a, ̃c ∈ Z in the congruence classes a mod N and c mod N such that gcd(̃a, ̃c) = 1); or, alternatively, there exist r, s ∈ Z/N Z such that ar + cs ≡ 1 mod N . Lemma 3.4.2. The coset space PSL2(Z)/Γ0(N ) is ﬁnite, in bijection with P1(Z/N Z), and a set of coset representatives is given by matrices of the form (a b c d ) , where (a, c) ∈ Z × Z such that (i) (a : c) ranges over P1(Z/N Z) and (ii) b, d are chosen such that ad − bc = 1. Proof. First observe that ( a b c d ) ∈ ( a′ b′ c′ d′ ) Γ0(N ) ⇐⇒ ( d′ −b′ −c′ a′ ) ( a b c d ) ∈ Γ0(N ). 30 By deﬁnition, this holds if and only if the lower left hand coeﬃcient of the product on the right, a′c − c′a, is divisible by N . In other words, we have ( a b c d ) ∈ ( a′ b′ c′ d′ ) Γ0(N ) ⇐⇒ a ′c ≡ ac ′ mod N. Note that a pair of integers (a, c) can occur as a column of a matrix in PSL2(Z) if and only if ad − bc = 1 is solvable, i.e., if and only if gcd(a, c) = 1. Hence the space of cosets PSL2(Z)/Γ0(N ) is in bijection with the set of pairs (a, c) ∈ Z/N Z × Z/N Z such that gcd(a, c) = 1 under the equivalence that (a, c) ≡ (a′, c′) ⇐⇒ a′c ≡ ac′ mod N . It suﬃces to show that a′c ≡ ac′ mod N is equivalent to (a′, c′) = (λa, λc) for some λ ∈ (Z/N Z×). Clearly if (a′, c′) = (λa, λc), then a′c ≡ ac′ mod N . On the other hand, suppose (a, c), (a′, c′) ∈ Z × Z such that gcd(a, c) = gcd(a′, c′) = 1 and a′c ≡ ac′ mod N . Write N = p n1 1 · · · pnk k . By the Chinese Remainder Theorem, Z/N Z ≃ Z/pn1 1 Z × · · · × Z/pnk k Z. Under this isomorphism, write a = (a1, . . . , ak) where ai ∈ Z/pni i Z, and do similarly for c, a′, and c′. Then a′c ≡ ac′ mod N means a′ ici ≡ aic′ i mod p ni i for each i. By the condition gcd(a, c) = 1, we know pi cannot divide both ai and ci. Assume pi ∤ ai, and say gcd(ci, p ni i ) = p ei i . Then a′ ici ≡ aic′ i mod pni i means gcd(c′ i, p ni i ) = pei i so pi ∤ a′ i. Put λi = a′ ia −1 i . Then a′ i = λiai and c′ i = λici. Consequently λ = (λ1, . . . , λk) ∈ (Z/N Z)× such that (a′, c′) ≡ (λa, λc) mod N . Corollary 3.4.3. [PSL2(Z) : Γ0(N )] = N ∏p|N (1 + 1 p ), where p runs through the distinct prime divisors of N . Proof. First suppose N = pn. For any equivalence class (a : c), either a is divisible by p or not. If not, we may rewrite this class as (λa : λc) = (1 : λc) where λ ≡ a−1 mod N . There are N choices for λc mod N , and all inequivalent. If p|a then p ∤ c, so by the same argument we may rewrite (a : c) = (λa : 1). Since λa must be a multiple of p, there are N/p choices for λa, and they all give inequivalent classes. Thus the proposition holds when N = pn. The proof for arbitrary N follows from the prime power case using the Chinese Remainder Theorem (see exercise below). Corollary 3.4.4. Let p be a prime, and n ∈ N. Then a complete set of coset representatives of PSL2(Z)/Γ0(pn) is given by {T ipS = ( ip −1 1 0 ) : 0 ≤ i < p n−1} ∪ {ST jS = ( 1 0 −j 1 ) : 0 ≤ j < p n} . Proof. First check T iS and ST jS are given by the expressions above. Then observe the proof of Corollary 3.4.3 actually tells us that P 1(Z/pnZ) = {(ip : 1) : 0 ≤ i < p n−1} ∪ {(1 : j) : 0 ≤ j < p n} . Hence by Lemma 3.4.2, we know S = T 0S, T pS, . . . T pn−1S, I = ST 0S, ST S, . . . , ST pn−1S forms a set of coset representatives for PSL2(Z)/Γ0(pn). Exercise 3.4.5. Complete the proof of Corollary 3.4.3 in the case where N is not a prime power. Exercise 3.4.6. Find a complete set of coset representatives for PSL2(Z)/Γ0(15). 31 Exercise 3.4.7. Find [PSL2(Z) : Γ1(N )]. (Suggestion: determine the index inside Γ0(N ).) Exercise 3.4.8. Find [PSL2(Z) : Γ(N )]. (Suggestion: see previous suggestion.) Lemma 3.4.9. Let F be a fundamental domain for PSL2(Z), and let Γ be a congruence subgroup of PSL2(Z). Let {αi} be a complete set of coset representatives for PSL2(Z)/Γ such that F ′ = ⋃ α−1 i F has connected interior. Then F ′ is a fundamental domain for Γ. Proof. Clearly the boundary of F ′ is a ﬁnite union of smooth curves, since the same is true of each αiF. Let z ∈ H. We show z is Γ-equivalent to a point in F ′. First, there is some τ ∈ PSL2(Z) such that τ z ∈ F. Write τ = αiγ for some αi where γ ∈ Γ. Then αiγz ∈ F, so γz ∈ α−1 i F ⊆ F ′. Now we want to show no two points z and z′ in the interior F ′0 of F ′ can be Γ0(N ) equivalent. The basic idea is that the following. Suppose z′ = γz for γ ∈ Γ, and write z = α−1 i w, z′ = α−1 j w′ where w, w′ ∈ F. Hence w′ = αiγα−1 j w, i.e., w′ and w are equivalent in PSL2(Z). If w, w′ are actually interior points of F, this can only happen if w′ = w, and one can use this to conclude z′ = z. However it need not be that w, w′ are interior points (e.g., examine the diagram in the example below), so instead we make the following argument to reduce to this case. Let γ ∈ Γ and suppose U = F ′0 ∩ γF ′0 is nonempty. For some αi, αiU ∩ F 0 is nonempty. Say w ∈ αiU ∩ F 0. Then z = α−1 i w ∈ F ′0 such that z′ = γz ∈ F ′0. There exists αj such that w′ = αjz′ ∈ F. Thus we have w′ = αjγα−1 i w, i.e., w is PSL2(Z)-equivalent to w′. It is a simple exercise (below) that no interior point of F is PSL2(Z)-equivalent to a boundary point, hence w′ ∈ F 0. Since no two interior points of F are PSL2(Z)-equivalent, we have w′ = w, i.e., w is a ﬁxed point of αjγα−1 i . However no interior points of F are ﬁxed by a nontrivial element of PSL2(Z) (either justify this to yourself, or see Lemma 3.5.1 below), whence αjγα−1 i = I. This implies αjΓ = αiΓ, i.e., i = j, which then implies γ = I so z′ = z. Exercise 3.4.10. Let Γ be a congruence subgroup of PSL2(Z) and F a fundamental domain for Γ. Show that no interior point of F is Γ-equivalent to a boundary point. Example 3.4.11. Consider Γ0(2) and let F be the standard fundamental domain for PSL2(Z). By Corollary 3.4.4, a set of representatives for PSL2(Z)/Γ0(2) is I, S, ST S. Hence by the above lemma, F ∪ SF ∪ ST −1SF would be a fundamental domain for Γ0(2) if it had connected interior, but it does not (cf. diagram for Exercise 3.3.6). Instead, if we replace the coset representative ST S = T −1ST −1 with T −1S, and then apply the above lemma, we see F ′ = F ∪ SF ∪ ST F, pictured below, is a fundamental domain for Γ0(2). 32 0 1 2− 1 2 F SF ST F Note that F ′ is convex in H. *Exercise 3.4.12. Find a fundamental domain for Γ0(4) which contains the above fundamental domain for Γ0(2). 3.5 Cusps and elliptic points As we said in the previous section, in some sense the simplest kinds of modular forms (modular functions) will be (meromorphic) functions on the upper half-plane H which are invariant under transformations in PSL2(Z) or some congruence subgroup Γ. This means we can think of them as functions on the quotient space X = Γ\\H, or in other words, functions on a fundamental domain F for Γ which satisfy certain conditions on the boundary. (The space X is simply F with certain boundary points identiﬁed.) There are 2 special kinds of points for X. First, let us discuss elliptic points. We say z ∈ F (or X) is an elliptic point if there exists γ ∈ Γ − {I} such that γz = z. In other words, the elliptic points for F are the points ﬁxed by some (non-identity) transformation in Γ. We have already seen these play a role in ﬁnding a fundamental domain (in the proof of Lemma 3.4.9). The γ ∈ Γ − {I} which ﬁx some point of X (or equivalently F) are called the elliptic elements of Γ. For example if Γ = PSL2(Z) and F is the standard fundamental domain, then i is ﬁxed by the transformation S. We will proceed to determine all elliptic points and elliptic elements for PSL2(Z). First we observe the following general result. Lemma 3.5.1. Suppose F is a fundamental domain for Γ and z is an elliptic point of F. Then z lies on the boundary ∂F of F. Proof. Suppose z lies in the interior F 0 of F and γ ∈ Γ such that γz = z. Then there exists a neighborhood U of z in F 0 such that γU ⊆ F 0. Consequently, any w ∈ U is Γ-equivalent with γw. However, by the deﬁnition of fundamental domain, this means γw = w for all w ∈ U , i.e., γ must 33 act trivially on U . Since two holomorphic functions agreeing on an open set agree everywhere, this gives γ = I, i.e., z is not elliptic. Lemma 3.5.2. The only elliptic points for the standard fundamental domain of PSL2(Z) are i, ζ3 and ζ6. The elliptic subgroup ﬁxing i is {I, S}. The subgroup ﬁxing ζ3 is {I, ST, T −1S}. The subgroup ﬁxing ζ6 is { I, ST −1, T S}. Observe by the diagram in Exercise 3.3.6, we can visually see the only possible elliptic elements of PSL2(Z) are S, ST , ST −1, ST S, T ST , T −1S, T S, T −1 and T . Further T and T −1 clearly ﬁx no points of H. *Exercise 3.5.3. Prove the previous lemma (either using Exer 3.3.6 or not). Lemma 3.5.4. Let Γ be a ﬁnite index subgroup of PSL2(Z) and F a fundamental domain. Then any elliptic point of F must be of the form γz ∈ ∂F where γ ∈ PSL2(Z) and z ∈ {i, ζ3, ζ6}. i.e., it is a PSL2(Z)-translate of i, ζ3 and ζ6 lying on the boundary of F. Further, such a γz will be elliptic if and only if γCγ−1 ⊂ Γ where C is the stabilizer of z in PSL2(Z). In this case, γCγ−1 is the stabilizer subgroup of γz in Γ. In particular, there are only ﬁnitely many elliptic points and elliptic elements for Γ. Proof. Suppose w ∈ ∂F has nontrivial stabilizer C in Γ. Let F0 be the standard fundamental domain for PSL2(Z). There is some τ ∈ PSL2(Z) such that z = τ w ∈ F0. Consequently, τ Cτ −1 is a subgroup of PSL2(Z) stabilizing z, i.e., z is an elliptic point in PSL2(Z) On the other hand, let z ∈ {i, ζ3, ζ6} and C be the subgroup (of order 2 or 3) which stabilizes z in PSL2(Z). If γz ∈ ∂F for some γ ∈ PSL2(Z), then the stabilizer of γz in PSL2(Z) is γCγ−1. Hence γz is elliptic for Γ if and only if γCγ−1 ⊂ Γ. If z is an elliptic point for Γ, we say it is elliptic of order n if the stabilizing subgroup of z in Γ has order n. From the above lemma, we see that any elliptic point must have order 2 or 3 in Γ ⊆ PSL2(Z) Exercise 3.5.5. Determine the elliptic points for Γ0(2) and Γ0(4) (Use the fundamental domains from 3.4.11 and Exercise 3.4.12. Exercise 3.5.6. Let p be a prime. (i) Show that the number of elliptic points of order 2 for Γ0(p) is ϵ2(p) = 1 + ( −1 p ) =  | | 1 p = 2 2 p ≡ 1 mod 4 0 p ≡ 3 mod 4. (ii) Show that the number of elliptic points of order 3 for Γ0(p) is ϵ3(p) = 1 + ( −3 p ) =  | | 1 p = 3 2 p ≡ 1 mod 3 0 p ≡ 2 mod 3. (iii) Write a table which determines the total number of elliptic points for Γ0(p) depending only on the values of p mod 12. 34 More generally (e.g., [DS05, Corollary 3.7.2]), the number of elliptic points of order 2 (resp. 3) for Γ0(N ) is ∏p|N ϵ2(p) (resp. ∏p|N ϵ2(p)). We remark that elliptic points in F will be precisely the non-smooth points of the Riemann surface X = Γ\\H. To get some idea of the geometry that goes on, consider the case of F being the standard fundamental domain for PSL2(Z). Around a non-elliptic point, one needs to go around 2π to make a closed loop. On the other hand, to make a closed loop around i, one only needs to go π radians. Similarly, to make closed loops around ζ3 and ζ6, one needs to go around 2π/3 radians. In fact, the subgroup ﬁxing any elliptic point z is cyclic of order m, and this subgroup is generated by an elliptic element which can be viewed as a hyperbolic rotation around z by 2π/m. While elliptic points do play a role in the theory of modular forms, more important for us will be the notion of the cusps of Γ. In fact, we need to know what cusps are to even give a deﬁnition of modular forms. Thinking of the Riemann surface, X = Γ\\H goes oﬀ to inﬁnity in certain places. For example, think of Γ = PSL2(Z) and the standard fundamental domain F. If we look at the deﬁnition of distance in H, it is clear the width of the fundamental domain d (− 1 2 + iy, 1 2 + iy) → 0 as y → ∞. (Alternatively, think about the fundamental domain SF.) Hence if we think about some truncated fundamental domain, say F100 = {z ∈ F : Im(z) > 100}, it looks like an half-inﬁnite cylinder whose diameter is shrinking to an inﬁnitesimal amount as Im(z) → ∞. This behavior at inﬁnity is called a cusp. If we look at the fundamental domain for Γ0(2) in Example 3.4.11, it appears to have two cusps, one at i∞ and one at 0. (Remember, distance to the real line is inﬁnite in H.) We will not be overly concerned with the geometry of X at its cusps (geometrically, they all look the same), but mainly in determining what they in terms of fundamental domains. One way to think about what the cusps for X should be is to think about how to compactify it. Let us think about the case of Γ = PSL2(Z) with standard fundamental domain F. By our remarks about the geometry of F with large imaginary part, it makes sense to look at the one-point compactiﬁcation F = F ∪ {i∞} of F. In other words, we look at X = PSL2(Z)\\H ∪ {i∞}. It would be nice to think of X itself as a quotient space, i.e., X = PSL2(Z)\\H where H is obtained from H by adding possible cusps. Precisely, we the extended upper half-plane H = H ∪ {i∞} ∪ Q. Now we extend the action of PSL2(Z) to H as follows: ( a b c d ) i∞ = lim y→∞ aiy + b ciy + d = { a c c ̸= 0 i∞ c = 0, and ( a b c d ) p q = lim y→0+ a ( p q + iy) + b c ( p q + iy) + d = { ap+bq cp+dq cp + dq ̸= 0 i∞ cp + dq = 0, where p q ∈ Q. (Note some authors call i∞ by ∞, though we feel the notation i∞ is pictorially more suggestive. In fact, the natural compactifcation of H—most easily seen from the Poincaré disc model—is to simply take the one-point compactiﬁcation of H ∪ R, so even if we think of the symbol ∞ meaning limx→∞ = +∞, we still have ∞ = i∞.) That this is indeed an action (i.e., that the action associates with the group multiplication in PSL2(Z)) follows formally from the action on H. If one wants to specify the topology on H, we can start with deﬁning a basis of open neigh- borhoods of i∞ in H to be U y = {i∞} ∪ {z ∈ H : Im(z) > y} where y > 0. Then for x ∈ Q, take 35 γx ∈ PSL2(Z) such that γi∞ = x. A basis of open neighborhoods around x in H is then given by γxU y where y > 0. Exercise 3.5.7. Show the open neighborhood γxU y is a Euclidean circle in H ∪ R which is tangent to R at x. Deﬁnition 3.5.8. Let Γ ⊆ PSL2(Z). The cusps of Γ (or Γ\\H) are the set of Γ-equivalence classes of {i∞} ∪ Q. Example 3.5.9. From the deﬁnition, we see any element of Q is PSL2(Z)-equivalent to i∞. Hence, PSL2(Z) has 1 cusp. Example 3.5.10. Let (a b c d ) ∈ Γ0(2). Then c ≡ 0 mod 2, so a ≡ d ≡ 1 mod 2. Hence i∞ is Γ0(2) equivalent to a (nonzero) rational number a c in reduced form if and only if c is even. Similarly, 0 is Γ0(2) equivalent to a nonzero rational number b d in reduced form if and only if d is odd. Thus there are two cusps for Γ0(2), represented by 0 and i∞. This agrees with the picture of the fundamental domain in Example 3.4.11. Lemma 3.5.11. For any prime p, Γ0(p) has precisely 2 cusps, represented by 0 and i∞. Proof. Simply replace 2 by p in the previous example. Exercise 3.5.12. Draw a fundamental domain for Γ0(3) which has 0 and i∞ as limit points. Lemma 3.5.13. For any Γ0(N ) the number of cusps is ﬁnite. This statement is true more generally for congruence subgroups, but we will restrict our proof to the case of modular groups. Proof. Consider any rational number p q in reduced form. Because we only want to show the number of Γ0(N )-equivalence classes of {i∞} ∪ Q is ﬁnite, we may assume p q is not Γ0(N )-equivalent to i∞. There exist c′, d ∈ Z relatively prime such that c′pN + dq = gcd(pN, q), which equals gcd(N, q) since gcd(p, q) = 1. Further c′pN + dq = gcd(N, q) implies gcd(c, d) = 1 where c = c′N . Thus there exist a, b such that ( a b c d ) ∈ Γ0(N ). Hence (a b c d ) p q = ap + bq cp + dq = ap + bq gcd(N, q) . Therefore replacing p q by something Γ0(N )-equivalent, we may assume q|N . Further, since T ∈ Γ0(N ), we see T b p q = ( 1 b 0 1 ) p q = p + bq q is also Γ0(N )-equivalent to p q . Hence we can also assume 0 ≤ p < q. This gives only a ﬁnite number of possible non-equivalent p q . One can reﬁne the argument above to precisely count the number of cusps for Γ0(N ). 36 Exercise 3.5.14. Show that the number of cusps for Γ0(N ) is given by ∑ d|N ϕ(gcd(d, N/d)) where ϕ is the Euler phi function. *Exercise 3.5.15. Compute the cusps for Γ0(4). 37 4 Modular Forms 4.1 Modular curves and functions Deﬁnition 4.1.1. The modular curves of level N , Y0(N ) and X0(N ), are deﬁned to be Y0(N ) = Γ0(N )\\H and X0(N ) = Γ0(N )\\H. In particular, Y0(1) = PSL2(Z)\\H and X0(1) = PSL2(Z)\\H. Note X0(N ) is the compactiﬁcation of Y0(N ) obtained by adding the cusps for Γ0(N ), as de- scribed in the last chapter. Exercise 4.1.2. Show X0(N ), with the quotient topology, is compact, using the topology on H described Section 3.5. Before we go further, let us explain the terminology a bit. In Section 2.5, we saw that Y0(1) parameterized lattices in C, equivalently, isomorphism classes of (generalized) elliptic curves. (Some lattices would give a curve with discriminant 0, and these degenerate curves are called generalized elliptic curves). One can also deﬁne a generalized elliptic curve for the cusp in X0(1), and thus view X0(1) as parametrizing the space of (generalized) elliptic curves over C, up to analytic isomorphism. Similarly, X0(N ) parametrizes isomorphism classes of pairs (E, C) where E is a (generalized) elliptic curve over C and C is a cyclic subgroup of order N . In algebraic geometry, a moduli space is a geometric object (curve, surface, manifold, etc.) whose points parametrize a class of other geometric objects, in this case elliptic curves with a distinguished cyclic subgroup. The Riemann surface X0(N ) can also be viewed as an algebraic curve over C, hence the term modular curve. Realizing X0(N ) as a moduli space is fundamental in the theory of elliptic curves, though we will not focus on this aspect in this course. For those familiar with Riemann surfaces, or complex manifolds, we can state the deﬁnition of a modular function very simply. Deﬁnition 4.1.3. (Riemann surface version) A modular function of level N is a meromorphic function f : X0(N ) → ˆC. For both readers familiar with Riemann surfaces and those not, let us translate this into a statement about functions on H. First, think about f restricted to Y0(N ) = Γ0(N )\\H. Being a meromorphic function on Y0(N ) means we can lift f to a function f : H → ˆC such that (i) f (γz) = f (z) for all γ ∈ Γ0(N ), and (ii) f is meromorphic on H. Now we need to explain what it means for f to be meromorphic at the cusps of X0(N ). We ﬁrst consider the notion of meromorphy at the cusp {i∞}. It may be helpful at this point to recall the discussion at the end of Section 2.3. 38 Since T = (1 1 0 1 ) ∈ Γ0(N ), we know f (T z) = f (z + 1) = f (z), i.e., f is periodic of period 1. Consequently, this means f (z) has a Fourier expansion f (z) = ∑ n∈Z ane2πinz where the n-th Fourier coeﬃcient an is given by an = ∫ 1 0 f (z)e−2πinzdx, (z = x + iy) valid for all z ∈ H. (Our argument at the end of Section 2.3 will justify that an does not depend upon y.) Put q = e2πiz. Thus the Fourier expansion becomes f (z) = ∑ n∈Z anqn. (4.1) This is also called the q-expansion for f . Note that the map z = x + iy 7→ q = e−2πye2πix is an analytic bijection from the vertical strip {z ∈ H : − 1 2 ≤ Im(z) < 1 2 } in H to the punctured disc D× = {z ∈ C : 0 < |z| < 1}. Therefore we may think of f (z), a priori a periodic function on H, instead as a function F (q) on D×. If z = iy, then q = e−2πy, so as z → i∞, q → 0. Hence f (z) being meromorphic at the cusp z = i∞ precisely means that F (q) is meromorphic at q = 0. If F (q) is meromorphic at q = 0, then it has a Laurent expansion, which must equal the Fourier expansion (4.1). In other words F (q) is meromorphic at q = 0 if and only if (iii-a) the Fourier coeﬃcients an = 0 for all but ﬁnitely many n < 0. By (2.3), this is equivalent to the condition that |f (z)| grows at most exponentially as y → ∞, i.e., (iii-a’) for y ≫ 0, there exists m such that |f (z)| < emy. Now that we know what it means for f (z) to be meromorphic at the cusp i∞, we can use this to say what it means to be meromorphic at any cusp. Namely consider a cusp for Γ0(N ) represented by z0 ∈ Q, and let τ ∈ PSL2(Z) be an element which maps i∞ to z0. Consider the function f |τ (z) = f (τ z). Since τ is an isometry of H, f |τ is also meromorphic on H. Lemma 4.1.4. Suppose f (γz) = f (z) for γ ∈ Γ0(N ). Let τ ∈ PSL2(Z). Then f |τ (z + N ) = f |τ (z) for all z ∈ H. Proof. First note that f |τ is left-invariant under τ −1Γ0(N )τ : for γ ∈ Γ0(N ), we have f |τ (τ −1γτ z) = f (γτ z) = f (τ z) = f |τ (z). On the other hand, note that the principal congruence subgroup Γ(N ) = {γ ∈ PSL2(Z) : γ ≡ I mod N } ⊆ Γ0(N ) is a normal subgroup of PSL2(Z). In particular Γ(N ) ⊆ τ −1Γ0(N )τ , so f |τ is invariant under T N ∈ Γ(N ). This proves the claim. 39 This lemma means that f |τ is also periodic with period N . (It may actually have smaller period if a smaller power of T lies in τ −1Γ0(N )τ .) Consequently, f |τ has a Fourier expansion of the form f |τ (z) = ∑ n∈Z aτ,nqn N , (4.2) where qN = e2πiz/N . (If, for instance, f |τ actually has period 1, we can write f |τ (z) = ∑ cnqn, i.e., the aτ,n = 0 unless N |n.) What f (z) to be meromorphic at the cusp z0 means is precisely that f |τ is meromorphic at i∞. Now our discussion about what it meant for f (z) to be meromorphic at i∞ goes through for functions with period N just as well, and we see f (z) is meromorphic at the cusp z0 if and only if (iii-b) the Fourier coeﬃcients aτ,n = 0 for all but ﬁnitely many n < 0; or equivalently, (iii-b’) for y ≫ 0, there exists m such that |f |τ (z)| < emy. Observe that (4.2) can be used to give another series expansion for f . Namely, since f (z) = f |τ (τ −1z), we can write f (z) = ∑ n∈Z aτ,nqn τ , qτ = e2πiτ −1z/N . (4.3) This expansion, again valid for all z ∈ H, is called a Fourier (or q−) expansion at z0 (with respect to τ ) for f (z). Consequently, we sometimes refer to the usual Fourier expansion (4.1) as the Fourier expansion at i∞. A priori, the Fourier expansion (4.3) at z0, and consequently the conditions (iii-b) and (iii-b’), depend upon the choice of τ ∈ PSL2(Z) we used to send z0 to i∞. We would like to say all of these are independent of the choice of τ —and in fact the choice of z0 representing the given cusp—and this is essentially what the following lemma tells us. Lemma 4.1.5. Suppose a meromorphic f : H → ˆC satisﬁes f (γz) = f (z) for all γ ∈ Γ0(N ). Let z0, z′ 0 ∈ {i∞} ∪ Q represent the same cusp for Γ0(N ), i.e., z′ 0 = γz0 for some γ ∈ Γ0(N ). Now suppose τ, τ ′ ∈ PSL2(Z) such that τ z0 = τ ′z0 = i∞. Then f |τ (z) = f |τ ′(z + j) for some j ∈ Z. Consequently, the Fourier coeﬃcients with respect to τ and τ ′ are related by aτ ′,n = aτ,ne2πij/N for all n; in particular |aτ ′,n| = |aτ,n| for all n. Proof. First observe that γτ is an element of PSL2(Z) which sends i∞ to z′ 0. Therefore (τ ′)−1γτ = ( a b c d ) ∈ PSL2(Z) which preserves i∞. By the deﬁnition of our action of PSL2(Z) on {i∞} ∪ Q, this means c = 0, whence a = c = ±1 so (τ ′)−1γτ = T j for some j ∈ Z, i.e., τ ′ = γτ T −j. Consequently f |τ ′(z) = f (τ ′z) = f (γτ T −jz) = f (τ T −jz) = f |τ (T −jz) = f |τ (z − j). 40 This gives the ﬁrst part of the lemma. Since we may also the last equation as f |τ ′ = f |τ T −j , the Fourier expansion at z′ 0 (w.r.t. τ ′) for f (γz) is f (z) = f (γz) = ∑ n∈Z aτ ′,ne2πiT j τ −1γ−1γz/N = ∑ n∈Z aτ ′,ne2πiT j τ −1z/N = ∑ n∈Z aτ ′,ne 2πij/N e 2πiτ −1z/N . Comparing this with the Fourier expansion at z0 (w.r.t. τ ) for f (z) gives the second assertion. In other words, f (z) may technically have more than one Fourier expansion at a given cusp, but any Fourier expansion is obtained from a given one by replacing the parameter qτ = e2πiz/N with a parameter of the form qγτ T −j = e2πi(τ γ−1z+j) for j ∈ Z and γ ∈ Γ0(N ) and multiplying all the Fourier coeﬃcients aτ,n by a ﬁxed root of unity e2πij/N . Now we can recast Deﬁnition 4.1.3 in the language it is typically presented in most modular forms texts. Deﬁnition 4.1.6. (Upper half-plane version) We say a function f : H → ˆC is a modular function of level N if (i) f (γz) = f (z) for all γ ∈ Γ0(N ); (ii) f is meromorphic on H; and (iii) f is meromorphic at each cusp of Γ0(N ); i.e., for each τ ∈ PSL2(Z), the Fourier coeﬃcients aτ,n as deﬁned in (4.3) satisfy aτ,n = 0 for all but ﬁnitely many n < 0. In practice one only needs to check the condition on negative Fourier coeﬃcients aτ,n as τ ranges over a ﬁnite set of elements of PSL2(Z) such that τ ∈ i∞ runs over all cusps of Γ0(N ). Further, our discussion above of course implies that (iii) is equivalent to (iii’) for each τ ∈ PSL2(Z), the function f |τ is of moderate growth in y = Im(z), i.e., for y large, there exists m such that |f |τ (z)| < emy. Exercise 4.1.7. Suppose f is a modular function of level 1 with Fourier expansion f (z) = ∑∞ −m anqn. Show that for any τ ∈ PSL2(Z), the Fourier coeﬃcients with respect to τ are the usual Fourier co- eﬃcients, i.e., aτ,n = an for all n. Note that our above discussion goes through if we replace Γ0(N ) by an arbitrary congruence subgroup Γ, as Γ ⊇ Γ(N ) for some N . Thus for any congruence subgroup Γ of PSL2(Z), we can say f : H → ˆC is a modular function for Γ by simply replacing Γ0(N ) by Γ in the deﬁnition above. Exercise 4.1.8. Suppose f is a modular function for a congruence subgroup Γ(N ). (i) For τ ∈ PSL2(Z), show f |τ is a modular function for τ −1Γ(N )τ . (ii) Deduce that |τ : f 7→ f |τ operates on the space of modular functions for Γ(N ). (iiii) Show f |τ = f |τ ′ if τ ′ ∈ Γτ . Hence at most |Γ(N )\\PSL2(Z)| of the operators |τ can be distinct. (iv) Show (f |τ )|τ ′ = |τ τ ′, hence these operators give a right action of the quotient group Γ(N )\\PSL2(Z) on the space of modular functions for Γ(N ). There are a couple obvious things we can say now about modular functions. 41 Example 4.1.9. Any constant function on H is a modular function for any congruence subgroup Γ. Example 4.1.10. Suppose Γ, Γ′ are two congruence subgroups such that Γ′ ⊆ Γ. If f is a modular function for Γ′, then f is a modular function for Γ. In particular, if f is a modular function of level N and N |M , then f is also a modular function of level M . Now of course we would like to know if some interesting (non-constant) modular functions exist. It turns out they are not trivial to construct. For example, let us try to naively construct a modular function for PSL2(Z), i.e., a modular function of level 1. Let g(z) = 1 zn for n ∈ Z. Then we can try to average over the PSL2(Z)-translates f (z) = ∑ γ∈PSL2(Z) g(γz) = 1 (γz)n . We can see this diverges just by considering γ of the form ST j. Such γ contribute ∑ j∈Z 1 (ST jz)n = ∑ 1 (S(z + j))n = ∑ 1 (−1/(z + j))n = ∑ j (−1) n(z + j) to the average, but this already diverges. An alternative approach might be the following. Since PSL2(Z) is generated by S (z 7→ −1/z) and T (z 7→ z + 1), we just need to ﬁnd a function invariant under both of them. We know e2πiz is invariant under T , so we could average this over the group ⟨S⟩ = {I, S}. This would give us e 2πiz + e 2πiSz = e2πiz + e−2πi/z. Unfortunately, because of the second term, this is no longer invariant under T . (And if one tries to average over enough of PSL2(Z) to make the sum formally PSL2(Z)-invariant, then it will diverge as in the ﬁrst attempt.) The easiest way to construct nontrivial modular functions will be to use modular forms. We will discuss this in the next section. First, we will present one result about nontrivial modular functions—they cannot be holomorphic! Recall the following result of complex analysis. Theorem 4.1.11. (Open Mapping Theorem) Let U ⊆ C be an open set, and f : U → C be holomorphic and nonconstant. Then f is an open map, i.e., f maps open sets to open sets. Corollary 4.1.12. Let X be a compact Riemann surface, and f : X → C holomorphic. Then f is constant. Proof. What f : X → C holomorphic means is the following. Around any point p ∈ X, there is an open set U such that there is an analytic isomorphism ιU → D with the open unit disc D ⊆ C. For each such p, the map f ◦ ι−1 : D → C is holomorphic at p. Consequently, the Open Mapping Theorem says if f is not constant, f (X) is an open subset of C. However, since f is continuous and X is compact, f (X) is also compact. But there are no open compact subsets of C. Since X0(N ) is compact (as is Γ\\H for any congruence subgroup Γ), there are no nonconstant holomorphic modular functions of level N (or for any congruence subgroup Γ). In fact, since the torus C/\\Λ is also a compact Riemann surface for a lattice Λ, the above corollary also tells us there are no nonconstant holomorphic elliptic functions with respect to Λ. 42 4.2 Eisenstein series Even though we couldn’t construct modular functions by an averaging process like we could for elliptic functions, the theory of elliptic functions does provide a subtle hint for constructing modular functions. Recall that for a lattice Λ ⊂ C, the ﬁeld of elliptic functions with respect to Λ was generate by the associate ℘-function and its derivative ℘′. We constructed ℘′ by an simple averaging technique, but the construction of ℘ was more complicated. Consequently, one might ask if the derivatives of modular functions are simpler to construct than modular functions themselves. Suppose f is a modular function for Γ. Let γ ∈ Γ and write γ = (a b c d ) . Then d dz f (z) = d dz f (γz) = f ′(γz) · d dz (γz) = f ′(γz) · d dz az + b cz + d = 1 (cz + d)2 f ′(γz). In other words, f ′ is no longer exactly invariant by Γ, but satisﬁes the transformation law f ′(γz) = (cz + d) 2f ′(z). Similarly if g(z) = f (k)(z), we have g(γz) = (cz + d)2kg(z). As I have suggested, it is easier to construct functions with these transformation properties than those which are strictly invariant under some Γ. Deﬁnition 4.2.1. Let f : H → ˆC be meromorphic and Γ a congruence subgroup of PSL2(Z). Let k ∈ 2N ∪ {0}. If f (γz) = (cz + d) kf (z), γ = ( a b c d ) ∈ Γ, z ∈ H, then f is weakly modular (or a weak modular form) of weight k for Γ. If Γ = Γ0(N ) we say f is weakly modular of weight k and level N . Note the factor cz + d is not quite determined uniquely by a (a b c d ) ∈ PSL2(Z), but only up to ±1. However since k is assumed to be even, this creates no ambiguity in the deﬁnition above. The adjective “weak” here refers to the fact that there is no condition at the cusps, like we had for modular functions. (One can deﬁne weak modular forms, and modular forms, of odd weight k, just by replacing PSL2(Z) with SL2(Z). However for the same reason, they will not exist unless Γ ⊆ SL2(Z) is a suﬃciently small congruence subgroup such that γ ∈ Γ =⇒ −γ ̸∈ Γ, or equivalently −I ̸∈ Γ. This rules out the case of modular groups Γ0(N ) viewed as subgroups of SL2(Z), but not Γ1(N ) or Γ(N ). Since our main focus in this course is modular forms for Γ0(N ), we will not have much reason to consider these forms of odd weight.) Lemma 4.2.2. Suppose f (resp. g) is weakly modular of weight k (resp. l) for Γ. (i) If k = l and c ∈ C, then cf + g is weakly modular of weight k = l for Γ. Hence weakly modular functions of weight k form a complex vector space. (ii) f · g is weakly modular of weight k + l for Γ. (iii) f g is weakly modular of weight k − l for Γ provided g ̸≡ 0. 43 The proof is immediate. Consequently, if we can construct two diﬀerent weak modular forms of weight k for some k, then their quotient will be a nontrivial weak modular form of weight 0, which is a modular function provided the condition of meromorphic at the cusps is satisﬁed. We will come back to the condition at the cusps later, and use this to deﬁne meromorphic and holomorphic modular forms. For now, we will show how to construct weak modular forms of even weight k > 2. The idea is basically to take a weighted average of some function g(z) : H → ˆC over a congruence subgroup Γ. To explain this, for γ ∈ PSL2(Z), we deﬁne the automorphy factor j(γ, z) : PSL2(Z) × H → ˆC to be j(γ, z) = cz + d, γ = (a b c d ) . (4.4) (As we remarked after Deﬁnition 4.2.1, j(γ, z) is only deﬁned up to ±1, but as we will raise this to an even power, this causes no ambiguity.) For k even, consider the average f (z) = ∑ γ∈Γ 1 (cz + d)k g(γz) = ∑ γ∈Γ j(γ, z) −kg(γz). Then we formally have f (γ0z) = ∑ γ∈Γ j(γ, γ0z)−kg(γγ0z). Now we will need the following property of the automorphy factor. Lemma 4.2.3. For γ, γ′ ∈ PSL2(Z), we have j(γγ′, z) = ±j(γ′, z)j(γ, γ′z). Proof. Observe that (3.1) implies Im(γz) = Im(z) |j(γ, z)|2 . Hence Im(z) |j(γγ′, z)|2 = Im(γγ′z) = Im(γ′z) |j(γ, γ′z)|2 = Im(z) |j(γ, γ′z)j(γ′, z)|2 . This shows the lemma is true up to taking absolute values. Thus the lemma follows from the following claim: Suppose f and g are meromorphic functions with |f (z)|2 = |g(z)|2. Then f (z) = ζg(z) where |ζ| = 1. We may assume g ̸≡ 0. The hypothesis just says f f = gg, i.e., f /g = g/f . Hence the image of the meromorphic function f /g is contained in the set of z ∈ C such that z = 1/z, i.e., |z|2 = 1. By the Open Mapping Theorem (restrict to an open set where f /g is holomorphic), this is impossible unless f /g is constant. Then the absolute value condition implies f (z) = ζg(z) where |ζ| = 1. This means j(γγ′, z) = ζj(γ′, z)j(γ, γ′z) with |ζ = 1|. Then the fact that j(γ, z) is of the form cz + d where c, d ∈ Z (so e.g., j(γ, z) ∈ Z for z ∈ Z) implies that ζ = ±1. 44 By this lemma, we have f (γ0z) = j(γ0, z)k ∑ γ∈Γ j(γγ0, z)−kg(γγ0z) = j(γ0, z)k ∑ γ∈Γ j(γ, z) −kg(γz) = j(γ0, z) kf (z), where we replaced γ by γγ−1 0 in the middle step. In other words, provided f (z) converges and is meromorphic, f (z) is weakly modular of weight k. However, as alluded to in the last section, averaging over all of Γ will be too much for f (z) to converge. We also brieﬂy toyed with a second idea—start with a periodic function and average over just what we need to yield the weak modularity condition for Γ. Let’s restrict to the case Γ = Γ0(N ) so T ∈ Γ. (Arbitrary Γ ⊇ Γ(N ) can be treated similarly since T N ∈ Γ(N ).) Let P be the subgroup of PSL2(Z) generated by T , i.e., P = ⟨T ⟩ = {( 1 n 0 1 ) : n ∈ Z } ⊆ Γ0(N ). Note for γ ∈ P , j(γ, z) = 1, so any periodic function g(z) with period 1 satisﬁes the weak modularity condition for T . Thus averaging over P \\Γ0(N ) should, at least formally, yield something which is weakly modular. First let’s describe this coset space. Lemma 4.2.4. A complete set of representatives for P \\Γ0(N ) is parametrized by the set {(c, d) ∈ Z 2 : c ≡ 0 mod N, gcd(c, d) = 1 } / ± 1, where a coset representative with parameter (c, d) can be taken uniquely in the form ( a b c d ) ∈ Γ0(N ) with 0 ≤ b < |d|, or ( a b c d ) = S if (c, d) = ±(1, 0) and N = 1. Proof. Let γ = ( a b c d ) ∈ Γ0(N ), so ad − bc = 1 and c ≡ 0 mod N . We can replace γ with the element ( 1 n 0 1 ) ( a b c d ) = ( a + cn b + dn c d ) which lies in the same right P -coset of Γ0(N ) as γ. First suppose d = 0. Then −bc = 1 so we may assume b = −c = 1, which can only happen if N = 1. Choosing n = −a shows γ ∈ P ( 0 1 −1 0 ) . Now suppose d ̸= 0. Then we may (uniquely) choose n such that 0 ≤ b + dn < |d|. Consequently we may assume 0 ≤ b < |d|. On the other hand, the determinant condition says a = 1+bc d ∈ Z, i.e., bc ≡ −1 mod d. This determines b, and consequently a, uniquely. So one idea might be to average the function e2πiz over this coset space, but again there are some issues with convergence. However, there’s a simpler periodic function we could use—a constant function! In the k = 0 case, this obviously diverges, but if k ≥ 4, it will converge. 45 Deﬁnition 4.2.5. Let k ≥ 4 be even. The (normalized) Eisenstein series of weight k and level N is deﬁned to be Ek,N (z) = ∑ γ∈P \\Γ0(N ) j(γ, z) −k = 1 2 ∑ (c,d)∈Z2 gcd(c,d)=1 c≡0 mod N 1 (cz + d)k . If N = 1 we often write Ek for Ek,N . Note the second expression for Ek,N in the deﬁnition follows (formally) from the above lemma, and the factor of 1 2 comes from the fact that we include both (c, d) and (−c, −d) in the sum. Proposition 4.2.6. The Eisenstein series Ek,N converges absolutely and uniformly on compact subsets of H. Therefore, Ek,N is a weak modular form of weight k and level N which is holomorphic on H. Proof. The discussion above shows that Ek,N transforms formally under Γ0(N ) as it should. Specif- ically, for γ0 ∈ Γ0(N ), we have Ek,N (γ0z) = ∑ γ∈P \\Γ0(N ) j(γ, γ0z)−k = j(γ0, z)k ∑ γ∈P \\Γ0(N ) j(γγ0, z) −k. Since right multiplying P \\Γ0(N ) by γ−1 0 simply permutes the cosets P \\Γ0(N ), we may replace γ by γγ−1 0 in the sum to see Ek,N (γ0z) = j(γ0, z) kEk,N (z). (4.5) Now let’s deal with convergence. Since the series Ek,N for N > 1 is a sum over a strictly smaller set of terms than the series for Ek = Ek,1, it suﬃces to prove absolute convergence for Ek(z). First suppose z lies in the standard fundamental domain F for PSL2(Z). Then |cz + d| 2 = (cz + d)(cz + d) = c 2|z| 2 + 2cdRe(z) + d 2. Since z ∈ F, |z| ≥ 1 and Re(z) ≤ 1 2 so |cz + d| 2 ≥ c 2 − |cd| + d 2 = { |cζ3 + d|2 cd > 0 |cζ3 − d|2 cd < 0. Hence for z ∈ F, |Ek(z)| ≤ ∑ c,d≥0 gcd(c,d)=1 1 |cζ3 + d|k + ∑ c≥0, d≤0 gcd(c,d)=1 1 |cζ3 − d|k = 2 ∑ c,d≥0 gcd(c,d)=1 1 |cζ3 + d|k . Note that {cζ3 + d : c, d ∈ Z} form the lattice in C generated by 1 and ζ3. Now we want to solve the lattice point problem of estimating how many (c, d) ∈ Z2 there are such that cζ3 + d lies inside the open disc Dr of radius r centered at the origin, i.e., bound the number of (c, d) such that |cζ3 + d| < r. Observe that if |c| ≥ 2r, then |Im(cζ3 + d)| = |Im(cζ3)| = |c| √3 2 > r, i.e., cζ3 + d ̸∈ Dr. Similarly, looking at real parts show if |c| < 2r then we must have |d| < 2r if cζ3 + d ∈ Dr. I.e., the number 46 of (c, d) such that |cζ3 + d| ∈ Dr is at most 4r2. In particular, the number of (c, d) such that |cζ3 + d| ∈ Dr+1 − Dr is at most 4(r + 1)2, and we can bound |Ek(z)| ≤ ∑ (c,d)∈Z2 (c,d)̸=(0,0) 1 |cζ3 + d|k ≤ ∑ (c,d)∈Z2 r≤|cζ3+d|<r+1 1 rk ≤ ∞∑ r=1 4(r + 1)2 rk , which converges for k > 3. This establishes absolute convergence on F. Then the formal identity (4.5) implies we have absolute convergence at any point in H. Namely we can write any point of H as γz for some γ ∈ PSL2(Z) and z ∈ F. Thus (4.5) says |Ek(γz)| = |j(γ, z)kEk(z)|. Since the bound above in F is independent of z, i.e., Ek(z) is a bounded function on F, it also implies uniform convergence of Ek(z) and Ek,N (z) on F. For Ek(z) this implies uniform convergence on compact sets of H by the transformation property of Ek(z) since for a ﬁxed γ, j(γ, z) is uniformly bounded on compact sets. Because the tail of a series for Ek,N (z) can be bounded by the tail of a series for Ek(z), this also implies Ek,N (z) is uniformly bounded on compact subsets. The theory of normal families or normal convergence in complex analysis says that if a series of analytic functions converges absolutely and uniformly on compact subsets, the limit function is also analytic. This ﬁnishes the proposition. For the future, let us record one more thing we got out of the above proof. Corollary 4.2.7. Ek,N (z) is bounded on the standard fundamental domain for PSL2(Z). In par- ticular, Ek,N (z) is bounded as z → i∞. Proof. The ﬁrst statement comes directly from the proof. On the other hand, if Imz > 1, then T jz ∈ F for some j. Therefore Ek,N (z) = j(T j, z)−kEk,N (T jz) = Ek,N (T jz) is also bounded. This says Ek(z) (as well as Ek,N (z)) should be “holomorphic at i∞.” Once we deﬁne holomorphy at the cusps in the next section, we will see these Eisenstein series are holomorphic at all cusps, making them holomorphic modular forms. One interesting and elementary aspect of Eisenstein series is their Fourier expansion. Since Ek,N (z + 1) = Ek,N (z), it has a Fourier expansion Ek,N (z) = ∞∑ n=0 anqn, q = e2πiz. Here the sum starts from n = 0 since Ek,N (z) is holomorphic at i∞. The idea is to use the following. Lemma 4.2.8. (Lipschitz’ formula) Let k ≥ 2 and z ∈ H. Then ∑ n∈Z 1 (z + n)k = Ck ∞∑ n=1 nk−1qn where Ck = (−2πi)k (k − 1)! . 47 Proof. Recall the product formula for sine: sin πz = πz ∞∏ n=1 ( 1 − z2 n2 ) . Taking the logarithmic derivative of this gives π cot πz = 1 z + ∞∑ n=1 ( 1 z + n + 1 z − n ) . (4.6) (Writing the cotangent formula this way as opposed to ∑ n∈Z 1 z+n gives a series which is absolutely convergent.) On the other hand, since sin(πz) = Im(πz) = eπiz−e−πiz 2i and cos(πz) = Re(πz) = eπiz+e−πiz 2 , we have π cot πz = πi eπiz + e−πiz eπiz − e−πiz = πi e2πiz + 1 e2πiz − 1 = πi q + 1 q − 1 = πi − 2πi 1 − q = πi − 2πi ∞∑ n=0 qn. Taking the (k − 1)-st derivative of each of these expressions for π cot πz gives the lemma. Comparing Ek,N (z) = 1 2 ∑ (c,d)∈Z2 gcd(c,d)=1 c≡0 mod N 1 (cz + d)k with Lipschitz’ formula, it would appear easier to compute the Fourier expansion for Ek,N (z) without the condition that gcd(c, d) = 1 in the above sum. For simplicity, let’s ﬁrst consider the case of full level, i.e., N = 1. Deﬁne Gk(z) = ∑ (0,0)̸=(c,d)∈Z2 1 (cz + d)k = ∞∑ n=1 ∑ (c,d)∈Z2 gcd(c,d)=n 1 (cz + d)k = ∞∑ n=1 1 nk ∑ (c,d)∈Z2 gcd(c,d)=1 1 (cz + d)k = 2ζ(k)Ek(z), where ζ(s) = ∑ 1 ns for Re(s) > 1 is the Riemann zeta function. Since Gk(z) is just a scalar multiple of Ek(z), we also call Gk(z) an (unnormalized) Eisenstein series. (In fact, in most classical treatments, one deﬁnes Gk(z) before Ek(z).) 48 Now applying the Lipschitz formula, we have Gk(z) = ∑ (0,0)̸=(c,d)∈Z2 1 (cz + d)k = ∑ d̸=0 1 dk + 2 ∞∑ c=1 ∑ d∈Z 1 (cz + d)k = 2ζ(k) + 2Ck ∞∑ c=1 ∞∑ n=1 nk−1e2πiczn = 2ζ(k) + 2Ck ∞∑ c=1 ∞∑ n=1 nk−1qcn. Then what is the coeﬃcient of a given qm? There is a contribution from nk−1qcn whenever cn = m, hence it is 2Ckσk−1(m) where σk(m) is the classical divisor function σk(m) = ∑ d|m d k. This establishes the following Fourier expansion. Proposition 4.2.9. Let k ≥ 4 be even. Then we have the following Fourier expansion for the Eisenstein series of weight k. Gk(z) = 2ζ(k) + 2Ck ∞∑ n=1 σk−1(n)qn. In terms of the normalized Eisenstein series, we can write this as Ek(z) = 1 − 2k Bk ∞∑ n=1 σk−1(n)qn, where Bk is the k-th Bernoulli number. We recall the Bernoulli numbers can be deﬁned as the coeﬃcients in the expansion x ek − 1 = ∑ k=0 Bk xk k! . Alternatively we can deﬁne them recursively by B0 = 0 and Bk = − k−1∑ j=0 (k j ) Bj k − j + 1 . Exercise 4.2.10. Check these two deﬁnitions of Bk are equivalent. Proof. We already derived the expansion for Gk(z). Dividing by 2ζ(k) and using Euler’s formula ζ(k) = − CkBk 2k gives the expansion for Ek(z). 49 The fact that the Fourier coeﬃcients of Eisenstein series are divisor functions—objects of study in elementary number theory—is our ﬁrst real evidence that modular forms and functions are important in number theory. Later, we can use the theory of modular forms to prove results about these divisor functions, as well as relate them to problems in quadratic forms, as we discussed in the introduction. At this point we can say why the Ek are called normalized Eisenstein series—they are normalized so that their leading Fourier coeﬃcient is 1. Since z = i∞ corresponds to q = 0, the 0-th Fourier coeﬃcient gives us the “value” of a period function at i∞, i.e., means Ek(i∞) = 1. Example 4.2.11. E4(z) = 1 + 240 ∞∑ n=1 σ3(n)qn. E6(z) = 1 − 504 ∞∑ n=1 σ5(n)qn. E8(z) = 1 + 480 ∞∑ n=1 σ7(n)qn. Exercise 4.2.12. From the ﬁrst few examples, it looks like the Fourier coeﬃcients for Ek might always be integers. This is not true (though they are clearly rational from Proposition 4.2.9). Find the ﬁrst even k such that 2k Bk ̸∈ Z. *Exercise 4.2.13. We deﬁne the j-invariant to be j(z) = 1728 E4(z)3 E4(z)3 − E6(z)2 . Use the Fourier expansions for Ek to show j is a nonconstant modular function for PSL2(Z). Since isomorphism classes of (generalized) elliptic curves are parametrized by X0(1) = PSL2(Z)\\H, this gives a (nontrivial) invariant for elliptic curves which varies smoothly in the parameters deﬁning the curve. Remark. While it is obvious that Ek cannot converge if k = 0, it is natural to ask what happens if k = 2. The sum does not converge absolutely, but if we specify the order of summation, we can get a convergent function. Exercise 4.2.14. Deﬁne E2(z) = 1 2ζ(2) ∞∑ c=−∞ ( ∞∑ d=−∞ ′ 1 (cz + d)2 ) , where the prime on the inner sum means we omit the term d = 0 when c = 0. (a) Using Lipshitz’ formula on the inner sum ﬁrst, show E2(z) converges absolutely. (b) Show E2(z) = 1 − 24 ∞∑ n=1 σ1(n)qn. 50 However E2(z) is not quite modular. It can be shown (e.g., [Kob93, p. 113]) that E2(−1/z) = z2E2(z) + 12 2πiz . Now let us consider the case of higher level. The naive generalization to level N would be to consider Gk,N (z) = ∑ (0,0)̸=(c,d)∈Z2 c≡0 mod N 1 (cz + d)k = ∞∑ n=1 ∑ (c,d)∈Z2 c≡0 mod N gcd(c,d)=n 1 (cz + d)k , (4.7) but we can’t write this in terms of Ek,N (z) as simply as we did when N = 1. The reason is if we rewrite the inner sum on the right as gcd(c, d) = 1 and factor out a n−k, we break the condition c ≡ 0 mod N if gcd(n, N ) ̸= 1. Let’s see what happens when N = p is prime. Then Gk,p(z) = ∑ (0,0)̸=(c,d)∈Z2 c≡0 mod p 1 (cz + d)k = ∑ (c,d)∈Z2 c≡0 mod p gcd(d,p)=1 1 (cz + d)k + ∑ (0,0)̸=(c,d)∈Z2 c≡d≡0 mod p 1 (cz + d)k = G∗ k,p(z) + 1 pk Gk(z), where G∗ k,p(z) = ∑ (c,d)∈Z2 c≡0 mod p gcd(d,p)=1 1 (cz + d)k = ∑ n>0 gcd(n,p)=1 ∑ (c,d)∈Z2 c≡0 mod p gcd(c,d)=n 1 (cz + d)k = ∑ n>0 gcd(n,p)=1 1 nk ∑ (c,d)∈Z2 c≡0 mod p gcd(c,d)=1 1 (cz + d)k = 2L(k, 1p)Ek,p(z) and L(s, 1p) is the Dirichlet series associated to the trivial character mod p, i.e., for Re(s) > 1, L(s, 1p) = ∑ n>0 gcd(n,p)=1 1 ns = ∞∑ n=1 1 ns − ∞∑ n=1 1 (pn)s = ( 1 − 1 ps ) ζ(s). 51 In summary, we have Ek,p(z) = ( 1 − 1 pk )−1 1 2ζ(k) G∗ k,p(z) and G∗ k,p(z) = Gk,p(z) − 1 pk Gk(z). Since we already know the Fourier expansion for Gk(z), it suﬃces to determine the Fourier expansion for Gk,p(z). This is similar to the expansion for Gk(z): Gk,p(z) = ∑ (0,0)̸=(c,d)∈Z2 c≡0 mod p 1 (cz + d)k = ∑ d̸=0 1 dk + 2 ∞∑ c=1 ∑ d∈Z 1 (cpz + d)k = 2ζ(k) + 2Ck ∞∑ c=1 ∞∑ n=1 nk−1e2πicpzn = 2ζ(k) + 2Ck ∞∑ c=1 ∞∑ n=1 nk−1qcpn = 2ζ(k) + 2Ck ∞∑ n=1 σk−1(n)qpn. Putting everything together yields the following Proposition 4.2.15. Let N = p be prime, and k ≥ 4 even. Then G∗ k,p(z) = 2 ( 1 − 1 pk ) ζ(k) + 2Ck ∞∑ n=1 ( σk−1(n/p) − σk−1(n) pk ) qn and Ek,p(z) = 1 − 2k Bk (1 − 1 pk )−1 ∞∑ n=1 ( σk−1(n/p) − σk−1(n) pk ) qn. (Here σk−1(n/p) = 0 if n/p ̸∈ Z.) *Exercise 4.2.16. Work out the Fourier expansion for Ek,N (z) when N = 4 and k ≥ 4 even. Speciﬁcally, show Gk,4(z) = G∗ k,4(z) + 1 2k Gk,2(z) where G∗ k,4(z) = ∑ c≡0 mod 4 d odd 1 (cz + d)k = ( 1 − 1 2k ) ζ(k)Ek,4(z). Deduce that Ek,4(z) = 1 − 2k Bk (1 − 1 2k )−1 ∞∑ n=1 ( σk−1(n/4) − 1 2k σk−1(n/2) ) qn. (4.8) 52 Comparing Fourier expansions, conclude Ek,4(z) = Ek,2(2z). To treat Eisenstein series of arbitrary level N , we need to break up the inner sum in the right of (4.7) into various pieces depending upon gcd(n, N ). The trick is to use the Möbius function µ(n), i.e., µ(n) = −1 (resp. 1) if n is squarefree and has an odd (resp. even) number of prime factors, and µ(n) = 0 if it is not squarefree. This is an important in the study of multiplicative functions because of Möbius inversion if f and g are multiplicative functions, g(n) = ∑ d|n f (d) implies f (n) = ∑ d|n µ(d)g(n/d). (This is like an arithmetic Fourier transform.) For the sake of time and simplicity, we will not work out the Fourier expansions for arbitrary N , but simply state them and refer to [Sch74] (see also [Boy01], [DS05], [Kob93]) for details. Let σk,N (n) = ∑ d|n µ(N/ gcd(d, N )) ϕ(N/ gcd(d, N )) d k. Then Ek,N (z) = 1 − 2kϕ(N ) N kBk ∏ p|N (1 − 1 pk )−1 ∞∑ n=1 σk−1,N (n)qn. (4.9) Exercise 4.2.17. Check (4.9) agrees with Proposition 4.2.15. We remark that for level N > 1 (or general Γ), one can construct a diﬀerent Eisenstein series for each cusp of Γ0(N ), and we’ll discuss this some in the next chapter. 4.3 Modular forms It is ﬁnally time for us to get to the full deﬁnition of modular forms. What we need to do is reﬁne the notion of weak modularity to include a condition of meromorphy or holomorphy at the cusps. First let’s think about the Eisenstein series Ek (k ≥ 4 even) of full level deﬁned in the previous section, which we said should be modular forms. In this case, the relevant group of transformations is Γ0(1) = PSL2(Z) and there is only one cusp for X0(1). In Corollary 4.2.7, we saw that Ek is bounded as z → i∞, which means that Ek should be “holomorphic at i∞.” Or, thinking in terms of Fourier expansions, we saw Ek(z) = 1 − 2k Bk ∑∞ n=1 σk−1(n)qn, so Ek can be thought of as having the value 1 at z = i∞ (↔ q = 0). On the other hand, any rational number also represents the cusp for X0(1). What happens to Ek(z) as z tends to an element of Q? The weak modularity condition actually forces Ek(z) to be unbounded as z ∈ H approaches a rational number z0. To see this, say γ · i∞ = z0 and write γ = (a b c d ) . Then lim z→z0 Ek(z) = lim z→i∞ Ek(γz) = lim z→i∞ (cz + d)kEk(z) = (c · i∞ + d)k · 1 = ∞, 53 since one cannot have c ̸= 0 if z0 ∈ Q. In other words, while Ek is “holomorphic” at i∞, the weak modularity property (when k ̸= 0) forces it to have a “pole” (which should be of order k) at all z0 ∈ Q. While it perhaps makes sense to say that Ek(z) is meromorphic at the cusp for PSL2(Z) (it has at most a pole of ﬁnite order at each element of {i∞} ∪ Q), it is not clear whether we should think of it as being holomorphic at the cusp. In fact, from what I said above, one might be inclined not to. However, Ek(z) does have a Fourier expansion with no negative terms, and it is as close as possible to being holomorphic at the cusp given the weak modularity transformation property. Bearing this in mind, one deﬁnes holomorphy at a cusp as follows. Similar to the |γ operator we deﬁned in Section 4.1, we can deal with the automorphy factor by considering the operator |γ,k, deﬁned for γ ∈ PSL2(Z) and k ∈ 2Z≥0, which sends any f : H → ˆC to f |γ,k(z) = j(γ, z)−kf (γz) = (cz + d)−kf (γz), (4.10) where γ = ( a b c d ). Note |γ,0 is precisely the operator |γ from Section 4.1. Observe that the weight k weak modular transformation property, f (γz) = j(γ, z)f (z) = (cz + d)kf (z) for γ ∈ Γ, is equivalent to the statement f |γ,k(z) = f (z), γ ∈ Γ. (4.11) In other words, a meromorphic f : H → ˆC is a weak modular form of weight k if and only if (4.11) holds. Consequently, while Ek(z) is not holomorphic at any z0 ∈ Q, it is true that Ek|γ,k(z) is holo- morphic at i∞ for each γ ∈ PSL2(Z). We will call this being holomorphic at the cusp. Or, more generally, we make the following deﬁnition. Recall if f is a meromorphic, periodic function on H with a period N ∈ R, f has a Fourier expansion f (z) = ∑ n∈Z anqn N where qN = e2πiz/N . In Section 4.1, we said such an f is meromorphic at at i∞ if an = 0 for all but ﬁnitely many n < 0, or alternatively, there exists m such that |f (z)| < emy for y = Im(z) ≫ 0. Similarly, we say such an f is holomorphic at i∞ if an = 0 for all n < 0, or equivalently, if f (z) is bounded for y ≫ 0. Deﬁnition 4.3.1. Let f : H → ˆC be a weak modular form of weight k for Γ ⊆ PSL2(Z). We say f is meromorphic (resp. holomorphic) at the cusps if f |τ,k is meromorphic (resp. holomorphic) at i∞ for each τ ∈ PSL2(Z). To see this deﬁnition makes sense, we need to know that f |τ,k is also periodic with real period. Exercise 4.3.2. Let Γ ⊇ Γ(N ) be a congruence subgroup of PSL2(Z) and suppose f is weakly modular of weight k for Γ. Show that f |τ,k(z + N ) = f |τ,k(z) for all τ ∈ PSL2(Z). We would also like to know that to check meromorphy/holomorphy at the cusps, it suﬃces to check it for a single representative of each cusp. This follows from the following generalization of Lemma 4.1.5. For τ ∈ PSL2(Z) and f a weak modular form of weight k for Γ ⊇ Γ(N ), write the Fourier expansion (at i∞) of f |τ,k as f |τ,k(z) = ∑ n∈Z aτ,nqn N , qN = e2πiz/N . 54 We call the aτ,n’s the Fourier coeﬃcients for f with respect to τ . This is perhaps a slight misuse of notation, as, unlike in the case of modular functions, this does not actually give us a series expansion for f (z) in qτ = e2πiτ −1z/N , but rather just an expansion for f |τ,k(z), or if one wishes, j(τ, z)−kf (z). Indeed, f (τ z) will not generally have a real period, so there will not typically be a series expansion for f in terms of powers of qτ . Exercise 4.3.3. Suppose a meromorphic f : H → ˆC is weakly modular of weight k for a congruence subgroup Γ ⊇ Γ(N ). Let z0, z′ 0 ∈ {i∞} ∪ Q represent the same cusp for Γ, i.e., z′ 0 = γz0 for some γ ∈ Γ. Now suppose τ, τ ′ ∈ PSL2(Z) such that τ z0 = τ ′z0 = i∞. (i) Show f |τ,k(z) = f |τ ′,k(z + j) for some j ∈ Z. (ii) Deduce the Fourier coeﬃcients with respect to τ and τ ′ are related by aτ ′,n = aτ,ne2πij/N for all n; in particular |aτ ′,n| = |aτ,n| for all n. Both of these exercises are really no more than verifying the proofs of Lemmas 4.1.4 and 4.1.5 go through in the setting k > 0. Deﬁnition 4.3.4. Let f : H → ˆC be meromorphic, k even, and Γ a congruence subgroup of PSL2(Z). We say f is a meromorphic modular form of weight k for Γ if (i) f is weakly modular of weight k for Γ, i.e., f |τ,k(z) = f (z) for all τ ∈ Γ; and (ii) f is meromorphic at the cusps. Deﬁnition 4.3.5. Let f : H → ˆC be meromorphic, k even, and Γ a congruence subgroup of PSL2(Z). We say f is a (holomorphic) modular form of weight k for Γ if (i) f is weakly modular of weight k for Γ, i.e., f |τ,k(z) = f (z) for all τ ∈ Γ; and (ii) f is holomorphic at the cusps. The space of modular forms of weight k for Γ is denoted Mk(Γ). In other words, if we just say “modular form” we mean holomorphic modular form. This is (fairly) standard terminology (an older term you may sometimes see is “entire modular form”), though terminology for meromorphic modular forms varies is less standardized. For example, they are called modular functions (even though they are not functions on Γ\\H!) by [Kob93] and automorphic forms (even though this does not agree with the standard usage of the term!) by [DS05]. As we have mentioned earlier, the modular forms we will be most interested in are modular forms for the modular groups Γ0(N ). Unless otherwise speciﬁed, we will assume the weight Deﬁnition 4.3.6. If f is a modular form of weight k for Γ0(N ), we say f is a modular form of weight k and level N . The space of such forms is denoted Mk(N ). In other words, the notation Mk(N ) just means Mk(Γ0(N )). Example 4.3.7. For Γ a congruence subgroup, any constant function lies in M0(Γ). Proposition 4.3.8. For k ≥ 4 even, the Eisenstein series Ek,N is a modular form of weight k and level N . 55 Proof. By Proposition 4.2.6, we know Ek,N is weakly modular of weight k and level N , and holomor- phic on H. Hence we just need to show Ek,N is holomorphic at the cusps. (In fact, we already know from Section 4.2 that it is holomorphic at the cusp given by i∞, and that Ek(i∞) = Ek,p(i∞) = 1.) Let τ = (r s t u ) ∈ PSL2(Z) and consider Ek,N |τ,k(z) = 1 2 1 (tz + u)k ∑ (c,d)∈Z2 gcd(c,d)=1 c≡0 mod N 1 (c rz+s tz+u + d )k = 1 2 ∑ (c,d)∈Z2 gcd(c,d)=1 c≡0 mod N 1 (c(rz + s) + d(tz + u)) k = 1 2 ∑ (c,d)∈Z2 gcd(c,d)=1 c≡0 mod N 1 ((cr + dt)z + (cs + du)) k = 1 2 ∑ (c,d)∈Z2 gcd(c,d)=1 c≡0 mod N 1 (c′z + d′)k , where in the last sum we have put c′ = cr + dt and d′ = cs + du. Note we can view T τ = ( r t s u ) as an element of GL2(Z) acting on Z × Z, and T τ (c d ) = (c′ d′ ). Hence the ﬁnal sum runs over a certain subset of pairs (c′, d′) ∈ Z × Z − {(0, 0)}. Thus |Ek,N |τ,k(z)| ≤ 1 2 ∑ (c′,d′)∈Z2−{(0,0)} 1 |c′z + d′|k . However, we already showed this sum on the right is bounded in the proof of Proposition 4.2.6. Proposition 4.3.9. For Γ a congruence subgroup and k ≥ 0 even, Mk(Γ) is a complex vector space. Proof. We show Mk(Γ) is a subspace of the space of holomorphic functions on H. Suppose f ∈ Mk(Γ) and c ∈ C. Then it is clear that cf ∈ Mk(Γ). Similarly, if f, g ∈ Mk(Γ), then f + g clearly satisﬁes the weak modularity condition (cf. Lemma 4.2.2, and f |τ,k, g|τ,k being bounded at i∞ for each τ ∈ PSL2(Z) implies (f + g)|τ,k = f |τ,k + g|τ,k is also bounded at i∞, i.e., f + g is also holomorphic at the cusps. There are two main reasons we work with holomorphic forms, rather than meromorphic forms. The ﬁrst is that restricting to holomorphic forms, the spaces Mk(Γ) are ﬁnite-dimensional vector spaces. (This is also why one needs the condition of being holomorphic at the cusps.) One of the main applications of modular forms, say to the theory of quadratic forms as presented in the introduction, is to construct a modular form in two diﬀerent ways and show that the constructions are equal. Knowing that Mk(Γ) is ﬁnite dimensional means that one can check two modular forms 56 are identical by checking that a ﬁnite number of their Fourier coeﬃcients agree. We will explore these ideas some in the rest of this chapter, and explain this precisely in the next chapter. One simple but important way to construct modular forms is the following. Lemma 4.3.10. Let Γ be a congruence subgroup, and f ∈ Mk(Γ), g ∈ Ml(Γ). Then f g ∈ Mk+l(Γ). Proof. We already observed that f + g is weakly modular of weight k + l in Lemma 4.2.2. Then, as in the previous proof, if f |τ, k and g|τ,l are bounded at i∞, we see (f g)|τ,k+l = (f |τ,k) (g|τ,l) is also bounded at i∞, i.e., f g is also holomorphic at the cusps. The second reason to restrict our study to holomorphic modular forms is that meromorphic modular forms can be simply constructed as quotients of holomorphic modular forms (cf. exercise below), and, at least on the full modular group (cf. [FB09, Exercise VI.3.5]), all meromorphic modu- lar forms arise this way. (If you ﬁnd a reference which discusses this for other congruence subgroups, or has the complete proof for PSL2(Z), please let me know.) If one restricts to meromorphic modu- lar forms of weight 0 for Γ, i.e., modular functions on Γ\\H, then basic function theory for compact Riemann surfaces implies any modular function is a quotient of two elements of Mk(Γ) for some k. We will prove something more precise in the case of Γ = PSL2(Z) later. Exercise 4.3.11. Let Γ be a congruence subgroup, f ∈ Mk(Γ) and g ∈ Ml(Γ). Show f g is a meromorphic modular form of weight k − l provided g ̸≡ 0. Now let’s look at an example of the above lemma. Example 4.3.12. Consider the Eisenstein series E4(z) = 1 + 240 ∞∑ n=1 σ3(n)qn ∈ M4(1). Then E2 4 (z) = 1 + 480 ∞∑ m=1 σ3(m)qm + (240)2 ∞∑ m,n=1 σ3(m)σ3(n)qm+n = 1 + 480 ∞∑ n=1 ( σ3(n) + 120 n−1∑ m=1 σ3(m)σ3(n − m) ) qn ∈ M8(1). On the other hand, E8(z) = 1 + 480 ∞∑ n=1 σ7(n)qn ∈ M8(1). Computing the ﬁrst few Fourier coeﬃcients of E2 4 , E4(z)2 = 1 + 480 (q + 129q2 + 2188q3 + · · ·) , we see the ﬁrst several Fourier coeﬃcients of E2 4 match with those of E8. This suggests E2 4 = E8, 57 which implies the sum-of-divisors identity σ7(n) = σ3(n) + 120 n−1∑ m=1 σ3(m)σ3(n − m). In particular, this would mean σ7(n) ≡ σ3(n) mod 120. In the next chapter, we will see that M8(1) is 1 dimensional, so just knowing the 0-th Fourier coeﬃcients (the “constant terms”) match is enough to deduce E2 4 = E8. While one can prove this and similar sum-of-divisors identities with just elementary number theory, it is not at all simple. 4.4 Theta series The motivation we presented in the introduction for studying modular forms is the application to the theory of quadratic forms, though we have also seen that they arise in connection with the function theory of the modular curves X0(N ). (The reader may want to reread the introduction at this point.) The passage from quadratic forms to modular forms comes via theta series. Jacobi seems to have begun the study theta functions in connection with elliptic functions. Speciﬁcally, in 1829, he obtained an expression for the Weierstrass ℘-functions in terms of theta functions. This has become important in mathematical physics. However, our interest in theta functions will be in relation to modular and quadratic forms. Recall from the introduction, Jacobi’s theta function ϑ(z) = ∞∑ n=−∞ qn2, (4.12) where, as usual, q = e2πiz. Thinking of this as a power series in the parameter q, it is clear this series converges absolutely and uniformly on compact sets in H, hence it is a meromorphic function on H with period 1 (w.r.t. z). Then ϑk(z) = k∏ i=1 ( ∞∑ ni=−∞ qn2 i ) = ∑ n1,...,nk∈Z qn2 1+n2 2+···+n2 k = ∑ n≥0 rk(n)qn, (4.13) where rk(n) is the number of ways to write n as a sum of k squares, i.e., rk(n) = # { (x1, . . . , xk) ∈ Z k : x2 1 + x2 2 + · · · + x 2 k = n} . In other words, the Fourier coeﬃcients of ϑk tell us the number of ways n can be written as a sum of k squares. We would like to say this is a modular form. Proposition 4.4.1. Jacobi’s theta function satisﬁes the transformation laws ϑ(z + 1) = ϑ(z), ϑ ( −1 4z ) = √ 2z i ϑ(z). (4.14) 58 Proof. The ﬁrst equation is obvious from the deﬁnition as q is invariant under z 7→ z + 1. The idea to prove the second equation is to use Poisson summation, which says for any Schwartz function (i.e., rapidly decreasing function) f : R → R, we have ∑ n∈Z f (n) = ∑ n∈Z ˆf (n), where ˆf (t) = ∫ ∞ −∞ e 2πistf (s)ds is the Fourier transform of f . (See any introduction to Fourier analysis for a proof of Poisson summation, which is a simple consequence of Fourier inversion.) Note that we can write (for ﬁxed z ∈ H) ϑ(z) = ∑ n∈Z f (n) where f (t) = e2πizt2. Now we will assume z = iy with y > 0, so that f (t) = e−2πyt2 is Schwartz. We compute ˆf (t) = ∫ ∞ −∞ e 2πi(st+s2z)ds. Completing the square, we see s2z + st = z ( s + t 2z )2 − t2 4z Let u = (s + t/2z). Then ˆf (t) = e−πit2/2z ∫ ∞ −∞ e2πizu2du = eπt2/2y ∫ ∞ −∞ e −2πyu2du = √ 1 2y e πt2/2y. Here the last equality follows from the substitution v = √2yu, which reduces the problem to the well known Gaussian integral ∫ ∞ −∞ e−πv2dv = 1. Now applying Poisson summation proves ϑ ( −1 4z ) = √ 2z i ϑ(z) when z = iy. However, since both sides are holomorphic functions, knowing they agree on a set with an accumulation point implies they agree everywhere. Lemma 4.4.2. Γ0(4) is generated by T and ̃T = ( 1 0 4 1 ) . 59 Proof. Suppose γ = ( a b c d ) ∈ Γ0(4). Note γT k = (a b + ka c d + kc ) . Since gcd(a, c) = 1 but c ≡ 0 mod 4, we know a is odd. In particular a ̸= 0, so by replacing γ by some γT k, we may assume |b| ≤ |a| 2 . Further, a odd means |b| ̸= |a| 2 , i.e., |b| < |a| 2 . On the other hand, γ ̃T k = (a + 4kb b c + 4kd d ) . If |b| ̸= 0, note |a + 4kb| < 2|b| for some k ∈ Z, so we upon replacing γ by γ ̃T k, we may assume |a| < 2b. Continuing in this manner of replacing γ by elements of the form γT k and γ ̃T k alternately, we eventually reduce to the situation b = 0 by Fermat descent. (Observe in the above replacements, when we reduce |b| we do not change a, and when we reduce |a| we do not change b, so this process terminates in a ﬁnite number of steps.) But if b = 0, by the determinant condition and the deﬁnition of Γ0(4), we know that (up to ±1) γ must be of the form ( 1 0 4k 1 ) = ̃T k. The following exercise is a simple consequence of Lemma 4.2.3. Exercise 4.4.3. Suppose Γ = ⟨γ1, . . . , γr⟩ and let f : H → ˆC be meromorphic. Show that if f (γiz) = j(γi, z)kf (z) for i = 1, . . . , r, then f is weakly modular of weight k for Γ. Proposition 4.4.4. Let k ∈ N such that k ≡ 0 mod 4. Then ϑk ∈ Mk/2(4). Proof. We know ϑk is holomorphic on H because ϑ is. By the above lemma and exercise, to show ϑk is weakly modular of weight k 2 for Γ0(4), it suﬃces to show ϑk(z + 1) = ϑk(T z) = j(T, z) k/2ϑk(z) = ϑk(z) and ϑk ( z 4z + 1 ) = ϑk( ̃T z) = j( ̃T , z)k/2ϑk(z) = (4z + 1)k/2ϑk(z). The former is clear, since ϑ(z + 1) = ϑ(z). To see the second, put w = z 4z+1 and observe the second 60 part of (4.14) implies ϑk ( z 4z + 1 ) = ϑk(w) = ( i 2w )k/2 ϑk ( −1 4w ) = ( i 2w )k/2 ϑk (−1 − 1 4z ) = ( i 2w )k/2 ϑk ( −1 4z ) = ( i 2w )k/2 ( 2z i )k/2 ϑk(z) = (4z + 1)k/2ϑk(z). Thus it remains to show ϑk is holomorphic at the cusps. By Corollary 3.4.4, we can take for a set of representatives of PSL2(Z)/Γ0(4) the elements I, S, ST S = ( 1 0 −1 1 ) , T 2S = ( 2 −1 1 0 ) . We know ϑ is holomorphic at i∞ by its Fourier expansion, so we need to show f |γ,k/2 is holomorphic at i∞ for γ = S, ST S and T S. Note by (4.14) we have ϑk|S,k/2(z) = ( 1 z )k/2 ϑk ( −1 z ) = ( 1 z )k/2 ( z 2i )k/2 ϑk ( z 4 ) = ( 1 2i )k/2 ϑk ( z 4 ) , which is holomorphic at i∞ since ϑk(z) is. We leave the cases of γ = ST S and γ = T S as an exercise. Exercise 4.4.5. Complete the proof of the above proposition by showing that ϑk|γ,k/2 is holomorphic at i∞ for γ = ST S and γ = T 2S. (Here k ∈ N with k ≡ 0 mod 4.) One might like to say that ϑk is a modular form of odd weight when k ≡ 2 mod 4, and a modular form of half-integral weight when k is odd. These notions can be made precise, but the transformation group can no longer be Γ0(4) (see parenthetical remarks after Deﬁnition 4.2.1). We will not treat the theory of modular forms of odd or half-integral weights in this course (see, e.g., [Kob93]), but leave the case of ϑk when k ≡ 2 mod 4 as an exercise. Exercise 4.4.6. Let Γ be a ﬁnite index subgroup of SL2(Z). Then for γ ∈ Γ, j(γ, z) is well deﬁned (not just deﬁned up to ±1). Let k ∈ Z. We say a holomorphic function f : H → C is a modular form of weight k for Γ, if f |γ,k(z) = f (z) for all γ ∈ Γ and z ∈ H, and f |τ,k(z) is holomorphic at i∞ for all τ ∈ SL2(Z). (a) Suppose −I ∈ Γ. Show there are no nonzero modular forms of odd weight for Γ. (b) Consider Γ = {( a b c d ) ≡ ( 1 b 0 1 ) mod 4 } ⊂ SL2(Z), i.e., Γ = Γ1(4) viewed as a subgroup of SL2(Z) (not PSL2(Z)). For any k ≥ 2 even, show ϑk is a modular form of weight k/2 for Γ. 61 Example 4.4.7. From the above proposition, we know ϑ8(z) = 1 + 16q + 112q2 + 448q3 + · · · ∈ M4(Γ0(4)). (There is 1 way to write 0 as a sum of 4 squares, 16 ways to write 1 = (±1)2 + 02 + 02 + · · · + 02 as a sum of 8 squares counting symmetries, and so on.) From Exercise 4.2.16, we know E4,4(z) = 1 + 16 ∞∑ n=1 (16σ3(n/4) − σ3(n/2)) qn = 1 − 16q2 + 112q4 − · · · ∈ M4(4). We also have E4,2(z) = 1 + 16 ∞∑ n=1 (16σ3(n/2) − σ3(n)) qn = 1 − 16q + 112q2 − 448q3 + · · · ∈ M4(2) ⊆ M4(4) and E4(z) = 1 + 240 ∞∑ n=1 σ3(n)qn = 1 + 240 (q + 9q2 + 28q3 + · · ·) ∈ M4(1) ⊆ M4(4). Assuming these three Eisenstein series give a basis for M4(4) (they do, as we will see in the next chapter), so a little linear algebra on the ﬁrst three coeﬃcients of the Fourier expansions shows ϑ8(z) = 1 16 E4(z) − 1 16 E4,2(z) + E4,4(z). Comparing Fourier expansions shows r8(n) = 16 (σ3(n) − 2σ3(n/2) + 16σ3(n/4)) . Besides completing a proof of the above result in the next chapter, we will study r2k(n) for other values of k later in the course. Another classical example of a theta series comes from asking about representing numbers as sums of triangular numbers. Recall the n-th triangular number is n(n+1) 2 , which is the number of entries in the ﬁrst n rows of Pascal’s triangle. Let δk(n) be the number of ways n is a sum of k triangular numbers, i.e., δk(n) = # {(x1, · · · , xk) ∈ Z k ≥0 : x1(x1 + 1) 2 + x2(x2 + 1) 2 + · · · + xk(xk + 1) 2 = n. } Let ψ(z) = q1/8 ∞∑ n=0 q n(n+1) 2 . Then ψk(z) = qk/8 ∞∑ n=0 δk(n)qn. Proposition 4.4.8. Suppose k ≡ 0 mod 8. Then ψk(z) ∈ Mk/2(4). 62 In the interest of time, we will not prove this now, but may give a proof at a later time. However, the point for now is it allows one to do the following exercise. *Exercise 4.4.9. (i) Compute δ8(n) for n = 0, 1, 2, 3. (ii) Assuming E4, E4,2 and E4,4 is a basis for M4(4), determine a, b, c ∈ Q such that ψ8(z) = aE4 + bE4,2 + cE4,4. (iii) Using (ii), show δ8(n) = σ♯ 3(n + 1) where σ♯ m(n) = ∑ d|n n/d odd dm. We remark that for a general positive deﬁnite quadratic form Q in r variables over Z, one can associate the theta series ΘQ(z) = ∞∑ n=0 rQ(n)qn, where rQ(n) denotes the number of solutions to Q(x1, . . . , xr) = n in Zr. One can write Q(x1, . . . , xr) = 1 2 (x1 x2 · · · xr) A      x1 x2 ... xr  | | |  , where A ∈ Mr×r(Z) is symmetric with det A > 0, and the diagonal entries of A are even. Let N ∈ N be minimal such that N A−1 ∈ Mr×r(Z) with even diagonal entries. Then one can show ΘQ(z) ∈ Mk/2(Γ1(N )). 4.5 η and ∆ About half a century after Jacobi’s began the theory of theta functions, Dedekind introduced a similar kind of function, which has played an important role in the theory of modular forms. Deﬁnition 4.5.1. The Dedekind eta function η : H → C is given by η(z) = q1/24 ∞∏ n=1 (1 − qn) . The factor q1/24 may seem curious at ﬁrst, as with the factor q1/8 in the deﬁnition of ψ in the previous section, but it is needed to get the desired transformation laws. Namely, we have Proposition 4.5.2. The function η is a holomorphic function on H satisfying the transformation properties η(z + 1) = η(z), η ( −1 z ) = √ z i η(z). 63 Proof. To see that it is holomorphic, it suﬃces to show the product converges absolutely and uniformly on compacts sets in H, which is equivalent to doing the same for log η(z) = log q1/24 + ∞∑ n=1 log(1 − qn) = πiz 12 + ∞∑ n=1 log(1 − qn). Recall z ∈ H corresponds to q = e2πixe−2πy in the region 0 < |q| < 1. Using the Taylor expansion for log(1 − x) = − ∑∞ j=1 xj j , we see if x = |q| then \f \f \f \f \f ∞∑ n=1 log(1 − qn) \f \f \f \f \f ≤ ∞∑ n=1 ∞∑ j=1 xnjj = ∞∑ n=1 σ−1(n)xn where σ−1(n) is the sum of the reciprocals of divisors of n. In particular, this is less than ∑∞ n=1 nxn, which we know converges (say by the ratio test) absolutely with a uniform bound for x lying in a compact subset of (0, 1). This establishes holomorphy. The transformation η(z + 1) = η(z) is evident since q is invariant under z 7→ z + 1. There are many ways to obtain the second identity, and we follow [Els06], which gives a proof suggested by Petersson. Since both sides are analytic, it suﬃces to prove logarithmic derivative of both sides of the desired identity are equal, i.e., 1 z2 η′(−1/z) η(−1/z) = d dz log η ( −1 z ) = d dz log √ z i η(z) = √ z i η′(z) − i 2 √ i z η(z) √ z i η(z) = η′(z) η(z) + 1 2z . Let τ ∈ H and consider the lattice Λ = ⟨1, τ ⟩. One deﬁnes the associated Weierstrass zeta function ζ(s; Λ) = 1 s + ∑ (m,n)∈Z2 (m,n)̸=(0,0) ( 1 s + mτ + n − 1 mτ + n + s (mτ + n)2 ) Using Euler’s expression (4.6) for cotangent, and a similar one for csc2, we have ζ(s; Λ) = π2 3 s + π cot πs + ∑ m̸=0 (π cot π(mτ + s) − π cot πmτ + π2s csc2 πmτ ) . Consequently, we have ϕ1(τ ) := ζ ( 1 2 ; Λ ) = ( π2 6 + π2 ∞∑ m=1 csc2 πmτ ) and ϕ2(τ ) := ζ ( τ 2 ; Λ ) = τ ϕ1(τ ) + 1 2 . On the other hand, the deﬁnition of ζ(z; Λ) implies ϕ2(τ ) = 1 τ ϕ1 ( −1 τ ) . 64 Comparing the previous two equations yields 1 τ ϕ1 ( −1 τ ) = τ ϕ1(τ ) + 1 2 . Note our expression for ϕ1 combined with the Fourier expansion csc2 πz = −4 ∑∞ n=1 nqn gives ϕ1(z) = −2πi η′(z) η(z) (cf. Exercise below). But now the previous transformation property for ϕ1 gives us precisely the desired identity for η′(z) η(z) . Exercise 4.5.3. (a) Determine the q-expansion for η′(z) η(z) . (b) Check ϕ1(z) = −2πi η′(z) η(z) as asserted in the proof above. We remark that had we proved the functional equation for the (pseudo-)Eisenstein series E2 stated in Exercise 4.2.14, one can derive the transformation, identity for η in a more straightforward manner from that. See, e.g., [Kob93] or [DS05]. Just like ϑ and ψ, one can relate η to quadratic forms. Speciﬁcally, one can ask about rep- resenting an integer n as a sum of k pentagonal numbers. Here the n-th pentagonal number is 3n2−n 2 for n ≥ 0, and this has a geometric interpretation just like square and triangular numbers do (draw a few). Then Euler’s pentagonal number theorem (Euler had previously considered the formal product ∏∞ n=1(1 − xn), not actually η as a function of H) states η(z) = q1/24 ∞∑ n=−∞(−1) nq 3n2−n 2 . Note this is not exactly the analogue of ψ for pentagonal numbers, due to both the factor of (−1)n and the appearance of the “negative pentagonal numbers” 3n2−n 2 for n < 0. However, what is more interesting, and Euler’s motivation for the pentagonal number theorem, is that 1 η(z) = q−1/24 ∞∑ n=0 p(n)qn, (4.15) where p(n) denotes the partition function. Recall a partition of n is a way of writing n as a sum of positive integers (order does not matter), e.g., the partitions of 3 are 3 = 2 + 1 = 1 + 1 + 1. Then p(n) is the number of partitions of n, so, e.g., p(3) = 3 (we count 3 itself as the trivial partition of 3). Here is a table of some partition numbers n 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 · · · 100 p(n) 1 2 3 5 7 11 15 22 30 42 56 77 101 135 176 231 · · · 190569292 The relation (4.15) follows immediately from the product expansion (our deﬁnition) for η, and the following exercise. 65 Exercise 4.5.4. Show the formal identity ∞∏ n=1 1 1 − xn = ∞∑ n=0 p(n)xn, where p(0) = 1. A classical problem in number theory and combinatorics was to ﬁnd a simple expression for p(n). (Partition numbers come up often in combinatorial problems.) There is no (known) simple (ﬁnite rational) closed form expression for p(n). As you can see from the table, the numbers p(n) start oﬀ growing quite slowly, but then appear to have exponential growth (an asymptotic was given by Hardy and Ramanujan). However, by Euler’s relation (4.15), one can use η and the theory of modular forms to get many results about the partition function. In fact, just in January 2011, Brunier and Ono gave a ﬁnite algebraic expression for p(n) in terms of η, E2 and certain binary quadratic forms of discriminant 1 − 24n. So what precisely is the relation with modular forms? Just like with ϑ and ψ, you might expect certain powers of η to be modular forms. From the q1/24 factor appearing, it seems clear that such an exponent would need to be a multiple of 24. (This is the same reason we needed to consider ψk where k ≡ 0 mod 8.) Proposition 4.5.5. Let k ≡ 0 mod 24. Then ηk ∈ Mk/2(1). In fact, since these forms are of level 1, the proof is easier than that for ϑ. *Exercise 4.5.6. Prove Proposition 4.5.5. There are a couple of things to remark here on apparent diﬀerences with powers of ϑ and ψ. First, we are getting modular forms on the full modular group, as opposed to Γ0(4) in the case of powers of ϑ and ψ. What this means is that η has slightly more reﬁned symmetry than ϑ and ψ. In fact one can write ϑ and ψ in terms of η: ϑ(z) = η(2z)5 η(z)2η(4z)2 , ψ(z) = η2(2z) η(z) One reason why η is quite special, is that all modular forms of “small level” can be generated by “eta quotients.” This is useful in giving product expansions for modular forms. Second, one can try to write η24 a linear combination of Eisenstein series on M12(1). However there is only one Eisenstein series here, namely E12 and just looking at the constant term (i.e., the value when z = i∞ or q = 0) shows η24 is not a constant multiple of E12. (When we worked on M4(4) we could use Eisenstein series from lower levels in addition to E4,4, but there is no lower level to work with now.) In other words, the Fourier coeﬃcients for η24 do not satisfy such a simple expression in terms of divisor functions as those for ϑ8 or ψ8. However, this issue not so much from any inherent diﬀerence between η versus ϑ and ψ, but rather from the diﬀerence in the exponents of the functions, or put another way, the weights of the modular forms. Except in the case of low weights k, the space Mk(Γ) will not be generated (as a vector space) by only Eisenstein series, but also require cusp forms. The Fourier coeﬃcients of these cusp forms, are on one hand more mysterious than the Fourier coeﬃcients of Eisenstein series (not easily expressible in terms of elementary functions like σk(n)), but on the other hand are much better behaved (asymptotically they satisfy better bounds and are in a sense “evenly distributed”.) 66 Deﬁnition 4.5.7. Let f ∈ Mk(Γ). We say f is a cusp form (of weight k for Γ) if f vanishes at the cusps, i.e., if, for each τ ∈ PSL2(Z), f |τ,k(z) → 0 as Im(z) → ∞. The space of cusp forms of weight k for Γ is denoted by Sk(Γ), or simply Sk(N ) if Γ = Γ0(N ). Note the S in Sk(Γ) stands for Spitzenform, which is German for cusp form. The French do not like this notation. (Cusp form is forme parabolique in French, but no one uses Pk(Γ).) Lemma 4.5.8. Let f ∈ Mk(Γ). Then f vanishes at the cusps if and only if f (z) → 0 as z → z0 for any z0 ∈ Q ∪ {i∞}. Contrast this with the case of Eisenstein series, where holomorphic at the cusps does not mean that Ek,N (z) is bounded as z tends to a rational number. Proof. First suppose f vanishes at the cusps. Let z0 ∈ Q ∪ {i∞}, and τ = (a b c d ) ∈ PSL2(Z) such that τ i∞ = z0. Since f |τ,k(z + N ) = f |τ,k(z) for some N , we have a Fourier expansion f |τ,k(z) = ∑ n≥0 aτ,nqn N , qN = e2πiz/N . The fact that this tends to 0 as z → i∞ implies aτ,0 = 0. Consequently f |τ,k(z) = qN h(z) where h(z) = ∑n≥0 aτ,n+1qn N is a holomorphic function. On the other hand f (τ z) = (cz + d) kf |τ,k(z) = (cz + d)kqN h(z) → 0 as z → i∞ because qN = e2πix/N e−2πy/N → 0 faster than (cz + d)k → ∞. This implies f (z) → 0 as z → τ i∞ = z0. Conversely, suppose f (z) → 0 as z → z0 for all z0 ∈ Q ∪ {i∞}. Take τ ∈ PSL2(Z). Then f |τ,k(z) = (cz + d) −kf (τ z) → 0 as z → i∞ since both (cz + d)−k → 0 and f (τ z) → 0 as z → i∞. As with holomorphy at the cusps, to check the condition of vanishing at the cusps given above, it suﬃces to check the vanishing condition at each cusp, rather than each element of Q ∪ {i∞}. Lemma 4.5.9. Let f ∈ Mk(Γ). Let {z1, . . . zr} ∈ Q ∪ {i∞} be a set of representatives for the cusps for Γ. If f (z) → 0 as z → zi for 1 ≤ i ≤ r, then f vanishes at the cusps. Proof. Let z0 ∈ Q ∪ {i∞} and write zi = γz0 for some 1 ≤ i ≤ r and γ = ( a b c d ) ∈ Γ. Since f (z) → 0 as z → zi, we have f (γz) → 0 as z → z0. Therefore, we also have f (z) = f |γ,k(z) = (cz + d) −kf (γz) → 0 as z → z0 since here (cz + d)−k → 0. Deﬁnition 4.5.10. We deﬁne the discriminant modular form ∆ := η24 ∈ M12(1). The Ramanujan τ -function deﬁned by the Fourier expansion of ∆ so that ∆(z) = ∞∑ n=1 τ (n)qn. 67 It is clear from the deﬁnition of η that η24 has no constant (n = 0) term in the Fourier expansion, so ∆ is holomorphic at i∞, which is the only cusp for PSL2(Z). Thus ∆ is a cusp form, i.e., ∆ ∈ S12(1). The reason for the terminology of ∆ is that is gives the discriminant for elliptic curves. Namely if E is the elliptic curve corresponding to the lattice ⟨1, z⟩, and ∆(E) is the appropriately normalized discriminant, then ∆(E) = ∆(z). In 1916, Ramanujan computed the ﬁrst 30 values of τ (n) and noticed various arithmetical curiosities. Here are the ﬁrst several values n 1 2 3 4 5 6 7 8 9 10 11 12 τ (n) 1 -24 252 -1472 4830 -6048 -16744 84480 -113643 -115920 534612 -370944 The most important property Ramaujan numerically observed is that τ is multiplicative, i.e., τ (mn) = τ (m)τ (n) whenever gcd(m, n) = 1. This alone means that τ must have some interesting arithmetical content. He also observed that τ (p2) = τ (p)2 − p11. Both these statements were proved by Mordell in 1917, and this was generalized by Hecke. We will prove these results later using the theory of Hecke operators. Ramanujan also conjectured that |τ (p)| ≤ 2p5√p. Compare this with the p-th Fourier coeﬃcient for E12 which is, up to a constant, σ11(p) = 1 + p11. In other words, the Fourier coeﬃcients for the cusp form ∆ of weight 12 should grow at most like the square root of the growth of the Eisenstein series of weight 12. This was proved by Deligne in 1974 as a consequence of his Fields-medal– winning proof of the Weil conjectures. While we obviously can’t prove this in our course, there is a weaker bound due to Hecke which is easy to prove that we will treat later. Hecke’s bound states |τ (p)| = O(p6), i.e., |τ (p)| ≤ Cp6 for some constant C. In fact, the proof so simple this bound is often called the trivial bound, and any improvement in the exponent was considered substantial progress. Ramanujan also noticed some remarkable congruences, such as the following. Example 4.5.11. We will see in the next chapter that dim M12(1) = 2. Observe that E12(z) = 1 + 65520 691 ∞∑ n=1 σ11(n)qn = 1 + 65520 691 q + · · · and E4(z) 3 = ( 1 + 240 ∞∑ n=1 σ3(n)qn)3 = 1 + 720q + · · · . The fact that dim M12(1) = 2 implies any cusp form (any form with zero constant term) must be a multiple of ∆, so comparing coeﬃcients of q, we see 691E12(z) − 691E4(z) 3 = −432000q + · · · = −432000∆. Since the coeﬃcients of E4(z)3 are integers, taking this mod 691 gives 566 ∞∑ n=1 σ11(n)qn ≡ 691E12(z) ≡ 566∆ ≡ ∞∑ n=1 τ (n)qn mod 691, i.e., τ (n) ≡ σ11(n) mod 691. 68 Note, while we have expressed ∆ as an algebraic (polynomial) combination of Eisenstein series, our comments before the deﬁnition of cusp form were stating that not all modular forms will be linear combinations of Eisenstein series. Roughly, it is the cusp forms which will not be. In fact, once we have the notion of an inner product on Mk(Γ), we will see that the space of cusp forms is orthogonal to the space generated (linearly) by Eisenstein series. While we could, from the previous example, write τ (n) as a polynomial expression in σ3 and σ11 akin to Example 4.3.12 (in fact, we will see later that one can write τ (n)—and more generally the Fourier coeﬃcients of any modular form of full level—as a polynomial expression in σ3 and σ5), this is qualitatively diﬀerent than being able to write the r8(n) and δ8(n) as linear expressions in σ3 as in Example 4.4.7 and Exercise 4.4.9. This is reﬂected in the very diﬀerent behavior of Fourier coeﬃcients for forms which are linear combinations of Eisenstein series and cusp forms. 69 5 Dimensions of spaces of modular forms As indicated in the introduction and the last chapter, we would like to know that a given space of modular forms Mk(Γ) is ﬁnite dimensional. Then, for example, we may be able to ﬁnd a basis for the space in terms of Eisenstein series, and use this to study questions about quadratic forms, as Example 4.4.7 and Exercise 4.4.9. In order to do this, we will need to know the dimension of the relevant space Mk(Γ). In this chapter, we will ﬁrst handle the case of full level, proving ﬁnite dimensionality and giving a simple formula for the dimension of Mk(1). Then, as in [Kil08], we will prove Sturm’s bound, which will allow us to deduce ﬁnite dimensionality for Mk(Γ). One can prove dimension formulas for Mk(N ) (and more generally Mk(Γ)), but in the interest of time we will not prove them in general, but merely state them for reference. However, it will be a consequence of Sturm’s bound that one can, for instance, rigorously verify the results of Example 4.4.7 and Exercise 4.4.9 without actually checking the dimension of M4(4). 5.1 Dimensions for full level To study the dimension of Mk(1), we will need the residue theorem from complex analysis, which we now recall. If f is meromorphic with a pole at s, then the residue of f at s is Resz=sf (z) = a−1 where f (z) = ∑ an(z − s)n, i.e., the residue is the coeﬃcient of the 1 z−s term in the Laurent expansion of f at s. Theorem 5.1.1. (Cauchy’s Residue Theorem) Let U be an open set in C whose boundary is a simple closed curve C. Let f : U → ˆC be meromorphic and let {sj} denote the set of singularities of f . If f extends to a holomorphic function at each z ∈ C, then ∫ C f (z)dz = 2πi ∑ j Resz=sj f (z) By convention, the integral around a closed curve will be in the counterclockwise direction. The condition that f must be holomorphic on C essentially means that there should be no poles along our path of integration. Example 5.1.2. Suppose f is holomorphic on a region U . In this case there are no residues because there are no poles, so ∫ C f (z)dz = 0 for any simple closed curve C ⊂ U . Example 5.1.3. Consider f (z) = 1 zk , and let C be any simple closed curve containing the origin. Here there is just one pole, at z = 0, and Resz=0f (z) = 1 if k = 1 and 0 otherwise. Thus ∫ C 1 zk dz = { 2πi k = 1 0 else. Meromorphic functions are controlled by their zeroes and poles. For a meromorphic function f on U , we deﬁne for any point p ∈ U , the order of f at p to be vp(f ) = m where the Laurent (or Taylor) expansion of f at p is f (z) = ∑∞ n=m an(z − p)n with am ̸= 0, i.e., the order tells you where the Laurent/Taylor series expansion at p starts. In other words, if vp(f ) = m > 0 means f has zero of order m at p, vp(f ) = 0 means f (p) ̸= 0, and vp(f ) = m < 0 means f has a pole of order −m at p. 70 Aside: in algebraic geometry, one studies associates to f a divisor div(f ) deﬁned to be a formal sum div(f ) = ∑ p∈U vp(f )p. This tells you where the zeroes and the poles are and what their order is, and if f is a rational function, then this sum is ﬁnite. For example, if we consider the meromorphic function f (z) = 12086 (z − 1)3(z − 4) z2(z + 2i) on ˆC = C ∪ {∞}, then div(f ) = 3 · 1 + 1 · 4 − 2 · 0 − 1 · (−2i) − 1 · ∞. In other words f has zeroes of order 3 and 1 at z = 1 and z = 4, poles of order 2, 1 and 1 at z = 0, 2i and ∞. I.e., v1(f ) = 3, v4(f ) = 1, v0(f ) = −2, v−2i(f ) = −1 and v∞(f ) = −1 (and vp(f ) = 0 for any other p ∈ ˆC. Note replacing f with a nonzero constant multiple does not change the divisor, and it is not hard to see that div(f ) determines f up to a constant. Observe that for any rational function f , ∑ p∈ˆC vp(f ) = 0. (5.1) (If f = q r where q and r are polynomials, div(f ) = div(q) − div(r). Now the number of zeroes of q is simply the degree, and q has no poles in C, but a pole of order deg(q) at ∞. Therefore the sum ∑ vp(q) of coeﬃcients of div(q) is 0, and the same is true for r, and therefore f .) Our proof of dimension formulas for Mk(1) will rely on an analogue of this formula for modular forms. We remark that (5.1) is analogous to the formula ∏ v |x|v = 1 from algebraic number theory, where x ∈ Q and v runs over the places of Q. (And both of these formulas are trivial consequences of the deﬁnition of the order of a function at a point and the p-adic valuation of a rational number. The analogy between algebraic number theory and algebraic geometry runs much deeper than this of course.) Theorem 5.1.4. Let f be a nonzero meromorphic modular form of weight k for PSL2(Z). For p ∈ H, let Cp be the elliptic subgroup of PSL2(Z) stabilizing p (cf. Section 3.5), and let F ∗ = {z ∈ H : − 1 2 ≤ Re(z) < 1 2 , |z| ≥ 1, and |z| > 1 if Re(z) ≥ 0 } − {ζ3} , so F ∗ ∪ {i, ζ3} is in bijection with PSL2(Z)\\H. Then ∑ p∈PSL2(Z)\\H 1 |Cp| vp(f ) = vi∞(f ) + 1 2 vi(f ) + 1 3 vζ3(f ) + ∑ p∈F ∗ vp(f ) = k 12 . (5.2) 71 F ∗ iζ3 − 1 2 1 2 We wrote the expression ∑ 1 |Cp| vp(f ) on the left of (5.2) both to give a more uniform presentation of the sum and make more clear the analogy with (5.1). However it is clear this expression equals vi∞(f ) + 1 2 vi(f ) + 1 3 vζ3(f ) + ∑ p∈F ∗ vp(f ) from Section 3.5, and this latter expression is what we will use in the proof. Proof. Note that we can relate the orders of zeroes and poles of f to residues of the logarithmic derivative f ′ f . Namely if f (z) = ∑n=m an(z − p)n with am ̸= 0, then f ′(z) f (z) = mam(z − p)m−1 + (z − p)m ((m + 1)am + · · ·) am(z − p)m (1 + · · ·) = m z − p + c0 + z(c1 + c2z2 + · · · ), so Resz=p f ′ f = vp(f ). Consequently, if f is holomorphic on U and C ⊂ U is a simple closed curve which misses all zeroes and poles of f (i.e., misses all poles of f ′ f ), then the residue theorem says ∫ C f ′ f dz = 2πi ∑ vp(f ), (5.3) where the sum is over all points in the region enclosed by C. First we assume that f has no zeroes or poles on the boundary ∂F ∗ of F ∗. Note ∂F ∗ = ∂F where F is the standard fundamental domain for PSL2(Z)); here, we mean the boundary inside H, so a zero or pole at i∞ is not ruled out. In this case we will consider our simple closed curve C to be of the following type. The curve C is mostly easily described in the diagram below, but here is how I would describe it in words also. The curve C, oriented counterclockwise, will begin at some point a high up on the left boundary Re(z) = − 1 2 of F∗, travel down the vertical line Re(z) = − 1 2 , stopping at a point b just short of ζ(3), then arcing inside F ∗ to travel along the bottom boundary |z| = 1, making a small arc inside F ∗ to avoid i, then continuing along the bottom boundary, again making a small arc to avoid ζ6, then climbing up the right boundary Re(z) = 1 2 to a point e such that Im(e) = Im(a), then traveling along the horizontal line Im(z) = Im(a) to end back at a. 72 F ∗ − 1 2 1 2 a b b′ d′ d c c′ e C Note that this curve C is made in such a way that no zeroes of poles of f inside F − {i, ζ3, ζ6} lie outside of C. This is possible since there are only ﬁnitely many zeroes and poles inside F. To see this, recall the open balls Br(i∞) = {i∞} ∪ {z ∈ H : Im(z) > r} form a basis of neighborhoods of i∞. So f being meromorphic at i∞ means we can choose a ball Br(i∞) such that f has no zeroes or poles in Br(i∞) except possibly at i∞. Consequently all zeroes and poles of f inside F must lie inside a truncated fundamental domain Fr = {z ∈ F : Im(z) ≤ r}. But the number of zeroes and poles inside Fr must be ﬁnite because Fr is compact. We also assume C is symmetric under reﬂection about iR+. By (5.3), we know ∫ C f ′ f dz = 2πi ∑ p∈F ∗ vp(f ), (5.4) On the other hand, we can compute the integral along C piecewise. Since f (z + 1) = f (z) we have ∫ b a f ′ f dz + ∫ e d′ f ′ f dz = 0. Thus ∫ C f ′ f dz = ∫ b′ b f ′ f dz + ∫ c b′ f ′ f dz + ∫ c′ c f ′ f dz + ∫ d c′ f ′ f dz + ∫ d′ d f ′ f dz + ∫ a e f ′ f dz. First note the change of variables z 7→ q transforms the integral from e to a to a circle around q = 0 with negative orientation. Then Cauchy’s Residue Theorem gives ∫ a e f ′ f dz = −2πivi∞(f ). 73 Next, if we integrate f ′ f around the circle αr of radius r containing the arc from b to b′, we get 2πivζ3(f ). (By making the arc of small enough radius, we may assume f has no zeros or poles inside this circle except possibly at ζ3.) If we take the radius r going to 0, its angle tends to π 3 , so you might guess ∫ b′ b f ′ f dz → − πi 3 vζ3(f ). This is true, and it follows from applying the following lemma to g(z) = f ′(z−ζ3) f (z−ζ3) , which has at most a simple pole at 0 whose residue is vζ3(f ). Lemma 5.1.5. Suppose g is meromorphic with at most a simple pole at the origin. Let Sr be the circle of radius r around the origin, 0 ≤ θ1 ≤ θ2 ≤ 2π, and consider the points ar = reiθ1 and br = reiθ2 on Sr. Then lim r→0 ∫ br ar g(z)dz = (θ2 − θ1)i Resz=0 g(z), where the integral is taken along the arc in Sr from ar to br. In particular, in the limit as r → 0, the integral only depends upon the length of the arc. Proof. First write g(z) = a−1z−1 + h(z) where h(z) is holomorphic at 0 and a−1 = Resz=0 g(z). It is clear that limr→0 ∫ br ar h(z)dz = 0, so it suﬃces to consider lim r→0 ∫ br ar a−1 z dz. Write z = reiθ so dz = ireiθdθ. Then lim r→0 ∫ br ar a−1 z dz = lim r→0 ∫ θ2 θ1 a−1 reiθ ire iθdθ = (θ2 − θ1)ia−1. Similarly, we have ∫ c′ c f ′ f dz → −πivi(f ) and ∫ d′ d f ′ f dz → − πi 3 vζ6(f ) = − πi 3 vζ3(f ). Putting all this together gives 2πi  vi∞(f ) + 1 2 vi(f ) + 1 3 vζ3(f ) + ∑ p∈F ∗ vp(f )   = lim C→∂F ∫ c b′ f ′ f dz + ∫ d c′ f ′ f dz. By our symmetry assumption on C, S = ( 0 1 −1 0 ) takes the arc from b′ to c to the arc from d to c′ (reverses orientation). Recall Sz = − 1 z , so diﬀerentiating f (Sz) = zkf (z) gives f ′(Sz) d dz Sz = f ′(Sz) d dz −1 z = 1 z2 f ′(Sz) = kzk−1f (z) + zkf ′(z). 74 Therefore, f ′(Sz) f (Sz) = kzk+1f (z) + zk+2f ′(z) zkf (z) = kz + z2 f ′(z) f (z) . so if z = Sw, then dz = 1 w2 dw and ∫ c b′ f ′(z) f (z) dz = ∫ c′ d f ′(Sw) f (Sw) dw w2 = ∫ c′ d ( k w + f ′(w) f (w) ) dw Since the path from d to c′ is taken along |w| = 1, ∫ c b′ f ′ f dz + ∫ d c′ f ′ f dz = k ∫ c′ d dw w → k ∫ π/2 π/3 dθ = k πi 6 , as C → ∂F. This proves the theorem with our assumptions about the zeroes and poles along the boundary of ∂F . Now suppose there are m points p1, . . . , pm, along ∂F − {i, ζ3, ζ6} at which f is zero or inﬁnite. (There are at most ﬁnitely many by meromorphy.) Then we can use the above argument, by suitably modifying the type of our curve C so as to just avoid p1, . . . , pm. Note that if pi is such a point along the left boundary Rez = − 1 2 (resp. bottom left boundary Rez < 0, |z| = 1), then T pi (resp. Spi) is also such a point along the right (resp. bottom right) boundary. For example if there are only two such points, say p1 on the left boundary, and p2 = T p1 along the right boundary, we can take our curve of the following type. F ∗ − 1 2 1 2 a b b′ d′ d c c′ e p1 p2 C 75 Here our previous argument goes through unchanged, since the integrals from a to b and d′ to e still cancel each other out. This obviously works for any (ﬁnite) number of zeroes and poles along the side boundary. It is also easy to see one can treat zeroes and poles on the lower boundary similarly (cf. exercise below). Exercise 5.1.6. With notation as in the previous theorem, suppose f has a zero or pole at some point p1 lying on the lower left boundary {z ∈ H : |z| = 1, − 1 2 < Re(z) < 0} of ∂F. Assume f has no zeroes or poles on ∂F − {i, ζ3, ζ6} except at p1 and p2 = Sp1. Check (5.2) still holds. Now we can use this to start computing dimensions of spaces of modular forms. Example 5.1.7. While we have been assuming k ≥ 0 even up to now, one can consider the same deﬁnitions for k < 0 even, and (5.2) still holds. If k < 0, then (5.2) says f must have a pole. Consequently, there are no (nonzero) holomorphic modular forms of negative weight, justifying our “omission” of negative weights. (Meromorphic modular forms of negative weights do of course exist— just take 1 f for any nonzero holomorphic modular form f of positive weight.) Proposition 5.1.8. We have Mk(1) =  | | C k = 0 {0} k = 2 CEk k = 4, 6, 8, 10, 14. This will complete the proof of the relation between σ7 and σ3 in 4.3.12. Proof. We already know M0(1) = C from Corollary 4.1.12. Next note any nonzero term on the left of (5.2) is at least 1 3 , so (5.2) has no solutions of k = 2. If k = 4, there is precisely one solution to (5.2), namely vζ3(f ) = 1 and all other vp(f ) = 0. Similarly, one easily sees (5.2) has only one solution for k = 6, 8, 10 or 14. However, we already know Ek is one nonzero modular form in Mk(1). Consequently if f ∈ Mk(1) for k = 4, 6, 8, 10 or 14, then (5.2) having only one solution means the zeroes of f must agree with the zeroes of Ek. Consequently, f /Ek is a meromorphic modular form of weight 0 with no zeroes or poles, i.e., a constant since M0(1) = C. Note if k = 12, then there are inﬁnitely many solutions to (5.2), and we need to use another argument to determine M12(1) (and similarly for Mk(1) for k > 14). We already know two forms in this space, the Eisenstein series E12, and the cusp form ∆. Lemma 5.1.9. Let k ≥ 4 even. Then Mk(1) = Sk(1) ⊕ CEk. Proof. Let f ∈ Mk(1). We know Ek ∈ Mk(1) is 1 at i∞. Thus g(z) = f (z) − f (i∞)Ek(z) ∈ Mk(1) and vanishes at i∞, i.e., g ∈ Sk(1). In other words, every modular form in Mk(1) is the sum of a cusp form and a multiple of the Eisenstein series Ek. In particular, to determine dim Mk(1) it suﬃces to determine dim Sk(1) = dim Mk(1) − 1. Note that by the previous proposition, there no nonzero cusp forms of level 1 for weights 0 through 10 or 14, so ∆ is the ﬁrst (smallest weight) instance of a cusp form. Proposition 5.1.10. The space S12(1) = C∆, i.e., M12(1) = C∆ ⊕ CE12. 76 This will complete the proof that τ (n) ≡ σ11(n) mod 691 in Example 4.5.11. Proof. Note that with k = 12, (5.2) only has one solution with vi∞(f ) > 0, namely vi∞(f ) = 1 and vp(f ) = 0 for any p ̸= i∞. This applies to any nonzero f ∈ S12(1), since such an f must vanish at i∞. I.e., any nonzero f ∈ S12(1) has a simple (order 1) zero at i∞ and no zeroes in H. In particular this is true for ∆. Then, as above, for any f ∈ S12(1), we have f /∆ ∈ M0(1), i.e., f is a scalar multiple of ∆. For k = 16, 18, 20, 22, 26, again one can observe there is only one solution to (5.2) with vi∞(f ) > 0 to see dim Sk(1) = 1 and dim Mk(1) = 2. However, we would prefer to be able to explicitly construct the cusp forms. How can we construct cusp forms? One way would be to construct a form in Mk(1) which isn’t a multiple of Ek and subtract oﬀ an appropriate multiple of Ek, as in the proof of Lemma 5.1.9. More suitable for our present purposes is just to multiply a cusp form (namely ∆) with another form. Exercise 5.1.11. For any congruence subgroup Γ, let f ∈ Mk(Γ) and g ∈ Sℓ(Γ). Then f g ∈ Sk+ℓ(Γ). Now we show that any cusp form can be constructed as a multiple of ∆ and a modular form of smaller weight. Lemma 5.1.12. Let k ≥ 16. Then Sk(1) = ∆ · Mk−12(1). In particular, dim Mk(1) = 1 + dim Mk−12(1). Proof. Let f ∈ Sk(1). Then vi∞(f ) ≥ 1. On the other hand, ∆ has a simple zero at i∞ and is nonzero on H, therefore f /∆ is a holomorphic modular form of weight k − 12. We can put all this information together in the following theorem. Theorem 5.1.13. Let k ≥ 0 even. Then dim Mk(1) = { ⌊ k 12 ⌋ + 1 k ̸≡ 2 mod 12 ⌊ k 12 ⌋ k ≡ 2 mod 12. By Lemma 5.1.9, this also tells us the dimensions of Sk(1). Note the reason for the diﬀerence in the case k ≡ 2 mod 12 is because E2 ̸∈ M2(1). In fact, we know more than the dimensions. What we did above, allows us to a basis for any Mk in terms of Eisenstein series and ∆. Example 5.1.14. Consider M40(1). We can write S40(1) = ∆ · M28(1) = ∆ · (CE28 ⊕ S28(1)) = ∆ · (CE28 ⊕ ∆ (CE16 ⊕ ∆E4)) . Consequently, a basis for M40(1) is { E40, ∆E28, ∆2E16, ∆3E4}. Exercise 5.1.15. Write a basis for M36(1) in terms of Eisenstein series and ∆. 77 Since we can write any modular form of level 1 in terms of Eisenstein series and ∆, we can write any modular form of level 1 simply in terms of Eisenstein series by the relation (now justiﬁed) ∆ = 691 432000 (E3 4 − E12) that we obtained in Example 4.5.11. In fact we can write ∆ in terms of strictly lower weight Eisenstein series, which is in many places how ∆ is deﬁned. Exercise 5.1.16. Show that ∆ = E3 4 − E2 6 1728 . Note the above relation shows the j-invariant deﬁned in Exercise 4.2.13 is simply j(z) = E4(z)3 ∆(z) . In other words, the j-invariant of an elliptic curve (which is actually an invariant of analytic isomor- phism classes) is closely related to the discriminant ∆ of the elliptic curve (which is not an invariant for isomorphism classes). In fact all modular forms for PSL2(Z) can be written in terms of E4 and E6. Proposition 5.1.17. Let f ∈ Mk(1). Then f is polynomial in E4 and E6. Proof. Since the above procedure shows any f is a polynomial in ∆ = E3 4 −E2 6 1728 and E4, E6, . . . , Ek, it suﬃces to show each Ej is a polynomial in E4 and E6. We use induction. Suppose it is true for Ej with j ≤ k − 2, and consider Ek. We may assume k ≥ 8 even. Then there exist r, s ∈ Z≥0 such that k = 4r + 6s. Hence E = Er 4Es 6 ∈ Mk(1). Since neither E4 nor E6 vanish at inﬁnity, E this is not a cusp form. Further, because Mk(1) = CEk ⊕ Sk(1), there exists g ∈ Sk(1) such that E − g = cEk for some c ̸= 0. (Note the Fourier expansions of E − g and Ek both start with 1, so in fact c = 1). On the other hand, since g = ∆g′ for some g′ ∈ Mk−12(1), by induction g is a polynomial in E4 and E6. Therefore Ek also is. Exercise 5.1.18. (i) Write E10 and E14 as polynomials in E4 and E6. (ii) Using a relation between E14, E10 and E4, show σ13(n) ≡ 11σ9(n) − 10σ3(n) mod 2640. 5.2 Finite dimensionality for congruence subgroups As you can see from the proof of Theorem 5.1.13, trying to carry out the same approach for an arbitrary congruence subgroup does not seem so appealing. Of course, for a given congruence subgroup, one can ﬁx a fundamental domain and mimic the proof of Theorem 5.1.4 and use this to compute dimension formulas. However, there is an general approach using some Riemann surface theory and algebraic ge- ometry, namely the Riemann–Roch theorem. We will not cover this here (see, e.g., [DS05]), but 78 simply remark that one can prove an analogue of Theorem 5.1.4, which states if f is a meromorphic modular form of weight k on Γ, then ∑ p∈Γ\\H 1 |Cp| vp(f ) = k 2 ( 1 2 ϵ2 + 2 3 ϵ3 + ϵ∞ + 2g − 2) , (5.5) where Cp is the stabilizer of p in Γ, ϵ2 (resp. ϵ3) is the number of elliptic points of order 2 for Γ, ϵ∞ is the number of cusps for Γ, and g is the genus of Γ\\H. Note for Γ = PSL2(Z), one has ϵ2 = 1, ϵ3 = 1, ϵ∞ = 1 and g = 0 so this agrees with Theorem 5.1.4. Consequently, one can show if k ≥ 0 even, then dim Mk(Γ) = { (k − 1)(g − 1) + ⌊ k 4 ⌋ϵ2 + ⌊ k 3 ⌋ϵ3 + k 2 ϵ∞ k ≥ 2 1 k = 0, (5.6) and dim Sk(Γ) =  | | (k − 1)(g − 1) + ⌊ k 4 ⌋ϵ2 + ⌊ k 3 ⌋ϵ3 + ( k 2 − 1) ϵ∞ k ≥ 4 g k = 2 0 k = 0. (5.7) Instead, we will take a simpler, and in some sense more practical, approach (as in [Kil08]) using Sturm’s bound, which will allow us to conclude ﬁnite dimensionality with a bound for dimensions, which in some cases will be sharp. Theorem 5.2.1. (Sturm’s bound) Let Γ be a congruence subgroup and f ∈ Mk(Γ). Let ρ1, . . . , ρt be the cusps of Γ. If ∑ ρj vρj (f ) > k[PSL2(Z) : Γ] 12 , then f = 0. Proof. First suppose Γ = PSL2(Z) and f ∈ Mk(1) with r := vi∞(f ) > k 12 . Since ∆ has only a simple zero at i∞ and is nonzero on H, f ∆r is a holomorphic modular form of weight k − 12r < 0. Since there are no nonzero holomorphic modular forms of negative weight (Example 5.1.7), this means f = 0. Now suppose Γ ̸= PSL2(Z) and put M = [PSL2(Z) : Γ] and f ∈ Mk(Γ) with vi∞(f ) > kM 12 . We will use f to construct a modular form for PSL2(Z). Let {τi}1≤i≤M be a set of coset representatives for Γ\\PSL2(Z) with τ1 ∈ Γ. Recall f |τ,k(z) = j(τ, z)−kf (τ z) = (cz + d) −kf (τ z), where τ = (a b c d ) , so f |τ1,k = f . Let F (z) = M∏ i=1 f |τi,k(z) = f (z) M∏ i=2 f |τi,k(z). Note f |γτi,k = (f |γ,k) |τi,k = f |τi,k 79 for any γ ∈ Γ, i.e., f |τi,k does not depend upon the choice of coset representative. Consider any τ ∈ PSL2(Z). Note {τ ′ i := τ τi} is just another set of coset representatives for Γ\\PSL2(Z), hence F |τ,kM = ( M∏ i=1 f |τi,k ) |τ,k = M∏ i=1 (f |τi,k) |τ,k = M∏ i=1 f |τ τi,k = F, i.e., F ∈ MkM (1). Since vi∞(F ) = ∑M i=1 vτ −1 i ·i∞(f ) > kM 12 , by the PSL2(Z) case we know F = 0, which implies f = 0. Remark 5.2.2. In the course of the proof we have shown how to construct a modular form of full level at the expense of increasing the weight. The same argument evidently shows the following. Let Γ′ ⊆ Γ ⊆ PSL2(Z) be congruence subgroups, f ∈ Mk(Γ′) and M = [Γ : Γ′]. Let {τi}1≤i≤M be a set of coset representatives for Γ′\\Γ′. Then F (z) = M∏ i=1 f |τi,k ∈ MkM (Γ). What Sturm’s bound really means is the following. For a congruence subgroup Γ, we put q = e2πiz as usual if T ∈ Γ. If not, then T N ∈ Γ for some N , and we set q = e2πiz/N for the minimal such N ∈ N. Then f ∈ Mk(Γ) has period N so we can write the Fourier expansion as f (z) = ∑ anqn. Corollary 5.2.3. Let f (z) = ∑ anqn, g(z) = ∑ bnqn ∈ Mk(Γ). If an = bn for n ≤ k[PSL2(Z):Γ] 12 , then f = g. Proof. Apply Sturm’s bound to f − g. Corollary 5.2.4. For a congruence subgroup Γ, dim Mk(Γ) ≤ k 12 [PSL2(Z) : Γ] + 1. In particular, dim Mk(N ) ≤ k 12 N ∏ p|N ( 1 + 1 p ) + 1. Proof. Sturm’s bound says the linear map given by f (z) = ∑ n≥0 anqn 7→ (a0, a1, . . . , ar) where r = k 12 [PSL2(Z) : Γ] is an injective map from Mk(Γ) to Cr+1. The second statement follows from Corollary 3.4.3. Example 5.2.5. Let k = 0, then we see for any Γ, dim M0(Γ) ≤ 1. On the other hand any constant function lies in M0(Γ), so M0(Γ) = C. This provides another proof that there are no nonconstant holomorphic modular functions (cf. Corollary 4.1.12). 80 Example 5.2.6. Let N = 4. Then we see dim Mk(4) ≤ k 12 4 · 3 2 + 1 = k 2 + 1. In particular dim M4(4) ≤ 4 2 + 1 = 3. On the other hand, we have constructed 3 linearly independent elements of M4(4) (none of which are cusp forms), namely E4,4, E4,2 and E4 (cf. Example 4.4.7). Hence dim M4(4) = 3. This justiﬁes the formulas for the number of representations of n as a sum of 8 squares (resp. triangular numbers) in Example 4.4.7 (resp. Exercise 4.4.9). Exercise 5.2.7. Show dim Mk(Γ0(2)) = 2 for k = 4, 6. Observe that even in small weights, dim Mk(N ) > 1 for higher levels, in contrast to the level 1 case, where the dimension did not jump to 2 until the occurrence of the cusp form ∆ in weight 12. The reason for this diﬀerence is that there is an Eisenstein series Ek,d ∈ Mk(N ) for each d|N , and these are all diﬀerent. In general Γ will have multiple cusps, and one can construct an “Eisenstein series for each cusp” (which turn out to be the same as the Ek,d for d|N when Γ = Γ0(N ) and N is a product of distinct primes or N = 4). While we haven’t shown this yet, E4 − E4,4 (or anything in M4(4)) is not a cusp form, even though it vanishes at i∞. We point this out to emphasize that in higher level, one really needs to check a form vanishes at all cusps in order to verify it is a cusp form. However, one sometimes has 1-dimensional spaces in higher level (besides in the trivial weight k = 0). Exercise 5.2.8. (a) Consider the Eisenstein series E∗ 2 (z) = E2(z) − 2E2(2z). Using the transfor- mation law stated in Exercise 4.2.14, show E∗ 2 ∈ M2(2) and E∗ 2 (2z) ∈ M2(4). (b) Deduce dim M2(2) = 1 and dim M2(4) = 2. (c) Show r4(n) = { 8σ1(n) n odd 24σ1(n0) n = 2rn0, n0 odd. One can show the ﬁrst cusp form for Γ0(4) occurs at weight 6. Exercise 5.2.9. (a) Show Fη(z) = η12(2z) ∈ S6(4). (b) Using Sturm’s bound, show dim S6(4) = 1. (c) For k ≥ 6 even, show Sk(4) = Fη · Mk−6(4). (d) Show for k ≥ 0, dim Mk(4) = k 2 + 1. Example 5.2.10. Let us now consider the number r12(n) of representations of n as a sum of 12 squares. By Proposition 4.4.4, we know ϑ12(z) = ∞∑ n=0 r12(n)qn = 1 + 2 · 12q + 4 · 66q2 + 8 · 220q3 + · · · ∈ M6(4). 81 From the previous exercise, we know M6(4) = ⟨E6, E6,2, E6,4, Fη⟩. Note E6(z) = 1 − 504 ∞∑ n=1 σ5(n)qn = 1 − 504 (q + 33q2 + 244q3 + · · ·) E6,2(z) = 1 − 504 31 ∞∑ n=1 (32σ5(n/2) − σ5(n)) qn = 1 + 504 31 (q + q2 + 244q3 + · · ·) E6,4(z) = E6,2(2z) = 1 − 504 31 ∞∑ n=1 (32σ5(n/4) − σ5(n/2)) qn = 1 + 504 31 q2 + · · · Fη(z) = η12(2z) = q ∞∏ n=1 (1 − q2n) 12 = ∑ n>0 anqn = q − 12q3 + · · · . One can verify that ϑ12 = − 5 336 E6 + 31 1008 E6,2 + 62 63 E6,4 + 16Fη. Consequently, one gets a formula for r12(n) in terms of σ5 and the Fourier coeﬃcients an of the cusp form Fη: r12(n) = 8σ5(n) − 512σ5(n/4) + 16an. Because of the appearance of cusp forms of level 4 starting at weight 6, for 2k ≥ 12 with k even, one no longer gets as elementary an expression for r2k(n) as the Fourier coeﬃcients of cusp forms are in some sense more mysterious. (While we’ve avoided modular forms of odd weight, there is also a cusp form of weight 5 for Γ1(4), so the formula for r10(n) also involves a cusp form.) However, as mentioned before, Hecke’s bound will show the Fourier coeﬃcients for cusp forms grow at a much slower rate, so one is at least able to get a nice asymptotic for r2k(n) just in terms of the Fourier coeﬃcients of Eisenstein series. We will say a little more about this once we get to Hecke’s bound. We remark that in speciﬁc cases, it is still possible to get elementary formulas for r2k(n) with more work. For instance, Glaisher in fact derived an explicit elementary formula for r12(n) as r12(n) = (−1) n−18 ∑ d|n (−1) d+n/dd 5 + 4 ∑ N (α)=n α4, where α runs over all Hurwitz integers with norm n. 82 6 Hecke operators Recall the conjecture of Ramanujan that τ (mn) = τ (m)τ (n) for m, n relatively prime. While this speciﬁc result was shown by Mordell, it was Hecke who developed a general theory to determine which modular forms have multiplicative Fourier coeﬃcients. Note that the Eisenstein series Ek essentially have multiplicative Fourier coeﬃcients by the following elementary exercise. Exercise 6.0.1. If gcd(m, n) = 1, show σk(m)σk(n) = σk(mn). Namely, if we write Ek(z) = 1 − 2k Bk ∑ σk−1(n)qn = ∑ anqn, the above exercise shows aman = ( 2k Bk )2 σk−1(m)σk−1(n) = ( 2k Bk )2 σk−1(mn) = − 2k Bk amn = a1amn. Very roughly, the idea of Hecke is the following. Consider an operator Up (∑ anqn) = ∑ apnqn. If this operator preserves S12(1), then Up∆ = λp∆ for some λp ∈ C, since S12(1) = ⟨∆⟩. On the other hand, Up∆ = Up(q − 24q2 + 252q3 − · · · ) = τ (p)q − 24τ (p)q2 + · · · so λp = τ (p) and therefore we would have τ (pn) = τ (p)τ (n) for all n. However, τ is not totally multiplicative, i.e., τ (p2) ̸= τ (p)2, so Up does not preserve ∆. Instead, since Ramanujan predicted τ (p2) = τ (p)2 − p11, one would expect τ (pn) = τ (p)τ (n) − p11τ (n/p) for p|n. Thus one can guess the correct operator (for weight 12) should be Tp (∑ anqn) = ∑ p∤n apnqn + ∑ p|n (apn + p 11an/p) qn. (6.1) Then one just needs to show Tp preserves S12(1). 6.1 Hecke operators for Γ0(N ) While we could deﬁne the Hecke operators directly by their action on Fourier expansions along the lines of (6.1), it will be helpful (and more motivated) to think of them as acting on lattices. First let’s consider the case of PSL2(Z). Recall PSL2(Z)\\H parameterizes the space of lattices up to homothety (equivalence by C×). Hence a weak modular form of weight 0 is simply a meromorphic function on equivalence classes of lattices. What about weight k? Given f ∈ Mk(1), consider the lattice Λ = ⟨1, τ ⟩ with τ ∈ H. Put F (Λ) = f (τ ). Since ⟨ω1, ω2⟩ = ⟨ω′ 1, ω′ 2⟩ if and only if ( a b c d ) ( ω1 ω2 ) = ( ω′ 1 ω′ 2 ) 83 one easily sees that ⟨1, τ ⟩ = ⟨1, τ ′⟩ (with τ ′ ∈ H also) if and only if τ ′ = τ + d for some d ∈ Z. Thus f having period 1 implies F (Λ) is well-deﬁned on lattices of the form ⟨1, τ ⟩. Now consider an arbitrary lattice Λ = ⟨ω1, ω2⟩. We can write Λ = ω1⟨1, ω2/ω1⟩ = λ⟨1, τ ⟩ where λ = ω1 and τ = ω2/ω1. Thus, to see how to extend F to a function on all lattices it suﬃces to determine how F should behave under multiplying a lattice Λ = ⟨1, τ ⟩ by a scalar λ. It’s reasonable to ask that a scalar λ should just transform F by some factor, i.e., F (λΛ) = c(λ)F (Λ). The only condition we have is that this should be compatible with our deﬁnition of F (⟨1, τ ⟩) = f (τ ). In other words, if λ⟨1, τ ′⟩ = ⟨1, τ ⟩, we need to ensure F (λ⟨1, τ ′⟩) = F (⟨1, τ ⟩). This boils down to the case where λ = τ and τ ′ = − 1 τ . Here we require c(τ )f ( − 1 τ ) = F (τ ⟨1, 1 τ ⟩) = F (⟨1, τ ⟩) = f (τ ). But now the modularity of f implies c(τ ) = 1 τ k . In other words, the weight k modular form f can be viewed as a homogeneous function F of degree −k on the space of lattices of C, i.e., a function F such that F (λΛ) = 1 λk F (Λ) for λ ∈ C×. Call the space of such F by L(k). Conversely, if F is a function of lattices such that F (λΛ) = λ−kF (Λ) with k ≥ 0 even, then one can check f (z) = F (⟨1, z⟩) ∈ Mk(1). Hence there is a bijection between Mk(1) and L(k). Then for PSL2(Z) we can deﬁne the n-th Hecke operator in terms of F ∈ L(k): Tn(F (Λ)) = F   ∑ Λ′ n ⊂Λ Λ′   , where the sum is over all Λ′ ⊆ Λ of index n. In other words Tn averages F over all sublattices of index n. It is clear that TnF is still a function of lattices, and it is homogeneous of degree −k. Clearly T1F = F . Thus the correspondence between modular forms f ∈ Mk(1) and F ∈ L(k) induces an action of the Hecke operators Tn : Mk(1) → Mk(1). Let’s see how Tn translates to an operator on Mk(1). First observe that the sublattices Λ′ of Λ = ⟨1, τ ⟩ of index n are precisely Λ′ = ⟨1, τ ′⟩, where (τ ′ 1 ) = (a b c d ) ( τ 1 ) for ( a b c d ) ∈ Mn(Z) where Mn(Z) denotes the 2 × 2 integer matrices of determinant n. For such a Λ′ = ⟨aτ + b, cτ + d⟩ = (cτ + d)⟨ aτ + b cτ + d , 1⟩, we have F (Λ′) = F ( (cτ + d)⟨ aτ + b cτ + d , 1⟩ ) = (cτ + d)−kf ( aτ + b cτ + d ) = f |µ,k(τ ) 84 where we extend the slash operator f |µ,k(τ ) = (cτ + d) −kf ( aτ + b cτ + d ) for µ = ( a b c d ) ∈ Mn(Z). (Note in general for µ = ( a b c d ) ∈ GL + 2 (Q) (the superscript + means positive determinant) one typically deﬁnes the slash operator with a factor of det(µ)k/2, so our notation departs from the standard here, but seems the most reasonable for our present purpose.) Given µ1, µ2 ∈ Mn(Z), one can check µ1⟨1, τ ⟩ = µ2⟨1, τ ⟩ if and only if µ2 = γµ1 for some γ ∈ SL2(Z). Hence on the level of modular forms, we have Tnf = ∑ µ∈SL2(Z)\\Mn(Z) f |µ,k. For our arithmetic purposes, it is better to introduce a normalization factor of n1−k in the Hecke operator, which we will do below. The above discussion was just motivation for how to deﬁne Hecke operators for PSL2(Z). While we will not go through the details (cf. [Kob93]), a similar argument can be made for the modular groups Γ0(N ) (as well as for Γ1(N ) and Γ(N )). The idea is that Γ0(N )\\H parameterizes pairs (Λ, C) where Λ is a lattice in C and C is a cyclic subgroup of Λ of order N . Then one can identify modular forms f ∈ Mk(N ) with homogenous functions of degree −k on pairs (Λ, C) and deﬁne Hecke operators Tn similarly, though some care must be taken when gcd(n, N ) > 1. Let Mn,N (Z) = {( a b c d ) ∈ Mn(Z)|c ≡ 0 mod N } / {±I} . Deﬁnition 6.1.1. Suppose gcd(n, N ) = 1. We deﬁne the n-th Hecke operator Tn on Mk(N ) by Tnf = nk−1 ∑ µ∈Γ0(N )\\Mn,N (Z) f |µ,k. We will see the normalization factor nk−1 will make the action on Fourier coeﬃcients nice. Observe that for f ∈ Mk(N ), µ ∈ Mn,N (Z) and γ ∈ Γ0(N ) we have f |γµ,k = (f |γ,k)|µ,k = f |µ,k, so the above sum over coset representatives is well deﬁned. It is also easy to see that Tn is linear. Now we show it actually is an operator on Mk(N ), as well as Sk(N ). Unless otherwise speciﬁed, we assume gcd(n, N ) = 1 in what follows. Proposition 6.1.2. We have Tn : Mk(N ) → Mk(N ) and Tn : Sk(N ) → Sk(N ). Proof. Let γ ∈ Γ0(N ). Then (Tnf )|γ,k = nk−1   ∑ µ∈Γ0(N )\\Mn,N (Z) f |µ,k   |γ,k = nk−1 ∑ µ∈Γ0(N )\\Mn,N (Z) f |µγ,k = nk−1 ∑ µ∈Γ0(N )\\Mn,N (Z) f |µ,k = Tnf 85 since right multiplication by γ ∈ Γ0(N ) preserves Mn,N (Z), and therefore simply permutes the cosets Γ0(N )\\Mn,N (Z). Note that each f |µ,k is holomorphic on H, therefore Tnf is. To see Tnf is holomorphic at each cusp, let τ ∈ PSL2(Z) and consider f |µ,k|τ,k = f |µτ,k = f |µ′,k where µ′ = µτ = (a b c d ) ∈ Mn(Z) (but not necessarily Mn,N (Z)). As Im(z) → ∞, f |µ′,k(z) → limIm(z)→∞ 1 (cz)k f ( a c ) which has a ﬁnite limit because f is holomorphic at the cusp a c . Thus each f |µ′ is holomorphic at i∞, and Tnf is holomorphic at the cusps. The same argument we used for holomorphy at the cusps shows that if f is vanishes at the cusps, so does Tnf . Lemma 6.1.3. A set of coset representatives for Γ0(N )\\Mn,N (Z) is {( a b 0 d ) : a, d > 0, ad = n, 0 ≤ b < n } . Proof. Take ( a b cN d ) ∈ Mn,N (Z) representing some coset in Γ0(N )\\Mn,N (Z). Since gcd(n, N ) = 1, we know gcd(a, cN ) = 1. Then there exist x, y ∈ Z such that ( x y cN −a ) ∈ Γ0(N ). Now observe ( x y cN −a ) ( a b cN d ) = ( ax + cyN bx + dy 0 bcN − ad ) , which means we may assume c = 0 for our coset representative. Further, given ( a b 0 d ) ∈ Mn,N (Z), we may replace it by the coset representative ( 1 x 0 1 ) ( a b 0 d ) = ( a b + dx 0 d ) where we choose x so that 0 ≤ b + dx < d, i.e., we may just assume 0 ≤ b < d. Since n = ad > 0, a and d have the same sign, we may multiply by −I if necessary to assume a, d > 0. This shows any coset has a representative of the desired form. Now consider ( a b 0 d ) and ( a′ b′ 0 d′ ) such that ad = a′d′ = n, 0 ≤ b < d and 0 ≤ b′ < d′. Assume they represent the same coset, i.e., ( a′ b′ 0 d′ ) = ( r s tN u ) ( a b 0 d ) = ( ra rb + sd tN a tN b + ud ) for some ( r s tN u ) ∈ Γ0(N ). First we see this means t = 0, which means r = u = 1 (up to ±1). This means a′ = a d′ = d, and b′ = b + sd. However 0 ≤ b′ < d′ = d implies we need s = 1, i.e.,( r s tN u ) = I, and therefore any two distinct matrices of the prescribed form represent distinct cosets. 86 Theorem 6.1.4. Let f (z) = ∑ anqn ∈ Mk(N ) and suppose gcd(m, N ) = 1. Then (Tmf )(z) = ∑ bnqn where bn = ∑ d| gcd(m,n) d k−1amn/d2. In particular, if m = p is prime, then bn = { apn p ∤ n apn + pk−1an/p p|n so (Tpf )(z) = ∑ n̸≡0 mod p apnqn + ∑ n≡0 mod p (apn + p k−1an/p) qn. Proof. By the previous lemma, we have (Tmf )(z) = m k−1 ∑ f | a b 0 d  ,k where the sum runs over a, b, d ∈ Z≥0 such that ad = m and 0 ≤ b < d. Note f | a b 0 d  ,k(z) = 1 dk f ( az + b d ) = 1 dk ∞∑ n=0 ane 2πi a d zne 2πi b d n = 1 dk ∞∑ n=0 ζ bn d anq a d n. For ﬁxed a, d we will be considering the sum ∑ 0≤b<d 1 dk f ( az + b d ) = 1 dk ∞∑ n=0   ∑ 0≤b<d ζ bn d   anq a d n. Note that the inner sum ∑0≤b<d ζ bn d will just be a sum over all d-th roots of unity, and therefore vanish, unless d|n, in which case it is just d. Thus ∑ 0≤b<d 1 dk f ( az + b d ) = 1 dk−1 ∞∑ n=0 adnqan. Hence (Tmf )(z) = m k−1 ∑ ad=m ∑ 0≤b<d 1 dk f ( az + b d ) = mk−1 ∑ ad=m ( 1 dk−1 ∞∑ n=0 adnqan) = ∞∑ n=0 ∑ a|m (a k−1amn/aqan) = ∞∑ n=0 ∑ d|m d k−1amn/d2qn. 87 Corollary 6.1.5. The Ramanujan tau function satisﬁes τ (mn) = τ (m)τ (n) whenever gcd(m, n) = 1 and τ (pr) = τ (p)τ (pr−1) − p11τ (pr−2). Proof. Consider (Tp∆)(z) = ∑ p∤n τ (pn)qn + ∑ p|n (τ (pn) + p11τ (n/p) ) qn. On the other hand, Tp acts on S12(1) = C∆ so (Tp∆)(z) = λ∆(z) for some λ ∈ C×. The 1st Fourier coeﬃcients of ∆ and Tp∆ are just 1 and τ (p), so λ = τ (p). Comparing the n-th Fourier coeﬃcients, we see { τ (pn) = λτ (n) = τ (p)τ (n) p ∤ n τ (pn) + p11τ (n/p) = λτ (n) = τ (p)τ (n) p|n. The former equation proves the multiplicativity when m = p and the latter equation proves the recursion relation for τ (pr). To obtain the general multiplicativity law τ (mn) = τ (m, n) for gcd(m, n) = 1, we simply use the same argument as above with Tm instead of Tp. The above argument applies in a more general setting. Exercise 6.1.6. Suppose f (z) = ∑ anqn ∈ Sk(N ) (resp. Mk(N )) and dim Sk(N ) = 1 (resp. dim Mk(N ) = 1). Show (i) If gcd(m, N ) = gcd(n, N ) = gcd(m, n) = 1, then a1amn = aman. In particular, if f (z) ̸= 0 we must have a1 ̸= 0, and if we normalize f such that a1 = 1, the Fourier coeﬃcients are multiplicative. (ii) If a1 = 1 and p ∤ N , then apn = apapn−1 − pk−1apn−2 for n ≥ 2. What this means is we can use Hecke operators to compute values of Fourier coeﬃcients from just knowing what the Tp’s are. Exercise 6.1.7. Using the fact that dim S16(1) = 1, use the previous exercise to help compute the ﬁrst 10 Fourier coeﬃcients of E4∆. Now you might ask, for what modular forms f are the Fourier coeﬃcients multiplicative in the sense a1amn = aman for gcd(m, n) = 1? By Exercise 6.0.1, we know this is true for the Eisenstein series Ek, and now we have seen it is true for ∆, and by Exercise 6.1.6, any Ek∆ where k = 4, 6, 8, 10, 14. In general, if you have two power series (or Fourier expansions) f and g with multiplicative coeﬃcients, the formal product f g will not have multiplicative Fourier coeﬃcients, so there is no reason to expect all modular forms—or even products of modular forms with multiplicative Fourier coeﬃcients—to have multiplicative coeﬃcients. For instance, starting in weight 24 for the full modular group, we have a space of cusp forms of dimension greater than 1, namely S24(1) = ⟨∆2, E12∆⟩. Since ∆(z) = q − 24q2 + 252q3 − 1472q4 + 4830q4 − 6048q6 + · · · 88 we compute ∆2(z) = q2 − 48q3 + 1080q4 − 2944q5 + 143820q6 + · · · . Right away, we see two things: 1) the Fourier coeﬃcients of q2 and q3 do not multiply to give the Fourier coeﬃcient of q6, and 2) a1 = 0 so the multiplicative property a1an = aman for gcd(m, n) = 1 would mean an = 0 whenever n is divisible by two diﬀerent primes, which is obviously not the case. (In fact something stronger is true, see Corollary 6.1.11 below.) One can also check that E12 = 1 + 65520 691 (q + 2049q2 + 177148q3 + 4196353q4 + 48828126q5 + · · ·) so E12∆ = q + 65520 691 ( 2039 2730 q2 + 527191 260 q3 + 525013709 4095 q4 + · · · − 666536766 65 q6 + · · ·) While the ﬁrst Fourier coeﬃcient is 1 here, again one sees the products of the q2 and q3 coeﬃcients does not give the q6 coeﬃcient (it’s not even the right sign!). So one cannot hope that the Fourier coeﬃcients of Ek∆ are multiplicative in general. You might now ask, are there any elements of S24(1) with multiplicative Fourier coeﬃcients or does this property of having multiplicative Fourier coeﬃcients only occur in small weight? We will see there always are cusp forms with multiplicative Fourier coeﬃcients. First, let’s make an observation in the weight 12 case: while 691 65520 E12 and ∆ have multiplicative Fourier coeﬃcients, one can’t expect this for any modular form in M12(1). Namely if f and g have multiplicative Fourier coeﬃcients, f + g will generally not. So while most forms in M12(1) do not have multiplicative Fourier coeﬃcients, M12(1) is generated by two “nice” forms, 691 65520 E12 and ∆, which do. Using the theory of Hecke operators, we will show that there exists such a “nice” basis for Mk(N ) and Sk(N ). The basic idea is to show that the Hecke operators Tm and Tn commute for gcd(m, n) = 1 (and m, n prime to N ). Then one deﬁnes an inner product ⟨·, ·⟩, called the Petersson inner product, on Mk(N ) and shows each Tn is Hermitian with respect to ⟨·, ·⟩, i.e., ⟨Tnf, g⟩ = ⟨f, Tng⟩. Then a well known theorem in linear algebra says that a commuting family of operators which are Hermitian with respect to ⟨·, ·⟩ can be simultaneously diagonalized by some orthonormal basis with respect f1, . . . , fr to ⟨·, ·⟩ In other words, each fi is an eigenform for Tn, i.e., Tnfi = λfi for some λ ∈ C. Deﬁnition 6.1.8. Let f ∈ Mk(N ) be nonzero. We say f is a (Hecke) eigenform if, for each n relatively prime to N , there exists a (Hecke) eigenvalue λn ∈ C such that Tnf = λnf . We say f is a normalized eigenform if the ﬁrst nonzero Fourier coeﬃcient is 1. The arguments from Corollary 6.1.5 and Exercise 6.1.6 apply to show any Hecke eigenform has multiplicative Fourier coeﬃcients. Precisely, work out *Exercise 6.1.9. Let f = ∑ anqn ∈ Mk(N ) be a Hecke eigenform. Suppose gcd(m, n) = gcd(m, N ) = gcd(n, N ) = 1. Then a1amn = aman. In other words, the basis f1, . . . , fr which diagonalizes the Tn’s asserted above is a basis of Hecke eigenforms, and therefore a basis of Mk(N ) with multiplicative Fourier coeﬃcients in the sense of the previous exercise. We remark that there is a technicality here we have ignored, namely that the Petersson inner product ⟨f, g⟩ is only well deﬁned when at least f or g is a cusp form. So the above argument will 89 only technically show that Sk(N ) has a basis of eigenforms, but at least when N = 1, we will see how this implies one can extend the basis of eigenforms of Sk(N ) to a basis of eigenforms for Mk(N ) We remark that for a eigencusp form (a Hecke eigenform which is a cusp form) the ﬁrst nonzero Fourier coeﬃcient should be a1 in order for the Hecke operators to not force every Fourier coeﬃcient to be zero. Lemma 6.1.10. Let f = ∑ anqn ∈ Mk(1) be a Hecke eigenform and k > 0. Then a1 ̸= 0. Proof. Write Tmf = λmf = ∑ bnqn. Then b1 = am. Consequently am = λma1. In other words, if a1 = 0, then am = 0 for all n ≥ 0. Consequently f (z) = a0 ∈ M0(1). Corollary 6.1.11. Let f ∈ Mk(1). Then ∆2f is not a Hecke eigenform. In particular, this shows ∆2 is not an eigenform. Now let’s get to the ﬁrst step in showing the existence of Hecke eigenforms, which is showing the Hecke operators are commutative. Lemma 6.1.12. Suppose gcd(m, N ) = gcd(n, N ) = 1 and gcd(m, n) = 1. Then the Hecke operators on Mk(N ) satisfy TmTn = Tmn. Proof. Take f (z) = ∑ arqr ∈ Mk(N ). Write Tnf (z) = ∑ brqr and Tm(Tnf )(z) = ∑ crqr. Then br = ∑ d| gcd(n,r) d k−1anr/d2 so cr = ∑ e| gcd(m,r) ek−1bmr/e2 = ∑ e| gcd(m,r) ek−1 ∑ d| gcd(n,mr/e2) d k−1amnr/d2e2. Since gcd(m, n) = 1, d runs over the divisors of gcd(n, r/e), and therefore d′ = de runs over the divisors of mn and cr = ∑ d′| gcd(mn,r)(d ′)k−1amnr/(d′)2 so TmTn = Tmn. Lemma 6.1.13. Suppose p ∤ N . The Hecke operators on Mk(N ) satisfy Tpr Tps = ∑ d| gcd(pr,ps) d k−1Tpr+s/d2. (6.2) Proof. The proof here is modeled on the one in [Apo90, Theorem 6.13], but there appear to me to be errors in the r = 1 case of loc. cit. I believe I have corrected them. We may as well assume r ≤ s. First let’s show the r = 1 case, which just says TpTps = Tps+1 + p k−1Tps−1. 90 For f ∈ Mk(n), Tpsf (z) = p s(k−1) ∑ 0≤i≤s ∑ 0≤b<pi f | ps−i b 0 pi  ,k = ps(k−1) ∑ 0≤i≤s p−ik ∑ 0≤b<pi f ( ps−iz + b pi ) . (6.3) In particular Tpg(z) = p (k−1)g(pz) + p −1 ∑ 0≤b′<p g ( z + b′ p ) so TpTpsf (z) = p (s+1)(k−1) ∑ 0≤i≤s p−ik ∑ 0≤b<pi f ( ps+1−iz + b pi ) (6.4) + p −1ps(k−1) ∑ 0≤b′<p ∑ 0≤i≤s p−ik ∑ 0≤b<pi f ( ps−i(z + b′) + pb pi+1 ) . (6.5) Note the i = s term from (6.5) is p −1−s ∑ 0≤b′<p ∑ 0≤b<ps f ( z + b′ + pb ps+1 ) = p−1−s ∑ 0≤b<ps+1 f ( z + b ps+1 ) . Thus adding the i = s term from (6.5) to (6.4) gives (6.3) with s replaced by s + 1, i.e., they sum to Tps+1f (z). Now the remaining terms, i.e., the i < s terms from (6.5), are p−1p s(k−1) ∑ 0≤b′<p ∑ 0≤i≤s−1 p −ik ∑ 0≤b<pi f ( ps−1−iz + b + ps−1−ib′ pi ) If i ≤ s−1 2 , then ps−1−ib′ pi ∈ Z, so by periodicity of f there is no dependence on b′ and the contribution for such a ﬁxed i is ps(k−1)p −ik ∑ 0≤b<pi f ( ps−1−iz + b + ps−1−ib′ pi ) . (6.6) In fact, for any i, b + ps−1−ib′ mod pi runs over the set of residue classes mod pi exactly p times, so the contribution for any i is given again by (6.6). This proves the r = 1 case. Now we suppose (6.2) is true up to some ﬁxed r. By the r = 1 case we have Tpr+1Tps = (TpTpr ) Tps − pk−1Tpr−1Tps. By the inductive assumption that (6.2) is true for r, we also have Tp (Tpr Tps) = ∑ 0≤i≤r pi(k−1)TpTpr+s−2i. 91 Comparing these, and making another use of the r = 1 case, gives Tpr+1Tps = ∑ 0≤i≤r pi(k−1)TpTpr+s−2i − p k−1Tpr−1Tps = ∑ 0≤i≤r (p i(k−1)Tpr+s+1−2i + p(i+1)(k−1)Tpr+s−1−2i) − pk−1Tpr−1Tps. Expanding out the last term using the r − 1 case of (6.2) gives Tpr+1Tps = ∑ 0≤i≤r+1 pi(k−1)Tpr+s+1−2i. The previous two lemmas combine to give the following. Corollary 6.1.14. The Hecke operators {Tn}gcd(n,N )=1 on Mk(N ) commute. The former lemma also shows knowing what the prime power Hecke operators do tells you what all Hecke operators do, and the latter lemma shows that the prime power Hecke operators are determined by the prime Hecke operators. In particular, we see Corollary 6.1.15. If f ∈ Mk(N ) is an eigenform for each Tp with p ∤ N prime, i.e., Tpf = λpf for some λp ∈ C, then f is a Hecke eigenform. Proof. The r = 1 case of (6.2) says, for j = s − 1 ≥ 2, Tpj = TpTpj−1 − pk−1Tpj−2. If Tpif = λpif for some λpi whenever i < j, then we see Tpj f = Tp(λpj−1f ) − pk−1λpj−2f = λpj f where λpj = (λpλpj−1 − p k−1λpj−2) . (6.7) Hence by induction, we see if Tpf = λpf then Tpj f = λpj f for some λpj —precisely, with λj p satisfying the recursion in (6.7). Now let n be relatively prime to N , and write n = p e1 1 . . . per r . By Lemma 6.1.12, we have Tnf = ( r∏ i=1 Tpei i ) f = r∏ i=1 λpei i f. 92 6.2 Petersson inner product We know that Mk(Γ) is a ﬁnite dimensional complex vector space, and therefore can be made into a Hilbert space, i.e., an inner product space. The standard way to make a function space into a Hilbert space is with the L2 inner product. Namely, if f, g ∈ L2(X) for some space X, then the inner product is given by ⟨f, g⟩ = ∫ X f (x)g(x)dx. While modular forms are not L2 on H, they are essentially L2 on relevant Riemann surface X = Γ\\H. We say essentially here, because they are of course not actually functions on Γ\\H due to the automorphy transformation factor except in the uninteresting (constant) case of k = 0. Let’s see what happens when we naively try to make f ∈ Mk(Γ) into a function on X = Γ\\H. For simplicity, consider Γ = PSL2(Z) = ⟨S, T ⟩. We already have f (T z) = f (z + 1) = f (z) so f descends to a function on the inﬁnite cylinder ⟨T ⟩\\H. We would like to modify f to a function F = Ff which still satisﬁes F (z + 1) = F (z) but also satisﬁes F (Sz) = F (−1/z) = F (z). Since the invariance under T is a transformation rule in x = Re(z) which we don’t want to mess up, we might just try to impose invariance under S by modifying y = Im(z). Since f (S · iy) = f (−1/iy) = f (i/y) = (iy)kf (iy), it makes sense to consider the function (which will be called a Maass form) F (z) := yk/2f (z) = Im(z) k/2f (z). (6.8) Then we still have F (z + 1) = F (z) for all z and now F (−1/iy) = F (i/y) = y−k/2f (i/y) = ±i kyk/2f (iy) = (−1) k/2F (iy), so at least F (−1/iy) = F (iy) when k ≡ 0 mod 4. (One could let F (z) = (iy)k/2f (z) so that we actually have F (−1/iy) = F (iy), but one typically considers F as deﬁned in (??), since the sign (−1)k/2 will not matter in the end.) It doesn’t quite satisfy F (−1/z) = F (z) for all z but it will be close, and we can say how close. In general, for any f ∈ Mk(Γ), we can associate to f the Maass form F deﬁned by (6.8). Recalling that |j(γ, z)| 2 = Im(z) Im(γz) (6.9) (cf. (3.1)), we see F (γz) = Im(γz) k/2f (γz) = Im(γz) k/2j(γ, z) kf (z) = j0(γ, z)kIm(z)k/2f (z) = j0(γ, z) kF (z) where j0(γ, z) = j(γ, z) |j(γ, z)| . In other words, the Maass form F (not holomorphic) is not quite invariant under Γ, but it is up to a factor j0(γ, z) of absolute value 1. This is good enough for our purposes.∗ Namely, if also ∗We remark that one can make f invariant under Γ at the expense of working on a larger space than H. Namely, one has the surjective map PSL2(R) → H given by γ 7→ γ · i. Since SO(2) stabilizes i, one can view PSL2(R)/SO(2) ≃ H. Thus one can lift f to a function on PSL2(R) by f (γ) = f (γ·i) and deﬁne the automorphic form ϕf (γ) = j(γ, i) k/2f (γ). This makes ϕf invariant under Γ so it is a function on Γ\\PSL2(R). Hence, viewed as functions on PSL2(R), the passage from modular forms to automorphic forms trades right SO(2) invariance for left Γ invariance. 93 g ∈ Mk(Γ) and G(z) = Im(z)k/2g(z) is the associated Maass form, it means the product F (γz)G(γz) = j0(γ, z)kj0(γ, z) kF (z)G(z) = F (z)G(z) is invariant under Γ. Consequently, we can deﬁne the inner product ⟨f, g⟩ = ∫ X F (x)G(x)dω = ∫ Γ\\H ykF (z)G(z)dω, where dω is an area measure on the Riemann surface X = Γ\\H. Now in practice, you want to express this as an integral on a fundamental domain for Γ inside H, so we need to know what the hyperbolic measure should be. Lemma 6.2.1. The measure dxdy y2 = dzdz Im(z)2 is an invariant measure on the hyperbolic plane H, i.e., for γ ∈ PSL2(R) and we have ∫ H f (γz) dxdy y2 = ∫ H f (z) dxdy y2 , for any integrable (w.r.t. to this measure) function f on H. Proof. Write γ = ( a b c d ), and let w = γz = (ad + bc)x + bd + acy2 + iy c2x2 + c2y2 + d2 = u + iv. Note dw dz = 1 |cz + d|2 = ∂u ∂x + i ∂v ∂x = ∂v ∂y − i ∂u ∂y . Then the Jacobian determiant \f \f \f \f ∂x ∂u ∂y ∂u ∂x ∂v ∂y ∂v \f \f \f \f = \f \f \f \f \f ∂u ∂x ∂u ∂y ∂v ∂x ∂v ∂y \f \f \f \f \f −1 = \f \f \f \f|cz + d|−2 0 0 |cz + d|−2 \f \f \f \f −1 = |j(γ, z)| 4. Since |j(γ, z)|2 = Im(z) Im(γz) = y v , we have ∫ H f (γz) dxdy y2 = ∫ H f (w)|j(γ, z)|4 dudv y2 = ∫ H f (w) dudv v2 . Deﬁnition 6.2.2. Let f, g ∈ Mk(Γ). The Petersson inner product of f with g is deﬁned to be ⟨f, g⟩ := 1 [PSL2(Z) : Γ] ∫ Γ\\H ykf (z)g(z) dxdy y2 (6.10) whenever the integral converges. 94 The above discussion shows that the integrand is invariant under Γ, so the deﬁning integral makes sense, provided it converges. Consequently, we can also write this integral as ⟨f, g⟩ := 1 [PSL2(Z) : Γ] ∫ F ykf (z)g(z) dxdy y2 (6.11) where F is any fundamental domain for Γ. The normalization factor [PSL2(Z) : Γ]−1 roughly cancels out the volume of Γ\\H, deﬁned to be vol(Γ\\H) = ∫ Γ\\H dxdy y2 . Lemma 6.2.3. Let Γ be a congruence subgroup in PSL2(Z). Then vol(Γ\\H) is ﬁnite. Proof. Let F ′ be a fundamental domain for Γ. By Lemma 3.4.9, F ′ = [PSL2(Z):Γ]⋃ i=1 αiF, where F is the standard fundamental domain for PSL2(Z) and αi ∈ PSL2(Z). Since the area measure is invariant under the action of PSL2(R), vol(F ′) = ∑ vol(αiF) = [PSL2(Z) : Γ]vol(F), so it suﬃces to show F has ﬁnite volume. Note vol(F) = ∫ 1/2 −1/2 ∫ ∞ √1−x2 dx dy y2 ≤ ∫ 1/2 −1/2 ∫ ∞ 1/2 dx dy y2 = 2 ∫ 1/2 −1/2 dx = 2. The proof is of course valid not just for congruence subgroups, but any ﬁnite index subgroup of PSL2(Z), and consequently any subgroup of PSL2(R) commensurable with PSL2(Z). Exercise 6.2.4. Compute vol(X0(1)) = vol(PSL2(Z)\\H). While not that interesting, the above lemma implies the Petersson inner product converges for f, g ∈ M0(Γ) = C. The issue in general is that, say for the standard fundamental domain of PSL2(Z), the yk can grow too fast for the Petersson inner product to converge unless f (z)g(z) → 0 as y → ∞. Similarly, if we tend to a cusp in Q, f (z)g(z) may grow too fast (cf. Section 4.3) for the inner product to converge. This suggests (when k > 0) we need f or g to be a cusp form for ⟨f, g⟩ to converge. Proposition 6.2.5. Let f, g ∈ Mk(Γ). The Petersson inner product ⟨f, g⟩ converges if either f ∈ Sk(Γ) or g ∈ Sk(Γ). Proof. We assume f ∈ Sk(Γ). The case g ∈ Sk(Γ) is similar. Let F be a fundamental domain for Γ\\H and F be its closure in H. Write F = K ∪ ⋃ Ui, where this is a ﬁnite union of subsets with K compact in H and each Ui ⊂ H containing exactly one cusp, say zi. Since yk−2f (z)g(z) is bounded on K it suﬃces to show this is bounded on each Ui. As in the proof of Lemma 4.5.8, we know f (z) → 0 exponentially fast as z → zi, whereas yk−2g(z) has at most a ﬁnite order pole at zi. Thus yk−2f (z)g(z) is bounded on each Ui, and because vol(F) = vol(F) < ∞, the Petersson inner product converges. 95 What this means is that the Petersson inner product deﬁnes an inner product (it is clearly sesquilinear, i.e., linear in the ﬁrst vector and anti, or conjugate, linear in the second) on the space of cusp forms Sk(N ). This inner product almost extends to an inner product on Mk(N ), but ⟨f, g⟩ need not converge when both f and g are not cusp forms. While we have failed to make Mk(N ) a Hilbert space, we have at least made SK(N ) one. Most importantly, the inner product commutes with the Hecke operators. Theorem 6.2.6. The Hecke operators {Tn} on Sk(N ) are hermitian with respect to the Petersson inner product, i.e., ⟨Tnf, g⟩ = ⟨f, Tng⟩ for f, g ∈ Sk(N ). Proof. Fix a fundamental domain F for Γ0(N ). For simplicity of notation, we extend ⟨f, g⟩ by the (6.11) to any functions on H for which the integral converges. First we claim that for any τ = ( a b c d ) ∈ PSL2(R), we have ⟨f |τ,k , g⟩ = ⟨f , g|τ −1,k⟩, where we extend |τ,k to τ ∈ GL2(R)+ = {α ∈ GL2(R) : det(α) > 0} by (4.10). (The condition of positive determinant ensures τ maps H to H.) This follows since ykf (z)|τ,k g(z) = Im(z)k (cz + d)k f (τ z)g(z) = Im(w) k(cz + d) kf (w)g(τ −1w). where we put w = τ z and used (6.9). Then observing (cz + d)k = j(τ, z)k = j(τ −1, w)−k shows this equals Im(w) kf (w)g(w)|τ −1,k which implies our claim. Recall Tnf = nk−1 ∑ µ∈SL2(Z)\\Mn(Z) f |µ,k = nk−1 r∑ i=1 f |µi,k Where µ1, . . . , µr is a set of representatives for SL2(Z)\\Mn(Z). Let ν = (√n 0 0 √n ) and write µi = ντi where τi ∈ PSL2(R). Then ⟨Tnf, g⟩ = nk−1 ∑ ⟨f |µi,k, g⟩ = nk−1 ∑⟨(f |ν,k)|τi,k, g⟩ = nk−1 ∑ ⟨(f |ν,k), g|τ −1 i ,k⟩. Note f (z)|ν,k = n−k/2f (z). Hence ⟨Tnf, g⟩ = nk−1 ∑ n−k/2⟨f, g|τ −1 i ,k⟩ = nk−1 ∑ ⟨f, g|τ −1 i ν,k⟩ = ⟨f, Tng⟩. Here the last equality follows because τ −1 i ν also runs over a set of representatives for SL2(Z)\\Mn(Z), whence Tng = nk−1 ∑ g|τ −1 i ν,k. 96 Corollary 6.2.7. The space Sk(N ) has a basis consisting of Hecke eigenforms. Proof. Since {Tn} is a family of commuting operators which are hermitian with respect to ⟨·, ·⟩, a well known theorem in linear algebra tells us that an orthonormal basis with respect to ⟨·, ·⟩ is a basis of eigenvectors for all {Tn}. By Exercise 6.1.9, we know the normalized (a1 = 1) Hecke eigenforms in Sk(N ) have Fourier coeﬃcients an which are multiplicative for n relatively prime to the level N . Hence the cusp forms are generated by forms whose Fourier coeﬃcients are some kind of arithmetic sequences. There are some more questions we can ask at this point to push our theory further. • Does the whole space of modular forms Mk(N ) actually have a basis of Hecke eigenforms? • Can we deﬁne the Hecke operators Tn on Mk(N ) when gcd(n, N ) > 1? • Can we actually ﬁnd a basis for Sk(N ) (or Mk(N )) whose Fourier coeﬃcients an are multi- plicative for all n? Here we will just brieﬂy discuss these questions. First, observe that Theorem 6.2.6 is actually valid for f, g ∈ Mk(N ) when ⟨Tnf, g⟩ converges. One can use this to deduce that Mk(N ) does have a basis of eigenforms, and in fact we already know it at least one case. Example 6.2.8. The space Mk(1) has a basis of Hecke eigenforms. To see this, recall Mk(1) = CEk ⊕ Sk(1). By Exercise 6.0.1, we know Ek is an eigenform, hence the basis of eigenforms for Sk(1) can be extended to a basis of eigenforms for Mk(1). In fact, the Eisenstein series (for Mk(N ), or more generally for Mk(Γ)) are orthogonal to the space of cusp forms in the sense that ⟨E, f ⟩ = 0 whenever E is an Eisenstein series and f is a cusp form. Often one uses this relation to deﬁne Eisenstein series: the space of Eisenstein series for Mk(Γ) will be the elements E ∈ Mk(Γ) such that ⟨E, f ⟩ = 0 for all f ∈ Sk(Γ). Next, one can deﬁne Hecke operators Tn on Mk(N ) when gcd(n, N ) > 1, however a deﬁnition in terms of Mn,N (Z) is somewhat trickier as the analogue Lemma 6.1.3 is not as nice. For simplicity, let’s just talk about Tp where p|N , since all the Tn’s can be constructed out of just the Tp’s. One can deﬁne Tpf = ∑ 0≤j<p f | 1 j 0 p  ,k, and if f (z) = ∑ anqn, one obtains Tpf (z) = ∑ apnqn. The deﬁnition of Hecke operators can be made more uniform (including for arbitrary congruence subgroups Γ) by working in terms of double cosets (see, e.g., [DS05] or [Kob93]). While the Hecke operators Tp for p|N can be deﬁned without much trouble, one does not in general have a basis of eigenforms for Sk(N ) for all Tn. Roughly the issue is the following. Say N = pq with p, q distinct primes and f ∈ Sk(q) is a Hecke eigenform. In particular, f is an eigenform for Tp (on Sk(q)) Then automatically f ∈ Sk(N ). However Tp on Sk(N ) acts diﬀerently, so f is no longer an eigenform for Tp. 97 More generally, if d|N and f (z) ∈ Sk(N/d), then f (dz) ∈ Sk(N ) and we the subspace generated by all such elements the space Sold k (N ) of old forms. Deﬁne the space of new forms Snew k (N ) to be its orthogonal complement in Sk(N ) (w.r.t. the Petersson inner product). Then it is true that Snew k (N ) has a basis of eigenforms for all Tp, as opposed to just for p ∤ N . Finally we remark that the theory of Hecke operators for an arbitrary congruence subgroup Γ is similar. See [Ste07] for how to computationally ﬁnd a basis of Hecke eigenforms for a given space Mk(Γ). 98 7 L-functions One of the main themes in modern number theory, is to associate to various objects (number ﬁelds, Dirichlet characters, Galois representations, elliptic curves, modular forms) an analytic gadget called an L-function. The idea comes from the theory of the Riemann zeta function, so before we introduce L-functions for modular forms, we recall some basic facts about the zeta function and Dirichlet L- functions. NOTE: This chapter is readable, but not as complete as I would like. Speciﬁcally, I didn’t have enough time in my mind to say why you should care about L-functions of modular forms, e.g., the relation with elliptic curves and Fermat’s last theorem. I hope to someday ﬂesh out this chapter more. 7.1 Degree 1 L-functions Let’s begin by reviewing the zeta function. Then we will review some facts about Dirichlet L- functions. Both of these are considered “degree 1” L-functions, which will be explained later. 7.1.1 The Riemann zeta function First recall the Riemann zeta function is deﬁned by ζ(s) = ∑ 1 ns (7.1) for s ∈ C with Re(s) > 1. Then ζ(s) can be (uniquely) meromorphically continued to a function of the whole complex plane with only a simple pole at s = 1. Euler (who considered ζ(s) for s real) observed ζ(s) = ∑ 1 ns = ∏ p 1 1 − p−s . (7.2) Since each factor on the right converges at s = 1, the fact that ζ(s) has a pole at s = 1 implies there are inﬁnitely many prime numbers. This is the ﬁrst hint that the analytic behaviour of ζ(s) can encodes deep arithmetic information. One important feature of ζ(s) is its functional equation relating the values at s to the values at 1 − s. Namely, recall the gamma function is deﬁned by Γ(s) = ∫ ∞ 0 ts−1e−sdt (7.3) for Re(s) > 0. Then Γ(s) has meromorphic continuation to C with simple poles at s = 0, −1, −2, . . .. Further Γ satisﬁes the functional equation Γ(s + 1) = sΓ(s) and one easily computes from the deﬁnition that Γ(1) = 1. Hence, by induction, the functional equation implies Γ(n + 1) = n! for n ∈ N. Then the functional equation for ζ(s) can be written ζ(s) = 2 sπs−1 sin ( πs 2 ) Γ(1 − s)ζ(1 − s). 99 One can rewrite this functional equation more simply in terms of the completed zeta function Z(s) = s(s − 1) 2πs/2 Γ ( s 2 ) ζ(s) as Z(s) = Z(1 − s). Either way, the functional equation means one can obtain the values for ζ(s) from the values of ζ(1 − s). In particular, if Re(s) < 0, then Re(1 − s) > 1 so one can also use (7.1) to evaluate ζ(s) on the left half-plane Re(s) < 0. The in-between region, 0 ≤ Re(s) ≤ 1 is called the critical strip and line of symmetry Re(s) = 1 2 is called the critical line. As is now famous, the zeros of the Riemann zeta function are intimately connected with prime numbers. Speciﬁcally, let ψ(x) = ∑ pk≤x log p be the Chebyshev function, which counts the number of prime powers up to x. Then one can show the astounding explicit formula ψ(x) = x − ∑ ρ xρ ρ − log 2π, (7.4) where ρ runs over the zeroes of ζ(s) (including the “trivial zeroes” to the left of the the critical strip). Consequently, if we knew where all the zeroes of ζ(s) lay, we would know exactly where all the prime powers are. Regardless, one can already use (7.4) to prove the prime number theorem π(x) := # {p : p ≤ x} ∼ ψ(x) log x ∼ x log x . The very deep Riemann hypothesis asserts that all nontrivial zeroes (all zeroes inside the critical strip) actually lie on the critical line, and this would give an optimal bound on the error term in the prime number theorem. In another direction, special values of ζ(s) tell us interesting arithmetic information. For in- stance, Euler showed that for n ∈ N, ζ(2n) = (−1) n+1 B2n · (2π)2n 2(2n)! . (7.5) One can interpret 1/ζ(2n) as the probability that 2n integers chosen at random are relatively prime (this is a simple consequence of (7.2)). Based on this expression, one might ask, when n is odd, if ζ(n) = cπn for some c ∈ Q? While this is not known (even for ζ(3)), it is expected the answer is no. One heuristic reason why values at the even and odd integers should be diﬀerent comes by looking the functional equation. Namely, the expression (7.5) simpliﬁes to ζ(1 − 2n) = − B2n 2n . Thus it appears the arithmetic of the special values of ζ(2n) is made more clear by looking at ζ(1 − 2n). On the other hand by the function equation and that Γ(s) has poles at negative integers, 100 in order for ζ(s) to be holomorphic we need ζ(−2n) = 0. (These are the trivial zeroes—note the functional equation does not produce zeroes at negative odd integers because then the vanishing of sin ( πs 2 ) cancels the pole from Γ(1 − s).) Since ζ(2n + 1) corresponds to ζ(−2n) = 0, there is no indication that ζ(s) at positive odd integers should follow the same sort of arithmetic behaviour as at positive even integers. (In light of the probabilistic interpretation of 1/ζ(n), this is perhaps analogous to the diﬀerence between rk(n), i.e., ϑk(z), for k odd and even.) 7.1.2 Dirichlet L-functions Deﬁnition 7.1.1. We say χ : Z → C is a Dirichlet character mod N if (i) χ(n) = χ(n + N ) for all n ∈ Z; (ii) χ(n) = 0 ⇐⇒ gcd(n, N ) > 1; (iii) χ(1) = 1; and (iv) χ(mn) = χ(m)χ(n) for all m, n ∈ Z. The standard way to construct a Dirichlet character is to take a character χ of (Z/N Z)×, extend it to Z/N Z by setting it to 0 on all the noninvertible residue classes, then lifting it to a function of Z. It is easy to see this satisﬁes the above deﬁnition, and conversely any Dirichlet character arises in such a way. Then one deﬁnes the Dirichlet L-function for a Dirichlet character χ to be L(s, χ) = ∞∑ n=1 χ(n) ns , (7.6) for Re(s) > 1. (Condition (i) in the deﬁnition implies χ is bounded, so the series converges absolutely for Re(s) > 1.) Since χ is multiplicative, again one an Euler product expansion L(s, χ) = ∞∑ n=1 χ(n) ns = ∏ p 1 1 − χ(p)p−s . (7.7) As with ζ(s), one can show L(s, χ) has meromorphic continuation to C, but this time it will in fact be entire whenver χ is a nontrivial character (i.e., does not come from the trivial character of (Z/N Z)×). Because the Dirichlet characters mod N allow one to distinguish among the diﬀerent residue classes mod N , these Dirichlet L-functions provide a way to study primes lying in arithmetic pro- gressions. Speciﬁcally, Dirichlet showed that L(1, χ) ̸= 0 for each nontrivial χ, and used this to prove that for any b relatively prime to N , there are inﬁnitely many primes of the form aN + b, a, b ∈ N. Again in analogy with the Riemann zeta function, Dirichlet L-functions have functional equa- tions. If χ is a “primitive” Dirichlet character mod N , the completed Dirichlet L-function is Λ(s, χ) = ( N π ) s+ϵ 2 Γ ( s + ϵ 2 ) L(s, χ) (7.8) where ϵ ∈ {0, 1} is the order of χ(−1), i.e., ϵ = 0 if χ(−1) = 1 and ϵ = 1 if χ(−1) = −1. Then the functional equation reads Λ(s, χ) = (−i)ϵ√N ( n∑ n=1 χ(n)e 2πin/N ) Λ(1 − s, χ). (7.9) 101 Note here the functional equation does not relate L(s, χ) with L(1 − s, χ) in general, but rather with L(1 − s, χ), where χ is the complex conjugate of χ (also a Dirichlet character mod N ). However if χ is real valued, which is equivalent to χ2 is trivial, then χ = χ and this functional equation relates L(s, χ) with L(1 − s, χ). In any case, one can still recover the values of L(s, χ) for Re(s) < 0 using the function equation (7.9) together with the series for L(1 − s, χ). The generalized Riemann hypothesis (GRH) asserts that any zeroes of L(s, χ) inside the critical strip 0 ≤ Re(s) ≤ 1 in fact lie on the critical line Re(s) = 1 2 . As one might expect from analogy with the Riemann hypothesis, GRH would tell us, up to a very precise error, how many primes ≤ x lie in a given arithmetic progression. (An asymptotic is already known by the Chebotarev density theorem.) What is perhaps more surprising, is that GRH also implies the weak Goldbach conjecture that every odd number > 7 is a sum of 3 odd primes. Again, just like with ζ(s), there are formulas for special values of L(s, χ). Let d be squarefree, and consider the quadratic extension K = Q( √d) of Q of discriminant ∆ (here ∆ = 4d if d ≡ 2, 3 mod 4 and ∆ = d if d ≡ 1 mod 4). and the Dirichlet character mod ∆ given by χ∆(n) = ( ∆ n ) , where (∆ n) is the Kronecker symbol. In particular, if p is an odd prime not dividing ∆, χ∆(p) = 1 if ∆ is a square mod p and χ∆(p) = −1 otherwise. If d < 0, i.e., K is imaginary quadratic, the Dirichlet class number formula says L(1, χ∆) = 2πhK w√|∆| , where hK is the class number of K and w is the number of roots of unity in K, i.e., w = 6 if d = −3, w = 4 if d = −1 and w = 2 otherwise. If d > 0, i.e., K is a real quadratic ﬁeld, then Dirichlet’s class number formula says L(1, χ∆) = 2 log ηhK√∆ , where η > 1 is the fundamental unit in the ring of integers of K. Since the class number is a fundamental, yet mysterious, invariant of a number ﬁeld, we see that special values (in this case at s = 1) of L-functions encode interesting arithmetic information. 7.2 The philosophy of L-functions In general, what is an L-function? There is no widely accepted answer yet as to what precisely constitutes an L-function, or what objects give rise to L-functions. However based on examples, there are certain properties L-functions should satisfy, similar to ζ(s) and the Dirichlet L-functions. Suppose one has an object X described by some data a1, a2, a3, . . ., one can study the sequence (an) forming the (formal) L-series (or Dirichlet series) for X L(s, X) = ∞∑ n=1 an ns . Exercise 7.2.1. Suppose |an| = O(nm) for some m, i.e. there exists a constant C such that |an| ≤ Cnm for all n. Show L(s, X) converges absolutely for Re(s) > 1 + m. 102 No matter what the original object X was, the L-series only depends on the sequence (an), so for the present purposes we could just assume the object X is the sequence (an), and so we will sometimes write X = (an) below. An L-series is just a series of the form ∑ an ns , but just requiring convergence on a right half plane does not give all the properties one would like to have an L-function. Based on the theory of Dirichlet L-functions and ζ(s), in order for L(s, X) to be called an L-function, one might also ask that • L(s, X) has meromorphic continuation to C; • L(s, X) has a functional equation L(s, X) = σ(s, X)L(k − s, ˇX) for some “simple” function σ(s, X), some k ∈ R and some related object ˇX; • L(s, X) should have an Euler product L(s, X) = ∏p Lp(s, X), for some “simple” local factors Lp(s, X).† Example 7.2.2. Let X = K be a number ﬁeld, i.e., a ﬁnite extension of Q. Let OK be its ring of integers, and an be the number of ideals of norm n. In particular, if K = Q, then an = 1 for all n so L(s, Q) = ζ(s). More generally, L(s, K) = ζK(s) is the Dedekind zeta function for K. The Dedekind zeta function also satisﬁes all properties listed above. Example 7.2.3. Let χ be a Dirichlet character and an = χ(n). Then L(s, χ) is the Dirichlet L-function we deﬁned earlier. Let’s elaborate on the Euler product condition a little more. How did we get the Euler product for Dirichlet L-functions? It came from the fact that χ(n) is multiplicative—in fact totally mul- tiplicative. Recall a sequence (an) is multiplicative (resp. totally multiplicative) if amn = aman for gcd(m, n) = 1 (resp. for all m, n). Exercise 7.2.4. Let X = (an) be a multiplicative sequence such that |an| = O(nm), and deﬁne the local L-factor Lp(s, X) = 1 + ap ps + ap2 p2s + ap3 p3s + · · · Show Lp(s, X) converges absolutely for Re(s) > 1 + m, and that on this half-plane, we have the product formula L(s, X) = ∞∑ n=1 an ns = ∏ p Lp(s, X). A priori, there is no reason for Lp(s, X) to have a simple expression. In the case of Dirichlet L-functions, the local L-factor Lp(s, χ) = 1 1−χ(p)p−s simply because χ(pj) = χ(p)j. More generally, we need, for each p, a relation among the apj ’s in order for Lp(s, X) to simplify. Suppose, for a ﬁxed p, the terms apj satisfy a degree d linear recurrence relation: apj+d = c0apj + c1apj+1 + · · · + cd−1apj+d−1. †One may not be able to make L(s, X) have an Euler product for all X in the space of interest—e.g., modular forms—but only certain “nice” X—e.g., Hecke eigenforms. 103 Then one can show the local L-factor is of the form Lp(s, X) = 1 F (p−s) where F is a polynomial (depending on c0, . . . , cd−1, which depend upon p) of degree ≤ d. For instance, for a Dirichlet character χ and a prime p, then the polynomial F (t) = 1 − χ(p)t. For Lp(s, X) of this form, call the degree of F the degree of Lp(s, X). If X = f is a Hecke eigenform and the an’s are its Fourier coeﬃcients, then the theory of Hecke operators tells us the Fourier coeﬃcients apj satisfy a degree 2 linear recursion, so the local L-factors should be reciprocals of (typically) quadratic polynomials in p−s. (For a ﬁnite number “bad” primes, the L-factor may be trivial or (a reciprocal of a) linear (polynomial).) Typically, the “degree” of almost all (all but ﬁnitely many) local L-factors, Lp(s, X), will be the same, and we will call this the number the degree of the L-function L(s, X). This explains why the Riemann zeta function and Dirichlet L-functions are called degree 1 L-functions, and the L-functions of modular forms are called degree 2 L-functions. The properties above are some properties we want L-functions to satisfy, but are probably not strong enough to say any function with these properties should be the L-function of some object. In the next section, we will describe some conditions that are suﬃcient to ensure an L-series is the L-function of a modular form. Just as with Dirichlet L-functions, when one can construct an L-function L(s, X) for some object X, one should expect the following. • The analytic properties—namely the location of the zeroes and poles—of L(s, X) should reveal deep information about X. • For certain special points s = s0, there should be a meaningful formula for special value L(s0, X). 7.3 L-functions for modular forms As was suggested in the previous section, if f (z) = ∑∞ n=0 anqn is a modular form, we will deﬁne its L-series by L(s, f ) = ∑∞ n=1 an ns . Obviously replacing f with a multiple cf replaces L(s, f ) with cL(s, f ), so one often assumes f is normalized so its ﬁrst nonzero Fourier coeﬃcient is 1. For convergence of L(s, f ), we need the following simple estimate on Fourier coeﬃcients of cusp forms, due to Hardy and Hecke. Proposition 7.3.1. (The Hecke, or trivial, bound) Let f (z) = ∑ anqn ∈ Sk(N ). Then, |an| = O(nk/2), i.e., for some constant C, we have |an| ≤ Cn k/2. (7.10) Proof. From our discussion at the beginning of Section 6.2, we know f (z)f (z)yk = |f (z)yk/2|2 is Γ0(N ) invariant. If F is a fundamental domain for Γ0(N ), f being a cusp form means f (z) → 0 as z ∈ F tends to a boundary point in Q ∪ {i∞}. Consequently, as in the proof of Proposition 6.2.5, we see |f (z)yk/2| is bounded on F, and by invariance, bounded on H. Say |f (z)yk/2| ≤ C1 for all z ∈ H. 104 Then for ﬁxed y > 0, ane −2πny = \f \f \f \f ∫ 1 0 f (x + iy)e −2πinze −2πnydx\f \f \f \f = \f \f \f \f ∫ 1 0 f (x + iy)e −2πinxdx\f \f \f \f ≤ C1y−k/2. Setting y = 1 n gives the desired bound. The Ramanujan conjecture (proved by Deligne) is that one actually has |an| ≤ Cn(k−1)/2, for some C (depending on f but not n). This is very deep and it is the best bound possible. (In analytic number theory, knowing the exponents in such bounds is crucial for applications, and even a small improvement in the exponent is often considered major progress.) Compare these bounds with those for Eisenstein series, which are simple to obtain. We explained this earlier, but it may be good to go over it on your own now. Exercise 7.3.2. Write Ek(z) = ∑ anqn. Show |an| = O(nk−1) and that this exponent is sharp, i.e., |an| ̸= O(nk−1−ϵ) for any ϵ > 0. Example 7.3.3. Recall from Example 5.2.10, we have r12(n) = 8σ5(n) − 512σ5(n/4) + 16an, where the an’s are the Fourier coeﬃcients of the cusp form Fη. Hence Hecke’s bound tells us r12(n) = 8σ5(n) − 512σ5(n/4) + O(n3), or more simply for n ̸≡ 0 mod 4, r12(n) = 8σ5(n) + O(n3). As in the above exercise, we see that σ5(n) roughly grows at the rate of n5. The Ramanujan conjecture says in fact the bound on the error is O(n5/2). Deﬁnition 7.3.4. Let f (z) = ∑ anqn ∈ Mk(N ). The (Hecke) L-function associated to f is given by L(s, f ) = ∞∑ n=1 an ns , where this sum converges. The completed L-function associated to f is given by Λ(s, f ) = ( √N 2π )s Γ(s)L(s, f ). By Exercises 7.2.1 and 7.3.2, we see if f = Ek ∈ Mk(1) then L(s, f ) converges for Re(s) > k. In fact this is true for any f ∈ Mk(N ). If f ∈ Sk(N ), then by Hecke’s bound we see L(s, f ) converges for Re(s) > 1 + k/2. In fact, for cusp forms the Ramanujan conjecture tells us L(s, f ) converges in the slightly larger right half-plane Re(s) > 1 + (k − 1)/2. We remark that unless f is an eigenform, L(s, f ) will not have an Euler product in general, but we will still call these L-functions as they at least have meromorphic continuation and functional equation. 105 Lemma 7.3.5. Let f ∈ Mk(N ) and consider the Fricke involution ˇf (z) := 1 N k/2zk f ( −1 N z ) . Then ˇ∈Mk(N ). Moreover, if f ∈ Sk(N ), then so is ˇf . Proof. We can write ˇf (z) = (det ω)k/2 j(ω, z)k f (ωz) = (det ω)k/2f |ω(z), where ω = ( 0 −1 N 1 ) . One sees ω (a b c d ) ω−1 = ( d −c/N −bN a ) so ω normalizes Γ0(N ). Then if γ ∈ Γ0(N ), we compute ˇf |γ = (det ω) k/2f |ωγ = (det ω) k/2f |γ′ω = (det ω)k/2f |ω = ˇf , where γ′ = ωγω−1 ∈ Γ0(N ). Hence ˇf satisﬁes the correct modular transformation law. Holomorphy and holomorphy at the cusps follow automatically. Similarly if f is zero at the cusps it is easy to see ˇf is also. Note if N = 1, then ˇf = f . Theorem 7.3.6. Let f (z) = ∑ anqn ∈ Mk(N ). The completed L-function Λ(s, f ) can be continued to a meromorphic function in s satisfying Λ(s, f ) = (−1) k/2Λ(k − s, ˇf ), with at most simple poles at s = 0 and s = k. Furthermore, if f ∈ Sk(N ), then Λ(s, f ) is entire and bounded in vertical strips, i.e., Λ(s, f ) is bounded when Re(s) is. Proof. (Sketch) The key to the proof comes from using an integral representation for Λ(s, f ). Namely, we look at the Mellin transform of f for Re(s) > k, ∫ ∞ 0 f (iy)ys−1dy = ∫ ∞ 0 ∑ ane −2πnyys−1dy = Γ(s) (2π)s L(s, f ) = N −s/2Λ(s, f ). Write ˇf (z) = ∑ bnqn. Then one can show Λ(s, f ) + a0 s + (−1) k/2 b0 k − s = ∫ ∞ 1 f (iy/ √N ) − a0)ys−1dy + ∫ ∞ 1 ( ˇf (iy/ √N ) − b0)yk−s−1dy. Since f (iy/ √N ) − a0 and ( ˇf (iy/ √N ) − b0 are of rapid decay when y → ∞, the integrals on the right converge absolutely, analytically continue to entire functions of s, and are bounded on vertical strips. A similar expression for Λ(s, ˇf ) gives the functional equation. 106 Theorem 7.3.7. Suppose f (z) = ∑ anqn ∈ Sk(1) be a Hecke eigenform. Then L(s, f ) = ∏ p 1 1 − a −s p + pk−1p−2s . Theorem 7.3.8. (Hecke’s converse theorem) Let (an) be a sequence such that |an| = O(nm) for some m, and k ∈ 2N. Suppose Λ(s) = Γ(s) (2π)s ∞∑ n=1 an ns has meromorphic continuation to C, Λ(s) = (−1) k/2Λ(k − s) and Λ(s) + a0 s + (−1) k/2 a0 k − s is entire and bounded in vertical strips. Then f (z) = ∞∑ n=0 anqn ∈ Mk(1). This provides an analytic way to show something is a modular form! Roughly it says, given a sequence (an) of polynomial growth, the Dirichlet series L(s) = ∑ an ns is the L-function of a modular form L(s) = L(s, f ) if it satisﬁes certain nice properties (stated above in terms of Λ(s)). In other words, if the Dirichlet series is nice, then the sequence (an) is actually the Fourier coeﬃcients for a modular form! There is also a converse theorem for Mk(N ), due to Weil, but it requires more than just the niceness of a single function L(s). It roughly says, given a sequence (an) of polynomial growth, the Dirichlet series L(s) = ∑ an ns is the L-function of a modular form in Mk(N ) if the set of twisted L-series L(s, χ) = ∑ anχ(n) ns satisfy certain nice properties for all Hecke characters χ. (You may think of Hecke characters as a more general kind of Dirichlet chacters.) To put this in context, we will summarize the primary methods of constructing modular forms: • Use an averaging procedure (e.g., as with our Eisenstein series and Hecke operators). • Construct a suitable η-quotient. • Use theta series. • Use the converse theorem. • Use the trace formula (which we will not describe). 107 Both the method of the converse theorem and the trace formula are not truly constructive, but they provide a way of showing something you suspect should be a modular form actually is a modular form. The simplest instance of this is the following. Since the L-function L(s, f ) of a modular (eigen)form is a degree 2 Euler product, one might ask if you can construct some such f by asking that L(s, f ) is a product of 2 known degree 1 L-functions. Example 7.3.9. Put L(s) = ζ(s)ζ(s − k + 1) for k ∈ 2N. One can see by Hecke’s converse theorem, that L(s) is the L-function of a modular form of weight k. In fact L(s) = L(s, Ek). More generally, if χ1 and χ2 are primitive Dirichlet characters mod N1 and N2, then L(s, χ1)L(s − k + 1, χ2) = L(s, f ) for some f ∈ Mk(Γ1(N1N2)). If χ1 = χ−1 2 , then in fact f ∈ Mk(N 2 1 ) = Mk(Γ0(N 2 1 )). However, this construction will not yield a cusp form. In fact, one can show that the modular forms f constructed this way will span the space of Eisenstein series for Γ1(N ), where N = N1N2. From the Euler product for L(s, f ), one can deduce that f is a Hecke eigenform. Thus the space of Eisenstein series, and therefore Mk(Γ1(N )), and by restriction Mk(N ), also has a basis consisting of eigenforms. 108 References [Ahl78] Lars V. Ahlfors. Complex analysis. McGraw-Hill Book Co., New York, third edition, 1978. An introduction to the theory of analytic functions of one complex variable, International Series in Pure and Applied Mathematics. [And05] James W. Anderson. Hyperbolic geometry. Springer Undergraduate Mathematics Series. Springer-Verlag London Ltd., London, second edition, 2005. [Apo90] Tom M. Apostol. Modular functions and Dirichlet series in number theory, volume 41 of Graduate Texts in Mathematics. Springer-Verlag, New York, second edition, 1990. [Boy01] Matthew Boylan. Swinnerton-Dyer type congruences for certain Eisenstein series. In q- series with applications to combinatorics, number theory, and physics (Urbana, IL, 2000), volume 291 of Contemp. Math., pages 93–108. Amer. Math. Soc., Providence, RI, 2001. [Bum97] Daniel Bump. Automorphic forms and representations, volume 55 of Cambridge Studies in Advanced Mathematics. Cambridge University Press, Cambridge, 1997. [CSS97] Gary Cornell, Joseph H. Silverman, and Glenn Stevens, editors. Modular forms and Fer- mat’s last theorem. Springer-Verlag, New York, 1997. Papers from the Instructional Con- ference on Number Theory and Arithmetic Geometry held at Boston University, Boston, MA, August 9–18, 1995. [DS05] Fred Diamond and Jerry Shurman. A ﬁrst course in modular forms, volume 228 of Grad- uate Texts in Mathematics. Springer-Verlag, New York, 2005. [Els06] Jürgen Elstrodt. A very simple proof of the eta transformation formula. Manuscripta Math., 121(4):457–459, 2006. [FB09] Eberhard Freitag and Rolf Busam. Complex analysis. Universitext. Springer-Verlag, Berlin, second edition, 2009. [Iwa97] Henryk Iwaniec. Topics in classical automorphic forms, volume 17 of Graduate Studies in Mathematics. American Mathematical Society, Providence, RI, 1997. [Kat92] Svetlana Katok. Fuchsian groups. Chicago Lectures in Mathematics. University of Chicago Press, Chicago, IL, 1992. [Kil08] L. J. P. Kilford. Modular forms. Imperial College Press, London, 2008. A classical and computational introduction. [Kob93] Neal Koblitz. Introduction to elliptic curves and modular forms, volume 97 of Graduate Texts in Mathematics. Springer-Verlag, New York, second edition, 1993. [Lan95] Serge Lang. Introduction to modular forms, volume 222 of Grundlehren der Mathematis- chen Wissenschaften [Fundamental Principles of Mathematical Sciences]. Springer-Verlag, Berlin, 1995. With appendixes by D. Zagier and Walter Feit, Corrected reprint of the 1976 original. 109 [Lan99] Serge Lang. Complex analysis, volume 103 of Graduate Texts in Mathematics. Springer- Verlag, New York, fourth edition, 1999. [Mil] J.S. Milne. Modular functions and modular forms. Online course notes. http://www.jmilne.org/math/CourseNotes/mf.html. [Miy06] Toshitsune Miyake. Modular forms. Springer Monographs in Mathematics. Springer- Verlag, Berlin, english edition, 2006. Translated from the 1976 Japanese original by Yoshitaka Maeda. [Sch74] Bruno Schoeneberg. Elliptic modular functions: an introduction. Springer-Verlag, New York, 1974. Translated from the German by J. R. Smart and E. A. Schwandt, Die Grundlehren der mathematischen Wissenschaften, Band 203. [Ser73] J.-P. Serre. A course in arithmetic. Springer-Verlag, New York, 1973. Translated from the French, Graduate Texts in Mathematics, No. 7. [Sta09] John Stalker. Complex analysis. Modern Birkhäuser Classics. Birkhäuser Boston Inc., Boston, MA, 2009. Fundamentals of the classical theory of functions, Reprint of the 1998 edition. [Ste07] William Stein. Modular forms, a computational approach, volume 79 of Graduate Studies in Mathematics. American Mathematical Society, Providence, RI, 2007. With an appendix by Paul E. Gunnells. [Zag08] Don Zagier. Elliptic modular forms and their applications. In The 1-2-3 of modular forms, Universitext, pages 1–103. Springer, Berlin, 2008. 110","libVersion":"0.3.1","langs":""}
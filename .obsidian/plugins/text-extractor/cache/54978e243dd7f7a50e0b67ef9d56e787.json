{"path":"iCloudDrive/bks/Algebra/Algebra/Generating Functions/Generating Functions - Micheal Pawliuk - Canada 2015.pdf","text":"GENERATING FUNCTIONS MICHEAL PAWLIUK 1. Introduction In this session you will develop the basic tools of “generating functions”. This is a powerful tool for solving combinatorial problems, particularly problems of a recursive nature. The basic idea is to deﬁne (i.e. generate) a polynomial (i.e. function) whose coeﬃcients are the answers to combinatorial questions you might have. We will then use tools from algebra, number theory, calculus and complex numbers to help us answer our combinatorics question. Theorem 1.1 (Main Idea). Rewrite a combinatorics problem in the language of polynomials. Use your polynomial tools to manipulate it. Translate your manip- ulated polynomial back into the language of combinatorics to solve your original problem. 2. Example 0 - Coin Flipping The next question is easy, but illustrates the main ideas. Pay attention to the ideas, not the actual problem. Question 2.1. You ﬂip 3 coins. How many ways are there to get n total heads? Let’s brute force this question and just write them down: TTT, TTH, THT, THH, HTT, HTH, HHT, HHH We can keep track of this information in this table: n 0 1 2 3 4 5 # of ways 1 3 3 1 0 0 Tables are boring though (which should really be a theorem). Let’s code the exact same information in a polynomial: n x0 x 1 x2 x3 x4 x5 coeﬃcient 1 3 3 1 0 0 Oops! That’s still a table. Silly me. Let’s put that into a polynomial: p(x) = 1x0 + 3x1 + 3x2 + 1x3 + 0x4 + 0x5 + . . . = 1 + 3x + 3x2 + x3 Date: January 7, 2015. 1 Generating Functions Canadian Winter IMO Camp January 7, 2015 Here the generating function p(x) = (ways to get 0 heads)x0+(ways to get 1 heads)x1+(ways to get 2 heads)x2+. . . . Let’s take that polynomial and do some polynomial-stuﬀ with it. (1) Plug in some numbers. There are many diﬀerent numbers we can plug in, but p(1) gives something interesting. It gives the sum of the coeﬃcients, which in the language of combinatorics, is “the total number of ways to ﬂip 3 coins”. (2) Factor it. In this case we get p(x) = (1 + x)(1 + x)(1 + x). This is interesting. If we want to ﬁgure out what the coeﬃcient in front of x2 is in p(x), we see that each factor contributes either 1 OR x. Since we want exactly two contributions of x, we see that there are three ways to do this, (just ﬁgure out which factor is contributing just its “1”). This might seem obvious, and weird to contort ourselves with generating func- tions to answer such an easy question, but it will be useful for more complicated combinatorics questions. 3. Example 1 - The Sicherman Dice Have you ever played Settlers of Catan? What about Monopoly? In these games you roll two six-sided dice, then add up their values to determine how much your piece moves/whether you get out of jail/whether you get to move the thief. The only thing you care about is the sum of the values on the two dice. Question 3.1. There is an alternate labeling on a pair of six-sided dice whose sums have the same probability distribution as the regular dice. i.e. You can play Settlers of Catan with these weird dice, and it doesn’t change the game. Dice labeled this way are called the Sicherman Dice. Prove that the regular labeling and the Sicherman labeling are the only two labelings with this property. Note that a valid labeling must use only positive integers. We’re going to go through this question in parts. (1) Exercise 3.1. Find a generating function (i.e. a polynomial) that repre- sents all of the combinatorial information about the sums of values of the dice. Call this p(x). Write it down explicitly. (2) Exercise 3.2. Find the “square root” of p(x). That is, ﬁnd a polynomial d(x) such that p(x) = d(x)d(x). In this problem d(x) is also a generating function. What does it represent? (3) Exercise 3.3. You are a hero. Factor d(x) = f1(x) . . . fN (x) into its irreducible factors. (4) Exercise 3.4. Keep track of f1(1), f2(1), . . . , fN (1); they will be useful. (5) Exercise 3.5. In terms of the factors of p(x), what would another labeling of two six-sided dice represent? i.e. In the language of factors of p(x), what is the question asking you to ﬁnd? (6) Exercise 3.6. What does the condition of “the dice are six-sided” corre- spond to? (7) Exercise 3.7. What other conditions are placed on the labels? (8) Exercise 3.8. Find the Sicherman labeling. See that it is the only option other than the regular labeling that satisﬁes the constraints of the question. Exercise You can’t actually play Monopoly with the Sicherman dice. Why? Page 2 Generating Functions Canadian Winter IMO Camp January 7, 2015 4. Partial Fractions Review We’re going to move on to some more powerful applications of generating func- tions, but to do that we will need to remember some techniques from algebra: partial fractions and power series. Skip these sections if you feel comfortable with these two techniques, or just use this as a reference if you get stuck in the later examples. Okay, now’s your last chance to get oﬀ... I’m going to move on now... Ready? Partial fractions is the method of simplifying rational functions like this: 1 (1 + x)(1 − x) = A 1 + x + B 1 − x The idea is (by multiplying through), solve a related equality and use the fact that two polynomials are equal if and only if all of their coeﬃcients are same (on the appropriate powers of x). 0x + 1 = A(1 − x) + B(1 + x) = (B − A)x + (A + B) In this case we see that A = B = 1 2 . (If you are really bad, and the idea of dividing by 0 doesn’t make you sick, you can plug x = −1 and x = 1 into the above equation to see what A and B should be.) 4.1. Irreducible Quadratic Factors. This method also works for quadratic fac- tors, but instead of a constant, you pick up a linear term. For example, let’s say we want to simplify x2+x+1 (1+x2)(x) . Then we write: x2 + x + 1 (1 + x2)(x) = Ax + B 1 + x2 + C x and solve x2 + x − 1 = (Ax + B)x + C(1 + x2) = (A + C)x 2 + (B)x + C So we see that C = −1, B = 1 and A + C = 1, so A = 2. 4.2. Repeated Factors. In the case of repeated factors we need to do a little more: Every factor 1 (x − a)k contributes 1 x − a + 1 (x − a)2 + . . . + 1 (x − a)k . Something similar happens for repeated quadratic factors: Every factor 1 (x2 + bx + c)k contributes 1 x2 + bx + c + 1 (x2 + bx + c)2 +. . .+ 1 (x2 + bx + c)k . 4.3. Repeated Factors Example. Here’s an example for you to look at: x + 1 (1 + x2)2(x − 4)3 = Ax + B 1 + x2 + Cx + D (1 + x2)2 + E x − 4 + F (x − 4)2 + G (x − 4)3 and solve x + 1 = (Ax + B)(1 + x2)(x − 4)3 + (Cx + D)(x − 4)3 + E(1 + x2) 2(x − 4)2 + F (1 + x2)2(x − 4) + G(1 + x2) 2 Page 3 Generating Functions Canadian Winter IMO Camp January 7, 2015 At this stage you would group like terms, to set up a list of 7 equations with 7 unknowns. (Do you see why the repeated factors required special attention?) You aren’t likely to see these sorts of beasts in the wild, so don’t worry about trying to solve it. The point is just to give you the idea of how you would solve something like this by hand (if civilization collapsed). Seriously, only a maniac would try to solve this. A maniac! You’re not going to solve it are you? Don’t do it. I didn’t even check to make sure the numbers are nice. You might end up with a 981√76 . Actually, maybe you can’t get square roots here? Huh. (Exercise: Show you can’t get (irrational) square roots showing up as the constants.) 5. Power Series Review Next we will discuss power series. This will be a very pratical discussion designed to get you to the point where we can manipulate them. Intuition: A power series is just a (possibly inﬁnite) polynomial in some variable x. The powers of x are just placeholders, and the coeﬃcients are real numbers which for us will usually answer some combinatorial problem. For example: • g(x) = 1 + x + x2 + x3 + x4 + . . . is a power series where all the coeﬃcients are 1. This is called the Geometric series. • F (x) = 1 + x + 2x2 + 3x3 + 5x4 + 8x5 + 13x6 + . . . is a power series where the nth coeﬃcient is (Exercise). • p(x) = 1 + 0x + x2 + 0x3 + 0x4 + . . . is a (ﬁnite) power series because only ﬁnitely many of the coeﬃcients are non-zero. 5.1. Notation. Because it’s impossible to write inﬁnitely many things down, (Exercise: Try to write down inﬁnitely many things), we use Sigma Notation to denote these power series. We write a general power series as ∑ n≥0 anx n, and it is implicit that we only let n range over (non-negative) integers. For example: • g(x) = 1 + x + x2 + x3 + x4 + . . . = ∑ n≥0 x n. • F (x) = 1 + x + 2x2 + 3x3 + 5x4 + 8x5 + 13x6 + . . . = ∑ n≥0 Fnx n. • p(x) = 1 + 0x + x2 + 0x3 + 0x4 + . . . = 1 + x2 + ∑ n≥3 0xn. Recall the following identity that you know for the ﬁnite geometric series: 1 + x + . . . + xN = 1 − xN +1 1 − x The remarkable thing is that there is an inﬁnite version of this. If x is small (say −1 < x < 1), as N gets large it crushes x, and xN +1 is basically nothing. So we get the following equality which is “valid” for small values of x. ∑ n≥0 xn = 1 1 − x Question 5.1. Are you allowed to plug numbers into power series? Page 4 Generating Functions Canadian Winter IMO Camp January 7, 2015 Yes, and no. Deﬁnitely for ﬁnite power series we can plug in values. However, what does an inﬁnite amount of additions look like? It’s weird, and we aren’t going to talk about it. Exercise. Plug x = 2 into the inﬁnite geometric series equality and behold the weirdness. Question 5.2. Should I be worried about this? No, not really. You’ll see that we are only going to be doing formal, algebraic manipulations of this sort, and we’re never going to claim something about inﬁnite additions. Remember, the power series (Exercise: What’s the plural of series? Kevin would know if he didn’t fall asleep in his Latin class. si dormiveris in schola linguae latinae, vinceris) are just placeholders for combinatorial information; we’re going to ask questions like “What’s the nth Fibonacci number?” or “How many ways are there to stack 2015 coins in a ‘fountain’ pattern?”. These questions are not about inﬁnity, so don’t worry about the inﬁnity stuﬀ. 5.2. The Important Power Series. There are many power series worth thinking about, but we will only mention a couple that have nice closed-forms. N∑ n=0 xn = 1 + x + x2 + . . . + x N = 1 − xN +1 1 − x (1) N∑ k=0 (N k )xk = 1 + (N 1 )x + . . . + ( N N )xN = (1 + x) N(2) ∑ n≥0 xn = 1 + x + x2 + . . . = 1 1 − x (3) Question 5.3. What sort of algebraic manipulations can I do to power series? Can I add them together? The short answer is that adding power series and multiplying by a constant works the way you think it should. Your intuition from polynomials should be correct. For example: ∑ n≥0 2xn = 2 ∑ n≥0 xn =  ∑ n≥0 xn   +  ∑ n≥0 xn   = 2 1 − x and addition of two power series is done by adding up the coeﬃcients in front of like terms, e.g. (2+3x+4x2+5x3+. . .)+(1+3x+5x2+7x3+. . .) = 3+6x+9x2+12x3+. . . = 3 1 − x 5.3. New Power Series from Old. We can get new power series from old power series. In particular, we can manipulate the geometric series as follows: 1 1 − 2x = ∑ n≥0 (2x) n = 1 + 2x + 4x2 + 8x3 + . . . 1 1 + x = 1 1 − (−x) = ∑ n≥0 (−x) n = 1 − x + x2 − x3 + . . . Page 5 Generating Functions Canadian Winter IMO Camp January 7, 2015 This versatile technique allows us to ﬁnd power series like: 1 1 − x2 = 1 (1 − x)(1 + x) = 1 2 1 1 − x + 1 2 1 1 + x = 1 2 ∑ n≥0 xn + 1 2 ∑ n≥0 (−x) n = 1 + x2 + x4 + x6 + . . . Exercise Find a faster/cleaner way to ﬁnd a power series for 1 1−x2 . 5.4. Power Series to Gaze upon. The following ones are nice to look at, but we won’t be using them. ∑ n≥0 (−1) n n + 1 xn+1 = x − x2 2 + x3 3 + . . . = ln(1 + x) ∑ n≥0 1 n! xn = 1 + x + x 2 2 + x3 6 + . . . = ex ∑ n≥0 (−1)n (2n + 1)! x2n+1 = x − x3 6 + x5 120 + . . . = sin(x) ∑ n≥0 (−1) n (2n)! x2n = 1 − x 2 2 + x4 24 + . . . = cos(x) ∑ n≥0 (−1)n 2n + 1 x2n+1 = x − x 3 3 + x5 5 + . . . = arctan(x) This is more than just something cool to look at; this is how your calculator computes sin(x). 6. Example 2 - First Recursion Example Now it’s time to see the power of generating functions. Well, sort of. Generating functions can be a bit complicated, so let’s ease into it. Let’s start with a nice example that is also the ﬁrst example in Wilf’s “generatingfunctionology”. Question 6.1. Consider the following sequence: an+1 = 2an + 1 for n ≥ 0 and a0 = 0. Using generating functions, can you ﬁnd a closed form for this sequence? Let me ﬁrst point out that you can easily guess what this sequence is, then prove it by induction. That’s not the point. We want to see how the machinery of generating functions can help answer some recursion questions. Question 6.2. What generating function should we use? Our generating function should contain the relevant information in the coeﬃ- cients, and since we are looking for the an, we’ll make those our coeﬃcients; simple. So let P (x) = ∑ n≥0 anx n Page 6 Generating Functions Canadian Winter IMO Camp January 7, 2015 Now the general strategy will be to use the recursion to form two diﬀerent (but necessarily equal!) power series. Let’s do it! Take the recursion an+1 = 2an + 1, multiply through by xn, an+1xn = 2anxn + xn then sum both sides to get ∑ n≥0 an+1xn = ∑ n≥0 2anxn + ∑ n≥0 x n We can simplify the RHS as 2P (x) + 1 1−x . Now to deal with the LHS: ∑ n≥0 an+1xn = a1 + a2x + a3x2 + . . . = a1x + a2x2 + a3x 3 + . . . x = (a0 + a1x + a2x 2 + a3x3 + . . .) − a0 x = P (x) x where we used the fact that a0 = 0. Combining the two we get: P (x) x = 2P (x) + 1 1 − x Solving for P (x) we get P (x) = x (1 − x)(1 − 2x) Exercise. Write this fraction as a power series, then read oﬀ its coeﬃcients. 7. Formal Derivatives At this stage you are ready to start attempting the questions in the next section. You might need the following nice power series: ∑ n≥1 nxn−1 = 1 + 2x + 3x2 + 4x3 + 5x4 + 6x5 + . . . = 1 (1 − x)2 How are these related? Well the terms of this (nxn−1) are the derivatives of the terms of the geometric series (xn), and 1 (1−x)2 is the derivative of 1 1−x . If you know a little bit of calculus, then you can get a whole bunch of new power series. This shows the power of translating a question into other language; now when we’re solving combinatorics problems, we get to use calculus! Page 7 Generating Functions Canadian Winter IMO Camp January 7, 2015 8. Other questions These questions are roughly in order of the way the material was presented. (1) Find the smallest n such that two regular dice labeled 1, 2, . . . , n admit alternative labelings, but don’t aﬀect the probability distribution of their sums. (2) Find the coeﬃcient of x21 in (x2 + x3 + x4 + x 5 + x6) 8. (3) Suppose that you want to play Settlers of Catan, but since you’re really cool you want to do it with as many dice as possible (but you don’t care about how many sides they have). Your friends don’t like negative numbers, but they are okay with zeros (so long as each die has a nonzero label on it). What is the most number of dice can you use without changing the probability distribution of their sum? (4) Using generating functions, ﬁnd a closed form for an, where an+1 = 2an +n for n ≥ 0 and a0 = 1. (5) Consider the k-variable generating function Fk(x1, . . . , xk) = (1 + x1)(1 + x2) . . . (1 + xk). Expand F3 and compare it with F3(1, 1, 1). What have you just proved? (6) How many subsets of {1, 2, . . . , 100} are there that do not contain adjacent numbers? (This question is tricky. There is a hint at the end.) (7) Use generating functions to ﬁnd a closed form for the Fibonacci numbers. Recall Fn+1 = Fn + Fn−1 for n ≥ 1 and F0 = 0, F1 = 1. (8) Let f (n) be deﬁned for all n ≥ 1 such that: • f (1) = 1; • f (2n) = f (n); • f (2n + 1) = f (2n). and deﬁne its generating function as F (x) = ∑ n≥1 f (n)xn. Show that F (x) = (1 + x + x2)F (x 2). Use this to write F (x) as an inﬁnite product. (9) Consider all possible sums of the form x1 + x2 + 2x3 + 5x4 + 10x5 + 10x6 + 20x7 + 50x8 where xi = 0, 1. Let Cn := the number of ways of getting n as this type of sum, and write the generating function C(x) = ∑99 n=0 Cnxn. (a) Write C(x) as a product. (b) Consider the corresponding sums where this time xi = −1, 0, 1. Let Dn := the number of ways of getting n as this type of sum. Show that there is a Dn ≥ 33. (c) Generalize the ﬁrst two parts of this question. (10) 100 is your favourite number. Let Ak = 1 k + 2k + 3k + . . . + 100k. Use generating functions to come up with a closed form for A1 and A2. (11) Let A(x) be a power series. (a) Find a power series B(x) (called the bisection of A(x)) which has the same coeﬃcients as A(x) for even powers of x and has 0 as its odd coeﬃcients. (b) Find a power series C(x) which has the same coeﬃcients as A(x) for odd powers of x and has 0 as its even coeﬃcients. (12) Prove Euler’s Formula eiπ + 1 = 0, where i 2 = −1. (Ignore issues of convergence.) Page 8 Generating Functions Canadian Winter IMO Camp January 7, 2015 Questions [4,8,9] were taken from Wilf’s “Generatingfunctionology”. Questions [2,5,11] were taken from Bender and Williamson’s “Foundations of Combinatorics with Applications”. 9. Hints (Question 6) In the language of strings of 0s and 1s, this asks for the number of such strings of length 100 that do not have consecutive 1s. Note that these strings are exactly the strings of the form: (All zeros)OR((0s)1(any number of: (0s, 0, 1))(0s)) Page 9","libVersion":"0.3.1","langs":""}
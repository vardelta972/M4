{"path":"iCloudDrive/bks/Calculus/Other Books/Advanced Calculus (Robert Creighton Buck, Ellen F. Buck) (Z-Library).pdf","text":"INTERNATIONAL SERIES IN PURE AND APPLIED MATHEMATICS E. H. Spanier, G. Springer, and P. J. Davis. Consulting Editors AHLFORS: Complex AnalysIs BUCK: Advanced Calculus BUSACKER AND SAATY: Finite Graphs and Networks CHENEY: Introduction to Approximation Theory CHESTER: Techniques in Partial Differential Equations CODDINGTON AND LEVINSON: Theory of Ordinary Differential Equations CONTE AND DE BOOR: Elementary Numerical Analysis: An Algorithmic Approach DENNEMEYER: Introduction to Partial Differential Equations and Boundary Value Problems DETTMAN: Mathematical Methods m Physics and Engineering GOLOMB AND SHANKS: Elements of Ordmary Differential EquatIOns HAMMING: Numerical Methods for Scientists and Engmeers HILDEBRAND: Introduction to Numerical AnalySIS HOUSEHOLDER: The Numerical Treatment of a Single Nonlinear Equation KALMAN, FALB, AND ARBIB: Topics m Mathematical Systems Theory LASS: Vector and Tensor Analysis MCCARTY: Topology: An Introduction With Applications to Topological Groups MONK: Introduction to Set Theory MOORE: Elements of Lmear Algebra and Matrix Theory MOURSUND AND DURIS: Elementary Theory and Application of Numerical AnalySIS PEARL: Matrix Theory and Finite Mathematics PIPES AND HARVILL: Applied Mathematics for Engmeers and Physicists RALSTO:--; A:--;D RABI:--;OWITZ: A First Course m Numerical AnalySIS RITGER AND ROSE: Differential Equations With Applications RITT: Fourier Series RCDlN: Principles of Mathematical Analysis SHAPIRO: Introduction to Abstract Algebra SIMMONS: Differential Equations With ApplicatIOns and Historical Notes SIMMONS: Introduction to Topology and Modern AnalySIS SNEDDON: Elements of Partial Differential EquatIOns STRL\"BLE: Nonlinear Differential EquatIOns ADlt4NCED 01LCULUS THIRD EDITION R. Creighton Buck Professor of Mathematics University of Wisconsin with the collaboration of Ellen F. Buck McGraw-Hili, Inc. New York • St. Louis San Francisco • Auckland Bogota. Caracas Lisbon • London Madrid • Mexico Milan. Montreal New Delhi • San Juan Singapore. Sydney Tokyo. Toronto ADVANCED CALCULUS Copynght © 1978. 1965. 1956 by McGraw-Hill. Inc All nghts reserved. Pnnted m the United States of America. No part of this pubhcallon may be reproduced. stored m a retneval system. or trans- mitted. m any form or by any means. electronic. mechanical. photocopymg. recordmg. or otherwise. without the pnor wntten permiSSion of the pubhsher 2021 222324 BRBBRB 99987654321 0 This book was set m Times Roman. The editors were A. Anthony Arthur and Shelly Levme Langman; the production supervisor was Dennis 1. Conroy New drawmgs were done by J & R Services. Inc. Library of Congress Cataloging in Publication Oata Buck. Robert Creighton. date Advanced calculus. (Internallonal senes m pure and apphed malh- emallcs) Bibhography. p Ineludes mdex I. Calculus. 2. Mathematical analySIS. I. Buck. Ellen F.. Joint author. II. Tille QA3OJ.B917 1978 515 77-2859 ISBN 0-07-008728-8 Contents PREFACE ix TO THE STUDENT XI CHAPTER 1 SETS AND FUNCTIONS 1.1 Introduction I 1.2 Rand R\" 2 1.3 Distance 11 1.4 Functions 19 1.5 Topological Terminology 28 1.6 Sequences 37 1.7 Consequences of the Monotonic-Sequence Property 57 1.8 Compact Sets 64 CHAPTER 2 CONTINUITY 71 2.1 Preview 71 2.2 Basic Definitions 72 2.3 Uniform Continuity 81 2.4 Implications of Continuity 89 2.5 Limits of Functions 97 2.6 Discontinuities 107 2.7 Inverses for Function, of One Variable III CHAPTER 3 DIFFERENTIA TlON 116 3.1 Preview 116 3.2 Mean Value Theorems and L'Hospital's Rule 116 v vi CONTENTS 3.3 Derivatives for FunctIons on R\" 125 3.4 Differentiation of Composite Functions 135 3.5 Taylor's Theorem 147 3.6 Extremal Problems 154 CHAPTER 4 INTEGRA TlON 167 4.1 Preview 167 4.2 The Definite Integral 16H 4.3 Evaluation of Definite Integrals 179 4.4 Substitution in Multiple Integrals 201 4.5 Improper Integrals. 205 CHAPTER 5 SERIES 227 5.1 Preview 227 5.2 Infinite Series 22H 5.3 Conditionally Convergent Senes 236 5.4 Double Series 245 5.5 Some Sums 250 CHAPTER 6 UNIFORM CONVERGENCE 260 6.1 Preview 260 6.2 Series and Sequences of Functions 261 6.3 Power Series 27H 6.4 Improper Integrals with Parameters 2H5 6.5 The Gamma Function 296 6.6 Fourier Series 304 CHAPTER 7 DIFFERENTIA TlON OF TRANSFORMA nONS 327 7.1 Preview 327 7.2 Transformations 32H 7.3 Linear Functions and Transformations 334 7.4 Differentials of Transformations 341 7.5 Inverses of Transformations 352 7.6 The Implicit Function Theorems 362 7.7 Functional Dependence 367 CHAPTER 8 APPLICA nONS TO GEOMETRY AND ANAL YSIS 375 X.I Preview 375 H.2 Set Functions 376 H.3 Transformations of Multiple Integrals 3H2 H.4 Curves and Arc Length 399 H.5 Surfaces a(1d Surface Area 417 H.6 Integrals over Curves and Surfaces 439 CONTENTS vii CHAPTER 9 DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 445 9.1 Preview 445 9.2 Differential Forms 446 9.3 Vector Analysis 464 9.4 The Theorems of Green, Gauss, and Stokes 477 9.5 Exact Forms and Closed Forms 497 9.6 Applications 512 CHAPTER 10 NUMERICAL METHODS 520 101 Preview 520 10.2 Locating Zeros 521 10.3 Fixed-Point Methods 527 10.4 Extremal Problems 535 10.5 Miscellaneous ApproXimatIOn Methods 541 APPENDIXES 549 1 Logic and Set Theory 549 2 Foundations of the Real Number System 554 3 Linear Algebra 562 4 Applications of Mathematics 567 5 Introduction to Complex Analysis 573 6 Further Topics in Real Analysis 582 SUGGESTED READING 588 HINTS AND ANSWERS 591 LIST OF SYMBOLS 610 INDEX 613 This page is intentionally left blank Preface The present edition covers essentially the same topics as the second edition, but with certain omissions, a few additions, and a considerable amount of rearrangement. We hope that these changes will make the material more accessible to students and more flexible for instructors' use. For the first half of the book. we assume that students have learned to use elementary calculus, but are not yet experienced in the techniques of proof and rigorous reasoning. For the second 'half. we assume that they may be taking concurrently (or have aheady completed) an elementary computational course in matrices and systems of linear equations. (Appendix 3 contains an abbreviated summary of this material.) The general objectives of the text are unchanged: 1. To introduce students to the language. fundamental concepts. and standard theorems of analysis so that they may be prepared to read appropriate mathematical literature on their own. 2. To develop analytical and numerical techniques for attacking problems that arise in applications of mathematics. 3. To revisit certain portions of elementary calculus. this time with attention to the underlying logical relationship of fundamental notions of analysis such as continuity and convergence. 4. To give a systematic, modern approach to the differential and integral calculus of functions and transformations in several variables. including an introduction to the useful theory of differential forms. 5. To display the structure of analysis as a subject in its own right. and not solely as a tool. for the benefit of those students whose interests lean ix X PREFACE toward research in mathematics and its applications, without sacrificing intelligibility to abstraction. The earlier editions have been used very successfully with a wide spectrum of students, most often at the junior or senior level with students majoring in science, engineering, or mathematics, but also with graduate students in mathematics or other fields whose undergraduate preparation was not adequate for more advanced courses. We hope that the changes we have made in this edition will serve the needs of these students even better. In revising the book, we have changed the order of topics and subdivided some of the chapters in order to make the first half of the book more unified and complete in itself; in particular, Chapter 3 incorporates the material on differentiation of functions of several variables, which formerly appeared much later. We have also changed the emphasis in Chapter 1 so that topological concepts and properties appear more as useful tools in the study of analysis, than as topics for separate study in themselves. (In teaching this material, we had found it all too easy to spend time in this direction!) The long chapter on series, in the earlier edition, is now two chapters, and a brief treatment of Fourier series has been added. Throughout the text we have also added a good many problems, and dropped others, in order to improve the mix of easy and challenging exercises. Finally, we have added a short chapter on numerical methods (which can be taken up any time after Chapter 3), and included additional illustrations of numerical techniques in other chapters, to give students a chance to see the connection between computational algorithms and theoretical analysis. In addition, we have included a few new pictures which we hope will help students acquire good geometric intuition. (We take this opportunity to thank those artists at McGraw-Hill who have worked with us to achieve such high-quality illustrations.) Textbooks and research papers tend to be very different in style and structure. Hans Freudenthal, a gifted teacher, researcher, and expositor, has described the latter: \"'This is the way we write our mathematical papers. We conceal the train of thought which led us to the result.\" Instead, in this book, we have tried to provide both motivation and insight, so that the reader will emerge having acquired both skill and understanding. We are very grateful to the large number of persons who have in the past sent us comments and suggestions. A partial list is inadequate, but we would like to mention particularly Professors H. F. Lowig, P. E. Miles, B. 1. Pettis, and R. S. Spira. R. Creighton Buck Ellen F. Buck To the Student We hope that you approach this book with some degree of curiosity and commitment; the title\" Advanced Calculus\" might equally well have been .. Basic Analysis\" or even\" Introduction to Mathematics for Applications.\" Your background ought to include the following: 1. A knowledge of the usual elementary (nonhonors) calculus, including some work with analytical geometry of space, double integrals, and partial derivatives. 2. An interest in learning more about this, either because of its applications or for its own sake. In the second half of the book, we assume a slight familiarity with matrices; for those for whom this topic is new, there is a condensed summary in Appendix 3. It is not necessary for you to have had a course in differential equations or vector analysis. No text intended for a one-year course can cover all the useful topics in analysis. Our selection criteria led us to concentrate on certain ideas and techniques that seemed most needed for further work in mathematics and its applications. Sketches of further developments and other digressions appear in the appendixes, some of which may be helpful reading from time to time. This applies in particular to Appendix 1, which explains some of the mysteries involved in logic and theorem proving. xi xii TO THE STUDENT All of Chapter 10 deals with numerical analysis; in addition, there are many exercises scattered throughout the book which ask for numerical answers or computational thinking. In some of these, you may find it convenient to use a small pocket calculator to carry out the calculations. The text is intended to be read and not used solely as a source for problem assignments. We have provided answers for about half the exercises, and in some cases, cryptic hints which may make sense only if you have already tried the problem. The hardest exercises are so indicated by the usual* AD ASTRA PER ASPERA! R. Creighton Buck Ellen F. Buck ADlt4NCED Q1lCUlUS~ This page is intentionally left blank CHAPTER ONE SETS AND FUNCTIONS 1.1 INTRODUCTION The most important difference between elementary calculus and advanced calculus is that, in the latter, we begin to explore some of the more com- plicated types of problems and techniques that can arise when we deal with functions of more than one variable. In particular, one has to become familiar with certain elementary geometrical ideas, not only in the plane and in 3- space, but also in spaces of higher dimension. We all possess rather clear intuitive ideas as to the meaning of certain geometric terms such as line, plane, circle, angle, distance, and so on, acquired from our earlier work in mathematics. To a less uniform degree, we have also acquired the ability to visualize objects in space and to answetgeometric questions about them without actually having to see or touch the objects themselves. In complicated cases, we have learned to work from inaccurate two- dimensional diagrams of the true situation; the perception of perspective in a drawing is another illustration of the same adaptive mechanism. (Example: Can the two curves in space which are shown in Fig. 1-1 be separated with- out cutting either?) Almost from the start, in the study of functions of several variables, we must deal with spaces of higher dimension than three; in such cases, it is a great convenience to be able to use geometric terminology and ideas. In 2 ADVANCED CALCULUS -----,-A~ Clil_ --g Figure I-I Linked or unlinked? higher dimensions, where our intuition is less trustworthy, we must make more use of analytical and algebraic tools than we do of pictures. The basic tools of classical analysis-limits, integration, differentiation- ultimately depend on the special properties of the real field R, and these in turn on the discoveries in logic and set theory made during the last century. It is not our intention to give this sequential axiomatic development, but instead to get on with the more concrete aspects of the calculus of functions of several variables; reasoning and rigor are still important, for here one meets new ideas and complications, and one needs to know more urgently than before the limits of validity of definitions and techniques. Readers who are interested in the axiomatic treatment of R and the various deductive chains that tie the whole theory together will find this discussed in Appendix 2. We assume that most of elementary calculus is familiar background; in particular, unless indicated otherwise, you are free to use the customary tools of elementary one-variable calculus, such as differentiation, curve tracing, integration, and so on, in doing exercises. 1.2 RAND R\" We start by describing some of the notation and basic concepts which we will use. The set of all real numbers is denoted by R; geometrically we identify this with an ordinary line and regard each real number x as specifying the point on this line with coordinate x. We also refer to such an axis as I-space. The ordinary cartesian plane is denoted by R 2, and space by R3 ; R 2 is the set of all ordered pairs (a, b), and R 3 the set of ordered triples (a, b, c), where the coordinates may be any real numbers in R. We also call R2 and R 3 2-space and 3-space, respectively. Points, whether they be in the plane or in space, will most often be denoted by a single letter: the point p, the point Q, the point x. If we are 4 ADVANCED CALCULUS Figure 1-3 Suppose that we have five oil tanks, with capacities C I' C2' C3' C4' C S • Suppose that, at the present time, tank k contains x k gal of oil. Certain inequalities must hold, (1-1) O:O::;;Xk~Ck k=I,2,3,4,5 We can represent the complete state of the system by a single point in 5-space, Po = (XI' x 2 ' x 3 ' x 4 ' x s ) The set of all possible states of the collection of tanks is the set of all such points P, whose coordinates are limited only by the inequalities (I-I). (Can you visualize this set as a box in R5?) If we begin to use oil from each tank, not necessarily at the same rate, the point representing the current state will move from Po along some curve toward the origin (0, 0, 0, 0, 0), which rep- resents the empty state. Various questions about the way the oil is being used can be phrased as geometric questions about the shape of this curve. Perhaps more familiar is the use of 4-space to image a physical point moving in 3-space by plotting the points (x, y, z, t), where (x, y, z) is the location of the moving point at time t. If we compress the three dimensions of space into two, then we can picture the four-dimensional world of space- time in R 3 . The \"history,\" or world line, of the moving particle then becomes a curve in 3-space. If the \"time\" axis is vertical, the space location of the particle at a particular moment of time to is found by intersecting the world line of the particle by the horizontal plane t = to (see Fig. 1-3). If we' accept the view that a particle cannot be in two different locations at the same time, then such a horizontal plane cannot cut a world line twice. In particular, the world line of a single particle cannot have the shape of a circle. Further geometric insight into the geometry of R\" for n > 3 can be ob- tained from any of the following references in the Reading List at the end of the book: [26, 49,50, 52]. (We especially recommend the two stories by Robert Heinlein.) If S is a set of points (or of other objects), the notation pES will mean that p is a member of S. We use A c B to indicate that the set A is a subset SETS AND FUNCTIONS 5 of the set B, meaning that every member of A is also a member of B; note that A c B does not mean that A and B must be different sets. If A c Band B c A, then A = B, for they have exactly the same members. If A #- B, then A contains a member that does not belong to B, or B contains a member not in A; both may happen. The union of two sets A and B is A u B, and consists of all the points that belong either to A or to B, including those that belong to both. Note that A c A u Band B c A u B. The intersection of A and B is A n B and consists of just the points that belong to both A and B. The set having no members is denoted by 0 and is called the empty set, or null set. If A and B have no members in common, then A n B = 0; in this case, we also say that A and B are disjoint. All the geometric properties of sets in R\" depend on basic properties of the set R of all real numbers. The algebraic properties of R can be summarized by saying that R is a field. This means that the operations called addition and multiplication are defined for any pair of real numbers, and that a familiar list of algebraic rules applies, including the following: (i) Addition and multiplication are commutative and associative: a+b=b+a and ab = ba for all a, b E R (a+b)+c=a+(b+c) and (ab)c=a(bc) foralla,b,cER (ii) a(b + c) = ab + ac for all a, b, c E R (iii) Additive and multiplicative inverses exist; in general, the equation x+a=b has a unique solution x for any a, b E R, and the equation ax = b has a unique solution x for any a, b E R, provided that a #- 0. Since we are assuming familiarity with the ordinary rules of algebra, and experience in calculating with numbers, we do not go into this aspect of R further. The complete list of field axioms will be found in Appendix 2. The real field also has an order relation, <, which obeys such laws as the following: (iv) For any x and yin R, exactly one of the following holds: x = y, x < 1', Y < x. (v) If x < y and y < Z, then x < z. (vi) If x < y, then x + Z < y + Z for any Z E R. (vii) If x < y and z > 0, then xz < yz. This ordering of R is used in many ways. For example, a subset S c R is said to be bounded if there are numbers band c such that b ~ x ~ c for all 6 ADVANCED CALCULUS XES. Any suitable number c is called an upper bound for S, and any suitable b is called a lower bound for S. R has two special subsets, the integers Z={O, ±1, ±2, ±3, ...} and the rational numbers Q = lall numbers ~where n¥-O and m, n E Z~ As a subset of R, the set of integers is an infinite set that is unbounded and uniformly dispersed. Any real number lies between two consecutive in- tegers; given x E R, there is a unique integer, usually denoted by [x] and called the greatest integer in x, such that [x] = n where n~x<n+1 The set Z also has the important property that any bounded set of integers is finite, and thus has a smallest member and a biggest member. The set Q of rational numbers behaves quite differently. As a subset of R, Q is dense, meaning that given any two real numbers band c with b < c, there are infinitely many rational numbers r with b < r < c. Moreover, a bounded set of rational numbers need not have either a biggest or a smallest member. If S is the set of all rational numbers r with °< r < 1, then for any rES there is an integer n such that lin < r < (n - l}ln; since lin and (n - l}ln also belong to S, no member of S can be either the largest member of S or the smallest. In Sec. 1.7, we will discuss this again in connection with one further very important property of R itself called the least-upper-bound property, which lies at the heart of many of the basic theorems in analysis. For completeness, we state the LUB property now, but defer further explanations until later. Put very briefly, the real numbers have the property that while a bounded set S does not itself have to have either a largest member or a smallest member, the set of upper bounds for S must have a smallest member, and the set of lower bounds for S must have a largest member. As we shall see, this fact provides a useful replacement for the maximum or minimum member of a bounded set of numbers when these do not exist. We have used the words \"finite\" and \"infinite\" above without explanation. The notion of cardinal number, applied to arbitrary sets, is an important part of modern set theory which we do not choose to discuss here; some elementary aspects are touched on in Appendix 1. For our purposes, an intuitive under- standing is sufficient. A set is either finite or infinite; if it is infinite, it is either countable, meaning that its members can be paired one-to-one with the set of positive integers and thus labeled as S = {PI' P2' P3' ..} or it is noncountable, in which case such a labeling is not possible. The set of all real numbers is noncountable, but the set Q is still countable. 8 ADVANCED CALCULUS (1-4) (VI) Addition of points is commutative and associative. (V2) If p and q are points and oc and fJ are real numbers, then oc(p + q) = ocp + ocq (oc + fJ)p = ocp + fJp oc(fJp) = (ocfJ)p (V3) The special point 0 has the property that p+O=p (V4) The real numbers °and 1 have the property that (o)p = 0 and (I)p = p While the statements in this list apply to R\", they also describe a standard mathematical structure called a vector space over R. A set V is called a vector space with real scalars if there is an operation of addition defined for pairs of elements of V, and a product defined for any p E V and any real number A. E R, such that p + q and A.p belong to V for every choice of p, q in V and A. E R, so that VI and V2 hold, and there is a special element 0 in V such that V3 and V4 also hold. In R\" the role of 0 is filled by the origin, (0,0, ... ,0), so that, by analogy, 0 is often called the origin of V. The preceding discussion, starting with formulas (1-4), can now be sum- marized by saying that R\", with the operations defined in (1-2) and (1-3), is a vector space over R. Please note that we do not choose to introduce an order relation among points in R\" for n z 2 comparable to that which holds among the real numbers themselves. The reason is merely that there is no simple order relation that turns out to be sufficiently useful. Furthermore, there is no general way to define multiplication of two points in R\" that will yield a point for the pro- duct, and that will obey the usual laws of algebra except when n = 2, and in a partial way for n = 3, 4, and 8. The reasons behind this form an interesting chapter in modern algebra, and are treated in detail in the article by Curtis in reference [16] in the Reading List. However, there is a different sort of multiplication operation for points in R\" that is extremely useful and that applies for any n. This is called the scalar or inner product; the former name is used because the product of two points in R\" is a real number or scalar, not another point. Given two points p = (Xl' x 2' ... , X\") and q = (Yl' Y2' ... , y\"), their scalar product (sometimes also called their dot product) is the number (1-5) p' q = X1Yl + X2Y2 + .,. + x\"Y\" Thus, if p = (2, -1,4) and q = (- 3,5,4), p' q = 5. Using the familiar algebraic laws for R, it is easy to verify the following formulas: (1-6) (1-7) (fJp)· q = fJ(p· q) = fJ(q . p) p. (ql + q2) = p . ql + P • q2 SETS AND FUNCTIONS 9 where p, q, ql' and q2 are points in Rn and fJ is a real number. In the next section, we will discuss the geometric meaning of the scalar product and obtain further properties. The vector space operations in Rn-and even in the plane or in space- make it possible to restate many familiar geometric ideas in algebraic terms. Recall, for example, the midpoint formula from plane analytical geometry. If p = (xl' Yl) and Q = (x 2' Y2)' then the midpoint of the line segment PQ is the point R = (~~~~ Yl + Y2)(1-8) 2 ' 2 In algebraic form, we can now write R = -tp + -tQ = -t(P + Q). If we make use of a familiar result about parallelograms, we can find a very simple proof of the following well-known property of quadrilaterals: Let A, B, C, and D be any four points in the plane and form a quadrilateral by joining them in that order; then, the midpoints of the four sides are the vertices of a parallelogram. (Two cases are shown in Fig. 1-6.) D c A Figure 1-6 10 ADVANCED CALCULUS As above, the four midpoints are A+BP=--- 2 ' Q=~±~ 2 ' C+D R =-_ .. 2 ' D+A S =-- 2 To show that PQRS is a parallelogram, we use the following: A quadrilateral is a parallelogram if and only if its diagonals bisect each other. It is clear that this is the same as asking that the midpoints of the diagonals coincide. But the midpoint of the diagonal PR is ~1~ = ~(A; B+ ~;1?) = i~B_~C_-+:1? and the midpoint of diagonal QS is Q ; S = ~ (~; C + D i-i) = 1!. :t- .~~D_+_A and since these are equal, we have proved the theorem. Note that in Exercise 15 below, an algebraic proof is given for the italicized statement about parallelograms that we used above, based on the definition of a parallelogram as a four-sided polygon whose opposite sides are parallel. (One person's definition is another person's theorem!) Does this mean that the complete argument can be given algebraically without bringing in geo- metry? Does this mean that the theorem about the midpoints of the sides of a quadrilateral holds for one sitting in 4-space or n-space? EXERCISESt I How would you describe the world lines of two particles that collide and destroy each other? 2 Construct a world-line diagram for the motion of two elastic balls of different mass that move along a line toward each other, collide, and rebound. *3 Draw a sketch to illustrate the following events: A photon vanishes, giving rise to two particles, one an electron and one a positron. The electron moves off in one direction, the positron in another. The positron strikes another electron, and the two annihilate each other, giving rise to a photon which travels off. Could this be the history of only one particle? 4 If A and B are sets and A c B, what are A u B and A n B? S For any sets A and B, let A - B be the set of those things which belong to A but do not belong to B. What is A - (A - B)? Is it true that C n (A - B) = (C n A) - (C n B)? 6 (a) Which is larger, (j243/3] or [12/jS)? (b) Find a rational number between jf? and fi. 7 Solve for P in each of the following equations: (a) (2, I, -3) + P = (0,2,4) (b) (I, - I. 4) + 2P = 3P + (2,0,5) t A star * indicates an exercise which requires a certain amount of ingenuity. SETS AND FUNCTIONS II 8 Solve for the points P and Q if 2P + 3Q = (0, 1,2) P + 2Q = (I, -1,3) 9 Solve for P and Q if 3P + Q = (1,0, I, -4) P - Q = (2, 1,2,3) 10 Let A = (I, 1,3) and B = (2, -I, I). Can you find a point p such that p • A = °and P' B = o? II Draw a diagram to illustrate that the associative law of addition, p + (q + r) = (p + q) + r, holds for the operation of addition of vectors. 12 The \"center of gravity\" of the triangle with vertices at A, B, and C is the point !(A + B + C). Show that the center of gravity of a triangle is always the same as that of the triangle formed by the midpoints of its sides. 13 What is the center of gravity of the triangle whose vertices are (1,2, -4, I), (2,0,5,2), (0,4,2, - 3)? 14 Show that any three noncollinear points can be the midpoints of the sides of a unique triangle. 15. Using the definition given at the end of this section, give an algebraic proof that a four-sided polygon is a parallelogram if and only if the diagonals bisect each other. 16. Show that the four points A, B, C. D are the vertices of a parallelogram if and only if A+C=B+~mA+B=C+~mA+D=B+C. 17. In the rules (i), (ii), (iii) which were given for real numbers, there was no mention of subtraction. Formulate a set of rules concerning subtraction, and then check these with the development given in Appendix 2. 18. Show that the rules in (1-4) hold, by direct use of the definition of addition of points and the previously given rules about real numbers. 19 Using the order properties (iv) to (vii) for the real field, derive the following additional properties: (a) For any a, bE R, if a < b, then -b < -a. (b) For any x E R, x 2 ~ 0, with equality only if x = 0. (c) For any real x and .\\\" if x 2 + .\\'2 = 0, then x = .\\' = 0. Does this extend to more terms' 20 (a) H 0< m < n, show that m2 < n2 and lin < 11m. (b) H m < n < 0, show that m2 > n2 and 11m> lin. 21 Suppose that a, b. A, B are all >0. Is it always true that a + b a b - < - +- A+B-A B 22 Using the coordinate representation for points and the dot product, prove the identities (1.6) and (1-7). 23 Show that the set Z of all integers is countable. 1.3 DISTANCE In the plane, the distance from the point (x, .\\') to the ongln is Jx 2 + .\\'2. In Rn we adopt the obvious analog. If p = (x l' X 2' ... , X n ), we define what we shall call its norm to be the number (1-9) r::.- /-----2 --------- ---- [pi = v p' p = v xi + X 2 + X~ + ... + x; 12 ADVANCED CALCULUS and we interpret this as the distance in R\" from p to the origin. If p and q are two points in n space, we take Ip - qI to be the distance between them. This agrees with the familiar distance formula both in the plane and in space. If p = (x, y, z) and Po = (xo,Yo' zo)' then p - Po = (x - xo' y - Yo' z- zo) and Ip - Po 1= J(x - XO)2 + (y=-YO)2 + (z --=ZJ2 When we specialize this general treatment to R 1, it takes on a slightly different appearance but is still familiar. If we write p=(x)=x then the formula for norm becomes Ipl = Ixl = ';;;2 We recall that, when c is a positLve number, .jC is always the positive number whose square is c; thus, JX2 is not always x. Indeed, if x is negative, p = -x. Thus, the formula for norm reduces in I-space to the ordinary absolute value Ixl = J x I-x if x 20 if x < 0 Again, Ix - yl is the absolute value of the difference of x and y, and this is in fact the distance on the line between the points with coordinate x and with coordinate y. We see that we can use the notation IpI and Ip - qI in all the spaces R\", n = 1, 2, .... We note that Ipl2 0 and that Ipl = 0 only if p= O. Furthermore, the norm function obeys certain simple identitites. (1-10) For any point p, For any real number A 2 0, Ipl = I-pi IAPI = Alpl (1-11) More generally, for any real number A and any p, IApl = IAllpl From these others can be derived; for example, it is evident that Ip - ql = Iq - pl· Finally, the norm function obeys the following triangle inequality: For any points p and q in R\", (1-12) Ip + ql ::; Ipl + Iql In the plane and in space, this relation has a simple geometric interpretation in terms of the sides of a triangle, as shown in Fig. 1-7. However, we can no longer draw pictures in R\" when n > 3, and it is necessary to have an analytical proof of (1-12) that does not depend in any way upon geometric arguments. If we restate (1-12) using (1-9), we must show that ~ + Yl)2 + (x 2 + Y2)2 + ... + (x\" + y\")2 .;---- .;yr-------- < x2 + ... + x2 + y2 + y2 + ... + y2 - 1 \" 1 2 \" SETS AND FUNCTIONS 13 p+q I I I I I I Ilql I I I I I Figure 1-7 The triangle law. for any choice of the 2n real numbers Xl' x 2' ... , x n ' Yl' Y2' ... , Yn ' If we square both sides of this conjectured inequality and do some cancelling, we are led to conjecture another inequality, namely X Y + X Y + ... + x Y < /Xl+ x 2 + ... + x 2 r::r-:--y2 + y2+ ... + y21 1 2 2 n n - v' Al 2 n v' Yl T 2 n This new inequality is valid, as we will shortly prove, and it is both important and useful in its own right; it is variously credited to Schwartz, Cauchy, and Bunyakovski. We restate this result in terms of norms and scalar products. Theorem 1 (The Schwarz Inequality) Let p and q be any points in n space, (1-13) then or Take real numbers oc and f3, as yet unspecified, and form the point Q = ocp - f3q. Clearly, a norm cannot be strictly negative, so IQI ;:::: O. Writing IQ 1 2 as Q . Q, we have 0.:::; Q • Q = Q • (ocp - f3q) = ocQ • p - f3Q • q = oc(ocp - f3q) • p - f3(ocp - f3q). = oc2p • P - ocf3q • p - f30cp • q + f32q • q • q which, by (1-6) and (1-9), we can rewrite as Os oc21pl2 + f321q12 - 2ocf3p' q 2ocf3p' q .:::; oc21pl2 + f321q12 This must hold for any choices of the numbers oc and f3. Suppose that we pick oc = Iq 1and f3 = 1p I, so that this becomes 2Ipllql(p' q).:::; Iql21pl2 + Ipl21ql2 = 21pl21ql2 14 ADVANCED CALCULUS If neither p nor q is the origin 0, then Ipl #- 0 and Iql #- 0 and we can divide by the positive number 2lpllql, obtaining p' q $; Ipllql and we have proved the inequality. The omitted cases, p = 0 or q = 0, are trivial. It In inequalities such as this, it is often important to know exactly under what circumstances (if any) they can become equalities. In the present case, it is easy to trace back the argument to see that we can have equality at the end only if we had IQ I= 0 at the start. But this says that Q = 0, and thus that IXp = f3q. The geometric interpretation of this is that the vectors p and q differ only in length, and not in direction; the points p and q must lie on the same line through the origin. We also note that if we replace p by - p, (1-13) yields the inequality - p • q $; Ip IIq I, so that a more general statement of the Schwartz inequality is (1-14) We can now return to the triangle inequality, and show that distance in n space satisfies this intuitive requirement. Corollary For any points p and q in n space, (1-15) Ip + ql $; Ipl + Iql and equality holds only if p and q lie on the same half linefrom the origin. I We have Ip + ql2 = (p + q). (p + q) =p'p+p'q+q'p+q'q = Ipl2 + Iql2 + 2p' q $; Ipl2 + Iql2 + 21pllql = {ipi + Iql}2 and the result follows. The Schwarz inequality (1-14) is geometrically evident in the case of the plane or 3-space because of a simple interpretation of the scalar product of vectors. Suppose that p and q are points in space, and represent them by position vectors as shown in Fig. 1-8. Let e be the angle between them. Then, the trigonometric law of cosines shows easily that (1-16) p • q = Ip IIq Icos e t Following the lead of others. we use the sIgn I to signify the end of a proof. SETS AND FUNCTIONS 15 Figure 1-8 Thus, when n is 2 or 3, the Schwarz inequality merely asserts the obvious fact that Icos eIcannot be larger than 1. When n ?: 4, Fig. 1-8 is no longer convincing, and the notion of the angle between two lines in n space may raise doubts; we therefore turn things around and use (1-14), which we know to hold for any choice of n, to define the notion of angle. Given two points p and q in n space, neither of which is the origin, we define the angle between them subtended at the origin to be the unique e between 0 and n such that (1-17) p'q cos e=IPfTql We need the Schwarz inequality to be sure that the number on the right side remains between - 1 and 1, so that a value of e can always be found. When p • q = 0, then the angle e must be n/2. In this case we say that the points p and q are orthogonal and write p .1 q. Geometrically, this means that the position vectors from the origin to p and q form a right angle. For example, (1, 2, - 3, 1) and (5, 1, 2, - 1) are orthogonal in 4-space. In the plane, a line has the equation Ax + By = C and in space, the equation of a plane is Ax + By + Cz = D In n space, it is natural to introduce the term hyperplane for the set of all poin ts p = (x l' X 2' ... , x n) that satisfy an equation of the form (1-18) where the numbers bi and C are specified and at least one of the bi is different from O. This equation can be written in a more condensed way as v' p = C, setting v = (bl' b2 , ... , bn ) #- O. Suppose that C is O. Then, the equation of the hyperplane becomes v • p = 0, so that the hyperplane consists of all the points p that are orthogonal to the given point v. In 3-space, the picture would be that shown in Fig. 1-9, and v would be the vector normal to the plane. By analogy, we use the same description in n space, and call v the normal vector to the hyperplane whose equation is v' p = O. Planes that do not pass through the origin can be treated in a similar way. In 3-space, the general plane through Po = (xo, Yo' zo) has the equation J6 ADVANCED CALCULUS Figure 1-9 which can be restated in the form v· (p - Po) = 0 with v = (A, B, C), and pictured as in Fig. 1-10. We therefore adopt the same formalism, and say that in n space the hyperplane through a point Po normal to the vector t' consists of all points p such that v· (p - Po) = O. Note that this equation agrees with (1-18) if C is chosen as the constant v· Po. Just as a plane in 3-space is a two-dimensional space, a hyperplane in nspace is an (n - I)-dimensional object, isomorphic to Rn - 1 itself; \"isomorphic,\" meaning \"same form,\" is a technical mathematical term, used here informally. As an illustration, in 4-space the hyperplanes are each isomorphic to ordinary 3-space; thus, in the conventional space-time picture of the universe, the time axis is regarded as a line orthogonal to a hyperplane that represents ordinary three-dimensional space. At the other end of the dimensional scale, we can also discuss lines in n-space, which will be one-dimensional geometric objects. In 3-space, we describe a line by parametric equations such as (1-19) x = X o + at .I' = Yo + bt z = Zo + ct -x<t<x / P / / / y_//_--- Figure 1-10 SETS AND FUNCTIONS 17 Figure I-II This is the line through Po = (xo' Yo' zo) in the direction of the vector v = (a, b, c) \"# O. Setting P = (x, y, z), we can condense these equations to the single equation (1-20) P = Po + vt - 00 < t < X We adopt the same equation in n space with v = (b I , b2 , ••• , bJ We can also approach the topic of lines in n space more geometrically, avoiding coordinates entirely. A line L will be determined completely by any distinct pair of points on it. If ql and q2 lie on L, they divide L into three portions, the interval between them and the unbounded segments to either side. We characterize each algebraically. As shown in Fig. 1-11, any point on L is obtained by adding to ql a positive or negative scalar multiple of the vector l' = q2 - qi' Thus, the general point on the line L will have the form (1-21) p = qi + At' = (l - A)qI + Aq2 for some choice of A E R. Note that if A =~, the point p is the midpoint of the segment between qi and q2' More generally, if 0 < A < I, p is the unique point on this segment whose distance from qi is exactly A times the distance from qi to q2' We verify this, showing that the sum of the distances from p to qi and q2 is Iql - q21. We have, using (1-21) and the fact that A> 0 and 1 - A > 0, Ip - qI I = I(1 - A)q I + Aq2 - qI 1 = IA(q2 - qI)1 = AlqI - q2! Ip - q21 = I(1 - A)q I + Aq2- q21 = I(l - A)(q I - q2)I = (1 - A)lqI - q21 and adding, we have SETS AND FUNCTIONS 19 EXERCISES I For n = 1,2, and 3 in turn, plot the set of points P in R· where (a) Ipl < I (b) Ipl ~ I (c) Ipl = I. 2 Let A = (4, 2). Graph the set of points p in the plane for which (a) Ipl<lp-AI (b) Ipl+lp-AI=6 (c) Ipl+lp-Als4. 3 Sketch the set of points (x, y) where (a) Ix + 2yl s x - Y (b) (x 2 - y)(x - ),2) < 0 4 Show that IpI + P2 + P3 + ... + p.1 s IpII + Ip21 + ... + Ip.l· 5 Prove thatlp - qI2Ipl-lqj· 6 If p = (u, v, w), show that (a) Ipl ,.;; lui + It'l + IwI (b) lui s Ipl,lvl s Ipl,lwl s Ipl 7 Use the law of cosines in the plane and the properties of the norm and scalar product to verify that p' q = Ipllql cos 8. S Show that the three points A = (2, -1,3, I), B = (4, 2, 1,4), and C = (I, 3,6, I) form a triangle with two equal angles. Find its area. 9 Find the equation of the hyperplane in 4-space which goes through the point Po = (0, I, -2,3) perpendicular to the vector a = (4, 3, I, -2). 10 If the angle between two hyperplanes is defined as the angle between their normals, are the hyperplanes 3x + 2)' + 4z - 2w = 5 and 2x - 4)' + z + w = 6 orthogonal? II Write the parametric equations of the line through (2, 3, - I, I) which is perpendicular to the hyperplane 3x + 2y - 4z + w = O. 12 Where does the line through ql = (1,0, 1,0) and q2 = (0, 1,0, I) intersect the two hyperplanes of Exercise 10? 13 Given a triangle with vertices at A, B, C, show that the point R = t(A + B + C) lies on each of the medians (the line from a vertex to the midpoint of the opposite side). 14 Formulate and prove an analogous property for the tetrahedron with vertices at A, B, C, D. 'IS In the triangle ABC, join A to a point t of the way from B toward C, join B to a point t of the way from C toward A, and join C to a point t of the way from A toward B. Express the vertices of the smaller triangle thus formed in terms of A, B, and C. 16 Let I be the line determined by the two pomts p and q. Let P = i.p + (I - i.)q. Show that. when A > I.IP - pi + Ip - ql = IP - ql. and interpret this geometrically. 17 Show that the intersection of two convex sets is convex but that the union of convex sets does not have to be convex. 1.4 FUNCTIONS The notion of function is essentially the same as that of mapping. A numerical- valued functionf assigns to each point p in its domain a single real number f(p) called the value offat p. The rule of correspondence may be given by a formula such as f(p) = x 2 - 3xy for any p = (x, .1') when x> y when x s y 20 ADVANCED CALCULUS or by several formulas, as in f(x, y) = l:2+ y or by a geometrical description, f(p) is the distance from p to the point (4, 7) or even by an assumed physical relationship, f(p) is the temperature at the point p In all these cases, it is important to bear in mind that the function f itself is the rule or mapping, while f(p) is the value which f assigns to p. It is also useful to think of functions in terms of an idealized computer; each function is then described by a specific software program or algorithm, and f (p) is the output corresponding to a data input p. The domain of a functionfis the set of objects to which it may be applied and for whichf(p) is defined. It is always possible to increase the domain of a function by giving definitions forf (p) for points p that were not in the original domain. This can be done quite arbitrarily in many ways; however, when the extension of the function is required to retain some of the properties that the function had on its original domain (e.g., smoothness, continuity, dif- ferentiability), then it becomes much more difficult and is indeed an interesting mathematical problem. Real-valued functions are often classified according to the nature of their domains. Iff(p) is defined for points p in a region D in the plane, then we may write p as (x, y) and f(p) as f(x, y) and may refer to f as a function of two real variables. Similarly, when D is a set in 3-space, we may write f(x, y, z) forf(p) and say thatfis a function of three real variables. In general,! is said to be a function of n real variables if the domain of f is a set in R\". In all these cases, it is still very helpful at times to think off as a function of a single point p and to writef(p) for its value. To see how this may happen, suppose that f(p) is the temperature at the point p on a thin, curved wire S. The functionfhas S for its domain and might thus be said to be a function of three real variables. However, it is clearly much more convenient to think off as a function of a variable point p which is confined to the wire. Again, if we are interested in the distribution of electric charge on a curved metal shell, we would be led to work with a numerical-valued function whose domain of definition is the set of points on the shell. It is a serious mistake to think that functions must always have numerical values. Many of the most useful functions have values that are points or vectors. The motion of a particle may be described by setting up a cor- respondence between moments of time and points in space, by means of a functionf, with P = f(t). Here, the domain off will be an interval on the time line, and the values off will be points in 3-space (see Fig. 1-13). If the moving particle is subject to a magnetic field and we want to indicate the direction and SETS AND FUNCTIONS 21 x y Figure 1-13 f: R 1 -> R 3 magnitude of the force field at each position of the particle, we may be led to work with a function F which is defined for points on the track of the particle and whose values are vectors (see Fig. 1-14). More generally, whenever we are dealing with a mapping from objects in one set A to objects in a second set B, we are dealing with a function. We can represent this type of situation by a diagram, as in Fig. 1-15, and sometimes indicate it as (1-24) f: A --> B The set A is still the domain of f, and the set B will contain the set of values (or range) of f This concept of function is so broad that it permits mathematicians to label things as functions, and to work with them, which do not at all resemble the simple class of numerical-valued functions. However, our interest in this book will be with less abstract functions. Stated succinctly, the main theme of this book is the study of functions whose domains are in R n and whose values are in Rm• To most of these functions, we can attach geometric interpretations that help us to work with them better. We have already illustrated this for functions from R into Rn, as in Fig. 1-13. Any such function is called a curve, since it corresponds to the familiar concept of the parametric description of a curve in n space. For example, a curve in the plane would be described by the equations Jx = cfJ{t) )Y=l/!{t) a~t~b Figure 1-14 SETS AND FUNCTIONS 23 This describes a mapping F from a square in the UV plane into 3-space. As the point p = (u, v) moves throughout the square, the image point F(p) = (x, Y, z) moves in space, tracing out the shape shown in Fig. 1-16. Thus, F(I, 0) = (1,2, 1) and F(O, 1) = (1,0,0). Other similar pictures will be found in Chap. 8, especially Fig. 8-17, 8-18, and 8-20, which show more complicated examples. The study of curves and surfaces is one of the more difficult areas of analysis, and some aspects of this are treated there as an application of the tools to be developed. We will also study functions that map a portion of Rn into Rn• An illustra- tion is the function F from 3-space into 3-space described by the formula F(x, y, z) = (u, v, w) where \\u=x- y v = y 2 + 2z Iw= yz + 3x 2 For example, we have F(l, 2, 1) = (-1,6, 5) and F(l, -1, 3) = (2, 7,0). All these cases can be subsumed under one general formula. A mapping F from Rn into Rm has the form y = F(x), where we write x = (Xl' x 2 ' ••• , xn ) and y = (YI' Y2' ... , Ym ) and where \\YI =f(X I,X 2,···,x) (1-26) 'Y2=g(Xl'X 2,···,x n ) l\"'~\"\"\"\"\"\"'\"Ym - k(xl' x 2 ' ... , xn ) Here, f, g, h, ... , k are m specific real-valued functions of the n real variables X I' x 2 ' ••• , xn ' Such functions as F are often called transformations to emphasize their nature; the study of their properties is one of the central topics of later chapters in this book. Side by side with the view of a function as a mapping A --+ B, there is also the equally important and useful idea of its graph. If f is a function of one variable, with domain D c R I, then the graph off is the set of all points (x, y) in the plane, with XED and y = f(x). The graph of a function of two variables is the set of points (x, y, z), with (x, y) in the domain of the function f and with z = f (x, y). Generalizing this, iff is a function on A into B, f:A--+B then the graph offis the set of all ordered pairs (a, b), with a E A and b = f(a). It is customary to use the term cartesian product of A and B, written as A x B, to denote the class of all possible ordered (a, b), with a E A and b E B. The graph offis therefore a special subset of A x B. By analogy, (a, b) is often called a point in A x B, and the graph off can be visualized as something like a curve in the space A x B (see Fig. 1-17). Let us apply this to a numerical-valued function f of three real variables. Suppose that the domain off is a set D c R 3 . Since f is numerical-valued, its SETS AND FUNCTIONS 25 Figure 1-18 The study of the set of points where a given function takes on specific values is often a very useful way to examine the function's behavior. For a function of two variables f, the set of points where f(x, y) = C is called the level line of value (or height) C. Thus, the level lines of the function f(x, y) = x 2 + 9y 2 are the family of ellipses shown in Fig. 1-18. In Chap. 3, we display the level lines of several more complicated functions in Figs. 3-13 and 3-14. The level lines of such functions are also a help in visualizing the graphs of the functions. This, of course, is nothing more than the standard process by which a topographic map is converted into a three-dimensional scale model. For a function of three variables F(x, y, z), the set of points where F(p) = C will usually be a surface in 3-space. Thus, one speaks of the level surfaces of F. These too help in understanding the behavior of F, but this time they are of no assistance in constructing the graph of F. Something similar can be done with functions of four variables, for one of the variables can be regarded as time; if the value of the function is regarded as specifying temperature, then we are dealing with a temperature distribution throughout space which also varies with time, and the concept of \"level sets\" is replaced by equithermal surfaces in space which change shape with time. Many special properties of a function are reflected in simple geometrical properties of its graph. A numerical functionf defined on the line is said to be strictly increasing iff (Xl) <f(x 2 ) whenever Xl < x 2 ; this means that the graph offis a curve that rises as we move along it from left to right. Again, a function of n variables is said to be midpoint convex if it obeys the special relation (1-27) f(1P + 1q) s !f(p) + !f(q) for all points p and q in its domain. This is easily seen to be satisfied if the set of poin ts above the graph off is a convex set (see Exercise 10). Elementary texts in calculus sometimes leave the impression that any equation in X and y \"defines y as a function of X.\" This must be both qualified and explained. What is usually meant is that, given an equation (1-28 ) E(x, y) = 0 one is often able to \"solve for .1',\" at least in theory. Without some restrictions, this is certainly false; the equation y2 + (x - y)(x + y) - 1 = 0 certainly cannot be \"solved for y.\" Moreover, solution of an equation such as 26 ADVANCED CALCULUS (1-28) does not usually yield a single unique solution for y, whereas when we write y = f(x), we require that exactly one value of y correspond to a chosen value of x. The meaning of the original statement can be made a little clearer. If the function E is suitably restricted, then Eq. (1-28) defines a collection (with possibly just one member) of functions f such that, iff is one of them, then E(x,f(x)) = 0 for all x in the domain off The geometric point of view is very helpful here. Let S be the graph of Eq. (1-28), that is, all points (x, y) for which E(x, y) = O. The set S may be single-valued, meaning that it has the property that no two distinct points in S have the same first coordinate. If so, then S itself is the graph of a function, and we have \"solved\" (1-28). In general, S will not be single-valued; some vertical lines will cut it twice. However, the set S will contain as subsets many single-valued sets, and each of these will be the graph of a function which \"solves\" Eq. (1-28). We return to this topic when we take up the implicit function theorems and try to find the needed conditions for good solutions to exist. So far, the only numerical-valued functions were real-valued. However, there is nothing to prevent one from dealing with functions whose values are complex numbers, such as f(t) = (2 + 3i)t 2 - 4i t + (1 - i) All can be reduced to the study of real-valued functions, however, for we can write any complex-valued function F in the form F(p) = G(p) + i H(p) where G and H are real-valued functiOils. In our example, f(t) = (2t 2 + 1) + i(3t 2 - 4t - I) Recalling that the complex number a + bi can be plotted as the point (a, b) in the plane, we see that a complex-valued function F can also be regarded as a function whose values lie in R 2 • It also turns out to be useful to consider functions whose values are more abstract objects. For example, in the study of systems of differential equations, many techniques are simplified if one works with functions whose values are matrices. An example of such a function is ( ) = pt2 + 1 F t I 2t + 1 5t - 2 t 2 + 1 t 3 + 7t j t + 5 We will meet matrix-valued functions later on in this book, where they emerge as the natural form for the derivative of a transformation from n space into rn space. SETS AND FUNCTIONS 27 Finally, in Chap. 8 we will meet functions whose domain itself is a set of functions. You have already met such functions, for differentiation itself is an example; d/dx is a function that can be applied to functions such as x 3 - 3x 2 , giving for the value another function 3x 2 - 6x. There is one special class of functions that is so important that it deserves separate mention. In your earlier work with mathematics, you have already met the term \"infinite sequence\" and the notation {aJ By this, one is to understand that to each positive integer n has been assigned a specific number an in some determinable manner. If we examine this critically, it is evident that we are again dealing with a function whose domain is the set Z+ = {I, 2, 3, 4, ...} of all positive integers and whose values are numbers. Explicitly, the sequence symbolized by {an} is the function mapping n -+ an' Taking the next step, a function on Z+ to the plane will be a sequence of points in the plane, and a sequence in Rn is defined to be any function from Z+ into n space. We can denote it either by {Pn} or by: n -+ Pn ' The values of this function are the points Pn ' which it is usual to call the terms of the sequence. They do not have to be all different. The sequence given by an = (- l)n has only two distinct terms, 1 and - 1. We shall use the word \"trace\" to describe the exact range of the function, the set of distinct points that appear as terms in the sequence. Other types of sequences will also be important in all the work to follow. For example, we will often deal with sequences of sets, such as {D n} where Dn = {all points P with Ipi :os; n} Each of the terms in this sequence is a ball, and as n increases they expand (see Exercise 15). Again, we will devote much space to the study of sequences of functions; a sample of this is the sequence {In} where While each of these examples could be formalized as a function on Z+ taking its values in either the class of all sets or the class of all functions, we prefer to treat this more informally. EXERCISES I Give the domain of definition of each functionfdefined below. and describe or sketch its graph: (a) f(x) = 1/(1 + x 2 ) (c) f(x) = xl(x - 1) II for x < y (e) f(x. y) = ,0 for x = y 11 for x> y (b) f(x. y) = 4 - x 2 _ y2 (d) f(x. y) = I/(x 2 _ y2) 28 ADVANCED CALCULUS (b) f(p) = Ipl- I when Ipl < I 2 Letf(x) = x 2 + X, g(x, .1') = xy, and h(x) = x + I. What are: (a) f(g(l, 2)) (b) h(f(3)) (e) g(f(1), h(2)) (d) g(f(x), h(y)) (e) g(h(x),j(x)) (f) j(g(x, h(y))) (g) f(f(x)) 3 (a) If F(x) = x 2 + x and G(s) = s + S2, are F and G different functions? (b) If F(x, .1') = x 2 + .I' and G(x, .1') = x + .1'2, are F and G different functions? 4 (a) What is the natural domain of the function g(x) = j2-=\"~? _ (b) What is the natural domain of the functionf(x) = Jx - 3 + J2 - x? *5 Sketch F for which F(I/(x - I)) = x/(x + I), x # 1. 6 Sketch the level curves of the function described by f(x, .1') = x 2 _ .1'2. 7 Sketch the level curves for f when (a) f(x, .1') = .1'2 - x 1 1 (e) f(p) = x - .I' when Ipl2 I 8 Sketch the level surfaces for the functionf(x, .1', z) = x 2 + .1'2 - Z2. 9 Let F(x, .1', z, I) = (x - 1)2 + .1'2 + Z2. By interpreting this as the temperature at the point (x, .1', z) at time I, see if you can get a feeling for the behavior of the function. 10 Iff is a function of two variables, show that if the set of points above the graph of f is a convex set, then f satisfies (1-27). 11 What can you say about the problem of solving for .I' in the equation x 3 - .1'3 + X - .I' = o~ How many real functions on - x < x < x does this equation define? *12 Given E(x, .1') = x 2 - .1'2, how many different functions f are there that are \"defined by the equation E(x, .1') = 0 so that .I' = f(x)\"? 13. Find the first six terms of the sequence defined by a. = (- 2)\"+ I + (- 3)· 14 Given x. = 3n + (-I)\"(n - 5) + 7, (a) Calculate XI' x 2 ' ••• , x iO ' (b) Find all the numbers that ever appear twice in the entire sequence. *(e) Do any terms appear three times? 15 What is U~ D. where D. = {all points p with Ipl ~ n}? *16 Show that the collection of all functions defined on a set D, with values in R3 , is a vector space. 1.5 TOPOLOGICAL TERMINOLOGY The role of elementary topology is to give precision and structure to a variety of intuitive concepts such as \"nearness\" and \"neighborhood,\" \"limits\" and \"continuity.\" When these concepts are used in the plane or in n space, they rest ultimately upon certain basic properties of the real number system R, and upon properties of the distance function IP - q I, which gives the distance between two points P and q. We start with a sequence of definitions. The word \"near\" in everyday use is ambiguous. The rational number 355/113 is very near to n, since they differ by less than 3 x 10- 7, and Alpha Centauri is one of our nearest stellar neighbors, at a distance of more than 3 x 10 13 kilometers. We shall say that the set of all points P that are near a point Po is those that obey Ip - Po I < 15, for some choice of 15 > O. This 32 ADVANCED CALCULUS isolated if there is a neighborhood about P which contains no other point of S. Note that any interior point of a set is also a cluster point, since a ball always contains infinitely many points. Every point in the closure of a set is either an isolated member of the set or a cluster point for the set. In the example in Fig. 1-22, (0, 2) is an isolated point, but (0, 0) is a cluster point. The subject of this book is analysis and not elementary topology; the topological terminology and concepts appear in this chapter because they will be useful tools in the study of functions on R\" that will follow in subsequent chapters. Our purpose is therefore not to study all the interconnections and implications of the various definitions, but to explain them and state certain useful relations. The following list summarizes a number of these basic properties, to be used whenever they are found helpful. (1-29 ) (i) If A and B are open sets, so are A u B and An B. (ii) The union of any collection of open sets is open, but the intersection of an infinite number of open sets need not be open. (iii) If A and B are closed sets, so are A u B and A n B. (iv) The intersection of any collection of closed sets is a closed set, but the union of an infinite number of closed sets need not be closed. (v) A set is open if and only if its complement is closed. (vi) The interior of a set S is the largest open set that is contained in S. (vii) The closure ofa set S is the smallest closed set that contains S. (viii) The boundary of a set S is always a closed set and is the intersection of the closure of S and the closure of the com- plement of S. (ix) A set S is closed if and only if every cluster point for S belongs to S. (x) The interior of a set S is obtained by deleting every point in S that is on the boundary of S. Each of these can be verified by a proof based on the definitions given above. We present this only for the first two assertions in the list, to show the nature of the proofs. PROOF OF (i) Suppose that A and B are open sets. To show that A u B is open, suppose that Po belongs to A u B. Then Po is in A or it is in B. In either case, Po is the center of an open ball that is a subset of A or a subset of B, since A and B are themselves open and Po must be interior to one of them. This open ball is then a subset of A u B, and Po is there- fore interior to A u B. Every point of A u B is therefore interior to A u B, and A u B is open. The proof that A n B is open is slightly different. Let Po be any point in An B; we must show that Po is interior to An B. .'4 ADVANCED CALCULUS nceded is a counterexample. Let A k be the open disc in the plane, centered at the origin and of radius 1+ I/k. We have Al ~ A 2 ~ A.1 ~ ...• and a moment's thought will show that the intersection , B = n A~ = Al n A 2 n A 3 n', is the closed disc of radius I, definitcly nOI an open SCI. (It is instructive to sec where the proof for a finite collection of open sets breaks down.) The purpose of such a list of topological facts and definitions is to give a language in which to describe new aspects of sets and functions with mathematical precision. As an illustration of this. considcr the intuitivc notion of a sel that is \"connected:' Asked to explain the meaning of this word. one might point to the set H shown in Fig. 1-21 as one that is certainly not connected. and then to the set B in Fig. 1-23 as a sample of one that is con· nected. With enough samples. perhaps the precise meaning of Ihe term will be clear. but a careful mathematical definition would be better. In fact. there arc two slightly differenl aspects of the intuitive idea. The sel H in Fig. 1-21 would certainly be said 10 be disconnected. since it consists of two separated pieces, This aspect is captured very adequately in Ihe following. Definition 2 Two (tisjoillt set.' A alld B, \"eit/WI\" ('lI1pn', an' sailJ 10 he mutually separated if neither cOn/ains a howl/lar,r {)(Jim t.!{ I he 011/{,I\". A s('1 is disconnecfed if if is Ille union oIwparalel1 .~llh,,·(',s.(111I1 i\" calfed connl'Cfl'd {{it is not IJisconnected. The scope of this definition can be realized hy conlrasting the sel S consisting of all (x, .r) with Xl - .rl < O. and Ihe sct T thai is obtained from .\"j by adjoining allihe points (x. y) wilh .1' = Ix I. The fanner is an open sel. shown in Fig. 1-24. and it is made up of IWO separated pieces. the top half where.r > 0 and Ihe botlom half where y < O. We would certainly conclude that S is dis- s Figure f-24 SETS AND FUNCTIONS 35 connected. However, we would not wish to call the set T disconnected. T is the union of two disjoint subsets, the top half A consisting of all (x, y) with y ~ IxI, and the bottom half B comprising those (x, y) with y < IxI. However, these subsets are not mutually separated, since the origin (0,0) belongs to A but is a boundary point of B. Note how slight is the difference in appearance of the set S and the set T, which differs only in containing the boundary of A. The second aspect of the intuitive meaning of connected is brought out by saying that the set B in Fig. 1-23 is connected\" because it is possible to travel between any two points of the set without ever leaving the set,\" a statement that is clearly false for the set H in Fig. 1-21. It is technically more difficult to make this concept precise, since we must explain \"travel between.\" We choose to interpret this to mean that there is a path or curve which lies in the given set and joins the two chosen points. However, the notion of \"curve\" itself has pitfalls, to be resolved in later chapters, and so we adopt for the present a temporary version that has no ambiguity. Definition 3 A set S is said to be polygon connected if, giren any two points p and q in S, there exists a chain of line segments in S which abut and form a path starting at p and ending at q. This definition has the virtue that is relatively easy to check, given a set S and a specific pair of points p and q. On the other hand, Definition 2 is easy to use in confirming that a specific set is disconnected, but very difficult to use to check that a set is connected, since one must prove that no decomposition ofthe set into mutually separated pieces is possible. Indeed, it is not until Sec. 1.7 that we will be able to prove that the line itself is connected, while it is obvious that the line is polygon connected. In Appendix 2, we will give an example to show that the difficulty is real and not artificial by exhibiting a set that can be shown to be connected, but which is not path connected. For the present, we show that such difficulties do not arise if we work with open sets, as in fact we shall for much of the work to follow. Theorem 2 Any open connected set is polygon connected. Let 0 be an open connected set, and take any two points ql and q2 in (7;. We will show that there is a polygon path in 0 that joins ql to q2' Let A be the set of all points p E 0 that can be joined to ql by a finite polygon path lying entirely in f!/. Clearly, ql E A; indeed, since 0 is open and all points p in a small ball centered at ql are in (7; and can be joined to ql along a radius, this ball is a subset of A. We prove that A is open. Let Po be any point in A. Since f! is open, there is an open ball.Ai about Po that lies entirely in 0 (see Fig. 1-25). Clearly, any point in A/' can be reached from Po by a segment in ,/V. Since Po is in A, there is a polygon path in 0 from ql to Po. Putting these together, we are able to connect ql in 0 to any point in Ar. Hence, all points in .t' lie in A, proving that Po is interior to A and A is SETS AND FUNCTIONS 37 3 The same as Exercise 2 for the set of points (x, .1', z) such that: (a) x 2 + .1'2 + Z2 > 4 (b) x 2 + y2 S 4 (c) xy > z (d) (x - .IV = Z2 4 The same as Exercise 2 for the set of points x on the line such that: (a) x(x - 1)2> 0 (b) x(x - I)(x + 1)2 sO 5 Let 5 = {all (x, .1') with x andy rational numbers:. (a) What is the interior of 5? (b) What is the boundary of 5? 6 What are the cluster poin ts for the set 5 = lall C'~)with 11 = 1,2, ... , m = I. 2, ... : 7 Produce an unbounded infinite set with no cluster points. 8 By constructing an example, show that the union of an infinite collection of closed sets does not have to be closed. 9 Let C be a closed set and V an open set. Then C - V is closed and V - C IS open. Verify this statement, using statements in (1-29). 10 Construct pictures to show that each of the following is false. (i) If A c B. then bdy(A) c bdy(B). (ii) bdy(5) is the same as the boundary of the closure of 5. (iii) bdy(5) is the same as the boundary of the interior of 5. (iv) The interior of 5 is the same as the interior of the closure of S. II Let 5 be any bounded set in 11 space. Is the closure of S a bounded set? 12 What is the relationship of bdy(A n B) to bdy(A) and bdy(B)? 13 (a) Why should the empty set 0 be called both open and closed? (b) Why, in the plane, is the set {all (x, .1'), x 2 + .1'2:2: 0) both open and closed? 14 Let Un = {all p = (x, r) with Ip - (0,11)1 < 11). Show that the union of all the open sets Un' for 11 = I, 2, 3, ... , is the open upper half plane. 15 Let A and B be connected sets In the plane which are not disjoint. Is A n B necessarily con- nected? Is A u B necessarily connected? 16 Show that the complement of the set in Exercise 5 is a polygon connected set. Is it an open set? 17 (a) Is the interior of a connected set necessarily connected'.' *(b) Is the closure of a connected set necessarily connected? 18 (a) Show that any two disjoint nonempty open sets are mutually separated. (b) Show that any two disjoint nonempty closed sets are mutually separated. *19 When a set is not connected, the separate pieces that it comprises are called components. How many components are there to the set 5 = {all (x, .1') with x 2 - 3xy + .1'3 < O:? 1.6 SEQUENCES Before introducing additional terms that are descriptive of the properties of certain types of sets of points, we show that those properties already stated are useful in discussing some standard parts of analysis. We take up the topic of sequences and convergence. Recall that a sequence {Pn} of points in any space is a special type of function! defined on the set Z+ = {l, 2, 3, ...} whose value at n is! (n) = Pn' The trace of a sequence {Pn} in a space is the set A of all 38 ADVANCED CALCULUS Figure 1-26 P. = (( - 1)\". ~) the points that appear as terms in the sequence; Thus A = {all p. for n = 1,2,3, ...} For example, the sequence in the plane given by P. = (( -I)', lin) has for its trace the infinite set shown in Fig. 1-26, while the trace of the sequence on the line, q. = 3 + (- 1)'2 is the set {l, 5}. A sequence is said to be bounded if its trace is a bounded set. Thus, for {P.} to be bounded, there must exist a number M such that !p.1 < M for all n = 1, 2, 3, .... The sequence whose terms are displayed in Fig. 1-26 is a bounded sequence. The concept of a convergent sequence is basic to analysis. Definition 4 A sequence {P.} converges to the point p if and only if every neighborhood about p contains all the terms P. for sufficiently large indices n; to any neighborhood U about p, there corresponds an index N such that P. E U whenever n z N. Under these circumstances, it is customary to call p the limit of {P.}, and to write lim... \", p. = p or p. --+ p, which is often read: \"P. approaches p as n increases.\" If the terms of the sequence were displayed as lights which flashed in succession, convergence would be observed by noticing that the points p. tend to concentrate more and more closely around the point p, for later values of n, and that if we construct a spherical neighborhood U of radius p > 0 about p, then eventually (when n > N) all flashes appear inside U and none appear outside. Note that the approach to p does not have to be from any particular direction, nor does the distance from P. to p have to decrease uniformly at each change in n. For example, the sequence in R 1 described by 2+(-I)k Pk=-'-- k has as its terms in order the numbers 1, ~, t, ;i, !, ~, ~,i, ... and converges to O. (Given p> 0, choose N so that N> 31p; then, IPk - 01 < P whenever n> N.) A word of caution about notation: The symbol\" 00\" used in connection with limits is neither a number nor a point on the line, but merely part of the or SETS AND FUNCTIONS 39 expression\" n --+ x.\" It need not have any meaning out of context. A test of this is the fact that \"'X \" does not appear in the statement of Definition 2 above. (Another aspect of the use of the symbol 00 will be found at the end of Appendix 2.) A sequence is said to be convergent if there is a point to which it converges. (As will be seen later, there are many times when it is possible to be sure that a sequence is convergent even if one does not know the point to which it converges.) A convergent sequence cannot converge to two distinct limits. For if {Pn] were to converge to both P and q with p ¥ q, then we could choose spherical neighborhoods about p and q that are disjoint; but, all but a finite number of the Pn would have to be inside each of these neighborhoods, which is impossible. A sequence that is not convergent is called divergent. This can happen in a number of different ways. The sequences given by bn=(-I)nn en = 1 + (-1)\" are each divergent, as is the sequence pictured in Fig. 1-26. It is evident from the definitions that the convergence or divergence of a sequence is not affected if one changes any finite number of its terms. In this sense, we are dealing with something that is a property of the \"tails\" of a sequence, the images of the sets In={n,n+ l,n+2, ... ] In order to show that a specific sequence is convergent, the only method we have available to us (at this stage) is to guess the limit and then check this by a certain amount of calculation. As an illustration, consider the sequence n--+p =(I,_n) n n n + 1 By one method or another (for example, by plotting some points of its trace), we are led to guess that this sequence converges to the point p = (0, 1). We want to show that lim Pn = (0, 1). Taking for U a neighborhood about p of radius £ > 0, we want to have IPn - pi < £ for all sufficiently large n. Sub- stituting the coordinates of P n and P, we wish to have I (~,n : 1) - (0, 1) I < £ 1 + ( n _ 1) 2 = 1 + _1 < £2 n2 n + 1 n2 (n + 1)2 for all n larger than some number N. This probably seems self-evident; 40 ADVANCED CALCULUS however, to give a formal argument (and to get some idea of how large N must be), we proceed thus: Since 1/n 2 + l/(n + 1)2 < 2/n 2 , we can obtain our goal by choosing N so that 2/N 2 < 1::2. Hence, we can choose N to be (J\"2)/1::. Any larger value of N, such as 2/1:: or 20/[;2, would do as well. I We now turn to the proof of several theorems about limits. Theorem 3 Any conrergent sequence is bounded. Let limn_x Pn = p. If we take V to be a neighborhood of radius 1, centered on P, then there will be only a finite number of terms of the sequence outside U. V is bounded, and any finite set is bounded; so the trace of the sequence is bounded. I Theorem 4 If limn_, Pn = P and limn_., qn = q, then lim (Pn + qn) = P + q Given I:: > 0, we may assume that there are numbers N' and N\" such that IPn - pi < I:: whenever n > N' and Iqn - qI < I:: whenever n > N\". Take N to beany number largerthan both N' and N\". If we have n > N, then both the above inequalities hold, so that (by using the triangle inequality) Ipn + qn - (p + q)1 = Ipn - P + qn - ql s Ipn - pi + Iqn - ql < I:: + I:: = 21:: This says that, except for a finite number of terms at the start, all terms of the sequence {Pn + qn] lie in a neighborhood of radius 21::, centered at the point P + q. Since I:: can be any positive number, we have shown that this is true of every neighborhood of P + q, and thus limn_ x (Pn + qn) = P + q. I The topological properties of a set in n space can often be explored most easily by means of sequences. For example, the following result affords an alternative way to define closure. Theorem 5 The closure of a set S in Rn is the set of all limits of cOnl'erging sequences of points from s. Let {Pn] be a sequence of points in S, with lim Pn = p. We shall first show that P belongs to the closure of S. This is certainly true if P is either in S or in the boundary of S. Could P be exterior to S? If so, then there would be a small neighborhood V about P such that V contains no points of S. In particular, V contains none of the points Pn' contradicting the fact that {Pnl converges to p. Hence, P lies in the closure of S. To complete the proof, we must show that every point in the closure of S can be the limit of a converging sequence from S. Let q be such a point. when n is even SETS AND FUNCTIONS 41 If q E S, then, clearly, we can take P. = q for all n and the sequence {P.} converges to q. Suppose therefore that q is in the closure of S, and not in S. The point q must then be a cluster point for S; every neighborhood of q contains points of S. Take any convenient decreasing sequence of neigh- borhoods of q, such as the sets U. = {all p with Ip - ql < lin} and choose any point P. in U.I\\ S. Then, it is evident that {P.} is a sequence in S which converges to q. I Corollary 1 Every point in the boundary of a set S is simultaneously the limit of a converging sequence of points in S and a converging sequence of points in the complement of S. For, by item (viii) in the list of basic topological facts (1-29), bdy(S) is the intersection of the closure of S and the closure of the complement of S. Corollary 2 A set S is closed if and only if it contains the limit of erery converging sequence {P.} whose terms lie in S. For sequences, the analog of the term\" cluster poin t\" is limit point. A point p is a limit point for the sequence {p.] if every neighborhood of p contains infinitely many of the terms p.; since many of the terms could be identical, we give a formal definition. Definition 5 p is a limit point for {P.} if given any neighborhood . ~ . about p, there is an infinite set of integers A such that p. E • ~ . for all n E A. Note that the set A depends on . ~ \" and may change if . ~ . is decreased in size. The difference between \"limit of a sequence\" and \"limit point of a sequence\" is subtle; for the former to hold, all the terms p. must lie in. V for n beyond some index no' while for the second to hold, p. must lie in . ~ . only for some infinite sequence of values of n, which may in fact be widely separated with none consecutive. As a result, a sequence can be divergent and still have limit points. The sequence p. = (( -I)·, lin) has (1,0) and (-1,0) as limit points, as seen from Fig. 1-26. Again, the sequence defined by a. = n + 1 + (-1)\"( n + ~) has exactly one limit point, and yet is divergent. For, we see that 12n + 1 + 1 ; n when n is odd 42 ADVANCED CALCULUS It is evident that 1 is a limit point for {an}' and since the sequence is unbounded, it is divergent. Moreover, there are no other limit points, for there is no number other than 1 about which terms of the sequence cluster. This concept, limit point, becomes easier to work with if we also introduce the related idea subsequence. Given a sequence {PnL and any increasing sequence of integers n l < n2 < n3 < ... we can define a new sequence {qk) by qk = Pnk This is called a subsequence of {Pn}; its terms are terms of Pn and are Pnl' P n2 ' P n3 ' •••• For example, the (divergent) sequence I, 1, I, t, 1, t, ... has, among its subsequences, the sequence 1, 1, t, t, ..., as well as the sequence 1 1 1 1 1 1 1 t Th '\" \"1 h', 4' 9' '16' 25' ,.... en, It IS easy to gIve an argument SimI ar to t at In the proof of Theorem 5 to show the following. Theorem 6 The limit points of a sequence {Pn} are exactly the limits of the converging subsequences of {Pn]. While we have discussed convergence for sequences of points in n space, it is clear that the problem of checking the statement limn _ ~ Pn = P can always be reduced to a problem dealing only with real sequences. One way to do this is to observe that {Pn} converges to P if and only if lim IPn - pi = 0 A better method is based on the following simplifying observation. Theorem 7 A sequence in n space is convergent if and only if each of the real sequences obtained from its coordinates is convergent. Thus, in 3-space, Pn = (an' bn, cn) defines a convergent sequence if and only if {an}' {bn}, and {cn} are each convergent real sequences. PROOF IN R 3 Let P = (a, b, c). Then, using Exercise 6 in Sec. 1.3, Ipn - pi ~ Ian - al + Ibn - bl + ICn - cl Ian - aI ~ IPn - pi Ibn - bl ~ Ipn - pi and ICn-cl~IPn-pl t Strictly speaking, a description of a sequence is not complete until a formula can be given for the general term or until a recursive rule is given which specifies the terms in some unique way. In practice, however, it may be sufficient for communicalions purposes to list enough of the terms to make the law of formation evident. This brings in matters of experience and judgment which could lead 10 conflicting choices; the terms 2. 3, 5, 8 might with equal justice be followed by 12, 17, 23, 30 or by 13, 21, 34, 55. SETS AND FUNCTIONS 43 Hence, lim n_ '1 Pn= P if and only if limn_, an = a, limn_, bn= b, and limn_, cn = c. I (The proof in n space follows the same pattern.) The advantage of thus being able to reduce questions about the convergence of a sequence of points to questions dealing only with sequences of real numbers is that one is back on more familiar ground. For example, one may use the following standard facts, whose proofs we include only for com- pleteness. Theorem 8 If limn_ '1 an = A and limn_, bn = B, then limn_ '1 (an + bn) exists and is A + B. PROOF This is merely Theorem 4 for R 1. Theorem 9 If limn_, an = 0 and {bnJ is bounded, then lim anbn = 0 n- , PROOF Suppose that IbnI < M for all n. Given any neighborhood . 1 ' about 0, choose G small enough so that if IcI < M G, then c lies in . 1 . Since limn_, an = 0, there is an no such that IanI < G for all n > no' Then, for these values of n, Ian bnI < Ian IM < M G, and an bn lies in . 1'. (Note that it is only necessary to know that Ibn I < M holds for sufficiently large n.) I Corollary Iflim n_ '1 an = A, then for any real number c, lim can = cA n- , PROOF Take bn= c for all n, and observe that limn_x (an - A) = O. I Theorem 10 If lim an = A and lim bn = B, then lim anbn = AB n- , PROOF Observe that anbn = (an - A)bn + Abn and use the fact that limn_, (an - A) = 0, {bn} is bounded, and limn_, Ahn = AB. I Theorem 11 Let limn_, an = A #- O. Then, there is an no such that II Ian I < 21IA Ifor all n > no; thus, the sequence {l/anl is defined and bounded for all sufficiently large n. 44 ADVANCED CALCULUS PROOF Using 6 = IA 1/2, choose no so that IA - anI < IA 1/2 for all n > no· Then, for n > no we have IA I = IA - an + anI ~IA - anI+ IanI< I; I+ IanI which implies that lanl > IAI-IAI/2 and I/lanl < 2/1AI· I Corollary Iflim n_7: an = A #- 0, then lim n _7: l/an = I/A. PROOF I/an- II A = (A - an)( II Aan) and lim n _ 1 (A - an) = 0 and 1/(Aan) is bounded by 2/1AI2 for large n, so that limn _:<. (i/an- I/A) = O. I Theorem 12 If limn _ 1 an = A and limn _ 1 bn = B, and B #- 0, then lim anlbn = AlB As will be shown in the next section, every bounded sequence of real numbers has at least one limit point, using the term as it was given in Definition 5 above. If such a sequence is not convergent, it will have at least two limit points. The largest limit point of {an: is called the limit superior or upper limit of the sequence, and is denoted by lim SUPn_ 7 an. Similarly, the smallest limit point of {an] is called the limit inferior or lower limit, and is denoted by lim infn_ oc an. Of course, if the sequence {an: is convergent, then the upper and lower limits coincide with limn _ 7: an; otherwise, we always have lim inf an < lim sup an' We can use these at times to work with a bounded sequence that is not known to be convergent; however, lim sup and lim inf do not obey the same rules as the ordinary limit operation, and are thus somewhat harder to work with (see Exercises 27 and 28). These results, many of which may have been familiar, enable us to discuss the convergence of more complicated sequences in terms of the behavior of known simpler sequences. For example, a starting point is the fact that limn _ y lin = 0. (We remark that the truth of this goes back to the basic fact that the rational numbers are dense in the real numbers; given any 6> 0, there is an integer N such that 0< liN < 6, so that 11//1 - 01 < 6 for all /I> N.) We can use this to show that lim 5n 2 -:-_3n + 7 5 n-:<. 6n 2 + 11 + 2 6 by writing 5n 2 - 3/1 + 7 5 - 3in + 7//1 2 5 - °+ 0 5-- - ----_. = -- -+ = 6n 2 + /I + 2 6 + l/n + 2//1 2 6 +°+ 0 6 SETS AND FUNCTIONS 45 Again, given an = J n + 1 - J n, we write r. _ J _(In_±-1 -jn)(~n±-1 + jn) vi n + 1 n - ~n-+T+ ~n 1 1 = ·.·.,--------c <- ·C ~n--+-1 + ~n ~n and since limn _ ao l/jn = 0 (see Exercise 11), we conclude (see Exercise 9) that limn _ ao ~n+l - jn = O. These examples illustrate the general approach to be used. One uses algebraic manipulation, inequalities, the standard theorems on limits (Theorems 8, 9, 10, and 12), and other simple relations such as those in the exercises to convert the original limit problem into another one that has been already understood and solved. The stage at which a mathematical problem is considered to have an obvious solution depends on the experience and insight of the solver. The test is always how easy it is to supply a formal proof. For example, it is undoubtedly seems obvious that limn _ et 2- n = o. A formal argument can be given by observing that the inequality 2- n :s: l/n holds for all n 2 1. However, is it equally obvious that n 3 lim . = 0 ? n-et 2 n If it is claimed that n3/2 n :s: l/n, which is equivalent to the assertion that n 4 :s: 2 n, then a little testing shows this is not immediately clear; thus, for n = 10 we have 10 4 = 10,000, which is larger than 210 = 1024. However, the following is indeed true; the proof is a standard use of mathematical induction. (A fuller discussion of this technique of proof is found in Appendix 1.) Lemma 1 n 4 :s: 2 n for all n 2 16. We observe first that 164 = (2 4 )4 = 2 16 , so the stated inequality holds when n = 16. We show that if it holds for n = N, then it must hold for 11 = N + I. We then conclude that the inequality must hold for n = 17, 18, 19, etc. Suppose N 4 :s: 2 IV and N 2 16. By the binomial theorem (N + 1)4 = N 4 + 4N 3 + 6N 2 + 4N + 1 < N 4 + 4N 3 + 6N 3 + 4N 3 + N 3 = N 4 + 15N 3 But, N 2 16 and the original inequality has been assumed for n = N, so that (N + 1)4 < N 4 + N(N 3 ) = 2N4 :s: 2(21\\') = 21\\'+ 1for aliI! > N 46 ADVANCED CALCULUS But, this is exactly the form the stated inequality takes when n = N + 1. Hence, n4 S 2\" for all n 2 16. I We can now use this to dispose of the previous limit problem. Since n 3 = (n 4 ) 1 < 1 2\" 2\" n - n we may conclude that n3/2\" --+ O. Is it now evident that nlO/2\" --+ 0 as n increases? To give a similar proof of this would require that we first show that nil S 2\" for all sufficiently large n. To prove this by induction, we need a starting point, and it happens that the first n for which this holds is n = 67. Even less\" obvious\" is the statement For anI' choice of the number r, lim n' = 0 ~ n- 1: 2\" since there does not seem to be a way to start an inductive argument if you do not have a specific value for r. There is a way to avoid all these difficulties. If we want to prove that nil S 2\" for large n, then it is equivalent to prove that 11 log n s n log 2, or that (log n)/n S (log 2)/11. [As we have stated earlier, we feel free to use all the standard computational techniques from one-variable calculus.] This leads us to the following result. Lemma 2 lim\"_, (log n/n) = o. Given 11, choose k so that (k - 1)2 S 11 < k 2 . It is easily checked that the inequality k 2 < 2k - 1 holds for all k 2 7. Thus, for any n 2 (6)2 = 36, we have log n S log(k 2 ) < log (21.-1) = (k - 1) log 2 S ~n log 2 and we have shown that log n < ~n log 2 = log 2 --+ 0 I n - n ~n . Theorem 13 For an.\\' b > 1 and an.\\' number r. I· n' 0 1m - = n- f b\" Since (log n)m --+ O. choose N so that O log n log b < < n r + 1 SETS AND FUNCTIONS 47 Then, (1 + r) log n < n log b, or n'+ 1 < bn, and n'lbn < lin -+ 0, which proves the assertion. I All these illustrations have dealt with positive sequences that approach O. The next illustration shows a different technique. Set an = nl/n and note that an ~ 1. If we set an = 1 + c, so that c ~O, then (1 + c)n = (n 1/n)n = n By the bmomIaI theorem, n(n - 1) (I + c)n = 1 + nc + - c 2 + ... 2 and in particular, since c ~ 0, throwing away all but two terms gives or n(n - 1) (1 + c)n ~ 1 + 2 - c2 n(n - 1) 2 n>l+ c- 2 and this yields c 2 :5: 21n, and 0 :5: c :5: fi/~. But, an = 1 + c, so that 0:5: an - 1 :5: fi/~, and we have proved Iimn _ oo an = 1. I Another very important method for proving that a sequence of real numbers converges is based on the order properties of R. A sequence {an} is said to be increasing if and decreasing if It is said to be monotonic if it is one or the other, and strictly monotonic if consecutive terms are never equal. The following statement describes a fundamental property of the real number system: Erer.l' bounded monotonic sequence is conrergent Because this is so basic to the rest of this chapter and to later chapters, and because its nature is ambivalent, regarded both as an axiom and a theorem, we postpone a discussion of it until the next section. However, we give three applications of it here to show its usefulness. 48 ADVANCED CALCULUS Consider a sequence {x n} defined by the following: XI = 1 (1-30) for n ~ 1 Note first that this differs from previous examples of sequences in that no explicit formula is given for the nth term of the sequence. Of course, it is easy to use this to calculate the terms of the sequence: XI = 1, x 2 = 2, x 3 = 2 + t = 2.5, x 4 = 2.9, X s = 3.24482 \"', x 6 = 3.55301 \"', x 7 = 3.83446 \"', and so on. Does this sequence converge? Often, it is possible to guess the limit of a converging sequence from the numerical values. This is the case, for example, with the sequence nl/n we discussed in Theorem 14, where the first seven terms were 1, 1.41, 1.44, 1.41, 1.38, 1.35, 1.32 By the time we reach large values of n, we obtain numbers strongly suggesting that the limit is 1. Thus, when n = 100 we have 1.047 and when n = 200 we have 1.027. This process is not very helpful with the sequence {x n}. Calculation yields x so = 10.0839 and x lOO = 14.143, which suggests that the sequence is divergent, but the data are not conclusive since we do not know how the sequence will behave for much larger values of n. The monotone sequence property settles this at once. By an easy induction argument, x n ~ 1 for all n, and hence {xn} is monotonic increasing. Suppose it were a bounded sequence. It would then have to be convergent, having a limit, limx_'X x n = L, for some real number L> 1. It would then necessarily be true that limx_ex, (x n + l/x n ) = L + I/L, which, by (1-30) is the same as the assertion r 1 1m Xn + 1 = L + L x-x But, the sequence with terms X 2 ' X 3 ' ... must have the same limit as the sequence {x n}, namely L. Thus, the number L must satisfy the equation 1 L=L+ L which is impossible. Thus, we can conclude that the sequence {x n } is unbounded. This means that for sufficiently large indices n, X n becomes as large as you like. (In Exercise 15, a method is suggested for determining more precisely how fast this sequence grows.) Our second example is the sequence an = (1 + l/n)n. We have a 1 = 2, a2 = 2.25, a3 = 2.37037 \"', a4 = 2.44140 \"', so that the sequence appears to be increasing. This can be verified by a tedious algebraic computation, and it can also be shown that {an} is bounded, so that it would then follow that limn_x an exists. The limit is the important number e = 2.718281 \"', which is SETS AND FUNCTIONS 49 the base of the natural logarithm. However, we win use a different method to show that {an} converges. Consider instead the sequence bn= (1 + l/n)n+l. Computation suggests that {bn} is a decreasing sequence. If this is true, then, since bn > 0 for an n, {bn} must converge. To show that bn > bn+l, we examine the quotient bjbn+l , which is (1 + ~)n+1 = (n + l)n+l(n + l)n+2 ( 1+ 1 )n+2 n n+2 11 + 1 = (n 2 + 2n + l)n+l(n + 1) n2 + 2n n + 2 ( 1 )n+l(n + 1) = 1 + n2 +2n ,;+ 2 We need a simple but useful inequality in order to simplify this. Lemma 3 For any integer m > 0 and an)' x > 0, (1 + x)'\" > 1 + mx This comes at once from the observation that m(m - 1) (1 + x)'\" = 1 + mx + . -- X 2 + ... > 1 + mx 2 Using this, we can continue the estimate of the size of bn/bn+ b obtaining first ( 1 + 1 )n+l> I +(11+ 1)( __ 1 ) =n_2_+3~+ 1 n2 + 2n n2 + 2n n2 + 2n and then bn > (n 2 + 3n + 1)(n + 1) = n3 + 4n 2 + ~n±_1 bn+1 n2 + 2n n + 2 n 3 + 4n2 + 4n > 1 This shows that bn > bn+b and that {bn} is a decreasing bounded sequence, and therefore a convergent sequence, by the monotonic sequence property. Hence, limn~cx: bn = L exists; note that we know only that L 2 O. [The monotonic sequence property guarantees that a bounded sequence con- verges, but teIls little about the limit.] This is enough to ten us that the original sequence {an] converges, for an = (1 + I/nr 1bn, and that limn~,,- (I + I/n) = 1. Hence, {an} converges to the same limit as does [hnl· I 50 ADVANCED CALCULUS As a final example, we shall investigate the convergence of a familiar algorithm for computing square roots. Suppose that we want to find J A and that we have already made an estimate x. Then, the algorithm supplies a new and better estimate x' = ~(x + :) As an illustration, let us find approximations for J2. Taking 1 as the first estimate, we find for the second estimate x' = 1( 1 + t) = 1.50 Using this as the old estimate, and applying the algorithm, we get a new estimate, , 1( 2) I x = 2 1.50 + I.-SO = 2 (1.50 + 1.333) = 1.416666 One more repetition of this loop gives x' = ~( 1.416 666 + 1.41~666) = 1(1.416666 + 1.411 765) = 1.4142155 It is clear that this algorithm is actually a process for generating sequences. If we label an initial estimate for JA as Xl' then the nex t term is x 2 = ~(Xl + .:J and in general (1-31) x n = 2 1 (xn - 1 + _A ) x n - 1 We would like to show that lim n _ x x n = J A; we would also like to learn something about the rate of convergence, so that we can estimate the accuracy obtained in using x n as an approximation to J A. Theorem 15 If A > 0 and Xl> 0, the sequence defined by (1-31) converges rapidly to JA. We shall prove that, after the first term, the sequence ~xn: is monotonic decreasing. We have x 2 = ~(x1 + A 1.\\ 1)' Since A and x 1 are positive, so is SETS AND FUNCTIONS 51 X 2. Moreover, ( 2 1 ( 2 A 2)X) - A =.- x + 2A + - - A 2 4 1 xi = 1 (X2_ 2A + .4. 2 ) 4 1 xi = I (x _A_) 2 > ° 4 1 Xl It therefore follows that x 2 is larger than ~A,no matter how x 1 was chosen. This is true for the remaining terms as well. By the same calculation, and X n > J A. To prove that the sequence is decreasing, we examine xn - xn+ 1 = xn - ~(Xn +:J = I (x _A) = x~_-.11 > ° 2 n x n 2x n Hence, x 2 > X3 > X 4 > ... ?: fl. By the monotonic-sequence theorem, {x n} converges. Let its limit be L ?: viA. Now, using Theorems 8 and 12, we have . I ( A) I ( A)hm 2 x n + ... = 2 L + n-x xn L Since this is the same as computing limn_x X n + b the value of the limit must again be L, and we have L = 1(L + AIL). From this, we have L 2 = A, and since L ?: ~A > 0, L = ~Ii. I The rate of convergence of the sequence {x n } to A is quite rapid. We can see this by comparing IXn - J A Iand Ixn+ 1 - ::fA I· We have xn + 1 - JIi = I (xn + A) - JA 2 X n x~.~A - ~J.4 x n 2xn (x n - J.4)2 (x n - JA)2= -----_.- < -_ .. 2xn 2J A 52 ADVANCED CALCULUS This shows that the error decreases at a rate much faster than geometric, because of the squaring; ignoring the factor 2jA, one would expect to see the error go down according to the pattern .1, .01, .0001, .000 000 01, .000 000 000 000 000 1. To illustrate this, we have computed the sequence of approximations for j25, starting with XI = 6, and have obtained 1 X = 5 = 50833 2 12 . 1 x 3 = 5 L4K4 = 5.000 683 1 1 x4 = 521435888 = 5.000000047 The monotonic-sequence property is not the only method that can be used to show that a sequence is convergent without having to guess its limit in advance. We conclude this section by making a few remarks about what is usually called the Cauchy convergence criterion-although, as will be explained at the end of Sec. 1.7, this name is somewhat inappropriate. We first defin'e the term \"Cauchy sequence.\" Definition 6 A sequence {PnJ of points is said to be a Cauchy sequence if, corresponding to any 6> 0, a number N (depending upon 6) can be found such that IPn - PmI < 6 whenever both nand m are larger than N. This condition is also written as lim Jpn - Pml = 0 At first glance, the connection between this definition and convergence is not clear. However, it is an easy exercise to show that any convergent sequence is also a Cauchy sequence (Exercise 32). What is useful is the converse of this, namely, the Cauchy convergence criterion: In n space, any Cauchy sequence is convergent. The proof that this holds requires more mathematical tools than we have at present, and so it is postponed to Sec. 1.7. It will follow from the monotonic- sequence property, which will also be justified later. Instead, we now show several simple applications of it. Suppose that a sequence is defined by the formula X = ,.n cost dt n • I t 2 It is easy to see that {x n } is a bounded sequence, for .\" Icos t I .nil /n IXnl~IT--dt~1 2 dt =- . It. Itt I ~ (-lin) - (-1) = I - lin ~ 1 SETS AND FUNCTIONS 53 for all n = 1, 2, 3, .... From this fact alone we learn nothing, since the sequence {xnJ does not happen to be monotonic. However, if we calculate the difference of xn and x m ' with n > m, . n cos t . m cos t x n - xm= I 2 dt - I t dt . 1 t . 1 t = \"n COS! dt t 2 'm .n Icos t I ,n Ix - x 1 < I .----- dt < I t- 2 dt n m - 2 - . m t . m 1 1 Hence, <_lin - t m m n Since limm • n_\" IXn - xml = 0, the sequence {xn} converges. (Note that these calculations give us no information about the numerical value of limn_~ x n ' This example also illustrates some of the techniques we assume to be familiar from elementary calculus, e.g., that 1cos t 1 ::; 1 for all t, and that the indefinite integral of l/t 2 is - l/t.) One of the most common mistakes made in the use of the Cauchy criterion is to overlook the fact that the indices m and n in IPn - Pm1-+0 must be treated as unrelated and independent. For example, it is not sufficient to have the consecutive terms of a sequence become closer and closer as you move out. Thus, with xn = jn, limn_~ IXn+ 1 - xnl = 0, and yet {x n } is un- bounded and therefore it is divergent. Nor is it enough to have limn_ oo IX</>(n) - xnl = 0, even if the values of cP(n) are considerably larger than n. (In Exercise 22 you will meet an example where limn_\" Ix n2 - xnI= 0, and yet {x n } is a divergent sequence that is monotonic.) In understanding the definition of \"Cauchy sequence\" (Definition 6), the key is that after N has been chosen, the only restrictions on nand mare n> N, m> N; thus, each may be as large as you like, independent of the choice of the other. In the light of these remarks, the following result may seem contradictory! Theorem 16 A sequence {Pn}is a Cauchy sequence, and therefore convergent, if the sequence I Pn+ 1 - Pn1 of distances between consecutive terms ap- proaches 0 fast enough. Specifically, if I Pn+ 1 - Pn1 < Acn where 0 ::; c < 1, for all n, then limn_\" Pn exists. We shall prove that {Pn} is a Cauchy sequence. For this, we need to estimate IPn - Pm 1 for large values of nand m; we may as well assume that m is the larger and write m = n + k. In order to make the argument clearer, we do the calculation first for the special case of k = 3, and then in general. We have Pn= Pn+3 = Pn - Pn+l + Pn+l - Pn+2 + Pn+ 2 - Pn+3 (b) I. I. - I. I. I. -I ... (d) I. H. -16. n.... 54 ADVANCED CALCULUS so that 1<- en -1-e In general, we have Ipn - Pn+kl::; /Pn - Pn+ll + + IPn+k- 1 - Pn+kl ::; en + en + 1 + + en + k- 1 ::; en(l + e + e 2 + ... + e k - 1 ) 1 - e k I < en ------ < - en - l-e 1-e Hence, for any nand m, with m> n, we have 1 IP - P I < ---- en n m 1 - e Now, since e < 1, limn_ oo en = °(see Theorem 13). In particular, given any e > 0, we can choose N large enough so that e l '/( I - e) < e. Then, if n > N and m > N, we have IPn - PmI < e. In other words, limn. m-oo IPn - PmI= 0, and the sequence {Pn} converges. I EXERCISES I Show that the sequence defined by P. = (n. lin) does not converge. 2 Show that the sequence described by P. = (n:!.(-n l ).) converges. 3 Let Ip.+l - ql ~ elp. - ql for all n. where e < I. Show that lim._., P. = q. 4 Let {P.} and {q.l be sequences in 3-space with P. -+ P and q. -+ q. Prove that lim._ x P.· q. = P' q. *5 Starting at the origin in the plane. draw a polygonal line as follows: Go I unit east. 2 units north. 3 units west. 4 units south. 5 units east. 6 units north. and so on. Find a formula for the nth vertex of this polygon. 6 Among the following sequences. some are subsequences of others; determine all those which are so related. (a) I. -1.1. -I .... (e) l.!. U.!... · (e) 1, 0.1. o. 1. o. i. o.... 7 Exhibit a sequence having exactly three limit points. Can a sequence have an mfintte number of limit points? No limit points? Could a divergent sequence have exactly one limit pomt? SETS AND FUNCTIONS 55 8 Discuss the behavior of the sequence {an)' where an = n + I + I/n + (-I)\"n 9 If an S Xn S bnand limn~\" an = limn~\" bn = L, show that limn~\" xn = L. (This is sometimes called the \"sandwich\" property.) 10 Find a formula for the sequence that begins with 1/2, 1/5, 1/10, 1/17, 1/26, ... , and show that it converges to O. II Prove that limn~\", I/Jn = O. 12 What are the correct hypotheses for the truth of the following assertion? If limn~\", an = A, then limn~\" Jan = J A. 13 Prove that limn~x Cl/n = I for any c> I by setting an = c'ln - I, and then deriving the estimate 0 S an S (c - Ilin. 14. Investigate the convergence of the sequence an = Jn 2 + n - II 15 Show that the sequence {x n } defined by the recursive formula: x, = I, for n > I obeys the inequality X n > In for all n2 2. 16 Define a sequence {x n } by for n > I (a) Prove that {x n } is unbounded. (b) Prove that if, for some N, x N S N 2/4, then x N + I S (N + 1)2/4. (c) Is there a value of n for which X n S n 2/4? (You will have to do some calculation. Use a pocket calculator; that's what they are for!) (d) Show that x n 2 n2/9 for all n 2 I. -(e) Show that limn~\", xJn 2 = i. I . 3 • 5 ... (2n - I) 17 Let an = 2·4·6· .. 2n (a) Prove that {an} is convergent. -(b) Can you determine limn~x an? 18 Let XI = I, x2 = 3, and define all later terms recursively by Xn = (xn_ 1 + xn_ 2)/2. Thus, x 3 = 2. x 4 = 5/2. Is the sequence {x n ) monotonic? Does it converge? 19 Let a, = I, a2 = 2, and an+2 = (4an+I - an)/3. Show that {an} converges. 20 Define the sequence {xn: by x, = a, x 2 = b, and xn+2 = (I + xn+,)/xn. Investigate the convergence of {x n }. [Hint: It may help to try some numerical values.] 21 Let a l = 0, a2 = I, and (a) Calculate the value of a6 and a7. (b) Prove that {an} converges. -(c) Show that limn~x an = 1- e- I . 22 Show that x n = Jlog log n, for n 2 3 defines a divergent increasing sequence such that lim (x n' - x) = 0 23 Let {x n } be a bounded real sequence and set P= lim sUPn~x xn ' Show that for any £ > 0, X n S Ii + f: holds for all but a finite number of n, and X n 21i - i: holds for mfinitely many n. What are the analogous statements about lim infn_, X n ry 56 ADVANCED CALCULUS 24 If b ~ x. ~ c for all but a finite number of n, show that b ~ lim inf._, x. and lim sUP._x x. ~ c. 25 If {x.} is a bounded sequence with lim inf._ x x. = lim suP._, x.' show that {x.} converges. 26 Find lim suP._ x a. and lim inf._ x a. when: (a)a.=(-I)\" n + (-I)\"(2n + I) (c) a =-- - ---- - • n (b) a. = ( - 1)\"( 2 + ~) (d) a. = sin ( n ;) 27 If lim sUP._x a. = A and lim sUP._x b. = B, must it be true that lim sup (a. + b.) = A + B *28 Show that, for any bounded sequences a. and b., lim inf a. + lim inf b. ~ lim inf (a. + b.) and that lim sup (a. + b.) ~ lim sup a. + lim sup b. *29 Let {a.: be any seq.uence of numbers converging to 0, and let (J. be the sequence of arithmetic means (averages), a l + a 2 + a3 + ... + a. n Prove that Iim._ x (J. = O. 30 If we start with x I = 2, how far must we go with the square root algorithm to get )2 accurate to 1O- 50 ? IO- IOO ? 31 Define a sequence of points thus: Startmg at the origin. move I unit east. then! unit north, then *unit east, then i unit north, then -h unit east, and so on. (a) Does the sequence of vertices converge? (b) Can you find the \"end\" of this polygon? 32 Show that a convergent sequence {P.: must be a Cauchy sequence. *33 Let A = (0, I) and B = (I. 0). Let PI be any point in the plane. and construct a sequence {p.:, with PI as its first term, as follows: Let QI = midpoint of API and P 2 = midpoint of BQI: then. let Q2 = midpoint of AP 2 and P 3 = midpoint of BQ2' and so on. Prove that {p.: converges. 34 Show that every Cauchy sequence {P.: is bounded. 35 Let P. = (x•. r., =.). Show that if {P.: is Cauchy. so are :x.:. :r.:. and :=.:. . 3/1 + 511l 36 (a) Explam why hm m.• _ x, , = O. 4w + 7/w (b) Is it true that 2n + III 2Iim- - m . • _ x 3n + 5m 2 3 37 Let ak > 0 for all k and suppose that Prove that {ak : converges. 38 Show that Theorems 10 and 12 still hold if the sequences {a.: and {b.: are sequences of complex numbers. SETS AND FUNCTIONS 57 1.7 CONSEQUENCES OF THE MONOTONIC-SEQUENCE PROPERTY Historically, plane geometry probably arose from the efforts of people engaged in an empirical study of the properties of lines, circles, and triangles who first observed certain repeated patterns and then used these to obtain others; much later, someone (perhaps Euclid?) codified the material, decided which should be axioms and which theorems, and presented it as an elegant deductive structure, with no misleading instances of circular reasoning. In this section, we discuss briefly one similar aspect of analysis, and then proceed to a series of very important applications of it in mathe- matics. In Sec. 1.2, we mentioned the algebraic axioms for the real numbers (\" R is a field\") and the existence of the order relation < and some of its properties. There are other aspects of R we did not discuss; for example, there are properties that have the effect of asserting that certain equations have solutions-for example, x 2 = 2. Our belief in this clearly has much to do with our understanding of the nature of the real numbers themselves. If we think of them as unending decimals, then one root of x 2 - 2 = 0 may be thought of as 1.41421356 ... , which in turn may be regarded as the limit of a monotonic sequence I, 1.4, 1.41, 1.414, 1.4142, .... Another approach is suggested by the example at the end of the preceding section. There, an algorithm was obtained for generating a monotonic decreasing sequence whose limit would have to be J2. In both of these approaches, the existence of the real number J2 depends on our belief in the truth of the monotonic-sequence property; it is therefore natural to list this as one of the basic axioms for the real numbers: Any bounded monoTOnic sequence of real numbers is conrergent. However, what is axiom and what is theorem is often an arbitrary choice, since one is often able to derive each logically from the other. Sometimes one can go a step further and make all the axioms of a mathematical system into theorems by basing the system entirely upon some other system. Thus, analytical geometry makes it possible to base all of plane geometry upon the properties of the real numbers. This is also possible with R itself, throwing it back onto modern set theory. With this, we end this digression; refer to Appendix 2 for further details and references. We adopt the position that the monotonic-sequence property stated above is one of the basic axioms for R, and adjoin it to earlier lists. (In the last section, we saw how useful it is in working with sequences of real numbers.) Earlier, in Sec. 1.2, we mentioned another basic property of R, also connected with the order relation <, there called the least-upper-bound property. Recall that any bounded set of integers must have a largest and a smallest member, but that this need not be true of a bounded set of real numbers; thus, the set of all x with 2 < x < 3 has neither a largest member 58 ADVANCED CALCULUS nor a smallest member, while the bounded set 1 n + 1 lA = all for n = 0, 1,2, ... n+3 has t as its smallest member, but does not have a maximum member. The least-upper-bound property (LUB property), applied to any bounded set S, guarantees the existence of two real numbers which, for many purposes. serve to replace the maximum or minimum of S, if either is missing. The formal definition is as follows: Let S be a bounded subset of R, and let (1-32 ) (j/1 = the set of upper bounds for S = {all c such that x :::; c for every XES: (1-33) !f' = the set of lower bounds for S = {all b such that h :::; x for every XES: Then, the LUB property asserts that the set O/f always has a minimum (1-34) sup (S) = the smallest member of 1/1 and the set Y always has a maximum (1-35) inf (S) = the largest member of Y The notation \"sup\" is meant to suggest \"supremum,\" and \"inf,\" \"infimum\"; sup (S) is also called the least upper bound of S, written lub (S), and inf (S) is called the greatest lower bound of S, written glb (S); sup (S) and inf (S) always belong to the closure of S. Since some sets of real numbers do not have maxima or minima. why do the sets 0/1 and Y? This follows from the monotonic-sequence property; the proof is not easy. Theorem 17 If S is any bounded nonempty set of real numbers, sup (S) and inf (S) exist. To show how such a result is obtained, we assume that all the numbers in S are positive, and prove only that inf (S) exists. We must therefore show that the set Y defined in (1-33) has a maximum member, L; we obtain L as the limit of a monotonic increasing sequence whose terms are chosen from Y. We start by choosing any number s in the set S. Then, since if is the set of lower bounds for the set S, u :::; s for every u E Y; since we have assumed that S contains no negative numbers,°E Y. We construct our monotonic sequence recursively, choosing the terms as positive rationals, each less than s. Choose ao as the largest integer in Y. Clearly, ao ;:::: 0. Then, choose at as the largest integer n such that n/2 E Y. Noting that ao = (2ao)/2, we see that 2ao is one of these possible values of n, so that 2ao :::; at. In general, SETS AND FUNCTIONS 59 we choose Uk as the largest integer n such that n/2k E Y. We therefore have Uk/2k in !fJ, for k = 0, 1, 2, .... We move on to ak+ 1> which is to be the largest integer n such that n/2k+ 1 is in Y, and note that (2ak)/2k+ I = ak/2k; thus we see that 2ak is a possible value of nand 2ak S ak+ I' Accordingly, we have constructed a sequence {an/2 n} whose terms are rational numbers and are all in the set Y, and such that a a a a a < I < 2 < 3 < ... <n < ... < 5 o - 2 - 4 - 8 - - 2n - - As a bounded monotonic sequence, this converges, and we set L = lim n _ oo an/2 n . If x is any member of S, then since an/2 n belongs to 2, an/2 n s x for every nand L S x; but since this holds for every XES, L is a lower bound for Sand LEY. The only remaining task is to show that L is the largest member of Y. Suppose that there were a number b E 2 with L < b. Since, for any k, ak/2k S L < b, we have ak S 2kL < 2kb. If we take k sufficiently large, there will be an integer N between 2k Land 2k b, with ak < N. Accordingly, the integer ak could not have been the largest integer n such that n/2k E Y, since N would have the same property. Thus, there cannot exist a number bEY with b > L, and L is the largest member of Y. I The following result may give an easier and more plausible reason for accepting the truth of the LUB property. Theorem 18 If the line is connected, then the LUB property holds. (Note that the word \"connected\" is used in the special technical sense given in Definition 2 in Sec. 1.5.) Suppose that S is a bounded nonempty set that does not have a greatest lower bound. If Y is the set of all lower bounds for S, then this hypothesis means that!f J does not have a maximum member. Take any Xo E 2. Clearly, all XI < Xo lie in Y. There must also exist X2 E 2 with Xo < X2, because Xo is not the largest member of 2. Thus, the interval [x 1> x 2] is a neighborhood of Xo lying inside Y. This proves 2 to be open. Let '1\" be all the numbers not in Y. If Yo E i , then Yo is not a lower bound for S, and there must exist 5 E S with 5 < Yo. Then, 5 < Y for all y near Yo, and j , is open. Finally, i is not empty, since S #- 0, and if 50 E S, any y > 50 belongs to \"f '. Thus, the whole real line is 2 u i' where these sets are disjoint and both open, showing that R is not connected. I One final remark about the axiomatics of the real numbers: Any of the three properties--LUB, monotonic-sequence, or the connectedness of R-can be derived from the others, so that each could equally well be taken as a 60 ADVANCED CALCULUS basic axiom for R. There are also other alternative routes through the country called Foundations, some of which are indicated in the road map in Appendix 2. We now explore the usefulness of some of these various concepts, and start with some geometric applications. Intuitively, the diameter of a set S ought to be the maximum distance between any two points in S. Unfortunately, in many cases such a maximum does not exist; consider, for example, an open disc in the plane. The solution is to replace \"maximum\" by \"supremum,\" using the LUB property. Definition 7 If S is any bounded set in n space, its diameter is given by diam (S) = sup {all numbers Ip - qlfor p, q E S} Again, how should one define the distance between two sets, or the distance from a point to a set? Intuitively, the distance from a point p to a set Sought to be the distance from p to the nearest point of S, but if the set is open, no nearest point will exist. The solution is to replace\" minimum\" by \"inf.\" Definition 8 If S is a nonempty set in n space, and p is any point in n space, the distance from p to S is dist (p, S) = inf {all Ip - qIfor q E S} Definition 9 If A and B are sets in n space, neither empty, then the distance between them is dist (A, B) = inf {alilp - qlfor pEA, q E B} While dist (A, B) may not be achieved as the minimum Ip - ql for an actual pair of points in the sets A and B, the fact that inf (S) is always a number in the closure of S implies that there must exist two sequences of points, Pn E A and qn E B, such that limn_\", IPn - qnl = dist (A, B). However, as seen in Exercise 6, neither {Pn} nor {qn} itself need be a convergent sequence. To illustrate the way one works with inf and sup, we prove a form of the triangle inequality for distances between sets. Theorem 19 Given any three sets A, B, and C in n space, with B bounded, the following relation holds: (1-36) dist (A, C) s dist (A; B) + dist (B, C) + diam (B) Before reading the proof, we suggest that you make your own picture to illustrate the meaning of this relation. Let rx = dist (A, B) and f3 = dist (B, C). Given any e > 0, we may choose points pEA, qEC, and b 1, blEB so that Ip-b11<rx+e, and 62 ADVANCED CALCULUS sequence of intervals whose intersection is empty. In Exercise 9, Theorem 20 is extended to nested rectangles in the plane. The following important result is often called the Bolzano-Weierstrass theorem for the line. Theorem 21 Every bounded infinite set of real numbers has a cluster point. Let S be a given set, which we may assume to be a subset of a bounded interval I = [a, b]. The midpoint of I, (a + b)/2, divides the interval I into two equal pieces. Since S is an infinite subset of I, one of these two pieces must contain infinitely many points of S. Choose one that does and label this piece II' noting that it is a closed bounded interval half the length of I, with II C I. Repeat this process with II to generate a subinterval 12 c II such that 12 n S is infinite. Continue this process, and obtain a nested sequence of closed bounded intervals {In} such that for each value of n, Inn S is infinite. Applying Theorem 20, we see that nfIn contains a single point p. We now prove that p is a cluster point for the original set S. Recall that this means that every neighborhood of p contains infinitely many points of S. Let. t' be any neighborhood about p. Since the intervals In close down on p, so that their respective endpoints form sequences converging to p, and since p is interior to . t \" it follows that In C 3' for all sufficiently large n. But, every interval In contains infinitely many points of S, and so must the larger set. t '. I A very similar argument also proves the following. Theorem 22 Erery bounded sequence of real numbers has a limit point, and therefore a conrerging subsequence. (We will shortly generalize Theorems 20, 21, and 22 to n space.) We are also able now to justify the Cauchy convergence criterion, discussed at the end of Sec. 1.6. Theorem 23 Any Cauchy sequence of real numbers is com·ergent. Any Cauchy sequence is bounded (see Exer. 34, Sec. 1.6). If {xnl is a Cauchy sequence, and is divergent, then :x = lim inf X n and {3 = lim sup X n exist, and :x < {3. Choose 6 < {3 -:x, and then choose N so that IXn - Xm 1< 6 for all 11, III> N. We can rewrite this inequality as all n, III > N and then rewrite the right half of this as all 11, III > N SETS AND FUNCTIONS 63 Hold m fixed, and apply Exercise 24, Sec. 1.6 to obtain lim sup xn = f3 ::; e + xm Write this as f3 - e ::; X m ' holding for all m > N, and again apply the same exercise to obtain f3 - e ::; lim inf x n = rJ. However, this implies f3 - rJ. < e, which is false. Thus, rJ. = f3 and {x n} IS convergent. I Corollary In n space, any Cauchy sequence is convergent. In 3-space, suppose we have the sequence {Pn} with Pn = (xn, Yn' zn), and suppose it is Cauchy. Then, one easily sees (Exercise 35, Sec. 1.6) that {xn}, {Yn}, and {zn} are Cauchy, and therefore convergent. I We remark that the property of being a Cauchy sequence is one that can be described in any space in which there is a notion of distance. (Such a space is usually called a metric space; we will encounter a metric space in Chap. 6 that is different from the spaces Rn.) However, in such spaces it is not always true that Cauchy sequences automatically converge, although they are always bounded. A space in which all Cauchy sequences converge is called complete; thus, this corollary is a proof that n space is complete. EXERCISES I Show that the LUB property implies the monotonic-sequence property by proving the following: If a l S a 2 S is a bounded increasing real sequence, then lim._ x a. = L where L = sup {al' a 2 , a3 , :. 2 Fill in the missing details in the following proof that the LUB property implies that R is connected. (a) Let R = A u B where A and B are mutually separated. Then, A and B are both open. (b) With ao E A and bo E B, assume ao < bo; let I be the interval ao s x s bo' and set c = sup (A n I). Then, c belongs to neither A nor B. (c) Hence, a contradiction has been found, and R is connected. (d) Modify the above to prove that an interval [b, c] is connected. 3 If 5 is any bounded set of real numbers, show that the numbers inf (5') and sup (5) belong to the closure of 5. 4 If A c Band B is a bounded set in n space, show that diam (A) s diam (B). Can eqm lit~ occur without having A = B? S Suppose that A, B. and C are three sets and that A c B. Show that dist (B, C) s dist (A, C). 6 Let A and B be closed sets in the plane defined by: A = {all (x, .1') with .I' 2: 2: B = {all (x,.r) with x 2: 0 and.r s x/(x + I)) 64 ADVANCED CALCULUS (a) Find d = dist (A, B). (b) Show there does not exist pEA, q E B with Ip - ql = d. (c) Find sequences {p.l in A and {q.l in B with lim.~\", Ip. - q.1 = d. Does either sequence converge? 7 Can one have two closed sets A and B which are disjoint (and not empty) and such that dist (A, B) = O? 8 Show that the intersection nr I. of the nested sequence of intervals {I.l is empty in the following cases: (a) I. is the open interval 0 < x < lin. (b) I. is the (unbounded) closed interval n S x < oc. 9 Let {R.l be a sequence of closed bounded rectangles in the plane, with R 1 ::> R 2 ::> R) ::> ..• ; describe R. by R. = {all (x, y) with a. s x s b., c. s y s d.l Prove that n~ R. # 0· 10 Prove that a bounded sequence of real numbers that has exactly one limit point must be convergent. Is this still true if the sequence is unbounded? *11 Show that every noncountable set of points in the plane must have a cluster point. Must it have more than one? 1.8 COMPACT SETS We next move to a different aspect of the behavior of sets on the line and in space which unifies the treatment of many topics in analysis. In the proof of the Bolzano-Weierstrass theorem for a bounded interval on the line (Theorem 21), we used a simple partitioning device which divided the interval up into smaller intervals of arbitrarily short length. This technique, which allows one to regard a set as contained in the union of a finite collection of simple sets of arbitrarily small diameter, simplifies many arguments and suggests certain useful definitions. Definition 10 A collection 8 of open sets (9~ is said to be an open covering of the set S if S c U (9~. The covering is said to be a definite covering if 8 consists of only a finite number of open sets. Any set S in n space, for example, can be covered by an infinite collection of open balls. For example, choose any <5 > 0 and use the collection 8 = {all B(p, (5) for pES} Since each point p in S is covered by its own ball B(p, (5), S is a subset of the union of all the balls B(p, (5). (Note that this will be a noncountable open covering of S in general.) A covering is obviously easier to work with if it is a finite covering, and it is therefore important to know if a given infinite open covering can be reduced to a finite covering by discarding most of the open sets. This property has turned out to be such an important one for analysis that it has received a special name. SETS AND FUNCTIONS 65 Definition II A set S is called compact if every open covering of S can be reduced to a finite covering. This means that there must exist a finite sub- collection So of the original open sets which is still a covering of S. On the line, it is easily seen (as an application of the LUB property) that any closed bounded interval [a, b] is compact. This statement is also called the Heine-Borel theorem for the line. Theorem 24 The interval [a, b] is compact. Suppose that K is some given open covering of [a, b]. Since [a, x] is a subset of [a, b], K is also an open covering of each of the intervals [a, x] for any x, a ::s; x ::s; b. Let A be the set of all x such that the covering K can be reduced to a finite covering of [a, x]. The theorem is proved if we can show that b E A. Clearly, a E A, since the left end point of the interval [a, b] must lie in some open set f!/1 E K, and this single open set would be a finite reduction of K covering the degenerate interval [a, a]. Since the set A is bounded, sup (A) = rx exists. Since rx is a point in the interval [a, b], rx lies in some open set (!, in the covering K. Since rx is interior to f!;, all points near rx (e.g., in an open interval about rx) lie in 0. Since rx is the smallest upper bound for A, there is x E A such that x < rx, and such that all points t with x ::s; t ::s; rx lie in fl. Since x E A, K has a finite reduction Ko that covers [a, x]. The single open set f!; covers [x, rx]. Thus, adjoining (!! to the collection Ko produces another finite subcollection of K that now covers [a, rx], and rx E A. If rx < b, then there are points y to the right of rx that also lie in (!/ and are such that the interval [rx, y] c &. By the same argument, Ko in fact covers [a, y], so that YEA. However, this is impossible, since rx was an upper bound for A, while rx < y. Hence, rx = band b E A. I Having shown that there are some simple sets that are compact, we state a number of theorems that show why the notion is important, and which generalize many of the previous results from the line to the plane, space, and n space. The first is the general Heine-Borel theorem. Theorem 25 The compact sets in n space are exactly those that are closed and bounded. The next two together are often called the Bolzano-Weierstrass theorem. Theorem 26 Any bounded irifinite set in n space has a cluster point. Theorem 27 Any bounded sequence in n space has a limit point, and thus a converging subsequence. The next generalizes the nested interval theorem. 66 ADVANCED CALCULUS Theorem 28 If e1::J e2::J e3::J •.• is a nested sequence of nonempty compact sets, then their intersection (If en is nonempty. Finally, the following result often makes it possible to work in n space with a finite subset of any bounded set, instead of the whole set, in much the same way as one does with a finite set of partition points on an interval. Theorem 29 If S is any bounded set in n space, and b > 0 is given, then it is possible to choose a finite set of points Pi in S such that every point pES is within a distance b of at least one of the points Pi' P2' ... , Pm' Of these theorems, only the first has a proof that is not immediate. For this reason, we prove others first. PROOF OF THEOREM 26 We prove that if S is an infinite subset of a compact set e, then S has a cluster point. If this were not the case, then every point pEe would have an open neighborhood .1I· p about p which contained only a finite number of points of S. The collection of all these sets % p is an open covering of e and must have a finite reduction Ko which still covers C. Since SeC, So covers S. Since .AI p n S is always finite, the set S itself is finite, contradicting the assumption that S was infinite. I To prove Theorem 27, repeat the same argument, choosing AI' p as a neighborhood of p such that Pn E % p for at most a finite number of n. PROOF OF THEOREM 28 By Theorem 25 (or by Exercise 2) each set ek is closed. Choose an open set U containing el' and thus all the en; for example, choose U as n space itself. Then, form the open sets ~ = U - en by removing from U all the points of en' Since the en decrease, Vi c V2 C V3 C .. '. If we suppose that (I fen is empty, then it follows that U~ ~ = U, and since e 1 c U, the sets ~ form an open covering of e l' This covering has a finite reduction that still covers e l' Hence, for some index N we have C 1 C Vi U V 2 U V3 U ... U VN = VN = U - eN But, eN eel' so that eN = 0, contradicting the hypothesis that none of the set Cn was empty. I PROOF OF THEOREM 25 We have left the proofs that a compact set is necessarily both closed and bounded as Exercises 1 and 2. To prove the converse, we will also use Exercise 3, which asserts that a closed subset of a compact set is compact. The proof of Theorem 25 for subsets of the plane will then be completed if we prove that a closed square in the plane is 68 ADVANCED CALCULUS Fig. 1-29, and S has been finitely reduced to cover one of the squares Cn. This contradiction shows that S must have had a finite reduction that covered Co itself. I We end this section with two useful applications of compactness. Theorem 30 (a) If C is a compact set, then there must exist two points p, q E C such that Ip - ql = diam (C). (b) If A and B are closed sets, and A is compact, then there is a point pEA and q E B such that Ip - ql = dist (A, B) PROOF OF (a) Choose Pn and qn in C with limn_~ IPn - qnl = diam (C). Since S is compact, {Pn} has a subsequence {PnJ that converges to some point p E C. Since IPnk - qnkl:-s; IPnk - pi + Ip - qnkl and since the left side of this converges to diam (C) while the right side is less than the sum of IPnk - pi, which approaches 0, and diam (C), we have lim Ip - qnkl = diam (C) k-x In a similar manner, the sec.uence {qnJ has a limit point q in S, and by an analogous argument, Ip - ql = diam (C). PROOF OF (b) Choose PnE A and qn E B such that lim Ipn - qnl = dist (A, B) Since A is compact, {Pn} has a limit point pEA, and as in the proof of part (a), there is a sequence {nk } of indices such that {PnJ converges to P and lim Ip - qnkI= dist (A, B) k-oo Since Iqn.l = Iqnk - p + pi :-s; Iqnk - pi + Ipl the sequence {qnk} is bounded. It must then have a limit point q which lies in B, since B is closed. Repeating the sort of argument used in part (a), we conclude that Ip - qI = dist (A, B). I Corollary 1 If A and B are disjoint closed sets, one of which at least is bounded, then they are a positive distance apart .. there is a number b > 0 such that Ip - qI ?: b for all pEA, q E B. SETS AND fUNCTIONS 69 Figurt' 1-30 Corollary 2 Ler A ami B be disjoint compact sets. Theil, !WO disjoint opell .~et,~ Valid V can he chosen sildl rliar A c:: V and 8 c:: V, and silch tllat V allli V llrl'i'ach rhl' IInion of a finite number of open balk The result is illustrated in Fig. 1-30. The practical importance of this result is that U and V arc so simple in construction that their boundaries arc each made up of a finite number of arcs of circles or portions of spheres. To prove Corollary 2, let {j = dist (A. B) > O. For eaeh pEA and each q E B, consider the open balls with center p or q and radius b/3. Note that these will be disjoint. since their centers are at least b apart. As p varies over A, we obtain an open covering of A which can be reduced to a finite sulx:overing whose union is an open set U. Similarly, as q ranges over B. we obtain a covering of 8 which then yields a finite subcovering whose union is the sel V. Note that dist (V, V) ~ ti/3. EXERCISES 1 Show that allY compact SCi in \" splice mUSI be bounded. 2 Show that any compact SCi in n space mUSI be closed. ) Show that every closed subsci of a compact sct is compact. 4 Fill in the dctails of the Pl'\"oof of Corollary I of Theorem 30. S Pro,'e Ihal a set S in n spal:c is Wn1p<lct if and only ir e\"ery sequenl:e in S has a Iimil poinl thai belongs 10 S. 6 ut A and B he compact sets on the line_ Use bercisc 5 to show Ihat their cartesian produCI A \" B is a compact SCi in the plane. 7 (a) Prove Theorem 29. assuming that the set S is both doscd and bounded, (h) Prove Theorem 19. assuming only that S is bounded. [Thc difficulty li~ in showing that the points 1', can be chosen in S itself.) 8 Must every bounded noncmpty SCi in \"spa~ have a nonempty boundary? 9 For any sct S in the plane. k:t XIS) '\" lall.l for which (x. Y)E S ror some.r! 70 ADVANCED CALCULUS This is called the projection of S into the X axis. (u) If S is bounded, is X(S) necessarily bounded? \"\"' S (b) If S is closed, is X(S) necessarily closed? 'L.u (c) If S is compact, show that X(S) is necessarily compact. 10 (u) Show that the open unit disc in the plane can be expressed as the union of a collection of closed squares. *(b) Can this be done with a countable collection of closed squares? CHAPTER TWO CONTINUITY 2.1 PREVIEW The purpose of this chapter is to clarify the intuitive notion of continuity, and to arrive at many of its most useful consequences. We start by discussing and comparing continuity of a function and uniform continuity of a function. The former is what is termed a local property, something that can be decided by examining a function on a neighborhood of each point of a set; the latter is a global property, and is a statement about the way a function behaves on an entire set. We then take up many of the properties of continuous functions which follow immediately from the definition of continuity, particularly those that describe the behavior of a continuous function on a set that is compact or connected. One familiar instance of the latter is the intermediate-value theorem, which is used informally by people more than any other theorem in analysis. (\" If the temperature was 40° and now it's 100°, it must have been 70° sometime!\") With the concept of continuity as a tool, the discussions of limits and discontinuities in Sees. 2.5 and 2.6 become easier, especially when dealing with functions of several variables, where the behavior of a function near a boundary point of its domain can be so complicated. Section 2.7 is very short and deals with inverses for functions of one variable. The continuity of such inverses turns out to be an immediate consequence of the useful compact graph theorem of Sec. 2.4. 71 CONTINUITY 73 of those points (x, y) with 0 ~ x ~ 1, 0 ~ y ~ 1. Let Po = (xo' Yo) be any point in S. Then F(p) - F(po) = F(x, y) - F(xo' Yo) = x 2 + 3y - x6 - 3Vo = x 2 - x6 + 3y - 3yo = (x - xo)(x + x o) + 3(y - Yo) No matter where the points p and Po are located in S, it is always true that o ~ x ~ 1 and 0 ~ X o ~ 1, so that x + X o ~ 2. Consequently, (2-1) IF(p) - F(Po)1 ~ 21x- xol + 31y - Yol We have here an estimate for the variation off near Po' If we confine p to a small neighborhood of Po' then Ix - X oI and Iy - Yo I must both be small and so will IF(p) - F(Po)l. We can make this argument more concrete. Suppose that we wish to find a neighborhood U about Po in which the variation of F is less than e = .03. Take U to be a square neighborhood centered on Po' with sides .01. Then, if p E U and lies in D, we must have Ix - X oI < .005 and Iy - Yo I < .005, so that (2-1) gives IF(p) - F(Po)1 < 2(.005) + 3(.005) = .025 < .03 In general, if we take U to be a square of side (A)e, then Ix - XoI < (.2)e and Iy - Yo I < (.2)e, so that IF(p) - F(po) I < 2(.2)e + 3(.2)e = e This example exhibits another fundamental property of continuous func- tions. Let {Pn} be a sequence of points in S, converging to a point Po E S. Then, {F(Pn)} will converge to F(po)' For, writing Pn = (x n, yn), we have, from (2-1), and since lim xn = x o' lim Yn = Yo' we conclude that the right side approaches oand lim F(Pn) = F(po)' Another way to describe this property is to say that a continuous function preserves convergence. Theorem 1 Let f be continuous at Po E D and let {Pn} be a sequence of points in the domain D off, with limn_ ao Pn = Po' Then, limn_<Xc f(Pn) = f(po)' Given any e > 0, choose a neighborhood U about Po such that If(p) - f(po)! < e whenever p E Un D. Since Pn E D and {Pn} converges to Po, we must have Pn E U for all sufficiently large n. Hence, there is an N such that I!(Pn) - f(po) I< e for all n > N. But this is precisely what we mean by saying that the sequence of numbers {.f(Pn)} converges to/(po)· I 74 ADVANCED CALCULUS It is also easy to see that \"convergence preserving\" is a characteristic property of continuous functions. Theorem 2 If a function f defined on D has the property that, whenever PnED and lim Pn = Po E D, then it follows that limn~'X f(P n) = f(po), then f is continuous at Po' It is easiest to prove this by an indirect argument. Assume that f is convergence preserving but thatfis not continuous at Po. If the definition of continuity (Definition I) is read carefully, one sees that, in order forf not to be continuous at Po, there must exist a particular value of E > Osuch that no neighborhood U can be found to satisfy the required condition. (There is a routine for carrying out the logical maneuver of constructing the denial of a mathematical statement in a semimechanical fashion; those who have difficulty reasoning verbally will find it explained in Appendix 1.) Thus iff is not continuous at Po, and we think of trying a specific neigh- borhood U, then it must fail because there is a point P of D in U with If(p) - f(Po)1 ~ G. If we try U in turn to be a spherical neighborhood of radius 1,1, t, i, ... and let Un therefore be Un = :all P with Ip - Po I< ~l then there must be a point Pn E Un n D with If(Pn) - f(p)1 > G. Since Pn E Un' IPn - Po I < I/n and lim Pn = Po· We have therefore produced a sequence {Pn] in D that converges to Po, but such thatf(Pn)does not converge to f(po). This contradicts the assumed convergence-preserving nature off and forces us to conclude that f was continuous at Po· I Theorem 2 is more useful as a way to show that a specific function is not continuous than it is as a way to show that a function is continuous. To use it for the latter purpose, one would have to prove something about {f(Pn )] for erery sequence {Pn} converging to PO' and there are infinitely many such sequences. However, if there is one sequence {Pn] in D which converges to Po. but for which {f (P n )} is divergent, then we know at once that f is not continuous at Po. For example, let f be defined on the plane by (2-2) , xy2 f(x, y) = . x 2-+ y4 10 (x, y) # (0,0) x=y=o We want to see if f is continuous at (0,0).. Among the sequences that approach the origin, look at those of the form Pn = (l/n, c/n). As c takes on different values. the sequence Pn will approach (0,0) along different lines, taking 76 ADVANCED CALCULUS When we adopt the point of view that a function is a correspondence or mapping, we think ofj(p) as the image of the point p. In a similar fashion, we can speak of the image of a set under! If S is any set in the domain D of f, then f(S) is the set of points f(p), for pES. Using this language, we can describe the relationship shown in Fig. 2-2 and Definition l' more simply: Given any neighborhood V, there is a neighborhood U such that f(U n D) c V. We shall also speak of the inverse image or pre-image of a set Sunder a mapping! Given any set S, its inverse image is the set (2-3) f- 1(S) = {all p ED withf(p) E S} It should be noted that the set S might be chosen in such a way that no point p in D satisfies f(p) E S. In this case,f - 1(S) will still be defined, but the result is 0, the empty set. Relation (2-3) merely requires that the points in f - 1(S) consist of all those in the domain off whose images are in S, and if there are none,f - 1(S) is empty. Some mathematical problems lend themselves to formulation in terms of these ideas. For example, instead of talking about the set of solutions x for the equation f (x) = 0, we could equally well ask for the inverse image of the set {O}. A striking example of this is the following reformulation of the idea of continuity. ~\\w'\" 1Theorem 3 A function f is contmuous on an open set D if and only if the inverse image of every open set, under f, is open. Let S be any open set in the range space off, and let R be its inverse image.r l(S). We must show that, iffis continuous, R is open. Take any point Po E R; we wish to show that Po is interior to R. Since Po is in the inverse image, under.f, of S, we know thatf(po) belongs to S. Also, since S is open, there is a neighborhood V aboutf(po) which lies entirely inside S. Now, since f is continuous at Po, we can find a neighborhood U about Po so thatf(p) E V for every p E U n D (see Fig. 2-2). Since D itself is open, the set U n D is a neighborhood of Po lying entirely in D. Moreover, the fact that f (U n D) c V, together with V c S, shows that U n D c R. Hence, we have found a neighborhood of Po composed only of points in R. Po is therefore interior to R, and R is open. ~ Conversely, if we suppose that f - 1 has the property of carrying open sets back into open sets, it follows that f is continuous. Given any Po ED and any neighborhood V aboutf(po), we look at the inverse image W of V. Since V is open, W is open. Sincef(po) E V, Hence, Po is an interior point of W, and there must be a neighborhood U about Po which lies in W. But, all points of Ware carried into points of V, underf, so thatf(W) c V. Taking W for the required neighborhood U, we have shown that f is continuous at Po· I CONTINUITY 77 In this theorem. the apparent restriction that the domain off be an open set can be overcome in several ways. One method is to introduce the notion of relative topology. If D is a set in n space, then one says that a subset A c D is open, relative to D, when A is the result of intersecting D with an open set in n space. In the same way, a set B is called closed, relative to D, if B = D n C, where C is closed in n space. This is merely a device for restricting one's attention precisely to the points in a specific set D, but still using all the terminology and topology of n space. If we use this interpretation, then Theorem 3 can be given a broader meaning as follows: A function f is continuous on a set D if and only if the inverse image of every open set under f is open relative to D. There is also a second way to overcome the limitation in the stated form of Theorem 3. We shall show later on that any continuous function f that is defined on a closed set D and takes values in R, or indeed in Rm, can be assumed in fact to have been defined and continuous on any convenient larger open set 0 ::) D. This important result, known as the Tietze extension theorem, is proved in Chap. 6, and simplifies many arguments. If we choose a set D, an arbitrary set in n space, then we can study the collection of all real-valued functions that are continuous on D. This is a very important mathematical object, the focus of much research work in the past several decades. The first questions that one asks about it deal with the sort of structure the whole collection possesses: what are the basic laws and operations that allow you to combine continuous functions and get continuous functions? The first result shows that this class of functions is a vector space, and in fact something more. (See also Appendix 6.) Theorem 4 The class of real-valued functions continuous on D forms an algebra. Explicitly, iff and g are continuous on D, so are their sum f + g, their product fg, and any scalar multiples rxf or rxf + {3g, where rx and {3 are numbers. The quotient of two functions fig is continuous at all those points p in D where g(p) -:f. O. We can derive this from the corresponding facts about convergent sequences that were proved in Sec. 1.6 if we also make use of Theorems 1 and 2 in the present section. Thus to prove that fg is continuous on D, we need show only thatfg is convergence preserving. Given any Po E D and any sequence {Pn} in D that converges to Po' we know from the assumed continuity off and g that limn _ oc f(Pn) = f(po) and limn _ oc g(Pn) = g(po)· By the standard result on real sequences, we conclude that {.f(Pn)g(Pn)} must be a convergent sequence, and = f(Po)g(po) The product function fg is therefore convergence preserving. I 78 ADVANCED CALCULUS The proof of all the remaining statements follows the same pattern. Several consequences of this result are worth pointing out. First, we can conclude that all polynomial functions are everywhere continuous. For polynomials in one variable, this follows by noting that constant functions [e.g., the function c with c(x) = 3 for all x] and the identity function J [J(x) = x for all x] are clearly continuous. Then, by addition and multiplication and by multiplication by scalars (i.e., coefficients), we construct the most general polynomial function. For polynomials in two variables, we would start from the basic functions I(x, y) = x and J(x, y) = y, prove that these are continuous, and then build up the general polynomial from these. Second, we can conclude that all rational functions, for example, R(x y) = P(x, y) , Q(x, y) are continuous everywhere except at the points where the denominator is O. (In Sec. 2.6, we shall discuss the behavior of such functions near points where the denominator is 0; in some cases, we can restore continuity, and in others we cannot.) There is a further way to combine continuous functions to yield continuous functions. It may be stated roughly as follows: Continuous functions of continuous functions are continuous. With more attention to the fine points of detail, we have the following: Theorem 5 Let the function 9 be continuous on a set D and f continuous on a set S. Suppose that Po E D and g(po) = qo E S. Then, the composite function F, gil'en by F(p) = f(g(p)) is continuous at Po' This can be proved easily by the scheme of using sequences and the sequence-preserving property. For variety, we choose to prove this by using the neighborhood definition of continuity. The argument can be followed in the diagram of Fig. 2-3. Letf(qo) = c = F(po)' Sincefis continuous at qo, we know that, for any e > 0, there is a neighborhood V about qo such that If(q) - f(qo)1 < e whenever q E V and q is in the domain S of f Since g(po) = qo and 9 is continuous at Po, we also know that there is a neighbor- hood U about Po such that g(p) E V for all points p E U n D. Putting these remarks together, we see that, if we set q = g(p), then If (g(p)) - f (g(po)) I < e whenever p E U n D. Since this can be rewritten as IF(p) - F(Po)1 < e, we have shown that F is continuous at Po· I CONTINUITY 79 Figurt 2-3 and The continuity of composite functions is used constantly. It can even be used to derive Theorem 4 in a different way. Suppose that we were to verify directly from the definition thai the functions A and M are continuous. where A(x• .1') = x + .I\" and M(x..r) = x.\\\". Then. the composite function theorem tells us at once that f + 9 and .f.lJ are continuous on a set D if f and 9 are each separately continuous on D: for I(p) + g(p) ~ AU(p) g(p)) ~ A(F(p)) f(p)9(p) ~ MU(p). g(p)) ~ M(F(p)) where F is the function from D to Rl given by F(p) = (f(p). g(p)). In the same fashion, the fact that Q(x,.\\\") = XIJ' is continuous on the set where Y:F 0 implies at once that fig is continuous where g(p) :F O. As a more practical example, what can we say about the continuity of a function such aSf(x, y) = X2.r csc (x + y)? If we assume that the sine function is known to be continuous everywhere, then the composite function theorem and Theorem 4 show that f is continuous at all points (x, .1') except for those where sin (x + y) = O. namely. the points on the family of lines with equation x+.r=/In 11 = o. ± I. ±2.. How do we know that a function such as the sine function is continuous? The only honest answer is to say that it depends upon how this functioll was defined. A traditional definition of the sine function is 10 say: For all.r x, sin (x) is tile second coordil1afC' of Ihe poim P Oil rile II/Iit circle whose distance from (1,0). m('aslired a/oily the ci,.cWI!(erelll'(' ill the positire di,.('ct;oll. is x (Fig, 2-4). From the figure. it probably seems self-evident that sin Ix) is near sin (xo) whenever x is sufficiently near xo ' It has even been traditional to bolster this CONTINUITY 81 5 Show that a real-valued functionfis continuous in D if the set S = {all p ED with b <f(p) < c} is open, relative to D, for every choice of the numbers band c. 6 Using Theorem 4, where can you be sure that the function given by F(x, y) = (x + y)/(x 2 - xy - 2y 2) is continuous? 7 Use the example f(x, y) = x 2 to show that a continuous function does not have to map an open set onto an open set. *8 Use the examplef(x) = x 2/(1 + x 2 ) to show that a continuous function does not always have to map a closed set onto a closed set. 9 Using the assumed continuity properties of the sine function, what can you say about the set on which the function g(x) = csc (sin (I/x)) is continuous? 10 Show that f is continuous if and only if the inverse images of closed sets are closed sets relative to D. II Prove Theorem 5 using Theorems 1 and 2. 12 How arer l(A n B) andf-I(A u B) related tof-l(A) andr I(B)? 13 Let f: X -+ Y be a function, and Sand T arbitrary sets. Show that: (u) frl(S) c S (b) T cr1f(T) 14 Let F(x, y) be continuous on the square Ixl ~ I, Iyl ~ 1. Where is the functionf(x) = F(x, c) continuous? 15 Formulate the definition of continuity for a complex-valued function! Show thatfis continuous if and only if its real and imaginary parts are continuous functions. 16 (u) Setting z = x + iy = (x, y), consider the function f defined from complex numbers to complex numbers (R 2 to R 2 ) byf(z) = Z2 + (I - i)z + 2, and show that it is continuous everywhere. (b) What can you say about the continuity of the functionfwhere: (i) f(z) = ~ (ii) f(z) = _2_ Z _ Z Z + 1 17 Show that a mapping y = F(x) on a set D in R\" to Rm as given in (1-26) is continuous if and only if the component functionsf, g, h, ... , k are continuous on D. 2.3 UNIFORM CONTINUITY We now make a closer study of the concept of continuity of a real-valued function, particularly with respect to the way the behavior of a function near one point may differ from that near another. As we shall see, the contrast here is between properties that are local and properties that are global. Suppose we return to the special polynomial function F(x, y) = x 2 + 3y which we studied at the start of the preceding section. There, we showed that F is continuous on the unit square with vertices at (0,0), (0, 1), (1,0), (1,1). From the more general theorems we proved in the last section, we know in fact that F is continuous in the whole plane. To obtain this directly, we would again write F(x, y) - F(xo' Yo) = (x - xo)(x + xo) + 3(y - Yo) If we are given a positive number E, we must find a neighborhood U about Po = (xo' Yo) so that IF(p) - F(po) 1<E for all points p E U. If we take U to be 82 ADVANCED CALCULUS a square box of side 2<5, centered on Po' then we have 1x - X oI < <5 and Iy - Yo I < <5 for any P E U. The number <5 is as yet undetermined, but we can agree to take it smaller than 1. Then, when P E U, we have Ix + X oI = Ix - X o + 2xo I ~ Ix - X oI + 21xo1 ~1+2Ixol Hence, for any point p E U, we have IF(p) - F(Po)1 ~ Ix - xollx + xol + 31y - Yol ~ <5(1 + 2lxol) + 3<5 ~(4+2Ixol)<5 In order to prove that F is continuous at Po' we wish to make the left side less than E for every p E U. We can achieve this if we can choose <5 so that the right side of this inequality is less than E. Thus, we are led to choose <5 as a number obeying (2-4) E0< <5 < ..._-- 4 + 21xol With this selected, we can be sure that IF(p) - F(Po)1 < E for all p E U, and F is continuous at each point Po' Now, in examining what we have done, we notice that the size of the neighborhood U that we selected depended not only upon E (as was to be expected) but also upon x o' and thus upon the point Po' Indeed, as the point Po is selected farther and farther to the right, Ix-ol will increase and the value of <5 will decrease. If we were trying to show that F is continuous on a specific bounded set D, then, since the point Po must lie in D, there would be an upper bound on the values of IX o I. Accordingly, we would then be able to select a value for <5 which is smaller than all the values given in formula (2-4), and we would be able to choose a single-sized neighborhood that works for all positions of Po in D at once. This in fact was the case when we first examined this function in the previous section, for there we found that <5 = (.2)E worked for all points Po in the square. This special phenomenon of being able to pick <5 independent of Po is one to which a special name is given. Definition 2 We say that a function f is uniformly continuous on a set E if and only if, corresponding to each E > 0, a number J > °can be found such that If(p) - f(q)1 < E whenel'er p and q are in E, and Ip - ql < 6. There is a vivid way to describe this property of a function that may help to emphasize its characteristic features. Suppose that we invent a measuring device with two movable prongs and a meter which will indicate the temperature difference of the prongs. Suppose that we have a sheet of metal whose tempera- CONTINUITY 83 ture varies from point to point, and that the temperature at p is given by f(p). If we place one prong at a point p on the sheet and the other at q, the meter will read the value 1f (p) - f(q) I· The meaning of the uniform continuity off is simply that, given a value for E > 0, we can set the prongs at a fixed separation of at most 15 and be sure that, wherever they are placed in the region E, the meter will read no higher than E. The term \"uniformly continuous\" is always used in conjunction with a set, which must also be specified. In the example of the function F above, we showed that it was uniformly continuous on the unit square S and indeed that it was uniformly continuous on any bounded set. It can be shown that it is not uniformly continuous on the whole plane. For another example, let f(x) = l/x. We shall show that f is continuous on the open interval °< x < 1 but is not uniformly continuous there. We first write I I I I Ixo- xlIf(x) - f(xo)1 = - - - = ----- x X o xXo To prove continuity at xo' which may be any point with 0< X o < 1, we wish to make If (x) - f(x o)I small by controlling 1x - X o I. If we decide to consider only numbers 15 obeying 15 < x o/2, then any point x such that Ix - Xo1< 15 must also satisfy x> xo/2, and xXo > x6/2. Thus, for such x, If(x) - f(xo)1 < 6/XXo < 2b/x6. Given E > 0, we can ensure that If(x) - f(xo)1 < E by taking 15 so that 15 S; (x6/2)E. Thus,f is continuous at each point X o with 0 < X o < 1. Iffwere uniformly continuous there, then a number 6 > °could be so chosen that If(x) - f(x') I < 1 for every pair of points x and x' between °and I with Ix - x'i S; 6. To show that this is not the case, we consider the special pairs, x= lin and x' = 15 + lin. For these, we have Ix - x'i = 6 and I 1 I n6If(x)-f(x')I= n----- =- -- 6 + lin 6 + lin No matter how small 6 is, n can be chosen so that this difference is larger than 1; for example, any n bigger than both 1/15 and 3 will suffice. A plausible (but incorrect) graphical argument can also be given. Examina- tion of the graph of f shows that its slope becomes arbitrarily steep as we move toward the vertical axis, and this would seem to imply that f cannot be uniformly continuous. This reasoning has an analytical counterpart; the choice 6 = (x6/2)E which we have made above becomes arbitrarily small as X o moves toward 0, so that \"no positive number can be found which works for all X o > 0.\" To see the flaw in these arguments, consider F, where F(x) = ~x. Since the graph of F also becomes arbitrarily steep as we move toward the vertical axis, the first argument would seem to show that this function too is not uniformly continuous on the interval°< x < 1. We seem to reach the same conclusion if we repeat the second line of reasoning. To see this, we first prove 84 ADVANCED CALCULUS continuity. Given points x and Xo with 0 < x < 1, 0 < Xo< 1, we have r:. c I(ylx - ylx~)(~+ ylx~)I IF(x)- F(xo)1 = Ivx-vxol = ._-~+-j~~---- Ix - XoI Ix - XoI ----',,=--------'''=== < -- ._. ~+A- ylx~ Given £, we select 15 so that 15 :s; A £; then, if Ix - X oI < 15, This shows that F is continuous on the interval 0 < x < 1. The choice of 15 as A £ suggests that F is not uniformly continuous there, since this number becomes arbitrarily small as X o approaches O. However, F in fact is uniformly continuous. To prove this, we must make a more careful choice of J. Assume that we have chosen 15, and again estimate the difference IF(x) - F(xo)I. Two cases arise, depending on the size of xo' If °< Xo < 15, and Ix - XoI < 15, then 0 < x < 215 and we have IF(x) - F(xo)1 = I~ - JX;I :s; ylx + JX; :s; yI2b + 05 < 305 If X o ::2: 15, then, using the original estimate of the difference, IF(x) - F(xo)1 :s; IxiX 0 I < ~= 05 < 305 X o v J No matter how 15 is chosen, we have shown that, if Ix - XoI < 15, then IF(x) - F(xo)1 < 305. This at once proves that F is uniformly continuous, since given c; we may choose 15 = £2/9 and have IF(x) - F(xo)I < c; whenever x and Xo obey x > 0, Xo > 0, and Ix - Xo 1< J. In fact, as is easily seen, these calculations show that F(x) = ~ is uniformly continuous on the unbounded interval consisting of all x, x > 0. When is a continuous function uniformly continuous? The following basic theorem supplies a partial answer. Theorem 6 ~f E is a compact set and f is continuous on E, then f is necessarily uniformly continuous on E. In particular, any continuous function defined on a closed and bounded set E in n space, and taking ralues in m space, is uniformly continuous on E. There are a number of proofs for this result. We give one here and indicate another in the exercises. We shall again argue indirectly, proving that, i(fwere not uniformly continuous on E, thenf could not be continuous CONTINUITY 85 on E. Our first problem is to understand the meaning of \"f is not uniformly continuous on E.\" This may be clearer if we put the statements side by side. f is uniformly continuous on E == For any e > 0, there is a 15 > 0 such that whenever P and q lie in E and Ip - ql < 15, then If(p) - f(q)1 < e. f is not uniformly continuous on E == There is some e > 0 such that, for any 15 > 0, there exist points P and q in E with Ip - ql < 15 but such that If(p) - f(q)1 ~ e. (Again, a brief explanation of the mechanical procedure for finding the negative of complicated statements is given in Appendix 1.) If, therefore, it were true thatfis not uniformly continuous on E, then we could select the special value of e mentioned above, and then take 15 in turn to have the values 1,1, j, !, ... ; for each choice of 15, we can produce a pair of points in E, say, Pn and qn for the choice of 15 as lin, such that IPn - qnl < 15 = lin, and with I/(Pn) - f(qn)1 ~ e. We next show that this cannot be done if/is continuous on E. Because the set E is compact, we apply the Bolzano-Weierstrass theorem (Theorem 26, Sec. 1.7) to conclude that the sequence {Pn} must have a limit point Po E E and a subsequence {Pn.} converging to Po. Since the terms of the sequence {qn} are progressively closer and closer to the terms of the sequence {Pn}, we would expect {qnk} also to converge to Po. Indeed, we have Iqnk - Pol = Iqnk - Pnk + Pnk - Pol < Iqnk - PnJ + Ipnk - Pol 1 < - + Ipn - Po I --+ 0n k k But, iffis continuous on E, it is convergence preserving and we must have lim (f(Pn) -f(qn)) =f(po) -f(po) = 0 k-cc which contradicts the fact that If(Pn) - f(qn) I ~ e > 0 for all n. I This result also has a direct proof which uses the covering property of a compact set to obtain a value of 15 that depends on e, but not upon the location of the points P and q in E (see Exercises 11 and 12). A standard method for presenting the numerical values of a function of one variable is to tabulate them at a constant interval distance ~x. Thus, a short table of the sine function might list the values of sin () for every choice of () in degrees between () = 0° and () = 90°, and sin () would be estimated for other choices of () between these extremes by linear interpolation. It is clear that this process can be described by saying that one starts with a finite number of points on the graph of a given function, and then approximates 86 ADVAK(\"I-I) (\"Al.n:II'S r, / , / , / , ---- ...... ----\",,,, .... Figurl' 2-~ III - FIII\"'1 :s; I: the function between these by line segmcnts. A practical problem ames immediately: How close should the tabulated values of x be in order that the interpolated values of function not have more than an assigned error? In such a problem. we are dealing wilh two functions. one of which is regarded as an approximation to the other: in the example quoted. a piecewise linear function is used as an approximation to the sine function on the interval [0 _90 ]. We need a precise notion of degree of approximation. Definition 3 We say Ilrm (/ .{ill/clioll F i,\\ II lilli/fir/II ':-flfJll'oximlllioll (0 1I fill/ctio\".r. Oil II set E. if I((p)- F(r)1 ,;\" \"II rE f Iff and F are functions of one variable and £ is an interval [a. hI. this has a simple geometric interprelation. Let S be the band of venical widlh 21: which is obtained by moving a vertical line segment of length 2,; along the graph off. irs midpoint being kept on the curvc (Fig. 2-5). Thcn. F is an I:-approxima- tion 10.r if the graph of F lies completely in the sct S, By analogy with the situation in euclidean spaces. one says that F lies ill an I: ll~ighhorhood of f. and one writcs III - f\",l\" ,;, Here Ii I:,; is a special not arion which is explained hy (2-5) !lgll,.. = sup ': Iy(pll wilh pEE: the least upper bound (or maximum if attained) of thc values of I!/I on E. Hence.IIF -fII,· is the maximum separation between the graphs of/and F. over the sel E. t:gll is read \"the norm of y.\" One of the key results in this subject is the Wcierstrass approximation theorem. which states that any continuom function of one \\'ariable dcfined on a closed bounded intcn'al [a. hl can be approximated uniformly rhcre. within I:. by a polynomial. We shall not pro\\'e this or its generaJiZ<lIiolls to functions of several variables: instead we shall provc a simpler result dealing CONTINUITY 87 with approximation by piecewise linear functions. The graph of such a function is a polygonal line, and the result we prove is directly connected with the problem of construction of numerical tables. Theorem 7 Iff is a continuous function on the closed and bounded interval [a, b], then, for any I; > 0, there is a piecewise linear function F which approximates / uniformly within I; on the interval. As the name implies, a piecewise linear function is one whose graph is a polygon, consisting of a finite number of straight-line segments. As I; decreases, the number of segments we have to use to get the function F may have to increase, in order to match the behavior off The method of proof is extremely natural. We select points Po, PI, ... , P N on the graph of the given function/and then construct F by joining these with line segments. The only trick is to be sure that the points Pk are close enough. We shall decide upon the size of the number N later. Divide the interval [a, b] into N equal subintervals at points a = Xo < Xl < x 2 < ... < x N = b Let Pk be the point (Xk' yd, where Yk = f(xd. Notice that Pk is on the graph off Now, define the function F on each of the subintervals in turn, (2-6) for all X with x k ~ x ~ X k + l' Notice that F(x) is of the form A + Bx on this interval, so that its graph i~ a straight line. Also, putting x = x k in (2-6) gives F(x k ) = J'k = f(x k ), while F(x k + 1) = J'k+ 1 = f(X k + 1)' Thus, this portion of the graph of F goes from Pk to Pk+ l' We now wish to estimate the difference between F(x) and/(x) at an arbitrary point x between x k and x k + l' Clearly, F(x) lies somewhere between hand J'k+ l' since its graph is a straight line. We do not know much about the shape off between xk and xk+ l' but we know with certainty that IF(x) - /(x)1 cannot be larger than the bigger of the numbers I/(x) - J'kl and If (x) - J'k+ 1 I· Since J'k and J'k + 1 are the values of f at points in the interval [xk ' X k + 1]' neither of these numbers in turn can be larger than the biggest separation of values I/(x) -f(x')I, for arbitrary placement of x' between x k and x k + l' We are now ready to choose the integer N. Given 1;, we make use of the uniform continuity ofjto choose b > °so that I/(x) - f(x') I < I; whenever x and x' are two points anywhere on the interval [a, b] with Ix - x'i < b. Choose N large enough so that (b - a)/N < <5. This has the effect of making each of the subintervals shorter than <5. The last remark in the paragraph just above now applies, since the points x and x' there must obey Ix - x'i < <5. Hence, we conclude that IF(x) -/(x)1 < E. With this done in 88 ADVANCED CALCULUS each subinterval [x k , X k + 1], it is clear that we have proved this uniformly throughout the entire interval [a, b], and IIF - f II < e. I It is interesting to note that the process given in (2-6) for obtaining the values of the approximating function F at points x intermediate between x k and x k + 1 is nothing more nor less then ordinary linear interpolation, as it is standardly done in mathematical tables. For functions of two or more variables, a similar process can be used, obtaining approximate values for a functionfby interpolating from the values at a discrete set of points. In two variables, for example, one can use linear interpolation in triangles to replace the formula given in (2-6) (see Exercise 10). In order to apply these methods to construct uniform approximations to a given function[, one must know a value of b that is appropriate for a given e. There is one case in which this step is simple. Definition 4 A function f is said to obey a Lipschitz condition on the set D if there is a constant M such that If (p) - f (q)I :s; M Ip - qI for every choice of p and q in D. When this happens, it is clear thatfis uniformly continuous on D and that we may choose b = elM. For, if Ip - ql < b, then If(p) -f(q)1 :s; Mb :s; e. In Sec. 3.2 we will see that any function of one variable that has a continuous derivative on an interval [a, b] obeys a Lipschitz condition on that interval. An analogous result will also be proved later for functions of several variables. EXERCISES I Show that F(x, y) = x 2 + 3y is not uniformly continuous on the whole plane. 2 Prove that the functionf(x) = 1/(1 + x 2 ) is uniformly continuous on the whole line. 3 Letfand 9 each be uniformly continuous on a set E. Show thatf + 9 is uniformly continuous on E. 4 Let A and B be disjoint sets, and letfbe continuous on A and continuous on B. When is it continuous on A u B? 5 Let A and B be disjoint closed sets and suppose that f is uniformly continuous on each. (a) Show thatfis necessarily uniformly continuous on A u B if A is compact. (b) Show thatfneed not be uniformly continuous on A u B if neither A nor B is compact. 6 If f is uniformly continuous on D, show that it has the property that if p.' q. E D and Ip. - q.l- 0, then If(p.) - f(q.)I- O. 7 Let D be a bounded set and let l be uniformly continuous on D cR·. Prove that f is bounded on D. 8 Let f be a function defined on a set E which is such that it can be uniformly approximated within e on E by functions F that are uniformly continuous on E, for every e > O. Show thatfmust itself be uniformly continuous on E. CONTINUITY 89 9 Using the special notation explained in (2-5), prove that, iff and 9 are defined on a set E, then 10 Let PI' P2' P3 be the vertices of a triangle D in the plane. (a) Show that any point p in D can be expressed as (b) Iffis a function defined on D with Lipschitz constant M, use part (a) to define a function F on D by F(p) = rtJ(PI) + rt 2 f(P2) + rt 3 f(P3) and show that IIF - filD s M diam(D). Exercises 11 and 12 constitute a different proof of Theorem 6. II Letfbe continuous on the interval [a, b]. Given £ > 0 and a point t in the interval, choose p = p(t) so that, if Ix - tl < p, then If(x) - f{t)1 < £. Let V t be the symmetric interval centered on t of radius 1P(t). Show that there are points t l' t 2' \"', t.. such that the sets V t , together cover the interval [a, b]. 12 (Continuation of Exercise 11.) Let Po be the smallest of the numbers p(tj), and let x' and x\" be any two points of the interval [a, b] with lx' - x\" 1< 1Po' Show that there must be one of the points tj such that lx' - tjl < p(t j ) and Ix\" - tjl < p(tJ Conclude that If(x') - f(x\")1 < 2£ and hence thatfis uniformly continuous on [a, b]. 2.4 IMPLICATIONS OF CONTINUITY Many properties of a continuous function-e.g., that it is bounded and attains a maximum-seem intuitively obvious and to require no formal proof, if one thinks only of those smooth functions whose graphs are easy to sketch with a pencil. However, there are continuous functions whose graphs are so compli- cated that they have tangent lines nowhere; an example will be discussed in Sec. 6.2. Moreover, if one considers any function of three variables, its graph becomes a set in 4-space, and there intuitive arguments become much less convincing. It is therefore important to see that these useful properties which hold for every continuous function do in fact follow logically from the defini- tion of continuity and do not depend upon intuitive geometric reasoning. It is helpful to introduce the words\" local\" and\" global\" to contrast two types of situations that frequently arise. If we are considering a given set D, then we say that any specific property holds locally at Po E D if it is true at Po and at all points P sufficiently near Po; thus, there will be an open ball B about Po and the property will hold for all p E B n D. On the other hand, a property that holds at all points in D is said to hold globally in D. Here is a useful example of this viewpoint. Theorem 8 Let f be a real-valued function defined and continuous on a set D in n space. If Po E D and f(po) > 0, then f is locally positive at Po' Indeed, there must be a neighborhood U about Po and an E > °such that f(p) > E for all p E U n D. 90 ADVANCED CALCULUS Set E = H-)f(po)' Since f is continuous at Po, choose U so that If(p) -f(Po)1 < E for all p E U (l D. Accordingly,f(p) - f(po) > -E, and hence f(p»f(Po)-E=2E-E=E I This result is a special case of the following more general theorem; to see the connection, take c = 0, and observe that Po will lie in an open set and must be interior to it. Theorem 9 Letfbe continuous on a set D, and let c be any number .. then, the set R of points P ED for whichf(p) > c is an open set, relative to D, and the set G of points p wheref(p) = c is a closed set, relative to D. This is an immediate consequence of Theorem 3. Let V be the open unbounded interval consisting of those numbers y with y > c. Since f is continuous, the inverse image f -l( V) of V must be open, relative to D. Clearly, R = f-l(V). The second part is treated in the same way by observ- ing that G is the inverse image of the closed set {c). I This result also explains the fact, noted earlier, that formulas such as S = {all (x, y) with x 2 - 3xl + y5 > I} always describe open sets, and formulas such as T = {all (x, y) with X 5y 2 + 7X 2y4 = 7J always describe closed sets. (See also Exercises I and 2.) A functionfis said to be bounded on a set S if the imagef(S) is a bounded set. There must then be a number M such that If(p)1 :s; M for all pES. A function can be continuous on a set without being bounded there. Examples are f(x) = l/x on the open interval °< x < I and g(x) = x 2 on the closed interval °:s; x < x. Theorem 10 Let f be a real-valued function defined and continuous on a compact set D. Then,f is bounded on D. Let us first prove that any continuous function is locally bounded on its domain. Given Po E D, take E = 1 and use the assumed continuity off to choose a neighborhood U about Po so that If(p) - f(Po)1 < I for all p E U (l D. Clearly, we then have If(p)1 < I + If(Po)1 for all such p, andf is locally bounded at Po. We now use the compactness of D to obtain a single bound for If(p)1 that works for all pin D. The fact thatfis locally bounded everywhere in D shows that given any p E D, there is an open set (!p abollt p and a number M p with If(q) I< M p for all points q E (! p' The sets (! p form an open covering of D. Since D is compact, this covering CONTINUITY 91 can be reduced to a finite covering by sets (! Pk for k = 1, 2, ... , m. In each of these sets,fis bounded, and every point q in D lies in one ofthese sets. Thus, if M is the largest of the numbers M Pk' we have If(q)1 < M for all qED. I The conclusion of this theorem can also be stated in the useful form: Iff is continuous on the compact set D, thenf(D) is a bounded set. In this form, the proof given above also holds iff is a function taking values in m space. (See also the statement of Theorem 13 below.) A real-valued function can be bounded and continuous on a set without attaining a maximum value on the set. This is true, for example, of the func- tionf(x) = x 2 on the open interval 0< x < 1 and on the unbounded closed interval O:s: x < 00 for the functionf(x) = x/(1 + x). Again, the situation is different for compact sets. Theorem 11 If S is compact, and f is continuous on S, then f takes a maximum and a minimum value somewhere on S. By the previous theorem,fis bounded on S. There then exist numbers B and b, with b :S:f(p) :S: B, for all pES. Let M be the smallest such upper bound for the values off on Sand m the largest lower bound. We must have m :S:f(p) :S: M for all pES as before, but now M cannot be decreased, nor m increased. If there is a point Po in S withf(po) = M, then M is the maxi- mum value for f on S, and it is attained in S. If there is no point Po with f(po) = M, thenf(p) < M for all pES. In this case, set g(p) = 1/(M - f(p)). Since the denominator is never 0, g is continuous on S and must therefore be bounded there. If we suppose that g(p) :S: A for all PES, then we would have and therefore 1 M _ 7(p) :S: A all pES 1 f(p) :S: M - It This, however, contradicts the fact that M was the smallest upper bound for the values off on S, and we conclude that this case does not occur and there is a point Po E S withf(po) = M. In a similar fashion, one may show that there is a point in S where f has the value m, and a minimum is attained. I There is an alternative approach to Theorems 10 and 11 which makes their meaning a little clearer, and also permits us to generalize them im- mediately for vector-valued functions and transformations. While such func- tions will be studied more fully in later chapters, it seems appropriate to men- tion these generalizations here. CONTINUITY 93 there would be some point Po in D, and a sequence {Pn} in D with Pn --+ Po, and an E > 0 such that If(Pn) - .[(Po)I> E for all n. Put qn = f(Pn) and consider the points Pn = (Pn, qn) in G, for n = 1,2, .... Note that Pn --+ Po E D, but that Iqn - f(po) I> E. Because G is compact, the sequence {Pn} must have a subsequence {Pn,} that converges to some point (p, q) in G. Accordingly, Iim n _ oo Pn, = Pand limn _ oo qn, = q. However, since {Pn,} is a subsequence of {Pn}, which itself converges to Po, we have P = Po. Because the point (p, q) is in G, which is the graph off, q = f(p) = f(po)' However, limn _ oc qn, = f(po) and Iqn - f(Po)1 > e are not both possible; we conclude thatfmust have been continuous on D. I In connection with this result, Exercise 4 shows that Theorem 12 does not hold if\" G is compact\" is replaced by \"G is closed.\" As our first application of this theorem, we obtain the following. Theorem 13 Iff is continuous on the compact set D, then f(D) is also a compact set. Becausefis continuous and D is compact, the graph offis a compact set G. The set f(D) is the projection of the set G (see Fig. 2-6). By Exercise 9, Sec. 1.8, the projection of a compact set is compact. Hencef(D) is compact. I;:&c\" This result contains both Theorem 10 and Theorem 11. Since f (D) is compact,f(D) is closed and bounded. The latter shows that there must exist a number M with If(p)1 < M for all P ED. The latter, together with the fact that the sup and inf of any set of real numbers belong to the closure of that set, shows that f (p) must achieve the values Maximum off(p) = sup (f(D)) Minimum of f(p) = inf (f(D)) Another application of the compact graph theorem will be given in Sec. 2.6, in connection with the problem of extending the definition of a function defined on an open set (! to the boundary of (!; in such a way that it remains continuous there. We now turn to what is usually called the intermediate value theorem. We state this for real-valued functions. Theorem 14 Let S be a connected set, and let f be continuous on S. Let the numbers a and b be any two values off on S, and suppose that a < c < b. Then, there is a point pES withf(p) = c. The one-variable form of this, with S an interval, is especially plausible. Here, it states that if the graph offlies below the line y = c at one point in 94 ADVANCED CALCULUS the interval, and above the line at another, then it must intersect the line at some intervening point. The proof of the general theorem is based upon Theorem 9 and the definition of a connected set. Suppose that f (p) is never c, for any point pES. Then, we always have either f(p) > cor f(p) < c. Let U be the set of pES withf (p) > c, and V the set where f (p) < c. These sets together must cover S. Sincefis continuous, both U and V are open, relative to S. Moreover, since there is a point Pi E S withf(pl) = a, the set V contains Pi and is therefore not empty; likewise, U is not empty. The existence of two such sets contradicts the assumption that S was connected; so we know that, somewhere in S,.f must take the value c. I This proof was again indirect; the argument proves that there must be a solution to the equation f(p) = c, but it gives no help in finding a solution. One reason to study such proofs in detail is to see if ways can be found to make them constructive, so that one has an algorithm for locating a point p in S with f(p) = c. Another approach to this result is found in Exercise 15, which will be recognized as a familiar process for locating the roots of an polynomial equation. This theorem too has a more general form which applies to continuous functions on n space with values in m space. Theorem 15 Let f be continuous on D, and let D be connected. Then, the image set f(D) is also connected. Suppose thatf(D) = A u B, where A and B are mutually separated. Since no point of A is arbitrarily near a point of B, A is open relative to f(D). So is B. Sincefis continuous,f- 1(A) andf-l(B) must be open, relative to D. Hence, D =.r l(A) u f- l(B), where these sets are disjoint and mutually separated. However, since D was assumed connected, one of these sets must be empty. Iff-l(A) is empty, A is empty. A similar observa- tion applies to f-l(B), and it follows that f(D) is not disconnected, and must be connected. I This general result also contains the usual intermediate value theorem (Theorem 14). We see this as follows. Suppose thatfis a real-valued function defined on a set D in n space, and thatftakes the values a and b somewhere in D. Let c be a number with a < c < b. If D is connected and f continuous, f(D) is a connected subset of R, and must therefore be an interval; but since f(D) contains the points a and b, it must also contain c. Thus, f takes the value c somewhere in D. We can also use Theorem 15 to clarify our understanding of connected- ness. In Sec. 1.5, we discussed two intuitive notions of this concept before defining \"connected.\" We can now make the notion of \"pathwise connected\" precise, and also prove the converse of Theorem 2, Sec. 1.5. CONTINUITY 95 Definition 5 A set S is pathwise connected if every pair of points p, q in Scan bejoined by a continuous path I' lying entirely in S. Specifically, this requires that there be a continuous function y(t), defined for °~ t ~ 1 such that 1'(0) = P and 1'(1) = q and such that y(t) E S for all t. We see that\" polygon connected\" is merely a special case of this, arising when the function y(t) is especially simple. Theorem 16 Any pathwise connected set S is connected. Suppose that S = A u B, where A and B are mutually separated and nonempty. Choose pEA and q E B, and then join p and q in S by a contin- uous path y. The trace of I' is the set 1'(1), where I is the interval [0,1]' Since I is connected, so is 1'(1). Set Ao = A n 1'(1) and Bo = B n 1'(1). Since these are subsets of A and B, respectively, Ao and Bo are also mutually separated. Moreover, p and q lie in 1'(1), so that Ao contains p and Bo contains q and neither set is empty. But 1'(1) = Ao u Bo , contradicting the fact that 1'(1) is connected. I The intermediate value theorem lies at the heart of many \"intuitively obvious\" mathematical facts dealing with the behavior of quantities that \"change continuously.\" We have given a number of these as exercises; in several which involve physical or geometrical quantities, you should assume that the appropriate function is continuous. We give two illustrations now that are less recreational. . Theorem 17 No continuous function can map the open unit square S onto the interval [0, 1] in a one-la-one fashion, although this is possible for dis- continuous functions. Suppose that ¢ is a continuous real-valued function defined on S. We show that there must be two points ql \"# q2 in S with ¢(qd = ¢(q2)' We may assume that we have PI and P2 in S with ¢(PI) < ¢(P2)' for otherwise we are done. Choose c with ¢(pd < c < ¢(P2) and take two different paths (J. and f3 in S which go from PI to P2' Then, on each there must be a point q where ¢(q) = c. Calling these points ql and q2 we clearly have ql \"# q2 and ¢(qd = ¢(q2)' I There is a standard example ofa discontinuous function ¢ that is a 1-to-l map of S into the unit interval. Given any point (x, y) E S, write each coordinate in decimal form: Y = ·YtY2)'3 ... 96 ADVANCED CALCULUS and then define cP by cP(x, y) = .Xd'I X2Y2 X3Y3 X4·\" If one is careful to avoid decimal representations that terminate in an endless sequence of 9s, cP can be seen to be a real-valued function, defined for o :os; x < 1, 0 :os; Y < 1, which takes distinct values at every distinct pair of points (x, y). It is also easily seen to be discontinuous. Our second illustration is a familiar observation from elementary calculus, used there frequently but without proof. Theorem 18 Letfbe a real-valued continuousfunction defined on the interval I = [a, b], and suppose that f is l-to-l on I. Then, f is strictly monotonic on I. The hypothesis means that if x I and x 2 are points in I with x I \"# x 2 ' then f(xI)\"# f(X2)' Clearly, we have either f(xd <f(x 2) or the reverse inequality; we show that this inequality always holds in the same direction, determined by the values off at the endpoints of[a, b]. We may suppose that f(a) <f(b). Take any x with a < x < b. Hf(x) > f(b), there must be t with a < t < x such that f(t) =f(b). If f(x) <f(a), there must be s with x < s < b andf(s) = f(a). We conclude that f(a) <f(x) <f(b) for all x between a and b. Now consider XI and X 2 with a < XI < X 2 < b, and suppose thatf(xd > f(x 2). Then, there must exist s with x 2 < s < band f(s) = f(xI)' We conclude thatf(xd <f(x 2) for every such pair of points, andfis strictly increasing on I. (If we had started withf(a) >.f(b),fwould have been strictly decreasing.) I EXERCISES I Show that if I is continuous on D, then the set of points p where I(p) :s C is closed relative to D. J . x v I2 Let S = jail (x, y) With 3 - Y- ~ :s 1 . (a) Is S a closed set in the plane? (b) Does this conflict with Exercise I? 3 Let F(x, y) be a polynomial in x and y, and let A = {all (x, y), F(x, y) ~ O} B = {all (x, y), F(x, y) = O} (a) Show that bdy (A) c B. (b) Is it always true that B is exactly the boundary of A? *4 Show by an example that the graph of a function defined on the interval 0 :s x :s 1 can be a closed set, without the function I being continuous. 5 Let I and 9 be continuous on the interval [0,1], and suppose that I(x) = g(x) for every rational number x = alb in this interval. Prove that 1= g. CONTINUITY 97 6 Use the intermediate value theorem to prove that any polynomial of odd degree with real coefficients has at least one real root. 7 Letfand 9 be continuous on [0, I] and suppose thatf(O) < g(O) andf(l) > g(I). Prove that there is a point x, 0 < x < I, withf(x) = g(x). Can you illustrate this by a picture? 8 Show that any function that is locally constant on an open connected set D is in fact constant on D. 9 Prove that a set S is disconnected if and only if there is a real-valued function f that is continuous on S but takes only the values 2 and 3 on S. 10 Give a mathematical argument to show that a heated wire in the shape of a circle must always have two diametrically opposite points with the same temperature. II Give a mathematical argument to show that any compact convex set can be divided into four subsets of the same area by two perpendicular cuts. 12 Show that any real-valued function defined on the set consisting of the nonnegative X, Y, and Z axes must take the same value at least twice. 13 Five line segments meet at a point. Show that any continuous real-valued function defined on this set must take the same value three times. 14 (a) Show that any heated tetrahedron must have three points located on its edges or vertices that have the same temperature. (b) Can you prove there must actually be four such points with the same temperature? 15 Suppose thatfis continuous on [a, b) and thatf(a)f(b) < O. Prove Theorem 14 by filling in the details of the following argument. (a) Apply the process of repeated bisection to construct two sequences {an} and Ibn} such that a s an < bn s b, with bn - an ---> 0, andf(an)f(bn) s O. (b) Show that limn~o< an = c where a < c < b andf(c) = O. 16 Let F(x, y) = (x - yf Then show that maxo~x~1 mino~y~ I F(x, y) = 0 and mino~y~1 maxo~x~ 1 F(x, y) =!. 17 Let F(x, y) be continuous on the square S = {all (x, y), Ixl s I, Iyl s I} Let maxlxl~ 1 minlYI~ 1 F(x, y) = A and min 1ylS 1 max 1xls 1 F(x, y) = B. Prove that A s B is always true. 18 Suppose that f is a complex-valued continuous function defined for 0 s t s 1. Suppose that f(O) = -I andf(1) = 1. Does there have to be a value of t withf(t) = O? Explain. 2.5 LIMITS OF FUNCTIONS The concept of continuity was introduced in this chapter by comparing the value of a function f at a point X o with the values which f takes on a small interval about x o' In this section, we examine the notion of convergence for functions which is implicit in this and which is analogous to the notion of convergence for sequences. The concept of the limiting value for a function at a point X o is particularly important when X o is a point at whichfhas not been defined, or where f is not continuous. We shall discuss functions of one variable first and treat the general case later. We assume for the present that functionsfare defined on some neighbor- hood of a point X o = b; whether or not f is defined at b itself turns out to be irrelevant for the discussion of limits. 98 ADVANCED CALCULUS Definition 6 We write lim x _ b f(x) = L if, corresponding to any £ > 0, there is a number 15 such that (2-7) If(x) - LI < £ whenever 0 < Ix - bl < 15 x#-I x = I Note that the last inequality rules out the choice x = b. It is customary to use the term \"deleted neighborhood of p\" to describe the set obtained by taking a neighborhood of p and removing p from it. Using this terminology, this definition could be rephrased as: lim x _ b f(x) = L if, given any £ > 0, there is a deleted neighborhood y of b such that (2-7) holds for all x in y. It should also be pointed out that there is a strong analogy between expressions involving the notation\" x ---+ b\" and the notation\" n ---+ 00,\" visible in both definitions and theorems; thus, compare \"limn _ ac an\" with \"lim x-b f (x ),\" and refer back to the appropriate definitions, noting also that just as we have x #- b, we have n #- 00. Further instances of this analogy will appear later. As an illustration of the calculation of a limit, let f be described by l ~~~__I f(x)=< x- 1 12 and consider limX _ 1 f(x). Computation gives f(l.I) = 3.31 f(1.01) = 3.0301 and we are led to guess that lim X _ 1 f(x) = 3. We can check this by the definition. We must estimate the difference If(x) - 31 for x near 1. When x #- 1, we have x 3 - I x3 - 3x + 2 f(x) - 3 = x---=-f - 3 =~-=- (-- = x 2 + X - 2 = (x - I)(x + 2) When x = l,j(x) - 3 = f(l) - 3 = 2 - 3 = - 1. However, our aim is to make f(x) - 3 small whenever 0 < Ix - II < 15, and this explicitly rules out x = 1; on this deleted neighborhood of 1, we have If(x)-31 = Ix- 11I x + 2 1 If we again agree to use numbers 15 smaller than 1, then the points x will be confined to the interval [0,2]. For such x, Ix + 21 :s; 4, and we have If(x) - 31 :s; Ix - 114 < 415 Given £ > 0, choose 15 as £/4; then, If(x) - 31 < £ whenever 0 < Ix - II < 15, and lim X _ 1 f(x) = 3. Of course, if the function f is known to be continuous at b, no such work is necessary, for it is evident from the definition of continuity that we CONTINUITY 99 then have lim x _ b f(x) = f(b). Thus, for continuous functions, calculation of limits is easy; one need merely substitute. We could have used this fact to simplify the calculations above which were used to find the limit of this specific function. We make the simple observation that x 3 - 1 can be factored as (x - 1)(x 2 + X + 1), so that we can write f(x) = x 2 + X + 1 x # 1 In other words, there is a function P given by P(x) = x 2 + X + 1 (for all x) such that f (x) = P(x) for all x # 1. Since f and P agree on a deleted neigh- borhood of x = I, and since these are the only values of f which are used in evaluating limx _ 1 f(x), we must have lim x _ 1 f(x) = limx _ 1 P(x). Clearly, P is continuous everywhere, being a polynomial, so that limx _ 1 P(x) = P( 1) = 3. This trick of replacing a function f by another function P which agrees with it near a point b, but which is known to be continuous at b, makes the calculation of certain limits easy. The theorems which were obtained in Sec. 1.6 for convergence of sequences (Theorems 8 to 12) each have their analog for limits of functions. Theorem 19 Assuming that f and 9 are each defined on a deleted neigh- borhood of x = b, and that limx-'+b f(x) = A and limx_b g(x) = B, then it is true that lim (f(x) + g(x)) = A + B lim f(x)g(x) = AB and if B # 0 lim !(x) = ~. x-b g(x) B We postpone proofs of these until we take up the comparable results for functions of several variables. As an illustration, to find I . 2X3 + 5x 2 - 8x - 20 1m 3 8 = L x-2 X - we may write this function as (x 2 - 4)(2x + 5) _ (x - 2)(x + 2)(2x + 5) (x - 2)(x 2 + 2x + 4) - (x - 2)(x 2 + 2x + 4) . and note that if the factor (x - 2) is removed, the result is continuous at x = 2, arriving at 100 ADVANCED CALCULUS In Sec. 3.2, we discuss L'Hospital's rule, often used in evaluating such limits; until then, we depend on other approaches. The limit notation is used to describe certain types of behavior for functions. Another possible behavior is indicated by the expression limx~b f(x) = 00. A word of caution: the symbol\" 00\" as used here is neither a number nor a point on the line. It is merely part of the expression and has no meaning out of context. A test of this is the fact that\" 00\" does not occur in the formal explanation of the whole expression which follows. Definition 7 We write limx~bf(x)= 00 if and only ij; corresponding to any positive number B, there is a number <5 > °such that f(x) > B whenever x satisfies °< Ix - b I < <5. As illustrations, we would write lim x~1 (x - 1r 2 = 00 and . 1 hm~--- = 00 x~o sin (x 2 ) We would not write limx~o l/x = 00, since the function involved behaves differently when x is negative and near°from what it does when x is positive. However, we could write limx~o 1/lxl = 00. Another useful modification of the limit notation is the following, which uses the symbol\" 00\" in a different way. Definition 8 We write lim f(x) = L xloo whenever f is defined on some unbounded interval such as °< x < 00 and, corresponding to any e > 0, there is a number X o such that If(x) - LI < e whenever x > X o . For example, limx 1 00 1/x2 = 0, limx 1 00 x/(x - 10) = 1, while limx 100 sin x and limx 1 00 l/(x sin x) do not exist. These can be combined and modified in other useful ways. Without giving formal definitions for them, we illustrate several possibilities. We would write lim eX = 0 lim log Ixl = - 00 x~o but would not write lim eX = 00 xl 00 lim (x sin x + 2x) = 00 xloo lim x sin x = 00 xloo lim (x sin x + x) = 00 CONTINUITY 101 1 Figure 2-7 f(x) = -- ... 1 + e llx One additional refinement of considerable usefulness is the notion of a one-sided limit. Definition 9 We write lim f(x) = L xl b if and only if, corresponding to a given 6 > 0, there is a number lJ > 0 such that If(x) - L I < 6 whenever x < b and Ix - bI < lJ, that is, whenever b - lJ < x < b. This is often called the left-hand limit of f (x) at b, or the limit of f (x) as x approaches b from below. A right-hand limit is defined in a similar fashion. Both may exist when the usual two-sided limit does not, and the two-sided limit exists when and only when both left- and right-hand limits exist and are the same. The function described by 1 f(x) =1 + el/x has left-hand limit 1 and right-hand limit 0 at the origin (see Fig. 2-7). Again, the one-sided limit notation can be combined with the other conventions already introduced. For example, the type of behavior exhibited by g(x) = l/x at the origin can now be described by writing lim g(x) = 00 x\" 0 lim g(x) = - 00 xl0 There is also an analog for the theorem about the convergence of bounded monotonic sequences. Recall that a function f is said to be bounded on a set S if there is a number B with I.f(p) I < B for all pES. For functions of one variable, we also speak of monotonic functions; f is increasing on a set E if f(x l ) ~f(X2) whenever Xl and x 2 belong to E and Xl < x 2 and decreasing if, under the same circumstances, we have f(x l ) ~f(X2)' We say that f is monotonic on E iff is either increasing on E or decreasing on E. Theorem 20 Iff is bounded and monotonic on the open interval a < x < b, then lim x 1 b f(x) and lim X \" a f(x) exist. 102 ADVANCED CALCULUS We now turn to the study of limits for functions of several variables, where much more diverse behavior is possible even with simple functions. This is to be expected, since there are only two modes of approach to a point b on the line but many approaches to a point in the plane or in space. The general case is covered by the following: Let S be a set on which f is defined, and let Po be a cluster point for S. For simplicity, we assume that Po is not itself in S. Thus, Po is a boundary point of S. If S contains a deleted neighborhood of Po' the reference to S in the statement below is usually omitted. Definition 10 We say that f(p) converges to L as p approaches Po in S, written lim f(p) = L [p E S] if and only if, corresponding to any e > 0 a number () > 0 can be found such that If(p) - LI < e whenever 0 < Ip - Po 1< () and pES. An important special case of this arises when S is a line segment or an arc (curve) having Po as an endpoint. In these cases, the limit of f(p) as p approaches Po from S reduces essentially to the computation of the limit of a function of one variable. For, let the arc be given by parametric equations: x = <jJ(t), Y = t/J(t), with 0 S t S 1, and such that lim t I 0 <jJ(t) = xo, limtjo t/J(t) = yo, the coordinates of Po· Then, setting g(t) = f(<jJ(t), t/J(t)), we see that lim p_ Po f (p), [p E S], is exactly lim, I 0 g(t). As an illustration, the limit off(x, y) as (x, y) approaches the origin along the horizontal axis from the right becomes lim x I 0 f(x, 0), while the limit along the vertical axis from below is limy 10 f(O, y) = lim t I 0 f(O, - t).If(x, y) approaches the origin along the ray of slope 1, we obtain lim t I 0 f(t, t). The following simple result is often quite useful in discussing the existence of limits. It can be considered as an extension of Theorem 1, which asserted that continuous functions were convergence preserving. Theorem 21 Iff is defined at all points of a neighborhood of PO' except possibly at Po itself, and limp_po f(p) = L, then the limit of f(p) exists for p approaching Po in any set S, and the limit is always L. The usual algebraic theorems for limits hold, either for approach in a deleted neighborhood of Po or in a general set S; for simplicity, we state only the first. Theorem 22 If limp_po f(p) = A and limp_po g(p) = B, then lim (f(p) + g(p)) = A + B lim f(p)g(p) = AB CONTINUITY 103 and, if B -=I 0, The proofs of these can be patterned on those of the comparable theorems for limits of sequences. Alternatively, for example, the second can be obtained by observing that f(p)g(p) - AB = (f(p) - A)(g(p) - B) + A(g(p) - B) + B(f(p) - A) If 'f~ is a deleted neighborhood of Po on which If (p) - A I < e and Ig(p) - BI < e, then on 'f~, If(p)g(p) - ABj < e2 + IAle + IBle Since A and B are constants, it is clear that the number [;2 + IAle + IBlf; can be made arbitrarily small by choosing [; sufficiently small. Thus,f(p )g(p) is seen to be arbitrarily near AB for p in 'r, if 'f~ is chosen small enough. A similar approach can be used for the limit of a quotient, starting from the identity f(p) A--- g(p) B B(f(p) - A) - A(g(p) - B) Bg(p) and using the fact that the deleted neighborhood j/O about Po can be chosen so that, in addition, Ig(p)1 > IBI/2 for p E j 0; accordingly, one has It will be noticed that we do not state any result dealing with the limit of the composition f(g(x)) of two functions, parallel to the theorem on the continuity off(g(x)). The absence of this is explained by Exercise 1. The Cauchy convergence criterion for sequences does have an analog for functions. Theorem 23 Suppose that for any e > 0, a deleted neighborhood j 0 about Po can be chosen so that If(p) - f(q)1 < efor every choice Q[p and q in j~. Then limp_po f(p) exists. We give a proof of this which throws the argument back onto the sequence case. Because of the hypothesis onf, we can choose a sequence bn , decreasing to 0, such that if p and q are any points with °< Ip - Po I < bn , °< Iq - Pol < bn, then If(p) - f(q)1 < l/n. Take any sequence {Pn} such that °< IPn - Po I < bn; clearly, {Pn} converges to Po· Set an = f(Pn)' Then, with Pn and Pm playing the role of p and q, we see that If(Pn) - f(Pm) I < I/N for alln, m > N, and {an} is a Cauchy sequence of real numbers. It must converge; let L = limn _ ce an' We will show that limp_po f(p) = L. 104 ADVANCED CALCULUS Given E> 0, choose a deleted neighborhood 'f~of Po as in the statemen t of the theorem. Choose k sufficiently large so that Pk E Yand Iak - L I < E. Let P be any point in Y. Then, /f(Pk) -f(p)1 < E, and, since ak =f(Pk)' we have If(p) - LI = If(p) - f(Pk) + ak - LI :-s; If(p) - f(Pk)1 + lak - LI <E+E=2E Thus,f(p) is near L for all P in Y, and limp_po f(p) = L. I The additional complexity introduced in going from functions of one variable to those of several variables can be seen from the following simple examples. Consider first the function f defined everywhere in the plane, except at (0,0), by f(x, y) = xy/J x 2 + y2, and let us study its behavior near the origin. When p lies on either axis, then xy = °andf(p) = 0. Thus,f(p) approaches ° as p approaches the origin along the axes. On the 45° line, where y = x, we havef(x, x) = X2/~ = Ixl/~i, so that againf(p) approaches 0. Is it true thatlimp_of(p)=O?Asafirststep,weobservethat Ixl:-s; Ipi and Iyl:-s; !pl, so that Ixyl :-s; Ipl2 and Ixyl Ipl2 If(p)1 = Jx 2 + y2 :-s; lPT = Ipi Thus, given any E > 0, we have If(p) - 01 < E for all points p with °< Ip - 01 < b, for the choice b = E. We have thus shown that lim p _ o f(p) = 0. Consider next the function g defined by xy g(x, y) = x 2 + y2 (x, y) # (0,0) Again, g(p) = °when P lies on either axis, so that g(p) converges to °as p approaches the origin along either axis. This time, lim p _ o g(p) fails to exist, however, for the limit as p approaches 0 along the 45° line is not 0. To see this, we set y = x, have g(p) = g(x, x) = x 2/2x 2 = 1, and find that the limit of g(p) on this line is 1- The final illustration will show that the behavior of a function can be considerably more complicated. Put xy2 F(x,y)= 2 4 (x,y)#(O,O) x + y On the axes, F(p) = 0. On the line y = x, we have x 3 x F(p) = F(x, x) = x2 + x4 = 1+ x 2 CONTINUITY 105 and limx _ o F(x, x) = O. In fact, we can show that F(p) converges to 0 as p approaches the origin along every straight line. When y = mx, m2x F(p) = F(x, mx) = 1 4 2 +mx lim (lim 2 X2~2) = 0 y-o x-o X + Y and and lim x _ o F(x, mx) = O. In spite of this, it is not true that lim p _ o F(p) = O. To show this, we produce a curve terminating at the origin, along which F(p) does not converge to 0; this curve is the parabola y2 = x, and F(p) = F(l, y) = y4/2y4 = 1- When f is a function of two real variables, the notation limx _ xo f(x, y) Y-YO is often used in place oflim p _ po f(p). This should not be confused with notion of an iterated limit, such as lim x _ xo limy_yO f(x, y), in which we treat f as a function of x and y separately, rather than as a function of the point (x, y). For example, lim (lim 2 X22) = 1 x-o y-o x + y while lim x _ o X 2 /X 2 + y2 fails to exist. y-o We may also discuss the behavior of a function \"at infinity,\" that is, when IpI is large. Definition 11 We write lim f(p) = L Ipl-<L if and only if, corresponding to each f. > 0, a number N can be found such that lJ(p) - LI < f. whenever Ipl 2 N. For example, iff (x, y) = 1/(x2 + y2 + 1), then we may write lim f(p) = 0 Ipl-Ol. Again, iff (x, y, z) = T + (x 2 + y2 + z2r 1/2 is the temperature at (x, y, z), we would say that the temperature \"at infinity\" is T, meaning that lim f(p) = T. Ipl-<L EXERCISES if x is different from 1 or 2 if x = 1 if x = 2 j(x) = g 12 g(x) = ·3 j4 I Let Note: Exercises are to be done without using L'Hospitafs rule. if x # 0 if x = 0 3 Find 106 ADVANCED CALCULUS (a) Verify that lim x _ o f(x) = 1,limx _ I g(x) = 2, lim x _ o g(l(x)) = 3, and g(l(O)) = 4. (b) Do the statements in (a) still hold if Ix + 1 x # 0 f(x) = \\2 I x=O -1x --12 2 Find lim --- --. x-2 Jx - J2 2 --+3 x-I lim------ x-I 4+ __5__ 2 3x - --- x+2 x 3 + x 2 - 7x + 2 4 Find lim f(x) where f(x) = -3--2--- . x- 2 2x - 5x + 6x - 8 x'\" 5 Prove that for any constant m, lim x = O. x r x e 6 Discuss the existence of: x 5 - 1 (a) lim 4'-- x-I x-I (e) lim (I - xl' 1/2 x 1 I 7 Formulate precise definitions for: (a) lim f(x) = L (e) lim f(x) = L x j b 8 Discuss the existence of: x (b) lim - x 1 x 1 + 3x (b) lim f(x) = ex x 1 x . x + I' (b) hm ---' - Ipl-x x 2 + .1'2 x-I x-I (a) lim --=- (b) lim -- -- xl-xji+x 2 xlxJl+x 2 9 What is the form that Theorem 23 should take if f is a function of one variable and Po IS replaced by .. ex \"? 10 If e # 0, show that lim x _, f(1/x) = Iim'_I' f(t) if either exists. II Is it always true that: (a) lim f(x) = lim f(~) (b) lim f(x) = lim f(~) x T :x: r lot x ! 0 n-+:x: n 12 Show that if r/J is defined on a neighborhood of to and continuous at to with r/J(to) = xo, then lim x_ xo f(x) = lim,_,o f(r/J(t)). 13 Prove Theorem 20. 14 Let f be bounded on the interval e < x < ex, and let lim x 1 x g(x) = O. Prove that limxl x f(x)g(x) = O. Does this follow directly from Theorem 19? *15 Can you formulate a definition for lim SUPx_b f(x)? What properties would you expect this to have? For example, does Theorem 19 hold? 16 Discuss the existence of the following limits: x + I' (a)lim--'--- p-o x 2 + .1'2 CONTINUITY 107 17 Following the pattern of Definition II, formulate a definition for \"f(p) converges to L as p becomes infinite in the set S.\" Using this, discuss the behavior of f(x, y) = exp (x - y) when Iplls large. (You may assume knowledge of the exponential function and its properties.) 18 If f is uniformly continuous on a set D in R\" and Po is a cluster point for D, show that limp~po f(p) exists in D. 2.6 DISCONTINUITIES A function that is not continuous at a point Po is said to be discontinuous there. The term discontinuity is used in two ways. The first refers to a point at which the function is defined but is not continuous. For example, consider the function f described by Jx 2 + i f(p) = f(x, y) = 10 when Ipi::; 1 when Ipi > 1 This function is defined in the whole plane and is continuous there except at the points p with IpI = 1; each point of this circle is thus a discontinuity for f If we consider f only on the set E = {all p with Ipl::; l}, then f is continuous on E; the points of the circumference would not be considered discontinuities this time. On the other hand, if we were to restrict f to the set consisting of points p with 1 ::; Ipi::; 2, it would not be continuous every- where in this ring, for the points p with Ipi = 1 would again be discontinuities for fIn its second usage, the term discontinuity is also applied to points where a function is not defined. For example, the function described by f(x) = l/x might be said to be discontinuous (or to have a discontinuity) at x = O. Discontinuities can be further classified as removable and essential. If f(po) is defined, and L = limp_po f(p) exists but L # f(Po), then Po is a dis- continuity for f; however, it may be \"removed\" by altering the definition for f at Po' If we construct a new function F by setting F(p) = f(p) for all p in the domain off, except Po' and setting F(po) = L, then F is now continuous at Po' Again, if a function f is not defined at Po' but L = limp_po f(p) exists, then we may define f(po) to be L and thus extend the domain off to include Po so that f is continuous at Po' In both these cases, we would say that Po was a removable discontinuity forf When limp_po f(p) does not exist, Po is said to be an essential discontinuity for f, since by no assignment of a value forf(po) can we makefcontinuous there. For example, let f(x) = XX g(x) = :~ h(x) = sin e) when x> 0 when x> 0 when x = 0 when x > 0 CONTINUITY 109 It is not always easy to tell when a discontinuity is removable or essential. It is an important research problem in mathematics to discover conditions under which it is possible to extend the definition of a function from a set E to a larger set so as to retain certain desirable properties such as continuity. For example, one question that could be asked is: When can a function f, defined and continuous on a set S, be extended to its closure as a continuous func- tion? The following result gives one answer to this question. Theorem 24 Let S be a bounded set and E its closure. Then, a function f, continuous on S, can be extended continuously to E if and only if f is uniformly continuous on S. The hypothesis that f is uniformly continuous on S is a necessary one, for E, the closure of S, is itself bounded and thus compact, and iff can be defined on the boundary of S in such a way that it becomes continuous on all of E, then the resulting function must be uniformly continuous on E, and must therefore have been uniformly continuous on the subset S. What remains to be proved, then, is that iffis uniformly continuous on S, such an extension offis possible. We give one proof which depends on the compact graph theorem (Theorem 12 in Sec. 2.4), and indicate the skeleton of another which uses the Cauchy convergence criterion. The first has the advantage ofelegance, but should be read with pencil and paper and suitable sketches. Let G be the graph of the given function f Because f is uniformly continuous on S, which is bounded, f is bounded (Exercise 7, Sec. 2.3). Combining this with the fact that S is bounded, we see that G is a bounded set. The closure of G, G, will then be a closed bounded set in an appropriately chosen euclidean space, and will therefore be compact. If we know that G is the graph of a function F, then F will be an extension off that is defined on the set E, and because of the compact graph theorem, F is continuous on E. The missing step is the proof that G is the graph of a function. Could a vertical line cut G in two distinct points? The points of G have the form (p,f(p}), for PES, and the points of G are limit points of these. The set G will not be the graph of a function if we can find two points (q, b) and (q, c) in G with b #- c. Choose two sequences (qn' un) and (Pn' un) in G, with the first converging to (q, b) and the second to (q, c). From the fact that G is the graph off, Un = f(qn} and Un = f(Pn)· In addition, {Pn} --+ q, {qn} --+ q, and Un = f(qn) --+ b, Un = f(Pn) --+ c. However, IPn - qnl--+ Iq - ql = 0, so that (by Exercise 6, Sec. 2.3), If(Pn} - f(qn} 1--+ 0, and we conclude that Ic - bI =° and b = c, completing the proof of Theorem 24. I A second proof, which may seem more direct, starts by asking what value the continuous extension offought to have at any particular boundary point q ofthe set S. To find out, take any sequence {Pn} in S which converges to q, and examine the values Un = f(Pn)' Use the uniform continuity offin S 110 ADVANCED CALCULUS to show that {un} is a Cauchy sequence. This must converge, so we are led to the definition: f(q) = limn _ oo Un' Use Exercise 6 of Sec. 2.3 to show that the value for f(g) so chosen doesn't depend on what sequence {Pn} was originally chosen. In this fashion, the function f has been extended to the closure of the original set S by defining it at every boundary point of S. All that remains is to prove that the extended function is continuous on E, and this can be done by invoking the compact graph theorem. I A typical illustration of this theorem is the situation in which one has a function F defined on a bounded open set D, and one would like to be able to speak of the values of F on bdy(D); for example, F(p) might be the temperature at the point P (see Exercise 7). Theorem 24 states that if F is uniformly continuous on S, then there is one and only one way to do this to keep the function F continuous. All points of the boundary of D are removable discontinuities. For a one-variable illustration, let D be the open interval 0 < x < 1. Given a function f (x) defined on D, we want to determine the \"correct\" values for f(O) and f( 1). In this case, they exist if and only iff is uniformly continuousonD,and thenf(O) = lim xlO f(x)andf(l) = limxp f(x), and these limits will in fact exist. It is natural to ask whether it is possible to extend functions still further, beyond the closure of the original domain, and still keep the functions con- tinuous; we return to this in Sec. 6.2 where we sketch the proof of the Tietze extension theorem, which gives an affirmative answer. EXERCISES Discuss the continuity of the function f described by: (a) f(x) = jX sin (ljx) 10 xv (b) f(x. y) = Ixl ~ Iyl l:~_-:-1 (d) f(x. y) = 1x - y x-y x#o x=o for (x. y) # (0.0) for (x. y) # (0.0) for x # y when x = y () 1 1 if x is a rational number 2 Letf x = oif x is an irrational number. Isfcontinuous anywhere? f( J0 if x is irrational 3 Let x) = l1jq if x is the rational number pjq in lowest terms. Is f continuous anywhere? CONTINUITY III 4 For each of the following functions, find all the discontinuities and indicate any that are removable. x (a) f(x) = --- SIn (5 cos x) sin x (b) f(x) = x + 4 2x - ---- x-I I (e) f(x) = I + e\"cx 5 For each of the following functions, find all the discontinuities and indicate any that are removable. x + 2y (a) F(x, y) =-;-------------- SIn (x + y) - cos (x - y) 6 Investigate the behavior of F(x, y) at (0,0) if (b) F(x, y) = x sin (~) 7 Suppose that there is a continuous distribution of temperature on the open square Ixl < I, Iyl < I. Is it possible to extend the temperature continuously to the boundary so that the temperature is 0 on the north edge and 100° on the other three edges? 8 The function ( X 2 + y2 - X y ) exp --- .._- = f(x, y) x2 + y2 is continuous on the open first quadrant. (a) Is it bounded there? (b) Can f be extended continuously to the closed first quadrant? *9 Letfbe an increasing function on the interval [0, I]. Show thatfcannot have more than a countable number of discontinuities on this interval. (Hint: First look at the one-sided limits at a point x Q .) 2.7 INVERSES FOR FUNCTIONS OF ONE VARIABLE The topic of the inverse of a function is one for which the geometrical point of view is particularly well suited. Let f be a function of one variable. Con- sidered as a transformation from R1 into R1,.f sends the point a Into the point b = f(a). A function g is called an inverse for f if g reverses the effect of f, sending b back into a, so that g(f(a)) = a. In most cases, it is not possible to find such a function g which has this property for all points x in the domain of .f As an illustration, letf(x) = x 2 , -00 < X < 00. Hfhad an inverse g such that g(f(x)) = x for all real numbers x, then g(x2) = x and it would be necessary to have both g(4) = g(22) = 2 and g(4) = g((_2)2) = -2. Such ambiguity is impossible for a function, since the point 4 must have a unique image. However, the functionfhas an inverse g on the interval 0 < x < 00 and a second inverse h on the interval - 00 < x < 0, namely, the functions defined on the interval 0 < x < 00 by g(x) = ~x and h(x) = -~x. In order for f to have a partial inverse associated with a subset S of its domain, all that is needed is to havef 1-to-1 on S. There then exists a function 112 ADVANCED CALCULUS --- \\, \\ , \" h..... ...._---- Figure 2-9 g defined on f(S) such that g(f(x)) = x for all XES, and f(g(x)) = x for all x Ef(S). Let us examine the problem from the geometrical point of view. The graph off is the set of points (x,f (x)), so that (a, b) is on the graph ofI if and only if b = I(a). If g(b) = a, then the point (b, a) must be on the graph of g. Let us introduce a special transformation R from R 2 into itself which sends (x, y) into (y, x). It is easily seen that this can be regarded as a reflection of the plane about the line y = x, in R 2 . Let C be the image under R of the graph of f If (a, b) is on the graph off, (b, a) E C. Thus, the graph of any function g which is an inverse for f must be part of the set C. Turning this around, any subset of C which is the graph of a function (i.e., any subset which is met no more than once by each vertical line ) yields a particular inverse function for f Applying this to the examplef(x) = x 2, we have given in Fig. 2-9 the graph of f, and its image C under the reflection R. The set C falls into two con- nected pieces, each of which is the graph of a function; the upper half is the function g, g(x) = JX, and the lower half the function h, h(x) = -JX Turning to a less trivial example, consider the function F given by F(x) = 1x - ~X3. The graph of F and its reflection C are shown in Fig. 2-10. As indicated there, C can be split into three connected pieces, each of which is the graph of a function, and each of which therefore defines a function which is an inverse for F. The function gl is defined on the interval - 00 < x < 1, the function g2 on [ - 1, 1], and the function g3 on the interval - 1 < x < 00. An accurate graph of F would enable us to read off the values of these functions, and thus tabulate them. (In this example, it is also possible to give analytical formulas for gl' g2' and g3; see Exercise 3.) Again, if f(x) = sin x, then (see Fig. 2-11) the graph of the reflection C falls into an infinite number of connected pieces, each of which provides an inverse for f Among these, one is usually singled out as shown and is called the principal inverse for the sine function, g(x) = arcsin(x). This same geometric process can be used with any mappingffrom n space into n space. If S c domain(f) is a set on which f is I-to-l, then the cor- 114 ADVANCED CALCULUS Theorem 25 Let f be continuous and 1-to-1 on an interval [a, b]. Then,f has a unique inverse 9 defined on an interval [C(, {3] such that g(f(x)) = x for all x E [a, b] andf(g(x)) = x for all x E [C(, {3], and 9 is continuous. By Theorem 18,f must be strictly monotonic on [a, b]. Since [a, b] is compact and connected, its image f([ a, b]) is the same and must be a closed interval, say [C(, {3]. By the geometrical process described above, there is a unique function 9 which is inverse tof, and which maps [C(, {3] 1-to-1 onto [a, b], reversing the mapping! Let the graph offbe G, and the graph of 9 be C. Since f is continuous, G is compact. Since C is simply the reflection of G, C is also compact. Hence, 9 is continuous. I The same proof can be used to show that any 1-to-1 mapping from a com- pact set S in n space into n space also has a continuous inverse. We will see later that this same geometric process can be used to discover other properties of the inverses of a given mapping! When n = 1, and we are studying a functionf defined on an interval, it can be a simple matter to find subintervals on which f is 1-to-1, since f must be strictly monotonic there. Indeed, iff is differentiable there, then it will be re- called from elementary calculus that f'(x) must be everywhere positive or everywhere negative on such an interval. This elementary result is a conse- quence of the mean value theorem (and will in fact be an exercise in the next chapter, Sec. 3.2); because this relationship between the monotonicity of f(x) and the sign of f'(x) is both so familiar and so useful, we remind you of it in connection with the exercises below. EXERCISES 3x I (a) Find an interval on whichf(x) = ... IS contmuous and l-to-1. x+4 (b) Find a formula for the corresponding inverse. 2 (a) Find an interval on whichf(x) = x 3 - 3x 2 + 3x is continuous and l-to-1. (b) Find a formula for the corresponding inverse. 3 Show that a formula for the function 9, of Fig. 2-10 is j[jx 2 - I - xl' 3 - [jx 2 -I + xl' 3. - X < X < -I 91(X) = I 2 cos (jarccos(-x)). -1:s;x:s;1 4 Find inverses for the function f given by f(x) = x 2 - 2x - 3 5 How many continuous inverses are there for the function described by F(x) = x 3 + 3x CONTINUITY 115 6 Is there any interval on which the function f described by f(x) = 2x + lxi-Ix + 11 fails to have an inverse? *7 Show that a continuous functionfcannot map the interval [0, 1] onto itself exactly 2-to-1. 8 Investigate the existence of local and global inverses for the function f(x) = Ax - sin x, for various values of A. 9 Letfbe a continuous function defined on the interval I = [a, b] which maps I onto I 1-to-1 and which is its own inverse. (a) Show that, except for one possible function,f must be monotonic decreasing on I. (b) What are the polynomial functions that are choices for f? CHAPTER THREE DIFFERENTIATION 3.1 PREVIEW In this chapter, we introduce and exploit the properties of the vector-valued derivative Df of a function of several variables. This is also called the gradient of f, and is related to the partial derivatives and directional derivatives of f There is some review of the one-variable theory, including the mean value theorem and L'Hospltars rule. We also discuss Taylor's theorem for one and several variables, and several forms of the mean value theorem for functions of several variables. We discuss chain rules for differentiation, and illustrate them in cases of complicated functional relationships and changes of variables; we think that the use of diagrams such as Fig. 3-7 makes this easier to follow. We also discuss the applications of differentiation, treating extremal prob- lems and the location and nature of critical points. Any treatment of higher derivatives of functions of several variables is postponed to Chap. 7, since this requires the differentiation of vector-valued functions. However, note the brief remarks that follow the proof of Theorem 19. 3.2 MEAN VALUE THEOREMS AND L'HOSPITAL'S RULE Certain simple properties of functions of one variable involve differentiation. Recall from elementary calculus thatfis said to be differentiable (or to have a derivative) at xo iff is defined on a neighborhood of xo and iff'(x o) exists. defined by (3-1) 116 1'(xo) = lim f(x1-/J:9) = lim lJxo + ~0 ~f(·,-o) x-xc x - X o h-O h DIFFERENTIATION 117 Another way to state this is to say that the function g(x) = f(x) - f(x o) x - X o has X o as a removable discontinuity. A frequent application of differential calculus is to so-called maximum- minimum problems. We say that f has a local maximum at X o if there is a neighborhood U about X o such thatf(x) ~f(xo) for all x E U. The notion of a local minimum is defined similarly, and the term extreme value may be used to refer to either. Theorem 1 Let f(x) be defined on a neighborhood of X o and have a local extreme value at X O ' Iff is differentiable at x O ' then f'(x o) = o. We may assume thatf(xo + h) ~ f(x o) for all h with Ihi < e5, and that C = limh _ o (f(xo + h) - f(xo))/h = f'(xo) exists. This limit may also be computed by letting h approach 0 first from above, and then from below. Since the numerator of the fraction is never strictly positive, we find that C obeys the conditions C ~ 0 and C ::::>: 0, so that necessarily C = o. I It is important to keep in mind that f'(x o) need not be 0 if X o is an end- point, rather than an interior point. Thus in using this theorem in the solution ofa maximum-minimum problem, separate consideration must be given to the possibility of an endpoint extreme value. One immediate consequence of Theorem 1 has acquired a special name. Theorem 2 (Rolle's Theorem) Let f be continuous on the interval [a, b], and letf'(x) existfor a < x < b. Iff(a) =f(b) then there is a point xo with a < xo < b at whichf'{xo) = O. Iff is a constant function, any choice of the point x o will do. Iff is not constant, then it must have either an interior minimum or an interior maximum at some point xo on the open interval a < x < b; and sincefis differentiable there,f'(xo) = O. I Corollary 1 Iff is differentiable on the interral a < x < b, then the zeros off are separated by zeros off'. Corollary 2 Let f and 9 be continuous on [a, b] and differentiable on a < x < b. Suppose that f(a) = g(a) and f(b) = g(b). Then, there is at least one point x o interior to [a, b] such that f'(x o) = g'(xo)' The second of these, which follows from the theorem if we consider the function f - g, has a simple geometric meaning, as shown in Fig. 3-1; some 118 ADVANCED CALCULUS Figure 3-1 vertical line must cross the graphs of f and 9 at a point where their slopes are the same, between two points where the curves meet. If the function 9 is specialized to be a straight line, then its slope will everywhere be f(b) - f(a) m = '----'--'------=---'--- b-a This case then gives the first of the following two very useful consequences of Rolle's theorem. Theorem 3 (Mean Value Theorem) Let f be continuous on [a, b], and let f'(x) existfor a < x < b. Then, at least one point X o exists interior to [a, b] such that (3-2) f(b) -f(a) = (b - a)f'(xo) Theorem 4 (General Mean Value Theorem) Let f and 9 be continuous on [a, b], and let f'(x) and g'(x) both exist for a < x < b. Then at least one point X o exists interior to [a, b] such that (3-3) . [.f(b) - f(a)]g'(xo) = [g(b) - g(a)]f'(xo) The first of these has many familiar consequences. If f'(x) is 0 on an interval,.fis constant there (Exercise 1). Iff'(x) never changes sign on an interval, thenf is monotonic there (Exercise 4). If 9 is chosen to be the identity function, g(x) = x, then Theorem 4 becomes Theorem 3. To prove Theorem 4, we construct a special function F to which we apply Rolle's theorem. Let F(x) = f(x) - Kg(x) where K is a constant to be selected later. The function F is continuous on [a, b] and differentiable in the interior. To apply Rolle's theorem, we want to have F(a) = F(b). Forcing this, we must have f(a) - Kg(a) = f(b) - Kg(b) orf(b) - f(a) = K(g(b) - g(a)). Put aside for the moment the considera- tion of what we should do if g(b) = g(a). Then, we can solve for K, and F satisfies the hypothesis for Rolle's theorem. There is then a point Xo with DIFFERENTIATION 119 F'(xo) = O. Since F'(x) = j'(x) - Kg'(x), this tells us thatf'(xo) = Kg'(xo), and substituting the value we found for K, we obtain (3-3). Suppose now that g(b) - g(a) = O. We cannot now solve for K. However, we do not need to; for, examining (3-3), we see that it will hold if we can find an X o with g'(xo) = 0, so that both sides of (3-3) will be O. This we can do by applying Rolle's theorem to g. I The geometric meaning of the general mean value theorem is very similar to that of the ordinary mean value theorem. If we assume that g'(x) is never oon [a, b], then from Rolle's theorem, we know that g(b) # g(a), and we can rewrite (3-3) in the form (3-4) f(b) - f(a) ---- ._~----- g(b) - g(a) Let r be the curve in the plane whose parametric equation is x = g(t), Y = f(t). As t moves along the interval [a, b], the point (x, y) moves along r from the point P = (g(a),f(a)) to Q = (g(b),f(b)). The left side of (3-4) is the slope of the line joining P and Q. The right side of (3-4), which can also be written as (dyjdt)j(dxjdt), is the slope of the curve. Thus, one meaning of Theorem 4 is that there must be a point on the curve r where its slope is the same as that of the line PQ (see Fig. 3-2). We remark that (3-3) is a more general form of this result than is (3-4), since the latter requires the hypothesis that g' is never O. For example, let f(x) = x 2 and g(x) = x 3 , on the interval [- 1, 1]. The left side of (3-4) is 0; however, since j'(x)jg'(x) = (2x)j(3x 2 ) = 2j(3x), there is no choice of X o E [ - 1, 1] for which (3-4) holds. (This also provides a curve r for which the geometric interpretation of Theorem 4 fails; see Exercise 17.) The analytical forms of these theorems can be modified. Since the point X o lies between a and b, we can write X o = a + (}h, where h = b - a and o < () < 1. The conclusion of Theorem 3 would then read f(a + h) = f(a) + hj'(a + (}h) The uses of the mean value theorems are of two sorts, one \"practical\" and the other\" theoretical\"; the distinctions here are quite subjective. As an Figure 3-2 Mean value theorem. 120 ADVANCED CALCULUS example of the former, we shall use the mean value theorem to obtain a simple approximation to a special function. Theorem 5 When u > 0 and v 2 O,Ju~v may be replaced by u + v/2u, with an error of v2/4u 3 at most. To illustrate this, -/87 = fiT+'-6 - 9 + -A = 9j, with an error of at most 36/(4)(9)3 - .012. To prove this, putf(x) = Ju 2 +x so thatf(O) = u, whilef(v) is the value we wish to estimate. By the mean value theorem, there is an x o , 0 < X o < v, with f(v) = f(O) + (v - O)f'(xo) v = u+-7.== 2y u2 + X o Since X o > 0, -/u- 2 + X o > u, and we have shown that f(v) < u + v/(2u). Thus, the approximation u + v/(2u) is always larger than the true value of ~2~•. To estimate the error in the approximation, we observe that Xo < v so that -/uT+~~< -/u\"\"\"\"2+~< u + v/(2u). Hence, v f(v) = u + ------,= 2JU2+x o v uv > u + l v j = U + 2u~ v 2 U + - 2u and thus uv r:-- v U + ---- < Y u2 + V < U + _. 2u 2 + v 2u The error made in using the right-hand term as the approximate value is less than the difference [The more exact methods made possible by Taylor's theorem, Sec. 3.5, show that the approximation u + r/(2u) is accurate to within r 2/(8u 3 ).] An extremely useful result which arises from the general mean value theorem (Theorem 4) is known as L'Hospital's rule. It provides a simple procedure for the evaluation of limiting values of functions which are ex pressible as quotients. lim g(x) = 0 x r b DIFFERENTIATION 121 Theorem 6 (L'Hospital's Rule) Let f and 9 be differentiable on the interval a s x < b, with g'(x) #- 0 there. ~f (i) lim f(x) = 0 x r b or if (ii) lim f(x) = 00 x r b lim g(x) = 00 x r b and if then lim j'(x) = L xrbg'(x) . f(x) hm---- = L xrbg(x) The upper endpoint b may be finite or \"00\", and L may be finite or \"00\". Before proving the theorem, we give several illustrations of its use, and possible modifications. To evaluate . I - cos (Xl) hm ---- ----- xjO x 4 we consider instead . 2x sin (Xl) . sin (Xl) 1 hm ---------- = hm~--2 - = x j 0 4x 3 x j 0 2x 2 By the theorem, this is also the value of the original limit. Again, consider lim x 0 xx. Since log (XX) = X log x, we consider instead limx j 0 X log x = limx j 0 (Jog x)/(l/x). We replace this by limx j 0 (l/x)/( - l/x l ) = limx j 0 - x = O. Since the exponential function is continuous, we conclude that lim XX = lim exp (x log x) = exp (0) = 1 x j 0 x j 0 We call your attention to two of the exercises which point out ways in which L'Hospital's rule can be misapplied. In Exercise 24, it is used to evaluate a limit (known not to exist) and finds the answer 0; in this case, one of the hypotheses of Theorem 6 has been overlooked. In Exercise 25 an incorrect result is again obtained, but this time the error lies in assuming that a converse of Theorem 6 is valid, namely, that if lim j'(x)/g'(x) does not exist, neither does lim f(x)/g(x). PROOF We first prove Theorem 6 under hypothesis (i), the case usually described as \"a fraction that is indeterminate of the form 0/0.\" We also suppose b finite, and can therefore setf(b) = g(b) = 0 and thus assume that f and 9 are each continuous on [a, b]. Using the form of the general 122 ADVANCED CALCULUS mean value theorem given in (3-4), we take any x interior to [a, b], and then can be sure that there is a point t with x < t < b such that j(b) - j(x) f'(t) ~---- g(b) - g(x) g'(t) Sincej(b) = g(b) = 0, this implies £0=) _ L = L(t) - L g(x) g'(t) Since limr _ b f'(t)jg'(t) = L, the right side (and thus the left) will approach° if we can force t toward b. Since t lies somewhere between x and b, we can achieve this by controlling x. Accordingly, given e > °we can choose b so thatifb - b < x < b,thenofnecessity Ib - tl < band Ij(x)jg(x) - LI < e, proving that lim x _ b j(x)jg(x) = L. We give a different type of proof for Theorem 6 under the second hypothesis, (ii); here, one speaks of a \"fraction that is indeterminate of the form oojoo.\" (As suggested by Exercise 26, there are essential geometric differences between the two cases.) We start from the fact thatj(x)--+ 00, g(x)--+ 00, andf'(x)jg'(x)--+L as x approaches b. Since g'(x) is never 0, we know that it must be positive and thus that 9 is strictly increasing; we may therefore assume g(x) > °for all x in [a, b]. Given e > 0, choose X o so that if X o < t < b, -e < [JtJ - L < e g'(t) Since g'(t) > 0, we may rewrite this as (3-5) (L - e)g'(t) <f'(t) < (L + e)g'(t) The right half of this can be written f'(t) - (L + e)g'(t) < ° which implies that the functionj(x) - (L + e)g(x) is decreasing, since its derivative is negative on [xo, b]. A decreasing function is necessarily bounded above, so that we have j(x) - (L - e)g(x) < B. Divide by g(x), which is positive, and arrive at j(x) B ---<L+e+--- g(x) g(x) Since g(x) --+ 00 as x --+ b, we see that for some XI near b, j(x)jg(x) < L + 2e for all x, x I < X < b. If we return to (3-5) and carry out a similar calculation using the left half of the inequality, we obtainj(x)jg(x) > L - 2e, and the combina- tion proves that lim x _ b j(x)jg(x) = L. I DIFFERENTIATION 123 Monotonic functions are much easier to work with than other functions. For example, as will be shown later, the graph of a continuous monotonic function is always a curve of finite length, while this need not be true for a function which is merely continuous. A function that is piecewise monotonic is also well behaved; any polynomial function P(x) = amxm+ am_1xm- 1 + ... + ao is piecewise monotonic (Exercise 6). For differentiable functions, this is easy to test, using the relationship between monotonicity and the sign of f'(x). (However, in this connection, note Exercise 30.) A function f that is piecewise monotonic will possess partial inverses associated with portions of its domain on which it is I-to-1. Iff is also differentiable, and the derivative doesn't vanish, the inverse is also differentiable. Theorem 7 Let f be monotonic on [a, b], and differentiable with f'(x) #- 0 for a < x < b. Then g, the inverse off, is defined on an interval [a, P], and g is differentiable in its interior, with g'(y) = 1/f'(g(y» for all y, a < y < p. We must show that lim x _ y (g(x) - g(y»/(x - y) exists. Set g(x) = y and g(y) = c. Then, x = f(y), y = f(c), and sincefand g are both continuous, the limit we must consider becomes . y-c hm---~-~ y-c f(y) -f(c) which we see at once to exist and be 1/f'(c) = 1/f'(g(y». I EXERCISES I Iff'(x) = 0 for all x, a < x < b, show Ihatfis constant there. 2 Use Rolle's theorem to prove that if g(x) is a polynomial and if g(a) = g'(a) = g\"(a) = g(31(a) = 0 and g(b) = 0, then there is a number c, a < C< b, with gI4l(C) = o. 3 Iff(x) is defined andf'(x) exists for each x, a < x < b, prove thatfis continuous there. 4 Iff(x) is defined andf'(x) exists for x, a < x < b, show that (a) Iff'(x) ~ 0 for a < x < b, thenfis monotonic there. (b) If f'(x) > 0 for a < x < b, then f is strictly monotonic. S Iff(x) and g(x) are functions both of which are differentiable at least three times, and each has at least 4 zeros, what can you say about the number of zeros of F(2l where F(x) = f(x)g(x)? 6 Show that any polynomial function P(x) is piecewise monotonic. 7 Prove that iff'(x)-> 0 as x i oo,lim (f(x + 1) - f(x)) = O. 8 Suppose that f is such that If(a) - f(b)1 s Mia - bl 2 for all a, bE R. Prove that f is a constant function. 9 Letf' exist and be bounded for - oc < x < oc. Prove that{is uniformly continuous on the line. 10 Let!\" exist and be negative on the interval [0, 1]. Show that if P and Q lie on the graph of f, then the line PQ is below the graph, between P and Q. II Left- and right-hand derivatives at a point X o for a function f are defined as . f(x) - f(x o) hm - ~~ ---- x T %0 X - Xo and . f(x) - f(x o) hm-----~ x! Xo X - X o 124 ADVANCED CALCULUS respectively. Show by examples that these may exist where the usual two-sided derivative does not. Can such a function be discontinuous at xo ? 12 Given fIx) = 1/(1 - e l / X ), which is defined for all x # 0, (a) Discuss the existence of f'(x) at x = 0 (see Fig. 2-7). (b) Does this conflict with Exercise 3? 13 Let f'(x) exist and be continuous for all x. Prove that f obeys a Lipschitz condition on every bounded interval. 14 Iff(x) > 0, andj\"(x) sO for x> 0, (a) Show thatf'(x) 20 for x> O. (b) Does it follow thatf(x) --+ 00 as x r oo? 15 (a) Iff(x) --+ 00 as x --+ a < 00, canf' be bounded? (b) Iff(x) roo as x roo, doesf'(x)--+ oo? (e) Iff(x) --+ 00 as x --+ a < 00, doesf'(x) --+ oo? 16 If P(x) is a polynomial such that P(O) = 1, P(2) = 3, and IP'(x) lsi for 0 s x s 2, what can you say about PIx)? (Prove it!) 17 Plot the curve given by y = f(t) = t 2, X = g(t) = t 3, where t E [-1, 1]. Show that this curve provides an example for which the geometric interpretation of Theorem 4 fails. 18 The general mean value theorem has a geometric formulation in terms of tangents to curves being parallel to chords. Is the corresponding result true for curves in space (Fig. 3-2)? 19 Let the sides of a right triangle be longer leg = B, shorter leg = b, hypotenuse = H. Let the smallest angle of the triangle be 8. Show that the old surveying estImate given by 8 = 3b/(2H + B), is accurate to within .02 (radians). (Hint: Express band B in terms of 8, and then estimate this expression.) 20 Show that for large x, arctan x :::: n/2 - 1/x and estimate the error. 21 Letf'(x) --+ A as x r 00. Prove fIx )/x --+ A. 22 (a) Use L'Hospital's rule for Exercises 2, 4, and 5 of Sec. 2.5. (b) Should you use it for Exercise 3 of Sec. 2.5? 23 Evaluate 1 - cos (x 2 ) (a) lim \"-3 -;--- x-o X Sin X (b) lim XX x I 0 sin x + cos x - eX (e) lim --------- x-o log (1 + x 2 ) 24 It is clear that lim x 1 or e-,in (xl does not exist. Wnte this as 2x + sin 2x lim ------\"'- x 1 or (2x + sin 2x )e\"n x and apply L'Hospltal's rule, reducmg your result to I . 4 cos x ~ =0 x 1 or (2x + 4 cos x + sin 2x )e'in x How do you explain this apparent contradiction? 25 Let fIx) = x 2 sin (I/x) and g(x) = sin x. Calculate Iim x _ o (f(x)/g(x)) by L'Hospital's rule. Does your result show that this limit fails to exist? (Check this by evaluating the limit in another way.) 26 Use x = g(t), Y = f(t) as parametric equations of a curve r. Construct pictures to illustrate the geometric meaning of the two cases of L'Hospital's rule. (Hint: Recall that the slope of r at t = to isf'(to)jg'(to)') 27 Letf(x) --+ ex and g(x) --+ ex as x --+ ex. (a) Show that if f(x)/g(x) --+ L, then log f(x)J1og g(x) --+ 1 where 0 < L < x. (b) Does the converse hold? (Hint: L'Hospital's rule may not be helpful.) DIFFERENTIATION 125 28 Use the examplej(x) = x 2 sin (1/x), suitably defined for x = 0, to prove thatf'(x) can exist everywhere but not be continuous. 29 Let f' exist for all x on [a, bj, and suppose that f'(a) = -I, f'(b) = 1. Prove that even if f' is not continuous, there must exist a number c, a < C < b, withf'(c) = O. 30 It is plausible that if j is differentiable and f'(x o) # 0, then j is monotonic on a neighborhood of xo ' Disprove this by a geometric analysis of the function j(x) = 2x + x 2 sin (1/x). 31 Iff, f', !\" are continuous on 1 s x < 00./> 0, and!\" < 0, show thatf' ~ O. 3.3 DERIVATIVES FOR FUNCTIONS ON Rn In elementary calculus, partial derivatives of functions of several variables were introduced merely as the ordinary derivative of the functions of one variable obtained by treating all the remaining variables in turn as constants. Thus, if w = f(x, y, z) = x 3i + xz4 , one wrote ow/ox = 3X 2y 2 + Z4, ow/oy = 2x 3y, ow/oz = 4xz 3 • In this section, we will study the vector-valued derivative of a function of several variables. This is also called the gradient off, the differential of f, and sometimes merely the (total) derivative of f We will also obtain several forms of the mean value theorem for functions of several variables, and then explore some of the properties of the vector-valued derivative. The process of differentiation is the means by which the intuitive notion of \"rate of change\" is made precise. For a function of one variable, there are only a limited variety of ways in which a change can be made: t may be either to the left of to or to the right of to' Thus, we end up with only one main concept, the derivative f'(t), and two minor variations, the left derivative and the right derivative (Exercise 11, Sec. 3.2). When we turn to a function ofseveral variables, the situation is considerably more complicated. We can move from a point Po in many different directions and, in each case, obtain a resultant change F(p) - F(po)' and it is intuitively clear that this will depend upon the direction as well as the distance IP - Po I· A convenient approach to the notion of the differential of a function starts with that of a directional derivative. In I-space, we have only two directions, left and right (or ahead and behind). In 2-space, we are apt to think of angles as the standard way to describe directions. In 3-space, and in n space for any n, it is easier to say that a direction is merely any point 13, with 1131 = 1. Such a point lies on the boundary of the unit sphere; intuitively, we think of it as the unit vector starting at the origin and ending at the point p. For example, if we wish to move away from the point Po \"in the direction 13,\" we understand that we are to proceed from Po on the line segment toward the point Po + p. In general, the ray or half line starting at Po and pointing in the direction 13 consists of all the points Po + tp, for 0 S t. Suppose now that f is a real-valued function, defined and continuous on a neighborhood of Po' Then, the rate of change off at Po in the direction 13, 126 ADVANCED CALCULUS or the directional derivative off at Po in the direction f3, is defined to be (3-6) As an illustration, letf(x, y) = x 2 + 3xy, Po = (2,0), and f3 = (1/;-2, -1/;-2). (Note that this specifies the direction - 45°.) Since Po + tf3 = (2 + t/~, - t/~), we have f(po + tf3) = (2 + t/~)2 + 3(2 + t/;-2)(-t/;-2) 2 2=4--t-t ~ Accordingly, ( 4 - ~ t - t 2 ) - 4 (Oflf)(po) = lim __ ~--,--2 _ 1-0 t 2 -fi If we hold Po the same and vary f3, the value of (Oil f)(po) neel' not remain the same. Intuitively, it is clear that reversal of the direction f3 ought to reverse the sign of the directional derivative. Indeed, If we put ..l. = - t, we have f(po- tf3) - f(po) t f(po + ..l.f3) - f(po) ..l. so that (O-flf)(Po) = -(Oflf)(po)' as conjectured. The partial derivatives of a function f of n variables are the directional derivatives that are obtained by specializing f3 to be each of the basic unit vectors (1,0,0, ... ,0), (0, 1,0, ... ,0), ... , (0,0, ... ,0, 1) in turn. There are a variety of notations in use; depending upon the circumstances, one may be more convenient than another, and the table below gives most of the more common ones. Since the case of three variables is typical, we treat thIS alone;;. A preliminary word of caution and explanation is needed. It is customary to use certain notations in mathematics, even when this can lead to confusion or misunderstandings. In particular, this is true of partial derivatives; the Then, DIFFERENTIATION 127 special usage of \"variables\" in the table (for example, W x and awjax) must be imitated with care. w =f(x, y, z) p= (1,0,0) (0,1,0) (0,0,1) Dpf = f, f2 f3 Dtf D2 f D3 f of of of ax oy oz fx fy f. ow ow ow -- - ax oy oz Wx Wy w. Of these, the alternatives in the first two rows are less likely to cause confusion; the numerical subscripts refer to the coordinate variables in order (e.g., the first coordinate) and can be used regardless of what letter is used for the corresponding coordinate. To obtain the formal definition offl = DJ, we need only take f3 = (1,0,0) in the definition of Old Thus, we have f ( ) -1' f(x + t, y, z) - f(x, y, z) I X, y, Z - 1m -----~~'----'--- ,-0 t From this, we see thatfl may be obtained by treatingf(x, y, z) as a function of x alone, with y and z held constant, and then differentiating the resulting function of one real variable in the usual fashion. For this reason, we refer to f l as the partial off with respect to the first variable. To illustrate the use of these notations, take f(x, y, z) = w = x 2y + y3 sin (Z2) aw fl(x, y, z) = ax = 2xy f 2(x, y, z) = ~;= x 2 + 3y2 sin (Z2) f 3(x, y, z) = ~:= 2iz cos (Z2) Since a partial derivative of a function of several variables is again such a function, the operation may be repeated, and if the appropriate limits exist, 128 ADVANCED CALCULUS we obtain higher partial derivatives. More generally, when p is fixed, D fJ f is again a function, and one can consider its directional derivatives, such as Da DfJ I, where rx is again a direction, possibly the same as p. In order to implement the definition of D fJ I at a point Po' it is convenient to haveIdefined on a neighborhood of Po' For this reason, we will differentiate functions mostly on open sets, and leave the consideration of differentiation at boundary points until later. Definition 1 Let I be defined and continuous on an open set D c R\". Then, I is said to be oI class C k in D if all the partial derivatives oII of order up to and including k exist and are continuous everywhere in D. The symbols C and C n are sometimes used instead of C l and C 2 • ,. . I ~ _ - ....) f \\' ( .-' /;\", \"I':' ' (- ( ,)21) J( (1/)_. -''''.,,, ,?' It. - ~(.- ~I\"(J' . = •.> . 1/ > • It is important in many situatioris~thiitthepartial de'ri~~tivesinvofved be: continuous and not merely exist. In the next chapter, we show that iff E en in the plane, the mixed derivatives II2 and f 21 must be the same. More generally, iff E ck, then any two mixed kth-order partial derivatives involving the same variables are equal; in C 4 , I xyxx = I xxxy . However, Exercise 11 gives an instance where I12 '# I2l' even though the first partial derivatives II and I 2 are continuous and all the second-order derivatives exist. There are also other differences between differentiation in one variable and in several variables. In the former case, a function must be continuous to have a derivative; in Exercise 4, an example is given of a discontinuous function for which f l andI 2 exist everywhere. However, if the partial derivatives are continuous, the function is also continuous. This follows from our next result, which is the first version of the mean value theorem for several variables. Lemma 1 Let fEe in an open ball B(po' r) about the point Po in n space. Let p E B, and set 130 ADVANCED CALCULUS theorem. If the ball B(po, r) is chosen so that its closure lies in D, then each of the functions 1;, being continuous in D, will be bounded on B, and we will have II;(p;) I ::s; M for i = 1, 2, ... , n. Accordingly, from (3-7) we will have If(p) - f(Po)1 ::s; MIL\\x11 + MIL\\x2 1+ ... + MIL\\xnl ::s; nMlp - Pol and limp_po f(p) = f(po)· I The role of a single comprehensive derivative of a function of several variables is filled by the vector-valued derivative of f, which we write as Df This is sometimes called the total derivative of f, to distinguish it from the numerical-valued partial derivatives off (Some mathematicians are beginning to write f' instead of Df, but we prefer the latter to avoid possible confusion with the one-variable case.) When f is a function of three variables, Pf is the same as the gradient off, usually written Vf Definition 2 Let f E C' in an open set S in n space. Then, the derivative off is the vector-valued function Df defined in S by (3-8) Note that Df is continuous in S, since each component function 1; IS continuous in S. To illustrate the definition, iff(x, y, z) = x 2y - y3 z2, then Df(x, y, z) = (2xy, x 2 - 3y 2z 2, -2lz) For functions of one variable Df coincides with f'. Here, the derivative has a geometric meaning, explained by the familiar diagram showing a tangent to the graph off and the statement that this line provides a good approximation to the function near the point of tangency. The corresponding analytic statement is the following: Iff is differentiable at X o and L\\x = x - xo ' then the remainder function (3-9) approaches Ofaster than L\\x, meaning explicitly that lim R(L\\x) = 0 X-Xo lL\\xl Equivalently, given 6 > 0 there is a neighborhood AI about Xo such that IRI < lL\\x l6for all x in AI. Similar statements hold for functions of several variables, and the vector- valued derivative Df, but the geometry is harder to visualize except in the special case of functions of two variables. In Fig. 3-4, we show the graph of such a function, and the tangent plane at the point P = (0, 0,f(0, 0)). Among 132 ADVANCED CALCULUS to write f(p) - f(po) = f l (p') dx + f 2(p\") dy + f 3 (p\"') dz where p', p\", p'\" are selected points on each of the three segments forming a polygonal path from Po to p. This path lies in S if p lies in a sufficiently small neighborhood of Po. Returning to (3-12), this yields (3-13 ) R = {II (p') - fl (Po)} dx + {I2(P\") - f2(PO)} dy + {l,(p\") - f 3(po)} dz Since the partial derivativesflJ2..[3 are continuous at Po, we can choose a neighborhood. t' about Po so that each of the terms in (3-13) in brackets has absolute value less than any preassigned e. This gives at once IR I ~ eIdx I + e Idy I + eIdz I ~ (3e)ldpl for any p E ,t', Small changes in this proof yield a slightly better result. Suppose that E is a compact subset of S, Since the distance from E to the boundary of S is strictly positive, we can choose a larger compact set Eo, with E c Eo c S, and 15 > 0, so that if Po E E and Ip - Po I < 15, then p E Eo. The partial derivatives I; are continuous in Eo, and therefore uniformly continuous in Eo. One is then able to show that given any e > 0, there is a radius p, depending only on e,j, and the sets E and S, such that IR I < Idp Ie for any choice of Po in E, and any p with Ip - Po I < p. This fact can be described by saying that the limit in (3-11) is \"uniformly for all Po E E.\" I (The general topic of uniform convergence will be taken up systematically in Chap. 6.) There is also a converse to Theorem 8 which serves to characterize the vector derivative Df Theorem 9 Let f be continuous on a neighborhood of Po' and suppose that there is a vector u such that (3-14 ) lim f(po + dp) =[Jpo) - u odp = ° ~p-o IdPI Then, the partial derivatives off exist at Po and u = Df(ro) For, if u = (u l, u2' ... , un), then by specializing dp to approach 0 along each of the coordinate axes in turn, one finds that uj = I;(po)· I Formula (3-14) can be taken as the basis for a general theory of differentia- tion. For example, f is said to be differentiable in an open set D if there is such a vector u corresponding to each point Po E D, and u obeys (3-14). As DIFFERENTIATlON 133 Theorem 9 shows, this will lead us back to the vector derivative Dj. This approach has advantages when we take up differentiation of general transforma- tions from n-space into m-space, and we will adopt it in Chap. 7. The approximation theorem has several immediate consequences that are very useful. The first relates the vector derivative Df to directional derivatives. Theorem 10 Iff E C in an open set S, then all its directional derivatives exist at any point PES, and Dpf(p) = f3' Df(p)· Corollary The derivative ~f at a point p is a vector that points in the direction of the maximum rate of change off at p, and whose length is the derivative off in this direction. Apply the approximation theorem with !'J.p = Af3. Then, so that f(p + Af3) - f(p) - Df(p) • Af3 = R f(p + Af3) - f(p) R -. ----y- -~- = f3 • Df(p) + A But, A = l!'J.p!, since f3 is a unit vector, and lim A_ o RIA = 0, which yields Dpf(p) = (J • Df(p)· I The corollary arises from the simple observation that as the vector f3 varies, the maximum value of f3' Df(p) will occur when the angle between f3 and Df(p) is 0, and this maximum value will then be IDf(p)l· Many of the results in the preceding section have analogs for functions of several variables. Theorem 11 Let fE C in an open set S, and suppose that f has a local maximum (minimum) at a point Po E S. Then, Df(po) = O. Thus, all the partial derivatives off vanish at PO' Suppose Po is a local maximum for f Thus, f(p) ~f(po) for all p sufficiently near Po. Accordingly, D p f(po) ~°for every choice of the direc- tion f3. Writing this as f3 • Df(po) ~°and then replacing f3 by - f3, we have (- f3) • Df(po) ~ 0, so that f3 • Df(po) = 0. This cannot hold for all direc- tions f3 unless Df (Po) = O. I Any point where Df = °is said to be a critical point for f Every local extremum of f occurs at a critical point; however, not every critical point gives an extremum, since some yield saddle points, as will be seen in Sec. 3.6. Theorem 12 Iff E C in an open set S which is also connected, and Df = 0 everywhere in S, then f is constant in S. DIFFERENTIATlON 135 3 Compute Df for each of the following functions at the given point: (a) f(x, y) = 3x2y - xl + 2 at (1,2) (h) f(u, v) = u sin (uv) at (n/4, 2) (c) f(x, y, z) = x 2yz + 3xz2 at (1,2, -1). 4 (a) Letf(x, y) = xy/(x 2 + y2), withf(O, 0) = O. Show thatfl andf2 exist everywhere, but that f is not of class C. (h) Does fhave directional derivatives at the origin? (c) Isfcontinuous at the origin? 5 Let a function f be defined in an open set D of the plane, and suppose that f l and f 2 are defined and bounded everywhere in D. Show that f is continuous in D. 6 Can you formulate and prove an analog for Rolle's theorem, for functions of two real variables? 7 Let f and 9 be of class C in a compact set S, and let f = 9 on bdy (S). Show that there must exist a point Po E S where Df(po) = Dg(po)' 8 Find the derivative of f(x, y, z) = xy2 + yz at the point (1,1,2) in the direction (2/3, - 1/3, 2/3). 9 Let f(x, y) = xy. Show that the direction of the gradient of f is always perpendicular to the level lines off 10 Show that each of the following obeys iYu/iJx 2 + iJ2U/iJy2 = 0: (a) u = eX cos y (h) u = exp (x 2 - y2) sin (2xy) II Letf(x, v) = xy(x 2 - y2)/(X 2 + y2)withf(0, 0) = O. Show thatfis continuous everywhere, that f1'f2,f12' andf21 exist everywhere, butfI2(0, 0) # f 21(0,0). 12 Find the directional derivative of F(x, y, z) = xyz at (1,2,3) in the direction from this point toward the point (3, 1, 5). 13 If F(x, y, z, w) = x 2y + XZ - 2yw 2, find the derivative of F at (1, 1, -1, 1) in the direction {3 = (4/7, -4/7. 1/7. -4/7). 14 Some economics students have been quoted as saying the following: F(x l • x 2' ... , x n ) is such that it does not change if you change only one variable, leaving the rest alone, but it does change if you make changes in two of them. What reaction would you give to such a statement? 3.4 DIFFERENTIATION OF COMPOSITE FUNCTIONS A function may often be regarded as built up by composition from a number of other functions. Hf(x, y) = xy2 + x 2, g(x, y) = y sin x, and h(x) = eX, then a function F may be defined by (3-15) F(x, y) = f(g(x, y), h(x)) = ye2x sin x + y2 sin 2 (x) The introduction of additional variable symbols sometimes helps to clarify such relations. For example, an equivalent description of (3-15) is obtained by setting w = F(x, y), and writing w = f(u, v) = uv 2 + u 2 (3-16) u = g(x, y) = y sin x v = h(x) = eX 136 ADVANCED CALCULUS Figure 3-6 These equations express w in terms of x and y indirectly through the inter- mediate variables u and v. The interdependence involved in this particular example may also be indicated schematically, as in Fig. 3-6. The main concern of this section is the theory and application of the rules for obtaining derivatives of such composite functions. The general case is postponed to Chap. 7. As an example of the so-called \"chain rules of dif- ferentiation,\" we shall here prove a special case which illustrates the method of proof. Theorem 14 Let F(t) = f(x, y), where x = g(t) and y = h(t). Here, g and h are assumed to be class C' on a neighborhood of to' and f of class C' on a neighborhood of Po = (xo , Yo) where Xo = g(to)' Yo = h(to)' Then, F is of class C' on a neighborhood of to ' and (3-17) F'(t) = fl(p)g'(t) +f2 (p)h'(t) where p = (g(t), h(t)). The differentiation formula (3-17) is more lucid if we alter the notation and write w = F(t), for (3-17) then becomes dw ow dx ow dy ~=~--+-­ dt ox dt oy dt To prove this, we must calculate F(t + M) - F(t). Set dx = g(t + M) - g(t), dy = h(t + M) - h(t). Then, F(t + M) - F(t) = f(x + dX, y + dy) - f(x, y) = f(p + dp) - f(p) = Df (p) . dp + R =f l (p) dX +f 2(p) d y + R where lim~p_o IRI/ldPI = O. Dividing by M, we have (3-18) F(t + dt) - F(t) =1 ( ) dx +1 ( ) ~1'+ ~ M I P dt 2 P M dt AsM-..O,dX/dt~g'(t)anddy/M-..h'(t).Also,sinceIdPI:-s; Idxl + Idyl, DIFFERENTIATlON 137 I~p1/I~tI is bounded and 1 ~1-J!11~pl~0 M -1~pl IMI Thus, as ~t ~ 0, (3-18) becomes (3-17). I Using this, one can easily obtain more elaborate chain rules for calculating partial derivatives of composite functions. For example let w = f(u, v) with u = 9(X, y), v = h(x, y). This defines a function F by w = F(x, y). To find the partial derivative. F 1 = ow/ax, we need the directional derivative of F along the X axis. This amounts to holding y constant and finding the derivative of the resulting function of x alone. Using the chain rule obtained in Theorem 14, we arrive at as expected; in a similar way, one finds F (x y) = ow = ow au + ow ov 2' oy au oy ov oy Note that these could also have been written F 1 =f191 +f2 h1 F 2 =f192 +f2 h2 To illustrate this, the example (3-16) yields ow - = (v 2 + 2u)(y cos x) + (2uv)(e X ) ax and ~~= (v 2 + 2u)(sin x) + (2uv)(0) The next illustration is somewhat more complicated; it also shows how the quotient notation for partial derivatives is sometimes ambiguous. Let w be related to x and y by the following equations: (3-19) w =f(x, u, v) u = (x, v, y) v = h(x, y) The corresponding diagram is shown in Fig. 3-7. We see that the dependence of w upon x is complicated by the fact that x enters in directly, and also through u and v. Each path in the diagram joining x to w corresponds to a term in the formula for ow/ax, so that we obtain (3-20) ow ow ow au ow avow au ov-=-+--+--+--- ax ax au ax ov ax au ov ax 138 ADVANCED CALCULUS Figure 3-7 (3-21 ) Since y enters in through u and u, aw aw au aw au aw au au-=--+--+--- ay au ay au ay au au ay In both of these formulas, the partial derivatives must be understood in the correct context of Eqs. (3-19) above. In (3-20), for example, the first oc- currence of \"awjax\" refers to the partial derivative of w, regarding it as \"a function of the independent variables x and y.\" (This is often indicated by writing awjax Iy to show that y is being held constant.) The second occurrence of\" awjax \", however, refers to the partial derivative of w regarded as a func- tion of the independent variables x, u, u. The use of numerical subscripts helps to remove such ambiguity. We may write (3-20) and (3-21) in the alternative forms aw a~ = II +12 91 +13 hI +12 92 hI aw ay =12 93 +13 h 2 +12 92 h 2 As another illustration of the use of chain rules, consider the following relationship: w = F(x, y, t) x = ¢(t) y=t{I(t) These express w in the form w = I(t), as shown by the diagram in Fig. 3-8 and (3-22) dw aw aw dx aw dy-=-+---+-- dt at ax dt ay dt (3.23) DIFFERENTIATlON 139 This procedure can also be used to compute higher derivatives too. For example, to find d2w/dt2, we rewrite (3-22) in the form dw dx dy -- = F3(x, 1', t) + FI(x, 1', t) - + F2(x, 1', t)- dt dt dt and then differentiate a second time, getting d2 w dx dy (dX)2 dx dy dx dtT = F33 + F31 dt + F32 dt + F 11 dt + F 12 dt dt + F I3 dt ( dY) 2 dx dy dy d2x d2l' + F 22 dt + F21 dt dt + F23 dt + F I dtT + F 2 d? Assuming that F is of class C, this may also be expressed in the form d2 w a2 w J a2 w dx a2 w dYI a2 w (dX)2 dtT = at2- + 21ax at dt + 01' at dtl + 8x 2 dt + 2 a2 w d:~dy+ a2~ (dY) 2 + ow d2 x + a_~d2 y ax 01' dt dt 01'2 dt ax dt 2 dy dt 2 Another type of problem in which the chain rules prove useful is that of finding formulas for the derivatives of functions which are defined\" implicitly.\" Consider the pair of equations j x 2 + UX + 1'2 + V = 0 lx + yu + v2 + x 2 v = 0 If we give x and l' numerical values, we obtain a pair of algebraic equations which have one or more solutions for u and v; for some choices of x and 1', these solutions will be real, so that Eqs. (3-23) serve to define one or more functions f and g such that ju = f(x, 1') lv = g(x, 1') For example, if x = 1, l' = 1, then (3.23) becomes ju+v+2 =0 1u + v2 + V + 1 = 0 which has the solutions (u,v)=(-I,-I) and (u,v)=(-3,1). General theorems, which we shall discuss later in Sec. 7.6, show that there are functions fand gdefined in a neighborhood . ~, of( 1, 1) such thatf(l, 1) = - 3, g(l, 1) = 1, and such that (3.23) holds with these substitutions for all (x, y) in •V. Knowing the function f, it would then be possible to compute au/ax = f l and find f l (1, 1) = au/ax 1(1. I)' By the use of the chain rules, it is possible to compute such partial derivatives without carrying out the often difficult task of solving explicitly for (3-24 ) 140 ADVANCED CALCULUS the functions I and g. To achieve this for the specific example above, dif- ferentiate each of the equations in (3-23) with respect to x while holding y constant. au av 2x + u + x ax + 0 + ax = 0 au av 2 av I + y - + 2v - + 2xv + x - = 0 ax ax ax Solving these for au/ax, we find au 1 - 2xv - 2uv - 2x3 - ux 2 ax 2xv + x 3 - y If we set x = 1, y = I, u = - 3, v = 1, we find the desired value aa u I = 11(1, 1) = 3 X (I. I) We can obtain a formula for the solution of a general class of such prob- lems. Suppose that one is given two equations JF(x, y, u, v) = 0 \\G(x, y, u, v) = 0 which we may regard as solvable for u and v in terms of x and y. We wish to find au/ax and av/ax. Holding y constant, differentiate (3-24) with respect to x. au av FI+F3a~+F4ax=O au av G 1 + G3 ax + G4 ax = 0 Solving these, we obtain the desired formulas IF 1 F4 / au G 1 G 4 =F 1G4 - F4 G 1 - - -~--_.~.-- ax IF3 F4 [ F3G4 - F4 G3 G3 G4 IF3 F 1 I av G3 G1 F3G 1 - F 1G3 -~- -F1= ax F3G4 -F 4 G3 G3 G4 Determinants. of this special form are common enough to have acquired a special name and notation; they are called Jacobians, and the notation is DIFFERENTIATION 141 illustrated by (3-25) o(A, B) o(s, t) oA oA os ot oB oB os ot Using this, we can write the formulas above in simpler form as (3-26) ou _ o(F, G)/O(F, G) ox - - o(x, v) 0(u,0 ov _ o(F, G)/O(F, G) a-~- - o(u, x) o(u, v) Then, of = 1 OV and To apply these to the pair of equations given in (3-23), we take F(x, y, u, v) = x 2 + UX + y2 + v G(x, y, u, v) = x + yu + v2 + x 2 v of of --- = 2x + u - = x ox ou oG -- = 1 + 2xv ox oG ---- = y ou oG -- = 2v + x 2 OV and so that OU 1 2X + u 1 I Ix 1 I ox = - 1 + 2xv 2v + x 2 -=- y 2v + x 2 2xv + 2uv + 2x 3 + ux 2 - 1 2xv + x 3 - Y OV Ix 2x + u I Ix 1 I ox = - y 1 + 2xv -=- y 2v + x 2 X + 2x 2 v - 2xy - uy 2xv + x 3 - y Further formulas of this nature will be found in the exercises. It should be pointed out that the Jacobian which occurs in the denominator of both frac- tions in (3-26) is one whose nonvanishing will be sufficient to ensure that Eqs. (3-24) really do have a solution in the form u = f(x, y), v = g(x, y) (see Sec. 7.6). A somewhat more difficult problem is the following, which is patterned after a type of situation which occurs in physical applications. A physical law or hypothesis is often formulated as a partial differential equation. If a change of variables is made, what is the corresponding form for the differential 142 ADVANCED CALCULUS equation? We first examine a simple case. Suppose the differential equation is o2ujox2- o2ujoy2 = 0, and suppose we wish to make the substitution (3-27) JX = s + t \\y = s - t By the appropriate chain rule, au au as au at ax = as ax + at a-; au au as au at -- =-- + ---- oy osoy otoy Solving (3-27), we have s= (x + y)j2 and t = (x - y)j2, so that au =au (!) + au (!) =! (_~+ ~)(u) ax as 2 at 2 2 as at and au=au (!) + ~'!(_!) =! (~__ ~)(u) oy as 2 at 2 2 as at Repeating this, and assuming that u = F(x, y) with F of class C, 02U a (au) 1(a O)(OU 1 au 1) ox2= ax ax = 2 a.~+ at as 2 + at 2 1 (a2u a2u 02U) = 4. as2 + 2 as at + atl and ::'~= ~(~-:t)(~;~- ~~~) 1 (a2u a2u 02U) = 4. as2- 2 as at +\"0(2 Subtracting these, we find that a2u a2u a2u ?Jx2- ay2 as at so that the transformed differential equation is o2ujas at = 0. A more complicated problem of the same type is that of transforming the Laplace equation c2ujox2+ a2ujcy2= ° into polar coordinates by the substitution JX = r cos {} ly = r sin {} Differentiate the first of these with respect to y, and the second with respect to x, regarding x and y as independent. (3-28) ar ae.o=--- cos e- - r sm eay ay ar. aeo= - sm e + -- r cos e ax ax DIFFERENTIATION 143 Also, x 2 + i = r2, so that 2r(ar/ax) = 2x and 2r(ar/ay) = 2y, and therefore (3-29) ar x --- = - = cos e ax r ar =.}' = sin e ay r Putting these into (3-28), we obtain (3-30) ae ax sin e r ae cos e ay r Then and Iterating these, au = au ar + au ae = cos eau _ sin eau ax ar ax ae ax ar r ae ( a sin e a) = cos ear - -r- ae u au = au ar + au ~ = sin eau + cos eau ay ar ay aeay ar r ae ( . a cos e a) = sm ea~ + -r- ae u a2u= (cos e~ _ sin ei) (cos eau _ sin eau) ax2 ar r ae ar r ae 2 a2u sin 2 ea2u 2 sin ecos e a2u = cos ecr2 + ----;:z ae2 - r ar ae 2 sin ecos eau sin 2 eau + r2 ae + -r- a~ a 2 u= (sin e~ + cos e~)(sin eau + cos e_~_~) ai ar r ae ar r ae _ . 2 e a2u cos 2 ea2u 2 sin ecos e a2u - sm ar2 + r2 ae2 + r ar ae 2 sin ecos eau cos 2 eau r2 ae + -r- ar 144 ADVANCED CALCULUS and adding, we find that a 2u a 2u a 2u 1 a 2u 1 au-+-=-+--+--ax2 ai ar2 r 2 ae2 r ar Thus, the equation a 2ujax2 + a 2ujai = 0 which governs the distribution of heat becomes in polar coordinates. Finally, let us consider a special type of change-of-variable problem. Suppose that E, T, V, and p are four physical variables which are connected by two relations, of the form (3-31 ) )4>(E, T, v, p): 0 11/1(E, T, V, p) - 0 We suppose also that these may be solved for any pair of the variables in terms of the remaining two, i.e., any pair may be selected as independent. When V and T are independent, the physical theory supplies the following differential relation between the variables (3-32) aE ap--T-+p=Oav aT (3-33 ) Suppose that we wish to shift our point of view, and regard p and T as the independent variables; what form does the physical relation (3-32) take now? To answer this, two techniques can be used. One is to assume that equations (3-31) have been solved for E and V in terms of the new independent variables p and T in the form E = I(p, T) V = g(p, T) Since the differential equation (3-32) involves aEjaV and apjaT, derivatives in which V and T were the independent variables, we obtain these from (3-33) by differentiating these two equations with respect to V and T. aE ap av =/1 av ap 1 = gl av aE ap aT = II aT +12 ap 0= gl aT + g2 Solve these for the derivatives that appear in (3-32): (3-34) (3-35) DIFFERENTIATlON 145 Substituting these into (3-32), we obtain It + T g2 + pg t = 0 and then, using (3-33) to convert this into more familiar notation, we see that the new form for the physical law (3-32) is aE av av-+T-+p-=O ap aT ap The second technique is a dual of this. In the context of (3-32), E and p were expressible in terms of V and T. E = F(V, T) P = G(V, T) Thus, the derivatives that appear in (3-32) were aE/aV = F 1 and ap/aT = G2 , and the relation (3-32) could have been written as F 1 - TG 2 + P = O. Now treat p and T as independent, and differentiate (3-35) with respect to each, obtaining a~= F av ap 1 ap av 1 = G- 1 ap aE av aT=F1aT +F 2 av 0= G t aT + G2 Solve these for F 1 and G2 and substitute the result into the relation F 1 - TG 2 + P = 0, and one again arrives at (3-34). EXERCISES I Construct schematic diagrams to show the following functional relationships, and find the indicated derivatives: (a) w = f(x, y, z), x = 1/>(1), Y = \"'(I), z = 0(1). Find dw/dl. (b) w = F(x, u, I), u = f(x, I), x = 1/>(1). Find dw/dl. (c) w = F(x, u, 1\"), U = f(x, y), 1\" = g(x, z). Find ('w/ax, ('w/i'y, and (1 W /i'Z. 2 If w = f(x, y) and y = F(x), find dw/dx and d2w/dx 2. 3 When x, y, and z are related by the equation x 2 + yz2 + y2 x + 1 = 0, find ay/ax and ayjaz when x = -1 and z = I. 4 Let x, y, u, v be related by the equations xy + x 2u = vy2, 3x - 4uy = x 2v. Find au/ax, au/ay, av/ax, av/ay first by implicit differentiation, and then by solving the equations explicitly for u and v. 5 Let F(x, y, z) = O. Assuming that this can be solved for z in terms of (x, y), find az/ax and az/ay. 6 Under the same assumptions as Exercise 5, find expressions for a2z/ax 2 and a2z/ax ay in terms of F and its derivatives. 7 Let F(x, y, z) = O. Prove that 146 ADVANCED CALCULUS 8 Let F(x, y, t) = 0 and G(x, y, t) = 0 be used to express x and y in terms of t. Find general formulas for dx/dt and dy/dt. 9 Let z = f(xy). Show that this obeys the differential relation 10 Let w = F(xz, yz). Show that aw aw aw x-~+y--=z-- ax ay az II A function f is said to be homogeneous of degree k in a neighborhood. t of the ongm if f(tx, ty) = t'f(x, y) for all points (x, y) E .Ai and all t, 0 S t s I. Assuming appropnate continuity conditions, prove that f satisfies in . i' the differential equation Xfl(X, y) + Yf2(x, y) = kf(x, y) 12 Setting z = f(x, y), Exercise 11 shows that x(az/ax) + y(azlay) = 0 wheneverfis homogeneous of degree k = O. Show that in polar coordinates this differential equation becomes simply r(az/ar) = 0, and from this deduce that the general homogeneous function of degree 0 is of the formf(x, y) = F(y/x). 13 If z = F(ax + by), then b(az/ax) - a(az/ay) = O. 14 If u = F(x - et) + G(x + et), then 2 a 2 u e 2 u e ex2 et 2 15 If z = r/>(x, y) is a solution of F(x + y + z, Ax + By) = 0, show that A(az/a.d - B(az/ex) is constant. 16 Show that the substitution x = e', y = e' converts the equation into the equation a2u/as2 + a2u/at 2 = o. 17 Show that the substitution u = x 2 - y2, V = 2xy converts the equation a2w/ax 2 + a2w/ay2 = 0 into a2w/au 2 + a2w/av 2 = o. 18 Show that if p and E are regarded as independent, the differential equation (3-32) takes the form eT av a(v, T) -T-· +p--=O ap aE a(E, p) 19 Let f be of class C in the plane, and let S be a closed and bounded set such that f1(p) = 0 andf2(p) = 0 for all pES. Show that there is a constant M such that If(p) - f(q)1 s Mlp - ql2 for all points p and q lying in S. *20 (Continuation of Exercise 19) Show that if S is the set of points on an arc given by the equations x = r/>(t), y = ljJ(t), where r/> and ljJ are of class C', then the function f is constant· valued on S. 21 Let f be a functlon of class C with fO, I) = I, flO, I) = a, and f 20, I) = b. Let r/>(x) = f(x,f(x, x)). Find r/>O) and r/>'(I). DIFFERENTIATION 147 3.5 TAYLOR'S THEOREM This important and useful result can be regarded either as a statement about the approximation of functions by polynomials, or as a generalization of the mean value theorem. Suppose that a functionJis given to us, and we wish to find a polynomial P which approximates J in a specified sense, for example, uniformly on some interval I. One familiar procedure is that of interpolation, or curve fitting. We choose points x l' x 2 ' ••• , x n on I, and determine P so that P(xJ = J(xJ, i = I, 2, ... , n. If P has degree m, then there will be m + 1 coefficients to be determined, so that in general a polynomial of degree n - 1 must be used to fit J at n points. Once P has been computed, it remains a separate problem to study the accuracy of the approximation at points x of the interval I other than the points Xi' Another method for choosing a suitable polynomial P is to select one point X o in the interval (e.g., the midpoint) and then choose P to match J very closely at the point x o' We first introduce a convenient notation. LetJE en on an interval I about x o' Among all the polynomials of degree n, there is exactly one which matches J at X o up through the nth derivative, so that (3-36) p(k)(X O) = j<k)(XO) k = 0, 1, ... , n We shall call this the Taylor polynomial of degree n at x O ' and denote it by Pxo' When n = I, PXo is the first-degree polynomial which goes through (xo,f(xo)) and has there the same slope as does J; it is therefore just the line tangent to the graph of.{, and P(x) = J(x o) + f'(xoHx - x o) When n = 2, P is a parabola which is tangent to J at (xo,f(xo)) and there has the same curvature as does f Writing P(x) = A + B(x - xo) + C(x - X O)2 and imposing conditions (3-36), we see that In general, We are concerned with the accuracy with which this polynomial approximates J at points of the interval I away from x o; therefore we study the remainder Rn(x) =J(x) - Pxo(x). Taylor's theorem expresses this remainder in terms of the function f 148 ADVANCED CALCULUS Theorem 15 (Taylor Remainder) Let f E C\" + 1 on an interval I about x = c, and let Pc(x) be the Taylor polynomial of degree n at c. Then, f(x) = Pc(x) + Rn(x),for any x E I, where the remainder Rn is given by (3-37) 1 . x R (x) = - I pn+ ll(t)(t - c)n dt n n! . c The key to the proof is to hold x fixed, and regard c as variable. Thus, consider the function g(t) = Pr(x) = f(t) + f'(t)(x - t) + j\"(t)(x - t)2/2! + ... + pn)(t)(x - t)n/n! Note that g(x) = f(x) and g(c) = Pc(x). Hence, .x Rn(x) = f(x) - PAx) = g(x) - g(c) = I g'(t) dt . c It is only necessary then to calculate g'; doing so, we find g'(t) = f'(t) -+- {f\"(t)(x - t) - f'(t)} + {f(3l(t)(x - t)2/2! - 2j\"(t)(x - t)/2!} + {f(n +ll(t)(x - t)n/n! - pnl(t)(x - t)n- l/n!} This sum \"telescopes,\" resulting in the simple result g'(t) =pn+ll(t)(x - t)\"/n !, which immediately yields (3-37). I Corollary 1 (3-38) If IPIl+ll(x)1 ~ Mfor all x E I, then on I (x - c)n+l IR (x)1 < M -----\" n - (n + I)! This useful estimate is obtained directly from (3-37), since 1 . x n 1 M(x - c)n+ 1 IR (X)I ~--I M(t - c) dt = -- --'_ .., n n!.c n! n+l There are other alternative forms for the remainder Rn(x). One of these, which depends upon applying a different estimate to the integral in (3-37), leads to the following statement of the relationship between f(x) and the Taylor polynomials at x = c which is perhaps more familiar than (3-37). Corollary 2 Iff E C\" + 1 in a neighborhood I of c, then for any x E I, (3-39) f(x) = f(c) + f'(c)(x - c) + j\"(c) ~~TY (x c)n + ... +pn)(c) ---,-- + Rn(x) n. (3-40) DIFFERENTIATION 149 where ( t+ 1 R (x) = pn+ 1)(r) x _-_C-'---c-_ n (n-t1)! and r is an appropriately chosen point between x and c. Note that if n = 0, this becomes the usual mean value theorem, discussed in Sec. 3.2. Thus, Taylor's theorem is a generalization of this. The equivalence of (3-37) and (3-40) follows from an exercise given in the next chapter (Exercise 5, Sec. 4.2), as well as from the simple argument in Exercise 8 of the present section. For the Taylor polynomial to be a good approximation to f, uniformly on an interval I, the remainder R n must be uniformly small there. The importance of the theorem lies in the fact that by having a formula for R n , we are thereby able to estimate its size. For example, let us find a polynomial which approximates eX on the interval [- 1, 1] accurately to within .005. Using (3-36) with X o = 0, we have 2 n P(x) = f(O) + f'(O)x + .f\"(0)~!+ ... +pnl(O) ~ which in our case is x 2 x n P(x) = '1 + x + -- + ... + - 2! n! The remainder, using the formula of Corollary 1, is xn+ 1 lex - P(X)I = IRn(X)1 ~ M (n + 1)! where M is the maximum of eX on [- 1, 1]. Since x also lies in [- 1, 1], this yields IR nI ~ e/(n + I)!. In order to have accuracy to within .005, we choose n = 5, and we have found a polynomial x 2 x 3 x 4 x 5 I +x+- +--+-+- 2 6 24 120 with the desired property. It is clear in this case that because of the rapid growth of the factorials n!, increasing the degree n of the Taylor polynomial will continue to improve the accuracy of the approximation on [-1, 1], or in fact, on any bounded interval. This is a special property of the exponential function which is also shared on their domains by an important class of functions. Definition 3 Afunctionfis said to be analytic at a point X o if there is an open interval I about X o on whichfis Qf class C''- and such that limn_x- Rn(x) = 0 for each x E I. 150 ADVANCED CALCULUS The functions eX, sin x, and cos x are analytic everywhere; J-x is analytic for each point X o > 0, and x/(x 2 - 1) is analytic at each point of the intervals x < - 1, - 1 < x < 1, and 1 < x. Since this property is equivalent to saying that the sequence of Taylor polynomials for f at X o converges to f in a neighborhood of xo; as we shall see in Chap. 6, this enables us to say that analytic functions are those that are sums of their Taylor series. The theory of analytic functions is a separate and highly evolved branch of analysis; a sketch of this subject is given in Appendix 5, and references to fuller treatments will be found there. There are functions of class C'\" which are not analytic, and for which the Taylor polynomials are very poor approximations. An often used example is f(x) = exp (-I/x 2). When x i' OJ is continuous and infinitely differentiable. In fact, f'(x) = 2x- 3 exp (-I/x 2), and induction shows that f(nl(x) has the form x- 3nQ(x)exp(-I/x 2), where Q is a polynomial of degree 2(n-I). Since limx_of(x) = 0, the discontinuity at the origin may be removed by setting f(O) = 0; the formula for fin) shows that it is also true that limx _ o jln)(x) = 0 for n = 1,2, .... This allows us to show thatfis also infinitely differentiable at x = 0, with jln)(o) = 0 for n = 1, 2, .... For n = 1, 1'(0) = limh _ o f(h)/h; applying L'Hospital's rule, we replace this by limh _ o f'(h), which exists and has the value O. Induction establishes the general result. The function f can be shown to be analytic for all x i' O. How- ever, it is not analytic at x = 0, even though it is infinitely differentiable there. The Taylor polynomial of degree n at 0 is 0 + Ox + Ox2/2 + ... + Oxn/n! so that Rn(x) = exp (-I/x 2 ), which does not tend to 0 as n increases, on any neighborhood ofO. For this function, then the Taylor polynomials at the origin do not converge to the function. This points up the fact that while the Taylor polynomials are easy to define, they are not always the best polynomials to use for approximating a given function. For example, on [-1, 1], the Taylor polynomial 1 + x + x 2/2 for eX approximates it with an error of .22, while the special polynomial .99 + 1.175 x + .543 x 2 approximates eX on the same interval with maximum error of only .04. The theory of approximation is currently a very active field of research, stimulated in part by the development of high-speed computers, and new methods for finding good polynomial and piecewise polynomial approximations are being discovered. Even with an apparently well-behaved function, it is not always true that increasing the degree of the Taylor polynomial will extend the interval of approximation. Letf(x) = 1/(1 + x 2 ), and construct the Taylor polynomial for fat X o = O. It is easy to see that it is exactly P(x) = 1 - x 2 + x 4 - x 6 + ... + (_I)nx 2n Moreover, by elementary algebra, we can compute the remainder exactly, DIFFERENTIATION lSI obtaining 1 x 2n + 2 R 2n(x) = 1+-;2 - P(X) = (_1)n+ I 1. + x 2 We see at once that IR2n(x)1 is very small on the open interval -1 < x < 1 if n is sufficiently large. Thus, increasing the degree of P yields a much better approximation to f on this interval. However, it is also evident that P(x) will never be a good approximation to f outside this interval, no matter how large n is chosen. Indeed, for a value such as x = 2, increasing n worsens the approximation! The explanation for this fact lies in the behavior off(x) for complex values of x, in particular the fact that it is not defined when x = j ~I for this fact influences the degree of approximation that the Taylor polynomial can achieve for real x. (This will be discussed in Chap. 6.) We now turn to functions of several variables. The first objective is an improved form of the mean value theorem, promised in the last section. Theorem 16 Let fE C in an open convex set S in n space. Then, for any points PI and P2 in S, there is a point p* lying on the segment joining them such that (3-41 ) The proof for a function of two variables exhibits the general method. If we have PI = (x, y) and P2 = (x + L1x, y + L1y), then this theorem asserts that there is a number Ie, 0 < Ie < 1, such that where p* = (x + Ie L1x, y + Ie L1y). To prove this, we construct a special function F of one variable F(t) = f(PI + t(P2 - PI)) = f(x + t L1x, y + t L1y) Applying the one-variable mean value theorem, F(I) - F(O) = (1 - O)F'(Ie) where Ie is some point between 0 and I. By the chain rules, F'(t) =f l L1x + f 2 L1y so that F'(Ie) = Df(p*)' (L1x, L1y), where p* is the point (x + Ie L1x, y + Ie L1y), which lies on the line from PI to P2' Since F(I) - F(O) = f(P2) - f(pd, we have established (3-41). [Note that the convexity of S was used only to be sure that the point p* belongs to S; all that is required for (3-41) is that the segment PIP2 lie in S.] I 152 ADVANCED CALCULUS If we apply Taylor's theorem to F, instead of merely the mean value theorem, we obtain the corresponding form of Taylor's theorem for functions of two variables. Theorem 17 Let f be of class C\" + I in a neighborhood of Po = (xo' Yo)' Then, with p = (x, y), f(p) =f(p ) + (x_-=- ~<J011 + (y -_Yo) ~I o 1 ax play o PO + (~-~?y:~L+ (x~t-oJ (L~!YQ) a~2~yL+ (~_~{O)2:~.L ... (x - X o)\" a\"f I (x - XO)\"-I (y - xo) a\"f I + + ---;;-,--- ax\" + (-n ~-c),- -11- a~;'-Iay • Po •• Po + ... + (JI_= yot a\"f I + R (x, y) n! ay\" PO \" where R (x y) = (x:.- xo)~a:_~If I + ... + (y =-l'Q)\"+_1 ~\"-+~I \" ' (n + I)! ax\"+I\". (n + I)! ay\"+1 p. and p* is a point on the line segment joining Po and p. By adopting a special notation, this can be thrown into a simpler ap- pearing form. Let ~x = x - X o and ~y = y - YO' so that ~p = (~x, ~y) = p - Po Define a differential operator V by a a V =~x- +~y- ax ay so that, for instance, Vf = ~xfl + ~yf2' Then, the Taylor expansion formula may be written as (3-42) f(po + ~p)=f(po) + ;! Vf(po) + i\\ V 2f(po) 1 1 + ... + - V\"f(p ) + ------ V\"+ If(p*) n! 0 (n + I)! For example, DIFFERENTIATION 153 This device makes it possible to state the n-variable form of Taylor's theorem without becoming overwhelmed with subscripts. Set !1p = (!1x 10 !1x2' ... , !1xn ) and define the operator U by a a a (3-43) U = !1x t ::l + !1x 2 ;- + '\" + !1xn ::l uX t uX 2 uX n so that Uf(q) = !1p' Df(q) Then, the statement of Taylor's theorem appears the same for n variables as it does for two, namely (3-42). Of course, the powers of U will be considerably more complicated when they are translated into formulas involving the higher partial derivatives off (see Exercise 17). EXERCISES I Show that sin x can be approximated by x - x 3/6 within .01 on the interval [ - I, I]' 2 Determine the accuracy of the approximation x 2 x4 cosx-I- + 2 24 on the interval [ - I, 1]. 3 Determine the accuracy of the approximation x 2 x 3 x 4 log (I + x) - x - +- - 2 3 4 on the interval [-1, n 4 Determine the accuracy of the approximation - (x-I) (X_1)2Jx - 1+---- - --.. - 2 8 on the interval [1, n 5 How many terms of the Taylor expansion for sin x about a conveniently chosen point are needed to obtain a polynomial approximation accurate to .01 on the interval [0, n]? On the interval [0, 2n]? 6 Suppose thatf(O) =f(-I) = 0,f(1) = I, andf'(O) = O. Assuming thatfis of class C 3 , show that there is a point c in [ - I, I] where f'''(c) :2: 3. 7 Assume thatfE C, that 1f\"(x)l:s M, and thatf(x)---> 0 as x roo. Prove thatf'(x)--->O as x roo. 8 Let P(x) = f(c) + f'(c)(x _ c) + f\"~C)(X=-.12 + j\"'(c)(x - ce 2! 3! be a Taylor polynomial at c of degree 3. Let g(x) = f(x) - P(x) - A(x - c)4/4! Suppose that A is chosen so that g(x) = o. Prove that there is a point r between c and x with A = f (4)(r). (Hint· Use Exercise 2, Sec. 3.2.) 9 Show that for all x :2: I, log x :s J; - I/Jx. 10 Show that for all x :2: 0, eX :2: 1x1. Can you replace 1by a larger number? II Letfobey the condition If1n)(x)l:s Bn for all x in an open interval I, and all n. Show thatf is analytic on I. 154 ADVANCED CALCULUS *12 Letfbe of class C on [0, 1] withf(O)=f(I)=O, and suppose that 1f\"(x)1 ~ A for all x, 0< x < 1. Show that 11'(1)1 ~ A/4 and that II'(x)1 ~ A/2 for 0 < x ~ l. *t3 Iff(O) = 0 and If'(x)1 ~ Mlf(x)1 for 0 ~ x ~ L, show that on that intervalf(x) == O. *t4 Say that f is locally a polynomial on - 00, ex if, given xo, there is a neighborhood. t '0 and a polynomial P(x), and on JV.o,f(x) = P(x). Prove thatfis a polynomial. t5 Sketch the graph of y = 1/(1 + x 2 ) and then, for comparison, the graph of the polynomials and t6 Sketch the graph of the function f(x) = e\", and then the graph of its Taylor polynomials and What is the contrast in behavior between this and the results in the preceding exercise? 17 Use (3-43) to obtain the coordinate form for Taylor's theorem in three variables, with a remainder of total degree 3. t8 Let fEe in an open convex set S in Rn. Show that f obeys a Lipschitz condition on any compact subset E c S. 3.6 EXTREMAL PROBLEMS Any continuous function f defined on a closed bounded set D attains a maxi- mum (and a minimum) value at some point of D Iff is of class C in D, and Po is an interior point of D at which f attains such an extremal value, then (Theorem 11, Sec. 3.3) all the first-order partial derivatives off are 0 at Po. This suggests that we single out the points in the domain of a function which have the last property. Definition 4 A critical point for a function f is a point p where The discussion in the first paragraph can be rephrased as asserting that the extremal points for the function f, which lie in the set D but do not lie on the boundary of D, are among the critical points for fin D. A critical point need not yield a local maximum or minimum value off However, since such a point is one where the directional derivative off is 0 in every direction, the point is a stationary point for the function; this is reflected in the fact that the tangent hyperplane to the graph of f will be horizontal there. Since such a point can be one where the surface rises in one direction and falls in another, as in Fig. 3-9, a critical point need not correspond to either a maximum or a minimum. Such points are often called saddle points, or minimax points. Before proceeding further, let us recall the facts about functions of one variable. A critical point is a solution of the equation f'(x) = 0, and corre- sponds to a point on the curve with equation y = f(x) at which the tangent line is horizontal. The critical point may be an extremal point forf or it may yield U1FH«FKIlA Till!' I S5 Fil:url\" 3-9 Il\"r;i;ont;ll langCnl pl,me ;It S<llldlc point. a poinl of inlleclion on the curve. As an illustmlion, suppose we wish to find the maximum value of .f(xl=4x 3 -15x 2 + IKx for x in Ihe interval 1 = [0.2]. The critical poinls for f in 1 are found to be 1 and 1. The maximum value off on t must therefore be altained either alone of lhese or on Ihe boundary of I. that is. at one of Ihe cndpoinls 0 and 2. Computing Ihe value of f at e~lch. we find flO) = O. f(2) = 8. f( I) = 7. fG) = ¥. Hencc. Ihe maximum value off on 1 is 8. and il is allained on [he boundary. (However. f has a local maximum value of 7 at I, and a local minimum value of ~7 ali.) The same lechnique may be used for funclions of scveral variables. As ;:111 illUSlnllion. consider Ihe funclion f given by f(x. y) = 4xy - 2x 2 - .\\\"4 in the square D = (all (x. .\\\") with 1.'171 :S 2.1.1'1 :s 21. The critical points for fare the simull;:lneous solutions of the equations 0= II Ix..1') = 4y - 4x o=f2(x. .r) = 4.'17 - 4.r3 and are (0.0). (I. I). and (-I, -I). The maximum value offin U musl be allained at one of these or on the nOllndary of D. We do nOI have to compute the values off on all the edges of this square; since we are looking for a maximum value. we may discard the parts of cD lying in the second and fourth quadmnts where the term xy which occurs in f(x . .1\") is negative. More- overJ( - x. - y) = fix • .r). so that/lakes the S<lme values at symmetric points in lhe first and lhird quadran IS. This reduces our work to an examination of the values of}\" on lhe line x = 2. 0 :s y :s 2. and the line .r = 2. 0 :S x :s ::!. On DIFFERENTIATION 157 where r is a point between c and c + h. Hf\"(c) < 0, thenf\"(r) < °when- ever Ihl is sufficiently small, so that f(c + h) < f(c) and f has a local maximum value at c. Conversely, iffhas a local maximum value at c, then f\"(r)h 2 :s;°for all small h. Since h2 ~ 0, and r approaches c as h -+ 0, we have f\"(c) :s; 0. I What is the corresponding statement for functions of two variables? Clearly, if Po is a critical point for f lying interior to a set D, and iff has an extremal value at Po' then this must also be extremal if we examine the values off on any curve passing through po. In particular, approaching Po along the vertical and the horizontal directions, a necessary condition that Po be a maximum point for f is that f ll (Po) :s;°and f 22 (Po) :s; 0. These conditions are not sufficient, nor are the conditions obtained by removing the equal signs (see Exercise 5). For example, the function given by f(x, y) = xy has (0,0) for a critical point and f ll (0,0) = f 22 (O, 0) = ° but (0,0) is neither a maximum point nor a minimum point. The shape of the graph of f is again like the saddle shown in Fig. 3-9. The name \"saddle point\" or \"minimax\" is given to a critical point for a function which does not yield either a local maximum or a local minimum value for the function. A simple condition which is sufficient to ensure that a critical point Po be a saddle point is that f ll (Po)fdpo) be strictly negative, since this implies that f has a local maximum at Po when Po is approached along one axis direction, and a local minimum when Po is approached along the other. A more general criterion can also be obtained. Theorem 19 Let f be of class C\" in a neighborhood of the critical point PO' and let Then, (i) fr A > 0, Po is a saddle point for f (ii) fr A < 0, Po is an extremal point for f, and is a maximum if f ll (Po) < °and a minimum iff ll (Po) > 0. (iii) If A = 0, the nature of Po is not determined by this test. In condition (ii),f22(Po) may also be used to distinguish between maxima and minima. Let us apply the test to the function given by f(x, y) = 4xy - 2x 2 - j/ which was used as an illustration prior to Theorem 18 and whose critical points are (0, 0), (1, 1), and ( - 1, - 1). We find that f ll (x, y) = -4,f12(X, y) = 4,fdx, y) = -12/, so that A = 16 - 48y 2 At (0,0), A = 16> 0, so that (0,0) is a saddle point. At (1. 1) and (-I, -I), 158 ADVANCED CALCULUS ~ = - 32 < 0, so that each is extremal. Since f ll = -4 < ° both are local maxima. The proof of the general test is based upon the following special case. Lemma 2 Let P(x, y) = Ax 2 + 2Bxy + Cy 2, and set ~ = (P 12)2 - P II P22 = B2 _ AC 4 Then, (i) If ~ > 0, then there are two lines through the orlgzn such that P(x, y) > °for all (x, y) on one, and P(x, y) < °for all (x, y) on the other, with the point (0,0) omitted. (ii) If ~ < 0, then P(x, y) never changes sign, and P(x, y) > °for all points except (0,0) if A > 0, and P(x, y) < °for all points except (0,0) if A < 0. We prove (ii) first. If ~ < 0, then AC # °so that A # 0. Write AP(x, y) = A2x 2 + 2ABxy + AC/ = (Ax + By)2 - ~/ Since ~ is negative, AP(x, y) 2 °for all (x, y), with equality only at (0,0). Thus, P(x, y) always has the same sign as the number A. To prove (i), we assume that ~ > °and compute P(B, -A) = AB2 - 2B 2A + CA 2 = -A~ P(C, -B) = AC2 - 2B2C + CB2 = -C~ Since P is homogeneous of degree 2, P(h, AY) = A 2P(x, y), it will be sufficient if we can find two points at which P has opposite signs, since the same will then hold on the entire line joining these to the origin. Let us sup- pose first that A # 0. Then, recalling that ~ is positive, P( 1, 0) = A and P(B, - A) = - A~ have opposite signs. Similarly, if C # 0, then P(O, I) and P(C, - B) have opposite signs. Finally, if A = C = 0, then P(x, y) = 2Bxy and P takes opposite signs at (1, 1) and (- 1, 1). I To apply this lemma to the proof of Theorem 19, assume that Po is a critical point for f, and write the Taylor expansion off near Po (3-44) f(po + ~p) =f(po) + t{.fll(P*)(~X)2 + 2f12(p*)(~x)(~y) + f22(p*)(~y)2} where p* is a point lying on the line segment joining Po and Po + ~p. We DIFFERENTIATION 159 shall again prove (ii) first. We note first that the expression in brackets in (3-44) has the form P(Ax, Ay), where P is the quadratic polynomial with coefficients A = fl1(P*), B = f12(P*), C = fdp*). If A < 0, then B2 _ AC < 0 whenever IApl is sufficiently small. Hence, P(Ax, Ay) has, by the lemma, the same sign as A. Th us, if fll (Po) < 0, then P(Ax, Ay) < 0 for 0< IApl < 6, and f(po + Ap) = f(p) :S-o!(po) for all P in a neighborhood of Po, with equality holding only at Po. The point Po is then an external point for f which yields a local maximum. If fl1(PO) > 0, then P(Ax, Ay) > 0, andf(p) ;::: f(po) so that Po yields a local minimum. To prove part (i), we must show that f takes values which are bigger than{(po) and smaller thanf(po), in any neighborhood of Po. Write Ap = (p cos e, p sin e). Since P is homogeneous, P(Ax, Ay) = p 2 p(cos e, sin e) Since f is of class C', we have (3-45) lim P(cos e, sin e) = fll(po)(cos e)2 + 2fI 2(PO)(cos e sin e) ~p-o + fdpo)(sin e)2 = Po(cos e, sin e) Since A> 0, the lemma implies that Po (cos 0, sin 0) takes both positive and negative values for 0 $; 0 $; 2n. In particular, we may choose e' and e\" so that Po(cos 0', sin 0') > Oand Po(cos 0\", sin e\") < O. By (3-45) these relations are also true of P, when IAp I is sufficiently small. Thus P(Ax, Ay) > 0 when Ap = (p cos e', p sin e') and 0 < p < 6, and P(Ax, Ay) < 0 when Ap = (p cos e\", p sin e\") and 0 < p < 6. Since P takes values which are both positive and negative in a neighborhood of the origin, f(p) is sometimes larger than f(po) and sometimes smaller, and Po is indeed a saddle point for f I The reader may wonder about the source of the expression A that appears in Theorem 19. There is a simple explanation which we must leave incomplete for the present. In this chapter, we have introduced the first derivative of a function f of n variables as a vector-valued function D f; however, although we have used the higher partial derivatives off, we have not introduced the second (total) derivative off, which would be the derivative of Df Derivatives of vector-valued functions are discussed in Chap. 7, where they can be regarded as matrix-valued functions. The number A in Theorem 19 is the negative of the determinant of the second derivative off In the vicinity of a critical point for a function of class C', the level curves form characteristic patterns which can also be used to determine the character of the critical point. For example, if Po is a simple maximum point forfso thatf(p) <f(po) for all p i' Po near Po' then the level lines offhave the remainmg four are extremes. The contour chan docs not have the numerical values of Ihe 1cvellines, so that it may not be evident that three are maxima and one a minimum. (The portion that is shaded in Fig. 3-14 is below level 0: the ullshadcd p'lrt is where the function is positive.) It is also instruc· tive to attempt 10 visualize the graph of the function from this contour chan. The technique can also be applied to the standard problem of obtaining the linear function which best fits a set of data, in the sense of least squares. Given II points (x I' .1\"1)' ... , (xn , .I\"n)' not all the same. we wish to find the func· tion F of the form F(x) = ax + b for which J(a, h) = 2: (FIX) - .rY = ). , , (J-46) \" \" (w.:. + b - r·)', . , is a minimum. The function J is of class C in the whole (a, b) plane and has a minimum value which is attained at some point. or points. (ao' ho) = po. Fij(un' J..J4 162 ADVANCED CALCULUS If we take the region D as a large disk, then we can rule out the boundary of D, for f(a, b) becomes arbitrarily large as (a, b) recedes from the origin. We compute the derivatives off f 1(a, b) = L 2(axj + b - })X j 1 n n = 2aL (X)2 + 2bL X j - 2L XjYj 1 1 1 f 2(a, b) =L 2(axj + b - Yj) 1 n n = 2aL X j + 2nb - 2L Yj 1 1 f 11 (a, b) = 2.2 (xl 1 f 12 (a, b) = 22: x j 1 /22(a, b) = 2n The critical points for f are the solutions of the following equations for a and b: (3-47) a.2 (Xj )2 + bL x j =L XjYj 1 1 1 a '\\ x. + nb = ')- Y' L... ) L... J 1 1 Introduce X = (i X j )/n and y = (~J'j )/n so that (.x,.n is the center of 1 1 gravity of the points (x j ' Y). The second equation in (3-47) can now be written aX + b = y, and asserts that a and b must be chosen so that F(X) = y, that is, the graph of F is a line passing through (x, y). A solution of (3-47) can be wri tten as n 1 ,~ - ) X'Y' - xy 11 L... J J 1a = ---'n 0-- _ ! ~' (xV - (x)2 n~ J b=y-ax DIFFERENTIATION 163 There is only one critical point. To check that it is a local minimum point for f, we compute n 2 n ~= (f12)2 - f ll f 22 = (2L Xj ) - (2n)(2L (X)2) 1 1 By the Schwarz inequality (Sec. 1.3), n 12L xJ = nL XJ 1 1 and equality holds only if all the x j are the same. Hence, ~ < °and our critical point (a, b) is extremal. Since f ll = 2t.xJ > 0, it is indeed a local (and hence global) minimum point for f (A different but related extremal problem is given in Exercise 17.) In a numerical problem, especially one with many variables, it may be more efficient on a high-speed computer to use a simple search technique to find the maximum (or minimum) of a function F than it is to look for critical points and use Theorem 19. One such device is called the method of steepest ascent. Suppose that we wish to maximize the function F in a region D. The procedure is to select a starting point Po' and then generate from it a sequence of points Pn which \"go uphill\" from Po and (hopefully) converge to the desired maximum point p* for F in D. The algorithm for generating Pn+ 1 from Pn is based on the fact that the gradient of F, OF(p), at a point P points in the direction of greatest increase. Choose a small positive number h, and define {Pn} by Pn+ 1 = Pn + hOF(Pn) n = 0, 1,2, .... The distance between successive points, IPn + 1 - Pn I, is determined by the size of h and also by the length of the vector OF. At a critical point, OF = 0, so the size of the successive steps will decrease as Pn approaches a critical point. The success of this ascent algorithm depends much upon the choice of a good starting point Po' and upon the\" landscape\" of the function F. The surface shown in Fig. 3-15 illustrates some of the difficulties that can be met; this is the surface whose contour lines were shown in Fig. 3-14. A new branch of applied analysis called optimization has grown out of the need to find better ways for finding the extremal values of a function. In searching for an extremal point for F on a set D, one must check both the boundary and the interior of D. Some functions, however, can be shown never to have interior extrema. For such a function F, it must then be the case that if m :$ F(p) :$ M holds on the boundary of D, it holds inside D as well. This is true for the harmonic functions; A function F of two variables is said to be harmonic in an open set D if F E Cn and if Fxx + Fyy = °everywhere in D. DIFFERENTIATION 165 For example, let us find the point (x, y, z) obeying g(x, y, z) = 2x + 3y + z - 12 = 0 for whichf(x, y, z) = 4x 2 + y2 + Z2 is minimum. We find that z = 12 - 2x - 3y so that F(x, y) = 4x 2 + y2 + (12 - 2x - 3yV The critical points of F are found from the equations 0= F1(x, y) = 8x + 2(12 - 2x - 3y)( -2) 0= F2(x, y) = 2y + 2(12 - 2x - 3y)(-3). These have only one solution, (1 6 1' in Checking, we find that F 11 = 16, F12 = 12, and F22 = 20, so that A = (12)2 - (16)(20) < 0 and this point yields a local minimum for F. Using the side condition to find z, we find that the solution to the original problem is the point (1 6 1' n If). A general approach to the solution of extremal problems with constraints, usually called the method of Lagrange multipliers, will be treated in Chap. 10. While of some theoretical interest, it has many practical limitations and is not often the most successful approach to a numerical solution. EXERCISES I What are the maxima and minima off(x) = (2x l + 6x + 21)j(x 2 + 4x + !O)? 2 (a) Does P(x) = I - x + x l j2 - x 3j3 + x4j4 have any real zeros? (b) What about Q(x) = P(x) - x 5j5 + x 6j6? 3 Find the maximum and minimum value of 2x l - 3/ - 2x for x 2 + / ~ I. 4 Find the maximum and minimum value of 2x l + yl + 2x for Xl + yl ~ I. 5 Discuss the nature of the critical points of each of the functions described by: (a) f(x, y) = x 2 - yl (b) f(x, y) = 3xy _ Xl _ yl (e) f(x, y) = 2x4 + y4 - x 2 - 2y 2 (d) f(x, y) = 4x l - 12xy + 9/ (e) f(x, y) = x4 + y4 (I) f(x, y) = x 4 _ y4 6 Sketch the level curves off for the functions given in Exercise 5, parts (a), (b), (d), and (e). 7 Givenf(x, y) = Xl - 2xy + 3y 2 - X and the square D = {(x, y), 0 ~ x ~ I, 0 ~ Y ~ 1}. Find all critical points and find the maximum and minimum on D. 8 Show that H(x, y) = Xl y4 + X4yl - 3x l / + I :2: 0 for all (x, y). 9 Let f(x, y) = (y - xl)(y - 2x 2 ). Show that the origin is a critical point for f which is a saddle point, although on any line through the origin,f has a local minimum at (0,0). 10 Given n points in space, PI' Pl ' ... , p., find the point P for which . f(P) = L IP - Pjll 1 is a minimum. II LetfE C' in the open set n and have no critical points there. Let E be the set wheref(p) = O. Show that E has no interior points. 166 ADVANCED CALCULUS 12 Find the point on the line through (1,0,0) and (0, 1,0) which is closest to the line: x = t, Y = t, Z = t. 13 Find the maximum value of x 2 + 12xy + 2y 2, among the points (x, y) for which 4x 2 + y2 = 25. 14 Give a complete discussion of the problem of finding the right circular cone of greatest lateral area which may be inscribed upside down in the cone of radius I and altitude 3. 15 Given an equilateral triangular set, what location of P in the set will yield the maximum value of the product of the distances from P to the vertices? (Hint: Use the symmetry of the triangle.) 16 In the solution of the normalized two-person game whose payoff matrix is [-~ -~ -1] one is led to the problem of finding the saddle points of the function F described by F(x l, x 2' x 3' Yl' Y2' Y3) = (XI - 2x 2 + X3)YI + (2x l - 2x 3)Y2 + (- Xl + X2)Y3 subject to the constraints Xl + x 2 + x 3 = I, YI + Y2 + Y3 = 1. Show that the saddle point is X = (!, 1, 1). Y = (~,~, ~). *17 Let (Xl' Yl) = PI' (X2' Y2) = P 2' ... , Pn be a set of points, not all the same. Find the line L which \"fits\" these points best in the sense that it minimizes 2: df, where dj is the distance from Pj to 1. [Note that this is not the same as the function f given in (3-46).] 18 Using Theorem 20, prove the following: If D is a closed bounded set, and iff and g are both harmonic in D, and if! (p) = g(p) for all p on the boundary of D, then f == g in D. 19 For a function F of one variable, show that the method of steepest ascent leads to the algorithm Xn + I = x n + hF'(xn ) If this is applied to find the maximum of F(x) = x 4 - 6x 2 + 5 for x in the interval [-I, I], show that the algorithm yields a convergent sequence {x n } if h is small, but that the method fails if h is too large and the starting point Xo is unfortunately chosen. 20 Apply the method of steepest ascent to locate the maxima of the function F(x, y) = x 3 - 3xi in the square D = {all (x, y) with Ixl s 2, lyl s 2} Examine the effect of the following three choices of initial point, Po = ( - I, 0), (1,0), (0, I), and the effect of the step size h = .1 and h = .01. *21 Let C I ~ C 2 ~ ..• ~ Cn be a fixed set of positive numbers. Maximize the linear function L(x l' x 2' ... , x n ) = 2: Cj xj in the closed set described by the inequalities 0 S xj S I,2: X j S A. CHAPTER FOUR INTEGRATION 4.1 PREVIEW In this chapter we start by discussing If j, the double integral of a function D \" of two variables over a well-behaved set in the plane. This keeps the notation within reason, enables one to look at concrete cases easily, and can be generalized to the n-variable case or contracted to the familiar one-variable form. Too much experience with the latter in elementary calculus often leaves one with misleading impressions of both the nature of integration and the role of antidifferentiation in evaluating integrals, especially in connection with multiple integrals. It is important to understand the difference between a multiple integral and an iterated integral, and how one moves from one to the other. Since not every integral can be evaluated in this manner, we give a brief treatment of certain numerical methods; more will be found in Chap. 10. Since high- dimensional integrals often seem artificial, we give several at the end of Sec. 4.3 that arise naturally in the study of urban transportation. One topic that is usually slighted in elementary calculus is the treatment of improper integrals, especially those involving several variables. We cover this in Sec. 4.5. Finally, we give a very brief discussion in Sec. 4.4 of the change-of-variables formula for multiple integrals, stating the general procedures and illustrating these with the familiar polar coordinate case. We have also chosen to present 167 168 ADVANCED CAIXUI US (as a piece of platform magic) the simple algorithm for carrying this out that is based on the algebraic manipulation of differential forms: a morc complctc cxplanation of this appears in Chap. 9. 4.2 THE DEFINITE INTEGRAL In elementary calculus. integration is oftcn equatcd to the notion of\"area under a curve\"; as a result, when the double intcgral is cncountcrcd. it is auto- matically viewed as the volume under a surface. However. this leaves one in somc difficulty with triple integrals, and even more so with higher-order integrals. One major objective of this section is to gain another viewpoint that is cxtremely useful both in applications and in mathematical theory. It is lhat thc definitc intcgral involvcs intcgrating a function lover a set D, with the realization that the rcsulting numerical value depends both anI and on D. We begin with a simple case, the definition of the Riemann integral of a continuous function! ovcr a rectangle R. By starting here. rather than with the one-variable case, we hope to overcomc the tendency 10 conncct integration too strongly with antidifTerentiation. By grid, we mean any finite set of horizontal and vertical lines which divide the rectangle R into a set of smaller reclangles. mutually disjoin I except for their edgcs. If a particular grid is denoted by N and divides R into subrcctangles R,j' as shown in Fig. 4-1. the mesh size of the grid l/(N) is the largest diamcter of the R 1J . The sides of the R1j may be unequal. It is evident Class (i) [:=J ClaSS(jj)~ FiJ:ure 4-1 INTEGRATION 169 that if d(N) is very small, the total number of subrectangles will be large, and each will have short sides. We take for granted the formula for the area A(R j ) of a rectangle. (However, see Exercise I, which asks you to justify logically a simple property of this concept.) In each R jj , choose a point Pij' and then form the associated Riemann sum: i. j Since the sum on the right is finite, S is a number which depends on all the listed variables. Intuitively, it might be interpreted in various ways; for example, if the rectangle R were a metal plate of variable density, and f(p) the density at the point P, then S would be a plausible estimate for the total mass of the plate. Definition 1 The double integral If f exists and has value v if and only R iffor any e > 0 there is a b > 0 such that IS(N, f, {Pij}) - vI < e for any choice of {Pij} and any grid N with d(N) < b. By analogy with preceding definitions, this is often written lim S(N, f, {Pij}) = If f d(N) .... O R However, as a limit operation, it differs in many essentials from those that we have discussed earlier. The system of grids is not a sequence tending toward some limit, and the number d(N) does not serve to identify the grid N. (The system of all grids is an example of what is called a \"net\" or \"directed system\" in more advanced courses, and is a generalization of the notion of sequence; we do not need the precise definition here, but refer to the article by McShane in [4] for anyone interested.) Having defined the integral, we need to know that it is valid for a wide class of functions f. Theorem 1 If f is continuous on R, then ff f exists. R In the first stages of the proof, we assume only that f is bounded on R, since this will make the proof of later theorems slightly easier. Associated with each subrectangle R jj determined by the grid N are two numbers M jj = sup f(p) pERij m jj = inf f(p) peRij 170 ADVANCED CALCULUS We set S(N) = LMijA(Rij) = upper Riemann sum ~(N)= LmijA(Ri) = lower Riemann sum It is clear that §.(N) :-::; S(N, f, {Pij}) :-::; S(N) for any choice of the points Pij' and if f is continuous, equality at either end can be obtained by proper choices. We separate the proof into several simple steps. In order to be able to compare two different grids and their upper and lower sums, we introduce the notion of a refinement of a grid. Definition 2 A grid N' is said to be a refinement of the grid N if N' is obtained by adding one or more lines to those which form N. We note that it is possible to have two grids, neither of which IS a refinement of the other. Lemma 1 If N' is a refinement of N, then §.(N) :-::; §.(N') :-::; S(N') :-::; S(N) Let us examine the effect of the refinement on a single term Mij A(Rij) of the upper sum S(N). Under the new partition scheme, Rij will be broken up into a collection of smaller rectangles r1, r2 , .•. , rm' Thus, corresponding to this single term of S(N), there will be in S(N') a block of terms M(l)A(rd + M(2)A(r2) + ... + M(m)A(rm), where M(k) is the least upper bound offin rk. Since each rk lies in Rij' M(k):-::; M ij , and m m 2: M(k)A(rk) :-::; Mij2: A(rk) = MijA(R i) 1 I Repeating this argument for each term of S(N), we find that S(N') :-::; S(N). An analogous argument shows that §.(N) :-::; §.(N'). I Every grid is a refinement of the empty grid which does not partition R at all, so that for any N, mA(R) :-::; S(N) :-::; S(N) :-::; MA(R) where m = infp E R f(p) and M = sUPp E R f(p), The set of lower sums §.(N) forms a bounded set of numbers as N ranges over all possible grids N; let s be its least upper bound. The set of all upper sums S(N) is also bounded; let S be its greatest lower bound. Lemma 2 s :-::; S and for any N, S - s :-::; S(N) - §.(N). INTEGRATION 171 This asserts that the four numbers mentioned have the relative position shown below: §IN) s s S(N) Since ~(N) is always to the left of s, and S(N) to the right of S, it is always true that S - s ~ S(N) - S.(N), regardless of the relative positions of sand S. Let N I and N 2 be any two grids, and construct a third grid N by forming the union of N 1 and N 2' N will therefore have all the lines that make up N I' and will be a refinement of N I' It will also be a refinement of N 2' Applying Lemma 1, ~(NI) < S(N) < S(N) < ~(NI) ~(N2) - - - - S(N 2) In particular, ~(NI) ~ S(N 2)' Since N 1 and N 2 were arbitrary grids, this shows that every lower sum is smaller than each upper sum, S(N 2)' Since s is the least upper bound for the set of lower sums, s ~ S(N 2)' This holds for every N 2' so that s ~ S. I Up to this point, we have not assumed that f was continuous. The numbers sand S are therefore defined for any bounded function f; they are called the lower and upper integrals off over R. Lemma 3 Iff is continuous on R, then limd(Nl!O IS(N) - ~(N)I= O. Since R is closed and bounded,! is uniformly continuous on R. Given 6, we may choose b > 0 so that If(p) -f(q)1 < 6 whenever p and q lie in Rand Ip - ql < b. Let N be any grid which partitions R with mesh diameter d(N) < b. Since Mij = f(p) and mij = f(q) for a particular choice of p and q in Rij' and since Rij has diameter less than b, we have Mij - mij < 6 for all i and j. This gives o ~ S(N) - ~(N)= .2(Mij - mi)A(R i) ~6.2 A(Rij) = 6A(R) This shows that IS(N) - ~(N)I can be made arbitrarily small merely by requiring that d(N) be small. I We now complete the proof of the theorem. Lemma 2 and Lemma 3 combined show that s = S. Call the common value v. Given 6, choose b so that S(N) - S(N) < 6 whenever N obeys d(N) < b. The closed interval [~(N),S(N)] contains v and also the value of the general Riemann sums 172 ADVANCED CALCULUS S(N, f, {Pij})' Thus IS(N, f, Pij) - vI < e whenever the grid N obeys d(N) < 6, so that rr f exists. I •• R Two questions arise naturally: (i) What happens if f is not continuous on R? (ii) How can we define the integral of a function f over a set D in the plane that is not a rectangle? It turns out that the answer to the first provides the answer to the second. Theorem 2 Let R be a closed rectangle, and let f be bounded in Rand continuous at all points of R except those in a set E of zero area. Then rr f exists. •• R This introduces a new concept, \"sets of zero area,\" so that we must digress to discuss this before giving the proof of this theorem. Historically, the concept of area preceded that of integral. Let D be any bounded set in the plane, and choose some rectangle R containing D, with its edges parallel to the coordinate axes. Any grid N on R will partition R into closed subrectangles Rij which will together cover D. We separate the rectangles R ij into three classes (see Fig. 4-1): Class (i), all the Rjj which contain only interior points of D; class (ii), all the Rjj which contain at least one boundary point of D; class (iii), all Rij which contain only exterior points of D. The union of the rectangles of class (i) is called the inner or inscribed set for D determined by the grid N, while the union of the rectangles of class (i) and class (ii) is called the outer or circumscribing set. Let S(N, D) be the total area of the outer set, and ~(N, D) the total area of the inner set. Clearly, 0 :-s; ~(N, D) :-s; S(N, D):-S; area of R. As N ranges over all possible grids, the values S(N, D) generate a bounded set which is determined solely by the set D. Let A(D) be the greatest lower bound (infimum) of this set. Similarly, the values ~(N, D) generate another bounded set, and we let ~(D) be its least upper bound (supremum). We call A(D) the outer area of D, and ~(D) the inner area of D. If they have the same value, we denote it by A(D) and call this area of D. This process defines a notion of area for certain sets D. Not all sets have an area. For example, let D be the set of points (x, y) with O:-s; x :-s; 1, o :-s; j' :-s; 1, and both x and j' rational. Since D has no interior points, class (i) is always empty, so that ~(D) = O. On the other hand, every point of the unit square is a boundary point for D, so that every circumscribing set has area 1, and A(D) = 1. Since these are not equal, the set D does not have an area. (Note that this is distinctly different from saying that a set D has zero area, for this would mean A(D) = A(D) = 0.) According to our-definition, a set D will have zero area, A(D) = 0, if and only if given I; > 0 we can cover D by a finite collection of rectangles Rk such INTEGRATION 173 that Any finite set D has zero area, as does any simple polygon. It is also easy to show (Exercise 14) that the graph of any continuous functionf(x) defined on an interval [a, b] is a set of zero area; it can also be shown that the same is true for any sufficiently smooth curve in the plane (Exercise 15). This can also be used to settle whether certain sets D are nice enough to have an area defined. (Return to Fig. 4-1.) For any choice of N, the number S(N, D) - §.(N, D) is exactly the sum of the areas of the rectangles R ij of the partition which are in class (ii). These are just the ones which form the circumscribing set for the boundary r of D. Thus, the number X(D) - ~(D) is exactly X(r), the outer area of the boundary of D. We have therefore shown that a set D is well behaved enough to have an area if and only if its boundary is a set with zero area. This can therefore be the case when the boundary is composed of polygonal curves, or more generally, piecewise smooth curves. However, an example has been constructed of a region D, bounded by a simple closed curve, which does not have an area. PROOF We now return to the proof of Theorem 2. By assumption, the set of discontinuities of f is a set E of zero area. It is therefore possible to choose a grid on R such that those subrectangles that cover E have arbitrarily small total area. Given any e > 0, we therefore assume that we have a finite union of Ro of these subrectangles with E c Ro and A(Ro) < e. The union of the rectangles not needed to cover E forms a closed set R 1 containing no points of E, and in which f is continuous. Since f is then uniformly continuous in R b we may choose 151 > 0, so that If(p) - f(q)1 < e whenever p and q lie in R 1 and Ip - ql < 151 , Take any grid N, and form the difference S(N) - §.(N) = 2: (Mij - mij)A(Rij) Divide the collection of rectangles R ij into two classes. Into class C(; 1 we put all Rij which are subsets of R 1, and into the class C(;2 we put all that remain (see Fig. 4-2). We split the expression for S(N) - S(N), in a corresponding way: If d(N) < 151' we have M ij - mij < e whenever R ij c RI' so that 174 ADVANCED CALCULUS Fil:ur~ 4-2 By assumption,f is bounded in R. so that Iffp)1 < B for all/'ER. Let R~ be the union of the rectangles in ~(,l' Then. :2 (Mij - lIIiJ)A(Rij ).:5 28 2 A(Rij) = 2BA(Ro) R;J<illl H'J\"~l The set R~ is exactly the circumscribing sci for Ro in Ihe parlilion determined by N. We can therefore choose ()2 so that A(R~I.:5 A(Ro) + I: < 21: whenever d(N) <°2, Letting I> be the smaller of iiI and (j2' we have shown that whenever N is a grid which p<lrtitions R with (J(N) < Ii, S(N) - S(N) < I;A(R) + 4Be = (48 + A(R))r.. This reestablishes Lemma 3 with our weakened hypothesis, and the theorem follows as before. I With Theorem 2, we have obtained an answer to our first question. We now use it to answer the second as well. We use a simple device to define the integml of f over D when D is not a rectangle. -Suppose thai D is any bounded set, and choose a rect<lngle R containing D. Define a new funclion F on R by (4-1) forpeD forpfD Suppose that f is continuous on the interior of D. What can be said aOOm the points at which F is continuous? F will cerl<linly be continuous at an}' interior point of D: if Po is a point not in D. then F(po) = O. and if Po is exterior to D. all the points near Po are also points where F vanishes. Thus. INTEGRATION 175 F is certainly continuous at every point p that is either interior to D or exterior to D. Hence, F is continuous off the boundary of D. If the set D is one that has an area (we shall call such sets Jordan measurable), then as seen above, bdy(D) will have zero area. By Theorem 2, ff F exists, and we \" R use this to define the integral off over D: (4-2) D R All that remains is to show that the answer does not depend on the choice of the containing rectangle R. Suppose R' is another closed rectangle containing D and F' is the corresponding function. Form R\" = R n R', which is also a closed rectangle containing D. Then, II F = II F = II F' = II F' R ROO ROO R' and we obtain the same value for If f from both Rand R'. This shows that D the definition for If f is unambiguous, and we have a satisfactory definition. 'D Suppose now that f is not continuous on D. If its discontinuities form a set E of zero area, then the function F will also be discontinuous on E, in addition to its discontinuities on the boundary of D. However, the union of two sets of zero area is again of zero area, and the preceding argument still applies. We have thus proved the following basic existence theorem for the definite integral. Theorem 3 Let D be a bounded Jordan-measurable set, and letf be bounded on D and continuous except for a set E of zero area. Then, II f D exists, as defined by (4-1) and (4-2). What we have said about the double integral is also valid for the general njold multiple integral. Because of the importance of the special case n = 1, we restate some of the treatment. A grid is now just a finite set of division points. If we impose a grid N on the closed interval I = [a, b], we obtain a partition of I into closed intervals I k = [x k ' Xk+I]' where a = Xo < XI < Xl < ... < x n = b. The general Riemann sum becomes where PkE1k and dX k = Xk+1 - x k is the length of Ik • The number d(N) is now the largest of the lengths dx k • 176 ADVANCED CALCULUS Definition 3 The integral r f of f over the interval I exists and has the • I value v if and only if lim S(N,f, {Pk}) = v d(N)-O b b Instead of r f, it is customary to write r f or r f(x) dx. Corresponding . I . a . a to Theorem 3 we have Theorem 3': Theorem 3' If f is bounded on [a, b] and iff is continuous on [a, b] except b on a set of zero length, then r f exists. • a A set on the line has zero length if it can be covered by a finite collection of intervals of arbitrarily small total length. In particular, a finite set of points has zero length. As an instance of the theorem, f 1 sin 2 (~)dx -I X exists, since the integrand is bounded and continuous except at the single point x = o. Some of the familiar properties of the definite integral are set forth in the next theorem as they would be stated for double integrals. The sets D, Dl' and D 2 are assumed to have area. Theorem 4 Let f and g be continuous and bounded on D. Then, (ii) For any constant C, ff Cf = C ff f· D D (iii) If f(p) ~ 0 for all p E D, ff f ~o. D (iv) If If Jexists and Iff f I~If Ifl· D D D (V) If D = D 1 U D2 and D 1 and D2 intersect in a set with zero area, then fff=fff+fff D INTEGRATION 177 Most of these follow directly from corresponding properties of the Riemann sums. Take a rectangle R containing D and define f and g to vanish off D. Then, the relations lead at once to (i) and (ii). For (iii), we observe that if f(p) ~ 0 for all p E D, then S(N,f, {Pij}) ~ O. In turn, (iii) leads to (iv); since If I +f and If I - f are nonnegative on D, and continuous, IID If I + II/ ~0 and ItIf I - IIDf ~O. To prove (v), we define a special function F by F(p) = {~(p) Then Iff = If F + If (f - F) = If f + If (f - F) D D D =Iff+Iff I With functions of one variable, the last property is usually stated differently. b When a ::5: b, r f is an alternative notation for I f. When a> b, we define • a la, bl b I f to mean - r .f. a • Ib, a) Thus, for functions of one variable, if f is continuous on an interval I, and a, b, c are any three points in I, then no matter how they are arranged on the interval, In this respect, the one-variable Riemann integral differs from the double or triple integral as they are usually presented. The single integral is an \"oriented\" .b integral, and in I f one speaks of integrating\" from a to b.\" In the definition • a of rr f, no notion of orientation of R occurred. We will need to add such •• R a notion later in dealing with multiple integrals and with transformations of coordinates in n-space. 178 ADVANCED CALCULUS EXERCISES Where nothing is said, assume that the sets D mentioned below have positive area and are bounded. I (a) Let R be a 3 x 5 rectangle divided as shown in Fig. 4-3, where the division points are arbitrary. Show that the sum of the areas of the subrectangles is always 15. *(b) How can you prove that this is similarly true for a general rectangle and an arbitrary subdivision? 2 Show from Definition 1 that for any rectangle R, (a) rr f = 0 iff == 0 on R. •• R (b) rr f = A(R) iff = 1 on R. (Hint: Use Exercise 1.) .' R 3 Iff IS continuous on D and m 5,f(p) 5, M for all p ED, show that mA(D) 5, JJ f 5, MA(D) D 4 If f is defined on a rectangle Rand /. r f exists, as defined above, then f is necessarily •• R bounded on R. 5 (Mean Value Theorem) Let D be compact, connected. Let f and 9 be contmuous and bounded on D, with g(p) 2: 0 for all p ED. Then, there IS a point p ED such that rr fg = f(p) rr g. \"D \"D 6 If D is open, and if f is continuous, bounded, and obeys f(p) 2: 0 for all p E D, then U f = 0 implies f(p) = 0 for all p. . , D 7 Formulate corresponding definitions br the triple integral I'rr f where D is a bounded set in ••• D 3-space. b 8 Iff is bounded and monotonic on [a, bj, show that J f exists, even if l is not continuous. 9 If DI C D2 , then A(D I ) 5, A(D 2 ), 10 Show that a finite set has zero area, II Let D be the set of all points (lin, 11m) where nand m are posItive integers. Does D have area? 12 Explain why the area of a Jordan-measurable region D IS given by A(D) = rr 1, using Theorem 3. \"D Figure 4-3 INTEGRATION 179 13 Letf E C 2,f(x) ~ 0, andj\"(x) s 0 for a s x S b. Prove that 1 .b (a + b) 2 (b - a)(f(a) + f(b)) s .1. f s (b - a)f --2- 14 Letf(x) be continuous for a s x S b. Show that the graph off has zero area. '15 Let f(t) be continuous for 0 s t s 1. Let g(t) be continuous for 0 s t s 1 with Ig'(t)1 s B. Show that the set of points (x, y) with x = f(t), y = g(t), 0 S t S I, has zero area. 16 Let f be continuous and positive on [a, bJ. Let D be the set of all points (x, y) with • b a S x S band 0 s y sf(x). Show that D has area A(D) = .1 f '17 A general subdivision K of a closed rectangle R is a collection D\\, D2 , ... , Dm of a finite number of domains Dj , each having area, which together cover R, and such that no pair have common interior points. The norm d(K) of such a subdivision is the largest of the diameters of the set D j . Let f be continuous on R. Show that for any e there is a 8 such that whenever K is a general subdivision of R, and where Pj E Dj , then l.r.r f - 5(K, f, {Pj}) 1< e R whenever d(K) < 8. 4.3 EVALUATlON OF DEFINITE INTEGRALS Several comments about notation are in order. It will be noticed that in most ,b\" ,b \" instances, we use I f and II f rather than I f(x) dx and II f(x, y) dx dy, 'a\"D 'a \"D When the second form is used, it must be recalled that the occurrence of \" x\" • b •• in I f(x) dx or of\" x\" and\" y\" in II J(x, y) dx dy is that of a dummy letter, • a \"D .b ,b and that one could equally well write J J(u) du or I J(t) dt, or a 'a ff f(u, v) du dv or ff J(s, t) ds dt. The same is true for the letter \"j\" in \"D \"D \"'. ~ aj and both\" i\" and \"j\" in \"'- ~. i 2l, While the notation (J is thus LJ=I L'.J=I 'a preferable from some points of view, it also has some disadvantages. Without ,I introducing additional notations, it is difficult to indicate I (x 3 - 4x 2 - 1) dx , 0 except in this way; again, when f is a function of several variables, and we wish to indicate the result of integration with respect 10 only one, it is h convenient to write r J(x, y) dy. No simple and usable substitute which does 180 ADVANCED CALCULUS not also have dummy letters suggests itself for these. It is also important to realize that in all of these, the letter \"d\" is irrelevant and serves merely to block off the letter which follows it from the function which is the integrand. b • b • b In place of I f(x, y) dy, we might write I f(x, y) 0 or even 0 I f(x, y) a • a • a where the presence of \" y\" in the square is to inform us that in carrying out the integration, we must regard f(x, y) as a function of the second variable alone. In the language of logic, \"x\" is free, while \"y\" is bound and \"[lJ\" serves as a quantifier. There is a reason for the conventional choice of \"dy\" in place of the suggested \"[[]\"; this will be indicated when we discuss the rule for\" change of variable\" in integration. If it is known that If f exists, then its value can often be obtained by 'D the use of special subdivision schemes. If N l' N 2' .. , is a sequence of grids such that limk _ oo d(Nk ) = 0, then the corresponding sequence of Riemann sums will converge to the value of the integral. To illustrate this, we first evaluate If xy2 dx dy, where R is the square: °:::; x :::; I, °:::; y :::; 1. Let N k be R the grid which partitions R into k2 equal squares, each of side 11k. Choosing the point Pij in R ij to be (ilk j/k), we have Since k 2: i = k(k; 1) 1 and and -( ) = ~ (k(k + 1)(k(k + 1)(2k + I)) S N k k5 2 6 If xy2 dx dy = lim S(Nk ) = i k-oo R 2 As another illustration, let us compute I' ~ dx from the definition. • 1 If we again use equal subdivisions, we arrive at the Riemann sums INTEGRATION lSI However, it is not easy to compute limn _ ac S(NJ Instead, we use a different type of subdivision with unequal intervals. Choose r = 2 1/n > 1 and let N n be the grid with division points 1 = rO < r < r2 < '\" < rn- 1 < rn= 2 The longest of the intervals determined by this grid is the last, so that d(Nn) = 2 - rn- 1 = 2(1 - l/r). Since limn_ ac r = limn_ ac 2 1/n = I, lim d(Nn ) = 0, and S(Nn ) =.;;. (r - 1) + P (r2 - r) + ... + ft (rn- r\"-I) = .;;. (r - 1)(1 + r.,fi- + [r';;']2 + ... + [r .,fi-]n- 1) r3n/2 - 1 = jr (r - 1) ---C3~/2~­ r -I M r:. r-l = (2y 2 - l)y r ~r3=/2;-_-1 so that .2 ;: _ M r.. r - 1 (4J2 - 2)I y x dx = lim S(N n ) = (2y 2 - 1) lim yr 3/2 _ = -'------'----'- . 1 n _ ac r- 1 r 1 3 If this direct method were the only available procedure for computing the value of an integral, only the simplest of integrands could be used. We next prove the fundamental theorem of integral calculm, which justifies the process of evaluating the integral of a function of one variable by means of antidifferentiation. Definition 4 A function F is an antiderivative (or primitive or indefinite integral) off on an interval I if F'(x) = f(x)for all x E I. Theorem 5 If f is continuous on the interval I = [a, b], then f has an antiderivative on I. Define a function F0 on I by for a ::; x ::; b If x and x + h both lie in I, then x+h x Fo(x+h)-Fo(x)=I f-I f a a = (+h f = f(x)h 182 ADVANCED CALCULUS where we use the mean value theorem for integrals (Exercise 5, Sec. 4.2) and x lies between x and x + h. Divide by h, and let h approach 0; since x must then approach x, and sincefis continuous, we find Fo(x) = f(x),and F° is an antiderivative off (When x is an endpoint of I, the argument shows the appropriate one-sided derivative of F°has the correct value.) I Some discontinuous functions have antiderivatives and some do not. When a function, continuous or not, has one, it has an infinite number, all differing by constan ts. Theorem 6 If F I and F2 are both antiderivatives of the same function f on an interval I, then F I - F2 is constant on I. For, (FI - F2Y= F'I - F~ =f - f = 0 on I, and Exercise 1, Sec. 3.2, applies. I Theorem 7 Iff is continuous on [a, bland F is any antiderivative off, then • b I f = F(b) - F(a) • Q Let F° be the particular antiderivative off which was constructed in Theorem 5. By Theorem 6, we may write F = Fo + C. Referring back to the definition of Fo' we have Fo(a) = O. so that C = F(a). Then, • b J f = Fo(b) = F(b) - C = F(b) - F(a) I Q One consequence of this is the familiar procedure for\" change of variable\" in integration. Theorem 8 Let </J' exist and be continuous on the interml [a, fJl with </J(a) = a and </J(fJ) = b. Letf be continuous at all points </J(u)for a ~ u ~ fJ. Theil, • b • P I f(x) dx = I f(</J(u))</J'(u) du • a . :.r: The rule may also be stated: To make the substitution x = </J(u) in .b an integral I f(x) dx, replacef(x) byf(</J(u)). replace dx by </J'(u) duo and 'Q replace the limits a and b by II values which correspond to them. It might seem that this is obviously true, since if x = </J(u). dx dx = -~ du = </J'(u) du du INTEGRATION 183 However, we are misled by a matter of notation. Using the alternative square notation, the theorem asserts that .b .P I j(x) 0 = I j(¢(u))¢'(u)@J • a • :I and the rule requires us to replace 0 by ¢'(u) ~; analogously, the differentiation rule dyjdx = dyjds dsjdx is not proved by canceling the two occurrences of .. ds\". It is a virtue of the notation used in differentiation and integration that such formalism is consistent with the truth, and serves as a guide in the correct application of theorems. To give a valid proof of the theorem, let F' = j and define G on [(X, P] by G(u) = F(¢(u)). Then, G'(u) = F'(¢(u))¢'(u) = j(¢(u))¢'(u), so that • P . P • P I j(¢(u))¢'(u) du = I G'(u) du = I G' o l • :x • ::r: = G(P) - G((X) = F(¢(P)) - F(¢((X)) .b =F(b)-F(a)= I j I • a For fixed a and b, there may be a number of possible choices of (X and p; any of these may be used if ¢ is continuous and differentiable on the entire interval [(X, Pl For example, with x = u2 = ¢(u), we have .4 .2 .2 -2 I j(x) dx = I j(u 2 )2u du = I j(u 2 )2u du = I I(u 2 )2u du . 1 . 1 . - 1 . 1 This requires care in its use, as may be seen from the special choices j(x) = x andj(x) = .j~. The following examples should be studied carefully. The first contains an incorrect application of Theorem 7, and the second an incorrect application of Theorem 8. .2 (i) To compute I x - 2 dx, we observe that an antiderivative is - X-I, so that '-2 2 ;2 f x - 2 dx = - X-I I = - (-n = HJ = - 1 . - 2 - 2 .1 (ii) Let C = I [sin l/xV dx. Since the integrand is bounded and continuous • -1 on [ - I, I] except at the point x = 0, the integral exists. Moreover, since the integrand is never negative, C > O. Put u = I!x so that((x) becomes (sinu)2 anddx= -u- 2 du.Whenx= I,u= l,andwhenx= -1,u=-1. Thus, 184 ADVANCED CALCULUS I·1 .1 fSin uj2 C = . (sin U)2( _u- 2) du = - .I -- du -1 -1 u The integrand in this integral is continuous on [- 1, 1] since the dis- continuity at u = 0 is removable; thus, the new integral exists, and is negative! [In each of these examples, you should make sure that you understand the nature of the error involved, before reading further.] We now take up the evaluation of multiple integrals. It is first important to understand the distinction between a multiple integral and an iterated integral. Here is an example of the latter. 3 x 2 3y r dx r dy r (4x + yz) dz • 0 • 1 • x- y This can be calculated using only elementary calculus, by starting with the inside integral and using antiderivatives and Theorem 7. Thus, the first step is to write 3y 1 /3 Y f (4x + yz) dz = 4xz + - yz2 'x-y 2 X-y 9 I = 12xy + - y3 - 4x(x - y) - - y(x - y)l 2 2 This is then the integrand for the next integration, which will be done \"with respect to y,\" and so on. The standard evaluation process for multiple integrals replaces a multiple integral by one of a number of different iterated integrals. Theorem 9 Let R be the rectangle described by a :-:; x :-:; b, c :-:; y :-:; d, and let f be continuous on R. Then b d If f = J dx J c f(x, y)dy R a For fixed x,f(x, y) is continuous in y, so that we may write .d F(x) = I f(x, y) dy • c b The theorem asserts that J F exists and is If f We shall prove this by a R showing that anyone-dimensional Riemann sum computed for a partition of the interval [a, b] and the function F, has the same value as a special two-dimensional Riemann sum for Rand f. 186 ADVANCED CALCULUS in R, and m-I F(p;) = L f(Pi) .1Yj j=O Returning to the original one-dimensional Riemann sum for F, n-I m-I S(N, F, {Pi}) = L lL f(P ij) .1Yj} .1xi i=O j=O n-I m-I = L L f(Pi) .1xi .1Yj i=O j=O The vertical lines x = Xi' i = 0, 1, ... , n, and the horizontal lines Y = Yj' j = 0, 1, ... , m, define a grid N* which partitions R into rectangles Rij in such a fashion that Pij E Rij and A(Rij) = .1xi .1Yj; moreover, since .1xi :::;: 15 and .1Yj :::;: 15, d(N*) < 215 = 2d(N). We have therefore shown that corre- sponding to any grid N which partitions [a, b] we can find a grid N* which partitions R such that S(N, F, {pJ) = S(N*, f, {Pij}) Since JfRf exists, the two-dimensional Riemann sums converge and (F exists and is equal to rr f I •• R We remark that in this proof, we could have obtained the existence of b r F at the outset from the easily proven fact that F is continuous (see • a Exercise 18). However, if we extend the theorem to functions f which may have discontinuities in R, then F may be discontinuous. In fact, iff is bounded and continuous on R except at points of a set E of zero area, it may happen .d that for individual values of X, I f(x, y) dy does not exist, and the set of X • c for which this is true can fail to be a set of zero length. One special case can be treated easily. Theorem 10 Let f be bounded in a closed rectangle R and continuous there except on a set E of zero area. Suppose there exists a k such that no vertical line meets E in more than k points. Then, b d fJf= r dx r f(x,y)dy • a • c R The proof of this requires only slight modifications from that for INTEGRATION 187 Theorem 9. As before, we consider F defined on [a, b] by .d F(x) = I f(x, y) dy • c Since f(x, y) is continuous in y in [c, d] except for at most k points, and since f is bounded, this integral exists and F is defined. Again take a n- 1 general one-dimensional Riemann sum S(N, F, {p;}) = 2:i= F(p;) Llxi and choose division points Yj on [c, d]. These determine a grid N* which partitions R into rectangles Rij' Let Ro be the union of those which contain points of E, and let R 1 be the union of the remaining rectangles. We may again write m-l F(p;) = (\"f(pj, y) dy = 2: r i + 1 f(Pi' y) dy Yo j=o Yi Since f(Pi' y) is continuous as a function of y in all but k of the intervals [Vj' Yj+ d, we may apply the mean value theorem as before, and replace these by terms of the formf(piJ LlYj' For the remaining k terms, we have bounds of the form B LlYj' where B is an upper bound for If I in R. Adding these estimates for F(Pi) Llxi, we arrive at (4-3) !S(N, F, {pJ) - 2 f(Pij)A(R i) Is B 2 A(Rij) RijcRl RijcRO Since Ro is a circumscribing set for E and E has zero area, the right side of (4-3) can be made arbitrarily small by requiring that d(N*) be small; the Riemann sum S(N, F, {pJ) will converge to the integral of F, and the sum 2: f(Pij)A(Rij) will converge to the integral offon R, and we have shown that b fff=f F(x)dx .~ • a which is the desired result. I A standard special case of this is when we wish to evaluate ff f, where •• D D is the set described by a s x s b, <jJ(x) s Y s t{J(x), where <jJ and t{J are continuous on [a, b]. If the function f is continuous on D and we extend it to a rectangle R containing D so as to be 0 off D, the set E of discontinuities of f will be the graphs of <jJ and t{J, and A(E) = O. Moreover, vertical lines cut E twice, so k = 2. Hence we have: Corollary If D is the region bounded by the lines x = a, x = b, and the graphs of <jJ and t{J, with <jJ(x) s t{J(x), and iff is continuous on D, and <jJ and t{J INTEGRATION 189 integral can be reduced to the computation of a number of such iterated integrals. As an example, consider the region D bounded by the line y = -1, and the curves x = sin (ny) and y = (x + 1)2(?2x + 1) = C(x) (see Fig. 4-5). To evaluate ff f, it is convenient to split D into four regions 'D as shown, so that fff=fff+fff+fff+fff D where we have -1 C(x) fff= L 3 dx L 1 f(x,y)dy Dl o sin (lty) ff f = f dy f f(x, y) dx -1 -1 D2 o C(x) ff f = L/xf o f(x, y) dy D3 1 sin (lty) If f = f/ y f o f(x, y) dx D4 The last two could be combined and written as 1 sin (lty) If f = f dy f f(x, y) dx o . A(Yl D3 UD4 where x = A(Y) is the particular solution of the cubic equation y = C(x) valid for -1 :-:; x :-:; O. We can also use the relation between double integrals and iterated integrals to prove the equality of mixed partial derivatives, promised in Sec. 3.3. The case off xy and f yx is typical. Theorem 11 Let f be of class e\" in a rectangle R with vertices p 1 = (a1' bd, Q1 = (a2' bd, P2 = (a2' b2), Q2 = (a 1, b2), where a1 :-:; a2 and b1 :-:; b2. Then, 190 ADVANCED CALCULUS Writing the double integral as an iterated integral, we have = ff(X, b2)]x:a 2 - ff(X, b1)]x:a 2 x-at x-a! = f(a 2, b2) - f(a l, b2) - [f(a 2, bl ) - f(a l, bl)] = f(P I) - f(QI) + f(P 2) - f(Q2) I Corollary If a function f is of class C\" in an open set D, then f12 = f21 throughout D. If R is any rectangle lying in D, then the line of argument in the theorem shows that ff fl2 and ff f21 are both equal to f(P 1 ) - f(Qd + f(P 2) R R - f(Q2)' where PI> QI> P2, Q2 are the vertices of R, in counterclockwise order. Thus, ff U12 - f2d = 0 for every choice of R, and the integrand R must be identically 0 in D. I Although iterated integrals having a form like (4-4) thus appear in the course of evaluating double integrals, they often arise in other ways (e.g., estimations of a probability), and sometimes do not correspond immediately to a multiple integral. For example, (4-5) 2 x 2 -1 V = f dx f f(x, y) dy o I has the same general form as (4-4), and might seem to be the iterated integral arising from the double integral off over a region D bounded by the curves y = 1, y = x 2 - 1, x = 0, x = 2. The corresponding picture (Fig. 4-6) suggests that this may not be so, since we have several regions. Moreover, we note that the upper limit of the inside integral is not always larger than the lower limit, as it should be if this iterated integral had the form (4-4). Such an iterated integral, therefore, does not correspond to a double integral. However, it can be written as the difference of two double integrals. 192 ADVANCED CALCUI-US Figurt 4-7 which suggesls Ihat the region A should be regarded as negative. ralher than positive as is the case with B. Why have we discussed the conversion of iterated integrals into combina- tions of double ilHegrals? Consider the following. (4-8) . 3 ,l V = I (Ix I t,xlr dy . I ')( We cannot carry out the first step in evaluating this. since we cannot find the function whose derivative, with respect to y. is eJ</r. (This is one of an infinite number of simple functions whose indefinite integral cannot be expressed in terms of any of the familiar functions.) Note. however, that we COIi/tl integrate it with respect to x. If we could con vcr! (4-8) into one or more double integrals. and then write Ihese as iterated integrals in the opposite order of integral ion, with tl)! outside and dx inside. we could at least carry out the first integration step. If we apply the procedure we have outlined above, we find that (4-8) can be expressed as the difference of two double integrals over triangular regions, and writing each as an iterated integral, we arrive at ,2 . J' , 3 .3 V = I (Iy I e* dx - I dy I ~I)'(Ix • I • 1 • 2 • )' which, in lhe usual way, leads to , ., V = 4e - r )Ie l \" (Iy - I )'e 31)' dy • 1 • 2 and the remaining integrals can be done numerically. The technique of reversal of order of integration. in itcrated intcgrals, is a very useful one. INTEGRATION 193 As another illustration, we have the useful formula (4-9) .b • x .b b I dx I f(x, y) dy = I dy r f(x, y) dx • a • a • a • y which follows at once from the observation that both sides reduce to the double integral off over the triangle with vertices (a, a), (b, a), (b, b). The following is a special application of this which is often used. Consider the n-fold iterated integral The last two inner integrals have the form X n - 2 X n - 1 J dXn_ 1 J f(x n) dXn o 0 to which the relation (4-9) may be applied, obtaining X n-2 Xn-l .X n - 2 r dXn r f(x n) dXn_ 1 = I f(x n)(xn- 2 - x n) dXn • 0 • X n • 0 We have thus reduced the original integral to an (n - I)-fold iterated integral. Repeating this process, (\"-3dxn _2 (n-2f (xn )(xn _ 2 - xJ dXn • 0 • 0 becomes X n - 3 rXn - 3 J Xn - 3 (x _X)2J o dXn ' xn f(Xn)(xn-2-xn)dxn-2= 0 f(x n) n-321 n dXn and the original integral can finally be reduced to the single integral b (b _ x )n- 1 J/(xn) (n _ n1)! dXn As a final illustration of this technique, let us prove a theorem dealing with differentiation of a function defined by means of an integral. As we have mentioned, if f(x, y) is continuous for a ::::;; x ::::;; b, and c ::::;; y ::::;; d, then (4-10) d F(x) = J f(x, y) dy c is continuous for x in [a, b] (Exercise 18), It is reasonable to suppose that iff is differentiable as a function of x alone, with y fixed, so that the partial derivative f ( ) - of _ I' f(x + h, y) - f(x, y) I x, Y -::l - 1m h uX h-O 194 ADVANCED CALCULUS exists for each x in [a, b] and y in [c, d], then we may differentiate (4-10) under the integral sign, obtaining (4-11 ) d of .d F'(x) =J a~dy =.1 f 1(x, y) dy c c We justify this under the hypothesis that f 1 is continuous. Theorem 12 Let f and f 1 be defined and continuous for x E [a, b], y E [c, d], and F defined by (4-10). Then, F'(x) exists on the interval [a, b] and is given by (4-11). d Sincefl is continuous, Exercise 18 shows that <jJ(x) = Jfl(X, y) dy is c continuous for x E [a, b]' Take any Xo and consider Xo Xo d r <jJ = r dx f fl (x, y) dy • a • a C Reverse the order of integration, obtaining Xo .d .Xo d Xo of f <jJ =.1 dy.l 11(x, y) dx =J dy J ax dx a cae a d = f [f(x o , y) - f(a, y)] dy = F(x o} - F(a) c This shows that F is an antiderivative for <jJ, so that F' exists and is <jJ. I For example, if F(x) = r1 sin (xy) dy '0 y then F,() r1 () d sin (xy) 11 sin xx = cos xy y = =-- • 0 x 0 x This technique is sometimes useful in the evaluation of special types of definite integrals. For example, let us show that for x > 0, 7</2 F(x) = flog (sin 2 e+ x 2 cos 2 e) de o x + 1= 1t log --- 2 SO that Differentiating the integral which defines F, we have .n/2 2x cos 2 e F'(x) = .I 0 sin 2 e + x 2 cos2 ede F'(x)(x 2 -1) fn/2 (x2 -I)cos 2 e .---'--'------'--'--= de 2x 0 sin 2 e + x 2 cos 2 e INTEGRATION 195 Now = fn/2 x 2 cos 2 e + sin 2 ~-=_! de o sin 2 e+ x 2 cos 2 e n r~2 de = 2 - . 0 sin 2 e+ x 2 cos 2 (J ,. de I' sec 2 e de . sin 2 e + x 2 cos 2 e =. tan 2 e + x 2 = X-I arctan [x- l tan e] SO that for x > 0 and x \"# I, , 2x In n}F(x)=-~ --- x 2 - 1 2 2x n x + 1 We have established this for all x > 0 except x = 1. When x = I, we have n/2 directly F'(I) = 2f cos2 e de = n12, or we may argue that F' is continuous, o so that F'(l) = limx _ l F'(x) = n12. Integrating F', we have F(x) = n log (x + I) + C. To determine C, we observe that so that n/2 F(I)=f 10g(l)de=O o x + 1 C = -n log 2, and F(x) = n log -2- At times, a more complicated rule for differentiating a function defined by an integral is needed. Consider the function given by (4-12) P(x) F(x) = f f(x, y) dy .(x) To find F'(x), we use the chain rule; let G be the function of three variables v G(x, u, v) = r f(x, y) dy • u 196 ADVANCED CALCULUS We can compute the partial derivatives of G, using the fundamental theorem of calculus for a/au and a/av. v G1(x, u, v) = r f 1(x, y) dy • u G2 (x, u, v) = -f(x, u) G3 (x, u, v) = f(x, v) Then, since F(x) in (4-12) is G(x, a(x), {3(x)), the chain rule of differentiation gives (4-13 ) PIx) F'(x) = {3'(x)f(x, {3(x)) - a'(x)f(x, a(x)) + f f 1(x, y) dy a(x) then For example, if F(x) = (' sin (xu) du • x2 U sin (xeX) sin (x 3 ) • ex F'(x) = eX - 2x 2 + I cos (xu) du ~ X. x 2 = (1 + X-i) sin (xeX) - 3x- 1 sin (x 3 ) In many cases, both with single and with multiple integrals, the best and most efficient procedure is to apply some method of approximate integration. Such an approach is forced on one if the indefinite integration steps are impossible, and may even be appropriate otherwise if the final step in getting an \"exact\" answer uses the approximate tabulated values of standard functions. One simple scheme for a double integral is to construct a convenient grid covering the region D, then compute the Riemann sums S(N) and ~(N) for f The exact value of rr f must then lie between these numbers, and •• D their difference is a measure of the accuracy of the approximation. Any other Riemann sum\"' .. f(Pij)A(Rij) may also be used as an approximation. InL,.J practice, a number of simple formulas are commonly used in the approximate b evaluation of single integrals. The general Riemann sum for r f can be put • a . \",;,n-1 IOto the form L.. 0 Ii ~x;, where ~Xi = Xi + 1 - Xi and where;; = f (p;) is the value off at some point of the interval [Xi' Xi + 1]. By the intermediate value theorem, if/is continuous on such an interval and A and B are values of f there, then every number between A and B, and in particular (A + B)/2, is a value of f More generally, if Ai' A 2 , ... , Ar are INTEGRATION 197 values of f on an interval, so is clA I + ... + crAr, where cj ~ 0 and L cj = 1. (This is merely a general weighted average of the numbers Ai\") Two special cases of this lead to the trapezoidal rule and Simpson's rule. For the first, we take J; = [f(xJ + f(X i + I)]j2, and for the latter, we take /; = [f(x;) + 4f(x) +f(x i + d]/6, where x is the midpoint x = (Xi + Xi+ d/2. The reason behind the second choice lies in the result of Exercise 26, which shows that Simpson's rule is exact whenever f is a polynomial of degree at most 3; application of the formula therefore amounts to approximating f on each of the intervals [xi' X i + l ] by such a polynomial, chosen to fitfat the end- points and the midpoint. Other methods for estimating the value of an integral will be found in the exercises. b For single integrals, a good way to approximate the value of r fwherefis • a a function that does not have an elementary indefinite integral is to approximate f by another function which can be integrated easily. Polynomials are the simplest choice here, and Taylor's theorem is helpful. Consider I C = r jXe'/x dx • 0 Instead of applying the expansion process to the integrand directly, we first recall that X 2 x 3 x 4 X S e X -l+x+-+-+-+- 2 6 24 120 within .005 on [-1, 1]' On [0, 1], we may write jXeolx _ jX r1 + X I / 2 + ... + X S / 2j l 120 X3 _ X I / 2 + X + ... + - 120 also good to .005. Making this replacement in the integral, 1 ( X3/2 x3 ) C - f X I / 2 + X + - + ... + - dx = 1.436210 o 2 120 I While we can be sure that this answer has at most an error off (.005) dx = .005, o in fact the estimate we have obtained is far better than that. If one makes the substitution u = jX, the integral becomes 1 /1C = r 2u 2e\" du = (4 - 4u + 2u 2 )e\" • 0 0 = 1.436 563 66 More about numerical integration will be found in Chap. 10. (4-14) 198 ADVANCED CALCULUS Iterated integrals involving many integrations often arise in very natural problems. Consider first the following question. Let 11 = [a, b] and 12 = [c, d] be two disjoint intervals on the line. Choose a point in each, say Pi E Ii' We ask: What is the expected distance between PI and P2' in the sense of probability theory? If we let x be the coordinate for PI and y that for P2' and let L i be the length of I;, then the distance between the points is Iy-xl=f(x,y), and the problem is answered by asking for the value of the double integral V = L 1 1 L 2 If f R where R is the rectangle 11 x 12 with vertices (a, c), (b, c), (a, d), (b, d). In this case, V can be calculated with ease, and the answer turns out to be the distance between the midpoints of the two intervals (Exercise 30). [This is not the answer if the intervals overlap!] Suppose we now consider the corresponding problem for variable points in the plane. Consider two disjoint sets D1 and D2 and Pi E Dp and again ask for the expected value of the distance Ipl - P21. Following the pattern above, let Pi = (Xi' y;), and f(x l' Yl' x 2' Y2) = Ipl - P21 = J(x 1 - X2)2 + (Yl - Y2)2 Then, the desired answer is (4-15) where S is the set D 1 x D 2 in 4 space. For illustration, let D 1 be the square with opposite vertices at (0, 0) and (1, 1), and let D 2 be the square with vertices at (1,0) and (2, 1). Then, 1 1 2 1 V = f dX 1 f dYI f dX2 f f(x 1, Yl' x 2' Y2) dY2 • 0 • 0 • 1 • 0 This is a challenge to carry out, and it is therefore more suitable as a candidate for numerical integration in the form (4-15). EXERCISES 2 I Calculate f .;r;, dx From the definition of the integral. (Hint: Use a method similar to that of I the text For ;-;'.) 2 IF possible, give an explicit Formula For a Function F such that For all x, (a) F'(x) = x + Ix - II (b) log F'(x) = 2x + If' l x O<x<l 3 Let f(x) = x - I 1 < x S 2 o 2<xs3 INTEGRATION 199 x (a) What is F(x) = I' f on [0, 3)? , 0 (b) Is F continuous? (c) Is F(x) = f(x)? 4 Explain the errors in illustrative examples (i) and (ii) on page 183. 5 Let F be defined by ,x (U2+ I) du F(x) = 1 exp ---- , I U U Show that F(I/x) = -F(x). 6 Let f be continuous on [0, 1], and suppose that for all x, °< x < I, x I I' f =,' f • 0 • x Can you determine f? *7 Find all continuous functions f such that for all x :2: ° x (f(x)j2 = I' f '0 8 Evaluate the double integral 1'1' x 2y dx dy when D is the region bounded by (a) the line \" D Y = x and the parabola y = x 2; (b) the line y = x - 2 and the parabola x = 4 _ y2, 9 Express the following iterated integral as a double integral, and then as an iterated integral with the order of integrations reversed, 2 x I dx I f(x, y) dy I 0 10 Show that reversing the order of integration in the integral (4-5) yields 3 2 1 Jy+l I dyJ _f dx - I dy I f dx 1 Jy+ I - 1 0 II H the order of integration is reversed in 1 x+ 1 I o dx t, fly) dy I 2 the sum of two integrals of the form I dy [ ] +I dy [ ] is obtained, Fill in the blanks [ ]. o I 12 H D is a pyramid with vertices (1,0,0), (0, 1,0), (0,0, I), (0,0,0), find HI (xy + z) dx dy dz D 13 Express the following iterated integral as a triple integral, and then rewrite it in several other orders of integration as iterated integrals, 2 2-x/2 2 I o dx II dyJx f(x, y, z) dz 14 Evaluate the preceding integral with f (x, y, z) = x + yz, 15 The line y = x divides the unit square with opposite vertices at (0, 0), (I, I) into two triangular 200 ADVANCED CALCULUS sets. On which set can the function f(x, y) = yjx be integrated? Find the value of the integral over that triangle. 16 Evaluate: ,I ,I (a) I dy leY/x dx • 0 . Y 2 2 (b) r dx r yeXY dy . 1 . l/x 17 Reverse the order of integration in the following iterated integral, and compute its value. 8 (x+6)j7 r dx r xy dy . - 6 • xl. J 18 Letf(x, y) be defined and continuous for a <::; x <::; b, C <::; Y <::; d. Let d F(x) = .1', f(x, y) dy Prove that F is continuous on [a, b]. 19 Prove the following formula for\" reversal of order of addition\" in finite sums: i=r j=r j=,. i = j and compare with (4-9). Hint: Try this first with numerical values for rand n. 20 Letf(x) be continuous for all x. 1 I-x (a) Find the value of ,. dx I' f(t) dt. . 0 • x (b) Can you explain the answer you obtain? 21 By choosing an appropriate grid and computing S(N) and §.(N), estimate the value of I I' dxj(l + x 3 ) to within ,05. Compare this with the work of computing the exact value by the , 0 usual process. 22 By choosing an appropriate grid, estimate the value of 2 I dx f dyf-~ '0 'ox+y+1O to within .02, and again compare by computing the exact value. 23 Let! and 9 be continuous on [a, b]. Show that (This is the integral form for the Schwarz inequality, given in Sec. 1.3 for finite sums.) 24 Using Exercise 23, show that I f ~e-x dx < .47 . 0 25 Use the same method to estimate the value of I (a) f J!+.0 dx , 0 INTEGRATION 201 26 Show that I · b ( P(a) +. P(b) + 4P([a + b]/2) P = b - a)· '. 6 whenever P is a polynomial of degree at most 3. 27 Verify the following statements: (a) If F(x) = r log (I + xe\") du, . - I then then then , -I (I + ex )F (x) = x log----::-- 1+ e IX (b) If F(x) = ( u- I cos (xu 2 ) du, '1 , 3 cos (x 3 ) cos xF(x)=----- 2x 2x (c) If F(x) = I\" u- 'eX\" sin u du, '0 en> + I F'(x)=-- x 2 + I 28 Use formula (4-13) to find F'(x) if: x 2 (a) F(x) = r t-Ie\" dt • x 3x (b) F(x) = r cos (4x) dx • 2x 29 Let F(x, y) = J' \\2y if x is rational if x is irrational Show that but that , I I' dx r F(x, y) dy = I '0 '0 .1 .1 I dy 1 F(x, y) dx does not exist. • 0 . 0 30 Let I I = [a, b) and 12 = [c, d) with b < c. Verify that the value of (4-14) is (c + d - a - b)/2. 31 Two points are chosen at random from an interval of length L. Show that their expected distance apart is L/3. 32 (a) Apply Theorem II to evaluate the double integral , 3 I' dx r (x 2y + 5xy 2) dy • 2 • -1 (b) Formulate and prove a corresponding theorem for the evaluation of triple integrals. 4.4 SUBSTITUTION IN MULTIPLE INTEGRALS In evaluating single integrals, we use either numerical methods or substitution and the fundamental theorem of calculus (Theorem 5). It is natural to expect that the situation would be similar for multiple integrals; in most instances, 202 ADVANCED CALCULUS however, multiple integrals are evaluated numerically or by replacing them by equivalent iterated single integrals, and the technique of substitution is mainly used in certain standard special circumstances, or occasionally to simplify difficult problems. In this section, we merely quote the relevant formulas, and defer all proofs and theoretical discussions until Chap. 7, where the necessary machinery for dealing with transformations of coordinates has been obtained. In one variable, we are accustomed to the following procedure for making a change of variable in an integral. Given • b V = I F(x) dx • a suppose we wish to make the substitution x = ¢(u). The three steps are: (4-16) (4-17) (4-18) Determine an interval [IX, fJ] of u values which is mapped by x = ¢(u) onto [a, b]' Replace F(x) by F(¢(u)), which is afunction ofu defined on the interval [IX, fJ]. Replace dx by ¢'(u) duo In Theorem 8 of the preceding section, we have shown that these steps convert the original integral into another with the same value .P V = I F(¢(u))¢'(u) du . ~ Consider now a double integral (4-19) and a substitution (4-20) V = If F(x, y) dx dy D { X = f(u, v) y = g(u, v) The three analogous steps are: (4-21 ) (4-22) (4-23) Determine a region D* in the UV plane that is mapped by (4-20) onto the region D, I-to-l. Replace F(x, y) by F(J(u, v), g(u, v)), which is a function of (u, v) defined on D*. Replace dxdy by XXXXX. We have chosen to leave the third step incomplete for the present, since the correct formula here is somewhat mysterious. One special case is familiar (4-24) INTEGRATION 203 from elementary calculus, namely, the formula arising from the coordinate substitutions of polar coordinates: JX = r cos fJ \\y = r sin fJ In this case, the third step in the process is (4-25) Replace dxdy by rdrdfJ and a geometric explanation for this is often given. In order to fill in the blank in (4-23), we must recall the expression given in (3-25) for a general Jacobian. Applied to (4-20), we write (4-26) :{:: ~= det [~::] = r~: ~:1 ou ou =1192 - 1291 Using this, the complete statement of the third step III the substitution procedure is as folIows: (4-27) Replace dxdy by I O(X,y) I o{u,u) dudu In the polar coordinates example, this becomes o(x,y)=det rcos fJ -rsinfJl o(r, fJ) Isin fJ r cos fJ = r{(cos fJ)2 + (sin fJ)2} = r which agrees with (4-25) above. While there is obvious parallelism between the three-step procedure for single integrals and that for double integrals, there is one visible difference. In that for multiple integrals, the second step mentions that the mapping shalI be I-to-l, and in the third step, the Jacobian (which replaces the derivative ¢'(u)) is inside an absolute value I I. This is because it is easier to prove a better theorem (Theorem 8, Sec. 4.3) for one variable than for the case of several variables, which we shalI take up in Chap. 7. Later, in Chap. 9, we wilI meet a version of the several-variables substitution more like that for one variable. We end this brief discussion by describing another method for carrying out a variable substitution in a multiple integral which does not bring in the Jacobian symbol, and which is as simple and automatic as the familiar method used for single integrals. It wilI seem far more mysterious than the above since (4-28) (4-29) (4-30) 204 ADVANCED CALCULUS it introduces some new symbols without explanation, and depends on some strange algebraic rules that seem arbitrary and ad hoc. First, as in (4-18), we agree that if x = cjJ(u), then dx = cjJ'(u) du By analogy, we agree that if x = f(u, v), then we write ax ax dx = au du + av dv = f t du + /2 dv From (4-28), we would therefore also write dy = gt du + g2dv. Accordingly, turning to (4-23), we have dx dy = (It du + f2 dv)(gt du + g2 dv) =/tgt du du + /tg2 du dv + /2gt dv du +/2 g2 dv dv We now invoke the following algebraic rules: du du = dv dv = 0 dv du = -du dv and using these in (4-29), we have dx dy = 0 + /tg2du dv - /2gtdu dv + 0 = (.ftg2 - f 2gJ du dv (We recognize that this is the same as (4-27), except that now we have dispensed with the absolute value of the Jacobian.) This generalizes immediately to multiple integrals of any size, and can be used with success, provided that one is careful to multiply all factors in the order in which they appear. Perhaps a word of explanation about this \"black magic\" method might be wise. In mathematical research, there seems to be a guiding platonic principle, most visible perhaps in many of the newer developments, which asserts that anything that leads to correct results, no matter how wild the method may look, may have some inner rationale. In the present case, a justification for the quasi-algebraic method for change of variable is found in the theory of differential forms. This is a fairly recent invention, growing out of earlier work (line and surface integrals, Green's theorem, and Stokes' theorem), and will be discussed in part in Chap. 9. Among other topics, this will contain a far-reaching generalization of the fundamental theorem of calculus. EXERCISES I Let f(x, y) = xy2, and let D be the region shown in Fig. 4-8. Use the substilution in (4-24) to evaluate ff f(x, y) dx dy. OOD INTEGRATION 207 much the same as that in Fig. 4-10. As above, we have • n A(Dn)=4+81 (x-1x 4 -1)dx • 1 Now, it is not hard to see that, for any x > 1, 4~ 1x-yx -1<- - x 3 For example, this can be checked directly by showing that whenever x ~ 1. Hence, n (1 1)A(Dn ) ~4 + 8Lx- 3 dx = 4 + 8 2- 2n 2 ~ 8 for all n. Since the Dn expand, {A(Dn)} is monotone increasing and lim A(Dn ) exists. We have shown that A(D) is finite, and at most 8, although we have not found its exact value. It is natural to ask whether or not the choice of the rectangles {R n} affects the final values of A(D). If we require that a more general sequence share with the special sequence the property that their interiors cover the plane, so that any point of the plane is eventually interior to some R n , then we can show that A(D) is independent of this choice. Theorem 13 Let {R~} and {RJ be two expanding sequences of closed and bounded rectangles whose interiors each cover the plane. Let D be a set such that the sets and D~ = D 1\\ R~ have area for each n = 1, 2, 3, .... Then, Let Un be the set of interior points of Rn and set E = Rj. The open sets Uncover the plane, and thus E; by the Heine-Borel theorem, there is a k such that E c Uk' This implies that for each j, there is a corre- sponding k such that Rj c Rk • Intersecting both with D, Dj c Dk and A(Dj) ~ A(Dk ) ~ limn_ oo A(Dn ). Since this holds for any j, limn_ oo A(D~) ~ limn_ oo A(D.}. By an analogous argument, we obtain the reversed inequality, and thus equality of the limits. I 208 ADVANCED CALCULUS Having extended the notion of area, we may similarly seek to extend the notion of the definite integral I(f, D) = JJf D Regarded as a function of the pair (f, D), we have shown that it is defined when D is a bounded set having area, and f is bounded and continuous on D, except for a set of zero area. In both cases, the word .. bounded\" cannot be deleted. For example, iff were not bounded above on D, then for any grid N partitioning D, the upper Riemann sum S(N) would have the value 00, since IUbpERuf(p) would be infinite for some choice of i and j. In particular, .1 the previous definition fails to give meaning to the integrals I log x dx and '0 .1 I l/jX dx. Guided by our discussion of area for unbounded sets, let us . 0 attempt to extend I(f, D) so that it will be defined for some unbounded regions D and some unbounded functions f. To distinguish these from the original notion of integral, we call them improper integrals. 00 What meaning should be attached to r f when f is continuous on the . c unbounded interval c ~ x < oo? If f is positive-valued, we can fall back on the notion of area, and define the value of this to be the area of the plane region D = {all (x, y) with c ~ x < 00 and 0 ~ y ~f(x)}. Applying the previous discussion, .00 .\" • !(x) I f = A(D) = lim I dx I dy 'c n-oo'c '0 .\" = lim.l f(x) dx n-oo C Modifying this slightly, we adopt the following definition to be applied also when the integrand takes on positive and negative values. Definition 5 Let f(x) be continuous for c ~ x ~ 00. Then, • 00 • r I f = lim I f 'c rfoo'e when this limit exists. To illustrate this, 00 r Ir r e - x dx = lim r e - x dx = lim - e - x I = I '0 rloo'O rloo 0 r00 sin x dx = lim _ cos x I,r '0 rloo 0 INTEGRATION 209 which does not exist. Since the final step in the computation is the evaluation of a limit, it is customary to use the terms \"convergent\" and \"divergent\" in • 00 ~ 0() place of \"exist\" and \"not exist.\" Thus I e- X dx converges and I sin x dx . 0 • 0 diverges. Following the same pattern, we shall understand { f to mean -00 -r For the expression Jex; f two distinct definitions are used. -ex; (4-31 ) (4-32) ex; r c f f = lim f f + lim r f '-00 r-oo'c r-oo'-, =.(f+{ f • 00 • r I f=lim I f • -00 '-00' -r We have To distinguish these, we call the first the (ordinary) value of the improper integral, and the second the Cauchy principal value. These agree whenever both exist, but the Cauchy value may exist in some cases where the ordinary value does not. The reason for this lies in the fact that the limit calculations in the ordinary case must be computed separately, and if either diverges, so does the integral. However, in the Cauchy principal value, the limit operations are combined, and divergence of one may be offset by the other. For example, consider the improper integral rex; (1 + x) dx • _ 00 1 + x 2 ,\" J~+ x)~x._= rarctan x + ~log (1 + x 2 ) r 'ol+x I 2 10 1 = arctan r + 2\" log (1 + r2 ) and since limr _ oo log (1 + r2 ) = 00, the original integral IS a divergent improper integral. However, so that and • 0 (1 + x) dx 1 2 I ------- = -arctan (-r) - -log (l + r ) . -r I + x 2 2 ,\" (1 + x) dx .T~ = 2 arctan r -r INTEGRATION 211 If D is the set of points lying above the horizontal axis, below the graph of f, and between the lines x = a, x = b, then the area of this unbounded set is . given by .b A(D) = lim I f\" n- 00 • a .b Were we to take this as our definition for I f, we would find that it is not too • a easily applied, even whenfis uncomplicated. Moreover, this would have to be modified to treat integrands taking both positive and negative values. Instead, we adopt a different definition which overcomes some of these objections, and which leads to the same results. We first isolate the discontinuities of f by splitting the interval of integration into subintervals in each of which f is continuous, except possibly for one endpoint. For example, ifJ(x) = 1/(x 2 - 1) and the interval of integration is [ - 1, 2], we would first write 2 0 I 2 r f(x) dx = r f(x) dx + r f(x) dx + r f(x) dx . -I . -I . 0 . I since the discontinuities are at I and - 1. We may therefore assume that we are considering a function f which is continuous on a half-open interval a < x s b and unbounded there; we do not require that f be positive. Definition 6 Letf(x) be continuous for a < x s b. Then, b b f f= lim r f a r ! a • r whenever this limit exists. I Using this for the integral r x- 1/2 dx, we obtain • 0 I If x- 1/2 dx = lim r X- I / 2 dx o '10', = lim 2./X II = 2 , 1 0 , in agreement with the former calculation. This agreement is of course not accidental. Theorem 14 Let f be continuous for a < x s b with f (x) ~ 0. Let D be the region bounded by the line y = 0, by x = a and x = b, and the curve y = f (x) . • b Then, A(D) = I f • a 212 ADVANCED CALCULUS ,b ,b This asserts that limn _ 00 I j\" and limr ) a I I are either both infinite, • a . r or both finite and equal. First, choose r> a and let M r = maxxE[r.bl I(x). When n > M r , j,,(x) = I(x) on [r, b] so that ,b ,r ,b .b IIn=IIn+IIn~II • a • a • r . r using the fact that I is positive. Letting n increase, we find that for any r> a, b b lim r In ~ r I n-oo'\" 'r and • b • b lim I j\" ~ lim I I n-x,,'Q rla', To obtain the opposite inequality, choose any n; sinceI(x) ~ j,,(x) for all x, whileIJx):s n, Combining these, we have and Jrr\" :S n(r - a) a • b • b I j,,:s n(r - a) + I I . a . r and letting r approach a, we see that for any choice of n, , b , b I In :S lim I I • a r ! a' r and thus • b ,b lim I In :S lim I I n-oc'Q r!a', Equality must hold, and we have shown that the alternative definition is consistent with the original area definition. I The examples which follow show how the definition is to be modified if the discontinuity of the integrand occurs at the upper endpoint, and if there is more than one discontinuity in the interval of integration. • 1 dx .\" dx . . (i) I ---== = hm 1---=== = hm arcsin r . 0 J1 - x 2 r 1 1 • 0 J1 - x 2 r 1 1 n (ii) 2 ( dx = (2 dx + ( dx . 0 Jx (I - x) . 0 Jx (1 - x) . 12 Jx (1 - x) INTEGRATION 213 Standard integration procedure shows that I , dx 1+ v'x = log , v'x (1 - x) 1 - v'x so that , 1I 2 dx , 1 + v'X 11I 2 .j2 + 1I = 11m log . ---. = log --'---o=c-.- '0 v'x(l-x) rjO I-v'x r .)2-1 However, , 1 dx , 1 + v';; Ir .1 1/2 J~(I-=~= !1~log \\'_ J~ 1/2 = 00 so that the original improper integral is divergent. So far, we have extended the definite mtegral by relaxing separately the restriction that the interval of integration be bounded, and that the integrand be bounded. These may also be combined. We interpret to mean , 1 , \"L I x- 1/2e- x dx + I x- 1/2e- x dx . 0 ' 1 and speak of the original improper integral as convergent only when both of these integrals are convergent. If care is exercised, the techniques applicable to ordinary proper integrals may also be used in evaluating improper integrals. If ¢(u) is of class C for a ~ u ~ p, and if ¢(a) = a, and lim. 1 P ¢(u) = b, then the change of variable ,b ,P X = ¢(u) converts an improper integral I j(x) dx into I j(¢(u))¢'(u) du, If • a • i2 this is now a proper integral, the original integral was convergent; if the new integral is also improper, then both are convergent or both divergent. For ,I example, the substitution x = u2 in I x- 1/2 dx gives . 0 I' 1 2u du = r 12 du = 2 , 0 1I ' 0 This procedure is also valid for integrals with unbounded range of integration. 'XJ , \"12 The integral r dx/(l + X 2 )2 becomes I (cos lW dO under the substitution , 0 ' 0 \"L X = tan 0; likewise, r x- 2 sin x dx is convergent since the substitution x = llu • 1 changes this into the proper integral (4-33) ( - sin (1) du = r 1sin (I) du . I U ' 0 u When the interval of integration is split into a union of subintervals, the original integral is represented as a sum of integrals, each having the same 214 ADVANCED CALCULUS intcgrand, and it is divergcnt if any onc of these diverges. A common error is to supposc that this is true whencvcr one intcgral is reprcsented in allY . , fashion as a sum of integrals. However. the intcgrals I (I + xlix dx and ·0., I (2x - I )/x dx arc each divergent. while their sum ·0 .1 I +x .1 2\\\"-I <Ix + I . • 0 x . 0 x is convcrgcnt. I .' <Ix ~ I ·0 I +x+2x- x I .' t/x=IJt!x ·0 , The convergence of an improper intcgral such as .1'0 f(x) ,Ix dcpends upon the behavior off(x) when x is large. Thc following simple comparison test is often used to show convergence or divcrgence. The functions f and 9 arc assumed continuous all the interval (I =::;; x < h. and h may be a number or 00. .' Theorem 15 LeI 0 s:f(x) s: y{x)Jor (I :s; x < b. TI'l'II. ~\"{I 9 (·ol1l'('ryl'S. so ., f' r' .'doe$ f and .r:s; I g. '\" '\" '\" Figure 4-12 will make this theorem plausible; if the area under the curve J' = y(x) is finite. so is the arca under the curve .1' = f(x). Of coursc. in this it is essentialthatfand yare both positive. To give a formal proof. we define F and G by F(r) = (f. G(r) = (y, Sinccf(x) :s; y(x). F(r) $; G(r) for all r < b. Since the intcgral of ~J converges. lim'_b G(r) exists. Since f is positive. F is monotonic increasing. Since F(r) is bounded above by G(r), and thcrcforc by lim._t> G(r), which is finite. Iim'_b F(r) exists. and, . lim._b F(r) = f f s lim._b G(r) = r g. I '\" '\" A corollary of this comparison test is somctimcs called the ratio test for improper integrals. Figure 4-12 INTEGRATION 215 Corollary Let f (x) ~ 0 and g(x) ~ 0 for a ::; x < b, and let lim f(x) = L xlb g(x) b b with 0 < L < 00. Then, the integrals r f and r g are either both convergent .. a .. a or both divergent. Iflimx_b f(x)jg(x) = L, then there is a point Xo between a and b such that whenever X o < x < b ~<f(x)<2L 2 g(x) Thus,j(x) < 2Lg(x) and g(x) < (2jL)f(x) for all x, Xo < x < b. Applying b b the theorem, we see that iff g converges, so does f f, and conversely. I a a To apply these tests, one must have at hand a collection of known integrals for comparison. Most frequently used are (4-34) rOO d: • 1 X 1 dx Jo ~P C dx Ja Ie - x IP converges if and only if p > 1 converges if and only if p < 1 converges if and only if p < 1 00 For example, r dXj~ converges, since the integrand is dominated by . 0 00 IjJXon the interval [0,1] and by Ijx 3 / 2 on [1,00]. The integral J dxjJ x + x 2 o 00 is divergent, since limx 1 00 xj~ = 1 and f dxjx diverges. 1 These comparison tests apply directly only when the integrand is every- where positive. However, the next result may often be used to reduce a general case to this special one. b b Theorem 16 f f always converges if r If(x)1 dx converges. a • a Sincef(x) always lies between -If(x)1 and If(x)l, 0::; If(x)1 + f(x)::; 2If(x)1 converges, since Ix-3/2sinxl ::;X- 3/ 2 on the interval . Isin x I Iconverges, smce 7 ::;.:x2 . Icos(l/x)1 converges smce- < x- 1/2, JX- 216 ADVANCED CALCULUS b b If f If I converges, then so does f [f(x) + If(x)l] dx, and subtracting b 'a .b fb the convergent integral I If(x)1 dx, f(x) dx must converge, , a a The following examples illustrate the use of this in combination with the preceding theorems. (i) f co sin/ dx 'I x (ii) (C0j¥X) dx '0 x (\"') I' co sin x d 111 r: x '0 xvx . r: sm x [1, 00] and hm v x r: = 1. x ~ 0 Xv x b A convergent improper integral f f is said to be absolutely convergent if a b b f If I is convergent, and conditionally convergent if f If I is divergent. All the • a • a convergent examples that we have discussed so far are absolutely convergent. A co sample of an integral which is only conditionally convergent is f x- I sin x dx. I The type of argument which was used above fails here; I(sin x )/x I is dominated by l/x, but f co X-I dx is divergent, so that Theorem 16 does not apply, and I this method gives no information about the convergence or divergence of either co cof X-I sin x dx or f x-II sin x I dx. To prove convergence of the first integral I I and divergence of the second, a different method must be used. Recall the familiar formula for integration by parts: (4-35) (f(x) dg(x) = f(x)g(x) I:- (g(x) df(x) We apply this to our integral, and have f' sin x f' 1-- dx = - d( - cos x) I X I X = _ cos x /' + ('cos x d(!) x I 'I X cos r f' cos x = - -- + cos (1) --2·· dx r . I X INTEGRATION 217 Since limr _ oo r- I COS r = 0, we have shown that I ,00 sin x \" 00 cos x-- dx = cos (I) - -2- dx 'I X 'I X The technique of integration by parts has replaced the original improper integral with another; however, the new one is absolutely convergent, since Ix- 2 cos x I ::;; x- 2. This shows that the original integral converges. ,00 To show that I x- 1 sin x dx is itself not absolutely convergent, write , I ,m\" Isin x I r\" sin x ~ I r(\"+Il\" Isin x II _.._- dx = I -- dx + L -- dx . I X '1 X I '\"\" x Since the minimum value of I/x on [mr, (n + I)n] is I/(n + I)n, f (\"+I)\" Isin xl 1 f(\"+I)\" ----- -- dx ~ ~--~ Isin x I dx \"It x (n + I)n \"It 2 2 ,\"+2 dx >~-->-·I --(n+ l)n-n'\"+1 x and Hence, m-I m-I '\" ,(\"+I)\"lsinxl 2 ,\"+2dx L I ----- dx ~ - L I - , \"It X n I '\" + I X I ,mIt Isin x I d \" \" sin x d 2 I m + 1 -~- x ~ -- x + - og-- 'I X 'I X n 2 ,00 and I Isin xlix dx diverges. , I The device of integration by parts may be applied in other cases too. To ,00 study the improper intygral I (cos x)/(Iog x) dx, we first perform an integra- , 2 tion by parts. (The use of \"00\" is an abbreviation for the previous limit operations. ) ,00 cos x ' 00 1I --dx= I --d(sinx) '2 log x . 2 log x sin 2 1,00 sin x---+ dx log 2 '2 x(log X)2 218 ADVANCED CALCULUS 00 Since r dx/x(log X)2 converges, the new improper integral is (absolutely) • 2 00 convergent, and r (cos x)/(log x) dx converges. • 2 The same procedure can be used to prove convergence for a general class of improper iotegrals. Theorem 17 (Dirichlet Test) Letf, g, and g' be continuous on the unbounded interval c ~x ~ 00. Then the integral f 00 f(x )g(x) dx is convergent iff and c g obey the following conditions: (i) limx _ oo g(x) = 0, 00 (ii) rig' I is convergent, • c (iii) F(r) = (f is bounded for c ~r < 00. c Take (fg = J:g(x) dF(x) = F(x)g(x) I:- (F(X) dg(x) .r = F(r)g(r) - F(c)g(c) - IF(x)g'(x) dx • c By assumption, IF(r)1 ~ M for all r ~ c, so that IF(r)g(r)/ ~ Mlg(r)1 and limr _ oo F(r)g(r) = 0. Also, IF(x)g'(x) I ~ Mlg'(x)1 and by hypothesis, rex; Ig'(x) I dx converges, so that by comparison rooF(x )g'(x) dx converges ~ c • c This shows that limr _ oo (fg exists. I c Two special cases of this are used frequently. 00 Corollary 1 r fg converges iff obeys condition (iii) and g(x) decreases • c monotonically to °as x i 00. For, g'(x) is always negative, so that (Ig'(x)/ dx = - (g'(X) dx = -g(x) I: = g(c) - g(r) and limr _ oorIg'(x)1 dx exists and is g(c). c INTEGRATION 219 Corollary 2 If9 is ofclass C for c ::; x < 00 and g(x) decreases monotonically to °as x i 00, then the integrals f 00 g(x) sin x dx and f 00 g(x) cos x dx are c c convergent. This corollary covers both of the illustrations given above. It IS often applied in combination with a change of variable. Consider the integral (4-36) .00 I cos (x 2 ) dx • 0 00 We prove that this converges, thus showing that r f(x) dx can converge • c without having f(x) --+°as x i. Make the substitution u = x 2 , and obtain instead the integral For u near 0, the integrand behaves like Ij~. Corollary 2 takes care of the interval 1 ::; u < 00, and the integral above converges. 1 00 Again, f x- I sin (X-I) dx becomes f (sin u)ju du after the substitution o 1 x = Iju, and is therefore convergent. The discussion of improper double and triple integrals follows somewhat the same pattern, allowing for the change in dimension. The most significant difference is the absence of an analog for conditional convergence. The reason for this will appear later. For the present, only positive integrands will be considered. Let D be an unbounded plane set and f continuous and positive in D. If we agree that ffDf is to measure the volume of the region V in 3-space lying above D and below the surface z = f(x, y), then we are led to the following definition. Definition 7 If f is limn _ oo rr f where Dn = D (l R n and {R n} is an ex- D •• D. panding sequence of closed rectangles whose interiors cover the plane. As in Theorem 13, the Heine-Borel theorem shows that the value obtained does not depend upon the choice of the sequence {RJ To illustrate this, let D be the first quadrant andf(x, y) = xye-(X 2 + y2 ). Choosing Rn as the square 220 ADVANCED CALCULUS with center at the origin and vertices at (±n, ±n) • • fJi= J o J/ye-<X 2 + Y2) dx dy D. .\" .n = I dx I xe- X2ye- y2 dy • 0 . 0 and fJi = lim ff i = i D \"-00 D\" When D is a bounded set, but i is unbounded, the region V above D and below the surface z = i(x, y) is again an unbounded set in 3 space. Its volume is found by constructing the truncated functions i., where i.(p) = min {n,f (p)}. These are bounded and the volume of V is lim._ oo rr i., which we may •. D accept as the definition of rr f, when the limit exists. Even in simple cases, •• D this process can be somewhat complicated to carry out. For example, let D be the unit square with vertices at (0, 0), (0, 1), (1,0), (1, 1), and i(x, y) = yx- 1/2 . Cutting i off at height n, we see that I(p)::; n when y ::; n~ and { YX- 1/2 I.(p)= n for y::; nfi for y > nfi Thus (see Fig. 4-13) 1/. 2 I 1/. 2 .-IX HI. = f dx f _n dy + f dx f yx- 1/2 dy D 0 .-Ix 0 0 I I 1 1 ( 1)+ f dx r yx- 1/2 dy = - + - + 1 -- 1/. 2 • 0 3n 3n n and fJ i = 1. As in the case of single integrals, an alternative procedure D may be used. The integrand yx- 1/2 is continuous in D except on the left edge, x = O. Let Dr be the rectangle bounded by the lines x = 1, x = r, y = 0, and y = 1. As r 10, Dr approaches D. Since I is continuous in Dr' we may integrate I over Dr' and define fJD I to be limr _ o fJD, I· We have I I I r l II .U,I = J r dx f o yx- 1/2 dy = f r dx 12fi 0 I dx = fr 2fi = 1 - jr so that 222 ADVANCED CALCULUS , II(x2 + y2t\" dx dy = lim 2n f r'-u dr D pjO • P , = 2n f r' - U dr . 0 which diverges when .Ie ~ 1 and converges to n/(1 - .Ie) when .Ie < 1. The following example may help to show why we have restricted the discussion thus far to integrands that are positive. Let us attempt to calculate II f where D is the first quadrant, and f(x, y) = sin (x 2 + i). We follow D the pattern used before and choose a sequence of regions {Dn} that converge to D, and examine limn_oo II f. Suppose that Dn is the square with vertices D. at (0, 0), (0, n), (n, 0), (n, n). Then n n II f = f 0 dx f 0 sin (x 2 + i) dy D. n n n n = f sin (x 2) dxf cos (y2) dy + f cos (x 2) dx f sin (i) dy • 0 0 • 0 0 = 2rsin (x 2) dxrcos (x 2) dx o 0 00 00 and lim IIf = 2 f sin (x 2) dx f cos (x 2 ) dx n- 00 DII • 0 0 Each of these separate integrals can then be shown convergent as was done earlier for (4-36), by first making the variable change u = x 2, and then using Corollary 2 of Theorem 17. Using certain special methods in complex analysis involving contour integration in the complex plane, it is possible to show that (4-37) fooo sin (x 2 ) dx = fooo cos (x 2) dx = ~ [These are called the Fresnel integrals and arise in optics.] We are thus led to propose 2(~)2 = n/4 as the value of If f. However, let us examine the D effect of a different choice for the sequence {DJ Take Dn to be the quarter circle °~ x, °~ y, Jx 2 + y2 ~ n. Using polar coordinates, we have n/2 n If f = f 0 dO.f0 r sin (r 2 ) dr D. n = \"4 [1 - cos (n 2 )] and limn~ooff f does not exist! .. D. INTEGRATION 223 In this example, two equally natural choices of the sequence {Dn} led to inconsistent results. The key to this strange behavior is the fact that, in this example, the integral of II lover D is divergent. The following result supplies the clue. Theorem 18 Let I be continuous on D and ff II I cpnverge. Then, D limn _ 00 ff I exists and has the same value lor any choice 01 the sequence •• D {Dn} converging to D. This is the analog for Theorem 16, and we prove it by means of the 2-space analog of the comparison test, Theorem 15 (Exercise 7). For any pED,O\":::;I(p) + II(p)I..:::;2II(p)l,andthus If U+ III} converges. Let D its value be A and the value of ff II I be B. Then, for any sequence {Dn} •• D converging to D, lim If U + II I} = A and lim If II I = B so that D,. D,. ~~~if I = ~~~Uf (f + II I) - if II I} exists and is A-B. I This result enables us to prove convergence for a wide class of improper integrals whose integrands take both positive and negative values. Thus, we can immediately know that the integral of sin (x 2 + i)e-(X2 + y2) over the entire plane is convergent. However, there is no analog for the notion of a conditionally convergent improper integral or for Dirichlet's test, when it comes to multiple integrals. The reason lies in the definition for convergence of an improper double integral, and the freedom of choice of the sets {Dn} that occur in that definition. We have stated that ff I will exist only when . D lim If I exists and is independent of the choice of the expanding regions D. Dn , which are restricted only by the requirement that every compact set interior to D shall be covered by the interior of Dn for all sufficiently large n. With this definition, it turns out that ffD I cannot exist without fJD II Iexisting too! A sketch of the proof is as follows. Let II = (II I + f)/2 and 12 = (II I- f)/2. We may assume that the integrals ff /; are each divergent. Note thatItI2 = 0, • D so that the sets where II and 12 are positive are disjoint. It is then possible (4-38) (4-39) 224 ADVANCED CALCULUS to choose {Dn} which favor f 1 over f 2, so that rr f1 diverges faster than .. D,. rr f 2 , with the result that rr f, which is their difference, also diverges. ... Dn o. .. Dn Another illustration may reinforce this. We will attempt to integrate the function f(x, y) = (x 2 - y2)j(X 2 + /)2 over the unit square S with opposite vertices (0, 0), (1, 1). Here are two different iterated integral calculations. 1 1 1 r y 11f o dx f o f(x, y) dy = f o dx x2 + y2 y=o ,I dx 1T: =.10 1 + x 2 =4 r1dy r1f(x, y) dx = 1,1dy r~211 , 0 • 0 • 0 x + Y x=o r1 -dy 1T: =. 0 1+ y2 = - 4 Note that the integrand f(x, y) is continuous everywhere in the square S except at (0, 0), where it becomes unbounded, both positively and negatively. If a third method is tried, integrating f over S with a small quarter disc of radius p at the origin removed, and then letting p -4 0, the value of the improper integral seems to be o! Again, the key is simply that ff If I is s divergent, and we do not therefore have a convergent integral ff f s So far, we have said little about the evaluation of improper integrals. The methods of approximate in tegration apply as before. One must first replace the original interval or set over which the integration is to be carried out by a bounded set. For example, if we wish to find the approximate value of 00 f e- t2 dt, accurate to .001, we first observe that o Choose R sufficiently large so that e - R < .0005. Then, calculate the value of ,R 1 e- t2 dt by Simpson's rule, with an accuracy of .0005. This will be the • 0 desired answer. Many times, however, a special device may enable one to find an expression for the exact value in terms of known constants and functions. As an illustration, let us find the exact value of the integral we have just discussed. We start by replacing the integration variable \"t\" by \"x\" and INTEGRATION 225 by \"y\", and consider the product of the resulting integrals, converting this to a double integral: .R .R .R .R I -x2d I - y2 d I I -x 2- y2 d de x e y= e x y . 0 • 0 • 0 • 0 Let R increase, and letting [ be the value we seek, [2 = (J o oo e- t2 dt) 2 = Ij e- x2 - y2 dx dy where D is the first quadrant. The integrand is positive, and the integral converges. We evaluate the double improper integral by an expanding sequence of discs, changing to polar coordinates to simplify the calculations. R ,,/2 [2 = lim r dr r e- r2r de R~oo'O '0 TC 4 (4-40) Thus, [= roo e- t2 dt=j\"\";r • 0 2 Other special methods for evaluating integrals will be given in the next several chapters. EXERCISES I What is the area of the region bounded by y = e\", y = 2 cosh x, with x ~ O? 2 Discuss the convergence of the following integrals: (a) f0'\" x2d~1 (b) f~'\"X 3d : 1 (c) f'\" sin 2x dx • 0 (d) ( (e) f 1 x 2 dx '0 )1- x 4 ()f \"'l-cosx 9 2 dx • 0 x (h) f\"'~d=x~ 'o~ 3 Discuss the convergence of the following integrals: (a) f00 eX sin eX dx • 0 _/2 (c) f sin (sec x) dx • 0 '\" (b) f x sin eX dx • 0 (d) ( sin (Ijx) dx o x 226 ADVANCED CALCULUS I (e) r xlogxdx '0 1[/2 (f) ,. jlanO dO '0 ,/2 (g) r . 0 dO ------~- ji-=-;in'-ii ,/2 (h) I' x jsecx dx • 0 4 For what values of ex and {3 does r '0 dx ----- converge? x' + x P oc 5 For what values of ex and {3 does r x'ix - liP dx converge? • 0 6 Let D be the unbounded triangular region in the right half plane bounded by the lines y = 0 and y = x, and letf(x, y) = x-3/2e'-x. Does n f converge? •• D 7 Let O:s f(p) :S g(p) for all p in a set D, and suppose that JJ D 9 converges. Prove that JJ D f converges. 8 Discuss the convergence of the improper integral JJ x>1 x ~~y+1 D • where D is the entire closed first quadrant. 9 Discuss convergence of the integral ... dx dv dz .1.1.1 ~>+}T~-;-2+1)2 where the integration is over all 3-space. 10 Verify (4-38) and (4-39). II For which real numbers ex is there a value c for which r ' dx .oc dx . 0 1 + x' = .1, 1 + x' 12 Let F(x, y) = y2jj(X 2+y2)3 and let S be the unit square with opposite corners (0, 0) and (1, 1). (a) Show why rr F exists. \"5 (b) As an iterated integral, would one of the two orders of integration be preferable? (c) Show that rr F = log (I + )2) \"5 CHAPTER FIVE SERIES 5.1 PREVIEW The topic ofstudy is2: ~ an = a1 + a2 + a3 + ... , an infinite series whose terms are numbers. For some readers, portions of this will be review. However, in addition to the standard ratio test, comparison test, and integral test, we also discuss the ratio comparison test, Raabe's test, and Dirichlet's test, which apply to series that escape the other tests for convergence and divergence. There is a brief discussion of the notion of conditional convergence, versus absolute convergence, and the effects that rearrangements have on the former. We present a small portion of the theory of absolutely convergent double series, since this is directly related to the Cauchy product of series, and since simple geometric problems often lead to double series. Finally, we describe and illustrate a number of different techniques for finding exact values or estimated values for the sum of specific series. Computers have not dispensed with the need for this; one does not blindly ask for the sum of a series, for one must know how many terms must be added to give the required accuracy, and any method which will decrease this number is worthwhile. 227 228 ADVANCED CALCULUS 5.2 INFINITE SERIES An infinite series is often defined to be \"an expression of the form .2~ an'\" It is recognized that this has many defects. In order to avoid some of these, we adopt the following formal definition. Definition 1 An infinite series of real numbers is a pair of real sequences {an} and {An} whose terms are connected by the relations: (5-1) An =.2 ak = a1 + a2 + ... + an I n~2 The first sequence is called the sequence of terms of the series, and the second is called the sequence of partial sums. If either is given, the other can be found from the relations (5-1). To denote the series as a single entity, one might use the expression <{an}, {An}); it is more customary to use .2~ an or a l + a 2 + .... Although the sequence of terms is given a dominant place in these expressions, the series itself is still the pair of sequences; we may speak of the sixth term of the series .2 ~ 1/(n2 + n) (which is i2) as well as the sixth partial sum (which is ~). The index \"n\" is a dummy letter, and may be replaced by any other convenient choice. As with sequences, it is not necessary that the initial term of a series be labeled with index \"1\". It is often convenient to vary this, and use, for example, ao + a l + a2 + .... There is a strong, but not perfect, analogy between infinite series .2; an 00 and improper integrals f f(x) dx. The function f(x) corresponds to the c sequence of terms {an}' and the partial sums 2: ak = An to F(r) = ( f This c correspondence means that most of the theorems in Sec. 4.5 have their analogs in this chapter, with proofs that will seem very similar. For this reason, some of these proofs will be abbreviated. Certain algebraic operations are defined for series. Definition 2 The product of the series2 an and the number c is the series (5-2) L (can) = cal + ca2 + ca 3 + ... The sum of the series L an and.2 bn is the series (5-3) L (an + bn) = (a l + bd + (a2 + b2 ) + (a 3 + b3 ) + ... SERIES 229 Thus, if an = lin and bn= - I/(n + 1), then L an +L bn = (1 + 1+ ...) + (-1 - j + ...) = (1 - 1) + (1 - j) + ... =1+i+-b+-io-+'\" which may be written as (5-4) 00 1 ~ n(n + 1) Note that this series is not the same as the series (5-5) 1-1+1-j+j-t+t-··· (5-6) obtained from L (an + bn) by merely removing all the parentheses, for (5-4) and (5-5) have different terms. Definition 3 A series L an is said to converge to the sum A whenever the sequence of partial sums {An} converges to A. A series that does not converge is said to diverge. We note that the algebraic operations described above may be performed on either divergent or convergent series. We shall see that both L: an and L: bn of the example above are divergent; however, their sum (5-4) is a convergent series, for the nth partial sum is ( 1 _!) + (!_!) + ... + (!__1 ) = 1 __1 2 2 3 n n+l n+l which converges to 1. A frequent cause for confusion in discussions about series is the unfortunate habit mathematicians have of using the expression \"~ an\" to stand both for the series and (when convergent) for its sum, letting the context distinguish between these meanings. In ''L an is divergent\" or \"L an is alternating\" it is clear that the series itself is intended, while in \"L an is larger than 3,\" the sum is meant. However, in \"L an is positive,\" either is possible, since it may be intended to mean that each of the terms is positive. A worse case is the statement: ~ an + ~ bn = ~ (an + bn).lfthis is a statement about series, it is simply the definition for addition of two series; if this is a statement about sums, it is the theorem which asserts that the sum of two convergent series is itself convergent, and its sum is the sum of the numbers ~ an and L bn· 230 ADVANCED CALCULUS Another source for confusion stems from the fact that in English, the words \"series\" and\" sequence\" are used with almost identical meanings, whereas their mathematical meanings are quite distinct. The series illustrated in (5-4) and (5-6) suggests a very simple way to construct lots of convergent series. From their nature, these are usually called \"telescoping\" series. Theorem 1 Let {bn} be any sequence with bn--+ 1.., and set an = bn - bn+ I. Then, .2: ~ an converges to the sum A = bl - L. For, An = (b l - b2 ) + ... + (bn - bn+ d = b l - bn+ I' which converges to b l - L. For example, calculating an = l/n2 - l/(n + I )2, we see that ~ 2n + 1 3 5 7 (5-7) L n2 (n + 1)2 = 4+ 36 + 144 + ... I converges to 1. A series cannot converge unless its terms approach O. Theorem 2 If.2: an converges, then lim an = O. For, an = An - An-I, and lim an = A - A = O. The Cauchy criterion for convergence of a sequence immediately gives a similar criterion for series. Theorem 3 A series .2: an converges if and only if lim (am + am+ I + ... + an) = O. m. n- 00 For, this sum of terms is exactly the difference (al + a2 + '\" + an) - (a l + a2 + ... + am- d = An - Am-I, and {A k} is convergent if and only if limm,n_ooIAn-Am=I!=O. I One consequence of this result is both important and useful. Theorem 4 If.2: !anI = Ia I I + !a21 + ... is a convergent series, so is the series.2: an' This is true whether the terms ofthe series are real numbers or complex numbers, and it explains why the first step in working with a particular SERIES 231 series is often to consider instead the positive series obtained by taking the absolute values of all the original terms. The proof of Theorem 4 is immediate, for Iam + am + 1 + ... + an I :-s; IamI + Iam + 1 I + ... + IanI and by hypothesis, the right side of this is approaching O. I Because of Theorem 4, many of the convergence tests for series are formulated for series with positive terms, but can be applied to the series .2: Ian I and thus provide information about .2: an· (Note, however, that if .2: IanI diverges, one cannot therefore conclude that .2: an diverges; this is discussed in the next section in more detail.) The comparison test and the ratio test were extremely useful in dealing with improper integrals; they have their analogs for series. Theorem 5 (Comparison Test) If 0 :-s; an :-s; bn for all sufficiently large n, and.2: bn converges, then.2: an converges. The terms {an} are positive from some index on, and at this point the sequence {An} of partial sums becomes monotonic increasing. They are bounded above, so that limn _ 00 An exists. I A corollary of this that is often easier to apply directly is: Corollary If 0 :-s; an and 0 :-s; bn and limn_ oo an/bn= L where 0 < L < 00, then.2: an and.2: bn are either both convergent or both divergent. The next result is sometimes called the ratio comparison test. Theorem 6 If 0 < an, 0 < bn, and.2: bn converges, and iffor all sufficiently large n, an+dan:-s; bn+dbn, then 2 an converges. Writing the inequality as an+1/bn+1 :-s; an/bn, we see that {an/bn} is an ultimately decreasing sequence, and is therefore bounded. Thus an :-s; Mbn for all n, and.2: an converges by the simple comparison test. I In order to apply either of these comparison tests, some known examples of divergent or convergent series must be at hand. Theorem 7 The geometric series .2:: x n = 1 + x + x 2 + ... converges to 1/(1 - x)for Ixl < 1 and diverges when Ixl ~ 1. 232 ADVANCED CALCULUS The partial sums are given by An = (1 - xn+ 1)/( I - X) when x #- I and by An = n + 1 when x = 1. I Combining this with Theorem 3 gives the ratio test. Theorem 8 If 0 < an' let L = lim SUPn_oc an+dan and 1= lim infn_ oo an+dan' Then L an converges if L < 1, and diverges if I> I; if I :'5.:: I :'5.:: L, no conclusion can be reached about the behavior ofL an' If L < I, then a number x can be chosen so that L < x < I and an+dan :'5.:: x for all but a finite number of indices n. Since x = xn + I/xn, this takes the form given in Theorem 6 with bn = xn, and since 2: bn = 2: xn converges, so does L an' On the other hand, when I > 1, then for all sufficiently large n, an + dan;:::: 1, so that {an} is an ultimately increasing sequence; as such, it cannot converge to 0, and 2: an must diverge. I In many cases, the sequence of ratios {an+dan} is convergent; when this happens, the statement of the theorem is simpler. Corollary If an> °and lim an+dan = r, then 2: an converges if r < 1 and diverges if r > 1. If r = 1, no information about 2: an results. The last part of the corollary is easily illustrated. We will see shortly that 2: lin diverges and that L I/n 2 converges; it is easily checked that r = 1 for both. An example to illustrate the last part of Theorem 8 is also easily supplied. Consider the series (5-8) 2 8 16 64 128 512 .3 + 9 + 27 + 81 + 243 + 729 + ... Instead of calculating the ratios an + IIan' it is easier to observe that these are the numbers Cn such that an+I = an cn· In (5-8) these are C I = t c2 = j, C3 = t etc., and we find that the numbers I and L in Theorem 8 are I = j and L = %. Since I < 1 < L, we do not yet know if the series (5-8) is convergent or divergent. This can be settled by a different test called the root test, which also is derived by using the geometric series for comparison. Theorem 9 Let lim sUPn_oo lani l/n = r. Then'L an converges ifr < 1 and diverges if r > 1; when r = 1, no conclusion can be reached. SERIES 233 If r < l,choosex with r < x < 1 and have lanll!n ~ x for all sufficiently large n. Thus Ian I ~ x nfor n :2: N, and sinceL xnconverges, so doesL an· If r > 1, then from the definition of limit superior, Ian II/n :2: 1 for infinitely many indices n. We therefore have lak11 :2: 1, lak2 1:2: I, ... , lakj l:2: 1, ... , so that the sequence of terms {an) is not convergent to 0; L an must then diverge. I These two tests are closely connected. The ratio test is often easier to apply; however, if a series can be shown convergent by the ratio test, it could also be treated by the root test (see Exercise 8). If this test is applied to the previous example (5-8), the number r is seen to be (ik/2 < I, and (5-8) converges (Exercise 4). The next theorem shows the close connection between improper integrals and infinite series; it also provides a large class of useful series for comparison purposes. It is called the integral test. Theorem 10 Iff is positive on the interval 1 ~ x < CfJ and monotonic de- creasing with lim x r 'Xo f(x) = 0, then the series .2: ~ f(n) and the improper integral r'Xo f are either both convergent or both divergent. . I . n+ 1 Let an = f(n) and bn = I f • n Since f is monotonic, n+ I f(n + 1) ~ r f(x) dx ~ f(n) • n or an+ I ~ bn ~ an· By the comparison test'L an converges ifL bn con- verges, andL bnconverges ifL an converges, so thatL an andL bncon- verge or diverge together. But'L bn converges exactly when the integral roof converges. I . I Corollary The series 2:: l/n P and 2:: l/n(log n)P converge when p> 1 and diverge when p ~ 1. This follows immediately from the behavior of the corresponding improper integrals [see formula (4-34)]. If the first of these series is used as the comparison series 2: bn in Theorem 6, a test called Raabe's test is obtained. 234 ADVANCED CALCULUS Theorem 11 Let 0 < an and p> 1, and suppose that an+ dan S 1 - pin for all sufficiently large n. Then, the series 2: an converges. For the proof, we need a simple lemma: Lemma 1 If P > 1 and 0 < x < 1, then 1 - px S (1 - x)P. Set g(x) = px + (1 - x)P, observe that g'(x) ~ 0 and that g(O) = 1, and conclude that g(x) ~ 1. To see that this implies Theorem 11, observe that, with x = lin, an + 1 S 1 _ ES (1 _ !)P = (n - 1)P an n n nP which is exactly bn+ llbn if bn+ 1 = 1/nP, and Theorem 6 applies. As an illustration of the last test, consider the series 1 1 . 3 1 . 3 . 5 1 . 3 .... (2n - 1)-+-+--+ ... + + ... 4 4·6 4·6 . 8 4·6···· (2n + 2) The successive ratios an+ dan are i, i, \"', (2n - 1)/(2n + 2) and limn _ 00 an + dan = 1, so that the simple ratio test fails. However, 2n - 1 2n + 2 2n + 2 - 3 3----=1--- 2n + 2 2n + 2 and since this has the form 1 - pl(n + 1) with p = 1> 1, the series is convergent by Raabe's test. EXERCISES I. Investigate the convergence of the following series: 1 2 3 4 5 (a) 3 + 6+ 11 + 18 + 27 + ... 1 2 3 4 5 (b) 2. - 20 + 38 - 56 + 74 - ... 1 1·2 1·2·3 (c) 3+M+~+··· 1 1 . 9 1 . 9 . 25 1 . 9 . 25 . 49 (d) 4+ 4· 16 + 4· 16·36 + 4· 16· 36·64 + ... 2 Show that if2: a. converges, then 2:: a. --+ 0 as N --+ 00. 3 Investigate the convergence of2: a. where (a) a.=~-fi, n + 1 J ~-fi, (b) a. = n + 1 SERIES 235 3· 4 Show that in (5-8) I a. = 'I ~ (2 3 • /2 ) ~ 3· if n is even if n is odd and that lim (a.)'/. = 2.j2/3 < 1. Apply the root test to prove the convergence of (5-8). 5 (a) Let 0 < a. and 0 < b. and a.+ ,/a. ;0: b.+ db. for all sufficiently large n. Show that if L b. diverges, so does L a•. (b) Prove: If 0 < a. and a.+ .Ia. ;0: I - pin for some psi and all large n, then L a. diverges. (c) Prove: If 0 < a. and a.+ dan ;0: I - lin - Aln 2 for all large n, A > 0, then L a. diverges. 6 Let L a. and L b. converge, with b. > 0 for all n. Suppose that ajb. ---> 1. Prove that 7 Let {a.} l 0; show that L7 a. converges iF and only iF L7 2·a 2 , converges. 8 Show that directly that if lim._ 00 Ia. + ,Ia. I = L, then lim._ 00 Ia. 1 1/. = 1. 9 Some of the following statements are true and some are false; prove those that are true, and disprove those that are false. (a) IfL a. and L b. converge, so does L (a. + b.). (b) IfL a. and L b. diverge, so does L (a. + b.). (c) If L la.1 is convergent, so is L (a.V· (d) If L la.1 and L Ib.1 converge so does La.b•. (e) IfL ~ a; converges, so does L ~ ajn. \"(I) If {a.} l 0 and L a. converges, then limn _ oo nan = O. 10 Show that iff ;0: 0 andfis monotonically decreasing, and if c. = \"\"': f(k) - r\"f(x) dx, then L \" limn _ 00 c. exists. 11 Show that if c. ;0: 0 and L c. converges, then L .j;:.ln also converges. 12 Show that if a. > 0, L a. diverges, and S. = a. + ... + a., then L ajS. also diverges, but more slowly. \"13 Letfand/, be continuous on the interval I s x < 00 withf(x) > 0 and ('\" If'(x) I dx \" convergent. Show that the series L7f(k) and the improper integral ( f(x) dx are either both convergent or both divergent. \"14 Show that ifL a;ln converges, then liNL ~ak ---> O. 236 ADVANCED CALCULUS 5.3 CONDITIONALLY CONVERGENT SERIES A convergent series 2: an for which the series 2: IanI is divergent is said to be conditionally convergent; if 2: Ian I is convergent, 2: an is said to be absolutely convergent. The preceding theorems show that each of the following series is absolutely convergent. 1- t + ~- -to + ~- ... =i (_1)n+ l~ 1 n 00 I 1 + ~ - t - i + -to + iz - ... = 2: (_1)n(n-I)/2 2 n o 00 1 I + ~ + t - -to- + -f, + -to + ~ - 3b- + ... = '\" (- 1)n(n- 1)(n- 2)/2 -- L n2 + I o One may also use Theorem 2 to prove that a series having both positive and negative terms may be divergent. For example, the series I - ~ + ~ - A + ;, - ... which has the general term a = (_1)n+l_n_ n 4n - 3 is divergent since it is not true that lim n _ 00 an = 0. The methods given so far for testing a series do not apply to the (convergent) alternating harmonic series Since 2: ~ lin diverges, this series is not absolutely convergent, while limn _ oo (- I )n+ 11ln = 0, so that Theorem 2 cannot be used to show divergence. The next result contains as a special case the alternating series test, and is the analog for series of Theorem 17, Sec. 4.5, dealing with improper integrals with integrands that change sign. It is usually called the Dirichlet test for series. Theorem 12 Let {an} and {bn} be sequences (real or complex) which obey the following: (5-9) (5-10) (5-11 ) lim an = ° 2: Ian + 1 - anI converges The series2: bnis such that its partial sums are uniformly bounded. Then, 2: an bn converges. SERIES 237 The last condition, (5-11), means that if Bn = 2:: bk , there is a number M such that IBnI ~ M for all n. The proof of this follows a pattern similar to that of Theorem 17 cited above; we use a discrete analog of integration by parts, sometimes called \"partial summation.\" 2: akbk = alb l + a2 b2 + ... + anbn I = alB I + a2(B2 - Bd + ... + an(Bn - Bn- d = (al - a2)B I + (a2 - a3)B2 + .\" + (an-I - an)Bn - 1 + an Bn n- I = anBn - 2: (ak+1 - adBk I Because of (5-9) and (5-11), lim n _ oo anBn = 0. Since l(ak+1 - ak)Bkl ~ Mlak+1 - akl and (5-10) holds, the series2: ~ (ak+1- ak)Bkis convergent. These together prove that lim n _ oo 2:~ akbk exists and 2: ~ an bn converges. I This theorem takes a simpler form when {an} is monotonic. Corollary 1 If the sequence {an} is monotonic decreasing with limn _ 00 an = 0, and the partial sums of2: bn are bounded, then 2: an bn converges. 2: !ak+1 - ak! = (a l - a2) + (a2 - a3) + ... + (an - an+d I and limn _ oo 2:~ lak+I - ak! = limn_ oo (al - an+I) = aI' so that hypothesis is satisfied. I A special choice of the sequence {bn} yields the usual alternating series test. Corollary 2 If {an} is monotonic decreasing with limn _ oo an = 0, then 2: ~(- l)n + I an converges. With bn = (- l)n + I the partial sums of2: ~ bn are always either 1 or 0, and are therefore bounded. I The following examples illustrate the use of these tests; we note that none of the series is absolutely convergent. 238 ADVANCED CALCULUS The series 1 -1 + 1- *+ ... is a simple alternating series and therefore converges. It should be noted that alternation of signs and lim an = 0 are not alone sufficient; the partial sums of the series 1/3 - 1/2 + 1/5 - 1/22 + 1/7 - 1/2 3 + 1/9 - 1/24 + ... are unbounded, since the positive terms form the divergent series 1/3 + 1/5 + 1/7 + \"', while the negative terms form a con- vergent geometric series - 1/2 - 1/22 - 1/2 3 - .... The series I + 1/2 - 2/3 + 1/4 + 1/5 - 2/6 + 1/7 + ... converges by appeal to Corollary 1; take an = l/n and let L bn be I + I - 2 + I + I - 2 + I + I - 2 + \"', which has a bounded sequence of partial sums. The conditionally convergent series L ~ (_I)n+ 1(I/n) is often used to illustrate a property which is shared by all conditionally convergent series, namely, that rearrangement of the order in which the terms appear may change the sum or even render the series divergent. Denoting the sum of this series by S (approximately .693), we write (5-12) Then S= 1-1+1-*+~-i-+i-'\" 1S = 1 - * + i- - i + -fu - fz + -h - ... Neither the convergence of a series nor the value of its sum is altered by the insertion or deletion of zero terms, so that 1S = 0 + 1 + 0 - * + 0 + i- + 0 - i + ... Adding this series to the first one, we have ~S = I + 0 + 1 - 1 + ~ + 0 + i - * + ~ + 0 + ... or, dropping the zero terms, ~S = 1 + 1 - 1 + ~ + i - * + ~ + -fi - i- + ... If the terms of this series are compared with those of the original series whose sum was S, it will be seen that these series are rearrangements of each other; each term of one appears exactly once somewhere among the terms of the other series. This emphasizes the fact that an infinite series is not merely the \"sum\" of an infinite set of numbers; if we return to the view that a series is a pair of related sequences, then we see that the two series are quite different, having entirely different sequences of terms, and that it should not be surprising, therefore, that they converge to different sums. It is not difficult to see that more drastic rearrangements can convert the alternating harmonic series (5-12) into a divergent series, or in fact into a convergent series with any preassigned sum. This depends on three facts: I. limn~x 1/11 = O. 11. The positive terms of (5-12) form a divergent series 1 + 1+ ~ + i + . iii. The negative terms in (5-12) form a divergent series -1- * - i- - i - . Suppose we wish to rearrange (5-12) to converge to A = 10. Choose positive 240 ADVANCED CALCULUS limit, so that any convergent series may have its terms grouped in brackets without altering the sum. If the original series is divergent, grouping terms may render it convergent. The series 2~ (_1)n+1 diverges, while (I - I) + (I - I) + ... converges to 0, and 1 - (I - I) - (I - I) - ... converges to 1. The techniques we have discussed for investigating the convergence of a specific series whose terms are numbers are equally applicable if the terms have variables in them; in this case, we seek the set of values which these variables must have if the resulting series is to converge. An instance of this is Theorem 7, where we showed that 2 x n converges exactly for those x with IxI < 1. Technically, what we have described is called pointwise convergence, since we are examining the convergence of the series for each individual choice of the variable points. (In the next chapter, we will study uniform convergence of series of functions, which looks at such matters differently.) Power series form the most common example of series that involve variables. A general power series in x has the form 2: an xn, and a power series in x - c (or about x = c) has the form 2: an(x - c)n. The behavior of power series with respect to pointwise convergence is especially simple and valid both for real and complex {an}. Theorem 14 With any power series 2: an xn is associated a radius of convergence R, o:-s; R :-s; 00, such that the series converges (absolutely) for all x with IxI < R, and diverges for all x with IxI > R. Moreover, R may be calculated from the relation ~= lim sup Ian II/n R n-oo or when the latter exists. ~= lim Ian \"!:~I R n-oo an We have only to apply the root test for convergence. Let L = lim sup Ian II/n Then, lim sup Ian xnII/n = L IxI, so that 2 an xn converges whenever L Ix I < I and diverges whenever L Ix I > 1. If L = 0, we see that the series converges for all x; if L = 00, then it converges only for x = O. Setting R = I/L,and interpreting L = 0 to correspond to R = 00, and L = 00 to R = 0, we see that L an x n converges for all x with IxI < R. The final statement of the theorem comes from the fact that when lim Ian + dan I exists, its value is always the same as lim Ian II/n. (See Exercise 8 Sec. 5.2.) I SERIES 241 The corresponding facts for more general power series can be obtained from this by substitution. The series2: an[g(x )]n may be called a power series in g(x). If we set g(x) = y, this becomes2: an yn. If this power series in y has radius of convergence R, then2: an[g(x )]n converges for all x with Ig(x) I < R. In particular, this gives the corollary. Corollary ~f I/R = lim sup lani l/n, then 2: an(x - c)n converges for all x with Ix - cl < R, and diverges when Ix - cj > R. The convergence set is thus an interval of length 2R centered at the point c, with endpoints c- Rand c+ R, and the series mayor may not converge at either endpoint. As an illustration, consider the power series (5-13 ) <. (X\"~})n =1+x+2+(x+~y + ... ~ 3nJ2n + 1 3)3 9)5 If we take absolute values of the terms, then apply the ratio test, we arrive at !~~a~:}= !~~h~~xllf~n:lr II ~i:n2~n!I . Ix + 21 fin+-f Ix + 21 = hm-- - -----=== = ------ - n-oc 3 fin + 3 3 Thus, we conclude that the series converges if Ix + 21/3 < 1 and diverges if Ix + 21/3 > 1, and we do not yet know what happens if Ix + 21/3 = I. Rewriting these, the first becomes Ix + 21 < 3, which, for real x, is the same as - 3 < x + 2 < 3, or - 5 < x < I. It remains to test each of the endpoints separately. When x = 1, (5-13) becomes the series 1 1 1 1 1 +-- + - + - + ... + -===---= + ... J3 .,/5 fi J2n + 1 which diverges (since the terms behave like n- 1/2 ). When x = - 5, the series (5-13) becomes 1 1 1 ( - l)n 1 - - ---- + --- --. - - + '\" + -~= + ... J3 J5 J7 J2n + 1 which is a convergent alternating series. We have now found the exact convergence set for (5-13); it converges for all x with - 5 S x < I, and diverges for all other (real) values of x. This is typical of the behavior of many power series, except that it may be much more difficult to decide on convergence or divergence at the endpoints. Examples of this sort will be found in the exercises. 242 ADVANCED CALCULUS Sometimes a simple substitution will simplify the work. Consider the series (5-14) ~ ~ (x + I)\" L n2 (x - 3)\" 1 If we set y = (x + 1)/(x - 3), this becomes L y\"/n 2 , which is easily seen to converge for all y with Iyl ~ 1. Hence, (5-14) converges exactly for those x with 1~1·~1 x-3 This, in turn, can be written (if x \"# 3) as (5-15) Ix+11~lx-31 and since in general, Ix - bI is the distance between x and b, the relation (5-15) is equivalent to dist (x to -I) ~ dist (x to 3) we conclude that (5-15) converges exactly for those x with x ~ 1. The same techniques that work for power series are also used for other types of series involving variable parameters. For example, let us prove the following statement about one form of the so-called hypergeometric series: The series (5-16 ) a a(a+l) a(a+I)(a+2) 7J + [3([3 + 1) + [3([3 + 1)([3 + 2) + ... a> 0, [3 > ° converges when [3 > 1 + a and diverges when [3 ~ 1 + a. The term ratios are (a + 1)/([3 + I), (a + 2)1([3 + 2), and In general (a + n)/([3 + n) so that lim a\"-t:~ = 1 n- 'X an which indicates nothing about convergence or divergence. Raabe's test is applicable, however, and writing (a + 11)/([3 + 11) = 1 - ([3 - a)/(11 + [3), we see that the series converges when [3 - a > 1. If [3 - a = I, the series becomes a a(a + I) a(a + 1)(a + 2)--- + .... +--- + ... ex + 1 (a + I)(ct + 2) (ct + I)(ct + 2)(ct + 3) ct ct ex ex= --- + -- + ---- + ... + .... _.. + ... ex+1 ct+2 ct+3 ex+11 which is divergent. If [3 < 1 + ct, then the terms become even larger and the series is also divergent. (5-17) A somewhat more complicated example is the series ~ Si~X)= sin x + sifi~+ s~x+ ... SERIES 243 Lemma 2 We shall show that it converges for every value of the parameter x. Apply Corollary I of Theorem 12 with an = I/~ and bn = sin nx; it is only necessary to show that the partial sums of the series2 ~ sin nx are bounded. 2 \"-- . k cos (x/2) - cos (n + 1-)x Sill X = - -~ -------~-~- 2 sin (x/2) 1 for all x with sin (x/2) # 0. We have sin C)~ sin kx = sin (~)sin x + sin (~)sin 2x + ... + sin (~)sin nx Using the identity: 2 sin A sin B = cos (B - A) - cos (B + A), this may be written as . (X) ,n. . (X 3X) (3X 5X) 2 Sill 2 2. Sill kx = cos 2- cos 2- + cos 2- + cos 2- 1 = cos (~)- cos ( n + ~)x and the required relation follows. I It is now clear that the partial sums of 2 ~ sin (nx) are bounded by 1/ Isin (x/2) I, so that Corollary 1 of Theorem 12 applies and L ~ (sin nx)/~ converges for all x except possibly those for which sin (x/2) = 0. However, these are the values X = 0, ± 2n, ... , and the series is clearly convergent for these also. EXERCISES t Investigate the convergence of the following series: 232 123 2 I (a) - + - + - + - + .. 1 234 567 8 244 ADVANCED CALCULUS 1 1 1 1 1 1 1 1 1 (b) 1 + --- _ .. -- + - + -----=-- +-- +--~_~ - -- + -ccc + .. , j3 fi J5 )7 j4 j9 )11 j6 )13 2 Determine the values of the parameters for which the following series converge, r 4r 2 9r3 16r4 (a) + --- +- + -- + ... 2 9 28 65 (b) 1 + ~ + 2x 2 + ~~)X3 + F. 3 . 4)x 4 + ... 3 9 27 81 \"x. (x + 2)\" (c)\"'_c~ ... n)n+ 1 ,c<. (x _ 1)2n (e) :\"' --- .:- n2 3 n 1 ,x. ({In)\" (g)\" --- .:- n! I ~ (2n)!x n (d) L n0!/ 1 (11) a{J + a(a_+I){J({J + I) + a(a + l)(a+2){J(fl.~I)({J +~) +'\" .,' 2' ;-(;, + I) 3! ;'(;' + 1)(;' + 2) , ;. xn(l. _ xn) (I) ,,-- ~ 11 \" )n(k) ,,-- ... (11 + 1)(2x + 3)\" x (m) \"'. sin (,\\) ~ 11 I ~, nx n (j) ~ n 3 + x 2n I ~, 1 [x + 1 jn (1)\"')11 2x + 1 3 Show why the following two statements are false. (a) If=:: an converges, and lim Cn = 0, then 2 an en converges, (b) If \"\" bn converges, and limn_x an/bn = I, then \"\" an converges, ~ ~ 4 Show that the sum of an alternating senes lies between any pair of successive partial sums, so that the error made in stoppmg at the 11th term does not exceed the absolute value of the next term, S Determine the radius of convergence of the fJllowing series: (a) '\" /1! x n (c) \"\" en'xn where 0 < x < x (b) ~. 11' xn _l1 n 1 6 Determme the radius of convergence of each of these power series: (a) \"\" II(X - I)\" \". II (b) ~ 112 + I x n I 246 ADVANCED CALCULUS we see that this definition amounts to summing 22 aij by rectangles. As with single series, the behavior of series with positive terms is particularly simple, and comparison theorems may be proved. Again, if L2 laijl con- verges, so does 22 aij; such a series is said to be absolutely convergent, and it can be shown that an absolutely convergent series can be arbitrarily rearranged without altering its convergence or its sum. In particular, any absolutely convergent double series22 aij can be rearranged as a convergent single series One immediate application of this observation is the following important theorem dealing with multiplication of absolutely convergent single series. Definition 5 The Cauchy product of the series 2~ an and L: bn is the series2: cn' where (5-18 ) (5-19) The motivation for this definition comes from the study of power series. If we treat power series simply as infinite-degree polynomials and use the same algebraic rules for them, then the product of 2: an xn and L: bnxn will produce a new power series, which will turn out to be 2: Cn x n, where cn is given by (5-18). ao + a1x + a 2 x 2 + a3 x 3 + a4 x 4 + . bb + b1x + b2 x 2 + b3 x 3 + b4 x 4 + . aobo +(aOb 1-+ alb~+ (aOb;-+~lbl+a;b~)~i + ... If we leave the parentheses in and set x = 1, we arrive at the definition (5-18) introduced by Cauchy. The following result justifies this definition. Theorem 15 Let 2: an and L: bn be absolutely convergent, with sums A and B. Then, their product series L Cn = L (aobn+ a1b n - 1 + ... + anbo) o 0 is absolutely convergent with sum AB. SERIES 247 m (5-20) L L laijl =L lail L Ibjl i=Oj=O 0 0 so thatL:L ~ IaijI is a convergent double series. The seriesL:L: aij is then absolutely convergent, and its sum is i=n j=m PI m lim L L aij = lim L ai lim L bj ~:: i=O j=O n-oo 0 m-oo 0 = AB Rewriting the double series as a simple series, and inserting brackets, we have This theorem is also true if one of the series L an or L bn is absolutely convergent and the other is conditionally convergent. A proof of this, together with many other refinements and additional results, may be found in special treatises on the theory of infinite series. Mere convergence is not enough, as the following example shows. Consider the convergent alternating series (for n 20) 1_L +L _~ + ... + J-l)n + ... .j2 J3 ~4 -In + 1 and form its Cauchy product with itself, according to the scheme (5-18); call the resultL cn • We find that the signs of this new series alternate and that 1 1 1 1 1 (5-21) Icnl = ---=--c-'C + ---_- + --c-c\"'--~ + ... +--- +--= ~+ 1 ~2~ J3-1n-1 ~.j2 In+ 1 However, calculation suggests that Cn does not approach O. In fact, an easy estimate shows that Icnl > 1 (Exercise 1). Thus, (5-20) is a convergent series whose Cauchy product with itself is divergent! The series analog for iterated integration is iterated summation, such as in \"\",' x_ (\"\" x_ ank ), which is interpreted to mean Ln-I Lk-I (5-22) where An = ~ ank k=1 248 ADVANCED CALCULUS When the terms ank are positive, the following result on reversal of order of summation is often used. Theorem 16 If ank Z 0 and \"\"\" 00_ {\"\"\" 00_ ank} converges to S, thenL..,n-1 L..,k-1 L:= 1 {L:= 1 ank} also converges to S. The hypothesis asserts that each of the series L:= 1 ank = IXn is con- vergent, and that S =L ~ IXn · For any k, ank ::5: IXn; invoking the com- parison theorem, L:= 1 ank converges to a sum 13k for k = 1, 2, .... Take any integer N and write N 00 00 L 13k = 131 + 132 + ... + 13N = Lan. 1 + ... + Lan. N 1 n=1 n=1 00 = L {an. 1 + an. 2 + ... + an. N} n= 1 00 ::5: L IXn = S n= 1 Since this bound is independent of N, L ~ 13k converges with sum less than or equal to S, and we have proved that We could now start over again with the series on the left, and obtain the opposite inequality; this shows that the two sides are actually equal. I This result need not hold if the term ank are not all positive. In the array given below, the sum of the nth row is 1/2n , so that ~,l~,a..1~~.1/2\" ~1 However, the sum of the kth column is 1/2k - 1, so that This shows that the bookkeeper's check may fail for infinite matrices of numbers, 250 ADVANCED CALCULUS 5.5 SOME SUMS While it is enough in some cases to know that a series L an converges, it is often more important to know something about the value of its sum. We know that L ~ 1/n 2 converges. Denote its sum by C; convergence implies that C is almost equal toL71/n 2 if N is large enough, but how large must we take N to calculate C to a specified precision? A reexamination of the integral test will help here. If an Z °and f is a n+1 decreasing positive function withf(n) = an, and bn = r f(x) dx, then as in • n 00 the proof of Theorem 10, an+ I ~ bn and L~ bn = f .f, and therefore I (5-23 ) and (5-24) 00 00 L an ~aI + JI f (x ) dx I 00 L an ~f f(x) dx n\"N+I N Applied to L l/n P , p > 1, these estimates are (5-25) (5-26) L oo 1 1-<1+-- nP - p - 1 I . \"1000 These tell us that the number C obeys C ~ 2, and that the filllte sum L I 1/n2 will differ from the exact value of C by not more than .001. (We will find out later how accurate these estimates are.) Similar remarks apply to divergent series. While it may be enough some- times to know that 2: an diverges, at other times one may need to know how fast it diverges-e.g., how rapidly AN = L7ak approaches infinity, in a case where an Z 0. For example, the harmonic series L l/n diverges. Calculation SERIES 251 shows that 50 L ~= 4.499 205 ... 1 100 L ~= 5.187377 ... 1 500 1 L ~ = 6.792823 ... 1 Since the series diverges and has positive terms, we know that the partial sums must exceed 100 eventually. How many terms must we use to achieve AN > 100? Again, the proof of the integral test suggests a way to estimate this. As before, iffis continuous for 1 :'S: x < 00 and is positive and decreasing, then m+1 f(m + 1) :'S: f f(x) dx :'S: f(m) Om n-I so that nL f(k) :'S: f f(x) dx :'S: L f(k) 2 1 1 and (5-27) n n f(n):'S: L f(k) - Lf(x) dx:'S: f(l) 1 Applying this, for example, to the seriesL ~ lin, we see that n 1L k = log n + Cn 1 where 0 < Cn :'S: 1. (In fact, lim n _ oo C n exists, by Exercise 10, Sec. 5.2.) Applied to our case of the harmonic series, we see that AN > 100 if log N > 100, or N > e100 , which is about 2.69 x 1043 . (R. P. Boas has informed us that the first value of N for which AN > 100 is 1509 26886 22113 78832 36935 63264 53810 14498 59497 which is smaller, being 1.509 x 10 43 .) If we analyze the relationship between partial sums and related integrals more carefully, we can obtain a result that is useful in estimations. 252 ADVANCED CALCULUS Theorem 17 Letf E en withf(x) 2: O,f\"(x) ~ Ofor 1 ~ x < 00, Let an = f(n)for n 2: 1, and set n n Sn = L ak - Lf(x) dx -1/(n) 1 Then, {Sn} is a bounded sequence,. specifically, (5-28) /(1) -1f(2) ~ Sn ~ 1/(1) Before proving this, let us use it to obtain a standard estimate. We will find an approximation for the value of n! which is useful when n is large. Observe that log (n!) = L: log k. Apply the theorem with f(x) = log x, and we find n (5-29) Sn = log (n!) - f log (x) dx -110g n 1 = log (n!) - n log n + n - 1 -110g n where -1 log 2 ~ Sn ~ O. We can rewrite (5-29) as (5-30) (5-31 ) where Cn = exp (1 + Sn), and where we have e 1.922 < fi ~ Cn ~ e = 2.718 ... (In Sec. 6.5, it will be found from a different estimate that the sequence {Cn} converges to J21t; this fact, together with (5-30), is called Stirling's formula for factorials. ) This formula is often useful in working with series whose coefficients involve factorials. Consider 1 + (1)(1' 2) x + (1 '2)(1' 2 . 3· 4) x 2 + .. , + n!(2n)! xn+ '\" (1'2'3) 6! (3n)! We can use (5-30) to estimate the size and behavior of the coefficient of x n, writing n! (2n)! (nne-njn)[(2n)2ne-2n~] enc2n (3n)! = (3n)3ne-3n~ . ~ = ( n3n e- 3nn2 2n ) (fiCn C2n) ~ n(~)n n3ne-3njn33n j3C 3n jn 27 Returning to the series, this tells us that it converges for IxI < 1(- and that it diverges at each endpoint, since the series there becomes one whose nth term is like jn or ±jn, and thus does not approach O. 51]<1105 253 The proof of Theorem 17 starts with several simple geometric observa- tions. Sincer is negative, f' is decreasing for <Ill x > I. Since f remains positive. f' can never be strictly negative; thus, f'(x) ~ 0 and f itself is increasing (Exercise J I, Sec. 3.2). Also. Fi~. 5·1 makes plausible the following (which W<lS proved us Exercise 13. Sec. 4.2.): (5-32) I _ -' (a+h)Ih - al(f(a) + 1(1,)) ,; I I,; (b - a)1 2 'a 2 For any 11 ~ 1. we have ~ 2 3 ~ r/~r/+r/++rl • l • I • 2 • ~- I The left side of (5-32) gives I k+ l 2 (f(k) +Ilk + I))'; J. I so that adding Ihese. I I .~ 1(1)+/(2)+/(3)+---+/(,,-I)+2/(a),;1 I2 _, and if(k)'; (I + ~f(,,) + ~1(1), This proves the right side of (5-28). To complete the proof of the theorem, two cases must be considered. Suppose first that II is odd. Write .~ .3 .5 . ~ I/~I/+I/++I I • I • I • J • ~- 2 From the right side of (5-32). we have , r 1,;2/(k-l) . t- 2 254 ADVANCED CALCULUS which yields at once (5-33 ) , n I f ~ (2)(.f(2) + f(4) + .. , + f(n - I)) , 1 Alternatively, we can write .n ,2 ,4,6 ,n-I.n 1 f=1 f+1 f+1 f+'''+1 f+1 f 'I 'I '2 '4 'n-3 'n-I ,2 ,n ~ (2)(.f(3) + f(5) +,\" + f(n - 2)) + I f + I f , 1 ' n- 1 Adding this to (5-33), we arrive at ,n n-,I ,2 ,n 2J/~2L f(k)+J1f+J n_/ 2 U sing the fact that f is increasing to estimate the integrals, and including the termsf(l) andf(n) in the sum, we obtain n n 2 .1'/ ~ 2L f(k) - 2f(l) - 2f(n) + f(n) +f(2) 1 which yields (r + 1f(n) - ~ f(k) ~!f(2) - f(1) 'I 2 L- 2 1 and we have proved the left half of (5.28) when n is odd, When n is even, the argument is almost the same, using , n ,2 ,4 , n 1 f=1 f+1 f+'''+1 f , 1 ' 1 ' 2 ' n- 2 and ,n ,3 ,5 ,n-I ,n I f= I f + I f + '\" + I f + I f 'I 'I '3 'n-3 'n-I to end with the same estimate. I A very similar estimation theorem can be proved if.f\"(x) is positive (see Exercise 8), Something similar can also be done with double series (see Exercise 11), At times, a very different process is used to obtain estimates for the sum of a convergent series, It is usually referred to as \"acceleration of convergence,\" since it is a method which replaces the given series by another whose terms tend to 0 faster, and for which a numerical estimate can be obtained by a partial sum involving fewer terms. The method depends on finding another SERIES 255 series whose sum is known and whose terms are similar in size to those of the given series. As an illustration, consider the series 2: ~ I/n 2 , whose sum we denoted earlier by C. Write I n+l n 1 ;;2 = n2 (n+0 = n2(n-+0 + n2 (n + 1) I 1 = ~~- + ---:--- n(n + 1) n2(n + 1) Accordingly, The first series on the right is recognized as a telescoping series L ~ [lIn - I/(n + I)], convergent to 1. Hence, we have replaced the original series by one whose terms, being cubic in n, decrease more rapidly: This process can be repeated again, to accelerate the convergence of the new series. We have 1 n + 1 1 2n + 1 1 1 ~- ~---- = --~~ = -~---- + - ---~- n2(n + 1) n2 (n + qz 2 n2(n + 1)2 2 n2 (n + qz and noting that 2n + 1 ;?(n + 1)2 we find (Since the first series telescopes.) The last series converges more rapidly than the original series, since the terms decrease like n- 4 . The number C = 2: ~ I/n 2 256 ADVANCED CALCULUS has now been shown to be (5-35) and nine terms of this gives C ;:::: 1.644767731. Kummer replaced this ad hoc procedure by a systematic technique, described in the following statement. Theorem 18 Let.2: an converge, and let.2: bnconverge with sum B; suppose also that lim a,jbn = L. Then, .2: ~ an = BL + .2: ~ Uk ak, where Uk = 1 - Lbk/ak. The point of this result, whose proof is left to the reader, is that Uk --+ 0; thus the new series converges more rapidly than the original series. The chief difficulty in using this result is in finding a convenient series.2: bn with a known sum B whose terms {bn} behave enough like those of the original series {an} so that lim a,jbn exists. As illustrated in the examples, .2: bn is often chosen as a telescoping series for this reason. Simple algebraic ingenuity is often the key in evaluating the sum of a series. Here is a sample from the early years of the subject. We will show the following: (5-36) oc 1 25 .2: n2 - 4 = 48 n=3 Our first step is to write out the first half dozen terms in factored form. 11111 1 1 1 M + 2 . 6 + 3 . 7 + 4· 8 + 5 . 9 + 6 . 10 + ~ + 8 . 12 + ... We next observe the following: 1 = G-~)+ G-~)+ (~-113)+ ... 4 4 4 4 4 = M + 5·9 + 9· 13 + 13' 17 + 17·21 + ... This suggests the next observation: ~= U-~)+ (~-1~)+ C~-1~)+ (1~-'\" 4 4 4 4 = 2 . 6 + 6 . 10 + 10· 14 + 14· 18 + ... (5-37) SERIES 257 Comparing these two series with the terms in (5-36), we try two more tele- scoping series, H- i) + (i - -Ir) + ... and (! - M+ (~ - -b) + \"', and thus obtain oc _1 __ ~ (1 ~ ~ ~) _ 25.2 n2 - 4 - 4 + 2 + 3 + 4 - 48 3 Several other equally simple procedures for estimating the sum of a series will be found in the exercises. We end this chapter with a computation of the exact value of the number C, showing that C = n 2/6 = 1.644 934 06... ; however, this computation is done in the spirit of the eighteenth century, rather than of today. We leave it to the reader to evaluate the rigor of the method. (That the answer is indeed correct will be shown rigorously in the next chapter, Sec. 6.6.) We borrow a result which may be familiar from elementary calculus, but if not, will be shown in the section on power series in the next chapter, namely that x 2 x 4 x 6 cos X = 1 - - + - - - + ... 2 4! 6! We also record a fact dealing with the roots of polynomials: If P(x) has roots 131,132' ... , 13m' none 0, and we write P(x) = (131 - X)(132 - x) ... (13m - x) = aO + alx + a2 X 2 + ... then ao = 131132133 '\" 13m and -a l = 132133'\" 13m + 131133134135 ... 13m + 131132134'\" 13m + ... + 131132 ... 13m-1 Thus, (5-38) We next observe that cos x = 0 if and only if x = ±n/2, ±3n/2, ±5n/2, .... Hence, the roots 13k of cos ~ = 0 are exactly n 2/4, 9n 2/4, 25n 2/4, .... From (5-37), we have 1 1 cos ~ = 1 - - x + - x 2 - ... 2 24 Comparing this with P(x), we see ao = 1 and al = -l Hence, by (5-38), SERIES 259 are balanced In a horizontal posItion, the whole is supported by a thread from the top stick to the ceiling. How much space must be allowed for the rotation of the mobile? 4 Apply Exercise 4, Sec. 5.3, to show that the number S = .2~ (- 1)\"/(11 + 1)2 lies between .818 and .828. (Remark The average of two successIve partial sums of an alternating series is often very accurate; In this example, two such sums are .8179 and .8279, and their average is .8229, while the true value of Sis 7t 2/12 = .82246703···.) 5 Estimate the sum of each of the following series, accurate to .005: (a) ~ (-1)\"11/10\" x .2 I (b) (_1)\"+1 11 3 I 6 Decide how many terms of the series .2 ~ (- 1)\"+ l(l/J~) would have to be used to be sure of an estimate for the sum, accurate to .005. 7 Letf(x) 2 O,f'(x) 2 O,r(x) 2 0 for I s x < 00. Show that Os')'\" f(k) - (f - if(ll) - if(l) S H'(Il) for 11 21. ...... 1 '1 8 Letfbe of class C\" on I s x <x, with f(x) > O,f'(x) < 0, r(x) > O. Suppose that the series \"> oc f(ll) converges. Using the same ideas as those of Theorem 17, prove that L., 1 o s 2: f(ll) - JN X f(x) dx - if(N) s if'(N) N ,.N \"N 9 Apply Exercise 7 to estimate the sums 2... 1 e and L I k 3 , then compare these estimates with the exact values. (The latter can be found by induction.) 10 Show that L; 1/(112 + 311 - 4) = 137/300. II Apply Exercise 8 to estimate the sum of the series.2 ~ (-1)\" + 1 (l/J~)within .005 by grouping terms in pairs, choosing I I f(x) = ;::c--- - h:. v' 2x - I v' 2x [You will have to select N, apply Exercise 8, and make a separate calculation for .27- I f(Il).] . ;; (31l)! 12 DISCUSS the convergence of 2 ---'3 x\" \"= I (Il!) 13 In Exercise I(e) and (d), Sec. 5.2, rewrite the terms of the series using factorials and use (5-30) to determine convergence or divergence of the series. 14 Show that the sum of the double series in Exercise 8 Sec. 5.4 is exactly 7/24. 15 Approximately how many points p = (m, 11), with m and 11 integers larger than 0, obey Ipl s R? 16 Show that a reasonable value for this unending product is 1/2. 17 What IS a reasonable value to assign to the unending expression: CHAPTER SIX UNIFORM CONVERGENCE 6.1 PREVIEW This chapter and the one to follow involve a noticeable increase in mathematical sophistication and rigor. As motivation for this, the chapter begins with a number of paradoxical examples in which a reasonable procedure is shown to yield an incorrect answer. Each time, the procedure involves the inter- change of two limiting operations. The main theme of most of the chapter is \"uniformity,\" treated first for series and sequences, and later, in Sec. 6.4, for improper integrals. A series of functions that is uniformly convergent turns out to behave far more rationally than one that is merely pointwise convergent. Thus, one can integrate termwise, take limits under the summation sign, etc. The power of this is shown by sketching a proof of the Tietze extension theorem (for sets in n-space) and by constructing a standard example of a continuous function that is everywhere nondifferentiable. An important part of Sees. 6.3 and 6.4 are the illustrations of useful techniques for evaluating integrals and summing power series. In the same spirit, Sec. 6.5 (which is not essential for later sections) treats the gamma and beta functions, and contains a derivation of Stirling's formula to illustrate how one may estimate the asymptotic behavior of a typical improper integral. Finally, Sec. 6.6 contains an introduction to the study of general orthogonal expansions and Fourier series, presented as a study of the space of continuous functions with a notion of convergence different from pointwise or uniform. 260 UNIFORM CONVERGENCE 261 6.2 SERIES AND SEQUENCES OF FUNCTIONS In the last chapter, we discussed the convergence of series whose terms involved one or more parameters or variables. In essence, we were there dealing with a particular notion of convergence of a series of functions which can be formalized as follows. Definition 1 Let each of the functions Un be defined for points of a set D. Then the series 2: un is said to converge pointwise on a set E c D if and only if2: un(p) converges for each p'E E. If we denote the sum of 2: un(p) by F(p), then we say that 2: Un con- verges pointwise to F on E. For sequences, a similar definition is used; {In} converges pointwise to F on E if for each point pEE, limn_ oo fn(P) = F(p). There are also a number of other important and useful notions of con- vergence for series and sequences of functions; before introducing these, let us observe some of the shortcomings of pointwise convergence. Each of the following examples represents a plausible, but unfortunately invalid, argument dealing with series or sequences of functions. Consider the series 00 (6-1) 2: x(l - x)n = x(1 - x) + x(1 - X)2 + ... 1 Standard techniques from the last chapter show that this converges for each x with 0 S x < 2. For these values we denote the sum of the series by F(x). We also note that (6-1) converges for x = 0, and thus F(O) = O. We pose the following question: (6-2) What is the value of lim F(x)? x I 0 Examining (6-1), we note that lim x _ o x(1 - x)n = O. This means that if we were to let x approach 0 in the series in each term, separately, we would obtain the series 0 + 0 + 0 + .... Is this argument valid? Can we find the limit of a function defined by a series by taking the limit termwise? In this example, the answer is \"no.\" To explain this, we calculate F(x). We have, from (6-1), F(x) = x(1 - x) + x(1 - X)2 + x(1 - xp + .. = x(1 - x){1 + (1 - x) + (1 - X)2 + } 262 ADVANCED CALCULUS and summing the geometric series, we have 1 F(x)=x(l-x) (1 )= I-x 1 - - x so that the correct value for lim x ~ 0 F(x) = 1, not O. Our second example is the following. Consider the series (6-3) This converges for every x, 0 :S x < 00, since nx 2 nx 2 x 2 ~-~<-=- n3 + x 3 - n3 n2 and 2: x 2/n 2 converges. Again, let F(x) denote the sum of (6-3). This time, we ask: (6-4) What is lim F(x)? If we look at the behavior of each term of the series separately, we find lim._ oo nx 2/(n 3 + x 3 )= O. Thus, termwise, the series for F(x) approaches 0, suggesting that the answer to (6-4) is the number O. This again is false, as seen thus. Take any x > O. Then, for any n with x/2 < n < 2x, nx 2 (x/2)x 2 1 ~--.>-;-::-,~~~ n3 + x 3 - (2X)3 + x 3 18 In the series for F(x), there are therefore (2x) - (x/2) terms, each larger than -fg, so that since all the terms of the series are positive, F(x) 2 (3x/2)(-fg) = x/12. Since this is true for any x, lim F(x) = 00 xtoo For the third example, consider (6-5) 2:[(n + l)x - n]x· = (2x - l)x + (3x - 2)x 2 + ... I Calling the sum of this F(x), what is lim x _ 1 F(x)? Termwise, we obtain 1 + 1 + 1 + 1 + ... , which strongly suggests that limx _ 1 F(x) = 00. However, if we expand each term of the original series, we obtain (2x 2 - x) + (3x 3 - 2x 2 ) + (4x 4 - 3x 2 ) + ... which is a telescoping series whose partial sum is - x + nx·, and which therefore converges to F(x) = - x for all x, Ix I < 1. Accordingly, lim F(x) = -1. x-I UNIFORM CONVERGENCF 263 The next two examples involve differentiation and integration. Consider the series (6-6) which converges for all x (absolutely). If we differentiate termwise, we obtain the supposed equality 00 .2 cos (n 2x) = F'(x) 1 However, the truth of this is dubious, since the series can be seen to be divergent for every choice of x. (The terms do not approach 0.) Finally, we propose to calculate the value of (6-7) 1 lim J n 2xe- nx dx \"-00 0 For any choice of x, n2xe- nx approaches 0 as n increases, since enx grows so much faster than n 2 . Thus, the integrand approaches 0 pointwise for all x, os x S 1, and one might conclude that the value of the limit (6-7) must be O. However, if we put u = nx, the integral becomes r\"ue- u du = 1 - (n + l)e- n-+ 1 • 0 All these paradoxical examples involve the reversal of two limit processes. In the first, for instance, we were concerned with the possible equality of (6-8) and In the last two examples, this may not be so apparent, but integration and differentiation both involve hidden limit operations. In circumstances such as these, the notion of uniform convergence of series or sequences of functions is especially useful. To simplify the discussion, we introduce a special notation. If f is a function which is defined on a set E, then II filE will denote the least upper bound of the set of values If (p) I for pEE; when f is continuous on E and E is closed and bounded, this is the maximum value of If(p)1 on E. Iff and g are both defined on E, then Ilf - gilE is a measure of the distance between f and g over the set E. If Ilf - gilE < e, then If(p) - g(p)1 < e for all pEE so that f approximates g within e uniformly on E (see Fig. 2.5). Definition 2 A sequence of functions Un} is uniformly convergent to a function F on a set E if and only if limn_ oo IIF - fnllE = O. 264 ADVANCED CALCULUS Figure 6-1 Nonuniform convergence. If we restate this without using the special notation, it becomes: {In} con- verges to F uniformly on E if and only if for any E there is an N such that for any n 2 N and any pEE, IF(p) - fn(P) I < E. If a sequence {In} is uniformly convergent on a set E, then it is certainly pointwise convergent for at least all points of E. However, it may converge pointwise on E and not uniformly on E. Examine again the sequence fn(x) = n2xe- nx As we saw, this sequence converges pointwise to 0 on the interval E = [0, l]' The convergence is not uniform on E. The maximum of fn on E occurs for x = lin and is fn(l/n) = nle, so that limn _ oo 11f\"IIE is not O. This behavior is also evident from the graphs of the functionsfl,f2' ... (see Fig. 6-1). The definition of pointwise convergence can also be given as follows: {In} converges to F pointwise on E if and only iffor any e > 0 and any point pEE, there is an N such that whenever n 2 N, IF(p) - fn(P) I < B. Comparing this with the corresponding definition of uniform convergence, we see that the essential difference lies in the fact that in uniform convergence, N depends only upon B, while in pointwise convergence, N depends upon both Band p. Uniform convergence of series is defined by throwing it back onto the sequence of partial sums: 2 ~ Un converges to F uniformly on E if and only if {In} converges to F uniformly on E, where fn =2: Uk' An alternative statement is: 2 Un ~onverges uniformly on E if and only if2 Un converges pointwise on E and limn _ 00 112: Uk II E = O. UNIFORM CONVERGENCE 265 It is often convenient to adopt the viewpoint that functions defined on a common set E can be regarded as geometric points in what is usually called function space, and that the metric, or measure of distance between points, is given by lif- giIE' This enables us to use geometric terminology and analogy to help motivate concepts and calculations. For example, a sequence of functions f\" is said to have the Cauchy property uniformly on a set E if for any £ > ° there is an N such that 11f\" - fm/IE < £ whenever n 2 Nand m 2 N (see Sec. 1-6). As before, this is often written limn, m-oo IIIn - fmllE = 0. Any uniformly convergent sequence has the Cauchy property; for, if {In} --+ F uniformly on E, then for any point pEE, Ifn(P) - fm(P) I = If\",(p) - F(p) + F(p) - fm(P) I :-s; IIIn - FilE + IIF - fm/IE so that limn,m_oo lifn - fmllE = 0. The converse also holds. Theorem 1 If limn, m- 00 1/ f\" - fm liE = 0, then there is a function F to which the sequence {In} converges uniformly on E. Since If,,(p) - fm(P) I :-s; I/In - fmllE for each point pEE, {f,,(p)} is a Cauchy sequence of numbers and is therefore convergent. Define F by F(p) = limn_ oo f,,(p). F is then the pointwise limit of fn on E. To show that the convergence is actually uniform, take any pEE and write IF(p) - fn(P) I = IF(p) - f,,(p) + fk(P) - fn(P) I :-s; IF(p) - fk(P) I + Ifk(P) - f,,(p) I :-s; IF(p) - fk(P) I + 11f\" - fnllE Given £ > 0, choose N so that Il.h - fnllE < £ whenever n 2 N, k 2 N. For each pEE, limk _ oo fk(P) = F(p); we may then choose k larger than N and dependent upon p and £, so that IF(p) - fk(P) I < £. Making this choice of k in the inequality above, we have IF(p) - f,,(p) I < £ + £ = 2£ holding now for each n 2 N and each point pEE. Hence, !IF - f\"IIE < 2£ for all n 2 N, and {f,,} is uniformly convergent to F on E. I In the language of Sec. 1.7, the space of functions is complete with respect to uniform convergence; for series, the corresponding statement is the following. Corollary If limn, m-ce ilL~Uk II E = 0, then L Uk is uniformly convergent on E. 266 ADVANCED CALCULUS The simplest and most useful test for uniform convergence is the following comparison test, also called the M test. Theorem 2 (Weierstrass Comparison Test) If IlukllE ~ M k for all k, and 2.: ~M k converges, then 2.: ~ Uk converges uniformly on E. F or any pEE, Iuk(p) I ~ M k, so that by the simple comparison test (Theorem 5, Sec. 5.2), ~ ~ Uk(P) converges pointwise on E. Estimating the tail of this series, uniformly, we have 12.:: Uk(P) 1~2.:: Mk for all pEE, and thus limn _ oo 112.:: Uk IIE ~limn _ oo 2.:: M k = 0, proving uni- form convergence of2.: Uk on E. I As an illustration, 2.: ~ sin (nx)/n 2 converges uniformly for all x, - 00 < x < 00, since Isin (nx)/n21 ~ 1/n 2 and 2.: 1/n2 converges. We take up next a very important property of uniform convergence. Theorem 3 If {In} converges to F, uniformly on E, and each function fn is continuous on E, then F is continuous on E. We prove that F is continuous at an arbitrary point Po E E. Given 8> 0, first choose N so that /IF - fN/IE < 8. For any point P in E we may write IF(p) - F(po)! = IF(p) - fN(P) + fN(P) - fN(PO) + fN(PO) - F(po)! ~ IF(p) - fN(P) I + IfN(P) - fN(PO)! + I!N(PO) - F(Po)1 ~ 211F - fNllE + IfN(P) - fN(PO) I ~28+ IfN(P)-fN(Po)1 Since fN is continuous on E, we may now choose 15 so that IfN(P) - fN(PO) I < 8 whenever pEE and IP - Po I < J. We thus obtain IF(p) - F(Po)1 < 38 whenever pEE and Ip - Po 1< 15, proving that F is continuous at Po· I Stated for series, this becomes: Corollary If each of the functions Un is continuous on a set E, and 2.: Un converges to F uniformly on E, then F is continuous on E. Theorem 3 and its corollary can also be described in topological terms. Let <f? be the class of functions f that are continuous on E. Then, Theorem 3 states that the set <f? is a closed set in the space of all functions on E. UNIFORM CONVERGENCE 267 The corollary also has another interpretation that is related to the examples with which we started this section, for an equivalent statement is 00 00 and this has the same meaning as (6-8), dealing with the interchange of limit operations. Returning to the examples which opened this section, the series in (6-1) was a series of continuous functions, but its sum is the discontinuous function described by F(x) = 1,°< x ~ 1, F(O) = 0. The series is therefore not uniformly convergent on [0, 1]. In fact, it cannot be uniformly convergent on the open interval °< x < 1, even though F is continuous there. This is shown by the following general theorem. Theorem 4 Let E be the closure of an open set. Let {In} converge uniformly in the interior of E. Suppose that each function j\" is continuous on E. Then {j,,} is uniformly convergent on E. Given E > 0, choose N so that Ifn(P) - fm(P) I < E whenever n ~ N, m ~ N, and p is an interior point of E. Since fn and fm are both continuous on E, so is <jJ(p) = Ifn(P) - fm(P) I, and since <jJ is bounded by E on the interior of E, it is bounded by E on all of E. This shows that Ilfn - fm/IE ~ E for all nand m with n ~ N, m ~ N, and {j,,} converges uniformly on E, by Theorem 1. I A useful application of this to series of continuous functions is: Corollary Let L ~ un(x) converge to F(x), uniformly for all x with c ~ x < 00. Let limx too un(x) = bn < 00 for n = 1, 2, .... Then, L ~ bn converges, and limx too F(x) =L ~ bn· Setting x = l/t, we obtain a series of functions which converges uniformly for 0< t ~ a. Since lim t _ o un(l/t) = bn, we can define the terms so as to be continuous at t = 0. Applying the theorem, the series is uniformly convergent for °~ t ~ a, and we can evaluate lim F(~)= lim F(x) tjo t xtoo termwise. I Returning to Example (6-3), the series F(x) = L ~ nx 2/(n 3 + x 3 ) converges uniformly on each of the intervals [0, R], since Inx 2/(n 3 + x 3 )1 ~ nR 2/n 3 = R 2/n 2 and 2: ~ l/n 2 converges. However, it cannot converge uniformly on the 268 ADVANCED CALCULUS whole unbounded interval 0:-:::; x < 00, since limx ! 00 F(x) = 00, although limx!oo nx2/(n 3 + x 3 ) = 0 for each n. The next theorem is the fundamental result dealing with integration of uniformly convergent series or sequences. We state it in a two-dimensional form. Theorem 5 Let D be a closed bounded set in the plane which has area, and let the functions fn be continuous on D. Then, if {/,,} converges to F uniformly on D, limn _ oo IfD fn = IfD F. If F exists since F is continuous on D. For any n, we have D IIi F - Ii fn I = IIi (F - fn) 1:-:::; Ii IF - /,,1:-:::; IIF - /\"IIDA(D) since IIF-fnIID is the maximum of IF(P)-fn(p)1 for pED. Since limn_oo IIF - fnllD = 0, limn_oo fr fn = rf F. I • D • D If {In} is the sequence of partial sums of a seriesL~ Uk' then ff fn = ff (Ul + U2 + ... + un) = ff Ul + ff U2 + .,. + ff Un D D D D D leading to the following corollary. Corollary If each of the functions Un is continuous on D and ~ ~ Un con- verges to F uniformly on D, then rr F = \"\" 00 rr Un' \"D Ll\" D This is usually abbreviated to the statement that a uniformly convergent series may be integrated term wise. As an illustration, consider the series L: (- t)n. This converges to 1/( 1 + t) uniformly on any interval - r :-:::; t :-:::; r, for r < 1. Integrating the series term wise between 0 and x, Ix I < 1, x dt 00. x \"'- xn + 1 r - = log (1 + x) = \"\" (- I)n I tn dt = L (- I)n ----- 'ol+t L· o n+lo 0 Thus, for any x with Ixl < 1, x 2 x 3 x n log (1 + x) = x - - + -- - ... + (- l)n - 1 + ... 2 3 n UNIFORM CONVERGENCE 269 We can also extend this to the endpoint x = 1 by a special argument. If x> 0, the series L~ (_1)n- [(xnln) is an alternating series and converges for o :S: x :S: 1. Using the fact (see Exercise 4, Sec. 5.3) that the partial sums of an alternating series constantly approach the sum and alternatively lie above and below, so that the error at any stage does not exceed the next term, we may write I n x k I x n + [ 1 log (1 + x) - '\" (- l)k - [- :S: -- :S: -- L k n+l n+1 [ for each x with 0 :S: x < 1. However, since all the functions involved in this are continuous at x = 1, the same inequality holds when x = 1. This shows that the series is uniformly convergent on the closed interval [0, 1], and termwise integration is valid for all x with 0 :S: x :S: 1. In particular, setting x = 1, we have log 2 = 1 - ~ + 1- -} + ~ - i + ... The functions j,,(x) = n 2xe- nx of Example (6-7) converge to 0 pointwise on [ [0, 1] but do not converge uniformly on [0, 1], and their integrals f fn o converge to I, not O. Examining their graphs (Fig. 6-1), we see that fn has a peak near the origin which becomes narrower but higher as n increases, leaving the total area underneath the curve about constant. For contrast, consider the function gn(x) = nxe - nx. These functions likewise converge to 0 pointwise, but not uniformly, on [0, 1]. However, it is easily seen [ from the earlier calculations with (6-7) that f gn -> o. The difference is that o this time, the functions gn are uniformly bounded on [0, 1]. None of the peaks of the functions gn reaches higher than lie. This example is an instance of a general convergence theorem for bounded functions. While it is very useful, its proof requires techniques that go beyond this text, involving portions of the theory of Lebesgue measure. We therefore state the result here without proof, but include a sketch of the argument in Appendix 6. Theorem 6 If the functions fn and F are integrable on a bounded closed set E, and Un} -> F pointwise on E, and if II fn II E :S: M for some M and all n = 1, 2, ... , then limn _ oo f j\" = f F . • E • E This may often be used when uniform convergence does not occur. Let 9 be continuous (and therefore bounded) on [-1, 1]. Then, the sequence Un} withj,,(x) = e- nX2g(x) is uniformly bounded on [-1, 1] and converges pointwise to the function F x;60 x=O 270 ADVANCED CALCULUS This is not continuous if g(O) #- 0, so that {j,,} does not in general converge uniformly. However, Theorem 6 applies, so that 1 lim f exp (- nx 2 )g(x) dx = 0 \"-00 -1 As we have seen in illustrative example (6-6), the process of differentiation of series is not well behaved. There we saw that a series such as 2: ~ n- 2 sin (n 2x)could be uniformly convergent everywhere, and yet not allow termwise differentiation. Termwise integration is much better. This can be used to obtain a valid result for differentiation, showing that termwise differentiation is justified if the resulting series of derivatives is itself uniformly convergent. Theorem 7Let 2: ~ un(x) converge to F(x) for each x in [a, b]. Let u~(x) exist and be continuous for a s x s b, and let L u~(x) converge uniformly on [a, b]' Then, L~ u~(x)= F'(x). Setting g(x) = 2: u~(x), integrate termwise between a and x, so that (g =i (u~=i [un(x) - un(a)] a 1 a 1 = F(x) - F(a) This shows that F is an antiderivative (indefinite integral) of g, so that F'(x) = g(x) for all x in [a, b]' I As an illustration of this, consider the series F(x) = 2: ~ e- n2X, which converges for all x > O. We shall show that F is continuous and of class COO on this interval, that is, F(kl(X) exists for all x > O. The termwise derivative of the series is (- 1)2: ~ n2 exp ( - n2x). If <5 > 0, then for all ;c 2 <5, In 2 exp (-n 2 x)1 S n2 exp (-n 2 <5), so that the derived series is uniformly con- vergent for all x, <5 s x < 00. This shows that F'(x) exists and is given by (- 1)2: ~ n2 exp ( - n2x) for all x > O. Repetition of this process leads to 00 F(k)(X) = (-lt2: n2k exp(-n 2x) 1 k = 1,2, ... where the series is uniformly convergent for <5 S x < 00 and any <5 > O. We conclude this section with a number of special examples. Let 00 (6-9) F(x) =2: x/n(x + n) 1 UNIFORM CONVERGENCE 271 Since Ix/n(x + n) I s l/n 2 for all x in [0, 1], this series is uniformly convergent there, and may be integrated termwise. The resulting series, 00 1 X dx 2: fo n(x + n)' 1 must converge. Denote its sum by y, so that 00 1 II I} y= 2: f --- dx Ion x+n N· = lim tt ~-log(N + l)} N-oo 1 n Since limN _ cc [log (N + 1) - log N] = 0, we have thus shown that there is a positive number y such that N 1 2: n= log N + Y + (J N 1 where lim (IN = O. The number y is called Euler's constant, and is approximately .577 21 .... Let cc converging for all x#-O(6-10) F(x) = 2: 1/(1 + n2x 2) 1 For any <5 > 0, and x z <5, we see that (1 + n2x 2r 1 S l/n 2 <52, so that the series is uniformly convergent for all x, x z <5. Appealing to the corollary to Theorem 4, limx roo F(x) = O. How does F behave near the origin? When x = 0, the series becomes 1 + 1 + 1 + ... , which suggests that lim F(x) = 00. x I 0 This conjecture is correct. For any N, N 1 F(x) z 2: 1+~ix2 = g(x) 1 and g(O) = N so that lim inf F(x) z N x I 0 and letting N increase, we see that lim x I 0 F(x) = 00. This approach cannot always be used, and depends upon the fact that the terms of the present series are positive. (For comparison, recall illustrative example (6-5), where we had a 272 ADVANCED CALCULUS series whose terms also approached I + 1 + 1 + .. \" but for which this did not mean that the function in question approached infinity.) Continuing our study of the function F, consider now Since x 2/{l + n2x 2) ::; l/n 2 for all x, - 00 < x < 00, this series is uniformly convergent on the whole axis. In particular, lim x _ o x 2F(x) = 2: 0= 0, and Finally, consider xF(x) = 2: ~ x/( 1 + n2x 2). This converges uniformly on the intervals <5 ::; x < 00, for any <5 > 0. Does it converge uniformly for °::; x::; <5? If so, then limx \" 0 xF(x) would have to be 0; we shall show that instead, limx \" 0 xF(x) = n/2. For any n, x r n + 1 x x 1 + (n + Wx 2 ::; . n -1-+-----ct2°-x~2dt ::; -1-+;2;;2 and adding, or However, 00 x xF(x) ::; f 1 2 2 dt ::; x + xF(x) o + x t f 00 x dt f 00 du 1 o I + x 2t2= 0 I + u2 = 2n > so that Pr - x::; xF(x) ::; !n, for all x> 0. Letting x approach 0, we have lim x \" 0 xF(x) = !n. Summarizing what we have found, the function F behaves near the origin like n/(2x), and for large x like Ax - 2, where (= n 2/6). Theorem 3, on the continuity of the uniformly convergent sum of a series of continuous functions, is often used to construct continuous functions that have strange and unlikely properties. For example, (1 + x 2r lX 2 sin (l/x) = g(x) is a continuous function that is differentiable everywhere, even at x = 0, where g'(O) = 0. Note also that Ig(x)1 ::; 1 for all x. The function g is not monotonic on any neighborhood of x = °because of the rapid oscillations of the sine function near there. Displacing g by forming gAx) = g(x - c), we have a function that has the same sort of behavior at x = c. If cn is any UNIFORM CONVERGENCE 273 -h o 1 Figure 6-2 sequence of real numbers, then 00 00 G(x) = L ;ngc.(x) = L ;ng(x - Cn) n=1 n=1 is a continuous function that is not monotonic on any neighborhood of the points C I , cz , .... These points Cn can be everywhere dense on the line. The same technique makes it possible to construct a simple example of a nowhere differentiable continuous function. Let K be the special function defined by saying that K(x) is the distance from x to the nearest integer; K is continuous everywhere, and periodic with period 1 (see Fig. 6-2). We note that K also has the property that IK(b) - K(a)1 = Ib - al whenever a and b both lie in the same half of any interval [m, m + 1]. Set un(x) = lO-nK(lOnx ) for n = 0,1, ... , and then define the sought-for function H(x) for all x by (6-11) The function K has corners where the derivative fails to exist, and the UNIFORM CONVERGENCE 275 By virtue of this result, any bounded continuous function on a closed set may always be regarded as bounded and continuous on all of n space. The proof of this result depends on the use of a special auxiliary function which is defined geometrically. Lemma If C is a closed set, and ¢(p) = d(p, C), the distance from p to C, then ¢ is everywhere continuous, and strictly positive off C. Let p, q, and c be three points with c E C. The triangle property for distances shows that Ip - cl ::; Ip - ql + Iq - cl· Since d(p, C) = inf Ip - cl C E C we have ¢(p)::; Ip - ql + Iq - cl· This holds in turn for every cE C, so that ¢(p) ::; Ip - ql + ¢(q). By symmetry, ¢(q) ::; Iq - pi + ¢(p), so that, putting these together, I¢(p) - ¢(q) I ::; Ip - q I. This shows that ¢ is every- where (uniformly) continuous. If ¢(p) = 0, then p = lim Cn for a sequence {cn} of points of C. Since C is closed, p E C. I To prove the theorem, we produce a series.2: ~ F n of continuous func- tions which converges uniformly in the whole plane, and whose sum on the set E is f. Suppose that If (p) I ::; M for pEE. Divide E into three sets A = {all pEE where ~ ::;f(p) ::; M} { -M M}C = all pEE where ~3- <f(p) < 3 B = {all pEE where -M::;f(p)::; -3~} and construct a function F I by the definition ( M) d(p, B) - d(p, A) Fdp) = 3- d(p, B) + d(p, A) Since A and B are disjoint closed sets, F I is everywhere defined and is everywhere continuous. For any point p in the plane, IF I (p) I ::; M/3. On E, F 1 behaves as follows: If pEA, d(p, A) = 0 and F1(p) = M/3. If p E B, d(p, B) = 0 and F1(p) = -M/3. If p E C, then -M/3 ::; F1(p)::; M/3. 276 ADVANCED CALCULUS An examination of the values off on E shows that If(p) - F 1(p)1 ::; iM for all pEE. Repeat this argument withf - F 1 playing the role off On E, f - F 1 is bounded by (2M )/3. We can therefore construct a function F2 which is everywhere continuous and such that IF2(P) I ::; (j-)(2M/3) for all p, while I[f(p) - F 1(p)] - F2 (p)1 ::; H)(2M/3) for pEE. Continuing this, we arrive at a sequence of continuous functions {Fn } which obey the two conditions: IFn(p) I ::; jm n - 1M all p If(p) - {F1(p) + ... + Fn(p)} I ::; (~)nM all pEE The first condition assures us that the series2: ~ F n is uniformly convergent for all p. The sum F is then, by Theorem 3, continuous everywhere in the plane. The second condition shows that oc F(p) = 2: Fn(p) = f(p) 1 for all pEE. Finally, for any p so that F is bounded on the whole plane by the same bound that applied tof on E. I EXERCISES I Show that ifI. converges pointwise to I on E, then!. -+ I uniformly on every finite subset of E. 2 Exhibit a sequence {I.} which converges uniformly on every interval [0, L) for every L > 0, but not uniformly on the interval 0 S; x < w. 3 Let I.(x) = x· for 0 s; x s; 1. Does {I.} converge pointwise on [0, I]? Does it converge uniformly on [0, I]? Does it converge uniformly on [0, ~]? 4 LetJ.(x) = nx·(1 - x) for O:s x :s 1. Show that {I.} converges pointwise, but not uniformly, 1 1 ort [0, I]. Does lim.~x r I. = r limn~x In? . 0 • 0 5 Let F(x) = L7x 2j(x 2 + n2 ). Study the uniform convergence of this series, and investigate the existence of lim. j 0 F(x), limx j 0 F(x)jx, lim. j 0 F(x)jx 2 , limx 1 x F(x), limx Ix F(x)jx 2 , limx 1 x F(x)jx. 6 Let/be continuous on the interval 0 s; x <W, and let limx~x I(x) = L. What can you say .2 about limn~xI I(nx) dx? • 0 7 Let 9 be continuous on [0, I] with g(l) = O. Show that {g(x)x n} converges uniformly for x in [0, I]. UNIFORM CONVERGENCE 277 8 Prove the corollary to Theorem 4 without making the change of variable x = I/t. 9 Extend Theorem 5 to improper integrals as follows: Suppose {In) is a sequence of functions continuous on 0 S x < OCJ and such that If..(x) I s g(x) for all x ~O. Suppose that ('\" 9 converges • 0 and that fn -+f where convergence is uniform on every interval [0, L] for any L > O. Prove (fn-+ (I . 0 • 0 *10 Let rPn(x) be positive-valued and continuous for all x in [-I, I] with 1 lim f rPn = I '1-00 • -1 Suppose further that {rPn} converges to 0 uniformly on the intervals [-I, -c] and [c, 1] for any c > O. Let 9 be any function which is continuous on [ - I, I]' Show that 1 lim f g(x)rPn(x) dx = g(O). '1-00 • - 1 *11 Let fn be continuous on a closed and bounded set E, for each n, and let {In) converge pointwise to a continuous function F. Suppose that for any pEE, the sequence {In(p)) is an increasing sequence of real numbers. Prove that {In) in fact converges uniformly on E. (Hint: For a given t, consider the set Cn = {all pEE with F(p) - fn(P) ~ t) and apply the nested set property.) 12 Apply Exercise 11 to prove the following result: Let {un) be a sequence of nonnegative continuous functions defined on the interval [a, b], and suppose that the series L~ un(x) converges pointwise to a continuous function F(x). Then, termwise integration is allowed; b b J. F(x) dx = L ~J. un(x) dx. 13 Use the Tietze extension theorem to show that if C is a compact set in n space, 0 an open set containing C, and f a continuous real-valued function defined on C, then f has a continuous extension to all of n space such that f is 0 everywhere in the complement of 0. 14 Show that the special operator II liE' defined in this section by IlfilE = sup If(x)1 XEE has the following properties of the Euclidean norm in n space: (a) Ilf + gilE S IlfIIE + Ilgk (b) Ilf - gilE = 0 if and only iff = g. 15 Interpreting Ilf - gilE as a distance between the functions f and g, show that ·Hf + g) is equally far from f and from g. 16 If \"\" is a collection of functions f, then the distance from a function F to the collection is defined to be d(F, \"\") = inf IIF - filE fEAt Find the distance between F, where F(x) = x 2, and the set\"\" of all linear functions of the form f(x) = Ax. Choose E as 'the set [0, I]. (You will have found the best uniform approximation on this interval to the function F by functions in the class \"\".) 278 ADVANCED CALCULUS 6.3 POWER SERIES The basic facts about pointwise convergence of power series were presented in Sec. 5.3. We now examine power series as functions defined by series whose terms are polynomials. We must therefore study the uniform convergence properties of power series. Theorem 9 IfL 00 an x n has radius of convergence R, then it is uniformly convergent on eve~y compact subset of the open interval - R < x < R. Any such compact set lies in a closed interval [- b, b], where b < R. The power series converges when x = b, and in fact converges absolutely. Thus, L: lanlb\" converges. If Ixl ~ b, then lanxnl ~ lanlb\", so the Weierstrass test applies, and the series converges uniformly on [-b, b]' I If this is combined with Theorem 7, it follows that a power series can always be differentiated termwise within its interval of convergence. Theorem 10 Let f (x) =L: an x n converge for Ix I < R, Then, l' exists, and1'(x) = L~ nanxn- I for all x with Ixl < R. Consider xL~ nan xn- I = L~ nan xn. Since multiplication by x does not affect convergence properties, the differentiated series has radius of convergence ilL, where L = lim SUPn_oo Inani l/n = lim sUPn_oo lan'l/n, using the fact that limn_ oo nl/n = 1. Thus, the original power series and its termwise derivative always have the same radius of convergence. The derived series is then uniformly convergent for Ix I ~ b, and any b < R, and, by Theorem 7, the differentiation was justified. I Repeating this argument, we see that a function given by a convergent power series may be differentiated as many times as desired, and the derivatives computed termwise, within the interval of convergence. Corollary 1 Iff(x) =L: an(x - c)n, convergent for some interval about c, then an = f(n)(c )/n!. For we have pnl(x) = n!an+ 2· 3 .. · (n + l)an+ l(x - c) + 3·4· .. (n + 2)an + 2 (x - C)2 + ... in an interval about c, and setting x = c, we have pnl(c) = n! an' I UNIFORM CONVERGENCE 279 Corollary 2 If2: an(x - c)n =2: bn(x - c)n for all x in a neighborhood of c, then an = bnfor a = 0, 1, '\" . If the common value is f(x), then an and bn are of necessity both given by pn'(c)/n!. I It should be observed that this shows that a function that is analytic on a neighborhood of c can have only one power series expansion of the form 2 an(x - c)n, and that this one is the Taylor series which is obtained as the limit of the Taylor polynomials. Conversely, any function which is given by a convergent power series is analytic within the interval of convergence. Differentiation of a power series dCles not change the radius of con- vergence, but can destroy convergence at the endpoints. Consider the series ~ x n f(x) = L 2 1 n which has radius of convergence R = 1. This converges in fact for all x with - 1 ::5: x ::5: 1. If we differentiate this, we obtain 'XJ n- 1 .f'(x) =2 ~ 1 which converges only for - 1 ::5: x < 1. If we again differentiate it, we obtain which now converges only for - 1 < x < 1. The first of the three series con- verges uniformly for all x with - 1 ::5: x ::5: 1 since its terms are dominated there by 1/n2 • Theorem 9 shows that the second series converges uniformly in intervals Ixl ::5: b with b < 1; since it is (pointwise) convergent on the larger interval - 1 ::5: x ::5: b, it might be conjectured that it is uniformly con- vergent there as well. The truth of this follows from a general result, due to Abel. Theorem II LetL: an X n have radius of convergence R, and let it also converge for x = R [for x = - R]. Then, it is uniformly convergent on the interval 0 ::5: x ::5: R [the interval - R ::5: x ::5: 0]. Without loss of generality, we may assume that R = 1, and that 2 anxn converges when x = 1. Put Bn = 2: ak so that limn~ooBn = O. 280 ADVANCED CALCULUS Then, for any x, 0 ~ x < 1. 00 '\" a x k = a x n + a x n + 1 + ...L k n n+l n = (Bn - Bn+1 )xn+ (Bn+1 - Bn+2 )xn + 1 + ... = Bnxn + Bn+ 1(xn+ 1 - x n) + Bn+ 2 (xn + 2 - xn+ 1 ) + ... = Bnxn + (x - l)xn{Bn+1 + Bn+ 2 x + ...} Given E, choose N so that IBj I < E whenever j 2 N. Then, for 0 ~ x < 1, and n 2 N, Ii ak xk I ~EXn + (1 - X)Xn{E + EX + EX 2 + ...} n ~ EXn + EXn ( 1 - x){ 1 + x + x 2 + ...} ~ 2EXn < 2E This also holds when x = 1, since IB nI < E < 2E. Thus, IL ~ ak x k I< 2E uniformly for all x with 0 ~ x ~ 1, and all n 2 N, proving uniform convergence. I Corollary If a power series converges at an endpoint of the interval of convergence, then the function defined by the power series is continuous at that endpoint: If2: an r n converges, with r > 0, then lim x 1 r 2:: an x n = 2: anrn . [We remark that while the results on pointwise convergence, and the general results on uniform convergence, apply equally to series of real-valued and series of complex-valued functions, the theorem of Abel (Theorem 11) on uniform convergence at endpoints does not generalize directly. Thus, a power series2: an zn can converge for all complex numbers z with IzI = R, but need not converge uniformly in the closed disc Iz I ~ R; it will, however, converge uniformly in every closed polygon with a finite number of vertices inscribed in the disc.] Since power series are always uniformly convergent in closed intervals which lie in the interval of convergence, they can be integrated termwise over any such interval. The process of integration, or differentiation, is often combined with algebraic operations and with substitution to obtain the power series expansion of special functions; although the coefficients of the expansion of a function f can always be obtained from the formula an = pnl(c)jn!, this is often a long and complicated task. The following examples will illustrate these remarks. UNIFORM CONVERGENCE 281 Let us start from the simple geometric series (6-12) 1 = 1 + x + X 2 + X 3 + '\"I-x which converges for - 1 < x < 1. Repeated differentiation of this yields 1 = 1 + 2x + 3x 2 + 4x 3 + ... + (n + 1)x\" + ... (1 - X)2 2-- = 2 + 6x + 12x 2 + ... + (n + l)(n + 2)x\" + ... (1 - X)3 and in general k! (k+l)! (k+2)! 2--- = k I + - - x + ----- - x + ... (I_X)k+l . l! 2! with convergence for - 1 < x < 1. If we choose instead to integrate the first series, we obtain (6-13 ) x 2 X 3 - log (1 - x) = x + - + -- + ... 2 3 convergent for - 1 < x < 1. Since the series is also convergent for x = - 1, the corollary to Theorem 11 shows that (6-13) holds also for x = - 1, with uniform convergence for - 1 ~ x ~ b, b < 1. In (6-13) replace x by - x, obtaining (6-14) x 2 x 3 x 4 log (1 + x) = x - -- + - - - + ...234 Divide by x, and integrate again on the interval [0, x], x ~ 1 'Xl og (l+t) x 2 x 3 x\"I ---- -- dt = x --- +-- - ... (- )\"+1_2 + ... '0 t 4 9 n In the first series (6-12), replace x by _x 2 , getting convergent for -1 < x < 1. Integrate from °to x, Ixl < 1, obtaining (6-15) x 3 x 5 arctan x = x - -- +-- - ... 3 5 (6-16 ) 282 ADVANCED CALCULUS Since this converges for x = 1 and x = - 1, it converges uniformly for - 1 S x S 1. In particular, setting x = 1, nIl 1 -=1--+---+'\" 4 357 where we have again used the corollary of Theorem 11. Let us define the exponential function E by the power series (6-17) 00 xn x 2 E(x) = \"\" - = 1 + x + - + ... L n! 2! o Then, since this converges for all x, it converges uniformly in every interval IxI s R, R < 00. Differentiating, we obtain 00 nxn - 1 oc xn - 1 E'(x) = \"\" ~ = \"\" = E(x)L n' L (n - 1)'1 . 1 . This shows that the function E is a solution of the differential equation y' = y. The other properties of the exponential function can also be obtained from the series definition. To verify the relation E(a)E(b) = E(a + b) we form the Cauchy product of the series for E(a) and E(b), obtaining 00 an 00 bn 00 /anbO an-1b aObn} E(a)E(b) = 2: n! 2: n! = 2: \\n!O! + (n - I)! I! + ... + O!n! o 0 n=O 00 1 = \"\" -- (a + b)n = E(a + b)Lnlo . With e = E(I), en = E(n), and we may define eX for general real exponents as E(x). Suppose we wish to expand eX in a power series in powers of x-c. Write eX = E(x - c + c) = E(x - c)E(c) = eel 1 +.x ~~+ ~~!C)2 + (.x ~!~23+ ...l Replacing x by - x 2 in the series for E, we have -X2 2 x 4 x 6 e = 1 - x + - -- + ... 2! 3! UNIFORM CONVERGENCE 283 convergent for all x. Integrating this, we have (6-18) We note that this expansion does not enable us to evaluate the probability 00 integral r e- x2 dx merely by letting t increase, since we cannot take the • 0 termwise limit of the right side of (6-18). [Recall that in Sec. 4-5 we used a method to show that this improper integral has the exact value fi/2.] The series which defines the exponential function, (6-17), is also convergent if x is replaced by any complex number z = x + iy, and the identities derived by multiplying power series still hold. Thus, writing e Z for E(z), we have (6-19) Using (6-17), we have . l y4 (l l ) e'Y = 1 - 2! + 4! + ... + i Y - 3! + 5! + - ... Adopting the definitions suggested in Exercise 5, Sec. 5.4, we may now write this relation as (6-20) e x + iy = eX cos y + ieXsin y which permits us the standard exponential definitions (6-21 ) 1. . 00 ()2\" + I sin () = - (e'9 - e- '9 ) = ~ (-1)\" ~~~ 2i ~ (2n + I)! 1. . 00 f)2\" cos () = - (e'9 + e- '9) = ~ (-1)\" ~~ 2 ~ (2n)! ei9 = cos f) + i sin f) It is an instructive exercise to see how much of the standard trigonometric lore can be recovered from these formulas. Division of power series is possible, but difficult to carry out except in relatively simple cases. The test is simple in theory. For example, one writes ~ a x\"L\" 0002:\"-~~-= ex 00 \" 2: b\"x\" 0 o 284 ADVANCED CALCULUS exactly when there is a common open interval I of convergence for all the series, and when, on I, it is true that the product of 2: en xn and 2: bn xn is 2: anxn . EXERCISES 1 Find the power series representations for the following functions which converge in some interval containing the indicated point. (a) sin (x 2 ) near x = 0 (b) l/x near x = 1 (e) log (1 + x 2 ) near x = 0 (d) cosh (x) near x = 0 2 By integration, differentiation, or any other valid operation, find the functions which are given by the following power series. cr: x 2t1 + 1 (e) L: 2;;-.+1 ·0 (b) ~(;~)! (d) x + x 4 + x 7 + x lO + X l3 + ... 3 Can the following functions be expressed as power series in x which converge in a neighborhood ofO? (a) f(x) = Ixl (b) f(x) = cos jx 4 The Bessel function of zero order may be defined by Find its radius of convergence, and show that y = Jo(x) is a solution of the differential equation: xy\" + y' + xy = O. *5 Let limn_ex> an = L andf(x) = L:: an x\". Show that lim x I' (I - x)f(x) = L. 6 Find power series expansions for the following functions about the indicated points: (a) f(x) = xe- X near x = 0 I (e) f(x) =-- near x = 0 1+ 2x I (e) f(x) = ------z near x = 0 1- x (b) f(x) = e2x - eX near x = 0 I (d) f(x) = -- near x = I 1- 2x 7 Show that (sin xl' + (cos X)2 = I by showing directly that le'\"1 = 1. 8 From the fact that e\"e'P = e'('+Pl, deduce the addition formulas for sin (IX + f1) and cos (IX + Pl. 9 Show that F(x) = I + x 3 /3! + x 6 /6! + x 9/9! + ... can be expressed in terms of eX and the number-~+ ij3/2_ 10 Let F(x) = I + 2x + x 2 + 2x 3 + x 4 + 2x 5 + .... By division, find a power series expansion near x = 0 for I/F(x). II Find a power series for I/F(x) where F(x) = L:: (n + I)xn. 12 If f(x) = a,x + a2 x 2 + \"', then I/f(x) = I - a,x + {(ad 2 - a2 }x 2 + {2a,a 2 - (ad 3 - a3 }x 3 + Ax 4 + .... Find A. so that 286 ADVANCED CALCULUS x and any t \"# °= to, we have If(x, t) - F(x)1 = It(~i:x:2) - 1:x21 = 1 ~~2ISi:txt-11 Since limo_ o (sin 8)/8 = 1, we can choose {3 so that I(sin 8)/8 - II < e when- ever 181 < {3. For any R let 15 = {3/R. Then, if Ixl ::; Rand ItI < 15, Ixtl < R(~)= {3 If(x, t) - F(x)1 ::; R ISi:;t- 11::; Re This shows that lim t _ O f(x, t) = x/(1 + x 2) uniformly on each of the intervals [ - R, R]' To prove uniform convergence on the whole axis, we need an additional estimate. Since I(sin 8)/8 I ::; 1 for all 8, we see that for any x and t, If(x, t) - F(x)1 ::; ~ l+x Since lim 1xl _ 00 2x/(1 + x 2) = 0, we can choose Ro so that for any t If(x, t) - F(x)1 < e whenever Ix I 2: Ro. Combining these inequalities, we have If(x, t) - F(x)1 < e for all x and any t with It I < {3/Ro· The continuous analog of an infinite series L~ u\"(p) of functions is an improper integral frO f(p, t) dt in which p is a parameter, and one speaks of • c this being pointwise convergent for pEE if it is a convergent improper integral for each individual choice of pEE. Definition 4 The integral frO f(p, t) dt converges to F(p), uniformly for c pEE if, given any e > 0, there is an r o that depends on e but not p, such that IF(p) - .( f(p, t) dt I< e for all r > ro , and all pEE. Most of the theorems in Sec. 6.2 dealing with sequences and series have analogs for continuous limits and improper integrals. Some of the proofs UNIFORM CONVERGENCE 287 follow the same pattern, but others have essential differences brought in by the contrast between finite sums and integrals. We give abbreviated proofs of the former. Theorem 12 Let limt _ to f(p, t) = F(p), uniformlyfor pEE, and suppose that for each t,f(p, t) is continuous for all pEE. Then, F is continuous on E. (Refer to Theorem 3, Sec. 6.2.) The next result is the analog of the corollary to Theorem 3. Theorem 13 Let Ioc f(p, t) dt converge to F(p) uniformly for all p in an c open set E, and suppose that f(p, t) is continuous for all (p, t) with pEE and t 2 c. Then F is continuous in E. The key to the truth of this is the fact that continuity is a local property, and that every point in E has a neighborhood that is compact. Given Po E E and E > 0, choose r = r(E) so that IF(p) - (f(P, t) dt 1< E for all pEE. Then, one arrives at IF(p) - F(Po)1 < 2E + !(f(P, t) dt - (f(po, t) dt I However,f(p, t) is uniformly continuous for all (p, t) with Ip - Po I s 15, cst s r, so that by Exercise 18, Sec. 4.3, limp_po j'f(p, t) dt = c j'f(po, t) dt, and it follows that F is continuous at Po· I c The simplest standard test of the uniform convergence of an improper integral with parameters is again the Weierstrass comparison test. The proof is similar to that of Theorem 2. Theorem 14 Suppose thatfis continuous and obeys I!(p, t)1 s g(t) for all t 2 c and all pEE. Suppose that {Xlg(t) dt converges. Then, Locf(P' t) dt converges uniformly for all pEE. We now examine the first of a number of illustrations designed to show that what seems plausible is not always true when dealing with improper integrals. Consider (6-22) r oc x 2 F(x) = 1 2 2 dt • 1 + x t 288 ADVANCED CALCULUS oc Since the integrand obeys If(x,t)1 s 1/t 2 for all x, and since r t- 2 dt con- • 1 verges, we know that (6-22) converges uniformly for all x. We may therefore conclude by Theorem 13 that F is continuous for all x; in particular, since F(O) = 0, we know that the integral in (6-22) is such that limx~o F(x) = O. Return to (6-22), and observe that x 2 lim = lim -~~ x~oo 1 + x 2 t 2 x~oo x- 2 + t 2 t 2 Can we also conclude immediately that 00 limF(x) = f C 2 dt= 1 x-co 1 That is, can we also evaluate the limit\" at infinity\" by simply taking the limit inside the integral? In general, the answer must be \"no.\" (However, see Exercise 3.) What we are doing here is extending a statement from the set E on which the uniformity was established to a boundary point of E-since 00 plays this role for the unbounded interval 0 s x < 00. (If you are uncomfortable with this, swap 00 for 0 by the substitution s = 1/x.) This is a situation where the analogy between series and integrals is not perfect. What we are asking for is a direct analogy for the result stated in the corollary to Theorem 4; the analogy for the theorem does hold, but that for the corollary fails. Here is an instance of this. Consider the integral 00 (6-23) F(x) = r x 2te- xt dt x;;:::: 1 • 0 For any t ;;:::: 0, limx~oo f(x, t) = 0, since ext grows faster than x 2 for any t> O. Thus, one might expect that limx~oo F(x) = O. However, if we put s = xt into (6-23), then the integral becomes 00 (6-24) F(x) = f se- s ds = 1 o so that in fact, F(x) = 1 for all x ;;:::: 1 and limx~oo F(x) = 1. We can also check that (6-23) converges uniformly for all x;;:::: 1 in the same way. so that = 1 - (1 + rx)e- rx jF(X) - (f(x, t) dt 1= (1 + rx)e- rx S (1 + r)e- r UNIFORM CONVERGENCE 289 for all x ;:::: 1. Since limr _ oo (1 + r)e- r = 0, we have proved uniform convergence for (6-23) directly. [We remark that this example is not amenable to the Weierstrass test; see Exercise 10.] Thus, in (6-23) we have an instance of an improper integral that converges uniformly for all x ;:::: I while lim x _ oo F(x) cannot be calculated by carrying the limit operation inside the integral; this is in contrast to the behavior of series in the corollary to Theorem 4. The analogy breaks down, and it is natural to wonder why. The answer lies in the behavior of finite sums versus integrals. In the series case, we use the fact that 2~ uk(x) is continuous in the entire set where each of the functions Uk is continuous. The analog would be the assertion that (f(x, t) dt is continuous for all those x where f(x, t) is • c continuous. The proof of this statement (which was Exercise 18, Sec. 4.3) depended upon havingf(x, t) uniformly continuous, which in turn depended on having x in a compact set. However, in our present context, the set of x that concerns us is 1 :-:;; x < 00, which is certainly not compact. Indeed, this problem cannot be resolved merely by a different mode of proof, for the substitution s = xt shows that lim (x 2te- xt dt = lim rXse-s = 1 x-oo'O x-oo 0 which is clearly not the same as rlim x 2te- xt dt = (0 dt = 0 Ox-.oo ~o One convenient way around this is to require a stronger limit behavior of the integrand as x ~ 00, namely that lim x _ oo f(x, t) is uniform in t on every interval [c, L]. Theorem 15 Let f(x, t) be continuous for x ;:::: b, t ;:::: c, and suppose that f oof(x, t) dt converges to F(x), uniformly for all x ;:::: b. Suppose also that c limx _ oo f(x, t) = g(t), where this convergence is uniform in t on every bounded interval c :-:;; t :-:;; L,for any L. Then, (6-25) ,00 lim F(x) = I g(t)dt x-oo .. c Given I: > 0, suppose ro = ro(l:) so that IF(X) - .Cf(x, t) dt I < I: for all x;:::: b. Then, choose X o = xo(ro, 1:) = xo(l:) so that I.f(x, t) - g(t) I < I:/(ro - c) for all x;:::: Xo and all t, c:-:;; t :-:;; ro . Take any points Xl and 290 ADVANCED CALCULUS X2' with Xi> xo, and an easy argument yields IF(xd - F(x 2 )1 ~2E + (Olf(x t , t) - g(t)1 dt + (Olf(x 2 , t) - g(t)1 dt \"' c \"' c E ~ 2E + 2(ro - c) --- = 4E ro - c This shows that F(x) has the Cauchy property as X ~ 00, and that limx _ oo F(x) exists, from which the conclusion of the theorem readily follows. I There are other circumstances in which we can be sure that lim (f(x, t) dt = ( lim f(x, t) dt, x~oo·c ·cx-oo such as a form of the Lebesgue bounded convergence theorem. Further refinements of this nature are left to texts on advanced real analysis. According to the corollary of Theorem 5, Sec. 6.2, a series of functions that converges uniformly on a compact set can be integrated termwise on that set. This has a direct analogy for improper integrals which can also be regarded as a statement about the interchange of orders of integration when one is improper. (In connection with Theorem 16, we note that uniform convergence is not enough to justify such an interchange when both integrals are improper, as is demonstrated in Exercise 16. This is also connected with the absence of a suitable theory of conditionally convergent improper double integrals, as was explained at the end of Sec. 4.5.) b 00 00 b Theorem 16 f dx f f(x, u) du = f du f f(x, u) dx if f(x, u) is continuousace a for a ~x ~b, c ~u < 00, and f oof(x, u) du converges uniformly for x on • c [a, b]. Using Theorem 9, Sec. 4.3, to reverse the order of integration, we have so that r b b r f du f f (x, u) dx = f dx f f (x, u) du .. c a .. a \"' c ,00 b b r I du f f(x, u) dx = lim f dx f f(x, u) du \"c a rfoo\"a C On the other hand, b 00 .b r b 00 f dx f f(x,u)du= I dx f f(x,u)du+ f dx f f(x,u)du \"a C \"0 'c ·a r (6-26) UNIFORM CONVERGENCE 291 • oc;. Since I f(x, u) du converges uniformly, • c 00 lim f f(x, u) du = 0 r 1 00 r uniformly for x E [a, b] and b 00 limf dxf f(x,u)du=O I rjoo a r Without some restriction on the integrand, and on the mode of convergence of an improper integral, reversal of the order of integration is not valid. Consider, for example, a function F defined by F(x) = frO(2xu - x 2u2 )e- XU du o For x = 0, F(O) = O. With x> 0, we may evaluate F directly, obtaining F(x) = lim fxu2e-XU IU=R R-oo Ju=o Thus, F(x) = 0 for all x ~ O. In particular, then, 1100 f F(x) dx = f dx f (2xu - x 2u2 )e- xu du = 0 o 0 0 Consider the effect of reversing the order of integration: roodu f 1(2xu _ x 2u2 )e- xu dx = roodu fX 2ue- XU !X= 1 '0 0 '0 Jx=o 00 = f ue- Udu = 1 o This discrepancy is explained by the fact that the original improper integral (6-26) is not uniformly convergent for x in the interval [0, 1] over which we wish to integrate. We have F(x) = lim xR 2e- xR = lim g(x, R) and the convergence is not uniform since g(I/R, R) = R/e, which is unbounded. (The graphs of these functions for several values of R are given in Fig. 6-1.) When certain conditions are fulfilled, an improper integral containing a parameter can be differentiated with respect to that parameter underneath the integral sign. 292 ADVANCED CALCULUS 00 Theorem 17 If r f (x, u) du converges to F(x) lor all x, a ~ x ~ b, and if • e f and fl = aI/ax are continuous for a ~ x ~ b, c ~ u < 00, and if 00 r Id x, u) du is uniformly convergent for x in [a, b], then for any x in [a, b], • e d 00 00 F'(x) = dx Ie I(x, u) du = ( fl(x, u) du The proof is essentially the same as that of Theorem 12, Sec. 4.3. Set cc g(x) = r fl(x, u) du . e Since this is uniformly convergent and II is continuous, g is continuous, and for any x, a ~ x ~ b, But and x:X x 00 I 9 = I g(x) dx = I dx r II (x, u) du a a a· c cc X = Ldu Lfl(X,u)dx x x of I fl(x,u)dx= I ;-(x, u) dx =f(x, u)-f(a, u) a a uX x 00 r 9 = r [f(x, u) - f(a, u)] du • a • c = F(x) - F(a) (6-27) Since 9 is continuous, this shows that F is differentiable, and that F' = g. I We shall give a number of examples which illustrate these theorems and the manner in which they may be used in the evaluation of certain special definite integrals. Let us start with the formula 1 00 - = Ie-xu du x 0 valid for all x > O. If we differentiate this, we obtain (6-28) 1 cc - - rue-xu du2- x '0 To check the validity of this process, we observe that lue-xul ~ ue- bu for all x with x 21> > 0; since rco ue- bu du converges, the integral in (6-28) is UNIFORM CONVERGENCE 293 uniformly convergent for all x with b s x < 00. This justifies the differentiation, and the formula (6-28) holds for every point x which can be included in one of these intervals, that is, for every x with x > O. More generally, the same argument may be used to show that for any n = 1,2,3, ... , (6-29) n! f 00-- = u\"e- XU du X \"+ I • 0 As another illustration, consider the improper integral (6-30) 00 - x - 2x f e__-_e__ dx '0 x (6-32) 2 Since the integrand may be expressed as Ie-xu du, we may write (6-30) as 1 an iterated integral f 00 .2 dx Ie-xu du • 0 • 1 Reversing the order of integration, we obtain 2 00 (6-31) f du r e- xu dx • 1 • 0 This does not alter the value, since the inner integral is uniformly convergent for all u with 1 sus 2. Using (6-27), we find that the exact value of the 2 original integral (6-30) is I u- 1 du = log 2. 1 Sometimes the operations of differentiation and integration are combined, as in the following illustration. On page 217 we saw that the improper integral ex; f X-I sin x dx was conditionally convergent; we shall now show that its • 0 value is 11t. Let f 00 sin x F(u) = e- XU -- dx '0 x This converges for all u ? 0, and F(O) is the value we seek. If we differentiate (6-32), we obtain (6-33 ) ex; F'(u) = - I e- XU sin x dx o which may be integrated exactly, yielding F'(u) = -(1 + u2r 1. This is valid for all u with u> 0, since the integrand in (6-33) is dominated bye-XU and, as we have seen, the integral of this is uniformly convergent for all u with b s u < 00 and any b > O. Integrating, we find that F(u) = C - arctan u, for 294 ADVANCED CALCULUS all u > 0. Now, suppose we let u increase; from (6-32), it would seem that limu _ oo F(u) = 0, so that °= C - lim arctan u = C - 11t and C = 11t. We then have F(u) = 1t12 - arctan u, so that F(O) ~foox-I sin x dx = 11t o There are two gaps in this argument. We have assumed that (6-34 ) and (6-35) . f 00 sin x lim e- xu -- dx = ° u-oo 0 X I· f 00 - sin x d roo sin x d1m e xu -- x = -- X u)O 0 X '0 X Neither of these is immediately obvious, although both are plausible. The first can be treated quickly. Since sin x r1-- = cos (xs)ds x ·0 it follows that Ix- I sin x lsi for all x. Thus, for any u, Iroo sin x I r00 1e- xu -- dx S e- ux dx =- '0 x '0 u and therefore limu _ oo F(u) = 0, which is (6-34). To verify (6-35), we show that the integral involved which defines ,F(u) is uniformly convergent for all u ~ 0, for this will, by Theorem 13, permit us to evaluate (6-35) as shown, taking the limit inside the integral. The Weierstrass test will not show uniform convergence in this example, since the integrand in (6-35) gives .00 and I x - I Isin x I dx diverges. If we use the trick behind the Dirichlet test • 0 (Theorem 17, Sec. 4.5) and integrate by parts once, the situation improves. We have ' .ooe-XU sin x dx __ f -xu -I JX=oo foo (1 + xu)e- XU cos x- e x cos x - 2 ._-- dx • r X x=r r X (6-36) UNIFORM CONVERGENCE 295 and (estimating the integrand in the second integral), I 00 • I e - ur Icos r I 00f e-xux- 1 Sill x dx s + f X- 2 dx r r. r 2 s- r for any u :2: o. Since limr _ oo 2/r = 0, (6-32) converges uniformly for this set of values of u. Putting this with all the rest of the discussion, we have proved that the value of f ocX-I sin x dx is exactly 7[/2. • 0 Another specialized integral that can be treated by the same method is f ocexp (- x2 - x- 2) dx o Consider the related integral (6-37) F() f oc - x2 - u2/x2 du = e e x o As partial motivation for this choice, we observe that F(l) is the desired integral, while F(O) is the familiar integral f oce- x2 dx which we have shown (Sec. 4.5) o to have the value -r;c/2. Differentiate (6-37), getting (6-38) F(u) = -2 (J (:2)e-X2e-U2/X2 dx To justify this, we must show that this integral converges uniformly. Writing the integrand in (6-38) as u- 1(u/x)2 e-(u/X)2e- X2 and using the fact that S2e -s 2 has maximum value e- 1, we see that the integrand is dominated by (1/eu)e- X2, so that the integral is uniformly convergent for all u :2: b > O. We cannot easily integrate (6-38); however, let us make the substitution t = u/x, obtaining for any u > 0, F'(u) = -2 (u- 1t2e- 12e-(UW( ~2U)dt oc = -2 f e-t2e-u2/t2 dt • 0 = - 2F(u) Solving this differential equation, we find that F(u) = Ce- 2U, valid for all u > O. However, the integral (6-37) which defines F is uniformly convergent for all u, since le-x2e-U2/x21 s e- x2 for all u. In particular, F is then continuous at 0, and lim u I 0 F(u) = F(O). We know that F(O) has the value -r;c/2, so that C = -r;c/2 and OC F(l)= f e-(X2+ 1/X2)dx=1--r;ce- 2 • 0 296 ADVANCED CALCULUS EXERCISES Investigate the existence and uniformity of . x sin (xr) hm-~- ,-0 1 + x 2 2 Let/be continuous on the interval 0 S x < CD with 1/(x)1 sM. Set F(u) = ~ roo ufjx)}x TC· 0 u2 + x 2 Show that lim. j 0 F(u) = /(0). 3 Show that, in fact, limx _oo F(x) = 1 where F(x) is given by (6-22). • /2 . oo x 2u du 4 Evaluate lim f e-'''\"· dO. 5 Evaluate lim f'j' ..-\". '-00 0 x-oo 0 X + U f oo sin2 (xu) du roo 1 - cos x 6 Evaluate ---2'--' 7 Evaluate., dx. o u '0 x 8 Evaluate fOOe-· 2cos (xu) duo o 9 Evaluate fOOe-(X- l/x)2 dx. o 10 Show that there is no function g(r) such that roog(r) dr converges but such that x 2re- x , S g(r) • 0 for all x ~ 1, r ~ O. II Investigate the existence and uniformity of the limit 12 Evaluate: 1 dr (a) lim r----=--= x-o·o p + r2 13 Evaluate: eX' - 1 lim--- r-O x O<X<CD 1 X dr (b) lim r-= x-o· 0 Jx 2 + r2 f oo fOO x dr (a) lim sin (eX') dr (b) lim-- 2\"2 x-oo 0 x-oo 0 1 + x r 14 Write out a detailed argument for the proof of Theorem 13. 15 Write out a detailed argument for the proof of Theorem 14. *16 Show that (dX (G(X, y) dy # (d y (G(X, y) dx if G(x, y) = (x - y)/(x + y)3. 6.5 THE GAMMA FUNCTION In Sec. 6.4, we discussed certain properties of functions which have been expressed as integrals. It is the exception when such functions can be expressed in terms of elementary functions; when this is not possible, the integral itself is often taken as the definition of the function, and additional properties of the function must be deduced from the integral representation. A simple and familiar instance of this procedure is the definition of the logarithm UNIFORM CONVERGENCE 297 function by the formula x>o(6-39) L(x)=(dt . I t By making changes of variable, one may verify all the algebraic properties. For example, to prove that L( l/x) is - L(x), we set t = l/u, and have L(_l) = (X~t= (u(-u- 2 )du x . 1 t . 1 .x du = -1-- = -L(x) • 1 u A less familiar example is the approach to the trigonometric functions which starts with the definition (6-40) x dt A(x) = r ----2 • 0 I + t As an example of what may be done with this, let us make the variable change t = l/u, and obtain r 1/X _U-2 roo du A(x) = du=- '00 l+u- 2 '1/x 1 + U2 00 Let K = r dt/(1 + t 2 ) = limx _ oo A(x). Then, the last integral is '0 K- rl/x ~ = K- A(~) '0 l+u x so that we have shown the identity A(x) + A(I/x) = K. In particular, A(I) = K/2; 1t may be defined as 2K. (6-40) can be taken as the definition of tan () by the equation () = A(x). Exercise 2 provides a proof of the familiar identity for tan (2()). We devote this section to the study of some of the simpler properties of the gamma function, as defined by the improper integral (6-41 ) r(x) = roouX-le- u du • 0 This converges for all x > 0, and converges uniformly for all x in the interval [15, L], for any 15 > 0 and L < 00, so that r(x) is continuous for all x> O. If x is chosen as an integer, (6-41) becomes an integral which we can evaluate exactly, so that comparing this with Eq. (6-29) of Sec. 6.4, 00 r(n+l)=f u\"e-udu=n! o 298 ADVANCED CALCULUS If we write x! = r(x + 1), we therefore obtain a definition of \"factorial\" applying to nonintegral values of x which agrees with the customary definition when x is an integer. The gamma function also obeys the identity (x + 1)! = (x + 1)(x!). Theorem 18 r(x + 1) = xr(x) for any x > o. Integrating by parts, we have r(x+ 1)= ('uxe-udu= l_uxe-u1u=00 + foce-Ud(uX) o Ju=o 0 = 0 + f oc xe-uux- I du = xr(x) I • 0 By making appropriate changes of variable, many useful alternative definitions of the gamma function may be obtained. We list several below, together with the necessary substitution: (6-42) (6-43) (6-44) r(x) = 2 f oc t2x-Ie-t2 dt • 0 1 l (1) lx-I r(x) = f0 log t J dt 00 r(x) = eX f tX-1e- ct dt o r(x) = f 00 ext exp ( - et ) dt -00 {u = -log t} {u=et} The first of these, (6-42), makes it possible to determine the value of r(x) when x is any odd multiple of 1. Theorem 19 r(!) = JTc, rG) = JTc/2 and in general, r(n +~) = (2n)!-li 2 4\"n! Putting x = -! in (6-42), we have r(!) = 2 fooe- t2 dt = JTc. Using the o functional equation r(x + 1) = xr(x), we have The general formula may be verified by an inductive argument. I UNIFORM CONVERGENCE 301 as x increases. On the interval b :-:::: t < 00, g(t) :-:::: g(b) < 1. Thus, ~ (Xl[g(t)Y dt = ~ rOO[g(t)Y-lg(t) dt • b • b rye :-::::~[g(b)Y-l r g(t)dt • 0 which again approaches °as x increases. This leaves us with the middle integral. We choose a = 1 - 15 and b = 1 + 15, where 15 has yet to be chosen. Then the middle integral, after the substitution s = t - 1, becomes (6-45) lJ I(x) = ~ f [(1 + s)e-sy ds -lJ Lemma 1 For s near 0, (1 + s)e- S = e- S2h(s), where lims_o h(s) = 1. This is seen by applying L'Hospital's rule to h(s) = -log (1 + s) + s I S2 The integrand in (6-45) is therefore e- xS2h (s). We now choose b. Given e > 0, choose 15 so that Ih(s) - 4-1 < e for all s, lsi :-:::: b. Then, for any s, -15:-:::: s:-:::: 15, (6-46) We will use this to estimate I(x). First, we need a simple calculation. Lemma 2 For any 15 > °and any c > 0, lim ~ ( e- cxs2 ds = J~ X-ex) \"-J C Put u = ~ s, which turns the given integral into (6-47) 1 rlJ.jcx - e- u2 du ;-;: • - lJ.jCX 00 and as x increases, this converges to (ljylc) r e- u2 du, which by (4-40), '-rye is#. I Returning to (6-46) and integrating between -15 and 15, we see that I(x), given by (6-45), is sandwiched between two integrals that converge to J1r7(~- e) and ~1l:I(r+6)as x increases. Since e is arbitrarily small, we may conclude that lim x _ oo I(x) = a =.jfit. I 302 ADVANCED CALCULUS If we admit the gamma function to the collection of functions which we may use, many otherwise intractable definite integrals can be evaluated exactly. 1 Theorem 21 B(p, q) = f x P- 1(1 - X)q-l dx = r(p)r(q)jr(p + q), where p o and q are positive real numbers. The integral defines B as a function of two real variables; it is known as the beta function. When p and q are positive integers, the integrand is a polynomial, and B(p, q) can be easily evaluated; the theorem makes the evaluation possible for all positive p and q. We follow a procedure similar to that which we used in evaluating f 00 e- t2 dt in (4-40). Using the alternative formula (6-42) for the gamma o function, and introducing different dummy letters for the variables of integration, we have 00 r(p) = 2 r y2 p-l e- y2 dy • 0 00 r(q) = 2 r x2q-le-x2 dx • 0 The product of these can then be expressed as R R r(p)r(q) = lim 4 f y2P-l e- y2 dy r x2q-le-x2 dx R-oo 0 '0 00 00 r r 2p-l 2q-l -(x2+y2)d d= y x e x y • 0 • 0 Since the integrand of this improper double integral is positive, we can also integrate over the first quadrant by using quarter circles, and polar coordinates. Replace x by r cos e, y by r sin e, and dx dy by r dr de. Carrying this out, we have R • ,,/2 r(p)r(q) = lim4 r dr I (rsinefP-l(rcose)2q-le-r2rde R-oo'O '0 00 ~2 = 4 r r2P+2q-le-r2 dr f (cos e)2q-l (sin e)2 p-l de • 0 0 In the first, put u = r2 so that dr = duj(2r); in the second, put v = sin 2 e so that de = dvj(2 sin e cos e). Then 00 up+q+ 1/2e-u 1 (I _ V)q-l/2Vp-;-1/2 r(p)r(q) = 4 J o --i~~ du JO-2~1/2(1 ~-~)i72-dv 00 1 = r uP+q-1e- u du r vP- 1(1 - V)q-l dv . 0 • 0 = r(p + q)B(p, q) I UNIFORM CONVERGENCE 303 Many integrals which are not originally in the form of a beta function can be converted into such a form, and thus evaluated. We give two samples of this. r I dx flU - 3/4 du • 0 (1 - X4 )1/2 = 0 4(1 _ U)I/2 = ;\\:B(t 1) qi)r(-t) -4rm r rr/2_~_ rI V I /4 dv )Sin ede = 1/2( r/2 = 1B(-i, 1) • 0 . 0 2v 1 - v (In the second, we have used the substitution v = sin 2 e, and in the last step, the functional equation for the gamma function.) EXERCISES I Show directly from the integral definition in Eq. (6-39) that the function L has the property L(xy) = L(x) + L(y). 2 (a) Show that the function A, defined in (6-40), has the property that A( __2X _) = 2A(x) 1 - x 2 for any x, Ix I < 1 (b) Show how this leads 10 the identity tan (211) = (2 Ian 11)/(1 - lan 2 11). 3 Complete the induction argument in Theorem 19. 4 In terms of the gamma function, evaluate the following integrals: 1 (c) r [I - I/X]'/3 dx '0 I dx (b) Jo j;log (i/~ n/2 (d) f jtaiJ7j dll • 0 5 Show that r(x)r(i - x) = (uX-I/(1 + u) duo • 0 6 Evaluate ('Oupe-·' duo • 0 1 7 Evaluate J x'[log (I/x)]' dx. o 8 The error function is defined by 2 x erf(x)= -f e-t'dr J7('o Use Ihis to express (evaluate) the following integrals: .L (a) I e- 1/,' ds '0 304 ADVANCED CALCULUS (e) F(x) = ('e- X '2 dr o I 9 (a) Show that r dx/(I - X I / 4 ) = 128/35. '0 1 (b) Show that f (I - x 213 )3/2 dx = 31t/32. • 0 10 Show that B(p, q) = r'\"uP - I/(l + u)p+q duo (Hint: x = u/(I + u).) • 0 II Using Exercise 10, show that I = f~'\"dr/(I + r2)4 = 51t/16. 12 Express r'\"(x - 1)213x - 2 dx in terms of the gamma function. '1 13 The following identity was stated by Wallis (c. 1650) Use Stirling's formula to show this is correct. 6.6 FOURIER SERIES It is often useful to borrow the terms \"point\" and \"distance\" from elementary geometry and apply them in quite different contexts in order to help motivate and explain mathematical techniques. We have already done this in treating n space, and have indicated in Sec. 6.2 an analog that is useful in working with functions. We now formalize this. A set vIt, whose members shall also be called points, is said to be a metric space if for every pair p, q in vIt, there is a real number d(p, q) which we call the distance from p to q, such that: (6-48) (6-49) (6-50) 0< d(p, q) < 00 unless p = q when d(p, q) = 0 d(p, q) = d(q, p) d(p, q):s d(p, r) + d(r, q) for any rEvIt The last of these is again called the triangle law. Clearly, with d(p, q) = Ip - q I, Rn is a metric space. All of Section' 6.2 dealt with the metric space ~[I] whose \"points\" were the continuous real-valued functions defined on a fixed compact set I, using the metric (Exercise 14, Sec. 6.2) d(f, g) = Ilf - gill = max If(p) - g(p) I pEl In any metric space, one can introduce all the topological concepts described in Sec. 1.5. For example, a sequence of \"points\" {Pn} is said to converge to a point p if (6-51 ) lim d(Pn' p) = 0 UNIFORM CONVERGENCE 305 In the metric space ~[I], (6-51) is the same as saying that the functions {f,,} converge to a function f uniformly on I. In this section, we look at two other metric spaces, both of which have been of central importance in mathematics and its applications, particularly to physics. The first of these is t 2 (usually called \"little L two \"), which is the natural infinite-dimensional generali7jltion of ordinary n space. The points of t 2 are infinite real sequences, written as though the terms were coordinates: The metric is defined by (6-52) (6-53) (6-54) = ~Ial- b~+l~-=-bJ2~ and in order to use it, the series inside the square root must converge. The origin of the space t 2 is 0, the sequence all of whose terms are 0, so that if we want d(p, 0) to exist, we must have 00 L lalcl2= l[p112 < 00 1 This imposes a requirement on all the points of t 2 • For example, the choice an = lin yields a point of t 2 , sinceL~ I/n 2 converges, but the choice an = l/~ is not allowed, and does not yield a point in the space t 2 • (This explains the \"2\" in t 2 ; there is also a metric space t P whose poin ts are the sequences {an} for which L~ lanl p converges. The space t 2 is also called real separable Hilbert space.) Imitating n space, we also introduce a scalar or dot product in t 2 , defining % p. q = L akbk 1 The fact that this series is convergent for every pair of points p and q in t 2 , and that the metric satisfies the desired laws, especially the triangle law (6-50), follows from an appropriate form of the Schwarz inequality, (6-55) whose proof comes at once from the corresponding finite-dimensional version (Theorem I, Sec. 1.3). For any n, we have 306 ADVANCED CALCULUS and the right side is less than Ilp11211q1l2, which is finite by (6-53), so that the series in (6-54) is absolutely convergent and is bounded as indicated in (6-55). The space (2 has a special set of points {en} which we call its standard basis. These are e 1 = (1,0,0, ... ,0, ... ) e 2 = (0, 1, 0, 0, , 0, ... ) en = (0, 0, 0, 0, , 1, 0, ... ) We note that each has length 1, meaning that Ilenll = 1, and that they are pairwise orthogonal, meaning that ei . ej =°if i \"# j. It is customary to write both of these facts in the single equation (6-56) where bij is a special function of i and j that is °unless i = j, when it is 1. The reason for the term\" basis\" lies in the following result. Theorem 22 For any p E t 2, P = 2,~ cnen, where the numbers Cn are defined by (6-57) Cn = P • en The proof of this is not quite as trivial as it looks. If we start with p = (al> a2' ... ), then (6-57) immediately gives an = cn for all n, and all that remains is to show that (6-58) 00 p = (CI> c2 , C3 , ... ) = 2, cnen 1 The only question lies in knowing what the right side means. As with series of numbers, we interpret the right side as limN _ oo SN where SN = 2,~ cnen, but \"limit\" must now be understood in the sense of the metric of (2, meaning that limN_ oo lip - SNII = 0. However, since SN is a finite sum, SN = (CI> C2 , ... , CN' 0, 0, 0, ... ), and lip - SNI1 2 = IcN+ 112+ ICN +212+ ... Since this is the tail of the convergent series 2, ~ ICk 1 2 , we see that, indeed, limN_ oo lip - SNII = 0, as required. I We state one more theorem about t 2 which will be of use to us later in this section. We need a preliminary definition. Definition 5 A metric space vii is called complete if every Cauchy sequence of points in vii is convergent in vii. UNIFORM CONVERGENCE 307 Thus, in a complete space A, any sequence {Pn} whose terms Pn are points of A and which is such that limm.n-oo IIPn - Pmll = 0 will converge to some point pEA. The function space ~[E] and Rn are each complete, the former because of Theorem 1 in Sec. 6.2, and the latter by Theorem 23 of Sec. 1.7. However, there are many metric spaces that are not complete (see Exercise 3). Theorem 23 (2 is complete. Since the proof of this is not needed for what we do later, and since it is long and complicated, we have left this as a challenge in Exercise 14, where you are asked to fill in a skeleton proof. While the space (2 may seem to be a transparent generalization of n space, it is not. The understanding of its geometric and analytic properties is far from complete, even after a century of active research. By the end of this section, some of the reasons for this will have become plain. We now introduce another example of a metric space. The points in this space will be continuous functions, for simplicity functions defined on a fixed interval f = [a, b]. We use a different metric from that in the space ~(I], and therefore use different symbols to denote both. We denote the new space by *~[f], and the new metric is given by (6-59) I b \\ 1/2 d(f, g) = *llf- gil = \\( If(t) - g(tW dtl We will use the elevated * in connection with operations in the new space, to distinguish them from similar operations in the function space ~[f]. Thus, we write *Iim fn = g to mean lim *llfn - gil = 0 which in turn (after squaring the result) translates into (6-60) .b lim I Ifn(t) - g(tW dt = 0 rJ-OO • a In much of the earlier work with Fourier series, the type of convergence described by the formula in (6-60) was called mean square convergence, or convergence in the mean; in some papers, it was denoted by I.i.m. fn(t) = g(t), where the letters were read \"limit in the mean.\" Mean convergence and uniform convergence are different, just as the two metrics II II I and *II II are different, even though both are being used on the same collection of functions. Thus, if f(t) = t 2 and g(t) = t 3 and f = [0, I], 308 ADVANCED CALCULUS then computation easily shows that II I-gill = fr, while However, there is a universal inequality between these two metrics, as shown by the following result (Exercise 4). Theorem 24 II I = [a, b] and I and g are continuous on I, then *111 - gil ~ ~-a III - gill Accordingly, if {f,,} converges to g uniformly on I, then *limn_ oo f\" = g. The converse of this does not hold. If In(t) = nJt exp (- n2t) and I = [0, 1], then *limn_ 00 In = 0, since r 1 I f,,(t) 12 dt = r 1n2te- 2n2 , dt . 0 . 0 1 .n 2 = 2 I se- 25 ds -+ ° n '0 but {f,,} does not converge to °uniformly on I, since 1 Il/nll = max I/n(t)1 = I/n(ljn2 )1 = Os's 1 e for all n. Although we have called * II II a metric on the space *~, we have not yet verified the three requirements (6-48), (6-49), and (6-50). The first two are easily checked. For the third, we are able to use the same approach adopted in treating the spaces t 2 and Rn. (Indeed, as will be seen later in this section, there is an innate similarity between the space t 2 and the space *~.) We do this by introducing an inner product in *~ by writing (6-61 ) b <f, g) = r I(t)g(t) dt , a We use this notation, rather than I' g, in order to avoid confusion with ordinary multiplication of functions. Notice that we are again making use of the analogy between sums and integrals in choosing definitions (6-59) and (6-61), which should be compared with (6-52) and (6-54). The properties of < , ) are described in Exercise 2, and the same procedure that was used to prove the Schwarz inequality in Rn (Theorem 1, Sec. 1.3) now proves the analog (6-62) I<f, g)1 ~ *11/11*llgll and from this, the triangle law (6-50) for the metric *11 II readily follows, using the fact that *11/ + gl12 = <I+ gJ + g). UNIFORM CONVERGENCE 309 Following the pattern set by f2, we say that two functions i and g in *'t' are orthogonal when neither is 0, but <f, g> = 0. An infinite set of functions {<Pn} is said to be an orthogonal set or orthogonal system if every distinct pair is orthogonal. This can be stated as (6-63 ) and in integral form as b r <Pn(t)<Pm(t) dt = ° • a n#m n# m If the <Pn have the additional property that *II <PnII = 1 for every n, then the set {<Pn} is said to be orthonormal on the interval I. Using the special function (\\m, this can be written in the abbreviated form <<Pn' <Pm> = bnm. We note that a set that is merely orthogonal can be converted into an orthonormal set by multiplying each <Pn by an appropriately chosen constant. Unlike f2, there is no immediately obvious standard orthonormal set for the space *'t'. Instead, one has many to choose from; indeed, one can be constructed from any infinite linearly independent set of functions by taking appropriate linear combinations to achieve the orthogonality. For example, starting from the collection of all polynomials, we pick <PI to be the constant function 1, then choose <P2(t) = a + bt to be orthogonal to <PI> and then <P3(t) = a + bt + et2 so that <P3 is orthogonal to both <PI and <P2' etc., each time solving for the required coefficients. For example, if I is the interval [0, 1], then one might arrive at the following polynomials: These are not normalized; in order to make them orthonormal, each must be multiplied by the appropriate factor, leading to the set <PI = 1, <P2 = J\"3(2t - 1), <P3 = J\"5 (6t2 - 6t + 1), etc. Another common set, orthogonal on the interval [-1, 1], is the Legendre polynomials, Pn(x), defined by the formula of Rodrigues (6-65) 1 (d)np (x) = -- -- (x 2 - l)n n 2nn! dx so that Po = 1, PI = x, P 2 = ~x2 - 1, etc. (These can be seen to be closely related to the polynomials <Pn given above in connection with the interval [0,1]; see Exercise 12.) While there are many obvious analogies between the space *'t' and the sequence space f2, there are also many important differences. Perhaps the most significant one is that the space *'t' is not complete. This means that there are sequences {f,,} in *'t' which obey the Cauchy criterion limn. m- 00 *IIin - im II = ° but which are not convergent. An example of such a sequence {in} is given 310 ADVANCED CALCULUS y = (t)1/12n-1I Figure 6-6 !3(t) = .yt f,,(t) = t l /(2n- I) 6-6. Computation shows easily that this 3). However, there is no function 9 E *~ on the interval [ - 1, 1] by !I(t) = t !2(t) = ~ whose graphs are shown in Fig. sequence is Cauchy (see Exercise with 9 = *lim!n· The reason for this is in fact quite simple: the space *Cfo is too small. As can be conjectured from Fig. 6-6, the sequence Un} does in fact converge to a function g, in the special metric defined in (6-59), but this function turns out to be the discontinuous function g(t) = 1 ~ -1 if t > 0 if t = 0 if t < 0 which is not in the space *~. The situation is similar to what would happen if we were to try to build analysis on the rational numbers alone; here, we would find that a sequence of rationals could be a Cauchy sequence but still fail to converge if its limit (in the reals) were a number such as .)2, which is not rational. It would therefore seem plausible that we could overcome this defect in the function space *~ by enlarging it to include many more functions, all dis- continuous, so that any sequence Un} that is Cauchy in the metric * II II will now converge in that metric to one of the functions in the new space. This is (almost) what is in fact done in a thorough and complete treatment of the topic of Fourier series. However, certain technical difficulties must be overcome. As a first step, *~ is enlarged by including all the piecewise continuous functions on the interval 1 = [a, b]. However, the resulting space is still not large enough, and one must include functions having an infinite number of discontinuities. The basic definitions of the metric and inner product given in (6-59) and (6-61) remain the same, but Riemann integration must be replaced by Lebesgue integration to handle the new functions that appear. Finally, while the metric UNIFORM CONVERGENCE 311 still obeys the triangle law, one can now have *llf - gil = 0 without havingf and g identical; for example, suppose f and g agree except at one point of the interval I. Since a treatment of all this would take us far afield, we will instead continue to work with the smaller function space *CC of continuous functions, and accept the fact that it is not metrically complete. Having defined the notion of an orthonormal set {cPn}, it is natural to ask if the pattern followed in the space t 2 still holds, so that one can choose a natural orthonormal set which forms a basis for the space *CC. Let us formulate a general definition. Definition 6 An orthonormal set {cPn} in *CC is called a Fourier basis for *CC if every f E *CC has the unique ex.pansion (6-66) (convergent in the metric of *CC), where the coefficients {cn} are given by (6-67) for n = 1, 2, 3, ... Here, the elevated * in (6-66) indicates that the convergence of the series is in the topology of the space *CC, meaning that *limN~oo SN = f where SN = L7 cncPn' which in tum is equivalent to limN~oo*llf - SNII = O. The sequence {cn} is usually called the sequence of Fourier coefficients of f with respect to the set {cPn}; it is important to note that {cn} can be constructed for any orthonormal set {cPn}, whether they form a basis or not. We shall usually write f\"\" {cn} to indicate the association between the function f and the sequences of Fourier coefficients. In the same way, it is always possible to form the formal series (6-68) 00 2: cncPn = ClcPl + C2cP2 + ... 1 where the coefficients Cn are given by (6-67); this is called the Fourier series for fwith respect to the orthonormal set {cPn}. The word \"formal\" is used here to emphasize that nothing is implied about the convergence of the series (6-68) in any of the possible meanings. Because of their importance, we rewrite some of these formulas in integral form. Thus, given any orthonormal set {cPn}, and a function f E *CC, we have f\"\" {en}, where (6-69) .b Cn = I f(t)cPn(t) dt.. 312 ADVANCED CALCULUS and the association off with its Fourier series is often written 00 (6- 70) f(t) ~.2 Cn<Pn(t) 1 (Note that \"~\" is used here instead of\" =\" to emphasize that this is a formal series, rather than one that is known to converge.) The set {<Pn} is a basis if and only if b lim f If(t) - SN(tW dt = 0 N-oo a for every f E *~. [In the older literature, one says that the senes (6-70) converges to f in the mean.] From the above discussion, it is clear that a basis for *~ will play the same role there as that played by the standard basis {ek } for the space t 2 . However, we have not yet shown that such a basis exists for *~. Unlike in t 2 , none is immediately obvious, and indeed, much of the research in general Fourier theory deals with the study of different orthonormal sets, the develop- ment of methods to decide which form a basis for *~, and the study of the various modes of convergence of the series (6-70) and the degree to which the Fourier coefficients {cn} characterize f The systematic development of classicial Fourier series started with the work of Fourier about 1820 in connection with the study of wave motion and the flow of heat. Fourier asserted that the system (6-71 ) 1 yl2~' cos (nx)--- yin sin (nx) --_. yin for n = 1, 2, 3, ... (6-72) formed a basis for *~[-n, n]' (We indicate a proof of this later on.) It is easy to verify that this system is orthonormal by using the trigonometric identities 2 sin A sin B = cos (A - B) - cos (A + B) 2 sin A cos B = sin (A + B) + sin (A - B) 2 cos A cos B = cos (A - B) + cos (A + B) For example, if n ¥- m, f\" sin nx sin mx 1 f\" J -- r= dx = - {cos (n - m)x - cos (n + m)x} dx . -\" n v n 2n -\" 1 fSin (n - m)x sin (n + m)x.I\" ----. ---_.,--- - ------ ---- 2n n - m n + m _\" =0 UNIFORM CONVERGENCE 313 while I,rr sin n.x sin nx d _ 1 rrr (1 2) d_ x - -- - - cos nx x , - rr J n .jn 2n . - rr n = -- = 1 n j(x)(6-73 ) The Fourier coefficients ofj(x) on the interval [-n, n] with respect to the functions (6-71) will lead to a Fourier series having the form '\" A o 1= +i A cos ~x+i B sin ~ .j2n 1 ·.jn 1· In where the A k and Bk ar~ calculated from (6-67). However, it is easier to absorb the terms involving .jn into the coefficients, arriving at the more traditional series (6-74) j(x) 1 00 :2 ao +L (a. cos nx + b. sin nx) 1 where the coefficients are now given by the formulas 1 rr a.=- r j(x)cosnxdx n· -rr 1 rr (6-75) b. = - r j(x) sin nx dx n· -rr For example, ifj(x) = x, then we find a. = 0 for all n, and b. = (2In)( -1).+ 1. (In calculating these, it is helpful to observe that any odd function, obeying g( - x) = - g(x), has a vanishing in tegral over any symmetric interval [ - c, c]; sincej(x) = x is odd and cos nx is even, a. = 0.) After dividing by 2, we there- fore obtain the following Fourier series: (6-76) x 2 . 1'2 1 '3 1 '4Sill x - 2 Sill X + 3 Sill X - 4Sill X + ... Following the treatment of (5-17), we can apply Dirichlet's test to show that the series is convergent pointwise for every x. This shows that (6-76) cannot be taken as equality for all x on [ - n, n], for the right side is 0 if x = n or - n. However, if we set x = n12, (6-76) becomes nIl 1 I 4 1- 3 + 5- 7+ 9-'\" 4 (6-77) which agrees with the result in (6-16), found from the power series for arctan x. Again, if[(x) = x 2/4, then the same process (simplified by observing thatf is an even function) yields the Fourier series x 2 n 2 1 1 - - cos x + - cos 2x -- cos 3x + ... 12 4 9 314 ADVANCED CALCULUS SinceL ~ 1/n 2 converges, we see that the series converges uniformly for all x. However, we do not as yet know that the function to which it converges must be x 2/4. We can check that this is plausible by setting x = n in (6-77) to obtain n 2 n 2 1 ~ ~ _L ... 4 12 + + 4 + 9 + 16 + which is confirmed by the \"computation\" in Sec. 5.5 that led to (5-39), although at this stage we certainly cannot say we have proved L 1/n 2 = n 2/6. Additional \"confirmation\" of the consistency of all this can be seen by looking at the formal derivative of (6-77) and comparing the result with (6-76). However, legitimate doubts should arise, since if we differentiate (6-74) in the same way, we then obtain the relation (6-78 ) 1 2 ~ cos x - cos 2x + cos 3x - cos 4x + ... and this series diverges for every choice of x. The mixture of sense and nonsense which these examples illustrate make it necessary to develop more theory. We suppose that {<Pn} is an arbitrary orthonormal set, not necessarily a basis, and we propose to study the relationship between a function! and its Fourier series; there are three main questions which we examine. The first deals with the Fourier coefficients themselves. If! ~ {cn}' then we ask if the sequence {cn} uniquely characterizes the function! among all other functions in *~, and if so, how properties of! are reflected in {cn }. The first half of this question can be rephrased usefully. If! and g both have the same Fourier sequence, then <f, <Pn> = <g, <Pn> for all n, and if h = ! - g, <h, <Pn> = 0 for all n. Since! = g if and only if h = 0, we are led to ask if 0 is the only function in *~ that is orthogonal to all the functions <Pn. The uniqueness question for a given orthonormal set {<Pn} is therefore the same as asking if the set is maximal in *~, meaning that no additional function can be found in *~ which is orthogonal to all the <Pn already chosen and which is not identically O. If an orthonormal set {<Pn} is maximal in *~, then every! in *~ is characterized uniquely by its Fourier coefficients. (Instead of \" maximal,\" some writers on Fourier theory use the more ambiguous terms\" complete\" or \"closed.\") It should be noted that a given set might be maximal with respect to *~ but not maximal with respect to a larger space of functions, since it might be possible to find a discontinuous function that is orthogonal to all the original <Pn which could then be adjoined to the set to form a larger orthonormal set. Once we have found the Fourier coefficients {cn} for f, we can form the Fourier seriesL ~ Cn <Pn· The remaining questions deal with the convergence of this series, and in particular, whether it converges to f, either in the mean (i.e., in the topology of the space *~) or in more familiar ways such as pointwise or uniformly on [. We start by looking at finite linear combinations (sums), such as UNIFORM CONVERGENCE 315 P =L7an <Pn· We call these Fourier polynomials, by analogy with elementary algebra; in the classical trigonometric case, these are called trigonometric polynomials. We prove several useful identities. Lemma 1 If P = L7an <Pn , and f E *<6', then (6-79) N N (J. P) = L an(J. <Pn) = L ancn I I (6-80) ifk ~ N ifk> N For, (J. P) = (f, al<PI + a2 <P2 + ... + aN<PN) = al(J. <PI) + a2(J. <P2) + ... aN(J. <PN) Lemma 2 If P = L7an <Pn, then (6-81 ) N For, */IPI/ 2 = (P, P) = L an(P, <Pn) I N N =L an(<Pn, P) =L lan l2 I I I We next use these to show that the partial sums of the Fourier series for a functionfprovide optimal approximations toJ. among all Fourier polynomials. Theorem 25 Iff\"\" {cn} and SN =L7Cn <Pn, then (6-82) */If - SNII ~ *lIf - PI/ where P may be any Fourier polynomial of the form L7an <Pn· We have*llf- PI/ 2 = (f - P,.f - P) = (J.f) - (J. P) - (P,.f) + (P, P) 316 ADVANCED CALCULUS Then, by (6-79) and (6-81), this becomes N N *III - Pl12 = <.f,I> - 22: anCn+2: lan l2 1 1 and then, with minor adjustments, N N (6-83) *III - PI12 = *IIII12- 2: Icn l2+2:, Ian - Cn l2 1 1 Since the numbers cn are determined by I, the minimum of the right-hand side of (6-83), as the an vary, is clearly achieved uniquely by the choice al = Cb a2 = C2 , ... , and the optimal polynomial P is SN itself. I From this simple result, we obtain a large number of very useful implications. Corollary 1 III'\" {cn} then (6-84 ) converges (6-85) lim Cn = 0 (6-86) 00 2: Icn l2 ~*IIII/ 2 1 (Bessel's Inequality) These all arise from the identity (6-87) N */II - SN/1 2 = *IIII12- 2: Icn l2 1 which comes from (6-83) by setting an = cn. Since the left side of (6-87) cannot be negative, N 2: Icn l2 ~*IIII12 1 for any N, and (6-84), (6-85), and (6-86) follow. Corollary 2 III'\" {cn} and SN is the Nth partial sum ol the Fourier series 2:~ Cn <Pn , then *III - SNII is monotonic decreasing as N --+ 00, and (6-88) 00 I = *2: cn <Pn = *lim SN 1 N-CLj UNIFORM CONVERGENCE 317 if and only if (6-89) (6-90) This follows directly from (6-84); the relation (6-89) is sometimes called Parseval's formula. At this stage, we can now apply these results to the study of any specific orthonormal set, such as the Legendre polynomials or the classical trigono- metric functions, (6-71). For example, because of (6-85) we know immediately that the trigonometric series (6-78) cannot be the Fourier series of a function in *~, since the coefficients do not converge to O. Again, the following trigonometric series is not a Fourier series . 1.() 1.() Sill X +fi Sill 2x + J3 Sill 3x + ... since.L ~ (l/fiy diverges. We note that this series in fact converges pointwise for all x, by the Dirichlet test. This leads to the reasonable conjecture that (6-90) ought to be the Fourier series (in some sense) for something, even if it is not the Fourier series for a well-behaved function. We return to this at the end of the present section. Turning now to the classical trigonometric Fourier series, based on the orthogonal functions (6-71) and the formulas (6-74) and (6-75), the Parseval relation becomes (6-91 ) which, by Corollary 2, is a necessary and sufficient condition for the Fourier series (6-74) to be convergent \"in the mean\" tof(x), in the metric of*~. If we apply this to the series (6-76), Parseval's relation becomes the assertion (which is by now an old friend). Thus, we see that we can conclude that the Fourier series (6-76) is convergent in the mean to x/2 if we can finally establish the series identity (5-39), and vice versa. As we have seen from (6-78) and (6-90), not every series in the orthogonal functions 1>\" is a Fourier series, including some that converge pointwise as series of functions. This is not the case if we use the notion of convergence in the space *~, for then every convergent series is a Fourier series. 318 ADVANCED CALCULUS Theorem 26 LetL ~ an cPn converge in *<6' to a function g E *<6'. Then i. L ~ 1an 1 2 < 00. ii. g'\" {an}. iii. Iff is any function in *<6' and f '\" {en}, then (6-92) The proof uses the Schwarz inequality, (6-62). Let FN=L; an cPn, so that we have, by hypothesis, *limN_ ce F N = g. By Lemma 1, for any f E *<6', so that N <f, g) - L ancn = <f, g) - <f, FN> 1 and thus by (6-62), I<f,g>-~ancnl= I<f,g-FN>I ~ *llfll*lIg - FNII But, lim N _ ce *Ilg - FNil = 0, and we have proved (iii). To obtain (ii), we take f as cPk' and (6-92) gives us <cPk> g> = ak, so that g '\" {an}, from which (i) follows. I It is natural to ask if the condition L~ Ian 12 < 00 is sufficient to imply that the series L~ an cPn converges. The complicated nature of this question can be seen from the following simple observation. Theorem 27 IfL ~ 1an 12 converges, then the seriesL ~ an cPn is a Cauchy series, meaning that the sequence of partial sums is a Cauchy sequence in the space *<6'. For, if FN= L7an cPn' then, applying Lemma 2 to the Fourier polynomial we have UNIFORM CONVERGENCE 319 M *IIFM - FN I1 2 = 2: lan l 2 N+l and sinceL 1an 1 2 converges, the right side of this approaches 0 as Nand M become large, proving that {Fk } is a Cauchy sequence in the metric of *~. However, as we have seen, the space *~ is not complete, and not every Cauchy sequence converges. As mentioned earlier, this can be overcome by enlarging the space *~ by including a great many discontinuous functions. When this is done, arriving at a function space:? that is complete, then every seriesL ~ an ¢n withL ~ Ian 1 2 < CIJ is convergent, and is therefore the Fourier series of a member of :? (As noted before, this process requires a much more thorough discussion of integration and Lebesgue measure theory, and is best treated as a subject in itself.) Let us return to the initial question: How can one tell if an orthonormal set {¢n} is a Fourier basis for the space *~? Theorem 28 The set {¢n} is a basis for *~ if and only if the collection of all Fourier polynomials P is dense in *~. By \"dense,\" we mean that given anyf E *~, and any E > 0, there is a P with *IIf - P II < E. This clearly holds if {¢n} is a basis, since P could be chosen as one of the partial sums of the Fourier series for f, which by assumption converges tof Conversely, suppose the polynomials are dense; we must then prove that the Fourier series for any f converges to f Choose any E, and then P with *llf - PII < E. Suppose that P has the form L ~an ¢n' Then, combining the minimality property of the partial sums {Sk} of the Fourier series2 Cn¢n for f and their monotonic property (Theorem 25), we have *llf - Skll ~ *llf - SNII ~ *llf - PII < E for all k > N, and *limk~ooSk = f, andf = *2:~ cn¢n' I At this point, we leave the general theory and turn instead to some results that deal specifically with the classical trigonometric Fourier series. Our first theorem shows that the Fourier coefficients of a function f E *~ characterize the function. Theorem 29 The trigonometric functions (6-71)form a muximal orthogonal set on the interval [ - n, n]. 320 ADVANCED CALCULUS What we must prove is that iffis continuous in the interval I = [ -1t, 1t] and if (6-93 ) (' f(x) cos (nx) dx = r\" f(x) sin (nx) dx = 0 . -n . -n for all n = 0, 1, 2, ... , then f is identically 0 on I. We first note that because of (6-93), (6-94) r f(x)P(x) dx = 0 -\" for any trigonometric polynomial of the form N P(x) = L (akcos (kx) + Pk sin (kx)) o We will use this to show thatf(x) = 0 for every x E I by choosing a very special trigonometric polynomial P(x), and do this first for x = O. Suppose thatf(O)\"# 0, and assume thatf(O) > O. Sincefis continuous, there is an 6> 0 and a neighborhood about 0 in Ion which f(x) > 6. We next wish to choose P(x) so that it is extremely small outside this neighborhood of 0, but very large for the points x near 0; such a function clearly cannot satisfy relation (6-94). To construct P(x), we need two elementary results about the cosine function. Lemma 3 Each of the functions (cos x)m is a trigonometric polynomial. The proof is by induction. We have (cos X)2 = -1- + (1) cos 2x. Suppose that (cos xt = Co + Cl cos X + C2 cos (2x) + ... + CN cos (Nx) Then, using the identity (6-72), N (cos xt+ 1 = L Ck cos X cos (kx) o N =L 1Ck(COS (k + l)x + cos (k - l)x) o Lemma 4 If Ix I ~ 1t, then (6-95) This is a routine application of Taylor's theorem with remainder. UNIFORM CONVERGENCE 321 Using these, we now construct the needed polynomial P(x). We suppose thatf(x) > E for all x with Ixl < b. Then, if Ixl < 15/3, we have by (6-95) ib 2 + cos X > ib 2 + 1 - -H~b2) = I + ~b2 while if 15 < Ix I ~ n, - I + ib 2 ~ ib 2 + cos X < ib 2 + 1 - ~b2 = 1 - iab 2 Choose n very large, and set P(x) = (tb2 + cos xV\" Then, expanding this in powers of cos x and using Lemma 3, we see that P(x) is a trigonometric polynomial which is uniformly arbitrarily large for Ixl < 15/3 and uniformly arbitrarily small for 15 < Ixl ~ n, and for it (6-94) must fail. This shows that f(O) = O. A similar argument can be made at any point x = c on the interval I by using the polynomial P(x) = (ib 2 + cos (x - C))2\" where If(x)1 > E for all x with Ix - cl < b. I We next use this to prove that any sufficiently smooth periodic continuous function has a classical Fourier series that converges to it uniformly on the interval I. We prove this in two steps. Theorem 30 Let f be of class C on [ - n, n], and suppose that f (n) = f (- n). Then the Fourier coefficients {a\"}, {b\"} for f obey .L:: la\"1 < 00, 2~ Ib\"1 < 00. By hypothesis,f' is continuous on [-n, n]. Using formulas (6-75), we find the Fourier coefficients off' in terms of those off 1 .\" !X\"= I f'(x)cos(nx)dx n· _\" I I\" n r\"= ~ f(x) cos (nx) _\" + ~. _/(x) sin (nx) dx = (-l)\"(f(n) - f(-n)) + nb\" = 0 + nb\" 1 \" /3\" = ~L\"f'(x) sin (nx) dx 1 I\" n f\"= n f(x) sin (nx) _\" - ~ _/(x) cos (nx) dx = 0 - nan (6-96) 322 ADVANCED CALCULUS Since IXn and fJn are Fourier coefficients of a function in *<i&', Theorem 26 applies andL IIXnl2and L IfJnl2both converge; accordingly, L n21anl2 andL n21bn 1 2 both converge. However, a simple argument with Schwarz' inequality shows that in general, ifL n21Cn 12 converges, so must the series L Icnl, for for all N. Applying this separately, we have L Ian I and L IbnI both convergent. I The next result depends upon the fact that the trigonometric orthogonal set is uniformly bounded. Theorem 31 Iff is continuous on [- rr, rr] and has Fourier coefficients {an}, {bn}, and L lanl and L Ibnl both converge, then the Fourier series forf 00 iao +L (an cos (nx) + bn sin (nx)) 1 converges uniformly tof(x) on [-rr, rr]. First, we observe that the hypothesis on the coefficients ensures that the series (6-96) converges uniformly on I to some function g(x), necessarily continuous. The relation between the norm *11 II and II III (Theorem 24) implies that the series (6-96) converges to 9 in the metric of *<i&', and Theorem 26 implies that the sequences {an}, {bn} must be the Fourier coefficients of g. Accordingly, f and 9 are both continuous on I and have the same Fourier coefficients. By Theorem 29,/ = g. I Combining the last two results yields a number of useful corollaries. Corollary 1 Any periodic function f of class C' on [ - rr, rr] has a uniformly convergent Fourier series. UNIFORM CONVERGENCE 323 In particular, this applies to the function x 2/4, so that we have at last verified (6-77) and the formula for the sum of the numerical series l/n 2 • We next obtain one form of the Weierstrass approximation theorem. Corollary 2 Any periodic continuous function on [ - n, n] can be uniformly approximated there by trigonometric polynomials. In Sec. 2.3, Theorem 7, we saw that f could be approximated uniformly by continuous piecewise linear functions, formed from a finite number of line segments. By rounding off the corners, we see that such a piecewise linear function can be uniformly approximated by a function g of class C. If f is periodic, so that f(n) = f(-n), then g can be chosen to obey g(n) = g(-n), and if we now approximate g on [-n, n] by a partial sum of its uniformly convergent Fourier series, the resulting trigonometric polynomial will be the desired !1niform approximation to the function.f If we now apply Theorem 28, we obtain the following. Corollary 3 The trigonometric orthonormal set (6-71) is a basis for *CC, and every continuous function f has a Fourier series which converges to it \"in the mean,\" that is, in the metric of the space *CC. We must prove that the trigonometric polynomials are dense in *CC. By Corollary 2, they are uniformly dense in the space of periodic continuous functions on [ - n, n], and thus by Theorem 24, they are also dense in the metric *11 II· We need now only observe that the periodic functions are dense in *CC. For, iffis continuous, butf(n) #- f(-n), then a continuous function g can be chosen which coincides with f exactly, except in a small neighborhood of x = n, and which is such that g( - n) = g(n) and *II f - gil is as small as desired. (The same argument shows considerably more; the trigonometric polynomials are dense in the metric *11 II in a much larger space than *CC, including, for example, all Riemann-integrable discontinuous functions. Thus, any piecewise continuous function on [ - n, n] is the limit in the mean of the partial sums of its Fourier series.) We conclude this brief introduction to the theory of general Fourier series with two remarks. The first deals with the sequence space t 2 . Perhaps it has been apparent that this space has played a central role. Given any infinite orthonormal set ¢n in *CC, the correspondence f \"\" {cn}, where Cn= (r. ¢n)' defines a mapping from *CC into t 2, because of the Bessel inequality. If the set {¢n} is maximal, this mapping is I-to-1. However, even if {¢n} is a basis, this mapping need not be onto, so that the complete image of *CC will not fill up t 2 • However, the mapping has several very nice properties. For example, it preserves distance and angle; this is the geometric meaning of Parseval's relation, (6-89), and (6-92). For, iff\"\" {cn } and g \"\" {bn}, and p and q 324 ADVANCED CALCULUS are the points in {2 identified with the sequences {en} and {bn}, then *111 - gil = lip - qll and <f,g)=p'q Thus, each basis for *~ yields a different congruent embedding of *rt as a subset of {2. The seemingly simple space (2 contains all the complexity associated with any basis for the space of continuous functions, as well as that for the enlarged function spaces mentioned earlier in this section. Our second remark returns to several examples given earlier, namely the senes (6-97) and (6-98) sin x + ~ sin (2x) + ~ sin (3x) + ... cos x - cos (2x) + cos (3x) - cos (4x) + ... The first converges for all x, by Dirichlet's test. The second converges for no x. Neither is a Fourier series, for the coefficients do not satisfy (6-84). The series can be obtained by formal differentiation of the following series: 1 1 (6-99) -cos x - -- cos (2x) - -- cos (3x) - ... 2)2 3J3 (6-100) sin x - ~ sin (2x) + ~ sin (3x) - ... which are in fact Fourier series [again by reference to (6-84)]. This suggests that (6-97) and (6-98) ought to be (in some new sense) the Fourier series for the derivatives of the functions associated with the Fourier series (6-99) and (6-100). Such a mathematical theory has been developed, based on what is called the theory of distributions. For it, one must first invent a new concept of differentiation; it then turns out that the \"derivative\" of a function which does not have an ordinary derivative can exist but may be something quite different from the conventional notion of function, and it is these objects that have Fourier series such as (6-97). (Some aspects of this are discussed in Appendix 6.) EXERCISES 1 Find the angle between the following points in (2. p = (1,~.~.~.~....) q = G. ~.}, ~....) 2 Verify the following properties of the inner product and norm in the space *((j. (a) d(f, g) = d(g, f) and d(f, g) = 0 if and only iff = 9 (b) <f, g, + g2) = <f, g,) + <f, g2) <f, rxg) = rx<f, g) = <rxf, g) *llfll = )(1,])- UNIFORM CONVERGENCE 325 3 Verify that the functionsf.(t) = t 1/(2.-1) are \"Cauchy in the space \" '1&'[ -1.1]' 4 Prove Theorem 24 by estimating the integral in (6-59). 5 Use (6-72) to finish verifying that the set (6-7 i) is orthonormal on [ -n. n]. 6 Verify formulas (6-74) and (6-75). 7 Verify (6-76). 8 Verify (6-77). 9 Find the Fourier series of eX on [-n. n] with respect to the orthonormal functions in (6-71). 10 The space of complex-valued continuous functions on the interval I = [0.1] can be made an 1 inner product metric space by means of the definition: (f, g) = \" f(t)g(t) dt. IIJII = j<J.T) . 0 and d(f, g) = Ilf - gil where 9 is the complex conjugate of g. Verify the following properties: (a) (f, g) = (9.1) = (g,f) (b) P(f, g) = (Pf, g) = (f, 71g) (c) Ilcxfll = IcxlllJil (d) IIf - gil = 0 implies thatf = 9 (e) (f, g) + (g,f) s 211fll Ilgli (f) I(f, g)1 s Ilfll Ilgil (g) Ilf + gil s Ilfll + Ilgll (h) Complex (2 has points p = (a\" a2 • •.• ) where the a. are complex numbers obeying L la.1 2 < 00. What is an appropriate definition for the inner product P'q? 11 (a) Verify that the set {<t>.l = {ei' X }. for n = 0, ± 1, ±2, ±3, .... forms an orthogonal set on [0,2n]. Find the normalizing constants that convert this set into an orthonormal system. and find the formula for the Fourier coefficients of a functionf(x) with respect to these functions {<t>J (b) Show how this set is related to the set (6-71). 12 (a) Use (6-65) to obtain the Legendre polynomials for n s 5. (b) Verify directly that P 3 is orthogonal on [-1, 1] to PI and to P 2' (c) Make a change of variable: t = (x + 1)/2. and compare the result with the special orthogonal polynomials <t>.(t) in (6-64). 13 The Chebyshev polynomials 1;,(x) are defined by the recursion To(x) = 1 T,(x) = x 1;,+tlx ) = 2x1;,(x) -1;,-,(x) (a) Find 1;,(x) for n s 5. (b) Verify that T,,(cos lJ) = cos (nlJ). (c) Verify that IT,,(x) lsI for -1 s x s 1. (d) Verify that if n # m 1 dx r 1;,(x)Tm(x)----- = O. '-1 j1=7 14 Complete the following proof that (2 is complete. (a) If p = (b\" b2 , b3 , ... ) E (2. define for any k, U,(p) = L b.e•• .>, (b) Verify that II U,(p)II s IIpll.11 v,.(p)II s IlpII,lim,_oo II U,(p)11 = Ilpll, and lim,_oo II v,.(p)11 = o. 326 ADVANCED CALCULUS (c) Let P. = (a~, ai, a3, ... ) be a Cauchy sequence of points in t 2 • Use U,(P.) to prove that {a~} is a Cauchy sequence for each k. (d) Let c, = Iim._a) a;; and prove that q = (c\" c2 , C3' ... ) belongs to (2. (e) Show that for any £ > 0, there is a ko and an N such that II V.o(p.)11 < 2£ for all n ;:>: N. if) Prove that lim._a) lip. - qll = O. CHAPTER SEVEN DIFFERENTIATION OF TRANSFORMATIONS 7.1 PREVIEW This chapter deals with the central core of multidimensional analysis, the study of transformations from n space into m space. A key tool in this is the dif- ferential (or derivative) of such a transformation T, regarded either as a matrix- valued function or as a function whose value at a point is a linear transforma- tion. Thus, one has T(po) = L, where L is the unique linear transformation such that lim IT(po + dp) - T(po) - L(dp) I= 0 ,1p-O Idp I a formula that resembles the corresponding one for the derivative of a function of one variable. In terms of this general concept of differentiation, which extends the previous concepts defined for real-valued functions, we then obtain the general chain rule in the simple form d(ST) = dS dT, and study the existence of local and global inverses for transformations and the properties of nonsingular mappings, defined as those T having a nonvanishing Jacobian. This leads im- mediately to the implicit function theorems, which give sufficient conditions for the existence of a solution of a system of nonlinear equations, and to the study of functional dependence. 327 328 ADVANCED CALCULUS 7.2 TRANSFORMATIONS In Chaps. 1 and 2, we discussed many general properties of functions that were defined on one set and took values in another set, both possibly being subsets of a space of high dimension. However, most of the material discussed since then has concentrated on the study of scalar-valued (i.e., numerical-valued) functions. In the present chapter, we will be working almost entirely with functions whose range of values will be points in m space, for some specific choice of m such as 2 or 3. These were called vector-valued functions, to distinguish them from scalar-valued functions. To emphasize a different view- point which lays stress on their role as mappings, we shall now use the special term transformation. Thus, if A is a set in n space and B a set in m space, a transformation T of A onto B is a function whose domain is A and whose range is B. We shall say that T carries a point p into the point T(p) = q and call q the image of p under the transformation T. If p is a point in the plane and q a point in space, we may write p = (x, y) and q = (u, v, w) so that T(x, y) = (u, v, w). In this case, we may also describe the transformation by specifying three coordinate functions, and writing l u = f(x, y) T;,v=g(x,y) lw = h(x, y) For brevity, we may also refer to such a transformation as a mapping from R 2 into R 3, even though its domain may not be all of the plane. To illustrate these notions, let us begin with a particular transformation of the plane into itself: (7-1) T)u = x 2 + y2 \\v=x+y Under T, the point (x, y) is sent into the point (u, v). For example, the image of (1,2) is (5,3), the image of (0,2) is (4,2), and the image of (2,0) is also (4,2). Any set of points in the XY plane is carried into a corresponding set of points in the UV plane. It often helps to compute the image of a number of selected curves and regions. To determine the image of the horizontal line y = c, make this substitution in the equations for T, obtaining Ju = x 2 + c2 \\v=x+c This can be regarded as parametric equations for the image curve in the UV plane, or x may be eliminated, resulting in the equation: u = (v - C)2 + c2 (In Fig. 7-1 these curves are shown for several choices of c.) Turning to regions, we first observe that the point (a, b) and the point (b, a) both have the DIFFERENTIATION OF TRANSFORMATIONS 331 general transformation from Rn to Rm can be described by means of the equations: (7-3) lYl :fl(X 1, x 2, , x n) Y2 - f2(X 1> x 2' , x n) T:'i~:~'~'~~(~':\"~';\":::: '~~; where we have written p = (x l' x 2 , ••• , x n ) for the general point in n space, and q = (Yl' Y2' ... , Ym) for the general point in m space. (Note that the subscripts on the functions!; do not indicate partial differentiation.) The labeling of the coordinates of p and q is quite arbitrary; convenience and habit are the guiding criteria. For example, the general transformation from I-space to 3-space can be described by lx=f(t) T:-y=g(t) j z = h(t) where we have put p = t and q = (x, Y, z). In this case, it often helps in studying T to regard these equations as a particular set of parametric equations for a curve in R 3 . Similarly, when n = 2 and m = 3, we may write Ix = f(u, v) , Y = g(u, v) jz=h(u,v) and regard these as a set of parametric equations for a surface in R 3 . Transformations can be combined by substitution to yield new transforma- tions, provided the dimensions of the domains and ranges are compatible. If T is a transformation from Rn to R m, and S is a transformation from R m to R k the transformation R defined by R(p) = S(T(p)) is a mapping from Rn into Rk ; R is often called the product or composite of Sand T. For example, let T be the mapping which sends (x, y) into (xy, 2x, - y) and S the mapping which sends (x, y, z) into (x - y, yz). Then, the mapping R = ST sends (x, y) into (xy - 2x, -2xy). T is a mapping of R 2 into R 3 , and S a mapping of R 3 into R 2 , so that R is a mapping from R 2 into R 2 • In order to calculate the product R = ST, given equations for Sand T, it is convenient to use the same coordinate labels for points in the middle space in both transformations. Thus, if T sends (x, y) into (r, s, t) and S sends (r, s, t) into (u, v), as shown in Fig. 7-4, and if the equations for T and S are (7-4) ~ r = xy T:~ s = 2x j t = - Y S)u=r-s \\v = st then R sends (x, y) into (u, v) and we can read off the equation for R = ST 332 ADVANCED CALCULUS Figure 7-4 directly from (7-4), obtaining R:Ju = xy - 2x \\v = -2xy In this particular example, since T maps 2-space into 3-space, and S maps 3-space into 2-space, we can also form the product of Sand T in the opposite order, obtaining H = TS, which will be a mapping from 3-space into itself. To calculate H, one might restate the equations for Sand T with new coordinate labels for the points. Suppose we say that S maps (x, y, z) into (u, v), and T maps (u, v) into (r, s, t). Then, (7-4) would appear instead in the form (7-5) s)u=x-y \\v = yz lr = uv T:< s = 2u It = -v and H = TS is seen to be lr = (x - y)yz H>s = 2(x - y) j t = - yz Note that ST \"# TS. The definition of continuity for a function as stated in Chap. 2 applies to transformations, as do many of the theorems in Sees. 2.2, 2.3, and 2.4 which were proved there for functions whose values could either be numbers or points. For convenience of reference, we restate some of these here, with references to the earlier discussion. Definition 1 A transformation T defined on a set D is said to be continuous at a point Po E D if and only if for any e > 0 there is a <5 > 0 such that IT(p) - T(po)/ < e whenever Ip - Po 1< <5 and p E D. We remark that a transformation described by equations such as (7-3) is continuous on a set D exactly when each of the component functions /; is continuous on D. DIFFERENTIATION OF TRANSFORMATIONS 333 Theorem I Let T be a tran~formation defined on a set D in n space and taking values in m space. Then, T is continuous on D if and only if T- 1 (CD) is open, relative to D,for every open set CD in m space. This was Theorem 3, Sec. 2.2. We observe that the word \"open\" could be replaced by \"closed,\" since the complement of any open set is closed, and vice versa. Theorem 2 Let T be a transformation defined on a compact set C in n space and taking values in m space. Then, T is continuous on C if and only if the graph of T is a compact set. This was Theorem 12, Sec. 2.4, and the proof there was written to apply to this general case, although the accompanying figure illustrated the one- variable form. Theorem 3 Let the tran~formation S be continuous on a set A and T be continuous on a set B, and let Po E A and S(Po) = qo E B. Then, the product transformation TS, defined by TS(p) = T(S(p)), is continuous at Po. This is Theorem 5, Sec. 2.2; in general, the product or composite of continuous transformations is continuous where it is defined. Theorem 4 Let T be continuous on a set D. Then, any compact set C c D is carried by T into a compact set T(C), and any connected set SeD is carried into a connected set T(S). This combines Theorems 13 and 15, Sec. 2.4, and generalizes the more elementary properties of real-valued functions usually described as the inter- mediate value theorem and the fact that continuous functions always achieve a bounded maximum on any closed and bounded set. Many of these statements follow in fact from the simpler statements about scalar-valued functions because one can throw the argument back upon the coordinate functions!; that describe a general transformation T, as in (7-3). For example, Theorem 4 above implies that the continuous image of any compact set C must be a bounded set. This follows from the fact that each of the scalar functions J; is bounded on C. EXERCISES I Discuss the nature of the transformation T of R2 into R 2 which: (a) Sends (x, y) into (x + 3, y - 1). (b) Sends (x, y) into (y, x). (e) Sends (x, y) into (x - y, x + y). (d) Sends (x, y) into (x 2 , /). 2 Verify the fact that every (u, v) inside the parabola v 2 = 2u is an image under the transforma- tion T described by (7-1) of a point (x, y). 334 ADVANCED CALCULUS 3 What is the image of the line x = 0 under the transformation S described by (7-2)? 4 Discuss the nature of the transformation T which sends (x, y) into (x 2 - y2, 2xy). 5 Find the products in each order of each pair of transformations given in Exercise I. 6 When a transformation T of R\" into R'\" is described by means of coordinate functions, as in (7-3), show that T is continuous in a set D if and only if each coordinate function/; is continuous in D. 7 Construct a transformation of R 2 into R 2 which maps the curve y = x 2 onto the horizontal axis, and the line y = 3 onto the vertical axis. 8 (aT Formulate a definition of uniform contmuity for transformations. (b) Show that a transformation T which is contmuous m a closed and bounded set D IS uniformly continuous there, by representing T in coordinate form. 9 A transformation T is said to be distance preserving if IT(p) - T(q) I = Ip - qI for all points p and q in the domain of T. Sho~ that the transformation of the plane into itself which sends (x, y) into ((x + y)/J2, (x - y)/J2) is distance preserving. 10 Discuss the nature of the transformations T of R2 mto R2 described by: T T (a) (x, y) ---> (sin x, cos y) (b) (x, y) ---> (x 2 + y2, x 2 _ y2) (c) (x. y) ~ (xy. y) (d) T(x, y) = (xy. X 2y2) (e) T(x, y) = (x cos y, x sin y) II A transformation T on R\" to R\" is said to be distance decreasing if there is a constant r, r < I, such that IT(p) - T(q)ls rip - ql Show that the transformation defined by T(x, y) = (3 - h. } - !Y) is distance decreasing. *12 Let T be any distance-decreasing transformation of the plane into itself. Prove that T leaves exactly one point of the plane fixed; that is, T(p) = p has one and only one solution pO. 13 Write a set of equations for the transformation T which reflects the plane (a) Across the line x = 0 (b) Across the line x = 2 (c) Across the line y = x (d) Across the line y = 2x - I 7.3 LINEAR FUNCTIONS AND TRANSFORMAnONS The section which follows this one is devoted to the theory of differentiation for general transformations. The key to this is the use of linear and affine trans- formations as local approximations to a general transformation. For this, only the most elementary aspects of matrix theory and linear algebra are needed; an abbreviated summary of the latter is given in Appendix 3, although the present section is intended to be sufficient without requiring a review of this. Definition 2 A transformation T from Rn to Rm is said to be linear if and only if it has the following two properties: (7-6) T(p + q) = T(p) + T(q) T(2p) = 2T(p) for all p and q for any real number 2 These defining properties immediately prescribe the form of linear transforma- tions. DIFFERENTIATION OF TRANSFORMATIONS 335 Theorem 5 The general linear transformation L from Rn to Rm has the coordinate form: (7-7) I YI = allx l + a l2 X2 + + alnx n i Y2 = a 21 x I + an X 2 + + a2n x n I;~.~.~·~:~·I·~.~~~.~~.~ ~.~~~.~~ where the coefficients aij are (real) constants. For, if we use the standard basis vectors ek for Rn, so that p = (XI' X 2 ' .•. , x n ) is written as n p =2 X k ek = X I el + ... + Xnen I then L(p) = L(2: Xkek), which by (7-6) can be written q = L(p) =2 L(ek)Xk I and if L(ek ) is the point (a lk , a2k' a3k' ... , amk ) in m space, and q = (YI' Y2' ... , Ym), then we have obtained the formula (7-7). The linear transformation L described by (7-7) is also completely specified by giving the coefficient matrix (7-8) whose columns are the points L(ed; the formula in (7-8) has the abbreviated equation (7-9) Y= Ax where x and yare column vectors and we use the standard way of multiplying matrices. Note that we could also write formula (7-7) as Yj = vj • p, using the ordinary dot product of vectors, where vj is the jth row of the matrix A. Scalar-valued linear transformations form an imp~rtantspecial case. These are merely real-valued functions that are also linear according to definition. As linear transformations from n space into I-space, the general formula (7-7) yields (7-10) and the corresponding matrix has only a single row. Restated, every linear DIFFERENTIATION OF TRANSFORMATIONS 337 only if the matrix A is nonsingular, meaning any of the following equivalent statements: (i) the determinant det (A) is not 0, (ii) the rows of A are linearly independent, (iii) the columns of A are linearly independent. A review of the terms and concepts used in this result may be found in Appendix 3, together with a sketch of the proof. The statements in the theorem have immediate translation into statements about the solution of the system (7-7) of linear equations in the special case when n = m and there are the same number of equations as unknowns. If det (A) #- 0, then for any given set of yj' there is one and only one solution for the Xi' In particular, when YI = Y2 = ... = Yn = °then the only solution of the system is XI = x 2 = .. , = x n = 0. Con- versely, if det (A) = 0, then L is not I-to-l, and there exists a point p = (XI' x 2 ' ... , x n ) #- 0 with L(p) = O. Accordingly, when det (A) = 0, the system of linear equations obtained by setting Yj = °for all j has a solution Xi not all 0. A linear transformation L that is nonsingular has an inverse, C I, and the matrix representing it is called the inverse of the matrix A that represents L. Thus, if det (A) #- 0, there is a unique matrix A - I such that AA -I = A -I A = J, the n-by-n identity matrix. There are a number of computational ways to construct A - I from A. If n = 2 and then where d = det (A) = ad - bc #- ° At times it is economical of notation to use the same symbol for a linear transformation and for a matrix representation of it, where this will not lead to confusion. Thus, one might write det (L) rather than det (A). The behavior of a singular transformation L is further characterized by the rank of its matrix. The rank of A is defined as the number of rows (equivalently, the number of columns) that are linearly independent; rank (A) is an integer between °and n. One can have rank (A) = °only if all the entries in A are 0, and rank (A) = 1 only if all the rows are multiples of one of the rows, itself not (0,0, 0, ... , 0) = O. Theorem 7 Let L be a linear transformation represented by a square n-by-n matrix A .. then thefollowing statements are equivalent: (i) rank (A) = r .. (ii) L maps all of n space onto an r-dimensional subspace of n space .. (iii) the null space of L, which is the set of all points p with L(p) = 0, is a subspace of n space of dimension n - r. When r = n, this result reduces to that of the preceding theorem. For a review of the concepts that appear in these two results and a sketch of their proof, we refer again to Appendix 3. 338 ADVANCED CALCULUS A linear transformation is continuous everywhere, since this is clearly true for a linear function. More than this is true; any linear transformation from Rn into Rm is everywhere uniformly continuous. This is equivalent to the next theorem. Theorem 8 Let L be a linear transformation from Rn into Rm represented by the matrix [aiJ Then, there is a constant B such that IL(p)1 ::;; Blplfor all points p. I~~ 11/2 We shall find that the number ILL 1ail, will serve for B. Put p = (Xl' X2, ... , x n ) and q = L(p) = (YI' Y2' ... , Ym), so that n Yi= L aijx j i= 1,2, ... ,m J= 1 We have Ipl2 = L~=l IXjl2 and Iql2 = L~=I IYiI2 . Accordingly, I n 12 n n n IYi 12::;;,L laijllxjl, ::;; L laijl2L Ixjl2= Ipl2 L laijl2 Ij=1 l j=1 j=1 J=I where we have used the Schwarz inequality (Sec. 1.3): Adding these for i = 1, 2, ... , m, we obtain m m n Iql2 = L IYil 2 ::;; Ipl2L L laijl2 i=1 i=1 J=I It should be remarked that the number B which we have found is not the smallest number with this property. For example, the transformation L specified by the identity matrix l~ ~J is such that IL(p)1 = Ipl, while the theorem provides the number B=fi> I However, this is not the case for linear functions. Let L be specified by the row matrix [c I' C2' ... , cn]. Then, according to the theorem, DIFFERENTIATION OF TRANSFORMATIONS 339 This is best possible, for taking p = (c 1, C 2 , ..• , cn), we have L(p) = c c + ... + c CI Inn In the study of general transformations on n space. It IS convenient to introduce a class of special transformations that is somewhat larger than the linear transformations. These are called affine, and have the simple form T(p) = A(p) + f3 where A is linear and f3 is a fixed vector. In coordinate form, an affine trans- formation from Rn to Rm is described by writing T(p) = q, where p = (x), X2,· .. , x n), q = (YI' Y2' ... , Ym), and YI = al1x 1 + a l2 x 2 + + alnxn + b l Y2 = a 21 x 1 + a 22 x 2 + + a2n x n + b2 These can be regarded as the generalization of straight lines, since the equation for an affine map from R to R is merely Y = ax + b. Since the effect of the added vector f3 is to translate rn space by a shift in a certain direction, the geometry of affine transformations as mappings is deter- mined again by the nature of the linear transformation A (see Exercise 11). EXERCISES I Let L be the linear function specified by the coefficient matrix [2,0, - I, 3]. What is L(I, 1, -I, -I)? What is L(2, 0, 0, I)? 2 Find the linear function L such that L(I, 0, 0) = 2, L(O, 1,0) = -1, L(O,O, 1) = 3. 3 Find the linear function L such that L(I, 0, -1) = 3, L(2, -1,0) = 0, L(O, I, 0) = 2. 4 Let T be the linear transformation of R 2 into R 2 specified by the matrix [ 2 -I] -3 0 Find the images of the points (1,2), (- 2, 1), (1,0), (0, I). 5 Let T be the linear transformation specified by o -1] 3 1 Find the images of (1,2, I), (1,0,0), (0, 1,0). 6 Find the matrix representation for the linear transformation T which (a) Maps (1,0,0) mto (0, I, I), (0, 1,0) into (1,4,0), and (0,0,1) into (2,3,1). (b) Maps (1, 1,0) into (0,0, I), (0, 1, I) into (1,0,0), and (1,0, 1) into (1,0,0). 340 ADVANCED CALCULUS 7 Compute the ranks of the following matrices: (a)[} 2 -~] (b{~ 1 -f]-I -I 1 0 (c) [ ~ -6 -In (d)[i -I 0 - ~] -4 3 I -2 4 I 1 8 By computing ranks, discuss the nature of the image in UVW space of all of XYZ space. If either transformation is nonsingular, find the equations for its inverse. , u = x + 2y - 3z (a) 1 v = 2x - y + 4z I w = 3x + Y + z lu=y-z (b); v=3x-y+3z /w=x+z 9 Compute the indicated matrix products: [2 -3J[-I 4J(a) 0 1 I 3 -1][ 23]o -1 2 I (b) [_ ~ (d) [-~ -I -7 o -1 o 1 ~J[~ -0 0][-1 1]1 3 2' I -2 0 10 Find the product ST of the transformations given by S: (x, y, z) ---+ (6x - y + 2z, 2x + 4z) T: (x, y) ---+ (x - y, 2x, -x + 2y) Can you form the product TS? II (a) If T is an affine transformation, show that for any points p and q and all real A, T(Ap + (1 - A)q) = H(p) + (I - A)T(q) (b) What is the geometric meaning of this conditIOn? (c) Does this condition characterize affine transformations? *12 Given any function f of one variable, infinitely differentiable, define M(f) = [j, J f~] f\" 21' Verify the following facts: (a) 11 M(f) = M(f') dx (b) M(f)M(g) = M(fg) (c) M(P(f)) = P(M(f)) where P IS any polynomial (d) eMIf) = M(ef ) (e) M(~) = M(ff' DIFFERENTIATION OF TRANSFORMATIONS 341 7.4 DIFFERENTIALS OF TRANSFORMATIONS In Chap. 3, we defined the (total) derivative of a scalar-valued functionf defined on an open set S to be a vector-valued function Df defined on S and con- structed from the partial derivatives off Specifically, if y =f (x!, x2, ... , x n ), then (7-12) ( ay ay ay ay ) Df = ax!' aX2' ax3' ... , aX n At any point PES, Df(p) is a numerical vector with n components, the values !;(p) of the partial derivatives offat p; this was also called the gradient offat p. In this section we take the next step and define the derivative of a vector- valued function T; this will turn out to be a matrix-valued function whose entries are the partial derivatives of the coordinate functions describing T. Note that we prefer to treat T at present as a transformation. We adopt a slightly different notation and terminology from that used for he simpler case discussed in Chap. 3. The derivative of a transformation T will now be called the differential of T, written dT. This is because our view- point must now be somewhat more abstract in order to develop a general theory. If T defined on a set S eRn, and is of class C' there, then dT will be a function that is also defined on S, but whose value at a point pES is a linear transformation L on n space. Since linear transformations can be represented by matrices, dT can also be regarded as a function on S whose value at each point of S is a matrix with numerical entries. Computationally, dT is therefore a matrix-valued function on S whose entries are the first partial derivatives of the component functions that describe the transformation T. The dual role of dT, as a function whose values are linear transformations, and as a function whose values are numerical matrices, is chiefly a notational problem and will become clearer as we develop more of the theory. Let us start by considering a transformation T of R 3 into itself which is given by a set of equations such as (7-13) ~ u = f(x, y, z) T: 1v:: g(x, y, z) w - h(x, y, z) We shall say that T is of class c(n) in a region D whenever each of the coordinate functions f, g, and h is of this class in D. In particular, T is of class C' in D if all the partial derivatives au/ax, au/ay, ... , aw/ay, aw/az exist and are continuous in D. DIFFERENTIATION OF TRANSFORMATIONS 343 It may be observed that if (7-17) is written in the explicit coordinate form IYl :!1(X1, X 2 ,· •. , x n ) (7-19) T:,Y2-!2(X 1,X 2\"\",x n ) I~~~·j~(~·l·'·~~·\"'·'·'·'.;~) then the rows of the matrix (7-18) are exactly the total derivatives, as in (7-12), of the coordinate functions in (7-19). In our new notation, we write these as 4h d!2' etc. Before examining the significance of the differential dT and explaining its role in obtaining local approximations to T, we will try to clarify the dual nature of dT, using for this purpose the more familiar case of a scalar function g whose differentiation theory was discussed in Chap. 3. As preparation for the next paragraph, please review the connection between linear functions Land their representation in terms of vectors and dot products as outlined in Sec. 7.3. Suppose that g is a real-valued function of class C' defined on an open set Sin 3-space. Writing g(x, Y, z), we recall that its vector-valued derivative in S is the function Dg defined by (7-12) as (7-20) Dg(p) = (gAp), gy(p), g.(p)) for pES On the other hand, the differential dg is a function defined on S whose value at pES is the linear transformation that is represented by the I-by-3 matrix [gAp), gy(p), g.(p)). Such a matrix with only one row represents a linear function Lon R 3, so that we now have dg(p) = L; like any linear function, L is defined everywhere in R 3, and if u = (a, b, c), then by (7-10), L(u) = gAp)a + gy(p)b + gz(p)c However, we can also use the alternative dot product formulation of this and have L(u) = [gAp), gAp), g.(p)] . (a, b, c) which, from (7-20), can also be written L(u) = Dg(p) . u Since L = dgl p , we have proved the following basic identity connecting the differential dg of the scalar function g with the vector-valued derivative Dg treated in Chap. 3. Theorem 9 For any pES and any u E R 3, (7-21 ) dglp(u) = Dg(p)· u The obvious similarity of the notation on both sides of this equation emphasizes the identity itself and shows that our new viewpoint gives nothing basically new when we apply it to scalar-valued functions. 344 ADVANCED CALCULUS Turning now to transformations T, which in the present context can be regarded merely as vector-valued functions defined on an open set S, we again will refer to the differential of T in two ways. The primary meaning of dT is a function defined on S whose value at any point Po E S is a linear transforma- tion L; the secondary meaning is a function defined on S whose value at any point Po E S is the matrix that represents the corresponding linear transforma- tion L. The latter is what we calculate with when we work with derivatives of transformations; the former is what we use when we prove theorems. The significance of the differential lies in the next result, which shows that these linear transformations provide local approximations for T. Theorem 10 Let T be of class C in an open region D, and let E be a closed bounded subset of D. Let dTlpo be the differential of T at a point Po E E. Then, (7-22) where (7-23) where uniformly for Po E E. Let T be given by T(xI' X2' ... , x n ) = (YI' Y2' ... , Ym) where Yi = <p;(p) = (/J;(x l , x 2, ... , x n ). (The subscript on <Pi does not indicate dif- ferentiation.) Then T(po + ~p) - T(po) = (~YI' ~Y2' ... , ~Ym) ~Yi = <p;(Po + ~p) - <p;(Po) To each of these, we apply the approximation theorem for functions, in the stronger form outlined at the end of the proof of Theorem 8, Sec. 3.3, to write [using (7-21)] Combining these, we have where and T(po + ~p) = T(po) + L(~p) + R(~p) L(~p) = (d<Pl(~P), d<P2(~p), , d<Pm(~P)) R(~p) = (RI(~p), R2(~P), , Rm(~P)) If we now set ~p = (~xI' ~x2' ... , ~xn)' then T: 346 ADVANCED CALCULUS The differential of a transformation T is also seen to correspond to the initial terms in a power series representation for T. Suppose that T(x, y) = (u, v), where { u = f(x, y) v = g(x, y) and suppose that we can expand f and g in double power series at the origin. u = aOO + alOx + aolY + a20 x 2 + allxy + ao2y2 + . v = boo + blOx + b01Y + b20 X 2 + bll xy + b02 / + . Then, this can be written T(x, y) = (aoo, boo) + f::: :::~f:~+ R(x, y) where R = (R l, R 2) and Note that R l = a20x2 + allxy + ao2y2 + . R 2 = b20 X 2 + bll xy + b02y2 + .. dTlo= falo aOl] blO b01J and that the expression for T(x, y) given above corresponds exactly to the form in (7-22), with Po = (0,0) and dp = (x, y). This process of cutting off all terms in a power series higher than the first order is called linearization, and is a frequently used technique for gaining understanding about the local behavior of a transformation. Our next result is the general chain rule of differentiation for products of transformations. It includes the earlier forms of the chain rule that were discussed in Sec. 3.4 in connection with differentiation of composite functions. Consider two transformations Tand S, with Tdefined from R\" into Rk and S from R k into Rm. Their product STis the composite mapping from R\" into Rm. We show that d(ST) = dS dT. Theorem 11 Let T be~i~ an open set D, and let S be differentiable on an open set containing T(D). Then, STis differentiable on D, and if p E D and q = T(p), then (7-26 ) d(ST) Ip = dS IqdT Ip Before proving this, we illustrate it in several typical cases similar to some treated in Sec. 3.4; the calculations are reduced to multiplication of matrices. DIFFERENTIATION OF TRANSFORMATIONS 347 Let Sand Tbe given by I u = f(x, y, z) jx = F(s, t) S:i u = g(x, y, z) T:lY=G(s,t) Iw = h(x, y, z) z = H(s, t) Their differentials are au au au ax ax - - ax ay az as at au au au dT= ay ay dS = - - - ax ay az as at aw aw aw az az ax ay az as at The transformation STis given by I u = f(F(s, t), G(s, t), H(s, t)) ST: u = g(F(s, t), G(s, t), H(s, t)) w = h(F(s, t), G(s, t), H(s, t)) and its differential is au au - -- as at d(ST) = au au - - as at aw aw as at Multiplying the matrices, we obtain dSdT = au ax au ay au az--+--+-- ax as ay as az as au ax au ay au az---+--+-- ax as ay as az as awax away awaz---+--+-- ax as ayas azas au ax au ay au az--+--+-- ax at ay at az at au ax au ay au az--+--+-- ax at ayat azat awax away awaz--+--+-- ax at ay at az at However, this is exactly the matrix which results from computing the partial derivatives by the chain rule and substituting into d(ST). Other instances of this general formula for computing the differential of a composite transformation will be found in the exercises. The more complicated examples of Sec. 3.4 can also be obtained in this fashion. Consider, for 348 ADVANCED CALCULUS Figure 7-6 example, the following set of equations: u = f(x, y, z) z = g(x, y, t) y = h(x, t) These may be used to express u in terms of x and t, and the corresponding diagram is Fig. 7-6. We introduce three transformations, R, S, and T, such that u = (STR)(x, t). R is the mapping of R 2 into R 3 given by ~ x = x R:\\ y = h(x, t) I t = t Tis the mapping of R 3 into R 3 given by Ix = x T:, y = y Iz = g(x, y, t) S is the mapping of R 3 into R 1 given by S: u = f(x, y, z) In order to find the partial derivatives au/ox and au/at, we shall find the differential [ au oUJ d(STR) = ox' at By Theorem 11, d(STR) = dS dT dR, where we have Computing these products, we have dS dT = (fl + f3gl' f 2 + f 3g2, f 3g3] and dS dT dR = (fl + f 3g 1 + (f2 + f 3g2)hl, (f2 + /3g2)h 2 + /3g3] DIFFERENTIATION OF TRANSFORMATIONS 349 SO that we may read off the correct expressions for the desired partial derivatives au ax = f l + f 3 9 I + f 2 hI + f 3 92 hI au at = f 2 h2 + f 3 92 h2 + f 3 93 We now return to the proof of Theorem 11. We have T(p) = q. Take tlp small, and write tlq = T(p + tlp) - T(p). Thus, q + tlq = T(p + tlp), and (ST)(p + tlp) = S(q + tlp). Apply the local approximation theorem (Theorem 10): The same theorem applied to T(p + tlp) yields tlq = T(p + tlp) - T(p) (7-27) and combining these, we have (7-28) (ST)(p + tlp) = ST(p) + dSlqdTlp(tlp) + R(tlp) where (7-29) To prove ST differentiable at 'p, we must now show that lim~p_o IR(tlp)I/ltlpl = O. We use the fact that Sand T are each differentiable, which implies that R 1(tlq) < eItlq I for small Itlq I and that R 2(tlp) < eltlpl for small Itlpl. We also use the standard boundedness property of linear transformations, stated in Theorem 8. This enables us to know that there is a number M such that IdT Ip (tlp) I ~M Itlp I I dSlq (R 2(tlp)) I ~MIR 2 (tlp)1 for all tlp. From (7-27), we next have 350 ADVANCED CALCULUS Then, using this in (7-29), we have IR(.1p) I ~ MIR 2 (.1p)1 + el.1ql ~ Mel.1pl + e(M + 1)I.1pl ~ (2M + 1)el.1pl and since e is arbitrarily small, lim~p_o IR(.1p)I/I.1pl = 0 I Before leaving the chain rule, we note that if Sand T are of class C', the correctness of the formula d(ST) = dS dT can be verified as illustrated above by falling back upon the earlier versions of the chain rule. The advantage of the proof given above is that it merely requires existence of the differentials, and therefore gives a sharper theorem. We conclude this section with the mean value theorem for general transformations. To avoid making the notation too complicated, we state it only for transformations from 3-space into 3-space; the general formulation of the result is evident from this. Note also that this mean value theorem differs from the corresponding result for scalar functions, given in Theorem 16, Sec. 3.5, in that we cannot now expect to have a single auxiliary point p*. Theorem 12 Let T be a transformation of class C' defined for all points p = (x, y, z) in an open set D by I u = f(x, y, z) T: v=g(x,y,z) w = h(x, y, z) Let D contain the points p' and p\" and the line segment which joins them. Then, there are three points pt, p~, and pj lying on this line segment such that T(p\") - T(p') = L(p\" - p') where L is the linear transformation represented by the matrix (7-30) This may be proved by applying the mean value theorem (Theorem 16 of Sec. 3.5) to each of the functionsf, g, and h. Setting p\" - p' = .1p = (.1x, .1y, .1z) we have at (1,1) at (I, -2,3) at (I, -1) and (I, 3) DIFH::1:.ENTlATlON OF TRANSFORMATIONS 351 where pf is some point on the line segment joining p' and p\". Similarly, g(p\") - g(p') = gl(P!) L\\x + g2(P!) L\\y + g3(P!) L\\z h(p\") - h(p') = hi (p;) L\\x + h2(p;) L\\y + h3(pj) L\\z and the result follows. I The following consequence of this theorem is sometimes handier to use. Corollary Let T be a transformation of class C' on an open set D in n space, and let E be a compact set in D. Then, there are numbers M and <5>0 such that IT(p)- T(q)1 ~Mlp-ql for all p and q in E with Ip - qI < <5. If E is convex, <5 = diam (E). To show this, let <5 1 = dist (E, bdy (D)); <5 1 > 0 since E is compact. Let E 1 be the set of all points p whose distance from some point of E is not more than <5 1/2. Then E 1 is also compact, and E eEl c D. Moreover, if <5 < <5d2 and p and q lie in E 1 with q E E and Ip - ql < <5, then the entire segment from p to q lies in E l' Applying Theorem 12, T(p) - T(q) = L(p - q); the functions in the matrix for L are continuous on E 1 and thus bounded there, and the auxiliary points pf, pL ... , P: which are used in the qefinitions of L and which lie on the segment from p to q also lie in E 1.ffhus, the entries of L are uniformly bounded, and Theorem 8 provides a number M such that IL(p - q)1 ~ Mlp - ql. If E itself is convex, then the segment joining p and q lies in E whenever p and q do, so that we do not need to construct the set Eland do not need to have p and q close together. As before, the bound M on L is obtained from uniform bounds on E of all the functions in the matrix for L, and we again have IL(p - q) I ~ M Ip - q I, and therefore (7-31) IT(p) - T(q)1 ~ Mlp - ql EXERCISES I Compute the differentials of the following transformations at the indicated points. ju = xy2 - 3x' (u) \\ v = 3x _ 5y 2 ju = xyz2 - 4y2 (b) \\ v = 3xy 2 _ y2 z ~ U = x + 6y (c) 1v = 3xy jw=x 2 -3 y 2 2 If Lis a linear transformation, show that dLjp = Lat every point p. 352 ADVANCED CALCULUS /,. (b) S)u = F(x, y) \\v = G(x, y) 3 Using the methods of Sec. 3.4, verify Theorem 11 for the following transformations: (a) S: u = F(x, y) T·Jx = c/>(t) '\\y = t/J(t) T.Jx = c/>(t) '\\y = t/J(t) 4 Let w = F(x, y, t), x = c/>(t), y = t/J(t). Show that Theorem 11 can be applied to yield Eq. (3.22) for dwjdt. 5 Let T be a transformation from R2 into R 2 given by u = f(x, y), v = g(x, y). Let L be a linear transformation L = [~ ~] such that T(po + ~p) - T(po) = L(~p) + R(~p), where lim\"p_oR(~p)jl~pl = O. Prove that L=dTlpo' 6 Prove: If Tis of class e\" in an open connected set D, and dT = 0 at each point of D, then Tis constant in D. 7 Is there a transformation T of the plane into itself whose differential at (x, y) is given by [3: 2y :;] 8 Is there a transformation whose differential is 9 Explain the difference between (7-24) as applied to a scalar function of one variable and (7-25). 10 Show that a differentiable transformation (Definition 3) cannot have two different differentials at the same point. 11 Given the transformation on E, the unit square with (0,0) and (I, I) as diagonal corners, show that an estimate for the Lipschitz constant M for E in (7-31) isv!130. 12 Consider the transformation T(x, y) = (u, v) defined on the unit square E: 0 ~ x ~ I, 0 ~ y ~ I, where u=2x 2 +6xy-4x 3 j3-3 xy 2 and V=X 3 _ y 2 Show that an estimate for the Lipschitz constant M for E in (7-31) is M = )65. 7.5 INVERSES OF TRANSFORMATIONS Much of the discussion in Sec. 2.7, dealing with inverses of functions of one variable, applies with few changes to the study of inverses of transformations from n space to n space. If T is a transformation of the plane into itself, and maps a set D l-to-l onto a set D', then this defines a transformation T- 1 which maps D' onto D, reversing the action of T. If p E D, then T- 1T(p) = p, so that DIFFERENTIATION OF TRANSFORMATIONS 353 and if qED', TT- I(q) = q. A transformation which is not 1-to-1 may have a number of partial inverses. For example, the transformation (7-32) T· Ju = 2xy . \\v = x 2 _ y2 maps the whole XYplane onto the UVplane. It is not 1-to-1 in the whole plane, since T sends both (1,1) and (-1, -1) into (2,0). More generally, T(p) = T( - p) for any point p. However, if we take D to be the open half plane {all (x, y) with x> O}, then T is 1-to-1 in D. To see this, let T(x, y) = T(a, b). Then 2xy = 2ab and x 2 _ y2 = a2 _ b2 0= X2(X2 _ y2 _ a2 + b2) = x 4 _ X 2 y 2 _ a2x 2 + b2x 2 = x 4 _ a2b2 - a2x 2 + b2x 2 = (x 2 + b2)(X2 - a2) Hence, x 2 = a2, and since x> °and a> 0, x = a and y = b. T thus maps D onto a set D' in the UV plane in a 1-to-1 fashion. This mapping has an inverse which maps D' onto D. Solving Eqs. (7-32), we obtain SI: JX = f v + J ;2+ v2r 2 j y = u[2v + 2Ju 2 + v2r 1/2 The set D' is the set of points (u, v) for which v + J.--cU2--+-V-' 2 > 0, that is, all points (u, v) except those of the form (0, c) with c sO. The graphical approach used in Sec. 2.7 can still be used here, and the proof given there for Theorem 25 also proves the following theorem. Theorem 13 If T is continuous and 1-to-1 on a compact set D, then T has a unique inverse T- 1 which maps T(D) = D* 1-to-1 onto D, and T- 1 is continuous on D*, For, the graph of T is itself a compact set by Theorem 12, Sec. 2.4, and the graph of T- 1 is just the reflection of the graph of T and is also compact, so that the transformation T- 1 must also be continuous. I (Another equally brief proof of this theorem is outlined in Exercise 14.) It is easy to tell if a real-valued continuous function f of one variable is 1-to-1 on an interval, for it must be monotonic there; iff is differentiable, and f'(x) =F°on an interval I, then f is 1-to-1 on I and has an inverse that is also differentiable (Theorem 7, Sec. 3.2). We seek a similar criterion for transformations. The special case of linear transformations gives the clue. If Lis a linear map on R\" into itself, it is 1-to-1 if and only if it is nonsingular, 354 ADVANCED CALCULUS and this is equivalent to the condition det (L) # O. This would lead one to conjecture that a general transformation Tis 1-to-1 on an open set D if dT is nonsingular at every point of D. (Note that this reduces to the requirement .f'(x) # 0 if T is a function f on R to R.) We shall see that this conjecture is almost correct. We introduce the following: Definition 4 If T is a transformation from Rn into Rn which is of class C' in a set D, then the Jacobian of T is the function J defined in D by J(p) = det (dT Ip) For example, if Tis given by J(p) =then ~u=f(x,y,z) j v:: g(x, y, z) I w - h(x, y, z) fl(p) f2(p) f3(p) o(u, v, w) I gl(P) g2(P) g3(P) = o( ) h1(p) h2(p) h3(p) x,y,z p The Jacobian of the transformation given in (7-32) is ! 2Y 2xl=_4(X2+y2) 2x -2y One is thus led to the conjecture that if J(p) # 0 throughout a region D, then Tis 1-to-1 in D. This conjecture is false. A simple counterexample is supplied by the transformation (7-33 ) T: {u = xc?S y v = x Sill Y whose Jacobian is J(x )= IC?SY -xsiny I=x ,y Sill Y X cos Y In the right half plane D = {all (x, y) with x > O}, J is never O. However, Tis not 1-to-1 in D, for (a, b) and (a, b + 2n:) always have the same image. The effect of the transformation may be seen from Fig. 7-7, where a set of SeD is shown, together with its image T(S). We notice that although T is not 1-to-1 in S, two distinct points of S which have the same image must be widely separated; thus, in S (and in fact in D), Thas the property of being locally 1-to-1. We give this a formal definition. Definition 5 A transformation which is defined in an open set D is said to be locally 1-to-1 (or locally univalent) in D if about any point p E D there is a neighborhood in which Tis 1-to-1. 356 ADVANCED CALCULUS Introduce a special function F defined for any triple of points of D by [ fl(Pd f2(pd f3(Pdj F(PI,P2,P3)=det gl(P2) g2(P2) g3(P2) hl (P3) h2(P3) h3(P3) Thus, F(pT, pi, pn = det (L), and F(p, P, p) = J(p). Moreover, since TEe, F is continuous, so that, since J(p) #- 0, there is a spherical neighborhood N about P and lying in D such that F(Pl' P2' P3) #- °for all choices of the points PI' P2' and P3 in N. We shall show that Tis I-to-l in N. We must therefore show that if P' and p\" are points of N for which T(p') = T(p\"), then p' = p\". Since p' and p\" lie in Nand N is convex, the entire line segment joining p' to p\" also lies in N; in particular, each of the points pT, pi, and p~ is a point of N. Using the characteristic property of N, we have F(pT, pi, pn = det (L) #-° The linear transformation L is therefore nonsingular. Returning to Eg. (7-34) and using the assumption that T(p') = T(p\"), we have L(p\" - p') = ° or L(p') = L(p\"). But, since L is nonsingular, L is l-to-1, and p' = p\". I Corollary If T is a transformation from Rn into Rn which is of class C in a neighborhood of a point Po, and J(po) #- 0, then Tis I-to-l on a (usually smaller) neighborhood of Po, and has there an inverse T- 1• Thus, a transformation Tdefined on an open set D whose Jacobian never vanishes on D is very well behaved there; it has continuous local inverses everywhere, although it need not have a single inverse defined on the total image set T(D). The next result describes an important property of such maps. Theorem 15 Let T be of class C 0/1 an open set D in n space, taking values in n space; suppose that J(p) #- 0 for all p E D. Then, T(D) is an open set; thus, T carries every open set in D into an open set. Take any point qo E T(D). We must show that qo is surrounded by a neighborhood which is composed entirely of image points of D. Let Po be any point in D with T(po) = qo. Since D is open and J(po) #- 0, we can choose a closed neighborhood N about Po (a closed disk if n = 2, a closed ball if n = 3) which lies in D and on which T is a I-to-l transformation. Let C be the closed set which is the boundary of N (a circle for n = 2, a spherical surface for n = 3). Since T is continuous and I-to-l in N, Theorem 4 shows that the image T(C) of this set is a closed and bounded set which does not contain qo, the image of Po. Let d be the distance from qo to the nearest point of T(C) (see Fig. 7-8). We shall show that any point within d/3 of qo is in T(D). Let ql be any such point, so that Iql - qo I < d/3. As p wanders throughout N, how , , , , ....._-- ..... C hgurt'1-H l' 1)I~H,Il[NTIATION01' TIlANS~UIlMATI{)NS357 close does T(p) come to (It '! The square of the distance from T(p) to ql is 4>(p)~ IT(p)-q,I' whit:h is continuous for pEN. Let p* be a point in N for which q,(p) is minimum; this is then a point whose image T(p*) is as close as possible to lhe point (Ii. Can p* lie on C, the boundary of N? When p is on C, IT(p) - /10I ~ II, so that IT(p) - Iii I ~ (/ - :\\11 = H Thus, the closest that T(p) can gel to lfl for p on C is jll. However, the point Po itself has image /10' which is only !II away from ql' Thus. lhe point p* will not lie on C, and is therefore an interior point of N. Since p* minimizes q,(p), the partial derivalives of q, must all vanish at p*. To see what this implies, we return to a coordinate description of T, and obtain a formula for 1>. Let us suppose thaI II = 2, so that TOlay be given by J\" ~ fix, J') \\ I' = .//(x, J') Lei lfl = ((I, h). Then, the formula for the distance between ql and (1/. t') = T(p) gives 4>(pl ~ (\" - a)' + (\" - b)' The partial derivatives of q, are given by 0/1 (II' t/Jdp) = 2(11 - a) ilx + 2(t' - b) cx GU a\" q,2(P) = 2(11 - a) (l.r + 2{v - h) t1.r Al the extremal point p*, both arc 0, so that (7-35) 0= (1/ - a)!;(p*) + (I' - b)ydp*) 0= (II - a)!2(p*) + (I' - b)Y2(P*) 358 ADVANCED CALCULUS The determinant of the coefficient matrix of these equations, regarded as linear equations in u - a and v - b, is Ifl(p*) gl(P*) 1= J(p*) i' ° f2(p*) g2(P*) The only solutions of (7-35) are then the null solutions, u - a = 0, v - b = 0. Thus, T(p*) = (u, v) = (a, b), and T(p*) = ql. This shows that the minimum value of 4J is actually 0, and the point ql is always the image point of some point in N. This holds for any point ql lying in the neighborhood of radius d/3 about qo, so that qo is an interior point of the image set T(D). Since qo was any point of T(D), T(D) is an open set. I One fact about mappings with nonvanishing Jacobians remains to be proved. We must prove that the local inverses are themselves differentiable transformations, and find a formula for their differentials. Theorem 16 Let T be of class C' in an open set D, with J(p) i' °for all p E D. Suppose also that T is globally l-to-l in D, so that there is an inverse transformation T- I defined on the open set T(D) = D*. Then, T- 1 is of class C' on D*, and d(T- 1)Iq = (dTjpr \\ where q = T(p). Let qo and qo + !J.q be nearby points of T(D). We shall show that T- 1 is of class C' by exhibiting a linear transformation which has the characteristic approximating property of the differential, and whose entries are continuous functions. By Exercise 5, Sec. 7.4, this transformation must be the differential of T- I and the entries are the required partial derivatives. Let Po = T- 1(qo) and p = T-1(qo + !J.q), and set !J.p = p - Po. Thus, (7-36) !J.q = T(p) - T(po) = T(po + L1p) - T(po) (7-37) !J.p = T-1(qo + !J.q) - T- 1(qo) Let dT be the differential of T at Po. By the approximation property (Theorem 10), applied to (7-36), we have (7-38) !J.q = dT(!J.p) + R(!J.p) where (7-39) lim IR(!J.p) I =0 ~p-o l!J.pl Since J(po) i' 0, dT is a nonsingular linear transformation and has an inverse (dTr 1. Applying this linear transformation to both sides of (7-38), (7-40) (dTr I (!J.q) = (dTr ldT(!J.p) + (dTr I (R(!J.p)) =!J.p + (dTr 1(R(!J.p)) DIFFERENTIATION OF TRANSFORMATIONS 359 so that, starting from (7-37), T- '(qo + Aq) - T-'(qo) = Ap = (dTr '(Aq) - (dTr '(R(Ap)) = (dTr l(Aq) + R*(Aq) where (7-41 ) If we show that (7-42) R*(Aq) = - (dTr '(R(Ap)) lim IR*(Aq)1 = 0 t.q-O IAq I then we will have shown that T-' satisfies the requirements of Definition 3 and is therefore differentiable at qo, and that its differential at that point is (dTr '. To prove (7-41) we use the boundedness theorem for linear transformations to choose a number M such that l(dTr1(u)j ~ Mlul for all u. We apply this twice to obtain from (7-41) (7-43 ) and from (7-40), (7-44) IR*(Aq)1 ~ M IR(Ap)1 Because of (7-39), we can assume IR(Ap) I ~ eIAp I, and putting this in (7-44), we obtain (1 - eM)IApl 5 MIAql, and then M (7-45) IApl ~ 1 _ eM IAql Returning to (7-43), we have M 2 IR*(Aq)1 ~ MelApl 5 e 1 _ eM IAql and since e is arbitrarily small, (7-42) is proved. The proof of the rest of Theorem 16 is easy. Now that we know that T-' is differentiable, and that dT-' = (dTr 1 at corresponding points, then since the entries of (dTr' are rational functions of the entries of dT, and since the latter are all continuous in D, so are the entries of (dTr', and since T-' is continuous, these become continuous function on the set D* = T(D). Hence, T- 1 is of class C in D*. I We may illustrate all of this with the transformation used earlier: (7-46) { u = x cos y T: . v = x Sin Y whose Jacobian is J(x, y) = x. Since this is 0 only on the vertical axis, T has 360 ADVANCED CALCULUS local inverses about any point Po = (xo, Yo) with Xo #- O. To find these explicitly, we must solve (7-46). We have u2 + v2 = x 2, and 2uv = 2x 2 sin y cos y = x 2 sin (2y), so that sin (2y) = 2uv/(u 2 + v2 ). If Po is a point in the right half plane, so that Xo > 0, then the desired solution for x is x = Ju 2 + v2 . If Xo < 0, then x = - Ju 2 + v2 . If sin (2yo) #- ± 1, then one of the inverses for the sine function may be chosen so that in an interval about Yo, Y = ~ arcsin (2uv/(u 2 + v2 )). If sin (2yo) = 1 or - 1, then we proceed differently; we have u2 - v 2 = X 2 (COS 2 Y - sin 2 y) = x 2 cos (2y) so that cos (2y) = (u 2 - V2 )/(U 2 + v2 ). Choosing an appropriate inverse for the cosine function, we obtain y = ~ arccos ([u2 - v2 ]/[u2 + v2 ]) in an interval about Yo' For example, with Po = (1,0) we have as equations for the desired inverse !x=p:tv S: ; r 2uv J Iy=~arcsin l~+V2 This transformation is defined and of class C at all points (u, v) #- (0,0). If we also rule out u = 0, the simpler equivalent formula y = arctan (v/u) may also be used. Computing the differential of S, one finds f (U 2 +UV2)1/2 (u2 +VV 2 ) 1/21 dS = -v U u2 + v2 u2 + v2 so that the Jacobian of S at (u, v) is (u 2 + v 2t 1/ 2 . It will be noticed that this is X-I, in agreement with Theorem 16 and the fact that the Jacobian of Tis x. Also, changing back to x and y, the differential of S may be written as ~ cos y Sill Y ~ dS = -x-Isiny x-Icosy so that dSdT= ~_xC~~~ny x_si:;syH~~:~ -:;~:~~= ~~ ~~=/ As we have seen from (7-33), a transformation T can be locally 1-to-1 on an open set D without being globally 1-to-1 on D. In fact, it is possible to have such a transformation which maps an open disk D onto itself and is locally 1-to-1 but not globally 1-to-1 on D. The sequence of pictures in Fig. 7-9 is intended to suggest the stages in a construction of such a mapping; note that Tis at most 3-to-1 and that Tis certainly not 1-to-l on the boundary of D. 362 ADVANCED CALCULUS 8 Let Tbe a transformation from R3 into R 3 which is of class C in an open set D, and let J(p) = det (dT Ipl. Show that J is continuous throughout D. Is the rank of dT a continuous function of p? 9 Let T(x, y) = (u, v). Show that o(u, v) o(x, y) ~---=I o(x, y) o(u, v) 10 (a) Find an example of a function f that is infinitely differentiable on an Interval I, maps 1 onto itself l-to-l, has a continuous inverse f-', but for which f-I fails to be differentiable at some point of 1. (b) Show by an example that a transformation of the plane can be I-to-I, have an everywhere-defined inverse, and still have the Jacobian vanishing somewhere. II Let T be defined by Ju = sin x cos y + sin y cos x T' . \\v = cos x cos y - sin x SIn y Find the Jacobian of T. Is there anywhere that Tis locally I-to-I? 12 The following transformation is continuous everywhere in the plane and differentiable there except on the lines y = ± x. l u = x 2 + y2 - Ix 2 _ y2 1 T' . V=X 2 +y2+lx 2 _y 2 1 (a) Find dTwhere it exists. (b) Discuss the local and global mapping behavior of T. (c) Is Tdifferentiable at (0,0) according to definition 3? 13 Let T be the transformation sending (x, y) into (2xy, x 2 + y2) and S the transformation sending (x, y) into (x - y, x + y). (a) Using the Jacobians, discuss the local and global mapping behavior of Tand S. (b) Obtain formulas for the two product transformations, ST and TS, and then repeat part (a) for these new transformations. 14 Prove Theorem 13 by filling in the details in the following argument: T- I is continuous if its inverse carries closed sets into closed sets; however, the inverse of T- I is T and any closed subset of D is compact. 15 Letfbe a real-valued continuous function defined for - 00 < x < 00. Suppose thatf is locally I-to-I everywhere. Prove that f is globally l-to-1. [Note: Do not assume that f' exists.] 16 Let J T(P) denote the Jacobian of a transformation Tat the point p. Show that if S and Tare transformations from n space into itself, and T(p) = q, then JST(p) = JS(q)JT(p). 17 Let D be the unit disk, x 2 + y2 :::; I. Consider a transformation T of class C on an open set containing D, J u = f(x, y) T' . \\ v = g(x, y) whose Jacobian is never 0 in D. Suppose that T is near the identity map in the sense that IT(p) - pi s j for all p E D. Prove that there is a point Po with T(po) = (0,0). 7.6 THE IMPLICIT FUNCTION THEOREMS The theorems of the present section have to do with the solution of one or more equations in several unknowns. They are existence theorems in that they give assurance that there are solutions, but do not give directions for obtaining DIFFERENTIATION OF TRANSFORMATIONS 363 them. In the simplest of these situations, suppose we are concerned with the solution of an equation F(x, y, z) = 0 for one of the variables as a function of the others. To \"solve for z,\" for example, means to find a function ¢ such that F(x, y, ¢(x, y)) = 0 for all x and y in some open set. This is not always possible. In general, there are two reasons for this. One reason is illustrated by the equation x 2 - Z2 + (z - y)(z + y) = 0 This cannot be solved for z, for z is not \"really\" present. The second reason is illustrated by the equation x 2 + l + Z2 + 10 = 0 This cannot be solved for z, and in fact, there is no real triple (x, y, z) which satisfies the equation. Our first result is a theorem which gives sufficient conditions for such an equation to be solvable for z. Theorem 17 Let F be a function of three variables which is of class C in an open set D, and let Po = (xo, Yo' zo) be a point of D for which F(po) = O. Suppose that F3(po) # O. Then, there is afunction ¢ of class C in a neighborhood N of (xo , Yo) such that z = ¢(x, y) is a solution of F(x, y, z) = 0 for (x, y) in N, and such that ¢(xo' Yo) = Zo. Consider the following special transformation from R 3 into R 3 : \\u=x T: 1v = Y Iw=F(x,y,z) This is of class C in D, and its Jacobian is J(p)=det[ ~ ~ ~ ]=F3(P) F 1(p ) F 2 (p ) F 3 (p ) Since J(po) = F3(PO) # 0, we may apply the principal result of Sec. 7.5 (Theorem 16) and conclude that there is a transformation T- 1 which is of class C in a neighborhood of qo = T(po) = (xo' yo, 0), and which is an inverse for T. Moreover, from the nature of the equations which describe T, we have for T- 1 Ix = U T- 1 : ~ y = v I z = f(u, v, w) wherefis of class C in a neighborhood of qo. Since T and T- 1 are inverses, we must have (7-47) w = F(x, y, z) = F(u, v,f(u, v, w)) 364 ADVANCED CALCULUS , J. (7-48 ) holding identically for all (u, v, w) near (xo, Yo, 0) = qo. Set w = 0, replace u by x and v by y, and define </J by </J(x, y) = f(x, y, 0). Then, (7-47) becomes 0= F(x, y, </J(x, y)) holding for all points (x, y) in a neighborhood of (xo , Yo). This shows that z = </J(x, y) is a solution of F(x, y, z) = O. Since f is of class C, so is </J. I By the same device, we can find sufficient conditions for the solution of an equation F(x, y, z, u, v, ... ) = 0 for anyone of the variables as a function of the remaining. In addition to the differentiability conditions, the two requirements are: (1) there is a point Po that satisfies the equation, and (2) the partial of F with respect to the sought-for variable does not vanish at Po. Turning to the more complicated cases in which more than one equation is involved, the following will amply illustrate the general procedure. Theorem 18 Let F and G be of class C in all open set Dc R5 . Let Po = (xo' Yo' zo, uo , vo) be a point of D at which both of the equations F(x, y, z, u, v) = 0 G(x, y, z, u, v) = 0 are satisfied. Suppose also that 8(F, G)/8(u, v) # 0 at Po. Then, there are two functions </J and ljJ of class C in a neighborhood N ~f (x o , Yo, zo) such that { u : </J(x, y, z) v - ljJ(x, y, z) is a solution of (7-48) in N giving Uo and Vo at (xo, Yo' zo)· To prove this, we construct a special transformation from R5 into R5 i t! = X t 2 = Y T: t 3 = z t 4 : F(x, y: z, u, v) t 5 - G(x, j, z, u, v) The Jacobian of Tis J = det[g F1 G1 8(F, G) --- 8(u, v) (7-49) DIFFERENTIATION OF TRANSFORMATIONS 365 By our hypotheses, J(po) # 0, so that T has a local inverse there. The form of this must be x = t 1 Y = t 2 Z = t 3 U =I(t 1, t 2 , t 3 , t 4 , t s ) v = g(t 1, t 2 , t 3 , t 4 , t s) whereIand 9 are of class C. Setting t 4 = °and t s = °to correspond to the original equations F(x, y, z, u, v) = °and G(x, y, z, u, v) = 0, and replacing t l' t 2 , t 3 by x, y, and z, and defining </J(x, y, z) = I(x, y, z, 0,0) l/J(x, y, z) = g(x, y, z, 0, 0) we have 0= F(x, y, z, </J(x, y, z), l/J(x, y, z)) °= G(x, y, z, </J(x, y, z), l/J(x, y, z)) holding for all (x, y, z) in a neighborhood of (x o, Yo, zo)' Thus, u = </J(x, y, z) and v = l/J(x, y, z) are the desired solutions. I To give a simple illustration of this theorem, let us discuss the solution of the following equations for u and v. Jx 2 - yu =° IXY + uv = ° Put F(x, y, u, v) = x 2 - yu and G(x, y, u, v) = xy + uv. We find ~(F,G) = 1-y °I= - yu J(u, v) v u Thus, if xo, Yo, uo, Vo satisfy Eqs. (7-49) and Yo Uo # 0, then there are con- tinuous solutions for u and v around the point (xo, Yo)' The limitation Uo # 0, Yo # °is needed, and both imply Xo # 0. In this example, it is possible to solve explicitly and obtain x 2 U=-' Y _ y2 V='~ X which is valid at all points (x, y) except those on the axes. 366 ADVANCED CALCULUS The general case follows the same pattern as Theorem 17. Given a system of m simultaneous equations <Pl(Xl' X 2 ,···, x n ) = 0 <P2(Xl' x 2 ' •.. , x n) = 0 <Pm(XI> x 2 ' ••• , x n ) = 0 in n variables, and a point p = (Xl' X2 , .•• , xn ) that satisfies the system, we can (in theory) solve for a specific set of m of the variables, say Xi\" Xi2' ... , x im ' in terms of the rest in a neighborhood of p if the Jacobian at p. EXERCISES I Can the curve whose equation is x 2 + Y + sin (xy) = 0 be described by an equallon of the form y = f(x) in a neighborhood of the point (0, OJ? Can it be described by an equation of the form x = g(y)? 2 Can the surface whose equation is xy - z log y + eX< = 1 be represented In the form z = f(x, y) in a neighborhood of (0, 1, I)? In the form y = g(x, z)? 3 The point (I, - I, 2) lies on both of the surfaces described by the equallons X 2(y2 + Z2) = 5 and (x - zjl + y2 = 2. Show that in a neighborhood of this point, the curve of intersection of the surfaces can be described by a pair of equations of the form z = f(x), y = g(x). , 4 Study the corresponding question for the surfaces with equations x 2 + y2 = 4 and 2x 2 + y2 - 8z 2 = 8 and the point (2,0,0) which lies on both. 5 The pair of equations J xy + 2yz = 3xz lxyz + ~ - y = 1 is satisfied by the choice x = y = z = 1. Study the problem of solving (either In theory or in practice) this pair of equations for two of the unknowns as a funcllon of the third, in the vicinity of the (1, 1, 1) solution. 6 (u) Let f be a function of one variable for which f(l) = O. What additional conditions on f will allow the equation 2f(xy) = ((x) + flY) to be solved for y in a neighborhood of (1, I)? (b) Obtain the explicit solution for the choicef(t) = t 2 - 1. ·7 With f again a function of one variable obeyIng f( I) = 0, discuss the problem of solVIng the equationf(xy) = f(x) + fly) for y near the point (I, 1). 8 Using the method of Theorem 18, state and prove a theorem which gives suffiCient conditions for the equations F(x, y, z, t) = 0 G(x, y, z, t) = 0 and H(x, y, z, t) = 0 to be solvable for x, y, and z as functions of t. DIFFERENTIATION OF TRANSFORMATIONS 367 9 Apply Theorem 18 to decide if it is possible to solve the equations xi + xzu + yv 2 = J and for u and vas functions of (x, y, z) In a neighborhood of the points (x, y, z) = (I, I, I), (u, v) = (I, I). 10 Find the conditions on the function F which allow you to solve the equation F(F(x, y), y) = 0 for y as a function of x near (0,0). Assume F(O, 0) = O. II Find conditions on the functions f and 9 which permit you to solve the equations f (xy) + g(yz) = 0 and g(xy) + f(yz) = 0 for y and z as functIOns of x, near the point where x = y = z = I; assume thatf(l) = g(l) = O. 7.7 FUNCTIONAL DEPENDENCE In Sec. 7.5, we studied at some length the properties of transformations of class C whose Jacobian is never 0 in an open set. We found that they map open sets onto open sets of the same dimension, are locally I-to-I, and therefore have local inverses. In this section, we examine the behavior of a transformation T whose Jacobian vanishes everywhere in an open set. We illustrate this first with a simple example. Consider the transformation described by T' Ju = cos (x + y2) . \\ v = sin (x + l) At (x, y), the Jacobian of T is J( ) d r-s in (x+y2) -2ysin(x+y2)1 x, y = et l cos (x + l) 2y cos (x + y2)J = -2y sin (x + y2) cos (x + y2) + 2y sin (x + y2) cos (x + l) =0 This transformation fails to have many of the properties which were shown to hold for those with nonvanishing Jacobian. For example, although it is continuous and in fact of class Coo, it does not map open sets in the XY plane into open sets in the U V plane. Since u2 + v2 = I for any choice of(x, y), T maps the entire XY plane onto the set of points on this circle of radius 1. Further- inore, it is not locally I-to-l. All the points on the parabola x + y2 = C map into the same point (cos c, sin c), and as c changes, these parabolas cover the entire XY plane. Thus, any disk, no matter how small, contains points having the same image. Speaking on the intuitive level for the moment, T might be called a dimension-reducing transformation; if we regard open sets in the plane as two-dimensional, and curves as one-dimensional, then T takes a two-dimen- sional set into a one-dimensional set. 368 ADVANCED CALCULUS All this degenerate behavior of T stems from the fact that the functions which we chose for the coordinates u and v were not independent, but were functionally related. There was a function F such that F(u, v) = ° for all x and y, namely F(u, v) = u2 + v 2 - 1 Definition 6 Two functions, f and g, are said to be functionally dependent in a set D if there is a function F of two variables, which itself is not identically °in any open set, such that F(f(p), g(p)) = °for all p ED. A similar definition may be formulated to describe functional dependence for any finite set of functions. As a special case of this, we say that a function g is functionally dependent in D upon the functions fl,f2 ' .. . ,fm if there is a function F of m variables such that for all p E D. When the function F is a linear function, g is said to be linearly dependent uponfl,f2' ... ,fm. In this case, there are m numbers C I , C2, ... , Cm such that g can be expressed in D as a linear combination of the functions fj: g = CIiI + Cd2 + ... + Cmfm Linear dependence is thus a special case of the general notion of functional dependence. The sine and cosine functions are linearly independent, since neither is a constant multiple of the other; however, they are functionally dependent, since for x in the interval [0, in]. We return to the study of a general transformation from R3 into R 3 . Let us recall the effect on a linear transformation T of the vanishing of its Jacobian. If T is represented by a matrix A = [au], then the Jacobian of T is det (A); if this is 0, then T maps all of R 3 onto a (two-dimensional) plane, or onto a (one-dimensional) line, or onto a single point. Which it does is determined by the rank of A. If rank (A) = 2, the image is a plane, and if rank (A) = 1, it is a line. Using this as a guide, one is led to guess the correct generalization of this for transformations T which are not linear. When the Jacobian of T vanishes throughout the open domain D, we expect T to be a dimension- reducing transformation. It will map D onto something like a surface, or a curve, or a single point; which it is will depend upon the rank of dT, the differential of T. In the statements of the next two theorems, we shall use the terms \"surface\" and \"curve\" in their intuitive meanings; we postpone formal discussion of these notions until Chap. 8. (7-50) DIFFERENTIATION OF TRANSFORMATIONS 369 Theorem 19 Let T be a transformation from R3 into R3 described by u=f(x,y,z) v = g(x, y, z) w = h(x, y, z) which is of class C' in an open set D, and suppose that at each point p E D the differential dT has rank 2. Then, T maps D onto a surface in UVW space, and the functions f, g, and h are functionally dependent in D. Theorem 20 I{ T is given by (7-50), and dT has rank 1 at each point of D, then T maps D onto a curve in U V W space, that is, f, g, and h satisfy two independent functional relations in D. In particular, about any point of D there is a neighborhood in which one of the functions can be used to express each of the others. The conclusion of the first theorem says that near any point of D, one may write either u = ¢>(v, w) or v = tJ;(w, u) or w = y(u, v). As p moves about in D, one may be forced to change from one type of relation to another. Thus, all the points (u, v, w) which arise as image points T(p) lie on the graph of a surface. Similarly, the conclusion of the second theorem says that near any point of D, one may write either u = ¢>(v) and w = tJ;(v), or v = a(w) and u = fJ(w), or w = y(u) and v = '1(u); again, it may not be possible to adhere to one of these relationships throughout D. Thus, in this case, the points (u, v, w) lie on the graph of a curve in UVW space. Stated in terms of Jacobians, we have the following simple condition for functional dependence. Corollary If u, v, and ware C' functions of x, y, and z in D, and if 8(u, v, w)j8(x, y, z) = 0 at all points of D, then u, v, and ware functionally related in D. We prove both theorems together. The differential of T is given by [ fl f2 f3] dT = gl g2 g3 hi h 2 h3 Let us first suppose that dT has rank 1 at all points of D. This means that every 2-by-2 submatrix of dT has 0 determinant, but at least one entry of dT is not O. Let us suppose that at a point Po E D,.fl (Po) # O. Writing the first line of (7-50) as f(x, y, z) - u = 0 and regarding the left side as F(x, y, z, u), we may apply the implicit function theorem (see Theorem 17); since F 1 = fl, which does not vanish at Po, we can solve the equation f(x, y, z) - u = 0 for x, getting x = K(y, z, u) 370 ADVANCED CALCULUS Making this substitution in the remaining equations of (7-50), we obtain (7-51 ) v = g(K(y, z, u), y, z) = G(y, z, u) w = h(K(y, z, u), y, z) = H(y, z, u) We shall next show that the variables y and z are not really present, that is, that G and H do not depend upon y and z. To show that y is absent, let us return to Eqs. (7-50), and differentiate the first and second with respect to y while holding z and u constants. (This may be done since Eq. (7-51) allow us to regard y, z, and u as the independent variables.) Doing so, we obtain ax o=fl ay + f2 av ax ay = gl ay + g2 Solving the first, we have ax/ay = - f2/fl and av = G ( z u) = flg2 - gd2 ay I y, , fl However is the determinant of one of the 2-by-2 submatrices in dT, and by assumption, it has the value O. Thus, in a neighborhood of Po, we find that GI(y, z, u) = O. By a previous result (Theorem 13, Sec. 3.3), this shows that G does not depend upon y. Similar computations show that G and H are both independent of y and of z. We may therefore write Eqs. (7-51) in the simpler form v=¢(u) w = t/J(u) This proves Theorem 20. I To prove Theorem 19, let us assume that dT has rank 2 throughout D. This means that the Jacobian of T is 0 at each point of D, but that about any point Po ED is a neighborhood in which one of the 2-by-2 submatrices is nonsingular. We may suppose that it is the upper left-hand submatrix. Thus, a(f, g)/a(x, y) #- O. By the implicit function theorem, we can solve the equations f(x, y, z) - u = 0 g(x, y, z) - v = 0 Corollary If (7-54) 372 ADVANCED CALCULUS Then, if the differential dT has rank 2 throughout D,j and g are functionally independent in D, and T maps D onto an open set in the U V plane; while if dT has rank 1 throughout D, then f and g are functionally dependent in D, and the image of D under T is a curve in the UV plane. o(u, v) _ o(u, v) _ o(u, v) _ 0 a(x, y) - J(y, z) - oCz:X) - throughout D, then about every point of D is a neighborhood in which u = ¢(v) or v = t/t(u). Theorem 22 Let T be a transformation from R 2 into R3 which is of class C' in an open set D, and is given there by the equations x = flu, v) y=g(u,v) Z = h(u, v) If the rank of dT is 2 throughout D, then T maps D onto a surface in X Y Z space, while if the rank of dT is 1 throughout D, T maps D onto a curve. Both of these may be reduced to special cases of Theorems 19 and 20. To prove Theorem 21, we adjoin an equation w = 0 to make T a trans- formation from R 3 into R 3 . Its differential is now whose rank is always the same as that of dT. I To prove Theorem 22, we introduce a dummy variable w into Egs. (7-54) which describe T to again make T a transformation from R 3 into R 3 . (For instance, one might write x = flu, v) + w - w.) The differential of the resulting transformation is whose rank is again the same as that of dT. I For future use, we note that the condition that the rank of this matrix be 2 may also be expressed in the equivalent form (7-55) r ~(X2-Y)12+ f~(Y,!)12+ rO(Z,X)j2 >0 o(u, v)J o(u, v)J o(u, v) CHAPTER EIGHT APPLICATIONS TO GEOMETRY AND ANALYSIS 8.1 PREVIEW This chapter deals with a number of geometric applications of integration and differentiation. Building on the techniques of the previous section, we treat the change-of-variable formula for multiple integrals in Sec. 8.3, using an approach that emphasizes the role of the differential of the transformation T that describes the coordinate change. The key idea is to look at the integral of a function f over the image set T(D) as though one had integrated some other function over the set D, then use differentiation to evaluate this new integrand. Thus, one needs a multiple-integral form of the fundamental theorem of calculus. This is supplied in Sec. 8.2, which gives an elementary treatment of set functions and a weak version of the Radon-Nikodym theorem, which is the key also to the physical notions of density and mass and to some of the basic aspects of probability theory. The remainder of the chapter deals with curves and surfaces, discussing such topics as tangents, normals, curvature, arc length and surface area, and integration of functions along a curve or over a surface. There is also a brief intuitive introduction to the notion of manifold, as an extension of \"surface,\" in order to present the contrasting concepts of orientability and nonorientability. 375 376 ADVANCED CALCULUS While it might seem somewhat out of place, Sec. 8.5 turned out to be the appropriate place to discuss the total second derivative of a function or transformation, since this characterizes geometric aspects of the associated graphs; as the Hessian, it also discriminates between saddle points and extreme points. 8.2 SET FUNCTIONS By the term set function we mean a function F which assigns a number F(S) to each set S in some specified class of sets. By contrast, the term point functions might be used for the functions f which have been discussed up until now, and which assign a number f(p) to each point p in a specified set of points. Examples of set functions are common in pure and in applied mathematics, embracing such diverse notions as area, force, mass, moment of inertia, and probability. To illustrate this, let d be the class of compact sets in the plane which have area. Then, the area function A, which assigns to each set SEd its area A(S), is a set function defined on the class .91. Taking an example from physics, we suppose we are given a specific distribution of matter throughout space, which in some places may be continuous, and in others, discrete. With this, we may associate a particular set function m by taking m(S) to be the total mass of the matter lying within the set S. In particular, if the distribution of matter is taken to be only a single particle of mass I located at the origin, then m(5) = ° whenever S fails to contain the origin, and m(S) = I if S contains the origin. Again, if a horizontal plate is subjected to a variable load distribution, we may obtain a set function F by choosing F(5) to be the total force pressing down on each region 5 of the plate. Finally, if an experiment involves dropping shot from a height onto a target board, then to each region S of the target we can associate a number P(5) which is the probability that an individual shot will land in S. All the examples presuppose that one starts with a prior knowledge (e.g., the meaning of area, mass, force, or probability). Reversing the procedure, one might postulate the existence of the set functions, together with certain appropriate properties, and then use them to develop the corresponding physical or mathematical notions. One property that a set function may possess, shared by all those mentioned above, is particularly important. . Definition 1 Let ~ be a collection of sets such that if SI and 52 belong to~, so do 51 U S2' 51 n S2' and SI - 52' Then, a set function F defined on ~ is finitely additive if F(SI U 52) = F(Stl + F(S2) whenever 51 and 52 are disjoint members of~. A finitely additive function F must automatically satisfy certain other properties. For example, F(0) = 0, since 5 and the empty set 0 are necessarily disjoint, and hence F(S u 0) = F(5) = F(5) + F(0). Again, if the sets Sk E ~ APPLICATIONS TO GEOMETRY AND ANALYSIS 377 are pairwise disjoint, then (8-1) We note also that there are corresponding addition formulas which apply when the sets are not disjoint (see Exercise 2). Another property shared by many set functions is positivity; F is said to be positive if F(S) ~ 0 for all S E K. This is equivalent to the property of being monotone, which means that F(Sl) :s; F(S2) whenever Sl C S2 (Exercise 3). An extensive category of finitely additive set functions can be constructed by means of integration. Let ¢ be a real-valued point function defined and continuous on the whole plane. Then ¢ yields a set function defined on the class sl by the equation (8-2) F(S) = rr ¢ .. s The fact that F is finitely additive is merely a restatement of one of the familiar properties of integration. Note also that F will be a positive set function if and only if ¢(p) 2: 0 for all points p (Exercise 5). The central result of this section will show that every finitely additive set function obeying certain simple conditions must have the form (8-2), where the appropriate point function ¢ is obtained from the set function F by a process analogous to differentiation. Indeed, the entire result can be regarded as the multiple integration version of the fundamental theorem of calculus that con- nects integration and differentiation in one variable. For concreteness, we work with set functions defined on the class d of Jordan-measurable subsets of the plane~i.e., bounded sets B that have an area A(B). The same analysis could be done for n space. We introduce a special type of limit operation. Definition 2 Given an arbitrary set function F, not necessarily additive, and defined at least for all rectangles R, we write lim R \" Po F(R) = c if and only if, given £ > 0, there is a b > 0 such that (8-3) IF(R)-cl<£ whenever R is a rectangle containing the point Po and with diameter diam (R) < b. The rectangles R can be thought of as \"closing down\" on the point Po, and the limit value c, when it exists, can be regarded as the value which F should assign to the set consisting of Po alone. (The restriction to rectangles makes this notion of limit rather special, but it is all we need for simple applications. ) 378 ADVANCED CALCULUS If the set function F has such a limit for each point p in a region D, then this process defines a poin t function f on D by writing, for each p E D, (8-4) f(p) = lim F(R) Rjp (8-5) Definition 3 We say that the limit (8-4) holds uniformly for all p in a set E if and only if, given E > 0, there is a 6 > 0 such that IF(R) - f(p)1 < E for every pEE and every rectangle R containing p with diam (R) < 6. Using these notions oflimits, we now introdl1ce a process of differentiation of set functions defined on the class .s1, with respect to the area function A. When the derivative of F exists, it will be a point function f; not all set functions have derivatives. Definition 4 An arbitrary set function F, defined on .91, is said to be differentiable on a set D if lim FJR} Rjp A(R) exists for each p E D, and to be uniformly differentiable on D if (8-5) exists, uniformly for all p ED. It is to be understood in the definition that A(R) > O. This is not a new concept, especially in the case of the examples of set functions which we have given above. Taking F as the mass function m, the value of the quotient m(S)/A(S) is the average mass per unit area (or volume, if we take the corresponding three-dimensional derivative) in the region S. As S closes down on p, the limit can be interpreted as the density of matter at p. Similarly, the derivative of the set function force is the point function pressure (= force per unit area). Not all set functions have a derivative; the mass function produced by an isolated unit point mass at the origin fails to have a derivative there since m(S) = 1 for any S containing 0, while A(S) - 0 (see also Exercise 8). Our first result shows that the special additive set function defined by (8-2) is differentiable everywhere, and that the integrand 1> can be recovered from F itself. Theorem 1 The set function F given in (8-2) is uniformly differentiable on any compact set E, and its derivative is the point function 1>. Given E, we can choose a small number 6 1 and a compact set E 1 containing E such that if pEE and Iq - pi < 6 1, then q E E\\. The function APPLICATIONS TO GEOMETRY AND ANALYSIS 379 ¢ is uniformly continuous in E I' Given e, we can choose 15 < 151 SO that if pEE and ·Ip - ql < 15, then I¢(p) - ¢(q)1 < e. Let R be any rectangle containing p and with diam (R) < 15; note that R lies entirely in E 1 • By the mean value theorem for integrals, F(R) = rr ¢ = ¢(q)A(R) •• R where q is some point in R. Thus, F(R)/A(R) = ¢(q), and we have shown that I~(R)- ¢(p) I< e A(R) holding now for any choice of R, diam (R) < 15, and any pEE. I The main result of this section is the converse of this, showing that a simple set of properties characterizes the set functions obtained by integration as in (8-2). In addition to finite additivity, we will use another property that is obviously true of those functions F defined by (8-2). Definition 5 A set function F is a.c. (area continuous) if F(S) = 0 for every set S with A(S) = 0 with SEd. In fact, set functions F defined by (8-2) even obey the following more restrictive condition: For any compact set E, there is a number M such that IF(S) I ~ MA(S) for all sets SEd, SeE (Exercise 6). Theorem 2 Let F be an additive set function, defined on d and a.c. Suppose also that F is dijJerentiable everywhere, and uniformly dijJerentiable on compact sets, with the derivative a point function f Then,f is continu~us everywhere, and (8-6) F(S) = If f s holds for every rectangle S. If F is positive on an open set D (meaning that F(S) ~ 0 for any set SeD, SEd), then (8-6) also holds for all sets SEd contained in D. The pattern of the proof of this is similar to that of the fundamental theorem of calculus for functions of one variable, as given in Sec. 4.3. We first prove that the derivative f is continuous. Let E be any closed disk. Since F is uniformly differentiable in E, given e we can choose 15 so that 380 ADVANCED CALCULUS for any pEE and any rectangle R containing P, and with diam (R) < b. Let PI and P2 lie in E, with Ipi - P21 < 15/2, and choose R, diam (R) < 15, so that PI' P2 E R. Then, ~ I: + I: = 21: proving that.f is (uniformly) continuous in E. Next, define a set function Fo by using (8-2) with <P = J By Theorem 1, Fo is also uniformly differentiable on compact sets, and its derivative is also the point functionJ Construct a third set function H by H(S) = F(S) - Fo(S). This is again finitely additive, a.c., defined on sd, and uniformly differentiable on compact sets, and its derivative is everywhere.f - .f = 0. We will now show that any such set function is necessarily 0, at least on rectangles. Let E be a large closed disk. Then, since the uniform derivative of H in E is the point function 0, we know that for any I: > °there is a 15 > Osuch that if R is a rectangle contained in E with diam (R) < 15, then I~(~/1 = I~(~1-°I< I: or, IH(R)I ~ I:A(R). Now take any rectangle S in E, and express it as the union of rectangles R l , R 2 , ... , Rn, each of diameter smaller than 15 and mutually disjoint except for edges. Since each edge has area°and H is both a.c. and additive, H(S) = l: H(R;). Applying the general estimate above, we then have IH(R;) I ~ I:A(Ri ) and n IH(S) I ~ I:2.: A(R;) = I:A(S) I Since this holds for every 1:, H(S) = 0, and it follows that F(S) = Fo(S) for any rectangle, and hence for finite unions. To extend this now to general sets S E sd contained in an open set D where F is a positive set function, we use the fact that F is monotonic, and approximate S from inside and outside by finite unions of rectangles. If Sn C S with A(Sn) -> A(S), then F(Sn) ~ F(S), and since Sn is a finite union of rectangles, which converges to ff .f = Fo(S) by properties of integration. This •• S argument shows Fo(S) ~ F(S) for any SeD. A similar argument using circumscribing sets Sn that are unions of rectangles yields F(S) ~ Fo(S), and we have completed the proof. I APPLICATIONS TO GEOMETRY AND ANALYSIS 381 This result provides the justification for obtaining the mass of a body by integrating a density function over the corresponding region, for computing the force on a wall by integrating a pressure function, or for finding the probability of an event by integrating a probability density function. You will meet it again in courses in measure theory, where it is generalized to the Radon-Nikodym theorem. In the next section, we apply Theorem 2 to derive the formula for change ofvariable;; in a multiple integral, which was discussed without proof in Sec. 4.4. EXERCISES Do the following describe set functions that are finitely additive? (a) F(S) is the square of the area of the plane set S. (b) F(S) IS the area of the smallest closed circular disk which contains the closed set S. (c) F(S) is the moment of mertia of the plane set S about an axis through the origin, and perpendicular to the plane. (d) F(S) is the diameter of the closed set S. 2 (a) If F is additive onel, then prove that (b) Is there a similar expression for F(S, u S2 u S3)? 3 Show that any additive set function F defined on .91 is positive on .91 if and only if F is monotonic. 4 If F is positive and additive on .91, show that for any finite collection of sets So E .91, \"'nF(U7 So):O; LI F(S,). 5 Show that if F is defined by (8-2), where ¢ is continuous, then F ~ 0 if and only if ¢ ~ O. 6 Let F be defined by (8-2), with ¢ continuous on the whole plane. Show that for every compact set E there is a number M such that IF(S) I :0; M A(S) for all S E .91 with SeE. 7 By considenng the one-dimensional case, show why Theorems 1 and 2 are analogous to the fundamental theorem of calculus (see Theorems 5, 6, and 7, Sec. 4.3). 8 Let I be a bounded function which is continuous everywhere in the plane except at the origin. Define F by F(S) = 1'1' f Is F differentiable at the origin? (Your answer will depend ., s upon the nature of the discontinuity off) 9 Let m be the set function described in the first paragraph of this section, based upon a single particle of unit mass, located at the origin. Show that Iim S )po m(S) exists for each point Po but that m is not a differentiable set function on a square containing the origin. 10 Let I be a function of one variable, defined on the interval -oo<x<oo Define a set function on mtervals by F(I) = I(b) - I(a), where I = [a, bJ, and assign the same value to F(I) whether the endpoints of I are included or not. (a) Show that F is an additive set function, for intervals. (b) Show that lim r I Xo F(I) exists iflis continuous at xo· (c) When is F differentIable? *11 Let I be a continuous function of two variables, defined on the whole plane and of class C. For any rectangle R, whose vertices are Po = (x o, Yo), P, = (x o, Yd, P2 = (x l' Yd, P3 = (x\" Yo), 382 ADVANCED CALCULUS and Xo < XI> Yo < Y\" let F(R) = f(P o) - f(Pd + f(P 2 ) - f(P 3 ) (a) Show that F is an additive set function on rectangles, In the sense that, if a rectangle R is the union of rectangles RI> R2 , •.. , R\", which have disjoint interiors, then F(R) = 2:: F(R.). (b) Show that the derivative of F exists and is the point function 9 = f12 = a2f!(ax ay). 8.3 TRANSFORMATIONS OF MULTIPLE INTEGRALS In this section we shall discuss certain additional properties of transformations, in particular, their effect on volume and area. This is a subject of considerable technical complexity, and one that is still near the frontier of research. To gain some insight into what may be expected, let us start~ith a linear transformation L from R\" into R\". If D is a bounded set in R\" whose n-dimensional volume is v(D), what can be said about the n-dimensional volume of the image L(D)? Theorem 3 The volume of L(D) is kv(D), where k = Idet (L)I. This asserts that the effect of L on volumes is simply to multiply by a fixed numerical factor k, which is independent of the set D. Moreover, if L is singular, this factor is 0, so that the image of any set D is a set of zero volume; this agrees with the fact that in this case, the image of all n space will be a set of lower dimension. To make the geometry easier, let us take n = 3 so that L may be represented by a matrix of the form A general set D in 3-space which has volume can be approximated from inside and outside by finite unions of cubes; thus, the general result will follow if it can be shown to hold when D is restricted to be a cube. In this case, the theorem can be interpreted as the equivalent of a familiar statement about determinants, and the fact that the general 3-by-3 matrix A can be factored as a product of simpler matrices. The proof for the general n-by-n case can be found in any of the standard references quoted in Appendix 3. Rather than digress here,! we merely show that the formula v(L(D)) = kv(D) I holds whenever D is a tetrahedron with one of its vertices at the origin. Let the other vertices be Pj = (x j , Yj' Zj), for j = 1,2,3. The volume of such a tetrahedron can be expressed by the formula (8-7) v(D) = (i)ldet (U)I APPLICATIONS TO GEOMETRY AND ANALYSIS 383 where U is the matrix (8-8) The transformation L carries D into another tetrahedron D' with vertices (0,0,0) and Pi = (xi, Yi, zi), for j = 1, 2, 3. Form the corresponding matrix U' from these points. The fact that Pi = L(PJ can also be expressed by the matrix equation U' = AU. Since the determinant of the product of two square matrices is the product of their determinants, we also have the equation det (U') = det (A) det (U). Since the volume of the tetrahedron D' is (i)ldet (U')I, this shows that v(L(D)) = kv(D) where k = Idet (A)I. L carries the triangular faces of the tetrahedron D into the corresponding faces of D'. It is natural to ask if there is an equally simple relation holding between the areas of these triangles. However, such is not the case; the area of the image of a triangle under a linear transformation of 3-space into itself will depend not only upon the area of the original triangle, but also upon its position. Congruent triangles may have images of different area. [Consider, for example, the effect of the simple projection (x, Y, z) ---> (x, Y, 0).] Of course, this cannot happen if the transformation maps 2-space into itself, for here Theorem 3 tells us that the area of any set D in the plane, and that of its image L(D), are connected by the formula A(L(D)) = kA(D), where k depends only upon L and not upon D. If, however, we consider linear transformations from 2-space into 3-space (or more generally, into n space), then we can obtain a result of comparable simplicity. Let L be the transformation represented by the matrix If R is a rectangle with vertices (0,0), (a, 0), (0, b), and (a, b), then L carries R into a parallelogram L(R) with vertices (0,0,0), aPI' bP 2' and aP I + bP2' where PI = (all' a21' a31 ) P2 = (aI 2' a22, a32) The area of R is labl; the area of L(R) is IaP I II bP21 sin () = lab II Pili P 21 sin () where () is the angle between the lines OPland OP 2 (see Fig. 8-1). Thus, we again have a relation of the form A(L(D)) = kA(D), where k = IP 1 1IP2 1 sin () APPLICATIONS TO GEOMETRY AND ANALYSIS 385 There is a special identity involving determinants which gives an alternative expression for k. For example, direct computation shows that for n = 3, k 2 (2 2 2 )( 2 2 2) ( )2= all + a 2 1 + a 31 a 12 + a 22 + an - a ll a l2 + a 21 a 22 + a 31 a 32 In the general case, k 2 is equal to the sum of the squares of the determinants of all the 2-by-2 submatrices of the matrix for L. Thus, in the numerical example given above, we would have -I 1 2 I Io + -I - I /2 11 I + 0 - I /2 I 2 0/2 3 + -I 1 1 2 0 1 2 1- 1 1 1 2 + 0 3 + 0 3 = 4 + 0 + 9 + 4 + 36 + 9 = 62 Let us turn now to the study of a general (nonlinear) transformation T If T is of class C' in an open set Q, then the approximation theorem allows us to write as in Theorem 10, Sec. 7.4, (8-10) T(p + i1p) = T(p) + dTlp(i1p) + R(i1p) (8-11) where lim ~_(L\\[J)I = 0 ~p-O li1pl uniformly for all points p in any closed bounded subset of Q. If T is a transformation from R\" into R\", then dT Ip is a linear transformation from R\" into R\". As such, it alters volumes by the factor k = Idet (dTlp) I= IJ(p)1 the absolute value of the Jacobian of T at p. If it is true that the local behavior of T is the same as the behavior of dT, then we would expect the volume ofT(D) to be about J(p)v(D) if D is a sufficiently small set surrounding p. As a first step in proving this, we have Theorem 4. Theorem 4 If E is a closed bounded subset of Q of zero volume, then T(E) has zero volume. Since E is compact and v(E) = 0, we can enclose E in a finite union of balls B I , B 2 , ... , BN , each of diameter less than any preassigned 15, and such that 2:7 v(Bk ) < e. Also, by the corollary to Theorem 12, 386 ADVANCED CALCULUS Sec. 7.4, we know that there is a constant M such that if Po E E and Ipo - pi < 15, then IT(p)- T(po)! < Mlp- Pol· Accordingly, the image under T of any ball B of radius r < 15 will be a subset of another ball of radius Mr, whose n-dimensional volume is M\"v(B). Thus, T(E) is a set that can be covered by the union of balls of total volume \"\"N M\"v(B k ) < M\"c;. L....l Since M depends only on E, and c; is arbitrarily small, T(E) is a set of zero volume. I As an application of this, we see that any nonsingular C transformation takes Jordan-measurable sets (i.e., sets that have an area or a volume) into Jordan-measurable sets. Corollary Let T be a C transformation on an open set 0 on which its Jacobian J(p) never vanishes. Then if D is a compact subset of 0 which has a boundary that has zero area (volume), the same is true for T(D). For T carries open sets into open sets. Thus, the image of the interior of D is an open set contained in the compact set T(D), and hence contained in <\\-je interior of T(D). Accordingly, every boundary point of T(D) is tt.e image of a boundary point of D; bdy (T(D)) c T(bdy (D)). Since v(bdy (D)) = 0, v(T(bdy (D))) = 0, and the boundary of T(D) is a subset of a set of zero volume, and therefore of zero volume itself. This is the criterion for T(D) to be a set having a measure in the Jordan sense. I What can be said about the value of v(T(D)), in comparison with the value of v(D)? Suppose that for concreteness we consider a transformation from 3-space into itself, given by a formula such as (8-12) Ix = f(u, v, w) T: 1y = g(u, v.' w) w = h(u, v, w) which we may abbreviate by T(u, v, w) = (x, y, z). hypothesis on T, we can find a formula for v(T(D)). With an appropriate Theorem 5 Let T be a transformation from 3-space into 3-space, with T( u, v, w) = (x, y, z), which is of class C and l-to-l in an open set 0, with J(p) \"# °throughout O. If D is a closed bounded subset orO in UVW space, then the volume of its image is given by v(T(D)) = JJJ dx dy dz = JJJ I ~i~:~'~\\Idu dv dw = JJJ IJ I nm D D In proving this, we shall use the theory of differentiation of set functions, as developed in Sec. 8.2. Define a set function F on the class of sets D (8-13 ) APPLICATIONS TO GEOMETRY AND ANALYSIS 387 possessing volume by the equation F(D) = v(T(D)) Since Tis I-to-I, disjoint sets have disjoint images, and F is an additive set function. If F has a derivative 1, that is, if the limit lim F(Dl = f(p) D l p v(D) exists, then by Theorem 2, Sec. 8.2, extended to 3-space, F(D) = v(T(D)) = JJJ f D In the light of the remarks made earlier about the local behavior of T, it is easy to conjecture that this will hold, and that f(p) = J(p). Since this result is important in itself, we single it out. Lemma 1 With Q and T as above, let E be a compact subset of Q. Then lim ~(!(C))= IJ(p)1 C l p v(C) where C ranges over the family of cubes lying in Q with center pEE, and the limit is uniform for all pEE. We start from the more precise statement of the approximation property of the differential of a transformation, as given in Theorem 10, Sec. 7.4. Given £, there is a b > 0 such that for any point Po E E and I~pI < b, p = Po + ~p, (8-14) where IR(~p)1 < £I~pl· In applying this, we first consider the case in which dT Ipo = I, the identity transformation. Since I(~p) = ~p, (8-14) becomes (8-15) T(p) = T(po) + ~p + R(~p) If the remainder term R(~p) were absent, then this equation would assert that the transformation T is nothing more than a translation; it would shift a cube with center at Po so that its center would become T(po), without altering lengths or direction. The term R(~p) causes a slight alteration of this picture. To estimate its effect, we see from (8-15) that whenever I~pI < b, (8-16) IT(p) - T(Po)1 < I~pl + £I~pl = (I + £)I~pl APPLICATIONS TO GEOMETRY AND ANALYSIS 389 its Jacohian J(p) never vanishes. Suppose also that T is close to the identity map, meaning that there is a number p such that 0 < p < 1and (8-18 ) IT(p)-pl-s,pr for all p E B Then, T maps B onto a set T(B) that contains all the points in the open ball centered at 0 of radius (1 - 2p )r. We give a proof that is quite similar to that for the open mapping theorem (Theorem 15, Sec. 7.5). Take any point qo with Iqo I < (1 - 2p)r; we wish to show that there is a point p E B with T(p) = qo. Consider the real-valued function defined on B by lj;(p) = IT(p)-qol and let m = min p E B lj;(p), which we assume is achieved at a point Po in B. We note that lj;(qo) = IT(qo) - qo I -s, pr by (8-18); thus, m -s, pro We next show that the minimum cannot be achieved on the boundary of B. For, if p E bdy (B), lj;(p) = IT(p) - p + p - qo I ~ Ip - qo I - IT(p) - pi ~ Ip - qo I - pr ~ IpI - Iqo I - pr Howt:ver, Iqo I < (1 - 2p)r and Ipl = r, so that lj; (p) > r - (I - 2p)r - pr = pr and ~f(p)> m everywhere on Ipi = r. We now know that the minimum of lj;(p), and thus the minimum of lj;(p)2, must occur at a point Po interior to B. The function lj;(pf is of class C, and its differential must vanish at Po. The 3-space case of the next step is typical of the general case, so we may suppose that T is described by (8-12). Then, if qo = (a, b, c), lj;(p)2 = (x - a)2 + (y - b)2 + (z - cf and at Po, we must haveox oy oz (x - a) au + (y - b) a~ + (z - c) ou = 0 ~ oy ~ (x - a) ov + (y - b) o~ + (z - c) o~ = 0 ~ oy ~ (x - a) if~ + (y - b) a~ + (z - c) o~ = 0 Since the coefficient matrix is exactly J(po), which is not 0, the only solution of this system is x - a = y - b = z - c = 0, and we have shown that T(po) = qo· 390 ADVANCED CALCULUS A similar argument can be made for cubical sets, using a different function ljJ; this takes care of the proof of Lemma 1 when dTlpo is the identity matrix. Suppose now that dTlpo = L. Since det (L) = l(po) #- 0, L is non- singular and has an inverse C I. Since T E C' and the entries of C I are continuous functions of Po and E is compact, we can choose a number Mo (again by the boundedness theorem for linear transformations) such that IC I (s) I :-s; Mol sI for all points s and all Po E E. Return to (8-14) and apply C I to both sides, obtaining C '{T(p) - T(po)} = C '{L(t1p) + R(t1p)} or C I T(p) - C I T(po) = C I L(t1p) + C I (R(t1p)) = t1p + C I(R(t1p)) In this, IC ' (R(t1p))1 :-s; M o IR(t1p)1 :-s; Moelt1pl. Setting T* = CiT, we have now shown that (8-19) T*(p) = T*(po) + t1p + R*(t1p) where IR*(t1p)1 :-s; Moelt1pl. This differs from (8-15) only in that we have a different transformation T* replacing Tand we have replaced e by Moe in the estimate of IR(t1p)l. Using (8-19) in place of (8-15), the previous argument applies, and we find (1 - 2M e)3 <'1 T *(C)l < (1 + 2M e)3 o v(C) 0 so that lim ~(!*(C))= 1 qpo v(C) However, T* = CiT, so that v(T*(C)) = v(C l(T(C))) = Idet (C I )lv(T(C)), since C I is linear. But, det (C I) = l/det (L) = 1/1(po), and we arrive at lim _1 __ v(T(C21 = 1 C I Po 11(Po)1 v(C) which (finally) proves (8-13). I The proof of Theorem 5 itself is immediate. Since the set function F is defined on cubes by F(C) = v(T(C)), the lemma shows that F is uniformly differentiable on E, with derivative at p the point function 11(p) I. By Theorem 2, F can be obtained by integrating its derivative, and for any set D having volume, F(D) = v(T(D)) = fff 111 = fff I ~(X,~,-Zlldu dv dw I ... .,. c(u r, w) D D' APPLICATIONS TO GEOMETRY AND ANALYSIS 391 With a slight modification of the argument, we also obtain a general theorem dealing with transformation of multiple integrals. Theorem 6 Let T be a tran~formation from 3-space into 3-space, with T(u, v, w) = (x, y, z), which is of class C and 1-to-l in an open set Q with J(p) \"# 0 throughout Q. Let D* be a closed bounded set in XYZ space which is the image under T of a set Dc Q in UVW space. Let f be a continuous function defined on D*. Then, (8-20) JJJ f(x, y, z) dx dy dz = JJJ f(T(u, v, w))IJ(u, v, w)1 du dv dw D' D The set D and D* are assumed to possess volume. Iff is a constant function, the result is covered by Theorem 5. We may suppose that f is everywhere positive by adding, if necessary, a suitable constant. We may also suppose that f is continuous throughout Q. [This is a typical application of the Tietze extension theorem (Theorem 8, Sec. 6.2).] Define a set function F on subsets of Q having volume by F(S) = rrr f T(S) Let E be a closed bounded subset of Q which contains D in its interior. Let C be a cube lying in E. Applying the mean value theorem for integrals, we can write F(C) = f(q*)v(T(C)), where q* E T(C). As the cube C closes down on a point Po, T(C) closes down on T(po), and q* approaches T(po). Thus, lim F(CJ = lim f(q*)v(T(C)) C!pov(C) C!po v(C) = f(T(po)) lim v(~~~)) C! Po V = f(T(po)) IJ(Po)1 using Lemma 1 for the last step. Moreover, since f is uniformly continuous on T(E), we have uniform convergence of this limit for all Po E E. Having thus computed the derivative of the set function F, application of Theorem 2 yields F(D) = rrr f = ffr f(x, y, z) dx dy dz... ... T(D) D* = JJJ f(T(u, v, w))IJ(u, v, w)1 du dv dw D = JJJ f(T(u, v, w)) I~i~::\"~;Idu dv dw I D 392 ADVANCED CALCULUS It is enlightening to compare this result with the corresponding theorem dealing with transformation of (substitution into) integrals of functions of one variable. As stated in Theorem 8, Sec. 4.3, the substitution x = ¢(u) in the b • f3 integral I j(x) dx results in the integral .I j(¢(u))¢'(u) du, where ¢(rx) = a a a and ¢(f3) = b. Comparing these, we see that the factor ¢'(u) = dxjdu corresponds to the Jacobian a(u, v, w)ja(x, y, z) and the new limits of integration [rx,f3] to the set D. However, the one-variable theorem was considerably stronger than the present form of the several-variable theorem. For example, there is no need to have ¢'(u) ¥- 0, nor must ¢ be a I-to-I mapping from the interval [rx, 13] onto the interval [a, b]. Another contrast is that ¢'(u) rather than 1¢'(u)1 appears; however, the explanation for this lies in the fact that the simple one- variable integral is a directed or oriented integral, while we have so far not oriented the multiple integral. This suggests, correctly, that similar improve- ments can be made in Theorem 6. In Chap. 9, we shall obtain such a result, using a different approach which assumes that T is of class C. Returning to the result given in Theorem 6, we recall that the symbols \"dx dy dz\" or \"du dv dw\" serve to show what integration is to be performed, but have no meaning out of context; nor does the order dx dy dz have as yet any different meaning from the order dy dx dz. As in Sec. 4.3, we might emphasize this by writing (8-20) in the form HI j(x, y, z)~ = HJ j(T(u, v, w))IJ(u, v, w)l~ D' D The rule for change of variable in a triple integral can be given thus: To make the substitution x = ¢(u, v, w), y = IjJ(U, v, w), z = e(u, v, w) in the triple integral rrf j(x, y, z) dx dy dz, replace the region D* by the region D in the ... D* UVW plane which corresponds to D* under the transformation, replace the integrandj(x, y, z) by j(¢(u, v, w), ljJ(u, v, w), e(u, v, w)) and replace dx dy dz by la(x, y, z)ja(u, v, w)1 du dv dw. In the one-variable case, the notation assisted the application of the rule. When the substitution was x = ¢(u), the formula dxjdu = ¢'(u) made the replacement of dx by ¢'(u) du a routine operation. It is natural to ask if a similar formalism can be used for multiple integrals. In Sec. 4.4, where we gave a preliminary discussion of change-of-variable techniques for multiple integrals, we gave a preview of such a routine, using differential forms such as ax ax ax dx = ~ du + - dv + - dw au av aw and a multiplication process to obtain the (correct) replacement for dx dy dz. 398 ADVANCED CALCULUS integral with this substitution, It will be observed that T maps the region (Fig, 8-8) D = {all (p, <p, e) with 0 ~ p, 0 ~ <p ~ n, 0 ~ e ~ 2n} onto all of X Y Z in a fashion which is I-to-I at all interior points of D, It is not I-to-I on the boundary of D; for example, the entire face p = 0 maps onto the single point (0,0,0), Moreover, the Jacobian is also 0 at points on portions of the boundary, However, by a limiting argument similar to that used above, the transformation formula can also be shown to hold for bounded subsets of D, EXERCISES I Show that the linear transformation which sends (1, 1) into (2, 5) and (1, -1) into (0, -1) is an area-preserving transformation. 2 Let A = [a,,] be a matrix with two columns and four rows. Show that the number k Z = 2~=1 (a,d Z 2~=1 (a,zf - (2~=1 ail aiZYIS In fact the same as the sum of the squares of the determinants of all of the 2-by-2 submatrices, 3 Make the indicated change of variables in the following integrals, and evaluate the result. 1 x (a) r dX\" xy dy, x = u + v, Y = u - v '0 '0 1 1 +x (b) r dx r xy dy, x = u, y = u + v • 0 • I-x (c) JJ xy dx dy, D x = u Z - vZ, y = 2uv where D is the unit disk, XZ+ yZ :S I. 4 Let D* be the parallelogram bounded by the lines y = ix, y = ix + 2, y = 3x, y = 3x - 4. Make an appropriate substitution, and evaluate 1'1' xy dx dy. ·'lJ· 5 Let D be the region In the first quadrant which is bounded by the curves xy = I, xy = 3, XZ - yZ = I, and XZ - yZ = 4. Make an appropriate substitution, and evaluate 1'1' (X Z+ yZ) dx dy. .• D 6 The equation of a curve in polar coordinates is r = sin (0/2) for 0 :S 0 :S 2n. Find the area of the regIOn which is bounded by this curve. 7 In 4-space, \"double\" polar coordinates are defined by the equatIOns x = r cos 0 y = r Sin 0 z=pcosrj> w = P Sin rj> Obtain the correct formula for making this substitution in a fourfold mulltple integral, and use this formula to show that the volume of the sphencal region XZ+ yZ + zZ + wZ :S RZ is in zR 4 , 8 The linear transformation L whose matrix IS APPLICATIONS TO GEOMETRY AND ANALYSIS 399 mapslheumtcubewith vertIces (0,0,0),(1,0,0),(0, 1,0),(0,0, 1),(1, 1,0),(0, I, 1),(1,0, 1),(1, I, I) mto a parallelepIped R. Fmd the area of each of the faces of R, and find its volume. 9 Let P = (-1,0) and Q = (1,0) and let p = (x, y) be any point with y ~ 0. Set s = IP _ pl2 and t = IQ - p12. Show that the correspondence p ---> (s, t) provides a coordinate system for the upper half plane, and discuss this as a transformation between (x, y) and (s, t). What is the image in me (x, y) plane of lines in the (s, t) plane? Where is a(s, t)ja(x, y) zero'! 10 (Alternative approach to Theorem 6.) Let T be the transformation described by x = u, y = ljI(u, v). Let D be the region bounded by the lines u = a, u = b, and the smooth curves v = P(u) and l' = oc(u) with P(u) > oc(u) for all u E [a, b). Let D* be the image of D under T, and suppose that ljI2(U, v) > °for all (u, v) ED. Show that for any funclIon f which is continuous in D*, JJ f(x, y) dx dy = JJ f(T(u, V))ljI2(U, v) du dv W D (Hint. Write each side as an iterated integral, and use the substitution formula for single integrals.) *11 (Continuation) Let T be a transformation of class C in an open set n which is described by x = </>(u, v) y = ljI(u, v) Assume also that a(x, y)ja(u, 1') > °throughout n. Show that in a sufficiently small neighborhood of any point pEn, the transformation T can be factored in one of the following two ways: or Jx = s \\y = G(s, t) Ix = s Lv = G(s, t) )s = </>(u, v) \\t = v /s = </>(u, v) \\t = u where G is a function of class C' which IS determined by the functions </> and ljI. 12 (Continuation) When such a factoring is made, show that Exercise 10 can be applied to each successively to obtain the result stated in Lemma I. 8.4 CURVES AND ARC LENGTH In our treatment of these topics, we shall deviate from the older traditional approach and adopt one which is of greater significance for applications in analysis. The terms \"curve\" and \"surface\" have several meanings in mathe- matics. For example, in one usage, \"curve\" means a set of points which has certain topological properties associated with the intuitIve notion of \"thinness.\" The word is also used to refer to a set of equations. We adopt the following formal definition. Definition 6 A curve ~' in n space is a mapping or transformation from R' into R n. 400 ADVANCED CALCULUS For example, the general continuous curve in 3-space is a continuous trans- formation of the form (8-23 ) Ix = ¢(t) 'y=ljJ(t) Iz = 8(t) Ix = sin t l.v = cos t o ~ t ~ 2no ~ t ~ 2n {X = c?S t y = Sill t o ~ t ~ 2n defined for t in one or more intervals [a, b]. In more familiar terminology, we have identified the notion of curve with what is often called a parametric representation. A point p in R 3 is said to lie on the curve when there is a t for which p = y(t). The set of all points which lie on y is called the trace of ~'. It is important to keep in mind the fact that the curve is the transformation (8-23) and not the set of points lying on y. Many different curves can have the same trace. For example, each of the following curves has for its trace the unit circle C = {all (x, y) with Xl + i = I}. Ix = cos (2t) \\y = sin (2t) However, the three curves are quite different. The first and third have length 2n, while the second (which goes around C twice) has length 4n. Again, the first curve starts and ends at (1,0) and goes around C in the counterclockwise direction, while the third begins and ends at (0, 1) and goes in the opposite direction. Such distinctions are of great importance in the analytical theory of curves. In this section, we shall take up some of the simpler portions of this theory. We begin with some convenient terminology. If a curve y is defined for the interval a ~ t ~ b, then the endpoints of yare y(a) and y(b); the former is called the first point on y, and the latter the last point on y. A curve y is closed if its endpoints coincide, so that y(a) = y(b). The three curves given above are examples of closed curves. A point p which lies on a curve y is said to be a multiple point if there is more than one value of t for which y(t) = p. A curve is said to be simple if it has no multiple points; the mapping y is then I-to-1. A continuous closed curve is said to be simple if the only multiple points are the coincident endpoints. (The terms \"Jordan arc\" and \"Jordan curve\" are also used.) In the examples given above, the first and third are simple closed curves, but the second is not. The trace of a continuous curve can fill an entire region of the plane (see Appendix 2). The existence of such space-filling curves is one reason why we do not attempt to define a curve as a particular kind of point set but concentrate instead upon the mapping itself. (It can be shown, however, that a simple curve cannot be space-filling.) It is also convenient to impose certain differentiability requirements. Definition 7 A curve y is said to be smooth on an interval I if~' is of class C and the differential dy is always of rank 1 on I. APPLICATIONS TO GEOMETRY AND ANALYSIS 401 Figure 8-9 x = 1-'. .I = Ir' I. When ~' is given in the form (8-23), this asserts that cP', If/, and e' exist and are continuous on [a, b] and that at no point of this interval do all of them become O. This latter condition can also be written as (8-24) ( dX)2 (dy)2 (dZ)2+-- +- >0 dt dt dt -ex:<t<ex: The word \"smooth\" is used to suggest that the motion of a point which traces the curve has no abrupt changes of direction. The need for a condition such as (8-24) to ensure this is shown by the following example of a curve of class C which violates condition (8-24) when t = 0: \".Ix = t 3 \"Lv=l t3 1 We note that dxldt = 3t 2, and that dyldt = 3t 2 for t 2: 0 and - 3t2 for t ~ 0; both are continuous, and both become zero for t = O. However, the trace of y is the set of poin ts (x, y) with y = Ix I (Fig. 8-9). A line is the simplest smooth curve. Recall from (1-20) that this is given by (8-25) I'(t) = Po + vt - ex: < t < ex: where the point (vector) v obeys the restriction Iv I ¥- O. For example, in 3-space, the general straight line is ~ x = Xo + at (8-26) , y = Yo + bt I Z = Zo + ct where a 2 + b2 + c 2 > O. Since ~'(O) = Po and y( I) = Po + v, the line (8-25) may be graphed as the line which goes through Po toward Po + v, in a direction which is specified by v. Since we have defined the notion of direction in n space by means of the points on the unit sphere, we form the unit vector f3 = vII v I, which has length 1 and specifies the same direction. In the customary language of analytical geometry, v is a set of direction components for the line, while f3 is a set of direction cosines; either may be used. A line through (1, 2, - 1) toward (3, 1, 1) has the equation ,,(t) = (1,2, -1) + {(3, 1, I) - (1,2, -1)}t = (1,2, -1) + (2, -1, 2)t or x = 1 + 2t,y = 2 - t,z = -1 + 2t. The direction of this line is f3 = (j, -j, j). 402 ADVANCED CALCULUS We observe that the coordinates of v can be obtained from (8-26) by differentiation; a = dxldt, b = dyldt, and c = dzldt. This suggests a similar procedure for the general smooth curve. Definition 8 U' y is a smooth curve, then the direction oj\"~' at a point p corresponding to the value t is f3 = vII v I, where , (dX dy dZ) v=y(t)= dt'dt'dt When the parameter t is interpreted as time, v is interpreted as the velocity vector of the point whose position at time t is y(t), and the speed of the point along its path is v = J(dX)2 + (dJ') 2 + (dZ)2\\1 / 2 I I 1 dt dt dt I Because of the restriction that dy always have rank 1, there is no t where itt) = (0,0,0), so the speed is never 0. For the same reason, the unit vector f3 is always well defined and a direction exists at each point p on a smooth curve. At a multiple point, y can have several different directions corresponding to the value of 1'(t) for each t at which ~' passes through the point. Two curves with the same direction at a common point p are said to be tangent there. The straight line cc a(t) = Po + vt -oc<t<oc where Po = y(to) and v = i(to), is tangent to ~' at Po. In discussing a particular curve, it is helpful to plot the trace of the curve, being sure to record points in the order assigned by t. Consider, for example, the plane curve -oo<t<oc(8-27) Ix = t - t 3 y: ly = t 2 - t which has the trace shown in Fig. (8-10). The origin is a double point cocresponding to both t = ° and t = 1. Differentiating, we have /(t) = (1 - 3t 2, 2t - 1), so that and i(O) = (1, -I) 1'(1) = (-2,1) At the origin, ~' has two tangent lines. The first is x = t, Y = - t with slope - 1, and the second is x = - 2t, .r = t with slope -1. The direction of~' for a general value of t is y'(t) (I - 3t 2, 2t - 1) {3 = 1/(t)1 = (9t 4 - 2t 2 - 4t + 2)12 APPLICATIONS TO GEOMETRY AND ANALYSIS 403 Figure 8-10 0~t~2 Thus,~' is horizontal [fJ = (1,0)] when 2t - 1 = 0, and it is vertical [fJ = (0, 1)] when 1 - 3t 2 = 0. Taking a curve in 3-space as a second illustration, consider ~ x = sin (2m) ;': , y = cos (2m) I z = 2t - t 2 In graphing the trace of this curve, it is helpful to observe that x 2 + y2 = 1 for all t (see Fig. 8-11). ~' is a closed curve, but is not simple since t = ~ and t = i both correspond to the point (0, -1, i). We, therefore, have /(t) = (2n cos (2m), - 2n sin (2m), 2 - 2t). At t = 0, this becomes (2n, 0, 2), and at t = 2, (2n, 0, - 2), so that the curve has two tangen t lines at the poin t (0, 1, 0), which is at once the first and last point on ~'. We next take up the important subject of arc length. If;' is a smooth curve defined for a ~ t ~ b, then we define the length of ~' by the formula (8-28) • b Lb,) =.1 1/(t)ldt a In 3-space this takes the form .h i(tlX)2 (dl')2 (tlZ)2\\li2 Lb') = I \\ +. + I dt . a tit tit dt Alternatively, this formula can be obtained by starting with a geometrical definition for the length of a curve. Given ~', let us choose a subdivision of the interval [a, h] by points tj , a = to < t l ... < tn = b, and set Pj = ~,(tJ The consecutive line segments joining Po to PI' PI to P 2 , ... , form a polygonal path C. Since each point Pj lies on ~', we speak of C as inscribed in /. For such APPLICATIONS TO GEOMETRY AND ANALYSIS 405 where we have written the curve as x = X(t), y = Y(t), a :<:;; t :<:;; b. Since X and Yare differentiable functions, we may use the mean value theorem and write the right side as {[X'(ri)(t j+ 1 - tJJl + [Y'(ri)(tj+ 1 - tJ]2}1/2 = {[X'(riW + [Y'(riWr/ 2 I1tj where I1tj = tj+ 1 - tj and ri and ri are two points in the interval [tj , tj+ I]. Thus, n- 1 L(C) = ~ {[X'(riW + [Y'(riW}I/2I1t j j;O b This closely resembles a Riemann sum for the definite integral f f(t) dt, 'Q wheref(t) = {[X'(tW + [Y'(tW}I/2. In fact, it would be one/if the points in each pair ri, ri were to coincide.) Introduce a special function F by F(t', t n ) = {[X'(t'W + [Y'(t nwr/2 and observe that F(t, t) = f(t) while n- 1 L(C) = L F(ri, rj) !!tj j;O Since i' is smooth, F is continuous in the closed rectangle R consisting of the points (t', tn ) with a :<:;; t' :<:;; b, a :<:;; t n :<:;; b. Accordingly, F is uniformly continuous in R; given e, we may choose b so that IF(p) - F(q)1 < e whenever p and q lie in Rand Ip - ql < b. In particular, we shall have IF(ri, rj) - F(t j , tj)1 < e or equivalently, IF(ri, ri) - f(tj)1 < e whenever ri and ri lie in an interval [t j , t j + d with I1tj < b. Assuming that the subdivision of [a, b] has mesh less than b, we obtain I:~F(,;. 'i) I1tj - ZfIr) I1t j I\"~IF(,;. 'i) - f(r)ll1t j n- 1 :<:;; e L I1tj = e(b - a) o However, L~-l F(ri, r'j) I1tj = L(C), while L~-I f(r j ) !!t j is a Riemann sum for the integrall~1, so that we find that L(C) approaches this integral as the mesh size of the subdivision decreases. Since L(i') is the least upper bound of the numbers L(C), and since L(C) increases (or at worst, remains 406 ADVANCED CALCULUS the same) when an additional subdivision point is introduced, we also have ,b L(y) = I f, the desired formula. I • a For example, let us find the length of the helical curve x = cos t, Y = sin t, z = t 3/2 for 0 ~ t ~ 4. The function f is f(t) = ly'(t)1 = {( -sin t)2 + (cos t)2 + ((i)t I/2 )2}1/2 =F+ (£)t .4 so that its length is I F+ (l)t dt = (80JIO - 8)/27. '0 It is interesting that formula (8-29), which was motivated by the geometric definition of arc length, also arises in a different context (see Exercise 12). A real-valued function f of one variable defined on [a, b] is said to be of bounded variation there if there is a number M such that (8-30) m-I L If(tk+d - f(tk)1 ~ M o for every m and every set of points t j with a = to < t l < t 2 < ... < tm = b. It is easily seen that any monotonic function on [a, b] is of bounded variation, even if it is not continuous, and the same holds for any continuous function f for which!, exists everywhere and is bounded on [a, b] (Exercise 13). The class of functions that are b.v. is rather large, since (Exercise 12) it contains any function that is the difference of two monotonic functions. What is also true (but not obvious) is that this characterizes the class; every functionfthat is b.v. on [a, b] has the formf= gl - g2' where gl and g2 are monotonic on [a, b]. It then follows that not every continuous function is of bounded variation. The connection between these concepts and arc length is still present; a continuous function f is b.v. if and only if the graph off is a rectifiable curve (Exercise 15). As we have seen, different curves may have the same trace. Some of these curves are closely related and have many properties in common. Definition 10 Two curves I' and ,'* are said to be parametrically equivalent when the following conditions hold: (i) }' is a continuous mapping from an interval [a, b] into R\"; (ii) y* is a continuous mapping from an interval [IX, /3] into R\"; (iii) there is a continuous function f which maps [IX, /3] onto [a, b] I-to-l with f(IX) = a,.f(fJ) = b and with j·*(t) = I'(f(t)) for all t in [IX, fJ]' APPLICATIONS TO GEOMETRY AND ANALYSIS 407 Briefly, this means that }' and 1'* are connected by a reversible change of parameter. For example, the following three curves are equivalent. Jx = t \\y = t Z O~t~l Jx = t Z \\y = t 4 O~t~l Jx = ~(l + t l / 3 ) Lv = !(l + 2t 1/ 3 + t2/3) -l~t~l so that It should be noticed that the second of these is not smooth, due to the fact that dx/dt = dy/dt = 0 when t = 0, while the third is not even of class C at t = O. When we consider parametric equivalence of smooth curves, more is true of the functionf If,' and 1'* are smooth and are parametrically equivalent, with ,,*(t) = i'(f(t)), thenfitselfwill be of class C, withf'(t) > 0 for IY. < t < p. For, at apoint to, find c= f(t o), and since /(c) #- 0, there is a component of I' whose derivative is not 0 at c, say }'k' Since I' is C, y,,(t) #- 0 on a neighborhood of c, and }'k 1 exists locally and is of class C. Thus,f(t) = Yk Iy:(t) locally at to, and fis of class C everywhere on the interior of [IY., p]. From the chain rule, we then have dy* = (d,')f'(t), so that if f'(to) = 0, dy* Ito = 0, and y* would fail to be smooth. The relation of equivalence separates the class of all smooth curves into classes of mutually equivalent curves. All the curves in anyone equivalence class have the same trace, and also share other geometric properties. We cite the next two results as examples. Theorem 8 Let i't and yz be smoothly equivalent smooth curves, and let p be a simple point on their trace. Then, YI and Yz have the same direction at p. Let ')!z(t) = I'df(t)), wheref'(t) > 0 for all t.lfp = yz(c), then p = YI (c*), where c* =f(c). To find the direction of Yz at p, we write d y:Z(t) = dt YI(f(t)) = /I(f(t))f'(t) 1'2 = /1 (f(c))f'(c) = Y1(C*)f'(c) The direction of I'z at p is therefore Y2(C) 1I'2(C)1 /dc*)f'(c) 11\"1(c-*)I7.cff i'1(C*) 1/I(c*)1 which is thus the same as the direction of YI at p. I Equivalent curves also have the same length. Theorem 9 Ifi'l and I'z are smoothly equivalent curves, then L(yd = L(\"z). 408 ADVANCED CALCULUS Assume that Y2(t) = Yt(f(t)) for a ~ t ~ b. Then, as before, Y2(t) = it (f (t ))f'(t) Sincef'(t) is never negative, 1}'2(t)! = lit(f(t))lf'(t) and • b • b L(Y2) = I 11'2(t)1 dt = I lit(f(t))lf'(t) dt • a . a Putting s = f(t) and IY. = f(a), f3 = f(b), this becomes • P L(Y2) = I lids)1 ds = L(}'d I • > In the equivalence class containing a smooth I\"~ one curve has a special role. This is obtained by using arc length as a parameter. If/' is defined on the in terval [a, b], define a function g by .r g(t) = I 1/1 • a Then, g'(t) = ly'(t)1 for all t, a ~ t ~ band g(a) = 0, g(b) = L(/,) = I, so that g is a C I-to-l map of [a, b] onto [0, I]. Its inverse, which we call f; maps [0, I] onto [a, b] and is also of class C. Let I'*(t) = I'(f(t)); i!* is then a smooth curve which is equivalent to 1', and is distinguished among all the curves equivalent to I' by the fact that I(dldt )y*(t) I= 1 for all t. Many of the formulas involving curves take on a simpler form if arc length is the parameter. The geometric concept called curvature is one example. We first need some additional terminology. As with general transformations, a curve I' is said to be of class em if the coordinate functions which describe the curve are of class em, and to be analytic if the coordinate functions are analytic, that is, representable by power series. All the examples that we have discussed are analytic curves, and may be represented in the form '/'(c)(t - e)2 y(t) = y(e) + i(c)(t - c) + I - - + ... 2! convergent for all t in a neighborhood of c. In this Taylor series representation of 1', the coefficient of t - c determines the direction of the curve when t = c- It is natural to ask for similar geometric interpretations of the remaining coefficients. Definition 11 If I' is a curve of class C' with arc length as the parameter, then the curvature of I' at the point corresponding to t = c is (8-31) k = 1/,(e)1 410 ADVANCED CALCULUS Now, from (8-32) we have a' p = lal 2t + (a' b)t2 + (a' c)t 3 + ... and squaring this, in the usual way one multiplies power series, (a· pf = lal4t2 + 2(a· b)lal2t3 + {(a' b)2 + 2(a' c)laI2)t4 + ... In the same way, if we take the dot product of (8-32) by itself, we obtain (p' p) = Ipl2 = lal 2t2 + 2(a' b)t 3 + {lbl2 + 2(a' c)}t4 + ... and then lal 21pl2 = lal 4t2 + 2(a' b)lal2t3 + {lal2lbi2 + 2(a· c)laI2}t4 + ... Ipl21pl2 = lal 4t4 + 4(a· b)lal2tS + ... Substituting these into (8-33), we arrive at and thus obtain R = lim R(t) = r J a I 2 Ia I 4 . 11/ 2 o 1-0 14{l aI 2IbI 2 -(a'bf}J Substituting for a and b the values /(0) and (\"(0)/2, and writing k for l/R o , the curvature, we have a general formula for k, valid even if arc length is not the parameter and Po is not 0, (8-34) Suppose now that the curve y does have arc length for the parameter. Then, 1[\" 1 = 1, so that (8-34) reduces to (8-35) k = JI?\"T2 - (y' . y';)2 However, this can be reduced still further. The characteristic property of curves with arc length as the parameter is 1/1 = 1, which we can write as (8-36) /(t) . y'(t) = 1 all t Differentiate this, and obtain (8-37) 2/(t) . /'(t) = 0 all t and use this in (8-35) to find the simple formula k = Ii'\" I, as given m our original definition, (8-31). As an illustration of the use of the general formula (8-34), return to the curve given in (8-27), for which the origin is a multiple point. We have /(t) = (1 - 3t 2, 2t - I) and /'(t) = (-6t, 2). The point p is at (0,0) when t = 0 APPLICATIONS TO GEOMETRY AND ANALYSIS 411 and when t = I, from which we find the respective curvatures to be J(2)(4) - (_2)Z k - 1 - (J2)3 1 J2 k _ J(S)(40f- (14)2 Z - (J5)3 2 svfs Curvature is a geometric property of curves; by this we mean that it is preserved under appropriate parameter changes, as was shown in Theorems 8 and 9 for length and direction. Thus, if Yl and Yz are curves of class en that are smoothly equivalent under a parameter change.f; also of class C\", and P is a simple point that is on both curves, then Yl and Yz have the same curvature at p. Since the curvature reflects only the magnitude of the vector function y\"(t) and not its direction, it might be expected that there are other geometric aspects of curves which can be described in terms of Y\" and the higher derivatives of y. This is the classical differential geometry of curves, and we leave this to more specialized treatments of the subject. Equivalence classes of curves have been introduced in topology and differential geometry to obtain alternative definitions for the notion of\" curve.\" In this approach, a curve is no longer an individual mapping Y, but is, instead, an entire equivalence class of such mappings, under a prescribed collection of permissible parameter changes. Depending upon the nature of these, special designations are used, such as \"Frechet curve,\" \"Lebesgue curve,\" etc., when one wishes to refer to the individual equivalence classes. As an example, let us consider briefly the notion of an algebraic curve. One of the simplest ways in which a curve in the plane can be given is by an equation of the form y = f(x); this can be thrown at once into a standard parametric form x = t, Y = f(t). One also says that an equation of the form F(x, y) = 0 specifies a curve. In a sense, one is again speaking of equivalence classes here, the class of all curves x = ¢(t), y = ljJ(t) which satisfy the equation F(¢(t), ljJ(t)) = O. If F(x, y) is a polynomial, then one might restrict ¢ and IjJ to be rational functions of t, and thus discuss the class of curves which are equivalent to a given curve under 1-to-1 birational correspondences. For example, the circle X Z + yZ = 1 has the rational parametrization x = (I - tZ)/(1 + tZ), Y = 2t/(1 + tZ). The situation becomes considerably more complicated when we turn to space curves. Here, one deals with pairs of algebraic equations, F(x, y, z) = 0, and G(x, y, z) = 0; again, with this one may associate a class of curves x = ¢(t), y = ljJ(t), z = Oft) which satisfy both equations for all t and whose coordinate functions ¢, 1jJ, f} are of specified sort, for example, rational functions. One may also consider the effect on a curve of a transformation which is applied to the space containing its trace. If y is a curve whose trace lies in a region D and T is a continuous transformation which maps D onto a region D*. then T carries Yinto a curvey* lying in D* defined by y*(t) = T(y(t)). If T is I-to-I in a neighborhood N of Po and y is a simple closed curve lying in N, then y* is a simple closed curve lying in T(N). Suppose that D and D* are each sets in the plane. As p moves along the trace of y, T(p) will 414 ADVANCED CALCULUS Let T be conformal at a point Po ED which we may suppose to be the origin for convenience. The coordinate axes form a pair of curves which are orthogonal (meet at right angles) at the origin. Their images will be curves which must be orthogonal at T(O, 0). Since the axes have equations x = t, Y = 0 and x = 0, y = t, the equations of their images under Tare u = f(t, 0), v = g(t, 0) and u = f(O, t), v = g(O, t). The direction numbers of the tangent to either of these are found by computing (du/dt, dv/dt); when t = 0, this results in (fJ, gd and (f2' g2), respectively, where the partial derivatives are evaluated at (0, 0). These directions are perpendicular if their inner product is 0; this gives us one relation connecting the functions f and g, namely, (8-40 ) To obtain a second relation, we consider another pair of orthogonal lines through the origin; we choose the lines of slopes I and - I with equations x = t, Y = t and x = t, Y = - t, Their images are the curves u = f(t, t), v = g(t, t) and u = f(t, - t), v = g(t, - t). At t = 0, the tangents to these have direction numbers (fl + I2' gl + 92) and (II - I2' 91 - 92); since these must be perpendicular, (8-41) 0 = (f12 - I/) + (91 2 - 9/) Multiplying this by I/ and making use of (8-40), °= II 2 f2 2 + 91 2I/ - (I/ + g/)f/ = g/g/ + gl2f/ - (f/ + 9/)f/ = (f22 + 9/ )(9 1 2 - I/) If the first factor were 0, then f2 = 92 = °and the Jacobian o(u, v) a(;;~Y) = II92 - f2g1 would be 0. Thus, g/ = I/. Returning to (8-41), we must also have II 2 = g2 2, so that 9 I = ± I2 and 92 = ± fl' If the choice of signs were the same in each, then (8-40) would hold only if all the quantities were 0, and the Jacobian of T would again be 0; thus, we either have f2 = gl and II = - g2 or we havef2 = - gl andfl = g2. In the first event, £IT, which is would have the form This can be ruled out, since a matrix of this form always has a negative 416 ADVANCED CALCULUS EXERCISES I Plot the trace of the plane curve x = r', .I' = 1\" - 4r for - x < r < x. Fmd the tangents at the double pomt. 2 Find the curvature of the helical curve of Fig. 8-11 at the double point. 3 Express the length of the loop of the curve (8-27) as a definite mtegral. 4 Find the curvature of the curve x = r' - 2r, .I' = 3r, Z = - r-', w = r - r' at the orlgm. 5 If;' IS the curve given by y = I(x), show that the curvature IS given by 1f\"(x)1 k= (I + ('(x)')'!' h and the length of;' between x = a and x = b by I' {I + [J'(xW: 12 dx ,. 6 If;' IS a curve which satIsfies the equation F(x, .1') = 0, show that the curvature at a pomt on ;' is given by k = IFllF,' + F22 F I ' - 2FJ, FI,I IFI ' + F,'I J ' 7 Using the converse of Theorem 10, show that the transformation r = 3x' .I' - .1'\" is directly conformal everywhere in the plane except at the origin. 8 Find the length of one arch of the cycloid x = a(r - sm r), .I' = a( 1 - cos r). 9 Find the angle between the curves where they intersect: \\ x = r I x = S2 , .I' = 2r I l' = 1 - s j Z = r' I 'z = 2 - s' to Let ;' be a curve in 3-space which satisfies both of the equatIOns f (x, .1', :) = 0, g(x, .1', :) = 0. Show that the direction of;' at a pomt on it has direction components (I12 13 1, I13 II I, III 1'1) g, g3 g3 gl gl g, It If fl and ;'2 are smoothly eqUIvalent curves of class C' and if the parameter change IS effected by a function I which is also of class C\", show that ;'1 and ;-, have the same curvature at corresponding points. 12 Let I = gl - g, where gi is monotonic on [0, 1] and not necessarily contmuous. Prove that ,I I IS of bounded variation on [0, 1], and that I I eXists. . 0 13 IfI is continuous, and (' exists and IS bounded on [0, 1], show that I IS of bounded variatIOn on [0, 1]. .1 14 Let I be continuous on [0, I],f' eXist for all x, °< x < 1, and I If'1 < x. Show that j IS of '0 bounded variation on [0, 1]. 15 Suppose ;' IS given by x = ¢(r), y = !/J(r), 0<::: r <::: 1. Prove that ;' is a rectifiable curve if and only if ¢ and !/J are of bounded variation. 16 Letl E C on [0, 1]. Prove thatl = gl - g, where gl and 9, are monotonic. 17 Find a rational parametrizatIOn for the hyperbola x' - y' = 1. 18 The graph of the equation x J + y' = 3xy IS known as the folium of Descartes. Show that a rational parametrization of thiS IS x = 3r/( 1 + 1\"), Y = 3r'/( I + 1\"), and graph this curve. APPLICATIONS TO GEOMETRY AND ANALYSIS 417 8.5 SURFACES AND SURFACE AREA The most elementary portions of the theory of curves in n space, outlined in Sec. 8.4, can be presented in a way that is relatively free of topological difficulties. This is much more difficult to do for the theory of surfaces; for this reason, certain topics in the present section will be presented on the intuitive level. Many of the basic definitions are direct analogs of those for curves. Definition 12 A surface L in n space is a transformation or mapping from R2 into R\". For example, the general continuous surface in 3-space can be expressed as a continuous transformation of the form (8-42) Ix = </J(u, v) L:'y=t/!(u,v) I z = e(u, v) whose domain is a set D in the UVplane. A point p is said to lie on the surface L if p = L(U, v) for some (u, v) E D, and the set of all points that lie on L is called the trace of the surface L. As with curves, may different surfaces can have the same trace. A point p lying on L is said to be a multiple point if it is the image of more than one point in the domain of L. A surface is simple if it has no multiple points; the mapping L is then I-to-l in D. Any set D which lies on one of the coordinate XYZ planes is the trace of a simple surface which is obtained from the identity mapping; if D is contained in the X Yplane, then the surface may be defined by x = x, y = y, z = 0, using x and y as parameters rather than u and v. Let L be a continuous surface whose domain D is such that its boundary is the trace of a simple closed curve y defined for a :\":::: t :\":::: b. The image of y under L is a closed curve r defined by r(t) = L(}'(t)) which is called the boundary or edge of L (see Fig. 8-17). We shall use aL as a notation for r, rather than bdy (L), to emphasize the fact that we are dealing with both curves and surfaces as mappings rather than sets of points. The trace of aL is the image, under L, of the boundary of the parameter domain D. If the boundary of D is composed of several simple closed curves, as indicated in Fig. 8-18, aL will also be made up of several closed curves. Any simple closed curve}' will be the edge aL of an infinite number of different surfaces, In Fig. 8-19, we show a closed curve}' whose trace is a simple trefoil knot, and in Fig. 8-20 we show the trace of a surface whose edge is \"r'. To see how this can be done in general, let }' be a continuous mapping from the unit circle u2 + v 2 = I into 3-space. We can extend this function }' in an infinite number of ways so that it becomes a continuous function L defined on the unit disk D into 3-space. For example, we can set (8-47) 422 ADVANCED CALCULUS and n = (A, B, C). Then, from (8-46), A(x - xo) + B(y - Yo) + C(Z - zo) = A(alu + blv) + B(a2 u + b2v) + C(a3u + b3t') = (Aal + Ba 2 + Ca3)U + (Ab l + Bb 2 + Cb3)t· a l a l b l b l al b l = a2 a2 b2 u + b2 a2 b2 v a3 a3 b3 b3 a3 b3 =0+0=0 Thus, every point (x, y, z) on the trace of I: satisfies the equation A(x - xo) + B(y - Yo) + C(Z - zo) = 0 which justifies our use of the word\" plane\" for the surface I:. The requirement that I: be smooth is equivalent to the condition A 2 + B 2 + C 2 > 0, and may thus be stated in the form nolO. In the analytical geometry of 3-space, the vector n is a set of direction numbers called the normal to the plane A(x - xo) + B(y - Yo) + C(Z - zo) = 0 Since (x - Xo, Y - Yo, z - zo) = v is a vector from the point Po to the general point (x, y, z) on the plane, this equation asserts that n . v = 0, and n and v are always orthogonal. By analogy, we may introduce a normal vector for a general smooth surface. Definition 14 If I: is a smooth surface in 3-space described by the standard equations (8-42), then the normal to I: at a point p is n = (oJy,:) o(z,:x) o(x, y)) o(u, v)' o(u, v)' o(u, v) Comparing this with (8-46), we see that this gives the correct answer when I: is a plane. Moreover, the next theorem shows that this is in agreement with the intuitive notion of the normal as a \"direction which is orthogonal to the surface\" (see also Exercise 19). Theorem 11 Let I: be a smooth surface and p a point lying on I:. Then, the normal to I: at p is orthogonal to any smooth curve which lies on I: and passes through p. Let I: have domain D, and let ;' be any smooth curve whose trace lies in D. The mapping I: carries j' into a curve r lying on the surface I: (see Fig. 8-24). The equation of r is r(t) = I:(y(t)). Let us suppose that r passes through p when t = O. The direction of r is determined by the vector v = r'(O). Since r(t) = (x, y, z) where (x, y, z) = I:(u, 1') and (u, v) = j,(t), we apply the chain rule of differentiation to find that 424 ADVANCED CALCULUS Two smooth surfaces in 3-space which pass through the same point Po and which have at Po normals pointing in the same or in opposite directions are said to be tangent at Po. The normal n = (A, B, C) to the general plane (8-45) is given by (8-46) and hence is determined by a and [3; since ~(u, v) = Po + au + f3v these may be obtained by partial differentiation, with and _ _ ~~ _ (ax ay az) a - ~u - au - au' au' au _ _ ~~ _ (ax ay az) f3 - ~v - a - a ' a ' av v v r The tangent plane to a smooth surface ~ at a point Po is therefore given by the equation We may also obtain a formula for the normal to a surface ~ when it is described by means of an equation F(x, y, z) = O. Theorem 12 If ~ is a swface which satisfies the equation F(x, y, z) = 0 where F is of class C, then the normal to ~ at a simple point Po lying on ~ is a scalar multiple ofdF Ipo = (F 1(Po), F2(PO)' F3(PO)), unless this is (0, 0, 0). Assume that ~ has the form x = ¢(u, v), y = lj;(u, v), z = O(u, r) for (u, v) ED. Then, F(¢(u, v), lj;(u, v), O(u, v)) = 0 for all (u, v) ED. Differentiating, and setting (u, v) = (uo, vo) so that (x, y, z) = Po, we obtain ax ay az o= F 1 (Po) a~ + F2(PO) a-u + F3(PO) au ax ay az 0= F 1(Po) au + F2(PO) av + F3(PO) ar If we set f3 = (Fdpo), F2(po), F3(po)) = dFlpo' these equations assert that f3 is orthogonal to both ~u and ~v at Po; but, the normal vector n is also orthogonal to these, so that f3 is a multiple of n. I As with curves, we say that a surface ~ is of class Ck if the coordinate functions that defined the mapping ~ are all of class C k on the parameter (8-48) APPLICATIONS TO GEOMETRY AND ANALYSIS 425 domain, and is analytic if the coordinate functions are analytic in U and v. This means that an analytic surface can be represented locally as an absolutely convergent double Taylor series L(U, 1') = L(Uo, 1'0) + (u - Uo)Lu + (v - l'o)Lv + ~{(u - Uo)ZLuu + 2(u - uo)(v - Vo)L uv + (v - Vo)ZL vv} + ... where the coefficients L u, Lv' L uu ' L uv ' etc., are vector-valued functions. Noting that L u and Lv are the columns of dL, and thus together determine, for example, the normal to the surface at any point by (8-47), one might reasonably expect that the other coefficients in the series expansion of L(U, v) would also have geometric significance. While we will leave this for more advanced works dealing with the classical differential geometry of surfaces, a few additional remarks may be helpful. Up until now, we have spoken only of the first total derivative Dg of a scalar function 9 and the first differential dTof a transformation T. However, Dg (or dg) is itself a vector-valued function, and thus can be viewed as a transformation, so that one may automatically apply the definitions of Chap. 7 to obtain its derivative or differential d(dg) = dZg. Suppose we try this with w = g(x, y, z). We have dg = (gx' gr' gz), and then dZg = [~:: ~::. :::] gzx gzr gzz Thus, the second (total) derivative of a scalar function turns out to be a matrix-valued function. Note that if 9 is of class C', the matrix dZg is symmetric because grx = gX}' , gxz = gzx' etc. For the general case, suppose we have a real-valued function g(x I, X z, ... , x n ) of class C' in an open set D. Then, dZg is defined in D and is the matrix-valued function dZg = [~.:.:... ~.:.~.. ~~~ '.'.' ...~~~1 gnl gnZ gn3 gnn [This is sometimes called the Hessian matrix of g, and its determinant the Hessian of g.] While we have not met dZg before in earlier topics, it has been implicit in several. For example, in Theorem 19 of Sec. 3.6, the nature of a critical point Po for a function f(x, y) was determined by examining the sign of the expression (/IZ)Z - fl1fzz' Note that this is exactly the negative of the determinant of dZf Thus, we could now restate Theorem 19 as follows: A critical point Po for f(x, y) is an extreme point if dZf Ipo has a strictly positive determinant, is a saddle point if the determinant is strictly negative, and is undetermined if dZf Ipo is singular. 426 ADVANCED CALCULUS This result for two variables suggests that there is a similar theorem for functions of n variables, characterizing the nature of critical points of f by properties of the second derivative d2f This is correct, but it is not sufficient merely to look at the sign of the determinant of the matrix (8-48)-i.e., the sign of the Hessian of f Instead, one must analyze the behavior of the quadratic form associated with the symmetric matrix d2f Ipo = [aij] = A. This arises by the same approach used in the proof of the two-variable version in Sec. 3.6. If Po is a critical point for f, then Taylor's theorem shows that on a neighborhood of Po, f(po + L1p) = f(po) + 0 + Q(L1p) + *R(L1p) where L1p = (L1x l' L1x2' ... , L1xn) and n (8-49) Q(L1p) = L aij(L1x;)(L1xJ ;. j= 1 and where I*R(L1p) I ~ lL1pI2. The local behavior of f at Po IS therefore determined by the behavior of Q(L1p), and there are three cases. Definition 15 A nonsingular symmetric matrix A is: i. Positive definite if Q(u) = L aijuiuj > 0 i.j= 1 for all U = (UJ> U2 ' .•• , un) i' O. ii. Negative definite if Q(u) < 0 for all U i' O. iii. Indefinite if neither (i) nor (ii) holds. Correspondingly, one arrives at the following characterization theorem for critical points. Theorem 13 Let f be of class C\" in an open set D, and let Po ED with df Ipo = 0, so that Po is a critical point for f Let A = d2f Ipo and assume det (A) i' O. Then, Po is a local minimum for f if A is positive definite, is a local maximum if A is negative definite, and is a saddle point if A is indefinite. A simple sufficient criterion for A to be indefinite is that two of the diagonal entries in A have opposite signs. Algebraic criteria which use the determinants of diagonal submatrices of A can be given, and are mentioned in Appendix 3. Another example of the role of d 2f may be given. Suppose w = f(x, y), where x = ¢(t), Y = t/J(t). Write this as w = f(y(t)) with y(t) = (x, y). Then, by APPLICATIONS TO GEOMETRY AND ANALYSIS 427 the usual chain rule, dw Idt = (df) y'(t) = Ux ,(t) dx dy = fx dt +~. dt 1,.] f dX/dt I Y dy/dt J (8-50) In the usual way, differentiate again, and obtain d2w (dX) 2 dx dy (dY) 2 d 2x d2Y dt 2 = fxx dt + ~fxy dt dt + fndt + fx d(T + fy dtT We now recognize this result as (PW dt2 = Q(i(t)) + (cif)y\"(t) where Q is the quadratic form associated with d~f However, if we choose to write Q(u) as A(u)(u), (8-50) becomes d2 w dt 2 = d~fi(t)y'(t) + dfy\"(t) and we see that we have returned to the type of notational simplicity of the one-variable calculus; if w = f(y(t)), then dw/dt = f'(y(t))y'(t), and d2w/dt 2 = f\"(y(t))y'(t)i(t) + f'(y(t))y\"(t). It is natural now to ask for the second derivative of vector-valued functions (transformations), and to ask if they too have useful geometric interpretations. Suppose we have Ix = f(u, v) L:l y =g(u,v) l w = h(u, v) Then, we may write and thus are led to write This allows many different descriptions. It is a 3-vector whose entries are 2-by-2 matrices, or the linear transformations that they represent. Or it is a solid array, obtained by stacking three 2-by-2 matrices on top of one another (see Fig. 8-25). Note that the vector-valued partial derivatives ~uu, ~uv = ~vu, 428 ADVANCED CALCULUS Figure 8-25 <i 2L (u, v) ED and L vv are visible in this array as the vertical columns, forming in fact the Hessian matrix (with vector entries) d2L = fL uu L uv I IL vu L vv J In the differential geometry of surfaces, these are used to discuss the various aspects of curvature for surfaces, just as d2 }, = \"/ was used to discuss this for curves. We turn next to the topic of surface area. Definition 16 The area of a smooth surface L with domain D is defined to be (8-51) A(L) = JJ In(u, v)1 du dv D = rr J I 8(x,y) 1 2 + I ~(Y'-~ 1 2 + I 8(z, x) 12 \\1/2 du dv .. \\ 8(u, v) 8(u, v) 8(u, v) I This rather arbitrary definition can be motivated by geometrical consider- ations. First, it agrees with our previous notion for area when L is merely a region embedded in one of the coordinate planes. For example, if L is the surface defined by x = u, y = v, z = °for (u, p) ED, then L u = (1. 0, 0) and Lv = (0, 1,0) and the normal n is (0,0, 1). The integral for the area of L becomes rr 1 du dv, which is precisely A(D), the area of the set D. Again, •• D when L is the portion of a plane defined by ~x=alu+blv L: ,y = a2 u + b 2 V I z = a3 u + b3 v 432 ADVANCED CALCULUS of [0, 1] into 10 subintervals, gives A(~) = .811; the latter eventually gives A(~) = 1log (J2 + )3) + J2/6 = .809. The important notion of parametric equivalence applies to surfaces as it did to curves, with appropriate modifications. Definition 17 Two smooth surfaces, ~ alld ~*, are said to be smoothly equivalent if there is a transformation T mapping D*, the domain of ~*, onto D, the domain of~, which is I-to-l, is of class C', and has a strictly positive Jacobian in D*, and such that ~*(u, v) = ~(T(u, v)) for all (u, v) E D*. As with curves, it can be shown that if two smooth surfaces are continuously equivalent, then they are smoothly equivalent. The notion of equivalence separates the class of all smooth surfaces into distinct subclasses, all the surfaces in a subclass being mutually equivalent. All the surfaces in a subclass have the same trace and the same normal direction at any point (see Exercise 5). They also have the same area. Theorem 14 If ~ and ~* are smoothly equivalent surfaces, then A(~) = A(P). We may assume that P(u, v) = ~(r, s) = ~(T(u, v)), where T maps the set of points (u, v) forming the domain D* of ~* onto the set of points (r, s) forming the domain D of~. The area of ~ is given by 'rIIO(X,y)/2 10(y,z) 1 2 /0(Z,X)j2}1/2A(~)= I .~- +--. + ... -- drds .. o(r, s) o(r, s) a(r, s) D To this double integral, apply Theorem 6, and make the change of variable produced by the transformation T. D will be replaced by D*, rand swill be replaced by their expressions in terms of u and v in the integrand, and dr ds will be replaced by la(r, s)/a(u, v)1 du dv. This results in the formula ( ) ( ) -rrlla(x,y)/2 10(y,Z)/2 ja(z,x)/2}1/2 0(r,s)d d8-53 A ~ - --- + ._.- +---- u v D', a(r,s) a(r,s) a(r,s) o(u,v) However, since P(u, v) = ~(T(u, v)), the chain rule of differentiation (Theorem II, Sec. 7.4) asserts that d~* = d~ dT, so that a(x, y) o(x, y) a(r, s) ---- --- o(u,v) a(r,s)a(u,v) a(y, z) o(y, z) a(r, s) - --- a(u, v) a(r, s) o(u, v) o(z, x) o(z, x) o(r, s) a(u, v) a(r,s) a(u, v) APPLICATIONS TO GEOMETRY AND ANALYSIS 433 If we use these relations in (8-53), we obtain A(L) = rr II o(x, y) 1 2 + 1 00\" 3) 1 2 + I 0(Z'3) 1 2 \\ 1/2 du dv D~ \\ O(U, v) O(U, v) O(U, v) I = A(P) proving equality of the areas of the surfaces. I From a more sophisticated point of view, it is now natural to alter the terminology so that the word \"surface\" no longer refers to an individual mapping L but rather to the entire equivalence class that contains L. Depend- ing upon the notion of equivalence that is used, one speaks of Frechet surfaces, Lebesgue surfaces, etc. It is in the guise of equivalence classes, perhaps, that one is best able to speak of \"the\" surface defined by an equation F(x, y, z) = 0; this may be understood to be the equivalence class of smooth surfaces L which satisfy this equation. So far, we have been chiefly concerned with the local theory of surfaces, that is, the behavior of a surface in the neighborhood of a point lying on it. Such considerations have to do with the existence and direction of a normal, with the curvature of the surface at the point, or with the relationship between the normal vector and curves which lie on the surface and pass through its base. Much of the modern theory of surfaces deals instead with properties\" in the large,\" which require consideration of the surfaces as a whole. For example, all smooth surfaces might be said to be approximately locally planar; thus, the essential distinction between a sphere and a torus is a property\" in the large.\" Similarly, the property of being orientable is one which cannot be settled by local considerations. To discuss such aspects as these, it is necessary to deal with the more general notion of a two-dimensional manifold. This can be thought of as a generalization of our previous notion of surface, and is motivated by consider- ing the union of a number of pieces of surfaces to form a larger object. Definition 18 A 2-manifold M is a set of mappings Ll' L2' ... such that (i) the domain of each is an open disk D in the (u, v) plane and (ii) each L j is a continuous 1-to-1 mapping having a continuous inverse. If we denote the trace of L j by Sj' then the trace of M is defined to be the union of the sets Sj' It is usual to require that the trace of M be a connected set of points; a manifold that is not connected is therefore the union of a number of connected manifolds. We may say that the manifold M is the union of the surface pieces (or surface elements) L j' This may be visualized as shown in Fig. 8-29. It is not necessary that all the mappings L j have the same domain. Any smooth surface which is simple is a manifold with just one surface element; any smooth surface L with multiple points is a manifold with a number of O~u~L o ~ v ~ 7[/2 438 ADVANCED CALCULUS 'EXERCISES 1 Plot the trace of the surface x = U 2 - V 2, .I' = u + v, z = U 2 + 4v, lui ~ I, 0 ~ v ~ I, and find the tangent plane at (- i, 1, 2). 2 Show that all the normal lines to the sphere (8-44) pass through the origin. 3 Let 1: be the surface described by z = f(x, .1'), (x, .1') E D, with f E C. Show that the normal to I: at Po is (- f,(po), - f2(PO)' I), and that the area of I: is A(I:) = JJ }I +~n+ f~ D 4 The curve y given by x = t, .I' = t 2 , Z = 2t 3 , - oc < t < 00, has a POint In common wIth the surface I: given by z = x 2 + 3.1'2 - 2xy. What is the angle bt:tween y and the normal to I: at thIs point? 5 Show that two surfaces which are smoothly equivalent have the same normal directIOns at corresponding points. 6 Find the surface area of the sphere (8-44). 7 Set up a definite integral for the surface area of the ellipsoid 8 Set up an integral for the area of the Mobius strip as described by (8-54). 9 Show that the normal to a surface I: is always orthogonal to I: u and I:,. 10 Find the surface area of the portion of the paraboloid z = x 2 + .1'2 which is cut out by the region between the cylinder x 2 + .1'2 = 2 and the cylinder x 2 + .1'2 = 6. II Show that an alternative expression for the area of a surface I: with domain Dis A(I:) = JJ {1I: u I 2 1I:v I2 - (I: u ' Ey}I!2 du dv D [In the study of the differential geometry of surfaces the notatIOn E = lI: uI 2, F = I: u • I: v ' and G = I I: v 1 2 is customary.] 12 Let axax ayay azaz F= +-- + au av au av au at· G = (a~)2+ (ay )2 + (az) 2 av av av Show that the inequality (7-55) can also be expressed as EG - F 2 > O. 13 A surface I: is described by I x = 2A u cos t' < \\' = 2Bu sin v I ~ = u2 (A cos 2 v + B sin 2 v) Describe the trace of I: and find its area. 14 Fmd the area of the portion of the upper hemisphere of the sphere with center (0,0,0) and radius R that obeys x 2 + .1'2 - Ry .:; O. APPLICATIONS TO GEOMETRY AND ANALYSIS 439 15 Let ~ be a C\" surface defined on an open-connected set D in the U V plane. Suppose dZ~ = ° m D. Prove that ~ is a plane. 16 If two smooth surfaces ~[ and ~z of class C are parametrically equ[valent, prove that the contmuous functions that relate them are of class C. 17 Let f be of class C' on the plane, flO, 0) = I and fl(O, 0) = fz(O, 0) = 0. The graph off is a surface defined by Ix = u ~~ V = v j ~= flu, v) Choose any 8, °S; 8 < n. Let y.(t) = (t cos 8, t sm 8) be a line in the parameter space, and let r.(t) = ~(y.(t)) be the corresponding curve on ~. (a) Find the curvature k. of r. at the point (0,0, I). (b) What is the connection between k. and dZf? \"(e) Show that the largest value of k., as 8 varies, is the largest eigenvalue of dZf 18 A two-dimensional surface in 4-space is a mapping from R Z into R4 • If ~(u, v) = (x, y, z, w) with domam D, then the area of ~ [S defined by A(~) = JJ {I~\"IZI~\"12 - (~\"• ~\")Z}I!2du dv D Fmd the area of the surface whose equation is x = 2uv, y = u 2 - vZ , Z = U + v, w = u - v, for u 2 + v2 S; 1. \"19 A three-dimensional surface in 4-space is a transformation X from a domain D in R 3 into R 4 . The three-dimensional volume (analogous to surface area) of X is defined to be V(x) = rl'r jK, ••• D where K is the sum of the squares of determinants of the 3-by-3 submatrices of dX· Thus, if X is given by x(8, 1/>, t/J) = (x, y, z, w), then K = Io(x, y, z) I Z+ I o(y, z,w) I Z + I o(z, w, x1l Z + Io(w, x,j') I Z 0(8,1/>, t/J) 0(8,1/>, t/J) 0(8,1/>, t/J) 0(8,1/>, t/J) The boundary of the four-dimensional ball of radius R is a three-dimensional manifold called the 3-sphere, given either by the equation XZ+ yZ + zZ + wZ= R Z or parametrically by x = R cos t/J sin I/> cos 8, y = R cos t/J sin I/> sin 8, z = R cos t/J cos 1/>, w = R sin t/J, for - (n/2) S; t/J S; n/2,°S; I/> S; n, 0,.::; 8 S; 2n. Show that the \"area\" of the 3-sphere is 2n zR 3 • 20 Check Theorem II for a surface ~ given by the equation F(x, y, z) = 0, by showing directly that if Po is a point on ItS graph [so that F(po) = 0], then the vector dF 1 Po = (F [(Po), Fz(Po), F3(PO)) is orthogonal to the tangent at Po of any smooth curve lying on ~ and passing through Po. 8.6 INTEGRALS OVER CURVES AND SURFACES In Chap. 4, we discussed integration in some detail, based on a simple approach in which the fundamental idea is the integral of a function defined on an interval, a rectangle, or an n-dimensional cell. In this section, we deal with a direct generalization, the integral of a function along a curve or over a surface, done in such a way that the integral of the function f == 1 yields the length of the curve or the area of the surface, respectively. This is also related to the 440 ADVANCED CALCULUS discussion of set functions in Sec. 8.2, since many of the usual applications of this deal with the calculation of physical quantities such as mass, gravitational attraction, or moment of inertia, in which the function to be integrated plays the role of a density. Let I' be a smooth curve, given as a C' mapping from [a, b] into 3-space, and letjbe a real-valued function that is defined and continuous on the trace of Yo Since the trace is the image of [a, b] under a continuous mapping, it is compact, and we may therefore assume thatjis in fact continuous everywhere in R 3 . We then define the integral ofjalong I' by (8-55) b r j= r j(y(t))ly'(t)! dt • Y • a Note that the integration is done back in the parameter space, although the values ofjare determined on the points p that lie on y. Note that ifj(p) = I for all p, then (8-55) becomes r 1 = L(y), the length of Yo If I' and 1'* are equivalent smooth curves, then . Y r j= r j • y • y* (see Exercise 5)0 If we choose 1'* as the curve which is equivalent to I' and which has arc length as parameter, then Iy*'(s)! = 1 for all s E [0, I], where 1 is the length of 1'; by (8-55) we then have (8-56) ./ r j = I j(y*(s)) ds • Y • 0 Since y*(s) is also a point on the trace of 1', this is frequently written (8-57) r j = r j(x, y, z) ds • Y • Y and for this reason, an integral along a curve I' is sometimes referred to as the result of \"integrating with respect to arc length.\" With arc length as the parameter, the integral of a function along I' can be given a different interpretation, much closer in format to that of the ordinary one-dimensional Riemann integral. If the length of I' is I, we choose points Sj with °= So < SI < S2 < ... < Sm = I, and think of these as partitioning the curve I' into short sections 1'1' 1'2' ... , I'm' where Yj is the mapping obtained by restricting I' to the subinterval [Sj_I' sJ Choose a point Pj on Yj' and form the sum 2: j(pJL(Yj)' It is then easily seen that this will converge to r f as the • y norm of the partition of [0, I] approaches 0, in the same way as was the case APPLICATIONS TO GEOMETRY AND ANALYSIS 441 for the usual integral of a continuous function on a real interval. For, in fact, m m s. L f(p)L(y) =L f(Pj) JJ ly'(s)1 ds 1 1 Sj_ 1 m =L f(pj)(Sj - Sj_ d 1 which converges to (8-57). Suppose now that we interpret the function f as giving the linear density (mass per centimeter) of a wire, which we can suppose varies from point to point. Then,f(pJL(Yj) is an estimate for the mass of the section Yj' and (8-57) becomes the definition of mass of the entire segment of wire 'I. As an illustration, let us find the center of gravity of a uniform wire which is bent into the shape of a semicircle. To describe this shape, we shall use the curve 'I whose equation is x = cos t, Y = sin t, °:os; t :os; n. By definition, the center of gravity will be the point (x, y) where Mx = rxp ds • y My = f yp ds y and M = r p ds • y The function p specifies the density of the wire (mass per unit length), M is the total mass of the wire, and the first two integrals are the moments of the wire about the lines x = °and y = 0, respectively. Since the wire is uniform, p is constant, and M = pL(y) = pn. From the equation for 'I, li(t)1 = I(-sin t)2 + (cos t)21 1/2 = I andy has arc length for its parameter. Substituting for x and y, and using (8-56 ), r px ds = p r1t cos t dt = °= M x • y • 0 • .1t I py ds = p I sin t dt = 2p = My • y • 0 so that the center of gravity is (0,2In). Other examples involving integrals along curves will be found in the Exercises. Turning to integrals over surfaces, let L be a smooth surface with domain D, and let f be a continuous function defined on the trace of L. A subdivision of D into sets Dij produces a subdivision of L into small surface elements Lij' Let Pij be a point lying on Lij and form the sum Lf(Pij)A(LiJ If these have a limit as the norm of the subdivision of D tends to 0, then this limit is called 442 ADVANCED CALCULUS the value of the integral off over the surface L, and is written as rr f By an .. r argument which is analogous to that used for integrals along curves, we arrive at the equivalent expression (8-58) where JJ f = JJ f(L(U, v))ln(u, v)1 du dv r D In(u, v)1 = Ja(~')'L+ o(~ Z)2 + o(z, X)2\\ 1/2 \\ o(u, v) o(u, v) o(u, v) I Thus, evaluation of the integral of a function over a surface is reduced to the evaluation of an ordinary double integral. Iff is constantly I, then rr f = A(L), .. r the area of L. For this reason, the general integral rr f is often written .. r rr f(x, y, z) dA, and one speaks ofintegratingfwith respect to the element of .. r surface area, over the surface L. To illustrate this, let us find the center of gravity of a thin uniform sheet of metal which is in the shape of the paraboloid z = x 2 + y2, with x 2 + y2 ~ 1. The center of gravity is the point (0,0, z), where Mz = II pz dA r and M = rr p dA. Since the sheet of metal is uniform, p is constant, and .. r M = pA(L). To compute this, we need the value of Inion L. Using x and y as the parameters for L rather than introducing u and v, and Exercise 3, Sec. 8.5, we have In(x, y)1 = [I + 4x 2 + 4y 2]1/2, so that A(L) = JJ )I--+- 4(xz-+?) dx dy D where D is the unit disk, x 2 + l ~ 1. The form of the integrand and of D suggest that we transform to polar coordinates. Accordingly, the integrand becomes (I + 4r2 )1 / 2, dx dy is replaced by r dr de, and D is replaced by the rectangle °~ e ~ 2n, °~ r ~ 1. Thus, .2\" . 1 _ A(L) = I de I )1 + 4r 2 r dr . 0 . 0 Hence APPLICATIONS TO GEOMETRY AND ANALYSIS 443 In the same fashion, we have JJ z dA = JJ (X 2 + i)~l+ 4(x2 + y2) dx dy 1: D .2\" . I I de I r\\/f+ 4? r dr . 0 . 0 1~(5~5 +~) Z = G) ~~~t= .56 Thus, in all cases, the integral of a function f \"along the curve Y,\" or \"over the surface L\" reduces to ordinary integration of the related function f(y(t)) or f(L(U, v)) over the appropriate parameter domain. While we have illustrated only the case in which f is a real-valued function, the same thing is done iff is complex-valued, or vector-valued, or even matrix-valued, since in each case, one merely integrates component by component. Thus, if F(p) = (.f(p), g(p), h(p)), then the integral of F along y is As we shall see in the next chapter, many physical problems lead to the consideration of a special class of integrals of functions along curves and over surfaces. EXERCISES I Find the center or gravity or a homogeneous wire which has the shape or the curve y = V + e- ')/2. - 1 ~ x ~ 1. 2 The moment or inertia or a particle or mass m about an axis or rotation whose distance is I is defined to be mI'. Show that a reasonable definitIOn ror the moment or inertia or a wire in the shape or the plane curve y abou t the Y aXIs IS 1= .r px 1 ds 3 A wire has the shape or the curve y = x 2 • - 1 ~ x ~ 1. The density or the wire at (x, y) is kJyo What is the momen t or inertia or the wire abou t the Yaxis? 4 Formulate a definitIOn ror the moment or inertia or a wire in space about the Z axiso 5 Let II and \"2 be smoothly equivalent curves, and let f be continuous on their trace. Show by (8-55) that ,0 f = I' f '}'l '}'2 6 The rorce or attraction between two particles acts along the line joming them, and its magnitude is given by km l m2 r- z, where m, and m2 are theIr masses, and r is the distance 444 ADVANCED CALCULUS between them. Fmd the attraction on a unit mass located at the origin which is due to a homogeneous straight wire of mfinIte length, whose distance from the ongin is I. *7 Let ~I and ~2 be smoothly equivalent surfaces, and let f be continuous on their trace. Show by (8-58) that JJ f = JJ f 8 Fmd the moment of inertia of a homogeneous spherical shell about a diameter. 9 A sheet of metal has the shape of the surface z = x 2 + y2, 0 'S x 2 + y2 'S 2. The density at (x, y, z) IS kz. Find the moment of inertia about the Z axis. 10 What IS the force of attraction upon a unit mass located at (0,0, I) which is due to a homogeneous cIrcular disk of radius R, center (0,0,0), and lying in the X Y plane? What happens if R is allowed to become infinite? *1) Show that the force of attractIOn within a spherical shell of constant density is everywhere O. CHAPTER NINE DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 9.1 PREVIEW The topics in this chapter are a strange mixture of applications and sophisticated theory. The study of the vector calculus (Stokes' theorem, Green's theorem, Gauss' theorem) is sometimes justified by its role in the solution of Laplace's equation, Poisson's equation, the inhomogeneous wave equation, and the study of electromagnetic radiation and Maxwell's equations, as described in Sec. 9.6. On the other hand, the theory of differential forms, sketched in Sees. 9.2, 9.4, and 9.5, gives a view of the surprising interplay between analysis and geometry that has marked many of the most significant mathematical advances of the current century. In Sec. 9.2, we introduce I-forms and 2-forms as functionals that assign numerical values to curves and surfaces, and present some of the accompanying algebraic formalism. In Sec. 9.3, we relate this to the more traditional algebra of vectors in 3-space, showing how vector-valued functions give rise to the study of line and surface integrals and differential forms. We state the generalized Stokes' theorem in Sec. 9.4, and then restate it (and prove it) in the form appropriate for the plane and 3-space. We note that Theorem 8 and the related Lemma I are an important part of this treatment. Finally, in Sec. 9.5 we discuss exact forms and locally exact forms (or closed forms) and the geometric conditions under which they are equivalent. This leads us back to simple connectedness and its higher-dimensional analogs. Theorems 3 and 15 445 446 ADVANCED CALCULUS provide the framework for this, along with Lemma 1; unfortunately, we have had to leave the general theory at this incomplete stage, referring to more advanced texts on differential topology for the rest of the story. 9.2 DIFFERENTIAL FORMS The integral of a function along a curve, or over a surface, is an example of a function whose domain of definition is not a set of points. For example, rf is a number that is determined by the pair (y, f) consisting of the • y smooth curve y and the continuous functionf, and defined by (8-55). Similarly, the value of rr f is determined by the pair (L, f), and can therefore be • '1: regarded as a function of the pair; ¢(L, f) = rr f If L is held fixed, then •• 1: the value is determined by the choice off, and one might write aU) = rr f to •• 1: indicate that we are dealing with a numerical-valued function a whose domain is the class of all continuous functions f defined on the trace of L. Again, if f is defined in an open region Q of space, and we regard L as the variable, we write F(L) = rr f, thus obtaining a function whose domain is the •• 1: class of smooth surfaces L having their trace in the region n. The name\" functional\" is sometimes used for functions such as F and a to distinguish them from the more usual type of function. We shall say that F is a curve functional if its domain is a class of smooth curves with trace in a specific open set; F will then assign the numerical value F(y) to any such curve y. Likewise, F is a surface functional on the open set Q if F assigns the numerical value F(L) to any smooth surface L whose trace lies in Q. For emphasis, we will sometimes use\" poin t function\" for an ordinary numerical- valued function whose domain is the set of points Q itself. Finally, for consistency, we introduce the term region functional for functions F whose domain is the class of compact sets K c Q. Note that these are precisely the set functions discussed in Sec. 8.2, of which the following is a typical example. F(K) = JJJ 9 K where 9 is a point function defined in Q. We can also generalize this to n space. We would have functionals of each dimension k = 0, 1, 2, ... , n. If k \"# 0, k\"# n, then a k-dimensional functional F on an open set Q would assign a numerical value F(L) to any smooth k-dimensional surface L whose trace lies in Q. (Recall that L itself is a C mapping from a rectangle in Rk into n space.) When k = 0, we identify 450 ADVANCED CALCULUS have JJJ f(x, y, z) dy dx dz = - JJJ f(x, y, z) dx dy dz We observe that this relation is also consistent with the symbolic equation (9-2). Since dy dx = -dx dy, dy dx dz = -dx dy dz. Again, dy dz dx = dy(dz dx) = dy( -dx dz) = -dy dx dz = - (-dx dy) dz = dx ely dz It is not possible to put all curve-functionals into the form F(y) = rf • y where the function f is independent of y. As we shall see, an example is furnished by the class of functionals that are known as line integrals. These form a special division of the more general category known as differential forms. In n space, there are n + I classes of differential forms, called in turn O-forms, I-forms, ... , n forms. In 3-space we shall deal with O-forms, I-forms, 2-forms, and 3-forms, while in the plane, we shall meet only O-forms, I-forms, and 2-forms. For simplicity, we begin with the theory of differential forms in the plane (n = 2), starting with the class of I-forms. These are also called line integrals. Definition I The general continuous Ijorm in the X Y plane is a curve- functional w denoted by W= A(x,y)dx + B(x, y) dy where A and B are continuous functions defined in a region n. rr y is a smooth curve, with equation x = ¢(t), y = ljI(t), a ::; t ::; b, whose trace lies in n, then the value which w assigns to y is defined by the formula (9-3) , b w(y) = , [A(y(t))¢'(t) + B(y(t))ljI'(t)] dt , a The rule for computing w(y) can be stated thus: Given the differential form wand a curve y, we \"evaluate w on y\" by substituting into w the expressions for x, y, dx, and dy which are obtained from the equations of y, following the familiar custom of replacing dx by ~~dt = ¢'(t) dt dt and dy by ljI'(t) dt; this results in an expression of the form g(t) dt, which ,b is then used as an integrand to compute I g(t) dt, where [a, b] is the domain ofy. . a DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 451 To put this in a more evident way, the value of w(y) is usually written rw = r [A(x, y) dx + B(x, y) dy] ')' ',' and one speaks of integrating the differential form w along the curve y. If we choose A = 1, B = 0, then w = dx, so that dx (and dy) are special I-forms. For example, dx assigns to the smooth curve I' the value . .b I dx = I ¢'(t) dt = ¢(b) - ¢(a) • )' . a which is the horizontal distance between the endpoints of y. Since every I-form can be expressed as a linear combination of dx and dy with function coefficients, dx and dy are called the basic I-forms in the XY plane. Let w = xy dx - / dyand let \" be given by x = 3t2, Y = t 3 , for °~ t ~ 1. On I\"~ we have w = (3t 2)(t 3 )(6t dt) - (t 3 )2(3t2 dt) = (I8t 6 - 3t 8 ) dt . .1 Thus Iw=1 (18t 6 -3t 8 )dt=¥-i=H • y • 0 Let us compute the integral of the same I-form along the straight line from (0,0) to (2,4). The equation for this curve is x = 2t, Y = 4t, °~ t ~ 1. On 1', w = (2t)(4t)(2dt) - (4t)2(4dt) = -48t 2 dt, so that • 1 IW= f (-48t 2)dt= -16 • y • 0 As we shall show in Theorem 2, f w = f w whenever 1'1 and 1'2 are • y 1 • Y2 smoothly equivalent curves. In this last example, for instance, we may also use the parameterization y = 2x, x = x, °~ x ~ 2. Making this substitution instead, we have on I' and w = x(2x) dx - (2X)2(2dx) = -6x 2 dx . .2 I (xydx-y 2 dy)= j (-6x 2)dx= -16 • y • 0 in agreement with the previous calculation. Certain general properties of I-forms (line integrals) in the plane can be seen at once from (9-3). Reversal of the orientation of a curve changes the sign of the integral, since the direction of integration in the integral containing dt will be reversed. We may state this in the form J w=-fw - y • y 452 ADVANCED CALCULUS y (0,1) I----E------, (1, 1) (1,0) x Figure 9-4 If the curve 'Y is the union of a finite set of curves 'Y = 'Y1 + 'Y2 + ... + 'Yn then rw = r w + f w + ... + r w 'Y 'y, 'Y2 'y. As an example, let us compute the integral of w = xy dx + y2 dy along the closed polygonal path which forms the edge of the unit square, 0 ::; x ::; 1, 0::; y::; 1 (see Fig. 9-4). We write 'Y = 'Y1 + 'Y2 + 'Y3 + 'Y4 where these are the four sides of the square. We evaluate each of the line integrals r w separately. On 'YI> y = 0 and x = x, with x going from 0 to I; • Yj thus, on 'Y1, w = 0 dx + 0 = 0 and r w = O. On 'Y2' x = 1 and y = y, with y • Y, going from 0 to 1; thus, w = (1)(y)O + y2 dy . r1 and I w = y2 dy = 1. On 'Y3' Y = 1 and x = x, with x going from • Y2 • 0 because of the orientation of 'Y3; thus, w = (x)(I) dx + (1)0 = x dx I to 0 o and r w = r x dx = -1. Finally, on 'Y4' x = 0 and y = y, with y going from • Y3 • 1 1 to 0, so that w = 0 + l dy and ,0 r w = I l dy = -~ • Y4 • 1 DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 453 Adding these, we have Integration of a I-form is especially simple if it involves only one of the variables. For example, let w = A(x) dx and let y be a smooth curve whose starting point is (xo, Yo) and whose last point is (XI' YI)' given by X = ¢(t), Y = l/J(t), 0 ~ t ~ 1. On y we have w = A(¢(t))¢'(t) dt so that I rw = r A(¢(t))¢'(t) dt • y • 0 (9-4) Making the substitution X = ¢(t), this becomes merely • .XI Iw=1 A(x)dx • }' • Xo (In particular, we note that the value of r w in this case depends only upon • y the location of the endpoints of y and not upon the rest of the trace of the curve.) Comparable statements can be made for I-forms w = B(y) dy. (See Exercises 6 and 7.) The general I-form (line integral) in 3-space is w = A(x, Y, z) dx + B(x, y, z) dy + C(x, y, z) dz and the method of evaluating w(y) = r w for a curve y is the same. If y is • y given by X =¢(t), y =l/J(t), z =8(t), for 0 ~ t ~ 1, then we define the value of the line integral by rw = r A dx + B dy + C dz • y • y r I dx f I dy = A(¢(t), l/J(t), 8(t)) -d- dt + B(¢(t), l/J(t), 8(t)) d- dt • 0 tot .1 dz +./0 C(¢(t), l/J(t), 8(t)) dt dt As an illustration, let w =xy dx - Y dy + 3zy dz and y be: x =t 2 , Y =t, z = _t 3 • On y, we have w = (t 2 )(t)(2t dt) - (t)(dt) + 3( - t3 )(t)( - 3t 2 dt) = (9t 6 + 2t4 - t) dt If the domain of y is [0, 1], then . .1 I w = I (9t 6 + 2t 4 - t) dt = i + ~- 1 • y • 0 454 ADVANCED CALCULUS Let us turn now to the theory of 2-forms. These will be a special class of surface-functionals. In the case of 2-forms in the plane, the theory is especially simple. As defined in Chap. 8, a surface in n space is a mapping from a region D in the parameter plane into n space. When n = 2, the notion of surface degenerates into the ordinary notion of a transformation T of the plane into itself, and a smooth surface is such a transformation which is of class C and whose Jacobian is never O. A simple smooth surface (surface element) is thus a I-to-l continuous transformation with nonzero Jacobian, which maps a region D of the (u, v) plane into a region in the (x, y) plane. Since the Jacobian is continuous, it must be always positive in D, or always negative in D; in the former case, T is orientation preserving, and in the latter, orientation reversing. We may thus identify such a surface with its trace in the (x, y) plane, oriented according to the sign of the Jacobian of T. The notion of \"surface\" becomes simply that of an oriented region in the plane. We adopt the following definition for 2-forms in the plane. Definition 2 The general continuous 2jorm in the X Y plane is a region- functional denoted by (9-5) w = A(x, y) dx dy where the function A is continuous. If Q is a region (having area) in the domain of definition of A, then the value which w assigns to Q is defined by w(Q) = JJ A(x, y) dx dy n In line with our previous discussion, it is also natural to consider expressions of the form A(x, y) dy dx; this is also a 2-form, but by means of the convention that dy dx = - dx dy, we may replace it by - A(x, y) dx dy, which is again of the form (9-5). The general 2-form in the plane becomes merely the oriented double integral [see (9-1)]. The situation in 3-space is more complicated. In addition to the basic 2-form dx dy, we also have dy dz and dz dx; moreover, their coefficients may be functions of three variables. Thus, the general 2-form in space becomes w = A(x, y, z) dy dz + B(x, y, z) dz dx + C(x, y, z) dx dy This is a surface-functional, and the value which it assigns to a surface L is denoted by If w. However, we cannot explain the meaning of this symbol . I further, nor the method for evaluating it, without some additional machinery. We complete the roster of differential forms in the plane by defining a 0- form to be merely any continuous function (= point function). In space, we must also define 3-forms. DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 455 Definition 3 The general continuous 3jorm in X YZ space is region- functional denoted by w = A(x, y, z) dx dy dz where the function A is continuous. If Q is a subset (having volume) of the domain of definition of A, then the value which w assigns to Q is defined by w(Q) = JJJ A(x, y, z) dx dy dz Q Thus, the 3-forms in space are oriented triple integrals; a 3-form in which the order is not dx dy dz can be reduced to this form by permuting pairs. The 3-form C(x,y,z)dydzdx is the same as -C(x,y,z)dydxdz and as C(x, y, z) dx dy dz. We next introduce an algebraic structure into the system of differential forms by defining addition and multiplication of forms. Any two forms of the same class are added by combining coefficients of like terms. For example, (x 2 dx + xy2 dy) + (dx - 3y dy) = (x 2 + 1) dx + (xy 2 - 3y) dy (2x + y) dx dy + (xy - y) dx dy = (2x + xy) dx dy (3dx + xyz dy - xz dz) + (y dx - dz) = (3 + y) dx + xyz dy - (xz + 1) dz When two terms contain the same differentials, but in different orders, they must be brought into agreement before adding their coefficients, using the convention: (9-6) dx dy = -dy dx dy dz = -dz dy dz dx = -dx dz For example, (x dy dz + y2 dx dy + z dx dz) + (3dy dz - z dy dx + x 2 dz dx) = (x dy dz + 3dy dz) + (y2 dx dy - z dy dx) + (z dx dz + x 2 dz dx) = (x + 3) dy dz + (y2 + z) dx dy + (z - x 2) dx dz Multiplication of differential forms is governed by the rules set forth in (9-6) and the following: (9-7) dx dx = dy dy = dz dz = 0 Except for these conventions, and the necessity of preserving the order of factors, multiplication can be performed as in elementary algebra. Stated in different terms, the system of differential forms in 3-space is a linear associative algebra whose basis elements are 1, dx, dy, dz, dxdy, dydz, dzdx, and dxdydz; whose coefficient space is the space of continuous functions of three variables; and whose multiplication table is specified by the relations (9-6) and(9-7). 456 ADVANCED CALCULUS For example, (2dx + 3xy dy)(dx) = 2(dx dx) + (3xy)(dy dx) = 0 + (3xy)( -dx dy) = -3xy dx dy (2dx + 3xy dy)(x dx - y dy) = (2x)(dx dx) + (3x 2y)(dy dx) + (- 2y)(dx dy) + (- 3xy 2)(dy dy) = 0 + (3x 2y)( -dx dy) + (-2y)(dx dy) + 0 = -(3x 2y + 2y) dx dy Taking a somewhat more complicated example involving three variables, (x dx - z dy + i dz)(x 2 dy dz + 2dz dx - y £Ix dy) = x 3 dx dy dz + 2x dx dz dx - xy dx dx dy - x 2z dy dy dz - 2z dy dz dx + yz dy dx dy + y2x 2 dz dy dz + 2y2 dz dz dx - / dz dx dy = x 3 dx dy dz - 2z dy dz dx - y3 dz dx dy = (x 3 _ 2z - y3) dx dy dz Such computations may be shortened by observing that any term which contains a repetition of one of the basic differential forms dx, dy, dz will be O. Accordingly, the product of two 2-forms in space, or in the plane, and the product of a I-form and a 2-form in the plane are automatically O. In general, the product of a k-form and an m-form is a (k + m)-form; if k + m is larger than n, the number of variables, then there will be repetitions, and such a product will be O. Since a O-form is merely a function, multiplication by a O-form does not affect the degree of a form. For example, Finally we define a notion of differentiation for forms. In general, if w is a k form, its derivative dw will be a (k + I )-form. We give the definition of dw for forms in 3-space. Definition 4 1. If A is a O~form (function) of class C, then dA is the I-form aA aA aA dA = - dx + dy + a dz ax ay z 11. If w is a I-form A dx + B dy + C dz whose coefficients are functions of class C, then dw is the 2~form dw = (dA) dx + (dB) dy + (dC) dz DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 457 Ill. It w is a 2~form A dy dz + B dz dx + C dx dy whose coefficients are of class C', thell dw is the 3-form dw = (dA) dy dz + (dB) dz dx + (de) dx dy In (ii) and (iii), dw is to be computed by evaluating dA, dB, and de, and then computing the indicated products. Since dA is a I-form, (dA) dx is indeed a 2-form and (dA) dy dz a 3-form. The derivative of a 3-form may be computed in the same fashion, but since it will be a 4-form in three variables, it will automatically be O. Differentiation of forms in two variables is done in the same fashion. Some examples will illustrate the technique. Form A = x 2 .\\' A = xy + yz w = x 2y dx w = (xy + yz) dx w = x 2y dy dz - xz dx dy Derivative dA = 2xy dx + x 2 dy dA = y dx + (x + z) dy + ydz dw = d(x 2y) dx = (2xydx + x 2dy) dx = _x 2 dx dy dw = d(xy + yz) dx = (ydx + (x + z) dy + .I' dz) dx = (x + z) dy dx + .I' dz dx dw = d(x 2y) dy dz - d(xz) dx dy = (2xy dx + x 2 dy) dy dz - (z dx + x dz) dx dy = 2xy dx dy dz - x dz dx dy = (2xy - x) dx dy dz This extensive barrage of definitions is partly justified and motivated by the following result. Theorem 1 If u = /(x, .1') and v = 9(x, .1'), then (9-8) 8(u, v) du dv = - - - dx dy 8(x, y) We have du = /1 dx + /2 dy and dv = 91 dx + 92 dy, so that du dv = (II dx + f2 dY)(91 dx + 92 dy) = /Igl dx dx + /192 dx dy + /291 dy dx + f2 92 dy dy = /192 dx dy + /291 dy dx = (I192 - f2 9d dx dy =1/1 /2!dXd y =8CU,V)dXdY I 91 92 8(x, y) 458 ADVANCED CALCULUS Recalling that the theorem on transformation of multiple integrals requires one to replace du dl' by c(u, l')jc(x, y) dx dy when making the substitution u = f(x, y), v = g(x, y), this theorem makes it possible to carry out such substitutions by the same routine procedure that one uses in singlefold integrals. For example, in Sec. 8.3 we considered the integral rr exp ((x - y)j(x + y)) dx dy, .• D* where D* is the triangle bounded by x = 0, y = 0, x + Y = 1. We set u = x - y, v = x + y, which maps D* onto another triangle D with vertices (0, 0), (1, 1), (-1, 1). We have du = dx - dy, dl' = dx + dy, so that du dl' = (dx - dy)(dx + dy) = dx dy - dy dx = 2dx dy Accordingly, we have rr exp (X- Y) dx dy = rr eU/t'~du dl' iJ: x + y v· from which one may proceed as before to complete the problem. It should be observed that (9-8) does not have the absolute value of the Jacobian. The reason is that we can now make good use of the orientation of double integrals (2-forms) in the plane; if c(u, l')jc(x, y) is negative, then the corresponding mapping sending (x, y) into (u, v) will be orientation reversing, and the formalism of (9-8) will assign the correct sign to the result of the change of variable in the integral. We are at last ready to explain the meaning to be attached to a 2-form in 3-space, and more generally, a k form in n space. Definition 5 The general continuous 2:form in space is a surface-junctional denoted by w = A(x, y, z) dy dz + B(x, y, z) dz dx + C(x, y, z) dx dy where A, B, and C are continuous functions defined in a region n. Let L be a smooth surface with domain D defined by Ix=iP(u,l') . Y = ljJ(u, v) I z = O(u, v) (u, v) ED whose trace lies in n. Then, the value which w assigns to L is defined by JJ w = JJ {A(L(U, v)) dljJ dO + B(L(U, v)) dO diP + C(L(U, 1')) diP dljJ} l: D We note that again, rr w is computed by a straightforward process of .. l: DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 459 substitution; w is evaluated on the surface by using the equation for L and the operations of differentiation and multiplication for differential forms. For example, let w = xy dy dz + x dz dx + 3zx dx dy, and let L be the surface On L, we have lx=u+t' , \\' = u - v j ~ = Ul' O~u~l O~v~1 dy dz = (du - d!')(v du + u dv) = (u + v) du dv dz dx = (v du + u dr)(du + dv) = (v - u) du dv dx dy = (du + dv)(du - dv) = - 2du dv and w = (u + r)(u - v)(u + v) du dr + (u + !'Hv - u) du dv + 3uv(u + 1')( -2) du dv = (u 3 - 5u2 1' - 7uv 2 - 1'3 + t,2 - u2) du dl' so that .. .1 .1 II w = I du I (u 3 - 5u2t, - 7uv 2 - 1'3 + 1'2 - u2) dv .. '0 • 0 1: ,I = I (u 3 - ~U2 - ~u + iz) du '0 = -2 Again, let w be the same 2-form, and let L be the surface given by z = x 2 + .1'2, with 0 ~ x ~ 1, 0 ~ y ~ 1. On L, dz = 2x dx + 2y dy, so that dy dz = dy(2x dx + 2y dy) = - 2x dx dy dz £Ix = (2x dx + 2y dy) dx = - 2.1' £Ix £1.1' and on L we have w = xy £1.1' dz + x dz dx + 3zx dx dy = (xy)( - 2x dx dy) + x( - 2.1' dx dy) + 3(x 2 + y2)X dx dy = (3x 3 + 3x/- 2x 2y - 2xy) dx dy Thus, the integral of this 2-form over L is .. .1 .1 II w = I £Ix I (3x 3 + 3xl - 2x 2y - 2xy) dy .. . 0 '0 1: ,I = I (3x 3 - x 2) £Ix = -fz '0 460 ADVANCED CALCULUS When two surfaces are parametrically equivalent, then a 2-form will assign the same value to both. This, together with the analogous statement for line integrals, is the content of the next theorem. Theorem 2 i. If \"h and 1'2 are smoothly equivalent curves and w is a continuous Ijorm defined on the trace of the curves, then r w = r w. • Yl • Y2 II. If L 1 and L 2 are smoothly equivalent surfaces, and w is a continuous 2-form defined on their trace, then ff w = rr w. \"II \"I 2 For (i), let us consider the I-form w = A(x, y, z) dx. We may assume that Y2(t) = Ydf(t)), where f is of class C, and maps the interval [IX, /3], which is the domain of 1'2' onto the interval [a, b], which is the domain of'Yt- If we have x = </J(t) on 1'1' then x = </J(f(t)) on \"'h. Computing the integral of w along 1'2' we have . .P dxI w = I A(Y2(t))-- dt • Y2 • , dt • P = I A(ydf(t)))</J'(f(t))f'(t) dt ., In this ordinary definite integral, make the substitution s = f(t), and obtain J w = (A(Yl (s))</J'(s) ds = J W Y2 a Y1 Similarly, one can show the same relation for the I-forms B dy and C dz, and by addition, obtain f w = r w for a general I-form w. • Y2 • YI For (ii), we consider first a 2-form w = A(x, y, z) dx dy. Let L be a surface with domain D 1 on which we have x = </J(r, s), y = t/J(r, s), z = 8(r, s), and let L 2 be a surface with domain D2 which is smoothly equivalent to L 1 ; we may therefore assume that we have L 2(U, v) = L1(T(u, v)) where T(u, v) = (r, s) describes a C transformation T mapping D2 onto Db I-to-I, orientation preserving. Using the result of Theorem 1, we evaluate w on L 2 : a(x v) w = A(L 2(U, 1')) dx dy = A(L 2(U, v)) '\"') du dl' a(u, v a(x v) = A(L1(T(u, r))) ..(--' 0) du dl' au, r Thus, DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 461 .. . . o(x y) .1.1 w = .1.1 A(L!(T(u, v))) a(U:V) du dv 1:2 D2 In this, let us make the transformation of coordinates (r, s) = T(u, v). Again applying Theorem 1, we have fl' w = fl' A(Ldr, s)) ~(x,y)o(u,y) dr ds.... o(u,v) o(r,s) 1: 2 D, However, by the chain rule for differentiation, so that The expression o(x, y)/o(r, s) dr ds is, again by Theorem 1, equivalent to dx dy on L!, so that we finally obtain JJ w = JJ A(x, y, z) dx ely = JJ W 1:2 1:, 1:, Again, the theorem may be completed by considering the 2-forms B dy dz and C dz dx, adding the results to arrive at the general case. I So far, we have given no motivation for the consideration of integrals of I-forms and of 2-forms. This will be done in Sec. 9.3, against a background of classical vector analysis. We shall show that the value which a I-form w assigns to the curve 'Y can also be obtained by integrating a certain function f, constructed from both wand 'Y, along the curve 'Y. Similarly, the value which a 2-form w assigns to the surface L can be obtained by integrating a function F over the surface L, where again F depends both upon wand L. These integra- tions are carried out as in Sec. 8.6. The functions.f and F which arise are defined only on the curve and on the surface; however, they arise from \"vector-valued\" functions in a manner which is physically significant, and which leads to important physical interpretations of the integrals involved. EXERCISES 1 Evaluate r (x dx + xv dy) where \" (a) y is the line x = t, Y = t, 0 ~ t ~ I. (b) y is the portion of the parabola y = x 2 from (0,0) to (I, I). (c) y is the portion of the parabola x = y2 from (0,0) to (I, I). (d) y is the polygon whose successive vertices are (0,0), (1,0), (0, I), (1, I). 462 ADVANCED CALCULUS 2 Evaluate f (ydx - x dy) where 'y (a) y is the closed curve x = t2 - I, .I' = t 3 - t, -I 'S t 'S I. (b) y is the straight line from (0,0) to (2,4). (c) y is the portion of the parabola .I' = x 2 from (0,0) to (2,4). (d) y is the polygon whose successive vertices are (0, 0), (- 2, 0), (- 2, 4), (2, 4). 3 Evaluate f (ydx + x dy) for the curves given in Exercise 2. 'y 4 Evaluate f (z dx + x 2 dy + .I' dz) where 'y (a) y is the straight line from (0,0,0) to (I, I, I). (b) y is the portion of the twisted cubic x = t, .I' = t2 , Z = t 3 from (0,0,0) to (I, I, I). (c) \" is the portion of the helix x = cos t, .I' = sin t, z = t, for °'S t 'S 2n. (d) y is the closed polygon whose successIve vertices are (0,0,0), (2,0, 0), (2, 3, 0), (0,0, I), (0,0,0). 5 Evaluate f (2x dx + z dy + .I' dz) for the curves given in Exercise 4. • y 6 If w = B(y) dy, show that f w = fY ' B(y) dy for any smooth curve \" which starts at (xo, Yo) • y • Yo and ends at (Xl> .1',). 7 If w = A(x) dx + B(y) dy, show that f w = °for any closed curve y. 'y 8 Verify the following: (a) (3x dx + 4.1' dy)(3x 2 dx - dy) = - (3x + 12x 2y) dx dy. (b) (3x 2 dx - dy)(3x dx + 4y dy) = (3x + 12x 2y) dx dy. (c) (x dy - yz dz)(y dx + xy dy - z dz) = (xy 2z - xz) dy dz - y2z dz dx - xy dx dy. (d) (x 2 dy dz + yz dx dy)(3dx - dz) = (3x 2 - yz) dx dy dz. (e) (dx dy - dy dz)(dx + dy + dz) = 0. (f) (dx - x dy + yz dz)(x dx - x 2 dy + xyz dz) = 0. 9 Show that (A dx + B dy + C dz)(a dx + b dy + c dz) = I: ~Idy dz +I~ ;Idz dx + I: ~Idx ell' 10 Show that (A dx + B dy + C dz)(a dy dz + b dz dx + c dx dy) = (aA + bB + cC) dx dy dz II Evaluate df if (a) f(x, .1', z) = x 2 yz; (b) f(x, .1') = log (x 2 + .1'2). 12 Let x = ¢(u, l\", w), Y = I/J(u, v, w), z = O(u, v, w). Show that iJ(x, 1', z) dx dr dz =. , du dl' dw - iJ(u, 1', w) 13 Evaluate dw where (a) w = x 2 r dx - yz dz (b) w = 3x dx + 4xy dy (c) w = 2xy dx + x 2 dy (d) w=e XY dx-x 2ydy (e) w = x 2ydydz - xzdx dy (f) w = x 2z dy dz + y2z dz dx - Xl'2 dx dy (g) w = xz dy dx + xy dz dx + 2yz dy dz 464 ADVANCED CALCULUS 9.3 VECTOR ANALYSIS Since the purpose of this section is to show how one can translate between the language and notation of the system of differential forms and that of vector analysis, we shall not develop the latter in detail. Since the early years of this century, there have appeared many texts which explain vector analysis in the form used in engineering and physics; our discussion is therefore abbreviated. Classical vector analysis is three-dimensional, and the reasons behind its notation and form are historical, having roots in a desire to introduce more algebraic structure into geometry. As we have seen, addition of points can be defined for points of the plane, or of space, or, in general, for points in Rn• If P = (Xb X2' ... , x n) and q = (Yb Y2' ... , Yn), then P + q = (XI + .J!!, X 2 + Y2' ... , Xn + Yn) We also defined the product of a point p by a real number A as the point given by AP = (Ax l , Ax2' ... , Axn ) It is natural to ask if there is a useful definition of multiplication for points such that the product of two points in Rn is again a point in Rn and such that the customary rules which govern the algebra of real numbers still hold for points. The inner product (also called scalar or dot product) of two points, which was defined in Sec. 1.2 by p' q = XIJ,'I + X2.V2 + ... + xnYn is not suitable, since the inner product of two points is a number (scalar) and not a point. It is well known that suitable multiplications exist when n = 2. For example, one may define the product of two points in the plane by the formula (9-9) Upon checking the various algebraic rules, it is found that under this definition for multiplication, and the previous definition of addition, R 2 becomes what is called a field (see Appendix 2). The motivation for (9-9) may be seen by making the correspondence (a, b) +--+ a + bi between the plane and the field of all complex numbers. If P = (XI' x 2) corresponds to z = XI + iX2 and q = (YI' Y2) corres- ponds to w = YI + iY2' then we see that zw = (XI + iX2)(,VI + iY2) = (Xl.VI - X2Y2) + i(Xd'2 + x 2yd which corresponds to the point which is given as the product of P and q. With this example in mind, one may attempt to find a similar definition for multiplication of points in 3-space. By algebraic methods, it can be shown that no such formula exists (still requiring that the ordinary algebraic rules remain valid). However, going to the next higher dimension, Hamilton (1843) 468 ADVANCED CALCULUS Figure 9-8 Velocity vector field. the table (9-11) that a, b, and a x b form a positively oriented trihedral; for the general case, see Exercise 3. The fact that the definitions of sum, inner product, and cross product, given originally in terms of the coordinates of the points, can also be given solely in geometrical terms means that these operations have an invariant quality which lends itself to the statement of physical laws. This invariance is inherent also in the coordinate definitions. The inner product of two points, p and q, is an algebraic function of their coordinates whose value is unchanged if the under- lying 3-space is subjected to any orthogonal linear transformation (rotation) resulting in new coordinates for p and q. Vectors are used in a variety of ways to represent physical quantities. With its initial point at the origin, a vector merely describes a position in 3-space. With its initial point at a point on a curve, the vector may represent the tangent to the curve, or the center of the circle of curvature there. A vector-valued function defined in a region D of space can be regarded as associating with each point p E D a specific vector V(p), whose initial point is placed at p. The resulting \"vector field\" or \"direction field\" in D might be used to model a variety of different physical situations. As an illustration, suppose that a flow of liquid is taking place throughout a region D. At each point of D, the liquid has a particular velocity which may be described by a directed line segment giving the direction and the speed of the motion. The vector-valued function so constructed is called the velocity field of the liquid (see Fig. 9-8). More generally, the directed line segment associated with the point p in the domain of V may have its initial point not at p, but at some other point determined by p. As an example of this, let g be a vector-valued function defined on an interval as; t S; b, and whose endpoint describes a curve. Its derivative, g'(t), is a vector which we may represent by the directed line segment whose initial point is the point g(t) lying on the curve; this gives the customary picture of a curve and its tangent vectors (Fig. 9-9). All the results dealing with differentiation of functions and transformations, presented in Chaps. 3 and 7, can be reinterpreted in terms of vectors when limited to 3-space, but the more general treatment is needed for functions of more than three variables. If F is a (scalar)-valued function of three variables, then its differential dF can be regarded as a vector-valued function; it is DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 469 Figure 9-9 Graph of a curve and its associated tangen t vectors. (9-14) then called the gradient of F and is denoted by VF. A vector-valued function T can be interpreted as a transformation of 3-space into itself. The differential dT of T is a matrix-valued function. Thus, the\" derivative\" of a scalar function is a vector function, and the\" derivative\" of a vector-valued function or vector field is a matrix-valued function. We put some of this in traditional vector form. Definition 7 Iff is ~fclass C, then its gradient is the vector-valued function grad (.f) = fli +f2j + f3 k = of i + of j + of k ox oy oz = Vf In explanation of the last symbol, V is to be thought of as the vector differential operator V .0 .0 k O =1 +J-+- ox oy oz The gradient off at a point p may be represented by a directed line segment with initial point at p. If we take any unit vector then (9-15 ) The differential of f (see Sec. 7.4) was (f1'/2 '/3], so that the expression in (9-15) is the same as the value of the directional derivative off at p in the direction (b l , b2 , b3 ). If v is any vector, and b is a unit vector, then v· b = IvIcos 0 is the component of v in the direction b (see Fig. 9-10). Its greatest value is IvI and is obtained when b is parallel to v. Applying this remark to the present case, we see that the gradient off at p is a vector whose component in a general direction b is the derivative off at p in the direction b; accordingly, the gradient itself points in the direction of greatest increase off, its magnitude is the value of this directional derivative, and it is normal to the level surface off at p (Exercise 11). DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 471 Definition 9 if V = Ai + Bj + Ck where A, B, and Care (scalar)functions of class C defined in a region n, then the curl of V is the vector-valued function: (9-17 ) curl (V) = (C 2 - B3 )i + (A 3 - Cdj + (B I - A2 )k = (OC _ OB)i + (OA _ ~.~)j+ (~1!_~~)k oy oz oz ox ox oy =VxV The last expression is to be regarded as a convenient formula for the curl of V and may be written as j k VxV= 0 0 0 .. - ox oy OZ A B C The invariant nature of this will also be shown later on. Many of the most important postulates of physical theory find their simplest statements in vector equations. To cite only one example, one form of the Maxwell equations is: (9-18) div (E) = p div (H) = 0 oH curl (E) = - ot curl (H) = 4n(J + ~~) One of the chief tools in the use of vector analysis in such applications is a knowledge of certain standard identities. In the list below, we give a number of these. All can be verified directly by substitution and computation. If a = ali + a 2j + a 3 k, b = bli + b2j + b3 k, and c = cli + C2j + c3k, then (9-19) (9-20) (a x b) . c = (b xc) . a = (c x a) . b a l a 2 a 3 = b l b2 b3 CI C2 C3 a x (b x c) = (a· c)b - (a· b)c Iff is a scalar function of class en, then (9-21 ) (9-22) curl (grad (.f)) = V x Vf = 0 div (grad (f)) = V . Vf = V 2f o2f o2f o2f = .... +--+- ox 2 oy2 OZ2 472 ADVANCED CALCULUS If V = Ai + Bj + Ck is a vector field with components of class C, then (9-23 ) (9-24) div (curl (V)) = V· (V x V) = 0 curl (curl (V)) = V x (V x V) = V(V\" V) - [V 2 Ai + V 2Bj + V 2Ck] = grad (div (V)) - V 2V If F and G are both vector-valued functions of class C, then (9-25) div (F x G) = V . (F x G) = G . (V x F) - F \" (V x G) Let us now compare the system of vector analysis, as sketched above, with the system of differential forms in three variables. We notice first that there is a certain formal similarity between the multiplication table for the vector units i, j, k given in (9-10) and (9-11) and the corresponding table for the basic dif- ferential forms dx, dy, and dz given in (9-6) and (9-7). In the latter, however, we do not have the identification dx dy = dz which corresponds to the relation i x j = k. This suggests that we correspond elements in pairs: dx \"-I dy dz dy \" dz dx- J dz -k dx dy To complete these, and take into account O-forms and 3-forms, we adjoin one more correspondence: 1 -1 dx dy dz With these, we can set up a 2-to-l correspondence between differential forms and vector- and scalar-valued functions. To any I-form or 2-form will corre- spond a vector function, and to any O-form or 3-form will correspond a scalar function. The method of correspondence is indicated below: A dx + B dy + C dz\\ _ Ai + B\" + Ck A dy dz + B dz dx + C dx dyl J f(x, y, z)\\ f( ) f(x, .1', z) dx dy dzl- x, y, z In the opposite direction, we see that a vector-valued function corresponds to both a I-form and a 2-form, and a scalar function to a O-form and a 3-form. To see the effect of this relationship, let V = Ai + Bj + Ck and W = ai + bj + ck Corresponding to V, we choose the I-form v = A dx + B dy + C dz (9-26) DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 473 and corresponding to W, both the I-form and the 2-form w = a £Ix + b dl' + c dz w* = a dl' dz + b dz £Ix + c £Ix dl' As shown in Exercises 9 and 10, Sec. 9.2, vw = I: ;Idl' dz + I; :Idz £Ix + I: ~I£Ix dl' vw* = (aA + bB + cC) £Ix dl' dz Reversing the direction of correspondence, and comparing these with (9-12), we see that vw corresponds to V x Wand vw* to V . W. So a single notion of multiplication among differential forms corresponds both to the inner product and the cross product among vectors. What vector operations correspond to differentiation of forms? Let us start with a scalar function j; go to the corresponding O-form I, and apply d. We obtain the I-form elI=II £Ix + I2 dl' + I3 dz which in turn corresponds to the vector function II i + I2 j + I3 k, the gradient off Again, let us start from a vector-valued function V = Ai + Bj + Ck go to the corresponding I-form w = A £Ix + B dl' + C elz, and again apply d. We obtain a 2-form which was shown in Exercise 14, Sec. 9.2, to be dw = (C2 - B3) dl' dz + (A 3 - Cd dz £Ix + (B I - A 2) £Ix dy Upon comparing this with (9-17), we see that this corresponds to the vector function curl (V). Finally, if we correspond to V the 2-form w* = A dl' dz + B dz £Ix + C £Ix dy, and apply £I, we obtain the 3-form (A I + B2 + C 3) £Ix ely dz, which corresponds in turn to the scalar function div (V). Briefly, then, the single operation of differentiation in the system of differential forms corresponds in turn to the operations of taking the gradient of a scalar and taking the curl and the divergence of a vector. This is indicated schematically in Fig. 9-11. f ) f -. df ) grad (n Scalar O-form I-form vector function function w dw curl (V) ~-form 2-form vector function V vector function ________ dw. div (V)w 2-form 3-form scalar function Figure 9-11 474 ADVANCED CALCULUS Some of the identities in the list given earlier correspond to simple state- ments about forms. Theorem 3 If w is any differential form of class en, then ddw = 0. This holds in general when w is a k form in n variables. We shall prove it when w is a I-form in three variables. Let w = A(x, y, z) dx. Then aA aA aA dw=d(A)dx=-dxdx+ dydx+ a- dzdx ax ay z and aA aA . - dy dx +- dz dx ay az ddw = d (aA) dy dx + d (aA) dz dx ay az a 2 A a 2 A = --- dz dy dx + -- dy dz dx = ° az ay ayaz using the equality of the mixed derivatives and the fact that dydzdx= -dzdydx A similar argument holds for B dy and C dz. I (See also Exercise 18.) Using the relations shown in Fig. 9-11, we see that the statement ddf = 0, holding for a O-form f, corresponds to the vector identity curl (grad f) = ° [see (9-21)] and the statement ddw = 0, holding for a I-form to the vector identity div (curl V) = °[see (9-23)]. Our final connections between vector analysis and differential forms will be made by relating the integral of a form to integrals of certain scalar functions which are obtained by vector operations. Theorem 4 Let F = Ai + Bj + Ck define a continuous vector field in a region n of space, and let w = A dx + B dy + C dz be the corresponding I-form. Let 'J' be a smooth curve lying in n. Let F T be the scalar junction defined on the trace of y whose value at a point p is the component of F in the direction of the tangent to y at p. Then, r F T ds = r w = r (A dx + B dy + C dz) • y • y • y The first integral is the integral of a numerical-valued function along the curve y, as discussed in Sec. 8.6. It should be noticed that the function F T is defined only for points on I\"~ although F is defined throughout n. We may assume that \" is parametrized by arc length, so that the tangent and DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 475 vector to y at p = y(s) is v= y'(s) and Ivl = 1. The component of F along v is then FT=F'v ( . k) (dX dy. dz k) = Ai + BJ + C . ds i + J; J + ds dx dy dz = A- + B-- + C -- ds ds ds . .1 (dX dy dZ) 1 F T ds = I A - + B - + C -- ds • y • 0 ds ds ds Comparing this with the definition of the integral of a I-form (9-4), we see that r F T ds = r w I • y • y The situation for integrals of 2-forms is similar. Theorem 5 Let F = Ai + Bj + Ck define a continuous vector field in a region n, and let w = A dy dz + B dz dx + C dx dy be the corresponding 2-form. Let L be a smooth surface lying in n. Let F N be the scalar function defined on the trace of L whose value at a point p is the component of F in the direction of the normal to L at p. Then JJ F N dA = IJw = IJ(A dy dz + B dz dx + C dx dy) ~ ~ ~ Let L have domain D in the (u, v) plane. By (8-47), the normal to L at the point p = L(U, v) is n(u v)= (~(~~:l a(z,x) a(x,y)) , a(u, v)' a(u, v)' a(u, v) so that the normal component of F at p is A ~(y~) + B ~.~~+ C a(x, y) F _ ~~!! _ a(u, v) a(u, v) a(u, v) N - Inl - In(u, v)1 Thus, according to the definition given in (8-58), JJ FN ciA = JJFN(L(U, v)) In(u, v)1 du dv ~ D _ 1'1' ( a(y, z) a(z, x) C a(x, y)) d d- A--+B--+ --- u v .. a(u, v) a(u, v) a(u, v) D 476 ADVANCED CALCULUS Using Theorem 1, Sec. 9.2, this may be written as JJ F N dA = JJ A dy dz + B dz dx + C dx dy = JJ w I I: I: I: To show how such integrals arise, let V be the vector-valued function which describes the velocity field of a liquid which is flowing throughout a region n, and let F = pV, where p is the scalar function which gives the density distribution of the liquid in n. Let L be a smooth orientable surface (for example, a portion of the surface of a sphere) lying in n. At any point on L, F N measures the rate of flow of mass across L in the direction of the normal. The integral rf F N dA is then the total mass of fluid which passes through L, per . I: unit time. Again, let y be a smooth curve lying in n. At a point lying on y, VT is the component of the velocity of the fluid taken in the direction of the tangent to y. The integral f VT ds is then a measure of the extent to which the y motion of the fluid is a flow along the curve y. If y is a closed curve, then f VT • y is called the circulation around y. Integrals of the same sort also arise in mechanics, especially in connection with the notion of work, in thermodynamics, and in electromagnetic theory. (See J. C. Slater and N. H. Frank, \"Introduction to Theoretical Physics,\" 1974; J. A. Stratton, \"Electromagnetic Theory,\" 1941; and P. M. Morse and H. Feshbach, \"Methods of Theoretical Physics,\" 1953, all published by McGraw-Hill Book Company, New York.) EXERCISES I Let a = 2i - 3j + k, b = i - j + 3k, e = i - 2j. Compute the vectors (a x b) . e, a x (b x c), (a x b) x e, a x (a x b), (a + b) x (b T c), (a· b)e - (a· e)b. 2 If a, b, and e are position vectors, show that the vector n = a x b + b x e + e x a is a normal to the plane through the points a, b, e. 3 Three points Pj = (x j ' Yj' Zj) which do not lie in a plane through the origin determme a trihedral-- -with sides Op\" 0P2' Op, which has positive orientation if and only if Using this, show that the vectors a, b, and a x b form a trihedral having positive orientation, unless a and b are parallel. 4 Given vectors a and b, and a real number k, when is there a vector v such that a x v = band a • v = k? DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 477 5 Define a sequence of vectors {P.} by PI = a, P2 = i, P, = a x i, P4 = a x P\" and in general, P.+ I = a x P.· What is the ultimate behavior of the sequence? 6 If f and g are vector-valued functions of a single variable, show that d (f. g) = (~f) . g+ f. (~g) dt dt dt and Ii (f x g) = (d f) x g+ f x (~g) dr dr dr 7 If f is a vector-valued function of one variable, and If(t)1 = 1 for all r, show that f(r) and f(r) are always orthogonal. Does this have a simple geometric interpretation? 8 Show that the curvature of a curve y at the point y(c) is I/(c) x y\"(c)1 k = ------ I/(cll' 9 Show that the normal to the surface r can be defined by [see (8-47)) 10 Let P = (x, y, z) and r = Ipl. Find the gradient of the functions r 2 , r, l/r, rm , and log r. II Show that the gradIent vectors for f are orthogonal to the level surfaces f(x, y, z) = c '12 Let A be the square matrix [au] and let B be a nonsingular matrix. Set A * = B- IAB. Show that the trace of A (the sum of the diagonal entries) is the same as that of A*. 13 Verify identities (9-19) and (9-20). 14 Verify identities (9-21) and (9-23). 15 (a) Verify identity (9-22). (b) Show that iff and 9 are scalar functions of class C, then 16 Verify (9-24). 17 Verify (9-25). 18 Prove Theorem 3 when w is a O-form, and when w is a 2-form in four variables. 19 Show that div (gradf x grad g) = O. 20 Let a = (aI' a2. a,), b = (b l, b2, b,), and c = (c l , C2• c,) be three vector functions defined in n. Put Cl = I a; dx i , P= I bi dx i • Y = I Ci dx i , and show that ClPy = {(a x b)' c} dx, dX 2 dx, [see (9-19)). 9.4 THE THEOREMS OF GREEN, GAUSS, AND STOKES The important theorems which form the subject of this section deal with relations among line integrals, surface integrals, and volume integrals. In the language of general differential forms, they connect an integral of a differential form w with an integral of its derivative dw. The theorems named in the title of the section are the special cases in 3-space of what is called the generalized Stokes' theorem, which takes the following form. 478 ADVANCED CALCULUS Theorem 6 Let w be a k form defined in an open region Q of n space, and let M be a suitably well-behaved k + l~dimensional surface (manifold) in Q. Then, (9-27) f ... JJ w = J... JJ dw M where the integral on the left is kjold, and that on the right is k + I-fold. If n = 2, and k is chosen as 1, Theorem 6 becomes: Green's Theorem Let D be a suitably well-behaved region in the plane whose boundary is a curve aD. Let w be a ljorm of class C' defined in D. Then, (9-28) f'DW= JJ dw C D If n = 3 and k IS chosen first as 1 and then as 2, Theorem 6 becomes In turn: Stokes' Theorem Let L be a suitably well-behaved orientable surface whose boundary is a curve aL. Let w be a ljorm of class C' defined on L. Then Divergence Theorem (Gauss) Let R be a suitably well-behaved region in space whose boundary aR is a surface. Let w be a 2:form of class C' defined on R. Then JJw = fJJ dw ('1R R The qualification\" suitably well behaved\" which occurs in each statement is inserted to indicate that it is convenient to impose some restrictions upon the regions, surfaces, and curves on which the integration is carried out. The exact nature of these restrictions is chiefly dependent upon the tools which are employed to prove the theorem. In most of the simpler applications of these theorems, one encounters only the nicest of curves and surfaces; for these, the proofs which we shall give are sufficient. Let us begin by proving a special case of Green's theorem. 480 ADVANCED CALCULUS On r2' the upper part of aD, y = g(x) and x goes from b to a. Thus, w = A(x, g(x)) dx and • • a • b I w = I A(x, g(x)) dx = -I A(x, g(x)) dx • Y2 • b • a On the vertical parts of aD, if any, w = O. Adding, we find r W= r Adx= ([A(X,f(X))-A(X'9(X))]dX • rD • iJD • a On the other hand, dw = d(A(x, y) dx) = A 2 (x, y) dy dx, so that rr dw = rr A 2(x, y) dy dx \". ... D D = - JJ A 2 (x, y) dx dy D b g(x) = - J dx J A 2(x, y) dy a f(x) b = - r [A(x, g(x)) - A(x,f(x))] dx • a Comparing the two results, we have r w = Jr dw. A similar computation, • iJD • D using (9-30), shows that the same relation holds if w = B(x, y) dy, and adding these, we obtain the formula for a general I-form. I In generalizing this theorem, we first remark that the proof used only the fact that D could be described both in the form (9-29) and in the form (9-30). Such regions need not be convex, as is shown by the region given by: x 2: 0, Y :::; x 2 , y 2: 2x 2 - 1. For such regions, we shall use the term \"standard region.\" Suppose now that D is itself not standard, but is the union of a finite number of standard regions such as shown in Fig. 9-13. Green's theorem holds for each of the regions Dj so that LD W = JJ dw J Dj and adding, we have r w + r w + ... + r w = JJ dw + JJ dw + ... + JJ dw • iJD, • iJD2 • rD. D, D 2 D. = JJ dw D DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 483 Suppose we compare (dw)* and d(w*). d(w*) = 2(3u 2v du + u3 dv + v2 du + 2uv dv) du + (2uv du + u2 dv + 2v dv) dv = 2(u3 + 2uv) dv du + (2uv) du dv = (2u3 + 4uv - 2uv) dv du = (2u3 + 2uv) dv du On the other hand, we have dw = d(xy dx) = d(xy) dx = (x dy + y dx)(dx) = x dy dx and applying T*, we have T*(dw) = (dw)* = (u 2 + v)(dv)(2u du + dv) = 2u(u 2 + v) dv du which agrees with d(w*); (dw)* = d(w*). The next theorem proves that this is true in general. Theorem 8 If w is a differential form of class C', then (9-31 ) T*(dw) = (dw)* = d(w*) = dT*(w) Let T be a transformation of class C\" from (u, v) space into (x, y, z) space, described by !x=<p(u,v) \\. y = t/J(u, v) jz=lJ(u,v) In the same fashion as before, we may use T to transform differential forms in the variables x, y, z into forms in u, v, and we shall use w* to denote the form obtained by transforming w. To begin with, suppose that w is a O-form /(x, y, z). Its transform w* will then be the O-form w* = f*(u, v) = /(<p(u, v), t/J(u, v), lJ(u, v)) Differentiating this, we obtain the I-form If we differentiate w bl!fore transforming, we obtain the I-form dw = fl dx + f2 dy + /3 dz and the transform of this is the I-form (dw)* = fd<pI du + <P2 dv) + f2(t/JI du + t/J2 dv) + /3(lJ I du + lJ2 dV) = (f1<PI + /2t/JI + f3 lJd du + (f1<P2 + f2t/J2 + /3 lJ2)dv 484 ADVANCED CALCULUS This agrees with the expression for d(w*), and we have shown that the relation d(w*) = (dw)* holds for O-forms. Let us suppose now that w is the I-form A(x, y, z) dx. Its transform will be the I-form w* = A[<PI du + <Pz dl'] = A<PI du + A<P2 dl' Differentiating this, we obtain the 2-form d(w*) = fa~(A<PI) du + :l' (A<Pd dl' ~du + f1u (A<P2) du + :l' (A<P2) dl' ~dl' r:u (A<P2) - :l' (A<Pd1du dl' r 8A 8A I [A<PlZ + <Pz 8~ - A<P21 - <PI al' J du dl' = f<PZ ~~- <PI ~~1du dl' making use of the fact that T is of class C' and thus <P12 = <P21' We compute 8Ajau and 8Aj8l' by the chain rule. 8A au = AI<PI + Az!/JI + A 3 81 8A a; = A I <P2 + Az!/Jz + A 3 8z so that Thus If, on the other hand, we differentiate w before transforming, we have dw = (AI dx + Az dy + A 3 dz) dx = Az dydx + A 3 dzdx DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 485 If we transform this, and use Theorem 1, we have so that dy dx = aev.~)du dv = /l/J 1 a(u, v) ¢1 dz dx = ~.:~xldu dv = Ie 1 a(u, v) ¢1 (dw)*=J A2 !l/Jl l/J2!+ A 3 I e1 e21}dUdV \\ ¢1 ¢2 ¢1 ¢2 Since this agrees with the expression for d(w*), we have shown that d(w*) = (dw)* holds when w = A(x, y, z) dx. A similar computation shows that the relation is valid also for the I-forms B dy and C dz, and we have thus shown that it holds for any I-form. A comparable direct verification may also be made when w is a 2-form such as A(x, y, z) dy dz. Rather than carry this out, we shall use an inductive method which proves the theorem for differential forms in n variables. We make use of two special formulas. Forms are transformed by T by replacing x, y, z, ... wherever they occur by ¢, l/J, e, ... , and then simplifying the result by means of the algebra of forms. Thus, if r:x and f3 are any two forms, then (9-32) T*(r:xf3) = (r:xf3)* = r:x*f3* = T*(r:x)T*(f3) The second formula expresses the manner in which the differentiation operator acts on products of forms. Lemma 1 If r:x is a k form and f3 any differential form, then (9-33 ) d(r:xf3) = (dr:x)f3 + (- Itr:x(df3) We prove this by induction on the dimension of r:x. Suppose that r:x is a O-form, and thus r:x = A(x, y, .. .), an ordinary function, and suppose that f3 = Ba, where B is a function and a is a product of pure differentials (e.g., a = dx dz dw). Then, r:xf3 = ABa, and d(r:xf3) = d(AB)a = {(Ax B + ABx) dx + (A yB + ABy) dy + .. ·}a = (AxB dx + AyB dy +. ··)a + (ABx dx + ABy dy + ···)a = (Ax dx + Ay dy + .. ·)Ba + A(Bx dx + By dy + .. ·)a = (dA)(Ba) + A(dB)a = (dr:x)f3 + r:x(df3) verifying (9-33) for the case when r:x is a O-form. We now verify (9-33) if r:x is the I-form dw (or any other single basic differential). As before, take 486 ADVANCED CALCULUS fJ = B(J, where (J is a product of basic differentials. Then, afJ = (dw)B((J) = B(dw)((J), and d(afJ) = (dB)(dw)((J) = (B x dx + By dy + .. ·)(dw)((J) = - (dw)(B x dx + By dy + .. .)((J) = - (dw)(dB)((J) = - a(dfJ) But, this verifies (9-33) for this case, since k = 1 and da = d(dw) = o. More generally, if a = A dw, then afJ = AB(dw)((J), d(afJ) = d(AB)(dw)((J) = [(dA)B + A(dB)](dw)((J) = (dA)B(dw)((J) + A(dB)(dw)((J) = (dA)(dw)B((J) - A(dw)(dB)((J) Thus, (9-34) d(afJ) = (da)fJ - a(dfJ) as required by (9-33). Knowing that (9-33) holds for k = 0, 1, we use induction to complete the proof. Assume now that (9-33) has been verified when a is any differential form of dimension less than k, and let a be a k form. We may suppose that a = y dw, where y is a form of dimension k - 1, and where dw is one of the basic differentials present in a. Then, by the inductive assumption, da = d(y dw) = (dy) dw + (- I t-1y d(dw) = (dy)(dw) + 0 = (dy)(dw) Also, for any form fJ, we have, from (9-34), (9-35) d((dw)fJ) = d(dw)fJ - (dw)(dfJ) = 0 - (dw)(dfJ) = - (dw)(dfJ) Finally, afJ = (y dw)fJ = y((dw)fJ), so that, again by the inductive as- sumption and (9-35), d(afJ) = (dy)(dwfJ) + (_I)k-l y d((dw)fJ) = (dy)(dw)fJ + (_I)k-l( -1)y(dw)(dfJ) = (da)fJ + (-lta(dfJ) which is (9-33). I With this lemma established, we complete the proof of Theorem 8. Suppose we know that the relation (9-31) holds if w is either of the dif- ferential forms a and fJ; we will show that it also holds if w = afJ. By (9-32), w* = a*fJ*. Since (9-31) holds for a and fJ, d(a*) = (da)* and d(fJ*) = (dfJ)*. DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 487 Using these, together with the lemma, we have d(w*) = d(a*fJ*) = d(a*)fJ* + (-l)k a* d(fJ*) = (da )*fJ* + (- 1fa*(dfJ)* = [(da)fJ]* + [(-l)k a(dfJ)]* = [(da)fJ + (-l)k a(df3)]* = [d(afJ)] * This shows that if (9-31) holds for any two differential forms w, it holds for their product. Since it holds for O-forms and for the basic I-forms dx, dy, dz, etc., and since any differential form is built from these by multi- plication and addition, (9-31) holds for any choice of w. I Having shown that differentiation of differential forms commutes with the substitution operator T*, we at once obtain a useful extension of Green's theorem, which will be a guide for other extensions of various forms of the generalized Stokes' theorem. Theorem 9 Let T be a transformation which is 1-to-1 and of class C in a closed bounded region D, mapping D onto D*. Then, if Green's theorem holds for D, it holds for D*. We take D as a set in the (u, v) plane whose boundary is a curve y. T carries D into the set D* in the (x, y) plane, and y into the boundary y* of D*. Let w be any I-form in the (x, y) plane of class C, and let T transform w into the I-form w*. T will also transform the 2-form dw into a 2-form (dw)* in u and v. The results in Sec. 8.3 dealing with transforma- tion of integrals give at once the formulas (9-36) r w* = f w • y • y* JJ (dw)* = JJ dw D D' By assumption, Green's theorem holds in D; thus, applying it to the I-form w*, (9-37) rw* = rr d(w*) 'y 'n By the fundamental relation (9-31), d(w*) = (dw)*. Combining this with (9-36) and (9-37), fy,w = Jyw* = JJ (dw)* = JJ dw D D' and Green's theorem holds for D*. I 488 ADVANCED CALCULUS This same technique gives another proof of the formula for change of variable in double integrals in a more general form. Theorem 10 Let T be a transformation of class en defined by x = 4>(u, v), y = t/J(u, v), mapping a compact set D onto D*. We assume that D and D* are finite unions of standard regions and that T is I-to-I on the boundary of D and maps it onto the boundary of D*. Let f be continuous in D*. Then, \\ \"f r\" 8(x y)\" f(x, y) dx dy = . .1 I(4)(u, v), t/J(u, v)) 8(u: v) du dv D' D As we have seen in Sec. 8-3, the difficult step is to show that this holds when I(p) is constantly I: rr dx dy = A(D*) = rr 8((X,Y)) du dv \"\" \"\" 8 u, V D' D Consider the special I-form w = x dy. This is chosen because dw = dx dy, so that by Green's theorem, A(D*) = rrdw = r w \". \"i'D' D' Writing this as an ordinary singlefold definite integral, and applying the formula for change of variable in this case (Sec. 4.3, Theorem 8), we obtain A(D*) = r w* \" oD Applying Green's theorem to D, and the fundamental invariance relation (9-31), we have A(D*) = JJ d(w*) = JJ (dw)* D D Since dw = dx dy, (dw)* = d4> dt/J = 14> I 4>2 1du dv = 8(.x-, y) du du. I t/JI t/J2 8(u, v) We note that this form of the change-of-variable theorem is in certain respects more general than that obtained in Sec. 8.3. Here, the Jacobian of T is not required to have constant sign, provided that the integral for A(D*) is understood to be an oriented integral. To offset this, the transformation Twas required to be of class C'. DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 489 Next, we proceed to give a proof of Stokes' theorem by reducing it to an application of Green's theorem. Theorem 11 Let l: be a smooth surface of class C' whose domain D is a standard region, or a finite union of standard regions, in the U V plane. Let w = A dx + B dy + C dz where A, B, and C are of class C on l:. Then, . \"1' (OC OB) (OA OA)I A dx + B dy + C dz = - - - dy dz +- - - - dz dx . f'\"f. • • oy oz oz ox \"f. The line integral on the left is r w, while the surface integral on the 'c\"f. right is r,. dw. It should be noticed that this becomes Green's theorem •• \"f. if the surface l: is taken as the region D in the X Y plane; C =°and dz = 0, so that the differential form in the right-hand integral becomes (oB/ox - oA/oy) dx dy. The proof of the theorem is almost immediate. By assumption, l: is described by a set of equations x = ¢(u, v), y = t/J(u, v), z = 8(u, v) for (u, v) E D which define a transformation of class C. More- over, D is a region to which Green's theorem applies. If we use the transformation l: to transform w, we obtain a I-form w* in u and v. Applying the method used in Theorem 9, Green's theorem in D, and the fundamental relation (9-31), we have r w = r w* = rr d(w*) = rr (dw)* = rr dw 'c\"f. • cD Ii ii 'i which, as we have seen,.. is the conclusion of Stokes' theorem. I By allowing D to be a union offinite number of standard regions, we admit surfaces l: which may have a finite number of \"holes\" (see Fig. 9-15). In computing r w, we must of course integrate around all the separate curves • (\"lr which compose the boundary of l:, each in its proper orientation. The theorem may also be extended to a surface (differentiable manifold) which is obtained by piecing together simple surface elements; however, it is necessary that it be orientable. The Mobius strip is a nonorientable manifold M which can be DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 493 Divergence Theorem Let R be a suitably well-behaved region in space whose boundary is a surface oR. Then JfJ div (F) = JJ F N R f1R Stated verbally: The integral of div (F) throughout R is equal to the integral of the normal component of F over the boundary of R. Stokes' Theorem Let L be a suitably well-behaved orientable surface whose boundary is a curve OL. Then, Stated verbally: The integral of the normal component of the curl of F over a surface is equal to the integral of the tangential component of F around the boundary of the surface. These may be used to obtain physical interpretations for div (F) and curl (F). As in Sec. 9.3, let V be the velocity field of a fluid in motion, and let p be the density function; both may depend upon time. Let F = pV; this is the vector function which specifies the mass flow distribution. Let R be a closed bounded region of space to which the divergence theorem applies, e.g., a cube or a sphere. At any point p on the boundary of R, F N is the normal component of F, and therefore measures the rate of flow of mass out of R at p. The surface integral ff FN is then the total mass per unit time •• oR which leaves R through oR. Let us suppose that there is no creation or destruction of mass within R, i.e., no \"sources\" or \"sinks.\" Then, fJ F N oR must also be exactly the rate of decrease of the total mass within R: JJFN = - ~JJJ P r'R R If we apply the divergence theorem to the left side, and assume that op/ot is continuous so that we can move the time differentiation inside, we obtain f'f \"fop..I. div (F) = -.1.1. at R r Since this relation must hold for all choices of R, we may conclude that the integrands are everywhere equal. Thus, we arrive at what is called the \"equation DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 495 angular velocity w about a fixed axis b, then curl (V) = 2wb. The motion of a fluid is said to be \"irrotational\" if curl (V) == O. We may also use the integral theorems to arrive at expressions for div (F) and curl (F) having a form which is free of the coordinate appearance of the original definitions for these quantities. By the same line of argument that has been used above, one may arrive at the formulas div (F) I = lim _(I) ff F N Po riO V R . cR curl (F) I . b = lim ~~_I-f FT Po rIPoA(I:) i'r where v(R) is the volume of Rand A(I:) the area of I:, and R and I: are thought of as closing down on the point Po in such a fashion that the normals to I: are always parallel to b, and Stokes' theorem and the divergence theorem always apply. Line integrals also arise in another natural way. Let F be a vector-valued function which describes a force field throughout a region of space. The work done by the force in moving a particle along a curve y is defined to be the value of the line integral In particular, if y is a closed path which forms the boundary of a smooth orientable surface I:, then we may apply Stokes' theorem, and obtain w = JJcurl (F)N r If F should be such that curl (F) == 0, then W = O. In this case, the work done by F around any such closed path is O. Such force fields are given the name conservative; an example is the newtonian gravitational field of a particle. EXERCISES I Verify Green's theorem for w = x dx + xy dy with D as the unit square with opposite vertices at (0,0), (I, I). 2 Apply Green's theorem to evaluate the integral of (x - .1'3) dx + x 3 dy around the circle x 2 + .1'2 = I. 3 Verify Stokes' theorem with w = x dz and with 1: as the surface described by x = UL', Y = U + L', Z = u2 + ['2 for (u, 1') in the triangle with vertices (0, 0), (1,0), (I, I). 4 Carry out the details needed to show that the special case of Green's theorem stated in Theorem 1 holds for w = B(x, .1') dy. 496 ADVANCED CALCULUS 5 Prove the divergence theorem directly when R is the solid sphere x 2 + y2 + Z2 S I 6 (a) Show that the area of a region D to which Green's theorem applies may be given by A(D) = ~ f (x dy - y dx) • CD (b) Apply this to find the area bounded by the ellipse x = a cos (J, y = b sin (J, as (J s 2n. 7 Use Exercise 6 to find the area inside the loop of the folium of Descartes, described by x = 3at/(1 + t3 ), Y = 3at 2/(1 + t 3 ). 8 Let D be the region inside the square Ix I + Iy I = 4 and outside the circle x 2 + y2 = 1. Using the relation in Exercise 6, find the area of D. 9 Find a I-form w for which dw = (x 2 + y2) dx dy, and use this to evaluate fJ(x 2 + y2) dx dy D when D is the region described in Exercise 8. 10 Show that the volume of a suitably well-behaved region R in space is given by the formula v(R) = 1ff x dy dz + y dz dx + z dx dy ,'R II (a) Show that the moment of inertia of a solid R about the z axis can be expressed in the form 1= (i) JJ (x 3 + 3xy 2) dy dz + (3x 2y + y3) dz dx fR (b) Use this to find the moment of inertia of a sphere about a diameter. 12 Verify the invariance relation (dw)* = d(w*) when w = x dy dz and T is the transformation x = u + v - w, y = u2 - v2 , Z = V + w2 • 13 Assuming Green's theorem for rectangles, prove it for a region of the type described by (9-29) with w = A(x, y) dx by means of the transformation x = u, y = j(u)v + g(u)(1 - 1'), a sus b, a s v s 1. 14 Verify the differentiation formula (9-33) when IX and p are a-forms in x, y, z. 15 Verify (9-33) for IX = A(x, y, z) dz and p= B(x, y, z) dy. 16 Let V be the velocity field of the particles of a rigid body which is rotating about a fixed axis in the direction of the unit vector b, at an angular velocity of w. Show that div (V) = a and curl (V) = 2wb. 17 Using n for a general normal vector on a surface and T for a general tangent vector to a curve, Stokes' theorem and the divergence theorem may be expressed by ff(VxF)'n=I' F·T .. . ol JJJ V . F = JJ F . n R f~R When D is a region in the plane, and 'I and T are used for the (outward) normal vector and the tangent vector for the curve aD, and when F = Ai + Bj is a vector field in the plane, DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 497 show that Green's theorem may be put into either of the forms I'I'V' F= I' F''l \" 'cD D rr (V x F) . k = r F' T .~ • cD 18 Assuming the truth of the generalized Stokes' theorem, as given in (9-27), show that it results In the following special formulas dealing with differentlal forms in 4-space: (a) If M IS a regIOn In 4-space, and aM is Its three-dimensIOnal boundary, then JJJ {A dy dz dw + B dx dz dw + C dx dy dw + D dx dy dz} \" JaA aB ac aDl = II rr \\ - +- + ~.. + -- dx dy dz dw .... lax ay az aw M (b) If ~ is a two-dimensional surface in 4-space bounded by a curve a~, then r {A dx + B dy + C dz + D dw} • f~I: ~( aB aA) (ac aA) (aD aA)= rr - dx dy +-- - - dx dz + - - - - dx dw ~ ~ ~ ~ ~ ~ ~ + (a~_ aB) dy dz + (aD _ i3!!) dy dw + (i!!! _ac) dz dwl ay az ay aw az aw I 19 Use (9-33) to give an inductive proof that ddw = 0 for any k form in n variables, 9.5 EXACT FORMS AND CLOSED FORMS In this section, we discuss the special properties of certain differential forms which are important for both their physical and mathematical significance. We start with I-forms. Definition 10 We say that a I-form w is exact in an open set n if there is a function f, at least of class C' there, such that df = w everywhere in n. For example, w = 3X 2y 2 dx + 2x 3y dy is exact in the entire plane, since it coincides there with d(x 3y2). On the other hand, the following simple result enables us to decide at once that w = l dx + x 2 dy is not an exact form. Theorem 14 If w is an exact I-form in n whose coe./jicients are at least of class C' there, then a necessary (but not sufficient) condition is that dw = 0 in n. 498 ADVANCED CALCULUS This follows at once from Theorem 3. For if f is defined in nand 4f = w, then dw = ddf = O. I (The fact that this criterion is not sufficient will be shown later.) The condition dw = 0 is often written in an expanded form that depends on the nature of w. Thus, if we are dealing with I-forms in the plane, and w = A dx + B dy, then w cannot be exact in a set n unless (9-39) oA oB oy ox in n Likewise, in 3-space, if w = A dx + B dy + C dz, then w cannot be exact in n unless (9-40) OC oB oy oz oA OC oz ox oB oA ox oy [These follow at once merely by calculating dw in each case.] Since these conditions arise frequently and are important to the theory, a special name is applied. Definition 11 A Ijorm w of class C is said to be closed in a region n if dw = 0 everywhere in n. The meaning of this [and a reason for the choice of the name] will appear later. Theorem 14 can thus be restated: Any I-form that is exact in n must be closed in n. There is also a connection between exactness and integration. Theorem 15 Let w be exact in n, with w = df, and let y be any smooth curve in n, starting at PI and ending at P2' Then I P2 f W = f df = f = f(P2) - f(pd Y • Y PI Suppose we are dealing with I-forms in 3-space, and suppose that y is given by x = ¢(t), y = t/f(t), z = 8(t), for 0 ~ t ~ 1. Since w = df, w = fl(x, y, z) dx + f2(X, y, z) dy + f3(X, y, z) dz so that on y, w = {fl(y(t))¢'(t) + f2(y(t))t/f'(t) + f3(y(t))8'(t)} dt But, this can also be written as d w = - {f(y(t))} dt dt so that DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 499 • .1 d .I y W = .1 0 at {f(y(t))} dt = f(y(I)) - f(y(O)) = f(P2) - f(pd I Corollary If w is an exact I-form in a region n, then r w = ° for every • y closed I' lying in n. For, if I' is closed, then P2 = PI' andf(PI) =f(P2)' I A special name is given to the type of behavior described In the corollary. Definition 12 A line integral r w is said to be independent of path in a • y region if its value is the same along any other curve lying in n which joins the same points (in the same order). Equivalently, f w = °for every closed curve • y I' lying in n. The equivalence arises from the fact that if 1'1 and 1'2 are two curves lying in n which have common endpoints, then the union of 11 and - 1'2 is a closed curve lying in n. Using this terminology, the corollary above states that any exact I-form yields line integrals that are independent of path. We may use this to test a I-form for exactness. For example, w = y dx is not exact in the first quadrant, since its integral along the straight line from (0,0) to (1, I) is .1 I x dx = 1, while its integral along the parabola y = x 2 which also joins (0,0) • 0 .1 to (I, I) is I x 2 dx = j-. This would be a difficult test to apply in some cases, • 0 since it depends upon a comparison between the numerical value of line integrals. While the physical interpretation of both \"exactness\" and\" independence of path \"will be discussed in more detail later, we remark at this point that one illustration arises in the study of fields of force which have the property that the work done in moving from PI to P2 depends only upon the positions of the two points, and not upon the path chosen. The mathematical significance of these concepts focuses on the connection between being an exact form and being a closed form. We note first that exact- ness is a global property. In order to test if w is exact in n, we must examine the behavior of w everywhere in n at the same time, for there must exist a single function f, defined everywhere in n, such that dw = f; alternatively, we must integrate w over every closed curve 1 in n, both large ones and small ones. DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 501 We wish to show that w = df Computing the partial derivatives off, and using Eqs. (9-10), we have f3(X, y, z) = C(x, y, z) J2(X, y, z) = B(x, y, 0) + fZC2(X, y, t) dt ·0 = B(x, y, 0) + (B 3 (x, y, t) dt . 0 = B(x, y, 0) + [B(x, y, z) - B(x, y, 0)] = B(x, y, z) • y z fl(X, y, z) = A(x, 0,0) + I B 1(x,t,0)dt+ f C1(x,y, t) dt • 0 • 0 ~ y ~ z = A(x, 0, 0) + I A 2(x, t, 0) dt + I A 3 (x, y, t) dt • 0 • 0 = A(x, 0, 0) + [A(x, y, 0) - A(x, 0, 0)] + [A(x, y, z) - A(x, y, 0)] = A(x, y, z) I For a general region, the best that this theorem gives is the following corollary. Corollary If dw = °in an open region n, then w is locally exact in n, that is, about any point p there is a neighborhood in which w has the form w=df As the point p moves around in n, the function f may change, and it may not be possible to find a single function such that w = df throughout all of n. For example, consider the I-form (9-41) w = .._x_ dy - Y dx x2 + y2 x2 + y2 in the open ring D = {all (x, y) with 1 =s; x 2 + y2 =s; 4}. Direct computation shows that dw = °in D, so that w is locally exact in D. However, w is not exact in D, for if we compute the integral of w around a circular path, x = r cos 0, y = r sin 0, lying in D, we obtain f f2JtJ(rcoso) (rSinO).} yw = 0 \\~-;r-(r cos 0) - --r2 - (-r SIn 0) dO 2\" =f (cos 2 0+sin 2 0)dO=2n¥0 • 0 If w were exact in D, then by the corollary to Theorem 15, Jw would have to 502 ADVANCED CALCULUS be O. As we shall see later, the clue to this behavior lies in the nature of the set D. Theorem 16 shows that the condition dw = 0 in a convex region Q implies exactness, and therefore independence of path in Q. A similar technique will prove the converse, for a general region Q. Theorem 17 If w is independent of path in an open connected set Q, then w is exact in Q, and therefore obeys dw = O. Choose any point Po E Q. By assumption, Q is connected so that any point P E Q can be joined to Po by a smooth curve y lying in Q. Define a functionfin Q by settingf(p) = rw. Since w yields line integrals that are • y independent of path, it does not matter what curve y we choose, so long as it lies in Q and goes from Po to p. We again wish to show that w = df, and for this, we need the partial derivatives of.f If PI and PI + lip are points of Q, and (3 is any curve in Q from PI to PI + lip, then choosing a curve y from Po to PI' we have f(PI + lip) = r w + r w • y • f3 =f(pd+r w • f3 To computefl(pd, the partial derivative offin the direction of the X axis, we take lip = (h, 0, 0) and compute lim f(PI +~fJ)- f(pd = lim 1 f w h-O h h-O h f3 For {3, we choose the straight line from PI to PI + lip whose equation is x = XI + ht, Y = Yt> z = Zl; 0::;; t ::;; 1. If w = A dx + B dy + C dz, then on {3, w = A(x i + ht, YI, zdh dt and f(PI +Ii:)-f(pd= (A(X I +ht'YI,zddt Letting h approach 0, and using the fact that A is continuous, I fl(pd = lim r A(xi + ht, YI, zd dt h-O • 0 I = f A(x l, YI, zd dt = A(xI' YI, zd o In a similar fashion, we find f2(pd = B(pd and f3(pd = c(pd, so that w = dfin Q. I DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 505 Finally, if we use the straight line joining (0,0) and (x, y), we have .1 j(x, y) = I {2(xt)(yt)3 d(xt) + 3(xt)2(yt)2 d(yt)} • 0 .1 = I {(2 xy3)(X)t 4 dt + (3X 2y2)(y)t 4 dt] . 0 .1 = X2y3 I 5t4 dt = X2y3 • 0 When the coefficients in w have special properties, other methods may be used to find j (see Exercise 5). The study of differential equations also leads to the consideration of exact differential forms. One says that a curve')' in the plane is a solution of the first-order \"differential equation\" (9-43) A(x, y) dx + B(x, y) dy = 0 if the I-form w = A dx + B dy is 0 on y. If w is exact, and w = df, then the level curves ofj'are solutions for (9-43). An integrating factor for Eq. (9-43) is a function 9 such that gw is an exact I-form. Computing d(gw), and requiring that this vanish, one is led to a partial differential equation for g. General existence theorems in the theory of differential equations show that, provided A and B are sufficiently well behaved, Eq. (9-43) always admits integrating factors. The situation is somewhat different in the case of forms in three or more variables. A curve')' in 3-space is said to be a solution of the \"total differential equation\" (or Pfaffian equation) (9-44) A(x, y, z) dx + B(x, y, z) dy + C(x, y, z) dz = 0 if the I-form w = A dx + B dy + C dz is 0 on y. When w is exact, and has the form w = df, then any curve lying on the level surfaces ofjwill be a solution of (9-44). Since this is a very special type of possible behavior for the solution curves of such an equation, it is plausible that only certain Pfaffian equations admit integrating factors. The analysis supports this. If 9 is an integrating factor for w, then we may assume that d(gw) = O. Using the formula (9-33) for differentiating a product, we obtain, since 9 is a 0 form, (dg)w + g(dw) = 0 It is easily seen that ww = 0; thus, if we multiply this equation on the right by w, we obtain as a necessary condition g(dw)w = 0 Dividing by the function g, we obtain the condition (dw)w = O. In terms of the coefficients of w, this shows that a necessary condition for (9-44) to have an 506 ADVANCED CALCULUS integrating factor is that ( ~~_OB)A + (~..t_~~)B+ (OB_OA)C = 0 oy oz oz ox ox oy It may also be shown that if this condition holds, and one imposes reasonable restrictions on A, B, and C, then an integrating factor for (9-44) exists. The notions of exactness and of independence of path may also be given in vector form. Using the\" dictionary\" (Fig. 9-11) in Sec. 9.3, we may recast our results in the following form. Theorem 20 Let F be a vector field which is of class C\" and obeys the condition curl (F) = 0 throughout a simply connected region of space n. Then, there is a scalar function f, unique up to additive constants, such that in n F = grad (f) Moreover, ify is any smooth curve lying in nand going from Po to PI> then r F T = f(pd - f(Po) • y The function f is called the potential for the vector field F. When the condition curl (F) = 0 is translated by saying that F specifies an \"irrotational\" velocity field, then f is called the velocity potential. If F specifies a force field, then F is said to be conservative when curl (F) = 0; in this case, it is customary to set V = - f and call this the potential energy. If y is a curve from Po to PI' then r FT = U(Po) - U(pd • y This is interpreted as meaning that the work done by the field in moving a particle from Po to PI is independent of the path chosen, and is equal to the loss in potential energy. Before leaving I-forms, we digress to point out that there exists a form of duality between the analysis and the geometrical notions we have been discus- sing. Consider a curve y that starts at P and ends at q; it is reasonable to define its boundary to be the set consisting of P and q, taken in some order or assigned numerical weights to indicate which is the starting point and which the endpoint. It is then convenient to say that a closed curve (for which P = q) has no boundary, and thus to write oy = O. Likewise, one may say that a curve y is bounding in n if there exists a surface L in n with y = OL. Compare the following statements: DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 507 curves y is closed if and only if 8y = O. y is bounding in Q if and only if y = 8L for some L in Q. I-forms w is closed if and only if dw = O. w is exact in Q if and only if w = df for some fin Q. In the light of Theorem 19 and Definition 13, and this table, the following statement should not seem surprising: An open region Q has the property that every closed I-form is exact if and only if every closed curve is bounding-i.e., if and only if Q is simply connected. This connection between analytic notions dealing with the local and global behavior of I-forms and geometric notions dealing with the behavior of curves is only one piece of a much larger picture, ex tending to general k forms, n space, and even general n-dimensional manifolds, for which reference should be made to recent books on modern differential topology. We illustrate this by discussing 2-forms briefly. Definition 14 A 2jorm (J is exact in Q if there is a I-form w of class C' in Q such that (J = dw. There is more freedom in the choice of w in this case. If (J is exact, and w is a I-form with (J = dw, then any exact I-form may be added to w. For example, (J is also given as d(w + df), where f is a function of class C. What corresponds to the notion of independence of path for 2-forms? An answer is supplied by Stokes' theorem. Theorem 21 If (J is exact in Q and L j and L 2 are two smooth orientable surfaces lying in Q and having the same curve y as boundary, then For, if (J = dw, then, by Stokes' theorem, ff (J = ffdw = f w for both l: • l: • ill: choices of L. I Corollary If (J is exact in Q, then f f (J = 0 for any smooth orientable closed .l: surface L in Q. We can also test a 2-form for exactness by examining its coefficients. Theorem 22 If (J = A dy dz + B dz dx + C dx dy is exact and of class C in Q, then d(J = 0 there .. that is, 508 ADVANCED CALCULUS This also comes at once from Theorem 3; if a = dw, then da = ddw = 0 I We are again able to prove a local converse to this. Theorem 23 If a is a 2jorm which is of class C' and obeys the condition da = 0 in a convex region n, then a is exact in n. If a = A dy dz + B dz dx + C dx dy, then we shall assume that Al + B z + Cz is identically 0 in a convex region n containing the origin (0,0,0). We shall find a i-form w such that dw = a. Because of the latitude that exists in the choice of w, it will turn out to be possible to find a solution of the form w = a(x, y, z) dx + b(x, y, z) dy. The requirement dw = a imposes the following three conditions on the coefficients of w: (9-45) aa -=B az ab -= -A az Integrating the first two with respect to z, and supplying an arbitrary function of (x, y) in the integral of the first, we are led to try the following: a(x, y, z) = fZ B(x, y, t) dt - fYC(x, s, 0) ds o . 0 b(x, y, z) = - rA(x, y, t) dt o These clearly satisfy the first two equations in (9-45). To see that the third holds as well, we differentiate with respect to y and x, respectively, obtaining aa Z -a = f Bz(x, y, t) dt - C(x, y, 0) y . 0 ab Z a - = - f A I (x, y, t) dt x '0 Accordingly, ab aa r z a - - a-- = - [AI (x, y, t) + Bz(x, y, t)] dt + C(x, y, 0) x y . 0 But, Al + B z + C 3 = 0, so that the right side becomes rZC 3(X, y, t) dt + C(x, y, 0) = [C(x, y, z) - C(x, y, 0)] + C(x, y, 0) • 0 = C(x, y, z) and all the equations in (9-45) are satisfied. I (We shall also give another treatment of this in Exercise 2 Sec. 9.6.) (9-46) DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 509 Corollary If a 2-form a satisfies the condition da = 0 throughout an open region n, then a is locally exact in n. This means again that in some neighborhood of any point of n, there is defined a I-form w such that a is the derivative of w in this neighborhood. The various I-forms w may not piece together to give a I-form whose derivative is a everywhere in n. For example, the 2-form x dy dz + y dz dx + z dx dy a = ~ (x2 + y2 + Z2)3 /2 is of class C' in all of space except at the origin, and direct calculation shows that da = 0 in this whole set. Thus, a is locally exact everywhere except at the origin. However, a is not exact in this set, for if one computes the surface integral rr a, where L is the unit sphere: x =sin <p cos e, y=sin <p sin e, z =cos <p, \"l: o S; <p S; TC, 0 S; e S; 2TC, the value does not turn out to be zero! It will be noticed that the region n involved in this example is simply connected. It is natural to ask for the corresponding property, which, if possessed by n, will ensure that any 2-form that is locally exact in n must also be exact. By analogy, we would expect the condition to be the geometric dual, namely, that every closed surface in n is bounding. The region shown in Fig. 9-22 fails to have this property, but the interior of the torus (inner tube) in Fig. 8-27 does; note that this geometric condition is not the same as being simply connected! Again, appealing to the Stokes' theorem for 2-forms in 3-space (Gauss' theorem), we can prove part of the conjectured result. Theorem 24 If every smooth surface in n is the boundary of a region D lying in n, and a is a closed 2jorm, then If a = Ofor every closed surface Lin n. 'l: For, we have f.f a= JJ a= HI da= HJo=o I D D In Exercise 8, we prove that if the region n is \"star-shaped,\" which is slightly more general than \"convex,\" then one can go further and conclude that a is necessarily exact in n. (This is far from the best possible result here, but an adequate discussion would take us in other directions.) These results on exact 2-forms may also be cast into vector form. Let F be a vector field described by F = Ai + Bj + Ck. Referring again to Sec. 9.3, we see that its corresponding2-form is exact if and only if we can write F = curl (V), where V is another vector field. Since div (curl (V)) = 0, a necessary condition on F is that div (F) = O. Such a field is said to be solenoidal, or divergence- free. The velocity field of an incompressible fluid is solenoidal. 510 ADVANCED CALCULUS Theorem 25 If F is a solenoidal vector field of class C, then in any convex set, F is of the form F = curl (V). EXERCISES For each of the following I-forms w, find if possible a function I such that w = df (a) w = (3x 2y + 2xy) dx + (x 3 + X Z + 2y) dy (b) w = (xy cos xy + sin xy) dx + (XZcos xy + y2) dy (e) w = (2xyz3 + z) dx + X 2 Z3 dy + (3x 2yz2 + x) dz (d) w = x 2 dy + 3xz dz 2 (a) By differentiating tg(xt, yt, zt) with respect to t, show that I I g(x, y, z) = r g(xt, yt, zt) dt + r [xgdxt, yt, zt) + ygz(xt, yt, zt) + zg3(xt, yt, zt)]t dt '0 '0 (b) A region Q in space is said to be star-shaped with respect to the origin if the line segment OP lies in Q whenever the endpoint P lies in Q. Let Q be star-shaped, and let w = A dx + B dy + C dz obey dw = 0 in Q. Obtain an alternative proof of Theorem 16 by showing that w = df, where I is defined in Q by the explicit formula I I(x, y, z) = r [xA(xt, yt, zt) + yB(xt, yt, zt) + zC(xt, yt, zt)] dt • 0 (e) Can this integral be regarded as a line integral of w along a curve joining (0,0,0) to (x, y, z)? 3 Verify that the differential form given in Eq. 9-41 obeys dw = 0 throughout the ring D. 4 Consider the differential form x dx + y dy W=~-·- x2 + yZ Show that dw = 0 in the ring D. Is w exact in D? 5 Recall that a function I is said to be homogeneous of degree k if I(xt, yt, zt) = t\"f(x, y, z) for all t 2: 0 and all (x, y, z) in a sphere about the origin. Let w = A dx + B dy + C dz be an exact I-form whose coefficIents are all homogeneous of degree k, k 2: O. Show that w = df, where 6 If such exist, find integrating factors for the following differential forms: (a) (x 2 + 2y) dx - x dy (b) 3yz2 dx + xz 2 dy + 2xyz dz (e) xy dx + xy dy + yz dz 7 (a) Show that the 2-form (J = A dy dz + B dz dx + C dx dy can also be expressed in the form (J = IX dx + Pdy, where IX = B dz - C dy, P= - Adz. (b) In the proof of Theorem 23 a I-form w = a dx + b dy was found such that dw = (J. Show DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 511 that the coefficients of ware given by the equatIOns: a(x, y, z) = I' C( \" b(x, y, z) = r p \" where y is the polygonal path from the origin to (x, y, z) that is shown in Fig. 9-20. 8 (a) By differentiating rZg(xr, yr, zr) with respect to t, show that g(x, y, z) may be given by ,I .1 2 I g(xt, yr, zt)t dr + 1 [xgl(xt, yr, zt) + ygz(xt, yt, zt) + Zg3(xt, yt, zt)]t Z dr . 0 . 0 (b) If (J = A dy dz + B dz dx + C dx dy, show that 2(J = (B dz - C dy) dx + (C dx - Adz) dy + (A dy - B dx) dz (c) Let n be star-shaped with respect to the origin, and let d(J = 0 in n. Obtain an alternative proof of Theorem 23 by showing that (J = dw, where w = a dx + b dy + c dz, and where I a(x, y, z) = r [zB(xt, yt, zr) - yC(xt, yt, zt)]t dt • 0 I b(x, y, z) = r [xC(xt, yt, zt) - zA(xt, yt, zr)]t dt • 0 I c(x, y, z) = I' [yA(xr, yt, zy) - xB(xt, yt, zt)]r dr , 0 9 Let (J = A dy dz + B dz dx + C dx dy, where the functions A, B, and C are homogeneous of degree k in a neighborhood of the on gin. If (J is exact, show that (J = dw, where (zB - yC) dx + (xC - zA) dy + (yA - xB) dz w = - ---------------- k+2 10 Show that the following 2-forms are exact by exhibiting each in the form (J = dw: (a) (3y Zz - 3xz Z) dy dz + x 2 y dz dx + (Z3 - XZz) dx dy (b) (2xz + z) dz dx + y dx dy II Formulate a necessary condition that a I·form in n variables be exact. 12 Verify the assertions made in connection with the 2-form given in Eq. (9-46). 13 Formulate a definition for \"integrating factor\" for 2-forms. Obtain a differential equation which must be satisfied by any integrating factor for the 2-form (J = A dy dz + B dz dx + C dx dy Using this, and Euler's differential equation for homogeneous functions (Exercise 11, Sec. 3.4), obtain the most general integrating factor for x dy dz + y dz dx + z dx dy 14 Using Theorem 8, Sec. 9.4, show that a transformation of class C\" carries exact forms into exact forms. 15 Let n be a region in space which can be mapped onto a star-shaped set by a I-to-l transforma- tion of class C\". Show that any 2-form (J which satisfies the equation d(J = 0 in n is exact in n. 512 ADVANCED CALCULUS 9.6 APPLICAnONS Many of the classical applications of differential forms occur in the study of the vector fields that arise in physics. We illustrate some of the results of the previous sections in this context, translating them into vector form. We start with techniques that are derived from the treatment of exact I-forms and exact 2-forms in Sec. 9.5, which permit us to work with vector functions that are irrotational or are solenoidal (divergence-free), expressing them in special forms at least locally. Our first illustration is a standard one, and is based on Maxwell's equations for electromagnetic radiation, given earlier in (9-18). If we drop the factor 4n to simplify the discussion, let us suppose that E aud H are vector functions of (x, y, Z, t), representing the electric and magnetic fields, which obey the four equations: (9-47) (9-48) (9-49) (9-50) V·E=p V·H=O aH V x E + -- = 0 at aE VxH--=J at The scalar function p describes the distribution of charge, and the vector function J describes the distribution of current. If we regard p and J as known, we may seek a solution of these equations for E and H. We shall show that this may be reduced to the solution of a standard partial differential equation, the inhomogeneous wave equation. By (9-48) and Theorem 25, H can be represented locally in the form (9-51) H = V x A where A, the vector potential, may be altered by adding any vector function of the form Vg, where g is a suitable scalar function. Putting this into (9-49), we have a 0= V x E + at (V x A) =V x (E+aa~) By Theorem 20, a scalar function <jJ exists such that, locally at least, aA E+-=V(-<jJ)=-V<jJ at (The negative sign is chosen only to improve the final appearance of our DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 513 equations.) We may thus assume that E and H have the representations given in (9-51) and in (9-52) oA E=-V<jJ-- at Put these i'1to (9-47) and (9-50), obtaining (9-53) p = V . ( - V<jJ - °o~) a = - V2 <jJ - at (V . A) and J=VX(VXA)-~(-V<jJ_OA) at at 0<jJ 02A = V x (V x A) + Vat + ot 2 Making use of the vector identity (9-24), this can be written as (9-54 ) 2 0<jJ 02A J = V(V . A) - V A + V -~ + .- at ot 2 Turning (9-53) and (9-54) around, we have two equations to be satisfied by A and <jJ: 2 0)V <jJ = - p - - (V . A at V2A _ 02A = -J + v(v. A + 0<jJ) ot2 at In the second, V2A is to be interpreted by writing A = ai + bj + ck and applying V 2 to each component, obtaining V2A = V2(a)i + V2(b)j + V2(c)k The second equation would assume a much simpler form if A and <jJ could be chosen so that (9-55) 0<jJ V·A+--=O at and In this case, our two equations would become 02<jJ V2 <jJ _.Ji2 = -p 02A V2A--=-J ot2 514 ADVANCED CALCULUS In the choice of A, we have a considerable amount of freedom. Suppose that Ao and <Po are particular choices which satisfy (9-51) and (9-52); if we add a vector of the form Vg to A o , (9-51) will still hold, since V x A = V x (Ao + Vg) = V x Ao + V x (Vg) = V x Ao = H where we have used (9-21). If we modify A o in this way, we must also modify <P in order to preserve (9-52). Putting <P = <Po - og/ot, we have -V<p - oA = -V(<po _ Og) - ~(Ao + Vg) at at at = - V<Po + V(Og) - ~Ao - ~(Vg) at at at a = - V<Po - at Ao =E We next choose g, which is thus far unrestricted, so that (9-55) holds. This requires that we have which implies that g must be chosen to satisfy the equation 2 02g ( o<Po) V g - ot 2 = - V· Ao + at With this line of argument, the solution of Maxwell's equations may be reduced to the consideration of the special partial differential equation (9-56) (9-57) (9-58) In coordinate form, this is 02~ 02~ 02~ 02~ ox2 + oi + OZ2 - ot2 + h = 0 and is called the inhomogeneous wave equation. If ~ is independent of time, then equation (9-57) reduces to an equation V2~ = -h, or 02~ 02~ 02~ ox2 + oy2 + OZ2 + h = 0 which is called Poisson's equation. DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 515 When h is identically 0, this in turn becomes Laplace's equation (9-59) whose solutions in an open region n are called harmonic functions. Vector methods are used in the solution of each of these equations. Before we can use them, we need certain relations which may be derived from the divergence theorem, and which are called Green's identities. To obtain these, we start from the vector form of the divergence theorem (9-60) JJJ V . F = JJF . n = JJ F N 00 where the vector n in the second integral is the general unit normal on an. In our applications, n will be the region lying between two spheres (Fig. 9-22). If we choose the vector function F to have a particular form, then we can obtain a number of special cases of this result which are quite useful. To illustrate this, let us first take F as a gradient field, F = Vg. Since V· (Vg) = V 2g, and Vg . n is the directional derivative of 9 in the direction n, (9-60) becomes (9-61 ) where ogjon is understood to mean the scalar function whose value at a point on the boundary of n is the directional derivative of 9 in the direction normal to the surface. (Briefly, ogjon is the normal derivative of g.) Again, if we choose F = fV g, we use the vector identity V· (IV) = Vf' V + f(V· V) with V = Vg, then V·F=Vf·Vg+fV 2g and (9-60) becomes Green's first identity: (9-62) JJJVf· Vg + JJf fV 2g = JJ f~: n Q en We illustrate the use of these identities by proving certain properties of the class of harmonic functions. Recall that a function 9 is said to be harmonic in a region n if it satisfies Laplace's equation, (9-59), in n. In Theorem 20, Sec. 3.6, we proved by a different method that these functions were conditioned in a region by their values on the boundary; if g is harmonic in a bounded closed region n, and g(p) :s; M for all p on the boundary of n, then g(p) :s; M for all points p in n itself. As a deduction from this, in Exercise 18, Sec. 3.6, we found that two functions which are harmonic in n and which coincide on the boundary of n must coincide throughout n. The second of these results 516 ADVANCED CALCULUS comes at once from (9-62). If we take f = 9 and assume that 9 is harmonic in n, and that 9 = 0 on the boundary of n, then we have JJJ Vg· Vg = JJJ IVgl 2 = 0 fl fl Since IVgl 2: 0, we must have Vg = 0 (assuming that 9 is of class C), and 9 is constant in n. Since the boundary value of 9 is 0, 9 = 0 in n. If 9 and g* were two functions, both harmonic in n, with g(p) = g*(p) for all points p on the boundary of n, then 9 - g* would be harmonic in n, and would have boundary value 0; by the previous argument, 9 - g* would be identically 0 throughout n, so that 9 = g*. By an analogous argument, it may be shown that if 9 and g* are harmonic in n, and if their normal derivatives, aglan and ag*lan, are equal on the boundary of n, then 9 and g* differ at most by a constant in n (see Exercise 1). These results show that for a suitably well-behaved region n, the values of a harmonic function in n are determined completely by its values on an, and up to an additive constant, by the values of its normal derivative on an. One may turn this around and ask the following question: Given a function f, defined on an, is there a function 9 which is harmonic in n and such that 9 = f on an? This is called the Dirichlet problem for the region n. If n is suitably well behaved and f is continuous, then it has a solution, which, by the previous discussion, is unique. Correspondingly, given a function f defined on an, one may ask for a function g, harmonic in n, such that aglan = f on an. This is called Neumann's problem for n. There may exist no solutions, even though n is very well behaved and f is continuous; to see this, we resort again to Green's identities. If we apply (9-61) when 9 is harmonic in n, then we obtain Thus, a necessary condition on the boundary-value function f in Neumann's problem is that its integral over the boundary of n be O. Again, the previous discussion shows that if Neumann's problem has a solution g, and if n is sufficiently well behaved, then 9 is unique to within an additive constant. Let us turn now to Poisson's equation: where h is assumed to be of class C', and, for convenience, to vanish outside a bounded region. We shall seek a solution of this equation which obeys two additional conditions: (9-63 ) (9-64) lim Il/J(p) I = 0 Ipl-oo lim Igrad l/J(p )II pI = 0 Ip!-oo DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 517 The first may be translated as saying that t/J vanishes at infinity, and the second as saying that the partial derivatives of t/J vanish more rapidly than l/lpl = (x 2 + i + z2r 1/ 2 . If we can obtain such a solution of Poisson's equation, then any harmonic function can be added to it; conversely, ift/J and t/J* are two solutions of Poisson's equation, then V2(t/J - t/J*) = V2 t/J - V 2 t/J* = h - h = 0 so that t/J - t/J* is harmonic. We begin by deriving Green's second identity. Write (9-62) with f and g interchanged: JfJ Vg . Vf + fJJ gV 2 f = fJg ~ n n m Subtract this from (9-62); the first integral drops out, leaving (9-65) Theorem 26 If t/J is a solution of the equation V 2 t/J + h = 0 which obeys the boundary conditions (9-63) and (9-64), then t/J is given at the point Po = (xo,yo,zo)by 4 .1,( ) - fl',' h(p) d - ffl' h(x, y, z) dx dy dz Tr'l' Po -- - P - ... Ip - Pol - .. [(x - XO)2 + (y - YO)2 + (z - ZO)2]1 /2 Let 4>(p) = l/Ip - Po I· By direct computation, it is seen that V 2 4> = 0 everywhere, except at the singularity Po. Also, grad 4>(p) = (p - Po)/Ip - Po 13 so that Igrad 4>(p)I = l/lp - poI 2.Thefunction4> thus obeys the conditions (9-63) and (9-64) \"at infinity.\" Let n be the region between two spheres with center Po; we suppose that the larger has radius R, and the smaller has radius r. We apply Green's identity (9-65) with this choice of n, and with f = 4> and g = t/J. Since t/J is assumed to be a solution of Poisson's equation, V 2g = - h. Since 4> is harmonic in n, V 2f = O. We therefore have (9-66) -JJJ 4>h = JJ 4> ~~- JJ t/J ~~ n an The boundary of n consists of two spherical surfaces, L Rand L,. On the outside one, L R , the normal n is directed away from Po. If we employ spherical coordinates (p, e, 4», with Po as origin, then \"derivative in the 518 ADVANCED CALCULUS direction of the normal\" means %p so that on L R , <jJ(p) = p-I = R-1 o<jJ o<jJ 0 -I -2 -2 on =ap = ap (p ) = - p = - R Similarly, on L\" the normal is directed toward Po, and %n= -%p; thus <jJ(p) = p-I = r- I and o<jJ = _ o<jJ = _ ...~ (p-I) = p-2 = r- 2 on op op Using these, (9-66) becomes (9-67) We examine the behavior of each of these integrals as r approaches °and R increases. Estimating the first three surface integrals, we have I~If ~~I ~~(area of LR)(maximum of Igrad ljJ I on L R ) I:R ~ 4nR (max Igrad ljJl on L R ) 1 1 oljJ I 1 .;:If on ~;: (area of Lr)(maxlmum of Igrad ljJ I on L r ) I:, ~ 4nr (maximum of Igrad ljJ I on L r ) I~2If ljJ I ~~2(area ofLR)(maximum of IljJl on L R ) I: R ~ 4n (maximum of IljJI on L R) Using (9-63) and (9-64), we see that all three approach 0, as r--+O and R --+ 00. Applying the mean value theorem to the remaining surface integral, I:r = -4nljJ(p*) where p* is some point lying on L r • As r --+ 0, p* --+ Po, so that DIFFERENTIAL GEOMETRY AND VECTOR CALCULUS 519 Accordingly, if we return to (9-67), we have 4m/!(po) = lim fff h¢ = fl'f 1 ~P)-Idp r-O . , ,. P Po R-oo n Having thus obtained the necessary form of a solution of the Poisson equation, one may proceed to verify directly that this is a solution. The general wave equation (9-57) may be treated in the same way. The solution which is obtained has the form ( ) _ fl'fh(x,y,z,t-p)dxdydz t/J xo , yo, zo , t - ... p where p = Ip - Po I, assuming that t/J and h are independent of time for t ::s; O. The form of the integrand has a simple interpretation; at time t, the value of t/J is not determined by the simultaneous values of h throughout space, but rather by those values which could be \"communicated\" to Po by a signal which travels at speed 1 (i.e., the speed of light), and which therefore left the point p at time t - I p - Po 1 = t - p. For details of this, and other applications of Green's identities, the reader is referred to the treatise by P. M. Morse and H. Feshbach, \"Methods of Theoretical Physics,\" McGraw-Hill Book Company, New York, 1953. EXERCISES I (a) If 9 is harmonic in n and the normal derivative of 9 on the boundary is 0, show that Vg = 0 in n. (b) Let 9 and g* be harmonic in n, and let agjan = ag*jan on an. Show that g* = 9 + K, where K is constant. 2 Let V· F = 0 in a convex region n. Show that F can be expressed there in the form F = V x V, where V' V = 0 and V 2 V = - V x F. (This reduces the problem of finding a I-form w with dw = (J for a gIven exact 2-form (J, to the solution of Poisson's equation.) 3 Prove the following vector analog for Green's identities. (a) If (F x [V x G])N = JJJ (V x F)' (V x G) - JJJ F· (V x [V x G]) n n (b) IfJiG . (V x [V x F]) - F' (V x [V x GJ)} = If {(F x [V x G])N - (G x [V x F])N} n en CHAPTER TEN NUMERICAL METHODS 10.1 PREVIEW While many mathematical questions are regarded as solved when a solution has been proved to exist, there are times when the goal is to find a concrete numerical answer. We have illustrated this already in Sec. 5.5, where we discussed finding the sum of a convergent series, and in many of the exercises in Sees. 3.5 and 4.3, dealing with applications of the mean value theorem and with numerical integration. In this chapter, we concentrate on the numerical aspect and point out a small number of algorithms and techniques, choosing those where results from earlier chapters of a theoretical nature are used to explain or justify the algorithm. The first three sections deal mainly with the following two problems: I. Given a set D, a function T defined on D and taking values in S, and a point qo E S, how can we find a point p E D such that T(p) = qo? In particular, given an interval I and a real-valued function f, how do we solve / (x) = O? n. Given a set D and a real-valued function / defined on D, how can we find the minimum (or maximum) value of/(p) for p ED? For each of these, the approach is often to obtain a sequence {Pn} of points in D which may be convergent to the desired solution point p. Thus, in 520 NUMERICAL METHODS 521 Sec. 10.2 we discuss Newton's method for functions of one variable and for transformations; the latter depends upon some of the results in Chap. 7 dealing with differentiation of transformations. In Sec. 10.3, we discuss another very useful iterative procedure that depends on the properties of a contraction mapping and the notion of an attractive fixed point for a transformation. Section 10.4 concentrates on problem (ii), discussing iteration methods for solving extremal problems, and ends with a brief treatment of Lagrange multipliers. The last section of the chapter touches upon several topics in numerical integration and differentiation, again picking some that use mathematical results obtained in earlier chapters. Thus, we use the mean value theorem to obtain formulas for approximate differentiation, and we obtain useful estimates for certain simple numerical integration methods. We have also included a description of the ingenious iterative procedure used by Gauss to evaluate a class of elliptic integrals. This brief chapter is not intended to be a survey of the entire field of numerical analysis, but rather a sampling only, omitting all mention of some of the most important topics. For example, there is no mention of the solution of ordinary or partial differential equations. We have also omitted any discussion of the computer aspects of these topics, although these will in fact be an important part of any solution procedure. For example, if we are attempting to solve the equation f(x) = 0, it should be observed that there are in fact two possible questions to be answered. Do we want to find a point x where f(x) is computationally indistinguishable from 0, or do we want a point x that is computationally indistinguishable from the true solution x of the equation? Here, we are recognizing that it is usually impossible to tell if a computed number is the same as a given number, or even to be sure that it is positive or negative. Similar remarks apply to problem (ii), for we may be interested only in finding a point wheref(p) is nearly minimum, or we may want p to be near the actual minimum point /5, even iff(p) itself is large. Such questions are important when it comes to actual computational matters, and we leave them to the growing collection of treatises on the subject. 10.2 LOCATING ZEROS The simplest problem of this type is to locate a solution of the equationf(x) = 0 on an interval I = [a, b] wherefis continuous, and where we havef(a)f(b) < O. By the intermediate value theorem, we know that there must exist at least one point x E I such that f(x) = O. A harder problem would be to locate all the zeros of f in I, since part of this problem is knowing that we have found them all. The curve shown in Fig. 10-1 will also suggest some of the pitfalls that enter into such problems. Inadequate sampling of the function 522 ADVANCED CALCULUS Figure 10-1 values may lead us to miss a zero entirely, as at A; round-off errors may lead us to confuse a positive minimum point B with a zero; a nearly horizontal portion near a zero point C may mislead us as to the true location of the zero. All of these are more the concern of a study of practical numerical analysis than of one directed toward the theoretical background, and for this reason we are content with this brief mention. There always seem to be trade-offs in the choice of a numerical procedure. Simple procedures often tend to be reliable, while fancier ones may be faster but likely to go wrong with special classes of problems. The simplest procedure for solving the problem posed above is the bisection process. We bisect the interval I and calculate the value off at the midpoint, noting the sign of this value; we now have a new interval of half the length in whichfmust have a zero, or we will have observed that the midpoint itself is a solution. Continuing this, we obtain a nested sequence of intervals which close down on the desired solution x. In twenty steps we have arrived at an interval of length 2- 20 L (I}, which is a reduction by about a million. This method is effective, and we can predict in advance how many steps are needed to achieve a specified accuracy in the location of x. Note that computer noise might give us the wrong sign for some value of f at a bisection point, but since this value would of necessity be very small, the ultimate point x provided by the algorithm would not be too far off. Another simple method is linear interpolation. Rather than choosing the midpoint each time, one might choose that value of x where simple linear interpolation between the current values off of opposite sign yields 0 as the predicted value off Another variant of this is called the secant method, and provides a sequence {x n} determined by the recursion (10-1 ) Xo = a Xl = b x n - J(x n } - xJ(x n - d x n + l = ~~-~- f(x n } - f(x n - d The reason for the name and the theory behind this algorithm are both seen in Fig. 10-2, and it is clear that in many cases, the sequence {xn} will converge to one of the zeros off [However, note that it can be catastrophic to have f(x n - d andf(x n} nearly equal while X n - l and X n are far apart; see Exercise 5.] 524 ADVANCED CALCULUS The bisection method requires more than 20 steps to achieve this degree of accuracy. The effectiveness of Newton's method is in striking contrast to the other two, and it is natural to seek a mathematical explanation for this success. Theorem 1 Let f be of class C\" on an interval I, and let x E I be a simple zero of f, meaning that .f'(x) -# O. Then, there is an interml 1* c I containing x and a constant M such that if Xo E 1* and {xnl is defined by the recursion (10-2), then {x n} converges to x and (10-3 ) for n = 1,2,3, ... A converging sequence which obeys a condition such as (10-3) is often called \"superconvergent,\" meaning that the errors decrease very rapidly, behaving something like the sequence .1, .01, .0001, .00000001, 10- 16 , 10- 32 , etc. To prove Theorem I, let 10 be an interval about x in which 1.f'(x)1 2 C > O. Then, let X n belong to 10 and expand f about X n by Taylor's theorem, obtaining f(x) = f(x n) + .f'(xn)(x - xn) + .f\"(r)(~- xnf where r lies between x and X n . In this, set x = x where f(x) = 0, and divide by.f'(xn) to obtain .f\"(r) _ 2 _ f(x n ) 21'(;J (x - xn) = X n - X - .f'(xn ) The right side of this expression is X n + 1 - x, so that we have (10-3) with M = B/(2C) where B is the maximum of 1.f\"(x)1 on 10 , Clearly, if Xo is sufficiently close to x, (10-3) will imply that XI' X2' and all later X n lie in 10 , I It is also natural to wonder if Newton's method can be applied when x is not a simple zero off Experimentation suggests that the method again produces a sequence converging to a zero x off if the starting point is sufficiently close to X, but that the rate of convergence is far slower. A mathematical justification of this is given in Exercise 6. (Of course, in order to be able to calculate X n+ 1 by (10-2), it is necessary to be sure that .f'(xn) -# 0; a convenient way to achieve this is to require that.f\"(x) -# 0 on a neighborhood of x.) Suppose we now turn to problems involving functions of several variables. The task of solvingf(x, y) = 0 for points (x, y) in a region D is really that of constructing the O-height level curve r for f in D. An obvious approach is to choose a set of discrete values of y, say Yi for i = 1, 2, ... , N, and for each to solve the equation f(x, y;) = 0 for x. The result will be a collection of points on each of the lines Y = Yi' each lying on the desired level curve (which may have more than one connected component), and the remaining task is to join these in an appropriate way to obtain an approximation to the complete (10-4) NUMERICAL METHODS 525 level curve J. Accuracy can be increased by choosing the Yi close together, but at the expense of increasing the effort considerably. Any adequate discussion of the methods used to obtain smooth approximations to J from the discrete point data would take us far afield. We therefore turn instead to the problem of solving a pair of simultaneous equations such as f(x, y) = 0 g(x, y) = 0 We can restate this in terms of the transformation T defined by T(x, y) = (.f(x, y), g(x, y)) in the simpler form T(p) = O. In either case, we see that a solution (x, y) = p will be a point that lies on the intersection of the O-level curves for f and g. If it is possible to obtain sufficient information about these curves by the methods described in the preceding paragraph, it may be possible to obtain a nested sequence of rectangles {Dn} known to contain p. In simple cases, such a discrete search method can succeed. However, analytic methods based on the study of the mapping T are usually much more efficient. For example, there is a several-variable form of Newton's method, defined as follows: Choose a trial solution point Po, which should be not too far from the actual solution point p, and then use the following recursion to obtain a sequence {Pn}: (10-5) [The analogy between this formula and that for the usual one-variable Newton's method is more evident if the notation T'(P n ) is used instead of the differential of T; compare with (10-2).] With appropriate requirements on T and on the point p, the sequence {Pn} will again be superconvergent to p if the starting point Po lies in a sufficiently small neighborhood of p. Theorem 2 Assume that T is of class en and that the differential of T is nonsingular at p. Then, there is a neighborhood JV about p and a constant M such that if Po lies in JV and Pn is defined by (10-5), then (10-6) The proof follows the same pattern as that of Theorem 1. Let dT be the differential of T at Pn • Then, for any P sufficiently close to Pn ' (10-7) T(p) = T(P n ) + (dT)(p - Pn ) + R where the remainder term R obeys IRI ~ Rip - Pn 1 2 , for some suitable constant B. In (10-7), choose P.= p and multiply through by the inverse 526 ADVANCED CALCULUS of dT to obtain (10-8) (dT)-I(R) = - (dTr I(T(Pn )) - (15 - Pn ) = Pn - (dTr I T(Pn ) - 15 (10-11) =P n+l-j5 By the boundedness theorem for linear transformations, and the fact that the entries in (dTr I are uniformly bounded on a neighborhood of 15, it follows that there is a constant A such that l(dTrl(R)I::S:AIRI::s: ABlj5 - Pn 1 2 , so that from (10-8) we obtain (10-6). I It is clear that the proof of Theorem 2 was not restricted to a pair of equations in two variables, but instead applied to a nonlinear system of n equations in n variables. As a numerical procedure, Newton's method is not an easy one to apply, especially if the number of equations is even moderately large. To illustrate its use, consider the pair of equations Jx2y - x - 2 = 0 (10-9) 1xi - y - 6 = 0 It is easy to see that this system has exactly one real solution, x = 1, y = 3. To apply Newton's method, we find 1 [2xy - I (dTt I = 3~2y2---=-4xy+1 I _y2 and then define the sequence {Pn} by the recursion (10-10) Po = (xo, Yo) Pn+1 = G(xn, Yn) where G(x, y) = (u, v) and x(xy - 1)2 + 6x 2 - 4xy + 2 u = x --- .-- .------ 3x 2y 2 - 4xy + 1 y(xy - 1)2 + 2y2 - 12xy + 6 v = y --. --- ..------------ ..-- ----- 3X2y 2 - 4xy + 1 In practice, the convergence of {Pn} to the desired solution 15 depends on a \"good\" choice for the start Po. As Theorem 2 indicates, any point sufficiently near 15 is good, but others may be also. In our example, the choice Po = (7, 7) yields the sequence PI = (4.684, 4.768) P2 = (3.139, 3.380) P5 = (1.0488, 2.8288) P6 = (.99797, 2.99965) P7 = (1.000004, 2.99994) ~ (1,3) NUMERICAL METHODS 527 On the other hand, with Po = (3, 1) the sequence obtained is PI = (-.5,2.5) pz = (-1.058, -1.819) P3 = (- 1.085, - .907) P4 = (-2.197, -2.029) and the sequence does not converge to p. (Of course, one cannot choose a starting point Po such as (1, 1) where the Jacobian vanishes or is too small.) We will reexamine Newton's method from a different point of view in the next section. EXERCISES I Verify formula (10-1) for the secant method. 2 Verify formula (10-2) for Newton's method. 3 (a) Determine the number of real roots of the equation sin x + h = 1 (b) Find each root, accurate to .0001. 4 Discuss the behavior of Newton's method for the function shown in Fig. 10-1, assuming that the starting point X o is chosen near to but not at the points A, B, and C. 5 Explain why the secant method encounters difficulty if If(x.) - f(x.- 1)I is small in comparison with Ix. - x._ ,I. (It may help to refer to Fig. 10-2.) 6 (a) Show that if f'(x) = 0 but r(x) # 0, then the behavIOr of the error in Newton's method is governed by the growth estimate Ix•• I - xl :S Blx. - xl, where B is approximately!. (b) What effect does this have on the rate of convergence of {x.}? (c) Apply Newton's method to solve x4 - 6x 2 + 9 = 0, and observe the rate of convergence of the sequence {x.:. (d) What happens ifj'(x) = r(x) = 0 but!\",(x) # O? 7 Sketch the set of pomts (A, B) for which the equation x 5 - 5x 3 + Ax + B = 0 has (a) exactly one real root; (b) exactly three real roots; (c) exactly five real roots. 8 Find the number of real solutions of the system of equations J sin (y) - x = 0 \\cos (x) - y = 0 and apply Newton's method (10-5) to find one solution. 10.3 FIXED-POINT METHODS Let D be a set in n space, and let T be a transformation defined on D and mapping D into itself, so that T(p) E D for each P ED. A point p is called a fixed point for T if T(p) = p, and the problem to be discussed in this section is that of finding such points p for a given T and D. There is a very close relationship between the topics in the preceding section and those in the present section. Clearly, if we define another 528 ADVANCED CALCULUS transformation S by S(p) = P - T(p), then the fixed points of T are exactly the zero points for S, and vice versa. Thus, any process which can be used to find zeros can be converted into a process for finding fixed points. However, the simple change in viewpoint turns out to be quite helpful in that it suggests other procedures and also helps to clarify the theory behind some of the procedures for locating zeros. We start with a very useful general result for which we need a special definition. Definition 1 A transformation T mapping a set D into itself is called a contraction if there is a number A < 1 such that (10-12) IT(p) - T(q)1 ~ Je Ip - ql for all points P and q in D. Note that a contraction mapping is necessarily continuous, and that T(D) is usually smaller than D. The following result is usually called the contraction theorem. Theorem 3 Let T be a contraction mapping on a closed set D, D eRn. Then, T has exactly one fixed point p in D, and p = limn_ex: Pn, where {Pn} is the sequence defined recursively by (10-13) where the initial point Po is arbitrarily chosen in D. The first step is to prove {Pn} a Cauchy sequence. From (10-13), we see that Pn+I - Pn= T(Pn) - T(Pn- d so that since T is a contraction, and (10-12) holds, IPn+1 - Pnl ~ Je IPn - Pn-II for all n = 1, 2, .... This yields !P2 - PI I ~ Alpl - Pol and Ip3 - P21 ~ Alp2 - PI I ~ Je21PI - Pol, and in general (10-14) IPn+l - Pnl ~ Jenl pl - Pol Take any indices Nand N + k. Then PN+k - PN = PN+k - PN+k-1 + PN+k-1 - PN+k-2 + ... + PN+I - PN so that, by (10-14), IPN+k - PNI ~ IPN+k - PN+k-ll + IPN+k-1 - PN+k- 21 + ... + IPN+ I - PNI ~ {AN+k-l + Je N + k - 2 + ... + AN}lpl - Pol ~ AN(l + A + Je2 + ... + Jek-I)lpl - Pol NUMERICAL METHODS 529 Since A < 1,L: An converges to 1/(1 - A). Thus, we have Ip - p I < AN IPI - Po I N+k N - 1 - A holding for all Nand k. Since limN~OJ AN = 0, we see that {Pn} is a Cauchy sequence. Since n space is complete, and D closed, {Pn} must converge to some point 15 ED. Since T is continuous, lim T(Pn) = T(j5). But, by (10-13), T(Pn) = Pn+ I' which we know converges to 15. Accordingly, T(j5) = p, and 15 is a fixed point for T in D. Suppose now that T were to have another fixed point, q. Then, because T is a contraction, IT(j5) - T(q) I :s; ..1.115 - q I, which becomes 115- q I :s; ..1.115 - q I· But, since A < 1, this can only occur if q = 15, showing that 15 is the only fixed point for T in D. I The hypothesis that a transformation T is a contraction is therefore a very powerful one. The definition can be restated in a useful way: T is a contraction on a region D if T obeys a uniform Lipschitz condition on D, with a constant that is strictly less than 1. In earlier chapters, we have found that various versions of the mean value theorem provide ways to find a Lipschitz constant for sufficiently smooth functions or mappings (see Exercise 13 of Sec. 3.2, Exercise 18 of Sec. 3.5, and the corollary to Theorem 12 in Sec. 7.4). As a result, we immediately obtain the following two simple results. Theorem 4 Let f be a real-valued function of class C' on an interval I, and suppose that f(1) c I and that 1f'(x)1 :s; A < 1 for all x E I. Then, f is a contraction mapping on I. Theorem 5 Let T be a tran~formation of class C' on a convex set D in n space, and suppose that T(D) c D. Supposefurther that T is described in coordinate form as \\YI = If(x l, x 2 ' ..• , x n ) Y2 = 2f(x l , x 2, ... , xn) I;n' ~';(~'I','~~',':::: ~~). and that the partial derivatives of the functions If, 2f, ... , \"f are bounded on D: Then, if all P E D (10-15) T is a contraction on D. .L (cijf < 1 ;'j=1 530 ADVANCED CALCULUS The first of these theorems follows from the ordinary one-variable mean value theorem, and the second from the corresponding n-variable mean value theorem (Theorem 12, Sec. 7.4). In practice, the following two results are more often used. Theorem 6 Let f be of class C' on an open interval I containing a point x which obeys f(x) = x, and suppose that 1f'(x)1 < 1. Then, there is a sub- interval 10 about x on which f is a contraction. Theorem 7 Let T be a transformation of class C' defined on an open set D eRn, mapping D into n space, and suppose that D contains a fixed point p for T. Suppose also that dT Iii = A = [aij]' where L;. j= 1 (aiY < I. Then, there is a neighborhood Do c D about p on which T is a contraction. Both of these arise from the observation that ex pressions involving the derivatives of the given functions will be continuous, and that the properties which hold at the point x or p must also hold when all the variables lie in an appropriately small neighborhood of the point. This guarantees a uniform Lipschitz condition on such a neighborhood, with a Lipschitz constant A. smaller than I. The final step is to observe that this in turn implies that a smaller neighborhood of x (or of p) is mapped into itself. I We give several illustrations of these. Suppose we wish to solve the equation (10-16) cos x + 3xe- X = 0 A sketch of y = cos x and of y = -3xe- X shows at once that there is one negative root and an infinite number of positive roots, with all the larger ones given approx imately by x = (2m + 1)n/2. Equation (10-16) can be converted into a fixed-point problem in many ways; one obvious way is to restate it in the form (10-17) x = _!ex cos x =f(x) If X o is chosen as X o = 0, and the sequence {x n} defined by x n + 1 = f(x n ), we obtain XI = -!, X2 = - .2257, etc., which converges to one of the desired roots (10-18) x = -.251 16283··· (given with reasonable accuracy by x 20 ). If a different choice of the starting point X o is made, in almost all cases the same fixed point will be reached, in spite of the fact that there are infinitely many other fixed points-as shown by the graphical analysis of (10-16). For example, the first few are given by NUMERICAL METHODS 531 2.322613\"', 4.569887\"', 7.863056\"', 10.995020\"', etc., matching ap- proximately the claimed formula (2m + I )n/2 for large m. The explanation for this behavior is seen in Theorem 6. It is readily seen that I.f'(x) I is smaller that I for the fixed point given in (10-18), while this fails to be true for any of the other fixed points. Thus, - .2511 ... is an attractive fixed poin t, and is surrounded by a neighborhood loon whichf is a con traction and in which every starting point X o leads to x whenfis iterated. On the other hand, each of the other fixed points off is a repulsive fixed point having the property that unless the initial choice Xo coincides exactly with the fixed point, the sequence of iterates generated by it moves away from it, eventually enters the attractive region 10 , and thus once more converges to - .2511 .... Indeed, it is immediately evident from (10-17) that a negative fixed point forr must be attractive, since I.f'(x) I = !exlcos x - sin xl ~ jex ~ j We remark that in general, the behavior of sequences generated in this fashion by a given function.f can be extremely erratic, producing both divergence to infinity and strange periodicities. (In this connection, we recommend an article by Li and Yorke in the American Mathematical Monthly, vol. 82, p. 985, 1975.) There is a simple way to overcome this behavior by introducing a different functionf We start again from the given equation (10-16), and consider instead the function (10-19) g(x) = x - A(cos x + 3xe- X ) (10-20) It is evident that the roots of (10-16) will again be fixed points of g. If we choose A appropriately, so that Ig'(x)1 is small, iteration of g will yield the positive roots of (10-16). In particular, if A = I, then 4.5698\"', and 10.99502'\" are attractive fixed points, and if A = - I, so are 2.3226'\" and 7.86305 ... , and both can be calculated by iterating g from any sufficiently nearby starting point. Our second example is the transformation T' Ju = x - Ax 2 - .2y + .6 . 1v = y + .3x - .5y2 + .2 and we seek a fixed point j5 for T. It is easily seen that there are two such points, (I, I) and (1.435 82 .. \" - 1.123 16 ... ). The first is attractive, and if Po is chosen as (0,0), the resulting sequence {Pn}. defined by Pn+ I = T(Pn), is convergent to (I, I): PI = (.6, .2), P2 = (1.016, .56), ... , Ps = (1.000015, .999876), etc. The second fixed point is not attractive. In confirmation of these statements, note that dT[ = [I - .8x (I. I) I .3 -.21 [.2 -.21 I - y (I. I) 1.3 0 J and that (.2)2 + (- .2)2 + (.3 f < 1. A similar computation at the second fixed 532 ADVANCED CALCULUS point yields a number larger than 1. (We remark that the estimate L;. j= 1 (Cij)2 is not the best possible bound for the constant associated with the matrix [cij] and the boundedness theorem, Theorem 8, Sec. 7.3; this means that the condition L;. j= 1 (Cij)2 < 1 is sufficient but not necessary, in order for a fixed point to be attractive.) The contraction theorem also throws light on the general Newton's method for solving equations. Suppose that we wish to solve the equationf(x) = 0 on an interval I. Choose a constant A, and define a function 9 by (10-21 ) g(x) = x - Af(x) (10-22) (10-23) Then, any root x of f(x) = 0 will be a fixed point for g. If we can choose A so that Ig'(x) I < 1, then x will be an attractive fixed point and can be found by iterating g; moreover, smaller values for Ig'(x)llead to faster convergence. Noting that g'(x) = 1 - Aj'(x), we see that an optimal choice for A is 1/j'(x). This analysis leads to the following procedure. To find x, already located within an interval I, estimate the number j'(x), choose A as 1/j'(x) (using the estimate), and then iterate the function 9 given in (10-21). For example, iff(x) = x 3 - 5, and we know that there is a root x in the interval [1, 2], thenj'(x) lies between 3 and 12. We estimate the correct value to be 7, and therefore set g(x) = x - (x 3 - 5)/7. If X o is chosen as any point in [1,2], then iteration will yield a sequence converging to 51/3. (For example, x lO = 1.7099763 if Xo = 1.) The connection between this and Newton's method is now evident. The recursion just described has the form x - x _ f(x n ) n+1 - n j'(x) (where in practice an estimate forj'(x) is used), while the recursion in Newton's method is f(x n ) xn + 1 = X n - fTx n ) automatically providing better and better estimates for j'(x) as the sequence {xn} converges to X. In both cases, it is now clear why multiple roots, for which j'(x) = 0, lead to different behaviors. It is also evident that (10-22) can be a preferable method, especially ifj'(x) is difficult to evaluate, since in (10-22) this need be done only once. A similar treatment can be given for systems of nonlinear equations in several variables. If we wish to solve Jf(x, y) = 0 1g(x, y) = 0 NUMERICAL METHODS 533 knowing that there is a solution p = (x, y) in a set D, consider the transforma- tion S defined by (10-24) S(p) = P - AT(p) where T(p) = (f(p), g(p)) and where A is an arbitrary nonsingular linear transformation. It is again clear that p is a fixed point for S. Calculating the derivative of S, we have dS = I - A dT If this is to be a matrix which at phas entries cij with L;. j= 1 (cijV < I, in order that p be an attractive fixed point for the transformation S, one choice for the constant matrix A is (dT lir 1, since we will then have dS = O. This leads to the following algorithm for finding p, which is seen to be the direct analog of the one described above in formula (10-22). Knowing that p lies in D, we estimate the matrix dTI Ii , then choose A as its inverse. We then define S by (10-24), choose a starting point Po, and define a sequence Pn by (10-25) Pn+l = Pn - AT(Pn) If this is compared with Newton's method, as given in (10-5), we see that A is replaced by (dT IPot I, which is merely a moving estimate for (dT llit I. The success of (10-25) depends on how good the estimate is that leads to the matrix A, and how well Po is chosen. Its advantage over Newton's method lies in the fact that A is calculated only once and used in this form at each step of the iteration, while the corresponding matrix must be recalculated at each step in Newton's method. We illustrate this with the same problem used as an illustration in the last section; we seek a solution for the system Jx 2y-x-2=0 \\ xy 2 - y - 6 = 0 Following the procedure outlined above, we must select a matrix A = [aij] and then define a mapping S by S(x, y) = (u, v), where f uI = fx 1_ fall al2 1fX2~- x- 61 v J y J a21 a22J xy - Y - 2 J Suppose that we believe that the desired solution is in a disk centered on (2,2). [Recall that the solution is actually at (1, 3).] Using this point as an estimate of p and computing (dT 1(2.2))- I, we are led to choose A=f .21 -.12/ -.12 .21 If we iterate S, with (2,2) as Po, we obtain a sequence of points that converges rapidly to the correct point ji = (1, 3); in fact, Ps = (.9220, 3.1911), PIO = (1.0040, 2.9608), and P30 = (.99993, 3.000 19). 534 ADVANCED CALCULUS Specialized methods have been developed for selecting good starting points Po and for choosing the auxiliary matrix A, including some which modify A in the light of current values of Pn' Along with many other aspects of numerical analysis, this is l.eft for texts devoted to this topic. We close this topic with one final observation. The proof of the contraction theorem depended essentially only upon the sequence {Pn} being convergent, and this in turn depended on the fact that in Rn, any Cauchy sequence converges. Accordingly, a similar theorem holds for any mapping of a complete metric space into itself which is a contraction, in the sense of Definition 1. In Chap. 7, we studied a number of complete metric spaces whose points were functions. In these spaces, the contraction theorem can therefore be used to prove the existence of (and indeed to find) the solution of differential or integral equations, as well as other functional equations. This technique is of wide usefulness. In addition, there are also other theorems in which it is not required that the transformation under study be a contraction mapping, but in which the topological nature of the set D enables one to conclude that T must have a fixed point in D. EXERCISES I Show that the iteration theorem (Theorem 4) fails to hold if f merely satisfies the condition 1f'(x)1 < 1 for all x, by considering the functionf(x) = x + 1/(1 + x) on the mterval 0 S x < oc. 2 Let 0 s A s 1 and define a sequence {x n} by X o = 0 (a) Prove lim X n = j A. (b) Estimate the rate of convergence. 3 Apply Exercise 2 to show that Po(x) = 0, Pn+l(X) = Pn(x) + !(x 2 - Pn(x)) defines a sequence of polynomials which converge uniformly to Ixl on -I S x s I. 4 Let A > 0 and consider the following two sequences: Xo = A Yo = A (a) Prove that lim X n = lim Yn = ,yA. (b) Which of these is a better algorithm for calculating ,yA? Explain why. S Solve the system J sin (y) = x ICOS (x) = Y by fixed point methods. 6 Define a sequence of functions {In} by fo(x) = any function of class C' on - oc < x < oc, fn+ dx) = (dldx)fn(x), and suppose thatfn(x) converges uniformly to F(x) on 0 s x s I. What can you find out about F(x)? NUMERICAL METHODS 535 lOA EXTREMAL PROBLEMS The general problem to be examined in this section is that of finding a point p which yields the minimum value ofj(p) for p in a given set S. This has already been examined from several viewpoints in earlier sections, especially Secs. 2.4 and 3.6. In the present section, we will look briefly at certain other aspects of this problem that are connected with the practical problem of finding p, rather than the theoretical problem of proving that p exists. For smooth functions j and regions S, it is evident that our problem can be reduced to another problem like those studied in Secs. 10.2 and 10.3. For, if the minimum ofj occurs at an interior point of S, then p must be one of the critical points ofjin S, and these are the points p at which Dj = 0, while if the minimum is on the boundary of S, then we have reduced the original problem to another similar problem with a different set S, namely bdy (S). If the boundary of S consists of one or more smooth curves, then substitution will yield a new function to be minimized on a domain of lower dimension, and the same process applies here. However, in many cases this procedure is difficult to carry out, even if one is dealing with a one-dimensional problem (see Exercise 1). In such cases, other methods often turn out to be more effective, even some that are mathematically much more naive. The study of numerical methods for dealing with such problems has given rise to a new subject, optimization theory. In Sec. 3.6, we described one of these methods which made use of the gradient of f, Of, identified as a vector at a point p in the domain of j which points in the direction of greatest increase in! As explained there, one uses this to generate a sequence of points {Pn} chosen so that along this sequence, the values of j constantly decrease-hopefully toward the minimum of! One such formula was given there as (10-26) Pn+ 1 = Pn - h Of(Pn) where h is a preselected constant which helps to determine the step size; each succeeding point is in the direction of decreasing values off from the previous point. It is also possible to take into account the behavior of the second derivative ofjin choosing the next point after Pn • We illustrate this with a function of one variable. Suppose that x is a local minimum point for j(x), and that X n is a trial point near x. In a neighborhood of X n we can write f(x n+ ).) = j(x n) + ).!'(xn) + ).2f\"(xn)l2 + ... If we drop all the later terms in the Taylor series after the first three, we have a quadratic approximation to f near x = X n , and we can ask for the choice of Ie which will minimize this. The solution is seen to be ). = - !'(xn)lf\"(x n ), and we are led to the formula (10-27) 536 ADVANCED CALCULUS which generates a sequence {x n} that, with a good choice for the starting point x o , may converge to the minimum point x. (In Exercise 5, we point out another approach which also leads to the same formula, thus providing a second justification. ) There are also versions of this method which apply to extremal problems for functions of several variables. The role ofj'(x) is replaced by Of, and that ofJ\"(x) by the matrix-valued second derivative off, d2f, discussed in Sec. 8.5 and defined in formula (8-48). Further discussion of this will be found in most of the recent texts on optimization, such as Kowalik and Osborne, \"Methods for Unconstrained Optimization,\" American Elsevier Publishing Company, Inc., New York, 1968; and R. P. Brent, \"Algorithms for Minimization without Derivatives,\" Prentice-Hall, Inc., Englewood Cliffs, N.J., 1973. The set S on which a function f is to be minimized is often characterized by auxiliary equations; thus, S might be the set of all p in a given region n which also obey the restrictions g(p) = h(p) = O. In such cases, the problem can be called a constrained minimum problem on n. The remainder of this section is devoted to two methods for solving such extremal problems. The first method is one which replaces a constrained problem by a different unconstrained problem on the same set n. Suppose we wish to minimize f(p) among those points pEn such that g(p) = O. The key idea is to consider instead the problem of minimizing on n the function (10-28) F(p) = f(p) + A Ig(pW where A is a suitable large constant, with the conjecture that a point PA that is optimal for F will be one for which g(pA) is small, and for which f (pA) is therefore nearly equal tof(p), the true minimum off(p) among those points p where g(p) = O. Then, as A increases, the hope is that PA will converge to p. For example, suppose we want to minimizef(x, y) = 2x + y among those (x, y) with x 2 0, Y 2 0 such that xy - 18 = O. It is easily seen that p = (3,6), and that the minimum off(p) is 12. We set F(x, y) = 2x + Y + A(xy - 18)2 and look for the minimum of F(p) for x 20, Y 2 O. It is seen that this occurs approximately at the point PA = (3 - 1/(72A), 6 - 1/(36A)), for large A, and if A -> X, PA -> (3, 6) = p. The most direct approach to the solution of a constrained extremal problem is to make appropriate substitutions which convert it into an un- constrained problem. If we are to minimize f(x, y, z), subject to the condition g(x, y, z) = 0, where p is confined to a set n and we can solve g(x, y, z) = 0 for z = ¢(x, y), then we can instead consider the function F(x, y) = f(x, y, ¢(x, y)) and look for the (unconstrained) minimum of the function F. We would first look for the critical poin ts of F, which would be found by solving F1 = F2 = 0 in n. For example, let us find (x, y, z) E R3 obeying (10-29) g(x,y,z)=2x+3y+z-12=0 (10-30) NUMERICAL METHODS 537 for which 4x 2 + .\\'2 + Z2 = f(x, y, z) is minimum. Solving (10-29) for z, we arrive unconstrained extremal problem of minimizing F(x, y) = 4x 2 + / + (12 - 2x - 3y)2 whose critical points are the solutions of 8x - 4(12 - 2x - 3y) = 0 2.1' - 6(12 - 2x - 3.1') = 0 which have only one solution, x = -A, .I' = it which clearly must be the desired minimum. Thus, the solution of the original constrained problem is the point - (6 36 12)P = IT, IT, IT . There are cases where it may be undesirable to carry out this direct approach explicitly, in part because it is not immediately obvious which variable should be the one to eliminate. One would therefore like to have an alternative way to explore such problems which treats all the variables alike. This can be done in terms of the critical points for general transformations; recall that p is a critical point for T if the rank of dT at p is smaller than the integer that is the lesser of the height and width of the matrix for dT. Theorem 8 The points p = (x, .1', z) which lie in the set S described by g(x, .1', z) = 0 and at which f(x, .1', z) is locally a maximum or a minimum are among the critical points for the transformation T' Ju =f(x, .1', z) . \\ v = g(x, .1', z) Since an equivalent assertion is to say that p is among the simultaneous solutions of the equations (10-31) as well as g(x, .\\', z) = o. (It should be noticed that any two of the determinant equations imply the third; the assertion that dT has rank less than 2 means that (f1J2J3) and (g1> g2' g3) are multiples of one another.) For example, let us apply this to the last illustrative example. Sincef(x, y, z) = 4x 2 + .\\'2 + Z2 and g(x, .1', z) = 2x + 3.1' + z - 12 we have dT = r~x ;.1' ~zJ If the top row is a multiple of the bottom row, then .I' = 6x and z = 2x. Substituting these into g(x, .\\', z) = 0, we again obtain the point (-A, it if). NUMERICAL METHODS 539 The method of this theorem can be given in another form, due to Lagrange. The key to this is the observation that if one forms the special function (10-32) H(x, y, ;:, A) = I(x, y, z) + Ag(X, y, z) then its critical points are the solutions of the equations 0= HI = II + Jegl 0= H 2 = 12 + Jeg2 o = H 3 = 13 + Jeg3 0= H 4 = 9 The first three equations merely assert that (f1,f2 ,/3) is a multiple of (gl' g2' g3)' so that we again obtain Eqs. (10-31). Thus, the extreme points forf, constrained to satisfy g(p) = 0, are among the critical points of the function H. Note that this resembles the procedure in (10-28) by introducing the constraint function g. However, there we were trying to minimize F on the original set n, while in (10-32) we are looking for critical points for H on a space of one higher dimension. These results may be extended also to the case in which several constraints are imposed. If we wish to maximize I (x, y, z) for points p = (x, y, z) which are required to obey g(p) = h(p) = 0, then the method of Lagrange multipliers would be to consider the special function H(x, y, z, Je, p) = I(x, y, z) + Ag(X, y, z) + ph(x, y, z) The critical points of H are the solutions of the equations 0=11 + A91 + phi 0=12 + Ag2 + ph2 0=13 + Jeg3 + ph3 0= 9 0= h Alternatively, we may find the critical points for the transformation I u =/(x, y, z) T: v:g(x,y,z) w - h(x, y, z) which also satisfy the equations g(p) = h(p) = O. As an illustration, let us maximize/(x, y, z) = z among the points satisfying 2x + 4y = 5 and x 2 + Z2 = 2y. (In intuitive geometric language, we are asking for the highest point on the curve of intersection of a certain plane and a 540 ADVANCED CALCULUS paraboloid of revolution.) Setting up T and dT, we have dT =[ ~ 2x o 4 -2 2~] This has rank less than 3 if its determinant vanishes. Expanding it, we obtain x = -l If we use the constraints to find y and z, the desired point is ( 1 3 11)-\"2\", \"2\", 2 . Since the method of Lagrange multipliers is intended to provide an alternative way to determine the critical points of the function whose minimum (or maximum) is sought, after certain of the variables have been eliminated, it is also necessary to check points on the appropriate boundaries, in case the desired extremal point is not interior to the natural domain of this function. In practice, it will often be found that the numerical and algebraic work involved is much the same, whether one uses Lagrange multipliers or whether one proceeds by substitution (see Exercise 4). EXERCISES 1 A wheel of unit radius is revolving uniformly. Attached to the perimeter is a rod of length 3, and the other end P of the rod slides along a horizontal track (see Fig. 10-5). (a) Outline a numerical procedure for finding where the maximum speed and the maximum acceleration of the point P occur. (b) Compute these locations. 2 Use the method suggested in Formula (10-28) to find the minimum value of f(x, y) = x 2 + y2 subject to the constraint 3x + 5y = 8. 3 Find the minimum value of F(x, y) = 3(x + 2y - i)2 + 4x 3 + 12y2 on the rectangle Ixl ~ I, O~y~1. 4 Find the maximum and minimum values of f(x, y, z) = xy + z subject to the constraints x ~ 0, y ~ 0, xz + Y = 4, and yz + x = 5. 5 (a) Apply Newton's method (as in Sec. 10.2) to locate the zeros of f'(x). (b) Compare the resulting algorithm with the process given in (10-27) for finding an extreme value for f(x). 6 What is the maximum value of x - 2y + 2z among the points (x, y, z) with x 2 + y2 + Z2 = 9? 7 Find the minimum of xy + yz for points (x, y, z) which obey the relations x 2 + y2 = 2, yz = 2. 8 What is the volume of the largest rectangular box with sides parallel to the coordinate planes which can be inscribed in the ellipsoid (x/ajl + (y/bjl + (Z/C)2 = I? -~ Figure 10-5 NUMUI.l(\"AL Ml:THOUS 541 9 leI ; -f(.~.l) he lhc cqll'llion or\" COlwe~ surface r lying abovc the .mil disk x' + r ' s: I. ant.! leI I' Ix ,m)' poml un r. LeI S be the region \"'hich is boundct.! hclow b), E, 011 lhe sides by lhe qli,a!cr r' + .l\" \"\" I. anti on lOP b) lhc langenl plane 10 r OIl I' (sec Fig. 10--6). For wh:n posillon of f' will S h,,,'c mininllllll volumc\"? 10.5 MISCELLANEOUS APPROXIMATION METHODS Since it is not possible to cover even superficially the whole field of numerical methods, we have chosen in this last section to discuss certain specific topics dealing with integration and differentiation. more as an indication of the use of other tLi:hniques in analysis than for their own merit. We start with the problem of finding a numerical estimate for an integral. Other aspects of this havc been treated in Chap. 4. specifically at the end of Sec. 4.3. where we described the use of the trapezoidal rule and Simpson\"s rule for integrals in one variable. We did not. however. discuss the estimation of the error involved. Suppose that f(x) is defined and continuous for all x. 0 S x s I. choose an integer II, and set II = 1/11. Wc adopt the special notation h for the value ., f(kll). Then. the trapezoidal estimate for I f = V is ·0 (l0·.1J) It is easily Sl\"Cn that this is III fact the integral on [0. I] of the piecewise linear 544 ADVANCED CALCULUS The resulting approximate integration formula is easy to implement in terms of the data values /ij' If Pij = (x;, Yj), then we assign weights as follows: If Pij is interior to D, let wij = 1; if Pij lies on an edge of D but is not one of the corners, set wij = t; if Pij is a corner of D, wij = t then, the desired estimate for the exact value V of the integral is T = h2 2, wiJ(Pij) As an illustration, ifj(x, y) = 1/(x + Y + 10), this method with n = 2 yields ( 1)2{1 ( 1 1 1 1) 1 (1 1 1 1 ) T = 2 4 10 + 11 + 11 + 12 + 2 10.5 + IO.S + ITS + iTS + (1) 10 + .IS+ .S} = .0910979 while the exact value can be shown to be .091 034 7 .... Turning to triple integrals, the same approach uses the approximating function F(x, Y, z) = Ao + A1x + A 2y + A 3 z + A4 xy + Asyz + A 6 xz + A 7 xyz and in implementing this, the data points can be weighted in a similar fashion, interior points having weight 1, interior points on a face having weight !, interior points on an edge having weight j, and each of the four vertices of the cube having weight l At times, much simpler methods can be useful. We have already observed in some of the exercises for Sec. 4.3 that the Schwarz inequality can provide useful estimates for one-dimensional integrals. The same is true of multiple integrals. For example, consider the integral ] = If Jx 2 - y2 dx dy D where D is the triangle with vertices at (0,0), (1, 1), (1,0). Schwarz' inequality gives us ]2 = {If JX- y~x+-ydx dyr D ~If (~x-=-yf dx dy If (JX+yf dx dy D D ~If (x - y) dx dy If (x + y) dx dy D D 1 1 = f !x 2 dx f ix 2 dx = ~ • 0 0 (10-36) (10-39) NUMERICAL METHODS 545 Thus, I::; }3/6 = .288675. (Since the exact value turns out to be n/(12) = .261 799''', we see that this approximation is not too far off.) We close this brief discussion of integration methods by illustrating one discovered by Gauss. The period of a simple pendulum, released from rest with an amplitude of eo is T=4J~(0Fos-:S~~~ If eo is 90 0 , we must evaluate the integral ,,/2 dcp (10-37) C - f - 0 Jcos cp If we substitute sin 2 e for cos cp, this becomes C ,,/2 de (10-38)- - r 2 - . 0 }COS2 e+ 2 sin2e Gauss considered the general integral ,,/2 de G(a,b)=fo Ja 2 cos 2 e+ b2 sin 2 e This can be converted easily into an elliptic integral of the first kind or expressed in terms of the hypergeometric function, 2F 1 (~,t 1; x). By using what is called a \"quadratic transformation\" for the functions 2F l' Gauss was able to show that G satisfied a rather unusual identity: (10-40) G(a, b) = G(a; b, jab) This in turn led him to the following numerical method for calculating the values of G. Define a pair of sequences {an}, {bn} by the recursion (10-41 ) ao = a an+ 1 = ~(an + bn) bo = b bn + 1 = j(iJJ;, Then, both sequences will converge to the same limit (Exercise 9), called by Gauss the arithmetic-geometric mean of a and b. Denote this common limit by L. Then, from (1O~40), we see that G(a, b) = G(an, bn) for all n, and since G is continuous, G(a, b) = lim G(an, bn) = G(L, L). However, this can be calcu- lated from (10-39), resulting in the formula given by Gauss: (10-42) n G(a, b) = 2L where L is the arithmetic-geometric mean of the pair a, b. The number L can be found very easily by calculating terms in the sequences {an} and {bn}, since the convergence is very rapid. To evaluate (10-37), we note from (10-38) that 546 ADVANCED CALCULUS C/2 = G(1, )2), and then obtain a. 1.2071 1.198 157 1.198 140 b. j2 1.1892 1.198124 1.198140 giving C = 2.622057. We remark that the methods developed in Sec. 6.5 can also be applied to (10-37), and yield C = ~~ r(±)lr(~). Numerical differentiation is far less used than numerical integration, although closely related formulas lie at the heart of the numerical methods for the solution of jifferential equations. Suppose we have available the values ofJat a discrete set of points near x = a; can we use these to estimate the values off'(a) andJ\"(a)? Sketches and analogies suggest the following: (10-43 ) (10-44) f'(a) ~ J(a + h) ;J(a - h) J \"( ) ~ f(a + h) - 2f(a) +f(a - h) a ~ h2 We wish to know how good these estimates are. The following result supplies an answer, assuming that we have some a priori information about f(3) near x = a. Theorem 10 Let IP3l(X)1 ::s; M on [a - h, a + h]. Then, the error informula (10-43) is less than h 2 M/6, and the error in (10-44) is less than hM/3. We start from Taylor's formula, with remainder, f(a + x) =f(a) + f'(a)x +J\"(a)x 2/2 + P3l(t)x 3/6 Using this with x = h and x = -h, we arrive at f(a + h) -f(a - h) = 2hf'(a) + {.f(3)(td +P3)(t 2 )}h3/6 and then, dividing by 2h, !f(a + h) 2~f(a- h) _ f'(a) I ::s; 1~:Ip3l (t j ) + f(3)(t 2 )1 h 2 < --- M - 6 In the same way, f(a + h) - 2f(a) + f(a - h) = h1'''(a) + {.f(3)(td - f(3)(t 2 )}h3/6 NUMERICAL METHODS 547 SO that If!{l ~hL-2~~a)+!(a -_h) -f\"(a) Is ~1.[(3)(t1) - f(3)(t 2)1 h <-M I-3 We note that this can be replaced by h2M*j3, where M* is an upper bound on P4) (Exercise 11). If more points are used, better estimates for f'(a) and f\"(a) can be found; several illustrations are found in the exercises. Generalizations for functions of several variables are also easily obtained. More detailed and more comprehensive information about numerical methods in analysis should be sought in the rapidly growing literature in this area. EXERCISES I Fill in the missing details m the proof of Theorem 9. 2 Estimate the values of the following integrals within .05. 1 (a) r e- x2 dx • 0 r 1 sin x (b) --- dx • 0 x 2 dx (e)r _.-- • 1 I + log x 1 3 Use Simpson's rule to estimate the value of r dx/(I + x), using the values offat the points 0, • 0 .25, .50, .75, 1.0. 4 Show that rr fA.-- - Ji5 V 4x 2 - y2 dx dy < .- .. 6 D where D is the triangle with vertices at (0,0), (1,0), (I, I). 5 Show that (e-x~;dx < I. o 6 Suppose thatf(O) = 1,f(I) = 4,f(2) = 4,f(3) = 3, and that f\"(x) S °for °s x s 3. What is 3 the best estimate you can give for f f? o 7 Estimate the value of r,'r dx dy dz ... 5+x+y+z D where D is the unit cube with opposite vertices at (0,0,0) and (I, I, I), using a decomposition of D into 8 subcubes and the trapezoidal method. 2 8 Estimate f sin (I/x) dx to within .01. o 9 Prove that the sequences {a.}, {b.} in (10-41) are superconvergent to a common limit. 548 ADVANCED CALCULUS 10 Use the method of Gauss (10-41) to verify the following computation: • ,/2 dO I --, .. - =.742 206 24 '0 jS-sin 2 IJ II Show that hM/3 can be replaced by h2 M*/3 if it is known that IP41(X)1 ~ M*. 12 Given thatf(.S) = 2.0./(.6) = 2.3./(.8) = 2.7, and If\"'(x) I ~ 4, estimate the value ofl'(.6) and /,,(.6) with error terms. 13 Obtain an approximate formula for I'(a) and/,,(a), making use of the five values f(a + kh) for k = 0, ± 1, ±2, and estimate its accuracy in terms of the maximum value of IP51(X) I or IP61(X)1 on the interval [a - 2h, a + 2h). 550 ADVANCED CALCULUS Here, we use the convention that \"(x)\" means \"for all x\", that \"(X)E\" means \"for all x E E\", that \"(3yt means \"there exists a y\", that \"(3Y)E\" means that \"there exists ayE E\", and that \"A --> B\" can be read \"if A then B\". The sets D and P are understood to be a set in the plane and the positive real numbers, respectively. However, there is one type of problem in which the use of a formalized language is very helpful. Suppose that we wish to prove a proposition of the form U --> V. The device of\" proof by contradiction\" amounts to the statement that it is equivalent to prove not V --> not U. (The fact that some persons have doubts about this will be discussed later.) The problem then is, knowing the statement\" V\", how can we formulate the statement \"not V\" in a simple and useful way? The simple routine which can be used is based upon the following semantic rules: not (X)E = (3x)E not not (3x)E = (X)E not not (A --> B) = A & not B not (A & B) = not A or not B not (A or B) = not A & not B not (not A) = A As a sample, let us apply these to find \"not V\", when V is the statement (*) above. Using (**), we first have not (P)D(3<5)P(q)D: Ip - ql < J --> f(q) < C Then, we move \"not\" past each quantifier in turn. The steps appear thus: (3p)D not (3J)P(q)D: Ip - ql < J --> f(q) < C (3P)D(J)P not (q)D: Ip - ql < J --> f(q) < C (3p)D(J)p(3q)D not: Ip - ql < J --> f(q) < C (3P)D(J)p(3q)D: Ip - ql < J & notf(q) < C Finally, which could be translated into the following less formal statement: there is a point p such that every neighborhood about p contains at least one point where f has a value as big as C As mentioned above, some logicians would object to certain of the equivalences listed above. Without entering into this in depth, this point of view can be appreciated in part by examining the first; we can translate Then LOGIC AND SET THEORY 551 to mean it is false that every x E E makes A(x) true The \"equivalent\" statement, (3x)£ not A(x) would translate there is an x E E for which A(x) is false But this statement might seem to convey that indeed you know an Xo E E and know that A(xo) is false, rather than that you merely know it is impossible for there not to exist such an x. The point here is one of existence vs. constructibility. In most cases, it is clearly better to have some algorithm for finding such an xo , rather than a theoretical proof that such an X o exists. Another topic that is often regarded as part of logic is the use of mathe- matical induction as a mode of proof. Strictly speaking, we are here dealing with properties of the system of whole numbers and similar systems. If S is a set of whole numbers which contains 1 and is such that, whenever it contains x, it must also contain x + 1, then S contains all the whole numbers. A familiar use of this is the proof that 1 + 2 + ... + n = n(n + 1)/2, for all n = 1, 2, .... Calling this proposition Pn , we observe that PI is true; then, let S = {all n with P n true}, and show that S is inductive, xES---+x+1ES and thus contains all whole numbers n. However, this same proposition is also proved in the following way: Let L=I+ 2 + 3 +\"'+n L = n + (n - 1) + (n - 2) + ... + 1 and adding, we have 2L = (n + I) + (n + 1) + ... + (n + 1) = n(n + 1) whence L = n(n + 1)/2. Is this argument less convincing than the appeal to mathematical induction? Is it logically valid? What is the role of\" .. ·\"? Finally, let us examine briefly some of the aspects of set theory. Although its importance to the foundations of analysis is undeniable, there is much of the theory of sets that has little relevance to advanced calculus. In particular, it does not seem to be essential at this level to understand the formal axiomatic approach. As an example, it does not seem necessary to examine the notion of ordered pair or triple, or to show that {a, {a, b}} is an adequate model for <a, b). The notion of infinite cardinal number is useful, however, and should be part of a student's experience. Excellent treatments can be found in many places, for example, in the book \"A Primer of Real Functions,\" by R. P. Boas, Jr., which is No. 13 in the Carus Monographs. Here, we shall mention only some aspects of countability and noncountability. 552 A[)VANCEIJ CALCl'I.lJS Two scts A and B arc said to have the same number of mcmocrs if there IS a function p A ..... 8 which Illaps A onto 8, 1-lo~1. Looked at tliffcrcmly. this is the samc as sayin£ that we havc used the members of 13 to label thc members of A, A set that has the same number of members as the sCI 1= {I. 2. 3. \".; of all whole numbers is said to be ('OII1/Iah/e. Any infinite sct that is not countablc is said to be /lollcolI/llable. 1. of coursc. is countable, as is the sct of all rational numbers, but the set of all real numhcrs is not countable. If wc idcntify the latlcr with uncnding dL-'Cimals, then it is easy to provc noncountability. Iflis a funclion from 1 into the real numbers in the closed interval [0, 1], thcn we can cxhibit a number Xo which is not in the range off All we necd do is to takc X o so that it differs at the 11th decimal from the 11th decimal of thc number f(n), with appropriate care to avoid decimals that terminate in a string of \"9\". More gcncrally, any set can be shown to Imvc more subsets than it lws members; in particular, the collection of all sels of inlegers is noncounlable. while the collection of all scts of real numbers has a cardinal number larger than thai of the set of real numbers itself. Onc says that a set A has at least as many members as the sel B if 13 am be paired, I-to-I, with a subset of A. A fundamcntal result about infinite sets is thc Schroedcr-Bernstein theorcm, asscrting thaI. if A has at least as man} members as B, and B has at least as many as A, then A and B have the same number of members. A simple proof of this tTI<lY be constructcd along the following lines. We are given Iwo functionsfand y. FA-B ~r B ..... A each l~to~l. but neithcr onto. We wish tll prcxlucc a function I,: A ..... B which is onlo and l-to-1. Suppose wc could split each of the sels A anti n, so that A is the union ofa subset C and the SCi A ~ C and B = 0 v(B - 0). in such a way that. as indicated in Fig. A I-I, y(O) = A - C and.f(C) = B - O. Then. the desired mapping 1r has been obtaincd, LOGIC AND SET THEORY 553 It is easy to show that we need only find the set C and can then determine D from it and that C must satisfy the identity C = A - g(B -f(C)) Define a function T on the subsets of A by T(5) = A - g(B - f(5)) For example, T(</J) = A - g(B), and T(A) = A - g(B - f(A)) c A. We are searching for a set C c A such that T(C) = C. The following steps complete the proof that such a set exists and thus prove the Schroeder-Bernstein theorem: i. Show that the mapping T has the property that if 51 c 52 C A, then T(5d c T(5 2 ) c A (T is monotone). ii. Let ~ be the class of subsets 5 c A such that T(5) c 5. (For example, A E K.) Show that, if 5 E K, then T(S) E K. 111. Show that any monotone mapping has a fixed set C, with T(C) = C. (Method: Define C to be the intersection of all sets S in ~.) APPENDIX TWO FOUNDATIONS OF THE REAL NUMBER SYSTEM The real-number system underlies all analysis. In the next few pages, we shall set forth its characteristic properties. We start with a definition: The real numbers constitute a complete simply ordered field. We expand this concise statement by explaining the meaning of the terms involved. Definition 1 A field is a set K of elements a, b, x, ... ,together with two functions + and\" called\" sum\" and\" product,\" which satisfy the following requirements: (F 1) closure If a and b are in K, then their sum {product} is defined and is a unique element ofK denoted by a + b {a' b}. (F 2) commutative If a and b are in K, then a+b=b+a a'b=b'a (F 3) associative If a, b, and c are in K, then a + (b + c) = (a + b) + c a'(b'c)=(a'b)'c 554 FOUNDATIONS OF THE REAL NUMBER SYSTEM 555 (F4) distributive If a, b, and c are in K, then a' (b + c) = (a' b) + (a' c) (F5) existence of neutral elements There are two special elements of K, denoted by °and I, such that for any x E K, x+o=x and x· I = x (F6) inverses For any a E K the equation a + x = °has a solution, and for any a E K except 0, the equation a . x = I has a solution. In working with a field, it is customary to use certain abbreviations. For example, according to (F6)' there is an element x such that a + x = 0; moreover, this element is unique, for if a + x' = 0, then x = x + °= x + (a + x') = (x + a) + x' = (a + x) + x' = °+ x' = x' + °= x' Thus, the element depends solely upon a, and we denote it by - a. The function \"difference\" is then defined by a - b = a + (- b). Likewise, if a \"# 0, then the solution of a . x = I is unique and may be denoted by a- 1 or I/a. We then define\" quotient\" by alb = a . (lib). On the basis of these postulates on K, all the familiar algebraic rules follow. To cite a few, one may prove that: (-a)·(-b)=a·b a'O = ° (alb )(cld) = (a . c )/(b . d) (alb) + (cld) = (a' d + b· c)/(b' d) a' b = ° only if a = °or b = ° The notion of an ordering relation may be introduced most easily by means of a set of positive elements. Definition 2 A field K with a simple order is one in which there is a subset P (called the set of positive elements) such that: (Od Ifa and b are in P, then so are a + b and a' b. (0 2 ) The zero element, 0, is not in P. (0 3 ) fr x is any element not in P, then x = 0, or - x E P. To convert these postulates into more familiar properties, one defines a relation> on K by: a> b if and only if (a - b) E P. The conditions (Od, (0 2 ), (0 3 ) imply the usual properties of >. For example, a> °is equivalent to saying that a belongs to P. Requirement (Od then implies that if a > b and b > c, then a > C, and if d > 0, then a . d > b . d. The equivalent form of 556 ADVANCED CALCULUS (0 3 ) is the statement that if a and b are any elements of K, then either a = b, a > b, or b > a. An ordering relation > which has this last property is said to be simple or linear; many important ordering relations are partial orderings in which this law fails, and two elements a and b may be incomparable. We note one important consequence of the existence of a simple order in K, namely, that the sum xi + x~ + ... + x; is always positive (> 0) unless Xl = x 2 = ... = X n = O. Finally, we come to the notion of completeness of an order relation. As we shall see, this has many equivalent formulations. One of these may be described in terms of what are called Dedekind cuts. A cut in K is a pair A, B, where A and Bare nonempty subsets of K whose union is K and such that a ::;; b whenever a E A and b E B. Any element c of K can be used to generate a cut by taking A as the set of all x E K with x ::;; c, and B as the set of all x E K with x 2 c. Definition 3 A simple ordering on a field K is complete if every cut in K is generated by an element of K. Some additional comments are in order. The real field R is not the only example of a field. One familiar example is the complex field C. Definition 4 The complex field C is the class of all ordered pairs (a, b) with a and b real numbers, and with sum and product defined by (a, b) + (x, 1') = (a + x, h + 1') (a, b)· (x, y) = (ax - by, ay + bx) One may verify that C satisfies the field axioms F l' ... , F 6' For example, 0= (0,0),1 = (1,0), -(x,y)= (-x, -1'), and ( X - y ) (x, yr 1 = (;2+-}-;-2)' (x2 .; 1'2) If we write (0, 1) = i and (a, 0) = a, then (x, 1') = x + iy, where i 2 = - I. The usual algebraic operations may now be used. The complex field cannot be given a simple order; as we have seen, in any simply ordered field, it is necessary that x 2 + l #- 0 except when x = l' = O. This fails in C, since 1 2 + i 2 = O. Other examples of fields may be obtained from R. A subset 5 of R is called a subfield if 5 is a field under the operations of R; one need only verify that if a and h are any two elements of 5, then a + h, a . h, - a, and if b #- 0, lib are all members of 5. The smallest subfield of the real field is called the rational field R o . The elements of the rational field are the rational numbers; each may be represented in the form alh, where a and b belong to the special subsystem called the ring of integers Z. Every element in Z is expressible as /11 or -/11 or 0, where m is in Z+, the system of positive integers FOUNDATIONS OF THE REAL NUMBER SYSTEM 557 (whole numbers). As a subfield of R, the rational field R o is simply ordered. The class of positive elements of R o can be taken as Po = P n R o . However, unlike the real field, Ro is not a completely ordered field. The Dedekind cut (A, B) in Ro defined by A = {all x E Ro with x 3 < 2} B = {all x E Ro with x 3 > 2} is one which cannot begenerated from an element in Ro . In R, the corresponding cut is generated by J2, but this number is not present in Ro . With this preparation, we state without proof the fundamental result dealing with the real field: any two fields which are completely ordered are isomorphic. This gives one the right to speak of the real field, and guarantees that the description we have chosen is adequate. To explain by illustration the meaning of \"isomorphic,\" we give another construction of the complex field. Let C* be the collection of all 2-by-2 matrices with real entries and having the form For multiplication, use the customary product operations for matrices, and add matrices by adding corresponding entries. Then, one may again verify that C* is a field. The correspondence r a baj-a+bi=(a,b) I-b is an isomorphism between C* and C. (This class of matrices also appears in another connection in Theorem 10, Sec. 8.4. Nor is this entirely a coincidence; conformal transformations are locally expressible as power series with complex coefficients.) Having obtained a categorical description of the real numbers, is it sufficient to proceed by fiat; \"let R be a completely ordered field,\" and then continue from there? This would leave open the possibility that there might not exist such a field, due perhaps to some undiscovered inconsistency in the postulates. To avoid this, we may attempt to construct an example of such a field, building up from a simpler system whose existence we are willing to accept. This process has been set forth in great detail in Landau, \"Grundlagen der Analysis,\" Leipzig, 1930. We sketch such a construction in a sequence of steps. Step I. Construction of R from R o . Two methods have been used here. The first method is conceptually simpler. Ro is an ordered field which is not complete. Some of its Dedekind cuts can be generated by elements of R o and some cannot. Define R to be the collection of all cuts. Those that can be generated from elements of R o are identified with the corresponding element of R o and are rational numbers; those that cannot be so generated are the 558 ADVANCED CALCULUS irrational real numbers. One then defines sum and product of cuts, and verifies all the postulates for R. The second method is easier to carry out. Working only with rational numbers, we define convergence of sequences of rational numbers, and Cauchy sequences of rational numbers. It is no longer true in Ro that every Cauchy sequence converges. Consider the collection K of all Cauchy sequences of rational numbers, and introduce a notion of equivalence by saying that {an} :::::; {bn} if and only if limn~oo (an - bn) = O. This splits K into equivalence classes. Each of these is now called a real number. The product and sum functions are now defined, and the postulates verified. Step 2. Construction afRo from Z. Consider the collection ;J/> of all ordered pairs of integers (Ill, n) with III i= O. Thinking of (m, n) as representing the rational number n/m, a notion of equivalence is defined in .J/> by (Ill, 11) ~ (m', n') if and only if mn' = m'n. This again divides ;J/> into equivalence cla\\\\c\\ Each of these classes is called a rational number: with appropriate definilillns for sum. >, and product, R o is seen to be an ordered field. Step 3. Construction of Z from Z+, the positil'e whole numhers. Again. one considers a collection of ordered pairs (m, 11) where m and n are in ['. With (m, n) being thought of as corresponding to the integer m - n, one says that (111, n) :::::; (m', n') if and only if m + n' = n + m' The resulting equivalence classes are called the integers. The rest goes as before. Step 4. Construction of Z + from axiomatic set theory. Within an adequate system of logic, one may define the notion of cardinal number for finite sets. From this, one may then obtain Z+. We conclude this discussion of the real-number system by giving some of the equivalent ways in which the completeness property, which is so character- istic of R, can be obtained. Most of these involve results which we have assumed, or which have been proved from others which we have assumed. In the chart in Fig. A2-1, we have indicated by arrows certain mutual implications which hold among these. The branched arrows on the right side of this diagram indicate that the combination of the Archimedean and Cauchy convergence property jointly implies all the rest (which are seen from this diagram to all be equivalent to one another). It may seem surprising that the Cauchy property alone is not enough. This is true because the statement that a given sequence has the Cauchy property is actually a very strong statement, and one cannot prove that a bounded monotonic sequence is Cauchy without using the archimedian property-which is itself equivalent to the assertion that the sequence {1/11] converges to O. In fact, there exist non- archimedean fields in which the only Cauchy sequences are ultimately constant. while there are bounded monotonic sequences that diverge. This discussion should not end without a mention of oc and - ex;. These are to be regarded as .. ideal\" points adjoined to the real field R. The FOUNDATIONS OF THE REAL NUMBER SYSTEM 559 Nested- interval property Dedekind Connectedness completeness of the line ~~ / Heine-Borel LUB Archimedean theorem property -- property ML'ol__ ) ~,::r I Bqlzano- Cauchy -----. Weierstrass----- sequences theorem converge Figure A2-1 neighborhoods of ware defined to be the intervals {all x with x > b] and the neighborhoods of - x are the intervals {all x with x < h) Using these, we see that the sequence {x n ] with X n = n is convergent to x and that every sequence of real numbers has a limit point in the extended system. The new points x and - x do not participate fully in the algebra of R; in particular, the new system is no longer a field. One may attach meaning to some of the operations, but not all; for example, we may define x + c to be x for all c E R, but no meaning within the new system is attached to ex + (- x ). The adjunction of 00 and - 00 to R is done with the aim of achieving compactness. This may also be done in other ways. If c/> is a transformation which is I-to-I, bicontinuous, and which maps R onto a set A in a compact set S, then the closure of A in S is a compactification of R. The boundary points for A which do not lie in R form the ideal points which are to be adjoined to R. As a simple illustration of this, let S be the circle of radius I, center C = (0, I), and let c/> be the transformation mapping the point (x, 0) on the horizontal axis (= R) into the point p on S which lies on the line through (x, 0) and Q = (0,2). It is easily seen that the image of R is the set A consisting of all points on S except Q. The closure of A is S itself, and Q is the only boundary point of A which does not lie in A. Thus, R may be compactified by adjoining a single point \"at infinity\" whose neighborhoods are the sets (all x with IxI > c). With the same choice of S, we may take c/> as the transformation mapping (x, 0) into the point of S lying on the line through (x, 0) and C; the closure of the image set A is a semicircle whose endpoints APPENDIX THREE LINEAR ALGEBRA This is intended to be a brief synopsis or review of those aspects of linear algebra and matrices which are most needed for the topics in analysis that are studied in Chaps. 7, 8, and 9. Proofs and complete discussions can be found in any of the large number of current texts in linear algebra. The definition of a linear (or vector) space has been given in Sec. 1.2; the associated field K of scalars is usually either the real numbers R or the complex numbers C. Standard examples of real linear spaces are Wand C[l]. We use Kn for the space whose points are n-tuples of scalars (c l , Cz , ... , cn) from K. If V is a linear space and MeV, and if AU and U - [\" belong to M for every u and [' in M and every scalar A E K, then M is a linear subspace of V. If U = {Ub Uz , ... J is a collection of points in a linear space V, then the (linear) span of the set U is the set of all points of the form\"\" Cj Uj, where c j E K, and .:........, all but a finite number of the scalars Cj are O. The span of U is always a linear subspace of V. A key concept in linear algebra is independence. A finite set Ul' Uz, ... , Uk is said to be linearly independent in V if the only way to write 0 = \"'. Cj Uj is .:........, by choosing all the cj = O. An infinite set is linearly independent if every finite subset is independent. If a set is not independent, it is linearly dependent, and in this case, some point in the set can be written as a linear combination of other points in the set. A basis for a linear space M is an independent set that spans M. A space M is finite-dimensional if it can be spanned by a finite set; 562 LINEAR ALGEBRA 563 it can then be shown that every spanning set contains a basis, and every basis for M has the same number of points in it. This common number is called the dimension of M. Another key concept is that of linear transformation. If V and Ware linear spaces with the same scalar field K a mapping L from V into W is called linear if L(lI + 1\") = L(u) + L(v) and L(AU) = AL(u) for every u and v in V and Ie in K. With any L are associated two special linear spaces: ,j '(L) = ker (L) = null space of L = Cj(O) = {all x E V such that L(x) = O} 1m (L) = image or range of L = L(V) = [all L(x) for x E V] The first is a subspace of V, and the second a subspace of W L is a I-to-l mapping (injective) if and only if ,V(L) = {O}, and L is an onto mapping (surjective) if and only if 1m (L) = W. A linear transformation that is both I-to-I and onto is called an isomorphism; two spaces V and Ware called isomorphic if there is an isomorphism L mapping V onto W. The inverse C j then exists and is an isomorphism mapping W onto V. Any space M of dimension n is isomorphic to the space Kn. If {Uj' U2 ' •.. , un} is a basis for M, then every point x in M can be written uniquely in the form L Ci Ui ' Ci E K, and the required isomorphism L is defined by L(x) = (c j , C2 , •.• , en)' All linear spaces of the same dimension are isomorphic. Henceforth, all the linear spaces discussed will be finite-dimensional. With any linear L mapping V into W, two integers are useful: r = rank (L) = dimension of 1m (L) k = nullity of L = dimension of. j '(L) If V has dimension n. it can be shown that r + k = n. If W also has dimension n, then the following useful criterion results: L is I-to-l if and only if L is onto. In particular, if L is a linear map of V into itself, and the only solution of L(x) = 0 is 0, then L is onto and is therefore an isomorphism of V onto V, and has an inverse C 1. Such a transformation of V onto itself is also said to be nonsingular. Suppose now that L is a linear transformation from V into W where dim (V) = 11 and dim (W) = Ill. Choose a basis [I\"j, 1'2' ... , I\"nl for V and a basis {Wj' W 2 , ... , wm: for W. Then, these define isomorphisms of V onto Kn and W onto Kill, respectively, and these in turn induce a linear transformation A between these, as shown in Fig. A3-1, such that L(I\") = ljJ-l A¢(I')' Any linear transformation (such as A) between K\" and Kill is described by means of a matrix [aia, according to the formula A(x) = .\\', where x = (x j, x 2 , ... , x n ), 564 ADVANCED CALCULUS V .....cL=-- ... W K\" --.-. Km A Y = (YI' Yz, ... , Ym), and Figure A3-1 (A3-1) n Yi = L Qijx i j= I i = 1,2, ... , m The matrix A is said to represent the transformation L and to be the representa- tion induced by the particular basis chosen for V and for W. (A different choice of basis would produce a different numerical matrix A.) All the properties of the transformation L are mirrored in terms of properties of the system of linear equations (A3-1) and the numerical matrix A, and do not depend on the choice of bases. Thus, the rank of L is the dimension of the subspace spanned by the columns of A, which is the same as the number of columns of A that are linearly independent; if the rank is m, then equations (A3-1) have a solution for any choice of y, since T is then onto, and Theorems 6 and 7 of Sec. 7.3 follow. When V = W, so that n = m, then the matrix A is square and (A3-1) is a system of n linear equations in the n unknowns x j . The transformation L is nonsingular if and only if A is of rank n, which means that its columns are linearly independent, and which is therefore equivalent to the assertion that (A3-1) has a unique solution for any choice of Yi; in particular, this must hold if and only if L is I-to-I, which means that the null space of L is {O}, and which is equivalent to the assertion that the homogeneous equations 0 = L~=I Qijx j have only the obvious solution XI = X z = ... = x n · If Sand Tare iinear transformations of V into itself, so is the composite transformation ST. If we choose a basis in V, and use this to obtain matrix representations for these, with A representing Sand B representing T, then ST must have a matrix representation C. This is defined to be the product AB of the matrices A and B, and leads to the standard formula for matrix multiplica- tion. The least satisfactory aspect of linear algebra is still the theory of deter- minants-even though this is the most ancient portion of the theory, dating back to Leibniz if not to early China. One standard approach to determinants is to regard an n-by-n a matrix as an ordered array of vectors (u I, U z , ... , un), and then its determinant det (A) as a function F(uJ, uz , ... , un) of these n vectors which obeys certain rules. F is required to be multilinear (i.e., linear in LINEAR ALGEBRA 565 each position), so that, for example, F(AU 1 , U2' , un) = AF(u 1, U2' ... , Un) F(v + W, U2' U3' , Un) = F(v, U2, ... , Un) + F(w, U2' U3, ... , Un) and alternating, so that for every k i' 1, and normalized by F(e 1, e2' ... , en) = 1, where e 1 = (1,0,0, ... ,0), e2 = (0, 1,0,0, ... ,0), etc. One is then able to show that there is exactly one such function, which not surprisingly turns out to coincide with the college algebra notion of determinant for n = 2 and n = 3. The determinant of such an array A turns out to be a convenient criterion for characterizing the nonsingularity of the associated linear transformation, since det (A) = F(Ul' U2, ... , un) = °if and only if the set of vectors ui are linearly dependent. There are many other useful and elegant properties of determinants, most of which will be found in any classical book on linear algebra. Thus, det (AB) = det (A) det (B), and det (A) = det (At), where At is the transpose of A, obtained by the formula At = [Q;;], thereby rotating the array about the main diagonal. If a square matrix A is triangular, meaning that all its entries above the main diagonal are 0, then det (A) turns out to be exactly the product of the diagonal entries. Even though the determinant is calculated from a matrix representation of a transformation L, it does not depend upon which representation is chosen. For, if a particular choice of basis for V yields the matrix A, then a different choice of basis will merely give rise to an isomorphism of V, and replace A by the matrix B = PAP- 1, where P induces the required isomorphism. However, det (B) = det (P)det (A)det (P- 1 ) = det (A) det (P) det (P- 1 ) = det (A). Thus, one is justified in speaking of the determinant of a transformation L: V --+ V rather than the determinant of matrices alone. Another useful concept is that of eigenvalue. A scalar is said to be an eigenvalue for a transformation T if there is a nonzero vector v with T(v) = AV. It is then clear that the eigenvalues will be those numbers A E K such that T - A.I is a singular transformation. Any vector in the null space of T - A.I is called an eigenvector of T associated with the eigenvalue A, and their span the eigenspace, El' It is invariant under the action of T, meaning that T carries E l into itself. The eigenvalues of T are then exactly the set of roots of the polynomial p(A) = det (T - U). If A is a matrix representing T, then one has p(A) = det (A - AI), which permits one to find the eigenvalues of T easily if the dimension of V is not too large, or if the matrix A is simple enough. The eigenvalues and eigenspaces of T provide a means by which the nature and structure of the linear transformation T can be examined in detail. The theory of linear algebra is rich, and cannot be summarized with any brevity. We conclude this sketch by mentioning two other topics. Given a linear space V, we can consider the scalar-valued linear function! on V. Denote 566 ADVANCED CALCULUS the collection of all these by V*; this is itself a linear space, usually called the (algebraic) dual of V. If V has dimension n, then V* also has dimension n; if Ui is a basis for V, then a basis for V* consists of the functions;; where .(;(uj ) = 1>ij, using the special symbol introduced in Sec. 6.6 in connection with orthogonality. Borrowing another notation from that section, we write <1, v) for J(v) for any JE V* and v E V. Suppose now that we have a second linear space Wand its dual space W*, and suppose that T is a linear transformation from V into W. Given any 9 E W*, we can construct a linear function J on V by writing J(x) = g(T(x)). We use this to define a transformation T* of W* into v* by T*(g) = f T* is the adjoint of T, and is linear. The relation between T and T* can also be given more simply by the equation <g, Tv) = <T*g, v) which holds for all 9 E W* and v E V. These relations are especially useful when V = Wand v* = W*. Every linear mapping of V into itself induces a dual mapping of v* into itself. It is easily seen, for example, that Tis I-to-l if and only if T* is onto. If V = Rn, and if V* is also identified with Rn, then every linear functionalJ has the form of an inner product J(v) = <u, v) = u· v. Given any symmetric matrix A (for which A = AI), one may introduce the bilinear function B(u, v) = <u, Av) and the associated quadratic form Q(x) = <x, Ax) = B(x, x). The study of the canonical forms of quadratic forms and their corresponding geometry is an important part of the theory of linear algebra. In analysis, it is useful to consider the class of positive definite quadratic forms Q(x) for which Q(x) > 0 for all x#-O in Rn. It is possible to give a criterion by which one can test a matrix A to see if it yields a positive definite quadratic form. Let A k denote the matrix obtained from A by deleting the last n - k rows and columns. Thus, if A = [aij] with i,j running from I to n, then A k = [aij] where i and j now run only from 1 to k. Then Q(x) is positive definite if and only if det (A k ) > 0 for k = 1,2, ... , n. Proofs of these, and a much more complete discussion of all these topics, may be found in references [17], [19], [21], and [22] in the Reading List that follows these appendices. APPENDIX FOUR APPLICATIONS OF MATHEMATICS Regardless of their ultimate interests and careers, students of mathematics ought to understand something about the way in which mathematics is used in applications and the complicated interaction between mathematics and the sciences. For many mathematicians engaged in pure research, contact with other sciences may be infrequent; they are apt to see their subject as one that is largely self-sufficient, breeding its own subdisciplines and creating its own research problems, with only occasional stimulus from outside. Others who are more directly involved in neighboring disciplines may find it difficult to agree with this position, and indeed may lay great stress upon the role of the physical sciences as a source for mathematical ideas and techniques. Both attitudes of course are wrong, because both are incomplete; at the same time, both are at least partially correct. If there is any basic error of the applied mathematician, it is in an attitude that segregates certain areas of mathematics as being those which \"are applied\" and dismissing the rest as belonging to the non useful arts. Many mathematicians share with us the belief that any branch of mathematics could become applied overnight in the right hands. What is then the role of mathematics in the sciences? Why is it important, and what part does it play in the development of a subject? We think that mathematics offers the scientist a vast warehouse full of objects, each available as a model for various aspects of physical reality. The richness and diversity of this supply are central reasons for the importance of mathematics; another 567 568 ADVANCED CALCULUS Figure A4-1 cal Physical ------ Predictions reality Mathemati technique Physical Mathematical approximation model is that, along with the objects, mathematics offers a system for using the models, to help raise or answer questions about physical reality, and techniques for exploring the behavior of the models themselves. Figure A4-1 may help in visualizing this relationship. We start from physical reality (whatever that may be) and proceed from this to what we have called a physical approximation. To think of a specific situation, suppose that the physical reality is a simple pendulum consisting of a spherical weight mounted at the end of a metal bar and swung from a pivot. In creating the physical approximation, we may make statements such as the following: \"I think we should assume Newton's laws, disregard air resistance, assume that the pivot has zero friction and that the mass of the bar is negligible in comparison with the weight.\" At this stage, the next step is to construct (or select) an appropriate mathematical model. The model could be something as simple as a quadratic equation, or it could be a complicated differential equation, or it could be a topological manifold with a group of measure-preserving mappings acting on it. At the next stage, the scientist or mathematician begins to explore the properties of the model, using mathematical techniques, and to answer specific questions that have been translated from questions about the physical reality or the physical approximation, so that they become meaningful questions about the mathematical model. The final step, of course, is the comparison of these answers with what is known about physical reality from observation or experiment and the evaluation of the success of the model and the correctness of the scientist's intuition. It is very important not to confuse the model with reality itself. A model is most useful when it resembles reality closely, but there will always be aspects of reality that it does not reproduce, and it will always predict behaviors that do not in fact occur. The skill of the scientist is in knowing how far, and in which contexts, to use a particular mathematical model. One simple illustration may help here. Physicists sometimes speak of light as a wave, and sometimes as a particle. Which is it? Obviously, neither, for APPLICATIONS OF MATHEMATICS 569 Plvol I I I I I I I ___ -_-L_--- Figure A4-2 these are names for specific mathematical models, and neither one is the physical reality that is light itself. Both successfully predict (Hexplain\") some of the observed phenomena of light; each is unsuccessful in predicting others. The moral is clear: One should never expect to have only one correct mathematical model for any aspect of reality. Let us continue with the specific example of the pendulum. We shall raise two questions about its motion and attempt to obtain answers from appropriate mathematical models. We move the weight out to form an initial angle (}o and then release it from rest. (i) What is the speed of the weight as it passes the lowest point of its swing? (ii) How long will it take to return (approximately?) to its original position? (See Fig. A4-2.) The various assumptions that underlie the physical approximation can be listed: a. We assume that the rod is rigid, of constant length L, and of zero mass. b. We assume that the weight can be treated as a particle of mass M. c. We assume that there is no air resistance and no friction at the pivot and that the only external force present is a constant vertical gravitational attraction. d. We assume Newton's laws. From these, in the usual way, we arrive at a differential equation for the pendulum motion. We assume that the mathematical description of the motion will be a function ¢ such that () = ¢(t) will specify its position at time t. Then, we arrive at or . d d ( d(})-Mgsm(}=· (Mv) = ML dt dt dt d20 g. 1 2= - sm 0 (( L t = 0 570 ADVANCED CALCULUS We must also translate into its mathematical equivalent the information about the mode of release of the pendulum. This becomes the set of initial conditions: dO = 0 dt Finally, we translate the pair of questions into the following: 1. What is the value of dO/dt when 0 = O? ii. What is the value of t when 0 = 00 ? We could now forget completely that we are concerned about a pendulum and pose the following\" pure\" mathematics problem: Find a function ¢ defined for all t ~ 0 such that ¢(O) = 00 , ¢'(O) = 0, and ¢\"(t) + (f sin ¢(t) = 0 t ~ 0 L Specifically, find ¢'(t) at the first value of t for which ¢(t) = 0, and find the first value of t > 0 for which ¢(t) = 00 , This can be treated in this form; for example, we have 2¢'(t)¢\"(t) + 2g ¢'(t) sin ¢(t) = 0 L and, integrating, (¢'(t))2 - 2g cos ¢(t) = const = C L Since we are to have ¢(O) = 00 , ¢'(O) = 0, we have 2g 0- cos 00 = C L and finally arrive at (¢'(t))2 = i {cos ¢(t) - cos eo} from which we obtain an answer to the first question: putting t = t l' where ¢(t 1) = 0, we find the speed at the bottom of the swing to be V = Ji JI - cos 00 = 2 J~sin C;) [Notice that this solution is predicated on several mathematical assumptions: (i) that indeed there is such a function ¢, (ii) that there is such a value t 1 where ¢(t d = O. Both of these can be proved by more detailed mathematical analysis of the differential equation; both are also implied by the physical reality, if we could be sure in advance that the model imitates reality.] (A4-1) APPLICATIONS OF MATHEMATICS 571 In the same way, an answer can be found for the second question, and we find the length of the period (the time taken from release to first return) to be J L .90 de T=4 I J ~- 2g . 0 cos e- cos Do More generally, some of the other predictions which arise from this model are as follows: The motion is periodic, and never ceases. The period depends in a simple way upon the length L and in a more complicated way upon the initial amplitude Do of the swing. If we were to modify the physical approximation by altering some of the assumptions (a) to (d), we would arrive at a new mathematical model. We could, for example, bring in resistance, or we could treat the rod as having mass, or we could assume the rod slightly flexible or slightly elastic so that it could change its length, etc. Each change would lead to a new and more complicated mathematical model. Our intuition tells us that these would be more likely to reproduce reality better; we would, for example, expect that the model will not exhibit complete periodicity, and that the amplitude will now decrease with time. There is, however, another way in which a mathematical model such as this can come to be modified. When a model has been constructed, it may be of such a nature that present mathematical techniques do not suffice to explore its behavior satisfactorily. In this case, one might wish to replace the model with another that is similar but easier to work with; moreover, the choice may be made for purely mathematical reasons, divorced completely from physical motivations. This is the case with the pendulum problem we have just treated, and one often finds it stated that the following differential equation is the equation of motion of a pendulum: ~ t = 0 • D= eo jdejdt=O in which we have replaced sin D bye. Being a linear equation with constant coefficients, this is more easily solved, and we find e= <jJ(t) = Do cos (Jf t) V = Jfeo T = 2nfiTg It should be noted that the predictions from this model are somewhat different. For example, the length of the period is now independent of the initial 572 ADVANCED CALCULUS amplitude 00 , and the values of V are not the same. (For 00 = n/2, the difference is 10 percent.) Would it be correct to say that the second model is bad and the first good, or that only the first deserves to be called the motion law for a pendulum? To agree with these would be to overlook the moral; both are models, and neither is the model; both have limited usefulness, and both represent different ap- proximations to various aspects of reality. The rapid growth in the potential and use of high-speed computers is having a striking effect upon this whole picture. Already, scientists are able to use them to explore the behavior of mathematical models of great complexity, and thus to simulate large-scale systems that were formerly quite unmanageable. At the same time, mathematicians are able to acquire some intuitive understanding of the qualitative nature of these systems, which is the first step toward their complete analysis. While the main concern of this book has been analysis, in the mathematical sense, many topics and illustrative examples have been chosen because of their connection with applicable mathematics. This is evident in Chaps. 7, 8, and 9, and particularly so in Sec. 9.6 and Chap. 10. Suppose that we wish to study the interaction of several charged particles. It is then convenient to think of one particle creating, by its presence, a \"field\" throughout space; the second particle is then regarded as interacting with this field, rather than with the particle itself, directly. From this viewpoint, it is only a step to the observation that the second particle also creates a field, and that we are really concerned with the interaction of two fields; the particles may in fact be regarded as unnecessary fictions. The result can be a theory of physics based upon fields alone. Some fields are\" particle-like\" and may have other attributes associated with them such as \"charge,\" \"mass,\" \"momentum,\" etc. Other fields may lack these attributes, or have others called\" spin,\" \"charm,\" etc. The simplest fields will be numerical- or vector-valued functions defined on all of 4-space (= space-time), but one may also wish to work with fields whose values are matrices, differential operators, probability distributions, measures, points in an infinite-dimensional function space, etc. The boundaries of the realm of applicable mathematics are indeed flexible, and change with each generation. or APPENDIX FIVE INTRODUCTION TO COMPLEX ANALYSIS Although it has great importance as an active branch of pure mathematics, the theory of holomorphic (also called analytic) functions owes its existence and much of its prestige to the success which it has had in dealing with problems in the field of differential equations, hydrodynamics, and potential theory. It came into independent existence late in the nineteenth century, when the traditional \"theory of functions\" was separated into \"real variable theory\" and \"complex variable theory,\" under the pressure of a more rigorous con- sideration of the concept of set, number, integral, and derivative. To a historian of mathematics, complex analysis is especially interesting because of its role in the birth of algebraic topology and because of its surprising connections with the theory of numbers and with algebra. In a brief summary such as this, it is impossible to do more than indicate some of these connections and to describe a few of the main results and techniques. Most of the details are omitted but may be sought in the references cited at the end. In the present book, the central subject of study has been the class of continuous real-valued functions defined on sets D in n space and, more generally, the class of continuous transformations T mapping a set D in n space into a set in m space. What would be the effect on the former if we were to allow functionsfwhich could take complex values? Such a function might be F(t) = 3t sin t - 3i cos t G() -/. 4st s, t = 3se + I 2--:2 s + t 573 pED 574 ADVANCED CALCULUS More generally, any complex-valued function F defined on a region D in R\" has the form F(p) = f(p) + ig(p) where f and 9 are real-valued functions defined on D. In this case, we speak off and 9 as the real and imaginary parts of F, respectively; the complex conjugate of F is the function F defined by F(p) = f(p) - ig(p) Note thatf = (F + F)/2 and 9 = (F - F)/2i. A complex-valued function F is continuous if and only if its real and imaginary parts are continuous. Similarly, we can speak of the differentiability of F and define partial derivatives of F in terms of the derivatives off and g. For example, with F(t) as given above, F'(t) = 3 sin t + 3t cos t + 3i sin t and ~.G(s t) = 3e- 1 + i ts 22 t_ 2 )(4t) - (4st)(2s) as ' (S2 + t2)2 From one point of view, the introduction of complex-valued functions brings in nothing basically new. If we identify the complex number a + bi with the point (a, b), then a complex-valued function F defined on a region Dc R\" becomes merely a mapping from D into R 2 • Indeed, if F(p) = f(p) + ig(p), then we can write F(p) = u + iv = (u, v) and identify F with the transformation Ju = f(p) \\v=g(p) Likewise, the function h(t) = t + it 2, 0 ~ t ~ 1, can be regarded simply as a curve (parabola) in the plane. However, if we look at certain functions that are complex-valued and defined on subsets of the plane (or, more generally, defined on subsets of R 2k for some k), then something new emerges. The reason for this is that the complex numbers are more than R 2 and in fact have the algebraic structure of a field. Writing x + iy = z, we can single out a special class of complex functions defined on R 2 . Let Co, c l , cz , ... , C\" be complex numbers, and define a complex-valued function F by F(x, y) = W, where W = Co + CIZ + czz z + ... + c\"z\" = P(z) Here, P is a polynomial with complex coefficients. If we separate into real and imaginary parts, we arrive at a formula for F of the form Ju = A(x, y) \\v = B(x, y) INTRODUCTION TO COMPLEX ANALYSIS 575 where A and B are real polynomials in x and y. For example, the equation w = Z3 - 3iz + (I + i) can be written as Ju = x 3 - 3x/ + 3y + 1 (A5-I) T: lv = 3x 2y _ y3 _ 3x + I In a similar manner, writing ZI = XI + iYI' Z2 = X 2 + iY2' etc., we can define certain special complex functions on the space R 2m of points p = (XI' .1'1' X 2 , Y2\" .. , x m' Ym) by w = P(ZI' Z2' ... , zm) where P is a polynomial in m variables over the complex field. This, too, can be separated into real and imaginary parts, obtaining a transformation from Rm into R 2 of the form ju : A(xI' >:b x 2 ' >:2' ,x m, ~m): A(p) \\v - B(x l , >1' X 2 ' h, , X m' >m) - B(p) Such functions are special examples of the class of functions to which the name \"holomorphic\" is given, and the study of complex analysis is very largely the study of properties of holomorphic functions; the name\" analytic\" is also used, even though this is also used in another, closely related sense. Before defining the general class of holomorphic functions, we could ask if there is some special property which will enable us to identify one of these special holomorphic polynomial mappings, within the class of all polynomial mappings. We shall henceforth consider only functions of one complex variable, and thus deal with mappings from R 2 (the Z plane or the XY plane) into R 2 (the W plane or the U V plane). The answer to this question is given by the following theorem: Theorem 1 A mapping F, given by the equations ju = A(x, y) \\ v = B(x, y) where A and B are real polynomials, has the form w = P(z) for a complex polynomial P if and only if the differential of F has the form at each point z. Since the differential of F is given by [ au ax dF= av ax au] a>,. av 8y (A5-2) 576 ADVANCED CALCULUS this is equivalent to asserting that the functions u and u obey the system of differential equations j :~= :~, au au - =: - -_. ay ax (These equatIOns are called the Cauchy-Riemann equations; they arose in another connection at the end of Sec. 8.4.) To check this result, we observe that the differential of the mapping given in Eq. (A5-1) is f 3X2 - 3y 2 dT= 6xy - 3 -6xy + 31 3x 2 - 3/ J The proof of Theorem 1 may be based upon the following observation: The\" remainder theorem\" of elementary algebra implies that a polynomial P has the property that, for any zo, P(z) - P(zo) = (z - zo)Q(z) = (z - zo)Q(zo) + (z - zo)2R(z) where Q and R are polynomials. On the other hand, the approximation property of the differential of F shows that P(z) - P(zo) = dF I (z - zo) + R(z, zo) '0 Comparison of these shows that for any ~z = (~x, ~y) one must have dF I (~z) = Q(zo) ~z '0 If Q(zo) = a + bi, then this yields ra b -bal dF 1'0 l J as asserted in the theorem. From this point, there are several ways to arrive at the class of general holomorphic functions. One is based on the behavior of power series with complex coefficients. Certainly, the most obvious generalization of a polynomial is the function defined by j(z) = ao + at(z - c) + a2(z - C)2 + a3(z - C)3 + ... If this series converges for some value of z other than c, then it is easy to see that it converges for all z in the neighborhood of c and that the real and imaginary parts of the resulting function obey the Cauchy-Riemann equations (A5-2). For example, exp (z) = ')00 zn/n! converges for all z and has real part \"\"\"\"'0 INTRODUCTION TO COMPLEX ANALYSIS 577 u = eX COS y, imaginary part v = eX sin y. It is then possible to adopt the following characterization: a complex-valued function F, defined on an open region D, is said to be holomorphic (or analytic) there if F can be represented locally in D by convergent power series. (It should be noted that this is a direct extension of the use of the term analytic as it was applied to real-valued functions of one or more variables; see Sees. 3.4, 3.5, and 6.3.) Another approach is conceptually even simpler. It is easy to extend Theorem I to rational functions R(z) = P(z)/Q(z), where P and Q are polynomials with complex coefficients, provided that we exclude from consider- ation points z, where Q(z) = O. We can then obtain the most general holomorphic function by taking appropriate limits of these. Specifically, Runge showed that a function F is holomorphic on a region D if and only if it can be approximated uniformly on each compact subset of D by rational functions. A third approach to the holomorphic functions is by means of differentia- tion. Returning to a polynomial P(z), given by P(z) = Co + clz + C2Z2 + ... + c\"z\" we can define its derivative , . P(z) - P(zo) P (zo) = hm------ z-zo z - Zo Not all complex-valued functions have derivatives; if we were to ask for the same limit for the function f defined by f(z) = f(x, y) = x 2 + y2 + 2xyi it would fail to exist. Indeed, the following result is true: Theorem 2 If F(z) = w = u + iv, where u and v are real polynomials in x and y, and if lim ~(z)-=F(z(j) Z-Zo z - Zo exists at each point zo, then there is a polynomial P with complex coefficients such that w = P(z); moreover, u and v satisfy the Cauchy-Riemann equations. It remained for Cauchy, Riemann, Weierstrass, and others to bring all these aspects together into a coherent structure of striking beauty. A key result is the demonstration of the equivalence of the three approaches: holomorphic functions are those which have derivatives, which can be represented locally by their Taylor series, and which can be approximated arbitrarily closely on compact sets by rational functions. 578 ADVANCED CALCULUS Most proofs of this rest upon the discovery that holomorphic functions can also be characterized by integral properties. Let w = f(z) = u + iv and write dz = dx + i dy. Then, the complex I-form f(z) dz can also be written as f(z) dz = (u + iv)(dx + i dy) = (u dx - v dy) + i(v dx + u dy) = a + if3 where a and f3 are real I-forms. Following the techniques of Chap. 9, we can compute the derivative of each of these forms, da = d(u dx - v dy) = du dx - dv dy = (ux dx + u}. dy) dx - (vx dx + vy dy) dy = uy dy dx - Vx dx dy = - (u. + v ) dx dy = - (a!l + av) dx dy y x oy ax and, in the same fashion, df3 = dv dx + du dy ( au av) = v, dy dx + U x dx dy =- - dx dy Y ax ay Suppose now that the function f is holomorphic, so that u and v satisfy the Cauchy-Riemann equations. Then, each of the forms da and df3 is O. Thus, the fact that f is holomorphic in a region D is reflected in the fact that the complex differential form f(z) dz is closed. Appealing to Green's theorem, we conclude that 0= r f(z) dz = r a + i r f3 . r . r . r where r is any closed path in D, bounding a region in whichfis holomorphic. This important result is known as Cauchy's theorem. From this, one may derive Cauchy's integral representation formula, f(z) = ...~ r fJtJ~! 2m' r t - z which expresses the value off at points inside a simple closed path r, where f is holomorphic, in terms of the values which f takes on r, as a complex line integral (also called a contour integral). INTRODUCTION TO COMPLEX ANALYSIS 579 In contrast with the general class of functions mapping the plane into the plane, holomorphic functions have many striking properties. If F is holomorphic on an open region D and not constant, then F is open-i.e., carries open subsets of D into open sets. From this, one can immediately infer the maximum modulus theorem: The real-valued function 1F(z) I cannot have a local maximum anywhere in D. Alternatively, if E is a compact subset of D and IF(z)1 ~ M for all z E oE, then IF(z)1 ~ M at all interior points of E. Even though such a mapping F is open, it need not be I-to-l in D. However, if we remove from D all the points (at most countable) where.f' takes the value 0, then f is locally 1-to-l in the remaining set and is therefore locally a homeomorphism on this set. Furthermore, examine the set S of all points z where F(z) = c. This set might be empty; however, if F is not constant, it cannot be more than countable, and if it is not finite, then all limit points of S lie on the boundary of D. This in turn implies the surprising uniqueness theorem for holomorphic functions: If F and G are both holomorphic in an open region D, and if F(z) = G(z) for all z in a neighborhood, or an arc, or even on a converging sequence of points in D, then F and G must agree everywhere in D. People often judge the significance of a new branch of mathematics, not by its elegance and unity, but by its ability to solve problems that had been raised previously. In this direction, one of the early successes of complex analysis was the ease with which it led to the evaluation of certain real integrals. We shall illustrate this with one example, representative of a class of similar definite integrals that can be treated by contour integration. Let us find the value of the integral .rr dO V = .I_ rr (S--+-3cos 0)(5 +-4 sin 0) Put t = eiO, observing that as 0 goes from - n to n, t moves around the unit circle 1t 1 = 1, starting and ending at the point - 1; we have cos 0 = (eiO + e- iO)/2 = (t + t- I )/2 and sin 0 = (t - t- 1 )/2i, while dt = ieiO dO = it dO. Making these substitutions, we find that 1 r t dt V = 3. '6 (t-+ j)(t -+- 3)(t -+- ii)(t + 2i) where c(/ is the circumference of the unit circle, traced counterclockwise. To this, the Cauchy integral formula can be applied twice by replacing C(/ by two paths enclosing the points -1 and -i/2 separately; here, we have used the fact that the integrand is a closed form in regions which exclude the points where the denominator becomes O. We therefore arrive at the evaluation 580 ADVANCED CALCULUS In a very similar way, one may also use contour integration to prove the fundamental theorem of algebra. The following elegant argument is due to R. P. Boas. We wish to show that any polynomial of degree n must have at least one root. The general case can be reduced to polynomials with real coefficients; so we suppose that P(z) = ao + a1z + ... + anzn, with an\"# 0, ak real. The proof rests on the observation that if P(z) is never 0, for any complex number z, then the same statement holds for the polynomial Q(z), where Q(z) = znp(z + Z-l); note that Q(O) = an \"# O. Since the coefficients of Pare assumed real, we know that the value of the following definite integral 7r dev - r ------ - • _ 7r P(2 cos 0) is real and different from O. Make the same substitution t = eiO, and obtain r dt I f tn- 1 dt V = . '(j ia)(t + C1 ) = i '(j-Q(t)-- But, as observed above, the function f(t) = tn-1/Q(t) is holomorphic every- where, since Q(t) is never 0, and by the Cauchy theorem the value of this last integral must be O. This contradiction proves the theorem. The theory of functions of a complex variable has close connections with both hydrodynamics and the study of heat conduction. One point of contact is the class of harmonic functions of two real variables. If f(z) = u(z) + i v(z) is holomorphic in a region D, then, by differentiating the Cauchy-Riemann equations (A5-2), one finds that the real functions u and v are both solutions of the Laplace equation a 2H a 2H V 2H = ~ + --- = 0 ax2 a/ Any solution of this equation in a region D is said to be harmonic in D; so this shows that the real and imaginary parts of a holomorphic function are always harmonic. The converse is partially true: if D is a simple connected region and H is harmonic in D, then H is the real part of some function f that is holomorphic in D. (For more general regions D, this statement is not always true.) One model for the stable temperature distribution throughout a plane region produced by a variable boundary temperature leads to the Laplace equation and thus to harmonic functions. The same equation arises in diffusion problems, and in the study of the steady-state flow of a two-dimensional incompressible irrotational fluid. Here, the velocity vector of the fluid at the point z = (x, y) can be written as a(x, y) + i b(x, y), and there must exist a harmonic function u with Ux = a and uy = b. The function u is called the velocity potential of the flow. If one constructs a holomorphic function f whose real part is u, then techniques of complex analysis can be applied to f INTRODUCTION TO COMPLEX ANAL YSIS 581 to predict the nature of the streamlines past a cross section immersed in the flow or to compute the theoretical drag or lift of a proposed cross section. Further information about the theory and application of holomorphic functions must be sought elsewhere. APPENDIX SIX FURTHER TOPICS IN REAL ANALYSIS In writing a book to be used at the junior or senior level and intended for students with a wide range of prior mathematical experience, many compromises must be made. Elegance must at times be outweighed by the need for clarity, and inviting digressions withheld. It is frustrating for the teacher, and possibly harmful for the best students, to be forced to pass by so many instances where one could so easily step aside and make contact with the frontiers of mathematical research. The purpose of this appendix is to restore some of this by a reexamination of certain topics in the text. No effort is made to be complete; for this, one should refer to the books listed at the end. The two threads that we wish to emphasize come under the headings of algebraic analysis and linear analysis. The former deals with the algebraic aspects of what has been covered, the latter with the vector spaces that are pandemic to analysis. We assume that readers are familiar with the concepts of ring, field, homomorphism, ideal, etc., as they might be presented in an undergraduate algebra course. The first example we shall use is the class C[D] of all continuous real- valued functions on a compact set D. As a mathematical object, what is its structure? One observes first that it is a linear space, with the usual notion of addition of functions. Moreover, with the norm IIfl1 = sUPpeD If(p)l, we can introduce a (metric) topology into C[D]. A neighborhood of a function fo E C[D] consists of all functions f E C[D] such that II f - fo II < b, and 582 FURTHER TOPICS IN REAL ANALYSIS 583 convergence of a sequence of functions U;'} means uniform convergence on D. Theorem I of Sec. 6.2 asserts that the resulting normed linear space is complete; every Cauchy sequence converges to a \"point\" in the space. If D is a compact set in n space, then the class of polynomials with rational coefficients forms a countable dense subset of C[D]. Whenever one has a topological linear space, a central question is to ask for the dual space of continuous linear functions. In our case, some are easily found. If 9 is any continuous function on D, define a function L on C[D] by L(f) = f fg • D Then, one may see that L is continuous; if Un} converges to f, then L(fn) converges to L(f). This follows at once from the fact that there must exist a number B such that IL(f)1 < Bllfll for all f E C[D]' These are not all the linear functions L; the remaining ones are also integrals, but of a more general variety. This is also closely related to Theorem 2 in Sec. 8.2, and to formula (6-61) in Sec. 6.6. But the linear space C[D] is also an algebra. Iff and 9 belong to C[D], so does fg. As an algebra, it has a more elaborate structure, which suggests further questions that can be asked. What are the ideals in C[D]? Are there any interesting subalgebras? What types of homomorphic images can C[D] have? What are the automorphisms? And what types of algebras can be represented isomorphically (or homomorphically) in C[D]? A few examples might be of interest. If a point Po E D is selected, then one may consider the mapping h from C[D] into the real numbers, defined by h(f) = f(po). This is easily seen to be a homomorphism of C[D] onto the real field. As such, its kernelM = {allf E C[D] withf(po) = O} must be a maximal ideal. Furthermore, all the maximal ideals are obtained in exactly this fashion. This important fact leads in turn to the observation that if two algebras C[Dd and C[Dz] of this sort are algebraically isomorphic, then the compact sets D 1 and D z must be topologically the same, i.e., must be homeomorphic. Again, C[D] has an additional type of structure as well. If we introduce an order relation by sayingf ::5: 9 whenever f(p) ::5: g(p) for all p ED, then we have an important example of what is called a partially ordered vector space. [The term \"partially\" is used because it is no longer true that a function f must obey either f 2: 0 or f ::5: 0; for example, f(x) = sin x.] The order properties of C[D] are as interesting as its algebraic properties and are also closely related to the properties of the integral as a functional. For example, if 9 2: 0, then the function L defined above has the property that L(f) 2: 0 whenever f 2: 0; for this reason, it is said to be a positive functional. There are many other attractive roads branching off in other directions; some of these are suggested by the treatmen t of function spaces, and especially Hilbert space, given in Sec. 6.6. One final topic which we think should be mentioned is that of generalized differentiation and generalized functions. In elementary calculus, much 584 ADVANCED CALCULUS attention is paid to the problem of when a function can or cannot be differentiated. In particular, we say thatf(x) = Ixl does not have a derivative at the point x = 0, even though it is continuous there. As a matter of fact, there is a perfectly good sense in which this function has a derivative, and indeed in which badly discontinuous functions can have derivatives. To explain this, we start with the observation that the use of functions in physical applications is not always (indeed, is hardly ever) as point-to-number mappings. If we measure the value of some physical variable such as velocity or charge, we are forced to read instead the time average of something over a short interval. When one analyzes (a la Bridgeman) the operational approach to physics, one sees that functions are used in physics, not for their point-to-point numerical values, but for their effect on other functions. This brings us back to integration, where we write (with a different notation now) 00 <f, g) = f fg -00 Suppose that we put no continuity restrictions on f at all but ask that 9 be a function of class Coo, which in addition vanishes off some compact set G. It is not difficult to see that we can examine f by means of the values of <f, g) for all choices of 9 and that, for example, if <f, g) = <h, g) for all g, and f and h are reasonably well behaved, then f = h. Now, suppose that f is itself of class C; we can ask how the function f' acts on sample functions g, in comparison with! Integration by parts gives the answer immediately. r <f', g) = lim r f'(t)g(t) dt 7-00\"-r = !~~k(t)g(t) I'-r- (r f(t)g'(t) dt} = - roo f(t)g'(t) dt = - <f, g') = <- f, g') 0.- 00 In words, the \"value\" off' at 9 is the negative of the \"value\" offat g'. We could therefore use this relation to find something aboutf', even if we did not know f' initially. Suppose that we examine this for a more general function f Even though l' does not exist in the usual sense, we can define a \"generalized\" derivative f' by saying: f' is the functional L which acts on functions 9 in the following manner: L(g) = <- f, g') 00 = - r fg' \"-ex; FURTHER TOPICS IN REAL ANALYSIS 585 Even though L is not representable in the form <!\" g), we can still work with it as though it were a function, except that we cannot ask for it to have values at points; we study!' only by the way it affects functions g. One example will show what this means. Let us take f to be the step function f(t) = ~~ when t 2: 0 when t < 0 Then, we wish to find out what!, is. As above,!, is characterized by the relation <!\" g) = - fxc f(t)g'(t) dt - oc' for all g. However, using the definition off, we have <!\" g) = _ (g'(t) = -g(t) I'\" • 0 0 = g(O) Thus, the derivative!, of the step function f is a generalized function which acts on functions g, so that <!\" g) = g(O). If we set!' = 15, then the integral notation (if applicable) would have to give 00 g(O) = r 15(t)g(t) dt '-cc for all smooth functions g. There is no actual function 15 that has this property, although there are functions 15\" that almost achieve this. If 15\"(t) is positive, even, and has a very tall peak at t = 0, so that f 15\"(t) dt = 1 while 15\" is very small away from the origin, then the value of <15\", g) is almost g(O). We have thus been led to the generalized function that is customarily called the Dirac delta function; it is in fact nothing more than a measure of mass 1 located at the origin. As above, 15 is the limit, in a suitable sense, of honest functions 15\", explaining the intuitive picture of 15 as a function which is zero-valued except at t = 0 but which has integral 1. This process for differentiating functions can also be applied to generalized functions, and one may find 15'; this turns out to be a generalized function q such that <q, g) = - g'(O) for all g. It is the limit of the sequence of derivatives 15~ and can be regarded as a dipole at t = O. It is a generalized function (or distribution) which is not even a measure. It is by introducing such extensions of the classical concept of function that the formal differentiation of Fourier series, discussed in Sec. 6.6, can be justified and used. This example is a good illustration of the way in which research in mathematics comes about. Clearly, the original step function{ does not have a derivative; however, it turns out to be profitable to ask what would happen if 586 ADVANCED CALCULUS we could differentiate it! One recalls the similar question \"what would happen if -1 did have a square root?\" in the light of the productive theory outlined in the preceding appendix. In Sec. 6.2, we stated Theorem 6, the bounded convergence theorem, without a proof, mentioning that this would require an excursion into some aspects of the theory of Lebesgue measure and integration. We end this appendix by sketching such a proof, omitting all the complicating details. We begin by assuming a related result. Theorem 1 Let {In} be a sequence offunctions that converge pointwise to a functionf on an interval I, and are such that 0 ::s:: fl ::s:: f2 ::s:: f3 ::s:: .... (That is, {In} i f on I.) Then (A6-1 ) lim r fn = r f . I . I [Note that if eachfn' as well as f, is continuous and I is compact, then by Exercise 11 in Sec. 6.2, {In} in fact converges uniformly to f] We can now weaken this by removing the monotonicity, at the expense of a weaker conclusion. Theorem 2 Let 0 ::s:: fn for all n, and let {In} converge pointwise on I to f Then, (A6-2) r f ::s:: lim inrf j\" . I . I To prove this, set gn(x) = inf{j,,(x), fn+I(X), fn+2(X), ...} and observe that 0 ::s:: gn(x) ::s:: fn(x) for all n and x, and that the sequence {gn} is mono- tonic increasing with limit f Integrating, we have and thus lim inf r gn ::s:: lim inf r fn • I . I But, by Theorem 1, lim r gn exists and is r f, which therefore gives us (A6-2). • I • I We are now ready for the final result. Theorem 3 Let {In} converge pointwise on I to f, and assume that Ifn(x)1 ::s:: g(x)for all x and n, where r 9 is finite. Then, . I (A6-3) FURTHER TOPICS IN REAL ANALYSIS 587 lim r In = r I. [ . [ For, we have 0 ~ 9 + In and 0 ~ 9 - In' and these converge pointwise to 9 + I and 9 - f, respectively. Accordingly, by Theorem 2, we have r 9 ± r I ~ lim inf r (g ±In) • [ 0 [ • [ ~ r 9 + lim inf r ± In. [ . [ But, r9 is finite, and so it can be cancelled from both sides, and the . [ result rewritten as lim sup r .f\" ~ r I ~ lim inf r In o [ 0 [ 0 [ which clearly implies (A6-3). (It should be obvious that many of the omitted details have to do with being sure that each of the functions appearing in this proof is integrable on the set I.) SUGGESTED READING This list of books and articles is intended for random browsing, or for back- ground reference, or to cast further light on later developments. It is meant neither to be exclusive nor exhaustive. Analysis 1. L. V. Ahlfors, \"Complex Analysis,\" 2d ed., McGraw-Hili Book Company, New York, 1966. 2. R. P. Boas, Jr., \"Primer of Real Functions,\" Carus Monograph 13, Math. Assoc. of Amenca and John Wiley & Sons, Inc., New York, 1960. 3. L. Brand, \"Vector Analysis,\" John Wiley & Sons, Inc., New York, 1957. 4. R. C. Buck (ed.), \"Studies In Modern Analysis,\" vol. I in Math. Assoc. of America, \"Studies In Mathematics,\" Prentice-Hall, Inc., Englewood Cliffs, N.J., 1962. 5. P. J. Davis, \"Leonhard Euler's Integral: An Historical Profile of the Gamma Function,\" Am. Math. Monthly, vol. 66, pp. 849-869, 1959. 6. 1. A. Dleudonne, \"Foundations of Modern Analysis,\" Academic Press, Inc., New York, 1960. 7. W. F. Eberlein, \"The Elementary Transcendental Functions,\" Am. Math. Monthly, vol. 74, pp. 1223-1225, 1967. 8. H. Flanders, \"DifferentIal Forms wIth Applications to the PhySIcal Sciences,\" Academic Press, Inc., New York, 1963. 9. B. R. Gelbaum and 1. M. H. Olmsted, \"Counterexamples in AnalySIS,\" Holden-Day, Inc., PublIsher, San FranCISco, 1964. 10. P. Halmos, \"Measure Theory,\" D. Van Nostrand Company, Inc., Princeton, N.J., 1950. 11. W. F. Osgood, \"A Jordan Curve of Positive Area,\" Trani. Am Math. Soc., vol. 4, pp. 107-112,1903. 12. A. W. Roberts and D. E. Varberg, \"Convex Functions,\" Academic Press, Inc., New York, 1973. 13. W. Rudin, \"PrinCIples of MathematIcal AnalYSIS,\" 3d ed., McGraw-HIli Book Company, New York, 1976. 588 SUGGESTED READING 589 14. G. SprInger, \"Introduction to Riemann Surfaces,\" Addison-Wesley Publishing Company, Inc., Reading, Mass., 1957. 15. D. J. Struik, \"Lectures on Classical Differential Geometry,\" Addison-Wesley Publishing Company, Inc., Cambridge, Mass., 1950. Algebra 16. A. A. Albert (ed.), \"Studies m Modern Algebra,\" vol. 2 in Math. Assoc. of America, \"Studies m Mathematics,\" Prentice-Hall, Inc., Englewood Cliffs, N.J., 1963. 17. S. Barnard and J. M. Child, \"Introduction to Higher Algebra\" and \"Advanced Algebra,\" The Macmillan Company, New York, 1936, 1939. 18. G. Blrkhoffand S. MacLane, \"Survey of Modern Algebra,\" rev. ed., The Macmillan Company, New York, 1965. 19. C. W. CurtIS, \"Lmear Algebra, an Introductory Approach,\" Allyn and Bacon, Inc., Englewood Cliffs, N.J., 1963. 20. I. N. Herstem, \"Topics in Algebra,\" Blaisdell Publishing Company, New York, 1963. 21. A. I. Marcev, \"Foundations of Linear Algebra,\" W. H. Freeman and Company, San Francisco, 1963. 22. B. Noble and J. W. Daniel, \"Applied Linear Algebra,\" 2d ed., Prentice-Hall, Inc., Englewood Cliffs, N.J., 1977. Topology-Geometry 23. S. S. Chern (ed.), \"Studies in Global Geometry and Analysis,\" vol. 4 in Math. Assoc. of America, \"Studies in Mathematics,\" Prentice-Hall, Inc., Englewood Cliffs, N.J., 1967. 24. P. 1. Hilton (ed.), \"Studies in Modern Topology,\" vol. 5 in Math. Assoc. of America, \"Studies m Mathematics,\" Prentice-Hall, Inc., Englewood Cliffs, N.J., 1968. 25. J. L. Kelley, \"General Topology,\" D. Van Nostrand Company, Inc., Princeton, N.J., 1955. 26. H. P. Manning, \"Geometry of Four Dimensions,\" The Macmillan Company, New York, 1914. 27. I. M. Singer and J. A. Thorpe, \"Lecture Notes on Elementary Topology and Geometry,\" Scott, Foresman and Company, Glenview, Ill., 1967. 28. M. Spivak, \"Calculus on Manifolds,\" W. A. Benjamin, Inc., New York, 1965. Logic and Foundations 29. P. R. Halmos, \"Naive Set Theory,\" D. Van Nostrand Company, Inc., Princeton, N.J., 1960. 30. 1. Olmsted, \"The Real Nuny,er System,\" Appleton-Century-Crofts, Inc., New York, 1962. 31. R. R. Stoll, \"Introduction to Set Theory and Logic,\" W. H. Freeman and Company, San Francisco, 1963. 32. R. L. Wilder, \"Introduction to the Foundations of Mathematics,\" John Wiley & Sons, Inc., New York, 1952. Applications 33. R. C. Buck with E. F. Buck, \"Introduction to Differential Equations,\" Houghton Mifflin Company, Boston, Mass., 1976. 34. S. D. Conte and C. W. deBoor, \"Elementary Numerical Analysis-An Algorithmic Approach,\" 2d ed., McGraw-Hili Book Company, New York, 1972. 35. A. Friedman, \"Generalized Functions and Partial Differential Equations,\" Prentice-Hall, Inc., Englewood Cliffs, N.J., 1963. 36. A. Hochstadt, \"Differential Equations, a Modern Approach,\" Holt, Rinehart and Winston, Inc., New York, 1963. 590 ADVANCED CALCULUS 37. C. C. Lin and L. A. Segel, \"Mathematics Applied to Deterministic Problems in the Natural Sciences,\" The Macmillan Company, New York, 1974. 38. R. D. Luce and H. Raiffa, \"Games and Decisions,\" John Wiley & Sons, Inc., New York, 1957. 39. B. Noble, \"Applications of Undergraduate Mathemalics in Engineering,\" The Macmillan Company, New York, 1967. 40. E. M. Purcell, \"Electricity and Magnetism,\" Berkeley Physics Course, vol. 2, McGraw-Hili Book Company, New York, 1965. 41. L S. Sokolnikoff and R. M. Redheffer, \"Mathematics of Physics and Modern Engineering,\" 2d ed., McGraw-Hili Book Company, New York, 1966. 42. D. J. Wilde, \"Optimum Seeking Methods,\" Prentice-Hall, Inc., Englewood Cliffs, N.J., 1964. Miscellaneous 43. Edwin A. Abbott, \"Flatland, a Romance of Many Dimensions,\" 6th ed., Dover Publications, Inc., New York, 1952. 44. C. Boyer, \"History of Mathematics,\" John Wiley & Sons, Inc., New York, 1968. 45. R. Courant and H. Robbins, \"What Is Mathematics?,\" Oxford University Press, New York, 1941. 46. Michael 1. Crowe, \"A History of Vector Analysis,\" University of Notre Dame Press, Notre Dame, Ind., 1967. 47. M. Gardner, \"Can time go backward?,\" Scientific American, January 1967, pp. 98-108. 48. I. J. Good, \"The Scientist Speculates,\" Capricorn Books, G. P. Putnam's Sons, New York, 1965. 49. Robert Heinlein, \"Lifeline,\" Astounding Science Fiction, August 1939, vol. 23, pp. 83-100. 50. Robert Heinlein, \"--- and He Built a Crooked House,\" Astounding Science Fiction, February 1941, pp. 68-83. 51. H. Petard, \"Contributions to the Mathematical Theory of Big Game Hunting,\" Am. Math. Monthly, vol. 45, pp. 446-447, 1938. 52. H. Poincare, \"Science and Hypothesis,\" Dover Publications, Inc., New York, 1952. 53. T. Rado, \"What Is the Area of a Surface?,\" Am. Math. Monthly, vol. 50, pp. 139-141, 1943. 54. S. Ulam, \"A Collection of Mathematical Problems,\" Interscience Publishers, Inc., New York, 1960. 55. H. Weyl, \"Symmetry,\" Princeton University Press, Princeton, N.J., 1952. 56. COSRIMS, \"The Mathematical Sciences-A Collection of Essays,\" The M.LT. Press, Cambridge, Mass., 1969. HINTS AND ANSWERS \"For emergency use only\" Section 1.2 3 If you make a two-dimensional picture, time vs. one space axis, the resulting diagram resembles a Z. It might be the history of one particle, if a positron is \"really\" an electron moving \"backwards through time\" (see [47] in Reading List). 7 (b); (-I, -1, -I). 8 Don't use coordinates; instead eliminate P or Q. 10 Any multiple of (4, 5, - 3). 12 This IS easier if you do not use coordinates. 16 The three cases depend on how the vertices are labeled. In one case, the vector AB is equal and parallel to the vector CD only if B - A = D - C. 19 (b) If x < 0, -x> 0 and (_X)2 > O. But, -x = (-I)x and (_1)2 = 1. 21 Start with (a + b)/(A + B) = a/(A + B) + b/(A + B). 23 Map n to 2n if n > 0, and to - 2n + 1 if n s O. Section 1.3 2 It helps to read Ip - A I as \"the distance from p to A.\" 3 (a) Write the relation as y - x S x + 2y s x - y. 5 Use Ipl = I(p - q) + ql· 10 Yes. II One component of the equatIOn is y = 21 + 3. 12 One point is (1, -1,1, -H 591 592 ADVANCED CALCULUS 13 Express R as a weighted average of each vertex and the opposite midpoint. 15 Two of the vertices are (A + 4B + 2C)/7 and (2A + B + 4C)/7. 17 Pictures will help! Section 1.4 I (b) A paraboloid opening downward. (d) Hard to sketch; domain omits the lines .I' = x and .I' = -x, and graph turns abruptly upward or downward as you approach one of these lines, depending upon which side you are on. (e) Graph is a cliff, with a crevasse at its foot. 2 (a) 6 (b) 13 (c) 6 (d) (x 2 + x)(y + I) (e) x(x + 1)2 (f) x 2 (y + 1)2 + x(.I' + 1) (g) x4 + 2x 3 + 2x 2 + x 3 The answers to (a) and (b) are different. 4 (b) f(x) is not defined for any real x. 5 Graph .I' = F(t) by putting t = 1/(x - 1) and solvmg for y. 7 (c) One of the level\" curves\" contains an entire open disk. 9 Among other observations, one could say that at any time, the temperature becomes arbitrarily large as one moves away from the origin in any direction, and also that at anyone spot, the temperature will become arbitrarily large as one waits. 12 There are infinitely many, but only four that are contmuous everywhere. 14 (b) Look for those choices of k and m such that 4k + 14 = 8m + 2. Section 1.5 2 (a) Closed, bounded, connected, and boundary IS itself. (c) Closed, unbounded, connected, and is its own boundary. (e) Open, unbounded, disconnected, and the boundary is a pair of intersecting lines. 3 (a) Open, unbounded, connected, boundary is sphere. (c) Open, unbounded, connected, boundary is surface. 4 (a) It may help to look at the graph of the polynomial P(x) = x(x - 1)'. 5 (b) The entire plane. 6 Cluster points include those such as (0, lin) for each n and others on the horizontal axis. Be sure to examine the origin, which is also a cluster point. II Yes. 12 Is it true in general that bdy (A) n bdy (B) c bdy (A n B)? 13 (b) Because its complement is 0. 17 (a) No; give examples. (b) Yes. 19 It is helpful to ask which values of x are acceptable at each value of r. Section 1.6 3 Show that IPn+l - ql:s CIPI - ql· 4 Use coordinates. 5 For example, P4n+ I = (1,0) + n(2, - 2). 6 Note that (a) and (b) are subsequences of each other. S It has Just one limit point, but is divergent. 13 Use c = (1 + an)\" = I + nan + .... 15 Use mathematical induction. HINTS AND ANSWERS 593 16 (e) Let A = lim mf (x./Il'). Show that A <::: ~ and that X.+ I - x. ?: nJ A - I: for all large n, and mfer that A ?: JA - I: /2 and then that A ?: ~. 17 (h) Put h. = [2' 4·6··· (2n)]/[3· 5·7 ... (2n + I)] and show that (a.)' < a.b. < 1/(2n + 1). 19 Show that a.+ 2 - a.+ 1 = (a.+ 1 - a.)/3, which enables one to calculate lim a•. 21 (c) Put d, = a,+ I - a,. Prove that d.+ 1 = -d./(n + 1), evaluate d\" and then show that Iima.=a l +\"'.? d,. ~1 26 (a) Iimsupa.= I. (h) liminfa.= -2. (c) limsupa.=3, lim infa. = -I. (d)limsupa.= J3/2. What do you suppose would happen in this if a. = sin (n/3)? 27 Construct the sequences so that the large terms of {a.) are m phase with the small terms of ib.). 28 Another way to say that L = lim sup.~ x a. is that, for any I: > 0, we have a. < L + i: for all large n, while a. > L - f: for infinitely many indices n. Similarly, if [ = lim inf.~ x a., then, for any i: > 0, a. > I - I: for all large mdlces n and a. < I + I: for an infinite number of indices n. 29 Given I: > 0, choose N so that la./ < I: when n?: N. Then, write and from this, get lim sup I(T. lSi:. Since this holds for any i: > 0, lim (T. = 0. 31 (t ~). 33 Obtain the formula p.+ 2 - p.+ I = (P.+ 1 - P.)/4, and conclude that {p.} is convergent to (1, t). 36 (b) No. 37 Work with h, = log a,. Section 1.7 I For any I: > 0, L - I: < L, so that there must exist an N with L - I: < aN' 3 If b = sup (S) and b ~ S, then it is seen to be true that h E bdy (S) c closure (S). 4 IfpEA,qEB,then Ip-ql sdiam(B). 5 If cE C, then dist (B, C) s Ip - c/ for every pEA. 6 (c) No. 7 Modify Exercise 6. 9 Work with the nested intervals [a., h.] and the nested intervals [c.' d.]. 11 Count the number of points from the given set that lie in D. = {all p, Ipl s n), and then note that the collection of all sets D. IS a countable collection. Section 1.8 I Cover the given set by the open sets D., where D. = {all p, Ipl < II). 3 If F IS closed and C compact and FcC, then any open covering of F leads to an open covermg of C if C - F IS adjomed. 6 Let (a., h.) E A x B and choose n, so that lim a., exists, then choose a subsequence of h., which converges. 9 (a) Yes. (h) No. (c) If x. E XIS), choose Y. with P. = (x., Y.) E S. Let p be a limit point of [P.), and show that X({r:) IS a limIt pomt of :x.:. 10 (a) Each pomt m the open diSC D IS the center of a closed square that lies m the disc. (b) The closed diSC D\" of radIUs I - liN can be covered by a finite number of closed squares contamed m D, and U; D,. = D, so one can succeed with a countable number of squares. 594 ADVANCED CALCULUS Section 2.2 x Xo (x - xo)Yo + (Yo - y)xo 2 Observe that .I' Yo YYo and estimate this when Iy1> p, IYo I > p, P > O. 4 Put x = r cos e, .I' = r sin 11. 10 Use the fact that the complement of any closed set is open. 12 rl(A n B) =F 1(A) n FI(B) Section 2.3 I You must prove that there are pairs of points, arbitrarily close together, on which the variation of F is large, for example, (n, 0) and (n + lin, 0). 5 (a) The key idea is that dist (A, B) > O. 7 Choose a finite number of points P, E D which are I:-dense In D and let M = max If(pdl, and use this to estimate SUPpED If(p)l. 10. (a) Draw a line through P and P3 to meet the edge connecting P, and P2' (b) Observe that f(p) = .L rxJ(p) and estimate If(p) - F(p)l· Section 2.4 2 (b) The function 3 - xly - ylx is not continuous everywhere in the plane. 3 (b) Construct a polynomial of the form f(x, .1') = [A(x, YWB(x, .1') and examine the set where A(x, .1') = O. 4 Consider for x> 0 for x = 0 5 Look at h(x) = f(x) - g(x). 6 Show that for sufficiently large c, P(c)P( - c) < O. 7 Sketch the graphs off and g, and then examine h(x) = f(x) - g(x). 8 Iff is constant on two overlapping intervals, It is the same constant on both. 9 Look at the inverse images of neIghborhoods of the values 2 and 3. 14 Arrange the temperatures of the vertIces in increasing order, and then examine theIr respective positions in the tetrahedron. 17 Pick any value Yo. Then, for any x, min)' F(x, .1') S F(x, Yo)' Hence A S max x F(x, Yo)' 18 In the complex field, a continuous path can go from I to - I without going through O. Section 2.5 I (b) No; lim x _ o g(f(x)) = 2. 2 Put x = t 6 • 3 H (note that this cannot be found merely by substitution). 4 Yo. 8 Note that jI +;2 = Ixljl-+ I/x 2. 14 Note that it is not permissible to assume that lim f(x) eXIsts. 15 For any I: > O,j(x) < L + I: on a deleted neIghborhood of b, but.f (xn ) > L - i: for a sequence approaching b. 18 Prove thatfis \"Cauchy\" at Po, meaning that lim If(p) - f (q)1 = 0 as p and q simultaneously approach Po. HINTS AND ANSWERS 595 Section 2.6 I (a) Contmuous everywhere. (b) Removable discontinuity at the orlgm. (e) Essential dis- contmUity at the orlgm. (d) Removable dlscontmultIes on the line y = x, except at the origin, where It is continuous. 2 The functIOn is contmuous nowhere. 3 The function is contmuous at each IrratIOnal point and discontinuous (essentIal) at each ratIOnal pomt ThIs depends upon the fact that any sequence of rationals that approach an Irrational must have larger and larger denominators. 4 (b) Removable at x = I, essential at 2 and -1. 5 (b) All removable. 6 (a) Removable at (0,0). (b) EssentIal at (0,0), since It depends upon which parabola is considered. 7 No. 8 (a) Yes. (b) No. 9 All discontinuities anse as jumps, due to unequal left- and right-hand limits. There cannot be more than a finite number of discontinuitIes with Jump more than I/n, and thus at most a countable number in toto. Section 2.7 2 (a) Graph f (h) Recognize f(x) - 1. 7 Let f(a) = f(h) = 1 with a < b and prove that a = 0, b = 1. 8 The result depends on whether or not IA I < 1. Section 3.2 4 These are mtultIvely obvious; what is asked for is a proof based on the mean value theorem. 5 First study the zeros of F. 6 Study P'(x) at and between its zeros. 7 Apply the mean value theorem tof(x + I) - f(x). 8 First method: Prove {'(x) eXIsts and evaluate It. Second method: Estimate If(h) - f(a)1 = /2: ~(f(x j +.) - f(x)) I where Xo = a, X N = b. 10 What must be shown IS that (b - a)f(x) 2': (b - x)f(a) + (x - a)f(b). Apply the mean value theorem tOf(x) - f(a) and tof(x) - f(b), and use the result to express (b - a)f(x). Finally, use the mean value theorem on f' and make use of the hypothesis on fa. 12 (a) The discontmuity off' at x = °IS removable. 14 (a) This IS intuitively clear from a picture, but a rigorous proof is called for. Show by the mean value theorem that if f'(x o) < 0, then f must be negative somewhere to the right of Xo . (b) No. 15 (a) Never. (b) Not necessanly. (e) Not necessarily. 2 16 Show that I' (I - P'(t)) dt = 0. . 0 18 Look at a helix . 19 Set f(O) = 3h/(2H + B) and express b, H, and B in terms of 0; then use the mean value theorem to estimate {to) - f(O) and then to estimate If (0) - 0 I· 20 Use the mean value theorem onf(x) = arctan (x), and then use 71/2 - f(x) = arctan (I/x). 22 (b) No. 23 (a) l (b) I. (e) - I. 24 It is not legal to cancel the factor cos x, and with thiS, the hypothesIs of Theorem 6 is not satisfied. 596 ADVANCED CALCULUS 25 lim f'(x)/g'(x) fails to eXISt, but lim f(x)/g(x) does. 27 (b) No; try f(x) = xe X • 28 f(O) = 0, and 1'(0), calculated from the onginal definttion of denvatlve, IS O. 29 First case: Iff (a) < f(b), then prove that there must be a point u with f(a) = f(u), and thus c withf'(c) = O. Second case: f(a) ~ f(b). Section 3.3 I (a) fdx, y) = 2x log (x 2 + y2) + 2x3/(X 2 + y2) f2(X, y) = 2x 2Y/(X 2 + y2),f12(X, y) = 4xy 3/(X 2 + y2)2. 2 f2(X, y) = 3X2y2 - 2,f2(2, 3) = 106,f2(y, x) = 3X2y2 - 2. 3 (c) [-I, -I, -4]. 4 (b) For no direction, except those of the axes; (c) no. 5 Using the mean value theorem, show that If(p) - f(Po)1 ~ M Ip - Po I. 6 Assume f = 0 on the boundary of a bounded open set. 7 Use Exercise 6. 8 O. 13 ¥. 14 \"Nonsense. F must have been constant.\" Show why. Section 3.4 ( dw aw cw cu aw au dx aw dx b) = + + + . dt ct au at au ax dt ax dt 3 At (-1,2, I), ay/cx = i. ay/az =~. au 4 ax az 5 ex (2x 3u + 2xy 2v + x 2y - 3y2) x 4 + 4y 3 and also, au (l2 y 5 - 12x 2 r 4 - 9X4 y 2 + x 6 )') ex (x 4 + 4y3)2 dx 8 dt e(F, G) (1(.1', t) ?(F, G) e(x, y)' dr dt o(F, G) a(x, t) e(F, G) l1(x, .1') II Differentiate the equatIOn with respect to t, and set t = I 19 Apply Taylor's theorem to express f(p + !J.p) In the form f (p) + R(!J.p) for any POint PinS. Then use the fact thatfllJ.2,f22 are continuous (and therefore bounded) on S to estimate R(!J.p). 20 Let p and q belong to S, wIth p = (¢(a), ljJ(a)), q = (¢(b), ljJ(h)). Subdivide [a. h] by pOints (j' HINTS AND ANSWERS 597 with to = a, t\" = h. Let Pj = (</>(tj ), l/f(t j)). Then, If(p) - f(q)1 s L If(Pj+tl- f(Pj)1 s M ~ IPj + I - Pjl '. Show that the latter sum can be made arbitrarily small by proper choice of the tj . (For a generalization of this, see a paper by Kakutani, Proc. Am. Math. Soc., vol. 3, pp. 532-542, 1952.) 21 </>(1) = I, </>'(1) = a + ab + V Section 3.5 2 The error does not exceed 1/6! = 1/720 < .0014. 3 By Taylor's theorem, we obtain lerror I <!. The actual error is no more than .07. 5 6, II. 6 Use Taylor's theorem at x = 0 and estlmatef(l) andf( - I), and obtainf(3)(1'tl + f(3)(1' 2) = 6. 7 Use Taylor's theorem at t = x; estimate 1f'(x)1 and then estimate lim sup 1f'(x)1 as x i 00. Note that many functions obey f(x) ---+ 0 wlthoutf'(x) ---+ 0, as x i 00. 9 We have I/x < 1/2P/x l +b + l/x l - 6) for any <5, 0 < <5 < I. Integrate, and obtain log x < (I/26)(x 6 - x- 6 ). Then take <5 = t. 10 Yes. eX ~ (e 2 /4)x 2 , and this is best possible. II IR\"(x)1 s B\"(x - a)\"/n l :-+ O. 12 Writef(x) = f(a) + f'(a)(x - a) + f\"(1')(x - a)2/2, set x = 0, x = I, and subtract. One then obtains 1f'(a)1 s (A/2)[a' + (I - a)']. I3 lf (a)I=I(f'lsM(lfl. 14 Show that for any xo, there is an m and a neighborhood of Xo on which (dm/dx)(f(x)) == O. Section 3.6 I 3 and ¥. 2 (a) Examme P'(x). 3 The critical point is (i, 0) and is a saddle pomt. The maximum and minimum occur on the boundary, and are 4 and -¥C. 4 Maximum = 4; minimum = -i. 5 (a) Saddle; (b) saddle; (c) (O,O)lsamaximum,(±i, ± I)areminima,and (0, ±1)and(±i,O) are saddle points; (d) all the points on the line y = mx are mmima; (e) (0,0) is a minimum; (f) (0,0) is a saddle point. 9 Look at the behavior off when y = mx and when y = 3x'/2. 10 The centroid. II An open set where df = 0 must contain a critical point. 12 One point is (i, i, 0). 13 The maximum is lOti!. 14 There IS an endpoint maXimum, with an interior local extreme. 17 The line L goes through the centroid of the given points. The slope is determined by IX = E(x') - [E(x)]', P= E(y2) - [E(y)]', and }' = E(xy) - E(x)E(y), where E(u) = L u;/n for any numbers U j , U ZI ••• , Un' 18 F = f - 9 IS harmonic in D and F ~ 0 (or F S 0) on bdy (D). 21 Let k = [A], the largest integer obeymg k s A. Then, the maximum occurs for the chOice x I = X2 = ... = x, = I, x, + 1 = p, x, + 2 = ... = x\" = 0, where k + P= A. This type of problem arises in many linear programming situatIOns. 598 ADVANCED CALCULUS Section 4.2 3 M - f(p) is positive, so that JJ (M - f) = M A(D) - JJ f ~0 D D 5 As in Exercise 3, show that I'r fg lies between M rr 9 and m 1'1' g. Then use the intermediate \"n .. D .. D value theorem to find the point p with f(p) = UJ fgl D 6 There is a neighborhood wheref(p) ~ b. II Yes, O. 13 Draw an appropriate picture and interpret the two estimates In geometric form. 14 Use the uniform continuity off 15 Subdivide [0, I] and cover the curve by rectangles with a small total area, again using the uniform continuity off and B as a Lipschitz constant for g. Section 4.3 I x 2 - X + I x ~ I 2 (a) F(x) = 1x (b) F(x) = (eX - I) exp (eX) x < I 3 (c) No. 5 Use the substitutIon v = I/u. 6 Let F' =.t, and evaluate each side. 7 There are infinitely many solutions, of which one IS f( x)- )0 - 1x/2 - 1/2 1 2 2 2 9 r dy I' f(x, y) dx + I' dy I' f(x, y) dx. • 0 . 1 • 1 . }' II The first blank should contain ..frl2f(y). 12 1/20. • 2 ,2 .2-(1/2)x 13 I dx I dz 1 f(x, y, z) dy · 0 • x • 1 2 4- 2y 2 r dy r dx r f(x, y, z) dz • 1 • 0 • x 2 z 2-(1/ljx I' dz I' dx r f(x, y, z) dy , 0 • 0 ' I Osxsl I<x 2 4 - l}' z 2 2 4 - 2y r dy r dz r f(x, y, z) dx + I' dy r dz I' f(x, y, z) dx '1'0'0 'I '4-1y '0 2 ,2-0/2)::: z 2 2 4-2\\' I' dz 1 dy I' f(x, y, z) dx + r dz r til' I' {(x, y, z) dx. '0 '1'0 '0 '2-(1/2)z '0 14 44/15, 16 (a) (e - 1)/2; (b) ~e4 - e2. o r3 2 y3 17 The reversed order is r dl' r xy dx + r dy\" xy dx. '-./6 . -6 '0' 7y-6 18 Use the uniform continuity off HINTS AND ANSWERS 599 22 Dividing the rectangle In half one finds the estimate .17558, good to .015. A little more precision gives .17447. The \"exact\" answer IS 13 log 13 + 10 log 10 - 12 log 12 - II log II Writing this Instead as 2 log (H) + log (H) - 10 log [I + (rh)], and using power <PrJP,. one gets .174465, good to the last digit. • h 23 Consider ,I. (f + ,ig)2, which cannot be negallve. 25 (a) Less than J5/2; (b) less than J27':, 26 Prove the identity for P(x) = I, x, x 2 , and x 3 in turn. 28 (a) (3e X3 - 2e X ')!x; (b) 3 cos (12x) - 2 cos (8x), I I 31 Calculate I' dx I' Iy - x I dy. , 0 ' 0 Section 4.5 1 Area =,' e- X dx =I. '0 2 (a) Diverge; (b) diverge; (c) diverge; (d) converge; (e) converge; (f) converge; (g) converge; (h) diverge. 3 (a) Diverge; (b) converge; (c) converge (not improper); (d) converge; (e) converge; (f) converge; (g) diverge; (h) converge. 4 Either IX < I and P> I, or IX > I and P< I. 5 All (IX, P) with IX > - I, fJ > - I and IX + fJ < - I. ,R x 6 Yes. Evaluate the first half of I dx\" x- 3 / 2er- x dy, and examine the resulting Integral as , , 0 r 1 0, R i eX 8 Divergent. 9 Convergent. II Use the intermediate value theorem. Section 5.2 12 (b) The order Jdx Jdr is hard, I (a) DIverges; (b) diverges; (c) converges, 3 (a) an = I/(n + I)(Jn + I + In) '\" l/n 3!2, convergent. (b) an'\" 1/113/4 , divergent. 5 (b) Take bn = I/(n - I) for n::,. 2. (c) Take bn = I/(n - A - I) for n ::,. A + 2, 7 Bracket the series in blocks of successive length I, 2, 4, 8, etc. 8 Take logs and use Exercise 29, Sec. 1.6, 9 (b) False; (c) true; (d) true, use Schwarz inequality; (f) sum from n + I to 2n, 14 Write a, = (a,/Jk)Jk and use Schwarz inequality, Section 5.3 I Neither is alternating so use the Dirichlet test. 2 (a) - I .; r < I (b) x = 0 (c) - 3 .; x .; - I 600 ADVANCED CALCULUS (d) Ixl s! (I) s > 0 (h) y > IX + P (k) x> -lor x S -2 5 (a) 0; (b) e; (c) OCJ if c < I, 9 Consider L (Pn+ I - Pn)· (e) Ix - II s}3 (g) -e-1sp<e- 1 (i) -I < x s I (I) x s 0 or x > 2 I if c = I, 0 if c > 1. (j) -x < x < ex (m) All x Section 5.4 2 [2 n + 1 + (-1)\"]/3. Section 5.5 7 -2<x<1. 1 Approx. 109566 terms. 2 (b) (log n)2/2 + 0(1), where 0(1) means a bounded term. 3 Allow a radius of rotation of about 2L. 5 (a) S = -.0826, error less than .0005; (b) S = .904412, error less than .005. 9 L'~ k 3 = P(N), where P is a polynomial of degree 4. 10 Write the general term as I/(n - a) - I/(n - b). 12 Use Stirling's formula. 16 Examine some \"partial products.\" Section 6.2 3 Yes; no; yes. 5 lim, I 0 F(x)/x 2 = L l/n 2 • ~ L • r:£ 9 Examine the behavior of I In and I In' • 0 • L 10 Split the interval of integration into [-I, -c], [-c, c], and [c, I], and show that the first and last lead to contributions that are very small if n is large, while the remaining integral is close to g(O). II If q lies in all the sets C n , then a contradiction arises. Thus the intersection of all the sets (and thus the intersection of finitely many) is empty. Section 6.3 (b) x I --- = I - (x - I) + (x - l)l - (x - 1)3 + .... I + (x - I) (X2)2 (X2)3 (c) log (I + Xl) = Xl - --- + .- - .... 2 3 2 (a) x d Jx d _! l= ~+ x~_. dx I dx I - x (I - X)3 ' I (I + X)(c) -log - 2 I - x 3 (a) No; (b) yes. 5 Apply the corollary to Theorem II. 9 If w = -1 + ii, then w l + w + 1 = O. 10 1/F(x) = I - 2x + 3x 2 - •.. - 96x 7 + ... II I/F(x) is a polynomial. (b) jn/4 erf (I) - 1/(2e). HINTS AND ANSWERS 601 13 If </J = L QPC, then tan </J = 2 sin (0/2)/[1 + 2 cos (0/2)] = 0/3 + 03/72 + \"', from which one may find that </J = 0/3 + 03/648 + .... 15 See Sec. 7.4 of Reference [33] m the Reading List. Section 6.4 4 o. 5 x.. 6 (n/2)/xl. 7 n/2 (try simple substitution). 8 Differentiate and then mtegrate by parts. 10 Find the smallest value for g(t), notmg that any x ? I is allowed. 16 Evaluate each side. (Nevertheless, IG(x, .1') I s l/x 2 for I s .1', so the inside integrals converge uniformly.) Section 6.5 I Put t = s/y. 2 (b) Put A(x) = O. 4 (a) r(~)r(~)/3r(¥). (b) j2r(i) = j2n. (e) -r(~)r(1). (d) ir(i)r(i). I 6 r((p + I)/q). q 7 r(s + I)/(r + I)\" l 8 (a) Le-l/t' + jn erf (l/L) - jn. (e) F(x) has the form A/j x. Section 6.6 I 13.86 = arccos (.97089). 3 Calculate (11/n - Imll! _1. 1])2 directly. 9 eX - (2/n) sinh (n){~+ ~; [( _I)n/(I + /l2)](COS nx - /I sm /Ix)}. 10 (il) p'q=\"\\' a;lin • L. II (a) l/j2n; (b) use deMoivre's identity. 13 (b) Use the recursion relation for the polynomials Tn' Section 7.2 I (a) A translatIOn sending the ongin into (3, - I). (b) A reflection about the line y = x. (e) A rotation by n/4, followed by a radial expansion which multiplies points by j2. 3 The line u + I\" = 0, m the plane w = O. 4 T(p) = T( - pl. If (x, .1') = x + i.r = z, then T(z) = Z2. 10 (e) The XYplane is mapped onto the whole UVplane, except for certain pomts on one of the axes. The mapping is mostly l-to-1. (d) The image of the X Yplane is only a curve in the U V plane. (e) This is, of course, the famIliar polar coordinate mapping; It should be analyzed in detail. 12 This wIll be treated in detail m Chap. 10. 13 (d) T(x, y) = (x', y') where x' = - 3x/5 + 4.1'/5 + t y' = 4x/5 + 3y/5 -~. 7 The ranks are (c) 2; (d) 3. 4 (0, -3),(-5,6),(2, -3),(-1,0). 602 ADVANCED CALCULUS Section 7.3 2 [2, -1,3]. [ 0 I 2] 6 (a) I 4 3 I 0 I 8 (a) All of XYZ space is mapped onto the plane whose equation is u + l' - W = 0, m a many- to-one fashion. [-5 -I] 9 (a) I 3' 10 (ST)(x, y) = (2x - 2y, - 2x + 6y), and (TS)(x, y, z) = (4x - y - 2z, 12x - 2y + 4z, - 2x + Y + 6z). II (c) Yes. Section 7.4 1 (b) [-18 12 25 -12] o -4 (c) n ~] -6 5 Take I1p = (h, 0) and (0, h) in turn, and compute lim !(p + I1p) - T(p) h 12 Estimate the maxima of the absolute values of the derivatives, arriving at the matrix [~ ~J. Section 7.5 2 (a) e 2x ; (b) 2, if x # O. 3 (a) Locally I-to-I but not I-to-I in the whole plane, even though J is never O. (b) I-to-I m the right half plane and in the left half plane. (c) Never I-to-I locally, since it maps the (x, y) plane onto the parabola 1'2 = 4u. 10 (a) Use y = x 3 . II The image set is a curve. 12 Consider separately the case where x 2 > y2 and where x 2 ~ y2 16 This depends on the multiplication property for determmants [see Appendix 3]. Section 7.6 1 Yes; no. At (0, O),oF/ay = I, of/ax = 0; moreover, for Ixy I small, the equatIOn IS approximately x 2 + y = O. 2 No; yes. 4 No such representation exists. (Examine the graph of each.) 6 (a) Assume f of class C near I, and 1'( I) # O. 7 There is always the solution y = I, identIcally. In some cases, this IS not the only solutIOn; when f(l) = (I - 1)2, Y = (I - x)/(I + x) is also a solution, but not through (I, I). 10 It IS sufficient if F.(0,0) # -I and F2(0,0) # O. 16 Consider 1f'1 + f HINTS AND ANSWERS 603 Section 7.7 2 Evaluate the Jacobians first. 4 (b) Solve for y in terms of u, 1\" and x and substitute this III the second equatIOn. Section 8.2 1 (a) No; (b) no; (c) yes; (d) no. 2 (b) Look at the seven disjoint sets that compose S1 U S2 U S3' and write F(S I U S2 U S3) III terms of F(S;), F(Si n Sj)' and F(SI n S2 n S3)' 5 Use Theorem 8 of Sec. 2.4. 7 See also Exercise 10 below. 8 Not necessarily; try j(x, .1') = XI/(X 2 + .1'2). 10 (c) Ifjis of class C'. Section 8.3 1/2 1 -I' 3 (a) I' dv I' 2(u 2 - [,2) du = l • 0 . I' .1 1 (b) I du r (u 2 + uv) dv = j. . 0 . 1 - 2u .3 .4 5 Setting u = xy, v = x 2 - .1'2, the integral transforms to (~)I du I dv = 3. • 1 • I 8 The areas of the faces are J6, J29, JiI, and the volume is 5. 9 The upper half of the X Yplane is mapped onto the portion of the (5, t) plane lying inside the parabola (s - t)2 - 8(5 + t) + 16 = 0. Lines in the (5, t) plane correspond to conics in the XYplane. The Jacobian is °only on the boundary .I' = 0. Section 8.4 1 The double point corresponds to t = 2, t = - 2, and the slopes of the tangents are 2 and - 2. 2 k = 4n(l + n 2 + 4n4 )1 /2(1 + 4n 2 )-3 / 2 3 L = rI (9t 4 - 2t 2 - 4t + 2r /2 dt. 4 k = (76)1/2( 14f 3/2 . . 0 7 The differential has the requisite form, except at the origin. There, angles are tripled. 2. • 8 L = a r }2 - 2 cos t dt = 4a f Isin 01 dO = 8a. . 0 • 0 9 The curves are perpendicular. 13 Use the mean value theorem. 17 One chOIce is .I' = 2t/(t 2 - I). Section 8.5 1 The tangent plane may be given by x = - *- v, y = ~ + u + v, z = 2 + 4v, or by 4x + z - 1 = 0. 4 The curve meets the surface in three points, (0,0,0), (I, 1,2), and (j, i, -17). The angles between the normal to the surface and the tangent to the curve are n/2, and arccos [6/(Ji7J97)) arccos [-2/(J4IJI7)]. 604 ADVANCED CALCULUS 7 The area of the ellipsoid is • 2. f sin ¢ d¢ I' {a2b2 cos2¢ + c2sin 2¢ [a 2 sin 2 (J + b2 cos2(J]}li2 dO • 0 . 0 8 The area of the Mobius strip is the same as that of l:I' which IS ,2. 1 J(V)2 [ (V)J2l112 J0 du J_1 i.2 + 2 - v sin 2 I dv 10 (-¥-)n. 13 The area is (2AB/3)((1 + 13)312 - l)n. 14 nR 2 - 2R 2. 18 4n. 20 If the curve is P = y(t) with y(O) = Po, then F(y(t)) = 0 on a neighborhood of t = O. Apply the chain rule, and interpret the result. Section 8.6 (x 2 + y2)R dx dy 8npR 4 .. . 8 1= 2p ff ~~c~~~= = --, where D IS the disk of radius R ... J R 2 - x 2 _ y2 3 D 10 F = 2nkP( 1 - -~--=),which approaches 2nkp as R i. The attraction of an infinite plate JT2 + R 2 is independent of the distance from it. II Describe the shell by x = sin ¢ cos 0, y = sin ¢ sin 0, z = cos ¢, 0 s ¢ s n, 0 s 0 s 27t, and let P = (0,0, a) with 0 ~ a < I. With p = density (mass per unit area), the component of the force at P in the vertical direction is F = _j,Z.d(J I\" ~o_sj=--a)(p ~njJ)dj '0 '0 (1+a 2 -2acos¢)3 12 This may be integrated easily; for example, put u2 = I + a2 - 2a cos ¢. One finds that F = O. Section 9.2 I (a) i; (b) -t'rr; (d) ~ - j + ~ = j. 3 0,8,8,8. 4 (b) tJ; (c) 2n; (d) 0 + 12 - ~ + 0 =.!.f. 5 2,2,0, O. II (a) 2xyz dx + x 2 z dy + x 2Y dz; (b) (x 2 + y2r 1(2x dx + 2y dy). 13 (a) x 2 dy dx - z dy dz; (c) 0; (e) (2xy - x) dx dy dz; (g) O. I I 16 (a) 4 f du f (uv 2 + v 3 ) dv = j; (b) n; (c) 1 - ~ = l • 0 • 0 1 I 18 r ds J dr (r4 + 2r 3 s - 4r 2s2 + 2rs 3 - S4) = n. HINTS AND ANSWERS 605 Section 9.3 (a x b)' c = 2, a x (b x c) = 8j + 24k, (a x b) x c = 2i + j + 21k, (a . b)c - (a . c)b = - 8j - 24k 3 With c = a x b, show that 4 !fax v = b, then a x b = (a' v)a - (a' a)v = ka - la 12V. Thus, ifsuch a vector exists, It must be (ka - (a x b))/Ial' (provided lal # 0). However, a solution does not always exist; a necessary condition is that a . b = O. This may be seen to be sufficient. 5 The vectors p.lie (for n :2: 3) in a plane normal to a, and rotate about it, each being orthogonal to its predecessor. !f la 1 < I, lim P. = O. 7 Since f(t)· f(t) = I, f'(t)· f(t) = O. The curve described by p = f(t) lies on the sphere Ipl = 1; this therefore states that the tangent vector at p is orthogonal to the vector from 0 to p. 13 For the second, let b = b,i + b,j + b3 k, c = cli + c2 j + c3k, and take a = i. By direct com- putation, it is seen that i x (b x c) = cdb 2 j + b3k) - b l (C2 j + C3k) = c,b - blc = (i' c)b - (i' b)c Similarly, one shows that j x (b x c) = (j' c)b - (j . b)c and k x (b x c) = (k . c)b - (k . b)c. Putting these together, with coefficients at, a 2 , a3 , one arrives at the general formula. 14 Assuming that f and V are of class C\", these follow by direct calculation. Formally, they may also be obtained from the relation V x V = 0; thus, curl (grad!) = V x Vf = (V x V)f = 0 and div (curl V) = V . (V x V) = (V x V)· V = O. This can be made acceptable by discussing vector systems whose components are elements from an arbitrary noncommutative ring. 15 For the second, observe that e 2(fg)/ex' = ge'f /ex 2 + 2(ef/ex)(eg/ex) + fe'g/ex'. 16 As an alternative to direct computation, one may use the relation a x (b x c) = b(a . c) - (a' b)c with a = b = V, and c = V, obtaining V x (V x V) = V(V . V) - (V . V)V. This requires the additional consideration indicated in Exercise 14. 17 An alternative to direct computation is the following. The analog of the rule for differentiation of a product is V . (F x G) = V . (F x G) + V . (F x G), where the dot indicates the function to which the differentiation is applied. Using the relation a' (b x c) = c . (a x b), we have have V . (F x G) = G . (V x F) - V . (G x F) = G . (V x F) - F • (V x G) 18 If w = f(x, y, z), then <lw = f. <Ix + f2 dr + f3 dz and Assuming that f E C\", ddw = O. Likewise, if w = A(x, y, z, w) dx dy, then <lw = A3 dz <Ix dy + A4 dw dx <lyand d<lw = A 34 dw dz dx dy + A43 dz dw dx dy, which is again 0, if A E C. 19 Use Exercises 14and 17. 606 ADVANCED CALCULUS Section 9.4 2 dw = 3(x 2 + .1'2) dx dy, so that • • • .21t 1 I w = 3 II (X 2 + .1'2) dx dy = 3 I dO I' r2r dr = 3n/2 '}\"O . 0 . 0 5 If V is the solid ball, x 2 + .1'2 + Z2 <:; 1, and L is the sphere which is its boundary, we Indicate the proof of the relation rr A dx dy = 1'1'1' A 3 . Let D be the disk x 2 + .1'2 <:; I. Then, • -1: ,.•. v JJJ A 3 = JJ {A(x, y, Jl--\"-:~2=-y2) - A(x, .1', -J1 - x 2 - .1'2)) dx dy v D Using the parametrization z = J1 =-X2-=-:f.2 on the top half of L, and its negative on the bottom (with reversed orientation), we obtain for the surface integral JJ A dx dy = JJ A(x, .1', Jl~~2 - .1'2) dx dy + JJ A(x, .1', - Jl - x 2 - .1'2) dy dx r D D = JJ {A(x, .1', JI- ~2_ .1'2) - A(x, .1', - J1 - x 2 - .1'2): dx dy D verifying the relation. r r t 2 dt 7 Area = 9a 2 • 0 (1 +t'fi = 3a 2/2. 9 With w = xy2 dy - x 2y dx, dw = (x 2 + .1'2) dx dy. Let Do be the portion of D in the first quadrant bounded by the closed curve \" formed of the lines x + .I' = 4, x = 0, .I' = 0, and part of the circle x 2 + .1'2 = I. Then, 1'1' dw = I' w = 128/3 - n/8. By symmetry, this IS the same as •. Do . y the integral of dw over the other three pieces of D, so that the result is 512/3 - n/2. 10 d(x dy dz + .I' dz dx + z dx dy) = 3 dx dy dz. II (b) Using z = [R 2 - x 2 - .1'2]'/2, we have dz = - (x/z) dx - (y/z) dy, so that 2 . (x 2 + .1'2)2 + 4X 2y 2 1= 1'1----- ---dxdr 6 JR 2 2 2 - 'j, - x - .I' 1 .' r5 dr . z. 2' 2 8 5 = I -- -cc-'-~~= 1 (1 + 4 cos 0 Sin 0) dO = nR 3.oJ'R2-r2.o 15 12 With w = x dy dz, dw = dx dy dz, and (dw)* = - (4vw + 4uw + 2u) du dv dw. Also, w* = (2u 2 + 2uv - 2uw) du dv + (4u 2w + 4urw - 4uw 2) du dw - (4uI'W + 4r 2w - 41'W 2 ) dl' dw and it is seen that d(w*) = (dw)*. 17 For the first, apply the divergence theorem to the cylindrical region R obtained by erecting lines of height 1 on the set D. One then sees that and that JJJ V . F = JJ V . F HINTS AND ANSWERS 607 Section 9.5 I (1I) f(x,.I') = X 3.1' + X 2 .1' + .1'2 + C; (c) f(x,.I', z) = X2 YZ3 + xz; (d) since dw #- 0, no function f eXIsts. ,I ,I .1 .1 2 (b) flx,.I\" z) = I A + I r(xA I + .I'B I + zCd = I A + I r(xA I + yA 2 + zA 3) = A(x,.I', z) . 0 . 0 . 0 • 0 using part (1I) and the relatIOns B I = A 2, C I = A 3 which come from dw = 0. (c) Along the straight line from (0, 0, 0) to (x, .1', z). 4 Yes..f (x,.I') = mlog (x 2 + .1'2). 5 Use Exercise 2. The homogeneity of A, B, and C enables one to factor out r\\ and carry out the integration. 6 (a) One possible factor is x- 3. (b) Since w dw = 0, integrating factors exist. One is x 2 • (c) No mtegratmg factor exists. 8 (c) If rJ = A d.l' dz + B dz dx + C dx dy and rJ = dw where w = a dx + b dy + c dz, then C = ob/ox - oa/oy. To venfy that the gIven functions have this property, we differentiate a(x, y, z) and b(x, .1', z), obtaining ob.1 .1 =1 rC+1 r 2(xC I -zAd ox . 0 . 0 va . I .1 , = -I rC + 1r2 (zB 2 - yC 2 ) OJ' • 0 • 0 By assumptIOn, da = 0, so that A, + B 2 + C 3 = 0. Usmg this, replace z(A I + B 2 ) by -zC 3, obtammg ob oa .1 .1 - =21 rc+1 r2(xC I +yC 2 +ZC 3)=C(x,y,z) ox 0.1' . 0 • 0 by part (a). 10 (a) Using Exercise 9, one obtains w = (!)(2x 2.1'z - Z3y ) dx + (!)(4xz 3 - 3y2z 2 - x 3z) dy + (!)(3 y3z - 3xyz 2 - x 3y) dz To this, any exact I-form df may be added. With a judicious choice, one obtains the simpler solution w = X 2.1'Z dx + xz 3 dy + lz dz. (b) Exercise 8 yields the solution w = [(1)xz 2 + (j)(Z2 - .1'2)] dx + (i)xy dy - [(1)x 2z + H)xz] dz However, by inspection, we see that rJ = [(2xz + z) dz - .I' dy] dx = {3 dx. Moreover, {3 itself is an exact I-form. Thus, we obtain the simpler solution w = (xz 2 + 1z 2 -h 2 ) dx 13 If ¢ is an integrating factor for the 2-form, then When rJ = x dy dz + .I' dz dx + z dx dy, this differential equation is X¢, + Y¢2 + Z¢3 = - 3¢ which IS satisfied by any function ¢ which is homogeneou' of degree - 3. For example, we may take ¢(x. y, z) = X 3 and have ¢a an exact 2-form, which is dw for w = (-!)(yx- 2 dz - zx- 2 dy). It is interesting to notice that in this example, the form ¢rJ has homogeneous coefficients, but that the methods of Exercise 9 (and also of Exercise 8) fail. 14 If w is exact, then w = dfJ. Hence w* = (d{3)* = d({3*), and w* is also exact. 608 ADVANCED CALCULUS Section 9.6 I (a) In (9-62), takef = g. (b) Since (c/co)(g* - g) = °on cO, V(g* - g) = °throughout O. If 0 IS a connected set, we may conclude that g* - 9 is constant. 3 (a) Apply the divergence theorem to F x [V x G), and use the relation V . (F x [V x G)) = (V x G) . (V x F) - F· (V x [V x G]) (b) In (a), interchange F and G, and subtract the two formulas. These relations may be used to solve the vector analog of Poisson's equation, V x [V x V] = F Section 10.2 3 (a) It helps to look at y = sin x and y = I - x/6. (b) The first three are .988567, 2.523600, 6.242721. 6 (a) Use Taylor's theorem about x = x, where f(x) = f'(x) = 0. (e) If Xl = 2, you should have x, = 1.751 18, and XIO = 1.732655. (d) ~ is replaced by l 7 The diagram is symmetric about the A aXIs and consists of three regions where three roots are found, the left region being unbounded, and a bounded region where five roots are found. In the connected set that remains, only one root is found. Section 10.3 I Sketch y = X and y = f(x) and locate the points (x., x.+ d· 2 (a) Show that ab S; a.+ 1<) A. (b) Show that) A - a. S; 2/(n + I). 3 Note that IxI = ) x 2 (ThIs result is the key to the Weierstrass approximation theorem. See Reference [4] in the Reading List.) 4 (b) Let A = a3 , and suppose x. = a - E. Then estimate x.+ I according to each algorithm. S Starting with x = I, y = 1, P, = (.7277, .7216), P 20 = (.694967, .768263), P,o = (.6948196894, .768 1691559). 6 Consider I' xf •. . 0 Section 10.4 I (a) This is an instance when it may be easier to do a direct search, rather than to attempt to solve d 2x/dt 2 = °or d3 x/dt 3 = 0. (b) The maximum velocity occurs when 0 = 1.277 radIans. 2 The mmimum off + Ag occurs when x = 24/(34 + 1/A), so that for large A. x --; H. 3 (-i, Yo) is one critical point. 4 The Lagrange equations have a solution for which f3 = - I, x = I. 6 9. 7 Minimum I; maximum 3. 8 8abe/3)3. 9 P = (0, 0,f(0, 0)). A nonanalytic treatment is possible. The volume of the region bounded by the tangent plane, the cylinder, and the XY plane is 7th, where h is the height of the point on the tangent plane which lies directly above (0,0,0). Thus, one need only minImize h. HINTS AND ANSWERS 609 Section 10.5 2 (a) .743; (b) .944; (e) .736. 3 I::::: .693 25. 4 Wnte J 4x 2 - )'2 = J2x - )' J2x + y and use Schwarz' mequality. 6 10.; I .; 12, and these bounds cannot be Improved. 7 15663 ± .0182. 8 Put t = I/x, and then write the interval of integration as [5, 2n], [2n, 3n], etc., and integrate by parts. 9 Show that an+ I - bn+ [ = (Jan - Jbn)2/2. 12 f'( 6) = 2.66 ± .0133. LIST OF SYMBOLS A(S), V(S) .r/ Ck.C,C' C y) .11 I (' Q R, R\" S '/I Z £I, £12 W, (J L inC sup bdy fi,I~,t;, 610 area, volume, 169 class of sets, 376 differentiable functions, 128 complex field, 556 class of continuous functions, 304. 307 derivative operators, 130 field, 554 lower bounds, 58 metric space, 304 neighborhood, 31 open set, 35 rational field, 6 real field, n space, 2 class of sets, 64 upper bounds, 58 set of in tegers, 6 differential operators, 341, 425 curve, 399 boundary operator, 417 Hilbert space, 305 differential form, 450 surface, 417 greatest lower bound, lub, 58 boundary, 30 partial derivatives, 127 c E,rj; uU nn o o S [x] [a;J [a, h] Ipl Illllf *Ii.fl *lim, *2: <{; g) d(p, q) d(A, B) B(po, r) x n Vr I set inclusion, 4 set membership, 4 epsilon, 39 set union, 5, 33 set intersection, 5, 33 empty set, 5 origin of R\", 3 closure of S, 31 greatest integer in x, 6 matrix, 335 closed interval, 30 length (norm) of p, II norm of function, 265 operations in *«(\" 307, 311 inner prod uct in *«(\" 308 metric, 304 distance between sets, 60 ball of radius r at Po, 18 inner (scalar) product, 8 vector product. 465 normal to surface, 422 gradient, 130 approximate equality, 124 basis vectors, 126, 306 Fourier mapping, 311 end of proof. 14 LIST OF SYMBOLS 611 This page is intentionally left blank~Inde~ x ~ - ~./- ~ Index Abel theorem, 279 Absolute convergence: integrals, 216, 223 series, 236 Absolute value, 12 Accumulation point, 31 Addition: of forms, 455 of numbers, 5, 554 of points (vectors), 7 of sets, 5 Alternating series, 237, 244 (Ex. 4) Analogies: between forms and vectors, 472 between series and integrals, 228, 245, 252 Analytic function, 149, 573 Angle: between hyperplanes, 19 (Ex. 10) between poin ts (vectors), 15 Antiderivative, 181 Approximation: of finite sums, 252 least square, 161 piecewise linear, 87 polynomial, 86, 147, 323, 583 of sum of series, 255 uniform, 86 Approximation theorem for differentials, 128,344 Arc (see Curve) Archimedean law, 6, 44, 558 Area: altered by transformation, 382, 386 inner and outer, 172 for unbounded sets, 205 zero, 172, 179 (Ex. 14, 15), 385 Area continuous (a.c.), 379 Arithmetic-geometric mean, 545 Arithmetic means, 56 (Ex. 29) Atlas, 434 Attractive fixed point, 531 Ball, 18 Basis, 306, 563 Begging the question, (see Circular argument) Bessel function, 284 (Ex. 4) Bessel inequality, 316 Beta function, 302 Bisection process, 97 (Ex. 15), 522 Boas, R. P., 251, 580 Bolzano-Weierstrass theorem, 62, 65 Boundary, 30 oriented, 437, 447, 449 615 616 INDEX Boundary: point, 30 of surface, 417 Bounded convergence theorem, 269, 586 Bounded function, 90 Bounded sequence, 38 Bounded set, 5, 31 Bounded variation, 406 Boundedness theorem for transfor- mations, 338 Bounding Curve, 506 Bounding surface, 419, 509 Calder, A\" 258 Cardinal number, 551 Cauchy convergence criterion, 52, 103, 230,265 Cauchy integral theorem, 578 Cauchy principal value, 209 Cauchy-Riemann equations, 413, 576 Cauchy sequence, 52 Chain rules for differentiation, 136, 346 Change of varia ble: in differential equations, 142 in multiple integrals, 203, 382, 392, 488 in single integrals, 183, 202 Chart, 434 Circular argument (see Petitio principii) Closed curve, 400 Closed form, 498, 507 Closed interval, 30 Closed manifold (surface), 437, 509 Closed set, 30 Closure operator, 31, 40 Cluster point, 31 Commutation theorem for d, 483 Compact graph theorem, 92, 333 Compactness, 65, 90, 93, 559 Comparison test: for improper integrals, 214 for series, 231 for uniform convergence, 266 Complement of a set, 30 Completion, 63, 265, 306, 556 Complex field, 556 Complex-valued function, 26, 574 Component of a set, 37 (Ex, 19) Composition of functions and transfor- mations, 78, 331 Computer use, 521 Conformal mapping, 413 Connectedness, 34ff., 95, 560 Continuity: of functions, 72 of transformations, 75, 332 uniform, 82 Contour integral, 578 Contraction theorem, 528, 534 Convergence: absolute and conditional, 236 acceleration of, 254 Cauchy, 52 Dirichlet test: for improper integrals, 218 for series, 236 Osgood- Lebesgue theorem on, 269, 586 poin twise, 261 preserving, 73 radius of, 240, 278 of a sequence: of functions, 240. 261 of points, 39 of a series, 229 uniform, 263 Convex, 18 Countability, 6, 552 Covering, open, 64 finite, 65 Critical point, 133, 154,373,426 Cross product, 467 Curl,471 Curvature, 408 Curve, 21, 399 algebraic, 411 analytic, 408 of class Co, 408 closed,400 curvature of, 408 equivalent, 406 length of, 403 linked,2 simple, 400 smooth,400 space filling, 560 trace of, 400 winding number of, 412 Dedekind cuts, 556 Denseness, 6, 37 (Ex. 5), 323 Dependence: functional, 368 linear, 562 DeRham theorem, 507 Derivative, 116, 130 directional, 126 generalized, 324, 584 of inverses, 123, 358 matrix-valued, 341 mixed, equality of, 190 partial, 126 second,425 of a set function, 378 total, 130 of a transformation, 341 vector-valued, 130, 343 Determinant, 140, 337, 564 Diameter of a set, 60 Dictionary, 473, 506 Differentiable function: one variable, 116 several variables, 132, 345 Differentiable set function, 378 DifferentIable transformation, 345 Differential, 341 Differential form, 446ff. Differentiation: chain rules for, 136, 346 of composite functions, 139, 348 of forms, 456, 485 of functions defined by integrals, 194 numerical, 546 partial, 126 of series, 270, 278, 324 of set functions, 378 term wise, 270 Dimension, 563 Dipole, 585 Dirac delta function, 277 (Ex. 10), 585 Directed system, 169 Direction in space, 125 Dirichlet problem, 516 Dirich let test: for integrals, 218 for series, 236 Disconnected, 34, 560 INDEX 617 Discontinuity, essential and removable, 107 Disjoint sets, 5 Distance: between functions, 86, 304, 307 between points, 12 between sets, 60 Distance-decreasing mapping, 334 (Ex. II) Distributions (Schwartz), 324, 585 Divergence: of improper integrals, 209, 223 of sequences, 39 of series, 229 of a vector field, 470 Divergence theorem, 478 Domain, 20 Doughnut, 430, 509 Dual space, 566, 583 e = 2.718 281828459\"',48 Eberlein, W. F., 80 Economics, 135 Eigenvalue, 565 Elementary functions, 78, 80 exponential, 282 trigonometric, 249, 283 Elliptic integrals, 545 Empty set, 5 Equation of continuity, 494 Equivalence classes of curves, 411 Euler, L., 257, 283 Euler's constant, 271 Exact differential forms, 497, 507 Expected value, 198 Exponential integral, 224 Extension theorem, 109 Tietze, 110, 274 Exterior point, 30 Extremal problem, 154, 535 Extreme value, 117 Feynman, R., 10 (Ex. 3) Field: algebraic, 5, 554 complex, 556 particle-like, 572 618 INDEX Field: rational, 556 vector, 468 conservative, 506 divergence of, 470 irrotational, 495 solenoidal, 509 Finite set, 6 Fixed-point theorems, 527, 553 n-Form,450 addition and multiplication of, 455 closed, 498, 507 differentiation of, 456, 485 exact, 497, 507 Fourier: basis, 311 coefficien ts, 311 polynomials, 315 series, 311 Fresnel integrals, 222 Fubini theorem (weak form), 186 Function, 19 analytic, 149 bounded,90 of bounded variation, 406 of class en, 128 continuous, 72 convex, 25, 28 (Ex. 10) defined implicitly, 363 differentiable, 116 domain of, 20 gradient of, 130, 343 graph of, 23 holomorphic, 573 homogeneous, 146 (Ex. 11, 12) hypergeometric, 545 implicit, 26 increasing, 25, 101 in verse, 111 ff. limits of, 97ff. linear, 334 matnx-valued, 26, 327 monotonic,96, !OI, 114,377 norm of, 86, 307 nowhere differentiable, 273 orthogonal. 309, 312, 325 (Ex. 13) periodic, 321 set, 376 space, 265 Function: vector-valued, 21, 328 Functional. 446, 566, SID Functional dependence, 368 Fundamental theorem: of algebra, 580 of calculus, 181, 379 Gamma function, 297 Gauss theorem (divergence), 478, 491 vector form of, 493, 496 Global property, 89 Gradient, 130, 343, 469 Graph,23 reflection of, 112 Greatest lower bound (glb, inf), 6, 58 Green's identities, 515, 517 vector form of, 519 (Ex. 3) Green's theorem, 478, 487 vector form of, 497 Grid, 168 refinement of, 170 Harmonic function, 163,515 Heine-Borel theorem, 65 Heinlein, Robert, 4 Hessian, 425, 428 Heuristics, 257, 314, 324 Hilbert space, 305 Homeomorphism, 583 Homomorphism, 583 Hyperplane, 15 Hypersphere, 205 Ideal, 583 Image, 76, 328 inverse, 76 Implicit function theorems, 362 Improper integral, 205ff. comparison test for, 214 Inclusion of sets, 4 Incompressible fluid, 494 Independence: linear, 368, 562 local, 134 of path, 499 Infinite sets, 6 Infinity, 100, 599 Inner product, 308 Integers, 6, 556 Integral: absolutely convergent, 216, 223 indefinite, 181 iterated, 184 Lebesgue, 319, 586 oriented, 177 upper and lower, 171 Integral test, 233 Integrating factor, 505 Integration: numerical, 197,541 by parts, 216 termwise, 268 Interior, 29 Intermediate value theorem, 93, 95 Intersection of sets, 5 Intervals, 18 nested, 61 Intuitionism, 550 Inverse: local,358 of mapping, 114, 352 Irrotational field, 495 Isolated point, 32 Isomorphism, 16 Iterated integral, 184 Iterated limit, 105 Jacobian, 140, 354 Jordan measurable, 175 Kummer, E. E., 256 Lagrange multiplIers, 539 Landau, E., 557 Laplace equation, 142, 515 Large numbers, 251 Least squares, 161 Least upper bound (lub, sup), 6, 58 property, 57 Lebesgue convergence theorem, 269, 586 Legendre polynomials, 309 Level curves and surfaces, 25, 160 INDEX 619 L'Hospital's rule (Bernoulli), 121 Light, 569 Limit, 38, 97ff. inf and sup, 44 at infinity, 105 iterated, 105 one-sided, 10 1 sums, products, quotients of, 43, 102 Limit point: of sequence, 42 of set, 41 Line, 16 Line integral, 450, 478, 489, 499 Linear dependence, 368, 562 Linear functions and transformations, 334, 563 Linear programming, 166 (Ex. 21) Linearization, 346 Lipschitz condition, 88, 154 (Ex. 18) Local properties, 89, 117, 131, 134, 354, 358, 500, 509 Lower bound, 6 Lower limit (lim inf), 44 Manifold,433ff. Mapping (see Transformation) Mathematical induction, 45, 551 Matrix: Hessian, 425 identity, 387 inverse of, 337 nonsingular, 337 positive definite, 426 product of, 336, 564 rank of, 337, 564 symmetric, 425 trace of, 470 Matrix-valued function, 26, 327 Maximum minimum: problems, 154 tests, 157 Maximum modulus theorem, 579 Maxwell's equations, 512ff. Mean square convergence, 307 Mean value theorem: for functions, 118, J51 for integrals, 178 (Ex. 5) for transformations, 350 620 INDEX Membership, 4 Mesh, 168 Metric space, 63, 265, 304 Midpoint, 9 Minimax (saddle point), 97 (Ex. 16, 17), 154 Minimum in a set, 58 Mobius strip, 436, 490 Monotonic function, 96, 101, 114,377 Monotonic sequence, 47 property, 57 Morals, 569, 572 Mutual separation, 34 Neighborhood, 31 deleted,98 Nested set property, 61, 66 Neuman problem, 516 Newton's method, 523, 525, 532 Noncountability, 6 Norm: of function, 86, 307 of grid, 168 of point, II Normal, 15,422 Numerical methods, 520-548 One-sided limit, 10 I One-to-one mapping, 354 Open interval, 30 Open mapping, 356 Open set, 29 Optimization, 163 constrained, 536 Orientation: of integrals, 449 of manifolds, 435 preserving, 412 of regions, 447 reversing, 412 Orthogonality, 15, 309 Orthonormal, 309 Paradox, 121, 124 (Ex. 24), 183,222,224, 238,248,261,262,296 (Ex. 16) Parametric equivalence, 406, 432, 460 Parseval formula, 317 PartIal derivative, 126 Partial sum, 228 Partial summation, 237 Path (see Curve) Peano, G., 560 Pendulum, 569 penod of. 571 Periodic function, 321 Petitio principii, 80 (See also Begging the question) Pfaffian, 505 Photon, 10 PhySical interpretations, 476, 494 Piecewise linear, 87 polygonal, 35 Plane, 2, 421 Point, 3 of accumulation, 31 critical, 133, 154, 3n 426 fixed,531 Isolated, 32 limit, 41, 42 multiple, 400 norm of. II saddle, 154 Poisson equation, 514 solution of, 516 Polar coordinates, 203, 395 Polynomial approximatIOn, 86, 323, 583 Taylor, 147 Potential, 506 Power series, 278ff. Pre-image, 76 Probability, 198, 376 Product: Cartesian, 23 cross, 467 dot, 8 of forms, 455 inner, 308 of matrices, 336, 564 of series, 246 of transformations, 331 Proof by contradiction, 35 (Th. 2), 550 Quadratic forms, 566 Quantifiers, 550 Quaternions, 465 Raabe's test, 2,13 RadIUs of convergence, 240, 278 Rank, 337, 564 Ratio test, 231, 232 Rational numbers (field), 6, 556 Reality, 568 Rearrangement of series, 2,19 Rectifiable curve, 404, 406 Recursion, 48, 55 (Ex. 15, 16), 522 Refinement, 170 Repulsive fixed point, 531 Reversal of order: of integrals, 188, 192 of sums, 248 Riemann sum, 169 Rolle's theorem, 117 Root test, 232 Runge theorem, 577 Saddle point, 154 Schroeder-Bernstein theorem, 552 Schwarz inequality: for integrals, 200 (Ex. 23), 308 for sums, 13 Secant method, 522 Sequence, 27 Cauchy, 52 monotonic, 47 of sets, 27 Series, 228 absolutely convergent, 236 alternating, 237 double, 245 harmonic, 250 hypergeometric, 242, 244 (Ex. 211) integration of, 268, 281 partial sum of, 228 power, 240 product of, 246 rearrangement of, 239 summation of, 250 Taylor, 150 telescoping, 230, 255 uniform convergence of, 264 Set function, 376 additive, 376 differentiation of, 378 monotone, 377 INDEX 621 Set theory, 549 Sets, 4 additIon of, 5 area of, 168 boundary of, 30 bounded, 5, 31 closed,30 closure of, 31, 40 compact, 65 connected, 34 countable, 6 diSJoint, 5 intersection of, 5 open, 29 Simple curve, 400 Simple surface, 417 Simply connected, 503 Simpson's rule, 197 Sink,493 Smooth curve, 400 Smooth surface, 418 Space: complete, 63 function, 265, 307 Hilbert, 305 metric, 63, 265, 304 n-dimensional, 3 Space-time, 4 Spherical coordinates, 205 (Ex. 2), 396 Square root, 50, 120 Steepest ascent, 163, 535 Stirling's approximation to n!, 252, 300 Stokes' theorem, 478, 489 generalized, 477,497 (Ex. 18) vector form of, 493, 496 Strictly monotone, 47 Subsequence, 42 Superconvergence, 524 Surface, 22,417 analytic, 425 area of, 428 boundary of, 417 bound ing, 509 of class en, 424 equivalent, 432, 460 in 4-space, 439, 463 integral, 478, 493 normal to, 422 orientable, 435 622 INDEX Surface: simple, 417 smooth,418 trace of, 417 Syntax, 550 Tangent line, 402 Tangent plane, 424 Taylor polynomial, 147 Taylor remainder, 148 Taylor series, 150 Taylor theorem, 152 Telescoping series, 230, 255 Temperature, 20, 97 (Ex. 10, 14) Term: of sequence, 27 of series, 228 Tetrahedron, 97 Texas hat, 164 Tietze extension theorem, 77, 110, 274 Topology, 28, 77 Torus, 430, 509 Trace: of curve, 400 of matrix, 470 of sequence, 37 of surface, 417 Transformation, 23, 328 area altered by, 382, 386 conformal, 413 continuous, 75 differentiable, 345 differential of, 341 distance decreasing, 334 graph of, 23 inverse, 352, 358 linear, 334 Transformation: mean value theorem for, 350 orientation preserving, 412 rank of, 563 Trapezoidal formula, 197, 541, 544 Triangle inequality, 12, 14 Trigonometric functions, 249, 283 Trisection, 285 Unbounded set, 31 Uniform approximation, 86 Uniform continuity, 82 Uniform convergence, 260 Union of sets, 5 Unit vector, 126, 306 Upper bound, 6 Upper limit (lim sup), 44 Vector, 7 analysis, 464 field, 468 identities, 465, 471, 472 normal,422 space, 8, 77, 562 Vector-valued derivative, 130, 343 Vector-valued function, 21, 328 Wallis, J., 304 (Ex. 13-) Wave equation, 514 Weierstrass approximation theorem, 86, 323,583 Weierstrass comparison test, 266, 287 Zero area (volume), 172, 385","libVersion":"0.3.1","langs":""}
{"path":"iCloudDrive/bks/Algebra/Algebra/Generating Functions - MDB.pdf","text":"Mathematical Database Page 1 of 17 GENERATING FUNCTIONS 1. Introduction The concept of generating functions is a powerful tool for solving counting problems. Intuitively put, its general idea is as follows. In counting problems, we are often interested in counting the number of objects of ‘size n’, which we denote by na . By varying n, we get different values of na . In this way we get a sequence of real numbers 0a , 1a , 2a , … from which we can define a power series (which in some sense can be regarded as an ‘infinite- degree polynomial’) 2 01 2()Gx a a x a x= ++ +. The above ()Gx is the generating function for the sequence 0a , 1a , 2a , …. In this set of notes we will look at some elementary applications of generating functions. Before formally introducing the tool, let us look at the following example. Example 1.1. (IMO 2001 HK Preliminary Selection Contest) Find the coefficient of 17x in the expansion of 57 20(1 )xx++ . Solution. The only way to form an 17x term is to gather two 5x and one 7x . Since there are 20 2 190C = ways to choose two 5x from the 20 multiplicands and 18 ways to choose one 7x from the remaining 18 multiplicands, the answer is 190 18 3420×= . To gain a preliminary insight into how generating functions is related to counting, let us describe the above problem in another way. Suppose there are 20 bags, each containing a $5 coin and a $7 coin. If we can use at most one coin from each bag, in how many different ways can we pay $17, assuming that all coins are distinguishable (i.e. the $5 coin from the first bag is considered to be different from that in the second bag, and so on)? It should be quite clear that the answer is again 3420 — to pay $17, one must use two $5 coins and one $7 coin. There are 20 2 190C = ways to choose two $5 coins from the 20 bags, and 18 ways to choose a $7 coin from the remaining 18 bags. Using the notations we introduced at the very beginning, we could say that 17 3420a = . Mathematical Database Page 2 of 17 2. Techniques of Computation Let us once again give the definition of a generating function before we proceed. Definition. Given a sequence 0a , 1a , 2a , …, we define the generating function of the sequence { }na to be the power series 2 01 2()Gx a a x a x= ++ +. Let us look at a few examples. Example 2.1. Find the generating functions for the following sequences. In each case, try to simplify the answer. (a) 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, … (b) 1, 1, 1, 1, 1, … (c) 1, 3, 3, 1, 0, 0, 0, 0, … (d) 2005 0C , 2005 1C , 2005 2C , …, 2005 2005C , 0, 0, 0, 0, … Solution. (a) The generating function is 2345 6 7 23 45 () 1 1 1 1 1 1 0 0 1 Gx x x x x x x x xx x x x =+ + + + + + + + = + ++ ++ We can apply the formula for the sum of a geometric series to rewrite ()Gx as 61 () 1 x Gx x − = − . (b) The generating function is 23 4() 1Gx x x x x= ++ + + + . When | | 1x < , we can apply the formula for the sum to infinity of a geometric series to rewrite ()Gx as 1 () 1 Gx x = − . In working with generating functions, we shall ignore the question of convergence and simply say 1 () 1 Gx x = − . (c) The generating function is 2() 1 3 3 1Gx x x=+ + + , and of course, the binomial theorem enables us to simplify the answer as 3() (1 )Gx x=+ . Mathematical Database Page 3 of 17 (d) The generating function is 2005 2005 2005 2 2005 2004 2005 2005 0 1 2 2004 2005()Gx C C x C x C x C x=+ + + + + , and the binomial theorem once again enables us to simplify the answer as 2005() (1 )Gx x=+ . When dealing with computations of generating functions, we are particularly interested with two things, namely, whether the generating function can be written in closed form and whether we can find the coefficient of a certain power of x easily. To write a generating function in ‘closed form’ means, in general, writing it in a ‘direct’ form without summation sign nor ‘ ’. For instance, in Example 2.1 (b), 234() 1Gx x x x x= + ++ ++ is not in closed form while 1 () 1 Gx x = − is. The reason for trying to put a generating function in closed form is as follows. In the more advanced theory of generating functions (beyond the level of this set of notes), we will find that certain combinations of problems correspond to certain operations (e.g. addition, multiplication or more complicated operations) on generating functions. If we can find a generating function in closed form, the computations can be greatly simplified and easily carried out. On the other hand, we are interested in knowing the coefficient of a certain power of x because, as we have remarked at the very beginning, it often refers to the number of objects of size n, which is usually the thing we wish to find in counting problems. Clearly, if a generating function is given in ‘explicit form’, such as 23 4() 2 3 4Gx x x x x= ++ ++ or 0 1 () 21 n n n Gx x n ∞ = − = +∑ , then finding a specific coefficient will be easy. However, if a generating function is given in closed form, ingenious tricks are sometimes required in determining certain coefficients. The following example illustrates some common tricks. Example 2.2. In each of the following, find the coefficient of 2005x in the generating function ()Gx . (a) 5000() (1 2 )Gx x=− (b) 1 () 13 Gx x = + (c) 2 1 () (1 5 ) Gx x = + Solution. Mathematical Database Page 4 of 17 (a) By the binomial theorem, we have 5000 5000 2 5000 4999 5000 1 2 4999( ) 1 (2 ) (2 ) (2 ) (2 )G x Cx Cx Cx x=− + − − + . From this, we see that the coefficient of 2005x is 2005 5000 20052 C− . (b) Recalling the formula for the sum to infinity of a geometric series, we have (noting once again that everything is dealt with formally, ignoring questions of convergence) 23 2 2 3 31 ( ) 1 ( 3) ( 3 ) ( 3) 1 3 3 3 1( 3 ) Gx x x x x x x x = = +− +− +− + = − + − + −− . From this, we see that the coefficient of 2005x is 20053− . (c) As in (b), we know that 22 3 31 15 5 5 15 xx x x = −+ − + + . Hence 22 3 3 22 3 3( ) (1 5 5 5 )(1 5 5 5 )Gx x x x x x x= − +− + − +− + . To form an 2005x term, we can multiply 1 with 2005 20055 x− , 5x− with 2004 20045 x , 225 x with 2003 20035 x− and so on, and finally 2005 20055 x− with 1. There are altogether 2006 products, each equal to 2005 20055 x− . It follows that the coefficient of 2005x is 20052006 5−× . The technique used in Example 2.2 (c) is rather ‘ad-hoc’ in nature. It will not work if the power 2 is increased to higher powers. (At least it will involve much more analysis.) To deal with higher powers, we shall need an extended version of the binomial theorem. In fact, the generating function in Example 2.2 (b) and (c) can be written as 1() (1 3 )Gx x −=+ and 2() (1 5 )Gx x −=+ respectively. If we can expand them using more or less the same method as in Example 2.2 (a), then the computation will be much simpler. For this purpose, we attempt to generalize the binomial theorem for positive integral indices. We begin by extending the usual notion of binomial coefficients to non-integer values. Definition. For any real number u and positive integer k, we define the extended binomial coefficient u kC by (1)( 2) ( 1) ! u k uu u u k C k − −− + = . We also define 0 1 uC = for any real number u. Mathematical Database Page 5 of 17 Clearly, if u is a positive integer with uk≥ , then the above extended binomial coefficient agrees with the usual binomial coefficient. Also, if u and k are positive integers with uk< , then we have 0 u kC = . This is natural from a combinatorial point of view: if uk< , there is no way to choose k different objects from a collection of u objects. With the notion of the extended binomial coefficients, we can state the extended binomial theorem as follows. Theorem (Extended Binomial Theorem). For any real number u, we have 2 01 2(1 )uu u ux C Cx Cx+= + + + . Again, if u is a positive integer, we see that the extended binomial theorem agrees with the usual binomial theorem by noting that 0 u kC = when uk< . Now if we go back to Example 2.2 (c), we see at once, with the extended binomial theorem, that the answer is 2005 2 20055 C −× . Note that we have 2 2005 ( 2) ( 3) ( 4) ( 2005) ( 2006) 2006! 2006 2005! 2005! C − −× − × −× × − × − − == = − , so that the answer agrees with what we obtained in Example 2.2 (c). Since we often have to compute extended binomial coefficients of the form u kC where u is a negative integer, it is useful to relate the extended binomial coefficients with the usual binomial coefficients. We have the following. Theorem. For positive integers n and r, we have 1(1) nr n r rrCC − +−=− . Hence we have 2 2005 2 2005 1 2006 2005 2005 2005( 1) 2006CC C −+ −= − =− =− , as we have previously worked out. It should be noted that the right hand side of the above formula is in fact ( 1)rn rH− . Mathematical Database Page 6 of 17 With the extended binomial theorem, computation of coefficients for generating functions like 5 1 (1 )x+ and 1 x+ becomes easy. Sometimes we also need the technique of partial fraction decomposition in the computation, as the following example shows. Example 2.3. What is the coefficient of 2005x in the generating function 22 1 () (1 ) (1 ) Gx x x = −+ ? Solution. Let 22 2 2 1 (1 ) (1) 1 (1 ) 1 (1) AB C D x xx x x x =+ + + −+ − − + + . Upon simplification, the right hand side becomes 32 22 () ( ) ( 2 2 ) ( ) (1 ) (1 ) CA x B D A C x A B C D x A B C D xx −+ + − − + + − − + + + + −+ . Comparing coefficients, we have 0 0 22 0 1 CA BD A C AB C D AB C D − =  + −− =  + −− = + ++ = . Solving, we get 1 4 AB C D== = =. It follows that 12 1 21 ( ) (1 ) (1 ) (1 ) (1 ) 4 Gx x x x x −− − −= − +− ++ ++. Thus the coefficient of 2005x is 12 1 2 2005 2005 2005 2005 1 () 0 4 C CCC −− − −−− + + = . Finally, for those who know calculus, the following two examples illustrate some further computation techniques in dealing with generating functions. Example 2.4. Find the generating functions of the following sequences in closed form. (a) 1, 2, 3, 4, 5, 6, 7 (b) 0, 1, 1 2 − , 1 3 , 1 4 − , … Mathematical Database Page 7 of 17 Solution. Formally, we can differentiate and integrate a power series term by term. In other words, if 23 01 2 3()Gx a a x a x a x=+ + + +, then 2 12 3'( ) 2 3Gx a a x a x= ++ + . The same is true for integration in place of differentiation. (a) The generating function is 23 234 2 () 1 2 3 4 () 1 1 (1 ) Gx x x x d xx x x dx dx dx x x =+ + + + =+ + + +  =  − = − We can verify the answer by expanding 2 1 (1 )x− using the extended binomial theorem. (b) The generating function is 23 4 23 11 1 () 23 4 (1 ) 1 ln(1 ) Gx x x x x x xx dx dx x xC = −+ −+ =− + − + = + =+ + ∫ ∫ To find the constant C, we put in 0x = to get (0)CG= . If we write 2 01 2()Gx a a x a x= ++ +, then (0)G is simply equal to 0a , which is 0 in this case. Hence the answer is () ln(1 )Gx x= + . Example 2.5. Find the coefficient of 2005x for each of the following generating functions. (a) ( ) ln(1 )Gx x=− (b) ( ) sinGx x= Mathematical Database Page 8 of 17 Solution. (a) We have 23 23 4 1 () 1 (1 ) 11 1 23 4 Gx dx x x xx dx Cx x x x  =− − =− − − − − = − −− −− ∫ ∫ where (0) 0CG==. From the above expression, we see that the coefficient of 2005x is 1 2005 − . (b) Let 2 01 2sin ( )xG x a a x a x== + + +. Setting 0x = , we have 00 a= . Differentiating both sides of ( )Gx with respect to x, we have 2 12 3cos 2 3xa a x a x= ++ + . Setting 0x = again, we have 11 a= . Differentiating the above equality with respect to x, we have 2 23 4sin 2 1 3 2 4 3xa a x a x−= ⋅ ⋅ + ⋅ ⋅ + ⋅ ⋅ + . Again, setting 0x = gives 202a= . Continuing this process, we see that 3 4 5 6 7 8 13! 04! 15! 06! 17! 08! a a a a a a − = = = = −= = Since 2005 1≡ (mod 4), the coefficient of 2005x is 1 2005! . For those who know about Taylor series, it should be noted that exactly the same idea is employed in part (b) above. In fact, given a generating function ()Gx in closed form, the coefficient of nx is given by ()1 (0) ! n naG n . Mathematical Database Page 9 of 17 3. Applications of Generating Functions A. Basic Counting Problems Some well-known results in combinatorics can be reproduced by means of generating functions, as the following examples show. Example 3.1. There are 50 students in the International Mathematical Olympiad (IMO) training programme. 6 of them are to be selected to represent Hong Kong in the IMO. How many ways are there to select 6 students? Solution. Each student is either selected or not selected. Hence each student contributes a factor of 1 x+ to the generating function, where the term 1 (i.e. 0x ) refers to the case when the student is not selected (i.e. the student occupies 0 place) while the term x (i.e. 1x ) refers to the case when the student is selected (i.e. the student occupies 1 place). Since there are 50 students, the generating function is 50() (1 )Gx x=+ . Since 6 students are to be selected, the answer is the coefficient of 6x in ()Gx , which, according to the binomial theorem, is 50 6C . This, of course, agreed with what we would have obtained without using generating functions. It is worth noting how the generating function is formed. Basically, it is formed by a sequence of ‘+’s and ‘×’s, corresponding to a sequence of ‘OR’s and ‘AND’s, very much like how counting problems are typically formulated. For each student, he is either selected OR not selected, so each student contributes a factor of 1 x+ . Now we need to do the same for the 1st student AND the 2nd student AND the 3rd student AND so on. That’s why we multiply 50 copies of 1 x+ together to form the generating function. Example 3.2. There are 30 identical souvenirs, to be distributed among the 50 IMO trainees, and each trainee may get more than one souvenir. How many ways are there to distribute the 30 souvenirs among the 50 trainees? Solution. Mathematical Database Page 10 of 17 Each student may get 0 OR 1 OR 2 OR … souvenirs, thus contributing a factor of 21 xx++ +. Since there are 50 students, the generating function is 50 250 501 () (1 ) (1 ) 1 Gx x x x x − =+ + + = = − − . As there are 30 souvenirs, the answer is the coefficient of 30x in ( )Gx , which, according to the extended binomial theorem, is equal to 50 79 30 30CC − = . Of course, we note that this is indeed 50 30H . One may argue that the term 21 xx++ + should be replaced by 2301 x xx++ + + in the above generating function because each student may get at most 30 souvenirs. It turns out that this modification will not affect the final outcome, and the details are left as an exercise. In view of this, we will simply use 21 xx++ + most of the time because it is easier to handle. B. More Complicated Counting Problems Using the same idea employed in the previous examples, we can solve more complicated counting problems using generating functions, as can be seen in the following examples. Example 3.3. How many integer solutions to the equation 6abc+ += satisfy 12a− ≤≤ and 1, 4bc≤≤ ? Solution. Since 12a−≤ ≤ , the variable a contributes a term 10 1 2x xx x − + ++ to the generating function. Similarly, each of b and c contributes a term 12 3 4x xx x+ ++ . Hence the generating function is 10 1 2 1 2 3 4 2 23 3 34 48 12 3 59 13 3 () ( )( ) (1 ) 1 1 (1 3 3 )(1 ) (3 3 )(1 ) G x x x xx xx x x xx x x x x x xx x x x xx x x x − − − =+ + + + + + =+ + + − =  − =− + − − =− + − − The answer is the coefficient of 6x in ()Gx . To get an 6x term, we can multiply x with the 5x term in 3(1 )x −− , as well as multiply 53x− with the x term in 3(1 )x −− . By the extended binomial theorem, the coefficient of 5x and x in 3(1 )x −− are 3 5C −− and 3 1C −− respectively. Hence the answer is 33 7 3 51 5 13( ) 3 12CC C C −−−− − = − = . Mathematical Database Page 11 of 17 The reader may try to make a comparison by solving the above problem using traditional ways without the help of generating functions. Example 3.4. In a country there are coins of denominations $2, $3, $5 and $7. How many different ways are there to pay exactly $10? Solution. The $2 coins may contribute a sum of $0, $2, $4, …, thus leading to the factor 241 xx+++. Using the same idea for the $3, $5 and $7 coins, the generating function is given by 24 3 6 5 10 7 14 23 5 7 ( ) (1 )(1 )(1 )(1 ) 11 1 1 11 1 1 Gx x x x x x x x x x xx x = + ++ + + + + + + ++ + =⋅ ⋅ ⋅ −− − − The answer is the coefficient of 10x in ( )Gx . This is hard to compute by hand (it would be easier to count the number of ways directly), but this can easily be done with the help of suitable computer software (by contrast, the computer will not be able to count the number of ways directly). Example 3.5. In the USA, there are coins of denominations 1, 5, 10, 25, 50 cents and $1. In how many different ways can we make up $1 (i.e. 100 cents) from these coins? Solution. Similar to the previous example, the generating function is 510 25 50 100 1 () (1 )(1 )(1 )(1 )(1 )(1 ) Gx xx x x x x = −− − − − − . The answer is the coefficient of 100x in ( )Gx . At first glance it may seem hopelessly complicated to compute this by hand, but if we take a second look, we see that the powers of x in all but one parentheses are divisible by 5. In view of this, we replace 1 1 x− by 234 5 1 1 x xx x x + ++ + − so that the generating function becomes 23 4 5 2 10 25 50 100 1 () (1 ) (1 ) (1 )(1 )(1 )(1 ) Gx x x x x xx x x x   =+ + + +  −− − − −  . Now all powers of x in the second factor are divisible by 5, so the only way to form an 100x term is to multiply the term 1 in the first factor with an 100x term in the second factor. Setting 5yx= , we therefore have to compute the coefficient of 20y in the expansion of Mathematical Database Page 12 of 17 22 5 10 20 1 (1 ) (1 )(1 )(1 )(1 )yy y y y−− − − − . In the denominator, all powers of y are divisors of 20. Using the same technique as we replaced 1 1 x− by 234 5 1 1 x xx x x ++ + + − , the above expression can be rewritten as 19 2 2 4 18 5 10 15 10 20 6 (1 ) (1 )(1 )(1 ) (1 ) yy y y y y y y y y ++ + + + + + + + + + − . Finally, to extract the coefficient of 20y , we note that 20 6 20(1 ) 1 6yy −− =+ + (here 6 16 C −=− ) and so we need only find the coefficient of 20y and the constant term in the numerator. The constant term is clearly 1. The coefficient of 20y is, unfortunately, complicated to compute. Nevertheless one can consider the last two factors first and deal with the terms case by case. For instance, if the term 5y is taken in the second last factor while the term 10y is taken in the last factor, there are 12 ways to get 5y from the first 3 factors ( 050+ + , 14 0+ + , 23 0+ + , 32 0+ + , 41 0++ , 50 0+ + , 032++ , 12 2++ , 21 2++ , 30 2++ , 01 4+ + and 10 4+ + ). We shall omit the remaining details, but anyway it can be found that the coefficient of 20y in the numerator is 287. It follows that the answer is 287 6 293+= . C. Solving Recurrence Relations Given a recurrence relation, one of the common ways to solve for the general term of a sequence is to use the method of characteristic equations. Here we will see how generating functions may be employed as an alternative way in solving recurrence relations. For each sequence, we can form a generating function which may be regarded as an ‘infinite polynomial’. If a recurrence relation is given, we can possibly reduce this ‘infinite polynomial’ to a finite one, so that we can get the generating function in closed form. Consequently the coefficient of a general term (i.e. the general term of the sequence) can be found. The idea is more or less the same as that employed in deriving the sum of a geometric series. Example 3.6. Using generating functions, find na in terms of n in each of the following cases. (a) 0 2a = and 1 3nnaa+ = for 0n ≥ (b) 0 1a = , 1 2a = and 2154nn naa a++=− for 0n ≥ Mathematical Database Page 13 of 17 Solution. In each case, we let ( )Gx be the generating function for the given sequence { }na . (a) We have 2 01 2 2 01 2 01 0 2 1 () (1) (1) 3 : 3 ( ) 3 3 (2) (1) (2) : (1 3 ) ( ) ( 3 ) ( 3 ) Gx a a x a x xxG x a x a x xG x a a a x a a x =+ + + ×= + + −− = + − + − + Since 0 2a = and 1 3nnaa+ = for 0n ≥ , we have (1 3 ) ( ) 2xG x− = , i.e. 23 2 () 13 21 (3 ) (3 ) (3 ) Gx x xx x = −  =+ + + +  In this way, we see that the coefficient of nx in ( )Gx is 23 n⋅ , so that 23 n na =⋅ for all n, as we would expect since { }na is in fact a geometric sequence with first term 2 and common ratio 3. (b) Similar to (a), we have 23 01 2 3 23 01 2 22 2 01 () 5( ) 5 5 5 4( ) 4 4 Gx a a x a x a x xG x a x a x a x xG x a x a x = ++ ++ −= − − − − = ++ + Adding these three equations, and using the initial conditions as well as the given recurrence relation, we get 2(1 5 4 ) ( ) 1 3x xG x x− += − . Applying partial fraction decomposition, we have 2 23 2 3 13 () 15 4 21 1 1 31 3 1 4 21 11 (4 ) (4 ) (4 ) 33 x Gx xx xx xx x x x x − = −+    =+   −−     =+ + + + + + + + +   Thus the coefficient of nx in ( )Gx is 21 4 33 n+ ⋅ , so that 42 3 n na + = . Mathematical Database Page 14 of 17 4. Further Examples In this section we shall look at a couple of problems from mathematical olympiads in which generating functions serve as a powerful tool. Example 4.1. (CGMO 2004) A set of poker has 32 cards. 30 of them are in red, yellow and blue, with 10 cards in each colour, given the numbers 1, 2, …, 10 respectively. 2 of them are different jokers, both with the number 0. A card with the number k counts for 2k points. Call a group of cards a ‘good group’ if the sum of their points is 2004. Calculate the number of ‘good groups’. Solution. The generating function is given by 2 2 3 4 3 1024 3 32 2 2 4 1024 23 22048 3 23 2 2048 4096 6144 2 3 2 2048 2049 2 3 ( ) (1 ) (1 ) (1 ) (1 ) (1 ) (1 )(1 )(1 ) (1 ) (1 ) (1 ) (1 ) (1 ) (1 2 )(1 3 3 )(1 ) (1 2 3 6 )(1 ) Gx x x x x x xxx x x xx x xx x x x x xx x x x − − =+ + + + +− + + += − +− = − =+ + − + − − =+ + − − − − The answer is the coefficient of 2004x in ( )Gx . Note that in the expansion of 23(1 )x −− , there are only even powers of x. To form an 2004x term, one can multiply the 1 in the first factor with the 2004x term in 23(1 )x −− , as well as multiply the 2x term in the first factor with the 2002x term in 23(1 )x −− . By the extended binomial theorem, the coefficients of 2004x and 2002x in 23(1 )x −− are 3 1002C − and 3 1001C −− respectively. It follows that the answer is 3 3 1004 1003 1004 1003 1002 1001 1002 1001 2 2 1006009C C CC CC −−− = +=+= . Example 4.2. (IMO 1995) Let p be an odd prime number. Find the number of subsets A of the set {1, 2, …, 2p} such that (i) A has exactly p elements, and (ii) the sum of all the elements in A is divisible by p. Mathematical Database Page 15 of 17 Solution. Since we need to count two things, namely, the number of elements of A as well as the sum of the elements of A, we form a bivariate generating function 22(, ) ( )( ) ( ) pGt x t x t x t x=+ + + where the power of t counts the number of elements of A and the power of x counts the sum of the elements of A. Let (, )ak m denote the coefficient of kmtx . Then the problem asks for nothing but the sum (, 0) (, ) ( , 2 )ap app a p p+ ++ . Let E denote the set of p-th roots of unity, i.e. 21{1, , , , } pE ωω ω −= … , where 2 i pe π ω = . We shall compute the sum (, ) tE x E SG t x ∈∈ =∑∑ by two different methods. We shall give the outline below and the details are left as an exercise. Method 1 (1) Establish the fact that if | or 1 0otherwise n zE p pn z z ∈ = = ∑ . (2) Replace ( , )Gt x by , (, ) km km ak m t x∑ in S. (3) Show that 2 | | (, ) pm pk Sp a k m= ∑ by first summing x and then t. Method 2 (1) Replace ( , )Gt x by 22()( ) ( ) ptx tx tx++ + in S. (2) First fix t and sum x, treating the cases 1x = and 1x ≠ separately. (3) Then sum t to show that () 21 42 p pSC p p =+ − . Now we can equate the results of the two methods to get () 2 | | 1 (, ) 4 2 p p pm pk ak m C p p = +−∑ . Bearing in mind that (0, 0) 1a = and 2(2 , 2 ) 1app p− = (i.e. coefficients corresponding to the empty set and the whole set of 2p integers respectively) are included in the left-hand summation but are not wanted in our final answer, we subtract 2 from the right hand side to get the answer () 21 22 p pCp p + − . Mathematical Database Page 16 of 17 5. Exercises 1. Find the generating functions of the following sequences in closed form. (a) 1, 0, 1, 0, 1, 0, … (b) 2, –4, 6, –8, 10, –12, … (c) 0 2C , 1 2C , 2 2C , 3 2C , 4 2C , 5 2C , … 2. Find the coefficient of 2005x in each of the following generating functions. (a) 2006(1 2 )x− (b) 4 1 13x   + (c) 2 1 25 2xx++ (d) [ ]ln 2(1 )x+ 3. Using generating functions, find na in terms of n in each of the following cases. (a) 0 2a = and 1 31nnaa+ = + for 0n ≥ (a) 0 1a = , 1 2a = and 2143nn naa a++=− for 0n ≥ (a) 01 1aa== and 21nn naa a++=+ for 0n ≥ 4. Find the number of solutions to the equation 50abc d+ ++ = if each variable is (a) a non-negative integer (b) a positive integer (c) an odd positive integer (d) an integer between 4 and 10 (inclusive) 5. Prove the formula 1(1) nr n r rrCC − +−=− for positive integers n and r. 6. Solve Example 3.3 without using generating functions and compare the two methods. Mathematical Database Page 17 of 17 7. Complete Example 3.5 by filling in the missing details in the last paragraph of the solution. 8. Complete the solution to Example 4.2 by following the steps outlined. 9. There are 10000 identical red balls, 10000 identical yellow balls and 10000 identical green balls. In how many different ways can we select 2005 balls so that the number of red balls is even or the number of yellow balls is odd? 10. Amy and Betty each picks n different positive integers, and Amy’s numbers are not all the same as Betty’s numbers. For each set of n numbers, there are 2 nH ways to add up two of them (adding a number with itself is allowed) and hence 2 nH sums can be obtained (some of them may be repeated). It turns out that the 2 nH sums obtained by each of Amy and Betty are exactly the same (same sums to the same multiplicities). Show that n is a power of 2. 11. For positive integer 1n > , let nC be the number of ways of dissecting a regular ( 2n + )-sided polygon into triangles by 1n − diagonals which do not intersect inside the polygon. For convenience we also define 01 1CC==. (a) Compute 2C , 3C and 4C . (b) Show that for 1n > , nC satisfies the recurrence relation 01 1 2 2 1 1 0nn n n nCC C C C C C C C−− − −=+ + + + . (c) Show that the generating function for the sequence { }nC is given by 11 4 () 2 x Gx x −− = . (d) Show that 21 1 n nnCC n = + . Remark. The numbers nC are known as Catalan numbers. In Richard Stanley’s book Enumerative Combinatorics, he listed 66 different combinatorial interpretations of the Catalan numbers!","libVersion":"0.3.1","langs":""}
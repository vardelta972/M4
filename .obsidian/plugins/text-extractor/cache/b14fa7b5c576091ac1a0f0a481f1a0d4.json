{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Number Theory - Dana Paquin Ph.D - EPGY.pdf","text":"Stanford University Educational Program for Gifted Youth (EPGY) Number Theory Dana Paquin, Ph.D. paquin@math.stanford.edu Summer 2010 Stanford University EPGY Number Theory Note: These lecture notes are adapted from the following sources: 1. Ivan Niven, Herbert S. Zuckerman, and Hugh L. Montgomery, An Introduction to Number Theory, Fifth Edition, John Wiley & Sons, Inc., 1991. 2. Joseph H. Silverman, A Friendly Introduction to Number Theory, Third Edition, Prentice Hall, 2006. 3. Harold M. Stark, An Introduction to Number Theory, The MIT Press, 1987. 1 Contents 1 The Four Numbers Game 5 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 2 Elementary Properties of Divisibility 9 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11 3 Proof by Contradiction 13 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16 4 Mathematical Induction 17 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22 5 The Greatest Common Divisor (GCD) 24 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29 6 Prime Factorization and the Fundamental Theorem of Arithmetic 31 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37 7 Introduction to Congruences and Modular Arithmetic 39 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44 8 Applications of Congruences and Modular Arithmetic 46 Problem Set 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50 Problem Set 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54 9 Linear Congruence Equations 56 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64 10 Fermat’s Little Theorem 66 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72 11 Euler’s Phi-Function and The Euler-Fermat Theorem 74 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79 2 Stanford University EPGY Number Theory 12 Primitive Roots 82 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89 13 Squares Modulo p and Quadratic Residues 92 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99 14 Introduction to Quadratic Reciprocity 102 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107 15 The Law of Quadratic Reciprocity 110 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113 16 Diophantine Equations 115 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118 17 Fibonacci Numbers and Linear Recurrences 120 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125 Fibonacci Nim . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128 Unsolved Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129 18 Mersenne Primes and Perfect Numbers 131 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136 19 Powers Modulo m and Successive Squaring 138 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 140 20 Computing k-th Roots Modulo m 141 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144 21 RSA Public Key Cryptography 145 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 150 22 Pythagorean Triples 151 23 Which Primes are Sums of Two Squares? 153 24 Lagrange’s Theorem 157 25 Continued Fractions 159 26 Geometric Numbers 164 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 166 27 Square-Triangular Numbers and Pell’s Equation 170 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 179 3 Stanford University EPGY Number Theory 28 Pick’s Theorem 182 Problem Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 185 29 Farey Sequences and Ford Circles 193 Problem Set. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 200 30 The Card Game SET 202 31 Magic Squares 207 32 Mathematical Games 212 33 The 5 Card Trick of Fitch Cheney 215 34 Conway’s Rational Tangles 217 35 Invariants and Monovariants 219 Problem Set. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 221 36 Number Theory Problems from AMC, AHSME, AIME, USAMO, and IMO Mathematics Contests 223 37 Challenge Contest Problems 228 4 Chapter 1 The Four Numbers Game Choose 4 numbers and place them at the corners of a square. At the midpoint of each edge, write the diﬀerence of the two adjacent numbers, subtracting the smaller one from the larger. This produces a new list of 4 numbers, written on a smaller square. Now repeat this process. The game ends if/when a square with 0 at every vertex is achieved. Here’s an example starting with the four numbers 1,5,3,2. We’ll call this the (1, 5, 3, 2) game; note that the ﬁrst number (1) is placed in the upper left-hand corner. The (1, 5, 3, 2) game ends after 7 steps. We’ll call this the length of the (1, 5, 3, 2) game. We’ll be interested in determining whether or not all games must end in ﬁnitely many steps. Once it’s clear how the game works, it’s easier if we display the game more compactly as follows: 1 5 3 2 4 2 1 1 2 1 0 3 1 1 3 1 0 2 2 0 2 0 2 0 2 2 2 2 0 0 0 0 5 Stanford University EPGY Number Theory Example 1.1 1. Find the length of the (1, 3, 8, 17) game. 2. Find the length of the (1, 2, 2, 5) game. 3. Find the length of the (0, 1, 6, π) game. Example 1.2 Is the length of the game aﬀected by rotations and/or reﬂections of the square? 1. Find the length of the (9, 7, 5, 1) game. 2. Find the length of the (7, 5, 1, 9) game. 3. More generally, there are 4 total ways to “rotate” the (9, 7, 5, 1) game. Find the length of each one. 4. Find the length of the (5, 9, 7, 1) game (vertical reﬂection). 5. Find the length of the (1, 7, 5, 9) game (horizontal reﬂection). 6. Find the length of the (9, 1, 5, 7) game (major diagonal reﬂection). 7. Find the length of the (7, 5, 9, 1) game (minor diagonal reﬂection). 8. There are 24 possible ways to arrange the numbers 9,7,5,1 on the vertices of a square–only 8 of them can be achieved by rotation and reﬂection. Find the length of the game for each conﬁguration. Are the lengths all the same? Can you make any observations/conjectures? Example 1.3 What is the greatest length of games using 4 integers between 0 and 9? Example 1.4 Work out a few examples of the Four Numbers Game with rational numbers at the vertices. Does the game always end? Observation 1.1 What happens if you multiply the 4 start numbers by a positive integer m? Is the length of the game changed? Once you’ve made and formally stated a conjecture, can you prove it? Observation 1.2 Find several games with length at least 4. What do you observe about the numbers that appear after Step 4? Theorem 1.1 Every Four Numbers Game played with nonnegative integers has ﬁnite length. More precisely, if we let A denote the largest of the 4 nonnegative integers and if k is the least integer such that A 2k < 1, then the length of the game is at most 4k. 6 Stanford University EPGY Number Theory Problem Set 1. Play the Three Numbers Game shown below using the same rules as the Four Numbers Game, and determine its length. 2. Experiment with examples of the k-Numbers Game for k = 5, 6, 7, 8. For each k, can you ﬁnd examples of k-Numbers Games with ﬁnite length? Inﬁnite length? Do you observe any patterns? 3. How does the length of the (a, b, c, d) game compare to the length of the (ma + e, mb + e, mc + e, md + e) game? 4. Let a, b, c, d be nonnegative real numbers, and suppose that a ≥ c ≥ b ≥ d. What is the maximum length of the Four Numbers Game (a, b, c, d) in this case? 5. Let a, b, c, d be nonnegative real numbers, and suppose that a ≥ b ≥ d ≥ c. What is the maximum length of the Four Numbers Game (a, b, c, d) in this case? 6. Let a, b, c, d be nonnegative real numbers, and suppose that any 2 of the numbers a, b, c, d are equal. What is the maximum length of the Four Numbers Game (a, b, c, d) in this case? 7. The Tribonacci numbers are deﬁned as follows: t0 = 0, t1 = 1, t2 = 1, t3 = 2, t4 = 4, t5 = 7, . . . . In general, tn = tn−3 + tn−2 + tn−1. We’ll deﬁne the n-th Tribonacci game as follows: T1 = (t2, t1, t0, 0) = (1, 1, 0, 0) Tn = (tn, tn−1, tn−2, tn−3) Can you ﬁnd an equation for the length of Tn? Begin this problem by doing some experiments, and try to make a conjecture based on your observations. Then try to prove your conjecture. 8. Can you ﬁnd a Four Numbers Game of length 20? Length 100? More generally, for a given integer N (possibly very large), can you ﬁnd a Four Numbers Game of length N ? 7 Stanford University EPGY Number Theory 9. Numerous mathematical research papers have been written about the Four Numbers Game(and related games). The sequence of numbers that appear in the games are also called Ducci sequences after the Italian mathematician Enrico Ducci. Investigate Ducci sequences and their properties, extensions of the Four Numbers Game, the Four Real Numbers Game, k-Numbers Games, and/or other related topics. For example, if 4 nonnegative integers are picked at random, what’s the probability that the game ends in 8 or fewer steps? 8 Chapter 2 Elementary Properties of Divisibility One of the most fundamental ideas in elementary number theory is the notion of divisibility: Deﬁnition 2.1 If a and b are integers, with a ̸= 0, and if there is an integer c such that ac = b, then we say that a divides b, and we write a | b. If a does not divide b, then we write a ∤ b. For example, 2 | 18, 1 | 42, 3 | (−6), − 7 | 49, 9 ∤ 80, − 6 ∤ 31. Theorem 2.1 Properties of Divisibility 1. If a, b, c, m, n are integers such that c | a and c | b, then c | (am + nb). 2. If x, y, z are integers such that x | y and y | z, then x|z. Proof. Since c | a and c | b, there are integers s, t such that sc = a, tc = b. Thus am + nb = c(sm + tn), so c | (am + bn). Similarly, since x | y and y | z, there are integers u, v with xu = y, yv = z. Hence xuv = z, so x | z. Theorem 2.2 If a | b and a | (b + c), then a | c. Proof. Since a | b, there is an integer s such that as = b. Since a | (b + c), there is an integer t such that at = b + c. Thus, 9 Stanford University EPGY Number Theory at − b = c at − as = c a(t − s) = c. Since t and s are both integers, t − s is also an integer, so a | c. Example 2.1 Find all positive integers n ≥ 1 for which (n + 1) | (n2 + 1). Solution: n2 + 1 = n2 − 1 + 2 = (n − 1)(n + 1) + 2. Thus, if (n + 1) | (n2 + 1), we must have (n + 1) | 2 since (n + 1) | (n − 1)(n + 1). Thus, n + 1 = 1 or n + 1 = 2. Now, n + 1 ̸= 1 since n ≥ 1. We conclude that n + 1 = 2, so the only n such that (n + 1) | (n2 + 1) is n = 1. Example 2.2 If 7 | (3x + 2) prove that 7 | (15x2 − 11x − 14.). Solution: Observe that 15x2 − 11x − 14 = (3x + 2)(5x − 7). We have 7s = (3x + 2) for some integer s, so (15x2 − 11x − 14) = 7s(5x − 7). Thus, 7 | (15x2 − 11x − 14). Theorem 2.3 The Division Algorithm: If a and b are positive integers, then there are unique integers q and r such that a = bq + r, 0 ≤ r < b. We refer to this theorem as an algorithm because we can ﬁnd the quotient q and the remainder r by using ordinary long division to divide a by b. We observe that b | aif and only if r = 0. 10 Stanford University EPGY Number Theory Problem Set 1. List all the divisors of the integer 12. 2. List all the numbers which divide both 24 and 36. Compare your answer with your answer to the previous problem. 3. Show that if d ̸= 0 and d | a, then d | (−a) and −d | a. 4. Show that if a | b and b | a, then a = b or a = −b. 5. Suppose that n is an integer such that 5|(n + 2). Which of the following are divisible by 5? (a) n2 − 4 (b) n2 + 8n + 7 (c) n4 − 1 (d) n2 − 2n 6. Find all integers n ≥ 1 so that n3 −1 is prime. Hint: n3 −1 = (n2 +n+1)(n−1). 7. Show that if ac | bc, then a | b. 8. (a) Prove that the product of three consecutive integers is divisible by 6. (b) Prove that the product of four consecutive integers is divisible by 24. (c) Prove that the product of n consecutive integers is divisible by n!. 9. Find all integers n ≥ 1 so that n4 + 4 is prime. 10. Find all integers n ≥ 1 so that n4 + 4 n is prime. 11. Prove that the square of any integer of the form 5k + 1 is of the same form. 12. Prove that 3 is not a divisor of n2 + 1 for all integers n ≥ 1. 13. A prime triplet is a triple of numbers of the form (p, p + 2, p + 4), for which p, p + 2, and p + 4 are all prime. For example, (3, 5, 7) is a prime triplet. Prove that (3, 5, 7) is the only prime triplet. 14. Prove that if 3 | (a2 + b2), then 3 | a and 3 | b. Hint: If 3 ∤ a and 3 ∤ b, what are the possible remainders upon division by 3? 15. Let n be an integer greater than 1. Prove that if one of the numbers 2 n − 1, 2 n + 1 is prime, then the other is composite. 11 Stanford University EPGY Number Theory 16. Suppose that p is an odd prime and that a b = 1 + 1 2 + 1 3 + · · · + 1 p − 1. Show that p | a. 17. Find, with proof, the unique square which is the product of four consecutive odd numbers. 18. Suppose that a is an integer greater than 1 and that n is a positive integer. Prove that if a n + 1 is prime, then a is even and n is a power of 2. Primes of the form 2 2k + 1 are called Fermat primes. 19. Suppose that a is an integer greater than 1 and that n is a positive integer. Prove that if a n − 1 is prime, then a = 2 and n is a prime. Primes of the form 2 n − 1 are called Mersenne primes. 20. Prove that the product of four consecutive natural numbers is never a perfect square. 21. Can you ﬁnd an integer n > 1 such that the sum 1 + 1 2 + 1 3 + · · · + 1 n is an integer? 22. Show that every integer of the form 4 · 14 k + 1, k ≥ 1 is composite. Hint: show that there is a factor of 3 when k is odd and a factor of 5 when k is even. 23. Show that every integer of the form 521 · 12 k + 1, k ≥ 1 is composite. Hint: show that there is a factor of 13 when k is odd, a factor of 5 when k ≡ 2 mod 4, and a factor of 29 when 4 | k. 24. Show that for all integers a and b, ab(a 2 − b2)(a2 + b2) is divisible by 30. 12 Chapter 3 Proof by Contradiction In a proof by contradiction (or reductio ad absurdum), we assume, along with the hypotheses, the logical negation of the statement that we are trying to prove, and then reach some kind of contradiction. Upon reaching a contradiction, we conclude that the original assumption (i.e. the negation of the statement we are trying to prove) is false, and thus the statement that we are trying to prove must be true. Example 3.1 Show, without using a calculator, that 6 − √35 < 1 10. Solution: Assume that 6 − √35 ≥ 1 10. Then 6 − 1 10 ≥ √35, so 59 ≥ 10 √35. Squaring both sides we obtain 3481 ≥ 3500, which is a contradiction. Thus our original assumption must be false, so we conclude that 6 − √35 < 1 10. Example 3.2 Let a1, a2, . . . , an be an arbitrary permutation of the numbers 1, 2, . . . , n, where n is an odd number. Prove that the product (a1 − 1)(a2 − 2) · · · (an − n) is even. Solution: It is enough to prove that some diﬀerence ak − k is even. Assume that all the diﬀerences ak − k are odd. Clearly S = (a1 − 1) + (a2 − 2) + · · · + (an − n) = 0, 13 Stanford University EPGY Number Theory since the ak’s are a reordering of 1, 2, . . . , n. S is an odd number of summands of odd integers adding to the even integer 0. This is a contradiction, so our initial assumption that all the ak − k are odd is thus false, so one of the terms ak − k is even, and hence the product is even. Example 3.3 Prove that there are no positive integer solutions to the equation x2 − y2 = 1. Solution: Assume that there is a solution (x, y) where x and y are positive integers. Then we can factor the left-hand side of the equation to obtain (x − y)(x + y) = 1. Since x and y are both positive integers, x − y and x + y are integers. Thus, x − y = 1 and x + y = 1 or x − y = −1 and x + y = −1. In the ﬁrst case, we add the two equations to obtain x = 1 and y = 0, which contradicts the assumption that x and y are both positive. In the second case, we add the two equations to obtain x = −1 and y = 0, which is again a contradiction. Thus, there are no positive integer solutions to the equation x2 − y2 = 1. Example 3.4 If a, b, c are odd integers, prove that ax2 + bx + c = 0 does not have a rational number solution. Solution: Suppose p q is a rational solution to the equation. We may assume that p and q have no prime factors in common, so either p and q are both odd, or one is odd and the other even. Now a ( p q )2 + b ( p q ) + c = 0 =⇒ ap2 + bpq + cq2 = 0. If both p and p were odd, then ap2 + bpq + cq2 is also odd and hence ̸= 0. Similarly if one of them is even and the other odd then either ap2 + bpq or bpq + cq2 is even and ap2 + bpq + cq2 is odd. This contradiction proves that the equation cannot have a rational root. Example 3.5 Show that √2 is irrational. Solution: Proof by contradiction. Suppose that √2 is irrational, i.e. √2 = r s , where r and s have no common factors (i.e. the fraction is in lowest terms). Then 2 = r2 s2 , so 2s2 = r2. 14 Stanford University EPGY Number Theory This means that r2 must be even, so r must be even, say r = 2c. Then 2s2 = (2c) 2 = 4c2, so s2 = 2c2, so s is also even. This is a contradiction since r and s have no common factors. Thus, √2 must be irrational. We conclude with two important results. Theorem 3.1 If n is an integer greater than 1, then n can be written as a ﬁnite product of primes. Proof. Proof by contradiction. Assume that the theorem is false. Then there are composite numbers which cannot be represented as a ﬁnite product of primes. Let N be the smallest such number. Since N is the smallest such number, if 1 < n < N , then the theorem is true for n. Let p be a prime divisor of N . Since N is composite, 1 < N p < N, so the theorem is true for N p . Thus, there are primes p1, p2 · · · pk such that N p = p1p2 · · · pk. Thus, N = pp1p2 · · · pk is a ﬁnite product of primes. This is a contradiction, so we conclude that any integer greater than 1 can be written as a ﬁnite product of primes. Theorem 3.2 There are inﬁnitely many prime numbers. Proof. Proof by contradiction. The following beautiful proof is attributed to Euclid. Assume that there are only ﬁnitely many (say, n) prime numbers. Then {p1, p2, . . . , pn} is a list that exhausts all the primes. Consider the number N = p1p2 · · · pn + 1. This is a positive integer, clearly greater than 1. Observe that none of the primes on the list {p1, p2, . . . , pn} divides N , since division by any of these primes leaves a remainder of 1. Since N is larger than any of the primes on this list, it is either a prime or divisible by a prime outside this list. Thus we have shown that the assumption that any ﬁnite list of primes leads to the existence of a prime outside this list, so we have reached a contradiction. This implies that the number of primes is inﬁnite. 15 Stanford University EPGY Number Theory Problem Set 1. The product of 34 integers is equal to 1. Show that their sum cannot be 0. 2. Prove that the sum of two odd squares cannot be a square. 3. Let a1, a2, . . . , a2000 be natural numbers such that 1 a1 + 1 a2 + · · · + 1 a2000 = 1. Prove that at least one of the ak’s is even. Hint: clear the denominators. 4. A palindrome is an integer whose decimal expansion is symmetric, e.g. 1, 2, 11, 121, 15677651 (but not 010, 0110) are palindromes. Prove that there is no positive palindrome which is divisible by 10. 5. Let 0 < α < 1. Prove that √α > α. 6. In △ABC, ∠A > ∠B. Prove that BC > AC. 7. Show that if a is rational and b is irrational, then a + b is irrational. 8. Prove that there is no smallest positive real number. 9. Prove that there are no positive integer solutions to the equation x2 − y2 = 10. 10. Given that a, b, c are odd integers, prove that the equation ax2 + bx + c = 0 cannot have a rational root. 11. Prove that there do not exist positive integers a, b, c and n such that a 2 + b2 + c2 = 2 nabc. 12. Show that the equation b2 + b + 1 = a 2 has no positive integer solutions a, b. 13. Let a, b, c be integers satisfying a 2 + b2 = c2. Show that abc must be even. 16 Chapter 4 Mathematical Induction Mathematical induction is a powerful method for proving statements that are “in- dexed” by the integers. For example, induction can be used to prove the following: • The sum of the interior angles of any n-gon is 180(n − 2) degrees. • The inequality n! > 2 n is true for all integers n ≥ 4. • 7 n − 1 is divisible by 6 for all integers n ≥ 1. Each assertion can be put in the form: P(n) is true for all integers n ≥ n0, where P (n) is a statement involving the integer n, and n0 is the starting point, or base case. For example, for the third assertion, P (n) is the statement 7 n − 1 is divisible by 6, and the base case is n0 = 1. Here’s how induction works: 1. Base case. First, prove that P (n0) is true. 2. Inductive step. Next, show that if P (k) is true, then P (k + 1) must also be true. Observe that these two steps are suﬃcient to prove that P (n) is true for all integers n ≥ n0, as P (n0) is true by step (1), and step (2) then implies that P (n0 + 1) is true, which implies that P (n0 + 2) is true, etc. You can think of induction in the following way. Suppose that you have arranged inﬁnitely many dominos in a line, corresponding to statements P (1), P (2), P (3), . . .. If you make the ﬁrst domino fall, then you can be sure that all of the dominos will fall, provided that whenever one domino falls, it will knock down its neighbor. Knocking the ﬁrst domino down is analogous to establishing the base case. Showing that each falling domino knocks down its neighbor is equivalent to showing that P (n) implies P (n + 1). Example 4.1 Prove that for any integer n ≥ 1, 1 + 2 + 3 + · · · + n = n(n + 1) 2 . 17 Stanford University EPGY Number Theory Example 4.2 Prove that n! > 2 n for all integers n ≥ 4. Solution: P (n) is the statement n! > 2 n. The base case is n0 = 4. (i) Base case. 4! = 24 > 2 4 = 16, so the base case P (4) is true. (ii) Inductive hypothesis. Assume that n! > 2 n. We must use this assumption to prove that (n + 1)! > 2 n+1. The left-hand side of the inductive hypothesis is n!, and the left-hand side of the statement that we want to prove is (n + 1)! = (n + 1)n!. Thus, it seems natural to multiply both sides of the inductive hypothesis by (n + 1). n! > 2 n (n + 1)n! > (n + 1)2 n (n + 1)! > (n + 1)2 n. Finally, note that (n + 1) > 2, so (n + 1)! > (n + 1)2 n > 2 · 2 n > 2 n+1, so we conclude that (n + 1)! > 2 n+1, as needed. Thus, n! > 2 n for all integers n ≥ 4. Example 4.3 Prove that the expression 3 3n+3 − 26n − 27 is a multiple of 169 for all natural numbers n. Solution: P (n) is the assertion 3 3n+3 − 26n − 27 is a multiple of 169, and the base case is n0 = 1. (i) Base case. Observe that 3 3(1)+3 − 26(1) − 27 = 676 = 4(169) so P (1) is true. (ii) Inductive hypothesis. Assume that P (n) is true, i.e. that is, that there is an integer M such that 3 3n+3 − 26n − 27 = 169M. We must prove that there is an integer K so that 3 3(n+1)+3 − 26(n + 1) − 27 = 169K. We have: 18 Stanford University EPGY Number Theory 3 3(n+1)+3 − 26(n + 1) − 27 = 3 3n+3+3 − 26n − 26 − 27 = 27(3 3n+3) − 26n − 27 − 26 = 27(3 3n+3) − 26n − 26(26n) + 26(26n) −27 − 26(27) + 26(27) − 26 = 27(3 3n+3) − 27(26n) − 27(27) + 26(26n) + 26(27) − 26 = 27(3 3n+3 − 26n − 27) + 676n + 676 = 27(169M ) + 169 · 4n + 169 · 4 = 169(27M + 4n + 4). Thus, 3 3n+3 − 26n − 27 is a multiple of 169 for all natural numbers n. Example 4.4 Prove that if k is odd, then 2 n+2 divides k2n − 1 for all natural numbers n. Solution: Let k be odd. P (n) is the statement that 2 n+2 is a divisor of k2n − 1, and the base case is n0 = 1. (i) Base case. k2 − 1 = (k − 1)(k + 1) is divisible by 2 1+2 = 8 for any odd natural number k since k − 1 and k + 1 are consecutive even integers. (ii) Inductive hypothesis. Assume that 2 n+2 is a divisor of k2n − 1. Then there is an integer a such that 2 n+2a = k2n − 1. Then k2n+1 − 1 = (k2n − 1)(k2n + 1) = 2 n+2a(k2n + 1). Since k is odd, k2n + 1 is even and so k2n + 1 = 2b for some integer b. This gives k2n+1 − 1 = 2 n+2a(k2n + 1) = 2 n+3ab, and so the assertion follows by induction. Example 4.5 The Fibonacci Numbers are given by F0 = 0, F1 = 1, Fn+1 = Fn + Fn−1, n ≥ 1, i.e. every number after the second one is the sum of the preceding two. The ﬁrst several terms of the Fibonacci sequence are 0, 1, 1, 2, 3, 5, 8, 13, 21, . . . . 19 Stanford University EPGY Number Theory Prove that for all integers n ≥ 1, Fn−1Fn+1 = F 2 n + (−1) n+1. Solution: P (n) is the statement that Fn−1Fn+1 = F 2 n + (−1) n and the base case is n0 = 1. (i) Base case. If n = 1, then 0 = F0F2 = 1 2 + (−1) 1. (ii) Inductive hypothesis. Assume that Fn−1Fn+1 = F 2 n + (−1) n. Then, using the fact that Fn+2 = Fn + Fn+1, we have FnFn+2 = Fn(Fn + Fn+1) = F 2 n + FnFn+1 = Fn−1Fn+1 − (−1) n + FnFn+1 = Fn+1(Fn−1 + Fn) + (−1) n+1 = F 2 n+1 + (−1) n+1, which establishes the assertion by induction. Example 4.6 Prove that n5 5 + n4 2 + n3 3 − n 30 is an integer for all integers n ≥ 0. Solution: P (n) is the statement that n5 5 + n4 2 + n3 3 − n 30 is an integer and the base case is n0 = 0. (i) Base case. Since 0 is an integer, the statement is clearly true when n = 0. (ii) Inductive hypothesis. Assume that n5 5 + n4 2 + n3 3 − n 30 is an integer. We must show that (n + 1)5 5 + (n + 1)4 2 + (n + 1)3 3 − n + 1 30 20 Stanford University EPGY Number Theory is also an integer. We have: (n + 1)5 5 + (n + 1)4 2 + (n + 1)3 3 − n + 1 30 = n5 + 5n4 + 10n3 + 10n2 + 5n + 1 5 + n4 + 4n3 + 6n2 + 4n + 1 2 + n3 + 3n2 + 3n + 1 3 − n + 1 30 = [n5 5 + n4 2 + n3 3 − n 30 ] + [ n4 + 2n3 + 2n2 + n + 2n3 + 3n2 + 2n + n2 + n + 1 ] , which is an integer by the inductive hypothesis and since the second grouping is a sum of integers. 21 Stanford University EPGY Number Theory Problem Set 1. Prove that for any integer n ≥ 1, 2 0 + 2 1 + · · · + 2 n−1 = 2 n − 1. 2. Prove that for any integer n ≥ 1, n2 is the sum of the ﬁrst n odd integers. (For example, 3 2 = 1 + 3 + 5.) 3. Prove that n5 − 5n3 + 4n is divisible by 120 for all integers n ≥ 1. 4. Prove that n9 − 6n7 + 9n5 − 4n3 is divisible by 8640 for all integers n ≥ 1. 5. Prove that n2 | ((n + 1)n − 1) for all integers n ≥ 1. 6. Show that (x − y) | (xn − yn) for all integers n ≥ 1. 7. Use the result of the previous problem to show that 8767 2345 − 8101 2345 is divisible by 666. 8. Show that 2903 n − 803 n − 464 n + 261 n is divisible by 1897 for all integers n ≥ 1. 9. Prove that if n is an even natural number, then the number 13 n + 6 is divisible by 7. 10. Prove that n! ≥ 3 n for all integers n ≥ 7. 11. Prove that 2 n ≥ n2 for all integers n ≥ 4. 12. Prove that for every integer n ≥ 2, n3 − n is a multiple of 6. 13. Consider the sequence deﬁned by a1 = 1 and an = √2an−1. Prove that an < 2 for all integers n ≥ 1. 14. Prove that the equation x2 + y2 = zn has a solution in positive integers x, y, z for all integers n ≥ 1. 15. Prove that n3 + (n + 1)3 + (n + 2)3 is divisible by 9 for all integers n ≥ 1. 22 Stanford University EPGY Number Theory 16. Prove that 1 n + 1 + 1 n + 2 + · · · + 1 3n + 1 > 1 for all integers n ≥ 1. 17. Prove that 4 n n + 1 ≤ (2n)! (n!)2 for all integers n ≥ 1. 18. Show that 7 n − 1 is divisible by 6 for all integers n ≥ 0. 19. Consider the Fibonacci sequence {Fn} deﬁned by F0 = 0, F1 = 1, Fn+1 = Fn + Fn−1, n ≥ 1. Prove that each of the following statements is true for all integers n ≥ 1. (a) F1 + F3 + F5 + · · · + F2n−1 = F2n (b) f2 + F4 + F6 + · · · + F2n = F2n+1 − 1 (c) Fn < 2 n (d) Fn = 1 √5 [(1 + √5 2 )n − (1 + √5 2 )n] 23 Chapter 5 The Greatest Common Divisor (GCD) Deﬁnition 5.1 Let a and b be integers, not both zero. Let d be the largest number in the set of common divisors of a and b. We call d the greatest common divisor of a and b, and we write d = gcd(a, b), or, more simply, d = (a, b). Example 5.1 We compute some simple gcd’s. • (6, 4) = 2 • (3, 5) = 1 • (16, 24) = 8 • (4, 0) = 4 • (5, 5) = 5 • (3, 12) = 3 Deﬁnition 5.2 If (a, b) = 1, we say that a and b are relatively prime. In general, we’d like to be able to compute (a, b) without listing all of the factors of a and b. The Euclidean Algorithm is the most eﬃcient method known for computing the greatest common divisor of two integers. We’ll begin by illustrating the method with an example. Example 5.2 Compute (54, 21). 24 Stanford University EPGY Number Theory Solution: The ﬁrst step is to divide 54 by 21, which gives a quotient of 2 and a remainder of 12. We write this as 54 = 2 · 21 + 12. Next, we divide 21 by 12, and obtain a quotient of 1 and a remainder of 9. We write this as 21 = 1 · 12 + 9. Next, we divide 12 by 9, and obtain a quotient of 1 and a remainder of 3. We write this as 12 = 1 · 9 + 3. Next, we divide 9 by 3 , and obtain a quotient of 3 and a remainder of 0. We write this as 9 = 3 · 3 + 0. The Euclidean algorithm says that we stop when we reach a remainder of 0, and that the remainder from the previous step is the greatest common divisor of the original two numbers. Thus, (54, 21) = 3. Now, why does this procedure work to give us the gcd? Working backwards through our string of equations, it’s clear that 3 | 9, so 3 | 12, so 3 | 21, so 3 | 54. Thus, 3 is a common divisor of 21 and 54. But why is it the greatest common divisor? Let’s suppose that d is some other common divisor of 21 and 54. We must show that d ≤ 3. Observe that if d | 21 and d | 54, then d | 12, so d | 9, so d | 3. Thus, d ≤ 3, so 3 is the gcd of 54 and 21. Example 5.3 Compute (36, 132), and use your computation to ﬁnd integers x and y such that (36, 132) = 36x + 132y. Solution: 132 = 3 · 36 + 24 36 = 1 · 24 + 12 24 = 2 · 12 + 0. We conclude that (36, 132) = 12. Working backwards, we have: 25 Stanford University EPGY Number Theory 12 = 36 − 1 · 24 = 36 − 1 · (132 − 3 · 36) = 4 · 36 − 1 · 132. We conclude that (36, 132) = 12 = 4 · 36 − 1 · 132. Example 5.4 Compute (53, 77), and use your computation to ﬁnd integers x and y such that (53, 77) = 53x + 77y. Solution: 77 = 1 · 53 + 24 53 = 2 · 24 + 5 24 = 4 · 5 + 4 5 = 1 · 4 + 1 4 = 4 · 1 + 0. We conclude that (53, 77) = 1, so 53 and 77 are relatively prime. Working backwards, we have: 1 = 5 − 1 · 4 = 5 − 1 · (24 − 4 · 5) = 5 · 5 − 1 · 24 = 5 · (53 − 2 · 24) − 1 · 24 = 5 · 53 − 11 · 24 = 5 · 53 − 11 · (77 − 1 · 53) = 16 · 53 − 11 · 77. Thus, (53, 77) = 1 = 16 · 53 − 11 · 77. Theorem 5.1 Let a and b be integers, not both zero. Then (a, b) can be written as a linear combination of a and b, i.e. there exist integers x and y such that (a, b) = ax + by, and these integers can be found by the Euclidean algorithm method illustrated in the examples. 26 Stanford University EPGY Number Theory Note that since (a, b) | a and (a, b) | b, (a, b) | ax + by for all integers x and y. By Theorem 5.1, we can always ﬁnd integers x and y so that (a, b) = ax + by. In general, let’s consider the possible values that we can obtain from numbers of the form ax + by when we substitute all possible integers for x and y. For example, consider the case a = 42 and b = 30. Note that (42, 30) = 6. Complete the table of values of 42x + 30y below for the given values of x and y. x = −3 x = −2 x = −1 x = 0 x = 1 x = 2 x = 3 y = −3 y = −2 y = −1 y = 0 y = 1 y = 2 y = 3 Observe that (42, 30) = 6 appears in the table, and is the smallest positive value of ax + by. In general, this is always true (and can be proven via the Euclidean algorithm). Theorem 5.2 Let a and b be integers, not both zero. Then the smallest positive value of ax + by (taken over all integers x and y) is (a, b). Suppose that a, b, c are integers and that a | bc. When is it true that a is also a divisor of c? For example, 8 | 4 · 10 = 40, but 8 ∤ 4 and 8 ∤ 10. We can use Theorem 5.1 to answer this question. Lemma 5.3 If a | bc and if (a, b) = 1, then a | c. Proof. Since (a, b) = 1, there are integers x and y such that ax + by = 1, and since a | bc, there is an integers k such that ak = bc. Then 27 Stanford University EPGY Number Theory c = c · 1 = c · (ax + by) = (acx + bcy) = (acx + aky) = a(cx + ky). Thus, a | c. 28 Stanford University EPGY Number Theory Problem Set 1. Use the Euclidean algorithm to ﬁnd each of the following. (a) (77, 91) (b) (182, 442) (c) (2311, 3701) (d) (12345, 67890) 2. Express (17, 37) as a linear combination of 17 and 37. 3. Express (399, 703) as a linear combination of 399 and 703. 4. Find integers r and s such that 547r + 632s = 1. 5. Find integers r and s such that 398r + 600s = 2. 6. Find integers r and s such that 922r + 2163s = 7. 7. Use the Euclidean algorithm to ﬁnd (29, 11), and show that 29 11 = 2 + 1 1 + 1 1+ 1 1+ 1 3 . 8. Suppose that a, b, c are positive integers. Show that (ca, cb) = c(a, b). 9. Suppose that (a, b) = d. Show that ( a d , b d ) = 1. Hint: use the theorem on linear combinations. 10. Show that if there is no prime p such that p | a and p | b, then (a, b) = 1. 11. Show that if p is a prime and a is an integer, then either (a, p) = 1 or (a, p) = p. 12. Prove that (a, b) n = (a n, b n) for all natural numbers n. 13. Suppose that (a, b) = 1. Show that (a + b, a 2 − ab + b2) = 1 or 3. 14. A number L is called a common multiple of m and n if both m and n divide L. The smallest such L is called the least common multiple of m and n and is denoted by lcm(m, n). For example, lcm(3, 7) = 21 and lcm(12, 66) = 132. (a) Find each of the following. i. lcm(8, 12) 29 Stanford University EPGY Number Theory ii. lcm(20, 30) iii. lcm(51, 68) iv. lcm(23, 18) (b) For each of the lcm’s that you computed in (a), compare the value of lcm(m, n) to the values of m, n and (m, n). Try to ﬁnd a relationship. (c) Prove that the relationship that you found in part (b) is true for all m and n. (d) Suppose that (m, n) = 18 and lcm(m, n) = 720. Find m and n. Is there more than one possibility? If so, ﬁnd all of them. (e) Suppose that (a, b) = 1. Show that for every integer c, the equation ax + by = c has a solution in integers x and y. (f) Find integers x and y such that 37x + 47y = 103. 15. Find two positive integers a and b such that a 2+b2 = 85113 and lcm(a, b) = 1764. 16. For all integers n ≥ 0, deﬁne Fn = 2 2n + 1. Fn is called the n-th Fermat number. Find (Fn, Fm). 17. Let a be an integer greater than or equal to 1. Find all integers b ≥ 1 such that (2 b − 1) | (2 a − 1). 18. Show that (n3 + 3n + 1, 7n3 + 18n2 − n − 2) = 1 for all integers n ≥ 1. 19. Let the integers an and bn be deﬁned by the relationship an + bn√2 = (1 + √2) n for all integers n ≥ 1. Prove that (an, bn) = 1 for all integers n ≥ 1. 20. Find integers x, y, z that satisfy the equation 6x + 15y + 20z = 1. 21. Under what conditions on a, b, c is it true that the equation ax + by + cz = 1 has a solution? Describe a general method for ﬁnding a solution when one exists. 30 Chapter 6 Prime Factorization and the Fundamental Theorem of Arithmetic Theorem 6.1 Let p be a prime number, and suppose that p | ab. Then either p | a or p | b (or p divides both a and b). Proof. Suppose that p is a prime number that divides the product ab. If p | a, then we have nothing to prove, so let’s assume that p ∤ a. Consider the greatest common divisor (a, p). We know that (a, p) | p, so (a, p) = 1 or (a, p) = p since p is a prime. But, (a, p) ̸= p, since (a, p) | a, and we are assuming that p ∤ a. Thus, (a, p) = 1. Thus, there exist integers x and y such that ax + py = 1. Multiplying both sides of this equation by b, we obtain abx + pby = b. Since p | abx and p | pby, we conclude that p | (abx + pby) = b. Theorem 6.2 Let p be a prime number, and suppose that p divides the product a1a2 · · · ar. Then p divides at least one of the factors a1, a2, . . . , ar. Proof. If p | a1, then we have nothing to prove, so let’s assume that p ∤ a1. Applying Theorem 6.1 to the product a1(a2a3 · · · ar), 31 Stanford University EPGY Number Theory we conclude that p | a2a3 · · · ar. Now, if p | a2, then we are ﬁnished, so let’s assume that p ∤ a2. Applying Theorem 6.1 to the product a2(a3a4 · · · ar), we conclude that p | a3a4 · · · ar. Continuing, we eventually ﬁnd some ak so that p | ak. Our goal now is to prove that every integer n ≥ 2 can be factored uniquely into a product of primes p1p2 · · · pn. Before we prove this result (which seems natural and, perhaps, obvious), let’s look at an example that should illustrate that unique factorization into primes is, in fact, not obvious. Example 6.1 Let E = {. . . , −8, −6, −4, −2, 0, 2, 4, 6, 8, . . .} denote the set of even numbers. Consider the number 60 in E. • Observe that 60 = 2 · 30 = 6 · 10. • Observe that 2, 6, 10, and 30 are all “primes” in E since they cannot be factored in E. Thus, 60 has two completely diﬀerent prime factorizations in E. Although this example is somewhat contrived, it should convince you that there is real mathematical content to unique prime factorization. Certain number systems have unique factorization, and others do not. The set Z of integers has important properties that make the unique factorization theorem true. Theorem 6.3 Fundamental Theorem of Arithmetic (FTA). Every integer n ≥ 2 can be factored into a product of primes n = p1p2 · · · pn in exactly one way. Proof. Notice that the FTA actually contains two separate assertions that we must prove: 1. We must prove that every integer n ≥ 2 can be factored into a product of primes. 32 Stanford University EPGY Number Theory 2. We must prove that there is only one such factorization. We’ll begin by proving the ﬁrst assertion. We’ll construct a proof by contradiction. Suppose that there exist integers greater than 2 that cannot be written as a product of primes. There must be a smallest such integer. Call the smallest such integer N . Since N cannot be written as a product of primes, we can conclude that N is not prime. Thus, there exist integers b and c such that N = bc, with b, c > 1 and b, c < N . Since N is the smallest integer that cannot be written as a product of primes, b and c can both be written as products of primes: b = p1p2 · · · pk, c = q1q2 · · · ql, where all of the pi and qi are prime. Then N = bc = p1p2 · · · pkq1q2 · · · qk can also be written as a product of primes. This is a contradiction, so we conclude that no such integers exist. Thus, every integer n ≥ 2 can be factored into a product of primes. Next, we’ll prove the second assertion. Suppose that there exists an integer n that we can factor as a product of primes in two ways, say n = p1p2 · · · pk = q1q2 · · · ql. We must show that these two factorizations are the same, possibly after rearranging the order of the factors. First, observe that p1 | n = q1q2 · · · ql, so by Theorem 6.2, p1 must divide one of the qi. We can rearrange the qi’s so that p1 | q1. But q1 is also a prime number, so its only divisors are 1 and q1. Thus, we conclude that p1 = q1. Now we cancel p1 = q1 from both sides of the equation to obtain p2p3 · · · pk = q2q3 · · · ql. Repeating the same argument as before, we note that p2 | q1q2 · · · ql, so by Theorem 6.2, p2 must divide one of the qi’s, and after rearranging, we conclude that p2 | q2, so p2 = q2 33 Stanford University EPGY Number Theory since q2 is prime. Canceling p2 = q2 from both sides of the equation, we obtain p3p4 · · · pk = q3q4 · · · ql. We can continue this argument until either all of the pi’s or all of the qi’s are gone. But if all of the pi’s are gone, then the left-hand side of the equation is equal to 1, so there cannot be any qi’s left either. Similarly, if all of the qi’s are gone, then the right-hand side of the equation is equal to 1, so there cannot be any pi’s left either. Thus, the number of pi’s must be the same as the number of the qi’s, and after rearranging, we have p1 = q1, p2 = q2, p3 = q3, . . . , pk = qk. Thus, there is only one way to write an integer n ≥ 2 as a product of primes. Applications of the Fundamental Theorem of Arithmetic. Example 6.2 Show that √2 is irrational. Solution: Proof by contradiction. Suppose that √2 is rational. Then there exist integers r, s such that √2 = r s . Then 2 = r2 s2 , so 2s2 = r2. Let n denote the number of prime factors in the prime factorization of s. Then there are 2n prime factors in the prime factorization of s2, and since 2 is prime, there are 2n + 1 prime factors in the prime factorization of 2s2, so in particular, 2s2 has an odd number of prime factors. Next, let m denote the number of prime factors in the prime factorization of r. Then there are 2m prime factors in the prime factorization of r2, so in particular, r2 has an even number of prime factors. However, this contradicts the FTA since 2s2 = r2. Thus, we conclude that √2 is irrational. Example 6.3 Suppose that a and n are positive integers and that n√a is rational. Prove that n√a is an integer. Solution: Since n√a is rational and positive, there are positive integers r and s such that n√a = r s , 34 Stanford University EPGY Number Theory so asn = rn. Without loss of generality, we may assume that (r, s) = 1 (otherwise, divide the numerator and denominator by (r, s) so that the fraction is in lowest terms). We will use proof by contradiction to show that s = 1. Suppose that s > 1. Then there is a prime p that divides s, so p | asn = rn. Thus, by Theorem 6.2, p | r. But this is a contradiction since (r, s) = 1. Thus, s = 1, so n√a = r is an integer. We can use this result, for example, to show that √2 is irrational. Since 1 < √2 < 2, √2 is not an integer, so it is not rational by the result of this example. Example 6.4 Show that log10 2 is irrational. Solution: Proof by contradiction. Suppose that log10 2 is rational. Then there exist integers r, s such that log10 2 = r s . Then 10 r/s = 2, so 10 r = 2 s, or 5 r2 r = 2 s, which contradicts the FTA. Thus, log10 2 is irrational. Example 6.5 Prove that if the polynomial p(x) = a0xn + a1xn−1 + · · · + an−1x + an with integral coeﬃcients assumes the value 7 for four integral values of x, then it cannot take the value 14 for any integral value of x. Solution: Proof by contradiction. Assume that there is an integer m such that p(m) = 14. We know that p(ak) − 7 = 0 for four distinct integers a1, a2, a3, a4. Then p(x) − 7 = (x − a1)(x − a2)(x − a3)(x − a4)q(x) 35 Stanford University EPGY Number Theory for some polynomial q(x) with integer coeﬃcients. Then we have 14 − 7 = 7 = p(m) − 7 = (m − a1)(m − a2)(m − a3)(m − a4)q(m). Since the factors m − ak are all distinct, we have decomposed the integer 7 into at least four diﬀerent factors. However, by the FTA, the integer 7 can be written as a product of at most 3 diﬀerent integers: 7 = (−7)(1)(−1). Thus, we have reached a contradiction, so we conclude that the polynomial cannot take the value 14 for any integral value of x. Example 6.6 Prove that m5 + 3m4n − 5m3n2 − 15m2n3 + 4mn4 + 12n5 is never equal to 33. Solution: Observe that m5 + 3m4n − 5m3n2 − 15m2n3 + 4mn4 + 12n5 = (m − 2n)(m − n)(m + n)(m + 2n)(m + 3n). Now, 33 can be decomposed as the product of at most four diﬀerent integers: 33 = (−11)(3)(1)(−1) or 33 = (−3)(11)(1)(−1). If n ̸= 0, the factors in the above product are all diﬀerent. By the FTA, they cannot multiply to 33, since 33 is the product of at most 4 diﬀerent factors and the expression above is the product of 5 diﬀerent factors for n ̸= 0.. If n = 0, the product of the factors is m5, and 33 is clearly not a ﬁfth power. Thus, m5 + 3m4n − 5m3n2 − 15m2n3 + 4mn4 + 12n5 is never equal to 33. Example 6.7 Prove that there is exactly one natural number n such that 2 8+2 11+2 n is a perfect square. Solution: Suppose that k is an integer such that k2 = 2 8 + 2 11 + 2 n = 2304 + 2 n = 48 2 + 2 n. Then k2 − 48 2 = (k − 48)(k + 48) = 2 n. By the FTA, k − 48 = 2 s and k + 48 = 2 t, where s + t = n. But then 2 t − 2 s = 48 − (−48) = 96 = 3 · 2 5 , so 2 s(2 t−s − 1) = 3 · 2 5. By the FTA, s = 5 and t − s = 2, so s + t = n = 12. Thus, the only natural number n such that 2 8 + 2 11 + 2 n is a perfect square is n = 12. 36 Stanford University EPGY Number Theory Problem Set 1. Give an example of four positive integers such that any three of them have a common divisor greater than 1, although only ±1 divide all four of them. 2. Prove that √3 is irrational. 3. Prove that 3√3 is irrational. 4. Prove that 5√5 is irrational. 5. Prove that if n ≥ 2, then n√n is irrational. Hint: show that if n > 2, then 2 n > n. 6. Prove that log10 7 is irrational. 7. Prove that log 3 log 2 is irrational. 8. Find the smallest positive integer such that n/2 is a square and n/3 is a cube. 9. In this exercise, you will continue your investigation of the set E, the set of even numbers. (a) Classify all primes in E. We will refer to such integers as E-primes. (b) We have seen that 60 has two diﬀerent factorizations as a product of E- primes. Show that 180 has three diﬀerent factorizations as a product of E-primes. (c) Find the smallest number with four diﬀerent factorizations in E. (d) The number 12 has only one factorization as a product of primes in E: 12 = 2 · 6. Describe all even numbers that have only one factorization as a product of E-primes. 10. Let M denote the set of positive integers that leave a remainder of 1 when divided by 4, i.e. M = {1, 5, 9, 13, 17, 21, . . .}. Note that all numbers in M are numbers of the form 4k + 1 for k = 0, 1, 2, . . .. (a) Show that the product of two numbers in M is also in M, i.e. if a and b both leave a remainder of 1 when divided by 4, then ab does as well. (b) Find the ﬁrst six M-primes in M. An integer is an M-prime if its only divisors in M are 1 and itself. (c) Find a number in M that has two diﬀerent factorizations as a product of M-primes. Conclude that M does not have unique factorization. 11. Consider the set F = {a + b√−6}, where a and b are integers. 37 Stanford University EPGY Number Theory (a) A prime in F is an element of F which has no factors in F other than 1 and itself. Show that 2 and 5 are F-primes. (b) Show that 7 and 31 are not F-primes. (c) Find two diﬀerent factorizations of the number 10 in F. (d) Conclude that F does not have unique factorization. 12. Show that if p is a prime and p | a n, then pn | a n. 13. How many zeros are there at the end of 100!? 14. Prove that the sum 1/3 + 1/5 + 1/7 + · · · + 1/(2n + 1) is never an integer. Hint: Look at the largest power of 3 ≤ n. 15. Find the number of ways of factoring 1332 as the product of two positive rela- tively prime factors each greater than 1. 16. Let p1, p2, . . . , pt be diﬀerent primes and a1, a2, . . . at be natural numbers. Find the number of ways of factoring pa1 1 pa2 2 · · · pat t as the product of two positive relatively prime factors each greater than 1. 17. Show that the cube roots of three distinct prime numbers cannot be three terms (not necessarily consecutive) of an arithmetic progression. 18. Prove that there is no triplet of integers (a, b, c), except for (a, b, c) = (0, 0, 0) for which a + b√2 + c√3 = 0. 38 Chapter 7 Introduction to Congruences and Modular Arithmetic Deﬁnition 7.1 We say that a is congruent to b modulo m, and write a ≡ b mod m, if m divides a − b. Equivalently, a ≡ b mod m if a and b leave the same remainder upon division by m. By the Division Algorithm, we observe that a ≡ b mod m if and only if there exists an integer k such that a = b + km. Example 7.1 7 ≡ 2 mod 5 since 5 | (7−2). Note that 7 and 2 both leave remainder 2 upon division by 5. Example 7.2 47 ≡ 35 ≡ 5 mod 6 since 6|(47 − 35) and 6|(35 − 5). Note that 47, 35, and 5 all leave remainder 5 upon division by 6. Example 7.3 9 ≡ 0 mod 3 since 3 | 9. Note that 9 leaves a remainder of 0 upon division by 3. Example 7.4 15 ≡ 7 ≡ −1 mod 8 since 8 | (15 − 7) and 8 | (7 − −1). Example 7.5 Construct an addition table and a multiplication table for arithmetic modulo 5. Solution: 39 Stanford University EPGY Number Theory Addition modulo 5: a, b 0 1 2 3 4 0 0 1 2 3 4 1 1 2 3 4 0 2 2 3 4 0 1 3 3 4 0 1 2 4 4 0 1 2 3 Multiplication modulo 5: a, b 0 1 2 3 4 0 0 0 0 0 0 1 0 1 2 3 4 2 0 2 4 1 3 3 0 3 1 4 2 4 0 4 3 2 1 Note that if a is divided by m and leaves a remainder of r, then a is congruent to r modulo m. Recall (from the Division Algorithm) that the remainder r obtained upon dividing a by m satisﬁes 0 ≤ r < m, so every integer a is congruent, modulo m, to some integer between 0 and m − 1. This is an important idea, and one that we will return to later. For now, we’ll study some fundamental properties of congruences. Theorem 7.1 Fundamental Properties of Congruences, Part 1. Let m be a positive integer. For all integers a, b, c, the following statements are true: 1. a ≡ a mod m 2. If a ≡ b mod m, then b ≡ a mod m. 3. If a ≡ b mod m, and b ≡ c mod m, then a ≡ c mod m. 4. For all integers n ≥ 1, a n ≡ bn mod m. Proof. 1. Since m | 0 = (a − a), a ≡ a mod m. 2. Suppose that a ≡ b mod m. Thus, m | (a − b). Then there is an integer k such that (a − b) = km. Thus, (b − a) = −km, so m | (b − a). Thus, b ≡ a mod m. 3. Suppose that a ≡ b mod m and that b ≡ c mod m. Thus, m | (a − b) and m | (b − c). Then there are integers k and l such that (a − b) = km and (b − c) = lm. Thus, (a − c) = (a − b) + (b − c) = km + lm = (k + l)m, so m | (a − c). Thus, a ≡ c mod m. 40 Stanford University EPGY Number Theory Theorem 7.2 Fundamental Properties of Congruences, Part 2. Suppose that a ≡ b mod m and c ≡ d mod m. Then: 1. (a + c) ≡ (b + d) mod m, 2. (a − c) ≡ (b − d) mod m, 3. ac ≡ bd mod m, and 4. For all integers n ≥ 1, a n ≡ bn mod m. Proof. Since a ≡ b mod m, m | (a − b), so there is an integer k such that (a − b) = km. Similarly, since c ≡ d mod m, m | (c − d), so there is an integer l such that (c − d) = lm. 1. To prove the ﬁrst equivalence, we observe the following: (a + c) − (b + d) = (a − b) + (c − d) = km + lm = (k + l)m, so m | (a + c) − (b + d). Thus, (a + c) ≡ (b + d) mod m. 2. To prove the second equivalence, we observe the following: (a − c) − (b − d) = (a − b) + (d − c) = km − lm = (k − l)m, so m | (a − c) − (b − d). Thus, (a − c) ≡ (b − d) mod m. 3. Finally, to prove the third equivalence, we observe the following: ac − bd = c(a − b) + b(c − d) = ckm + blm = (ck + bl)m, so m | (ac − bd). Thus, ac ≡ bd mod m. 41 Stanford University EPGY Number Theory Theorem 7.3 If a ≡ b mod m, then for any integer c, (a ± c) ≡ (b ± c) mod m, and ac ≡ bc mod m. Proof. Since m | (a−b), m | (a−b)+(c−c) = (a+c)−(b+c) and m | (a−b)−(c−c) = (a − c) − (b − c), so (a ± c) ≡ (b ± c) mod m. Similarly, m | (a − b)c = ac − bc, so ac ≡ bc mod m. Corollary 7.4 Suppose that f (x) is a polynomial with integer coeﬃcients. If a ≡ b mod m, then f (a) ≡ f (b) mod m. Proof. Let f (x) = akxk + ak−1xk−1 + · · · + a1x + a0, where a0, a1, . . . , ak are integers. Then by Theorem 7.2, aka k + ak−1a k−1 + · · · + a1a + a0 ≡ akbk + ak−1bk−1 + · · · + a1b + a0 mod m. Thus, f (a) ≡ f (b) mod m. Note that in general, we are not allowed to “divide” in congruences. For example, 15 = 3 · 5 ≡ 3 · 1 mod 6. But 5 ̸≡ 1 mod 6, so we can’t “cancel” the 3’s. However, it is true that 3 · 4 ≡ 3 · 14 mod 15 and 4 ≡ 14 mod 5, so in certain cases, we can cancel. Thus, it is a natural question to determine under which conditions we can cancel in congruences. Theorem 7.5 Suppose that ac ≡ bc mod m and that (c, m) = 1. Then a ≡ b mod m. 42 Stanford University EPGY Number Theory Proof. m | (ac − bc) = (a − b)c. Since (m, c) = 1, m | (a − b). 43 Stanford University EPGY Number Theory Problem Set 1. Determine whether each of the following statements is true or false. (a) 17 ≡ 2 mod 5 (b) 14 ≡ −6 mod 10 (c) 97 ≡ 5 mod 13 2. Compute each of the following: (a) 30 modulo 4 (b) 21 modulo 6 (c) 100 modulo 9 (d) 32 modulo 8 (e) 29 modulo 5 (f) 75 modulo 11 3. (a) Verify each of the following statements. i. 3 · 5 ≡ 3 · 13 mod 4 ii. 7 · 18 ≡ 7 · (−2) mod 10 iii. 3 · 4 ≡ 3 · 14 mod 6 (b) Determine whether each of the following statements is true or false. i. 5 ≡ 13 mod 4 ii. 18 ≡ −2 mod 10 iii. 4 ≡ 14 mod 6 4. Can we add congruences? If a ≡ b mod m and c ≡ d mod m, is it necessarily true that a + c ≡ b + d mod m? If so, why? If not, provide an example that illustrates why not. To get started on this question, do some numerical examples. 5. Can we subtract congruences? If a ≡ b mod m and c ≡ d mod m, is it necessarily true that a − c ≡ b − d mod m? If so, why? If not, provide an example that illustrates why not. To get started on this question, do some numerical examples. 6. Can we multiply congruences? If a ≡ b mod m and c ≡ d mod m, is it necessarily true that ac ≡ bd mod m? If so, why? If not, provide an example that illustrates why not. To get started on this question, do some numerical examples. 7. Can we take powers of congruences? If a ≡ b mod m and n ≥ 1 is a positive integer, is it necessarily true that an ≡ bn mod m? If so, why? If not, provide an example that illustrates why not. To get started on this question, do some numerical examples. 44 Stanford University EPGY Number Theory 8. Can we cancel congruences? If ab ≡ ac mod m, is it necessarily true that b ≡ c mod m? If so, why? If not, provide an example that illustrates why not. To get started on this question, do some numerical examples. 9. Suppose that ac ≡ bc mod m and that gcd(c, m) = 1. Prove that a ≡ b mod m in this case. 10. Find a if a ≡ 97 mod 7 and 1 ≤ a ≤ 7. 11. Find a if a ≡ 32 mod 19 and 52 ≤ a ≤ 70. 12. Construct the tables for addition and multiplication modulo 7. 45 Chapter 8 Applications of Congruences and Modular Arithmetic Example 8.1 Find the remainder when 6 1987 is divided by 37. Solution: First, note that 6 2 ≡ −1 mod 37. Thus: 6 1987 ≡ 6 · 6 1986 mod 37 ≡ 6(6 2) 993 mod 37 ≡ 6(−1) 993 mod 37 ≡ −6 mod 37 ≡ 31 mod 37. Thus, the desired remainder is 31. Example 8.2 Prove that 7 divides 32n+1 + 2 n+2 for all natural numbers n. Solution: Observe that 3 2n+1 ≡ 3 · 9 n ≡ 3 · 2 n mod 7 and 2 n+2 ≡ 4 · 2 n mod 7. Thus, 3 2n+1 + 2 n+2 ≡ 7 · 2 n ≡ 0 mod 7, for all natural numbers n. Example 8.3 Prove that 641 | (2 32 + 1). 46 Stanford University EPGY Number Theory Solution: First, observe that 641 = 2 7 · 5 + 1 = 2 4 + 5 4. Thus, 2 7 · 5 ≡ −1 mod 641 and 5 4 ≡ −2 4 mod 641. Thus, 5 4 · 2 28 = (5 · 2 7) 4 ≡ (−1) 4 mod 641 ≡ 1 mod 641. Thus, −2 4 · 2 28 = −2 32 ≡ 1 mod 641. This implies that −2 32 − 1 ≡ 0 mod 641, so 641 | −(2 32 + 1), which implies that 641 | (2 32 + 1). Example 8.4 Prove that there are no integers with x2 − 5y2 = 2. Hint: consider the equation modulo 5. Solution: If x2 − 5y2 = 2, then (x2 − 5y2) ≡ 2 mod 5. Since 5y2 ≡ 0 mod 5, this implies that x2 ≡ 2 mod 5. Now, consider the possibilities for x and x2 modulo 5. x modulo 5 x2 modulo 5 0 0 1 1 2 4 3 4 4 1 Thus, there is no x such that x2 is congruent to 2 modulo 5, so there are no integers x and y such that x2 − 5y2 = 2. Example 8.5 Find the units digit of 7 100. Solution: To ﬁnd the units digit of 7 100, we must ﬁnd 7 100 modulo 10. 47 Stanford University EPGY Number Theory 7 2 ≡ −1 mod 10 7 3 ≡ 7 · 7 2 mod 10 ≡ −7 mod 10 7 4 ≡ (7 2) 2 mod 10 ≡ (−1) 2 mod 10 ≡ 1 mod 10 7 100 ≡ (7 4) 25 mod 10 ≡ 1 25 mod 10 ≡ 1 mod 10. Thus, the units digit of 7 100 is 1. Example 8.6 Find inﬁnitely many integers n such that 2 n + 27 is divisible by 7. Solution: Observe that 2 1 ≡ 2 mod 7 2 2 ≡ 4 mod 7 2 3 ≡ 1 mod 7 2 4 ≡ 2 mod 7 2 5 ≡ 4 mod 7 2 6 ≡ 1 mod 7. Thus, 2 3k ≡ (2 3) k ≡ 1 k mod 7 for all positive integers k. Thus, 2 3k + 27 ≡ 1 + 27 ≡ 28 ≡ 0 mod 7 for all positive integers k. Thus, for all positive integers k, 7 | 2 3k + 27, so 2 n + 27 is divisible by 7 for all positive multiples of 3. Example 8.7 Prove that 2 k−5, k = 0, 1, 2, . . . never leaves remainder 1 when divided by 7. Solution: Observe that 2 1 ≡ 2 mod 7, 48 Stanford University EPGY Number Theory 2 2 ≡ 4 mod 7, 2 3 ≡ 1 mod 7, and this cycle of three repeats, so for any k, 2 k ≡ 2, 4, or 1 mod 7. Thus (2 k − 5) ≡ −3, − 1, or − 4 mod 7, so 2 k − 5 can leave only remainders 3, 4, or 6 upon division by 7. Example 8.8 Show that a positive integer n is divisible by 3 if and only if the sum of its digits is divisible by 3. Solution: We show that n and the sum of its digits are congruent modulo 3. Suppose that the positive integer n is written in its standard decimal expansion as n = ak · 10 k + ak−110 k−1 + · · · + a2 · 10 2 + a1 · 10 + a0. Observe that 10 ≡ 1 mod 3 and 10 m ≡ 1 m ≡ 1 mod 3 for any integer m. Thus, n ≡ ak · 10 k + ak−110 k−1 + · · · + a2 · 10 2 + a1 · 10 + a0 mod 3 ≡ ak · 1 + ak−1 · 1 + · · · + a2 · 1 + a1 · 1 + a0 mod 3 ≡ ak + ak−1 + · · · + a2 + a1 + a0 mod 3. Thus, the remainder obtained when n is divided by 3 is the same as the remainder obtained when the sum of the digits of n is divided by 3, so n is divisible by 3 if and only if the sum of its digits is divisible by 3. 49 Stanford University EPGY Number Theory Problem Set 1 1. Compute each of the following: (a) 51 mod 13 (b) 342 mod 85 (c) 62 mod 15 (d) 10 mod 15 (e) (82 · 73) mod 7 (f) (51 + 68) mod 7 (g) (35 · 24) mod 11 (h) (47 + 68) mod 11 2. List all integers x in the range 1 ≤ x ≤ 100 that satisfy x ≡ 7 mod 17. 3. If an integer x is even, observe that it must satisfy the congruence x ≡ 0 mod 2. If an integer y is odd, what congruence does it satisfy? What congruence does an integer z of the form 6k + 1 satisfy? 4. Write a single congruence that is equivalent to the pair of congruences x ≡ 1 mod 4, x ≡ 2 mod 3. 5. Suppose that p is a prime number and that a2 ≡ b2 mod p. Show that p | (a + b) or p | (a − b). 6. Show that if a ≡ b mod n and d | n, then a ≡ b mod d. 7. Show that a perfect square is congruent to either 0 or 1 modulo 4. 8. (a) Compute 5 2 mod 3. (b) Use (a) to compute 5 3 mod 3. (c) Use (a) and (b) to compute 5 101 mod 3. (d) What is the remainder when 5 101 is divided by 3? 9. (a) Compute 2 2 mod 3. (b) Compute 4 2 mod 5. (c) Compute 6 2 mod 7. (d) Compute 10 2 mod 11. 50 Stanford University EPGY Number Theory (e) Make a conjecture about the value of (p − 1) 2 mod p, where p is a prime number. Prove that your conjecture is true for all primes p. 10. (a) Compute 1 · 2 mod 3. (b) Compute 1 · 2 · 3 · 4 mod 5. (c) Compute 1 · 2 · 3 · 4 · 5 · 6 mod 7. (d) Compute 1 · 2 · 3 · 4 · 5 · 6 · 7 · 8 · 9 · 10 mod 11. (e) Make a conjecture about the value of (p − 1)! mod p, where p is a prime number. This result is known as Wilson’s Theorem. (f) Try to prove that your conjecture is correct for all primes p. 11. (a) Find (by trial and error or otherwise) all numbers x, 0 ≤ x ≤ 2, such that x2 ≡ 1 mod 3. (b) Find (by trial and error or otherwise) all numbers x, 0 ≤ x ≤ 4, such that x2 ≡ 1 mod 5. (c) Find (by trial and error or otherwise) all numbers x, 0 ≤ x ≤ 6, such that x2 ≡ 1 mod 7. (d) Find (by trial and error or otherwise) all numbers x, 0 ≤ x ≤ 10, such that x2 ≡ 1 mod 11. (e) Suppose that p is a prime. Make a conjecture about the numbers x, 0 ≤ x ≤ p − 1 such that x2 ≡ 1 mod p. 12. The inverse of a number x modulo m is the number y such that xy ≡ 1 mod m. For example, since 3 · 5 ≡ 1 mod 7, 5 is the inverse of 3 modulo 7 and 3 is the inverse of 5 modulo 7. (a) Find the inverse of 1 modulo 7. (b) Find the inverse of 2 modulo 7. (c) Find the inverse of 4 modulo 7. (d) Find the inverse of 6 modulo 7. 13. Let n be a positive integer greater than 3. Show that n, n + 2, and n + 4 cannot all be prime. 14. Let a, b, s, t be integers. If a ≡ b mod st, show that a ≡ b mod s and a ≡ b mod t. 51 Stanford University EPGY Number Theory 15. A United States Postal Service money order has an identiﬁcation number con- sisting of 10 digits together with an extra digit called a check. The check digit is the 10-digit number modulo 9. Thus, the number 3953988164 has the check digit 2 since 3953988164 ≡ 2 mod 9. If the number 39539881642 were incorrectly entered into a computer (pro- grammed to calculate the check digit) as, say, 39559881642 (an error in the fourth position), the machine would calculate the check as 4, whereas the en- tered check digit would be 2. Thus, the error would be detected. (a) Determine the check digit for a money order with identiﬁcation number 7234541780. (b) Suppose that in one of the noncheck positions of a money order number, the digit 0 is substituted for the digit 9, or vice versa. Prove that this error will not be detected by the check digit. Prove that all other errors involving a single position are detected. (c) Suppose that a money order with identiﬁcation number and check digit 21720421168 is erroneously copied as 27750421168. Will the check digit detect the error? (d) A transposition error involving distinct adjacent digits is one of the form ...ab... → ...ba... with a ̸= b. Prove that the money order check digit scheme will not detect such errors until the check digit itself is transposed. 16. As you have shown in the previous problem, the method used by the Postal Service does not detect all single-digit errors. One method that does detect all single-digit errors, as well as nearly all errors involving the transposition of two adjacent digits, is the Universal Product Code (UPC). A UPC identiﬁcation number has 12 digits. The ﬁrst 6 digits identify the manufacturer, the next 5 identify the product, and the last is a check. To explain how the check digit is calculated, we introduce the dot product notation for two k-tuples: (a1, a2, . . . , ak) · (b1, b2, . . . , bk) = a1b1 + a2b2 + · · · + akbk. An item with UPC identiﬁcation number a1a2 · · · a12 satisﬁes the condition (a1, a2, . . . , a12) · (3, 1, 3, 1, . . . , 3, 1) ≡ 0 mod 10. Thus, the the UPC identiﬁcation number 021000658978 has check digit 8 be- cause 0·3+2·1+1·3+0·1+0·3+0·1+6·3+5·1+8·3+9·1+7·3+8·1 = 90 ≡ 0 mod 10. (a) Determine the UPC check digit for the number 07312400508. 52 Stanford University EPGY Number Theory (b) Explain why the UPC check digit scheme will identify all single-digit errors. (c) Show that the only undetected transposition errors of adjacent digits a and b in the UPC scheme are those in which |a − b| = 5. 17. Identiﬁcation numbers printed on bank checks (on the bottom left between the two colons) consist of an eight-digit number a1a2 · · · a8 and a check digit a9 so that (a1, a2, . . . , a9) · (7, 3, 9, 7, 3, 9, 7, 3, 9) ≡ 0 mod 10. As in the case for the UPC scheme, this method detects all single-digit errors and all errors involving the transposition of adjacent digits a and b except when |a − b| = 5. It also detects most errors of the form · · · abc · · · → · · · cba · · · , whereas the UPC method detects no errors of this form. Use this method to determine the check digit for the number 09190204. 18. The International Standard Book Number (ISBN) a1a2 · · · a10 has the property that (a1, a2, . . . , a10) · (10, 9, 8, 7, 6, 5, 4, 3, 2, 1) ≡ 0 mod 11. The digit a10 is the check digit. When a10 is required to be 10 to satisfy the congruence, the character X is used as the check digit. (a) The ISBN assigned to one of my favorite number theory books (that you will receive a copy of at the end of the session!) is 0-13-186137-9. Verify that this ISBN satisﬁes the necessary congruence. (b) Verify the check digit for the ISBN assigned to your favorite book (or any book that you have with you). (c) The ISBN 0-669-03925-4 is the result of a transposition of two adjacent digits not involving the ﬁrst or last digit. Determine the correct ISBN. 53 Stanford University EPGY Number Theory Problem Set 2 Applications of Congruences 1. Compute 5 15 modulo 7 and 7 13 modulo 11. 2. Find the number of integers n, 1 ≤ n ≤ 25, such that n2 + 15n + 122 is divisible by 6. Hint: n2 + 15n + 122 ≡ n2 + 3n + 2 ≡ (n + 1)(n + 2) mod 6. 3. Find the remainder when 6 83 + 8 83 is divided by 49. 4. Prove that if 9 | (a3 + b3 + c3), then 3 | abc, for integers a, b, c. 5. Prove that there are no integers x, y that satisfy the equation x2 − 7y = 3. 6. Prove that if 7 | (a 2 + b2) then 7 | a and 7 | b. 7. Show that if x3 + y3 = z3, then one of x, y, z must be a multiple of 7. 8. Prove that there are no integers x, y, z that satisfy the equation 800000007 = x2 + y2 + z2. 9. Prove that the sum of the decimal digits of a perfect square cannot be equal to 1991. 10. Prove that 7 | 4 2n + 2 2n + 1 for all natural numbers n. 11. Find the last two digits of 3 100. 12. Show that a perfect square is congruent to either 0, 1, or 4 modulo 8. 13. Show that for all positive integers n, n3 ≡ n mod 3. 14. Show that if 5 ∤ n, then n4 ≡ 1 mod 5. 15. Show that any odd prime number p is either congruent to 1 modulo 4 or con- gruent to 3 modulo 4. 16. Find all possible values of the sum of two squares modulo 4. Use your result to show that the number 2003 cannot be written as the sum of two squares. 17. Suppose that m is an integer greater than or equal to 0. Show that 49 | 5 · 3 4m+2 + 53 · 2 5m. 18. Show that there are inﬁnitely many integers n such that 43 | (n2 + n + 41). 54 Stanford University EPGY Number Theory 19. Show that if n2 − 2 and n2 + 2 are both primes, then 3 | n. 20. Show that an integer n is divisible by 9 if and only if the sum of its digits is divisible by 9. 21. Show that an integer n = (dkdk−1 . . . d1d0) is divisible by 11 if and only if dk − dk−1 + dk−2 − . . . ± d0 is divisible by 11. 22. Show that an integer n is divisible by 4 if and only if its last two digits are divisible by 4. 23. Show that an integer n is divisible by 8 if and only if its last three digits are divisible by 8. 24. Find the least positive integer x such that 13 | (x2 + 1). 25. Prove that 19 is not a divisor of 4n2 + 4 for any integer n. 26. Prove that any number that is a square must have one of the following for its units digit: 0, 1, 4, 5, 6, 9 27. Prove that n6 − 1 is divisible by 7 if gcd(n, 7) = 1. 28. Prove that n7 − n is divisible by 42 for any integer n. 29. Prove that n13 − n is divisible by 2, 3, 5, 7, and 13 for any integer n. 30. Prove that the product of three consecutive integers is divisible by 504 if the middle one is a cube. 31. What is the last digit of 3 400? 32. Let N be a number with 9 distinct non-zero digits, such that, for each k from 1 to 9 inclusive, the ﬁrst k digits of N form a number which is exactly divisible by k. Find N (there is only one such number). 33. Let f (n) denote the sum of the digits of n. (a) For any integer n, prove that eventually the sequence f (n), f (f (n)), f (f (f (n))), . . . will become constant. This constant value is called the digital sum of n. (b) Prove that the digital sum of the product of any two twin primes, other than 3 and 5, is 8. Twin primes are primes that are consecutive odd numbers, such as 17 and 19. (c) Let N = 4444 4444. Find f (f (f (N ))). 34. The Fermat numbers are deﬁned as Fn = 2 2n + 1. Show that every Fn is either a prime or a pseudoprime. A pseudoprime is a composite integer n such that n | (2 n − 2). 55 Chapter 9 Linear Congruence Equations Deﬁnition 9.1 An equation of the form a1x1 + a2x2 + · · · + akxk ≡ b mod m, with unknowns x1, x2, . . . , xk is a linear congruence equation in k variables. A solution to this equation is a set of integers which satisﬁes the equation. Example 9.1 x = 1, y = 2, z = 3 is a solution to the linear congruence equation x + y + z ≡ 6 mod 7. Example 9.2 Solve the congruence x + 12 ≡ 5 mod 8. Solution: The key step is to observe that we can subtract 12 from both sides of the equivalence (by Theorem 7.2). x + 12 ≡ 5 mod 8 x ≡ (5 − 12) mod 8 x ≡ −7 mod 8 x ≡ 1 mod 8 Thus, any integer x that is congruent to 1 modulo 8 will satisfy the congruence. Example 9.3 Solve the congruence 4x ≡ 3 mod 19. Solution: First, observe that we cannot simply divide both sides by 4. However, by Theorem 7.3, we can multiply both sides of the equivalence by 5. Thus we obtain: 56 Stanford University EPGY Number Theory 4x ≡ 3 mod 19 20x ≡ 15 mod 19 x ≡ 15 mod 19 since 20 ≡ 1 mod 19. Thus, any integer x that is congruent to 15 modulo 19 will satisfy the congruence. We can, of course, check our answer by substituting 15 into the original congruence: 4 · 15 = 60 ≡ 3 mod 19. Example 9.4 Solve the congruence x2 + 2x − 1 ≡ 0 mod 7. Solution: This is not a linear congruence, but it illustrates an important principle. Since we’re not really sure how to approach this congruence, we can just try x = 0, x = 1, . . . , x = 6. In general, to solve a congruence modulo m, we can just try each value 0, 1, . . . , m − 1 for each variable. For the congruence x2 + 2x − 1 ≡ 0 mod 7, we ﬁnd the solutions x ≡ 2 mod 7 and x ≡ 3 mod 7. Of course, there are other solutions, such as x ≡ 9 mod 7, but we note that 9 and 2 are not really diﬀerent solutions since they are congruent modulo 2. When we are asked to “ﬁnd all solutions of a congruence,” we mean that we wish to ﬁnd all incongruent solutions, i.e. all solutions that are not congruent to one another. Example 9.5 Solve the congruence x2 ≡ 3 mod 4. Solution: x modulo 4 x2 modulo 4 0 0 1 1 2 0 3 1 Thus, the congruence x2 ≡ 3 mod 4 has no solutions. Consider the linear congruence equation ax ≡ b mod m. 57 Stanford University EPGY Number Theory We would like to determine when this congruence has a solution, and when the solution is unique. When there is only one solution modulo m, we say that this solution is unique. Before we begin the general theory, let’s look at a few examples. Example 9.6 Solve the congruence 6x ≡ 15 mod 514. Solution: If x is a solution of this congruence, then 514 | (6x − 15). Note that 514 is even, and 6x is even and 15 is odd, so 6x − 15 is odd. Thus, 6x − 15 cannot be divisible by the number 514, so the congruence has no solutions. Observe (for future reference) that gcd(6, 514) = 2 and 2 ∤ 15. Example 9.7 Solve the congruence 3x ≡ 5 mod 7. Solution: We try x = 0, 1, 2, 3, 4, 5, 6, and ﬁnd that x ≡ 4 mod 7 is the unique solution to this congruence. Observe (for future reference) that gcd(3, 7) = 1 and 1 ∤ 5. Example 9.8 Solve the congruence 9x ≡ 15 mod 21. Solution: We try x = 0, 1, 2, . . . , 21, and ﬁnd that x ≡ 4, 11, 18 mod 21 are three incongruent solutions to this congruence. Observe (for future reference) that gcd(9, 21) = 3 and 3 | 15. Example 9.9 Suppose that we wish to solve an arbitrary linear congruence of the form ax ≡ b mod m. Then we must ﬁnd an integer x so that m | (ax − b). Equivalently, we must ﬁnd an integer y so that my = ax − b, which we can rewrite as ax − my = b. 58 Stanford University EPGY Number Theory Now, this type of equation should look familiar, as it is precisely the type of equation that we solved in Chapter 5. Let g = (a, m). We know that every number of the form ax − my is a multiple of g (since g | a and g | m), so if g ∤ b, then ax−my = b has no solutions. Thus, if g = (a, m) ∤ b, then the congruence ax ≡ b mod m has no solutions. Next, suppose that g | b. By Theorem 5.1, we know that there exist integers u and v such that au + mv = g. Now, since g | b, we can multiply this equation by the integer b/g to obtain the equation a bu g + m bv g = b. This implies that m | a bu g − b, so abu g ≡ b mod m. Thus, x0 ≡ bu g mod m is a solution to the congruence ax ≡ b mod m. Thus, we have shown that if g = (a, m) | b, then x0 ≡ bu g mod m is a solution of the congruence. At this point, it is natural to consider whether or not this x0 is the only solution of the congruence. Suppose that x1 is some other solution of the congruence ax ≡ b mod m. Then ax1 ≡ ax0 mod m, so m | (ax1 − ax0) = a(x1 − x0). This implies that m g divides a(x1 − x0) g . Now, (a, m) = g, so ( a g , m g ) = 1. Thus, a/g and m/g have no common factors, so m/g must divide x1 − x0. So there is an integer k such that k m g = x1 − x0, 59 Stanford University EPGY Number Theory or x1 = x0 + k m g . Finally, recall that any two solutions that diﬀer by a multiple of m are considered to be the same, so there will be exactly g diﬀerent solutions that are obtained by taking k = 0, 1, . . . , g − 1. Note that if g = (a, m) = 1, then there will be exactly one solution of the congruence a ≡ b mod m. We summarize these results in the following theorem. Theorem 9.1 Solutions of Linear Congruences. Let a, b, and m be integers with m ≥ 1. Let g = (a, m). (a) If g ∤ b, then the congruence ax ≡ b mod m has no solutions. (b) If g | b, then the congruence ax ≡ b mod m has g incongruent solutions. To ﬁnd the solutions, ﬁrst ﬁnd integers u and v that satisfy au + mv = g. As described in Chapter 5, the Euclidean algorithm can be used to ﬁnd such integers u and v. Then x0 = bu g is one solution to ax ≡ b mod m. A complete set of g incongruent solutions is given by x ≡ x0 + k m g mod m for k = 0, 1, 2, . . . , g − 1. Example 9.10 Find all solutions of the congruence 943x ≡ 381 mod 2576. Solution: g = (943, 2576) = 23 ∤ 381, so the congruence has no solutions. Example 9.11 Find all solutions of the congruence 8x ≡ 7 mod 13. Solution: g = (8, 13) = 1, so there is g = 1 solution of the congruence. Notice that we are able to determine the number of solutions without having computed the solution! To ﬁnd the solution, we ﬁrst ﬁnd integers u and v so that 8u + 13v = 1. Using methods from Chapter 5, we ﬁnd the solution u = 5 and v = −3. Thus, x0 = 7 · 5 1 = 35 ≡ 9 mod 13 60 Stanford University EPGY Number Theory is a solution of the congruence. Example 9.12 Find all solutions of the congruence 6x ≡ 9 mod 15. Solution: g = (6, 15) = 3 | 9, so there are g = 3 incongruent solutions of the congruence. Notice that we are able to determine the number of solutions without having computed any of them! To ﬁnd the solutions, we ﬁrst ﬁnd integers u and v so that 6u + 15v = 3. Using methods from Chapter 5, we ﬁnd the solution u = −2 and v = 1. Thus, x0 = 9 · −2 3 = −6 ≡ 9 mod 15. is a solution of the congruence. To obtain all of the solutions, we start with x0 = 9 and add multiples of the quantity 15 3 = 5. The 3 incongruent solutions are 9, 14, 4. Finally, we consider the situation in which we have more than one congruence equa- tion in one unknown. Example 9.13 Solve the system of congruences x ≡ 2 mod 4 x ≡ 1 mod 6. Solution: There is no common solution to both congruences since the ﬁrst congru- ence requires x to be odd and the second requires x to be even. Example 9.14 Solve the system of congruences x ≡ 2 mod 4 x ≡ 3 mod 5. Solution: By inspection, we note that x = 18 is a common solution. To ﬁnd all solutions of the system, we proceed as follows. The ﬁrst congruence is satisﬁed by x if and only if 4 | (x − 2), 61 Stanford University EPGY Number Theory i.e. if and only if there exists an integer k such that x = 2 + 4k. Substituting this in the second congruence, we obtain 2 + 4k ≡ 3 mod 5, which we rewrite as 4k ≡ 1 mod 5. Next, we observe that k ≡ 1 mod 5 is the only solution of this congruence. Thus, k is a solution of 2 + 4k ≡ 3 mod 5 if and only if k can be written in the form k = 4 + 5j, where j is an integer. Thus, x satisﬁes both congruences if and only if there is an integer j such that x = 2 + 4(4 + 5j) = 20j + 18. Thus, the unique solution of the system of congruences is x ≡ 18 mod 20. The situation that we observed here is an example of a more general result, as described in the following theorem. Theorem 9.2 If (m, n) = 1, then the congruences x ≡ a mod m x ≡ b mod n have a unique common solution modulo mn. Proof. The ﬁrst congruence has a solution x if and only if m | (x − a), i.e. if and only if there exists an integer k such that x = a + mk. Then the second congruence becomes mk ≡ (b − a) mod n. Since (m, n) = 1, this congruence has a unique solution modulo n, say k ≡ c mod n. 62 Stanford University EPGY Number Theory Thus, k satisﬁes mk ≡ (b − a) mod n if and only if there exists an integer j such that k = c + nj, where j is an integer. Thus, x = a + mk = a + m(c + nj) = a + mc + mnk ≡ a + mc mod mn. All solutions are congruent to (a+mc) mod mn, so there is a unique solution modulo mn. This result is actually a special case of a more general theorem. Sun Tzu (or Sun Zi) was a Chinese mathematician, and is known for authoring Sun Tzu Suan Ching (literally “Sun Tzu’s Calculation Classic”) in the third-fourth century AD, which contains the Chinese Remainder Theorem. The following problem was posed: How many soldiers are there in Han Xing’s army? If you let them parade in groups of 3 soldiers, there are 2 left over. If they parade in rows of 5, there are 3 left over. If they parade in rows of 7, there are 2 left over. Theorem 9.3 Chinese Remainder Theorem. Let m1, m2, . . . , mk be positive integers which are relatively prime in pairs. Then the k congruences x ≡ a1 mod m1 x ≡ a2 mod m2 · · · x ≡ ak mod mk have a unique solution modulo (m1m2 · · · mk). Example 9.15 Find a number n such that when divided by 4 leaves remainder 2, when divided by 5 leaves remainder 1, and when divided by 7 leaves remainder 1. Solution: We want n such that n ≡ 2 mod 4, n ≡ 1 mod 5, n ≡ 1 mod 7. This implies that 35n ≡ 70 mod 140, 28n ≡ 28 mod 140, 20n ≡ 20 mod 140. We have n ≡ 3(35n − 28n) − 20n ≡ 3(70 − 28) − 20 ≡ 106 mod 140. Thus all n ≡ 106 mod 140 satisfy the given conditions. 63 Stanford University EPGY Number Theory Problem Set 1. Find all incongruent solutions to each of the following congruences. (a) 7x ≡ 3 mod 15 (b) 6x ≡ 5 mod 15 (c) x2 ≡ 1 mod 8 (d) x2 ≡ 2 mod 7 (e) x2 ≡ 3 mod 7 (f) 8x ≡ 6 mod 14 (g) 66x ≡ 100 mod 121 (h) 21x ≡ 14 mod 91 2. Determine the number of incongruent solutions for each of the following con- gruences. You need not write down the actual solutions. (a) 893x ≡ 266 mod 2432 (b) 72x ≡ 47 mod 200 (c) 4183x ≡ 5781 mod 15087 (d) 1537x ≡ 2863 mod 6731 3. Solve each of the following systems of congruences. (a) x ≡ 2 mod 3 x ≡ 3 mod 4 (b) x ≡ 7 mod 9 x ≡ 13 mod 23 x ≡ 1 mod 2 (c) 2x ≡ 3 mod 5 4x ≡ 3 mod 7 64 Stanford University EPGY Number Theory 4. Find all incongruent solutions (or show that there are none) to 4x + y ≡ 6 mod 12, x + 4y ≡ 2 mod 12. 5. Find all incongruent solutions to 3x + 4y ≡ 1 mod 7. 6. Find all incongruent solutions to 3x + 7y ≡ 2 mod 8. 7. Find all positive integers less than 1000 which leave remainder 1 when divided by 2, 3, 5, and 7. 8. A multiplication has been performed incorrectly, but the answer is correct mod 9, mod 10, and mod 11. What is the closest that the incorrect result can possibly be to the correct result? 9. The following multiplication was correct, but there is an x in place of a digit in the answer: 172195 · 572167 = 985242x6565. Find x without redoing the multiplication. 10. Show that an integer is divisible by 4 if and only if the number left when all digits other than the last two are eliminated is divisible by 4. Use this rule to ﬁnd conditions for divisibility by 12. 11. Show that every integer satisﬁes at least one of the following six congruences: x ≡ 0 mod 2, x ≡ 0 mod 3, x ≡ 1 mod 4, x ≡ 1 mod 6, x ≡ 3 mod 8, and x ≡ 11 mod 12. 12. Prove the Chinese Remainder Theorem by induction. 13. Do there exist fourteen consecutive positive integers each of which is divisible by one or more primes p, 2 ≤ p ≤ 11? 14. Do there exist twenty-one consecutive integers each of which is divisible by one or more primes p, 2 ≤ p ≤ 13? 15. Let a, b, c be pairwise relatively prime integers. Show that 2abc − ab − bc − ca is the largest integer not of the form bcx + acy + abz, x ≥ 0, y ≥ 0, z ≥ 0. 16. What is the largest positive integer that is not the sum of a positive integral multiple of 42 and a positive composite integer? 65 Chapter 10 Fermat’s Little Theorem Let p be a prime number, and let a be any positive integer such that a ̸≡ 0 mod p. In this section, we will consider powers of a (i.e. a, a 2, a 3, . . .) modulo p. Example 10.1 (a) Let p = 3. Compute a, a 2, a 3 modulo 3 for a ≡ 0, 1, 2 mod 3. a a 2 a3 0 1 2 (b) Let p = 5. Compute a, a 2, a 3, a 4, a 5 modulo 5 for a ≡ 0, 1, 2, 3, 4 mod 5. a a 2 a 3 a4 a5 0 1 2 3 4 (c) Let p = 7. Compute a, a 2, a 3, a 4, a 5, a 6, a 7 modulo 7 for a ≡ 0, 1, 2, 3, 4, 5, 6 mod 7. a a 2 a3 a4 a5 a 6 a 7 0 1 2 3 4 5 6 66 Stanford University EPGY Number Theory (d) Based on the numerical evidence in these tables, we conjecture that ap−1 ≡ 1 mod p and that a p ≡ a mod p for all a ̸≡ 0 mod p. Create a similar table for p = 11 and observe that for a = 1, 2, . . . , 10, we have a10 ≡ 1 mod 11 and a 11 ≡ a mod 11. Example 10.2 (a) Let p = 5 and a = 2. Compute the numbers a, 2a, 3a, 4a mod 5 and compare to the list of numbers 1, 2, 3, 4. Repeat with a = 3, 4. (b) Letp = 7 and a = 2. Compute the numbers a, 2a, 3a, 4a, 5a, 6a mod 7 and compare to the list of numbers 1, 2, 3, 4, 5, 6. Repeat with a = 3, 4, 5, 6. Theorem 10.1 Fermat’s Little Theorem. Let p be a prime number, and let a be any number such that a ̸≡ 0 mod p. Then a p−1 ≡ 1 mod p. Proof. We will need the following result to prove Fermat’s Little Theorem: Lemma 10.2 Let p be a prime number, and let a be any number such that a ̸≡ 0 mod p. Then the numbers a, 2a, 3a, . . . , (p − 1)a mod p are the same as the numbers 1, 2, 3, . . . , (p − 1) mod p, although they may be in a diﬀerent order. Proof of the Lemma. First, observe that the list a, 2a, 3a, . . . , (p − 1)a contains p − 1 numbers, and none of them are divisible by p. Next, suppose that two numbers, say ja and ka, in the list a, 2a, 3a, . . . , (p − 1)a 67 Stanford University EPGY Number Theory are congruent modulo p. Then ja ≡ ka mod p, so p | (ja − ka) = (j − k)a. Since a ̸≡ 0 mod p, p ∤ a, so p | (j − k) by Theorem 6.1. On the other hand, we know that 1 ≤ j, k ≤ p − 1, so |j − k| < p − 1. However, there is only one number with absolute value less than p − 1 that is divisible by p, and that number is zero. Thus, j − k = 0, so j = k. We can conclude, therefore, that diﬀerent multiples in the list a, 2a, 3a, . . . , (p − 1)a are distinct modulo p. Thus, the list a, 2a, 3a, . . . , (p − 1)a contains p − 1 distinct non-zero values modulo p. However, there are only p − 1 distinct nonzero values modulo p, namely 1, 2, 3, . . . , (p − 1). We conclude that the list a, 2a, 3a, . . . , (p − 1)a mod p must contain the same numbers as the list 1, 2, 3, . . . , (p − 1), though the numbers may appear in a diﬀerent order. This ﬁnishes the proof of Lemma 10.2. We can now use Lemma 10.2 to prove Fermat’s Little Theorem. Since the lists of numbers a, 2a, 3a, . . . , (p − 1)a mod p and 1, 2, 3, . . . , (p − 1) are the same, the product of the numbers in the ﬁrst list is equal to the product of the numbers in the second list: a · 2a · 3a · · · (p − 1)a ≡ 1 · 2 · 3 · · · (p − 1) mod p. We can rewrite this equivalence as ap−1(p − 1)! ≡ (p − 1)! mod p. Finally, note that gcd((p − 1)!, p) = 1, so by Theorem 7.5, we can cancel the (p − 1)! from both sides to obtain Fermat’s Little Theorem: ap−1 ≡ 1 mod p. Note that we can multiply both sides by a to obtain a p ≡ a mod p. 68 Stanford University EPGY Number Theory Example 10.3 Show that 23 | (6 22 − 1). Solution: By Fermat’s Little Theorem, 6 22 ≡ 1 mod 23. Example 10.4 Compute 2 35 mod 7. Solution: By Fermat’s Little Theorem, 2 6 ≡ 1 mod 7. Thus we have: 2 35 ≡ 2 302 5 mod 7 ≡ (2 6) 52 5 mod 7 ≡ 2 5 mod 7 ≡ 4 mod 7. Example 10.5 Show that 341 | (2 341 − 2). Solution: Observe that 341 = 11 · 31. We’ll show that both 11 and 31 are divisors of 2 341 − 2. By Fermat’s Little Theorem, 2 10 ≡ 1 mod 11. Thus, 2 341 ≡ 2(2 10) 34 ≡ 2 mod 11. Thus, 11 | (2 341 − 2). Now, 2 5 ≡ 1 mod 31. Thus, 2 341 ≡ 2(2 5) 68 ≡ 2 mod 31. Thus, 31 | (2 341 − 2). Since (11, 31) = 1, their product also divides 2 341 − 2, i.e. 341 | (2 341 − 2). 69 Stanford University EPGY Number Theory Example 10.6 Let a1 = 4, an = 4 an−1, n > 1. Find the remainder when a100 is divided by 7. Solution: By Fermat’s Little Theorem, 4 6 ≡ 1 mod 7. Now, 4 n ≡ 4 mod 6 for all positive integers n, i.e., 4 n = 4 + 6t for some integer t. Thus a100 ≡ 4 a99 ≡ 4 4+6t ≡ 4 4 · (4 6) t ≡ 4 mod 7. For the second equivalence above, we have used the fact that a99 = 4 k for some integer k, so a99 = 4 + 6t for some integer t. Example 10.7 Fermat’s Little Theorem can be used to show that a number is not prime without actually factoring it. For example, it can be shown that 2 1234566 ≡ 899557 ̸≡ 1 mod 1234567. Thus, the number 1234567 cannot be a prime, since if it were, then Fermat’s Little Theorem would tell us that 21234566 must be congruent to 1 modulo 1234567. Example 10.8 Solve the congruence x103 ≡ 4 mod 11. Solution: By Fermat’s Little Theorem, x10 ≡ 1 mod 11. Thus, x103 ≡ x100x3 ≡ x3 mod 11. So, to solve the original congruence, we only need to solve x3 ≡ 4 mod 11. We can do this by trying successively x = 0, 1, 2, . . . , 10. We ﬁnd the solution x ≡ 5 mod 11. Example 10.9 Does Fermat’s Little Theorem apply to composite integers? Com- pute 2 8 mod 9, 3 7 mod 8, and 2 14 mod 15. Theorem 10.3 Existence and Uniqueness of Inverses. Suppose that (a, m) = 1. Then there exists a unique integer x such that ax ≡ 1 mod m. Proof. Observe that we must prove both existence and uniqueness. To prove exis- tence, (a, m) = 1 implies that there exist integers x and y such that ax + my = 1. Thus, my = 1 − ax ⇒ m | (1 − ax) ⇒ m | (ax − 1) ⇒ ax ≡ 1 mod m. 70 Stanford University EPGY Number Theory To prove uniqueness, suppose that there exist two integers x1 and x2 such that ax1 ≡ ax2 ≡ 1 mod m. Since (a, m) = 1, x1 ≡ x2 mod m. Thus, a has a unique inverse mod m. Example 10.10 Compute (p−1)! mod p for p = 2, 3, 5, 7, 11, 13. Make a conjecture about the value of (p − 1)! mod p. Theorem 10.4 Wilson’s Theorem. Suppose that p is a prime number. Then (p − 1)! ≡ (p − 1) mod p. Proof. Observe that (p − 1)! = (p − 1)(p − 2)(p − 3) · · · (2)(1). By the previous theorem, each integer 1, 2, 3, . . . , p − 2, p − 1 has a unique inverse modulo p. Note that 1 · 1 ≡ 1 mod p and (p − 1) · (p − 1) ≡ 1 mod p, so 1 and p − 1 are their own inverses. Moreover, we have seen that 1 and p − 1 are the only x that satisfy x2 ≡ 1 mod p. Thus, each integer between 2 and p − 2 has a unique inverse in the list 2, 3, . . . , p − 3, p − 2. Pairing each integer with its inverse modulo p, we obtain (p − 1)! ≡ (p − 1)(p − 2)(p − 3) · · · (3)(2)(1) mod p ≡ (p − 1) · 1 · 1 · · · 1 mod p ≡ (p − 1) mod p. 71 Stanford University EPGY Number Theory Problem Set 1. Compute 9 794 modulo 73. 2. Show that 91 is not prime by computing 2 90 modulo 91. 3. Compute 2 7 modulo 7. 4. Compute 10 7 modulo 7. 5. Find all integers x such that x86 ≡ 6 mod 29. 6. Find all integers x such that x39 ≡ 3 mod 13. 7. If p is a prime number and if a ̸≡ 0 mod p, then Fermat’s Little Theorem tells us that ap−1 ≡ 1 mod p. (a) The congruence 7 1734250 ≡ 1660565 mod 1734251 is true. Can you conclude that 1734251 is composite? (b) The congruence 129 64026 ≡ 15179 mod 64027 is true. Can you conclude that 64027 is composite? (c) The congruence 2 52632 ≡ 1 mod 52633 is true. Can you conclude that 52633 is prime? 8. (a) Let p be a prime number. Show that p | (2 p − 2). (b) The ancient Chinese knew this result, and also believed that the converse was true. The converse states that if n > 1 and n | (2 n − 2), then n is a prime number. It is probable that the Chinese observed this experimentally, but did not attempt to prove the conjecture. However, we know that the conjecture is wrong. For example, we have seen that 341 | (2 341 − 2), but 341 = 11 · 31 is not prime. We say that a composite integer n such that n | (2 n − 2) is a pseudoprime. There are inﬁnitely many pseudoprimes. Show that 561 = 3 · 11 · 17 is a pseudoprime. 9. Recall Wilson’s Theorem: If p is a prime number, then (p − 1)! ≡ (p − 1) mod p. Compute the value of (m − 1)! mod m for some small values of m that are not prime. Do you observe any patterns? If you know the value of (n − 1)! mod n, how can you use this value to determine whether n is prime or composite? 72 Stanford University EPGY Number Theory 10. Find all primes p such that p | (2 p + 1). 11. If (mn, 42) = 1, prove that 168 | (m6 − n6). 12. If p is an odd prime prove that np ≡ n mod 2p for all integers n. 13. If p is an odd prime and p | (mp + np) prove that p2 | (mp + np). 14. Prove that 19 | (2 26k+2 + 3) for all integers k ≥ 0. 15. Prove that if p is an odd prime 1 2 · 3 2 · · · (p − 2) 2 ≡ 2 2 · 4 2 · · · (p − 1) 2 ≡ (−1) (p+1)/2 mod p. 16. Show that if p is a prime, a is an integer, and k is a nonnegative integer, then a 1+k(p−1) ≡ a mod p. 17. Show that if n is odd and a is an integer, then a n ≡ a mod 3. 73 Chapter 11 Euler’s Phi-Function and The Euler-Fermat Theorem Deﬁnition 11.1 For n ≥ 1, let ϕ(n) denote the number of positive integers that are less than or equal to n and relatively prime to n. Example 11.1 ϕ(6) = 2 since 1 and 5 are the only integers that are less than or equal to 6 and relatively prime to 6. Example 11.2 Find the value of ϕ(m) for each m in the table below. m 1 2 3 4 5 6 7 8 9 10 ϕ(m) Theorem 11.1 For any prime p, ϕ(p) = p − 1 since every positive integer less than a prime p is relatively prime to p. Example 11.3 1. Let m = 6. Compute aϕ(m) mod m for a = 1, 5. 2. Let m = 9. Compute a ϕ(m) mod m for a = 1, 2, 4, 5, 7, 8. 3. Let m = 10. Compute a ϕ(m) mod m for a = 1, 3, 7, 9. Based on the numerical evidence that we obtained in the previous example, we conjecture the following. Theorem 11.2 Euler-Fermat Theorem. If (a, m) = 1, then a ϕ(m) ≡ 1 mod m. 74 Stanford University EPGY Number Theory Proof. The proof of the Euler-Fermat theorem is very similar to the proof of Fer- mat’s Little Theorem, and will be left to you to complete as an exercise. Note that Fermat’s Little Theorem is actually a special case of the Euler-Fermat Theorem: If p is a prime number, then ϕ(p) = p − 1. To use the Euler-Fermat Theorem in problems and applications, we need an eﬃcient method for computing ϕ(m) for arbitrary (i.e. not necessarily prime) integers m. If m is small, then it is fairly easy to ﬁnd all the numbers less than or equal to m that are relatively prime to m. However, if m is large, then we do not want to have to write down all integers less than or equal to m and determine whether or not they are relatively prime to m. We’ll begin by considering powers of primes. Theorem 11.3 If p is a prime number, then ϕ(pk) = pk − pk−1 = pk−1(p − 1) = pk (1 − 1 p ) . Proof. By deﬁnition, ϕ(pk) is the number of integers less than or equal to pk that are relatively prime to pk. There are pk integers less than or equal to pk. Thus, ϕ(pk) = pk − (number of integers ≤ pk that are not relatively prime to pk. The integers less than or equal to pk that are not relatively prime to pk are precisely those that are divisible by p. There are pk−1 such integers: 1 · p, 2 · p, 3 · p, . . . , p · pk−1. Thus, ϕ(pk) = pk − pk−1 = pk−1(p − 1) = pk (1 − 1 p ) . Finally, we’ll consider general composite numbers. Example 11.4 1. Compute ϕ(6), ϕ(2), and ϕ(3). How do these values relate to one another? 2. Compute ϕ(10), ϕ(2), and ϕ(5). How do these values relate to one another? 3. Compute ϕ(30), ϕ(5), and ϕ(6). How do these values relate to one another? 4. Compute ϕ(72), ϕ(8), and ϕ(9). How do these values relate to one another? Theorem 11.4 If (a, b) = 1, then ϕ(ab) = ϕ(a)ϕ(b). 75 Stanford University EPGY Number Theory Proof. Let n be a natural number with n = ab, (a, b) = 1. We arrange the ab integers 1, 2, . . . , ab as follows. 1 2 3 . . . k . . . a a + 1 a + 2 a + 3 . . . a + k . . . 2a 2a + 1 2a + 2 2a + 3 . . . 2a + k . . . 3a . . . . . . . . . . . . . . . . . . . . . (b − 1)a + 1 (b − 1)a + 2 (b − 1)a + 3 . . . (b − 1)a + k . . . ba Now, an integer r is relatively prime to m if and only if it is relatively prime to a and b. We shall determine ﬁrst the number of integers in the above array that are relatively prime to a and ﬁnd out how may of them are also relatively prime to b. There are ϕ(a) integers relatively prime to a in the ﬁrst row. Now consider the k-th column, 1 ≤ k ≤ a. Each integer on this column is of the form ma + k, 0 ≤ m ≤ b − 1. As k ≡ ma + k mod a, k will have a common factor with a if and only if ma + k does. This means that there are exactly ϕ(a) columns of integers that are relatively prime to a. We must determine how many of these integers are relatively prime to b. We claim that no two integers k, a + k, 2a + k, . . . , (b − 1)a + k on the k-th column are congruent modulo b. Suppose that (ia + k) ≡ (ja + k) mod b. Then a(i − j) ≡ 0 mod b. Thus, b | a(i − j), so b | a or b | (i − j). Since (a, b) = 1, b ∤ a. Thus, b | (i − j), so (i − j) ≡ 0 mod b. Now i, j ∈ [0, b − 1] which implies that |i − j| < b. However, the only integer (i − j) such that |i − j| < b and b | (i − j) is 0. This forces i − j − 0, so i = j. This means that the b integers in any of these ϕ(n) columns are, in some order, congruent to the integers 0, 1, . . . , b − 1. But exactly ϕ(b) of these are relatively prime to b. This means that exactly ϕ(a)ϕ(b) integers on the array are relatively prime to ab, so ϕ(n) = ϕ(ab) = ϕ(a)ϕ(b). Note. We say that a function f : Z + → R is multiplicative if f (mn) = f (m)f (n) for every pair of integers m, n such that (m, n) = 1. Thus, Theorem 11.4 says that Euler’s phi-function is multiplicative. Using Theorems 11.3 and 11.4, we can now obtain a general formula for ϕ(n). Theorem 11.5 Let n = pa1 1 pa2 2 · · · pam m 76 Stanford University EPGY Number Theory be the prime factorization of n, where p1, p2, . . . , pm are distinct primes and a1, a2, . . . , am are integers greater than or equal to 1. Then ϕ(n) = (pa1 1 − pa1−1 1 ) (pa2 2 − pa2−1 2 ) · · · (pam m − pam−1 m ) = n (1 − 1 p1 ) ( 1 − 1 p2 ) · · · (1 − 1 pm ) . Example 11.5 Find ϕ(100). Solution: We do not need to list the integers less than or equal to 100 and deter- mine which are relatively prime to 100. Instead, we use Theorem 11.5. The prime factorization of 100 is 100 = 2 25 2. Thus, ϕ(100) = 100 (1 − 1 2 ) ( 1 − 1 5 ) = 40. Example 11.6 Find inﬁnitely many integers n such that 10 | ϕ(n). Solution: Take n = 11 k for k = 1, 2, . . .. Then ϕ(11 k) = 11k − 11 k−1 = 10 · 11 k−1, so 10 | ϕ(11 k) for all integers k ≥ 1. Example 11.7 Find the last two digits of 3 1000. Solution: To ﬁnd the last two digits of 3 1000, we need to compute 3 1000 modulo 100. We know that ϕ(100) = ϕ(2 2)ϕ(5 2) = 40, so by the Euler-Fermat Theorem, 3 40 ≡ 1 mod 100. Thus, 3 1000 = (3 40) 25 ≡ 1 25 = 1 mod 100, so the last two digits are 01. 77 Stanford University EPGY Number Theory Example 11.8 Find the last 2 digits of 7 71000. Solution: Note that 740 ≡ 1 mod 100. Now, ϕ(40) = 16, so 7 16 ≡ 1 mod 40 7 1000 ≡ (7 16) 627 8 mod 40 ≡ 7 8 ≡ (7 4) 2 ≡ 1 mod 40 Thus, 40 | 7 1000 − 1, so there exists an integer t such that 7 1000 = 40t + 1. Thus, 7 71000 = 7 40t+1 ≡ 7 mod 100. 78 Stanford University EPGY Number Theory Problem Set 1. Find the value of ϕ(20). 2. Find the value of ϕ(60). 3. Find the value of ϕ(63). 4. Find the value of ϕ(97). 5. Find the value of ϕ(341). 6. Find the value of ϕ(561). 7. Find the value of ϕ(8800). 8. Show that if n is odd, then ϕ(2n) = ϕ(n). 9. Show that if n is even, then ϕ(2n) = 2ϕ(n). 10. Let x be the smallest positive integer such that 2 x ≡ 1 mod 63. Find x, and verify that x | ϕ(63). 11. Find the last three digits of 7 9999. 12. (a) The positive divisors of 6 are 1, 2, 3, and 6. Compute ϕ(1) + ϕ(2) + ϕ(3) + ϕ(6). (b) The positive divisors of 8 are 1, 2, 4, and 8. Compute ϕ(1) + ϕ(2) + ϕ(4) + ϕ(8). (c) The positive divisors of 9 are 1, 3, and 9. Compute ϕ(1) + ϕ(3) + ϕ(9). (d) Let n ≥ 1. Make a conjecture about the value of ∑ d|n ϕ(d), where the sum is taken over all of the divisors d of n. Try to prove that your conjecture is correct. To prove that your conjecture is correct, it may be useful to use the result of the next problem. 13. Recall that a function f is said to be multiplicative if f (mn) = f (m)f (n) for all integers m and n such that (m, n) = 1. We know that Euler’s ϕ-function is multiplicative. Suppose that f is a multiplicative function, and deﬁne a new function g(n) as follows: g(n) = f (d1) + f (d2) + · · · + f (dr), where d1, d2, . . . , dr are the divisors of n. Show that g(n) is multiplicative. 79 Stanford University EPGY Number Theory 14. What can you say about n if the value of ϕ(n) is a prime number? What if the value of ϕ(n) is the square of a prime number. 15. Find at least ﬁve diﬀerent numbers n such that ϕ(n) = 160. 16. Suppose that the integer n satisﬁes ϕ(n) = 1000. Make a list of all the primes that might possibly divide n. Use this information to ﬁnd all integers n that satisfy ϕ(n) = 1000. 17. Find all values of n that satisfy each of the following equations: (a) ϕ(n) = n/2 (b) ϕ(n) = n/3 (c) ϕ(n) = n/6 18. Find the remainder of 10 10 + 10 102 + · · · + 10 1010 upon division by 7. 19. (a) For each integer 2 ≤ a ≤ 10, ﬁnd the last four digits of a 1000. (b) Based on your experiments in (a), and further experiments if necessary, give a simple criterion that allows you to predict the last four digits of a 1000 from the value of a. (c) Prove that your criterion in (b) is correct. 20. Show that for all natural numbers s, there is an integer n divisible by s such that the sum of the digits of n is equal to s. 21. Prove that 504 | (n9 − n3) for all integers n ≥ 1. 22. Prove that for any odd integer n > 0, n | (2 n! − 1). 23. Prove that for every natural number n there exists some power of 2 whose ﬁnal n digits are all ones and twos. 24. Prove that there exists a positive integer k such that k · 2 n + 1 is composite for every positive integer n. 25. Suppose that p and q are diﬀerent odd primes and that a is an integer such that (a, pq) = 1. Show that a ϕ(pq)/2 ≡ 1 mod pq. 26. Show that if n > 2, then 2 | ϕ(n). 27. In this series of exercises, you will prove the Euler-Fermat Theorem. Let n be an integer greater than or equal to 1, and let a be an integer such that (a, n) = 1. Let 1 = b1 < b2 < · · · < bϕ(n) < n be the ϕ(n) numbers between 0 and n that are relatively prime to n. 80 Stanford University EPGY Number Theory (a) Show that the numbers b1a, b2a, . . . , bϕ(n)a mod n are the same as the numbers b1, b2, . . . , bϕ(n) mod n, although they may be in a diﬀerent order. (b) Show that (b1a) · (b2a) · · · (bϕ(n)a) ≡ b1 · b2 · · · bϕ(n) mod n. (c) Conclude that a ϕ(n) ≡ 1 mod n. 28. Liouville’s lambda function λ(n) is deﬁned by factoring n into a product of primes, n = pk1 1 pk2 2 · · · pkr r and then setting λ(n) = (−1) k1+k2+···kr. We deﬁne λ(1) = 1. For example, to compute λ(1728), we factor 1728 = 2 63 3, and obtain λ(1728) = (−1) 6+3 = −1. (a) Compute the following: λ(30); λ(504); λ(60750). (b) We use Liouville’s lambda function to deﬁne a new function G(n) by the formula G(n) = λ(d1) + λ(d2) + · · · + λ(dr), where d1, d2, . . . , dr are the divisors of n. Compute the value of G(n) for all 1 ≤ n ≤ 18. (c) Use your computations in (b), and additional computations if necessary, to make a conjecture for the value of G(n). Prove that your conjecture is correct. 29. Recall that a function f is said to be multiplicative if f (mn) = f (m)f (n) for all integers m and n such that (m, n) = 1. Show that Liouville’s lambda function λ(n) is multiplicative. 81 Chapter 12 Primitive Roots We know by the Euler-Fermat Theorem that if (a, n) = 1, then a ϕ(n) ≡ 1 mod n, and that if p is a prime number, then a p−1 ≡ 1 mod p since ϕ(p) = p − 1. However, ϕ(n) may not be the smallest integer b such that ab ≡ 1 mod n. For example, by Fermat’s Little Theorem, we know that 2 6 ≡ 1 mod 7. However, 2 3 ≡ 1 mod 7 is the smallest power of 2 that is congruent to 1 modulo 7. On the other hand, there may be some values of a that require the full (p − 1)-st power. For example, the ﬁrst power of 3 that is congruent to 1 modulo 7 is 3 6. Let’s look at some more examples to try to deduce a pattern. For now, we’ll consider the case a b ≡ 1 mod p where p is a prime. Example 12.1 Complete the table below for p = 5. Let b denote the smallest integer such that ab ≡ 1 mod p. Recall that ϕ(5) = 5 − 1 = 4. a b such that a b ≡ 1 mod 5 1 2 3 4 82 Stanford University EPGY Number Theory Example 12.2 Complete the table below for p = 7. Let b denote the smallest integer such that ab ≡ 1 mod p. Recall that ϕ(7) = 7 − 1 = 6. a b such that a b ≡ 1 mod 7 1 2 3 4 5 6 Example 12.3 Complete the table below for p = 11. Let b denote the smallest integer such that ab ≡ 1 mod p. Recall that ϕ(11) = 11 − 1 = 10. a b such that ab ≡ 1 mod 11 1 2 3 4 5 6 7 8 9 10 Based on the numerical evidence in the tables above, we make the following obser- vations: 1. The smallest exponent b so that a b ≡ 1 mod p seems to divide ϕ(p) = p − 1. 2. There are always some values of a that require the full (p − 1)-st power. Deﬁnition 12.1 Suppose that a is a positive integer such that (a, p) = 1. The order of a modulo p is the smallest positive integer b such that a b ≡ 1 mod p, and we write b = ordp(a). 83 Stanford University EPGY Number Theory By Fermat’s Little Theorem, we know that ordp(a) ≤ ϕ(p) = p − 1. Theorem 12.1 Order Divisibility Property. Let a be an integer such that (a, p) = 1, and suppose that an ≡ 1 mod p. Then ordp(a) | n. In particular, ordp(a) | p − 1. Proof. By deﬁnition, a ordp(a) ≡ 1 mod p. Suppose that an ≡ 1 mod p. Let g = gcd(ordp(a), n). By Theorem 5.1, we know that there are integers u and v such that ordp(a)u − nv = g. Then, for any integer t, we have g = ordp(a)(u + nt) − n(v + ordp(a)t), and by choosing t to be suﬃciently large, both u+nt and v +ordp(a)t will be positive. Thus, there are integers r and s such that g = ordp(a)r − ns, where r and s are both positive (you will see why we need them to be positive soon). Next, we compute the quantity a ordp(a)r in two diﬀerent ways: a ordp(a)r = (a ordp(a))r ≡ 1 r ≡ 1 mod p aordp(a)r = ag+ns = a g (a n) s ≡ a g · 1 s ≡ a g mod p Thus, ag ≡ 1 mod p. Now, recall that ordp(a) is the smallest power of a that is congruent to 1 modulo p. Thus, ordp(a) ≤ g. 84 Stanford University EPGY Number Theory On the other hand, g = gcd(ordp(a), n), so g | ordp(a) and g | n. In particular, g ≤ ordp(a). We conclude that g = ordp(a), so ordp(a) | n. Finally, by Fermat’s Little Theorem, ap−1 ≡ 1 mod p, so ordp(a) | p − 1. Deﬁnition 12.2 If ordp(a) = p − 1, then a is called a primitive root modulo p. Example 12.4 Using the tables that we created for p = 5, 7, 11, we observe that 2 and 3 are primitive roots modulo 5; 3 and 5 are primitive roots modulo 7; and 2, 6, 7, and 8 are primitive roots modulo 11. Theorem 12.2 Primitive Root Theorem. Let p be a prime and suppose that d | (p − 1). Then there are exactly ϕ(d) distinct integers a modulo p such that ordp(a) = d. In particular, there are exactly ϕ(p − 1) primitive roots of p. We will not give a proof of the Primitive Root Theorem here. Example 12.5 The Primitive Root Theorem says that there are ϕ(10) = 4 primitive roots modulo 11. We have found that there are indeed 4 primitive roots modulo 11– namely, 2, 6, 7, and 8. Similarly, there are ϕ(36) = 12 primitive roots modulo 37 and ϕ(9906) = 3024 primitive roots modulo 9907. The following is an important property of primitive roots. Theorem 12.3 Suppose that g is a primitive root modulo a prime p. Then every nonzero number modulo p can be expressed as a power of g. More precisely, for any number 1 ≤ a < p, we can pick out exactly one of the numbers g, g2, g3, . . . , gp−3, gp−2, gp−1 as being congruent to a modulo p. 85 Stanford University EPGY Number Theory Proof. Since g is a primitive root modulo p, gp−1 ≡ 1 mod p, and p − 1 is the smallest integer b such that gb ≡ 1 mod p. Next, we claim that the numbers g, g2, g3, . . . , gp−3, gp−2, gp−1 are all distinct modulo p. If not, then there would be exponents i and j such that 1 ≤ i < j ≤ p − 1 such that gj ≡ gi mod p. Then p | (gj − gi) = gi(gj−i − 1). Thus, p | gi or p | gj−i − 1. We know that p ∤ gi since gcd(g, p) = 1. Thus, p | gj−i − 1, so gj−i ≡ 1 mod p, and j − i < p − 1. This is a contradiction since p − 1 is the smallest integer b such that gb ≡ 1 mod p. Thus, the numbers g, g2, g3, . . . , gp−3, gp−2, gp−1 are distinct modulo p, so any number a such that 1 ≤ a < p can be expressed as a power of g. Note that the Primitive Root Theorem tells us that there are exactly ϕ(p − 1) prim- itive roots modulo a given prime p. However, the theorem does not give us any information about how to ﬁnd the primitive roots or about which speciﬁc numbers will be primitive roots modulo a given prime p. A natural question is the following: given a number a, for which primes p is a a primitive root? For example, we ﬁnd that 2 is a primitive root for the primes p = 3, 5, 11, 13, 19, 29, 37, 53, 59, 61, 67, 83. Artin’s Conjecture. There are inﬁnitely many primes p such that 2 is a primitive root mod p. Theorem 12.4 Let p be a prime. The congruence x2 + 1 ≡ 0 mod p has solutions if p = 2 or if p ≡ 1 mod 4 but does not have any solutions if p ≡ 3 mod 4. 86 Stanford University EPGY Number Theory Proof. • When p = 2, x = 1 is a solution since 1 1 + 1 ≡ 0 mod 2. • Suppose that p ≡ 1 mod 4. Then 4 | (p−1), so by the Primitive Root Theorem, there is an integer a such that ordp(a) = 4. Thus, a 4 ≡ 1 mod p, so a4 − 1 ≡ (a 2 − 1)(a 2 + 1) ≡ 0 mod p. This implies that either a 2 − 1 ≡ 0 mod p or a2 + 1 ≡ 0 mod p. Note that a 2 − 1 ̸≡ 0 mod p since ordp(a) = 4. Thus, a 2 + 1 ≡ 0 mod p, so a is a solution of x2 + 1 ≡ 0 mod p. • Suppose that p ≡ 3 mod 4. Then 4 | (p − 3), so 4 ∤ (p − 1). Since p is odd, p − 1 is even, so 2 | (p − 1). Thus, (p − 1, 4) = 2. Now, suppose (by way of contradiction) that there is an integer a such that a2 + 1 ≡ 0 mod p. Then a4 ≡ (a 2) 2 ≡ (−1) 2 ≡ 1 mod p. By Fermat’s Little Theorem, we also know that a p−1 ≡ 1 mod p. Since 2 = (p − 1, 4), there are integers u and v such that 2 = (p − 1)s + 4t. Thus, we have a 2 ≡ a(p−1)s+4t ≡ (ap−1) s(a 4)t ≡ 1 mod p. Then a 2 ≡ 1 ≡ −1 mod p, 87 Stanford University EPGY Number Theory so 2 ≡ 0 mod p. This implies that p | 2, which is a contradiction since p is an odd prime. Thus, there is no integer a such that a 2 + 1 ≡ 0 mod p, so the congruence x2 + 1 ≡ 0 mod p does not have any solutions in this case. Finally, we note that the ideas of order and primitive roots can be extended to all (i.e. not necessarily prime) positive integers. Deﬁnition 12.3 Suppose that (a, n) = 1. The order of a modulo n is the smallest positive integer b such that ab ≡ 1 mod n. By the Euler-Fermat Theorem, we know that a ϕ(n) ≡ 1 mod n. Thus, ordn(a) ≤ ϕ(n). Using an argument similar to that given in the proof of Theorem 12.1, we can prove the following result. Theorem 12.5 Suppose that (a, n) = 1 and that a b ≡ 1 mod n. Then ordn(a) | b, and in particular, ordn(a) | ϕ(n). Deﬁnition 12.4 If (a, n) = 1 and ordn(a) = ϕ(n), then we say that a is a primitive root modulo p. Example 12.6 3 is a primitive root modulo 10 since ϕ(10) = 4 and 31 ≡ 3 mod 10, 3 2 ≡ 9 mod 10, 3 3 ≡ 7 mod 10, 3 4 ≡ 1 mod 10. 88 Stanford University EPGY Number Theory Problem Set 1. Compute each of the following. (a) ord5(3) (b) ord5(4) (c) ord7(3) (d) ord9(2) (e) ord15(2) (f) ord16(3) (g) ord10(3) 2. Find all primitive roots modulo 5. 3. Find all primitive roots modulo 7. 4. (a) Find all primitive roots modulo 13. (b) For each number d dividing 12, list the a’s such that 1 ≤ a < 13 and ord13(1) = d. 5. Find all primes less than 20 for which 3 is a primitive root. 6. In this exercise, you will investigate the value of ordn(2) for odd integers n. (a) Compute the value of ordn(2) for each odd number 3 ≤ n ≤ 19. (b) In the table below, the value of ordn(2) is given for all odd numbers between 21 and 115. ord21(2) = 6 ord23(2) = 11 ord25(2) = 20 ord27(2) = 18 ord29(2) = 28 ord31(2) = 5 ord33(2) = 10 ord35(2) = 12 ord37(2) = 36 ord39(2) = 12 ord41(2) = 20 ord43(2) = 14 ord45(2) = 12 ord47(2) = 23 ord49(2) = 21 ord51(2) = 8 ord53(2) = 52 ord55(2) = 20 ord57(2) = 18 ord59(2) = 58 ord61(2) = 60 ord63(2) = 6 ord65(2) = 12 ord67(2) = 66 ord69(2) = 22 ord71(2) = 35 ord73(2) = 9 ord75(2) = 20 ord77(2) = 30 ord79(2) = 39 ord81(2) = 54 ord83(2) = 82 ord85(2) = 8 ord87(2) = 28 ord89(2) = 11 ord91(2) = 12 ord93(2) = 10 ord95(2) = 36 ord97(2) = 48 ord99(2) = 30 ord101(2) = 100 ord103(2) = 51 ord105(2) = 12 ord107(2) = 106 ord109(2) = 36 ord111(2) = 36 ord113(2) = 28 ord115(2) = 44 Using your result from (a) and this table, ﬁnd a formula for ordmn(2) in terms of ordm(2) and ordn(2) when (m, n) = 1. Use your formula to ﬁnd ord11227(2). Note that 11227 = 103 · 109. 89 Stanford University EPGY Number Theory (c) Use your results from (a) and the table to ﬁnd a formula for ordpk(2) in terms of ordp(2) and k, where p is a prime. Use your formula to ﬁnd the value of ord68921(2). Note that 68921 = 41 3. 7. Let p be a prime number. (a) What is the value of (1 + 2 + 3 + · · · + (p − 1)) mod p? (b) What is the value of (1 2 + 2 2 + 3 2 + · · · + (p − 1) 2) mod p? (c) For any positive integer k, ﬁnd the value of (1 k + 2 k + 3 k + · · · + (p − 1) k) mod p. 8. Suppose that a and n are integers such that (a, n) = 1. Prove that ordn(a) | ϕ(n). Hint: see the proof of the Order Divisibility Property. 9. (a) If g is a primitive root modulo 37, which of the numbers g2, g3, . . . , g8 are also primitive roots modulo 37? (b) If g is a primitive root modulo p, develop an easy-to-use rule for determining if gk is a primitive root modulo p, and prove that your rule is correct. (c) Suppose that g is a primitive root modulo the prime p = 21169. Use your rule from (b) to determine which of the numbers g2, g3, . . . , g20 are primitive roots modulo 21169. 10. Suppose that p is a prime such that p ≡ 3 mod 4 and that a and b are integers such that a2 + b2 ≡ 0 mod p. Show that a ≡ b ≡ 0 mod p. 11. Show that if (a, 15) = 1, then aϕ(15)/2 ≡ 1 mod 15, and conclude that 15 has no primitive roots. Hint: Consider the congruence modulo 3 and modulo 5. 12. Show that 21 has no primitive roots. 13. Show that 35 has no primitive roots. 90 Stanford University EPGY Number Theory 14. Suppose that b and c are positive integers. Let d = (b, c). Suppose that ab ≡ 1 mod n and a c ≡ 1 mod n. Show that a d ≡ 1 mod n. 15. If a = b2 is a perfect square and p is an odd prime, explain why it is impossible for a to be a primitive root modulo p. 16. Suppose that (a, m) = 1, (a, n) = 1, and (m, n) = 1. Find a formula for ordmn(a) in terms of ordm(a) and ordn(a). 17. Let Fn = 2 2n +1 and suppose that p | Fn, where p is a prime (possibly Fn itself). Show that 2 2n+1 ≡ 1 mod p, so that ordp(2) | 2 n+1. Use this to show that ordp(2) = 2 n+1. Since ordp(2) | (p − 1), show that there is an integer k such that p = k · 2 n + 1. Recall that the order of a modulo p is the smallest positive integer b such that a b ≡ 1 mod p, and we write b = ordp(a). 18. Show that if p is a prime and ordp(a) = 3, then ( 2∑ j=0 a j2)2 ≡ −3 mod p. 19. Show that if p is a prime and ordp(a) = 4, then ( 3∑ j=0 a j2)2 ≡ 8a mod p. 20. Show that if p is a prime and ordp(a) = 6, then 5∑ j=0 a j2 ≡ 0 mod p. 91 Chapter 13 Squares Modulo p and Quadratic Residues We have learned previously how to solve linear congruences of the form ax ≡ c mod p. Next, we consider quadratic congruences modulo a prime p. Example 13.1 Is 3 congruent to the square of some number modulo 7, i.e. can we ﬁnd a number x such that x2 ≡ 3 mod 7? Solution: 0 2 ≡ 0 mod 7 1 2 ≡ 1 mod 7 2 2 ≡ 4 mod 7 3 2 ≡ 2 mod 7 4 2 ≡ 2 mod 7 5 2 ≡ 4 mod 7 6 2 ≡ 1 mod 7 Thus, 3 is not congruent to a square modulo 7. Example 13.2 Does the congruence x2 ≡ −1 ≡ 12 mod 13 have a solution? 92 Stanford University EPGY Number Theory Solution: We compute x2 mod 13 for x ≡ 0, 1, 2, . . . , 12 mod 13 and ﬁnd that the congruence has two solutions, x ≡ 5 mod 13 and x ≡ 8 mod 13. To begin our study of squares modulo p, we compute the squares modulo p for p = 3, 5, 7, 11. a a2 mod 3 0 1 2 a a2 mod 5 0 1 2 3 4 a a2 mod 7 0 1 2 3 4 5 6 a a 2 mod 11 0 1 2 3 4 5 6 7 8 9 10 We make the following observations from this numerical data: • Each number (other than 0) that appears as a square modulo p appears exactly twice. 93 Stanford University EPGY Number Theory • The square of the number b and the square of the number p − b are the same. Theorem 13.1 Suppose that p is a prime. Then b2 ≡ (p − b) 2 mod p. Proof. (p − b) 2 = p2 − 2pb + b2 ≡ 0 − 0 + b2 ≡ b2 mod p. Thus, if we wish to ﬁnd all of the numbers that are squares modulo p, we actually only need to compute half of them: 1 2 mod p, 2 2 mod p, . . . , ( p − 1 2 )2 mod p. Our goal is to determine which numbers are squares modulo p, and which numbers are not squares modulo p. To begin, we need some terminology. Deﬁnition 13.1 A nonzero number that is congruent to a square modulo p is called a quadratic residue modulo p. Example 13.3 3 is a quadratic residue modulo 11 since 5 2 ≡ 3 mod 11. The set of quadratic residues modulo 11 is {1, 3, 4, 5, 9}. Notice that there are 5 quadratic residues modulo 11. Deﬁnition 13.2 A nonzero number that is not congruent to a square modulo p is called a quadratic nonresidue modulo p. Example 13.4 2 is a quadratic nonresidue modulo 11 since there is no integer x such that x2 ≡ 2 mod 11. The set of quadratic nonresidues modulo 11 is {2, 6, 7, 8, 10}. Notice that there are 5 quadratic nonresidues modulo 11. Theorem 13.2 Let p be an odd prime. Then there are exactly ( p − 1 2 ) quadratic residues modulo p and ( p − 1 2 ) quadratic nonresidues modulo p. Proof. The quadratic residues modulo p are precisely the squares modulo p. Thus, they are the numbers 1 2 mod p, 2 2 mod p, . . . , (p − 1) 2 mod p. 94 Stanford University EPGY Number Theory However, since we have shown that p2 ≡ (p − b) 2 mod p, we only need to go halfway, i.e. the quadratic residues modulo p are the numbers 1 2 mod p, 2 2 mod p, . . . , ( p − 1 2 )2 mod p. Note that the list above consists of ( p − 1 2 ) numbers. Thus, to show that there are exactly ( p − 1 2 ) quadratic residues modulo p, we just need to check that the numbers 1 2 mod p, 2 2 mod p, . . . , ( p − 1 2 )2 mod p are all diﬀerent modulo p. Suppose that b1 and b2 are two numbers between 1 and( p − 1 2 ) such that b2 1 ≡ b2 2 mod p. Then p | (b2 1 − b2 2) = (b1 + b2)(b1 − b2). Now, b1 + b2 is between 2 and p − 1, so it can’t be divisible by p. Thus, p | (b1 − b2). However, |b1 − b2| < p − 1 2 , so b1 − b2 = 0. Thus, b1 = b2, and we conclude that the numbers 1 2 mod p, 2 2 mod p, . . . , ( p − 1 2 )2 mod p are all diﬀerent modulo p, so there are exactly ( p − 1 2 ) quadratic residues modulo p and ( p − 1 2 ) quadratic nonresidues modulo p. What happens when we multiply quadratic residues and nonresidues? Perform some experiments modulo 11 and make a conjecture. Recall that the quadratic residues modulo 11 are {1, 3, 4, 5, 9} and the quadratic nonresidues are {2, 6, 7, 8, 10}. 95 Stanford University EPGY Number Theory • QR × QR = QR • QNR × QNR = QR • QR × QNR = QNR To prove that the conjectures made above are correct, we must investigate the rela- tionship between quadratic residues and primitive roots. Let g be a primitive root modulo p. By Theorem 12.3, we know that the powers of g, g, g2, g3, . . . , gp−3, gp−2, gp−1, give all the nonzero numbers modulo p. We know that half of the nonzero numbers modulo p are quadratic residues, and half are quadratic nonresidues. How do we know which are which? We know that g2 is a quadratic residue, since it is clearly a square. Similarly, g4 = (g2) 2 is also a quadratic residue. In general, any even power of g, say g2k is a quadratic residue since g2k = (gk) 2. Since exactly ( p − 1 2 ) of the exponents in the list g, g2, g3, . . . , gp−3, gp−2, gp−1 are even, and there are exactly ( p − 1 2 ) quadratic residues modulo p, we conclude that the quadratic residues modulo p are precisely those numbers a that can be expressed as an even power of g, and the quadratic nonresidues modulo p are those numbers a that can be expressed as an odd power of g. Using this information, we can now prove the following. Theorem 13.3 Quadratic Residue Multiplication Rule, Version 1. Let p be an odd prime. Suppose that a and b are any quadratic residues modulo p and that c and d are any quadratic nonresidues modulo p. Then: • ab is a quadratic residue modulo p. The product of two quadratic residues modulo p is a quadratic residue modulo p. • cd is a quadratic residue modulo p. The product of two quadratic nonresidues modulo p is a quadratic residue modulo p. • ac is a quadratic nonresidue modulo p. The product of a quadratic residue modulo p and a quadratic nonresidue modulo p is a quadratic nonresidue modulo p. Proof. Let g be a primitive root modulo p. Since a and b are quadratic residues modulo p, there exist integers j and k such that 1 ≤ i, j ≤ p − 1 and a ≡ g2k mod p and b ≡ g2j mod p. 96 Stanford University EPGY Number Theory Since c and d are quadratic nonresidues modulo p, there exist integers m and n such that 1 ≤ m, n ≤ p − 1 and c ≡ g2m−1 mod p and d ≡ g2n−1 mod p. Then ab ≡ g2(j+k) is an even power of g, so ab is a quadratic residue modulo p; cd ≡ g2(m−n−1) is an even power of g, so cd is a quadratic residue modulo p; and ac ≡ g2(k+m)−1 mod p is an odd power of g, so ac is a quadratic nonresidue modulo p. We use the following notation for quadratic residues and nonresidues. Deﬁnition 13.3 The Legendre symbol ( a p ) of a modulo p is deﬁned by: ( a p ) = { 1 if a is a quadratic residue modulo p −1 if a is a quadratic nonresidue modulo p Theorem 13.4 Quadratic Residue Multiplication Rule, Version 2. Let p be an odd prime. Then ( ab p ) = ( a p ) ( b p ) . Proof. This follows directly from Version 1 of the Quadratic Residue Mulitplication Rule. Example 13.5 Is 75 a square modulo 97? Solution: To determine whether or not 75 is a square modulo 97, we need to compute( 75 97 ). By the Quadratic Residue Multiplication Rule, we know that ( 75 97 ) = ( 3 · 5 · 5 97 ) = ( 3 97 ) ( 5 97 ) ( 5 97 ) . Next, note that ( 5 97 ) = ±1, so ( 5 97 ) ( 5 97 ) = 1. 97 Stanford University EPGY Number Theory Also, 10 2 ≡ 3 mod 97, so ( 3 97 ) = 1. Thus, ( 75 97 ) = 1, so 75 is a square modulo 97. Note that the solution of the previous example was dependent on knowing that ( 3 97 ) = 1. It is thus important to be able to compute ( a p ) for arbitrary integers p. First, we need the following result. Theorem 13.5 Suppose that p is an odd prime and that a ̸≡ 0 mod p. Then a (p−1)/2 ≡ ±1 mod p. Proof. Let A = a (p−1)/2. By Fermat’s Little Theorem, A2 = a p−1 ≡ 1 mod p. Thus, p | (A2 − 1) = (A − 1)(A + 1). Thus, p | (A − 1) or p | (A + 1). If p | (A − 1), then A ≡ 1 mod p. If p | (A + 1), then A ≡ −1 mod p. Thus, A = a(p−1)/2 ≡ ±1 mod p. We observe that the quantities a (p−1)/2 and ( a p ) both take on the same values, namely ±1. We might consider whether these quan- tities are related to one another. You will explore this question in the problem set. 98 Stanford University EPGY Number Theory Problem Set 1. Make a list of all the quadratic residues and the quadratic nonresidues modulo the primes 7, 13, 17, and 19. 2. In this exercise, you will investigate the relationship between a(p−1)/2 mod p and ( a p ) . Complete the following table. For example, in the second row, we have 2 (5−1)/2 = 2 2 = 4 ≡ −1 mod 5 AND ( 2 5 ) = −1 since 2 is a quadratic nonresidue modulo 5 (the squares modulo 5 are 1 and 4). p a a (p−1)/2 mod p ( a p ) 5 1 1 1 5 2 -1 -1 5 3 5 4 7 1 7 2 7 3 7 4 7 5 7 6 11 1 11 2 11 3 11 4 11 5 11 6 11 7 11 8 11 9 11 10 99 Stanford University EPGY Number Theory Based on the numerical evidence in this table, make a conjecture about the relationship between a (p−1)/2 mod p and ( a p ). 3. In this exercise, you will consider primes p for which −1 is a quadratic residue. Recall that −1 is a quadratic residue modulo p if there is an integer x such that x2 ≡ −1 ≡ (p − 1) mod p. (a) i. Is −1 a quadratic residue or nonresidue modulo 3? Solution: −1 is a quadratic nonresidue modulo 3 since 1 2 ≡ 1 ̸≡ −1 mod 3 and 2 2 ≡ 1 ̸≡ −1 mod 3. ii. Is −1 a quadratic residue or nonresidue modulo 5? iii. Is −1 a quadratic residue or nonresidue modulo 7? iv. Is −1 a quadratic residue or nonresidue modulo 11? v. Is −1 a quadratic residue or nonresidue modulo 13? vi. Is −1 a quadratic residue or nonresidue modulo 17? vii. Is −1 a quadratic residue or nonresidue modulo 19? (b) Note that any odd prime p is either congruent to 1 modulo 4 or congruent to 3 modulo 4. (If p ≡ 0 mod 4, then 4 | p, so p is not prime, and if p ≡ 2 mod 4, then (4 − 2) = 2 | p, so p is not prime). For each prime p in part (a) such that −1 is a quadratic residue modulo p, compute p modulo 4. Do you observe any patterns? (c) For each prime p in part (a) such that −1 is a quadratic nonresidue modulo p, compute p modulo 4. Do you observe any patterns? (d) Make a conjecture describing which primes have −1 as a quadratic residue. 4. In this exercise, you will consider primes p for which 2 is a quadratic residue. Recall that 2 is a quadratic residue modulo p if there is an integer x such that x2 ≡ 2 mod p. (a) i. Is 2 a quadratic residue or nonresidue modulo 3? ii. Is 2 a quadratic residue or nonresidue modulo 5? iii. Is 2 a quadratic residue or nonresidue modulo 7? iv. Is 2 a quadratic residue or nonresidue modulo 11? v. Is 2 a quadratic residue or nonresidue modulo 13? vi. Is 2 a quadratic residue or nonresidue modulo 17? vii. Is 2 a quadratic residue or nonresidue modulo 19? viii. Is 2 a quadratic residue or nonresidue modulo 23? (b) Note that any odd prime p is either congruent to 1, 3, 5, or 7 modulo 8. (Otherwise, 2 | p so p is not prime). For each prime p in part (a) such that 2 is a quadratic residue modulo p, compute p modulo 8. Do you observe any patterns? 100 Stanford University EPGY Number Theory (c) For each prime p in part (a) such that 2 is a quadratic nonresidue modulo p, compute p modulo 8. Do you observe any patterns? (d) Make a conjecture describing which primes have 2 as a quadratic residue. 5. Here are lists of the ﬁrst few primes for which 3 is a quadratic residue and a quadratic nonresidue: Quadratic residue: 11, 13, 23, 37, 47, 59, 61, 71, 73, 83, 97, 107, 109 Quadratic nonresidue: 5, 7, 17, 19, 29, 31, 41, 43, 53, 67, 79, 89, 101, 103, 113, 127 Try reducing these lists modulo m for various m’s until you ﬁnd a pattern, and make a conjecture describing which primes have 3 as a quadratic residue. 6. Suppose that p is a prime and that (a, p) = 1. Show that the equation x3 ≡ a mod p has solutions if a (p−1)/2 ≡ 1 mod p and does not have solutions if a (p−1)/2 ≡ −1 mod p. 101 Chapter 14 Introduction to Quadratic Reciprocity In this section, we’ll consider which primes p have a = −1 as a quadratic residue and which primes p have a = 2 as a quadratic residue. That is, we wish to answer the following questions: • For which primes p is there an integer x such that x2 ≡ −1 mod p? • For which primes p is there an integer x such that x2 ≡ 2 mod p? Theorem 14.1 Euler’s Criterion. Let p be an odd prime. Then a (p−1)/2 ≡ ( a p ) mod p. Proof. We’ll ﬁrst consider the case when a is a quadratic residue modulo p and then when a is a nonresidue. Suppose that a is a quadratic residue modulo p. Then ( a p ) = 1. So we must show that a(p−1)/2 ≡ 1 mod p in this case. Let g be a primitive root modulo p. We know that a is an even power of g, i.e. a can be expressed in the form a ≡ g2k mod p. By Fermat’s Little Theorem, we have: a(p−1)/2 ≡ (g2k) (p−1)/2 ≡ (gp−1) k ≡ 1 k ≡ 1 mod p. Thus, if a is a quadratic residue modulo p, a(p−1)/2 ≡ ( a p ) mod p. 102 Stanford University EPGY Number Theory Next, suppose that a is a quadratic nonresidue modulo p. Then ( a p ) = −1. So we must show that a (p−1)/2 ≡ −1 mod p in this case. Let g be a primitive root modulo p. We know that a is an odd power of g, i.e. a can be expressed in the form a ≡ g2k+1 mod p. By Fermat’s Little Theorem, we have: a (p−1)/2 ≡ (g2k+1) (p−1)/2 ≡ (gp−1) kg(p−1)/2 ≡ g(p−1)/2 mod p. Now, g(p−1) ≡ 1 mod p, so g(p−1)/2 ≡ ±1 mod p. But g is a primitive root modulo p, so the smallest power of g that is congruent to 1 modulo p is the (p − 1)-st power. Thus, g(p−1)/2 ≡ −1 mod p, so we conclude that a (p−1)/2 ≡ −1 mod p in this case. Thus, if a is a quadratic nonresidue modulo p, a (p−1)/2 ≡ ( a p ) mod p. Theorem 14.2 Quadratic Reciprocity, Part 1. Let p be an odd prime. Then −1 is a quadratic residue modulo p if p ≡ 1 mod 4, and −1 is a quadratic nonresidue modulo p if p ≡ 3 mod 4. Using the Legendre symbol, ( −1 p ) = { 1 if p ≡ 1 mod 4, −1 if p ≡ 3 mod 4. Proof. Use Euler’s Criterion: (−1) (p−1)/2 ≡ ( −1 p ) mod p. First, suppose that p ≡ 1 mod 4. Then 4 | (p − 1), so there is an integer k such that p = 4k + 1. 103 Stanford University EPGY Number Theory Then (−1) (p−1)/2 = (−1) (4k+1−1)/2 = (−1) 2k = 1, so 1 ≡ ( −1 p ) mod p. Thus, if p ≡ 1 mod 4, −1 is a quadratic residue modulo 4. Next, suppose that p ≡ 3 mod 4. Then 4 | (p − 3), so there is an integer k such that p = 4k + 3. Then (−1) (p−1)/2 = (−1) (4k+3−1)/2 = (−1) 2k+1 = −1, so −1 ≡ ( −1 p ) mod p. Thus, if p ≡ 3 mod 4, −1 is a quadratic nonresidue modulo p. Theorem 14.3 Quadratic Reciprocity, Part 2. Let p be an odd prime. Then 2 is a quadratic residue modulo p if p ≡ 1 or 7 mod 8, and 2 is a quadratic nonresidue modulo p if p ≡ 3 or 5 mod 8. Using the Legendre symbol, ( 2 p ) = { 1 if p ≡ 1 or 7 mod 8, −1 if p ≡ 3 or 5 mod 8. Proof. Our ﬁrst thought might be to use Euler’s Criterion, as we did for the proof of Quadratic Reciprocity, Part 1. However, there is not an obvious way to compute 2 (p−1)/2 mod p. Recall that when we proved Fermat’s Little Theorem in Chapter 10, we ﬁrst multiplied the numbers 1, 2, 3, . . . , (p − 1) by a, and then multiplied them all together, which gave us a factor of a p−1 to pull out. To use Euler’s Criterion, we want 1 2(p − 1) factors of a to pull out, so instead of starting with all the numbers from 1 to p, we’ll start with the numbers 1, 2, 3, . . . , p − 1 2 and multiply each by a = 2. 104 Stanford University EPGY Number Theory To illustrate the idea, we’ll compute ( 2 13 ). We begin with half the numbers from 1 to 13 − 1 = 12: 1, 2, 3, 4, 5, 6. Next, we multiply each by 2 and then multiply them together. We obtain: (2 · 1)(2 · 2)(2 · 3)(2 · 4)(2 · 5)(2 · 6) = 26 · 6!. Notice the factor 2 6 = 2 (13−1)/2, which is what we are interested in computing. The main idea now is to reduce each of the numbers 2, 4, 6, 8, 10, 12 modulo 13 to obtain a number between 6 and −6. We have: 2 ≡ 2 mod 13 4 ≡ 4 mod 13 6 ≡ 6 mod 13 8 ≡ −5 mod 13 10 ≡ −3 mod 13 12 ≡ −1 mod 13 Multiplying these numbers together, we have: 2 · 4 · 6 · 8 · 10 · 12 ≡ 2 · 4 · 6 · (−5) · (−3) · (−1) mod 13 ≡ (−1) 3 · 6! mod 13 ≡ −6! mod 13. Thus 2 6 · 6! ≡ −6! mod 13, which implies that 2 6 ≡ −1 mod 13. By Euler’s Criterion, we conclude that 2 is a quadratic nonresidue modulo 13. Next, let’s think about the idea a little more generally. Let p be any odd prime. We wish to compute 2(p−1)/2. We start with the even numbers 1, 2, 3, . . . , p − 1 2 105 Stanford University EPGY Number Theory and multiply each by 2 to obtain the list 2 · 1, 2 · 2, 2 · 3, . . . , 2 · p − 1 2 . Next, we multiply the numbers together and factor out a 2 from each number to obtain (2 · 1) · (2 · 2)(2 · 3) · · · (2 · p − 1 2 ) = 2 (p−1)/2 ( p − 1 2 )!. The next step is to reduce each number in the list 2, 4, 6, . . . , p − 1 modulo p so that it lies in the range − p−1 2 to p−1 2 . The ﬁrst few numbers won’t change, but any number in the list larger than (p − 1)/2 needs to have p subtracted from it (and thus becomes negative). The number of minus signs is exactly the number of integers in the list 2, 4, 6, . . . , (p − 1) that are larger than (p − 1)/2. Thus, equating the two products, we have: 2 (p−1)/2 ( p − 1 2 )! = 2 · 4 · 6 · · · (p − 1) ≡ (−1) number of minus signs · ( p − 1 2 )! mod p. We conclude that 2 (p−1)/2 ≡ (−1) number of minus signs mod p. Recall that the number of minus signs is exactly the number of integers in the list 2, 4, 6, . . . , (p − 1) that are larger than (p − 1)/2. Using this result, we can now prove the Theorem. Suppose that p ≡ 3 mod 8. Then 8 | (p − 3), so there is an integer k such that p = 8k + 3. We need to list the numbers 2, 4, 6, . . . , p − 1 and determine how many of them are larger than (p − 1)/2. In this case, p − 1 = 8k + 2 and p − 1 2 = 8k + 2 2 = 4k + 1. So the list is 2, 4, 6, . . . , 4k || (4k + 2), (4k + 4), . . . , 8k. There are 2k + 1 even numbers between 4k + 2 and 8k + 2 (try it for a few values of k), so there are 2k + 1 numbers in the list larger than (p − 1)/2. Thus, there are 2k + 1 minus signs, so 2 (p−1)/2 ≡ (−1) 2k+1 ≡ −1 mod p. We conclude that 2 is a quadratic nonresidue modulo p for any prime p that is congruent to 3 modulo 8. The three remaining cases can be proved in a similar way, and are left to you as exercises. 106 Stanford University EPGY Number Theory Problem Set 1. Determine which of the following congruences has a solution. All of the moduli are primes. (a) x2 ≡ −1 mod 5987 (b) x2 ≡ 6780 mod 6781 (c) x2 ≡ 2 mod 61 (d) x2 ≡ 2 mod 59 (e) x2 + 14x − 35 ≡ 0 mod 337 (Hint: use the quadratic formula to ﬁgure out what number you need to take the square root of modulo 337.) (f) x2 − 64x + 943 ≡ 9 mod 3011 2. Suppose that p is an odd prime and that a ≡ b mod p. Show that ( a p ) = ( b p ) . 3. In this exercise, you will prove that there are inﬁnitely many primes that are congruent to 1 modulo 4. Suppose that you are given a list p1, p2, . . . , pr of primes that are congruent to 1 modulo 4. You can then ﬁnd at least one new prime, not in the list, that is congruent to 1 modulo 4. Repeating this process indeﬁnitely constructs a list of inﬁnitely many primes that are congruent to 1 modulo 4. (a) Consider the number A = (2p1p2 · · · pr) 2 + 1. Factor A into a product of primes, say A = q1q2 · · · qs. (b) Show that A ≡ 0 mod qi for each qi. (c) Show that −1 is a quadratic residue modulo qi for each qi. (d) Conclude that each qi is congruent to 1 modulo 4. (e) Explain why none of the qi’s could have been in the original list. 107 Stanford University EPGY Number Theory (f) Use the procedure described in this proof to produce a list of primes that are congruent to 1 modulo 4. Start with p1 = 5. Then A = (2p1) 2 + 1 = 101, so our second prime is p2 = 101 ≡ 1 mod 4. Repeat this procedure to ﬁnd a few more primes that are congruent to 1 modulo 4 (you will probably want to use a calculator for the arithmetic). 4. Finish the proof of the Quadratic Reciprocity, Part 2 Theorem for the cases p ≡ 7 mod 8, p ≡ 1 mod 8, and p ≡ 5 mod 8. 5. Suppose that q is a prime number that is congruent to 1 modulo 4, and suppose that the number p = 2q + 1 is also a prime number. (For example, q could equal 5 and p would be 11). Show that 2 is a primitive root modulo p. 6. In this exercise, you will investigate the relationship between ( q p ) and ( p q ) for various primes q and p. The following table gives the value of ( q p ) for all odd primes p, q ≤ 37. q, p q = 3 q = 5 q = 7 q = 11 q = 13 q = 17 q = 19 q = 23 q = 29 p = 3 -1 1 -1 1 -1 1 -1 -1 p = 5 -1 -1 1 -1 -1 1 -1 1 p = 7 -1 -1 1 -1 -1 -1 1 1 p = 11 1 1 -1 -1 -1 -1 1 -1 p = 13 1 -1 -1 -1 1 -1 1 1 p = 17 -1 -1 -1 -1 1 1 -1 -1 p = 19 -1 1 1 1 -1 1 1 -1 p = 23 1 -1 -1 -1 1 -1 -1 1 p = 29 -1 1 1 -1 1 -1 -1 1 (a) Using the row with p = 5 and the column with q = 5, make a conjecture about the relationship between ( 5 p ) and ( p 5 ). (b) What is the relationship between ( 7 3 ) and ( 3 7 )? 108 Stanford University EPGY Number Theory (c) In (a) and (b), you should have observed that sometimes ( q p ) = ( p q ) and sometimes ( q p ) = − ( p q ). Make a list of the primes p whose rows and columns are exactly the same. For these primes, ( q p ) = ( p q ). Next, make a list of the primes p whose rows and columns are not exactly the same. For these primes, ( q p ) = − ( p q ). Do you observe any patterns about your lists? Hint: consider the primes in your list modulo 4. 109 Chapter 15 The Law of Quadratic Reciprocity The Law of Quadratic Reciprocity was ﬁrst formulated by Euler and Lagrange, but Gauss gave the ﬁrst proof in 1801. Gauss discovered the law for himself when he was 19, and during his lifetime he found seven diﬀerent proofs. The Law of Quadratic Reciprocity is a beautiful and subtle theoretical result that also has important prac- tical consequences. Theorem 15.1 Law of Quadratic Reciprocity. Let p and q be distinct odd primes. ( −1 p ) = { 1 if p ≡ 1 mod 4 −1 if p ≡ 3 mod 4 ( 2 p ) = { 1 if p ≡ 1 or 7 mod 8 −1 if p ≡ 3 or 5 mod 8. ( q p ) =    ( p q ) if p ≡ 1 mod 4 or q ≡ 1 mod 4 − ( p q ) if p ≡ 3 mod 4 and q ≡ 3 mod 4 We have already proved the result for ( −1 p ) and ( 2 p), and will not give the general proof for ( q p) here. Using the Law of Quadratic Reciprocity and the Quadratic Residue Multiplication Rule, we can compute ( a p ) for any number a and any prime p. The Law of Quadratic Reciprocity allows us to ﬂip the Legendre symbol ( q p ) and replace it with ± ( p q ). Then we can reduce p modulo q and repeat the process, at each stage obtaining a Legendre symbol with smaller and smaller entries, so that eventually we arrive at a Legendre symbol that we can compute. 110 Stanford University EPGY Number Theory Example 15.1 Determine whether the congruence x2 ≡ 5 mod 3593 has a solution (3593 is prime). Solution. We need to determine whether 5 is a quadratic residue modulo 3593, so we need to compute ( 5 3593 ): ( 5 3593 ) = ( 3593 5 ) since 5 ≡ 1 mod 4 = ( 3 5 ) since 3593 ≡ 3 mod 5 = −1 since 3 is a quadratic nonresidue modulo 5. Thus, 5 is a quadratic nonresidue modulo 3593, so the congruence does not have a solution. Example 15.2 Determine whether the congruence x2 ≡ 14 mod 137 has a solution (137 is prime). Solution. We need to determine whether 14 is a quadratic residue modulo 137, so we need to compute ( 14 137 ): ( 14 137 ) = ( 2 137 ) ( 7 137 ) by the Quadratic Residue Multiplication Rule = ( 7 137 ) since 137 ≡ 1 mod 8 = ( 137 7 ) since 137 ≡ 1 mod 4 = ( 4 7 ) since 137 ≡ 4 mod 7 = 1 since 4 = 22 is a square modulo 7. Thus, 14 is a quadratic residue modulo 137, so the congruence does have a solution. 111 Stanford University EPGY Number Theory Example 15.3 Determine whether the congruence x2 ≡ 55 mod 179 has a solution (179 is prime). Solution: We need to determine whether 55 is a quadratic residue modulo 179, so we need to compute ( 55 179 ): ( 55 179 ) = ( 5 179 ) ( 11 179 ) by the Quadratic Residue Multiplication Rule = ( 179 5 ) · (−1) · ( 179 11 ) since 5 ≡ 1 mod 4 and 11 ≡ 179 ≡ 3 mod 4 = ( 4 5 ) · (−1) ( 3 11 ) = 1 · (−1) · ( 3 11 ) = 1 · (−1) · (−1) · ( 11 3 ) since 3 ≡ 11 ≡ 3 mod 4 = 1 · (−1) · (−1) · ( 2 3 ) = 1 · (−1) · (−1) · (−1) = −1. Thus, 55 is a quadratic nonresidue modulo 179, so the congruence does not have a solution. Example 15.4 Find all odd primes p such that 3 is a quadratic residue modulo p. Solution: We need to ﬁnd all primes p such that ( 3 p ) = 1. Since 3 ≡ 3 mod 4, we know that ( 3 p ) = {( p 3 ) if p ≡ 1 mod 4 − ( p 3 ) if p ≡ 3 mod 4. Also, ( p 3 ) = {( 1 3 ) = 1 if p ≡ 1 mod 3 ( 2 3 ) = −1 if p ≡ 2 mod 3. Thus, ( 3 p) = 1 if p ≡ 1 mod 3 and p ≡ 1 mod 4 or if p ≡ 2 mod 3 and p ≡ 3 mod 4. 112 Stanford University EPGY Number Theory Problem Set 1. Use the Law of Quadratic Reciprocity to compute each of the following Legendre symbols. (a) ( 42 61 ) (b) ( 85 101 ) (c) ( 29 541 ) (d) ( 101 1987 ) (e) ( 31706 43789 ) 2. Determine which of the following congruences are solvable. All of the moduli are prime. (a) x2 ≡ 10 mod 89 (b) x2 ≡ 5 mod 227 (c) x2 ≡ 5 mod 229 (d) x2 ≡ 7 mod 1009 (e) x2 ≡ 150 mod 1009 3. Find all primes q such that ( 5 q ) = −1. 4. Find all primes p such that x2 ≡ 13 mod p has a solution. 5. Prove that if a prime p is a quadratic residue of an odd prime q, and if p is of the form 4k + 1, then q is a quadratic residue of p. 6. Does the congruence x2 − 3x − 1 ≡ 0 mod 31957 have any solutions? Hint: use the quadratic formula to ﬁnd out what number you need to take the square root of modulo the prime 31957. 7. Let p be a prime number not equal to 2 or 5, and let A be any number. Suppose that p divides A2 − 5. Show that p must be congruent to either 1 or 4 modulo 5. 8. Let p be a prime satisfying p ≡ 3 mod 4. Suppose that a is a quadratic residue modulo p. 113 Stanford University EPGY Number Theory (a) Show that x = a (p+1)/4 is a solution to the congruence x2 ≡ a mod p. This gives an explicit way to ﬁnd square roots modulo p for primes congru- ent to 3 modulo 4. (b) Find a solution to the congruence x2 ≡ 7 mod 787. 9. Let p be a prime satisfying p ≡ 5 mod 8. Suppose that a is a quadratic residue modulo p. (a) Show that one of the values x = a (p+3)/8 or x = 2a · (4a) (p−5)/8 is a solution to the congruence x2 ≡ a mod p. This gives an explicit way to ﬁnd square roots modulo p for primes congru- ent to 5 modulo 8. (b) Find a solution to the congruence x2 ≡ 5 mod 541. (c) Find a solution to the congruence x2 ≡ 13 mod 653. 114 Chapter 16 Diophantine Equations A Diophantine equation is a polynomial equation for which we seek integer solu- tions (or perhaps rational solutions). There is no universal method for determining whether a given Diophantine equation has a solution, or for ﬁnding all solutions if solutions do exist. Example 16.1 Find all positive integer solutions of the equation x4 + 9 = y2. Solution: We rewrite the equation in the form y2 − x4 = 9 (y − x2)(y + x2) = 9 Since we are interested in y > 0, x > 0, the factor y + x2 is positive; thus, the other factor y − x2 must also be positive. There are only two ways of factoring 9 as a product of positive integers: 9 = 1 · 9 and 9 = 3 · 3. Thus there are only three possibilities: (a) y + x2 = 1 and y − x2 = 9 (b) y + x2 = 3 and y − x2 = 3 (c) y + x2 = 9 and y − x2 = 1 In each case, there are two equations and two unknowns. In case (a), we ﬁnd x = ± √−4, which is not an integer. In case (b), we ﬁnd x = 0, which is not a positive integer. In case (c), we ﬁnd y = 5, x = ±2. Thus, the only solution in positive integers is x = 2 and y = 5. Theorem 16.1 Fermat’s last theorem states that if n ≥ 3, then there are no solu- tions to the equation xn + yn = zn 115 Stanford University EPGY Number Theory in nonzero integers. In 1637, Fermat wrote in the margin of his copy of Arithmetica of Diophantus that he had a “truly marvellous proof of this proposition which this margin is too narrow to contain.” No correct proof of Fermat’s Last Theorem was found for 357 years, until one was ﬁnally published by Andrew Wiles in 1995. Note that when n = 2, the equation x2 + y2 = z2 has inﬁnitely many solutions (which you will explore as an exercise). Fermat also stated that the equation x2 + 2 = y3 has only x = 5, y = 3 as a solution in positive integers and that the equation x2 + 4 = y3 has only x = 11, y = 5 as a solution in positive integers. These statements have since been proven to be true using the ideas of quadratic ﬁeld theory (developed 200 years after Fermat’s announcement). It would be very interesting to know Fermat’s proofs of these statements. Congruences often provide an easy way of showing that certain Diophantine equations have no solutions. Example 16.2 Find all integer solutions of the equation x2 − 7y2 = −1. Solution: Consider the equation modulo 7. If x2 − 7y2 = −1, then x2 − 7y2 ≡ −1 mod 7 x2 ≡ −1 mod 7. However, 7 ≡ 3 mod 4, so −1 is a quadratic nonresidue modulo 7. Thus, there is no integer x such that x2 ≡ −1 mod 7. The squares modulo 7 are 1 2 ≡ 1 mod 7, 2 2 ≡ 4 mod 7, 3 2 ≡ 2 mod 7, 4 2 ≡ 2 mod 7, 5 2 ≡ 4 mod 7, 6 2 ≡ 1 mod 7. We conclude that the equation has no integer solutions. The main idea in using congruences to show that a Diophantine equation has no solutions is that if a Diophantine equation has no solutions modulo n, then it certainly has no solutions. Theorem 16.2 Suppose that d is divisible by a prime p ≡ 3 mod 4 or that d is divisible by 4. Then the equation x2 − dy2 = −1 has no solutions. 116 Stanford University EPGY Number Theory Proof. Suppose that (x, y) is a solution to the equation. First, suppose that p ≡ 3 mod 4 and p | d. Then d ≡ 0 mod p. Then: x2 − dy2 ≡ x2 ≡ −1 mod p. But since p ≡ 3 mod 4, −1 is a quadratic nonresidue modulo p, so no such integer x exists. Next, suppose that 4 | d. Then x2 − dy2 ≡ x2 ≡ −1 mod 4. But the squares modulo 4 are 1 2 ≡ 1 mod 4, 2 2 ≡ 0 mod 4, 3 2 ≡ 1 mod 4, so there is no integer x such that x2 ≡ −1 ≡ 3 mod 4. Thus the equation has no integer solutions. Example 16.3 Find all integer solutions of the equation x2 − 5y2 = 2. Solution: Consider the equation modulo 5. x2 − 5y2 ≡ 2 mod 5 x2 ≡ 2 mod 5 However, 2 is a quadratic nonresidue modulo 5, so no such integers x exists. The squares modulo 5 are 1 2 ≡ 1 mod 5, 2 2 ≡ 4 mod 5, 3 2 ≡ 4 mod 5, 4 2 ≡ 1 mod 5. We conclude that the equation has no integer solutions. Example 16.4 Are there integers x and y such that x2 − 5y2 = 2? Hint: Consider the equation modulo 5. 117 Stanford University EPGY Number Theory Problem Set 1. Find all solutions in positive integers to the equation x2 + 12 = y4. 2. Find all solutions in positive integers to the equation x3 + y3 = 20. 3. Find all solutions in positive integers to the equation x3 − y3 = 19. 4. Suppose that d is a perfect square. Find all integer solutions to the equation x2 − dy2 = 1. 5. Show that 2 is the only prime which is the sum of 2 positive cubes. The word positive is necessary and hence must play a role in your proof; consider the examples 7 = 2 3 + (−1) 3, 61 = 5 3 + (−4) 3. 6. In this exercise, you will investigate Pythagorean triples, i.e. positive integers (x, y, z) that satisfy the equation x2 + y2 = z2. (a) Suppose that (a, b, c) is a Pythagorean triple, and let d be a positive integer. Show that (da, db, dc) is also a Pythagorean triple. Thus, there are inﬁnitely many Pythagorean triples. (b) A primitive Pythagorean triple is a triple of numbers (a, b, c) such that a, b, c have no common factors and satisfy a 2 + b2 = c2. Give 5 examples of primitive Pythagorean triples. (c) Suppose that (a, b, c) is a primitive Pythagorean triple. Show that c is odd. (d) Suppose that (a, b, c) is a primitive Pythagorean triple. Show that one of a and b is odd and the other is even. (e) Suppose that (a, b, c) is a primitive Pythagorean triple. Show that either a or b must be a multiple of c. (f) Suppose that (a, b, c) is a primitive Pythagorean triple. Show that one of a, b, c is divisible by 5. 7. In this exercise, you will ﬁnd all primitive Pythagorean triples by following the steps outlined below. Suppose that (a, b, c) is a primitive Pythagorean triple. We can always switch a and b and still have a primitive Pythagorean triple, so let’s suppose that a is odd and b is even. 118 Stanford University EPGY Number Theory (a) Show that a2 = (c − b)(c + b). (b) Show that gcd(c − b, c + b) = 1. (c) Show that c − b and c + b are both squares. Then we can write c + b = s2 and c − b = t 2, where s > t ≥ 1 are odd integers with no common factors. (d) Solve these equations for b and c. (e) Solve for a. (f) Conclude that every primitive Pythagorean triple (a, b, c) with a odd and b even is given by the formulas a = st, b = s2 − t 2 2 , c = s2 + t 2 2 , where s > t ≥ 1 are chosen to be any odd integers with no common factors. (g) Give all possible primitive Pythagorean triples with s ≤ 7. 8. Suppose that p is an odd prime that can be written as the sum of two squares, p = a 2 + b2, where a and b are positive integers. Show that p ≡ 1 mod 4. 9. Show that the equation x2 + 7y2 = 3 has no integer solutions. 10. Show that the equation x2 − 3y2 = 2 has no integer solutions. 11. Show that the equation x2 − 11y2 = 3 has no integer solutions. 12. Show that the equation 11x2 + 10x − y2 + 2 = 0 has no integer solutions. 13. Find all integer solutions of the equation x2 − 7y2 = 3z2. 14. Show that the equation x2 + y2 = 9z + 3 has no integer solutions. 15. Show that the equation x2 + 2y2 = 8z + 5 has no integer solutions. 16. Show that the equation (x2 + y2) 2 − 2(3x2 − 5y2) 2 = z2 has no integer solutions. 17. Show that the equation x2 = y3 + 23 has no integer solutions. 119 Chapter 17 Fibonacci Numbers and Linear Recurrences Deﬁnition 17.1 The Fibonacci numbers Fn are deﬁned as follows: F0 = 0, F1 = 1, F2 = 1, Fn = Fn−1 + Fn−2 for n ≥ 3. Notice that we don’t have an explicit formula for Fn because we can’t compute Fn directly. We have a rule that tells us how to compute Fn from the previous numbers. This is an example of a recursion or recursive equation. Create a table of values of the ﬁrst 20 Fibonacci numbers. n Fn n Fn 1 1 11 2 1 12 3 2 13 4 14 5 15 6 16 7 17 8 18 9 19 10 20 Notice that the Fibonacci numbers grow very rapidly. In fact, the 31st Fibonacci number is larger than 1 million, F31 = 1, 346, 269 and the 45th Fibonacci number is larger than 1 billion, F45 = 1, 134, 903, 170. 120 Stanford University EPGY Number Theory We’re interested in discovering number theoretic patterns that exist within the Fi- bonacci numbers, so one question that we should consider is how fast the Fibonacci numbers are growing. We can measure this by the ratio Fn Fn−1 . Create a table of values of Fn/Fn−1 for n ≤ 20. n Fn/Fn−1 n Fn/Fn−1 2 1.00000 12 3 2.00000 13 4 14 5 15 6 16 7 17 8 18 9 19 10 20 11 Observe that the ratio Fn/Fn−1 appears to be getting closer and closer to some number around 1.61803. Let’s try to ﬁgure out exactly what this number is. The table suggests that Fn is approximately equal to αFn−1 for some number α: Fn ≈ αFn−1 Fn−1 ≈ αFn−2 Fn ≈ α2Fn−2 Using the recursive equation Fn = Fn−1 + Fn−2, we have α2Fn−2 ≈ αFn−2 + Fn−2. Dividing by Fn−2, we obtain the equation α2 − α − 1 = 0, which we solve to obtain α = 1 ± √5 2 . Note that 1 + √5 2 ≈ 1.61803399. 121 Stanford University EPGY Number Theory We know that both values of α satisfy α2 = α + 1, so for any number n, they both satisfy αn = αn−1 + αn−2, which looks a lot like the Fibonacci recursive equation Fn = Fn−1 + Fn−2. We can formalize this observation as follows. Let α1 = 1 + √5 2 and α2 = 1 − √5 2 . Next, let Hn = c1αn 1 + c2αn 2 , where c1 and c2 are constants. Then Hn = Hn−1 + Hn−2, so Hn satisﬁes the same recursive formula as the Fibonacci sequence, and c1 and c2 can be any integers. The idea now is to choose c1 and c2 so that Hn and the Fibonacci sequence Fn start with the same two values, i.e. H1 = F1 = 1 and H2 = F2 = 1. Thus, we solve c1α1 + c2α2 = 1 and c1α2 1 + c2α2 2 = 1 to obtain c1 = 1 √5 and c2 = −1 √5. We summarize our ﬁndings as follows. The formula for the n-th term of the Fibonacci sequence is named after Binet, who published it in 1843 (although it was known to Euler and Daniel Bernoulli at least 100 years earlier). Theorem 17.1 Binet’s Formula. Then Fibonacci sequence Fn is described by the recursion F1 = F2 = 1 and Fn = Fn−1 + Fn−2 for n ≥ 3. Then the n-th term of the Fibonacci sequence is given by the formula Fn = 1 √5 [(1 + √5 2 )n − (1 − √5 2 )n] . 122 Stanford University EPGY Number Theory Check the formula for the ﬁrst few values of n to make sure that you believe the result. Proof. For each positive integer n ≥ 1, let Hn = 1 √5 [(1 + √5 2 )n − (1 − √5 2 )n] . We will prove that Hn = Fn for all integers n ≥ 1 by induction. (i) Base case. First we check that H1 = F1 and H2 = F2. H1 = 1 √5   (1 + √5 2 )1 − (1 − √5 2 )1  = 1 √5 · √5 = 1 = F1 H2 = 1 √5   (1 + √5 2 )2 − (1 − √5 2 )2  = 1 √5 4 √5 4 = 1 = F2 (ii) Inductive hypothesis. Suppose that Hk = Fk for all k ≤ n. Then Hn+1 = Hn + Hn−1 = Fn + Fn−1 = Fn+1. Thus, Hn = Fn for every integer n ≥ 1. Deﬁnition 17.2 The number ϕ = 1 + √5 2 is known as the golden ratio. Binet’s Formula states the following: Fn = ϕ n − (1 − ϕ) n √5 . The golden ratio has fascinated Western intellectuals for at least 2400 years, and it has appeared in extremely diverse (and sometimes surprising areas): • Architecture (Acropolis, Parthenon, Giza Pyramids, Great Mosque of Kairouan, Naqsh-e Jahan Square) • Painting (Mona Lisa, De Divina Proportione, Dali’s The Sacrament of the Last Supper) 123 Stanford University EPGY Number Theory • Book design • Music • Nature (Fibonacci spiral in plants, leaf arrangements, phyllotaxis, sunﬂower spirals, pinecone spirals) • Human body Theorem 17.2 Zeckendorf ’s Theorem. Every positive integer can be expressed in a unique way as the sum of one or more distinct Fibonacci numbers in such a way that the sum does not contain any 2 consecutive Fibonacci numbers. Example 17.1 100 = F11 + F6 + F4 = 89 + 8 + 3 is the Zeckendorf representation of the integer 100. Observe that we can also express 100 as 100 = 89 + 8 + 2 + 1 = 55 + 34 + 8 + 3, but these contain consecutive Fibonacci numbers. For any given positive integer, we can ﬁnd a representation that satisﬁes the condi- tions of Zeckendorf’s Theorem by using a “greedy algorithm”–at each stage, choose the largest possible Fibonacci number. Example 17.2 Find the Zeckendorf representation of each of the following: 1. 25 2. 34 3. 700 124 Stanford University EPGY Number Theory Problem Set 1. The golden ratio ϕ = 1 + √5 2 satisﬁes some amazing identities. Prove (or investigate) the following: (a) 1 ϕ = ϕ − 1 (b) ϕ = √ 1 + √ 1 + √1 + √1 + · · · (c) ϕ = 5 0.5 · 0.5 + 0.5 (d) ϕ = 1 + 1 1+ 1 ϕ (e) ϕ = 1 + 1 1+ 1 1+ 1 ϕ (f) Can you continue the previous 2 identities? (g) ϕ ϕ2+ϕ = ϕ ϕ1+ϕ2 (h) ϕ = 13 8 + ∞∑ n=0 (−1)n+1(2n+1)! (n+2)!n!42n+3 (i) ϕ = 1 + 2 sin(π/10) 2. Find the continued fraction expansion of the golden ratio ϕ = 1+√5 2 . Then ﬁnd the ﬁrst 10 convergents in the continued fraction expansion of ϕ. What do you observe? See 25 for more information on continued fractions. 3. Find the Zeckendorf representation of each of the following: (a) 10 (b) 500 (c) 800 4. Compute the Zeckendorf representations for F 2 n for n = 1, 2, . . .. Try to ﬁgure out the pattern and prove that it holds in general. 5. (a) Show that Fmn/Fm is always an integer. (b) Compute the Zeckendorf representation of Fmn/Fn for diﬀerent values of m and n. Can you ﬁnd any patterns? 6. Make a list of the Fibonacci numbers that are prime. Make a conjecture of the form “If Fn is prime, then n is ...”. 7. Find as many square Fibonacci numbers as you can. Do you think that there are ﬁnitely many or inﬁnitely many square Fibonacci numbers? 125 Stanford University EPGY Number Theory 8. Find all positive integer solutions of the Diophantine equation 89x + 55y = 1. What do you observe? 9. The number ϕ = 1 + √5 2 = 1.61803 . . . is known as the golden ratio. We have observed that the ratio Fn/Fn−1 gets closer and closer to the Golden Ratio as n increases. The golden ratio appears in many other places such as art, architecture, history, nature, and other branches of mathematics. Do some research online about the golden ratio, and write a short paper (with illustrations!) about places in which it appears. 10. The Lucas sequence is the sequence of numbers Ln given by the rules L1 = 1, L2 = 3, and Ln = Ln−1 + Ln−2. (a) Write down the ﬁrst 10 terms of the Lucas sequence. (b) Find a simple formula for Ln, similar to Binet’s Formula for the Fibonacci number Fn. (c) Compare the value of L2 n − 5F 2 n for each 1 ≤ n ≤ 10. Make a conjecture about this value, and prove that your conjecture is correct. (d) Show that L3n and F3n are even for all n. Combining this fact with the formula that you discovered in (c), ﬁnd an interesting equation satisﬁed by the pair of numbers 1 2L3n, 1 2F3n. (e) Compute the Zeckendorf representations for Ln and L2 n for n = 1, 2, . . .. Do you observe any patterns? 11. Let Pn be the sequence deﬁned by P1 = 1, P2 = 9, P3 = 1, and Pn = Pn−1 + 4Pn−2 − 4Pn−3 for n ≥ 4. (a) Write down the ﬁrst 10 terms of Pn. (b) Does the sequence exhibit any strange behavior? (c) Find a formula for Pn, similar to Binet’s Formula for the Fibonacci number Fn. Does the formula explain the behavior that you observed in (b)? 12. Consider the Fibonacci sequence reduced modulo m for various moduli m. For example, Fn mod 2 = 1, 1, 0, 1, 1, 0, 1, 1, 0, . . . Fn mod 3 = 1, 1, 2, 0, 2, 2, 1, 0, 1, 1, 2, 0, 2, 2, 1, 0, . . . Fn mod 4 = 1, 1, 2, 3, 1, 0, 1, 1, 2, 3, 1, 0, 1, 1, 2, . . . Fn mod 5 = 1, 1, 2, 3, 0, 3, 3, 1, 4, 0, 4, 4, 3, 2, 0, 2, 2, 4, 1, 0, 1, 1, 2, . . . 126 Stanford University EPGY Number Theory Observe that in each case, the Fibonacci sequence eventually starts to repeat. Thus there is an integer N ≥ 1 such that Fn+N ≡ Fn mod m for all n = 1, 2, . . . . The smallest such integer N is called the period of the Fibonacci sequence and is denoted by N (m). Using the examples above, we have: m 2 3 4 5 N (m) 3 8 6 20 (a) What is the value of FN (m) modulo m? What is the value of FN (m)−1 modulo m? (b) Write out the Fibonacci sequence modulo m in reverse direction: FN (m)−1, FN (m)−2, . . . , F3, F2, F1 mod m. Do this for several values of m, and try to ﬁnd a pattern. (c) Prove that if m ≥ 3, then the period N (m) is even. (d) Prove that if p is a prime such that p ≡ 1 mod 10, then N (p) divides p − 1. Hint: one way to solve this problem is to use Binet’s formula, but ﬁrst you’ll need to ﬁnd a number modulo p to play the role of √5. You will also need to use Fermat’s Little Theorem. 13. The Fibonacci numbers satisfy many amazing identities. (a) Compute the quantity F 2 n+1 − F 2 n−1 for the ﬁrst few integers n = 2, 3, . . .. Make a conjecture for the value of F 2 n+1 − F 2 n−1, and prove that your con- jecture is correct. Hint: it is equal to a Fibonacci number. (b) Same question (and same hint) for the quantity F 3 n+1 + F 3 n − F 3 n−1. (c) Same question (but not the same hint) for the quantity Fn−1Fn+1 − F 2 n . (d) Same question for the quantity 4FnFn−1 + F 2 n−2. Hint: compare the value with the square of a Fibonacci number. (e) Same question for the quantity F 4 n+4 − 4F 4 n+3 − 19F 4 n+2 − 4F 4 n+1 + F 4 n . 127 Stanford University EPGY Number Theory Fibonacci Nim The game of Fibonacci Nim is played with two people and a pile containing n pennies (or sticks, or matches, or marbles, etc.). Person A removes j pennies from the pile, where 1 ≤ j < n. Player B then removes k pennies from the pile, where 1 ≤ k ≤ 2j. The game continues in this way. Each player (after the ﬁrst move) may take away as many pennies as he or she wishes with the restrictions that he or she must take at least one penny but no more than two times the number of pennies the previous player took. The player who takes the last penny wins the game. Problems. 1. Find a winning strategy for Player 1 if n = 4. 2. Find a winning strategy for Player 1 if n = 6. 3. Find a winning strategy for Player 1 if n = 7. 4. Find a winning strategy for Player 1 if n = 9. 5. Find a winning strategy for Player 1 if n = 10. 6. Find a winning strategy for Player 1 if n = 11. 7. Find a winning strategy for Player 1 if n = 12. 8. Find a winning strategy for Player 1 if n = 14. 9. Find a winning strategy for Player 1 if n = 25. 10. Find a winning strategy for Player 1 if n = 43. 11. Show that Player 1 always has a winning strategy if n is not a Fibonacci number. Describe the winning strategy. Why doesn’t Player 1 have a winning strategy if n is a Fibonacci number? 128 Stanford University EPGY Number Theory Unsolved Problems 1. Begin an array by writing the Fibonacci numbers: 0, 1, 1, 2, 3, 5, 8, 13, 21, . . .. Do not include the 0 or the ﬁrst 1. Thus, the ﬁrst row should be 1 2 3 5 8 13 · · · Start row 2 with the least unused positive integer, which is 4. Follow 4 by 6 (the rule for choosing the second term in each row will be described be- low), and ﬁnish the row using the Fibonacci recurrence, i.e. add the two most recent numbers to produce the next. Thus, the array should be the following: 1 2 3 5 8 13 · · · 4 6 10 16 26 42· · · Start row 3 with the least unused, which is 7, follow 7 by 12, and then use the Fibonacci recurrence to complete the row. To obtain the second number in each row, do the following. Let r = 1 + √5 2 . Let x be the ﬁrst number in the row. Then the second number is ⌊rx⌋ if the row number is even and ⌊rx⌋ + 1 if the row number is odd. Here, ⌊a⌋ means the greatest integer less than or equal to a. Thus, for example, row 3 starts with the least unused, which is 7, and is followed by ⌊7r⌋ = 11. Find the ﬁrst 8 rows of this array. What do you observe about the numbers in the second column? 2. Which numbers can be expressed as the sum of a Fibonacci number and a prime number? For example, 122 = 13 + 109 = 21 + 101 = 55 + 67. The ﬁrst number in each of the three summations is a Fibonacci number, while the second is a prime number. (a) Let W (n) denote the number of ways that an integer n can be expressed as the sum of a Fibonacci number and a prime number. Find W (n) for n from 1 to 25. (Remember that 0 is a Fibonacci number). (b) Find two numbers such that W (n) = 0. (c) Unsolved question: Are there any Fibonacci numbers greater than 1 that cannot be expressed as the sum of a Fibonacci number and a prime number? (i.e. is it possible to ﬁnd a Fibonacci number n such that W (n) = 0?) 3. A number is said to be squareful if it contains at least one square in its prime factorization. The ﬁrst six squareful numbers are 4,8,9,12,16,18. (a) Find the ﬁrst six squareful Fibonacci numbers. (b) Unsolved question: Is it possible to ﬁnd a Fibonacci number Fn (i.e. the n-th Fibonacci number, F0 = 0, F1 = 1, F2 = 1, F3 = 2, F4 = 3, F5 = 5, F6 = 8, . . .) such that n is prime and Fn is squareful? 129 Stanford University EPGY Number Theory 4. Are there inﬁnitely many prime Fibonacci numbers? 5. Which Fibonacci numbers can be written as half the diﬀerence or sum of two cubes? 130 Chapter 18 Mersenne Primes and Perfect Numbers We begin this section by considering primes that can be written in the form a n − 1 with n ≥ 2. For example, 31 is such a prime, since 31 = 2 5 − 1. The ﬁrst step is to look at some data: n = 2 n = 3 n = 4 n = 5 a = 2 3 7 15 = 3 · 5 31 a = 3 a = 4 a = 5 We make the following observations: 1. If a is odd, then an − 1 is even, so it cannot be prime. 2. a n − 1 is always divisible by a − 1. Proof. a n − 1 = (a − 1)(a n−1 + an−2 + · · · + a2 + a + 1). We refer to this formula as the Geometric Series Formula. Thus, a n − 1 will always be composite unless a − 1 = 1, i.e. a = 2. Next, let’s look at a table of values of 2 n − 1. n 2 3 4 5 6 7 8 9 10 2 n − 1 3 7 Theorem 18.1 If n is divisible by m, then 2 n − 1 is divisible by 2 m − 1. Proof. Suppose that m | n. Then there is an integer k such that n = mk. Then 2 n = 2 mk = (2 m) k, 131 Stanford University EPGY Number Theory and 2 n − 1 = (2m) k − 1 = (2m − 1)((2 m) k−1 + (2 m) k−2 + · · · + (2 m) 2 + (2 m) + 1. Thus, if n is composite, then 2 n − 1 is composite, and we can conclude the following result. Theorem 18.2 If a n − 1 is prime for some integers a ≥ 2 and n ≥ 2, then a = 2 and n is prime. Deﬁnition 18.1 Primes of the form 2 p − 1 are called Mersenne primes. The ﬁrst few Mersenne primes are 22 − 1 = 3, 2 3 − 1 = 7, 2 5 − 1 = 31, 2 7 − 1 = 127, 2 13 − 1 = 8191. Note that not every number of the form 2 p − 1 is prime. For example, 2 11 − 1 = 2047 = 23 · 89 and 229 = 233 · 1103 · 2089. It is currently not known whether or not there are inﬁnitely many Mersenne primes. The largest known Mersenne prime is 2 43,112,609 − 1, discovered in 2008 at UCLA. This prime has 12,978,189 digits! You can partici- pate in the search for such primes by downloading software from the Great Internet Mersenne Prime Search (GIMPS) website: www.mersenne.org/prime.htm. The fol- lowing conjecture has been made (see American Mathematical Monthly, Volume 96, pages 125–128) about Mersenne primes, and it has been veriﬁed for all positive odd integers less than 20000000. Conjecture 18.1 Mersenne Prime Conjecture Let p be any odd natural num- ber. If two of the following conditions hold, then so does the third: 1. p = 2 k ± 1 or p = 4k ± 3. 2. 2 p − 1 is a prime. 3. 2 p + 1 3 is prime. Complete the following table. Is the conjecture valid for the values of p considered below? 132 Stanford University EPGY Number Theory p Is p = 2 k ± 1 or p = 4k ± 3 ? Is 2 p − 1 a prime? Is 2 p + 1 3 prime? 3 5 7 9 11 13 The integer 6 has the property that the sum of the proper divisors of 6 (i.e. the divisors of 6 other than 6 itself) is equal to 6: 1 + 2 + 3 = 6. Numbers with this property are called perfect numbers. Can you ﬁnd another perfect number? The Greeks knew a method for ﬁnding perfect numbers that is closely related to Mersenne primes. Theorem 18.3 Euclid’s Perfect Number Formula. If 2 p − 1 is a prime number, then 2 p−1(2 p − 1) is a perfect number. The ﬁrst two Mersenne primes are 2 2 − 1 = 3 and 2 3 − 1 = 7. If we apply Euclid’s Perfect Number Formula to these two Mersenne primes, we get the two perfect numbers 6 and 28. The next Mersenne prime is 2 5 − 1 = 31. Euclid’s formula gives us the perfect number 496. To check that 496 is a perfect number, we need to sum its proper divisors. We factor 496 as 496 = 2 4 · 31, so the proper divisors are 1, 2, 2 2, 2 3, 2 4, 31, 2 · 31, 2 2 · 31, 2 3 · 31. To illustrate the general method that we’ll use to prove Euclid’s Formula, we’ll add the divisors in two stages. First, 1 + 2 + 2 2 + 2 3 + 2 4 = 31, and second, 31 + 2 · 31 + 2 2 · 31 + 2 3 · 31 = 31 · 15. Then 31 + 31 · 15 = 496, 133 Stanford University EPGY Number Theory so 496 is indeed a perfect number. We can use a similar idea to prove Euclid’s Formula. Proof. Suppose that 2 p − 1 is prime. Then the proper divisors of 2 p−1(2 p − 1) are 1, 2, 2 2, 2 3, . . . , 2 p−1 and 2 p − 1, 2 · (2 p − 1), 2 2 · (2 p − 1), . . . , 2 p−2(2 p − 1). We add the divisors together to obtain: 1 + 2 + 2 2 + 2 3 + · · · + 2 p−1 = 2 p − 1 2 − 1 = 2 p − 1 and (2 p − 1) + 2(2 p − 1) + 2 2(2 p − 1) + · · · + 2 p−2(2 p − 1) = (2 p − 1)(1 + 2 + 2 2 + · · · + 2 p−2) = (2 p − 1) ( 2 p−1 − 1 2 − 1 ) = (2 p − 1)(2 p−1 − 1). Then the sum of the proper divisors of 2 p−1(2 p − 1) is (2 p − 1) + (2 p − 1)(2 p−1 − 1) = 2p−1(2 p − 1), so 2 p−1(2 p − 1) is indeed a perfect number. A natural question to ask at this point is whether Euclid’s Formula actually describes all perfect numbers. Does every perfect number have the form 2 p−1(2 p −1) with 2 p −1 prime, or are there other perfect numbers? Approximately 2000 years after Euclid’s death, Euler showed that Euclid’s Formula gives all even perfect numbers. Theorem 18.4 Euler’s Perfect Number Theorem. If n is an even perfect num- ber, then n is of the form n = 2 p−1(2 p − 1), where 2 p − 1 is a Mersenne prime. You will prove Euler’s Perfect Number Theorem as a series of exercises. To prove Euler’s Perfect Number Theorem, you will need to use the sigma function, which is deﬁned as follows. Deﬁnition 18.2 The sigma function σ(n) is deﬁned as σ(n) = sum of all divisors of n including 1 and n. 134 Stanford University EPGY Number Theory Example 18.1 σ(6) = 1 + 2 + 3 + 6 = 12 σ(8) = 1 + 2 + 4 + 8 = 15 σ(18) = 1 + 2 + 3 + 6 + 9 + 18 = 39. Theorem 18.5 Sigma Function Formulas. Suppose that p is prime and k ≥ 1. 1. σ(p) = p + 1 2. σ(pk) = 1 + p + p2 + · · · + pk = pk+1 − 1 p − 1 . 3. If gcd(m, n) = 1, then σ(mn) = σ(m)σ(n). The sigma function is related to perfect numbers in the following way. Recall that a number n is perfect if the sum of its divisors, other than n is equal to n. The sigma function is the sum of the divisors of n, including n. Thus, a number n is a perfect number exactly when σ(n) = 2n. Note that Euler’s Formula describes all even perfect numbers, but says nothing about odd perfect numbers. It is not currently known whether or not any odd perfect numbers exist. 135 Stanford University EPGY Number Theory Problem Set 1. Show that if a n + 1 is prime for some integers a ≥ 2 and n ≥ 1, then n must be a power of 2. 2. Let Fk = 2 2k + 1. For example, F1 = 5, F2 = 17, F3 = 257, F4 = 65537. Fermat thought that all the Fk’s might be prime, but Euler showed in 1732 that F5 factors as F5 = 641 · 6700417. In 1880, Landry showed that F6 is composite. Primes of the form 2 2k + 1 are called Fermat primes. Show that if k ̸= m, then gcd(Fk, Fm) = 1. Hint: if k > m, show that Fm | (Fk − 2). 3. The numbers 3 n−1 are never prime if n ≥ 2 since they are always even. However, it sometimes happens that 3 n − 1 2 is prime. For example, (3 3 − 1)/2 = 13 is prime. (a) Find another prime of the form (3 n − 1)/2. (b) If n is even, show that (3 n − 1)/2 is divisible by 4, so it can never be prime. (c) Show that if n is a multiple of 5, then (3 n − 1)/2 is not prime. (d) Do you think that there are inﬁnitely many primes of the form (3 n − 1)/2? 4. If m and n are integers with gcd(m, n) = 1, prove that σ(mn) = σ(m)σ(n). Hint: start by proving that σ(pq) = σ(p)σ(q) for distinct primes p and q. 5. Compute the following values of the sigma function. (a) σ(10) (b) σ(20) (c) σ(1728) 6. (a) Show that a power of 3 can never be a perfect number. (b) More generally, if p is an odd prime, show that a power pk can never be a perfect number. (c) Show that a number of the form 3 i · 5 j can never be a perfect number. (d) More generally, if p is an odd prime number greater than 3, show that the product 3 ipj can never be a perfect number. (e) Finally, show that if p and q are distinct odd prime numbers, then a number of the form qipj can never be a perfect number. 7. Show that a number of the form 3 m · 5 n · 7 k can never be a perfect number. 136 Stanford University EPGY Number Theory 8. Take any even perfect number, except 6. Now sum the digits of the resulting number. Then sum the digits of the sum, and repeat this process until you ob- tain a single digit. What will this digit be? Can you prove that your conjecture is always true? For reference, the ﬁrst several even perfect numbers (after 6) are 28, 496, 8128, and 33550336. 9. In this exercise, you will prove Euler’s Perfect Number Theorem. (a) Suppose that n = 2 km, where k ≥ 1 and m is odd, is an even perfect number. Show that σ(n) = 2n = (2 k+1 − 1)σ(m). (b) Show that there is some positive integer c so that σ(m) = 2 k+1c and m = (2 k+1 − 1)c. (c) Show that c = 1 by assuming that c > 1 and deriving a contradiction. (d) Conclude that σ(m) = 2 k+1 = m + 1. (e) Conclude that m is prime, and that if n is an even perfect number, then n is of the form n = 2 k(2 k+1 − 1), where (2k+1 − 1) is prime. 10. If the product of the divisors of a number n (other than n itself) is equal to n, then we say that n is a product perfect number. For example, 6 is a product perfect number since 1 · 2 · 3 = 6. (a) List all product perfect numbers between 2 and 50. (b) Describe all product perfect numbers. Your description should be precise enough to enable you to easily solve such problems as “Is 35710 product perfect?” and “Find a product perfect number larger than 10000.”. 137 Chapter 19 Powers Modulo m and Successive Squaring How would you compute 5 100000000000000 mod 12830603? If 12830603 were prime, we might try using Fermat’s Little Theorem, or the Euler- Fermat Theorem if it is not prime. However, we would like to be able to compute 5 100000000000000 mod 12830603 without ﬁrst having to factor 12830603. In fact, later we will want to be able to compute ak mod m for numbers a, k, m that have hundreds of digits, so we certainly do not want to have to factor m ﬁrst. These computations will be important when we study RSA Public Key Cryptography. The method that we will use to compute a k mod m is called the method of successive squaring. We will illustrate the idea with an example. Example 19.1 Compute 7 327 mod 853. Solution: First, observe that 327 = 256 + 64 + 4 + 2 + 1. Thus, 7 327 = 7 2567 647 47 27 1. We can compute the 2 k-powers of 7 modulo 853 by successive squaring, as illustrated below. 138 Stanford University EPGY Number Theory 7 1 ≡ 7 mod 853 7 2 ≡ 49 mod 853 7 4 ≡ (49) 2 ≡ 695 mod 853 7 8 ≡ (695) 2 ≡ 227 mod 853 7 16 ≡ (227) 2 ≡ 349 mod 853 7 32 ≡ (349) 2 ≡ 675 mod 853 7 64 ≡ (675) 2 ≡ 123 mod 853 7 128 ≡ (123) 2 ≡ 628 mod 853 7 256 ≡ (628) 2 ≡ 298 mod 853 Thus, 7 327 = 7 2567 647 47 27 1 ≡ 298 · 123 · 695 · 49 · 7 mod 853 ≡ 828 · 695 · 49 · 7 mod 853 ≡ 538 · 49 · 7 mod 853 ≡ 727 · 7 mod 853 ≡ 286 mod 853. Example 19.2 Using successive squaring, show that 2 283976710803262 ≡ 280196559097287 mod 283976710803263. Is the number 283976710803263 prime or composite? Solution: If 283976710803263 were prime, then 2 283976710803262 would be congruent to 1 modulo 2839767108032623. Thus, 2839767108032623 is composite. Note that we have determined that 2839767108032623 is composite without actually computing any factors. 139 Stanford University EPGY Number Theory Problem Set 1. Use the method of successive squaring to compute each of the following: (a) 5 13 mod 23 (b) 28 749 mod 1147 (c) 999 179 mod 1763 2. (a) Compute 7 7386 mod 7387. Is 7387 prime? (b) Compute 7 7392 mod 7393. Is 7393 prime? 3. Show that 1763 is composite. Hint: compute 21762 mod 1763. 4. Show that 1387 is composite. 5. (a) Show that 11111 is composite. (b) Show that 1111111 is composite. (c) Show that 1111111111111 is composite. 140 Chapter 20 Computing k-th Roots Modulo m We have learned how to solve linear congruences of the form ax ≡ b mod m and quadratic congruences of the form x2 ≡ b mod m. In this section, we will develop techniques for solving congruences of the form xk ≡ b mod m, where k ≥ 3. These methods will be important when we study RSA Public Key Cryptography. Example 20.1 Solve the congruence x131 ≡ 758 mod 1073. Solution: First, we compute ϕ(1073). Since 1073 = 29 · 37, ϕ(1073) = ϕ(29)ϕ(37) = 28 · 36 = 1008. Next, we observe that gcd(131, 1008) = 1, so there are integers u and v such that 131u + 1008v = 1. Using the method described in Chapter 5, we ﬁnd u = 731 and v = −95. Thus, 131 · 731 − 1008 · 95 = 1. Using this equation, we obtain the following: (x131) 731 = x131·731 = x1+1008·95 = x · (x1008) 95. 141 Stanford University EPGY Number Theory By the Euler-Fermat Theorem, x1008 ≡ 1 mod 1073. Thus, (x131) ≡ x mod 1073, so the original congruence becomes x ≡ (x131) 731 ≡ 758 731 mod 1073. Thus, to ﬁnd the solution of the original congruence, we must compute 758 731 mod 1073. We can do this using the method of successive squaring. First, observe that 731 = 512 + 128 + 64 + 16 + 8 + 2 + 1 758 731 = 758 512 · 758 128 · 758 64 · 758 16 · 758 8 · 758 2 · 758. Computing powers of 758 modulo 1073, we obtain: 758 ≡ 758 mod 1073 758 2 ≡ 509 mod 1073 758 4 ≡ 488 mod 1073 758 8 ≡ 1011 mod 1073 758 16 ≡ 625 mod 1073 758 32 ≡ 53 mod 1073 758 64 ≡ 663 mod 1073 758 128 ≡ 712 mod 1073 758 256 ≡ 488 mod 1073 758 512 ≡ 1011 mod 1073. Thus, 758 731 = 758 512 · 758 128 · 758 64 · 758 16 · 758 8 · 758 2 · 758 ≡ 1011 · 712 · 663 · 625 · 1011 · 509 · 758 mod 1073 ≡ 922 · 197 · 632 · 758 mod 1073 ≡ 297 · 498 mod 1073 ≡ 905 mod 1073. Finally, note that we can use successive squaring to check that 905 131 ≡ 758 mod 1073. 142 Stanford University EPGY Number Theory The general method for computing k-th roots modulo m is described by the following algorithm. Algorithm 20.1 Computing k-th Roots Modulo m. Let b, k, and m be integers such that gcd(b, m) = 1 and gcd(k, ϕ(m)) = 1. Then the following steps give a solution to the congruence xk ≡ b mod m. 1. Compute ϕ(m). 2. Use the Euclidean Algorithm to ﬁnd integers u and v that satisfy ku + ϕ(m)v = 1. 3. Compute bu mod m by successive squaring. The value obtained gives the so- lution x. Proof. We need to check that x = bu is a solution to the congruence xk ≡ b mod m. xk = (bu) k = buk = b1−ϕ(m)v = b · (bϕ(m)) −v ≡ b mod m. 143 Stanford University EPGY Number Theory Problem Set 1. Solve the congruence x329 ≡ 452 mod 1147. 2. Solve the congruence x113 ≡ 347 mod 463. 3. Solve the congruence x275 ≡ 139 mod 588. 4. (a) Try to use the method described in the Algorithm for Computing k-th Roots Modulo m to compute the square root of 23 modulo 1279 (note: the number 1279 is prime). What goes wrong? (b) More generally, if p is an odd prime, explain why the method described in the Algorithm cannot be used to ﬁnd square roots modulo p. (c) Even more generally, explain why the Algorithm for Computing k-th Roots Modulo m does not work if gcd(k, ϕ(m)) > 1. 144 Chapter 21 RSA Public Key Cryptography In this section, we describe a technique for encoding and decoding messages. 1. The ﬁrst step in encoding a message is to convert it into a string of numbers. One simple method for doing this is to set A = 11, B = 12, C = 13, . . . , Z = 36. Here is a convenient table to use: A B C D E F G H I J K L M 11 12 13 14 15 16 17 18 19 20 21 22 23 N O P Q R S T U V W X Y Z 24 25 26 27 28 29 30 31 32 33 34 35 36 Note that we have ignored spaces and other punctuation marks. 2. Next, we choose two large primes p and q and multiply them together to obtain a modulus m. We also compute ϕ(m) = ϕ(pq) = (p − 1)(q − 1). 3. Next, we choose a number k such that gcd(k, ϕ(m)) = 1. 4. Next, publish the numbers k and m for anyone to know, and keep the values of p and q secret. 5. Anyone who wants to encode a message to send to us can use the values of m and k to encode the message in the following way. (a) First, they convert their message into a string of digits as described above. (b) Next, they look at the number m and break their string of digits into numbers that are less than m so that their message is a list of numbers a1, a2, . . . , ar. 145 Stanford University EPGY Number Theory (c) Next, they use successive squaring to compute ak 1 mod m, ak 2 mod m, . . . , a k r mod m. These values form a new list of numbers b1, b2, . . . br. This list is the encoded message. 6. To decode the message once we receive it, we use the following method. (a) We have received the list of numbers b1, b2, . . . , br, and we need to recover the numbers a1, a2, . . . , ar. (b) Recall that each bi is congruent to ak i modulo m, so to ﬁnd each ai, we must solve the congruence xk ≡ bi mod m. Using the Algorithm for Computing k-th Roots Modulo m (described in Chapter 20), we can do this if we know ϕ(m). (c) Since we know the values of p and q with m = pq, we know that ϕ(m) = ϕ(pq) = (p − 1)(q − 1) = pq − p − q + 1 = m − p − q + 1. (d) Finally, we apply the Algorithm for Computing k-th Roots Modulo m to solve each of the congruences xk ≡ bi mod m. The solutions are the num- bers a1, a2, . . . , ar. We then use this string of digits to recover the original message. For reference, here is the Algorithm for Computing k-th Roots Modulo m: Let b, k, and m be integers such that gcd(b, m) = 1 and gcd(k, ϕ(m)) = 1. Then the following steps give a solution to the congruence xk ≡ b mod m. i. Compute ϕ(m). ii. Use the Euclidean Algorithm to ﬁnd integers u and v that satisfy ku + ϕ(m)v = 1. iii. Compute bu mod m by successive squaring. The value obtained gives the solution x. Example 21.1 Encode the message “STANFORD” using the public key m = 143 and k = 23. Solution: First, we convert the text “STANFORD” to a string of numbers: 2930111416252814. The number m has three digits, so we break up the message 2930111416252814 as a string of numbers that are 2 digits each: 29, 30, 11, 24, 16, 25, 28, 14. 146 Stanford University EPGY Number Theory Next, we use successive squaring to compute the 23-rd power of each number modulo 143. First, we compute 29 23 mod 143. We have: 29 23 = 29 1629 429 229 1 29 ≡ 29 mod 143 29 2 ≡ 126 mod 143 29 4 ≡ 3 mod 143 29 8 ≡ 9 mod 143 29 16 ≡ 81 mod 143. Thus, 29 23 ≡ 81 · 3 · 126 · 29 ≡ 35 mod 143. Use successive squaring to compute the 23-rd power of each of the remaining numbers modulo 143: 29 23 ≡ 35 mod 143 30 23 ≡ mod 143 11 23 ≡ mod 143 24 23 ≡ mod 143 16 23 ≡ mod 143 25 23 ≡ mod 143 28 23 ≡ mod 143 14 23 ≡ mod 143 Example 21.2 Decode the message 20, 130, 62, 107 using the primes p = 11 and q = 13 and k = 23. Solution: We must solve the congruences a 23 1 ≡ 20 mod 143 a 23 2 ≡ 130 mod 143 a 23 3 ≡ 62 mod 143 a 23 4 ≡ 107 mod 143 147 Stanford University EPGY Number Theory We can solve each of these using the Algorithm for Computing k-th Roots Modulo m. Since we know the primes p = 11 and q = 13, we can compute ϕ(m) = ϕ(11)ϕ(13) = 10 · 12 = 120. Next, we ﬁnd integers u and v such that 23u + 120v = 1. Using the Euclidean Algorithm, we obtain u = 47 and v = −9. We are now able to solve each congruence. To solve the ﬁrst congruence, we compute 20 u = 20 47 modulo 143 by successive squaring. We obtain: 20 47 = 20 3220 820 420 220 1 20 1 ≡ 20 mod 143 20 2 ≡ 114 mod 143 20 4 ≡ 126 mod 143 20 8 ≡ 3 mod 143 20 16 ≡ 9 mod 143 20 32 ≡ 81 mod 143 Thus, 20 47 ≡ 20 · 114 · 126 · 3 · 81 ≡ 15 mod 143, so the ﬁrst number in the message is 15, which corresponds to the letter E. Finish decoding the message by solving the remaining 3 congruences. Example 21.3 Encode the message “To be or not to be” using the primes p = 12553 and q = 13007. Solution: First, we compute the modulus m = pq = 163276871 and ϕ(m) = 163251312. We also need to choose a k that is relatively prime to ϕ(m). We choose k = 79921. The message “TOBEORNOTTOBE” becomes the string of digits 30251215252824253030251215. 148 Stanford University EPGY Number Theory The modulus m is 9 digits long, so we break the message up into 8-digit numbers: 30251215, 25282425, 30302512, 15. Next, we use the method of successive squaring to raise each of these numbers to the k-th power modulo m: 30251215 79921 ≡ 149419241 mod 163276871 25282425 79921 ≡ 62721998 mod 163276871 30302512 79921 ≡ 118084566 mod 163276871 15 79921 ≡ 40481382 mod 163276871 Thus, the encoded message is the list of numbers 149419241, 62721998, 118084566, 40481382. It is natural to consider how secure this cryptosystem is. Suppose that a message is intercepted by a third party. Since the modulus m and the exponent k are public, the third party can decode the message if they can ﬁnd the value of ϕ(m) = ϕ(p)ϕ(q). So to decode the message, the third party must factor m to ﬁnd the primes p and q. If m consists of 5 to 10 digits, then a computer will ﬁnd the factors of m almost immediately. Using advanced methods from number theory, mathematicians have constructed techniques for factoring numbers with 50 to 100 digits. Thus, if the primes p and q have, say, 100 digits each, then there are no known techniques for the third party to determine p and q from the modulus m = pq. The idea underlying this coding technique is that although it is easy to multiply large numbers together, it is very diﬃcult to factor a large number. The cryptographic method described here is called a public key cryptography system because the encoding key consisting of the modulus m and the exponent k can be distributed to the public while the decoding method remains secure. This particular public key cryptosystem is called the RSA public key cryptosystem and is named after its inventors Ron Rivest, Adi Shamir, and Leonard Adleman, who invented the system in 1977. 149 Stanford University EPGY Number Theory Problem Set 1. Decode the following message, which was sent using the modulus m = 7081 and the exponent k = 1789: 5192, 2604, 4222. Note that you will ﬁrst need to factor m. 2. Research the history of public key cryptography and public key digital sig- natures. Discuss the political and social consequences of the availability of inexpensive unbreakable codes. 3. The problem of factoring large numbers has been much studied recently due to its importance in public key cryptography. Research each of the following factorization methods. (a) Pollard’s ρ method (b) Pollard’s ρ − 1 method (c) The quadratic sieve factorization method (d) Lenstra’s elliptic curve factorization method (e) The number ﬁeld sieve 150 Chapter 22 Pythagorean Triples Deﬁnition. A Pythagorean triple is a triple (a, b, c) of integers such that a 2 + b2 = c2. The study of Pythagorean triples began long before the time of Pythagoras. In fact, there are Babylonian tablets, dating to around 1800 BC, that contain lists of such triples, including quite large ones, which indicates that the Babylonians probably had a systematic method for producing them. (a) Find 4 examples of Pythagorean triples. (b) Show that there are inﬁnitely many Pythagorean triples by showing that if (a, b, c) is a Pythagorean triple, then (da, db, dc) is also a Pythagorean triple for any integer d. (c) A primitive Pythagorean triple is a triple of numbers (a, b, c) that have no common factors and satisfy a2 + b2 = c2. Find 4 examples of primitive Pythagorean triples. (d) Prove that if (a, b, c) is a primitive Pythagorean triple, then either a is odd and b is even or a is even and b is odd. Also prove that c is always odd. (e) Observe that if (a, b, c) is a primitive Pythagorean triple, then a2 = c2 − b2 = (c − b)(c + b). For example, 3 2 = 5 2 − 4 2 = (5 − 4)(5 + 4) = 1 · 9. Write the Pythagorean triples (15, 8, 17), (35, 12, 37), (33, 56, 65), (21, 20, 29), (63, 16, 65) in this form (i.e. factor a 2 as a product of (c − b) and (c + b). In each case, what do you observe about (c − b) and (c + b)? Prove that your observation is true for any primitive Pythagorean triple. 151 Stanford University EPGY Number Theory (f) Prove that any primitive Pythagorean triple (a, b, c) with a odd and b even can be obtained by using the formulas a = st, b = s2 − t 2 2 , c = s2 + t 2 2 , where s, t ≥ 1 are chosen to be any odd integers with no common factors. (g) Show that if (a, b, c) is a primitive Pythagorean triple, then either a or b must be a multiple of 3. (h) By examining the list of primitive Pythagorean triples in Problem 5, make a guess about whether a, b, or c is a multiple of 5. Try to show that your guess is correct. (i) For each of the following questions, begin by compiling some data; next examine the data and formulate a conjecture. Finally, try to prove that your conjecture is correct. i. Which odd numbers a can appear in a primitive Pythagorean triple (a, b, c)? ii. Which even numbers b can appear in a primitive Pythagorean triple (a, b, c)? iii. Which numbers c can appear in a primitive Pythagorean triple (a, b, c)? (j) Observe that 33 2 + 56 2 = 65 2 and 162 + 63 2 = 65 2 are 2 primitive Pythagorean triples with the same value of c. Can you ﬁnd 3 primitive Pythagorean triples with the same value of c? Can you ﬁnd more than 3? (k) Observe that (3, 4, 5), (15, 8, 17), (35, 12, 37), (63, 16, 65) are all primitive Pythagorean triples that have c = a + 2. i. Find two more primitive Pythagorean triples that have c = a + 2. ii. Find a formula that describes all primitive Pythagorean triples (a, b, c) that have c = a + 2. iii. For each primitive Pythagorean triple (a, b, c) that you’ve seen so far, compute the quantity 2c − 2a. Do these values seem to have some special form? Try to prove that your observation is true for all primitive Pythagorean triples. 152 Chapter 23 Which Primes are Sums of Two Squares? In this problem set, you will consider the following question: which prime num- bers can be written as a sum of two squares? For example, the number 5 is a sum of two squares, since 5 = 1 2 + 2 2. On the other hand, 19 cannot be written as a sum of two squares. To check this, note that none of the diﬀerences 19 − 1 2 = 18, 19 − 2 2 = 15, 19 − 3 2 = 10, 19 − 4 2 = 3 is a square. In general, to check if a given number m is a sum of two squares, we check the numbers m − 0 2, m − 1 2, m − 2 2, . . . until you obtain a square or until the numbers become negative. (a) i. Make a list of the primes p, 5 ≤ p ≤ 229 that can be written as a sum of two squares. (Ignore p = 2 for now.) ii. Make a list of the primes p, 3 ≤ p ≤ 227 that cannot be written as a sum of two squares. iii. Do you observe any patterns? Consider the primes modulo 4. If p ≡ 1 mod 4, is p always, sometimes, or never a sum of two squares? If p ≡ 3 mod 4, is p always, sometimes, or never a sum of two squares? (b) Prove that if the prime p can be written as a sum of two squares, then p ≡ 1 mod 4. (c) In the next problem, you will show that if p is a prime that is congruent to 1 modulo 4, then p can be written as a sum of two squares. In this problem, you will work through the method of proof known as Fermat’s Descent Procedure for the speciﬁc example p = 881. 153 Stanford University EPGY Number Theory i. Verify that 387 2 + 1 2 = 170 · 881. Thus, you have written a multiple of p as a sum of two squares. ii. Verify that u = 47 and v = 1 satisfy u ≡ 387 mod 170, v ≡ 1 mod 170, − 170 2 ≤ u, v ≤ 170 2 . iii. Verify that 47 2 + 1 2 ≡ 387 2 + 1 2 ≡ 0 mod 170, so 170 | (47 2 + 1 2) and 170 | (387 2 + 1 2). iv. Verify that 47 2 + 1 2 = 170 · 13 and 387 2 + 1 2 = 170 · 881. v. Multiply the equations in the previous step to show that (47 2 + 1 2)(387 2 + 1 2) = 170 2 · 13 · 881. vi. Use the identity (u2 + v2)(A2 + B2) = (uA + vB) 2 + (vA − uB) 2 to show that 18190 2 + 340 2 = 1702 · 13 · 881. vii. Divide by 170 2 to show that 107 2 + 2 2 = 13 · 881. viii. Observe that you have written a smaller multiple of 881 as a sum of two squares, and that you can repeat this process until p itself is written as a sum of two squares. (d) In this problem, you will use Fermat’s Descent Procedure to show that if p ≡ 1 mod 4, then p can be written as a sum of two squares. So, suppose that p is a prime that is congruent to 1 modulo 4. i. Show that there exists an integer A such that p | (A2 + 1). Hint: use quadratic reciprocity. If you haven’t read the sections on quadratic reciprocity yet, just assume that there is an integer A such that p | (A2 + 1), and continue with the problem. It is always true that if p ≡ 1 mod 4, then there is an integer A such that p | (A2 + 1). ii. Show that there exist integers B (B = 1) and M such that A2 + B2 = M p. Show that M < p. 154 Stanford University EPGY Number Theory iii. Observe that if M = 1, then we’re done, so suppose that M ≥ 2. Choose numbers u and v satisfying u ≡ A mod M, v ≡ B mod M, − 1 2M ≤ u, v ≤ 1 2M. Show that there exists an integer r such that u2 + v2 = M r. iv. Show that (u2 + v2)(A2 + B2) = M 2rp. v. Show that r ≥ 1. vi. Show that r < M . vii. Show that M | (uA + vB). Hint: use the identity (u2 + v2)(A2 + B2) = (uA + vB) 2 + (vA − uB) 2. viii. Show that M | (vA − uB). Hint: use the identity (u2 + v2)(A2 + B2) = (uA + vB) 2 + (vA − uB) 2. ix. Conclude that ( uA + vB M )2 + ( vA − uB M )2 = rp. This means that you have written a smaller multiple of p as a sum of two squares. x. Observe that you can repeat this process to write an even smaller mul- tiple of p as a sum of two squares. Continuing repeatedly, observe that you must eventually end up with p itself written as a sum of two squares. (e) Make a list of all primes p < 50 that can be written in the form p = a 2 + ab + b2. For example, p = 7 has this form with a = 2 and b = 1, while p = 11 cannot be written in this form. Try to ﬁnd a pattern and make a guess as to exactly which primes have this form, and try to prove at least part of your conjecture. (f) Make a list of all primes p < 50 that can be written in the form p = a 2 + 2b2. Try to ﬁnd a pattern and make a guess as to exactly which primes have this form, and try to prove at least part of your conjecture. (g) Suppose that p is a prime not equal to 5. If p can be written in the form p = a + 5b2, show that p ≡ 1 or 9 mod 20. 155 Stanford University EPGY Number Theory (h) Use the Descent Procedure twice, starting from the equation 557 2 + 55 2 = 26 · 12049 to write the prime 12049 as a sum of two squares. (i) Use the Descent Procedure, starting from the equation 259 2 + 1 2 = 34 · 1973 to write the prime 1973 as a sum of two squares. (j) Which primes p < 100 can be written as a sum of three squares, p = a 2 + b2 + c2? Based on the data that you collect, try to make a conjecture describing which primes can be written as a sum of three squares. 156 Chapter 24 Lagrange’s Theorem In this series of exercises, you will prove Lagrange’s Theorem, which states that every positive integer can be expressed as the sum of four squares. For example, 5 = 2 2 + 1 2 + 0 2 + 0 2, 21 = 4 2 + 2 2 + 1 2 + 0 2, 127 = 11 2 + 2 2 + 1 2 + 1 2. 1. Show that 1 can be written as a sum of four squares. 2. Verify that (x2 1 + x2 2 + x2 3 + x2 4)(y2 1 + y2 2 + y2 3 + y2 4) = (x1y1 + x2y2 + x3y3 + x4y4) 2 +(x1y2 − x2y1 + x3y4 − x4y3) 2 +(x1y3 − x3y1 + x4y2 − x2y4) 2 +(x1y1 + x2y2 + x3y3 + x4y4) 2. (This is known as Euler’s identity). Conclude that the product of two numbers that are a sum of four squares is also a sum of four squares. Thus, since every positive integer greater than 1 can be expressed as a product of primes, it’s enough to show that every prime can be expressed as a sum of four squares. 3. Show that 2 can be written as a sum of four squares. 4. Show that if p is an odd prime, then there are integers x, y, m such that 1 + x2 + y2 = mp. 5. Show that if p is an odd prime, then there exists an integer m such that 0 < m < p and integers x1, x2, x3, x4 such that mp = x2 1 + x2 2 + x2 3 + x2 4. 6. Show that the least m with this property is m = 1, and conclude that every prime p can be written as a sum of four squares. 157 Stanford University EPGY Number Theory 7. A related problem is to determine which positive integers can be expressed as a sum of three squares. Prove that any number of the form 4 t(8k + 7), where t and k are positive integers, can NOT be expressed as a sum of three squares. 8. Given a particular positive integer n, how can you (eﬃciently) write n as a sum of four squares? Try to determine an algorithm for writing a positive integer as a sum of four squares. 158 Chapter 25 Continued Fractions Note: A calculator is required for this set of exercises, so if you don’t have one, work with someone that does! 1. Observe that we can write the fraction 210 47 as 4 + 1 2 + 1 7+ 1 3 . This is called the continued fraction expansion for the fraction 210 47 . Note that in the continued fraction expansion, all of the denominators are equal to 1. A more compact notation for this continued fraction expansion is [4; 2, 7, 3]. Find the simple fraction corresponding to the continued fraction expansion [1; 2, 3, 4]. 2. To ﬁnd the continued fraction expansion of 8 5, use the following procedure: 8/5 = 1 + 3/5 = 1 + 1/5/3 = 1 + 1 1 + 2 3 = 1 + 1 1 + 1 1+ 1 2 3. Consider the decimal expansion of π: π = 3.1415926535897932384626433 . . . Observe that we can write this as π = 3 + something, 159 Stanford University EPGY Number Theory where the “something” is a number between 0 and 1. Next, observe that we can rewrite this as: π = 3 + 0.1415926535897932384626433 . . . = 3 + 1 1 0.1415926535897932384626433... = 3 + 1 7.06251330593104576930051 . . . = 3 + 1 7 + 0.06251330593104576930051 . . . = 3 + 1 7 + a little bit more The ﬁnal equation above gives the fairly good approximation 22 7 for π. Now, if we repeat this process, we obtain: 0.06251330593104576930051 . . . = 1 1 0.06251330593104576930051... = 15.996594406685719888923060 = 15 + 0.996594406685719888923060 Thus, we have the following representation of π: π = 3 + 1 7 + 1 15+0.996594406685719888923060 The bottom level of this fraction is 15.996594406685719888923060, which is very close to 16. If we replace it with 16, we get a rational number that is very close to π: 3 + 1 7 + 1 16 = 355 113 = 3.1415929203539823008849557 . . . The fraction 355 113 agrees with π to six decimal places. Continue this process, at each stage ﬂipping the decimal that is left over and then separating oﬀ the whole integer part, to obtain a four-layer fraction repre- sentation of π. Use your ﬁnal representation to get a rational number approxi- mation for π, and compare with the known decimal approximation of π to see how accurate your approximation is. 160 Stanford University EPGY Number Theory 4. An expression of the form x = a0 + 1 a1 + 1 a2+ 1 a3+ 1 ··· is called the continued fraction expansion of x. Use the procedure described above to compute the ﬁrst 10 terms in the continued fraction of √2. 5. Find the continued fraction of 3.245. 6. Compute the ﬁrst 10 terms in the continued fraction of e = 2.7182818 . . .. 7. (a) Compute the ﬁrst 10 terms in the continued fractions of √3 and √5. (b) Do the terms in the continued fraction of √3 appear to follow a repetitive pattern? If so, prove that they really do repeat. (c) Do the terms in the continued fraction of √5 appear to follow a repetitive pattern? If so, prove that they really do repeat. 8. Compute the ﬁrst 10 terms in the continued fraction expansion of the golden ratio ϕ = 1 + √5 2 . 9. Find the following remarkable continued fractions: (a) 4 π (b) e (c) e 1/s + 1 e1/s − 1 (d) (√ ϕ + 2 − √ ϕ ) e 2π/5, where ϕ = 1+√5 2 is the golden ratio. 10. Since all of the numerators in a continued fraction expansion are 1, we can express continued fraction expansions in a more convenient way by just listing the denominators. We write [a0, a1, a2, a3, . . .] as shorthand for the continued fraction a0 + 1 a1 + 1 a2+ 1 a3+ 1 ··· Using this notation, our continued fraction expansion of π can be written as π = [3, 7, 15, 1, 292, 1, 1, 1, 2, 1, 3, 1, 14, 2, 1, 1, 2, . . .]. 161 Stanford University EPGY Number Theory (a) The continued fraction expansion of π2 is [?, ?, ?, 1, 2, 47, 1, 8, 1, 1, 2, 2, 1, 1, 8, 3, 1, 10, . . .]. Fill in the three initial missing entries. (b) Use the ﬁrst ﬁve terms in the continued fraction of π2 to ﬁnd a rational number that is close to π2. How close do you come? 11. We have seen that if a number α has a continued fraction expansion α = [a0, a1, a2, . . .], then cutting oﬀ after a few terms gives a rational number that is close to α. The n-th convergent to α is the rational number pn qn = [a0, a1, a2, . . . , an] = a0 + 1 a1 + 1 a2+ 1 a3+···+ 1 an obtained by using the terms up to an in the continued fraction expansion of α. For example, for the continued fraction expansion of π = [3; 7, 15, 1, 292, 1, 1, 1, 2, 1, 3, 1, 14, 2, 1, 1, 2, . . .], the ﬁrst few convergents are: p0 q0 = 3 p1 q1 = 3 + 1 7 = 22 7 = 3.142857143 p2 q2 = 1 + 1 7 + 1 15 = 333 106 = 3.141509434 For the continued fraction expansion of √2 = [1, 2, 2, 2, 2, 2, 2, 2, . . .], the ﬁrst few convergents are: p0 q0 = 1 p1 q1 = 1 + 1 2 = 3 2 = 1.5 p2 q2 = 1 + 1 2 + 1 2 = 7 5 = 1.4 For each n = 1, 2, . . . , 7, compute the n-th convergent to √3. 162 Stanford University EPGY Number Theory 12. Find the ﬁrst 10 convergents in the continued fraction expansion of ϕ = 1+√5 2 . What do you observe? Hint: Fibonacci numbers. See 17 for more information on Fibonacci numbers. 13. As in the previous problem, let pn qn = [a0, a1, a2, . . . , an] = a0 + 1 a1 + 1 a2+ 1 a3+ 1 an denote the n-th convergent to α. (a) Show that p0 = a0 and q0 = 1. (b) Show that p1 = a1a0 + 1 and q1 = a1. (c) Show that p2 = a2a1a0 + a2 + a0 and q2 = a2a1 + 1. (d) Show that p3 = a3a2a1a0 + a3a2 + a3a0 + a1a0 + 1 and q3 = a3a2a1 + a3 + a1. (e) Show that, for all n ≥ 2, pn = anpn−1 + pn−2. (f) Show that, for all n ≥ 2, qn = anqn−1 + qn−2. 14. Let the decimal expansion of α be α = b + b1 10 + b2 102 + b3 103 + · · · , where 0 ≤ bk ≤ 9 for all k. Suppose that for some convergent pn qn , we have qn = 100. Prove that either b3 = b4 = 0 or b3 = b4 = 9. 163 Chapter 26 Geometric Numbers Triangular numbers are numbers that can be arranged in a triangular pattern. Visualize each triangle as sitting inside the next. The n-th triangular number Tn is formed using an outer triangle whose sides have n dots: The ﬁrst 5 triangular numbers are 1, 3, 6, 10, 15. Observe that the n-th triangular number, which we will denote Tn, is Tn = 1 + 2 + 3 + · · · + n = n(n + 1) 2 . Square numbers are numbers that can be arranged in the shape of a square: Visualize each square as sitting inside the next. The n-th square number is formed using an outer square whose sides have n dots. The n-th square number is Sn = n2. A pentagonal number is a number that can be arranged in the shape of a pentagon: 164 Stanford University EPGY Number Theory The ﬁrst four pentagonal numbers are 1, 5, 12, 22. Visualize each pentagon as sitting inside the next one. The n-th pentagonal number is formed using an outer pentagon whose sides have n dots. Hexagonal (and septagonal, r-gonal, etc.) numbers are deﬁned similarly. 165 Stanford University EPGY Number Theory Problem Set Note: Whenever possible, try to come up with geometric (rather than induction) proofs of the properties in the following problems. 1. Explain geometrically why Tn = n(n + 1) 2 for all integers n ≥ 1. 2. (a) Compute T1 + T2, T2 + T3, T3 + T4, and T4 + T5. (b) Computing more expressions of the form Tn + Tn+1 if necessary, make a conjecture about the sum of any two consecutive triangular numbers Tn and Tn+1, and prove that your conjecture is true for all integers n ≥ 1. 3. (a) Compute 8T1 + 1, 8T2 + 1, 8T3 + 1, 8T4 + 1, and 8T5 + 1. (b) Computing more expressions of the form 8Tn + 1 if necessary, make a con- jecture about the expression 8Tn + 1, and prove that your conjecture is correct for all integers n ≥ 1. 4. Can you ﬁnd any interesting equations that relate Ta+b To Ta and Tb? How about Tab? 5. Show that if T is a triangular number, then 9T + 1 is also a triangular number. 6. What are the possible digits that a triangular number can end in? 7. What are the possible digits that a square number can end in? 8. What are the possible last 2 digits that a square number can end in? 9. The digital root of a number is obtained in the following way. Start with your number, and sum its digits. Then sum the digits of the resulting number, and continue until only one digit remains. This is called the digital root. What are the possibilities for the digital root of a triangular number? What are the possibilities for the digital root of a square number? 10. How many four digit square numbers are composed of only even digits? What four digit square numbers can be reversed and become the square of another number? 11. (a) Compute 1 3, 1 3 + 2 3, 1 3 + 2 3 + 3 3, 1 3 + 2 3 + 3 3 + 4 3, and 1 3 + 2 3 + 3 3 + 4 3 + 5 3. (b) Computing more expressions of the form 1 3 + 2 3 + 3 3 + · · · + n3 if necessary, make a conjecture about how the sum of the ﬁrst n cubes is related to the n-th triangular number Tn. Prove that your conjecture is correct for all integers n ≥ 1. 12. (a) Compute 3T2 + T1, 3T3 + T2, 3T4 + T3, 3T5 + T4, and 3T6 + T5. 166 Stanford University EPGY Number Theory (b) Computing more expressions of the form 3Tn + Tn−1 if necessary, make a conjecture about the expression 3Tn + Tn−1, and prove that your conjecture is correct for all integers n ≥ 1. 13. Can you ﬁnd any triangular numbers whose square is also a triangular number? 14. Compile some data and try to make a conjecture about which numbers can be written as a sum of two triangular numbers. For example, 7 = 1 + 6 and 25 = 10 + 15 are sums of two triangular numbers, while 19 cannot be written as the sum of two triangular numbers. Can you prove your conjecture? 15. There are 6 triangular numbers that can be expressed as the product of three consecutive integers. Can you ﬁnd them? 16. Triangular numbers that can be expressed as a product of two primes are called triangular semiprimes. For example, 6 is a triangular semiprime because 6 = 2 · 3. Can you ﬁnd other triangular semiprimes? 17. Are there 4 distinct triangular numbers in geometric progression? 18. Show that every even perfect number is triangular. Perfect numbers are numbers n with the property that the sum of the proper divisors of n (not including n) sum to n. For example, 6 is a perfect number because 1+2+3 = 6. See Chapter 18 for more information on prefect numbers. 19. Show that every positive integer can be expressed as a sum of 3 or fewer trian- gular numbers. 20. Investigate the minimum number of squares needed to represent a given number. Do you see any patterns? For each number k, compare the minimum number of squares needed to represent k with the minimum number needed to represent k2. What do you observe? (Note: it is known that every positive integer can be expressed as a sum of 4 or fewer square numbers.) 21. (a) What is the 5-th pentagonal number? (b) Find a general formula for the n-th pentagonal number Pn. (c) How do pentagonal numbers relate to triangular numbers? Find a number c such that the following is true: If P is a pentagonal number, then there is a triangular number T such that P = cT . (d) There are conjectured to be exactly 210 positive integers that cannot be expressed as the sum of 3 pentagonal numbers. Find 6 of them. (e) There are only 6 positive integers that cannot be expressed as the sum of 4 pentagonal numbers. Find them. (f) Show that every positive integer can be expressed as a sum of 5 or fewer pentagonal numbers. 167 Stanford University EPGY Number Theory 22. (a) Find a general formula for the n-th hexagonal number. (b) Show that every hexagonal number is also a triangular number. Is every triangular number also a hexagonal number? If not, can you classify which ones are? (c) There are exactly 13 positive integers that cannot be expressed as a sum of 4 hexagonal numbers. Find 6 of them. (d) There are only 2 positive integers that cannot be expressed as a sum of 5 hexagonal numbers. Find them. (e) Show that every positive integer can be expressed as a sum of 6 hexagonal numbers. 23. More generally, ﬁnd a general formula for the n-th r-gonal number. Show that every positive integer can be expressed as a sum of r r-gonal numbers. 24. A tetrahedral number is a number corresponding to a conﬁguration of points that form a pyramid with a triangular base: (a) What are the ﬁrst 5 tetrahedral numbers? (b) Find a general formula for the n-th tetrahedral number. How does the n-th tetrahedral number relate to Pascal’s triangle? (c) Can you classify which tetrahedral numbers are even and which are odd? (d) Are there any numbers that are both triangular and tetrahedral? (e) Are there any numbers that are both square and tetrahedral? (f) Pollock’s Conjecture (1850) states that every number is the sum of at most 5 tetrahedral numbers; this conjecture has not yet been proven. It is also conjectured that there are exactly 241 numbers that cannot be written as the sum of 4 or fewer tetrahedral numbers. Can you ﬁnd the ﬁrst 5? (g) How would you deﬁne a square pyramidal number? A pentagonal pyra- midal number? A hexagonal pyramidal number? Once you’ve deﬁned a square pyramidal number, show that the sum of two consecutive tetrahe- dral numbers is a square pyramidal number. This is, of course, analogous to the 2-dimensional result (the sum of two consecutive triangular numbers is a square number). 168 Stanford University EPGY Number Theory 25. The centered polygonal numbers are numbers formed by a central dot, surrounded by polygonal numbers with a constant number of sides. Each side of a polygonal layer contains one dot more than a side in the previous layer. (a) Find the ﬁrst 5 centered triangular, centered square, centered pentagonal, and centered hexagonal numbers. (b) Find a general formula for the n-th centered k-gonal number. Can you explain your formula geometrically? (c) How would you deﬁne a centered cube number? Can you ﬁnd a general formula for the n-th centered cube number? 26. Investigate formulas for and properties of other geometric numbers. For exam- ple, a rhombic dodecahedral number is a number constructed as a centered cube with a square pyramid appended to each face. What is an octahedral number? How do octahedral numbers relate to pyramidal numbers? What is Pollock’s conjecture for octahedral numbers? 169 Chapter 27 Square-Triangular Numbers and Pell’s Equation Recall from Chapter 26 that triangular numbers are numbers of the form Tm = m(m + 1) 2 . Geometrically, they’re numbers that can be arranged in the shape of a triangle: The n-th triangular number is formed using an outer triangle whose sides have n dots. Similarly, square numbers are numbers that can be arranged in the shape of a square: The n-th square number is formed using an outer square whose sides have n dots. The n-th square number is Sn = n2. Example 27.1 Make a list of the ﬁrst 10 triangular and square numbers. Are there any numbers in both lists? In this chapter, we’ll develop a method for ﬁnding all square-triangular numbers (i.e. numbers which are both square and triangular numbers). One of the major questions we’ll be interested in answering is whether or not there are inﬁnitely many square-triangular numbers. Since triangular numbers are of the form Tm = m(m + 1) 2 170 Stanford University EPGY Number Theory and square numbers are of the form Sn = n2, square-triangular numbers are integer solutions of the equation n2 = m(m + 1) 2 . Next, multiply both sides by 8 and show that we can rewrite the previous equation as 8n2 = 4m2 + 4m = (2m + 1)2 − 1. This suggests the substitution x = 2m + 1 and y = 2n. Make this substitution, and rearrange to obtain the equation x2 − 2y2 = 1. Solutions to this equation produce square-triangular numbers with m = x − 1 2 and n = y 2 . In other words, if (x, y) is a solution of the equation x2 − 2y2 = 1, then N = n2 = ( y 2 )2 is a square-triangular number. Geometrically, the square has y/2 dots on a side and the triangle has (x − 1)/2 dots on the bottom row. Example 27.2 Show that (x, y) = (3, 2) and (x, y) = (17, 12) are both solutions of x2 − 2y2 = 1. Then ﬁnd the corresponding values of (m, n) and the resulting square- triangular numbers. Can you ﬁnd any other solutions (perhaps using a calculator or computer)? To ﬁnd all square-triangular numbers, we need to ﬁnd all solutions of x2 − 2y2 = 1. Observe that we can factor this equation as x2 − 2y2 = (x + y√2)(x − y√2). For example, we can write the solution (x, y) = (3, 2) as 1 = 3 2 − 2 · 2 2 = (3 + 2 √2)(3 − 2 √2). Next, observe what happens if we square both sides of this equation: 171 Stanford University EPGY Number Theory 1 = 1 2 = (3 + 2 √2) 2(3 − 2 √2) 2 = (17 + 12 √2)(17 − 12 √2) = 172 − 2 · 12 2 Thus, “squaring” the solution (x, y) = (3, 2) produced the next solution (x, y) = (17, 12)! Example 27.3 Cube the solution (x, y) = (3, 2), and show that you obtain the solution (x, y) = (99, 70). Which square-triangular number does this produce? What about taking the fourth power? Example 27.4 What is the solution of Pell’s equation corresponding to (3+2 √2) 16? What is the corresponding square-triangular number? Theorem 27.1 There are inﬁnitely many square-triangular numbers. Proof. For every positive integer k, 1 = 1 k = (3 + 2 √2) k(3 − 2 √2) k. By raising (3 + 2 √2) to higher and higher powers, we continue to ﬁnd more and more solutions to the equation x2 − 2y2 = 1, and each new solution gives us a new square-triangular number. (Note: the technique that we have used is interesting from a number-theoretic point of view. In attempting to solve a question about integers, we’ve used irrational numbers!) Thus, there are inﬁnitely square-triangular numbers, but it’s natural to ask at this point whether or not our procedure actually produces all of them. Theorem 27.2 Square-Triangular Number Theorem. (a) Every solution (xk, yk) in positive integers to the equation x2 − 2y2 = 1 is of the form xk + yk√2 = (3 + 2 √2) k, k = 1, 2, 3, . . . . (b) Every square-triangular number n2 = 1 2 m(m + 1) is given by m = xk − 1 2 and n = yk 2 . 172 Stanford University EPGY Number Theory Proof. We’ve already checked (b). We just need to check that if (u, v) is any solution of x2 − 2y2 = 1, then it is of the form u + v√2 = (3 + 2 √2) k for some k. To do this, we’ll use the method of descent. First, note that u ≥ 3, and if u = 3, then v = 2, so there’s nothing to check. Next, suppose that u > 3, and try to show that there must be another solution (s, t) in positive integers such that u + v√2 = (3 + 2 √2)(s + t √2) with s < u. If (s, t) = (3, 2), then we’re done (i.e. (u, v) is of the correct form). If not, then try to ﬁnd another solution (q, r) such that s + t √2 = (3 + 2 √2)(q + r√2) with q < s. If we can do this, then we have u + v√2 = (3 + 2 √2) 2(q + r√2), so if (q, r) = (3, 2), then we’re done. If not, we’ll apply the procedure again. Observe that this process can’t go on forever, since each time we get a new solution, the value of “x” is smaller (e.g. q < s < u. Since these values are all positive integers, they cannot get smaller forever, so the process must end in a ﬁnite number of steps. Thus, we eventually must reach (3, 2) as a solution, so eventually we’re able to write u + v√2 as a power of 3 + 2 √2. Thus, it remains to show that if we start with a solution (u, v) with u > 3, then we can ﬁnd a solution (s, t) with the property u + v√2 = (3 + 2 √2)(s + t √2) with s < u. To do this, multiply out the right-hand side to obtain u + v√2 = (3s + 4t) + (2s + 3t) √2. Thus, we need to solve u = 3s + 4t and v = 2s + 3t. Show that the solution is s = 3u − 4v and t = −2u + 3v for s and t. Now, there are three things left to check. We need to make sure that this (s, t) is really a solution of x2 − 2y2 = 1, that s and t are both positive, and that s < u. For the ﬁrst, just check that s2 − 2t 2 = 1 (remember that u2 − 2v2 = 1 since (u, v) is a solution). Once we know that s and t are both positive, we can check that s < u as follows: 173 Stanford University EPGY Number Theory s = 3u − 4v = 3u − 4 ( 1 3t + 2 3u) = 3u − 4 3t − 8 3u = 1 3u − 4 3t So it remains to make sure that s and t are both positive. First, we’ll check that s is positive: u2 = 1 + 2v2 > 2v2 u > √2v s = 3u − 4v > 3 √2v − 4v = (3 √2 − 4)v > 0 Finally, we’ll check that t is positive: u > 3 u2 > 9 9u2 > 9 + 8u2 9u2 − 9 > 8u2 u2 − 1 > 8 9u2 2v2 > 8 9u2 v > 2 3u t = −2u + 3v > −2u + 32 3u = 0 This completes the descent proof. More generally, any Diophantine equation of the form x2 − dy2 = 1, where d is a non- square positive integer is called a Pell equation. Pell’s equation has an interesting history–its ﬁrst recorded appearance is in the “Cattle problem of Archimedes” (287- 212 BC), in a letter sent from Archimedes to Eratosthenes. In 1880, A. Amthor, a 174 Stanford University EPGY Number Theory German mathematician, showed that the total number of cattle had to be a number with 206,545 digits, beginning with 7766. Over the next 85 years, an additional 40 digits were found, but it was not until 1965 at the University of Waterloo that a complete solution was found–it took over 7.5 hours of computation on an IBM 7040 computer. However, they didn’t print out the solution, and the problem was solved a second time using a Cray-1 computer in 1981. So, we know that if we can ﬁnd one solution of a Pell equation, then we can ﬁnd inﬁnitely many. But how do we ﬁnd the smallest (i.e. fundamental solution)? To answer this question, we’ll investigate the relationship between continued fractions and Pell equations. Example 27.5 A continued fraction is an expression of the form 4 + 1 2 + 1 7+ 1 3 . This is called the continued fraction expansion for the fraction 210 47 . Note that in the continued fraction expansion, all of the denominators are equal to 1. A more compact notation for this continued fraction expansion is [4; 2, 7, 3]. Example 27.6 Consider the decimal expansion of π: π = 3.1415926535897932384626433 . . . Observe that we can write this as π = 3 + something, where the “something” is a number between 0 and 1. Next, observe that we can rewrite this as: π = 3 + 0.1415926535897932384626433 . . . = 3 + 1 1 0.1415926535897932384626433... = 3 + 1 7.06251330593104576930051 . . . = 3 + 1 7 + 0.06251330593104576930051 . . . = 3 + 1 7 + a little bit more The ﬁnal equation above gives the fairly good approximation 22 7 for π. Now, if we repeat this process, we obtain: 175 Stanford University EPGY Number Theory 0.06251330593104576930051 . . . = 1 1 0.06251330593104576930051... = 15.996594406685719888923060 = 15 + 0.996594406685719888923060 Thus, we have the following representation of π: π = 3 + 1 7 + 1 15+0.996594406685719888923060 The bottom level of this fraction is 15.996594406685719888923060, which is very close to 16. If we replace it with 16, we get a rational number that is very close to π: 3 + 1 7 + 1 16 = 355 113 = 3.1415929203539823008849557 . . . The fraction 355 113 agrees with π to six decimal places. Continue this process, at each stage ﬂipping the decimal that is left over and then separating oﬀ the whole integer part, to obtain a four-layer fraction representation of π. Use your ﬁnal representation to get a rational number approximation for π, and compare with the known decimal approximation of π to see how accurate your approximation is. Using our more compact notation, we can express the continued fraction expansion of π as Using this notation, our continued fraction expansion of π can be written as π = [3; 7, 15, 1, 292, 1, 1, 1, 2, 1, 3, 1, 14, 2, 1, 1, 2, . . .]. Deﬁnition 27.1 The n-th convergent to α is the rational number pn qn = [a0; a1, a2, . . . , an] = a0 + 1 a1 + 1 a2+ 1 a3+···+ 1 an obtained by using the terms up to an in the continued fraction expansion of α. Example 27.7 For the continued fraction expansion of π = [3; 7, 15, 1, 292, 1, 1, 1, 2, 1, 3, 1, 14, 2, 1, 1, 2, . . .], the ﬁrst few convergents are: p0 q0 = 3 p1 q1 = 3 + 1 7 = 22 7 = 3.142857143 p2 q2 = 1 + 1 7 + 1 15 = 333 106 = 3.141509434 176 Stanford University EPGY Number Theory Consider again the Pell equation with d = 2: x2 − 2y2 = 1. Start by ﬁnding the continued fraction expansion of √2: √2 = [1; 2, 2, 2, 2, 2, 2, 2, . . .]. The ﬁrst few convergents are: p0 q0 = 1 p1 q1 = 1 + 1 2 = 3 2 p2 q2 = 1 + 1 2 + 1 2 = 7 5 What do you notice? The fundamental solution of x2 = 2y2 = 1 is (3, 2), which is one of our convergents! Theorem 27.3 Continued Fractions and Fundamental Solutions of Pell Equations. Consider the Pell equation x2 − dy2 = 1. Let hi ki , i = 0, 1, . . . de- note the sequence of convergents to the continued fraction expansion for √d. Then the fundamental solution (x1, y1) of the Pell equation satisﬁes x1 = hi and y1 = ki for some i. Example 27.8 Consider the Pell equation x2 −3y2 = 1. Find the continued fraction expansion of √3 = 1.7320508075688..., and use it to ﬁnd the fundamental solution of the Pell equation. √3 = [1; 1, 2, 1, 2, 1, 2, 1, 2, . . .] p0 q0 = 1 p1 q1 = 1 + 1 1 = 2 1 p2 q2 = 1 + 1 1 + 1 2 = 5 3 = 1.6666... Example 27.9 Consider the Pell equation x2 −7y2 = 1. Find the continued fraction expansion of √7 = 2.6457513110645907..., and use it to ﬁnd the fundamental solution of the Pell equation. 177 Stanford University EPGY Number Theory √7 = [2; 1, 1, 1, 4, 1, 1, 1, 4, 1, 1, 1, 4, . . .] p0 q0 = 2 p1 q1 = 2 + 1 1 = 3 1 p2 q2 = 2 + 1 1 + 1 1 = 5 2 = 2.5 p3 q3 = 2 + 1 1 + 1 1+ 1 1 = 8 3 = 2.6666... 178 Stanford University EPGY Number Theory Problem Set 1. Use the continued fraction technique to ﬁnd the smallest solution of x2 − 61y2 = 1. 2. Use the continued fraction technique to ﬁnd the smallest solution of x2 − 63y2 = 1. 3. How many positive integer solutions are there to the equation x2 − y2 = 1? 4. Find four solutions in positive integers to the equation x2 − 5y2 = 1. 5. Let (xk, yk) be the solutions to x2 − 2y2 = 1, as described in Theorem 27.2. (a) Find a, b, c, d such that xk+1 = axk + byk and yk+1 = cxk + dyk. (b) Find e, f, g, h such that if (m, n) satisﬁes n2 = m(m + 1) 2 , then (1 + em + f n, 1 + gm + hn) also produces a square-triangular number. (c) If L is a square-triangular number, show that 1 + 17L + 6 √L + 8L2 is the next largest square-triangular number. 6. Let STn denote the n-th square-triangular number. Show that STn = 34STn−1 − STn−2 + 2. 7. What can you say about the size of the n-th square-triangular number as a function of n? 8. Study the ratio rn = xn/yn as n becomes large. Can you explain your observa- tion? 9. Recall from Chapter 26 that the general formula for the n-th pentagonal number is Pn = n(3n−1) 2 . (a) Are there any pentagonal numbers (other than 1) that are also triangular numbers? Are there inﬁnitely many? What is the Diophantine equation that produces pentagonal-triangular numbers? 179 Stanford University EPGY Number Theory (b) Are there any pentagonal numbers (other than 1) that are also square num- bers? Are there inﬁnitely many? What is the Diophantine equation that produces pentagonal-square numbers? (c) Are there any numbers (other than 1) that are simultaneously triangu- lar, square, and pentagonal numbers? Are there inﬁnitely many? What is the Diophantine equation that produces pentagonal-square-triangular num- bers? (d) Are there any numbers (other than 1) that are both pentagonal and hexag- onal? Are there inﬁnitely many? What is the Diophantine equation that produces pentagonal-hexagonal numbers? 10. Solutions of Pell Equations. (a) Suppose that (x1, y1) is a solution of the Pell equation x2 − dy2 = 1. Square both sides of 1 = x2 1 − dy2 1 = (x1 + y1√d)(x1 − y1√d) to show that (x2 1+y2 1d, 2x1y1) is also a solution. Thus, if we ﬁnd one solution of x2 − dy2 = 1, then we can ﬁnd inﬁnitely many solutions. (b) The smallest solution of x2 − 15y2 = 1 is (4, 1). Find two more solutions of this Pell equation. (c) The smallest solution of x2 − 22y2 = 1 is (197, 42). Find a solution of this Pell equation whose x is larger than 10 6. (d) Prove, using the technique that we used for the Pell equation x2 − 2y2 = 1, that every solution of the Pell equation x2 − 11y2 = 1 is of the form xk + yk√11 = (10 + 3 √11) k, k = 1, 2, 3, . . . . Note: Although we know that once we ﬁnd one solution of Pell’s equation we can ﬁnd inﬁnitely many solutions, it can often be diﬃcult to ﬁnd the smallest solution. In addition, there’s currently no known pattern for the size of the smallest solution to x2 − dy2 = 1. For example, the smallest solution of x2 − 61y2 = 1 is (1766319049, 226153980), while the smallest solution of x2−63y2 = 1 is (8, 1), and the smallest solution of x2 − 65y2 = 1 is (129, 16). The smallest solution of x2 − 73y2 = 1 is (2281249, 267000), while the smallest solution of x2 − 75y2 = 1 is (26, 3). 11. Investigate the Archimedes cattle problem, which Archimedes (287-212 BC) communicated to students at Alexandria in a letter to Eratosthenes. Can you determine the size of the 8 unknowns, and thus the size of the herd? If thou art diligent and wise, O stranger, compute the number of cattle of the Sun, who once upon a time grazed on the ﬁelds of the Thrinacian isle of Sicily, divided into four herds of diﬀerent colours, one milk white, another a glossy black, a third yellow and the last dappled. In each herd were bulls, mighty in 180 Stanford University EPGY Number Theory number according to these proportions: Understand, stranger, that the white bulls were equal to a half and a third of the black together with the whole of the yellow, while the black were equal to the fourth part of the dappled and a ﬁfth, together with, once more, the whole of the yellow. Observe further that the remaining bulls, the dappled, were equal to a sixth part of the white and a seventh, together with all of the yellow. These were the proportions of the cows: The white were precisely equal to the third part and a fourth of the whole herd of the black; while the black were equal to the fourth part once more of the dappled and with it a ﬁfth part, when all, including the bulls, went to pasture together. Now the dappled in four parts were equal in number to a ﬁfth part and a sixth of the yellow herd. Finally the yellow were in number equal to a sixth part and a seventh of the white herd. If thou canst accurately tell, O stranger, the number of cattle of the Sun, giving separately the number of well-fed bulls and again the number of females according to each colour, thou wouldst not be called unskilled or ignorant of numbers, but not yet shalt thou be numbered among the wise. But come, understand also all these conditions regarding the cattle of the Sun. When the white bulls mingled their number with the black, they stood ﬁrm, equal in depth and breadth, and the plains of Thrinacia, stretching far in all ways, were ﬁlled with their multitude. Again, when the yellow and the dappled bulls were gathered into one herd they stood in such a manner that their number, beginning from one, grew slowly greater till it completed a triangular ﬁgure, there being no bulls of other colours in their midst nor none of them lacking. If thou art able, O stranger, to ﬁnd out all these things and gather them together in your mind, giving all the relations, thou shalt depart crowned with glory and knowing that thou hast been adjudged perfect in this species of wisdom. 181 Chapter 28 Pick’s Theorem Pick’s Theorem is a beautiful result that establishes a connection between the area of a lattice polygon and the number of lattice points inside and on the boundary of the polygon. The polygon may be convex or concave–the only requirement for Pick’s Theorem is that the edges of the polygon do not intersect. Lattice points are points with integer coordinates in the x, y-plane. A lattice line segment is a line segment that has 2 distinct lattice points as endpoints, and a lattice polygon is a polygon whose sides are lattice line segments–this just means that the vertices of the polygon are lattice points. Example 28.1 Find the area of each of the following lattice polygons. Make a table that contains the following information for each polygon: the area of the polygon, the number of lattice points inside the polygon, and the number of lattice points on the boundary of the polygon. Can you make any observations or conjectures? Example 28.2 Repeat the previous problem for each of the following polygons. Add the information from these polygons to the table that you created in the previous problem. 182 Stanford University EPGY Number Theory Example 28.3 Construct at least 5 diﬀerent polygons that contain 4 boundary lat- tice points and 6 interior lattice points. Keep in mind that the polygons do not need to be convex! What is the area of each polygon? 183 Stanford University EPGY Number Theory Example 28.4 Let P be the triangle with vertices (0, 0), (3, 1), and (1, 4). Find the area of P , the number of lattice points inside the polygon, and the number of lattice points on the boundary of the polygon. Based on your work on these examples (do more examples if necessary), you should be able to make a conjecture about the statement of Pick’s Theorem. Theorem 28.1 Pick’s Theorem. Let P be a simple lattice polygon, and let A(P ) denote the area of P . Let B denote the number of lattice points on the boundary of P , and let I denote the number of lattice points in the interior of P . Then A(P ) = 184 Stanford University EPGY Number Theory Problem Set 1. A Proof of Pick’s Theorem using Induction. (Reference: http://www.geometer.org/mathcircles/pick.pdf). In this series of exercises, you will prove Pick’s Theorem. (a) Consider an m × n lattice-aligned rectangle: Show that for such a rectangle, I = (m − 1)(n − 1) and B = 2m + 2n. Conclude that A = I + B 2 − 1. (b) Next, ﬁnd I and B for a lattice-aligned right triangle with legs m and n. Prove that Pick’s Theorem holds for such a triangle. (c) The next step is to show that Pick’s Theorem holds for arbitrary triangles. If T is an arbitrary triangle, draw right triangles A, B, C to form a rectangle R, as shown below. 185 Stanford University EPGY Number Theory Suppose that triangle A has Ia interior points and Ba boundary points. Use similar notation for triangles B and C. Let Ir and Br denote the number of interior and boundary points of the rectangle, respectively. We already know that Pick’s Theorem holds for A, B, C, R, so we know that A(A) = Ia + Ba 2 − 1 A(B) = Ib + Bb 2 − 1 A(C) = Ic + Bc 2 − 1 A(R) = Ir + Br 2 − 1 We want to show that A(T ) = It + Bt 2 − 1. We know that A(T ) = A(R) − A(A) − A(B) − A(C). Explain why Br = Ba + Bb + Bc − Bt and Ir = Ia + Ib + Ic + It + (Ba + Bb + Bc − Br) − 3. Use these equations to show that A(T ) = It + Bt 2 − 1. 186 Stanford University EPGY Number Theory (d) So far, we’ve shown that Pick’s Theorem is true for every polygon with 3 sides. To complete the proof that Pick’s Theorem is true for any polygon, we’ll use induction on the number of sides of the polygon. The base case is n = 3 sides, and we’ve already shown that Pick’s Theorem holds for n = 3. For the inductive step, assume that Pick’s Theorem holds for n = 3, 4, . . . , k − 1 sides. We must now prove that Pick’s Theorem holds for n = k sides to complete the induction. Suppose that P is a polygon with k sides (k > 3). Show that P must have an interior diagonal that will split P into 2 smaller polygons. Here’s an example. OW is the interior diagonal for this example. Once we have shown that we can always split a polygon P with k sides into 2 smaller polygons P1 and P2 (each with fewer than k sides), the ﬁnal step is to show that if 2 polygons satisfy Pick’s Theorem, then the polygon formed by attaching the 2 will also satisfy Pick’s Theorem. Since the smaller polygons satisfy Pick’s Theorem by the inductive hypothesis, we have A(P ) = A(P1) + A(P2) = I1 + B1 2 − 1 + I2 + B2 2 − 1. Finally, ﬁnd a relationship between I and I1, I2 and between B and B1, B2 to conclude that A(P ) = I + B 2 − 1. 2. A Proof of Pick’s Theorem using Euler’s Formula. A graph G = (V, E) consists of a V , a nonempty, ﬁnite set of vertices, and E, a ﬁnite set of unordered 187 Stanford University EPGY Number Theory pairs of distinct elements of V called edges. If {u, v} is an edge e of G, the edge e is said to connect u and v, and the vertices u and v are the endpoints of the edge e. Some examples of graphs are shown below. These graphs are both planar (can be drawn in such a way that no 2 edges cross) and connected (there is a path between every pair of distinct vertices of G). Euler’s Formula states that if G is a connected, planar graph with n vertices, e edges, and f regions, then v − e + f = 2. (A planar graph splits the plane into regions, including one unbounded region “outside” the graph. For example, the graph on the far right in the fourth row below contains 4 regions.) Can you prove this result? (a) To prove Pick’s Theorem from Euler’s Formula, start with a simple lattice polygon P , and show that you can always dissect the polygon into primitive lattice triangles. A primitive lattice triangle is a triangle that has no lattice points in its interior, and no lattice points other than vertices on its sides. (b) Next, show that the area of a primitive lattice triangle is equal to 1 2. (Of course, you can’t use Pick’s Theorem since that’s what we’re trying to prove! You must use geometry to prove this result.) (c) Once you’ve proved these results, it’s relatively easy to obtain Pick’s Theo- rem. Begin by observing that the vertices of the graph of P are the lattice points in the interior and on the sides of P , and the edges of the graph P are the sides of P and of the primitive triangles in the dissection of P . The f regions of the graph of P are the f − 1 primitive triangles and the complement of P in the plane. Since each primitive triangle has area 1/2, we have A(P ) = 1 2f − 1. Let ei denote the number of interior edges of primitive triangles, and let es denote the number of edges of primitive triangles on the sides of P . Explain why 3(f − 1) = 2ei + es = 2e − es. 188 Stanford University EPGY Number Theory Use Euler’s Formula to rewrite this equation as f − 1 = 2(v − 2) − es + 2. Finally, use A(P ) = 1 2(f − 1) and v = B(P ) + I(P ) to obtain Pick’s Theorem. 3. Among all of the lattice points on a lattice line L through the origin (0, 0), there are exactly 2 that have minimum positive distance from the origin. Such lattice points are called visible lattice points. Show that a lattice point (a, b) is visible if and only if a and b are relatively prime. 4. Show that if (a, b) is a visible lattice point, then the lattice points on the line through (a, b) are all of the form t(a, b), where t is an integer. 5. Consider the lattice line segment from (0, 0) to the point (a, b), where a and b are any nonnegative integers. How many lattice points are there between (0, 0) and (a, b) (excluding the endpoints)? 6. Let P be a lattice n-gon, with vertices p1 = (a1, b1), p2 = (a2, b2), . . . , pn = (an, bn). Let di = gcd(ai+1 − ai, bi+1 − bi). Show that the number of lattice points on the boundary of P is B(P ) = n∑ i=1 di. 7. Let L be a line in the plane, and suppose that the slope of L is irrational. Show that there is at most one lattice point on L. Give an example of a line with irrational slope containing one lattice point. Give an example of a line with irrational slope containing no lattice points. 8. Let L be a line with rational slope in the plane. Show that if there is a lattice point on L, then the y-intercept of L is rational. Show that if there is one lattice point on L, then there are inﬁnitely many lattice points on L. Give an example of 2 lines with rational slope, one containing no lattice points, and the other containing inﬁnitely many. 9. Polygons with Holes. In the following ﬁgure, there are 5 examples of polygons with holes. Polygons A, B, C have one hole, and polygons D and E have 2 holes. Find the area of each of these polygons. Make a table that contains the following information for each polygon: I, B, area, number of holes. Doing more examples if necessary, modify Pick’s Theorem to derive a formula that works for polygons with holes. Then derive a proof of your conjecture. 189 Stanford University EPGY Number Theory 10. Find the equation of the line connecting 2 points A(n, 0) and B(0, n), and show that this line contains all points of the form (i, n − i), where i is an integer. There are n − 1 such points between A and B. Connect each one of them with the origin O(0, 0). The lines divide △OAB into n small triangles. Show that the 2 triangles next to the axes (i.e. the triangle adjacent to the x-axis and the triangle adjacent to the y-axis) contain no lattice points in their interior. Next, prove that if n is prime, then each of the remaining triangles contains exactly the same number of lattice points. 11. An n × n square is randomly tossed onto the plane. Prove that it may never contain more than (n + 1)2 lattice points. 12. Is it possible to construct an equilateral lattice triangle? A lattice square? A regular lattice hexagon? For which n is it possible to construct a regular lattice n-gon (i.e. a convex polygon that is equilateral and equiangular)? 13. For which positive integers n is it possible to construct a lattice square with area n? 14. For each integer n > 2, construct a lattice triangle with I(T ) = 0 and B(T ) = n. 15. If T is a lattice triangle with I(T ) = 1, show that B(T ) must be equal to 3, 4, 6, 8, or 9. For each of these possible values, construct an example of such a lattice triangle. 16. This problem is an introduction to how Pick’s Theorem generalizes in higher dimensions. First, we’ll rewrite Pick’s Theorem as follows. Let P be a lattice polygon, and let L(P ) denote the total number of lattice points in the interior and on the sides of P , so L(P ) = B(P ) + I(P ). Then Pick’s Theorem can be restated as follows: L(P ) = A(P ) + 1 2B(P ) + 1. 190 Stanford University EPGY Number Theory The generalization of Pick’s Theorem that we’ll prove in this exercise describes how L(P ) changes as the polygon undergoes dilation by a positive integer. For each positive integer n, we deﬁne the lattice polygon nP as nP = {nx | x ∈ P }. Prove that L(nP ) = A(P )n2 + 1 2B(P )n + 1. 17. Let M be a bounded set in the plane with area greater than 1. Show that M must contain two distinct points (x1, y1) and (x2, y2) such that the point (x2 − x1, y2 − y1) is an integer point (not necessarily in M ). 18. Use the previous result to show that if S is a bounded, convex region in the plane that is symmetric about the origin and has area greater than 4, then S must contain an integer point other than (0, 0). 19. Construct an example of a circle with exactly n lattice points in its interior (for n = 1, 2, . . .). 20. Let C( √n) denote the circle with center (0, 0) and radius √n. (a) Find the number of lattice points on the boundary of C( √18), C( √19), C( √20), and C( √21). (b) Find the number of lattice points in the interior and on the boundary of the circles C( √5), C( √7), and C( √10). (c) Can you ﬁnd a general formula (or a rule for determining a formula, or any observations that might lead to a rule) for the number of lattice points on the boundary of C( √n)? (d) (⋆) Let L(n) be the number of lattice points in the interior and on the boundary of the circle C( √n). Show that lim n→∞ L(n) n = π. 21. (⋆) Use the previous result to show that π 4 = 1 − 1 3 + 1 5 − 1 7 + · · · . Hint: L(n) = 1 + 4 ∑ 0<m≤n (d1(m) − d3(m)), where d1(k) denotes the number of divisors of k congruent to 1 mod 4, and d3(k) denotes the number of divisors of k congruent to 3 mod 4. 191 Stanford University EPGY Number Theory 22. (⋆) Consider the square region S(t) in the plane deﬁned by the inequalities |x| ≤ t and |y| ≤ t, where t is a positive real number. Let N (t) denote the number of lattice points in this square, and let V (t) denote the number of lattice points in the square that are visible from the origin. (Among all the lattice points on a lattice line L through th origin, there are exactly 2 that have minimum positive distance to the origin. Such lattice points are called visible. It may be useful to prove that a lattice point (a, b) is visible if and only if a and b are relatively prime.) Show that lim t→∞ V (t) N (t) = 6 π2 . 23. Do some research on Ehrhart’s Theorem and the extension of Pick’s Theorem to higher dimensions. 192 Chapter 29 Farey Sequences and Ford Circles Deﬁnition 29.1 Farey Sequence. The Farey sequence of order n, denoted Fn is the sequence of completely reduced fractions between 0 and 1 which, in lowest terms, have denominators less than or equal to n, arranged in order of increasing size. Example 29.1 F1 = {0/1, 1/1} F2 = {0/1, 1/2, 1/1} F3 = {0/1, 1/3, 1/2, 2/3, 1/1} F4 = {0/1, 1/4, 1/3, 1/2, 2/3, 3/4, 1/1} F5 = {0/1, 1/5, 1/4, 1/3, 2/5, 1/2, 3/5, 2/3, 3/4, 4/5, 1/1} F6 = {0/1, 1/6, 1/5, 1/4, 1/3, 2/5, 1/2, 3/5, 2/3, 3/4, 4/5, 5/6, 1/1} F7 = {0/1, 1/7, 1/6, 1/5, 1/4, 2/7, 1/3, 2/5, 3/7, 1/2, 4/7, 3/5, 2/3, 5/7, 3/4, 4/5, 5/6, 6/7, 1/1} Properties of Farey Sequences. 1. Fn contains Fk for all k ≤ n. 2. Fn is equal to Fn−1 plus an additional fraction for each number that is less than n and coprime to n. For example, F6 consists of F5 together with 1/6 and 5/6. 3. Let |Fn| denote the number of fractions in Fn. For n > 1, |Fn| is odd and the middle term of Fn is equal to 1/2. 4. |Fn| = |Fn−1| + ϕ(n) 5. Since |F1| = 2, we obtain |Fn| = 1 + n∑ k=1 ϕ(k), 193 Stanford University EPGY Number Theory where ϕ(k) is Euler’s totient function (ϕ(k) is equal to the number of positive integers less than or equal to k that are relatively prime to k). 6. The mediant property. Unfortunately, addition of fractions is not as easy as we would like it to be. For example, 1 5 + 1 3 ̸= 1 + 1 5 + 3 = 1 4. But, looking at the Farey sequences F4 and F5, how does 1/4 relate to 1/5 and 1/3? Can you ﬁnd other Farey sequences in which you observe this phenomena? In particular, choose 3 consecutive terms of Fn, say p1/q1, p2/q2, p3/q3. Compute p1 + p3 q1 + q3 . What do you observe? 7. The mediant property and how to compute Fn. How do we go from the (n − 1)-st row to the n-th row? Lemma 29.1 If 0 < a b < c d < 1, then a b < a + c b + d < c d. Proof. a b < c d ad < bc ad + ab < bc + ab a(b + d) < b(a + c) a b < a + c b + d Similarly, a b < c d ad < bc ad + cd < bc + cd d(a + c) < c(b + d) a + c b + d < c d 194 Stanford University EPGY Number Theory This completes the proof of the Lemma, and we thus have the following algo- rithm for computing Fn: Algorithm 29.1 How to Compute Fn. (a) Copy Fn−1 in order. (b) Insert the mediant fraction a + c b + d between a b and c d if b + d ≤ n. (If b + d > n, the mediant a + c b + d will appear in a later sequence). Use this algorithm to ﬁnd F4 from F3. Then ﬁnd F5. Check your results with the sequences given at the beginning of this chapter. 8. Suppose that p1/q1 and p2/q2 are two successive terms of Fn. Prove that p2q1 − p1q2 = 1. Note that it is equivalent to prove that if p1/q1 and p2/q2 are two successive terms of Fn with p1/q1 less than p2/q2, then p2 q2 − p1 q1 = 1 q1q2 . Note: there’s a beautiful proof of this result using Pick’s Theorem! Proof. We’ll use induction on n and the mediant property to prove this result. First, we need to look at the base case, n = 1. We have: F1 = {0 1, 1 1 } 1 · 0 − 0 · 1 = 1 Thus, we have veriﬁed the best case. For the inductive hypothesis, we’ll suppose that the statement is true for n = k, and we’ll consider n = k + 1. This means that in the Farey sequence Fk, we have Fk = { . . . , p1 q1 , p2 q2 , . . . } and p2q1 − p1q2 = 1. Now, recall how we obtain Fk+1 from Fk. We ﬁrst copy Fk in order. Then, we insert the mediant fraction a + c b + d between a b and c d if b + d ≤ k + 1. If b + d > k + 1, the mediant a + c b + d will appear in a later sequence. So, let’s look at the mediant fraction p1 + p2 q1 + q2 . 195 Stanford University EPGY Number Theory If q1 + q2 ≤ k + 1, then Fk+1 = {. . . , p1 q1 , p1 + p2 q1 + q2 , p2 q2 , . . . } . Then (p1 + p2)q1 − p1(q1 + q2) = p2q1 − p1q2 = 1 p2(q1 + q2) − q2(p1 + p2) = p2q1 − p1q2 = 1 On the other hand, if q1 + q2 > k + 1, then Fk+1 = {. . . , p1 q1 , p2 q2 , . . . } , so it’s clear from the inductive hypothesis that the property holds. This com- pletes the induction proof. 9. If p1/q1, p2/q2, and p3/q3 are three successive terms of Fn, then p2 q2 = p1 + p3 q1 + q3 . Proof. p2q1 − p1q2 = 1 p3q2 − p2q3 = 1 p2q1 − p1q2 = p3q2 − p2q3 p2q1 + p2q3 = p1q2 + p3q2 p2 q2 = p1 + p3 q1 + q3 Next, we’ll investigate the remarkable connection between Farey sequences and Ford circles. Deﬁnition 29.2 Ford Circle. For every rational number p/q in lowest terms, the Ford circle C(p, q) is the circle with center ( p q , 1 2q2 ) and radius 1 2q2 . This means that C(p, q) is the circle tangent to the x-axis at x = p/q with radius 1 2q2 . Observe that every small interval of the x-axis contains points of tangency of inﬁnitely many Ford circles. 196 Stanford University EPGY Number Theory Example 29.2 Sketch C(0, 1), C(1, 1), C(1, 2), C(1, 3), C(2, 3). Several Ford circles are illustrated in Figure 29.1. Example 29.3 Consider three adjacent terms of Fn. What do you observe about the corresponding Ford circles? Theorem 29.2 No Ford circles intersect. The representative circles of two dis- tinct fractions are either tangent at one point or wholly external to one another. Proof. Let p/q and P/Q be distinct fractions in lowest terms. Without loss of general- ity, we’ll assume that p q < P Q. Consider the distance between the centers of their representative Ford circles C(p, q) and C(P, Q). The coordinates of point A are ( p q , 1 2q2 ) and the coordinates of point B are ( P Q, 1 2Q2 ). Thus we have: AB2 = ( P Q − p q )2 + ( 1 2Q2 − 1 2q2 )2 = ( 1 2Q2 + 1 2q2 )2 + (P q − pQ) 2 − 1 Q2q2 = (AD + EB) 2 + (P q − pQ) 2 − 1 Q2q2 . There are three cases to consider: 1. Case 1. If |P q − pQ| > 1, then AB > AD + EB, and the circles are wholly external to one another. 2. Case 2. If |P q − pQ| = 1, then AB = AD + EB, and the circles are tangent. Observe that this happens exactly when p/q and P/Q are adjacent terms in a Farey sequence! 3. Case 3. If |P q − pQ| < 1, then, since P q − pQ is an integer, we must have P p − pQ = 0. Thus, P Q = p q , which is impossible since we assumed that the fractions are distinct. 197 Stanford University EPGY Number Theory Figure 29.1: Ford circles. 198 Stanford University EPGY Number Theory Thus, we conclude that the representative Ford circles of two distinct fractions are either tangent at one point or wholly external. Moreover, the circles are tangent at one point precisely when the fractions are adjacent in some Farey sequence Fn. Theorem 29.3 Ford circles and the Farey sequence. Suppose that h1/k1, h2/k2, and h3/k3 are three consecutive terms in some Farey sequence Fn. Then the circles C(h1, k1) and C(h2, k2) are tangent at α1 = ( h2 k2 − k1 k2(k2 2 + k2 1), 1 k2 2 + k2 1 ) , and the circles C(h2, k2) and C(h3, k3) are tangent at α2 = ( h2 k2 + k3 k2(k2 2 + k2 3), 1 k2 2 + k2 3 ) . Moreover, α1 lies on the semicircle with diameter h2/k2 − h1/k1, and α2 lies on the semicircle with diameter h3/k3 − h2/k2. Theorem 29.4 Largest Ford circle between tangent Ford circles. Suppose that C(a, b) and C(c, d) are tangent Ford circles. Then the largest Ford circle between them is C(a + c, b + d), the Ford circle associated with the mediant fraction. 199 Stanford University EPGY Number Theory Problem Set. 1. Find F8 by using F7 and the algorithm that we developed. 2. Suppose that p1/q1 and p2/q2 are two successive terms of Fn. In this problem, we will use Pick’s Theorem to prove that p2q1 − p1q2 = 1. See Chapter 28 for more information on Pick’s Theorem. Let T be the triangle with vertices (0, 0), (p1, q1), and (p2, q2). (a) Show that T has no lattice points in its interior, i.e. I(T ) = 0. (b) Show that the only boundary points of T are the vertices of the triangle, i.e. B(T ) = 3. (c) Conclude, using Pick’s Theorem, that A(T ) = 1 2. (d) Use geometry to show that A(T ) = 1 2 (p2q1 − p1q2) . (e) Conclude that p2q1 − p1q2 = 1. 3. Let a/b and a ′/b ′ be the fractions immediately to the left and the right of the fraction 1/2 in the Farey sequence of order n. Prove that b is the greatest odd integer less than or equal to n. Next, by experimenting with various choices of n, make and prove a conjecture about the value of a + a ′. 4. Prove that the sum of the fractions in the Farey sequence Fn is equal to 1 2 [ 1 + n∑ j=1 ϕ(j) ] . 5. Let a/b and a ′/b ′ run through all pairs of adjacent fractions in the Farey sequence of order n > 1. Make and prove a conjecture about the values of min ( a ′ b′ − a b ) and max ( a ′ b′ − a b ) . 6. Consider the fractions from 0/1 to 1/1 inclusive in the Farey sequence of order n. Reading from left to right, let the denominators of these fractions be b1, b2, . . . , bk so that b1 = bk = 1. By experimenting with various values of n, make and prove a conjecture about the value of k−1∑ j=1 1 bjbj+1 . 200 Stanford University EPGY Number Theory 7. Suppose that C(a, b) and C(c, d) are tangent Ford circles. Prove that the largest Ford circle between them is C(a + c, b + d), the Ford circle associated with the mediant fraction. 8. Suppose that a/b and c/d are adjacent terms in Fn (so that C(a, b) and C(c, d) are tangent Ford circles). Find a formula for all fractions that are adjacent to a/b in some Farey sequence. 9. Suppose that h1/k1, h2/k2, and h3/k3 are three consecutive terms in some Farey sequence Fn. Find the point of tangency of the circles C(h1, k1) and C(h2, k2), and the point of tangency of the circles C(h2, k2) and C(h3, k3) 10. It can be shown that |Fn| = 1 + n∑ k=1 ϕ(k) ≈ 3n2 π2 . Complete the following table to investigate the accuracy of this approximation as n increases. n |Fn| = 1 + n∑ k=1 ϕ(k) 3n2 π2 n |Fn| = 1 + n∑ k=1 ϕ(k) 3n2 π2 1 15 2 25 3 100 4 200 5 500 6 700 7 1000 8 2000 9 5000 10 10000 11. Investigate the relationship between the total area of Ford circles and the Rie- mann Hypothesis. 201 Chapter 30 The Card Game SET The Mathematical Framework. Each card has four characteristics (symbol, color, number, and ﬁlling), each of which has three possible values. Thus, we can associate each card in the SET deck with a 4-tuple of numbers (x1, x2, x3, x4), where each xi is 0, 1, or 2. We will use the following labeling scheme: Symbol Label diamond 0 oval 1 squiggle 2 Color Label purple 0 red 1 green 2 Number Label three 0 one 1 two 2 Filling Label striped 0 solid 1 unﬁlled 2 Finally, we will label the four characteristics symbol, color, number, and ﬁlling in that order. Since there are 4 characteristics, each of which has 3 possible values, we can associate each card in the SET deck with an element in the set D = Z3 ×Z3 ×Z3 ×Z3. Some examples of the labeling scheme are as follows: 202 Stanford University EPGY Number Theory • A card with one red unﬁlled squiggle would have label (2, 1, 1, 2). • A card with two purple solid ovals would have label (1, 0, 2, 1). • A card with two green solid diamonds would have label (0, 2, 2, 1). • A card with three purple striped squiggles would have label (2, 0, 0, 0). Note that every possible combination of the four characteristics does appear in the SET deck, so there are a total of 3 · 3 · 3 · 3 = 3 4 = 81 cards in the deck. We will call the set of all 81 4-tuples the set D. Multiplication on D. Next, we deﬁne a multiplication operation on the set D = Z3 × Z3 × Z3 × Z3 which reﬂects how we obtain a SET from two given cards. Suppose that two cards have labels x = (x1, x2, x3, x4) and y = (y1, y2, y3, y4). Then we deﬁne the product xy as follows: xy = (2(x1+y1) mod 3, 2(x2+y2) mod 3, 2(x3+y3) mod 3, 2(x4+y4) mod 3). Problems. 1. Choose any 2 cards from your deck of SET cards, and call them x and y. (a) Find the 4-tuple labels for x and y and compute the product xy. Find the card in the deck that corresponds to xy. What do you notice about x, y, and xy? (b) Multiply x and xy. Which card does this produce? (c) Multiply y and xy. Which card does this produce? (d) Does order matter? Is xy the same card as yx? Prove your answer using the deﬁnition of multiplication of cards and by interpreting the question in terms of SETs. (e) Repeat parts (a)-(d) for 3 more pairs of cards. 2. Suppose that x = (1, 1, 1, 1) y = (0, 0, 0, 0) z = (1, 2, 2, 0) w = (2, 2, 1, 1). 203 Stanford University EPGY Number Theory Compute each of the products xy, xz, and xw, and zw. Then sketch in the appropriate symbols to see how this multiplication translates into cards. You will need purple, green, and red pens to complete this exercise. Describe what you discover. 3. (a) Based on what you discovered in the previous exercise, explain why you would expect the following properties to be true. Hint: think about what these properties say in terms of the cards. Property 1: x(xy) = y Property 2: (xy)y = x (b) Prove that these properties are indeed true. 4. Choose any card from your deck of SET cards. How many SETs are there that contain this card? 5. Choose any 2 cards from your deck of SET cards. How many SETs are there that contain both of these cards? 6. Choose any 3 cards from your deck of SET cards, and call them x, y, and z. Compute the products zx, zy, and xy. Next, compute (zx)(zy) and z(xy). What do you observe? Repeat with a diﬀerent choice of 3 cards. 7. A SET magic square is a square array of cards such that any horizontal row, vertical column, or main diagonal forms a SET. (a) Construct a 3 × 3 magic square. (b) Consider the following method for constructing a 3 × 3 SET magic square. Start with any three cards that do not form a set, and place them in the 1, 3, and 5 positions in the square (counting left to right and top to bottom). Show that it is always possible to create a 3 × 3 SET magic square when we start with this conﬁguration. 8. What is the maximum number of red cards that contain no sets? More gener- ally, what is the maximum number of cards that all share a particular feature (number, color, shape, or ﬁlling) that contains no sets? 9. Is it possible for the game to end with three cards left? 10. Prove that 5 cards that have two common features must include a SET. For example, consider only the red cards with solid ﬁlling, and prove that any col- lection of 5 such cards must contain a SET. 11. Prove that among 7 cards there cannot be exactly 4 SETs. 12. If 12 randomly selected cards don’t contain a SET and 3 additional cards are added, what is the probability of a SET being present? 204 Stanford University EPGY Number Theory 13. What is the probability of having 2 disjoint SET among 12 randomly selected cards? 14. How does the game change, and how do the answers to some of these questions change, if you combine 2 or 3 decks of cards together? 15. A cap is a collection of cards which have no SET but the addition of any card to the collection will produce a SET. (a) Suppose that we are playing SET with only the red ovals. What is the maximum size of a cap? (b) Suppose that we are playing SET with all of the red cards. What is the maximum size of a cap? 16. Does cancellation hold in D? That is, if x, y, z are elements of D such that xy = xz, must y = z? Provide a proof to support your claim. 17. Prove that (zx)(zy) = z(xy). 18. A D-set is deﬁned to be a subset S ⊆ D of the form S = {x, y, xy}, where x, y ∈ D. D-sets correspond to SETs in the card game. Prove that there are a total of 1080 possible D-sets in D (and thus there are a total of 1080 possible sets in the card game). How many D-sets can a given element x ∈ S be a member of? 19. Suppose that U ⊆ D. We say that U is product-free if xy /∈ U whenever x, y ∈ U . Note that product-free subsets of D translate into collections of cards that fail to contain a SET. Prove that if U is product-free, then xU is also product-free. For any set S ⊆ D, and x ∈ D, the set xS is deﬁned to be the set xS = {xs such that s ∈ S}. 20. Prove that if S ⊆ D is a product-free set and x ∈ S, then S ∩ xS = {x}. Conclude that any product-free set can contain at most 41 elements, and that any collection of 42 cards must contain a SET. 21. The largest known collection of cards containing no SET is given below. Its cardinality is 20. If we let α(D) denote the cardinality of the largest product- free subset of D, then this fact together with the result of the previous exercise yields 20 ≤ α(D) ≤ 41. Can you tighten the upper bound on α(D)? That is, can you ﬁnd an upper bound that is less than 41, or optimally, can you prove that α(D) = 20? Here is a product-free set of 20 elements in D: (0, 1, 0, 0), (0, 2, 0, 1), (1, 2, 0, 0), (1, 1, 0, 1), (2, 1, 0, 1), (2, 2, 0, 0), (0, 0, 2, 0) (0, 1, 1, 0), (0, 2, 1, 1), (1, 2, 1, 0), (1, 1, 1, 1), (2, 1, 1, 1), (2, 2, 1, 0), (0, 0, 2, 1) (0, 1, 2, 2), (0, 2, 2, 2), (1, 2, 2, 1), (1, 1, 2, 0), (2, 1, 2, 0), (2, 2, 2, 1) 205 Stanford University EPGY Number Theory 22. What is the largest number of SETs that can be present among a layout of 9 cards? 23. What is the largest number of SETs that can be present among a layout of 12 cards? 206 Chapter 31 Magic Squares A magic square of order n is an n × n array (or square) containing n2 diﬀerent entries such that the sum of the n numbers in any horizontal, vertical, or main diagonal line is always the same magic constant. If the rows and columns sum to the magic constant (but the main diagonals do not), the resulting array is called a semi-magic square. For example, the following is an example of a 5×5 semi-magic square: 12 19 21 3 10 18 25 2 9 11 24 1 8 15 17 5 7 14 16 23 6 13 20 22 4 The numbers in any row or column sum to 65, but the main diagonals do not both sum to 65. Example 31.1 Construct a 3 × 3 magic square. The De la Loub`ere Method. In 1693, De la Loub`ere gave a rule for inserting the numbers 1, 2, 3, . . . , n2 into an n × n square (where n is an ODD integer) so that a magic square is formed. The procedure is outlined as follows. 1. Start with an empty n × n square, where n is odd. We’ll begin with n = 5: 207 Stanford University EPGY Number Theory 2. The basic rule is to count diagonally upwards to the right. For example, if we have written a 12 in the 2nd position of the 4th row, 12 then the numbers 13, 14, 15 should be placed as follows: 15 14 13 12 3. To construct a magic square, begin in the middle of the top row with a 1. (Here we for the ﬁrst time use the assumption that n is odd, which guarantees that there is a middle square in the top row). If we don’t start there, the row and column sums will be ok, but the diagonals won’t add to the magic sum, so we will create a semi-magic square instead of a magic square. 1 208 Stanford University EPGY Number Theory 4. Now, the ﬁrst thing we observe is that it is impossible to move diagonally upwards from this position, since we are already at the top of the square. This is an example of what can go wrong with the basic method of moving diagonally upwards to the right. There are actually three things that can go wrong: (a) We could be at the top edge of the square, so we can’t go up. (b) We could be at the right edge of the square so we can’t move right. (c) The square we would like to put the next number in may already be occu- pied. Here is what to do in these cases: (a) If we are at the top edge, pretend that the top edge is pasted to the bottom edge and come up through the bottom. In other words, we pretend that the bottom row is the row above the top row. Moving diagonally upwards to the right means moving up one row and over one column to the right. So the 2 goes in the bottom row one column to the right of the column containing the 1. Thus, after 1, we place 2 as follows: 1 2 (b) If you are at the right edge, pretend that the right edge is pasted to the left edge and that the left edge is immediately to the right of the right edge. We are in this situation after counting to 3, since we have: 1 3 2 Then moving diagonally upwards to the right is the same as moving right one column and up one row. Moving right one column from the rightmost column puts us in the leftmost column, so 4 must be in the leftmost column, and moving up one row we put the 4 in the row above the row containing the 3. So we get 209 Stanford University EPGY Number Theory 1 4 3 2 (c) If there is a number already occupying the square we would like to move into, abandon the plan of moving diagonally upwards to the right and instead just drop down one square from the square one is in presently. We are in this situation after we place the number 5. Indeed, continuing from the previous diagram, we place the 5 diagonally upwards, so the 6 will be placed directly below the 5. 17 24 1 8 15 23 5 7 14 16 4 6 13 20 22 10 12 19 21 3 11 18 25 2 9 5. Continuing, we obtain the following 5 × 5 magic square with magic constant 65. Problems. 1. Starting with 1 in the lower-left hand corner, construct the 3 × 3 and 4 × 4 squares given by the Loub`ere method. Verify that the 3 × 3 square is a semi- magic square with magic constant 15 and that the 4 × 4 square is neither a magic square nor a semi-magic square. 2. Construct a 7 × 7 magic square using the Loub`ere method. 3. Construct examples of several n × n squares for even n using the Loub`ere method. Compute the row and column sums for your examples, and make a conjecture about the Loub`ere method for even n using your results. 4. Can the numbers 0 through 5 be inserted in a 2 × 3 rectangle in such a way that the sums of the entries of the two rows are equal? 5. The numbers 0 through n2 − 1 are placed in an n × n square in such a way as to make it semi-magic. (The process used is not necessarily the Loub`ere method). What is the magic sum? Hint: consider the sum of every number in the square and how this total is related to the magic sum. 6. Is there a 2 × 2 magic square? 210 Stanford University EPGY Number Theory 7. A 9 × 9 square may be split up naturally into nine 3 × 3 squares. Using the numbers from 0 to 80, construct a semi-magic square such that each of the nine 3 × 3 squares is also semi-magic. 8. Complete the following 5 × 5 magic square. 1 19 23 18 5 9 4 8 7 14 3 13 2 6 9. Research the pyramid method for constructing magic squares. Construct a 5 × 5 magic square using the pyramid method. 10. Research Greco-Latin squares, and construct an example of a 5 × 5 Greco-Latin square. 211 Chapter 32 Mathematical Games Reference: Tatiana Shubin, Department of Mathematics, San Jose State University, San Jose, CA, shubin@math.sjsu.edu. In all of the games described below there are two players, Alice and Bob, and Alice always plays ﬁrst. The problem is to decide which one of the two players has a win- ning strategy (and, of course, to describe this strategy). An answer to the question Which player has a winning strategy? must include a detailed description of such strategy, i.e., you have to explain what the winning player should do so that this player wins REGARDLESS of his opponents moves. To solve a game means to ﬁnd a winning or a non-losing strategy for one of the players. In particular, to solve a game, you must provide an algorithm that secures a win for one player, or a tie, against any possible moves from the opponent, from the beginning of the game. 1. (a) There are 25 matches on a table. During each turn, a player can take any number of matches between 1 and 4. The player that takes the last match wins. (b) Same game as above but it starts with 24 matches. (c) Same game again, only the initial number of matches is N . 2. (a) Now there are two piles of matches, one pile with 10 matches and another one with 7. During each turn, a player can take any number of matches from either one of the two piles. The player who takes the last match wins. (b) What will happen if the numbers of matches in the piles are m and n? 3. (a) Alice and Bob want to produce a 20-digit number, writing one digit at a time from left to right. Alice wins if the number they get is not divisible by 7; Bob wins if the number is divisible by 7. (b) What will happen if 7 is replaced by 13 in the previous game? 4. Given a convex n-gon, the players take turns drawing diagonals that do not intersect those diagonals that have already been drawn. The player unable to draw a diagonal loses. 212 Stanford University EPGY Number Theory 5. There are 25 matches in a pile. A player can take 1, 2, or 4 matches during each turn. The player who cannot continue (no more matches left) loses. 6. On one square of an 8 by 8 chessboard there is a lame tower that can move either to the left or down through any number of squares. Alice and Bob take turns moving the tower. The player unable to move the tower loses. (Consider various initial positions of the tower.) 7. There are two piles of matches; one pile contains 10 matches while the other contains 7. A player can take one match from the ﬁrst pile, or one match from the second pile, or one match from each of the two piles. The player unable to move loses. 8. At the start of the game, there is a number 60 written on the board. During each turn, a player can reduce the number that is currently on the board by any of its positive divisors. If the resulting number is a 0, the player loses. 9. Alice calls out any integer between 2 and 9, Bob multiplies it by any integer between 2 and 9, then Alice multiplies the new number by any integer between 2 and 9, and so on. The player who ﬁrst gets a number bigger than 1000 wins. 10. (a) There are several minuses written along a line. A player replaces either one minus by a plus or two adjacent minuses by two pluses. The player who replaces the last minus wins. (b) Same game as above, only the minuses are written around a circle. 11. There are nine cards on a table labeled by numbers 1 trough 9. Alice and Bob take turns choosing one card. The player that has collected a set of cards with the property that the sum of numbers on three cards out of their total set is 15 wins. Theres a tie if none of the players has a set of cards with this property at the end of the game. Does any of the players have a winning strategy? A non-losing strategy? 12. Players start with one pile of pebbles. During each move, a player must split one pile into two nonempty piles in such a way that all resulting piles have diﬀerent number of pebbles. The player unable to make a move loses. (a) After the ﬁrst move, the piles contain 5 and 11 pebbles. Find a winning strategy for Bob. (b) After the ﬁrst move, the piles contain 5 and 11 pebbles. Give an example of a bad move after which Bob will necessarily lose. (c) Which player has a winning strategy if they start with 11 pebbles? (d) Which player has a winning strategy if they start with 22 pebbles? (e) Can you solve the game in general? 13. In a box, there are 213 Stanford University EPGY Number Theory (a) 57 candies (b) 50 candies (c) 1000 candies (d) N > 1 candies During each turn, a player can take any amount of candy subject to the following two conditions. • The ﬁrst player cannot take all the candy. • A player cannot take more candy than his opponent has just taken. The player who takes the last candy wins. Which of the players has a winning strategy? 14. Suppose we start with N integers: 1, 2, 3, . . . , N . During each turn, a player circles one of the numbers in such a way that all circled numbers are pairwise relatively prime. No number can be circled twice. The player unable to complete a turn loses. Which player has a winning strategy if: (a) N = 10 (b) N = 12 (c) N = 15 (d) N = 30 (e) N is any positive integer 15. Players start with one pile of pebbles. During each move, a player must split one pile into two nonempty piles in such a way that all resulting piles have diﬀerent number of pebbles. The player unable to make a move loses. (a) After the ﬁrst move, the piles contain 5 and 11 pebbles. Find a winning strategy for Bob. (b) After the ﬁrst move, the piles contain 5 and 11 pebbles. Give an example of a bad move after which Bob will necessarily lose. (c) Which player has a winning strategy if they start with 11 pebbles? (d) Which player has a winning strategy if they start with 22 pebbles? (e) Can you solve the game in general? 214 Chapter 33 The 5 Card Trick of Fitch Cheney The trick. Take an ordinary deck of 52 cards, and draw a hand of 5 cards from it. Choose them deliberately or randomly, but do not show them to the magician. Instead, give them to the magician’s assistant, who will then give 4 of them, 1 at a time, to the magician. The magician can then name the hidden card. The mathematics. Suppose that 5 cards are drawn from a standard deck of 52 cards. Note that among these 5 cards, there must be 2 of the same suit (by the Pigeonhole Principle, since there are 4 suits). We will label these two cards the base card and the hidden card in such a way that it is possible to go from the base card to the hidden card by adding at most 6, modulo 13, to the base card. Assume that we have labeled the cards as follows: Card rank Value Ace 1 2 2 3 3 4 4 5 5 6 6 7 7 8 8 9 9 10 10 Jack 11 Queen 12 King 13 So, for example, if both the 3 of diamonds and the queen of diamonds are among the four cards, we will choose the queen to be the base card and the ace to be the hidden card since 12 + 4 ≡ 3 mod 13. 215 Stanford University EPGY Number Theory The assistant always hands the base card ﬁrst to the magician. This reveals the suit of the hidden card to the magician, and also sets the base point at which the magician should add up to 6, modulo 13, to obtain the value of the hidden card. The order in which the 3 remaining cards are presented can be used to reveal what number should be added to the base card, as there are 6 possible permutations of the 3 remaining cards. Use the ordering above to put the 3 remaining cards in order. If there are two cards with the same value, use the suit to break the tie. For example, order the suits alphabetically–clubs, diamonds, hearts, spades. Use the following code to determine the number which the magician adds to the base card, where H stands for high, M for middle, and L for low: Order Number to add to the base card LMH 1 LHM 2 MLH 3 MHL 4 HLM 5 HML 6 Example. Suppose that the ﬁve cards drawn are the queen of hearts, the 3 of diamonds, the king of spades, the 8 of clubs, and the 7 of spades. Since there are two cards in the spade suit, and the king has value 13, the assistant will choose the 7 of spades to be the base card and the king of spades to be the hidden card. Thus, the assistant will ﬁrst give the 7 of spades to the magician. Next, the assistant needs to use the remaining three cards to tell the magician to add 6 to the 7 of spades to obtain 13, the king of spades. Using our ordering above, the code HM L corresponds to the number 6, so the assistant should give the magician the three remaining cards in the order highest, middle, lowest. Thus, the assistant gives the magician the cards in the order queen of hearts, 8 of clubs, and 3 of diamonds. The magician recognizes the code for the number 6, adds 6 to the 7 of spades, and concludes that the hidden card must be the king of spades. Reference: Michael Klever, The Best Card Trick, The Mathematical Intelli- gencer, Volume 24, Number 1, Winter 2002. This trick is credited to Dr. William Fitch Cheney, Jr. (1894-1974). 216 Chapter 34 Conway’s Rational Tangles Summary of the rational tangles operations: • Let x denote the number associated with the current tangle. • Twist: T : x → x + 1. • Rotate: R : x → − 1 x . 1. Given a tangle number m n , where m and n are integers and the fraction is in lowest terms, is it always possible to use the TWIST and ROTATE operations to obtain the tangle number 0 (i.e the untangled conﬁguration)? If so, how do you do it? How do you know that you’ll always be able to reach the tangle number 0? 2. Is it possible to start from 0 and get to any positive or negative fraction using TWISTs and ROTATEs? Given relatively prime integers i and j, is it always possible to obtain the tangle number i j ? If so, how do you do it? If not, what numbers are not possible to obtain? 3. In this problem, you will discover and prove formulas for various combinations of TWIST and ROTATE (starting in each case with the tangle number 0). The letter T denotes the twist operation and the letter R denotes the rotate operation. So, for example, T (T RT ) n means ﬁrst do 1 TWIST, then do TWIST- ROTATE-TWIST n times. (a) Show that T n : 0 → n. (b) Show that T (T RT ) n : 0 → 1 n+1 . To get started, work out the fraction produced by T (T RT ) n for a few small values of n. Then try to prove the general formula. (c) Discover and prove a formula for T 2RT n. 217 Stanford University EPGY Number Theory (d) Discover and prove a formula for T 2(T RT ) n. (e) Discover and prove a formula for T (T RT ) nR. (f) Discover and prove a formula for T n+1RT n. (g) Can you ﬁnd other patterns? 4. How does inﬁnity relate to tangle numbers? For example, try starting with zero and do a single ROTATE. What happens? What happens if you do another ROTATE? What happens if you do a ROTATE, then a TWIST? How do these examples relate to the number inﬁnity? 5. In this problem, you’ll investigate the relationship between rational tangles and the Euclidean algorithm for computing the gcd. (a) Describe the order of the TWIST and ROTATE operations that you would use to obtain the tangle number 0 starting from a tangle number of −5/17. (b) Next, use the Euclidean algorithm with subtraction instead of addition to ﬁnd the gcd of 5 and 17: 5 = 17 × 1 − 12 17 = 12 × 1 + 5 = 12 × 2 − 7 12 = 7 × 1 + 5 = 7 × 2 − 2 7 = 2 × 1 + 5 = 2 × 2 + 3 = 2 × 3 + 1 = 2 × 4 − 1 2 = 1 × 1 + 1 = 1 × 2 + 0 What do you observe? How does the calculation above compare with the calculation that you did in part (a)? (c) Repeat parts (a) and (b) for a diﬀerent tangle number. Discuss your obser- vations. 218 Chapter 35 Invariants and Monovariants Example 35.1 Write 11 numbers on a sheet of paper–six zeros and ﬁve ones. Per- form the following operation 10 times: cross out any two numbers, and if they were equal, write another zero on the board. If they were not equal, write a one. Show that no matter which numbers are chosen at each step, the ﬁnal number on the board will be a one. Solution. The sum of the numbers at the start is 5. After each operation, the sum can only increase by 0 or 2. Thus, the parity of the sum remains the same. Since the original sum was odd, the ﬁnal remaining number must be odd as well. In this example, the parity of the sum of the numbers is an invariant. Example 35.2 The numbers 1, 2, . . . , 20 are written on a blackboard. It is permitted to erase any two numbers a and b and write the new number a + b − 1. What number can be on the blackboard after 19 such operations? Solution. For any collection of n numbers on the board, let X denote the sum of all of the numbers decreased by n. How does X change when we erase a and b and write the new number a + b − 1? If the sum of all the numbers except a and b is equal to S, then before the transformation, we have X = S + a + b − n, and after the transformation, we have X = S + (a + b − 1) − (n − 1) = S + a + b − n. Thus, X is invariant. Initially, we have X = (1 + 2 + · · · + 20) − 20 = 19 · 20 2 = 190. When there is only one number left, we must have X = 190, so the last number must be 191. 219 Stanford University EPGY Number Theory Example 35.3 A circle is divided into 6 sectors. The numbers 1, 0, 1, 0, 0, 0 are written into the sectors in the counterclockwise direction. You may increase any two neighboring numbers by 1. Is it possible to make all of the numbers equal? Solution. Consider the quantity I = a1 − a2 + a3 − a4 + a5 − a6. This quantity is invariant, and I = 2 initially. Thus, I = 0 cannot be obtained. Example 35.4 A dragon has 100 heads. A knight can cut oﬀ 15, 17, 20, or 5 heads with one blow of his sword. In each of these respective cases, 24, 2, 12, or 14 new heads grow back. If all heads are cut oﬀ, the dragon dies. Is it possible for the knight to kill the dragon? Solution. Note that (24 − 15) ≡ (2 − 17) ≡ (14 − 20) ≡ (17 − 5) ≡ 0 mod 3. Thus, the total number of heads never changes modulo 3. Since the original sum is 100 ≡ 1 mod 3, the total number of heads will always be congruent to 1 modulo 3, so it’s not possible for the knight to kill the dragon. Example 35.5 (IMO 1986) To each vertex of a pentagon, assign an integer xi such that the sum S = 5∑ i=1 xi > 0. If x, y, z are the numbers assigned to three successive vertices and if y < 0, then we replace (x, y, z) by (x + y, −y, y + z). This step is repeated as long as there exists a vertex labeled with a negative integer. Determine whether or not this algorithm always stops. Solution. The algorithm always stops. Consider the function f (x1, x2, x3, x4, x5) = 5∑ i=1 (xi − xi+2)2, x6 = x1, x7 = x2. Clearly f > 0 always and f is integer-valued. Suppose, without loss of generality, that y = x4 < 0. Then fnew − fold = 2Sx4 < 0 since S > 0. Thus, if the algorithm does not stop, then we can ﬁnd an inﬁnite decreasing sequence of nonnegative integers f0 > f1 > f2 > · · · . This is impossible, so the algorithm must stop. The function f used in this example is an example of a monovariant, a generalization of the idea of invariance. Even if we cannot identify some function that never changes, we may be able to identify a function that always changes in the same direction. If there is some nonnegative, integer-valued function that decreases at each step of a process, that process must eventually terminate. 220 Stanford University EPGY Number Theory Problem Set. 1. Suppose that the positive integer n is odd. Write the numbers 1, 2, . . . , 2n on the board. Choose any 2 numbers a and b, erase them, and write |a − b|. Prove that an odd number will remain at the end. 2. Start with the set {3, 4, 12}. In each step, you may choose two of the numbers a and b and replace them by 0.6a − 0.8b and 0.8a + 0.6b. Can you reach (a) or (b) in ﬁnitely many steps? (a) {4, 6, 12} (b) {x, y, z}, where each of |x − 4, |y − 6|, |z − 12| are less than 1 √3 3. The numbers 1, 2, . . . , 20 are written on a blackboard. It is permitted to erase any two numbers a and b and write the new number ab + a + b. What number can be on the blackboard after 19 such operations? Hint: consider the quantity obtained by increasing each number by 1 and multiplying the result. 4. Consider an 8 × 8 array of squares in which one of the squares is colored black and all of the others are colored white. You may recolor all of the squares in a row or column. Is it possible to make all of the boxes white? 5. Consider a 3 × 3 array in which only the upper left corner is colored black and all other squares are colored white. You may recolor all of the squares in a row or column. Is it possible to make all of the boxes white? 6. Consider an 8 × 8 array of squares in which all four corner squares are colored black and all other squares are colored white. You may recolor all of the squares in a row or column. Is it possible to make all of the boxes white? 7. There are green, yellow, and red chameleons. Whenever 2 chameleons of diﬀer- ent colors meet, they change to the third color. (a) Given 4 green, 5 yellow, and 5 red chameleons, is it possible to have all chameleons change to the same color? (b) Given 4 green, 5 yellow, and 6 red chameleons, is it possible to have all chameleons change to the same color? (c) Given 13 green, 15 yellow, and 17 red chameleons, is it possible to have all chameleons change to the same color? 221 Stanford University EPGY Number Theory (d) Can you ﬁnd a condition which is necessary and suﬃcient for a given starting conﬁguration to be solvable? (Here, solvable means that it is possible to obtain a conﬁguration in which all chameleons have the same color). 8. The number 8n is written on the board. The sum of its digits is calculated, then the sum of the digits of the result is calculated, and so on, until a single digit is reached. What is this digit if n = 1989? 9. Consider an 8 × 8 chessboard with the usual coloring. You may recolor all squares (a) of a row or column or (b) of a 2 × 2 square. Can you reach just one black square? 10. A pawn moves across an n × n chessboard so that in one move it can shift one square to the right, one square upward, or along a diagonal down and left. Can the pawn move through all of the squares on the board, visiting each square exactly once, and ﬁnish its trip on the square immediately to the right of the initial one? 11. The boxes of an m × n table are ﬁlled with numbers so that the sum of the numbers in each row and in each column is equal to 1. Prove that m = n. 12. The integers 1, 2, . . . , n are arranged in any order. In one step, you may switch any 2 neighboring integers. Prove that you can never obtain the initial order after an odd number of steps. 13. (2008 Putnam) Start with a ﬁnite sequence a1, a2, . . . , an of positive integers. If possible, choose 2 indices j < k such that aj does not divide ak, and replace aj and ak by gcd(aj, ak) and lcm(aj, ak) respectively. Prove that this process must eventually stop. Hint: can you ﬁnd a monovariant? 222 Chapter 36 Number Theory Problems from AMC, AHSME, AIME, USAMO, and IMO Mathematics Contests 1. (1998 AHSME #13) Walter rolls four standard six-sided dice and ﬁnds that the product of the numbers on the upper faces is 144. Which of the following could not be the sum of the upper four faces? (A) 14 (B) 15 (C) 16 (D) 17 (E) 18 2. (2000 AMC 10 #1) Let I, M , and O be distinct positive integers such that the product I · M · O = 2001. What is the largest possible value of the sum I + M + O? (A) 23 (B) 55 (C) 99 (D) 111 (E) 671 3. (1999 AMC 10 #7) Find the sum of all prime numbers between 1 and 100 that are simultaneously one greater than a multiple of 5 and one less than a multiple of 6. (A) 52 (B) 82 (C) 123 (D) 143 (E) 214 4. (1995 AHSME #29) For how many three-element sets of positive integers {a, b, c} is it true that a × b × c = 2310? (A) 32 (B) 36 (C) 40 (D) 43 (E) 45 5. (1999 AMC 10 #14) All even numbers from 2 to 98 inclusive, except those ending in 0, are multiplied together. What is the rightmost digit (the units digit) of the product? 223 Stanford University EPGY Number Theory (A) 0 (B) 2 (C) 4 (D) 6 (E) 8 6. (1999 AMC 10 #15) How many three-element subsets of the set {88, 95, 99, 132, 166, 173} have the property that the sum of the three elements is even? (A) 6 (B) 8 (C) 10 (D) 12 (E) 24 7. (1998 AHSME #30) For each positive integer n, let an = (n + 9)! (n − 1)! . Let k denote the smallest positive integer for which the rightmost nonzero digit of ak is odd. The rightmost nonzero digit of ak is (A) 1 (B) 3 (C) 5 (D) 7 (E) 9 8. (1992 AHSME #17) The two-digit integers from 19 to 92 are written consecu- tively to form the large integer N = 192021 · · · 909192. Suppose that 3 k is the highest power of 3 that is a factor of N . What is k? (A) 0 (B) 1 (C) 2 (D) 3 (E) 4 9. (1997 AHSME #20) Which one of the following integers can be expressed as the sum of 100 consecutive positive integers? (A) 1,627,384,950 (B) 2,345,678,910 (C) 3,579,111,300 (D) 4,692,581,470 (E) 5,815,937,260 10. (2000 AMC 10 #17) Boris has an incredible coin changing machine. When he puts in a quarter, it returns ﬁve nickels; when he puts in a nickel, it returns ﬁve pennies; and when he puts in a penny, it returns ﬁve quarters. Boris starts with just one penny. Which of the following amounts could Boris have after using the machine repeatedly? (A) $3.63 (B) $5.13 (C) $6.30 (D) $7.45 (E) $9.07 11. (2000 AMC 10 #25) In year N , the 300th day of the year is a Tuesday. In year N + 1, the 200th day is also a Tuesday. On what day of the week did the 100th day of year N − 1 occur? 224 Stanford University EPGY Number Theory (A) Thursday (B) Friday (C) Saturday (D) Sunday (E) Monday 12. (1991 AHSME #15) A circular table has 60 chairs around it. There are N people seated at this table in such a way that the next person to be seated must sit next to someone. What is the smallest possible value for N ? (A) 15 (B) 20 (C) 30 (D) 40 (E) 58 13. (1992 AHSME #23) Let S be a subset of {1, 2, 3, . . . , 50} such that no pair of distinct elements in S has a sum divisible by 7. What is the maximum number of elements in S? (A) 6 (B) 7 (C) 14 (D) 21 (E) 23 14. (1974 AHSME #8) What is the smallest prime number dividing the sum 3 11 + 5 13? (A) 2 (B) 3 (C) 5 (D) 311 + 5 13 (E) none of these 15. (1983 AIME) Let an = 6 n + 8 n. Determine the remainder when a83 is divided by 49. 16. (2004 AMC 10B #4) A standard six-sided die is rolled and P is the product of the ﬁve numbers that are visible. What is the largest number that is certain to divide P ? (A) 6 (B) 12 (C) 24 (D) 144 (E) 720 17. (1999 AHSME #6) What is the sum of the digits of the decimal form of the product 2 2004 · 5 2006? (A) 2 (B) 4 (C) 5 (D) 7 (E) 10 18. (2002 AMC 10B #14) The number 25 64 · 64 25 is the square of a positive integer N . What is the sum of the digits of N ? (A) 7 (B) 14 (C) 21 (D) 28 (E) 35 19. (2002 AMC 10A #14 and 12A #12) Both roots of the quadratic equation x2 − 63x + k = 0 are prime numbers. What is the number of possible values of k? 225 Stanford University EPGY Number Theory (A) 0 (B) 1 (C) 2 (D) 4 (E) 6 20. (1986 AHSME #23) Let N = 69 5 + 5 · 69 4 + 10 · 69 3 + 10 · 69 2 + 5 · 69 + 1. How many positive integers are factors of N ? (A) 3 (B) 5 (C) 69 (D) 125 (E) 216 21. (2003 AMC 12A #23) How many perfect squares are divisors of the product 1! · 2! · 3! · 9!? (A) 504 (B) 672 (C) 864 (D) 936 (E) 1008 22. (1990 AHSME #11) How many positive integers less than 50 have an odd number of positive integer divisors? (A) 3 (B) 5 (C) 7 (D) 9 (E) 11 23. (1993 AHSME #15) For how many values of n will an n-sided regular polygon have interior angles with integer degree measures? (A) 16 (B) 18 (C) 20 (D) 22 (E) 24 24. (2002 AMC 12 #20) Suppose that a and b are digits, not both nine and not both zero, and the repeating decimal 0.abababab · · · is expressed as a fraction in lowest terms. How many diﬀerent denominators are possible? (A) 3 (B) 4 (C) 5 (D) 8 (E) 9 25. (1996 AHSME #29) Suppose that n is a positive integer such that 2n has 28 positive divisors and 3n has 30 positive divisors. How many positive divisors does 6n have? (A) 32 (B) 34 (C) 35 (D) 36 (E) 38 26. (1998 AHSME #28) How many ordered triples of integers (a, b, c) satisfy |a + b| + c = 19 and ab + |c| = 97? 226 Stanford University EPGY Number Theory (A) 0 (B) 4 (C) 6 (D) 10 (E) 12 27. (2008 USAMO) Prove that for each positive integer n, there are pairwise rela- tively prime integers k0, k1, . . . , kn, all strictly greater than 1, such that k0k1 · · · kn − 1 is the product of two consecutive integers. 28. (2007 USAMO) Let n be a positive integer. Deﬁne a sequence by setting a1 = n and, for each k > 1, let ak be the unique integer in the range 0 ≤ ak ≤ k − 1 for which a1 + a2 + · · · + ak is divisible by k. For example, when n = 9, the sequence is 9, 1, 2, 0, 3, 3, 3, . . .. Prove that for any n, the sequence a1, a2, . . . eventually becomes constant. 29. (1979 IMO) If a, b are natural numbers such that a b = 1 − 1 2 + 1 3 − 1 4 + · · · − 1 1318 + 1 1319, prove that 1979|a. 30. (2007 IMO) Let a and b be positive integers. Show that if 4ab − 1 divides (4a 2 − 1), then a = b. 227 Chapter 37 Challenge Contest Problems For each of these problems, experiment numerically with the given problem, and try to come up with conjectures. Then, try to prove that your conjectures are correct. To get started with each problem, try small cases and look for patterns. 1. (Putnam 1990) Let T0 = 2, T1 = 3, T2 = 6, and for n ≥ 3, Tn = (n + 4)Tn−1 − 4nTn−2 + (4n − 8)Tn−3. The ﬁrst few terms are 2, 3, 6, 14, 40, 152, 784, 5158, 40576, 363392. Find a formula for Tn of the form Tn = An + Bn, where (An) and (Bn) are well-known sequences. 2. For each integer n > 1, ﬁnd distinct positive integers x and y such that 1 x + 1 y = 1 n . 3. For each positive integer n, ﬁnd positive integer solutions x1, . . . , xn of the equa- tion 1 x1 + 1 x2 + · · · + 1 xn + 1 x1x2 · · · xn = 1. 4. Deﬁne s(n) to be the number of ways that the positive integer n can be written as an ordered sum of at least one positive integer. For example, 4 = 1 + 3 = 3 + 1 = 2 + 2 = 1 + 1 + 2 = 1 + 2 + 1 = 2 + 1 + 1 = 1 + 1 + 1 + 1, so s(4) = 8. Conjecture a general formula for s(n). 228 Stanford University EPGY Number Theory 5. Let g(n) be the number of odd terms in the row of Pascal’s Triangle which starts with 1, n, . . .. For example, g(6) = 4 since the row 1, 6, 15, 20, 15, 6, 1 contains 4 odd numbers. Conjecture a formula for (or an easy way of computing) g(n). 6. A group of n people are standing in a circle, numbered consecutively clockwise from 1 to n. Starting with person #2, we remove every other person, proceeding clockwise. For example, if n = 6, the people are removed in the order 2,4,6,3,1, and the last person remaining is #5. Let j(n) denote the last person remaining (e.g. j(6) = 5). (a) Compute j(n) for n = 2, 3, . . . , 25. (b) Conjecture an easy way of computing j(n). You may not get a nice formula, but try to ﬁnd an algorithm which is easy to implement. 7. Observe that 6 = 1 2 − 2 2 + 3 2 and 7 = −1 2 + 2 2 + 3 2 − 4 2 − 5 2 + 6 2. Investigate this pattern, and make a conjecture about a more general result.. 8. (Putnam 1983) Let f (n) = n + ⌊√n⌋, where ⌊n⌋ is the greatest integer less than or equal to n. Prove that, for every positive integer m, the sequence m, f (m), f (f (m)), f (f (f (m))), . . . contains the square of an integer. You should begin this problem by experi- menting with some numerical values. Make tables of the sequence m, f (m), f (f (m)), f (f (f (m))), . . . for various positive integers m. 9. Lockers in a row are numbered 1, 2, 3 . . . , 1000. At ﬁrst, all of the lockers are closed. A person walks by, and opens every other locker, starting with locker #2. Thus, lockers 2, 4, 6, . . . , 998 are open. Another person walks by, and changes the “state” (i.e., closes a locker if it is open, opens a locker if it is closed) of every third locker, starting with #3. Then another person changes the state of every fourth locker, starting with #4. This process continues until no more lockers can be altered. Which lockers will be closed? Hint: Start doing some experimentation with a smaller number of lockers. 229 Stanford University EPGY Number Theory 10. (1985 AIME) The numbers in the sequence 101, 104, 109, 116, . . . are of the form an = 100 + n2, where n = 1, 2, 3, . . .. For each n, let dn be the greatest common divisor of an and an+1. Find the maximum value of dn as n ranges through the positive integers. 11. (Russia, 1995) The sequence a0, a1, a2, . . . satisﬁes am+n + am−n = 1 2(a2m + a2n) for all integers m, n ≥ 0 with m ≥ n. If a1 = 1, ﬁnd a1995. 12. Into how many regions is the plane divided by n lines in general position (no two lines parallel; no three lines meet in a point)? 13. A great circle is a circle drawn on a sphere that is an “equator,” i.e. its center is also the center of the sphere. Suppose that there are n great circles on a sphere, no three of which meet at any point. Into how many regions do they divide the sphere? 14. What is the ﬁrst time after 12:00 at which the hour and minute hands meet? 15. Let N denote the natural numbers {1, 2, 3, 4, . . .}. Consider a function f : N → N which satisﬁes f (1) = 1, f (2n) = f (n), f (2n + 1) = f (2n) + 1 for all n ∈ N. Find a nice simple algorithm for f (n). Your algorithm should be a single sentence long, at most. 16. Deﬁne the function f (x) by f (x) = 1 1 − x and denote r iterations of the function f by f r, i.e. f 2(x) = f (f (x)) f 3(x) = f (f (f (x))) f 4(x) = f (f (f (f (x)))). Compute f 1999(2000). 230 Stanford University EPGY Number Theory 17. (1997 IMO) An n × n square matrix (square array) whose entries come from the set S = {1, 2, . . . , 2n − 1} is called a silver matrix if, for each i = 1, . . . , n, the i-th row and the i-th column together contain all elements of S. Show that there is no silver matrix for n = 1997. 18. (Taiwan, 1995) Consider the operation which transforms the 8-term sequence x1, x2, . . . , x8 into the new 8-term sequence |x2 − x1|, |x3 − x2|, . . . , |x8 − x7|, |x1 − x8|. Find all 8-term sequences of integers which have the property that after ﬁnitely many applications of this operation, one is left with a sequence, all of whose terms are equal. 19. There are 25 people sitting around a table, and each person has two cards. One of the numbers 1, 2, 3 . . . , 25 is written on each card, and each number occurs on exactly two cards. At a signal, each person passes one of her cards–the one with the smaller number–to her right-hand neighbor. Prove that, sooner or later, one of the players will have two cards with the same number. 20. For positive integers n, deﬁne Sn to be the minimum value of the sum n∑ k=1 √ (2k − 1)2 + a2 k, as the a1, a2, . . . , an range through all positive values such that a1 + a2 + · · · + an = 17. Find S10. 231","libVersion":"0.3.1","langs":""}
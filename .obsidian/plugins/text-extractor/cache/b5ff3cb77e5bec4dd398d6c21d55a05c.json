{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Kimball Martin/NT 1 (Intro to NT)/Notes/chap9.pdf","text":"9 Quadratic Reciprocity 9.1 Primes x2 + y2, x2 + 2y2 and x2 + 3y2 Recall Fermat’s two square theorem (Theorem 6.18), which says if p is an odd prime, p = x2 + y2 if and only if p ≡ 1 mod 4. Fermat generalized this to the following Theorem 9.1. Let p be an odd prime. Then p = x2 + 2y2 if and only if p ≡ 1, 3 mod 8. Theorem 9.2. Let p be prime. Then p = x2 + 3y2 if and only if p ≡ 1 mod 3. How might we prove these two results? Let’s recall our proof of Fermat’s two square theorem. One direction is easy: If p ≡ 3 mod 4, then p ̸= x2 + y2 by congruence conditions. For the other direction, suppose p ≡ 1 mod 4. Lagrange’s Lemma 6.17 (which was proved with Wilson’s theorem) said that p|m2 + 1 for some m. Since p|m2 + 1 = (m + i)(m − i) but p ∤ m ± i in Z[i] ( m p ± i p ̸∈ Z[i]), this means p is not prime in Z[i] (by the prime divisor property, which is equivalent to unique factorization). Then p has a nontrivial factorization p = αβ in Z[i], so p2 = N (p) = N (α)N (β) =⇒ N (α) = N (β) = p, i.e., p = x2 + y2 where x + yi = α. Again, one direction of Theorems 9.1 and 9.2 are easy. If p ≡ 5, 7 mod 8, then p ̸= x2 + 2y2 and if p ≡ 2 mod 3, then p ̸= x2 + 3y2 (see Section 3.7). To prove the hard direction, one needs two things: (i) unique factorization in Z[ √−2] and Z[ζ3], which was covered in Chapter 7; and (ii) appropriate analogues of Lagrange’s Lemma 6.17. In this chapter, we will prove a great generalization of Lagrange’s lemma, which is known as the Law of Quadratic Reciprocity. This was ﬁrst proven by Gauss, in many diﬀerent ways, and might be viewed as the pinnacle of elementary number theory. Along the way, we will also cover another important result from elementary number theory—the Chinese Remainder Theorem. 9.2 Statement of Quadratic Reciprocity Let p and q denote odd primes. Deﬁnition 9.3. We say a is a square, or quadratic residue, mod p if x2 ≡ a mod p for some x ∈ Z. Otherwise, we say a is a nonsquare, or quadratic nonresidue, mod p. Example. The squares mod 4 are 0, 1; the nonsquares are 2, 3 (up to congruence). (Okay, you might say 4 is not prime, but this example comes up often, and the deﬁnitions are the same for any mod n.) Example. Lagrange’s Lemma 6.17 says, if p ≡ 1 mod 4, then p|m2 + 1 for some m, i.e., m2 ≡ −1 mod p for some m, i.e., −1 is a square mod p. We will soon see that these conditions are equivalent, i.e., p is a square mod 4 ⇐⇒ p ≡ 1 mod 4 ⇐⇒ −1 is a square mod p (The ﬁrst equivalence is because, up to congruence, only 0 and 1 are squares mod 4.) 60 I stated things in this form because it looks somewhat similar to quadratic reciprocity, which was originally conjectured by Euler in the following form: If p and q are not both 3 mod 4, then p is a square mod q ⇐⇒ q is a square mod p. (1) If p ≡ q ≡ 3 mod 4, then p is a square mod q ⇐⇒ q is not a square mod p. (2) It is convenient to introduce some new notation, which will allow us to combine these two cases into one. Deﬁnition 9.4. Let a ∈ Z such that gcd(a, p) = 1 The Legendre symbol, or quadratic residue symbol mod p is ( a p ) = { 1 a is a square mod p −1 else. (One can extend this to all Z by setting (a p) = 0 if gcd(a, p) = p, but we will not use this.) Note we have deﬁned the Legendre symbol as a map ( · p) : Z → {±1}, but since the value only depends on the congruence class mod p, we may view it as a map ( · p ) : (Z/pZ) × → {±1} . Hence we can rewrite (1) as ( p q ) = (q p ) and (2) as ( p q ) = − (q p ) This leads to the typical modern formulation of quadratic reciprocity. Theorem 9.5. (Quadratic Reciprocity) Let p, q be odd primes. Then (p q ) = (−1) p−1 2 q−1 2 (q p ) . This is equivalent to Euler’s version because p−1 2 q−1 2 is even unless p ≡ q ≡ 3 mod 4. (Note the statement in the text, (p q)(q p) = (−1) p−1 2 q−1 2 , is not valid when p = q.) Example. Note that (5 p ) = (−1) p−1(p 5 ) = ( p 5 ) . The squares mod 5 are 0, 1, 4. Hence 5 is a square mod p if and only if p = 5 or p ≡ 1, 4, mod 5. Exercise 9.1. Use quadratic reciprocity to determine for which primes p is 7 a square mod p. 61 9.3 Euler’s criterion Again, let p be an odd prime. Denote by □p ⊆ (Z/pZ)× be the nonzero congruence classes which are squares mod p, e.g., □5 = {1, 4}. Hence for any a ∈ (Z/pZ)×, we may say (a p) = 1 if and only if a ∈ □p. Exercise 9.2. Show □p is a subgroup of (Z/pZ)×. Show the map σ : (Z/pZ)× → (Z/pZ) given by σ(x) = x2 is 2-to-1. Conclude the subgroup □p has index 2 in (Z/pZ)×, i.e., |□p| = p−1 2 . Note this exercise tells us that exactly half of the elements in (Z/pZ)× are squares and half are nonsquares. The squares and nonsquares are then the two cosets (remember cosets?) of (Z/pZ)× with respect to the subgroup □p. Proposition 9.6. (Euler’s criterion) Let a ∈ (Z/pZ)×. Then ( a p ) ≡ a p−1 2 mod p. Proof. Consider the map from (Z/pZ)× → (Z/pZ)× given by ϕ(a) ≡ a p−1 2 mod p Note that ϕ(a) ≡ 1 mod p if a ∈ □p. This is because we can write a ≡ x2 mod p so ϕ(a) ≡ ϕ(x2) ≡ xp−1 mod p by Fermat’s little theorem. By the previous exercise, the squares mod p give p−1 2 solutions to the polynomial congruence ϕ(a) ≡ a p−1 2 ≡ 1 mod p. By Lagrange’s theorem on polynomial congruence solutions (Section 3.5), this is all of them. Hence ϕ(a) ≡ a p−1 2 ≡ 1 mod p if and only if a ∈ □p, i.e., if and only if (a p) = 1. If (a p) = 1 we are done. If (a p) = −1, then a p−1 2 ̸≡ 1 mod p, but its square is ap−1 ≡ 1 mod p, hence it must be ≡ −1 mod p. Thus in either case, Euler’s criterion holds. Proposition 9.7. The map ( · p) : (Z/pZ)× → {±1} is multiplicative, i.e., (ab p ) = (a p)(b p), i.e., it is a group homomorphism. Its kernel is □p. Recall the kernel of a multiplicative map χ : G → C× is deﬁned to be the set of all a such that χ(a) = 1. Note: A group homomorphism χ : G → C× is called a (group) character. Hence the Legendre symbol is also called the Legendre character or quadratic residue character. Proof. Multiplicatively follows from Euler’s criterion: ( ab p ) ≡ (ab) p−1 2 ≡ a p−1 2 b p−1 2 ≡ ( a p )(b p ) mod p. Since congruence mod p distinguishes between 1 and −1, we can conclude (ab p ) = (a p)(b p). The statement that □p is the kernel of ( · p ) is immediate from the deﬁnitions of □p and the Legendre symbol. 62 Exercise 9.3. Explicitly write down the values of ( · p) for p = 7, 11, 13. In each case, write down what the subgroup □p of (Z/pZ)× is. Proposition 9.8. (First supplementary law) (−1 p ) = 1 ⇐⇒ −1 ∈ □p ⇐⇒ p ≡ 1 mod 4. Proof. By Euler’s criterion, we have ( −1 p ) ≡ (−1) p−1 2 ≡ { 1 mod p p ≡ 1 mod 4 −1 mod p p ≡ 3 mod 4. Exercise 9.4. Give a proof of the ﬁrst supplementary law which does not require Euler’s criterion as follows. We know if p ≡ 1 mod 4, then −1 ∈ □p by Lagrange’s lemma. So it suﬃces to show that −1 ̸∈ □p for p ≡ 3 mod 4. Show this using Exercise 9.2. The reason this is called the ﬁrst supplementary law (to quadratic reciprocity) is the following. A common question that arises in number theory is to evaluate some Legendre symbol (a p) for some a ∈ Z. Quadratic reciprocity tells us how to do it if a is odd and positive. To take care of a < 0, we need the ﬁrst supplementary law, and to take care of a even, we need one more supplementary law for (2 p). We will do this next, and then show how to put everything together to calculate any Legendre symbol. 9.4 The value of (2 p) Again, p is an odd prime. Proposition 9.9. (Second supplementary law) (2 p ) = 1 ⇐⇒ 2 ∈ □p ⇐⇒ p ≡ ±1 mod 8. Proof. The text proves the cases p ≡ 1, 5 mod 8 with an crazy mess of congruences, leaving an equally complicated mess of congruences for the p ≡ 3, 7 mod 8 cases in the exercises. You can read that/do the exercise if you want, but I’ll show you one and a half algebraic number theory proofs of theorem. The ﬁrst half of a proof assumes unique factorization (or rather the prime divisor property) in Z[ √2] (which is true, and we should get to next semester). Suppose 2 ≡ x2 mod p. Then p|x2 − 2 = (x + √2)(x − √ 2), but p does not divide either term on the right. Hence p must not be prime in Z[ √2] (prime divisor property), i.e., there is a nontrivial factorization p = αβ in Z[ √2]. Thus p2 = N (p) = N (α)N (β), which means N (α) = N (β) = p. Writing α = a − b √2, we see p = a2 − 2b2. The squares mod 8 are 0, 1, 4, so we must have p ≡ ±1 mod 8. If one tries to do the other direction in a similar way, it is more complicated and involves using (essentially) Z[ √±p]. See Cohn’s Advanced Number Theory. I won’t even sketch this, but I wanted 63 to point out the above argument for the (⇒) since it’s an argument that we’ve used several times now. There is a much more clever proof of the proposition using the 8-th roots of unity in Ono’s Introduction to Algebraic Number Theory. It involves a couple things we haven’t really covered yet, but I think you can probably follow the idea anyway, and it shows some of the power of roots of unity. It goes as follows. Let ζ = ζ8 = e2πi/8 = √i and η = ζ + ζ −1. Then η2 = ζ 2 + 2 + ζ −2 = i + 2 − i = 2, i.e., η = √2. Hence 2 p−1 2 = ηp−1 = ηpη−1 = (ζ + ζ −1)pη−1. But (ζ + ζ −1)p ≡ ζ p + ζ −p ≡ { ζ + ζ −1 ≡ η mod p p ≡ ±1 mod 8 ζ 3 + ζ −3 ≡ −η mod p p ≡ ±3 mod 8. Here we have extended the mod notation to a more general ring of (algebraic) integers, namely Z[ζ], which is not a problem (except possibly psychologically—again α ≡ β mod p means p|β − α in Z[ζ]). Therefore 2 p−1 2 = (ζ + ζ −1) pη−1 ≡ { 1 mod p p ≡ ±1 mod 8 −1 mod p p ≡ ±3 mod 8, which proves the proposition by Euler’s criterion. In the ζ8 proof, we used the fact that (ζ + ζ −1)p ≡ ζ p + ζ −p mod p. Prove the equivalent statement for integers (your proof should apply to this case also): Exercise 9.5. Let a, b ∈ N. Show for p prime (a + b) p ≡ ap + b p mod p. Show by example this is not true for p not prime. 9.5 The story so far Before we prove quadratic reciprocity, let’s see how we can compute any Legendre symbol using quadratic reciprocity and the ﬁrst and second supplementary laws. Example. ( 12 23 ) = ( 2 23 )2( 3 23 ) = − ( 23 3 ) = − ( 2 3 ) = 1. I.e., 12 is a square mod 23, which is not obvious without computing the squares mod 23. The ﬁrst step was from multiplicativity, the second by quadratic reciprocity, the third by reduction mod 3, and the fourth by either the second supplementary law or just knowing what the squares are mod 3. An alternate way to do it is ( 12 23 ) = ( −11 23 ) = ( −1 23 )(11 23 ) = (−1)(−1) ( 23 11 ) = ( 1 11 ) = 1. Here the ﬁrst step is by congruence mod 23, the second by multiplicativity, the third by both the ﬁrst supplementary law and quadratic reciprocity, the fourth by congruence mod 11, and the last is 64 because 1 is always a square mod p. In this case both ways are of about equal diﬃculty, but sometimes one way is considerably simpler, e.g., if we had (22 23 ) it’s easiest to write it as (−1 23 ) and use the ﬁrst supplementary law. Note that using this trick of writing (a p) = (p−a p ) we can always get away with not using the second supplementary law for computing a speciﬁc Legendre symbol. This is because we only need the second law if a is even, in which case p − a is odd. One could also get away without using the ﬁrst supplementary law, e.g., (−3 59 ) = (56 59 ) = (115 59 ), but this makes things considerably more diﬃcult. I just wanted to point out that the supplementary laws are useful, but not necessary to compute speciﬁc Legendre symbols. However, we will need the supplementary laws when we want to prove general theorems—e.g., to determine which primes are of the form x2 + 2y2 or x2 + 3y2. Example. ( 30 59 ) = ( 2 59 )( 3 59 )( 5 59 ) = (−1)(−1) ( 59 3 )(59 5 ) = ( 2 3 )( 4 5 ) = −1 · 1 = −1, i.e., 30 is not a square mod 59. Exercise 9.6. Compute (24 61 ), (30 61 ), and (31 61 ). 9.6 The Chinese remainder theorem The original form of the Chinese remainder theorem, which was found in Sun Tzu’s (the Art of War guy) mathematical treatise dating to the 3rd century, is as follows: Let m, n ∈ N. If gcd(m, n) = 1, then each x = 0, 1, 2, . . . , mn−1 has a distinct pair of remainders (x mod m, x mod n). Example. Do m = 3, n = 5. From the example, we observe that the the remainders x mod m repeat with period m and x mod n repeat with period n, so you will never get the same pair again until these periods match up, which happens at mn since gcd(m, n) = 1. This is the proof of the Chinese remainder theorem. You might wonder what the Chinese call the Chinese remainder theorem. Maybe just the remainder theorem? like the French just call French onion soup “onion soup,” Canadians just call Canadian bacon “bacon,” or Feynman just called the Feynman integral “the integral.” I looked it up on Chinese Wikipedia, and apparently they also call it the Chinese remainder theorem. I guess they’re pretty proud of it. In the past it had many diﬀerent names—“Sun Tzu’s Theorem” is the only one I can read, which was also they used to call the theorem in Japan. 9.7 The full Chinese remainder theorem A slight modiﬁcation of the above Chinese remainder theorem tells us (x mod m, x mod n) = (y mod m, y mod n) ⇐⇒ x ≡ y mod mn. The above argument tells us that the pairs of remainders on the left are diﬀerent when x ̸≡ y mod mn, but the converse is obvious x ≡ y mod mn ⇐⇒ x − y ≡ 0 mod mn =⇒ x − y ≡ 0 mod m and x − y ≡ 0 mod n. 65 Hence we may rephrase the Chinese remainder theorem as statement that the map α : Z/mnZ → Z/mZ × Z/nZ given by α(a) = (a mod m, a mod n) is 1-1 and onto.1 The full Chinese remainder theorem says that α is a ring homomorphism, i.e., α(0) = (0, 0), α(1) = (1, 1), α(a + b) = α(a) + α(b) and α(ab) = α(a)α(b). These facts are immediate from congruence arithmetic. Check it: Exercise 9.7. Let gcd(m, n) = 1 and α : (Z/mnZ) → (Z/mZ) × (Z/nZ) be given by α(a, b) = (a mod m, b mod n). Check that α(0) = (0, 0), α(1) = (1, 1), α(a + b) = α(a) + α(b) and α(ab) = α(a)α(b). This means α is a ring homomorphism. In summary, we have Theorem 9.10. (Chinese remainder theorem) Suppose gcd(m, n) = 1. The map α : (Z/mnZ) → (Z/mZ) × (Z/nZ) is a ring isomorphism, i.e., it is 1-1 and onto, α(0) = (0, 0), α(1) = (1, 1), α(a + b) = α(a) + α(b) and α(ab) = α(a)α(b). Corollary 9.11. Suppose gcd(m, n) = 1. Then (Z/mnZ) × ≃ (Z/mZ) × × (Z/nZ) ×. In particular ϕ(mn) = ϕ(m)ϕ(n), where ϕ denotes Euler’s ϕ-function. This says that the multiplicative group mod mn is isomorphic to the product of the multiplicative groups mod m and mod n. If you don’t know what the product of two groups means, don’t worry. What the corollary means should be clear from the proof. But for the record if G and H are two groups, their product G × H is the group of elements (g, h) where g ∈ G, h ∈ H and the group multiplication is deﬁned by (g, h)(g′, h′) = (gg′, hh′). (Isomorphic means that two groups are really the same: precisely, that there is a bijective homomorphism from one to the other. A homomorphism is a function f : G → H which respects the group multiplication, i.e., f (gg′) = f (g)f (g′).) Proof. The corollary essentially makes the following claim: x ∈ (Z/mnZ) × ⇐⇒ x ∈ (Z/mZ) × and x ∈ (Z/nZ)×. Again we have slightly abused notation here—what we mean precisely is an integer x is invertible mod mn if and only if it is both mod m and mod n. This is true because x is relatively prime to mn if and only if it is relatively prime to m and n. To see this gives the statement of the corollary, observe that it means the following: if we restrict the map α : Z/mnZ → Z/mZ×Z/nZ to (Z/mnZ)×, we get a bijection of the group (Z/mnZ)× with the product group (Z/mZ)× × (Z/nZ)×. Since α is multiplicative, it is a group isomorphism. Exercise 9.8. Exercises 9.7.1, 9.7.2. 1We never deﬁned what a mod m means if a ∈ Z/mnZ, but it should be obvious. If we want to be more precise, we can read this statement for a ∈ Z, not a ∈ Z/mnZ, but since it clearly only depends on the value a mod mn, it indeed deﬁnes a function on Z/mnZ. 66 9.8 Proof of quadratic reciprocity Proof. Let p, q be distinct odd primes. Set P = { 1 ≤ x ≤ pq−1 2 | gcd(x, pq) = 1 } , so (Z/pqZ)× = P ∪ −P , where −P = {−x|x ∈ P }. We consider ∏x∈P x mod p and mod q. Note that P consists of q−1 2 full sequences 1, 2, . . . , p−1 mod p and the half sequence 1, 2, . . . , p−1 2 mod p minus the multiples q, 2q, . . . , p−1 2 q of q. Hence ∏ x∈P x ≡ ((p − 1)!) q−1 2 ( p − 1 2 ) !/q p−1 2 ( p − 1 2 ) ! ≡ (−1) q−1 2 (q p ) mod p, where the second equivalence comes from Wilson’s theorem, along with the fact that 1/q p−1 2 ≡ ±1 ≡ q p−1 2 ≡ (q p) mod p, using Euler’s criterion. Similarly ∏ x∈P x ≡ (−1) p−1 2 (p q ) mod q. In other words ∏ x∈P α(x) ≡ ( (−1) q−1 2 (q p ) , (−1) p−1 2 (p q )) mod (p, q) (3) On the other hand, since (Z/pqZ)× = P ∪ −P , the Chinese Remainder Theorem says that α(P ) = {α(x)|x ∈ P } contains exactly one of (a, b) and (−a, −b) for each 1 ≤ a ≤ p − 1 and 1 ≤ b ≤ q−1 2 . Hence ∏ x∈P α(x) ≡ ± ( (p − 1)! q−1 2 , ( q − 1 2 )! p−1) ≡ ( (−1) q−1 2 , ( q − 1 2 ) !p−1) mod (p, q). Note that −1 ≡ (q − 1)! ≡ 1 · 2 · · · q − 1 2 · (−1)(−2) · · · (− q − 1 2 ) ≡ (−1) q−1 2 ( q − 1 2 ) ! 2 mod q, hence ( q − 1 2 )! p−1 ≡ (( q − 1 2 ) ! 2) p−1 2 ≡ ((−1)(−1) q−1 2 ) p−1 2 ≡ (−1) p−1 2 (−1) p−1 2 q−1 2 mod q. Thus ∏ x∈P α(x) ≡ ± ((−1) q−1 2 , (−1) p−1 2 (−1) p−1 2 q−1 2 ) mod (p, q). (4) Dividing (3) by (4), we get (1, 1) ≡ ± ((q p ) , (−1) p−1 2 q−1 2 ( p q )) mod (p, q). This means (q p ) = (−1) p−1 2 q−1 2 ( p q ) , which is precisely the Quadratic Reciprocity Law. 67 The following exercises are related to our proof of quadratic reciprocity. Exercise 9.9. Let p, q be distinct odd primes. Determine the elements x ∈ (Z/pqZ)× such that x2 ≡ 1 mod pq. (Hint: think about the Chinese Remainder Theorem). Using this, prove that∏x∈(Z/pqZ)× x ≡ 1 mod pq in the same way we proved Wilson’s Theorem. Exercise 9.10. As in the proof, set P = {1 ≤ x ≤ pq − 1 2 | gcd(x, pq) = 1 } . Deduce from the previous exercise that (∏x∈P x)2 ≡ 1 mod pq. Note that if one knew ∏x∈P x ≡ ±1 mod pq, this would say ∏x∈P α(x) ≡ ±(1, 1) mod (p, q), hence (3) would mean (−1) q−1 2 (q p) = (−1) p−1 2 (p q), which is not true. (In the previous exercise, you determined which elements square to 1, and it’s not just ±1 anymore.) As we see from (4), the actual determination of ∏x∈P α(x) (even up to ±1) is more complicated. This is an example of how working mod pq is more complicated than working mod p. Now we can sketch the proofs of Theorems 9.1. Proof. (of Theorem 9.1) First suppose p is an odd prime of the form x2 + 2y2. Then examining the squares mod 8 shows p ≡ 1, 3 mod 8. This is the easy direction of Theorem 9.1. To prove the converse, we ﬁrst claim that p = x2 + 2y2 if and only if p is not prime in Z[√ −2], which we know has unique factorization from Chapter 7. If p = x2 +2y2 then (x+y√−2)(x−y√−2) is a non-trivial factorization of p in Z[ √−2] so it is not prime. Conversely, if p factors non-trivially in Z[ √−2], say p = αβ, then p2 = N (α)N (β) implies N (α) = x2 + 2y2 = p where α = x + y√−2. (Actually, we only need the “if” direction of this claim.) Now suppose p ≡ 1, 3 mod 8. Then we claim p|m2 + 2 for some m. This follow from the two supplementary laws of quadratic reciprocity: p|m2 + 2 iﬀ m2 ≡ −2 mod p iﬀ (−2 p ) = (−1 p )(2 p) = 1, which is true. Since p|(m + √−2)(m − √−2), but p ∤ m ± √−2 in Z[√ −2], p is not prime by the prime divisor property. This proves the Theorem. Note that we did not actually need quadratic reciprocity—just the supplementary laws. We do however for Theorem 9.2, which is homework. Exercise 9.11. (Proof of Theorem 9.2) Let p > 3 be prime. (i) Show p = x2 + 3y2 implies p ≡ 1 mod 3. (ii) Show p = X 2 − XY + Y 2 with X ≡ Y mod 2 if and only if p is not prime in Z[ζ3]. (iii) Find half-integers a, b, c, d ∈ 1 2 Z such that X 2 − XY + Y 2 = x2 + 3y2 where x = aX + bY , y = cX + dY . (iv) Deduce that p = x2 + 3y2 if and only if p is not prime in Z[ζ3]. (v) Suppose p ≡ 1 mod 3. Using quadratic reciprocity, show p|m2 + 3 for some m. Conclude p is of the form x2 + 3y2. 9.9 Discussion Worthwhile reading. I am thinking about trying to cover some higher reciprocity laws in the second semester, so let me know if you think it sounds interesting. 68","libVersion":"0.3.1","langs":""}
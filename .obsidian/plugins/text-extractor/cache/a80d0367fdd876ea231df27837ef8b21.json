{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Kimball Martin/NT 1 (Intro to NT)/Notes/chap78.pdf","text":"7 Quadratic Integers In the last chapter, we used unique factorization in Z[i] to study sums of squares. Here we give a study what happens in the rings Z[ √−2] and Z[ √−3]. We will go through these cases fairly quickly, and not give all of the details, as we will soon look at the general case. The sections in the notes no longer match up with the sections in the text for this chapter. First, for the record we deﬁne for n ∈ N, the imaginary quadratic rings Z[ √−n] = {a + b √−n|a, b ∈ Z } These are all rings, in the sense that they contain Z and are closed under addition and multiplication. Fix n. For α = a + b √−n, the conjugate is α = a − b √−n and the norm is N (α) = αα = a2 + nb2. Note that α = a + ib √n and α = a − ib √n, so conjugation in Z[ √−n] coincides with complex conjugation. This also means N (α) = |α|2. Note the norm is never negative. We say u ∈ Z[ √−n] is a unit of Z[ √−n] if u is invertible in Z[ √−n], which is equivalent to N (u) = 1. As before we have the properties αβ = αβ (ordinary complex conjugation) and N (αβ) = N (α)N (β). For α, β ∈ Z[ √−n], we say β is a divisor of α, and write β|α, if α = βγ for some γ ∈ Z[ √−n]. In rings without unique factorization, we do not usually use the term prime as we have been (or it is deﬁned diﬀerently). Instead, we talk about irreducibles (which include the units). Let’s start using this terminology now. We say α is irreducible if the only divisors of α are u and uα where u is a unit, i.e., if α has no non-trivial factorizations. Example. The irreducible elements of Z are ±1 and ±p for p prime. Example. The irreducible elements of Z[i] are the units and the primes of Z[i]. Proposition 7.1. Any non-zero α ∈ Z[ √−n] factors into a product of irreducibles. The proof is identical to the proof of existence of prime factorzation in Z and Z[i]. 7.1 Factorization in Z[ √−2] and Z[√−3] Deﬁnition 7.2. We say Z[ √−n] has unique factorization if for any non-zero, non-unit α ∈ Z[ √−n] and any two irreducible factorizations α = ∏ πi = ∏ π′ j (where πi, π′ j are irreducible non-units) we have, up to relabeling, πi = uiπ′ i for some unit ui. This coincides with our notions of unique factorization in the cases Z and Z[i]. Let us recall our approach for proving unique factorization in these cases. In Z (or rather N), we ﬁrst observed that gcd(a, b) = gcd(b, a − b). Then we used the Euclidean algorithm to show that gcd(a, b) = ma + nb for some m, n ∈ Z. From this, we got the prime divisor property (p|ab =⇒ p|a or p|b), and unique factorization follows formally. In Z[i], we ﬁrst demonstrated the division property: for any α, β ∈ Z[i] and non-zero, there exist µ, ρ ∈ Z[i] such that α = µβ + ρ where N (ρ) < N (β). This gave us a Euclidean algorithm 51 for computing some (non-unique) gcd(α, β) in Z[i]. This implies any gcd(α, β) = µα + νβ for some µ, ν ∈ Z[i]. Then we concluded the prime divisor property and unique factorization as before. The key step (meaning the only one that can fail) is the division property. The idea of the proof of the division property was that L = {µβ : µ ∈ Z[i]} formed a square lattice in the complex plane, so the furthest α could be from a corner of L was |β| √2 . Proposition 7.3. Let α, β ∈ Z[√ −2] be non-zero. Then there exist µ, ρ ∈ Z[√−2] such that α = µβ + ρ, |ρ| < |β| or equivalently, α = µβ + ρ, N (ρ) < N (β). Proof. The multiples of β are L = { mβ + n√−2β = mβ + ni√2β} , in other words, the lattice in C generated by β and i √2β. Recall multiplication by i rotates 90 degrees, so i √2β is the vector obtained by rotating β 90 degrees and scaling by √2. Hence L is a rectangular lattice with side lengths |β| and √2|β|. The distance from the midpoint of one of these rectangles to the corner is v u u √ ( |β| 2 )2 + ( √2|β| 2 )2 = √ |β|2 + 2|β|2 4 = √3 2 |β| Thus the closest lattice point (or corner) µβ to α is at most distance √ 3 2 |β| away. Letting ρ = α−µβ, we see |ρ| = √3 2 |β| < |β|. Corollary 7.4. Z[ √−2] has unique factorization. This follows in the same way. We omit the details. If we try to do the same thing in Z[ √−3], we have a rectangular lattice and the rectangles have dimension |β| × √3|β|. But then the midpoint of one such rectangle has distance v u u √ ( |β| 2 )2 + ( √3|β| 2 )2 = √ |β|2 + 3|β|2 2 = |β| from the corners, so we don’t have a similar division property in Z[√−3]. This suggests in fact Proposition 7.5. Z[ √−3] does not have unique factorization. Proof. 4 = 2 · 2 = (1 + √−3)(1 − √−3). Further 2, 1 + √−3 and 1 − √−3 are all irreducible in Z[ √−3] because they all have norm 4, and Z[ √−3] has no elements of norm 2 (since 2 ̸= x2 + 3y2). 52 However, an amazing thing happens. Let ζ3 = e2πi/3 = cos(2π/3) + i sin(2π/3) = − 1 2 + i √3 2 = −1 + √−3 2 . If we extend the ring Z[√−3] to include ζ3, namely set Z[ζ3] = {a + bζ3|a, b ∈ Z} . Just like Z[ √−n] this is a ring. The two things to check are that it’s closed under addition, which is obvious, and closed under multiplication. Exercise 7.1. Show ζ 2 3 + ζ3 + 1 = 0. Using this, deduce that Z[ζ3] is closed under multiplication. (Note the set of integer linear combinations of 1 and α, {a + b · α|a, b ∈ Z}, is not always closed under multiplication. For example when α = 3√2 or α = e2πi/5, α2 is not a linear combination of 1 and α.) Then we get the following. Proposition 7.6. Let α, β ∈ Z[ζ3] be non-zero. Then there exist µ, ρ ∈ Z[ζ3] such that α = µβ + ρ, |ρ| < |β|, or equivalently, α = µβ + ρ, N (ρ) < N (β). Proof. Note that multiplication by ζ3 = e2πi/3 in C is simply rotation by 120 degrees. Thus the multiples µβ form the lattice L = {mβ + nζ3β} . This divides the complex plane not into rectangles, but parallograms. In fact, into equilateral triangles, each of side length |β|. Now α lies in (or on the border of) one of these triangles, and the distance to the closest corner µβ must be less than |β|. Exercise 7.2. For α ∈ Z[ζ3], let α be the complex conjugate of α, and deﬁne the norm by N (α) = |α|2 = αα. (The norm of a + bζ3 is not (a + bζ3)(a − bζ3).) Show α ∈ Z[ζ3] for any α ∈ Z[ζ3]. Compute ζ 3, N (ζ3) and N (1 + ζ3). Write down a formula for N (a + bζ3) where a, b ∈ Z. Exercise 7.3. Determine the units of Z[ζ3] (the elements of norm 1). One also deﬁnes units and irreducibles for Z[ζ3] in the same way. As before, the division property yields Corollary 7.7. Z[ζ3] has unique factorization. In the general case, Z[ √−n] typically does not have unique factorization (it happens only ﬁnitely many times). Nevertheless, one can always enlarge the ring Z[ √−n] to some slightly bigger ring R such that any element of Z[ √−n] factors uniquely into irreducibles in R; however, R itself may not have unique factorization. This route essentially was what Kummer pursued (and had great success); however Dedekind’s ideal theory provides a much simpler approach. This is what we will aim for by the end of the course. Exercise 7.4. Exercise 7.4.1. This resolves the non-unique factorization of 4 = 2·2 = (1+√−3)(1−√−3) in Z[ √−3] by going to Z[ζ3]. 53 7.2 Applications Here we give a couple examples of the power of unique factorizations. There are inﬁnitely many solutions to y3 = x2 + 2 in Q, which was known to Diophantus. However Fermat claimed, and Euler mostly proved, Proposition 7.8. The only solution to y3 = x2 + 2 in N is (x, y) = (5, 3). Proof. (Sketch) Suppose y3 = x2 + 2 = (x + √−2)(x − √−2). It is not too hard to show that x + √−2 and x − √−2 are relatively prime in Z[ √−2]. Since their product is a cube, then both x + √−2 and x − √−2 are cubes. Write x + √−2 = (a + b √−2) 3 = a 2 − 6ab 2 + (3a 2b − 2b 3) √−2. Hence x = a3 − 6ab 2, 1 = b(3a2 − 2b 2). From the second equation, we have b = ±1 and 3a2 − 2b2 = 3a2 − 2 = 1, so a = ±1 and x = ±5. Theorem 7.9. x3 + y3 = z3 has no solutions in N. Proof. (Sketch) Suppose we have a solution z3 = x3 + y3. Dividing by any common factors, we may assume x, y, z are (pairwise) relatively prime. Note z3 = x3 + y3 = (x + y)(x2 − xy + y2) = (x + y)(x + ζ3y)(x + ζ 2 3 y). One can show that x+y, x+ζ3y and x+ζ 2 3 y are relatively prime in Z[ζ3]. Then unique factorization implies that, up to units, they are all cubes in Z[ζ3]. In fact, one may assume that x + ζ3y is a cube (multiplying by units just reorders these three factors and interchanges x and y), i.e., x + ζ3y = (a + bζ3)3 = a3 + b 3 − 3ab2 + 3ab(a − b)ζ3. Hence y = 3cd(c − d) ≡ 0 mod 3. Thus we have z3 − x3 = (z − x)(z − xζ3)(z − xζ 2 3 ) is divisible by 3. As before, z − x, z − xζ3, z − xζ 2 3 are relatively prime in Z[ζ3]. The element π = √−3 is a prime in Z[ζ3] (it’s norm is 3, which is prime in Z). We say α ≡ β mod π if π|(α − β). This is well deﬁned. By unique factorization, π must divide one of z − x, z − xζ3, z − xζ 2 3 . But in fact one can show z − x ≡ z − xζ3 ≡ z − xζ 2 3 mod π, hence π divides all three factors, contradicting relative primeness. Exercise 7.5. What are the possible remainders mod π = √−3 in Z[ζ3]? (Hint: they will be the elements whose norm is less than that of π.) Show that for any z, x ∈ Z (or even Z[ζ3]) z − x ≡ z − xζ3 ≡ z − xζ 2 3 , which we need in the proof of Fermat’s Last Theorem for n = 3. (If you need at hint, look at p. 131.) 54 Lamé thought he could generalize this kind of proof and show Fermat’s Last Theorem in general, but his proof failed due to failure of unique factorization in the cyclotomic integers Z[ζn] for most n. Nevertheless, Kummer developed a theory to try to recover unique factorization by going to larger rings, as mentioned above, and used this to prove Fermat’s Last Theorem in a large number of cases. If people show interest, I will try to say more about this later. Exercise 7.6. Fermat’s Last Theorem says xn + yn = zn has no solutions in N if n > 2. Show that if d|n then a solution to xn + yn = zn give a solution to xd + yd = zd. Deduce that Fermat’s Last Theorem is true for n ≡ 0 mod 3. Also deduce that to prove Fermat’s Last Theorem, it suﬃces to prove it for n = 4 and n = p where p is any odd prime. 7.3 Discussion For more details, see the text. The discussion section is worth reading. Also Section 7.5, which I didn’t touch on, is interesting. 55 8 The four square theorem 8.1 Some theorems After having answered a question, which numbers are sums of two squares, it is natural to ask which numbers are sums of three squares or four squares. Surprisingly, case of 3 squares turns out to be harder than 4 squares! Using the theory of quadratic forms (largely developed by him), the great genius Gauss showed Theorem 8.1. (Legendre–Gauss, 1801) n ∈ N is a sum of three integral squares if and only if n is not of the form 4a(8m + 7). He also determined the number of ways n is a sum of three cubes. We will not go into that here, but may revisit it next semester when we cover binary quadratic forms if there is interest. In any case, this was considerably more diﬀerent than the following result, which seems to have been observed without proof by Diophantus. Theorem 8.2. (Diophantus–Lagrange, 1770) Every n ∈ N is a sum of four integral squares. Note that Lagrange’s theorem does not say every n is a sum of exactly 4 positive squares. For example, 1 = 12 + 02 + 02 + 02. Therefore, a common way to state Lagrange’s theorem is that every number is a sum of at most 4 squares. Before we talk about how to prove Lagrange’s theorem, let me mention a nice generalization observed by Fermat. I can think of n2 as the number of points square lattice, with side length n. We can also make an equilateral triangular lattice, of side length n. In the top row there is 1 point, in the second 2 and so on. Hence there are 1 + 2 + · · · + n = n(n+1) 2 total points. Thus we call the numbers n(n+1 ) 2 triangular numbers. Theorem 8.3. (Fermat–Gauss, 1796) Every n ∈ N is a sum of at most 3 triangular numbers. More generally, one can deﬁne k-gonal numbers as the number of points one can get from regular k-gonal lattices. Theorem 8.4. (Fermat–Cauchy, 1813) Every n ∈ N is a sum of at most k k-gonal numbers. Legendre showed that in fact 4 or 5 k-gonal numbers suﬃce depending on whether n is odd or even. (Cf. L.E. Dickson’s, History of the theory of numbers.) In the case of three triangular numbers or four squares, one knows formulas for the number of ways n can be written in these forms, but—if I remember correctly—formulas for general k are not known. Another related question, still unsolved, is Waring’s problem. In 1909, Hilbert show for every k ∈ N, there is a smallest number g(k) such that every n ∈ N is a sum of at most g(k) k-th powers. Lagrange’s theorem says g(2) = 4. Further g(3) = 9 and and g(4) = 19. What is g(k)? (Rather the more interesting question is, what is the smallest number G(k) of k-th powers needed to represent every suﬃciently large integer. For example G(4) = 16. I.e., almost every integer is a sum of 16 4-th powers, but there are a ﬁnite number of special ones which require up to 19.) 8.2 Three proofs There are several diﬀerent proofs of Lagrange’s four square theorem. One can deduce it from either Gauss’s theorem on the sum of 3 squares or Gauss’s theorem on the sum of 3 triangular numbers 56 (cf. Grosswald’s Representations of Integers as Sums of Squares), but both of Gauss’s theorems are harder to prove. Below we brieﬂy discuss three relatively simple ways one can prove Lagrange’s four square theorem. In all cases, we will just sketch the proofs, leaving out the more tedious details. The ﬁrst two proofs both use the following two lemmas. Lemma 8.5. Suppose n and m are sums of four squares. Then so is mn. Hence it suﬃce to prove every odd prime p is a sum of four squares (p = 2 clearly is 12 + 12 + 02 + 02). Exercise 8.1. Let p be an odd prime. We say a is a square or quadratic residue mod p if a ≡ x2 mod p for some x. Prove there are p+1 2 distinct squares mod p. Exercise 8.2. Let p be an odd prime. Show x2 + y2 ≡ −1 mod p for some x, y ∈ Z. (Hint: use the previous exercise and the pigeonhole principle.) Note this exercise looks similar to Lagrange’s lemma from Chapter 6. In fact it was also proved by Lagrange, and we restate it in the following form. Lemma 8.6. (Lagrange) Let p be an odd prime. Then p divides x2 + y2 + 1 for some x, y ∈ Z. 8.2.1 The algebraic proof One idea, which is the proof given in the text, is to generalize the proof of Fermat’s two square theorem using Z[i]. Hence we want a ring R and a norm map N : R → Z which looks like a2 + b2 + c2 + d2. Answer: the quaternions. Let H = R[i, j, k] = {a + bi + cj + dk|a, b, c, d ∈ R} , where i 2 = j2 = k2 = ijk = −1. This is a non-commutative division algebra, known as Hamilton’s quaternions. It is some sort of generalization of the complex numbers. Just as C is 2-dimensional over R, this is 2-dimensional over C, or 4-dimensional over R (as a vector space). H has many applications, and is closely related to the algebra of 2 × 2 real matrices. Note that going from R to C, one loses the natural well-ordering one had on R, and going from C to H one loses commutativity. Incidentally one can extend the quaterions to the octonions O, but then one loses associativity. Nevertheless, the octonions also have various applications. The norm on H is given by N (a + bi + cj + dk) = a 2 + b 2 + c 2 + d 2. The integers of H, also called the Hurwitz integers are R = Z[ 1 + i + j + k 2 , i, j, k] = { a + bi + cj + dk 2 |a, b, c, d ∈ Z, a ≡ b ≡ c ≡ d mod 2 } . Then N : R → Z. 57 Theorem 8.7. R has unique factorization. Lemma 8.8. n is a sum of four squares if and only if n = N (α) for some α ∈ R. Note that Lemma 8.5 is a simple consequence of this lemma and the fact that the norm is multiplicative. Corollary 8.9. p is a sum of four squares if and only if p is not prime (irreducible) in R. So we want to show no prime p of N is prime in R. Let p be an odd prime. Then by Lagrange’s Lemma 8.6 we have, for some x, y ∈ Z, p|1 + x2 + y2 = (1 + xi + yj)(1 − xi − xj). Since 1 ± xi ± yj p ̸∈ R p does not divide either factor on the right. Hence by unique factorization/prime divisor property, p is not prime in R. 8.2.2 The geometric proof This proof is taken from Algebraic Number Theory and Fermat’s Last Theorem by Stewart and Tall. Suppose you have a sublattice L of Z2 generated by two elements (a, 0) and (0, b), i.e., L = {am + bn|m, n ∈ Z}. This provides a tiling of R2 by rectangles, each of area ab. A theorem of Minkowski says that if X is a bounded symmetric (X = −X) domain of R2 and has volume greater than 4ab, it contains a non-zero point of L. Minkowski’s theorem applies in any dimension, and we consider it in dimension 4. Speciﬁcally, let p be an odd prime, and let x, y ∈ Z such that p|x2 + y2 + 1. Consider the lattice L ⊂ Z4 given by L = {(a, b, c, d)|a, b, c, d ∈ Z, c ≡ xa + yb mod p, d ≡ xb − ya mod p} . The point is then that each lattice point satisﬁes a 2 + b 2 + c 2 + d 2 ≡ a 2 + b 2 + x2a 2 + y2b 2 + x2b 2 + y2a 2 ≡ a 2(1 + x2 + y2) + b 2(1 + x2 + y2) ≡ 0 mod p. The lattice L tiles R4 into 4-dimensional rectangles, each of volume p2. Let X be a 4-dimenional sphere of radius r, which has volume π2r4/2. If we choose r such that r2 = 1.9p, then the volume of X is greater than 16p2, which by Minkowski’s theorem say X contains a non-zero lattice point (a, b, c, d). This means a 2 + b 2 + c 2 + d 2 ≤ r2 = 1.9p < 2p. On the other hand a2 + b2 + c2 + d2 ≡ 0 mod p means a2 + b2 + c2 + d2 = p. One can do a similar proof to show any prime of the form 4n + 1 is a sum of two squares. 58 8.2.3 The analytic proof This proof is basically due to Jacobi, but recast in the language of modular forms. Let r4(n) denote the number of solutions to n = a2 + b2 + c2 + d2 in Z. Consider the function θ(z) = ∞∑ n=−∞ zn2. Then Θ(z) = θ(z)4 = ∑ anzn = 1 + ∞∑ n=1 r4(n)zn = 1 + 8z + 12z2 + · · · To see this, ﬁrst we know that Θ(z) has a power series expansion because θ(z) does. Now what is the coeﬃcient an of the n-th term? We just need to count the number of ways zn is a product za2zb2zc2zd2, i.e, it is r4(n) for n > 0. One shows that Θ(z) satisﬁes certain transformation properties, which means that it is what is called a modular form of weight 2 on Γ0(4). However this is a two dimensional space of functions generated by F (z) = 1 24 + ∑ n odd σ(n)zn + ∑ 2n (σ(2n) − 2σ(n))z2n = 1 24 + z + z2 + 4z3 + z4 + · · · and G(z) = 1 24 + ∑ n odd σ(2n)z2n + ∑ 2n (σ(4n) − 2σ(2n))z4n = 1 24 + z + z4 + 4z6 + · · · where σ(n) = ∑d|n d. Hence for some a, b we have Θ(z) = aF (z) + bG(z). By comparing the ﬁrst two coeﬃcients, we have in fact Θ(z) = F (z) + 2G(z) 3 . Solving for the coeﬃcients gives r4(n) = { 8σ(n) n ̸≡ 0 mod 4 8(σ(n) − 4σ(n/4)) n ≡ 0 mod 4. Since we see r4(n) > 0 this gives Lagrange’s theorem, together with a formula for number of ways n is a sum of 4 squares. Jacobi also used this idea to prove a formula for r2(n). I’ll go through this in detail in the modular forms course next year. 59","libVersion":"0.3.1","langs":""}
{"path":"iCloudDrive/bks/Calculus/Handouts/gamma_beta.pdf","text":"Gamma and Beta Integrals Jeﬀery Yu May 30, 2020 This article presents an overview of the gamma and beta functions and their relation to a variety of integrals. We will touch on several other techniques along the way, as well as allude to some related advanced topics. However, we will not worry about the ﬁner details of convergence, and all given integrals do convergence for the given bounds. Most of these kinds of integrals that would occur on an integration bee are solvable via other traditional methods too, but our methods will often provide quicker and more methodical solutions. The prerequisite is standard single-variable integration, primarily of polynomial, exponential, and trigonometric functions, along with integration by substitution (reverse chain rule, often called u-substitution), integration by parts (reverse product rule), and improper integrals. There are a couple derivations involving partial derivatives or double integrals, but otherwise multivariable calculus is not essential. 1 Gamma Function Our study of the gamma function begins with the interesting property ∫ ∞ 0 x ne−x dx = n! for nonnegative integers n. 1.1 Two derivations The diﬃculty here is of course that xne−x does not have a nice antiderivative. We know how to integrate polynomials xn, and we know how to integrate basic exponentials e−x, but their product is annoying. Let’s consider some small cases ﬁrst. If n = 0, then we have the familiar integral ∫ ∞ 0 e−x dx = lim a→∞ ∫ a 0 e−x dx = lim a→∞ −e −x\f \f \fa 0 = lim a→∞(1 − e−a) = 1. If n = 1, then we might recognize it as a typical integration by parts example: ∫ ∞ 0 xe−x dx = (−xe−x)\f \f \f∞ 0 − ∫ ∞ 0 −e−x dx = 1. Note that the xe −x vanishes at the upper limit due to the e−x and at the lower limit due to the x. Continuing, if n = 2, then there isn’t a single-step solution, but we can try integrating by parts again: ∫ ∞ 0 x2e−x dx = (−x2e−x) \f \f \f∞ 0 − ∫ ∞ 0 −2xe −x dx = 0 + 2 ∫ ∞ 0 xe −x dx = 2. Aha! We were able to reduce the integral to a smaller case we already knew how to do. We can try to apply this to the more general problem too, where we apply integration by parts through diﬀerentiating the power function and integrating the exponential function: ∫ ∞ 0 xne−x dx = (−xne−x)\f \f \f∞ 0 − ∫ ∞ 0 −nxn−1e−x dx = n ∫ ∞ 0 xn−1e−x. 1 1.1 Two derivations 1 GAMMA FUNCTION In essence, each time we apply integration by parts, we reduce the power by 1. If we denote the integral as I(n) = ∫ ∞ 0 xne−x dx, then we have just obtained the recursion relation I(n) = n · I(n − 1). If we apply this again to I(n − 1), then we would get I(n) = n · I(n − 1) = n(n − 1) · I(n − 2), and so on, decreasing the argument of I until it gets down to something we know. In this case, we showed earlier the base case I(0) = ∫ ∞ 0 x0e−x dx = 1. This recursion relation along with the base case match exactly those of the factorial function! Hence we may conclude I(n) = n!, so ∫ ∞ 0 xne−x dx = n! for nonnegative integers n. This approach of reducing integrals via recursion is known as using a reduction formula. Exercise 1.1. Determine a general form for the indeﬁnite integral ∫ x ne−x dx for nonnegative integers n. Exercise 1.2. Determine reduction formulas for ∫ sin n x dx and ∫ cosn x dx. We now provide a second approach via diﬀerentiation with respect to an external parameter. To motivate this, consider the following simple integral: ∫ ∞ 0 e−2x dx = − 1 2 e−2x\f \f \f∞ 0 = 1 2 . Of course, nothing is special about 2, and we could easily replace it with another number, say π: ∫ ∞ 0 e−πx dx = − 1 π e−πx\f \f \f∞ 0 = 1 π . In these cases, it was simple enough to write down the antiderivative by guessing or inspection, but a substitution would also have worked. We can generalize this more to any real number a: ∫ ∞ 0 e−ax dx = − 1 a e−ax\f \f \f∞ 0 = 1 a . We’ll restrict ourselves to a > 0 to ensure that the integral converges. (If a were negative then e−ax would behave like ex, which blows up at ∞.) At this point, we have introduced a as an arbitrary constant, but we can also treat it as a function parameter that we can vary, similar to the n in I(n). In this case, we won’t deﬁne a new function in terms of a yet, but rather we’ll take a derivative with respect to a. In particular, taking the derivative of both sides of the above equation gives d da ∫ ∞ 0 e−ax dx = d da 1 a . The right side is easy to evaluate as it’s simply − 1 a2 . For the left side, it would be nice if we could just apply the derivative to the e−ax. Formally, in order to do that, we have to swap the order of diﬀerentiation and integration; that is, we want to move the derivative inside the integral. Swapping a derivative and integral 2 1.2 Properties 1 GAMMA FUNCTION is not always legal, and this is generally governed by Leibniz’s integral rule. In our case, everything is continuous and well-behaved, so doing so gives d da ∫ ∞ 0 e−ax dx = ∫ ∞ 0 ∂ ∂a e−ax dx = ∫ ∞ 0 −xe−ax dx. Here, ∂ ∂a is a partial derivative, which should be treated as an ordinary derivative with respect to a, but keeping in mind that x is a constant from the perspective of the derivative. Hence our equation becomes ∫ ∞ 0 xe−ax dx = 1 a2 after removing the minus sign from both sides. We now repeat this procedure again: d dx ∫ ∞ 0 xe−ax dx = d dx 1 a2 ∫ ∞ 0 −x2e−ax dx = − 2 a3 . And again: d dx ∫ ∞ 0 x2e−ax dx = d dx 2 a3 ∫ ∞ 0 −x3e−ax dx = − 3 · 2 a4 . And again: d dx ∫ ∞ 0 x3e−ax dx = d dx 3 · 2 a4 ∫ ∞ 0 −x4e−ax dx = − 4 · 3 · 2 a5 . At this point a pattern emerges, and it is not diﬃcult to show inductively that the general result is ∫ ∞ 0 xne−ax dx = n! an+1 for nonnegative integers n. Taking a = 1 gives the desired result ∫ ∞ 0 xne−x dx = n!. Notice how we actually solved a more general integral in the process. We started with our original integrand just as a function of x, introduced an external parameter a, and then diﬀerentiated with respect to a. In doing so, we derive a whole class of integrals at once, and we can substitute any appropriate value for a to get a speciﬁc integral. These parameters are generally introduced in place of constants or coeﬃcients. Exercise 1.3. Compute ∫ 1 0 x 2019(ln x)2020 dx and ∫ 1 0 x42( log 1 x )1337 dx. Exercise 1.4. Compute ∫ ∞ −∞ 1 (x2 + 4)2 dx, ∫ ∞ −∞ x2 (3x2 + 1)2 dx, and ∫ ∞ −∞ x4 (x2 + 1)5 dx.. 1.2 Properties We are now ready to formally introduce the gamma function. 3 1.2 Properties 1 GAMMA FUNCTION Deﬁnition. The gamma function is Γ(z) = ∫ ∞ 0 tz−1e−t dt Here, we use t as the variable of integration to place greater emphasis that this is a function of z, the variable in the power. As suggested by the z, we can also allow for complex numbers. The integral will converge for all Re(z) > 0. The decaying exponential e−t will suppress any power of t at ∞. On the other hand, if Re(z) ≤ 0, then the magnitude of tz−1 behaves as 1 t , whose integral diverges at 0. This function can actually be extended to include almost all complex numbers through analytic continuation. For Re(z) ≤ 0, the integral representation no longer holds as it diverges, but complex analysis provides a way to uniquely extend it to the entire complex plane, except at the nonpositive integers. For our purposes, we’ll only use Re(z) > 0, where the integral is meaningful. The most important thing to notice is that the power is tz−1 rather than tz. There are a variety of historical reasons for this. However, arguably the mathematical reason for this is that at a deeper level, the integral should actually be viewed as ∫ ∞ 0 tze −t dt t , where dt t is the Haar measure on the multiplicative group of positive reals. From our above derivations, we have Γ(n) = (n − 1)! for positive integers n. From integration by parts, we also have the recursion formula Γ(z + 1) = z · Γ(z) . Note that because of the oﬀ-by-one shift, the gamma recursion is not the same as the factorial recursion. The statement 5! = 5 · 4! would translate into Γ(6) = 5 · Γ(5), not Γ(6) = 6 · Γ(5) which is a false statement. This recursion extends beyond just the positive integers, but to all positive real numbers. In this sense, the gamma function extends the factorial function while maintaining its deﬁning property. This is not the only possible extension, but it is in some sense the best and arguably most useful. We can make this extension unique by adding an additional property. Speciﬁcally, the Bohr-Mollerup theorem says that f (x) = Γ(x) is the only function f : R+ → R satisfying f (1) = 1, f (x + 1) = xf (x) for all x > 0, and is logarithmically convex. The integral provides another reason why 0! should equal 1, namely that 0! = Γ(1) = ∫ ∞ 0 e−x dx = 1. We could also have applied the recursion Γ(2) = 1 · Γ(1), which gives Γ(1) = 1. In factorial terms, this would be 1! = 1 · 0!. If we were to try to apply the recursion further, we would get Γ(1) = 0 · Γ(0), and no ﬁnite real (or complex) value of Γ(0) could satisfy this equation. Hence Γ(0) must be inﬁnite, and this cascades downward to all negative integers. Note that it suﬃces to determine the values of Γ(z) on any unit interval, say 0 < z ≤ 1, and the values at other real numbers can be computed via recursion. So far, we only know Γ(1) on this range, which gives us all the integers. Next we will determine Γ(1/2). It is possible to determine directly from the Gaussian integral ∫ ∞ −∞ e−x2 dx, whose value is often determined with multivariable integration. Instead, we will do the reverse, ﬁrst determining Γ(1/2) independently, and then applying it to determine the value of the integral. To proceed, we will ﬁrst prove a useful result: Γ(z)Γ(1 − z) = π sin(πz) . Recall the limit e −t = lim n→∞ (1 − t n )n. 4 1.2 Properties 1 GAMMA FUNCTION Substituting this into the gamma integral Γ(z) = ∫ ∞ 0 lim n→∞ t z−1( 1 − t n )n dt = lim n→∞ ∫ n 0 tz−1(1 − t n )n dt. Note that we have incorporated n as the variable limit for both Euler’s constant as well as the improper integral.1 Next we repeatedly integrate by parts, diﬀerentiating the (1 − t n )n and integrating the tz−1: ∫ n 0 tz−1(1 − t n )n dt = tz z ( 1 − t n )n\f \f \f \f \f n 0 − ∫ n 0 t z z (− n n )( 1 − t n )n−1 dt = n nz ∫ n 0 t z( 1 − t n )n−1 dt. Notice that positive powers of t evaluates to 0 at t = 0 and positive powers of 1 − t n evaluate to 0 at n, so the ﬁrst term will continue to be 0. Integrating by parts n times therefore gives Γ(z) = lim n→∞ n nz · n − 1 n(z + 1) · n − 2 n(z + 2) · · · 1 n(z + n − 1) ∫ n 0 tz+n−1 dt = lim n→∞ n! nn n−1∏ k=0(z + k) · n z+n z + n = lim n→∞ nz z n∏ k=1 k z + k . Then applying recursion to Γ(1 − z) gives Γ(z)Γ(1 − z) = Γ(z) · (−z)Γ(−z) = −z ( lim n→∞ nz z n∏ k=1 k z + k )( lim n→∞ n−z −z n∏ k=1 k −z + k ) = lim n→∞ 1 z n∏ k=1 k2 k2 − z2 . The factors of n cancel, so now the limit only applies to the product to give lim n→∞ 1 z n∏ k=1 k2 k2 − z2 = 1 z ∞∏ k=1 k2 k2 − z2 . The k2 k2 − z2 factors look similar to the inﬁnite product expansion for sin: sin(πz) = πz ∞∏ k=1 ( 1 − z2 k2 ) = πz ∞∏ k=1 k2 − z2 k2 . This is the reciprocal, so rearranging gives Γ(z)Γ(1 − z) = π sin(πz) . This is the reﬂection formula, named as such because of its symmetry about 1 2 . Applying the reﬂection formula to z = 1 2 gives Γ(1/2)Γ(1/2) = π sin(π/2) = π, so Γ(1/2) = √π. Here, we chose the positive square root since the integral Γ(1/2) = ∫ ∞ 0 t −1/2e −t dt is clearly positive. This is what lets people say in popular mathematics that ( 1 2 )! has a value, namely given by ( 1 2 ) ! = Γ(3/2) = 1 2 Γ(1/2) = 1 2 √π. Thus we can compute the gamma function at integers and half-integers. Unfortunately, these are the only rational numbers on which there is a closed form. For denominators larger than 2, it is common to just leave expressions in terms of Γ(z). Of course, by recursion and reﬂection, all such fractions can be reduced to one in the range 0 < z < 1 2 . 1This step requires signiﬁcant justiﬁcation in real analysis, both moving the limit outside the integral and incorporating the limit with the integral. However we won’t worry about that here. 5 1.3 Applications 1 GAMMA FUNCTION 1.3 Applications Applying the gamma function to an integral involving polynomials with exponentials is fairly straightforward upon recognizing it as such. The general method is to make a substitution to convert whatever the exponential is into e−x. For example, to compute ∫ ∞ 0 x2019e−2020x dx, we would make the substitution u = 2020x. Remember with any substitution that we have to change both the limits of integration and the diﬀerential element. In this case x = u 2020 , so dx = du 2020 , and the limits are scaled 0 → 2020·0 = 0 and ∞ → 2020·∞ = ∞. Hence we can compute ∫ ∞ 0 x2019e−2020x dx = ∫ ∞ 0 ( u 2020 )2019e−u du 2020 = 1 20202020 ∫ ∞ 0 u 2019e−u du = 2019! 2020 . Note that all gamma-like integrals require an improper integral with a limit at ∞. For integrals of the form ∫ ∞ −∞, we can often exploit symmetry if the integrand is odd or even, in which case it evaluates to 0 or 2 ∫ ∞ 0 , respectively. If the limits are ﬁnite, then the nice values of Γ(z) no longer apply, and one would have to redetermine the relevant values. Earlier we alluded to the Gaussian integral ∫ ∞ −∞ e−x2 dx. We can use the same methods here. The integrand is even, so it suﬃces to compute a half of it. Substituting u = x2 would give x = u 1/2, so dx = 1 2 u−1/2 du, giving ∫ ∞ −∞ e−x2 dx = 2 ∫ ∞ 0 e−x2 dx = 2 ∫ ∞ 0 e−u · 1 2 u −1/2 du = 2 · 1 2 ∫ ∞ 0 u −1/2e−u du = Γ(1/2) = √π. This is particularly useful in statistics and probability theory where the Gaussian or normal distribution is prevalent. These also often show up in physics, particularly statistical physics and quantum physics which involve probability distributions of states. Quantities of interest include the mean/expectation and variance/uncertainty/standard deviation, which involve computing the integrals ∫ ∞ −∞ xe−x 2 dx and ∫ ∞ −∞ x2e−x2 dx, albeit with messier constants. These are all easily done using our methods. So far we have only used real numbers. One nice application of complex numbers is for gamma-like integrals with an extra sin or cos factor. Recall that e ix = cos x + i sin x. This eﬀectively allows us to switch between trigonometric functions and exponentials. For example, to compute ∫ ∞ 0 xe−x cos(x) dx, we could interpret the integral as the real part of ∫ ∞ 0 xe−x cos(x) dx + i ∫ ∞ 0 xe −x sin(x) dx = ∫ ∞ 0 xe−x(cos(x) + i sin(x)) dx = ∫ ∞ 0 xe−xeix dx. Now we have a typical gamma integral, just with complex numbers too, giving ∫ ∞ 0 xe −(1−i)x dx = 1! (1 − i)2 = 1 −2i = 1 2 i. The real part is 0, so we conclude that ∫ ∞ 0 xe−x cos(x) dx = 0. In fact, we can also immediately deduce that ∫ ∞ 0 xe−x sin(x) dx = 1 2 from the imaginary part. Converting between trigonometric functions and exponentials also works for indeﬁnite integrals. 6 2 BETA FUNCTION Exercise 1.5. Compute ∫ ∞ −∞ xe −x2 dx, ∫ ∞ 0 xe−x 2 dx, and ∫ ∞ −∞ x 2e−x2 dx. Exercise 1.6 (2020 MIT Integration Bee). Compute ∫ ∞ 0 x5e−x 4 dx. Exercise 1.7 (2019 MIT Integration Bee). Compute ∫ ∞ 0 e− 2019 4t2 t2 dt. Exercise 1.8 (2019 HMNT Integration Bee). Compute ∫ sin log x dx. Exercise 1.9 (2020 HMMT Integration Bee). Compute ∫ xex sin x dx. Exercise 1.10 (2020 HMMT Integration Bee). Compute ∫ ∞ 0 x 1 + ex dx. 2 Beta Function Unfortunately, there isn’t a good lead-in to motivate the beta function, so instead we’ll dive straight in. Deﬁnition. The beta function is B(x, y) = ∫ 1 0 tx−1(1 − t)y−1 dt. Notice now that this is a function in two variables, x and y. Which is which turns out to be not important, as substituting u = 1 − t gives B(x, y) = ∫ 1 0 t x−1(1 − t) y−1 dt = ∫ 0 1 (1 − u) x−1u y−1(− du) = ∫ 1 0 uy−1(1 − u) x−1 du = B(y, x). Hence we have that B(x, y) = B(y, x) so the beta function is symmetric. The powers are shifted by 1 for the same reasons as before. 2.1 Relation to gamma As with the gamma function, we ﬁrst try to get intuition for the beat function on integers. In these cases, there is a nice combinatorial interpretation. To keep the argument clean, let’s consider ∫ 1 0 tx(1 − t) y dx without the shift, and we’ll add the oﬀ-by-ones back at the end when writing the result in terms of B. Suppose we had x distinct red objects, y distinct blue objects, and one gray object, and they are randomly placed on the unit interval [0, 1]. Then the integral computes the probability that all the red objects come ﬁrst, followed by the gray object, followed by the blue objects. This is because it integrates over all possible positions 0 ≤ t ≤ 1 of the gray object, t is the probability for each red object to occur before t, and 1 − t is the probability for each blue object to occur after t. 0 1t 7 2.2 Applications 2 BETA FUNCTION There is another way we can compute the probability. Suppose, instead of randomly placing the objects one by one, we ﬁrst randomly chose the x + y + 1 positions that the objects will take, and then we distribute the objects among these positions. There are (x + y + 1)! ways to arrange the objects into these positions. A satisfactory arrangement will have the x red objects in the ﬁrst x spots, the gray object next, followed by the y blue objects in the remaining y spots. There are x! ways to arrange the red objects in their spots, and y! ways to arrange the blue objects. Hence the desired probability is x! y! (x + y + 1)! . We calculated the same probability in two diﬀerent ways, so they must equal, giving ∫ 1 0 tx(1 − t) y dt = x! y! (x + y + 1)! for nonnegative integers x and y. If we shift x 7→ x − 1 and y 7→ y − 1, then we get B(x, y) = ∫ 1 0 t x−1(1 − t) y−1 dt = (x − 1)! (y − 1)! (x + y − 1)! for positive integers x and y. We could write the factorials in terms of the gamma function as B(x, y) = Γ(x)Γ(y) Γ(x + y) . It would be natural to expect that this relation extends beyond just integers to all positive real numbers. Indeed it does, which we now prove. We start by expanding the numerator Γ(x)Γ(y) = ∫ ∞ 0 u x−1e−u du ∫ ∞ 0 vy−1e −v dv = ∫ ∞ 0 ∫ ∞ 0 u x−1vy−1e−u−v du dv. Next we substitute s = u + v in as v = s − u to get Γ(x)Γ(y) = ∫ ∞ 0 ∫ s 0 u x−1(s − u) y−1e−s du ds = ∫ ∞ 0 ∫ s 0 u x−1(1 − u s )y−1s y−1e−s du ds. Now we substitute2 t = u s in for u = st with du = s dt and get Γ(x)Γ(y) = ∫ ∞ 0 ∫ 1 0 (st) x−1(1−t) y−1s y−1e−ss dt ds = ∫ ∞ 0 s x+y−1e−s ds ∫ 1 0 tx−1(1−t) y−1 dt = Γ(x+y)B(x, y). Hence we obtain our desired relation B(x, y) = Γ(x)Γ(y) Γ(x + y) . 2.2 Applications Useful applications of the beta don’t necessarily come directly from its original form, but its numerous other forms that can be obtained from various substitutions. One particularly lucrative form is the trigonometric one, which allows fast evaluation of integrals of powers and products of trigonometric functions. We start similarly as before: Γ(x)Γ(y) = ∫ ∞ 0 u x−1e−u du ∫ ∞ 0 vy−1e −v dv = ∫ ∞ 0 ∫ ∞ 0 u x−1vy−1e−u−v du dv. This time, we make the substitutions u = s 2 and v = t2, with the hope of getting s 2 + t2 in the exponential and then converting to polar coordinates: Γ(x)Γ(y) = ∫ ∞ 0 ∫ ∞ 0 (s 2) x−1(t 2) y−1e−s 2−t22s ds2t dt = 4 ∫ ∞ 0 ∫ ∞ 0 s 2x−1t2y−1e−(s 2+t2) ds dt. 2In this case we are able to do the substitutions step-by-step, but more generally a change of variable to a double integral requires computing the Jacobian to determine how the diﬀerential area element changes. 8 A APPENDIX Now we change into polar coordinates with s = r cos θ, t = r sin θ, and ds dt = r dr dθ. Note that the region of integration is over the ﬁrst quadrant in s and t, so we have Γ(x)Γ(y) = 4 ∫ π/2 0 ∫ ∞ 0 (r cos θ) 2x−1(r sin θ)2y−1e−r2r dr dθ = 4 ∫ π/2 0 (cos θ) 2x−1(sin θ)2y−1 dθ ∫ ∞ 0 r2x+2y−1e−r2 dr. The r integral is evaluated using standard gamma methods to give 1 2 Γ(x + y), so we obtain ∫ π/2 0 (cos θ) 2x−1(sin θ) 2y−1 dθ = Γ(x)Γ(y) 2Γ(x + y) = 1 2 B(x, y) . Notice that this integral is from 0 to π/2. Oftentimes trig integrals will range from 0 to π or 2π, and in those cases one can use the symmetry of sin and cos to reduce it to the desired range. Exercise 2.1 (2020 HMMT Integration Bee). Compute ∫ 1 0 1 √x − x2 dx. Exercise 2.2 (2020 HMMT Intergration Bee). Compute ∫ π/2 0 (sin x) 3 dx. Exercise 2.3 (2020 HMMT Integration Bee). Compute ∫ π/2 0 sin 7 x cos7 x dx. Exercise 2.4 (2020 MIT Integration Bee). Compute ∫ 2π 0 cos2020(x) dx. A Appendix A.1 Hints 1.2 After integrating by parts you will need to apply sin2 x+cos 2 x = 1 to manipulate the remaining integral into the form you want. 1.3 Consider ∫ 1 0 xa dx. 1.4 Consider ∫ ∞ −∞ 1 ax2 + b dx. (Further hint: The indeﬁnite integral is a messy tan −1, but evaluating it at the bounds should help.) 1.7 The usual method works. You might be worried about the t being in the denominator, but that just means you have to remember to adjust the limits too! 1.10 Rewrite the integrand as xe−x 1 + e−x and expand the denominator as a geometric series with common ratio −e−x. (We have to rewrite the denominator in this form in order for the series to converge. Originally |ex| is unbounded, so the geometric series wouldn’t make sense, but |e−x| ≤ 1 on x ≥ 0.) 9","libVersion":"0.3.1","langs":""}
{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Kimball Martin/NT 2 (To the skies)/Notes (Individual sections)/chap5.pdf","text":"5 Non-unique factorizations In this chapter we brieﬂy discuss some aspects of non-unique factorization, ending with an applica- tion of quadratic forms (and more generally ideals) to factorization problems in rings of integers. 5.1 Principalization Let K be a number ﬁeld. Kummer approach to resolving the non-unique factorization of OK was essentially to work in a larger ring of integers R where every (nonzero nonunit) element of OK factors uniquely (up to order and units) into irreducibles in R. We can recast this approach in Dedekind’s language of ideals with the following notion. Deﬁnition 5.1.1. We say an ﬁnite extension L of K is a principalization ﬁeld for K,or prin- cipalizes K,if IOL is a a principal ideal of L for any ideal I of OK. Some authors instead say K capitulates in L. Proposition 5.1.2. Suppose L principalizes K.Leta be a nonzero nonunit in OK and write aOK =￿ pi be the prime ideal factorization of aOK in OK.Write piOL =(αi) for some αi ∈ OL.If a = ￿ βj is any irreducible factorization of a in OK,then each βj is, up to a unit of OL,a subproduct of the αi’s. In other words all irreducible factorizations of a in OK, comes from diﬀerent groupings of a single (not necessarily irreducible) factorization a = ￿ αj in OL. E.g., we may have something like a =(α1 ·· · αi1) ￿ ￿￿ ￿ β1 (αi1+1 ·· · αi2) ￿ ￿￿ ￿ β2 ·· · (αik+1 ·· · αm) ￿ ￿￿ ￿ βk+1 and any irreducible (or even non-irreducible) factorization of a in OK, just comes from a regrouping of the αi’s. Proof. Since L principalizes K, then for each i, we can write piOL =(αi) for some αi ∈ OL.(It is not necessarily true that each αi is irreducible.) Hence aOL = ￿ (piOL)= ￿ (αi). On the other hand, aOK = ￿ (βj) so each (βj) is a subproduct of the pi’s, say βj = pj1pj2 ·· · pjk so βj = uαj1 .. . αjk for some unit u ∈ OL. Example 5.1.3. Let K = Q( √−5) and L = Q( √−5, √2).To show L principalizes K,it suﬃces to show (2, √−5)OL is principal since (2, √−5) ⊆ OK generates the class group of K.(Justify to yourself that this is suﬃcient.) Note that (2, √−5)2 = (2).On the other hand (2) = ( √2)2 in OL.Since ( √2) is prime in OL,we must have ( √2) = (2, √−5)OL by the unique prime ideal factorization in OL.Thus L is a principalization ﬁeld for K. Let’s see how we can resolve the non-unique factorization 6=2 · 3= (1 + √−5)(1 − √−5) 75 in OK using principalization. Recall the prime ideal factorization of (6) in OK is (6) = (2, 1+ √−5) 2(3, 1+ √−5)(3, 1 − √−5). One can check that (2, 1+ √−5)OL =( √2) (we did this above) and (3, 1+ √−5)OL =( √2+ √−10 2 ) (3, 1 − √−5)OL =( √2 − √−10 2 ) (we’ll discuss this below). The above proposition say the irreducible factorizations of 6 in OK come from diﬀerent groupings of the factorization 6= (√2 · √2) ￿ ￿￿ ￿ 2 ( √2+ √−10 2 · √2 − √−10 2 ) ￿ ￿￿ ￿ 3 =( √2 · √2+ √−10 2 ) ￿ ￿￿ ￿ 1+√−5 ( √2 · √2 − √−10 2 ) ￿ ￿￿ ￿ 1−√−5 . Thus we see principalization provides an alternative viewpoint to the resolution of non-unique factorization in a ring of integers OK. Furthermore, we will see there are some advantages to using principalization (essentially Kummer’s approach) instead of ideal theory (Dedekind’s approach) by giving an application of principalization in the next section, even though these two approaches are more or less equivalent by Proposition 5.1.2. Now of course it is natural to ask when K has a principalization ﬁeld and how can we ﬁnd one. It turns out to be quite easy to answer. Proposition 5.1.4. Let I1,. .., Ih be ideals of OK which generate the class group. If ej is the order of Ij in ClK,then wecan write I ej j =(αj) for some αj ∈ OK.Then L = K( e1 √α1,. .., eh √αh) is a principalization ﬁeld for K. The proof is immediate. It is worthwhile to remark that even though passing to OL resolves non-unique factorization in OK (in the sense of Proposition 5.1.2, it is not necessarily the case that any element of OK has a unique irreducible factorization in OL. In particular, there are examples of number ﬁelds K,such that no ﬁnite extension L of K has class number 1. This was shown by Golod and Shafarevich in 1964 with the example of K = Q( √−3 · 5 · 7 · 11 · 13 · 17 · 19). One particular principalization ﬁeld is particularly noteworthy, and is important for studying primes of the form x2 + dy2. We say L/K is an abelian extension if it is Galois and Gal(L/K) is abelian. Further, L/K is unramiﬁed if every prime ideal p of OK is unramiﬁed in L. Deﬁnition 5.1.5. The Hilbert class ﬁeld HCF (K) is the maximal unramiﬁed abelian extension of K. An important component of class ﬁeld theory, which we hope to discuss in Part III, is the following result. 76 Theorem 5.1.6. H = HCF (K) is a well-deﬁned ﬁnite extension of K satisfying Gal(H/K)= ClK. Further H principalizes K. Example 5.1.7. Let K = Q.Then any nontrivial extension L of K must be ramiﬁed (since the |∆L| > 1 and any p|∆L ramiﬁes in L), hence there is only one unramifed extension of Q—namely Q itself. Thus HCF (Q)= Q. More generally if hK =1,theabovetheoremtells us HCF (K)= K. Example 5.1.8. Let K = Q( √−5).If L/K is unramiﬁed, then p|∆L implies p|∆K = −20.One might be tempted to guess the Hilbert class ﬁeld of K is L = Q( √−5, √2) from Example 5.1.3. Indeed L/K is abelian with Galois group ￿ C2 ￿ ClK, but it is not unramiﬁed. The Hilbert class ﬁeld of K is Q( √−5,i). Exercise 5.1. Check HCF (Q( √−5)) = Q( √−5,i) using the deﬁnition and the theorem above. One use of the Hilbert class ﬁeld can be seen in the following result ([Cox]). Theorem 5.1.9. Let d> 0 be squarefree and d ￿≡ 3 mod 4.Let K = Q( √−d), H = HCF (K),and p be an odd prime not dividing ∆ = −4d.Write H = K(α) and let f (x) be the minimum polynomial for α.Then the following are equivalent: (i) p is represented by x2 + dy2 (ii) p splits completely in H (iii) ￿∆ p ￿ =1 and f (x) has a root mod p. Exercise 5.2. Check the above theorem in the case of d =5. 5.2 Counting non-unique factorizations In this section, we will show how one can use quadratic forms to determine and count the irreducible factorizations of an integer in OK, where K is a quadratic ﬁeld with class number 2. (In fact, one can treat the case of ClK ￿ Cr 2 by the same approach.) For simplicity, we will just go through the speciﬁc case of K = Q( √−5). Afterwards, we will discuss what happens in an arbitrary number ﬁeld, where one must use ideal theory to obtain the analogous result. In particular, this gives a qualitative and quantitative way to see that the class group ClK really does measure the failure of unique factorization in OK in a precise way. Both these results and this approach using principalization seems to be new (in fact I proved it just to show you how the class group measures the failure of unique factorization in OK!), see [Martin] for more details. For an introduction to other work on irreducible factorizations (in diﬀerent directions), see [Narkiewicz]. Let K = Q( √−5) so ∆ = ∆K = −20. Denote by C1 the set of principal ideals in OK and C2 the set of nonprinicpal ideals of OK. The reduced forms of discriminant ∆ are Q1(x, y)= x2 +5y2 and Q2(x, y)=2x2 +2xy +3y2. Let P0 denote the primes p ∈ N which are not represented by Q1 or Q2 and Pi denote the primes p ∈ N which are represented by Qi for i =1, 2. Then P0 is the set of inert primes in K/Q, P1 is the set of primes p such that the ideal pOK factors into two principal ideals in OK,and P2 is the set of primes p such that pOK factors into two nonprincipal ideals of OK. 77 Set P ram i = {p ∈ Pi : p is ramiﬁed in K} , and P unr i = {p ∈ Pi : p is unramiﬁed in K} . Explicitly, we have P0 = {p : p ≡ 11, 13, 17, 19 mod 20}, P ram 1 = {5}, P unr 1 = {p : p ≡ 1, 9 mod 20}, P ram 2 = {2} and P unr 2 = {p : p ≡ 3, 7 mod 20}. If p ∈ P0 ∪ P1 then any prime ideal p of OK lying above p is in C1,and if q ∈ P2, then any prime ideal of OK lying above q is in C2. Speciﬁcally, if q =2 ∈ P ram 2 , then qOK = r2 where r is the prime ideal (2, 1+ √−5) of OK,and if q ∈ P unr 2 then q = qq where q and q are distinct prime ideals of OK. Here q denotes the conjugate ideal of q in K/Q. Now let n> 1 and write the prime ideal factorization of nOK as (n)= pd1 1 ·· · pdr r qe1 1 qe1 1 ·· · qes s qes s rf , where each pi ∈ C1, qj ∈ C2 with conjugate qj,and the pi’s, qj’s, qj’s and r are all distinct. Since each pi =(πi) for some irreducible πi of OK, any irreducible factorization of n must contain (up to units) πd1 1 ·· · πdr r . Thus it suﬃces to consider irreducible factorizations of n￿ = n/(πd1 1 ·· · πdr r ). Let qj be the prime in N such that qj lies above qj. Since qj is nonprincipal, we must have that qj ∈ P2, i.e., qj is represented by Q2. Note that we can factor the quadratic form into linear factors Q2(x, y)=( √2x + √2+ √−10 2 y)( √2x + √2 − √−10 2 y) (5.1) over the ﬁeld L = K( √2). Hence, while qj is irreducible over OK (otherwise the prime ideal factors of qjOK would be principal), the fact that qj = Q2(x, y) for some x, y gives us a factorization qj = αjαj in L where αj = √2x + √2+√−10 2 y and αj = √2x + √2−√−10 2 y. Since √2, √2±√−10 2 ∈ OL, we have αj ∈ OL (in fact irreducible). Since αj and αj are conjugate with respect to the nontrivial element of Gal(K/Q), the ideals (αj) ∩ OK and (αj) ∩ OK must be conjugate ideals of OK which divide qj, and hence in some order equal qj and qj. Thus, up to a possible switching αj and αj, we can write qjOL =(αj) and qjOL =(αj).Similarly rOL =( √2). This means the following. If n￿ = ￿ βi is any irreducible factorization of n￿ in OK,we have ￿ (βi)= (n￿)= rf qe1 1 qe1 1 ·· · qes s qes s =( √2) f s￿ j=1(αj) ej (αj) ej as ideals of OL. From Proposition 5.1.2, we know that each (βi) is a subproduct of the product of ideals on the right. In other words, to the irreducible factorizations of OK come from diﬀerent groupings of the factorization n￿ = √2f s￿ j=1 αej j αej j . (5.2) Thus to determine the factorizations of of n￿ in OK, it suﬃces to determine when a product of the αij is an irreducible element of OK. But this is simple! Note from the factorization of Q2(x, y) in (5.1), we see that each αij ∈ √2K. Hence the product of any two αi’s (or √2 · αj or √2 · √2) lies in K, and therefore OK, and must be irreducible since no individual αj ∈ OK. In other words, 78 the irreducible factorizations of n￿ in OK are precisely what we get from grouping the terms on the right of (5.2) in pairs. What we have proved is the following. If {ai} is a collection of distinct objects, denote the multiset containing each ai with cardinality mi by ￿ a (mi) i ￿ . Let ηK(n) denote the number of distinct (up to order and units) irreducible factorizations of n in OK. Proposition 5.2.1. With notation as above (K = Q( √−5),the irreducible factorizations of n in OK are, up to units, n = ￿ πi ￿ βk where each βk is a product of two numbers of the following types: √2, αj, or αj.In particular, ηK(n) is the number of ways we can arrange the multiset￿√2 (f ), α(ej ) j , α(ej ) j ￿ in pairs. The length of an irreducible factorization is the number of irreducibles occurring in the factor- iziation, with multiplicity. Corollary 5.2.2. Any two irreducible factorizations of n in OK have the same length. Hence the above result tells us about the structure of the irreducible factorizations in OK,not just their number. In fact, the above approach tells us how to explicitly obtain all irreducible factorizations of some n in OK. Example 5.2.3. Let n =2 · 72 · 29.Here 29 ∈ P1 and 2, 7 ∈ P2.We have 2= Q2(1, 0) = √2 · √2 7= Q2(1, 1) = ( √2+ √2+ √−10 2 ) ￿ ￿￿ ￿ α ( √2+ √2 − √−10 2 ) ￿ ￿￿ ￿ α 29 = Q1(3, 2) = 32 +5 · 22 =(3 + 2√−5) ￿ ￿￿ ￿ π (3 − 2 √−5) ￿ ￿￿ ￿ π using the factorization of Q1 and Q2 into linear forms over OL.Then the above tells us the ir- reducible factorizations of n in OK are precisely those obtained from grouping the terms in square brackets on the right in pairs in the following factorization in OL: n = ππ ￿√2 · √2 · α · α · α · α￿ . Precisely, we have ηK(n)=5 factorizations and they are explicitly given by n = ππ( √2√2)(αα)(αα) n = ππ( √2√2)(αα)(αα) n = ππ( √2α)( √2α)(αα) n = ππ( √2α)( √2α)(αα) n = ππ( √2α)( √2α)(αα). (Each product of two terms in OL in parentheses above is an irreducible element of OK.If you feel aneed, youcancomputetheseproductsexplicitly, andcheckthattheyarealldistinctfactorizations in OK.) 79 Exercise 5.3. Determine all irreducible factorizations of n = 60 in OK = Z[ √−5]. Exercise 5.4. Let p ∈ N be prime and e ≥ 1.Determine a formula for ηK(pe) where K = Q( √−5). (It will depend on the value of p mod 20 as well as e.) Exercise 5.5. Let q1,. .., qk be distinct primes in P unr 2 .Show ηK(q1 ·· · qk)= (2k − 1)!! = (2k − 1)(2k − 3)(2k − 5) ·· · 3 · 1.(Again K = Q( √−5).) We remark that there seems to be no simple algebraic formula for ηK(n) for general n, despite the fairly simple combinatorial description. However, there is a simple way to compute ηK(n) in terms of generating functions, a technique often used in combinatorics. We give it precisely in the following alternate version of the above proposition. Proposition 5.2.4. Let K = Q( √−5), L = K( √2) and n> 1.Write the prime ideal factorization of (n) in OK as (n)= ￿ pdi i ￿ qej j ,where each pi ∈ C1, qj ∈ C2 and the pi’s and qj’s are all distinct. Let πi ∈ OK and αj ∈ OL such that pi =(πi) and qjOL =(αj).Then the irreducible nonassociate factorizations of n are precisely n = u ￿ πdi i ￿ βk where u is a unit, each βk is a product of two (not necessarily distinct) αj’s and ￿ βk = ￿ αej j . In particular ηK(n) is the number of ways we can arrange the multiset ￿ α(ej ) j ￿ in pairs, i.e., the number of partitions of this multiset into sub-multisets of size 2.In other words, if the number of distinct qj’s is m,then ηK(n) is the coeﬃcient of ￿ x ej j in the formal power series expansion of ￿i≤j 1 1−xixj in Z[[x1,x2,. .., xm]]. In fact we stated this proposition for n ∈ OK, not just n ∈ Z, but it is no more diﬃcult to prove. Moreover, the description of ηK(n) in terms of coeﬃcients of a power series is essentially a tautology (use the geometric series expansion for 1 1−xixj and count). In general, one can prove an analogue of the above using (just) ideals, and the proof is just as simple as the case of K = Q( √−5) we did with quadratic forms. The advantage of the quadratic forms approach above however is one can explicitly write down the irreducible factorizations of a rational integer n in OK in terms of the explicit representations of p|n by quadratic forms of discriminant ∆K, provided ClK ￿ Cr 2 . See [Martin] for the details when r> 1. (The problem when ClK ￿ Cr 2 , which is tied to the one class per genus problem, is that if Q is a quadratic form which does not have order 2 in Cl(∆), then there is no number ﬁeld L such that Q factors into linear forms over OL. One can always factor Q into linear forms over some quadratic ﬁeld, since Q is just a quadratic polynomial, but the problem is that the coeﬃcients of these linear forms will only be algebraic integers when Q is ambiguous, hence of order 2 in Cl(∆).) In [Martin], we prove the following. Theorem 5.2.5. Let K be a number ﬁeld and ClK = {Ci}.Let n ∈ OK be a nonzero nonunit. Suppose the prime ideal factorization of nOK is (n)= ￿(i,j)∈T pij where the pij’s are (not necessarily distinct) prime ideals such that pij ∈ Ci,and T is some ﬁnite index set. Let Ki be a principalization ﬁeld for Ci,so pijOKi =(αij) for some αij ∈ OKi.Let L = ￿ Ki. Then the irreducible factorizations of n in OK are precisely the factorizations of the form n =￿ βl where ￿ βl ∼ ￿ αij in OL and each βl is of the form βl ∼ ￿(i,j)∈S αij in OL for S aminimal (nonempty) subset of T such that ￿(i,j)∈S Ci = I.(Here each βl is irreducible in OK.) In other words, all irreducible factorizations n in OK come from diﬀerent groupings of the factorization n ∼ ￿ αij in OL. Now a grouping of terms of this factorization in OL gives an 80 irreducible factorization in OK if and only if every group of terms gives an irreducible element of OK (possibly up to a unit in OL). A product of αij’s gives an element of OK if and only if the corresponding product of ideal classes Ci is trivial in ClK, and this element of OK will be irreducible if and only if no proper subproduct of the corresponding ideal classes is trivial. It should be clear that this theorem gives a precise way that the class group measures the failure of unique factorization in OK. In particular, the larger the class group, the more complicated the structure of the irreducible factorizations of an element can become. Corollary 5.2.6. Let K be a number ﬁeld and ClK = {Ci}.Let n ∈ OK be a nonzero nonunit. Suppose (n)= ￿(i,j)∈T peij ij ,where the pij’s are distinct prime ideals, each pij ∈ Cj and T is some index set. Let U be the multiset U = ￿(i, j)(eij ) :(i, j) ∈ T ￿.Then ηK(n) is the number of ways one can partition the multiset ￿ x eij ij ￿ into minimal subsets V such that ￿xij ∈V Ci = I. Exercise 5.6. Deduce the following result of Carlitz: Let K be a number ﬁeld. We say OK is half-factorial if every irreducible factorization of a given n ∈ OK has the same length. Then OK if half-factorial if and only if hK ≤ 2. In general, one deﬁnes the elasticity ρK of OK to be maxn∈OK ρK(n) where ρK(n) is the maximum ratio of lengths of two irreducible factorizations of n in OK. Similarly, one can use our theorem above to determine ρK in terms of the structure of the class group (it depends upon more than just hK). See [Narkiewicz] for complete statements (needless to say, proved there without recourse to our theorem). 81","libVersion":"0.3.1","langs":""}
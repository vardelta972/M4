{"path":"iCloudDrive/bks/Combinatorics/Combinatorics/Olympiad Combinatorics.pdf","text":"Olympiad Combinatorics Pranav A. Sriram August 2014 Chapter 1: Algorithms 1 Copyright notices All USAMO and USA Team Selection Test problems in this chapter are copyrighted by the Mathematical Association of America’s American Mathematics Competitions. © Pranav A. Sriram. This document is copyrighted by Pranav A. Sriram, and may not be reproduced in whole or part without express written consent from the author. About the Author Pranav Sriram graduated from high school at The International School Bangalore, India, and will be a Freshman at Stanford University this Fall. Chapter 1: Algorithms 1 1. ALGORITHMS Introduction Put simply, an algorithm is a procedure or set of rules designed to accomplish some task. Mathematical algorithms are indispensable tools, and assist in financial risk minimization, traffic flow optimization, flight scheduling, automatic facial recognition, Google search, and several other services that impact our daily lives. Often, an algorithm can give us a deeper understanding of mathematics itself. For instance, the famous Euclidean algorithm essentially lays the foundation for the field of number theory. In this chapter, we will focus on using algorithms to prove combinatorial results. We can often prove the existence of an object (say, a graph with certain properties or a family of sets satisfying certain conditions) by giving a procedure to explicitly construct it. These proofs are hence known as constructive proofs. Our main goals in this chapter will be to study techniques for designing algorithms for constructive proofs, and proving that they actually work. Olympiad Combinatorics 2 In this chapter, and throughout the book, the emphasis will be on ideas. What can we observe while solving a given problem? How can disparate ideas and observations be pieced together cohesively to motivate a solution? What can we learn from the solution of one problem, and how may we apply it to others in the future? Each problem in this book is intended to teach some lesson - this may be a combinatorial trick or a new way of looking at problems. We suggest that you keep a log of new ideas and insights into combinatorial structures and problems that you encounter or come up with yourself. Greedy Algorithms Be fearful when others are greedy and greedy when others are fearful - Warren Buffet Greedy algorithms are algorithms that make the best possible short term choices, hence in each step maximizing short term gain. They aren’t always the optimal algorithm in the long run, but often are still extremely useful. The idea of looking at extreme elements (that are biggest, smallest, best, or worst in some respect) is central to this approach. Example 1 In a graph G with n vertices, no vertex has degree greater than Δ. Show that one can color the vertices using at most Δ+1 colors, such that no two neighboring vertices are the same color. Answer: We use the following greedy algorithm: arrange the vertices in an arbitrary order. Let the colors be 1, 2, 3… Color the first vertex with color 1. Then in each stage, take the next vertex in the order and color it with the smallest color that has not yet been used on any of its neighbors. Clearly this algorithm ensures that two Chapter 1: Algorithms 3 adjacent vertices won’t be the same color. It also ensures that at most Δ+1 colors are used: each vertex has at most Δ neighbors, so when coloring a particular vertex v, at most Δ colors have been used by its neighbors, so at least one color in the set {1, 2, 3, …, Δ+1} has not been used. The minimum such color will be used for the vertex v. Hence all vertices are colored using colors in the set {1, 2, 3,…, Δ+1} and the problem is solved. ■ Remark: The “greedy” step here lies in always choosing the color with the smallest number. Intuitively, we’re saving larger numbers only for when we really need them. Example 2 [Russia 2005, Indian TST 2012, France 2006] In a 2 x n array we have positive reals such that the sum of the numbers in each of the n columns is 1. Show that we can select one number in each column such that the sum of the selected numbers in each row is at most (n+1)/4. 0.4 0.7 0.9 0.2 0.6 0.4 0.3 0.1 0.6 0.3 0.1 0.8 0.4 0.6 0.7 0.9 Figure 1.1: 2xn array of positive reals, n=8 Answer: A very trivial greedy algorithm would be to select the smaller number in each column. Unfortunately, this won’t always work, as can easily be seen from an instance in which all numbers in the top row are 0.4. So we need to be more clever. Let the numbers in the top row in non-decreasing order be a1, a2, …., an and the corresponding numbers in the bottom row be b1, b2, …., bn (in non- increasing order, since bi = 1 - ai). Further suppose that the sum of the numbers in the top row is less than or equal to that of the bottom row. The idea of ordering the variables is frequently used, since it provides some structure for us to work with. Our algorithm is as follows: Starting from a1, keep choosing the smallest remaining element in the top row as long as possible. In Olympiad Combinatorics 4 other words, select a1, a2, …, ak such that a1 + a2 + … + ak ≤ but a1 + a2 + … + ak + ak+1 > Now we cannot select any more from the top row (as we would then violate the problem’s condition) so in the remaining columns choose elements from the bottom row. We just need to prove that the sum of the chosen elements in the bottom row is at most Note that ak+1 is at least the average of a1, a2, …, ak, ak+1 which is more than Hence bk+1 = (1 - ak+1) < 1 - . But bk+1 is the largest of the chosen elements in the bottom row. So the sum of the chosen elements in the bottom row cannot exceed (1 - ) x (n-k). We leave it to the reader to check that this quantity cannot exceed (n+1)/4. ■ Remark: One of the perks of writing a book is that I can leave boring calculations to my readers. Example 3 In a graph G with V vertices and E edges, show that there exists an induced subgraph H with each vertex having degree at least E/V. (In other words, a graph with average degree d has an induced subgraph with minimum degree at least d/2). Answer: Note that the average degree of a vertex is 2E/V. Intuitively, we should get rid of ‘bad’ vertices: vertices that have degree < E/V. Thus a natural algorithm for finding such a subgraph is as follows: start with the graph G, and as long as there exists a vertex with degree < E/V, delete it. However, remember that while deleting a vertex we are also deleting the edges incident to it, and in the process vertices that were initially not ‘bad’ may become bad in the subgraph formed. What if we end up with a graph with all vertices bad? Fortunately, this won’t happen: notice that the ratio Chapter 1: Algorithms 5 of edges/vertices is strictly increasing (it started at E/V and each time we deleted a vertex, less than E/V edges were deleted by the condition of our algorithm). Hence, it is impossible to reach a stage when only 1 vertex is remaining, since in this case the edges/vertices ratio is 0. So at some point, our algorithm must terminate, leaving us with a graph with more than one vertex, all of whose vertices have degree at least E/V. ■ Remark: This proof used the idea of monovariants, which we will explore further in the next section. The next problem initially appears to have nothing to do with algorithms, but visualizing what it actually means allows us to think about it algorithmically. The heuristics we develop lead us to a very simple algorithm, and proving that it works isn’t hard either. Example 4 [IMO shortlist 2001, C4] A set of three nonnegative integers {x, y, z} with x < y < z satisfying {z-y, y-x} = {1776, 2001} is called a historic set. Show that the set of all nonnegative integers can be written as a disjoint union of historic sets. Remark: The problem is still true if we replace {1776, 2001} with an arbitrary pair of distinct positive integers {a, b}. These numbers were chosen since IMO 2001 took place in USA, which won independence in the year 1776. Answer: Let 1776 = a, 2001 =b. A historic set is of the form {x, x+a, x+a+b} or {x, x+b, x+a+b}. Call these small sets and big sets respectively. Essentially, we want to cover the set of nonnegative integers using historic sets. To construct such a covering, we visualize the problem as follows: let the set of nonnegative integers be written in a line. In each move, we choose a historic set and cover these numbers on the line. Every number must be covered at the end of our infinite process, but no number can be covered twice (the Olympiad Combinatorics 6 historic sets must be disjoint). We have the following heuristics, or intuitive guidelines our algorithm should follow: Heuristic 1: At any point, the smallest number not yet covered is the most “unsafe”- it may get trapped if we do not cover it (for example, if x is the smallest number not yet covered but x+a+b has been covered, we can never delete x). Thus in each move we should choose x as the smallest uncovered number. Heuristic 2: From heuristic 1, it follows that our algorithm should prefer small numbers to big numbers. Thus it should prefer small sets to big sets. Based on these two simple heuristics, we construct the following greedy algorithm that minimizes short run risk: in any move, choose x to be the smallest number not yet covered. Use the small set if possible; only otherwise use the big set. We now show that this simple algorithm indeed works: Suppose the algorithm fails (that is, we are stuck because using either the small or big set would cover a number that has already been covered) in the (n+1)th step. Let xi be the value chosen for x in step i. Before the (n+1)th step, xn+1 hasn’t yet been covered, by the way it is defined. xn+1 + a + b hasn’t yet been covered since it is larger than all the covered elements (xn+1 > xi by our algorithm). So the problem must arise due to xn+1 + a and xn+1 + b. Both of these numbers must already be covered. Further, xn+1 + b must have been the largest number in its set. Thus the smallest number in this set would be xn+1 + b – (a+b) = xn+1 – a. But at this stage, xn+1 was not yet covered, so the small set should have been used and xn+1 should have been covered in that step. This is a contradiction. Thus our supposition is wrong and the algorithm indeed works. ■ Remark: In an official solution to this problem, the heuristics would be skipped. Reading such a solution would leave you thinking “Well that’s nice and everything, but how on earth would anyone come up with that?” One of the purposes of this book is to Chapter 1: Algorithms 7 show that Olympiad solutions don’t just “come out of nowhere”. By including heuristics and observations in our solutions, we hope that readers will see the motivation and the key ideas behind them. Invariants and Monovariants Now we move on to two more extremely important concepts: invariants and monovariants. Recall that a monovariant is a quantity that changes monotonically (either it is non-increasing or non-decreasing), and an invariant is a quantity that doesn’t change. These concepts are especially useful when studying combinatorial processes. While constructing algorithms, they help us in several ways. Monovariants often help us answer the question “Well, what do we do now?” In the next few examples, invariants and monovariants play a crucial role in both constructing the algorithm and ensuring that it works. Example 5 [IMO shortlist 1989] A natural number is written in each square of an m x n chessboard. The allowed move is to add an integer k to each of two adjacent numbers in such a way that nonnegative numbers are obtained (two squares are adjacent if they share a common side). Find a necessary and sufficient condition for it to be possible for all the numbers to be zero after finitely many operations. Answer: Note that in each move, we are adding the same number to 2 squares, one of which is white and one of which is black (if the chessboard is colored alternately black and white). If Sb and Sw denote the sum of numbers on black and white squares respectively, then Sb – Sw is an invariant. Thus if all numbers are 0 at the end, Sb – Sw = 0 at the end and hence Sb – Sw = 0 in the Olympiad Combinatorics 8 beginning as well. This condition is thus necessary; now we prove that it is sufficient. 8 7 6 4 8 7 2 0 7 3 2 1 → 7 3 2 1 5 2 5 6 5 2 5 6 Figure 1.2: A move on the mxn board Suppose a, b, c are numbers in cells A, B, C respectively, where A, B, C are cells such that A and C are both adjacent to B. If a ≤ b, we can add (-a) to both a and b, making a 0. If a ≥ b, then add (a-b) to b and c. Then b becomes a, and now we can add (-a) to both of them, making them 0. Thus we have an algorithm for reducing a positive integer to 0. Apply this in each row, making all but the last 2 entries 0. Now all columns have only zeroes except the last two. Now apply the algorithm starting from the top of these columns, until only two adjacent nonzero numbers remain. These last two numbers must be equal since Sb = Sw . Thus we can reduce them to 0 as well. ■ The solution to the next example looks long and complicated, but it is actually quite intuitive and natural. We have tried to motivate each step, and show that each idea follows quite naturally from the previous ones. Example 6 [New Zealand IMO Training, 2011] There are 2n people seated around a circular table, and m cookies are distributed among them. The cookies can be passed under the following rules: (a) Each person can only pass cookies to his or her neighbors (b) Each time someone passes a cookie, he or she must also eat a cookie Let A be one of these people. Find the least m such that no matter how m cookies are distributed initially, there is a strategy to pass cookies so that A receives at least one cookie. Chapter 1: Algorithms 9 Answer: We begin by labeling the people A–n+1, A–n+2, …., A0, A1, A2, …, An, such that A = A0. Also denote A-n = An. We assign weight 1/2|i| to each cookie held by person Ai. Thus for example, if A3 passes a cookie to A2, that cookie’s weight increases from 1/8 to 1/4. Note that A3 must also eat a cookie (of weight 1/8) in this step. Thus we see in this case the sum of the weights of all the cookies has remained the same. More precisely, if Ai has ai cookies for each i, then the total weight of all cookies is W =∑ Whenever a cookie is passed towards A0 (from A±i to A±(i-1) for i positive) one cookie is eaten and another cookie doubles its weight, so the total weight remains invariant. If a cookie is passed away from A, then the total weight decreases. Thus the total weight is indeed a monovariant. Figure 1.3: Labeling scheme to create a monovariant (n=5) A 0 A 1 A 2 A 3 A 4 A 5 A 6 A -5 A -4 A -3 A -2 A -1 Olympiad Combinatorics 10 If m < 2n , then if all the cookies are initially given to An, the initial total weight is m/2n < 1. Therefore the total weight is always less than 1 (since it can never increase), so A0 cannot receive a cookie (if A0 received a cookie it would have weight 1). Thus we must have m ≥ 2 n. We now show that for m ≥ 2n , we can always ensure that A0 gets a cookie. Intuitively, we have the following heuristic: Our algorithm should never pass away from A0, otherwise we will decrease our monovariant. Thus in each step we should pass towards A0. This heuristic, however, does not tell us which way An should pass a cookie, as both directions are towards A0 (An and A0 are diametrically opposite). This leads us to consider a new quantity in order to distinguish between the two directions that An can pass to. Let W+ be the sum of the weights of cookies held by A0, A1, A2, …., An and let W- be the sum of the weights of cookies held by A0, A-1, A-2, …., A-n. Assume WLOG W+ ≥ W-. Then this suggests that we should make An pass cookies only to An-1 and that we should only work in the semicircle containing nonnegative indices, since this is the semicircle having more weight. Thus our algorithm is to make An pass as many cookies as possible to An-1, then make An-1 pass as many cookies as possible to An-2, and so on until A0 gets a cookie. But this works if and only if W+ ≥ 1: W+ ≥ 1 is certainly necessary since W+ is a monovariant under our algorithm, and we now show it is sufficient. Suppose W+ ≥ 1. Note that our algorithm leaves W+ invariant. Suppose our algorithm terminates, that is, we cannot pass anymore cookies from any of the Ai’s with i positive, and A0 doesn’t have any cookies. Then A1, A2, …., An all have at most 1 cookie at the end (if they had more than one, they could eat one and pass one and our algorithm wouldn’t have terminated). Then Chapter 1: Algorithms 11 at this point W+ ≤ ½ + ¼ + ….. + 1/2n < 1, contradicting the fact that W+ is invariant and ≥ 1. Thus W+ ≥ 1 is a sufficient condition for our algorithm to work. Finally, we prove that we indeed have W+ ≥ 1. We assumed W+ ≥ W-. Now simply note that each cookie contributes at least 1/2n-1 to the sum (W+ + W-), because each cookie has weight at least 1/2n-1 except for cookies at An. However, cookies at An are counted twice since they contribute to both W+ and W-, so they also contribute 1/2 n-1 to the sum. Hence, since we have at least 2n cookies, W+ + W- ≥ 2, so W+ ≥ 1 and we are done. ■ The next example demonstrates three very useful ideas: monovariants, binary representation and the Euclidean algorithm. All of these are very helpful tools. Example 7 [IMO shortlist 1994, C3] Peter has 3 accounts in a bank, each with an integral number of dollars. He is only allowed to transfer money from one account to another so that the amount of money in the latter is doubled. Prove that Peter can always transfer all his money into two accounts. Can he always transfer all his money into one account? Answer: The second part of the question is trivial - if the total number of dollars is odd, it is clearly not always possible to get all the money into one account. Now we solve the first part. Let A, B, C with A ≤ B ≤ C be the number of dollars in the account 1, account 2 and account 3 respectively at a particular point of time. If A = 0 initially, we are done so assume A > 0. As we perform any algorithm, the values of A, B and C keep changing. Our aim is to monotonically strictly decrease the value of min (A, B, C). This will ensure that we eventually end up with min (A, B, C) = 0 and we will be done. Now, we know a very simple and useful algorithm that monotonically reduces a number- the Euclidean algorithm. So let B = qA + r with 0 r < A. Our aim now is to reduce the number Olympiad Combinatorics 12 of dollars in the second account from B to r. Since r < A, we would have reduced min (A, B, C), which was our aim. Now, since the question involves doubling certain numbers, it is a good idea to consider binary representations of numbers. Let q = m0 + 2m1 + …. + 2kmk be the binary representation of q, where mi = 0 or 1. To reduce B to r, in step i of our algorithm, we transfer money to account 1. The transfer is from account 2 if mi-1 = 1 and from account 3 if mi-1 = 0. The number of dollars in the first account starts with A and keeps doubling in each step. Thus we end up transferring A(m0 + 2m1 + …. + 2kmk) = Aq dollars from account 2 to account 1, and we are left with B – Aq = r dollars in account 2. We have thus succeeded in reducing min (A, B, C) and so we are done. ■ Now we look at a very challenging problem that can be solved using monovariants. Example 8 [APMO 1997, Problem 5] n people are seated in a circle. A total of nk coins have been distributed among them, but not necessarily equally. A move is the transfer of a single coin between two adjacent people. Find an algorithm for making the minimum possible number of moves which result in everyone ending up with the same number of coins. Answer: We want each person to end up with k coins. Let the people be labeled from 1, 2, …, n in order (note that n is next to 1 since they are sitting in a circle). Suppose person i has ci coins. We introduce the variable di = ci – k, since this indicates how close a person is to having the desired number of coins. Consider the quantity X = |d1| + |d1 + d2| + |d1 + d2 + d3| + … + |d1 + d2 + … + dn-1| Clearly X = 0 if and only if everyone has k coins, so our goal is to Chapter 1: Algorithms 13 make X = 0. The reason for this choice of X is that moving a coin between person j and person j + 1 for 1 ≤ j ≤ n -1 changes X by exactly 1 as only the term |d1 + d2 + … + dj| will be affected. Hence X is a monovariant and is fairly easy to control (except when moving a coin from 1 to n or vice versa). Let sj = d1 + d2 + … + dj. We claim that as long as X > 0 it is always possible to reduce X by 1 by a move between j and j +1 for some 1 ≤ j ≤ n -1. We use the following algorithm. Assume WLOG d1 ≥ 1. Take the first j such that dj+1 < 0. If sj > 0, then simply make a transfer from j to j + 1. This reduces X by one since it reduces the term |sj| by one. The other possibility is sj = 0, which means d1 = d2 = … = dj = 0 (recall that dj+1 is the first negative term). In this case, take the first m > i+1 such that dm ≥ 0. Then dm-1 < 0 by the assumption on m, so we move a coin from m to (m-1). Note that all terms before dm were either 0 or less than 0 and dm-1 < 0 , so sm-1 was less than 0. Our move has increased sm-1 by one, and has hence decreased |sm-1| by one, so we have decreased X by one. Thus at any stage we can always decrease X by at least one by moving between j and j +1 for some 1 ≤ j ≤ n -1. We have not yet considered the effect of a move between 1 and n. Thus our full algorithm is as follows: At any point of time, if we can decrease X by moving a coin from 1 to n or n to 1, do this. Otherwise, decrease X by 1 by the algorithm described in the above paragraph. ■ Sometimes while creating algorithms that monotonically decrease (or increase) a quantity, we run into trouble in particular cases and our algorithm doesn’t work. We can often get around these difficulties as follows. Suppose we want to monotonically decrease a particular quantity. Call a position good if we can decrease the monovariant with our algorithm. Otherwise, call the position bad. Now create an algorithm that converts bad positions into good positions, without increasing our monovariant. We use the first algorithm when possible, and then if we are stuck in a bad position, use the second algorithm to get back to a good position. Then we can again use the first algorithm. The next example Olympiad Combinatorics 14 (which is quite hard) demonstrates this idea. Example 9 [USAMO 2003-6] At the vertices of a regular hexagon are written 6 nonnegative integers whose sum is 2003. Bert is allowed to make moves of the following form: he may pick a vertex and replace the number written there by the absolute value of the difference between the numbers at the neighboring vertices. Prove that Bert can make a sequence of moves, after which the number 0 appears at all 6 vertices. Remark: We advise the reader to follow this solution with a paper and pen, and fill in the details that have been left for the reader. We first suggest that the reader try some small cases (with 2003 replaced by smaller numbers). Answer: Our algorithm uses the fact that 2003 is odd. Let the sum of a position be the sum of the 6 numbers and the maximum denote the value of the maximum of the 6 numbers. Let A, B, C, D, E, F be the numbers at the 6 vertices in that order. Our aim is to monotonically decrease the maximum. Note that the maximum can never increase. We need two sub-algorithms: (i) “Good position” creation: from a position with odd sum, go to a position with exactly one odd number (ii) Monovariant reduction: from a position with exactly one odd number, go to a position with odd sum and strictly smaller maximum, or go to the all 0 position. For (i), since (A + B + C + D + E + F) is odd, assume WLOG that A + C + E is odd. If exactly one of A, C, E is odd, suppose A is odd. Then make the following sequence of moves: B, F, D A, F (here we denote a move by the vertex at which the move is made). This way, we end up with a situation in which only B is odd and the Chapter 1: Algorithms 15 rest become even (check this), and we are done with step (i). The other possibility is that all of A, C and E are odd. In this case make the sequence of moves (B, D, F, C, E). After this only A is odd (check this). Now we are ready to apply step (ii), the step that actually decreases our monovariant. At this point, only one vertex contains an odd number; call this vertex A. Again we take two cases. If the maximum is even, then it is one of B, C, D, E or F. Now make moves at B, C, D, E and F in this order. (The reader should check that this works, that is, this sequence of moves decreases the maximum and ensures that the sum is odd). If the maximum is odd, then it is A. If C = E = 0, then the sequence of moves (B, F, D, A, B, F) leaves us with all numbers 0 and we are done. Otherwise, suppose at least one of C and E is nonzero so suppose C > 0 (the case E > 0 is similar). In this case, make the moves (B, F, A, F). The reader can check that this decreases the maximum and leaves us with odd sum. Thus starting with odd sum, we apply (i) if needed, after which we apply (ii). This decreases the maximum, and also leaves us again with odd sum (or in some cases it leaves us with all 0s and we are done), so we can repeat the entire procedure until the maximum eventually becomes 0. ■ Miscellaneous Examples Now we look at a few more problems involving moves that don’t directly use monovariants or greedy algorithms. These problems can often be solved by algorithms that build up the required configuration in steps. Sometimes, the required algorithm becomes easier to find after making some crucial observations or proving an auxiliary lemma. But in lots of cases, all a combinatorics problem needs is patience and straightforward Olympiad Combinatorics 16 logic, as the next example shows. Here again the solution looks long but most of what is written is just intended to motivate the solution. Example 10 [China 2010, Problem 5] There are some (finite number of) cards placed at the points A1, A2, …, An and O, where n ≥ 3. We can perform one of the following operations in each step: (1) If there are more than 2 cards at some point Ai, we can remove 3 cards from this point and place one each at Ai-1, Ai+1 and O (here A0 = An and An+1 = A1) (2) If there are at least n cards at O, we can remove n cards from O and place one each at A1, A2, …, An. Show that if the total number of cards is at least n2+3n+1, we can make the number of cards at each vertex at least n + 1 after finitely many steps. Answer: Note that the total number of cards stays the same. We make a few observations: (a) We should aim to make the number of cards at each Ai equal or close to equal, since if in the end some point has lots of cards, some other point won’t have enough. (b) We can make each of the Ai’s have 0, 1 or 2 cards. Proof: repeatedly apply operation (1) as long as there is a point with at least 3 cards. This process must terminate, since the number of coins in O increases in each step but cannot increase indefinitely. This is a good idea since the Ai’s would now have a ‘close to equal’ number of coins, which is a good thing by observation a). (c) From observation b), we see that it is also possible to make Chapter 1: Algorithms 17 each of the Ai‘s have 1, 2, or 3 cards (from the stage where each vertex has 0, 1 or 2 cards, just apply operation (2) once). This still preserves the ‘close to equal’ property, but gives us some more flexibility since we are now able to apply operation 1. (d) Based on observation c), we make each of the Ai’s have 1, 2 or 3 cards. Suppose x of the Ai’s have 1 card, y of the Ai’s have 2 cards and z of the Ai’s have 3 cards. The number of cards at O is then at least (n 2+3n+1) - (x +2y + 3z). Since x + y + z = n, (x + 2y + 3z) = (2x + 2y + 2z) + z – x = 2n + z – x ≤ 2n if x ≥ z. Thus if x ≥ z, O will have at least (n 2 +3n+1) – 2n = n 2 +n + 1 cards. Now we can apply operation (2) n times. Then all the Ai’s will now have at least n + 1 cards (they already each had at least 1 card), and O will have at least n 2 + n + 1 – n 2 = n + 1 cards and we will be done. Thus, based on observation d), it suffices to find an algorithm that starts with a position in which each of the Ai’s have 1, 2, or 3 cards and ends in a position in which each of the Ai’s have 1, 2, or 3 cards but the number of points having 3 cards is not more than the number of points having 1 card. This is not very difficult- the basic idea is to ensure that between any two points having 3 cards, there is a point containing 1 card. We can do this as follows: If there are consecutive 3’s in a chain, like (x, 3, 3, ….., 3, y) with (x, y ≠3), apply operation (1) on all the points with 3 cards to get (x + 1, 1, 2, 2, ……, 2, 1, y+1). Thus we can ensure that there are no adjacent 3’s. Now suppose there are two 3’s with only 2’s between them, like (x, 3, 2, 2, 2,…,2, 3, y) with x, y ≠3. After doing operation (1) first on the first 3, then on the point adjacent to it that has become a 3 and so on until the point before y, we get the sequence (x+1, 1, 1,…,1, y+1). Thus we can repeat this procedure as long as there exist two 3’s that do not have a 1 between them. Note that the procedure Olympiad Combinatorics 18 preserves the property that all Ai’s have 1, 2 or 3 cards. But this cannot go on indefinitely since the number of coins at O is increasing. So eventually we end up with a situation where there is at least one 1 between any two 3’s, and we are done. ■ Example 11 [IMO 2010, Problem 5] Six boxes B1, B2, B3, B4, B5, B6 of coins are placed in a row. Each box initially contains exactly one coin. There are two types of allowed moves: Move 1: If Bk with 1 ≤ k ≤5 contains at least one coin, you may remove one coin from Bk and add two coins to Bk+1. Move 2: If Bk with 1 ≤ k ≤ 4 contains at least one coin, you may remove one coin from Bk and exchange the contents (possibly empty) of boxes Bk+1 and Bk+2. Determine if there exists a finite sequence of moves of the allowed types, such that the five boxes B1, B2, B3, B4, B5 become empty, while box B6 contains exactly 201020102010 coins. Note: abc = a(bc) Answer: Surprisingly, the answer is yes. Let A = 201020102010. We denote by (a1, a2, …, an)  (a1’, a2’, …, an’) the following: if some consecutive boxes have a1, a2, …, an coins respectively, we can make them have a1’, a2’, …, an’ coins by a legal sequence of moves, with all other boxes unchanged. Observations: a) Suppose we reach a stage where all boxes are empty, except for B4, which contains at least A/4 coins. Then we can apply move 2 if necessary until B4 contains exactly A/4 coins, and then apply move 1 twice and we will be done. Thus reaching this stage will be our key goal. Chapter 1: Algorithms 19 b) Move 1 is our only way of increasing the number of coins. Since it involves doubling, we should look for ways of generating powers of 2. In fact, since A is so large, we should try to generate towers of 2’s (numbers of the form 222 ). Based on this, we construct two sub algorithms. Algorithm 1: (a, 0, 0)  (0, 2 a, 0) for any positive integer a. Proof: First use move 1: (a, 0, 0)  (a–1, 2, 0). Now use move 1 on the middle box till it is empty: (a–1, 2, 0)  (a–1, 0, 4) Use move 2 on the first box to get (a-2, 4, 0). Repeating this procedure (that is, alternately use move one on the second box till it is empty, followed by move one on the first box and so on), we eventually get (0, 2a, 0). Now, using this algorithm, we can construct an even more powerful algorithm that generates a large number of coins. Algorithm 2: Let Pn be a tower of n 2’s for each positive integer n (eg. P3 = 222 = 16). Then (a, 0, 0, 0)  (0, Pa, 0, 0). Proof: We use algorithm 1. As in algorithm 1, the construction is stepwise. It is convenient to explain it using induction. We prove that (a, 0, 0, 0)  (a-k, Pk, 0, 0) for each 1 ≤ k ≤ a. For k = 1, simply apply move 1 to the first box. Suppose we have reached the stage (a-k, Pk, 0, 0). We want to reach (a- (k+1), Pk+1, 0, 0). To do this, apply algorithm 1 to get (a-k, 0, 2 Pk, 0). Note that 2Pk = Pk+1. So now just apply move 2 to the first box and we get (a- k-1, Pk+1, 0, 0). Thus by induction, we finally reach (for k = a) (0, Pa, 0, 0). With algorithm 2 and observation a), we are ready to solve the problem. Olympiad Combinatorics 20 First apply move 1 to box 5, then move 2 to box 4, 3, 2 and 1 in this order: (1, 1, 1, 1, 1, 1)  (1, 1, 1, 1, 0, 3)  (1, 1, 1, 0, 3, 0)  (1, 1, 0, 3, 0, 0) (1, 0, 3, 0, 0, 0)  (0, 3, 0, 0, 0, 0). Now we use algorithm 2 twice: (0, 3, 0, 0, 0, 0)  (0, 0, P3, 0, 0, 0)  (0, 0, 0, P16, 0, 0). Now we leave it to the reader to check that P16 > A/4 (in fact P16 is much larger than A). By observation a), we are done. Remark: In the contest, several contestants thought the answer was no, and spent most of their time trying to prove that no such sequence exists. Make sure that you don’t ever jump to conclusions like that too quickly. On a lighter note, in a conference of the team leaders and deputy leaders after the contest, one deputy leader remarked “Even most of us thought that no such sequence existed”. To this, one leader replied, “That’s why you are deputy leaders and not team leaders!” We close this chapter with one of the hardest questions ever asked at the IMO. Only 2 out of over 500 contestants completely solved problem 3 in IMO 2007. Yup, that’s right- 2 high school students in the entire world. Example 12 [IMO 2007, Problem 3] In a mathematical competition some competitors are friends; friendship is always mutual. Call a group of competitors a clique if each two of them are friends. The number of members in a clique is called its size. It is known that the size of the largest clique(s) is even. Prove that the competitors can be arranged in two rooms such that the size of the largest cliques in one room is the same as the size of the largest cliques in the other room. Answer: Let M be one of the cliques of largest size, |M| = 2m. First send all members of M to Room A and all other people to Room B. Let c(A) Chapter 1: Algorithms 21 and c(B) denote the sizes of the largest cliques in rooms A and B at a given point in time. Since M is a clique of the largest size, we initially have c(A) =|M|≥ c(B). Now we want to “balance things out”. As long as c(A) > c(B), send one person from Room A to Room B. In each step, c(A) decreases by one and c(B) increases by at most one. So at the end we have c(A)≤ c(B) ≤ c(A) + 1. We also have c(A) = |A| ≥ m at the end. Otherwise we would have at least m+1 members of M in Room B and at most m−1 in Room A, implying c(B)−c(A) ≥ (m+1)−(m−1) = 2. Clearly if c(A) = c(B) we are done so at this stage the only case we need to consider is c(B) - c(A) = 1. Let c(A) = k, c(B) = k+1. Now if there is a competitor in B, who is also in M but is not in the biggest clique in B, then by sending her to A, c(B) doesn’t change but c(A) increases by 1 and we are done. Now suppose there is no such competitor. We do the following: take each clique of size k+1 in B and send one competitor to A. At the end of this process, c(B) = k. Now we leave it to the reader to finish the proof by showing that c(A) is still k. (You will need to use the supposition that there is no competitor in B who is also in M but not in the biggest clique of B. This means that every clique in B of size (k+1) contains B∩M). ■ Exercises 1. [Activity Selection Problem] On a particular day, there are n events (say, movies, classes, parties, etc.) you want to attend. Call the events E1, E2, …, En and let Ei start at time si and finish at time fi. You are only allowed to attend events that do not overlap (that is, one should finish before the other starts). Provide an efficient algorithm that selects as many events as possible while Olympiad Combinatorics 22 satisfying this condition. (Note: We have not defined what “efficient” here means. Note that this problem can be solved by simply testing all 2n possible combinations of events, and taking the best combination that works. However, this uses a number of steps that is exponential in n. By efficient, we mean a procedure that is guaranteed to require at most a number of steps that is polynomial in n). 2. [Weighted Activity Selection] Solve the following generalization of the previous problem: event Ei has now weight wi and the objective is not to maximize the number of activities attended, but the sum of the weights of all activities attended. 3. [Russia 1961] Real numbers are written in an m × n table. It is permissible to reverse the signs of all the numbers in any row or column. Prove that after a number of these operations, we can make the sum of the numbers along each line (row or column) nonnegative. 4. Given 2n points in the plane with no three collinear, show that it is possible to pair them up in such a way that the n line segments joining paired points do not intersect. 5. [Czech and Slovak Republics 1997] Each side and diagonal of a regular n-gon (n ≥ 3) is colored blue or green. A move consists of choosing a vertex and switching the color of each segment incident to that vertex (from blue to green or vice versa). Prove that regardless of the initial coloring, it is possible to make the number of blue segments incident to each vertex even by following a sequence of moves. Also show that the final configuration obtained is uniquely determined by the initial coloring. Chapter 1: Algorithms 23 6. [Bulgaria 2001] Given a permutation of the numbers 1, 2, …, n, one may interchange two consecutive blocks to obtain a new permutation. For instance, 3 5 4 8 9 7 2 1 6 can be transformed to 3 9 7 2 5 4 8 1 6 by swapping the consecutive blocks 5 4 8 and 9 7 2. Find the least number of changes required to change n, n-1, n-2, …, 1 to 1, 2, …, n. 7. [Minimum makespan scheduling] Given the times taken to complete n jobs, t1, t2, …, tn, and m identical machines, the task is to assign each job to a machine so that the total time taken to finish all jobs is minimized. For example, if n = 5, m = 3 and the times are 5, 4, 4, 6 and 7 hours, the best we can do is make machine 1 do jobs taking 4 and 5 hours, machine 2 do jobs taking 4 and 6 hours, and machine 3 do the job taking 7 hours. The total time will then be 10 hours since machine 2 takes (4 + 6) hours. Consider the following greedy algorithm: Order the jobs arbitrarily, and in this order assign to each job the machine that has been given the least work so far. Let TOPT be the total time taken by the best possible schedule, and TA the time taken by our algorithm. Show that TA/TOPT ≤ 2; in other words, our algorithm always finds a schedule that takes at most twice the time taken by an optimal schedule. (This is known as a 2- factor approximation algorithm.) 8. [USAMO 2011-2] An integer is written at each vertex of a regular pentagon. A solitaire game is played as follows: a turn consists of choosing an integer m and two adjacent vertices of the pentagon, and subtracting m from the numbers at these vertices and adding 2m to the vertex opposite them. (Note that m and the vertices chosen can change from turn to turn). The game is said to be won at a vertex when the number 2011 is written at it and the Olympiad Combinatorics 24 other four vertices have the number 0 written at them. Show that there is exactly one vertex at which the game can be won. 9. [Chvatal’s set covering algorithm] Let S1, S2, …, Sk be subsets of {1, 2, …, n}. With each set Si is an associated cost ci. Given this information, the minimum set cover problem asks us to select certain sets among S1, …, Sk such that the union of the selected sets is {1, 2, …, n} (that is, each element is covered by some chosen set) and the total cost of the selected sets is minimized. For example, if n = 4, k = 3, S1 = {1, 2}; S2 = {2, 3, 4} and S3 = {1, 3, 4} and the costs of S1, S2 and S3 are 5, 6 and 4 respectively, the best solution would be to select S1 and S3. Consider the following greedy algorithm for set cover: In each stage of the algorithm, we select the subset Si which maximizes the value of ⋂ , where C’ denotes the set of elements not yet covered at that point. Intuitively, this algorithm maximizes (additional benefit)/cost in each step. This algorithm does not produce an optimal result, but it gets fairly close: let CA be the cost of the selected sets produced by the algorithm, and let COPT be the cost of the best possible selection of sets (the lowest cost). Prove that CA/COPT ≤ Hn, where Hn = 1 + ½ + … + 1/n. (In other words, this is an Hn- factor approximation algorithm.) 10. A matroid is an ordered pair (S, F) satisfying the following conditions: (i) S is a finite set (ii) F is a nonempty family of subsets of S, such that if A is a set in F, all subsets of A are also in F. The members of F are called independent sets (iii) If A and B belong to F but |A| > |B|, then there exists an element x B\\A such that A U {x} F. Chapter 1: Algorithms 25 For example, if S = {1, 2, 3, 4} and F = { , {1}, {2}, {3}, {4}, {1, 2}, {1, 3}, {1, 4}, {2, 3}, {2, 4}, {3,4}}, then you can easily verify that the above properties are satisfied. In general, note that if F contains all subsets of S with k or fewer elements for some k ≤ |S|, {S, F} will be a matroid. An independent set A is said to be maximal if there does not exist any element x in S such that A U {x} F. (In other words, adding any element to A destroys its independence.) Prove that all maximal independent sets have the same cardinality. 11. Consider a matroid {S, F} where S = {a1, …, an}. Let element ai have weight wi, and define the weight of a set A to be the sum of the weights of its elements. A problem central to the theory of greedy algorithms is to find an independent set in this matroid of maximum weight. Consider the following greedy approach: starting from the null set, in each stage of the algorithm add an element (that has not been selected so far) with the highest weight possible while preserving the independence of the set of selected elements. When no more elements can be added, stop. Show that this greedy algorithm indeed produces a maximum weight independent set. 12. [IMO Shortlist 2013, C3] A crazy physicist discovered a new kind of particle which he called an imon. Some pairs of imons in the lab can be entangled, and each imon can participate in many entanglement relations. The physicist has found a way to perform the following two kinds of operations with these particles, one operation at a time. (i) If some imon is entangled with an odd number of other imons in the lab, then the physicist can destroy it. (ii) At any moment, he may double the whole family of imons in the lab by creating a copy I’ of each imon I. During this procedure, the two copies I’ and J’ become entangled if and Olympiad Combinatorics 26 only if the original imons I and J are entangled, and each copy I’ becomes entangled with its original imon I; no other entanglements occur or disappear at this moment. Show that after a finite number of operations, he can ensure that no pair of particles is entangled. 13. [Japan 1998] Let n be a positive integer. At each of 2n points around a circle we place a disk with one white side and one black side. We may perform the following move: select a black disk, and flip over its two neighbors. Find all initial configurations from which some sequence of such moves leads to a position where all disks but one are white. 14. [Based on IOI 2007] You are given n integers a1, a2, …, an and another set of n integers b1, b2, …, bn such that for each i, bi ≤ ai. For each i = 1, 2, …, n, you must choose a set of bi distinct integers from the set {1, 2, …, ai}. In total, (b1 + b2 +…+ bn) integers are selected, but not all of these are distinct. Suppose k distinct integers have been selected, with multiplicities c1, c2, c3, …, ck. Your score is defined as ∑ . Give an efficient algorithm to select numbers in order to minimize your score. 15. [Based on Asia Pacific Informatics Olympiad 2007] Given a set of n distinct positive real numbers S = {a1, a2, …, an} and an integer k < n/2, provide an efficient algorithm to form k pairs of numbers (b1, c1), (b2, c2), …, (bk, ck) such that these 2k numbers are all distinct and from S, and such that the sum ∑ is minimized. Hint: A natural greedy algorithm is to form pairs sequentially by choosing the closest possible pair in each step. However, this doesn’t always work. Analyze where precisely the problem in this approach lies, and then accordingly adapt this algorithm so that it works. Chapter 1: Algorithms 27 16. [ELMO Shortlist 2010] You are given a deck of kn cards each with a number in {1, 2, …, n} such that there are k cards with each number. First, n piles numbered {1, 2, …, n} of k cards each are dealt out face down. You are allowed to look at the piles and rearrange the k cards in each pile. You now flip over a card from pile 1, place that card face up at the bottom of the pile, then next flip over a card from the pile whose number matches the number on the card just flipped. You repeat this until you reach a pile in which every card has already been flipped and wins if at that point every card has been flipped. Under what initial conditions (distributions of cards into piles) can you guarantee winning this game? 17. [Russia 2005] 100 people from 25 countries, four from each country, sit in a circle. Prove that one may partition them onto 4 groups in such way that no two countrymen, nor two neighboring people in the circle, are in the same group. 18. [Saint Petersburg 1997] An Aztec diamond of rank n is a figure consisting of those squares of a gridded coordinate plane lying inside the square |x| + |y| ≤ n+1. For any covering of an Aztec diamond by dominoes, a move consists of selecting a 2x2 square covered by two dominoes and rotating it by 90 degrees. The aim is to convert the initial covering into the covering consisting of only horizontal dominoes. Show that this can be done using at most n(n+1)(2n+1)/6 moves. Olympiad Combinatorics Pranav A. Sriram August 2014 Chapter 2: Algorithms - Part II 1 Copyright notices All USAMO and USA Team Selection Test problems in this chapter are copyrighted by the Mathematical Association of America’s American Mathematics Competitions. © Pranav A. Sriram. This document is copyrighted by Pranav A. Sriram, and may not be reproduced in whole or part without express written consent from the author. About the Author Pranav Sriram graduated from high school at The International School Bangalore, India, and will be a Freshman at Stanford University this Fall. Chapter 2: Algorithms - Part II 1 2. ALGORITHMS – PART II In this chapter we focus on some very important themes in the study of algorithms: recursive algorithms, efficiency and information. A recursive algorithm is one which performs a task involving n objects by breaking it into smaller parts. This is known as a “divide and conquer” strategy. Typically, we either do this by splitting the task with n objects into two tasks with n/2 objects or by first reducing the task to a task with (n-1) objects. The latter approach, which is essentially induction, is very often used to solve Olympiad problems. Induction We first look at two problems which use induction. In the first one, we use the technique of ignoring one object and applying the induction hypothesis on the remaining (n-1) objects. This obviously needs some care: we cannot completely ignore the nth object if it has some effect on the other objects! Example 1 [China Girls Math Olympiad 2011-7] There are n boxes B1, B2, …, Bn in a row. N balls are distributed amongst them (not necessarily equally). If there is at least one ball Olympiad Combinatorics 2 in B1, we can move one ball from B1 to B2. If there is at least 1 ball in Bn, we can move one ball from Bn to Bn-1. For 2 ≤ k ≤ (n -1), if there are at least two balls in Bk, we can remove two balls from Bk and place one in Bk+1 and one in Bk-1. Show that whatever the initial distribution of balls, we can make each box have exactly one ball. Answer: We use induction and monovariants. The base cases n =1 and 2 are trivial. Suppose we have an algorithm An-1 for n-1 boxes; we construct an algorithm An for n boxes. We use two steps. The first step aims to get a ball into Bn and the second uses the induction hypothesis. Step 1: If Bn contains at least one ball, move to step two. Otherwise, all n balls lie in the first (n-1) boxes. Assign a weight 2k to box Bk. Now keep moving balls from the boxes B1, B2, …, Bn-1 as long as possible. This cannot go on indefinitely as the total weight of the balls is a positive integer and strictly increases in each move but is bounded above by n2n . Thus at some point this operation terminates. This can only happen if B1 has 0 balls and B2, B3, …, Bn-1 each has at most 1 ball. But then Bn will have at least 2 balls. Now go to step 2. Step 2: If Bn has k > 1 balls, move (k-1) balls from Bn to Bn-1. Now Bn has exactly one ball and the remaining (n-1) boxes have (n-1) balls. Color these (n-1) balls red and color the ball in Bn blue. Now we apply the induction hypothesis. Use algorithm An-1 to make each of the first (n-1) boxes have one ball each. The only time we run into trouble is when a move needs to be made from Bn-1, because in An-1, Bn-1 only needed 1 ball to make a move, but now it needs 2. We can easily fix this. Whenever An-1 says we need to move a ball from Bn-1 to Bn-2, we first move the blue ball to Bn-1. Then we move a ball from Bn-1 to Bn-2 and pass the blue ball back to Bn. This completes the proof. ■ Chapter 2: Algorithms - Part II 3 Example 2 [IMO Shortlist 2005, C1] A house has an even number of lamps distributed among its rooms in such a way that there are at least three lamps in every room. Each lamp shares a switch with exactly one other lamp, not necessarily from the same room. Each change in the switch shared by two lamps changes their states simultaneously. Prove that for every initial state of the lamps there exists a sequence of changes in some of the switches at the end of which each room contains lamps which are on as well as lamps which are off. Answer: Call a room bad if all its lamps are in the same state and good otherwise. We want to make all rooms good. We show that if k ≥ 1 rooms are bad, then we can make a finite sequence of switches so that (k-1) rooms are bad. This will prove our result. Call two lamps connected if they share a switch. Take a bad room R1 and switch a lamp there. If this lamp is connected to a lamp in R1, we are done since each room has at least 3 lamps. If this lamp is connected to a lamp in another room R2, then R1 becomes good but R2 might become bad. If R2 doesn’t become bad, we are done. If R2 does become bad, then repeat the procedure so that R2 becomes good but some other room R3 becomes bad. Continue in this manner. If we ever succeed in making a room good without making any other room bad we are done, so assume this is not the case. Then eventually we will reach a room we have already visited before. We prove that at this stage, the final switch we made would not have made any room bad. Consider the first time this happens and let Rm = Rn for some m > n. We claim that Rm is good at this stage. The first time we switched a lamp in Rn, we converted it from bad to good by switching one lamp. Now when we go to Rm (= Rn), we cannot switch the same lamp, since this lamp was connected to a lamp in room Rn-1, whereas the lamp we are about to switch is connected to a lamp in Rm-1. So two distinct lamps have been switched in Rm and hence Rm is good (since there are at least three lamps, at least Olympiad Combinatorics 4 one lamp hasn’t been switched, and initially all lamps were in the same state since the room was bad before). Thus our final switch has made Rm-1 good without making Rm bad. Hence we have reduced the number of bad rooms by one, and repeating this we eventually make all rooms good. ■ The next two examples demonstrate how to construct objects inductively. Example 3: Given a graph G in which each vertex has degree at least (n-1), and a tree T with n vertices, show that there is a subgraph of G isomorphic to T. Answer: We find such a subgraph inductively. Assume the result holds for (n-1); we prove it holds for n. Delete a terminal vertex v from T. By induction we can find a tree H isomorphic to T \\ {v} as a subgraph of G. This is because T \\ {v} has (n-1) vertices and each vertex in G has degree at least (n-1) > (n-1) - 1, so we can apply the induction hypothesis. Now suppose v was adjacent to vertex u in T (remember that v is adjacent to only one vertex). Let w be the vertex in G corresponding to u. w has at least (n-1) neighbors in G, and at most (n-2) of them are in H since H has (n-1) vertices and w is one of them. Thus w has at least 1 neighbor in G that is not in H, and we take this vertex as the vertex corresponding to v. ■ Figure 2.1: Finding H inductively u a b v T w a’ b’ G This vertex can be added to H Chapter 2: Algorithms - Part II 5 Example 4 [USAMO 2002] Let S be a set with 2002 elements, and let N be an integer with 0 ≤ N ≤ 22002. Prove that it is possible to color every subset of S black or white, such that: a) The union of two white subsets is white b) The union of two black subsets is black c) There are exactly N white subsets. Answer You may have thought of inducting on N, but instead we induct on the number of elements of S. In this problem |S| = 2002, but we prove the more general result with |S| = n and 0 ≤ N ≤ 2n . The result trivially holds for n = 1, so suppose the result holds for n = k. Now we prove the result for n = k+1. If N ≤ 2n-1, note that by induction there is a coloring for the same value of N and n = k. We use this coloring for all sets that do not contain the (k+1)th element of S, and all subsets containing the (k+1)th element of S (which were not there in the case |S| = k) are now colored black. (Essentially, all “new” subsets are colored black while the old ones maintain their original color). Clearly, this coloring works. If N ≥ 2n-1, simply interchange the roles of white and black, and then use the same argument as in the previous case. ■ Information, Efficiency and Recursions The next few problems primarily deal with collecting information and performing tasks efficiently, that is, with the minimum possible number of moves. Determining certain information with the least number of moves or questions is extremely important in computer science. The next example is a simple and well-known problem in Olympiad Combinatorics 6 computer science. Example 5 [Merge Sort Algorithm] Given n real numbers, we want to sort them (arrange them in non- decreasing order) using as few comparisons as possible (in one comparison we can take two numbers a and b and check whether a < b, b < a or a = b). Clearly, we can sort them if we make all possible n(n-1)/2 comparisons. Can we do better? Answer: Yes. We use a recursive algorithm. Let f(n) be the number of comparisons needed for a set of n numbers. Split the set of n numbers into 2 sets of size n/2 (or if n is odd, sizes (n-1)/2 and (n+1)/2. For the rest of this problem, suppose n is even for simplicity). Now sort these two sets of numbers individually. This requires 2f(n/2) comparisons. Suppose the resulting sorted lists are a1 ≤ a2 ≤ … ≤ an/2 and b1 ≤ b2 ≤ … ≤ bn/2. Now we want to combine or ‘merge’ these two lists. First compare a1 and b1. Thus after a comparison between ai and bj, if ai ≤ bj, compare ai+1 and bj and if bj < ai, compare bj+1 and ai in the next round. This process terminates after at most n comparisons, after which we would have completely sorted the list. We used a total of at most 2f(n/2) + n comparisons, so f(n) ≤ 2f(n/2) + n. From this recursion, we can show by induction that f(2k) ≤ k x 2k and in general, for n numbers the required number of comparisons is of the order nlog2(n), which is much more efficient than the trivial bound n(n-1)/2 which is of order n 2. ■ Example 6 Suppose we are given n lamps and n switches, but we don’t know which lamp corresponds to which switch. In one operation, we can specify an arbitrary set of switches, and all of them will be switched from off to on simultaneously. We will then see which lamps come on (initially they are all off). For example, if n = 10 and we specify the set of switches {1, 2, 3} and lamps L6, L4 and L9 Chapter 2: Algorithms - Part II 7 come on, we know that switches {1, 2, 3} correspond to lamps L6, L4 and L9 in some order. We want to determine which switch corresponds to which lamp. Obviously by switching only one switch per operation, we can achieve this in n operations. Can we do better? Answer: Yes. We actually need only ⌈log2(n)⌉ operations, where ⌈ ⌉ is the ceiling function. This is much better than n operations. For example, if n is one million, individually testing switches requires 999,999 operations, whereas our solution only requires 20. We give two solutions. For convenience assume n is even. Solution 1: In the first operation specify a set of n/2 switches. Now we have two sets of n/2 switches, and we know which n/2 lamps they both correspond to. Now we want to apply the algorithm for n/2 lamps and switches to the two sets. Hence it initially appears that we have the recursion f(n) = 2f(n/2)+1, where f(n) is the number of steps taken by our algorithm for n lamps. However, note that we can actually apply the algorithms for both sets simultaneously, since we know which set of switches corresponds to which set of lamps. Thus the actual recursion is f(n) = f(n/2)+1. Since f(1) = 0, we inductively get f(n) = ⌈log2(n)⌉. Solution 2: The algorithm in this solution is essentially equivalent to that in solution 1, but the thought process behind it is different. Label the switches 1, 2, …, n. Now read their labels in binary. Each label has at most ⌈log2(n)⌉ digits. Now in operation 1, flip all switches that have a 1 in the units place of the binary representation of their labels. In general, in operation k we flip all switches that have a 1 in the kth position of their binary representation. At the end of ⌈log2(n)⌉ operations, consider any lamp. Look at all the operations in which it came on. For example, if a lamp comes on in the second, third and fifth operations, but not in the first, fourth and Olympiad Combinatorics 8 6th operations, then it must correspond to the switch with binary representation 010110 (1s in the 2nd, 3rd and 5th positions from the right). Thus each lamp can be uniquely matched to a switch and we are done. ■ Example 7 [Generalization of IMO shortlist 1998, C3] Cards numbered 1 to n are arranged at random in a row with n ≥ 5. In a move, one may choose any block of consecutive cards whose numbers are in ascending or descending order, and switch the block around. For example, if n=9, then 91 6 5 3 2 7 4 8 may be changed to 91 3 5 6 2 7 4 8. Prove that in at most 2n - 6 moves, one can arrange the n cards so that their numbers are in ascending or descending order. Answer: We use a recursive algorithm relating the situation with n cards to the situation with n-1 cards. Let f(n) be the minimum number of moves required to ‘monotonize’ any permutation of the n cards. Suppose we have a permutation with starting card k. In f(n-1) moves, we can monotonize the remaining (n-1) cards to get either the sequence (k, 1, 2, …, k-1, k+1, …, n) or (k, n, n-1, …, k+1, k–1, …, 2, 1). In one move, we can make the former sequence (k, k-1, k-2, …, 1, k+1, k+2, …, n) and with one more move we get the sequence (1, 2, 3, …., n) and we are done. Similarly in the latter case we need only two additional moves to get (n, n-1, …., 1). Thus in either case, we can complete the task using f(n-1) + 2 moves, so f(n) ≤ f(n-1) + 2. Now to prove the bound for general n ≥ 5, it suffices to prove it for n = 5 and then induct using f(n) ≤ f(n-1) + 2. To prove that f(5) ≤ 4, first note that f(3) = 1 and f(4) = 3. With a little case work (do this), we can show that any permutation of 4 cards can be monotonized either way in at most 3 moves (thus both {1, 2, 3, 4} and {4, 3, 2, 1} can be reached after at most 3 moves, regardless of the initial permutation). Now given a permutation of {1, 2, 3, 4, 5}, use one move if necessary to ensure that either 1 or 5 is at an extreme position. Now monotonize the remaining 4 numbers in 3 Chapter 2: Algorithms - Part II 9 moves, in such a way that the whole sequence is monotonized (we can do this by the previous statement). Hence at most 4 moves are required for 5 cards, and we are done. ■ Remark: Since we wanted a linear bound in this problem, we tried to relate f(n) to f(n-1). However, when we want a logarithmic bound, we generally relate f(n) to f(n/2), or use binary representations. Thus the question itself often gives us a hint as to what strategy we should use. Example 8 [Russia 2000] Tanya choses a natural number X ≤ 100, and Sasha is trying to guess this number. She can select two natural numbers M and N less than 100 and ask for the value of gcd (X+M, N). Show that Sasha can determine Tanya's number with at most seven questions (the numbers M and N can change each question). Answer: Since 26 < 100 < 27 we guess that more generally ⌈log2(n)⌉ guesses are needed, where n is the maximum possible value of X and ⌈ ⌉ is the ceiling function. Our strategy is to determine the digits of X in binary notation; that is, the bits of X. First ask for gcd (X+2, 2). This will tell us whether X is even or odd, so we will know the units bit of X. If X is even, ask for gcd (X+4, 4). This tells us whether or not X is divisible by 4. Otherwise ask for gcd (X+1, 4). This tells us if X is 1 or 3 mod 4 (if the gcd is 4, then X+1 is divisible by 4 and so X ≡ 3 mod 4). With this information we can determine the next bit of X. For example, if X is odd and is 3 mod 4, its last two bits will be 11. Now suppose X = i mod 4. To determine the next digit, ask for gcd (X + (4-i), 8). This gcd is either 4 or 8, according as X = i or 4+i mod 8. This gives us the next bit. For example, if X = 3 mod 4 but X = 7 mod 8, then the last 3 bits of X will be 111, but if X = 3 mod 8, then the last 3 bits would be 011. Now the pattern is clear. We continue in this manner until we obtain all the bits of X. This takes k Olympiad Combinatorics 10 questions, where k is the number of bits of n (since X ≤ n, we don’t have to ask for further bits), which is at most equal to ⌈log2(n)⌉. ■ Example 9 [Generalization of Russia 2004, grade 9 problem 3] On a table there are n boxes, where n is even and positive, and in each box there is one ball. Some of the balls are white and the number of white balls is even and greater than 0. In each turn we are allowed to point to two arbitrary boxes and ask whether there is at least one white ball in the two boxes (the answer is yes or no). Show that after (2n – 3) questions we can indicate two boxes which definitely contain white balls. Answer: Label the boxes from 1 to n. Ask for the pairs of boxes (1, j), where j= 2, 3, …, n. If at some stage we get a no, this means box 1 contains a black ball. Then for all j such that we got a ‘yes’ for (1, j), box j contains a white ball and we are done. The only other possibility is if we got a yes for all boxes (1, j), in which case there are 2 possibilities: either box 1 has a white ball or box 1 has a black ball and all the other (n-1) boxes have white balls. The latter case is ruled out since we are given that an even number or boxes have black balls, and (n-1) is odd. Hence box 1 has a white ball. Now ask for the pairs (2, j) where j =3, 4, …, n. Note that now we have asked a total of (n-1) + (n-2) = (2n-3) questions. Again if we get a ‘no’ somewhere, then box 2 has a black ball and all yeses tell us which boxes have white balls. In this case we are done. The other case is if all the answers are yes. The same argument we used earlier shows that box 2 has a white ball and we are done. ■ Now we look at a simple problem from computer science (part a of the next problem), which also happens to be a game I played when I was a little kid. Part b is a little trick question I just came up with. Example 10 a) [Binary Search Algorithm] Chapter 2: Algorithms - Part II 11 My friend thinks of a natural number X between 1 and 2k inclusive. In one move I can ask the following question: I specify a number n and he says bigger, smaller or correct according as n < X, n > X, or n = X. Show that I can determine the number X using at most k moves. Answer: In my first move I say 2k-1 . Either I win, or I have reduced number of possibilities to 2k-1 . Repeat this process- in each stage reduce the number of possibilities by a factor of 2. Then in k moves there is only one possibility left. Example: If k = 6, first guess 32. If the answer is “smaller”, guess 16. If the answer is now “bigger”, guess 24 (the average of 16 and 32). If the answer is now “smaller”, guess 20. If the answer is again smaller, guess 18. If the answer is now “bigger”, the number is 19. In general if we replace 2k with n, we need ⌈log2(n)⌉ questions. ■ Example 10 b) [Binary Search with noise – a little trick] We play the same game, but with a couple changes. First, I can now ask any yes or no question. Second, now my friend is allowed to lie - at most once in the whole game though. Now, from part a) I can win with 2k + 1 moves: I simply ask each question twice, and if the answer changes, that means my friend has lied. Then I ask the question again, and this time I get the true answer (he can only lie once). Thus I ask each question twice except for possibly one question which I ask thrice, for a total of 2k + 1 questions. Can I do better? Answer: First I ask about each of the k digits in the binary representation of X. If the game didn’t involve lying, I would be done. Now I need to account for the possibility that one answer was a lie. I ask the question, “did you ever lie this game?” If the answer is no, we are done (if he had lied, he would have to say yes now as he can’t lie Olympiad Combinatorics 12 twice). If the answer is yes, I ask the question, “was the previous answer a lie?” If the answer to this is yes, then that means he never lied in the first k questions and again we are done. If the answer is no, then we can be sure that one of the first k answers we received (about the binary digits) was a lie. Note that he cannot lie anymore. We want to determine which answer was a lie. But using part a), we can do this in at most ⌈log2( )⌉ moves! This is because determining which of k moves was a lie is equivalent to guessing a number X’ with X’ ≤ k, and for this I use the algorithm in part a). After this, I know which digit in my original binary representation of X is wrong and I change it, and now I am done. I have used k + 2 + ⌈log2( )⌉ questions, which is much less than 2k + 1 questions for large k. In general, if 2k is replaced by n, this algorithm takes ⌈log2(n)⌉+ ⌈log2 ⌈log2(n)⌉⌉ + 2 moves. ■ As in the previous chapter, we end this section with one of the hardest questions ever asked at the IMO. Only 3 out of over 550 contestants managed to completely solve it. However, the difficulty of this now famous problem has been hotly debated on AOPS, with many people arguing that it is a lot easier that the statistics indicate. We’ll let the reader be the judge of that. The following solution is based on one found during the contest. The official solution is much more complicated. Example 11 [IMO 2009, Problem 6] Let n be a nonnegative integer. A grasshopper jumps along the real axis. He starts at point 0 and makes n + 1 jumps to the right with pairwise diﬀerent positive integral lengths a1, a2, … an+1 in an arbitrary order. Let M be a set of n positive integers in the interval (0, s), where s = a1 + a2 + ··· + an+1. Prove that the grasshopper can arrange his jumps in such a way that he never lands on a point from M. Chapter 2: Algorithms - Part II 13 Answer: We construct an algorithm using induction and the extremal principle. The case n = 1 is trivial, so let us assume that n > 1 and that the statement holds for 1, 2, ..., n−1. Assume that a1 <···< an. Let m be the smallest element of M. Consider the following cases: Case 1: m < an+1: If an+1 does not belong to M then make the ﬁrst jump of size an+1. The problem gets reduced to the sequence a1, ..., an and the set M\\{m}, which immediately follows by induction. So now suppose that an+1 ∈ M. Consider the following n pairs: (a1, a1+an+1), ..., (an, an+an+1). All numbers from these pairs that are in M belong to the (n−1)-element set M\\{an}, hence at least one of these pairs, say (ak, ak +an), has both of its members outside of M. If the ﬁrst two jumps of the grasshopper are ak and ak +an+1, it has jumped over at least two members of M: m and an+1. There are at most n−2 more elements of M to jump over, and n−1 more jumps, so we are done by induction. Case 2: m ≥ an+1: Note that it is equivalent to solve the problem in reverse: start from s = a1 + a2 + ··· + an+1 and try to reach 0 without landing on any point in M. By the induction hypothesis, the grasshopper can start from s make n jumps of sizes a1, ..., an to the left, and avoid all the points of M\\{m}. If it misses the point m as well, then we are done, since we can now make a jump of size an+1 and reach 0. So suppose that after making the jump ak the grasshopper landed at m. If it changes the jump ak to the jump an, it will jump past m and all subsequent jumps will land outside of M because m is the left-most point. ■ Olympiad Combinatorics 14 Exercises 1. [Spain 1997] The exact quantity of gas needed for a car to complete a single loop around a track is distributed among n containers placed along the track. Show that there exists a point from which the car can start with an empty tank and complete the loop (by collecting gas from tanks it encounters along the way). [Note: assume that there is no limit to the amount of gas the car can carry]. 2. [Russia] Arutyun and Amayak perform a magic trick as follows. A spectator writes down on a board a sequence of N (decimal) digits. Amayak covers two adjacent digits by a black disc. Then Arutyun comes and says both closed digits (and their order). For which minimal N can this trick always work? 3. [Generalization of Russia 2005] Consider a game in which one person thinks of a permutation of {1, 2, …, n} and the other’s task is to deduce this permutation (n is known to the guesser). In a turn, he is allowed to select three positions of the permutation and is told the relative order of the three numbers in those positions. For example, if the permutation is 2, 4, 3, 5, 1 and the guesser selects positions 1, 4 and 5, the other player will reveal that 5th number < 1st number < 4th number. Determine the minimum number of moves for the guesser to always be able to figure out the permutation. 4. [IMO Shortlist 1990] Given n countries with three representatives each, m committees A1, A2, …, Am are called a cycle if Chapter 2: Algorithms - Part II 15 i. each committee has n members, one from each country; ii. no two committees have the same membership; iii. for 1 ≤ i ≤ m, committee Ai and committee Ai+1 have no member in common, where Am+1 denotes A1 iv. if 1 < |i-j| < m-1, then committees Ai and Aj have at least one member in common. Is it possible to have a cycle of 1990 committees with 11 countries? 5. [Canada 2012 – 4] A number of robots are placed on the squares of a finite, rectangular grid of squares. A square can hold any number of robots. Every edge of each square of the grid is classified as either passable or impassable. All edges on the boundary of the grid are impassable. A move consists of giving one of the commands up, down, left or right. All of the robots then simultaneously try to move in the specified direction. If the edge adjacent to a robot in that direction is passable, the robot moves across the edge and into the next square. Otherwise, the robot remains on its current square. Suppose that for any individual robot, and any square on the grid, there is a finite sequence of commands that will move that robot to that square. Prove that you can also give a finite sequence of commands such that all of the robots end up on the same square at the same time. 6. [IMO Shortlist 2002, C4] Let T be the set of ordered triples (x, y, z), where x, y, z are integers with 0 ≤ x, y, z ≤ 9. Players A and B play the following guessing game. Player A chooses a triple in T (x, y, z), and Player B has to discover A’s triple in as few moves as possible. A move consists of the following: B gives A a triple (a, b, c) in T, and A replies by giving B the number |x + y – a – b| + |y + z – b Olympiad Combinatorics 16 – c| + |z + x – c – a|. Find the minimum number of moves that B needs in order to determine A’s triple. 7. Given a finite set of points in the plane, each with integer coordinates, is it always possible to color the points red or white so that for any straight line L parallel to one of the coordinate axes the difference (in absolute value) between the numbers of white and red points on L is not greater than 1? 8. [Generalization of Russia 1993] There are n people sitting in a circle, of which some are truthful and others are liars (we don’t know who is a liar and who isn’t though). Each person states whether the person to in front of him is a liar or not. The truthful people always tell the truth, whereas the liars may either lie or tell the truth. The aim is for us to use the information provided to find one person who is definitely truthful. Show that if the number of liars is at most 2√ – 3, we can always do this. 9. On each square of a chessboard is a light which has two states- on or off. A move consists of choosing a square and changing the state of the bulbs in that square and in its neighboring squares (squares that share a side with it). Show that starting from any configuration we can make finitely many moves to reach a point where all the bulbs are switched off 10. [Indian Postal Coaching 2011] Let C be a circle, A1, A2, …, An be distinct points inside C and B1, B2, …, Bn be distinct points on C such that no two of the segments A1B1, …, AnBn intersect. A grasshopper can jump from Ar to As if the line segment ArAs does not intersect any line segment AtBt (t ≠ r, s). Prove that after a certain number of jumps, the grasshopper can jump from any Au to any Av. Chapter 2: Algorithms - Part II 17 11. [USAMO 2000, Problem 3] You are given R red cards, B blue cards and W white cards and asked to arrange them in a row from left to right. Once arranged, each card receives a score as follows. Each blue card receives a score equal to the number of white cards to its right. Each white card receives a score equal to twice the number of red cards to its right. Each red card receives a score equal to three times the number of blue cards to its right. For example, if the arrangement is Red Blue White Blue Red Blue, the total score will be 9 + 1 + 2 + 0 + 3 + 0 = 15. Determine, as a function of R, B and W, the minimum possible score that can obtained, and find all configurations that achieve this minimum. 12. [IMO Shortlist 2005, C7] Suppose that a1, a2, …, an are integers such that n | (a1 + a2 + … + an). Prove that there exist two permutations b1, b2, …, bn and c1, c2, …, cn of (1, 2, …, n) such that for each integer i with 1 ≤ i ≤ n, we have n | ai – bi – ci. 13. [St. Petersburg 2001] In the parliament of the country of Alternativia, for any two deputies there exists a third who is acquainted with exactly one of the two. There are two parties, and each deputy belongs to exactly one of them. Each day the President (not a member of the parliament) selects a group of deputies and orders them to switch parties, at which time each deputy acquainted with at least one member of the group also switches parties. Show that the President can eventually ensure that all deputies belong to the same party. Olympiad Combinatorics Pranav A. Sriram August 2014 Chapter 3: Processes Copyright notices All USAMO and USA Team Selection Test problems in this chapter are copyrighted by the Mathematical Association of America’s American Mathematics Competitions. © Pranav A. Sriram. This document is copyrighted by Pranav A. Sriram, and may not be reproduced in whole or part without express written consent from the author. About the Author Pranav Sriram graduated from high school at The International School Bangalore, India, and will be a Freshman at Stanford University this Fall. Chapter 3: Processes 3. PROCESSES Introduction In this chapter we analyze combinatorial processes. In Chapter 1 on algorithms, we often encountered combinatorial processes from a different viewpoint. Problems from both chapters are similar in that they typically specify an initial configuration and allowed set of moves. In the chapter on algorithms, we were asked to prove that a certain final configuration could be reached using these moves, and we solved these problems by constructing procedures to reach the desired final configuration. In this chapter, our job is not to construct our own procedures, but rather to analyze given ones. Some questions ask us to determine whether a process terminates, and if it does, what the final configuration looks like. Others may ask us to bound the number of steps it takes for a certain configuration to arise. Our main tools for this chapter are invariants, the extremal principle, induction and other clever ideas that we will develop as we go further, such as making transformations to a problem that simplify the problem but leave the end result invariant. It must also be stressed that experimentation, trial and error, observation, intuition and conjectures play a big role in solving problems related to processes (and combinatorics in general). We remind the reader that the ideas to solve combinatorial problems often arise from experimenting with small values. Olympiad Combinatorics 2 Invariants Our first few examples use invariants, a technique we have already used in earlier chapters. The usefulness of invariants while analyzing combinatorial processes can hardly be overstated. Example 1 [Indian TST 2004] The game of pebbles is played as follows. Initially there is a pebble at (0, 0). In a move one can remove a pebble from (i, j) and place one pebble each on (i+1, j) and (i, j+1), provided (i, j) had a pebble to begin with and (i+1, j) and (i, j+1) did not have pebbles. Prove that at any point in the game there will be a pebble at some lattice point (a, b) with a+b ≤ 3. Answer: Clearly the pebbles will always be on lattice points in the first quadrant. How can we find an invariant? Just assign a weight of 2-(i+j) to a pebble at (i, j). Then in each move one pebble is replaced by two pebbles, each having half its weight. So the total weight of pebbles is invariant. Initially the weight is 20 = 1. Suppose at some stage no pebble is on a point (a, b) with a+b ≤ 3. Then the maximum possible total weight of all pebbles is the weight of the whole first quadrant minus that of the squares (a, b) with a+b ≤ 3, which is (∑ ∑ -(i+j) ) – (1 + 2 × ½ + 3 × ¼ + 4 × ⅛) = 4 – (1 + 1+ ¾ + ½) = ¾ < 1. This is a contradiction as the weight should always be 1. ■ Remark: The double summation was computed by noticing ∑ ∑ -(i+j) = ∑ x ∑ = 2 x 2 = 4. The second parenthesis was the weight of all squares a, b with a+b ≤ 3. Chapter 3: Processes Example 2 [IMO shortlist 2005, C5] There are n markers, each with one side white and the other side black, aligned in a row so that their white sides are up. In each step, if possible, we choose a marker with the white side up (but not one of the outermost markers), remove it and reverse the closest marker to the left and the closest marker to the right of it. Prove that one can achieve the state with only two markers remaining if and only if n−1 is not divisible by 3. Answer: If n–1 is not divisible by 3, it is easy to construct an inductive algorithm to make only two markers remain (chapter 2 FTW!). We leave this to the reader (just do it for n = 5, n = 6 and induct with step 3). Now we do the harder part: if (n–1) is divisible by 3, we need to show that this cannot be done. Call a marker black or B if its black side is up and white or W if its white side is up. One invariant we immediately find is that the number of black markers is always even since each move changes the number of black markers by 0, 2 or -2. Now we look for another invariant. We assign numbers to each white marker. If a white marker has t black markers to its left, we assign the number (-1) t to it. Let S be the sum of all the labels. Initially all labels are (-1) 0 = 1, so S = n initially. The labels may keep changing, but we claim that S stays invariant mod 3. For example, suppose we have the substring …WWB… and remove the middle white marker. Then it becomes …BW…. If the 2 white markers had t black markers to their left initially, then the white marker now has (t+1) black markers to its left. Thus the two white markers both had labels (-1) t initially, but now the white marker has label (-1) t+1. The sum of the labels has changed by (-1) t+1 – 2(-1) t = 3(-1) t+1 ≡ 0 mod 3. The reader can verify that in the other cases (WWW, BWB, BWW) as well the sum Olympiad Combinatorics 4 of labels S doesn’t change mod 3. Now the rest is easy. If two markers remain, they are either both white or both black (number of black markers must be even). In the first case, both labels are 1 and S = 2. In the second case, S = 0 as no markers are labeled. So S = 0 or 2 at the end and S = n in the beginning. Since S stays invariant mod 3, n ≡ 0 or 2 mod 3 and we are done. ■ Example 3 [IMO Shortlist 1998 C7] A solitaire game is played on an m × n board with markers having one white side and one black side. Each of the mn cells contains a marker with its white side up, except for one corner square which has a marker with its black side up. The allowed move is to select a marker with black side up, remove it, and turn over all markers in squares sharing a side with the square of the chosen marker. Determine all pairs (m, n) for which it is possible to remove all markers from the board. Answer: It is natural (but not essential) to rephrase the problem using graph theory. We take the markers as vertices. Each vertex is black or white. 2 vertices are connected by an edge if and only if the markers lie on adjacent squares. In each move, we are deleting one black vertex and all its incident edges, but all its white neighbors become black and all its white neighbors become black. Suppose in a move we delete a black vertex v and s edges, where s is the degree of v. Suppose w of v’s neighbors were white vertices, and (s–w) were black vertices. Then these w vertices become black and (s–w) become white, so the number of white vertices increases by s – 2w. This information alone does not immediately give us an invariant, since the quantity s – 2w is quite random. However, suppose we consider the quantity W + E, where W is the total number of remaining white vertices (don’t confuse this with w) and E is the number of edges. Then when E reduces by s and W Chapter 3: Processes changes by s – 2w, (W+E) decreases by 2w, which is always even. Hence the parity of (W+E) remains the same. So if W+E is 0 at the end (when all markers are gone), we need W+E to be even in the beginning. But initially W = mn-1, E = m(n-1) + n(m-1), and W+E = 3mn – m – n – 1 ≡ mn – m – n + 1 (mod 2) = (m-1)(n-1), so at least one of m and n must be odd. In this case the task is indeed possible and we leave it to the reader to find an algorithm. (Assume m is odd and use an inductive procedure that makes each column empty one by one). ■ Good and Bad Objects Another useful idea while analyzing processes is to distinguish between “good” and “bad” objects. For example, if at the end of a process we want to show that all objects satisfy a certain property, call objects with that property good and the other objects bad. We will use this idea in different forms several times throughout this chapter. The next example combines this idea with monovariants by showing that the number of “good” objects monotonically increases. Example 4 [Based on Canada 1994] There are 2n+1 lamps placed in a circle. Each day, some of the lamps change state (from on to off or off to on), according to the following rules. On the kth day, if a lamp is in the same state as at least one of its neighbors, then it will not change state the next day. If a lamp is in a different state from both of its neighbors on the kth day, then it will change its state the next day. Show that regardless of the initial states of each lamp, after some point none of the lamps will change state. Olympiad Combinatorics 6 Answer: Call a lamp “good” if it is in the same state as at least one of its neighbors. Once a lamp is good, it will remain good forever (if two adjacent lamps are in the same state on the kth day, they will not change state the next day, and hence both remain good). Hence the number of good lamps never decreases and is a monovariant. We show that in fact the number of good lamps strictly increases until it reaches 2n+1. Initially there must be 2 adjacent lamps with the same state since the number of lamps is odd. Suppose at some point there are j good lamps and 2 ≤ j < 2n+1. Then there must exist 2 adjacent lamps such that one is bad and one is good. Then the bad lamp will switch states the next day and the good lamp will remain in the same state. Then the bad lamp will now be good, so the number of good lamps has increased (remember all good lamps remain good). So the number of good lamps increases until all lamps are good, and at this point there will be no more changes of state. ■ Figure 3.1: Bad lamps next to good lamps become good Bounds on the number of steps Now we look at another class of problems, which ask us to bound the number of steps or moves it takes for a process to terminate. To bound the total number of moves, it is often useful to bound Good Bad Good Good Chapter 3: Processes the number of times a particular object is involved in a move. Example 5 [USAMO 2010-2] There are n students standing in a circle, one behind the other, all facing clockwise. The students have heights h1 < h2 < … < hn. If a student with height hk is standing directly behind a student with height hk-2 or less, the two students are permitted to switch places. Prove that it is not possible to make more than nC3 such switches before reaching a position in which no further switches are possible. Answer: We bound the number of times an individual student can switch places with another student. Let sk denote the number of times the student with height k switches with someone shorter. Obviously s1 = s2 = 0. Now consider the number of people between student k and student (k–1) (along the clockwise direction) of height less than hk-1. This number is at most (k–2). This quantity decreases by 1 each time student k switches with someone shorter and increases by one each time student k–1 switches with someone shorter. This quantity doesn’t change when students taller than student k switch with either student k or student (k–1). Hence sk - sk-1 denotes the decrease from beginning to end in the number of students between student k and student (k–1), which cannot exceed (k–2). Thus we get the bound sk – sk-1 ≤ (k–2). Using this recursive bound and the initial values s1 = s2 = 0, we get s3 ≤ 1, s4 ≤ 3, etc. In general it is easy to show by induction sk ≤ ( ). Hence the total number of moves cannot exceed ∑ ( ) = nC3 and we are done. ■ Note: The last step uses a well-known binomial identity. More generally ∑ ( ) = ( ), where by convention ( ) = 0 for j < r. Example 6 [Based on Canada 2012, IMO Shortlist 1994 C4] A bookshelf contains n volumes, labeled 1 to n, in some order. The Olympiad Combinatorics 8 librarian wishes to put them in the correct order as follows. The librarian selects a volume that is too far to the right, say the volume with label k, takes it out, and inserts it in the kth position. For example, if the bookshelf contains the volumes 3, 1, 4, 2 in that order, the librarian could take out volume 2 and place it in the second position. The books will then be in the order 3, 2, 1, 4. Show that the sequence (1, 2, … , n) is reached in fewer than 2n moves. Answer: We bound the number of times book k can be selected by the librarian. Clearly, book n can never be selected since it will never be too far right. Book 1 can only be selected once, because once selected, it will move to the first position and never move again. Book 2 can be selected twice: it may be selected once and put in the correct position, but then it may move because of book 1. More generally, let f(k) denote the number of times book k is selected for 1 ≤ k ≤ (n–1). We have f(k) ≤ 1 + f(k – 1) + f(k – 2) + …+ f(1). This is because once k is in the correct position, it can only be displaced f(k – 1) + f(k – 2) + … + f(1) times, because the only way in which book k can be displaced is if one of the books with number less than k “pushes” k. For example: If we start from (4, 1, 3, 2, 5) and we choose book 2, it becomes (4, 2, 1, 3, 5). Book 3 was in the correct position, but has been “pushed out” because of book 2 being chosen. Thus using this recursive bound on f(k) and the fact that f(1) = 1, we obtain by a simple induction f(k) ≤ 2k-1. Hence the total number of moves required is at most f(1) + f(2) + … + f(n – 1) ≤ 1 + 2 + 4 + … + 2n-2 = 2 n-1 – 1. ■ Remark: A solution with monovariants is also possible. Chapter 3: Processes Induction In the previous section, we essentially broke down the analysis of a process into the analysis of the individual entities involved. To find the total time for the process to terminate, we used recursive bounds to estimate the time a particular object could contribute to the total time. These essential elements of somehow “breaking down” a process and using induction and/or recursion will be central to this section as well. However, rather than the object- centric approach of the previous section, a structure-centric approach will be taken here: the inductive proofs will rely on exploiting the nice combinatorial structure of n x n boards. Example 7 [Belarus 2001] Let n be a positive integer. Each unit square of a (2n-1) × (2n-1) square board contains an arrow, either pointing up, down left or right. A beetle sits in one of the squares. In one move, the beetle moves one unit in the direction of the arrow in the square it is sitting on, and either reaches an adjacent square or leaves the board. Then the arrow of the square the beetle left turns 90o clockwise. Prove that the beetle leaves the board in at most 23n-1 (n-1)! – 3 moves. Answer: The base case n = 1 is trivial since the beetle leaves in the first move. Now suppose the result is true for n = k; we prove it for n = k+1. It is natural to distinguish between boundary squares (squares on the edge of the board) and interior squares, since the interior squares form a (2k-1) × (2k-1) board and we can use the induction hypothesis on this board. We further distinguish between corner squares and non-corner boundary squares. Suppose the beetle is still on the board after T moves. We want to show that T < 23(k+1)-1k! – 3. At this stage, if any non-corner Olympiad Combinatorics 10 boundary square has been visited 4 times, then one of the four times the arrow would have been pointing out of the board (since its direction changes each time). Similarly if a corner square has been visited 3 times, then at least once it would have pointed out of the board. Hence in each of the cases, the beetle would have left the board, contradiction. Hence the beetle has visited each corner square at most twice and each non-corner boundary square at most thrice. Moreover, the beetle can move at most once from a non-corner boundary square to an interior square. Thus: i. The beetle has made at most 2 × 4 + 3(8k – 4) = 24k – 4 moves from boundary squares to other squares of the board (since there are 4 corner squares and 8k – 4 non-corner boundary squares). ii. The beetle has made at most 4(2k – 1) = 8k – 4 moves from a boundary square to an interior square, since there are 8k – 4 non-corner boundary squares. iii. If a beetle is in the interior (2k – 1) × (2k – 1) square, it can make at most M = 23k-1(k – 1)! – 3 moves before reaching a boundary square, by the induction hypothesis. iv. From (ii), the beetle can stay in the interior square for at most 8k – 3 periods of time (once in the beginning, then once for each time it moves from a boundary square back to the interior). Each period lasts at most 23k-1 (k – 1)! – 3 moves by (iii). Hence the number of moves made from interior squares is at most (23k-1 (k – 1)! – 3) × (8k – 3) < 8k × (23k-1 (k – 1)! – 3) = 2 3(k+1)-1 k! – 24k. From (i) and (iv), we see that T ≤ (24k – 4) + (23(k+1)-1k! – 24k) = 2 3(k+1)-1k! – 4, as desired. ■ Now we look at another example using induction. This problem is different from the previous one in that we are not asked to Chapter 3: Processes bound the number of moves for a process to terminate. However, the idea of inducting by dividing an n×n board into an (n-1)×(n-1) sub board and an additional row and column is very similar to the idea in the previous example. This inductive technique is just one of many ways in which the structure of boards can be exploited. Example 8 [Russia 2010] On an n × n chart where n ≥ 4, stand n ‘+’ signs in cells of one diagonal and a ‘–’ sign in all the other cells. In a move, one can change all the signs in one row or in one column, (– changes to + and + changes to –). Prove that it is impossible to reach a stage where there are fewer than n pluses on the board. Answer: Note that operating twice on a row is equivalent to not operating on it at all. So we can assume that each row and column has been operated upon 0 or 1 times. Now we use induction on n. The base case n = 4 is not entirely trivial, but is left to the reader in keeping with my general habit of dismissing base cases. Now passing to the induction step, given an n × n board there are at least (n – 1) pluses in the bottom right (n – 1) × (n – 1) square by the induction hypothesis. If we have a plus in the first row or column we are done. Suppose there is no plus in the first column or row. Then either the first row or the first column (but not both) has been operated upon (otherwise the top left square would have a plus). Suppose WLOG the first row has been operated upon. Then columns 2, 3, ..., n have all been operated upon (otherwise row 1 would have a plus). Also no other row has been operated upon (otherwise the first column would have a plus). But in this case, the lower right (n – 1) × (n – 1) square has had all its columns and none of its rows operated upon, and hence each column has (n – 2) pluses. In total it has (n – 2)(n – 1) > n pluses, so in this case as well we are done. ■ Olympiad Combinatorics 12 Problem Alteration: Don’t play by the rules Next we look at a very powerful technique of solving problems related to processes. In the next three examples, we will alter the problem statement slightly in such a way that the result we need to show doesn’t change, but the process becomes much easier to analyze. In other words, we simplify the process to be analyzed while leaving the aspect of the process that we want to prove something about invariant. This may take some time to understand, so read through the next few examples slowly and carefully, and multiple times if necessary. Example 9 [warm up for example 11] There are n ants on a stick of length one unit, each facing left or right. At time t = 0, each ant starts moving with a speed of 1 unit per second in the direction it is facing. If an ant reaches the end of the stick, it falls off and doesn’t reappear. When two ants moving in opposite directions collide, they both turn around and continue moving with the same speed (but in the opposite direction). Show that all ants will fall off the stick in at most 1 second. (We will use a very similar idea in example 11, so make sure you understand this trick.) Answer: The key observation is that the problem doesn’t change if we alter it as follows: when two ants moving in opposite directions meet, they simply pass through each other and continue moving at the same speed. Thus instead of rebounding, if the ants pass through each other, the only difference from the original problem is that the identities of the ants get exchanged, which is inconsequential. Now the statement is obvious – each ant is unaffected by the others, and so each ant will fall of the stick of length one unit in at most 1 second. ■ Chapter 3: Processes Example 10 [Russia 1993 generalized] The integers from 1 to n are written in a line in some order. The following operation is performed with this line: if the first number is k then the first k numbers are rewritten in reverse order. Prove that after some finite number of these operations, the first number in the line of numbers will be 1. Answer: The base case n = 1 is trivial. Suppose the result is true for (n – 1). First observe that if n appears in the first position at some point, then in the next step n will be in the last position and will remain there permanently. Then we can effectively ignore n and we are done by induction. So suppose n never appears in the first position. Let j be the number in the last position. If we switch n and j, it has absolutely no effect on the problem, as j will never appear in the first position (since we assumed n will never appear in the first position). Now n is in the last position and as in the first case, we are done by induction. ■ Remark: Based on the above proof, it is not difficult to show that for n > 1 if the first number becomes 1 after at most f(n) operations, we have the recursive bound f(n+1) ≤ 2f(n)+1. I believe this bound can be further improved for most values of n. As if “cheating” once isn’t bad enough, we’ll cheat twice in the next problem. Combining the insights obtained from these two instances of “cheating” will greatly restrict the possible positions of otherwise very chaotic ants. Example 11 [IMO Shortlist 2011, C5] Let m be a positive integer and consider a checkerboard consisting of m × m unit squares. At the midpoints of some of these unit squares there is an ant. At time 0, each ant starts moving with speed 1 parallel to some edge of the checkerboard. When two ants moving in opposite directions meet, they both turn 90◦ clockwise and continue moving with speed 1. When more than two ants meet, or when two ants moving in perpendicular Olympiad Combinatorics 14 directions meet, the ants continue moving in the same direction as before they met. When an ant reaches one of the edges of the checkerboard, it falls oﬀ and will not reappear. Considering all possible starting positions, determine the latest possible moment at which the last ant falls off the checkerboard or prove that such a moment does not necessarily exist. Answer: After experimenting with small values of m, we conjecture that the answer is -1. Clearly this is attainable if initially there are only 2 ants, one in the bottom left square facing upwards and one in the top left square facing downward. Now we prove that it is the maximum possible. Let U, D, L, R represent the directions up, down, left and right respectively. Step 1: We use a modified version of the trick in example 7. Using the same reasoning, we can change the rules so that each ant travels in only two directions- either U and R or D and L. So if an ant travelling R meets an ant travelling L, they now move U and D respectively (even though in the original problem they should now move D and U respectively). This doesn’t affect the problem. Now based on their initial direction, each ant can be classified into two types: UR or DL. UR ants can only move up and right the whole time and DL ants only move down and left the whole time. Note that we can ignore collisions between two ants of the same type. From now on, “collision” only refers to collisions between two ants of opposite types. Step 2: Choose a coordinate system such that the corners of the checkerboard are (0, 0), (m, 0), (m, m) and (0, m). At time t, there will be no UR ants in the region {(x, y): x + y < t + 1} and no DL ants in the region {(x, y): x + y > 2m−t−1}. So if a collision occurs at (x, y) at time t, we have t + 1 ≤ x + y ≤ 2m−t−1. Step 3: In a similar manner, we can change the rules of the original problem (without affecting it) by assuming that each ant can only Chapter 3: Processes move U and L or D and R, so each ant is UL or DR. Using the same logic as in step 2, we get a bound |x−y| ≤ m−t−1 for each collision at point (x, y) and time t. Thus we have shown that all collisions at time t are within the region bounded by the 4 lines represented by the equations t + 1 ≤ x + y ≤ 2m−t−1 and |x−y|≤ m−t−1. Figure 3.1: All collisions at time t must lie within the shaded region Step 4: We finish the proof for a UR ant; by symmetry the same final bound will hold for DL ants. Take a UR ant and suppose its last collision is at (x, y) at time t. Adding the bounds x+y ≥ t+1 and x – y ≥ – (m – t – 1), we get x ≥ t + 1 - . Similarly, y ≥ t + 1 - . Since this is the last collision, the ant will now move straight to an edge and fall off. This takes at most m−min{x, y} units of time. The total amount of time the ant stays on the board is hence at most t + m – min{x, y} ≤ t + m − {t + 1 − m/2} = -1 units of time. ■ L1 L 2 L 3 L 4 (0, 0) (0, m) (m, m) (m, 0) (t, 0) (0, t) Olympiad Combinatorics 16 Remark: Let’s reverse engineer the solution a little bit, to see how the main ideas fit together so nicely – did you notice how the parameter t disappeared so conveniently in the last step? The basic goal in the above solution was to obtain tight bounds on the location of an ant after its last collision because after this the ant travels straight off the board. The intuition behind getting rid of t was that the longer an ant has been wandering around till its last collision, the closer it must be to an edge, and so the less time it will take to fall off now. But for this to work we need the ants to be “well behaved” - and hence the cheating! Concluding Examples Our final two examples lie at the heart of this chapter. Example 12 is a particular case of a more general and extensively studied process known as a “chip firing game”, and Example 13 is a distant cousin of the chip firing game. Through these problems we introduce some important ideas such as using the extremal principle in different ways and obtaining contradictions, and combine these with ideas we have already seen like invariants and making assumptions that don’t affect the problem. In example 12, we use the following idea: if a process never terminates, there must be some object that is moved or operated upon infinitely times. If we can find an object that is only operated upon finitely many times, we may be able to get a contradiction. Example 12 [IMO shortlist 1994, C5] 1994 girls are seated in a circle. Initially one girl is given n coins. In one move, each girl with at least 2 coins passes one coin to each of her two neighbors. (a) Show that if n < 1994, the game must terminate. (b) Show that if n = 1994, the game cannot terminate. Chapter 3: Processes Answer: (a) Label the girls G1, G2, …, G1994 and let G1995 = G1, G0 = G1994. Suppose the game doesn’t terminate. Then some girl must pass coins infinitely times. If some girl passes only finitely many times, there exist two adjacent girls, one of whom has passed finitely many times and one of whom has passed infinitely many times. The girl who has passed finitely many times will then indefinitely accumulate coins after her final pass, which is impossible. Hence every girl must pass coins infinitely many times. Now the key idea is the following: For any two neighboring girls Gi and Gi+1, let ci be the first coin ever passed between them. After this, we may assume that ci always stays stuck between Gi and Gi+1, because whenever one of them has ci and makes a move, we can assume the coin passed to the other girl was ci. Therefore, each coin is eventually stuck between two girls. Since there are fewer than 1994 coins, this means there exist two adjacent girls who have never passed a coin to each other. This contradicts the result of the first paragraph. (b) This is simple using invariants. Let a coin with girl i have weight i, and let G1 have all coins initially. In each pass from Gi to her neighbors, the total weight either doesn’t change or changes by ±1994 (if G1 passes to G1994 or vice versa). So the total weight is invariant mod 1994. The initial weight is 1994, so the weight will always be divisible by 1994. If the game terminates, then each girl has one coin, so the final weight is 1+2+3+…+ 1994 = (1994 x 1995)/2 which is not divisible by 1994. Contradiction. ■ Before reading the solution to the next problem, we recommend that the reader experiment with small values of n and try to guess what the final configuration looks like. Several combinatorics problems require experimentation, observation and conjecturing before actually proving anything. Olympiad Combinatorics 18 Example 13 [IMO shortlist 2001, C7] A pile of n pebbles is placed in a vertical column. This configuration is modified according to the following rules. A pebble can be moved if it is at the top of a column which contains at least two more pebbles than the column immediately to its right. (If there are no pebbles to the right, think of this as a column with 0 pebbles.) At each stage, choose a pebble from among those that can be moved (if there are any) and place it at the top of the column to its right. If no pebbles can be moved, the configuration is called a final configuration. For each n, show that, no matter what choices are made at each stage, the final configuration obtained is unique. Describe that configuration in terms of n. Answer: It is clear that if si denotes the number of stones in column i, then in the final configuration si+1 = si or si -1. After experimenting with small values of n, we are led to the following claim: Claim: In the final configuration, there is at most one index i such that si+1 = si (hence the remaining columns satisfy sj+1 = sj – 1). Proof: Call an index j bad if sj+1 = sj. Assume to the contrary that there exist (at least) 2 bad indices in the final configuration. Take k and m (k > m) to be consecutive bad indices. Then sk+1 = sk, sm+1 = sm and si+1 = si – 1 for m < i < k. Consider the earliest configuration, say C, with the 2 bad indices. Now look at the last move before C. Since C is the earliest such configuration, the last move was either from the kth or mth column. But then in either case the configuration before C also had 2 bad indices, contradicting our assumption. This proves the claim. Now it is easy to see that the claim uniquely determines the final configuration. For example, for n = 17 the final heights would be (5, 4, 3, 2, 2, 1). ■ Chapter 3: Processes Exercises 1. [Austrian-Polish Mathematical Competition 1997] The numbers 49/k for k = 1, 2, …, 97 are written on a blackboard. A move consists of choosing two number a and b, erasing them and writing the number 2ab – a – b + 1 in their place. After 96 moves, only one number remains. Find all possible values of this number. 2. We have n(n+1)/2 stones in k piles. In each move we take one stone from each pile and form a new pile with these stones (if a pile has only one stone, after that stone is removed the pile vanishes). Show that regardless of the initial configuration, we always end up with n piles, having 1, 2, …, n stones respectively. 3. [ELMO Shortlist 2013, C9, generalized] There are n people at a party. Each person holds some number of coins. Every minute, each person who has at least (n – 1) coins simultaneously gives one coin to every other person at the party. (So, it is possible that A gives B a coin and B gives A a coin at the same time.) Suppose that this process continues indefinitely. That is, for any positive integer m, there exists a person who will give away coins during the mth minute. What is the smallest number of coins that could be at the party? 4. [China TST 2003] There is a frog in every vertex of a regular 2n-gon (n ≥ 2). At a certain time, all frogs jump simultaneously jump to one of their neighboring vertices. (There can be more than one frog in one vertex). Suppose after this jump, no line connecting any two distinct vertices having frogs on it after the jump passes through the circumcentre of the 2n-gon. Find all possible values of n for which this can occur. Olympiad Combinatorics 20 5. [Chip firing lemma] Let G be a connected graph with m edges. Consider 2m+1 frogs, each placed on some vertex of G. At each second, if a vertex v contains at least dv frogs, then dv of the frogs on v jump, one on each of the dv adjacent vertices. Show that every vertex will be visited by a frog at some point. 6. [IMO 1986, Problem 3] An integer is assigned to each vertex of a regular pentagon, and the sum of all five integers is positive. If three consecutive vertices are assigned the numbers x, y, z respectively, and y < 0, then the following operation is allowed: x, y, z are replaced by x+y, -y, z+y respectively. Such an operation is performed repeatedly as long as at least one of the five numbers is negative. Determine whether this procedure necessarily comes to an end after a finite number of steps. 7. [Russia 1997] There are some stones placed on an infinite (in both directions) row of squares labeled by integers. (There may be more than one stone on a given square). There are two types of moves: (i) Remove one stone from each of the squares n and n – 1 and place one stone on n + 1 (ii) Remove two stones from square n and place one stone on each of the squares n + 1 and n – 2. Show that at some point no more moves can be made, and this final configuration is independent of the choice of moves. 8. [APMO 2007, Problem 5] A regular 5×5 array of lights is defective, so that toggling the switch for one light causes each adjacent light in the same row and in the same column as well as the light itself to change state, from on to off, or from off to on. Initially all the lights are switched off. After a certain number of toggles, exactly one light is switched on. Find all the possible positions of this light. Chapter 3: Processes 9. [IMO Shortlist 2007, C4] Let A0 = {a1, a2, …, an} be a finite sequence of real numbers. For each k ≥ 0, from the sequence Ak = {x1, x2, …, xn} we construct a new sequence Ak+1 in the following way: (i) We choose a partition {1, 2, …, n} = ⋃ , where I and J are two disjoint sets, such that the expression |∑ - ∑ | is minimized. (We allow I or J to be empty; in this case the corresponding sum is 0.) If there are several such partitions, one is chosen arbitrarily. (ii) We set Ak+1 = {y1, y2, …, yn}, where yi = xi + 1 if i I, and yi = xi – 1 if i J. Prove that for some k, the sequence Ak contains an element x such that |x| ≥ n/2. 10. [Romanian TST 2002] After elections, every Member of Parliament (MP) has his own absolute rating. When the parliament is set up, he enters a group and gets a relative rating. The relative rating is the ratio of its own absolute rating to the sum of all absolute ratings of the MPs in the group. An MP can move from one group to another only if in his new group his relative rating is greater. In a given day, only one MP can change the group. Show that only a finite number of group moves is possible (that is, the process eventually terminates). 11. [ELMO Shortlist 2013, C10] Let N > 1 be a fixed positive integer. There are 2N people, numbered 1, 2, …, 2N, participating in a tennis tournament. For any two positive integers i, j with 1 ≤ i < j ≤ 2N, player i has a higher skill level than player j. Prior to the first round, the players are paired arbitrarily and each pair is assigned a unique court among N courts, numbered 1, 2, …, N. Olympiad Combinatorics 22 During a round, each player plays against the other person assigned to his court (so that exactly one match takes place per court), and the player with higher skill wins the match (in other words, there are no upsets). Afterwards, for i = 2, 3, …, N, the winner of court i moves to court (i – 1) and the loser of court i stays on court i; however, the winner of court 1 stays on court 1 and the loser of court 1 moves to court N. Find all positive integers M such that, regardless of the initial pairing, the players 2, 3, …, N+1 all change courts immediately after the Mth round. 12. [IMO 1993, Problem 3] On an infinite chessboard, a solitaire game is played as follows: at the start, we have n 2 pieces occupying a square of side n. The only allowed move is to jump over an occupied square to an unoccupied one, and the piece which has been jumped over is removed. For which n can the game end with only one piece remaining on the board? 13. [South Korea TST 2009] 2008 white stones and 1 black stone are in a row. A move consists of selecting one black stone and change the color of its neighboring stone(s). The goal is to make all stones black after a finite number of moves. Find all possible initial positions of the black stone for which this is possible. 14. [IMO Shortlist 1996, C7] A finite number of coins are placed on an infinite (in both directions) row of squares. A sequence of moves is performed as follows: at each stage a square containing more than one coin is chosen. Two coins are taken from this square; one of them is placed on the square immediately to the left while the other is placed on the square immediately to the right of the chosen square. The sequence terminates if at some point there is at most one coin on each square. Given some initial Chapter 3: Processes configuration, show that any legal sequence of moves will terminate after the same number of steps and with the same final configuration. 15. [IMO Shortlist 2010, C6] Given a positive integer k and other two integers b > w > 1. There are two strings of pearls, a string of b black pearls and a string of w white pearls. The length of a string is the number of pearls on it. One cuts these strings in some steps by the following rules. In each step: i. The strings are ordered by their lengths in a non- increasing order. If there are some strings of equal lengths, then the white ones precede the black ones. Then k first ones (if they consist of more than one pearl) are chosen; if there are less than k strings longer than 1, then one chooses all of them. ii. Next, one cuts each chosen string into two parts differing in length by at most one. The process stops immediately after the step when a first isolated white pearl appears. Prove that at this stage, there will still exist a string of at least two black pearls. Olympiad Combinatorics Pranav A. Sriram August 2014 Chapter 4: Existence 1 Copyright notices All USAMO and USA Team Selection Test problems in this chapter are copyrighted by the Mathematical Association of America’s American Mathematics Competitions. © Pranav A. Sriram. This document is copyrighted by Pranav A. Sriram, and may not be reproduced in whole or part without express written consent from the author. About the Author Pranav Sriram graduated from high school at The International School Bangalore, India, and will be a Freshman at Stanford University this Fall. Chapter 4: Existence 1 4. EXISTENCE The devil’s finest trick is to persuade you that he does not exist. -Charles Baudelaire Introduction In this chapter, we focus on problems asking us to determine whether objects satisfying certain conditions exist. We encountered these types of problems in Chapter One, and solved them by creating algorithms that explicitly constructed the required objects. First of all, note that this approach does not give us any way to solve problems that ask us to prove that something does not exist. In addition, even when we want to prove existence, it may not always be possible to explicitly construct the required object. In these situations, we turn to less direct proof techniques, which are existential rather than constructive. Some of the ideas in the first two chapters, such as induction, invariants and the extremal principle, can be adapted to provide non-constructive proofs. We will also introduce several new techniques in this chapter, including discrete continuity, divide and conquer strategies, the “hostile neighbors” trick, injective mappings and two very powerful variants of the extremal principle. A key theme that will pervade the examples in this chapter is the notion of proofs by contradiction, which the mathematician G. H. Hardy described as “one of a mathematician’s finest weapons”. Olympiad Combinatorics 2 Induction Our first example lies somewhere in between the inductive constructions of Chapter Two and the purely existential arguments of the rest of this chapter. Example 1 [IMO Shortlist 1985] A set of 1985 points is distributed around the circumference of a circle and each of the points is marked with 1 or -1. A point is called “good” if the partial sums that can be formed by starting at that point and proceeding around the circle for any distance in either direction are all strictly positive. Show that if the number of points marked with -1 is less than 662, there must be at least one good point. Answer: Note that 1985 = 3 x 661 + 2. This suggests that we try to show that for any n, if we have 3n+2 points and at most n (-1)s, then there will be a good point. The result is true for n = 1. Assume it is true for k. Now we are given 3(k+1) + 2 points, of which at most (k+1) are (-1)s. Take a chain of consecutive (-1)s, having at least one (-1) and surrounded by two 1s. For example, (1, -1, -1, -1, -1, 1) or 1, -1, 1. Such a chain exists unless there are no (-1)s at any point, in which case we are trivially done. Now delete one (-1) from the chain as well as the bordering 1s. For example, 1, -1, -1, - 1, 1 becomes -1, -1. Now we have 3k+2 points and at most k (-1)s, so by induction there is a good point P. Note that P is obviously not part of the chain of (-1)s. Hence P is good in our original configuration as well, since after we add back the deleted points, each partial sum starting from P either doesn’t change or increases by 1. ■ This was an example of “top-down” induction: we started from a configuration of 3(k + 1) + 2 points, then reduced it to a configuration of 3k+2 points by deleting 3 points. We saw top Chapter 4: Existence 3 down induction in the chapter on processes as well, where we broke down n × n boards into (n-1) × (n-1) boards with an extra row and column in order to use induction. On the other hand, if in the above example we had started with 3k+2 points and then added 3 points, it would be “bottom up” induction. When applying induction, often one of the two approaches will work much better than the other. In the above example a top down approach works better since we can choose which points to delete, whereas in a bottom up approach we wouldn’t be able to choose where to add the points (as this would lead to a loss of generality). The next example uses a potent combination of induction, the pigeonhole principle and contradiction: we will essentially use the pigeonhole principle to inductively construct a contradiction. Example 2 [IMO shortlist 1990] Assume that the set of all positive integers is decomposed into r (disjoint) subsets A1 ∪ A2 ∪ … ∪ Ar = N. Prove that one of them, say Ai has the following property: There exists a positive m such that for any k one can find numbers a1, a2, …, ak in Ai with 0 < aj+1 – aj ≤ m (1 ≤ j ≤ k-1). Answer: Call a set with the given property good. Assume to the contrary that none of the sets is good. We will use this assumption to prove by induction that for each s ≤ r, As ∪ As+1 ∪ … Ar contains arbitrarily long sequences of consecutive integers. For s = r this will imply that Ar is good, contradicting our assumption. A1 is not good, so for every k there exist k consecutive numbers not in A1. This means that A2 ∪ A3 ∪ … ∪ Ar contains arbitrarily long sequences of consecutive integers. Now suppose we have shown that As ∪ As+1 ∪ … Ar contains arbitrarily long sequences of consecutive integers. Since As is not good, for each m there exists a number km such that As doesn’t contain a sequence of km integers with consecutive terms differing by at most m. Now take mkm consecutive integers in As ∪ As+1 ∪ … An. If As contains fewer than Olympiad Combinatorics 4 km of these numbers, then by the pigeonhole principle there are m consecutive numbers in As+1 ∪ As+2 ∪ … An, proving the inductive step. Otherwise, if As contains at least km of the numbers, by the definition of km some two of them differ by at least m. The m numbers in between then belong to As+1 ∪ As+2 ∪ … An. Since m is arbitrary, this proves the inductive step. By the first paragraph, the proof is complete. ■ The Extremal Principle and Infinite descent The extremal principle basically says that any finite set of real numbers has a smallest and a largest element. “Extremal arguments” in combinatorics come in various forms, but the general idea is to look at objects that are extreme in some sense: smallest or largest numbers in a finite set, leftmost or rightmost points in combinatorial geometry problems, objects that are best or worst in a sense, etc. This provides a good starting point to solving complicated problems, since extremal objects are likely to satisfy certain restrictions and conditions that make them easy to analyze. Example 3 [France 1997] Each vertex of a regular 1997-gon is labeled with an integer such that the sum of the integers is 1. Starting at some vertex, we write down the labels of the vertices reading counterclockwise around the polygon. Is it always possible to choose the starting vertex so that the sum of the first k integers written down is positive for k = 1, 2, 3,…, 1997? Some Intuition: Let the vertices be V1, V2, …, V1997 in anticlockwise order. Suppose we place V1 at sea level, and for each Vi, define the altitude of Vi be equal to the altitude of Vi-1 plus the number at Vi. Then, if we start at Vj and walk around the polygon, the sum of all the integers we have encountered is the net gain or loss in our altitude. Obviously, if we start at the lowest point, we Chapter 4: Existence 5 can never have a net loss in altitude! In other words, the sum of numbers encountered can never be negative. (Note that this argument does not break down even when we cross from V1997 to V1, because since the sum of all numbers is 1, the sum of encountered numbers is actually even more than the net altitude gain.) Below we convert this intuitive proof to a more formal proof. Answer: Yes. Starting from V1, let the sum of the labels at the first k vertices in anticlockwise order be bk. Let m be the minimum of all the bk. Then take k such that bk = m (if there are many such k, take the largest such k). We claim that the vertex Vk+1 satisfies the required conditions. Indeed, if the sum of the labels from Vk+1 to Vj for some j > k+1 is negative, then the sum of the labels from V1 to Vj is strictly less than m, since the sum from V1 to Vj = sum from V1 to Vk + (sum from Vk to Vj) = m + (a negative number). This contradicts the minimality of m. The only other case is if j < k+1, in which case we get a similar contradiction after using the fact that the sum of the 1997 labels is positive (since it is given to be 1). ■ Remark: Another intuitive interpretation of this solution is as follows: If we have had extremely bad luck until Vk, then by the “law of averages”, we must have pretty good luck from there onwards. The existence of extremal objects enables us to reach contradictions using a technique known as infinite descent, which you may have seen in the famous proof of the irrationality of √ . This technique works as follows: suppose we want to show that no number in a finite set S satisfies a certain property P. We assume to the contrary that some number in S does satisfy P, and use this assumption to show that there exists an even smaller number in S satisfying P. This immediately yields a contradiction as follows: the argument shows that for any x1 in S satisfying P, we can find x2 in S Olympiad Combinatorics 6 satisfying P with x1 > x2. But repeating the same argument, we get a number x3 in S satisfying P with x2 > x3. We can continue this indefinitely, to get numbers x1 > x2 > x3 > x4 > … all in S and satisfying P. But S is finite, so we cannot have infinitely many numbers in S; contradiction. In the next example, infinite descent will provide a key lemma needed to solve the problem. Example 4 [Indian TST 2003] Let n be a positive integer and {A, B, C} a partition of (1, 2, 3, …, 3n) such that |A| = |B| = |C| = n. Prove that there exist x є A, y є B, z є C such that one of x, y, z is the sum of the other two. Answer: Assume to the contrary that there exists a partition that does not have this property. WLOG suppose that 1 є A. Let k be the smallest number not in A, and suppose WLOG that k B. Hence 1, …, k – 1 are all in A and k is in B. Hence: (i) No elements from C and A can differ by k (ii) No elements from B and C can differ by less than k, since 1, 2, …, k-1 are in A. In particular no elements from B and C can differ by 1. Let m be any element in C. By (ii), m-1 is not in B. What happens if m-1 is in C? First, m-k is not in A by (i). Further, m-k is not in B, since (m-1) – (m-k) = k-1, which is in A. So m-k must be in C. Also, m-k-1 is not in A, since (m-1) – (m-k-1) = k. By (ii), m-k-1 is not in B since m-k is in C. Hence m-k-1 is also in C. Thus starting with any pair of consecutive numbers in C, namely (m, m-1) we get a smaller pair, namely (m-k, m-k-1). This leads to an infinite descent, which is a contradiction. Hence if m is in C, m-1 has to be in A. Hence we have an injective correspondence between elements in C and elements in A. This correspondence must also be bijective (otherwise |A| > |C|, but we are given that |A| = |C| = n). Thus if t є A, t+1 є C. So 1 A implies 2 Chapter 4: Existence 7 C. This is a contradiction since we assumed that the smallest number not in A belongs to B. ■ Let us analyze the above proof. Essentially, we were given an abstract problem about sets and we simplified things by making a few assumptions. A natural starting point was to place 1 in one of the sets. Then using the extremal principle by assuming k was the least element not in A gave us some more structure. The infinite descent we used was almost accidental – even if we were not deliberately looking for an extremal argument, we were fortunate to find that given a pair of consecutive numbers in C, we could find a smaller such pair. These “accidental” infinite descents pop up very frequently in combinatorics, graph theory, number theory and algebra problems. So keep your eyes open while solving Olympiad problems – keep making observations, and you might just walk right into the solution! Example 5 [ELMO Shortlist 2012] Find all ordered pairs of positive integers (m, n) for which there exists a set C = {c1, c2, … ck) (k ≥ 1) of colors and an assignment of colors to each of the mn unit squares of an m × n grid such that for every color ci and unit square S of color ci, exactly two direct (non- diagonal) neighbors of S have color ci. Answer: If m and n are both even, then we can partition the board into 2 × 2 squares. Then color each 2 × 2 square with a different color. This clearly satisfies the problem’s conditions. Now suppose at least one of m and n is odd. WLOG suppose the width of the board is odd. Consider a horizontal chain of squares of the same color in the top row of the board of odd length. Define a good chain as a chain of squares of the same color C of odd length. For example, if the width is 7 and the top row consists of colors c1, c1, c4, c4, c4, c5, c5 then the 3 c4’s form a good chain. A good chain in the top row must exist since the width of the board Olympiad Combinatorics 8 is odd. Note that there can be no good chain of length 1 in the top row, since then that square will have at most one neighbor with the same color (the square below it). Now look at the set of squares below the good chain in the top row. Let the good chain in the top row be x, ci, ci, … ci, y where there are an odd number of ci’s flanked by two colors that are different from ci (or by edges of the board). There are no squares above this chain. Thus there are no squares of color ci directly above, left or right of the chain. The leftmost and rightmost ci have only one neighboring square that is of color ci; hence the squares below these two squares must have color ci. The squares below the other squares in our chain of ci’s cannot have color ci (since these squares of our chain already have exactly 2 neighbors with color ci). Thus the set of squares below our row of ci’s must be of the form ci, X, Y, Z, …, W, ci where W, X, Y, Z stand for any colors other than ci. An example is shown below. X ci ci ci ci ci ci ci Y ci c5 c4 c4 c4 c3 ci There are an odd number of squares between the two ci’s in the second row. Hence among these squares we can find a chain of odd length of squares having the same color ck (different from ci). Furthermore this chain is of smaller length than our original chain. Since all the squares above this chain are of color ci, which is different from ck, the new chain is bordered on 3 sides by squares not having color ck, which is just like the first good chain. Hence we can repeat the above argument to obtain an even smaller good chain, obtaining a descent. We obtain smaller and smaller good chains until finally we get a good chain of length 1. This is a contradiction, because we would then have a single square bordered on three sides by squares of other colors, and it would hence have at most one neighbor of the same color. ■ Chapter 4: Existence 9 Optimal Assumption Assume first, ask questions later Now we turn to an idea related to the extremal principle that I call the “optimal assumption” method. Suppose we want to find a set of size at least X satisfying some condition. Instead of constructing such a set using an algorithm, we merely prove its existence. We take the largest set S satisfying the required condition, and then use the assumption that S is as large as possible to prove that |S| must be at least X. Here is a simple example to demonstrate this idea. Example 6 In a graph G, suppose all vertices have degree at least δ. Show that there exists a path of length at least δ + 1. Answer: Take the longest possible path (optimal assumption) and let v be its last vertex. By the assumption that this is the longest possible path, we cannot extend the path any further. This means that all of v’s neighbors must already lie in the path. But v has at least δ neighbors. Thus the path must contain at least δ + 1 vertices (v and all of its neighbors). ■ The next example shows the true power of this approach. Example 7 [Italy TST 1999] Let X be an n-element set and let A1, A2, …, Am be subsets of X such that: (i) |Ai| = 3 for i = 1, 2, …, m (ii) |Ai Aj| 1 for any two distinct indices i, j. Show that there exists a subset of X with at least ⎿√ ⏌elements which does not contain any of the Ai’s. (Note: Here ⎿⏌ denotes the floor function). Olympiad Combinatorics 10 Answer: Call the elements of X b1, b2, …, bn. Let S be the largest subset of X not containing any of the Ai’s. Let |S| = k. We want to show that k ⎿√ ⏌. Now comes the crucial observation. For any element x in X but not in S, there exists a pair of elements {y, z} in S such that {x, y, z} = Ai for some i. Otherwise we could add x to S, and the new set would still not contain any set Ai, contradicting our assumption that S is the largest set satisfying this property. Thus we can construct a mapping from elements in X \\ S to pairs of elements in S such that the element in X \\ S together with the pair of elements it is mapped to forms one of the sets Ai. Moreover, it cannot happen that two distinct elements in X \\ S are mapped to the same pair of elements. If this happened, say x1 and x2 were both mapped to {y, z}, then {x1, y, z} = Ai and {x2, y, z} = Aj for some i and j, and then |Ai Aj|= 2. This violates condition 2 of the problem. Thus the mapping we have constructed is injective. This implies that the number of elements in X \\ S is cannot exceed the number of pairs of elements in S. Hence we get (n – k) ( ). This simplifies to k2 + k 2n, and from this the result easily follows (remember that k is an integer). ■ Example 8 Show that it is possible to partition the vertex set V of a graph G on n vertices into two sets V1 and V2 such that any vertex in V1 has at least as many neighbors in V2 as in V1, and any vertex in V2 has at least as many neighbors in V1 as in V2. Answer: What properties would such a partition have? Intuitively, such a partition would have lots of ‘crossing edges’, that is, edges joining a vertex in V1 to a vertex in V2. This suggests the following idea: Take the partition maximizing the number of crossing edges. We claim that such a partition satisfies the problem conditions. Chapter 4: Existence 11 Suppose it doesn’t. Suppose there is a vertex v in V1 that has more neighbors in V1 than in V2. Consider a new partition V1’ = V1 \\ {v}, V2’ = V2 ∪ {v} (in other words, we have just moved v from V1 to V2). This has more crossing edges than the original partition by the assumption on v. This contradicts our earlier assumption that we took the partition maximizing the number of crossing edges. Hence the initial partition indeed works. ■ Remark 1: A partition of the vertices into two sets is known as a cut. The partition maximizing the number of crossing edges is known as a max cut. Remark 2: The algorithmic problem of efficiently finding maximum or minimum cuts in general graphs is very difficult. Algorithms for finding approximate solutions to these and related problems have been extensively studied, and a rich combinatorial theory surrounding cuts, flows (the “dual” of a cut) and multicuts and multiway cuts (generalizations of cuts) has been developed. Several problems in this field remain open. Invariants (Again. Some things just don’t change.) Example 9 [Italy TST 1995] An 8 × 8 board is tiled with 21 trominoes (3 × 1 tiles), so that exactly one square is not covered by a tromino. No two trominoes can overlap and no tromino can stick out of the board. Determine all possible positions of the square not covered by a tromino. Answer: The idea is to color the board in 3 colors, such that each tromino covers one square of each color. The figure shown below demonstrates such a coloring, where 1, 2, 3 denote 3 colors. Olympiad Combinatorics 12 1 2 3 1 2 3 1 2 2 3 1 2 3 1 2 3 3 1 2 3 1 2 3 1 1 2 3 1 2 3 1 2 2 3 1 2 3 1 2 3 3 1 2 3 1 2 3 1 1 2 3 1 2 3 1 2 2 3 1 2 3 1 2 3 Figure 4.1: Coloring of the board Since any tromino covers one square of each color, in total exactly 21 squares of each color will be covered. However, in the figure there are 22 2s, 21 1s and 21 3s. So the uncovered square would contain a 2. Now for my favorite part: symmetry. Suppose we take the initial coloring and create a new coloring by reflecting the board across its vertical axis of symmetry. For example, the top row of the board would now be colored 2, 1, 3, 2, 1, 3, 2, 1- the same coloring “backwards”. In the new coloring also, the uncovered square should be colored with the number 2. So the uncovered square should be colored by a 2 in both colorings. The only such squares are the ones underlined in the figure, since when one of these 2s is reflected in the vertical axis the image is on another 2. Thus we have 4 possible positions of the uncovered square. To construct a tiling that works for these positions, first tile only the inner 4 × 4 square with one corner missing, and then tile the outer border. ■ Chapter 4: Existence 13 The Hostile Neighbors Principle (Yes, I made that name up) Suppose we have n objects, A1, A2, …, An. Suppose some of these objects are of type one, and the rest are of type two. Further suppose that there is at least one object of each type. Then there exists an index i such that Ai and Ai+1 are of opposite type. This statement is obvious, but as the next two examples demonstrate, it is surprisingly powerful. Example 10 [Redei’s theorem] A tournament on n vertices is a directed graph such that for any two vertices u and v, there is either a directed edge from u to v or from v to u. Show that in any tournament on n vertices, there exists a (directed) Hamiltonian path. (Note: a Hamiltonian path is a path passing through all the vertices. In other words we need to show that we can label the vertices v1, v2, …, vn such that for each i, 1 ≤ i ≤ n-1, there is a directed edge from vi to vi+1.) Answer: Figure 4.2: Illustration of how to extend the path to include V We use induction on n, with the base cases n = 1, 2 and 3 being trivial. Suppose the result is true for n-1 vertices. Delete a vertex and form a Hamiltonian path with the remaining n-1 vertices. Let the path be v1  v2  v3  …  vn-1. Let the remaining vertex be v. V1 V2 V3 Vk Vk+1 Vn V . . . . . . Olympiad Combinatorics 14 If vn-1  v, we are done, since we get the path v1  v2  v3  …  vn-1  v. Similarly if v  v1 we are done. So suppose v  vn-1 and v1  v. Hence there must be an index k such that vk  v and v  vk+1. Then the path v1  v2  … vk  v  vk+1…  vn-1 is a Hamiltonian path and we are done. ■ The next example demonstrates the true power of this idea. Example 11 [IMO shortlist 1988] The numbers 1, 2, … , n 2 are written in the squares of an n × n board, with each number appearing exactly once. Prove that there exist two adjacent squares whose numbers differ by at least n. Answer: Assume to the contrary that there exists a labeling such that the numbers in any pair of adjacent squares differ by at most n-1. Let Sk = {1, …, k} for each k ≥ 1. Let Nk = {k+1, k+2, … , k+n-1}. These are the numbers that can possibly neighbor a number in Sk. Let Tk = {k+n, k+n+1, …, n 2 }. No number from Sk can be next to a number from Tk. For each k, since |Nk| = n-1, there exists a row that contains no element of Nk. Similarly there exists a column containing no element of Nk. The union of this row and this column must contain either only elements from Sk or only elements from Tk, otherwise some element of Sk would be next to an element of Tk. Call the union of this row and column a cross. For k = 1, the cross cannot contain only elements from Sk (since there are 2n-1 squares in the cross and only one element in S1). Thus this cross contains only elements from Tk. But for k = n 2–n, the cross will contain only elements from Sk, as has only one element. Hence from some j with 1 ≤ j < n 2 – n, the cross formed due to Nj will have elements only from Tk but the cross formed due to Nj+1 will have elements only from Sj+1. But these crosses Chapter 4: Existence 15 intersect at two squares. The numbers in these two squares belong to both Sj+1 and Tj. This is a contradiction since Sj+1 ⋂ j = Ø. ■ Figure 4.3: The black squares illustrate a contradiction as they cannot simultaneously belong to Tj and Sj+1. Divide and Conquer In the next example, we use the following idea: we are asked the minimum number of tiles needed to cover some set of squares. What we do is that we take a certain subset of these squares, such that no tile can cover more than one of these squares. Then clearly we need at least as many tiles as the number of squares in our subset, which gives us a good bound. This type of idea is frequently used in tiling problems as well as in other combinatorics problems asking for bounds of some sort. Example 12 [IMO shortlist 2002, C2] For n an odd positive integer, the unit squares of an n × n chessboard are colored alternately black and white, with the four corners colored black. An L-tromino is an L-shape formed by three connected unit squares. For which values of n is it possible to Olympiad Combinatorics 16 cover all the black squares with non-overlapping L-trominoes? When it is possible, what is the minimum number of L-trominoes needed? Figure 4.4: An L-tromino Answer: Let n = 2k+1. Consider the black squares at an odd height (that is, in rows 1, 3, 5, …, n). The key observation is that each L-tromino can cover at most one of these squares. There are (k+1) 2 such squares, so at least (k+1) 2 L-trominoes are needed. These L- trominoes cover a total of 3(k+1)2 squares. For n = 1, 3 or 5 this exceeds n 2 so we require n ≥ 7 and at least (k+1)2 = L- trominoes. To construct tilings, induct with step 2. The base case 7 is left to the reader (do it systematically: start with the corners and then keep covering black squares of odd height). Given a 2k+1 × 2k+1 board, divide it into the top left (2k-1) × (2k-1) board along with a border of thickness 2. The (2k-1) × (2k-1) board can be tiled with k2 tiles by induction. Now tile the border with 2k+1 squares (this is left to the reader again). This shows that (k+1) 2 L-trominoes are sufficient, so the answer is n ≥ 7 and (k+1) 2 L-trominoes are necessary and sufficient. Discrete Continuity The following example uses an idea known as discrete continuity that is very similar to the hostile neighbors principle. Discrete continuity is a very intuitive concept: basically, suppose in a sequence of integers, each pair of consecutive terms differ by at Chapter 4: Existence 17 most 1. Then if a and b are members of the sequence, all integers between a and b will necessarily be members of the sequence. For instance, if 2 and 5 are in the sequence, then 3 and 4 must be as well. In particular, if we have such a sequence containing both a positive and a negative term, the sequence must contain 0 at some point. Such sequences where consecutive terms differ by at most one arise very often in combinatorics, and several problems can be solved by exploiting this “discrete continuity”. Example 13 [USAMO 2005, Problem 5] Let n be an integer greater than 1. Suppose 2n points are given in the plane, no three of which are collinear. Suppose n of the given 2n points are colored blue and the other n colored red. A line in the plane is called a balancing line if it passes through one blue and one red point and, for each side of the line, the number of blue points on that side is equal to the number of red points on the same side. Prove that there exist at least two balancing lines. Answer: Take the convex hull of the 2n points. If it contains points of both colors, then there will be two pairs of adjacent points in the hull that are of different colors. Take the two lines through these two pairs of points. There will be 0 points on one side and n-1 points of each color on the other side, so we are done. From now suppose the convex hull contains points of only 1 color, WLOG blue. Take a point P that is part of this convex hull. Take a line L through P, such that all other points lie on the same side of L (this is possible since P lies on the convex hull). Now rotate L clockwise and let R1, R2, … Rn be the red points in the order in which they are encountered. Let bi be the number of blue points encountered before Ri (excluding P) and ri be the number of red points encountered before Ri (hence ri = i-1). Let f(i) = bi – ri and note that f(i) = 0 if and only if PRi is a balancing line. Also f(1) = b1 – 0 ≥ 0 and f(n) = bn – (n-1) ≤ 0, since bn is at most n-1. Thus f(i) goes from nonnegative to nonpositive as i goes from 1 to n. Olympiad Combinatorics 18 Furthermore, f can decrease by at most 1 when going from i to i+1, since ri increases by only 1. Hence at some point f becomes 0, and we get a balancing line through P. Repeating this argument for each point on the convex hull, we get balancing lines for each point on the convex hull, so we get at least 3 balancing lines in this case (there are at least 3 points on the convex hull), so we are done. ■ Figure 4.5: A balancing line for f(i) = 0 Miscellaneous Examples (Because I ran out of imaginative names) Example 14 [Romania 2001] Three schools each have 200 students. Every student has at least one friend in each school (friendship is assumed to be mutual and no one is his own friend). Suppose there exists a set E of 300 students with the following property: for any school S and two students x, y E who are not in school S, x and y do not have the same number of friends in S. Prove that there exist 3 students, one in each school, such that any two are friends with each other. i-1 blue points i-1 red points n-i red points n-i blue points P Ri Chapter 4: Existence 19 Answer: Let S1, S2, S3 be the sets of students in the three schools. Since there are 300 students in E, one of the schools must have at most 300/3 = 100 students in E. WLOG let |S1 ⋂ | ≤ 100. Then consider the 200 or more students in E \\ S1. Each of these students has at least one at and most 200 friends in S1, and moreover no two of them have the same number of friends in S1 (by the conditions of the problem and the condition on E). This implies that exactly one of them has 200 friends in S1. Let this student by X, and assume WLOG that X is in S2. Then X has a friend Y in S3 and Y has a friend Z in S1 (everyone has at least one friend in each school). But Z and X are friends since Z is friends with everyone in S1. So (X, Y, Z) is our required triple and we are done. ■ Example 15 [IMO shortlist 1988] Let n be an even positive integer. Let A1, A2, …, An+1 be sets having n elements each such that any two of them have exactly one element in common while every element of their union belongs to at least two of the given sets. For which n can one assign to every element of the union one of the numbers 0 and 1 in such a manner that each of the sets has exactly n/2 zeros? Answer: Let n = 2k. Observe that any set Aj has 2k elements and intersects each of the other 2k sets in exactly one element. Hence each of the 2k elements in Aj belongs to at least one of the other 2k sets but each of the 2k sets contains at most one element from Aj. This implies that each of the 2k elements of Aj belongs to exactly one other set. This holds for each j, so every element in the union of the sets belongs to exactly two sets and any two sets intersect in exactly one element. Now suppose we count the number of elements labeled 0. Each set contains k zeros and there are 2k+1 sets. But each element labeled 0 is in two sets, and if we simply multiplied k and 2k+1 we would be counting each element twice. So the total number of Olympiad Combinatorics 20 elements labeled 0 will be k(2k+1)/2. This quantity must be an integer, so k must be divisible by 2. Hence n must be divisible by 4. To show that such a coloring indeed exists when n is divisible by 4, incidence matrices provide an elegant construction. Incidence matrices will be introduced in the chapter on counting in two ways, and the rest of the proof of this example is left as an exercise in that chapter. ■ Example 16 [IMO shortlist 2001 C5] Find all finite sequences x0, x1, x2, … , xn such that for every j, 0 ≤ j ≤ n, xj equals the number of times j appears in the sequence. Answer: The terms of such a sequence are obviously nonnegative integers. Clearly x0 > 0, otherwise we get a contradiction. Suppose there are m nonzero terms in the sequence. Observe that the sum x1 + x2 … + xn counts the total number of nonzero terms in the sequence; hence x1 +… +xn = m. One of the nonzero terms is x0, so there are exactly m-1 nonzero terms among x1, x2, …, xn. These m-1 nonzero terms add up to m, so m-2 of these terms are equal to 1 and one term is equal to 2. This means that no term of the sequence is greater than two, except possibly x0. Hence at most one of x3, x4, … can be positive (For example, if x0 = 4, then x4 will be positive since 4 appears in the sequence). Thus the only terms that can be positive are x0, x1, x2 and at most one xk with k > 2. It follows that m ≤ 4. Also m =1 is impossible. So we have 3 cases: (i) m = 2. Then there are m-2 = 0 1s and one 2 among the terms x1, x2, … xn. Hence x2 = 2 (as x1 = 2 is impossible) and the sequence is (2, 0, 2, 0). (ii) m = 3. Either x1 = 2 or x2 = 2. These cases give the sequences (1, 2, 1, 0) and (2, 1, 2, 0, 0) respectively. (iii) m = 4. Then the positive terms are x0, x1, x2 and xk for some k > 2. Then x0 = k and xk = 1. There are m-2 = 2 1s so x1 = 2, and hence x2 = 1. The final sequence is (k, 2, 1, 0, …., 0, 1, 0, 0, 0), Chapter 4: Existence 21 where there are k 0s between the two 1s. Hence the sequences listed in (i), (ii) and (iii) are the only possible sequences and we’re done. ■ Exercises 1. [Russia 2001] Yura put 2001 coins of 1, 2 or 3 kopeykas in a row. It turned out that between any two 1-kopeyka coins there is at least one coin; between any two 2-kopeykas coins there are at least two coins; and between any two 3-kopeykas coins there are at least 3 coins. Let n be the number of 3-kopeyka coins in this row. Determine all possible values of n. 2. [Indian TST 2001] Given that there are 168 primes between 1 and 1000, show that there exist 1000 consecutive numbers containing exactly 100 primes. 3. [Canada 1992] 2n+1 cards consists of a joker and, for each number between 1 and n inclusive, two cards marked with that number. The 2n+1 cards are placed in a row, with the joker in the middle. For each k with 1 ≤ k ≤ n, the two cards numbered k have exactly (k–1) cards between them. Determine all the values of n not exceeding 10 for which this arrangement is possible. For which values of n is it impossible? 4. [IMO 1997-4] An n × n matrix whose entries come from the set S = {1, 2, …, n} is called a silver matrix if, for each i = 1, 2, …, n, the i-th row and the i-th column together contain all elements of S. Show that: Olympiad Combinatorics 22 a) there is no silver matrix for n = 1997; b) silver matrices exist for infinitely many values of n. 5. [Russia 1996] Can a 5 × 7 board be tiled by L-trominoes (shown in the figure below) with overlaps such that no L-tromino sticks out of the board, and each square of the board is covered by the same number of L-trominoes? An L-tromino 6. IMO Shortlist 2011, C2] Suppose that 1000 students are standing in a circle. Prove that there exists an integer k with 100 ≤ k ≤ 300 such that in this circle there exists a contiguous group of 2k students, for which the first half contains the same number of girls as the second half. 7. [Bulgaria 2001] Let n be a given integer greater than 1. At each lattice point (i, j) we write the number k in {0, 1, …, n-1} such that k (i+j) mod n. Find all pairs of positive integers (a, b) such that the rectangle with vertices (0,0), (a, 0), (a, b) and (0, b) has the following properties: (i) Each number 0, 1, …, n-1 appears in its interior an equal number of times (ii) Each of these numbers appear on the boundary an equal number of times 8. [Russia 1998] Each square of a board contains either 1 or -1. Such an arrangement is called successful if each number is the product of its neighbors. Find the number of successful arrangements. Chapter 4: Existence 23 9. [IMO Shortlist 2010, C3] 2500 chess kings have to be placed on a 100 × 100 chessboard so that i. no king can capture any other one (i.e. no two kings are placed in two squares sharing a common vertex); ii. each row and each column contains exactly 25 kings. Find the number of such arrangements. (Two arrangements differing by rotation or symmetry are supposed to be different.) 10. [Russia 2011] There are some counters in some cells of 100 × 100 board. Call a cell nice if there are an even number of counters in adjacent cells. Is it possible for there to exist exactly one nice cell? 11. [Bulgaria 1997] A triangulation of a convex n-gon is a division of the n-gon into triangles by diagonals with disjoint interiors. Call a triangulation even if each vertex of the n-gon is the endpoint of an even number of diagonals. Determine all natural numbers n for which an even triangulation of an n-gon exists. 12. [India Postal Coaching 2011] On a circle there are n red and n blue arcs given in such a way that each red arc intersects each blue one. Prove that there exists a point contained by at least n of the given colored arcs. 13. Call a rectangle integral if at least one of its dimensions is an integer. Let R be a rectangle such that there exists a tiling of R with smaller integral rectangles with sides parallel to the sides of R. Show that R is also integral. 14. [IMO Shortlist 1999, C6] Suppose that every integer has been given one of the colors red, blue, green or yellow. Let x and y be odd integers so that |x| ≠ |y|. Show that there are two integers of the same color Olympiad Combinatorics 24 whose difference has one of the following values: x, y, (x+y) or (x-y). 15. [China TST 2011] Let l be a positive integer, and let m, n be positive integers with m ≥ n, such that A1, A2, …, Am, B1, B2, …, Bn are (m+n) pairwise distinct subsets of the set {1, 2, …, l}. It is known that Ai Δ Bj are pairwise distinct, for each 1 ≤ i ≤ m, 1 ≤ j ≤ n, and run over all nonempty subsets of {1, 2, …, l}. Find all possible values of (m, n). 16. [IMO 1996, Problem 6] Let p, q, n be three positive integers with p+q < n. Let (x0, x1, …, xn) be an (n+1)-tuple of integers satisfying the following conditions: : (a) x0 = xn = 0, and (b) For each i with 1 ≤ i ≤ n, either xi – xi-1 = p or xi – xi-1 = -q. Show that there exist indices i < j with (i, j) ≠ (0, n) such that xi = xj. 17. [IMO 2004, Problem 3] Define a hook to be a figure made up of six unit squares as shown below in the picture, or any of the figures obtained by applying rotations and reflections to this figure. Determine all m × n rectangles that can be tiled with hooks without gaps, overlaps, and parts of any hook lying outside the rectangle. A hook Olympiad Combinatorics Pranav A. Sriram August 2014 Chapter 5: Combinatorial Games 1 Copyright notices All USAMO and USA Team Selection Test problems in this chapter are copyrighted by the Mathematical Association of America’s American Mathematics Competitions. © Pranav A. Sriram. This document is copyrighted by Pranav A. Sriram, and may not be reproduced in whole or part without express written consent from the author. About the Author Pranav Sriram graduated from high school at The International School Bangalore, India, and will be a Freshman at Stanford University this Fall. Chapter 5: Combinatorial Games 1 5. COMBINATORIAL GAMES I’m afraid that sometimes, you’ll play lonely games too. Games you can’t win ‘cause you’ll play against you. -Doctor Seuss Introduction In this chapter, we study combinatorial games involving two players. Typical problems describe a game, and ask us to find a winning strategy for one of the players or determine whether one exists. As in problems in the chapters on algorithms and processes, games are specified by a starting position, allowed move(s) and the final or winning position. These and other attributes make problems in this chapter seem superficially similar to those in the first three chapters, but a fundamental difference is that our algorithms or strategies now need to compete against those of an opponent. Some of the techniques we will develop in this chapter are hence significantly different from earlier ones. One simple yet surprisingly powerful technique we use is exploiting symmetry. Olympiad Combinatorics 2 Others include coloring and invariants, recursion, induction, parity and a very important technique we will introduce known as positional analysis. The term “combinatorial games” is generally used to describe games with the following characteristics: (i) There are no elements of luck or chance (so no dice rolling or coin flipping involved). (ii) There is usually perfect information, unlike in card games, where I cannot see your hand (unless I peak). (iii) Players typically move alternately. In this chapter, all our games are played by Alice and Bob, whom we refer to as A and B respectively. In general A starts. (iv) There is no cheating (unfortunately). One more thing we will use frequently is that if a game is finite and does not have ties, then someone has to eventually lose. Because of the perfect information property and the absence of probabilistic elements, one player will hence have a winning strategy. In particular, one concept we will use frequently to develop strategies is that if one player can ensure that he always “stays alive”, the other player will eventually lose. Symmetry, Pairing and Copying They said no cheating, but we can still copy! This section is devoted to the very important technique of “copycat strategies” and pairing techniques. The next few examples should illustrate what these techniques are about. Example 1 A and B each get an unlimited supply of identical circular coins. A Chapter 5: Combinatorial Games 3 and B take turns placing the coins on a finite square table, in such a way that no two coins overlap and each coin is completely on the table (that is, it doesn’t stick out). The person who cannot legally place a coin loses. Assuming at least one coin can fit on the table, prove that A has a winning strategy. Answer: A first places a coin such that its center is at the center of the table. Then whenever B places a coin with center at a point X, A places a coin with center at the point X’, where X’ is the reflection of X in the center of the table. This ensures that after each of A’s moves, the board is completely symmetrical. Thus if B can make a legal move, then by symmetry, A’s next move is also legal. Since the area of the table is finite, eventually the game must terminate and someone must lose. Since A can always “stay alive”, B loses. ■ Example 2 [Saint Petersburg 1997] The number N is the product of k different primes (k ≥ 3). A and B take turns writing composite divisors of N on a board, according to the following rules. One may not write N. Also, there may never appear two coprime numbers or two numbers, one of which divides the other. The first player unable to move loses. If A starts, who has the winning strategy? Answer: A has a winning strategy. A first writes pq for some primes p and q dividing N. Then all the subsequent numbers written must be of the form pm or qm for some m dividing N, by the conditions of the problem. Whenever B writes qm, A writes qn. This “copying strategy” ensures that A always has a move. Since the game is finite (N has a finite number of divisors), A will eventually win. ■ Example 3 [USAMO 2004 – 4] Alice and Bob play a game on a 6 × 6 grid. On his or her turn, a player chooses a rational number not yet appearing in the grid and writes it in an empty square of the grid. Alice goes first and then the players alternate. When all of the squares have numbers Olympiad Combinatorics 4 written in them, in each row, the square with the greatest number in that row is colored black. Alice wins if she can then draw a path from the top of the grid to the bottom of the grid that stays in black squares, and Bob wins if she can’t. (A path is a sequence of squares such that any two consecutive squares in the path share a vertex). Find, with proof, a winning strategy for one of the players. Answer: X X X X X X X X X X X X X X X X X X Figure 5.1 B has a winning strategy. The idea is to ensure that the largest number in each row is in one of the squares marked X in Figure 5.1. Then clearly there will be no path and B will win. To do this, B pairs each square marked with an X with a square not marked with an X in the same row. Whenever A plays in a square marked with an X, B writes a smaller number in the paired square. Whenever A writes a number in a square not having an X, B writes a larger number in the paired square. This ensures that after each of B’s moves, the largest number in each row is in one of the squares marked with an X. ■ Example 4 [Tic Tac Toe for mathematicians] On a 5 × 5 board, A and B take turns marking squares. A always writes an X in a square and B always writes O. No square can be marked twice. A wins if she can make one full row, column or diagonal contain only Xs. Can B prevent A from winning? Chapter 5: Combinatorial Games 5 Answer: Yes. Mark the board as shown. 5 9 11 9 6 8 1 1 2 7 12 4 2 12 8 4 3 3 7 6 10 11 10 5 Figure 5.2: Squares with equal numbers are paired Since each number from 1 to 12 appears in 2 squares, B can ensure that he always marks at least one square of each number (if A marks an X in a square with number i, B puts an O in the other square marked i). Observe that each row, column and diagonal contains a pair of squares having equal numbers. Since B ensures that at least one number in each pair is marked, each row, column and diagonal would have been marked by B at least once. ■ Remark 1: This is one of those solutions that initially appears to come out of nowhere, but actually has a very intuitive explanation. Here’s one way of thinking about it. There are 5 columns, 5 rows and 2 diagonals, for a total of 12 “winning lines”. We can only make 12 pairs of numbers (since there are 25 squares and 12 x 2 = 24). Thus our idea is to construct a pairing strategy such that each row, column and diagonal is covered by exactly one pair. In this example, a natural way to construct the pairing is to start with the inner 3 x 3 square, covering its border, and then fill the outer layer, ensuring that the remaining winning lines are taken care of. Remark 2: The game of tic-tac-toe can be generalized to getting k squares in a row on an m × n board (regular tic-tac-toe has k = m = n = 3 and this problem has k = m = n = 5). For most values of k, m and n, the question of whether there exists a winning strategy for Olympiad Combinatorics 6 the starting player remains an open problem. In addition, the game of tic-tac-toe in higher dimensions (such as on 3-D cubes or in general, n-dimensional hyperspaces) has strong connections to a branch of extremal combinatorics known as Ramsey theory. Example 5 [IMO Shortlist 1994, C1] A and B play alternately on a 5 × 5 board. A always enters a 1 into an empty square, and B always enters a 0 into an empty square. When the board is full, the sum of the numbers in each of the nine 3 × 3 squares is calculated and A's score S is the largest such sum. What is the largest score A can make, regardless of the responses of B? Answer: D D D D D D D D D D Figure 5.3: A pairing strategy for B Tile the board with 10 dominoes (marked D in the figure), leaving the bottom row untiled. B can ensure that each domino contains at least one 0, since whenever A plays in a domino B writes a 0 in the other square. Each 3 × 3 square has at least 3 full dominoes, and hence will have at least three 0s. Thus B can ensure that S is at most 6. Now we leave it to the reader to show that A can ensure that S is at least 6. ■ Parity Based Pairing We solved the last few examples by explicitly constructing pairing Chapter 5: Combinatorial Games 7 strategies. But all we actually need to do sometimes is prove the existence of a pairing strategy. This is often remarkably easy- observe that if there are an even number of objects, there exists a way to pair them up. Example 6 [Based on Italy TST 2009, problem 6] A and B play the following game. First A writes a permutation of the numbers from 1 to n, where n is a fixed positive integer greater than 1. In each player’s turn, he or she must write a sequence of numbers that has not been written yet such that either: a) The sequence is a permutation of the sequence the previous player wrote, OR b) The sequence is obtained by deleting one number from the previous player’s sequence For example, if A first writes 4123, B could write 3124 or 413. The player who cannot write down a sequence loses. Determine who has the winning strategy. Answer: If n = 2, B wins: after A’s first move, B deletes the number 2 and is left with the sequence {1}. Then A has no move. The idea now is to construct an inductive strategy for B. Suppose B wins for n = k; we now want a strategy for n = k+1. B’s aim is to make A be the first player to delete a number from the sequence. Then from this point the game is reduced to a game with k numbers, and B will win this by induction. But this is very easy to do – whenever A writes a sequence of k+1 numbers, there will always exist at least one permutation of the k+1 numbers that has not been written yet, simply because the total number of permutations is even ((k+1)! is even). ■ Remark: You can also use an explicit pairing strategy. One example is that whenever A writes a sequence, B writes the same sequence backwards. Olympiad Combinatorics 8 Example 7 [USAMO 1999-5] The Y2K Game is played on a 1 × 2000 grid as follows. Two players in turn write either an S or an O in an empty square. The first player who produces three consecutive boxes that spell SOS wins. If all boxes are filled without producing SOS then the game is a draw. Prove that the second player has a winning strategy. Answer: Call an empty square bad if playing in that square will let the other player form SOS in the next turn. We claim that an empty square is bad if and only if it is in a block of 4 squares of the form S_ _ S. It is easy to see that both these empty squares are bad, as playing either S or O will allow the other player to form SOS. Conversely, if a square is bad, then playing an O in it will allow the other player to win, so it must have an S next to it and an empty square on the other side. Also, playing an S in a bad square allows the other player to win, so there must be another S beyond the empty square. This forces the configuration to be S_ _S, proving our claim. Now after A’s first move, B writes an S at least 4 squares away from either end of the grid and A’s first move. On B’s second move, he writes S three squares away from his first S so that the two squares in between are empty. These two squares are bad. Note that at any point in the game there will always be an even number of bad squares (since they come in pairs, by our claim above). So whenever it is B’s turn, an odd number of moves would have been made, so an odd number of squares would be empty, of which an even number would be bad. Hence there will always be at least one square that is not bad on B’s turn, so B won’t lose. Eventually the game will end since there are at least 2 bad squares, so B must win. ■ Chapter 5: Combinatorial Games 9 Positional Analysis Heads I win, tails you lose. For the rest chapter, we will use the following convention: a position in a game is a P-position if the player who has just played can force a win (that is, if he has a winning strategy). A position is called an N-position if the player whose turn it is can force a win. P and N respectively stand for Player and Next player. This means that the starting player has a winning strategy if and only if the initial position of a game is an N-position (he is the “next player” as it is his turn at the start of the game). The second player has a winning strategy if and only if the initial position is a P-position (even though the game has not yet begun, by convention, he is the player who has “just played”, since it is not his turn). Our definition of P- and N-positions also implies the following: From an N-position, the player whose turn it is can move into a P- position. In other words, the player who has a winning strategy can move to a position in which he still has a winning strategy. From a P-position, the player whose turn it is must move into an N-position. The winning strategy for a player is to always move to P-positions. Example 8 A and B play a game as follows. First A says 1, 2 or 3. Then B can add 1, 2 or 3 to the number the first player said. The game continues with the players playing alternately, in each turn adding 1, 2 or 3 to the previous number. For example, A can say 2, then B can say 5, then A could say 6, and so on. The player who says 100 wins. Who has the winning strategy? Olympiad Combinatorics 10 Answer: Observe that B can always say a multiple of 4 in his turn. For example, consider the following sequence of moves: A-1; B-4; A-6; B-8 and so on. Regardless of what A says, B can always say a multiple of 4. This is fairly obvious, but if you want to be more rigorous you can prove it by induction – if B says 4k then A says 4k+1, 4k+2 or 4k+3, and in all cases B can say 4k+4. Hence B will say 100 and will win. ■ Remark 1: Let’s analyze this proof. First of all, how would one come up with it? One idea is to work backwards. Clearly the player who says 100 wins. Hence 100 is a P-position – the person who has just played wins. Then 99, 98 and 97 are N-positions as the next player can reach 100 from these positions. But 96 is a P- position, since from 96 only N-positions can be reached (97, 98 and 99). Continuing in this manner, we see that every multiple of 4 is a P-position, so the winning strategy is to always play multiples of 4. This type of analysis of P- and N-positions will be the central idea in the rest of this chapter. Remark 2: This game can be generalized- instead of 1, 2, or 3 we can allow a player to increase the number by 1, 2, …, or k for any positive integer k and we can replace 100 by n. If k+1 divides n, then all multiples of k+1 are P-positions, so 0 is a P-position and B has a winning strategy. Otherwise, suppose n ≡ r mod (k+1). Then all numbers that are congruent to r mod k+1 are P-positions, and A has a winning strategy by saying r in her first move. Note: In several problems, we will use arguments of the form “If one player does this, then the other player does that, then the first player does this…”. In order to avoid referring to the players as “one” or “the other” or the particularly ambiguous “the first player”, we will use X and Y in these situations. X could refer to either of the players A and B, and Y refers to the other one. (On the other hand this precludes the usage of personal pronouns… writing a book is just frustrating sometimes.) Chapter 5: Combinatorial Games 11 Example 9 [Lithuania 2010] In an m × n rectangular chessboard there is a stone in the lower leftmost square. A and B move the stone alternately, starting with A. In each step one can move the stone upward or rightward any number of squares. The player who moves it into the upper rightmost square wins. Find all (m, n) such that A has a winning strategy. Answer: For convenience, lets flip the board upside down so that the stone starts in the upper rightmost square and the player who moves it to the lower leftmost square wins. All moves are now down or left. Now we label the squares by their coordinates, so that the lower leftmost square is (1, 1) and the upper rightmost square is (m, n). Note that the game must terminate – this is a key ingredient for positional analysis to work. P Start P P P P P P Figure 5.4: The P-positions The crucial observation is that the P-positions are squares with equal coordinates, that is, squares with coordinates (k, k) for some k. These are marked P in the figure. This is because if X moves to a square marked P, Y cannot reach any other P square in Y’s turn. Then X can move back to a P-position. This continues – X keeps moving to P-positions, and eventually reaches (1, 1) and wins. Thus if m ≠ n, the initial position is N, so A wins by always Olympiad Combinatorics 12 moving to a square marked P. If m = n, the initial position is P, so B wins. Hence A wins if and only if m ≠ n. ■ The previous two examples illustrate the general approach to problems in this section: characterize the N- and P-positions. If the starting position is an N-position, A wins; otherwise B wins. The next example is similar to example 8, but the inductive proof for characterizing N-positions is slightly trickier. There is also an important difference between this example and the previous two, discussed in the remark at the end. Example 10 [Saint Petersburg 2001] The number 1,000,000 is written on a board. A and B take turns, each turn consisting of replacing the number n on the board with n – 1 or ⌊ ⌋. The player who writes the number 1 wins. Who has the winning strategy? Answer: Note that the game eventually ends, so one of the players must have a winning strategy. After experimenting with 1,000,000 replaced with smaller values, we see that A wins when the starting number is 2, 4, 6 and 8 and conjecture that A wins for any even starting number. In other words, we claim that all even numbers are N-positions. We prove this by induction. 2 is an N-position, so now suppose that all even numbers less than 2k are N-positions. We show that 2k is also an N-position. If k is a P-position, A can write k in her first move and win. Otherwise A first writes 2k – 1. Then B must write 2k – 2 or k, both of which are N-positions by assumption, so A wins in this case as well. Thus all even numbers are N-positions, so 1,000,000 is an N-position and A has a winning strategy. ■ Remark: Note that unlike the solutions in examples 8 and 9, this solution does not characterize all positions as P or N. We proved all even numbers are N-positions, but didn’t prove anything about odd numbers since we didn’t need to. All we really cared about Chapter 5: Combinatorial Games 13 was the number 1,000,000, so characterizing the positions of even numbers was sufficient. Another interesting thing to observe is the following: suppose N = 50. A’s strategy says to write 25 if 25 is a P-position, and otherwise write 49. But we don’t know whether 25 is a P-position or an N-position! Does that mean our solution is incomplete or wrong? No. The problem only asked who has the winning strategy, not what the winning strategy is. We have guaranteed the existence of a winning strategy for A, without explicitly finding all its details – that’s Alice’s problem! (Well, actually, it’s kind of your problem too- exercise 6 asks you to characterize the odd positions of this problem.) An idea that has started to recur in this book is to take the techniques used in constructive proofs and use them for existential proofs. The next proof is a beautiful example of this idea, in which we use positional analysis to prove the existence of a winning strategy for one player by contradiction. Example 11 [Russia 2011, adapted] There are N > n 2 stones on a table. A and B play a game. A begins, and then they alternate. In each turn a player can remove k stones, where k is a positive integer that is either less than n or a multiple of n. The player who takes the last stone wins. Prove that A has a winning strategy. Answer: The game is finite and deterministic so some player must have a winning strategy. Suppose to the contrary that B can win. A first removes kn stones. If B removes jn stones for some j, then that means N – (k + j) n is a P-position (since we are assuming B is playing his winning strategy). In this case A could have removed (k + j) n stones in her first move and won, meaning that A has a winning strategy, which is a contradiction. Thus if A removes kn stones in the first move, where 1 ≤ k ≤ n, let f(k) denote the number of stones B takes in response according Olympiad Combinatorics 14 to his winning strategy. By the first paragraph, 1 ≤ f(k) ≤ n – 1. Hence by the pigeonhole principle, for some distinct k and j, f(k) = f(j). This means that both N – kn – f(k) and N – jn – f(k) are P- positions, since these are the positions that arise after B’s move. Now WLOG let k < j. A first removes kn stones, then B removes f(k) stones. Now A removes (k – j)n stones. There are now N – kn – f(k) stones remaining, which is a P-position by the second paragraph. Hence A will win, contradicting our assumption that B has a winning strategy. ■ In slightly harder problems recursion often proves to be a useful technique. This means that we relate the outcome of a game of size N to games of smaller size. Example 12 [IMO Shortlist 2004, C5] A and B take turns writing a number as follows. Let N be a fixed positive integer. First A writes the number 1, and then B writes 2. Hereafter, in each move, if the current number is k, then the player whose turn it is can either write k + 1 or 2k, but no player can write a number larger than N. The player who writes N wins. For each N, determine who has a winning strategy. Answer: Step 1: We quickly observe that if N is odd, A can win. A can always ensure that she writes an odd number, after which B would have to write an even number. Hence B cannot say N so A wins. Now suppose N is even. Step 2: The key observation is that all even numbers greater than N/2 are P-positions. This is because after this point neither player can double the number (otherwise it will exceed N). Hence they both must keep adding 1 in their turns, and one player will keep writing even numbers and the other will keep writing odd numbers. The player who wrote the even number greater than N/2 will hence write N since N is even. Chapter 5: Combinatorial Games 15 Step 3: If N = 4k or N = 4k+2, then k is a P-position. This is because if X writes k, Y must write k+1 or 2k. Then X writes 2k+2 if Y writes k and X writes 4k if Y writes 2k. X has thus written an even number greater than N/2 and by step 2, X wins. Steps 2 and 3 now give us the final critical lemma. Step 4: If X has a winning strategy for N = k, then X has a winning strategy for N = 4k and N = 4k+2. Proof: Consider a game where N = 4k or 4k + 2. If X writes k at some point during the game, we are done by step 3. So X’s aim is to write k, so X starts implementing the winning strategy for N = k. How can Y prevent X from writing k? By “jumping over” k at some point: after X says some number j with k/2 < j < k, Y doubles it, resulting in a number 2j with (k + 1) ≤ 2j ≤ N/2. But then X simply doubles this number, resulting in an even number at least equal to 2(k+1) > N/2. So X wins by step 2. Finally, we have a recursive method of determining the answer for even N. The answer for N is the same as that for ⌊ ⌋. To convert this recursion into an explicit answer, write N in base 4. The function ⌊ ⌋ is equivalent to removing the last digit of N in base 4. Starting from the base 4 representation of N, keep removing the rightmost digit. The resulting numbers will all be winning for the same player by our recursion. If at some point we obtain an odd number, then A wins for this number and hence A wins for N. Hence if N has an odd digit in base 4, then A wins. Otherwise, suppose N has only 0s and 2s in its base 4 representation. Then applying our procedure we eventually end up with the number 2, and since B wins for 2, B wins for N in this case. ■ The final example of this chapter is different in a few ways. First, it is asymmetrical, in the sense that the two players have different (in fact, opposite) objectives. Such games are typically called “maker-breaker” games. We cannot define P- and N- positions the way we did before. However, similar ideas of Olympiad Combinatorics 16 analyzing positions based on outcome still apply, and winning strategies are still based on always sticking to some particular type of position. These positions are typically characterized by some specific property or invariant, as the next example shows. Example 13 [IMO Shortlist 2009, C5] Five identical empty buckets of 2-liter capacity stand at the vertices of a regular pentagon. Cinderella and her wicked Stepmother go through a sequence of rounds: At the beginning of every round the Stepmother takes one liter of water from the nearby river and distributes it arbitrarily over the ﬁve buckets. Then Cinderella chooses a pair of neighboring buckets, empties them into the river, and puts them back. Then the next round begins. The Stepmother’s goal is to make one of these buckets overﬂow. Cinderella’s goal is to prevent this. Can the wicked Stepmother enforce a bucket overﬂow? Answer: Let the volume of water in the buckets be B1, B2, B3, B4 and B5. Indices will be taken mod 5. Clearly if both Bi and Bi+2 are greater than one before one Cinderella’s moves, she cannot empty both of them and hence the stepmother will win enforce an overflow in her turn. Thus Cinderella’s aim is to prevent this from happening. To do this, clearly it is sufficient to ensure that Bi + Bi+2 is at most one for each i after each of Cinderella’s turns. Call such a situation good. Suppose after some round we have a good situation: two buckets are empty, say B4 = B5 = 0. Then B1 + B3 ≤ 1 and B2 ≤ 1 (since B2 + B4 ≤ 1). After the stepmother’s turn, we will have B1 + B3 + B4 + B5 ≤ 2. Hence either B5 + B3 ≤ 1 or B4 + B1 ≤ 1. WLOG B5 + B3 ≤ 1. Then Cinderella empties B1 and B2. Now observe that the new configuration is still good, since B4 ≤ 1 and B5 + B3 ≤ 1. Hence starting from a good configuration, Cinderella can ensure that at the end of the round the new configuration is still good. Initially the buckets are all empty, so this configuration is Chapter 5: Combinatorial Games 17 good. Hence Cinderella can prevent an overflow by always staying in a good position. ■ Exercises 1. [Cram] A and B take turns placing dominoes on an m × n rectangular grid, where mn is even. A must place dominoes vertically and B must place dominoes horizontally, and dominoes cannot overlap with each other or stick out of the board. The player who cannot make any legal move loses. Given m and n, determine who has a winning strategy, and find this strategy. 2. [Double Chess] The game of double chess is played like regular chess, except each player makes two moves in their turn (white plays twice, then black plays twice, and so on). Show that white can always win or draw. 3. [Russia 1999] There are 2000 devices in a circuit, every two of which were initially joined by a wire. The hooligans Vasya and Petya cut the wires one after another. Vasya, who starts, cuts one wire on his turn, while Petya cuts two or three. A device is said to be disconnected if all wires incident to it have been cut. The player who makes some device disconnected loses. Who has a winning strategy? 4. [IMO Shortlist 2009, C1] Consider 2009 cards, each having one gold side and one black side, lying on parallel on a long table. Initially all cards show their gold sides. Two players, standing by the same long side of the table, play a game with alternating moves. Each move consists of choosing a block of 50 consecutive cards, the leftmost of which is showing gold, and turning them all over, Olympiad Combinatorics 18 so those which showed gold now show black and vice versa. The last player who can make a legal move wins. a) Does the game necessarily end? b) Does there exist a winning strategy for the starting player? 5. [Russia 1999] There are three empty jugs on a table. Winnie the Pooh, Rabbit, and Piglet put walnuts in the jugs one by one. They play successively, with the order chosen by Rabbit in the beginning. Thereby Winnie the Pooh plays either in the first or second jug, Rabbit in the second or third, and Piglet in the first or third. The player after whose move there are exactly 1999 walnuts in some jug loses. Show that Winnie the Pooh and Piglet can cooperate so as to make Rabbit lose. 6. Solve the problem in example 10 with 1,000,000 replaced by n, an arbitrary odd number. Use this complete character- ization of positions to provide a complete description of the winning strategy. If you have some programming experience, you could also write a program to play this game against you. Remark (for programmers): You could also write a program to solve this probem, that is, to determine for each n who has a winning strategy. A simple dynamic programming approach would run in O(n) time. Using this as a subroutine, the program to play the game against you would take O(n) time for each move. However, if you found the characterization of positions on your own first, the program to play the game would only take O(log n) time for each move. 7. [Bulgaria 2005] For positive integers t, a, b, a (t, a, b)-game is a two player game defined by the following rules. Initially, the number t is written on a blackboard. In his first move, the first player replaces t with either t – a or t – b. Then, the second player subtracts either a or b from this number, and writes the result on the blackboard, erasing the old number. After this, the first player once again erases either a or b from the number Chapter 5: Combinatorial Games 19 written on the blackboard, and so on. The player who first reaches a negative number loses the game. Prove that there exist infinitely many values of t for which the first player has a winning strategy for all pairs (a, b) with (a + b) = 2005. 8. [Rioplatense Math Olympiad 2010] Alice and Bob play the following game. To start, Alice arranges the numbers 1, 2, …, n in some order in a row and then Bob chooses one of the numbers and places a pebble on it. A player's turn consists of picking up and placing the pebble on an adjacent number under the restriction that the pebble can be placed on the number k at most k times. The two players alternate taking turns beginning with Alice. The first player who cannot make a move loses. For each positive integer n, determine who has a winning strategy. 9. [Russia 2007] Two players take turns drawing diagonals in a regular (2n+1)- gon (n > 1). It is forbidden to draw a diagonal that has already been drawn or intersects an odd number of already drawn diagonals. The player who has no legal move loses. Who has a winning strategy? 10. [Indian Practice TST 2013] A marker is placed at the origin of an integer lattice. Calvin and Hobbes play the following game. Calvin starts the game and each of them takes turns alternatively. At each turn, one can choose two (not necessarily distinct) integers a and b, neither of which was chosen earlier by any player and move the marker by a units in the horizontal direction and b units in the vertical direction. Hobbes wins if the marker is back at the origin any time after the first turn. Determine whether Calvin can prevent Hobbes from winning. Note: A move in the horizontal direction by a positive quantity will be towards the right, and by a negative quantity will be towards the left (and similarly in the vertical case as well). Olympiad Combinatorics 20 11. [Based on South Korea 2009, Problem 5] Consider an m × (m+1) grid of points, where each point is joined by a line segment to is immediate neighbors (points immediately to the left, right, above or below). A stone is initially placed on one of the points in the bottom row. A and B alternately move the stone along line segments, according to the rule that no line segment may be used more than once. The player unable to make a legal move loses. Determine which player has a winning strategy. 12. [IMO Shortlist 1994, C6] Two players play alternatively on an infinite square grid. The first player puts an X in an empty cell and the second player puts an O in an empty cell. The first player wins if he gets 11 adjacent X's in a line - horizontally, vertically or diagonally. Show that the second player can always prevent the first player from winning. 13. [Nim] There are k heaps of stones, containing a1, a2, …, ak stones respectively, where the ai’s are positive integers. Players A and B play alternately as follows: in each turn, a player chooses one non-empty heap and removes as many stones as he or she wants. The person who takes the last stone wins. Determine when each player has a winning strategy, and find this winning strategy. 14. [The name of this problem would give the answer away] There is one pile of N counters. A and B play alternately as follows. In the first turn of the game, A may remove any positive number of counters, but not the whole pile. Thereafter, each player may remove at most twice the number of counters his opponent took on the previous move. The player who removes the last counter wins. Who has the winning strategy? Olympiad Combinatorics Pranav A. Sriram August 2014 Chapter 6: Counting in Two Ways 1 Copyright notices All USAMO and USA Team Selection Test problems in this chapter are copyrighted by the Mathematical Association of America’s American Mathematics Competitions. © Pranav A. Sriram. This document is copyrighted by Pranav A. Sriram, and may not be reproduced in whole or part without express written consent from the author. About the Author Pranav Sriram graduated from high school at The International School Bangalore, India, and will be a Freshman at Stanford University this Fall. Chapter 6: Counting in Two Ways 1 6. COUNTING IN TWO WAYS Introduction Several combinatorics problems ask us to count something – for example, the number of permutations of the numbers from 1 to n without fixed points, or the number of binary strings of length n with more 1s than 0s. What’s interesting is that the techniques used to solve counting or enumeration problems can be applied to problems that don’t ask us to count anything. Problems in fields such as combinatorial geometry, graph theory, extremal set theory and even number theory can be solved by clever applications of counting – twice. The basic idea underlying this chapter is to compute or estimate some quantity Q (which will depend on the problem and information given to us) by counting in two different ways. We hence obtain two different expressions or bounds for Q. For instance, we may obtain E1 ≥ Q and E2 = Q. This allows us to conclude that E1 ≥ E2, which may have been very difficult to prove directly. The role of counting in this approach is thus to allow us to convert complicated combinatorial information into convenient algebraic statements. The main challenge lies in choosing Q appropriately, so that we use all the information given to us and derive an algebraic conclusion relevant to what we are trying to prove. Olympiad Combinatorics 2 Incidence Matrices Let A1, A2, …, An be subsets of S = {1, 2, …, m}. A convenient way to express this information is by drawing an n × m matrix, with the n rows representing A1, A2, …, An and the m columns representing the elements of S. Entry aij = 1 if and only if element j belongs to Ai. Otherwise, aij = 0. The idea of counting the total number of 1s in an incidence matrix is very useful. Example 1 Let A1, A2, …, A6 be subsets of S = {1, 2, …, 8}. Suppose each set Ai has 4 elements and each element in S is in m of the Ai’s. Find m. Answer: We draw an incidence matrix with six rows, representing the subsets A1, A2, …, A6 and eight columns representing the elements of S. The entry in the ith row and jth column is 1 if and only if the element j belongs to Ai. Otherwise the entry is 0. Since |Ai| = 4, each row contains four 1s. There are 6 rows, so the total number of 1s in our matrix is 6×4 = 24. Now each element of S is in m of the Ai’s. Thus each column of our matrix contains m 1s. So the total number of 1s in the matrix is 8m, since there are 8 columns. Thus 24 = 8m, so m = 3. ■ 1 1 0 1 1 0 0 0 Figure 6.1: A sample 6 x 8 incidence matrix with one row filled in, illustrating set A3 containing elements 1, 2, 4 and 5. Chapter 6: Counting in Two Ways 3 Counting Pairs and Triples What we are actually doing in the above proof is counting pairs of the form (element, set) where the set contains the element. Each 1 in the matrix corresponds to such a pair. If we choose the set first and then the element, there are 6 choices for the set and then 4 for the element, for a total of 24 pairs. We can also choose the element first (8 choices), and then choose the set (m choices, since each element belongs to m sets) for a total of 8m pairs. Equating the two answers, 8m = 24, so m = 3. More generally, we have the following result: If A1, A2, …, Am are subsets of {1, 2, …, n} and each element j belongs to dj of the subsets, then ∑ = ∑ Both sides count the total number of 1s in the matrix, which is the number of pairs (set, element). The left side counts this quantity by picking the set first and the right side counts it by picking the element first. Note that both sides are also the sum of 1s in the incidence matrix. In the first example, we counted pairs of the form (set, element) where the element belongs to the set. There are a few important variations of this technique: (i) Count triples of the form (set, set, element) where the two sets are distinct both contain the element. This is especially useful if we are given information about the intersection size of any two sets. These triples can be counted either by first fixing the two sets and then picking the element from their intersection, or by fixing the element and then picking two sets to which it belongs. Olympiad Combinatorics 4 Note that counting triples of the form (set, set, element) is equivalent to counting the number of pairs of 1s that are in the same column in the incidence matrix representation. (ii) Count triples of the form (element, element, set) where the two elements both belong to the set. This is useful if we are given information about how many sets two elements appear together in. These triples can be counted in two ways: you can either fix the two elements first or you can fix the set first. Note that counting triples of the form (element, element, set) is equivalent to counting the number of pairs of 1s in the same row in the incidence matrix representation. The next example demonstrates (ii) in part (a), and the original idea of counting pairs (set, element) in part (b). Example 2 [Balanced block designs] Let X = {1, 2, …, v} be a set of elements. A (v, k, λ) block design over X is a collection of distinct subsets of X (called blocks) such that: (i) Each block contains exactly k elements of X (ii) Every pair of distinct elements of X is contained in exactly λ blocks Let b be the number of blocks. Prove that: (a) Each element of X is contained in exactly r = λ (v – 1)/(k – 1) blocks. (In particular, this means that each element is in the same number of blocks, which is initially not obvious) (b) r = b k / v Answer: (a) Consider an element s in X. We count in two ways the number of triples (s, u, B) where u is an element (different from s) and B is a block containing s and u. The first way we count will be to fix B and then u, and the second way will do the reverse. If s is in r blocks, then there are r ways to choose B, and then (k – 1) ways to choose u from B. This gives a total of r (k – 1). On Chapter 6: Counting in Two Ways 5 the other hand, there are (v – 1) ways to choose u first, and then λ ways to choose B such than B contains both u and s (by condition (ii)). This gives a total of λ (v – 1). Hence r (k – 1) = λ (v – 1), which is what we wanted. (b) We count in two ways the number of pairs (x, B) where x is an element in a block B. There are v ways to choose x, and then r ways to choose B. This gives v r pairs. On the other hand, there are b ways to choose B first, and then k ways to choose x since |B| = k. This gives b k pairs. Hence b k = v r. ■ The real power of counting in two ways lies in proving inequalities. Typically, we count the number of pairs P (or triples T) of some objects in two ways. At least one of the two counting procedures should give us a bound on P (or T, as may be the case). To do this, we need to cleverly exploit information given to us in the problem statement. The next example is fairly simple, as we use ideas we have already seen in preceding examples. Example 3 [USA TST 2005] Let n be an integer greater than 1. For a positive integer m, let Sm = {1, 2, …, mn}. Suppose that there exists a 2n-element set T such that (a) each element of T is an m-element subset of Sm (b) each pair of elements of T shares at most one common element; and (c) each element of Sm is contained in exactly two elements of T. Determine the maximum possible value of m in terms of n. Remark: Make sure you understand the problem – the “elements” of T are actually sets, that is, T is actually a family of subsets of Sm. Answer: Let A1, A2, …, A2n be the elements of T. Let S be the number of triples (x, Ai, Aj) where x is an element of Sm belonging to both sets Ai and Aj. If we choose x first, there is only one choice for the pair Olympiad Combinatorics 6 (Ai, Aj) since x belongs in exactly two elements of T by (c). This gives S = mn (the number of choices for x). If we select Ai and Aj first, there is at most one choice for x by (b). Thus S ≤ ( ), the number of ways of choosing the pair (Ai, Aj). Hence mn = S ≤( ) ⇒ m ≤ 2n – 1. To give a construction when m = 2n-1, simply take 2n lines in the plane, no three of which concur and no two of which are parallel. There will be ( ) = mn intersection points formed. The 2n lines are the 2n elements of T, and the mn points are the elements of Sn. The conditions of the problem are satisfied, since each point lies on exactly two lines, each two lines meet at exactly one point and each line contains m = 2n – 1 points since it meets the other 2n-1 lines once each. ■ Slightly harder problems require a clever choice of what pairs or triples to count, and how to use the information in the problem to get the bounds we want. This comes with practice. One general principle to note is to pay attention to key phrases in the problem like “at most” and “at least”. These pieces of information often give a good idea of what we should count. Example 4 [IMO 1998, Problem 2] In a competition, there are a contestants and b judges, where b ≥ 3 is an odd integer. Each judge rates each contestant as either pass or fail. Suppose k is a number such that for any two judges, their ratings coincide for at most k contestants. Prove that ≥ . Answer: Let T be the number of triples (judge, judge, contestant) where the two judges both gave the same rating to the contestant. We can select the two judges in ( ) ways, and then select the contestant in at most k ways by the condition of the problem. Hence T ≤ k ( ). Chapter 6: Counting in Two Ways 7 Now take any individual contestant, and suppose the number of judges who rated her “pass” is p and the number who rated her “fail” is b – p. The number of triples containing this candidate is ( ) + ( ) ≥ ( ) + ( ) = (b – 1)2 /4. Here we used convexity and the fact that b is odd. Thus each candidate is in at least (b – 1) 2/4 triples, so T ≥ a(b – 1) 2/4. Combining this with our earlier estimate, a(b – 1) 2/4 ≤ kb(b – 1)/2 ⇒ ≥ ■ Unlike the previous example, the next problem offers us no clues that lead us to guess what we should count. However, we can exploit the geometry of the problem to our advantage. Example 5 [Iran 2010] There are n points in the plane such that no three of them are collinear. Prove that the number of triangles whose vertices are chosen from these n points and whose area is 1 is not greater than (n 2 - n). Answer: Let the number of such triangles be k. We count pairs (edge, triangle) such that the triangle contains the edge. If the number of such pairs is P, then clearly P = 3k, since each triangle has 3 edges. On the other hand, for any edge AB, there are at most four points such that the triangles they form with A and B have the same area. This is because those points have to be the same distance from line AB, and no three of them are collinear. Hence P is at most 4 times the number of edges, which is at most ( ) Thus P ≤ 4 ( ). This gives 3k ≤ ( ) ⇒ k ≤ (n 2 - n) ■ Olympiad Combinatorics 8 Figure 6.2: At most four points P1, P2, P3, P4 can form a triangle of unit area with segment AB Remark: Whenever I’m faced with a combinatorial geometry problem that involves proving an inequality, like the above problem, I use the following principle: use the geometry of the situation to extract some combinatorial information. After that, ignore the geometry completely and use the combinatorial information to prove the inequality. We use this principle in the next example as well. Example 6 [IMO 1987] Let n and k be positive integers and let S be a set of n points in the plane such that: (i) No three points of S are collinear (ii) For every point P in S, there are at least k points in S equidistant from P. Prove that k < + √ . Answer: Condition (ii) implies that for each point Pi in S, there exists a circle Ci with center Pi and passing through at least k points of S. Now we count pairs (Pi, Pj) such that Pi and Pj are points in S. P1 P 2 P 3 P 4 A B Chapter 6: Counting in Two Ways 9 Obviously the number of such pairs is ( ) On the other hand, each circle Ci has k points on its circumference, which give rise to ( ) pairs of points. Thus the n circles in total give us n ( ) points. However, there is over counting, since some pairs of points may belong to two circles. Since any two circles meet in at most 2 points, the number of pairs of points that we have counted twice is at most equal to the number of pairs of circles, which is ( ). Hence the total number of pairs of points in S is at least n( ) - ( ). This implies n( ) - ( ) ≤ ( ) ⇒ ( ) ≤ 2( ) ⇒ k 2 + k – (n-1) ≤ 0. Solving this quadratic inequality, noting that k and n are integers, gives us the desired result. ■ The next example again requires a good choice of what to count, in order to capture all the given information. Example 7 [IMO Shortlist 2004, C1] There are 10001 students at a university. Some students join together to form several clubs (a student may belong to different clubs). Some clubs join together to form several societies (a club may belong to different societies). There are a total of k societies. Suppose that the following conditions hold: (i) Each pair of students is in exactly one club. (ii) For each student and each society, the student is in exactly one club of the society. (iii) Each club has an odd number of students. In addition, a club with 2m + 1 students (m is a positive integer) is in exactly m societies. Find all possible values of k. Answer: In order to use all the information in the question, we count triples (a, C, S), where a is a student, C is a club and S is a society, Olympiad Combinatorics 10 where a C and C S. Let the number of such triples be T. Suppose we first fix a, then S, then C. We can choose a in 10001 ways, S in k ways and then finally C in only one way (by condition (ii)). Hence T = 10001 k. Now suppose we fix C first. There are |C| ways of doing this. Then by condition (iii), there are (|C| -1)/2 ways to choose S. Finally there is only one way to choose a, by (ii). This gives T = ∑ = ∑ ( ) On the other hand, the sum ∑ ( ) is actually equal to the number of pairs of students. This is because each pair of students is in exactly one club by (i), so each pair of students is counted exactly once. Hence this sum is equal to ( ), so putting everything together ( ) = T = 10001 k ⇒ k = 5000. Finally, to construct a configuration for k = 5000, let there be only one club C containing all students and 5000 societies all containing only one club (C). It’s easy to see that this works. ■ Counting with Graphs In the next few examples, we show how to use counting in two ways to solve some problems on graphs. Modeling situations using graphs is very useful, since graphs are very convenient to work with while counting in two ways. For example, suppose we want to count pairs of people such that the two people are friends. If we draw a graph with vertices representing people and an edge between two people if and only if they are friends, then the Chapter 6: Counting in Two Ways 11 problem is equivalent to counting the number of edges in the graph. Some useful properties of graphs Let G be a graph with n vertices v1, v2, …, vn. Let di be the degree of vi, E be the set of edges and |E| = k. All summations without indices are assumed to be from 1 to n. We have the following useful properties: Lemma 1: ∑ = 2k (this is because the LHS counts each edge of the graph twice) Lemma 2: ∑ ≥ ∑ (By Cauchy-Schwarz) ⇒ ∑ ≥ Lemma 3: ∑( ) ≥ – k Proof: ( ) = . Using lemma 1 and lemma 2 produces the result. Lemma 4: ∑ ) = ∑ Proof: Each term di appears in the sum on the LHS di times (once for each of the neighbors of vi). Thus the total sum will be the sum of di × di = di2 for each i, which is the RHS. There are also some important results on directed graphs, especially tournaments. A tournament on n vertices is a directed graph such that between any two vertices u and v, there is either a directed edge from u to v or a directed edge from v to u. One can interpret these graphs as follows: the n vertices stand for participants in a tournament, and each two players play a match. Olympiad Combinatorics 12 There are no ties. If v beats u, then there is a directed edge from v to u. Let P1, P2, …, Pn be the n participants. Let wi and li denote the number of wins and losses of Pi. Clearly wi + li = (n – 1) for each i, because each person plays against (n – 1) others. Also, ∑ = ∑ since each match has a winner and a loser, and so contributes 1 to both sides. Hence in fact both sides are equal to ( ), the total number of matches. We have another interesting but less obvious result: Lemma 5: ∑ = ∑ . Proof: Define a noncyclic triple to be a set of 3 players A, B and C such that A beat both B and C and B beat C. Call A the winner of the triplet and C the loser of the triplet. If we count noncyclic triplets by winners, the sum would be ∑( ) since after choosing the winner there are ( ) ways to choose the other two players who he beat. If we count by losers, the sum is ∑( ), since after choosing the loser there are ( ) ways to choose the other two players. Hence ∑( ) = ∑( ) Combining this with ∑ = ∑ we get the result. Remark: Whenever you see expressions of the type in this lemma, like a sum of squares, try to interpret them combinatorially. For instance, it is often useful to convert x 2 to ( ) + 2x. Allow these sums to give you hints as to what to count. In the proof of lemma 5, the term ( ) gives us a hint to count triples of the form (X, Y, Z) such that X beat both Y and Z. This almost automatically leads us to the solution. Example 8 [APMO 1989] (U*) Show that a graph with n vertices and k edges has at least k (4k – n 2 )/3n triangles. Chapter 6: Counting in Two Ways 13 Note: The symbol U* in brackets next to a problem indicates that it is a useful result and should be remembered. Answer: We count pairs (edge, triangle) where the triangle contains the edge. Consider an edge vivj. How many triangles have vivj as an edge? vi is joined to (di – 1) vertices other than vj, and vj is joined to dj vertices other than vi. There are only n – 2 vertices other than vi and vj. Hence at least (di – 1) + (dj – 1) – (n – 2) = (di + dj – n) vertices are joined to both vi and vj. Each of these gives one triangle. Hence each edge vivj is in at least max {0, (di + dj – n)} triangles. Figure 6.3: The set of vertices neighboring both vi and vj must contain at least (di + dj – n) vertices Thus the total number of triangles is at least ∑ ) = ∑ – (Using lemma 4) ≥ × - = . (Using lemma 3) Note that we divided by 3 because otherwise each triangle would be counted thrice (once for each edge). ■ Neighbors of vi Neighbors of v j vi v j Olympiad Combinatorics 14 Corollary 1 (U*) A graph with no triangles has at most ⌊ ⌋ edges. Equality is achieved only by bipartite graphs with an equal or almost equal number of vertices in each part. This is an extremely useful result, and is a special case of Turan’s theorem, which will be discussed in the exercises of chapter 8. Example 9 [Indian TST 2001] (U*) Let G be a graph with E edges, n vertices and no 4-cycles. Show that E ≤ (1 + √ ). Answer: Let the vertices be {v1, …, vn} and let the degree of vi be di. Let T be the number of “V-shapes”: that is, triples of vertices (u, v, w) such that v and w are both adjacent to u. The vertices v and w may or may not be adjacent and triples {u, v, w} and {u, w, v} are considered the same. Figure 6.4: A “V shape” The reason for this choice of T is that if we first select v and w, then there is at most one u such that {u, v, w} is a triple in T. Otherwise there would be a 4 cycle. Hence we get T ≤ ( ), since for each of the ( ) ways of choosing v and w, there is at most one way to choose u. If we choose u first, there are ( ) ways of choosing v and w, where du is the degree of u. Summing over all choices for u, and then using lemma 3, we get v w u Chapter 6: Counting in Two Ways 15 T = ∑ ( ) ≥ - E Combining this with T ≤ ( ), – E ≤ . This reduces to a quadratic inequality in E, which yields the desired bound. ■ Sometimes, when we need to bound or count the number of objects satisfying some property, it is easier or more convenient to count the number of objects not satisfying the property. Then we can subtract this from the total number of objects to get the result. Example 10 [USAMO 1995] Suppose that in a certain society, each pair of persons can be classified as either amicable or hostile. We shall say that each member of an amicable pair is a friend of the other, and each member of a hostile pair is a foe of the other. Suppose that the society has n people and q amicable pairs, and that for every set of three persons, at least one pair is hostile. Prove that there is at least one member of the society whose foes include q (1- 4q/n 2 ) or fewer amicable pairs. Answer: We naturally rephrase the problem in graph theoretic terms, with vertices representing people and an edge joining two vertices if and only if they form an amicable pair. The graph has no triangles by assumption, n vertices and q edges. We wish to estimate the number of edges containing 2 foes of X, where X is a vertex. To do this, we first count P, the number of pairs (E, X), where E is an edge containing X or a friend of X. First we count the number of pairs (X, E) where E is an edge Olympiad Combinatorics 16 containing a neighbor of X but not containing X. This quantity will be equal to T, the number of triples (X, Y, Z) such that XY and YZ are edges. (X, Y, Z) is considered different from (Z, Y, X). Note that XZ cannot be an edge by the condition that there are no triangles. To compute T, we count by Y. The number of triples containing Y is dY (dY – 1), so the total number of triples is ∑ i(di – 1). Now clearly the number of pairs (X, E) where E is an edge containing X is given by the sum ∑ i. If we add this summation to the previous summation, we would have counted the number of pairs (X, E) where E is an edge containing X OR a friend of X but not X. Thus the total number of such pairs is P = ∑ i(di – 1) + ∑ i = ∑ i2 ≥ 4q2 /n, by lemma 2. Hence by averaging, there is some X such that there at least 4q2 /n 2 pairs (X, E), where E is an edge X or at least one neighbor of X. Thus the number of edges joining two foes of X is at most q – 4q2/n 2 = q (1 – 4q/n 2). Example 11 [Generalization of Iran TST 2008] In a tournament with n players, each pair of players played exactly once and there were no ties. Let j, k be integers less than n such that j < 1 + ( ) ( ) . Show that there exist sets A and B of k players and j players respectively, such that each player in A beat each player in B. Answer Count (k + 1)–tuples of the form (P1, P2, …, Pk, L) where L lost to each of the players P1, P2, …, Pk. Let T be the total number of such tuples. If we fix L, we get ( ) tuples containing L, where dL is the number of players L lost to. Summing over all n choices of L, T ≥ Chapter 6: Counting in Two Ways 17 ∑ ( ) , where di is the number of losses of the ith player. Hence by Jensen’s inequality, T ≥ n × ( ∑ ) = n × ( ), since ∑ = n (n – 1)/2. Now assume to the contrary that there do not exist such sets A and B. Then for any choice of P1, P2, …, Pk, there are at most (j – 1) choices for L. Hence T ≤ ( )(j – 1). Combining these estimates gives (j – 1) ≥ ( ) ( ) , which contradicts the condition of the problem. Thus, our assumption in the second paragraph is false, and such sets A and B indeed exist. Example 12 [IMO Shortlist 2010 C5] n ≥4 players participated in a tennis tournament. Any two players have played exactly one game, and there was no tie game. We call a company of four players bad if one player was defeated by the other three players, and these three players formed a cyclic triple (a set (A, B, C) such that A beat B, B beat C and C beat A). Suppose that there is no bad company in this tournament. Let wi and li be respectively the number of wins and losses of the ith player. Prove that ∑ Answer: Note that ∑ 3 = ∑ + ∑ We will show that (i) ∑ ≥ ∑ (ii) ∑ ≥ ∑ Olympiad Combinatorics 18 From now on, any summation without indices is assumed to be from 1 to n. Note that by using lemma 5, we can reduce (i) to the “more combinatorial” form (iii) ∑( ) ≥ ∑( ) Let us define a “chained quadruple” as a set of 4 players with no cyclic triple amongst them. It is easy to see that a chained quadruple has (a) A person who won against all the other three players, called the winner (b) A person who lost against all the other three players, called the loser The converse of (a) is not true, since the other three players may form a cyclic triple. However, the converse of (b) holds, since by assumption there is no bad quadruple. Let Q be the number of chained quadruples. If we count Q by picking the loser first, we get Q = ∑( ) If we count Q by picking the winner first, noting that the converse of (a) doesn’t hold, then Q ≤ ∑( ) Hence ∑( ) ≥ ∑( ), which proves (iii) and hence (i). To prove (ii), subtract ∑ from both sides and divide by 2, to write it as: (iv) ∑ ( ) ∑ ( ) Observe that the LHS of this expression counts pairs of the form (quadruple, person) such that the person won exactly one Chapter 6: Counting in Two Ways 19 game against the other three in the quadruple. Similarly, the RHS counts pairs such that the person won exactly two games. Now let us look at the types of quadruples we can have. If in a certain quadruple the number of games won by each person against the other three are a, b, c, d in non-increasing order, we say that this quadruple is of type (a, b, c, d). The only types we can have are: (3, 1, 1, 1) – Note that this refers to a quadruple in which one person beat the other three, and the other three each won one game. This type of quadruple contributes 3 to the LHS of (iv) (three people won one game) and 0 to the RHS (no one won two games). (2, 2, 1, 1) – This contributes 2 to both sides of (iv) (3, 2, 1, 0) – This contributes 1 to both sides of (iv) (2, 2, 2, 0) – This is not allowed: this is a bad company. Thus we see that every allowed quadruple contributes at least as much to the LHS of (iv) as it does to the RHS. Hence (iv) indeed holds, which proves (ii). Hence (i) and (ii) together give us the desired result and we are done. Remark 1: This example shows the true power of “interpreting things combinatorially”. Remark 2: This problem was the first relatively hard (rated above C2 or C3) combinatorics problem I ever solved, and my solution was essentially the one above. The thought process behind this solution is fairly natural – keep expressing things “combinatorially”, let these expressions guide what you choose to count, and exploit the fact that there is no “(2, 2, 2, 0)”. Also note that it is not essential to prove (i) and (ii) separately: one can directly show that ∑( ) + ∑ ( ) ≥ ∑( ) + ∑ ( ) by comparing the contributions to each side by each type of quadruple. Olympiad Combinatorics 20 Miscellaneous Applications In this section we look at some unexpected applications of counting in two ways. Example 13 [IMO 2001, Problem 4] Let n be an odd integer greater than 1 and let c1, c2, …, cn be integers. For each permutation a = {a1, a2, …, an} of {1, 2, …, n} , define S(a) = ∑ ici . Prove that there exist permutations a ≠ b of such that n! is a divisor of S(a) – S(b). Answer: Suppose to the contrary that all the S(a)’s are distinct modulo (n!). Since there are n! possibilities for a, this means that S(a) takes each value in {1, 2, … , n!} modulo n! Consider the sum of all the S(a)’s modulo n!. If the sum is S, then S ≡ 1 + 2 + … + n! ≡ n! (n! + 1)/2 mod n! ≡ n!/2 mod n!. On the other hand, the coefficient of each ci in S is (n – 1)! (1 + 2 + … + n) = n! (n + 1)/2 ≡ 0 mod n!, since n is odd and 2 divides n + 1. Thus the coefficient of each ci in S is divisible by n!, so S ≡ 0 mod n!. This is a contradiction to the result in the first paragraph. ■ Example 14 [IMO Shortlist 2003, C4] Given n real numbers x1, x2, …, xn and n further real numbers y1, y2, …, yn. The entries aij (with 1 ≤ i, j ≤ n) of an n × n matrix A are defined as follows: { Chapter 6: Counting in Two Ways 21 Further, let B be an n × n matrix whose elements are numbers from the set {0, 1} satisfying the following condition: The sum of all elements of each row of B equals the sum of all elements of the corresponding row of A; the sum of all elements of each column of B equals the sum of all elements of the corresponding column of A. Show that in this case A = B. Answer: Let bij denote the entry in the ith row and jth column of B. Define S = ∑ On the one hand, S = ∑ ∑ ij - ∑ ij) + ∑ ∑ -∑ = 0, since ∑ ij = ∑ ij and ∑ = ∑ by the conditions of the problem. On the other hand, note that if xi + yj ≥ 0, then aij = 1 so (aij – bij) ≥ 0. If xi + yj < 0, then aij = 0 so aij – bij ≤ 0. Thus in both cases, (xi + yj) (aij – bij) ≥ 0. Hence each term in the summation is nonnegative, but the total sum is 0. Thus each term is 0. Hence whenever (xi + yj) ≠ 0, we must have aij = bij. Whenever (xi + yj) = 0, then aij = 1. In these cases we must have bij = 1 since the sum of all the entries in both matrices is the same. Hence in all cases aij = bij, and we are done. ■ Remark: Where on earth does the expression S = ∑ come from?!?! Note that one way of proving that several different real numbers are 0 is to show that their squares sum to 0, since no square is negative. Thus, a first approach to the problem may be Olympiad Combinatorics 22 to show that the sum S’ = ∑ is 0. This doesn’t work as it doesn’t utilize information about the x’s and y’s. Instead we try the following modification: we seek to weight each term by some other quantity that still ensures that each term in the summation is nonnegative, and additionally enables us to use the information about the x’s and y’s to show that the entire sum is 0. Example 15 [Indian TST 2010] Let A = (ajk) be a 10 x 10 array of positive real numbers such that the sum of numbers in each row as well as in each column is 1. Show that there exists j < k and l < m such that Answer: To make things more intuitive, let us interpret the algebraic expression visually. The centers of the squares containing entries , , and form a rectangle with sides parallel to grid lines. Define the value of this rectangle to be . Assuming to the contrary that the value of any such rectangle is strictly less than 1/50. Observe that as j, k, l, m vary within the bounds 1 ≤ j < k ≤ 10 and 1 ≤ l < m ≤ 10, we obtain ( ) 2 = 452 such rectangles. Let S be the sum of values of these 452 rectangles. By our earlier assumption, we obtain S < 452 /50 = 40.5. We will now compute S in a different way to yield a contradiction. Note that ajl and akm lie diagonally opposite and ajm and akl lie diagonally opposite each other. Thus in each rectangle the diagonally opposite pairs of entries are multiplied. Hence, when Chapter 6: Counting in Two Ways 23 the sum of values is taken over all rectangles, each entry aij occurs in products with every other entry in the array except those in its own row or column, since two entries in the same row or column can never be diagonally opposite in a rectangle. Therefore, S = ∑ , where Sij is the sum of all entries except those in the ith row and jth column. Note that we have divided by two since if we simply sum the terms aijSij, we will be counting each product aijakl twice. Observe that Sij = (10 – 1 – 1 + aij) = (8 + aij), since the sum of all entries is 10 and the sum in each row and column is 1. Note that the “ + aij” occurs since when we subtract all elements in row i and in column j, aij is subtracted twice. Thus the total sum is S = ∑ = ∑ = 4∑ + ∑ Now ∑ = 10 and ∑ ≥ ∑ 2 = 1, using Cauchy Schwarz. Thus S ≥ 4x10 + 0.5 = 40.5, a contradiction. ■ Remark: The visual interpretation as “diagonally opposite entries in rectangles” is by no means essential (and entails a little abuse of notation as well, for which I apologize). Simply taking a suitable double summation would lead to a significantly shorter but equivalent proof. However, I felt the basic intuition behind the problem may have been lost in a sea of symbols that would have mysteriously spat out the solution, so I chose to write the proof this way. Olympiad Combinatorics 24 Exercises 1. [Due to Grigni and Sipser] Consider an m × n table (m rows, n columns), in which each cell either contains a 0 or a 1. Suppose the entire table contains at least αmn 1s, where 0 < α < 1. Show that at least one of the following must be true: (i) There exists a row containing at least n√ 1s (ii) There exist at least m√ rows containing at least αn 1s. 2. [Italy TST 2005, Problem 1] A class is attended by n students (n > 3). The day before the final exam, each group of three students conspire against another student to throw him/her out of the exam. Prove that there is a student against whom there are at least √ conspirators. 3. [Important Lemmas on incident matrices] (U*) Let A be an r × c matrix with row sums Ri (that is, the sum of the elements in the ith row is Ri) and column sums Cj. Suppose Ri and Cj are positive for all 1 ≤ i ≤ r and 1 ≤ j ≤ c. (i) Show that ∑ = r and ∑ = c (ii) Suppose Cj ≥ Ri whenever aij = 1. Using (i), show that r ≥ c. (iii) Suppose instead of the condition in (ii) we were given that 0 < Ri < c and 0 < Cj < r for each i and each j, and furthermore, Cj ≥ Ri whenever aij = 0. Prove that r ≥ c. 4. [IMO 1987, Problem 1] Let p(n, k) denote the number of permutations of {1, 2, …, n} with exactly k fixed points. Show that ∑ = n! Chapter 6: Counting in Two Ways 25 5. [Corradi’s Lemma] (U*) Let A1, A2, …, An be r-element subsets of a set X. Suppose that Ai ⋂ ≤ k for all 1 ≤ i < j ≤ n. Show that |X| ≥ . 6. [Erdos-Ko-Rado] (U*) Let F be a family of k-element subsets of {1, 2, …, n} such that every two sets in F intersect in at least one element. Show that |F| ≤ ( ). 7. [Indian Postal Coaching 2011] In a lottery, a person must select six distinct numbers from {1, 2, …, 36} to put on a ticket. The lottery committee will then draw six distinct numbers randomly from {1, 2, …, 36}. Any ticket not containing any of these 6 numbers is a winning ticket. Show that there exists a set of nine tickets such that at least one of them will certainly be a winning ticket, whereas this statement is false if 9 is replaced by 8. 8. [Hong Kong 2007] In a school there are 2007 girls and 2007 boys. Each student joins at most 100 clubs in the school. It is known that any two students of opposite genders have joined at least one common club. Show that there is a club with at least 11 boys and 11 girls. 9. [IMO Shortlist 1995, C5] At a meeting of 12k people, each person exchanges greetings with exactly (3k + 6) others. For any two people, the number of people who exchange greetings with both of them is the same. How many people are at the meeting? 10. [Based on Furedi’s result on maximal intersecting families] Let n and k be positive integers with n > 2k – 1, and let F be a family of subsets of {1, 2, …, n} such that each set in F contains k elements, and every pair of sets in F has nonzero Olympiad Combinatorics 26 intersection. Suppose further that for any k-element subset X of {1, 2, …, n} not in F, there exists a set Y in F such that X ⋂ = . Show that there are at least ( ) ( ) sets in F. 11. [IMO Shortlist 2000, C3] Let n > 3 be a fixed positive integer. Given a set S of n points P1, P2, …, Pn in the plane such that no three are collinear and no four concyclic, let at be the number of circles Pi Pj Pk that contain Pt in their interior, and let m(S) = a1 + a2 + … + an. Prove that there exists a positive integer f(n) depending only on n such that the points of S are the vertices of a convex polygon if and only if m(S) = f(n). 12. [Iran 2010] There are n students in a school, and each student can take any number of classes. There are at least two students in each class. Furthermore, if two different classes have two or more students in common, then these classes have a different number of students. Show that the number of classes is at most (n – 1) 2. 13. [IMO Shortlist 2004, C4] Consider a matrix of size n × n whose entries are real numbers of absolute value not exceeding 1. The sum of all entries of the matrix is 0. Let n be an even positive integer. Determine the least number C such that every such matrix necessarily has a row or a column with the sum of its entries not exceeding C in absolute value. 14. [Generalization of USAMO 2011, Problem 6] Let A1, A2, …, An be sets such that |Ai| = ( ) for each 1 ≤ i ≤ n and | ⋂ | = (n – 2) for each 1 ≤ i < j ≤ n. Show that |A1 ∪ A2 ∪ … ∪ An|≥ ( ), and show that it is possible for equality to occur. Chapter 6: Counting in Two Ways 27 15. [Iran 1999] Suppose that C1, C2, …, Cn (n ≥ 2) are circles of radius one in the plane such that no two of them are tangent, and the subset of the plane formed by the union of these circles is connected. Let S be the set of points that belong to at least two circles. Show that |S| ≥ n. 16. [IMO Shortlist 2000, C5] Suppose n rectangles are drawn in the plane. Each rectangle has parallel sides and the sides of distinct rectangles lie on distinct lines. The rectangles divide the plane into a number of regions. For each region R let v(R) be the number of vertices. Take the sum of v(R) over all regions which have one or more vertices of the rectangles in their boundary. Show that this sum is less than 40n. 17. [Indian TST 1998] Let X be a set of 2k elements and F a family of subsets of X each of cardinality k such that each subset of X of cardinality (k – 1) is contained in exactly one member of F. Show that (k + 1) is a prime. 18. [IMO Shortlist 1988] For what values of n does there exist an n × n array of entries - 1, 0 or 1 such that the 2n sums obtained by summing the elements of the rows and the columns are all different? 19. [IMO 2001, Problem 3] Twenty-one girls and twenty-one boys took part in a mathematical competition. It turned out that each contestant solved at most six problems, and for each pair of a girl and a boy, there was at least one problem that was solved by both the girl and the boy. Show that there is a problem that was solved by at least three girls and at least three boys. Olympiad Combinatorics 28 20. [IMO 2005, Problem 6] In a mathematical competition 6 problems were posed to the contestants. Each pair of problems was solved by more than 2/5 of the contestants. Nobody solved all 6 problems. Show that there were at least 2 contestants who each solved exactly 5 problems. 21. Let A be a set with n elements, and let A1, A2, …, An be subsets of A such that |Ai| ≥ 2 for each 1 ≤ i ≤ n. Suppose that for each 2-element subset A’ of A, there is a unique i such that A’ is a (not necessarily proper) subset of Ai. Show that for all pairs (i, j) such that 1 ≤ i < j ≤ n, Ai ∩ Aj > 0. 22. [USAMO 1999 proposal] Let n, k and m be positive integers with n > 2k. Let S be a nonempty set of k-element subsets of {1, 2, …, n} such that every (k + 1)-element subset of {1, 2, …, n} contains exactly m elements of S. Prove that S must contain every k-element subset of {1, 2, …, n}. 23. [Based on Zarankeiwicz’ problem] At a math contest there were m contestants and n problems. It turned out that there were numbers a < m and b < n such that there did not exist a set of a contestants and b problems such that all a contestants solved all b problems. Define the score of each contestant to be the number of problems he solved, and let S denote the sum of the scores of all m contestants. Show that S ≤ (a – 1) 1/b nm 1-1/b + (b – 1)m. 24. [IMO Shortlist 2007, C7] Let < √ be a positive real number. Prove that there exist positive integers n and p > 2n for which one can select 2p pairwise distinct subsets S1, S2, …, Sp, T1, T2, …, Tp of the set {1, 2, …, n} such that Si ⋂ ≠ for all 1 ≤ i, j ≤ p. Olympiad\t Combinatorics\t \t \t \t \t Pranav\tA.\tSriram\t August 2014\t Chapter 7: Extremal Combinatorics 1 Copyright notices \t All USAMO and USA Team Selection Test problems in this chapter are copyrighted by the Mathematical Association of America’s American Mathematics Competitions. © Pranav A. Sriram. This document is copyrighted by Pranav A. Sriram, and may not be reproduced in whole or part without express written consent from the author. About the Author Pranav Sriram graduated from high school at The International School Bangalore, India, and is currently pursuing undergraduate studies at Stanford University. Chapter 7: Extremal Combinatorics 1 7. EXTREMAL COMBINATORICS \t \t \t Introduction \t Extremal\t combinatorics\t is,\t in\t essence,\t the\t combinatorics\t of\t superlatives.\t Problems\t in\t this\t field\t typically\t revolve\t around\t finding\t or\t characterizing\t the\t maximum,\t minimum,\t best,\t worst,\t biggest\tor\tsmallest\tobject,\tnumber\tor\tset\tsatisfying\ta\tcertain\tset\tof\t constraints.\tThis\tchapter\tand\tthe\tnext\ttwo\twill\ttake\tus\tto\tthe\theart\t of\t combinatorics,\t and\t will\t represent\t a\t deep\t dive\t into\t the\t intersection\t of\t Olympiad\t mathematics,\t classical\t combinatorics,\t and\t modern\t research\t in\t the\t field.\t Extremal\t combinatorics\t is\t an\t actively\t researched\t area,\t with\t deep\t connections\t to\t fundamental\t problems\t in\t theoretical\t computer\t science,\t operations\t research\t and\tstatistical\tlearning\ttheory.\tEntire\tbooks\thave\tbeen\tdevoted\tto\t the\t subject\t (and\t rightfully\t so),\t so\t we\t will\t not\t be\t able\t to\t do\t complete\t justice\t to\t this\t field\t in\t a\t single\t chapter.\t However,\t the\t powerful\tarsenal\tof\ttools\twe\thave\tbuilt\tup\tin\tthe\tfirst\tsix\tchapters\t has\t already\t done\t much\t of\t our\t work\t for\t us:\t indeed,\t pretty\t much\t every\ttechnique\twe\thave\tseen\tso\tfar\thas\ta\trole\tto\tplay\tin\textremal\t combinatorics.\tThis\tchapter,\t then,\t will\t develop\t specialized,\t niche\t methods\tfor\textremal\tcombinatorics,\tas\twell\tas\tdemonstrate\thow\t to\t effectively\t exploit\t combinatorial\t structure\t to\t apply\t classical\t techniques\t like\t induction\t effectively\t in\t the\t context\t of\t extremal\t problems.\t\t\t Olympiad Combinatorics 2 \t \t Injections and Bijections \t One\t simple\t way\t to\t compare\t the\t cardinalities\t of\t sets\t is\t to\t find\t mappings\tbetween\tthem.\tFor\tinstance,\tsuppose\tI\thave\ttwo\tsets\tS\t and\tT,\tand\ta\tfunction\tf\tmapping\telements\tfrom\tS\tto\telements\tof\tT.\t If\tf\tis\tinjective\t–\tthat\t is,\tf(x)\t =\tf(y)\t if\t and\t only\t if\tx\t=\ty\t–\tthen\t it\t follows\tthat\tT\tmust\thave\tat least\tas\tmany\telements\tas\tS.\tMoreover,\t if\tf\tis\t also\tsurjective\t-\tthat\t is,\t all\t elements\t in\tT\tare\t mapped\tto\t by\t some\telement\tin\tS\t-\tthen\tit\tfollows\tthat\t|S|\t=\t|T|.\tA\tfunction\tthat\tis\t injective\tand\tsurjective\tis\tcalled\ta\tbijection.\t\t \t The\t basic\t idea\t in\t this\t section\t will\t be\t to\t construct\t functions\t between\tcarefully\tchosen\tsets.\tThe\tchoice\tof\tthese\tsets\twill\tenable\t us\t to\t exploit\t information\t given\t in\t the\t problem\t in\t order\t to\t conclude\tthat\tour\tfunction\tis\tinjective\tor\tbijective.\tThis\tconclusion\t will\t give\t us\t quantitative\t results\t relating\t the\t sizes\t of\t the\t sets,\t which\twill\thopefully\treduce\tto\tthe\tresult\twe\tare\ttrying\tto\tprove.\t\t \t Example 1 [APMO 2008] Students\tin\ta\tclass\tform\tgroups.\tEach\tgroup\tcontains\texactly\tthree\t members\tand\tany\ttwo\tdistinct\tgroups\thave\tat\tmost\tone\tmember\t in\t common.\t Prove\t that\t if\t there\t are\t 46\t students\t in\t the\tclass,\t then\t there\t exists\t a\t set\t of\t at\t least\t10\tstudents\t in\t which\t no\t group\t is\t properly\tcontained.\t\t \t Answer: Let\tT\tbe\tthe\tset\tof\t46\tstudents.\tTake\tthe\tlargest\tset\tS\tof\tstudents\t such\t that\t no\t group\t is\t properly\t contained\t in\t S.\t Now\t take\t any\t student\tX\tnot\t in\tS.\t By\t the\t maximality\t of\tS,\t there\t exists\t a\t group\t containing\tX\tand\ttwo\tstudents\tof\tS\t(otherwise\twe\tcould\tadd\tX\tto\tS,\t contradicting\tmaximality).\tThis\tsuggests\tthe\tfollowing\tmapping:\tif\t (A,\tB,\tX)\t is\t this\t group,\t define\t a\t mapping\t from\tT\t\\\tS\tto\t pairs\t in\tS\t such\tthat\tf(X)\t=\t(A,\tB).\tThis\tmapping\tis\tinjective\tbecause\tif\tf(Y)\t=\t f(Z)\tfor\tsome\tY\t≠\tZ,\tthen\tboth\t(Y,\tC,\tD)\tand\t(Z,\tC,\tD)\tare\tgroups\tfor\t Chapter 7: Extremal Combinatorics 3 some\t (C,\tD),\t contradicting\t the\t fact\t that\t any\t two\t groups\t have\t at\t most\tone\tcommon\tstudent.\tThe\tinjectivity\timplies\t| T\t\\\tS\t|\t≤\t\u0000 |\u0000| \u0000\u0000,\t or\t(46-|S|)\t≤\t\u0000 |\u0000| \u0000\u0000.\tSimplifying\tgives\t|S|\t≥\t10.\t■\t \t Example 2 [IMO Shortlist 1988] Let\tN\t=\t {1,\t 2,\t …,\tn},\t with\tn\t≥\t 2.\t A\t collection\tF\t=\t {A1,\tA2,\t …,\tAt}\t of\t subsets\tof\tN\tis\tsaid\tto\tbe\tseparating,\tif\tfor\tevery\tpair\t{x,\ty}\tthere\tis\t a\tset\tAi\tє\tF\tso\tthat\tAi\t⋂{\u0000,\u0000}\tcontains\tjust\tone\telement.\tF\tis\tsaid\tto\t be\tcovering,\tif\tevery\telement\tof\tN\tis\tcontained\tin\tat\tleast\tone\tset\tAi\t є\tF.\tWhat\tis\tthe\tsmallest\tvalue\tof\tt\tin\tterms\tof\tn\tso\tthat\tthere\tis\ta\t family\tF\t=\t {A1,\tA2,\t …,\tAt}\t which\t is\t simultaneously\t separating\t and\t covering?\t \t Answer: Associate\teach\telement\tm\tof\tN\twith\ta\tbinary\tstring\tx1x2…xt,\twhere\t xi\t=\t1\tif\tm\tis\tin\tset\tAi\tand\t0\tif\tm\tis\tnot\tin\tAi.\tThe\tcondition\tthat\tF\tis\t separating\t simply\t means\t that\t distinct\t elements\t of\tN\twill\t be\t mapped\tto\tdistinct\tbinary\tstrings.\tThe\tcondition\tthat\tF\tis\tcovering\t means\tthat\tno\telement\tof\tN\twill\tbe\tmapped\tto\t(0,\t0,\t…,\t0).\t\t \t Thus\t we\t have\tn\tdistinct\t binary\t strings\t of\t length\tt,\t none\t of\t which\t is\t the\t all\t 0\t string.\t This\t implies\tn\t≤\t 2 t–1.\t Conversely,\t if\t we\t indeed\thave\tn\t≤\t2 t –1,\tthen\ta\tconstruction\tis\teasy\tby\treversing\tthe\t above\t process:\t first\t label\t each\t element\t with\t a\t different\t binary\t string\tand\tthen\tplace\tit\tinto\tthe\tappropriate\tsets.\tThus\tn\t≤\t2 t–1\tis\t necessary\tand\tsufficient,\tso\tt\t=\t⌊log\u0000\u0000⌋+1\tis\tthe\tanswer.\t■\t \t Remark:\tThis\tidea\tof\tassociating\telements\twith\tbinary\tstrings\tis\t more\t than\t just\t a\t useful\t trick\t on\t Olympiads\t–\tin\t fact,\t it\t plays\t an\t important\t role\t in\t a\t whole\t branch\t of\t combinatorics\t known\t as\t algebraic\tcombinatorics,\twhere\tthese\tbinary\t“strings”\tare\tactually\t treated\t as\t vectors.\t Algebraic\t manipulations\t of\t these\t vectors\t (which\toften\ttake\tplace\tmod\t2\tor\tin\tsome\tother\tfield)\tcan\tproduce\t surprising\tcombinatorial\tresults.\t\t Olympiad Combinatorics 4 \t Example 3 [IMO 2006-2] A\t diagonal\t of\t a\t regular\t 2006-gon\t is\t called\todd\tif\t its\t endpoints\t divide\t the\t boundary\t into\t two\t parts,\t each\t composed\t of\t an\t odd\t number\tof\tsides.\tSides\tof\t the\t2006-gon\t are\t also\tregarded\t as\t odd\t diagonals.\tSuppose\tthe\t2006-gon\thas\tbeen\tdissected\tinto\ttriangles\t by\t 2003\t nonintersecting\t diagonals.\tDefine\t a\tgood triangle\tas\t an\t isosceles\ttriangles\twith\ttwo\todd\tsides.\tFind\tthe\tmaximum\tnumber\t of\tgood\ttriangles.\t \t Answer: Note\t a\t good\t triangle\thas\t two\t odd\t sides\t and\t an\t even\t side;\t hence\t the\tpair\tof\tequal\tsides\tmust\tbe\tthe\todd\tsides.\t\t \t Experimentation\twith\t 2006\t replaced\t by\t small\t even\t numbers\t hints\tthat\t the\t general\t answer\t for\t a\tregular\t2n-gon\t is\tn.\t This\t is\t attainable\tby\tdrawing\tall\tdiagonals\tof\tthe\tform\tA2kA2k+2,\twhere\tA1,\t A2,\t …,\t A2n\tare\t the\t vertices\t of\t the\t 2n-gon.\t Now\t we\t show\t this\t is\t indeed\tthe\tmaximum.\t \t Consider\t a\t 2n-gon\tP.\t To\t simplify\t notation,\t draw\t the\t circumcircle\t of\tP.\t For\t a\t side\tAB\tin\t a\t triangle\tABC,\t “arc\tAB”\t will\t denote\t the\t arc\t of\t the\t circumcircle\t not\t containing\t C.\tArc\t AB\t is\t a\t “good\tarc”\tif\tAB\tis\todd\tin\ta\tgood\ttriangle\tABC.\t\t \t Our\t basic\t idea\t is\t to\t construct\t a\t mapping\tf\tfrom\t sides\t of\tP\tto\t good\t triangles\tsuch\t that\t each\t good\t triangle\t is\t mapped\t to\tby\t at\t least\t2\t sides,\t and\t no\t side\tis\t mapped\t to\tmore\t than\t one\t good\t triangle.\tThis\twill\timmediately\timply\tthe\tresult.\t\t \t Consider\t a\t side\t XY\t of\tP.\t Let\t AB\t denote\t the\tsmallest\t good\t arc\t containing\t vertices\t X\t and\t Y,\t if\t it\t exists.\t (Note\t that\t {A,\t B}\t may\t be\t equal\tto\t{X,\tY}.)\tLet\tC\tbe\tthe\tthird\tvertex\tof\tthe\tgood\ttriangle\tABC.\t Then\twe\twill\tmap\tXY\tto\tABC:\tf(XY)\t=\tABC.\t\t \t All\twe\tneed\tto\tshow\tis\tthat\teach\tgood\ttriangle\tis\tmapped\tto\tby\t at\tleast\ttwo\tsides.\tIn\tfact,\tfor\ta\tgood\ttriangle\tDEF,\twith\tDE\tand\tEF\t Chapter 7: Extremal Combinatorics 5 odd,\t we\t will\tshow\t that\t at\t least\t one\tside\t of\tP with\tvertices\t in\tarc\t DE\tis\tmapped\tto\ttriangle\tDEF;\tthe\tsame\targument\twill\thold\tfor\tEF\t and\twe\twill\thence\thave\ttwo\tsides\tmapped\tto\tDEF.\t \t Suppose\tto\tthe\tcontrary\tthat\tno\tside\twith\tvertices\tin\tarc\tDE\tis\t mapped\tto\tDEF.\tConsider\tsome\tside\tRS\tof\tP with\tvertices\tR\tand\tS\t in\tarc\tDE.\tLet\tf(RS)\t=\tD’E’F’\tfor\tsome\tD’,\tE’,\tF’\tlying\ton\tarc\tDE\twith\t D’E’\t and\t E’F’\t the\t odd\t sides\t of\t good\t triangle\t D’E’F’.\t Then\tby\t symmetry,\t the\t side\t of\tP that\t is\t the\t reflection\t of\t RS\t across\t the\t perpendicular\tbisector\tof\tD’F’\twill\talso\tbe\tmapped\tto\tD’E’F’.\t\t \t In\tthis\tmanner,\tsides\tin\tarc\tDE\tcan\tbe\tpaired\tup,\twith\teach\tpair\t of\tsides\tbeing\tmapped\tto\tthe\tsame\ttriangle.\tBut\tthere\tare\tan\todd\t number\t of\t sides\t in\t arc\t DE,\t so\t they\t cannot\t all\t be\t paired\t up.\t Contradiction.\t■ \t \t \t The Alternating Chains Technique (Yes, I made that name up) \t The\tbasic\tidea\tthat\twe\twill\tuse\tin\tsome\tform\tor\tthe\tother\tfor\tthe\t next\t few\t problems\t is\t a\t simple\t consequence\tof\t the\t pigeonhole\t principle.\t Suppose\t you\t have\t n\t points\t on\t a\t line,\t and\t you\t are\t allowed\tto\tmark\tsome\tof\tthem\tsuch\tthat\tno\tconsecutive\tpoints\tare\t marked.\t Then\t the\t maximum\t number\t of\t points\t you\t can\t mark\t is\t ⌈\u0000/2⌉,\tand\tthis\tcan\tbe\tachieved\tby\tmarking\talternate\tpoints.\tIf\tthe\t n\t points\t were\t on\t a\t circle\t and\t not\t a\t line\t segment,\t then\t the\t maximum\t would\t be\t⌊\u0000/2⌋.\t These\t obvious\t statements\t can\t be\t cleverly\tapplied\tin\tseveral\tcombinatorial\tsettings.\t\t \t Example 4 [IMO Shortlist 1990] Let\tn\t≥\t 3\tand\t consider\t a\tset\tE\tof\t 2n-1\tdistinct\t points\t on\t a\tcircle.\t Suppose\tthat\texactly\tk\tof\tthese\tpoints\tare\tto\tbe\tcolored\tred.\tSuch\ta\t coloring\tis\tgood\tif\tthere\tis\tat\tleast\tone\tpair\tof\tred\tpoints\tsuch\tthat\t Olympiad Combinatorics 6 the\t interior\t of\t one\t of\t the\t arcs\t between\t them\t contains\t exactly\t n\t points\t from\tE.\t Find\t the\t smallest\t value\t of\tk\tso\t that\t every\t such\t coloring\tof\tk\tpoints\tof\tE\tis\tgood.\t \t Answer: Let\tj\tbe\t maximum\t number\t of\t colored\t points\t a\tbad\tcoloring\t can\t have.\tThen\tk\t=\tj+1,\tso\tit\tsuffices\tto\tfind\tj.\t\t \t Let\tthe\tpoints\tbe\tA1,\tA2,\t…,\tA2n-1.\tJoin\tvertices\tAi\tand\tAi+n+1\tby\tan\t edge\t for\t each\ti\t(indices\t modulo\t 2n-1).\t This\t decomposes\tE\tinto\t disjoint\t cycles.\t The\t coloring\t is\t bad\t if\t and\t only\t if\t no\t two\t red\t vertices\tare\tjoined\tby\tan\tedge.\tIn\tother\twords,\tno\ttwo\tconsecutive\t vertices\t in\t the\t cycle\t are\t both\t red.\t How\t many\t cycles\t are\tthere?\t Using\t elementary\t number\t theory,\t it\t is\t easy\t to\t show\t that\t the\t number\tof\tcycles\tis\tequal\tto\tgcd\t(n+1,\t2n-1).\t\t \t Since\t2n-1\t=\t2(n+1)–3,\tgcd (n+1,\t2n-1)\t=\t3\tif\tn+1\tis\tdivisible\tby\t 3,\tand\tgcd (n+1,\t2n-1)\t=\t1\totherwise.\tIf\tgcd (n+1,\t2n-1)\t=\t1,\twe\tget\t only\tone\t cycle\t containing\t all\t 2n-1\t points.\t Then\tj\t=\tn-1\t by\t our\t earlier\tdiscussion.\tHence\tk\t=\tj+1\t=\tn.\t \t Figure 7.1. 1\t 2\t 3\t 4\t5\t 6\t 7\t Chapter 7: Extremal Combinatorics 7 \t Figure 7.2. \t If\tgcd(n+1,\t2n-1)\t=\t3,\tthen\twe\tget\t3\tcycles,\teach\tcontaining\t \u0000\u0000\u0000\u0000 \u0000 \t vertices.\tEach\tcycle\tthen\tcan\thave\tat\tmost\t⌊(2\u0000−1)/6⌋\tred\tpoints\t in\t a\t bad\t coloring.\t Thus\t at\t most\t 3⌊(2\u0000−1)/6⌋\tpoints\tin\t total\tcan\t be\t colored\t in\t a\t bad\t coloring.\t Hence\tk\t=\t 3⌊(2\u0000−1)/6⌋+1\t if\t 3\t divides\tn+1,\tand\tk\t=\tn\totherwise.\t■\t \t Example 5 [USAMO 2008, Problem 3] Let\tn\tbe\ta\tpositive\tinteger.\tDenote\tby\tSn\tthe\tset\tof\tpoints\t(x,\ty)\twith\t integer\tcoordinates\tsuch\tthat\t|x|\t+\t|y+½|\t≤\tn.\tA\tpath\tis\ta\tsequence\t of\tdistinct\tpoints\t(x1,\ty1),\t(x2,\ty2),\t…,\t(xk,\tyk)\tin\tSn\tsuch\tthat,\tfor\ti\t=\t1,\t 2,\t…,\tk-1,\tthe\tdistance\tbetween\t(xi,\tyi)\tand\t(xi+1,\tyi+1)\tis\t1\t(in\tother\t words,\tthe\tpoints\t(xi,\tyi)\tand\t(xi+1,\tyi+1)\tare\tneighbors\tin\tthe\tlattice\t of\t points\t with\t integer\t coordinates).\t Prove\t that\t the\t points\t in\tSn\t cannot\t be\t partitioned\t into\t fewer\t than\tn\tpaths\t (a\t partition\t of\tSn\t into\tm\tpaths\tis\ta\tset\tP\tof\tm\tnonempty\tpaths\tsuch\tthat\teach\tpoint\tin\t Sn\tappears\tin\texactly\tone\tof\tthe\tm\tpaths\tin\tP).\t \t Answer: Color\t the\t points\t of\t each\t row\t of\tSn\talternately\t red\t and\t black,\t starting\t and\t ending\t with\t red.\t Any\t two\t neighboring\t points\t are\t of\t opposite\tcolor,\tunless\tthey\tare\tfrom\tthe\tmiddle\ttwo\trows.\t\t 1 2 3 4 5 6 7 8 9 Olympiad Combinatorics 8 \t Consider\ta\tpartition\tof\tSn\tinto\tm\tpaths,\tfor\tsome\tm.\t\tFor\teach\tof\t the\tm\tpaths,\t split\t the\t path\t into\t two\t paths\t wherever\t there\t are\t consecutive\t red\t points.\t Now\t no\t path\t has\t consecutive\t red\t points.\t Further,\t since\t there\t are\tn\tpairs\t of\t consecutive\t red\t points\t in\tSn\t (from\tthe\tmiddle\ttwo\trows),\twe\thave\tsplit\tpaths\tat\tmost\tn\ttimes.\t Thus\t we\t now\t have\t at\t most\tm+n\tpaths\t (each\t split\t increases\t the\t number\tof\tpaths\tby\tone).\t\t \t Figure 7.3. Example for n = 3 \t Now,\tthere\tare\t2n\tmore\tred\tpoints\tthan\tblack\tpoints\tin\tSn,\tbut\t each\tof\tthe\tm+n\tpaths\tcontains\tat\tmost\tone\tmore\tred\tpoint\tthan\t black\tpoint\t(since\tno\tpath\tcontains\tconsecutive\tred\tpoints).\tThus\t we\tobtain\tm+n\t≥\t2n,\tor\tm\t≥\tn,\tproving\tthe\tresult.\t■\t \t In\tthe\tnext\texample,\tin\torder\tto\tuse\tthe\tchain\tdecomposition\tidea\t we\t need\t some\t starting\tpoint,\t that\t is,\t some\t information\t or\t assumption\tthat\tlends\tenough\tstructure\tto\tthe\tproblem\tfor\tus\tto\t exploit.\tTo\tthis\tend,\twe\tuse\tthe\textremal\tprincipal\tby\tconsidering\t the\tsmallest\telement\tin\ta\tcertain\tset.\t\t \t Example 6 [USAMO 2009-2] Let\tn\tbe\ta\tpositive\tinteger.\tDetermine\tthe\tsize\tof\tthe\tlargest\tsubset\t S\tof\tN\t=\t{-n,\t-n+1,\t…,\tn-1,\tn}\twhich\tdoes\tnot\tcontain\tthree\telements\t Chapter 7: Extremal Combinatorics 9 (a,\tb,\tc)\t(not\tnecessarily\tdistinct)\tsatisfying\ta +\tb +\tc\t=\t0.\t \t Answer: Obviously\t0\tis\tnot\tin\tS\tsince\t0+0+0\t=\t0.\tWe\tclaim\tthe\tanswer\tis\tn\tif\t n\tis\t even\t and\t (n+1)\t if\tn\tis\t odd.\t These\t bounds\t can\t clearly\t be\t achieved\t by\t taking\t all\t the\t odd\t numbers\t in\tN, since\t the\t sum\t of\t three\todd\tnumbers\tcan\tnever\tbe\t0.\tTo\tshow\tthis\tis\tthe\tmaximum,\t let\tj\tbe\tthe\telement\tof\tsmallest\tabsolute\tvalue\tin\tS\t(if\tboth\tj\tand\t–j\t are\tpresent,\tconsider\tthe\tpositive\tone).\tAssume\tWLOG\tthat\tj\t>\t0,\t and\tlet\tT\tdenote\tthe\tset\tof\telements\twith\tabsolute\tvalue\tat\tleast\tj.\t Note\tthat\tall\telements\tof\tS\tare\tin\tT.\t\t \t Case 1:\t (-j)\t is\t not\t in\tS.\t Consider\t the\t pairs\t (j,\t–2j),\t (j+1,\t–(2j+1)),\t (j+2,\t–(2j+2)),\t ….,\t (n–j,\t–n).\t In\t each\t of\t these\t pairs\t the\t sum\t of\t the\t numbers\t is\t (-j),\t so\t at\t most\t one\t of\t the\t two\t elements\t is\t in\tS\t (otherwise\tthe\tsum\tof\tthe\ttwo\telements\tplus\tj\twould\tbe\t0).\tThere\t are\t exactly\t (n-2j+1)\t pairs,\t so\t at\t most\t (n-2j+1)\t of\t the\t paired\t numbers\tare\tin\tS.\t\t \t Furthermore,\tthere\tare\texactly\t2j-1\tunpaired\tnumbers\tin\tT\t\\\t{-j}:\t\tj\t positive\t unpaired\t numbers\t (namely\tn,\tn–1,\t …,\tn–j+1),\t and\t (j–1)\t\t negative\t unpaired\t numbers\t (namely\t–(j+1),\t–(j+2),\t …,\t–(2j–1)).\t Thus\tthe\tmaximum\tnumber\tof\telements\tin\tS\tis\t(2j–1)\t+\t(n–2j+1)\t=\t n.\t\t \t Case 2:\t(–j)\tis\talso\tin\tS.\tNow\twe\tuse\tthe\tchain\tdecomposition\tidea.\t If\ta\tand\tb\tare\telements\tin\tT,\tthen\ta\tis\tjoined\tto\tb\tby\tan\tedge\tif\tand\t only\t if\ta+b\t=\tj\tor\ta+b\t=\t–j.\t This\t ensures\t that\t no\t two\t elements\t joined\tby\tan\tedge\tcan\tboth\tbe\tin\tS.\tEach\telement\tx\tin\tT\tis\tjoined\tto\t at\tleast\tone\tand\tat\tmost\ttwo\tother\telements\tof\tT\t((j–x)\tand\t(–j–x)).\t Hence\t the\t elements\t of\tT\thave\t been\t partitioned\t into\t disjoint\t chains.\t\t \t Olympiad Combinatorics 10 \t Figure 7.4: n = 13, j = 3. There are 6 chains, of which 2 are shown. \t \t Now\t the\t rest\t is\t just\t counting.\t There\t are\t exactly\t 2j\tchains,\t namely\t the\t chains\t starting\t with\t ±j,\t ±(j+1),\t …,\t ±(2j-1).\t Let\t the\t lengths\tof\tthese\tchains\tbe\tl1,\tl2,\t…,\tl2j.\tFrom\ta\tchain\tof\tlength\tli,\tat\t most\t\u0000 \u0000\u0000 \u0000\u0000\telements\tcan\tbe\tin\tS.\tThus\tthe\ttotal\tnumber\tof\telements\t we\tcan\ttake\tis\tat\tmost\t\t \t ∑ \u0000 \u0000\u0000 \u0000\u0000 \u0000\u0000 \u0000\u0000\u0000 \t≤\t∑ \u0000\u0000\u0000\u0000 \u0000 \u0000\u0000 \u0000\u0000\u0000 \t=\tj\t+\t ∑ \u0000\u0000 \u0000\u0000 \u0000\u0000\u0000 \u0000 \t=\tj\t+\t \u0000\u0000\u0000\u0000(\u0000\u0000\u0000) \u0000 \t=\tn+1.\t \t Here\twe\tused\t∑ \u0000\u0000 \u0000\u0000 \u0000\u0000\u0000 \t=\t2n\t–\t2(j-1)\tsince\tboth\tsides\tare\tequal\tto\t the\tnumber\tof\telements\tof\tabsolute\tvalue\tat\tleast\tj.\t\t \t Now\twe\tare\tdone\tif\tn\tis\todd.\tIf\tn\tis\teven,\twe\tneed\tto\ttighten\tour\t bound\tto\tn.\tFor\tthis\twe\tnote\tthat\tthe\tinequality\t∑ \u0000 \u0000\u0000 \u0000\u0000 \u0000\u0000 \u0000\u0000\u0000 \t≤\t∑ \u0000\u0000\u0000\u0000 \u0000 \u0000\u0000 \u0000\u0000\u0000 \t is\tstrict\tif\tthere\tis\ta\tchain\tof\teven\tlength,\tsince\t\u0000 \u0000 \u0000\u0000\tis\tstrictly\tless\t than\t \u0000\u0000\u0000 \u0000 \tfor\t even\tx.\t It\t now\t suffices\t to\t prove\t the\t existence\t of\t a\t chain\tof\teven\tlength\tif\tn\tis\teven;\tthis\tis\tpretty\tsimple\tand\tis\tleft\tto\t the\treader.\t■\t \t \t \t 9\t 10\t 11\t 12\t 13\t -9\t-10\t-11\t -12\t -13\t 1\t 2\t 3\t 4\t 5\t 6\t 7\t 8\t -1\t -2\t -3\t -4\t -5\t -6\t -7\t -8\t Chapter 7: Extremal Combinatorics 11 \t \t Two problems on boards \t We\tnow\tlook\tat\ttwo\tproblems\tbased\ton\tn×n\tboards\tthat\tinitially\t look\t quite\t similar\t but\t are\t actually\t very\t different.\t Through\t these\t two\t problems\t we\t will\t demonstrate\t two\t important\t ways\t of\t thinking\tabout\tand\texploiting\tthe\tstructure\tof\tboards.\t \t The\t following\t example\t uses\t the\t idea\t of\t examining\t individual\t objects’\tcontributions\ttoward\tsome\ttotal.\tWe\tsaw\ta\tsimilar\tidea\tin\t examples\t5\tand\t6\tfrom\tchapter\t3.\t\t \t Example 7 [USAMO 1999-1] Some\t checkers\t placed\t on\t an\tn×n\tcheckerboard\t satisfy\t the\t following\tconditions:\t\t \t a) Every\t square\t that\t does\t not\t contain\t a\t checker\t shares\t a\t side\t with\tone\tthat\tdoes;\t\t b) Given\t any\t pair\t of\t squares\t that\t contain\t checkers,\t there\t is\t a\t sequence\tof\tsquares\tcontaining\tcheckers,\tstarting\tand\tending\t with\t the\t given\t squares,\t such\t that\t every\t two\t consecutive\t squares\tof\tthe\tsequence\tshare\ta\tside.\t\t \t Prove\tthat\tat\tleast\t \u0000\u0000\u0000\u0000 \u0000 \tcheckers\thave\tbeen\tplaced\ton\tthe\tboard.\t \t Answer: Suppose\t we\t have\t an\t empty\t board,\t and\t we\t want\t to\t create\t an\t arrangement\t of\tk\tcheckers\t satisfying\t (a)\t and\t (b).\t Call\t a\t square\t good\tif\t it\t contains\t a\t checker\t or\t shares\t a\t side\t with\t a\t square\t containing\t a\t checker.\t By\t (a),\t every\t square\t must\t eventually\t be\t good.\tLet\tus\tplace\tthe\tcheckers\ton\tthe\tboard\tas\tfollows:\tplace\tone\t checker\t on\t the\t board\t to\t start,\t and\t then\t in\t each\t step\t place\t one\t checker\t adjacent\t to\t one\t that\t has\t already\t been\t placed.\t Since\t any\t arrangement\t of\t checkers\t that\t satisfies\t the\t problem\t must\t be\t Olympiad Combinatorics 12 connected\t by\t (b),\t we\t can\t form\t any\t arrangement\t of\t checkers\t in\t this\tmanner.\t \t In\tthe\tfirst\tstep\tat\tmost\t5\tsquares\tbecome\tgood\t(the\tsquare\twe\t placed\tthe\tchecker\ton\tand\tits\tneighbors).\tIn\teach\tsubsequent\tstep,\t at\t most\t 3\t squares\t that\t are\tnot\talready\tgood\tbecome\tgood:\t the\t square\t we\t just\t put\t a\t checker\t on\t and\t the\t square\t next\t to\t it\t are\t already\tgood,\tleaving\t3\tneighbors\tthat\tcould\tbecome\tgood.\tThus,\t at\tthe\tend\tof\tplacing\tk\tcheckers,\tat\tmost\t5+3(k-2)\t=\t3k+2\tsquares\t are\tgood.\tBut\twe\tknow\tall\tn 2 \tsquares\tare\tgood\tat\tthe\tend,\tso\tn 2 \t≤\t 3k+2,\tproving\tthe\tresult.\t■\t \t Remark 1: Initially\t the\t problem\t appears\t difficult\tdue\t to\t the\t fact\t that\t a\t given\t square\t may\t be\tgood due\t to\t more\t than\t one\t checker.\t This\tmakes\tit\thard\tto\tcalculate\t“individual\tcontributions”,\tthat\tis,\t the\tnumber\tof\tsquares\tthat\tare\tgood\tbecause\tof\ta\tcertain\tchecker.\t We\t get\t around\t this\t problem\t by\t imagining\t the\t k\t checkers\t being\t added sequentially,\trather\tthan\tsimply\t“being\tthere.”\tThis\tallowed\t us\tto\tmeasure\tthe\t“true\tcontribution”\tof\ta\tchecker\tby\tnot\tcounting\t its\t neighbors\t that\t are\talready\tgood.\t This\t was\t just\t a\t simple\t example,\t but\t the\t ideas\t of\t introducing\t an\t element\t of\t time\t and\t adopting\t a\t dynamic\t view\t of\t a\t static\t problem\t have\t powerful\t applications\tin\tcombinatorics\tand\talgorithms.\t\t \t Remark 2:\t The\t only\t property\t of\t the\t board\t we\t are\t using\t is\t that\t any\t square\t has\t at\t most\t 4\t neighboring\t squares.\t Thus\t we\t can\t actually\t think\t of\t the\t board\t as\t a\t graph\t with\t vertices\t representing\t squares\t and\t two\t vertices\t being\t connected\t if\t and\t only\t if\t they\t correspond\tto\tadjacent\tsquares\ton\tthe\tboard.\tThis\tinterpretation\t of\t problems\t involving\tn×n\tboards\t is\t often\t very\t useful,\t and\t we\t have\t already\t used\t this\t idea\t in\t example\t 3\t of\t chapter 3.\t With\t the\t present\t problem,\t we\t can\t easily\t generalize\t to\t graphs\t with\t maximum\tdegree\tΔ.\t\t\t \t At\tfirst\tglance,\tthe\tnext\texample\tlooks\tvery\tsimilar\tto\tthe\tprevious\t one.\t However,\t it\t is\t significantly\t more\t difficult,\t and\t the\t solution\t Chapter 7: Extremal Combinatorics 13 uses\t a\t clever\t coloring.\t Coloring\t is\tanother\t extremely\t important\t way\tof\texploiting\tthe\tstructure\tof\tboards.\t\t \t Example 8 [IMO 1999, Problem 3] Let\tn\tbe\tan\teven\tpositive\tinteger.\tWe\tsay\tthat\ttwo\tdifferent\tcells\tof\t an\tn×n\tboard\tare\tneighboring\tif\tthey\thave\ta\tcommon\tside.\tFind\t the\t minimal\t number\tof\t cells\t on\t the\tn×n\tboard\t that\t must\t be\t marked\t so\t that\t any\t cell\t (marked\t or\t not\t marked)\t has\t a\t marked\t neighboring\tcell.\t \t Answer: Let\tn\t=\t2k.\tColor\tthe\tboard\tblack\tand\twhite\tin\tlayers\tas\tshown\tin\t figure.\t Note\t that\t any\t square\t (black\t or\t white)\t neighbors\t exactly\t two\t black\t squares.\t Hence,\t since\t the\t number\t of\t black\t squares\t is\t 2k(k+1),\twe\tmust\tmark\tat\tleast\tk(k+1)\tsquares.\tOn\tthe\tother\thand,\t this\tbound\tcan\tbe\tachieved\tby\tmarking\talternate\tblack\tsquares\tin\t each\t layer,\t in\t such\t a\t way\t that\t each\t white\t cell\t neighbors\t exactly\t one\tmarked\tblack\tsquare.\t■ \t Figure 7.5: Example for n = 6. Olympiad Combinatorics 14 \t \t The Classification Method Suppose\t we\t have\t a\t set\tS\tof\t objects,\t and\t we\t want\t to\t show\t that\t there\texists\ta\tlarge\tsubset\tS’\tof\tthese\tobjects\tsuch\tthat\tS’\tsatisfies\ta\t particular\tcondition.\tThe\tidea\tbehind\tthe\tclassification\tmethod\tis\t to\tpartition\t(split)\tS\tinto\tsets\tS1,\tS2,\t…,\tSk\tsuch\tthat\tS1 ∪ S2 ∪… ∪ Sk\t =\tS,\tand\tfurthermore,\teach\tof\tthe\tsets\tS1,\tS2,\t…,\tSk\tsatisfies\tthe\tgiven\t condition.\tThen,\tby\tthe\tpigeonhole\tprinciple,\tat\tleast\tone\tof\tthese\t sets\twill\thave\tsize\tat\tleast\t|S|/k,\tthereby\tproving\tthe\texistence\tof\ta\t subset\tof\tS\tof\tsize\tat\tleast\t|S|/k\tsatisfying\tthe\tgiven\tcondition.\t\t \t Example 9 [IMO Shortlist 2001, C6] For\ta\tpositive\tinteger\tn\tdefine\ta\tsequence\tof\tzeros\tand\tones\tto\tbe\t balanced\tif\t it\t contains\tn\tzeros\t and\tn\tones.\tTwo\t balanced\t sequences\ta\tand\tb\tare\tneighbors\tif\t you\t can\t move\t one\t of\t the\t 2n\t symbols\t of\ta\tto\t another\t position\t to\t form\tb.\t For\t instance,\t when\t n\t=\t4,\t the\t balanced\t sequences\t 01101001\tand\t 00110101\t are\t neighbors\tbecause\tthe\tthird\t(or\tfourth)\tzero\tin\tthe\tfirst\tsequence\t can\t be\t moved\t to\t the\t first\t or\t second\t position\t to\t form\t the\t second\t sequence.\tProve\tthat\tthere\tis\ta\tset\tS\tof\tat\tmost\t \u0000 \u0000\u0000\u0000\u0000 \u0000\u0000 \u0000\u0000\tbalanced\t sequences\t such\t that\t every\t balanced\t sequence\t is\t equal\t to\t or\t is\t a\t neighbor\tof\tat\tleast\tone\tsequence\tin\tS.\t \t Answer: Call\tsuch\ta\tset\tS\ta\tdominating set.\tOur\tidea\tis\tto\tpartition\tthe\tset\tof\t \u0000 \u0000\u0000 \u0000\u0000\tbalanced\t sequences\t into\t (n+1)\t classes,\t so\t that\t the\t set\t of\t sequences\t in\t any\t class\t form\t a\t dominating\t set.\t Then\t we\t will\t be\t done\t by\t the\t pigeonhole\t principle,\t since\t some\t class\t will\t have\t at\t most\t \u0000 \u0000\u0000\u0000\u0000 \u0000\u0000 \u0000\u0000\tbalanced\tsequences.\t\t \t To\tconstruct\tsuch\ta\tpartition,\tfor\tany\tbalanced\tsequence\tA\tlet\t f(A)\tdenote\tthe\tsum\tof\tthe\tpositions\tof\tthe\tones\tin\tA\t(mod\t(n+1)).\t For\texample,\tf(100101)\t≡\t1+4+6\t(mod\t4)\t≡\t3\tmod\t4.\tA\tsequence\t Chapter 7: Extremal Combinatorics 15 is\t in\t class\ti\tif\t and\t only\t if\tf(A)\t≡\ti\tmod\t (n+1).\t It\t just\t remains\t to\t show\t that\t every\t class\t is\t indeed\t a\t dominating\t set,\t that\t is,\t for\t any\t class\tCi\tand\tany\tbalanced\tsequence\tA\tnot\tin\tCi,\tA\thas\ta\tneighbor\tin\t Ci.\t\t \t This\tisn’t\tdifficult:\tif\tA\tbegins\twith\ta\tone,\tobserve\tthat\tmoving\t this\tone\timmediately\tto\tthe\tright\tof\tthe\tkth\tzero\tgives\ta\tsequence\t B\t satisfying\tf(B)\t≡\tf(A)\t +\tk\tmod\t (n+1).\tHence\t simply\t choose\t k\t≡\tI\t-\tf(A)\t mod\t (n+1),\tand\t then\t by\t shifting\t the\t first\t one\t to\t the\t right\t of\t the\tkth\t zero\twe\t end\t up\t with\t a\t sequence\tB\tsatisfying\t f(B)\t≡\ti\tmod\t(n+1).\tHence\tB\tis\ta\tsequence\tin\tCi.\tThe\tcase\twhen\tA\t begins\t with\t a\t zero\tis\t similar.\t Thus\t each\t class\t is\t indeed\t a\t dominating\tset\tand\twe\tare\tdone\tby\tthe\tfirst\tparagraph.\t■\t \t Remark:\t It\t is\t worth\t mentioning\t that\t the\t reason\t for\t naming\t S\ta\t “dominating\t set”\t is\t that\t this\t problem\t has\t a\t very\t nice\t graph\t theoretic\t interpretation.\t Dominating\t sets\t are\t graph\t structures\t that\twe\twill\tencounter\tin\tchapters\t8\tand\t9.\t\t \t \t Two Graph Theory Problems Graphs\t are\t a\t rich\t source\t of\t extremal\t problems.\t We\t present\t two\t here,\tand\tyou\twill\tsee\tseveral\tmore\tin\tthe\tnext\tchapter.\tThe\tmain\t thing\t to\t keep\t in\t mind\t when\t dealing\t with\t such\t problems\t is\t dependencies\t–\thow\t are\t all\t the\t quantities\t in\t question\t related?\t How\tdoes\tthe\tsize\tof\tone\timpact\tthe\tsize\tof\tanother?\tIndeed,\tthe\t entire\t purpose\t of\t a\t graph\t is\t to\t model\t connections\t and\t dependencies,\tso\tthe\tstructure\tof\ta\tgraph\tinvariably\tproves\tuseful\t for\tanswering\tthese\ttypes\tof\textremal\tquestions.\t\t \t Example 10 [Swell coloring] Let\tKn\tdenote\tthe\tcomplete\tgraph\ton\tn\tvertices,\tthat\tis,\tthe\tgraph\t with\tn\tvertices\tsuch\tthat\tevery\tpair\tof\tvertices\tis\tconnected\tby\tan\t edge.\tA\tswell coloring\tof\tKn\tis\tan\tassignment\tof\ta\tcolor\tto\teach\tof\t Olympiad Combinatorics 16 the\t edges\t such\t that\t the\t edges\t of\t any\t triangle\t are\t either\t all\t of\t distinct\tcolors\tor\tall\tthe\tsame\tcolor.\tFurther,\tmore\tthan\tone\tcolor\t must\tbe\tused\tin\ttotal\t(otherwise\ttrivially\tif\tall\tedges\tare\tthe\tsame\t color\twe\twould\thave\ta\tswell\tcoloring).\tShow\tthat\tif\tKn\tcan\tbe\tswell\t colored\twith\tk\tcolors,\tthen\tk\t≥\t√\u0000\t+\t1.\t\t \t Answer: Let\tN(x,\tc)\t denote\t the\t number\t of\t edges\t of\tcolor\tc\tincident\t to\t a\t vertex\tx.\tFix\tx0,\tc0\tsuch\tthat\tN(x0,\tc0)\tis\tmaximum\tand\tdenote\tthis\t maximum\tvalue\tby\tN.\tThere\tare\tn–1\tedges\tincident\tto\tx0,\tcolored\t in\t at\t most\tk\tcolors,\t with\t no\t color\t appearing\t more\t than\tN\ttimes.\t Hence\tNk\t≥\tn–1.\t\t \t Now\tconsider\tvertex\ty\tsuch\tthat\tedge\tyx0\tis\tnot\tof\tcolor\tc0.\tAlso\t let\tx1,\tx2,\t…,\txN\tbe\tthe\tN\tvertices\tjoined\tto\tx0\tby\tcolor\tc0.\tNote\tthat\t for\tany\ti\tand\tj\tin\t{1,\t2,\t…,\tN},\txixj\tis\tof\tcolor\tc0\tsince\tx0xi\tand\tx0xj\tare\t of\tcolor\tc0.\t\t \t Suppose\tyxi\tis\tof\tcolor\tc0\tfor\tsome\ti in\t{1,\t2,\t…,\tN}.\tThen\ttriangle\t yxix0\tcontradicts\tthe\tswell\tcoloring\tcondition,\tsince\ttwo\tsides\t(yxi\t and\txxi)\t are\t the\t same\t color\tc0\tbut\t the\t third\t side\t isn’t.\t Hence\t the\t color\tof\tyxi\tis\tnot\tc0\tfor\ti\t=1,\t2,\t…,\tN.\t\t \t Now\tsuppose\tyxi\tand\tyxj\tare\tthe\tsame\tcolor\tfor\tsome\tdistinct\ti\t and\tj\tin\t{0,\t1,\t2,\t…,\tN}.\tThen\txixj\talso\tmust\tbe\tthis\tcolor.\tBut\txixj\tis\tof\t color\tc0,\twhich\timplies\tyxi\t\tand\tyxj\tare\talso\tof\tcolor\tc0,\tcontradicting\t our\tearlier\tobservation.\t\t \t It\t follows\t that\tyx0,\tyx1,\tyx2,\t …,\tyxN\tare\t all\t different\t colors,\t and\t none\tof\tthem\tis\tc0.\tThis\timplies\tthat\tthere\tare\tat\tleast\tN+2\tdistinct\t colors,\t so\tk\t≥\tN+2.\tSince\twe\t already\tshowed\tNk\t≥\tn–1,\t it\t follows\t that\tk(k\t–\t2)\t≥\tn–1,\tfrom\twhich\tthe\tdesired\tbound\tfollows.\t■ Remark: Basically, one can think about the above proof as follows: either there is a big clique of one color, or there isn’t. If there isn’t, then we need many colors to avoid big monochromatic cliques. If there is, then anything outside this clique needs many different colors Chapter 7: Extremal Combinatorics 17 to be connected to the clique. Example 11 [Belarus 2001] Given\tn\tpeople,\t any\t two\t are\t either\t friends\t or\t enemies,\tand\t friendship\t and\t enmity\t are\t mutual.\t I\t want\t to\t distribute\t hats\t to\t them,\tin\tsuch\ta\tway\tthat\tany\ttwo\tfriends\tpossess\ta\that\tof\tthe\tsame\t color\t but\t no\t two\t enemies\t possess\t a\t hat\t of\t the\t same\t color.\t Each\t person\tcan\treceive\tmultiple\thats.\tWhat\tis\tthe\tminimum\tnumber\tof\t colors\trequired\tto\talways\tguarantee\tthat\tI\tcan\tdo\tthis?\t \t Answer: Set\tup\ta\tgraph\tin\tthe\tusual\tway,\twith\tvertices\tstanding\tfor\tpeople\t and\tedges\tbetween\ttwo\tpeople\tif\tand\tonly\tif\tthey\tare\tfriends.\tNote\t that\tif\twe\thave\ta\tcomplete\tbipartite\tgraph\twith\t⌊\u0000/2⌋\tvertices\ton\t one\t side\t and\t⌈\u0000/2⌉\tvertices\t on\t the\t other,\t then\t we\t need\t at\t least\t ⌊\u0000/2⌋⌈\u0000/2⌉\tcolors.\t This\t is\t because\t we\t need\t one\t for\t each\t pair\t of\t friends\t and\t no\t color\t could\t belong\t to\t more\t than\t two\t people\t (otherwise\t some\t two\t people\t on\t the\t same\t side\tof\t the\t bipartition\t would\t have\t the\t same\t color,\t which\t is\t not\t possible\t since\t they\t are\t enemies).\tWe\tclaim\tthis\tis\tthe\tworst\tcase,\tthat\tis,\tgiven\t⌊\u0000/2⌋⌈\u0000/2⌉\t colors\t we\t can\t always\t satisfy\t the\t given\t conditions.\t We\t will\t use\t strong\tinduction,\tthe\tbase\tcases\tn\t=\t1,\t2,\t3\tbeing\teasy\tto\tcheck.\t\t \t Obviously\tif\tthe\tgraph\thas\tfewer\tthan\t\t⌊\u0000/2⌋⌈\u0000/2⌉\tedges\twe\tare\t done,\tsince\twe\tcan\tassign\ta\tseparate\tcolor\tfor\teach\tpair\tof\tfriends.\t Now\t if\t the\t graph\t has\t more\t than\t⌊\u0000/2⌋⌈\u0000/2⌉\tedges,\t then\t by\t the\t contrapositive\t of\tcorollary\t 1\tin\t chapter\t 6\t (example\t 8),\t the\t graph\t contains\ta\ttriangle.\tUse\tone\tcolor\tfor\tthe\ttriangle\t(that\tis,\tgive\teach\t member\t of\t the\t triangle\t a\t hat\tof\t that\t color).\t Using\t at\t most\t n–3\t colors,\twe\tcan\tensure\tthat\teach\tperson\tnot\tin\tthe\ttriangle\twho\tis\t friends\twith\tsome\tmember(s)\tof\tthe\ttriangle\thas\ta\tcommon\tcolor\t with\tthem.\t Now\t among\t the\t remaining\t n–3\t people,\t we\t need\t at\t most\t⌊(\u0000−3)/2⌋⌈(\u0000−3)/2⌉\tmore\t colors\t by\t the\t induction\t hypothesis.\tHence\tin\ttotal\twe\tuse\tat\tmost\t\t (1+(n–3)+⌊(\u0000−3)/2⌋⌈(\u0000−3)/2⌉)\t≤\t⌊\u0000/2⌋⌈\u0000/2⌉\tcolors.\t■\t \t Olympiad Combinatorics 18 Remark:\tThe\timportant\tpart\tof\tthe\tprevious\texample\tis\tguessing\t the\t worst\t case\t scenario.\t Intuitively,\t when\t there\t are\t too\t many\t or\t too\tfew\tedges,\twe\tdon’t\tneed\tmany\tcolors,\tbecause\twe\twould\tthen\t have\teither\tvery\tfew\tenemies\tor\tvery\tfew\tfriends.\tThis\tleads\tus\tto\t guess\tthat\tthe\tworst\tcase\tis\t“somewhere\tin\tthe\tmiddle”.\tIn\tthese\t cases,\tbipartite\tgraphs\tshould\tbe\tyour\tfirst\tsuspects\t(followed\tby\t multipartite\t graphs).\t This\t gives\t us\t the\t intuition\t needed\t to\t complete\tthe\tsolution-\tthe\tsimplest\tstructure\twe\tcan\texploit\tin\ta\t graph\twith\t“too\tmany\tedges”\tis\tthat\tit\twill\thave\ttriangles.\t\t \t \t \t Induction and Combinatorics of Sets \t In\t this\t section\t we\t will\t use\t induction\t to\t solve\t extremal\t problems\t on\tsets.\tWe\tfirst\testablish\ttwo\tsimple\tlemmas.\t\t \t Lemma 7.1: Let\tS\tbe\ta\tset\twith\tn\telements,\tand\tlet\tF\tbe\ta\tfamily\tof\t subsets\t of\tS\tsuch\t that\t for\t any\t pair\tA,\tB\tin\tF,\tA\t∩\tB\t≠\t∅.\tThen\t |F|\t≤\t2 n-1 . \t Proof: For\tany\tset\tA\tin\tF,\tthe\tcomplement\tof\tA,\tthat\tis,\tS\\A,\tcannot\t be\tin\tF.\tSo\tat\tmost\t½\tof\tthe\ttotal\tnumber\tof\tsubsets\tof\tS\tcan\tbe\tin\t F.\tEquality\tis\tachieved\tby\ttaking\tall\tsubsets\tof\tS\tcontaining\ta\tfixed\t element\tx\tin\tS.\t\t\t\t \t Lemma 7.2: Let\tS\tbe\ta\tset\twith\tn\telements,\tand\tlet\tF\tbe\ta\tfamily\tof\t subsets\tof\tS\tsuch\tthat\tfor\tany\tpair\tA,\tB\tin\tF,\tS\tis\tnot\tcontained\tby\t A\t⋃\u0000.\tThen\t|F|\t≤\t2 n-1.\t Proof: The\tproof\tis\tidentical\tto\tthat\tof\tlemma\t7.1.\tEquality\tholds\t by\ttaking\tall\tsubsets\tof\tS\texcluding\ta\tfixed\telement\tx\tof\tS. \t \t Example 12 [Iran TST 2008] Let\tS\t=\t {1,\t 2,\t …,\tn},\t and\tlet\tF\tbe\t a\t family\t of\t 2 n-1 \tsubsets\t of\tS.\t Chapter 7: Extremal Combinatorics 19 Suppose\tfor\tall\tA,\tB\tand\tC\tin\tS,\tA\t∩\tB\t∩\tC\t≠\t∅.\tShow\tthat\tthere\tis\tan\t element\tin\tS\tbelonging\tto\tall\tsets\tin\tF.\t\t \t Answer Suppose\tthere\tare\tsets\tX\tand\tY\tin\tF\tsuch\tthat\t|X\t∩\tY|\t=\t1.\tThen\twe\t are\ttrivially\tdone\tsince\tall\tsets\tin\tF\tmust\tcontain\tthis\telement\tby\t the\t intersection\t condition\t of\t the\t problem.\t Now\t assume\t that\tF\tis\t 2-intersecting;\tthat\tis,\t|X\t∩\tY|\t≥\t2\tfor\teach\tX\tand\tY\tin\tF.\tWe\tprove\t by\tinduction\ton\tn\tthat\tin\tthis\tcase,\t|F|\t<\t2 n-1 ,\tshowing\tthat\tthis\tcase\t cannot\toccur.\t\t \t Base\tcases\tn\t=\t1\tand\t2\tare\ttrivial,\tso\tassume\tthe\tresult\tholds\tfor\t n–1\tand\t that\t we\t are\t trying\t to\t prove\t it\t for\tn.\t We\t can\t write\tF\tas\t F\t=\tFn\t∪\tFn-1,\twhere\tFn\tconsists\tof\tall\tsets\tin\tF\tcontaining\tn\tand\tFn-1\t consists\tof\tall\tsets\tin\tF\tnot containing\tn.\t\t \t By\tthe\tinduction\thypothesis,\t|Fn-1|\t<\t2 n-2 .\tNow\tdefine\tFn’ =\t{S\\n\t|\t S\t∈\tFn}.\tIn\tother\twords,\tdefine\tFn’ is\tobtained\tfrom\tFn\tby\tdeleting\tn\t from\tall\tsets\tin\tFn.\tSince\tFn\tis\t2-intersecting,\tFn’\tis\tstill\tintersecting,\t so\t by\t lemma\t7.1,\t |Fn’|\t≤\t 2 n-2 .\tNote\tthat\t |Fn’|\t =\t |Fn|,\tso\twe\t get\t |F|\t=\t|Fn|\t+\t|\tFn-1|\t=\t\t|Fn’|\t+\t|\tFn-1|\t<\t2 n-2\t+\t2 n-2\t<\t2 n-1,\tas\tdesired.\t■\t \t Example 13 [Kleitman’s lemma] (U*) A\tset\tfamily\tF\tis\tsaid\tto\tbe\tdownwards closed\tif\tthe\tfollowing\tholds:\t if\tX\tis\ta\tset\tin\tF,\tthen\tall\tsubsets\tof\tX\tare\talso\tsets\tin\tF.\tSimilarly,\tF\t is\t said\t to\t be\tupwards closed\tif\t whenever\tX\tis\t a\t set\t in\tF,\t all\t sets\t containing\tX\tare\talso\tsets\tin\tF.\tLet\tF1\tand\tF2\tbe\tdownwards\tclosed\t families\t of\t subsets\t of\tS\t=\t {1,\t 2,\t …,\tn},\t and\t let\tF3\tbe\t an\t upwards\t closed\tfamily\tof\tsubsets\tof\tS.\t\t (a) Show\tthat\t|\tF1\t∩\tF2|\t≥\t |\t\u0000\u0000||\u0000\u0000| \u0000\u0000 .\t\t (b) Show\tthat\t|\tF1\t∩\tF3|\t≤\t |\t\u0000\u0000||\u0000\u0000| \u0000\u0000 .\t.\t\t \t Answer a) Induct\ton\tn.\tThe\tbase\tcase\tn\t=\t1\tis\ttrivial,\tso\tassume\tthe\tresult\t Olympiad Combinatorics 20 holds\tfor\t(n–1)\tand\tthat\twe\tare\ttrying\tto\tprove\tit\tfor\tn.\tLet\tX1\t be\tthe\tfamily\tof\tsets\tin\tF1\tcontaining\tn\tand\tY1\tbe\tthe\tfamily\tof\t sets\tnot\tcontaining\tn.\tDelete\tn\tfrom\teach\tset\tin\tX1\tto\tobtain\ta\t new\t family\tX1’.\t Note\t that\t |X1’|=\t |X1|\t and\t |X1’|+|Y1|\t =\t |F1|.\t Also\t note\t that\tX1\tand\tY1\tare\t still\t downwards\t closed.\t Analogously\t define\tX2,\tY2\tand\tX2’\tfor\tthe\tfamily\tF2.\t\t Observe\t that\t |F1\t∩\tF2|\t =\t |Y1\t∩\tY2|\t +\t |\t X1’\t∩\tX2’|\t≥\t |\t\u0000\u0000||\u0000\u0000| \u0000\u0000\u0000\u0000 \t+\t |\t\u0000\u0000\u0000||\u0000\u0000\u0000| \u0000\u0000\u0000\u0000 \t(applying\t the\t induction\t hypothesis).\t Since\tF1\tand\tF2\t are\tdownwards\tclosed,\tX1’\tis\ta\tsubset\tof\tY1,\tand\tsimilarly\tX2’\tis\t a\t subset\t of\tY2.\t Hence\t |Y1|\t≥\t |X1’|,\t |Y2|\t≥\t |X2’|,\t so\t Chebyshev’s\t inequality\t (or\t just\t basic\t algebra)\t yields\t |\t\u0000\u0000||\u0000\u0000| \u0000\u0000\u0000\u0000 \t+\t |\t\u0000\u0000\u0000||\u0000\u0000\u0000| \u0000\u0000\u0000\u0000 \t\t ≥\t(|Y1|\t+\t|X1’|)(|Y2|\t+\t|X2’|)/2 n \t=\t |\t\u0000\u0000||\u0000\u0000| \u0000\u0000 .\t\t \t b) The\t proof\t is\t similar\t to\t that\t in\t part\t (a),\t but\t with\t inequality\t signs\treversed.\t■\t \t Lemmas\t(i)\tand\t(ii)\tin\tthis\tsection\tare\tfairly\tstraightforward.\tNote\t that\tin\tboth\tcases,\tthe\timposition\tof\ta\tcertain\tconstraint\tdecreases\t the\tnumber\tof\tsets\twe\tcan\thave\tby\ta\tfactor\tof\t½\t(we\tcan\tinclude\t 2 n-1\tsets\t out\t of\t 2 n \ttotal\t possibilities).\t A\t natural\t question\t is\t what\t happens\t if\t we\t impose\t both\t conditions\t simultaneously\t–\twill\t the\t number\tof\tpossible\tsets\tin\tthe\tfamily\tbe\tdecreased\tby\ta\tfactor\tof\t 4?\t Interestingly,\t Kleitman’s\t lemma\t answers\t this\t question\t in\t the\t affirmative.\t\t \t Example 14 (U*) Let\tF\t=\t{A1,\tA2,\t…,\tAk}\tbe\ta\tfamily\tof\tsubsets\tof\tS\t=\t{1,\t2,\t…,\tn}\t(n\t>\t 2),\tsuch\tthat\tfor\tany\tdistinct\tsubsets\tAi\tand\tAj,\tAi\t∩\tAj\t≠∅\tand\tAi\t∪\tAj\t ≠\tS.\tShow\tthat\tk\t≤\t2 n-2.\t\t \t Answer F\tcan\t be\t extended\t to\t a\t downward\t closed\t system\tD\tby\t adding\t all\t subsets\tof\tthe\tsets\tin\tF.\tSimilarly,\tF\tcan\tbe\textended\tto\tan\tupward\t closed\tsystem\tU\tby\tadding\tall\tsubsets\tof\tS\tthat\tcontain\tsome\tset\tin\t Chapter 7: Extremal Combinatorics 21 F.\t Note\t that\tF\t=\tU\t∩\tD.\t Since\tF\tis\t intersecting,\t so\t is\tU\t(since\t in\t creating\tU\twe\t only\t added\t “big”\t sets).\t Hence\t by\t lemma\t 7.1,\t |U|\t≤\t2 n-1 .\t Similarly,\t since\t the\t union\t of\t no\t two\t sets\t in\tF\tcovers\tS,\t the\tsame\tholds\tfor\tD.\tHence\tby\tlemma\t7.2,\t|D|≤\t2 n-1 .\tThen\tby\tpart\t (b)\tof\tthe\tprevious\tproblem,\t\t k\t=\t|F|\t=\t|U\t∩\tD|\t≤\t|U||D|/2 n\t≤\t2 n-1\t×\t2 n-1/2 n\t=\t2 n-2\t.\t■\t Example 15 [stronger version of USA TST 2011] Let\tn\t≥\t1\tbe\tan\tinteger,\tand\tlet\tS\tbe\ta\tset\tof\tinteger\tpairs\t(a,\tb)\twith\t 1\t≤\ta\t<\tb\t≤\t 2 n.\t Assume\t |S|\t >\tn2 n.\t Prove\t that\t there\t exist\t four\t integers\ta\t<\tb\t<\tc\t<\td\tsuch\t that\tS\tcontains\t all\t three\t pairs\t (a,\tc),\t (b,\td)\tand\t(a,\td).\t \t Answer: We\t induct\t on\tn.\t The\t base\t cases\t being\t trivial,\t suppose\t the\t result\t holds\tfor\t(n–1).\tLet\tS’\tbe\tthe\tset\tof\tpairs\t(a,\tb)\tin\tS\twith\ta\t<\tb\t≤\t2 n-1.\t If\t |S’|\t≥\t (n–1)2 n-1 ,\t we\t would\t be\t done\t by\t applying\t the\t induction\t hypothesis\tto\tS’.\t\t \t Similarly,\t let\tS’’\t be\t the\t set\t of\t pairs\t (a,\t b)\t with\t 2 n-1\t\t<\t a\t <\t b.\t If\t |S’’|\t≥\t(n–1)2 n-1\twe\twould\tagain\tbe\tdone\tby\tapplying\tthe\tinduction\t hypothesis\t to\tS’’,\t treating\t the\t pair\t (a,\tb)\t as\t if\t it\t were\t the\t pair\t (a-2 n-1 ,\tb-2 n-1 ).\t(Take\ta\tmoment\tto\tfully\tunderstand\tthis.)\t\t \t Now\t suppose\t neither\t of\t these\t cases\t arises.\t Then\t more\t than\t (n2 n–2(n–1)2 n-1)\t=\t2 n\tpairs\t(a,\tb)\twould\thave\tto\tsatisfy\ta\t≤\t2 n-1\t<\tb.\t\t \t We\tcall\ta\tpair\t(a,\tb)\tin\tS\ta\tB-champion\tif\ta\t≤\t2 n-1\t<\tb,\tand\tb\tis\tthe\t smallest\t number\t greater\t than\t 2 n-1\twith\t which\ta\toccurs\t in\t a\t pair.\t Note\t that\t there\t is\t at\t most\t 1\tB-champion\tfor\t fixed\ta,\t and\t at\t most\t 2 n-1\tchoices\t for\ta.\t Thus\t there\t are\t at\t most\t 2 n-1\tB-champions.\t Similarly,\tdefine\tan\tA-champion\tto\tbe\ta\tpair\t(a,\tb)\tin\tS\tif\ta\t≤\t2 n-1\t<\tb\t Olympiad Combinatorics 22 such\t that\ta\tis\t the\t largest\t number\t less\t than\t or\t equal\t to\t 2 n-1\twith\t which\tB\tis\t paired.\t The\t same\t argument\t shows\t that\t there\t are\t at\t most\t2 n-1\tA-champions.\t\t \t Since\t there\t are\t more\t than\t 2 n \tpairs\t (a,\tb)\t with\ta\t≤\t 2 n-1\t<\tb,\tat\t least\tone\tof\tthese\tpairs,\tsay\t(x,\ty)\tis\tneither\tan\tA-champion\tnor\ta\t B-champion.\tThen\tthere\tmust\texist\tz\tsuch\tthat\t2 n-1\t <\tz\t<\ty\tand\t(x,\t z)\tis\tin\tS\t(since\t(x,\ty)\tis\tnot\ta\tB-\tchampion).\tSimilarly,\tthere\texists\t w\tsuch\tthat\tx\t<\tw\t≤\t2 n-1\tand\t(y,\tw)\tis\tin\tS.\tHence\tx\t<\tw\t<\tz\t<\ty,\tand\t (x,\t z),\t (w,\t y)\t and\t (x,\t y)\t are\t all\t in\t S,\t proving\t the\t statement\t of\t the\t problem.\tThe\tinduction\tstep,\tand\thence\tthe\tproof,\tis\tcomplete.\t■\t \t Remark 1: Observe\tthe\tstructure\tof\tthis\tsolution-\twe\tfirst\ttried\tto\t find\ta\tsuitable\tsubset\tof\tS\tto\twhich\twe\tcould\tapply\tthe\tinduction\t hypothesis;\tthat\tis,\twe\ttried\tto\tbreak\tthe\tproblem\tdown.\tWe\tthen\t solved\t the\t problem\t for\t the\t cases\t in\t which\t this\t didn’t\t work.\t By\t dealing\twith\tan\teasy\tcase\tof\ta\tproblem\tfirst,\twe\tdo\tmore\tthan\tjust\t get\tthe\teasy\tcase\tout\tof\tthe\tway.\tWe\tactually\tlearn\tsome\timportant\t conditions\ta\tcase\tmust\tsatisfy\tto\tnot\tbe\teasy-\tand\tthis\tinformation\t is\t crucial\t for\t handling\t the\t hard\t case.\t This\t subtly\t illustrates\t the\t following\t problem\t solving\t tenet\t-\tthe first step in solving a hard problem often lies in identifying what makes the problem hard. \t Remark 2:\tThe\tdefinition\tof\tA-champions\tand\tB-champions\tin\tthe\t above\tsolution\tinitially\tappears\tto\tcome\tout\tof\tnowhere.\tHowever,\t after\t carefully\t reading\t the\t whole\t solution,\t the\t purpose\t behind\t it\t becomes\t clear:\t we\t are\t trying\t to\t find\t a\t pair\t (x,\ty)\t with\tw\tand\tz\t “squished\tbetween”\tx\tand\ty\tsuch\tthat\t(x,\tz)\tand\t(w,\ty)\tare\tpairs\tin\t S.\t The\t only\t way\t this\t can\t happen\t is\t if\t (x,\ty)\t is\t neither\t an\t A-champion\tnor\ta\tB-champion.\t\t \t\t Example 16 [The Sunflower Lemma] A\tsunflower\twith\tk\tpetals\tand\ta\tcore\tX\tis\ta\tfamily\tof\tsets\tS1,\tS2,\t…,\t Sk\tsuch\tthat\tSi\t⋂\u0000\u0000\t=\tX\tfor\teach\ti\t≠\tj.\t(The\treason\tfor\tthe\tname\tis\t that\tthe\tVenn\tdiagram\trepresentation\tfor\tsuch\ta\tfamily\tresembles\t Chapter 7: Extremal Combinatorics 23 a\t sunflower.)\t The\t sets\tSi\t\\\tX\tare\t known\t as\t petals\t and\t must\t be\t nonempty,\tthough\tX\tcan\tbe\tempty.\tShow\tthat\tif\tF\tis\ta\tfamily\tof\tsets\t of\tcardinality\ts,\tand\t|F|\t>\ts!(k-1) s ,\tthen\tF\tcontains\ta\tsunflower\twith\t k\tpetals.\t\t \t \t Figure 7.6: A Sunflower. \t Answer: Induct\t on\ts.\t The\t result\t is\t trivial\t for\ts\t=\t 1,\t since\t then\tk\tsingleton\t sets\t will\t form\t the\t sunflower\t (its\t core\t will\t be\t empty\t but\t that’s\t okay,\t no\t one\t said\t the\t sunflower\thas\t to\t be\t pretty).\t Passing\t to\t the\t inductive\tstep,\tlet\ts\t≥\t2\tand\ttake\ta\tmaximal\tfamily\tA\t=\t{A1,\tA2,\t…,\t At}\t of\t pairwise\t disjoint\t sets\t in\tF.\t If\tt\t≥\tk\twe\t are\t done,\t since\t this\t family\t will\t form\t our\t required\tsunflower\t (with\tempty\t core).\t Now\t suppose\tt\t≤\tk\t–\t1\tand\tlet\tB\t=\tA1\tU\tA2\tU\t…\tU\tAt.\tNote\tthat\t|B|\t=\tst\t≤\t s(k–1).\tAlso,\tby\tthe\tmaximality\tof\tA,\tit\tfollows\tthat\tB\tintersects\tall\t sets\tin\tF\t(otherwise\t we\t could\t add\tmore\t sets\t to\tA).\t Hence\t by\t the\t pigeonhole\tprinciple,\tsome\telement\tx\tof\tB\tmust\tbe\tcontained\tin\tat\t least\t |\u0000| |\u0000| \t>\t \u0000!(\u0000\u0000\u0000)\u0000 \u0000(\u0000\u0000\u0000) \t=\t(s\t–\t1)!(k\t–\t1) s-1\t sets\t in\tF.\t Deleting\tx\tfrom\t these\t sets\t and\t applying\t the\t induction\t hypothesis\t to\t these\tsets\t(which\t now\tcontain\ts–1\telements\teach),\t Core Olympiad Combinatorics 24 we\tsee\tthat\tthere\texists\ta\tsunflower\twith\tk\tpetals.\tAdding\tx\tback\t to\t all\t these\t sets\t doesn’t\t destroy\t the\t sunflower\tsince\tit\t just\t goes\t into\tthe\tcore,\tso\twe\tget\tthe\tdesired\tsunflower.\t■\t \t Example 17 [IMO Shortlist 1998, C4] Let\tU\t=\t{1,\t2,\t…,\tn},\twhere\tn\t≥\t3.\tA\tsubset\tS\tof\tU\tis\tsaid\tto\tbe\tsplit\t by\t an\t arrangement\t of\t the\t elements\t of\tU\tif\t an\t element\t not\t in\tS\t occurs\tin\tthe\tarrangement\tsomewhere\tbetween\ttwo\telements\tof\tS.\t For\texample,\t13542\tsplits\t{1,\t2,\t3}\tbut\tnot\t{3,\t4,\t5}.\tProve\tthat\tfor\t any\tfamily\tF\tof\t(n–2)\tsubsets\tof\tU,\teach\tcontaining\tat\tleast\t2\tand\tat\t most\tn–1\telements,\tthere\tis\tan\tarrangement\tof\tthe\telements\tof\tU\t which\tsplits\tall\tof\tthem.\t\t \t Answer: We\tinduct\ton\tn.\tAs\talways,\twe\tunceremoniously\tdismiss\tthe\tbase\t case\tas\ttrivial\tand\tpass\tto\tthe\tinduction\tstep,\tassuming\tthe\tresult\t for\tn–1\tand\tprove\tit\tfor\tn.\tWe\tfirst\tprove\ta\tclaim.\t \t Claim:\t There\t exists\t an\t element\ta\tin\tU\tthat\t is\t contained\t in\t all\t subsets\t of\tF\tcontaining\tn – 1\telements,\t but\tin\tat\tmost\t one\t of\t the\t 2-element\tsubsets.\t Proof:\t A\t simple\t counting\t argument\t suffices.\t Let\tF\tcontain\tk\t (n-1)-element\tsubsets\tand\tm\t2-element\tsubsets.\tNote\tthat\tk+m\tis\t at\t most\tthe\t total\t number\t of\t subsets\t in\tF,\twhich\t is\tn–2.\t Hence\t (k+m)\t≤\t (n–2).\t The\t intersection\t of\t the\tk\t(n–1)-element\t subsets\t contains\texactly\t(n–k)\telements.\tThis\tis\tbecause\tfor\teach\tof\tthese\t subsets\tthere\tis\texactly\tone\telement\tit\tdoesn’t\tcontain.\t \t But\tn–k\t≥\tm+2\tand\tat\tmost\tm\telements\tcan\tbe\tin\tmore\tthan\tone\t of\tthe\ttwo-element\tsets.\tThus\tone\tof\tthese\telements\tthat\tis\tin\tthe\t intersection\t of\t all\t the\t (n–1)-element\t subsets\t is\t in\t at\t most\t one\t of\t the\t2-element\tsets,\tproving\tthe\tclaim.\t \t Now\t let\tA\tbe\t the\t 2-element\t subset\t that\t contains\ta\tif\t it\t exists;\t otherwise\t let\t it\t be\t an\t arbitrary\t subset\t of\tF\tcontaining\ta.\t Now\t exclude\ta\tfrom\tall\tsubsets\tin\tF\t\\\tA.\tWe\tget\tat\tmost\tn–3\tsubsets\tof\t U\t\\\t{a} containing\t at\t least\t 2\t and\t at\t most\tn–2\telements.\t Applying\t Chapter 7: Extremal Combinatorics 25 the\tinductive\thypothesis,\twe\tcan\tarrange\tthe\telements\tof\tU\t\\\ta\tso\t as\t to\t split\t all\t subsets\t of\tF\t\\\tA.\t Replace\ta\tanywhere\t away\t from\tA\t and\twe\tare\tdone.\t■ \t \t \t Exercises \t 1. [Generalization of USAMO 1999, Problem 4] Find\tthe\tsmallest\tpositive\tinteger\tm\tsuch\tthat\tif\tm\tsquares\tof\t an\tn×n\tboard\t are\t colored,\t then\t there\t will\t exist\t3\tcolored\t squares\twhose\tcenters\tform\ta\tright\ttriangle\twith\tsides\tparallel\t to\tthe\tedges\tof\tthe\tboard.\t \t 2. [Erdos-Szekeres Theorem] (U*) Show\tthat\tany\tsequence\tof\tn2\tdistinct\treal\tnumbers\tcontains\ta\t subsequence\t of\t length\tn\tthat\t is\t either\t monotonically\t increasing\tor\tmonotonically\tdecreasing.\t\t \t 3. [USA TST 2009, Problem 1] Let\tm\tand\tn\tbe\tpositive\tintegers.\tMr.\tFat\thas\ta\tset\tS\tcontaining\t every\t rectangular\t tile\t with\t integer\tside\t lengths\tand\t area\t of\t a\t power\t of\t 2.\t Mr.\t Fat\t also\t has\t a\t rectangle\tR\twith\t dimensions\t 2 m ×2 n \tbut\twith\ta\t1×1\tsquare\tremoved\tfrom\tone\tof\tthe\tcorners.\t Mr.\t Fat\t wants\t to\t choose\t (m+n)\t rectangles\t from\tS,\t with\t respective\t areas\t 2 0 ,\t 2 1 ,\t …,\t 2 m+n-1 \tand\t then\t tile\tR\twith\t the\t chosen\t rectangles.\t Prove\t that\t this\t can\t be\t done\t in\t at\t most\t (m+n)!\tways.\t \t 4. [Generalization of APMO 2012, Problem 2] Real\tnumbers\tin\t[0,\t1]\tare\twritten\tin\tthe\tcells\tof\tan\tn×n\tboard.\t Each\t gridline\t splits\t the\t board\t into\t two\t rectangular\t parts.\t Suppose\tthat\tfor\tany\tsuch\tdivision\tof\tthe\tboard\tinto\ttwo\tparts\t along\ta\tgridline,\tat\tleast\tone\tof\tthe\tparts\thas\tweight\tat\tmost\t1,\t where\tthe\tweight\tof\ta\tpart\tis\tthe\tsum\tof\tall\tnumbers\twritten\tin\t Olympiad Combinatorics 26 cells\tbelonging\tto\tthat\tpart.\tDetermine\tthe\tmaximum\tpossible\t sum\tof\tall\tthe\tnumbers\twritten\ton\tthe\tboard.\t\t [Challenge:\tgeneralize\tto\tk\tdimensional\tboards.]\t \t 5. [Indian postal coaching 2011] Consider\t2011 2 \tpoints\tarranged\tin\tthe\tform\tof\ta\t2011\tx\t2011\t grid.\t What\t is\t the\t maximum\t number\t of\t points\t that\t can\t be\t chosen\tamong\tthem\tso\tthat\tno\tfour\tof\tthem\tform\tthe\tvertices\t of\teither\tan\tisosceles\ttrapezium\tor\ta\trectangle\twhose\tparallel\t sides\tare\tparallel\tto\tthe\tgrid\tlines?\t \t 6. [China Girls Math Olympiad 2004] When\t the\t unit\t squares\t at\t the\t4\tcorners\t are\t removed\t from\t a\t 3×3\tsquare,\t the\t resulting\t shape\t is\t called\t a\t cross.\t Determine\t the\tmaximum\tnumber\tof\tnon-overlapping\tcrosses\tthat\tcan\tbe\t placed\twithin\tthe\tboundary\tof\ta\t10×11\tboard.\t\t \t 7. [IMO Shortlist 2010, C2] Let\tn\t>\t3\tbe\ta\tpositive\tinteger.\tA\tset\tof\tn\tdistinct\tbinary\tstrings\t of\t length\tn\tis\t said\t to\t be\tdiverse\tif\t there\t exists\t an\tn×n\tarray\t whose\trows\tare\tthese\tn\tbinary\tstrings\tin\tsome\torder,\tand\tall\t entries\t along\t the\t main\t diagonal\t of\t this\t array\t are\t equal.\t Find\t the\tsmallest\tinteger\tm,\tsuch\tthat\tamong\tany\tm\tbinary\tstrings\t of\tlength\tn,\tthere\texist\tn\tstrings\tforming\ta\tdiverse\tset.\t \t 8. [Iran TST 2007] Let\tA\tbe\tthe\tlargest\tsubset\tof\t{1,\t2,\t…,\tn}\tsuch\tthat\tfor\teach\tx\t∈\t A,\tx\tdivides\t at\t most\t one\t other\t element\t in\tA.\t Show\t that\t 2n/3\t≤\t|A|\t≤\t\u0000 \u0000\u0000 \u0000\u0000.\t\t \t 9. [IMO 2014, Problem 2] Let\tn\tbe\t a\t positive\t integer,\t and\t consider\t an\tn×n\tboard.\t Suppose\t some\t rooks\tare\tplaced\t on\t this\t board\tsuch\t that\t each\t row\t contains\t exactly\t one\t rook\t and\t each\t column\t contains\t exactly\tone\t rook.\t Find\t the\t largest\tinteger\tk\tsuch\t that\t for\t any\t such\t configuration\t as\t described\t above,\t there\t necessarily\t Chapter 7: Extremal Combinatorics 27 exists\ta\tk×k\tsquare\twhich\tdoes\tnot\tcontain\ta\trook\ton\tany\tof\tits\t k2 \tsquares.\t\t \t 10. [IMO 2013, Problem 2] A\t configuration\t of\t 4027\t points\t in\t the\t plane\t is\t called\t Colombian\t if\t it\t consists\t of\t 2013\t red\t points\t and\t 2014\t blue\t points,\tand\tno\tthree\tpoints\tof\tthe\tconfiguration\tare\tcollinear.\t By\t drawing\t some\t lines,\t the\t plane\t is\t divided\t into\t several\t regions.\t An\t arrangement\t of\t lines\t is\tgood\tfor\t a\t Colombian\t configuration\tif\tthe\tfollowing\tconditions\tare\tsatisfied:\t (i) No\tline\tpasses\tthrough\tany\tpoint\tof\tthe\tconfiguration\t (ii) No\tregion\tcontains\tpoints\tof\tboth\tcolors\t\t Find\t the\t least\t value\t of\tk\tsuch\t that\t for\t any\t Colombian\t configuration\tof\t4027\tpoints,\tthere\tis\ta\tgood\tarrangement\tof\tk\t lines.\t\t \t 11. [IMO Shortlist 2005, C3] Consider\t an\tm×n\trectangular\t board\t consisting\t of\tmn\tunit\t squares.\t Two\t of\t its\t unit\t squares\t are\t called\t adjacent\t if\t they\t have\ta\tcommon\tedge,\tand\ta\tpath\tis\ta\tsequence\tof\tunit\tsquares\t in\twhich\tany\ttwo\tconsecutive\tsquares\tare\tadjacent.\tTwo\tpaths\t are\t called\t non-intersecting\t if\t they\t don't\t share\t any\t common\t squares.\tSuppose\teach\tunit\tsquare\tof\tthe\trectangular\tboard\tis\t colored\teither\tblack\tor\twhite.\t\t Let\tN\tbe\tthe\tnumber\tof\tcolorings\tof\tthe\tboard\tsuch\tthat\tthere\t exists\tat\tleast\tone\tblack\tpath\tfrom\tthe\tleft\tedge\tof\tthe\tboard\tto\t its\tright\tedge.\tLet\tM\tbe\tthe\tnumber\tof\tcolorings\tof\tthe\tboard\t for\twhich\tthere\texist\tat\tleast\ttwo\tnon-intersecting\tblack\tpaths\t from\tthe\tleft\tedge\tof\tthe\tboard\tto\tits\tright\tedge.\t\t Prove\tthat\tN2\t≥\tM\tx\t2 mn.\t \t 12. [Balkan Math Olympiad 1994] Find\tthe\tsmallest\tnumber\tn\t≥\t5\tfor\twhich\tthere\tcan\texist\ta\tset\t of\tn\tpeople,\tsuch\tthat\tany\ttwo\tpeople\twho\tare\tfriends\thave\tno\t common\tfriends,\tand\tany\ttwo\tpeople\twho\tare\tnot\tfriends\thave\t Olympiad Combinatorics 28 exactly\ttwo\tcommon\tacquaintances.\t\t \t 13. Given\ta\tset\tS\tof\tn\tpoints\tin\t3-D\tspace,\tno\tthree\ton\ta\tline,\tshow\t that\tthere\texists\ta\tsubset\tS’\tof\tS\tcontaining\tat\tleast\tn 1/4\tpoints,\t such\tthat\tno\tsubset\tof\tthe\tpoints\tin\tS’\tform\ta\tregular\tpolygon. \t 14. [IMO Shortlist 2000, C4] Let\tn\tand\tk\tbe\tpositive\tintegers\tsuch\tthat\tn/2\t<\tk\t≤\t2n/3.\tFind\t the\t smallest\t number\tm\tfor\t which\t it\t is\t possible\t to\t mark\tm\t squares\ton\tan\tn×n\tboard\tsuch\tthat\tno\trow\tor\tcolumn\tcontains\t a\tblock\tof\tk\tadjacent\tunoccupied\tsquares.\t\t \t 15. [IMO Shortlist 1988] The\tcode\tfor\ta\tsafe\tis\ta\tthree\tdigit\tnumber\twith\tdigits\tin\t{1,\t2,\t …,\t 8}.\t Due\t to\t a\t defect\t in\t the\t safe,\t it\t will\t open\t even\t if\t the\t number\t we\t enter\t matches\t the\t correct\t code\t in\t two\t positions.\t (For\t example,\tif\t the\t correct\tcode\tis\t 245\t and\t we\tenter\t 285,\tit\t will\t open.)\t Determine\t the\t smallest\t number\t of\t combinations\t that\tmust\tbe\ttried\tin\torder\tto\tguarantee\topening\tthe\tsafe.\t\t \t 16. [Bulgaria 1998] Let\tn\tbe\t a\t given\t positive\t integer.\t Determine\t the\t smallest\t positive\t integer\tk\tsuch\t that\t there\t exist\tk\tbinary\t (0-1)\t sequences\t of\t length\t 2n+2,\t such\t that\t any\t other\t binary\t sequence\t of\t length\t 2n+2\t matches\t one\t of\t the\tk\tbinary\t sequences\tin\tat\tleast\tn+2\tpositions.\t\t\t \t 17. [IMO Shortlist 1996, C3] Let\tk,\tm,\tn\tbe\t integers\tsatisfying\t 1\t <\tn\t≤\tm–1\t≤\tk.\tDetermine\t the\tmaximum\tsize\tof\ta\tsubset\tS\tof\tthe\tset\t{1,\t2,\t…,\tk}\tsuch\tthat\t no\tn\tdistinct\telements\tof\tS\tadd\tup\tto\tm.\t \t 18. [IMO Shortlist 1988] 49\tstudents\ttook\tpart\tin\ta\tmath\tcontest\twith\tthree\tproblems.\t Each\t problem\t was\t worth\t 7\t points,\t and\t scores\t on\t each\t problem\twere\tintegers\tfrom\t0\tto\t7.\tShow\tthat\tthere\texist\ttwo\t Chapter 7: Extremal Combinatorics 29 students\tA\tand\tB\tsuch\tthat\tA\tscored\tat\tleast\tas\tmany\tpoints\tas\t B\ton\teach\tof\tthe\tthree\tproblems.\t\t \t 19. [USAMO 2007, Problem 3] Let\tS\tbe\ta\tset\tcontaining\t(n 2 +n–1)\telements,\tfor\tsome\tpositive\t integer\tn.\t Suppose\t that\t the\tn-element\t subsets\t of\tS\tare\t partitioned\t into\t two\t classes.\t Prove\t that\t there\t are\t at\t least\tn\t pairwise\tdisjoint\tsets\tin\tthe\tsame\tclass.\t \t 20. [IMO Shortlist 2009, C6] On\ta\t999\t×\t999\tboard\ta\tlimp\trook\tcan\tmove\tin\tthe\tfollowing\t way:\t from\t any\t square\t it\t can\t move\t to\t any\t of\t its\t adjacent\t squares,\t that\t is,\t a\t square\t having\t a\t common\t side\t with\t it,\t and\t every\tmove\tmust\tbe\ta\tturn,\tthat\tis,\tthe\tdirections\tof\tany\ttwo\t consecutive\tmoves\tmust\tbe\tperpendicular.\tA\tnon-intersecting\t route\t of\t the\t limp\t rook\t consists\t of\t a\t sequence\t of\t pairwise\t different\tsquares\tthat\tthe\tlimp\trook\tcan\tvisit\tin\tthat\torder\tby\t an\t admissible\t sequence\tof\t moves.\t Such\t a\t non-intersecting\t route\t is\t called\t cyclic,\t if\t the\t limp\t rook\t can,\t after\t reaching\t the\t last\tsquare\tof\tthe\troute,\tmove\tdirectly\tto\tthe\tfirst\tsquare\tof\tthe\t route\tand\tstart\tover.\t\t How\t many\t squares\t does\t the\t longest\t possible\t cyclic,\t non- intersecting\troute\tof\ta\tlimp\trook\tvisit?\t \t 21. [USAMO 2002, Problem 6] Some\ttrominoes\t(3×1\ttiles)\tare\tto\tbe\tplaced\ton\tan\tn×n\tboard\t without\t overlaps\t or\t trominoes\t sticking\t out\t of\t the\t board.\t Let\t b(n)\tdenote\tthe\tminimum\tnumber\tof\ttrominoes\tthat\tmust\tbe\t placed\tso\tthat\tno\tmore\tcan\tbe\tplaced\taccording\tto\tthe\tabove\t rules.\t Show\t that\t there\t exist\t constants\tc\tand\td\tsuch\t that\t n 2/7\t-\tcn\t≤\tb(n)\t≤\tn 2/5\t+\tdn.\t\t \t 22. [IberoAmerican Math Olympiad 2009, Problem 6] 6000\tpoints\ton\tthe\tcircumference\tof\ta\tcircle\tare\tmarked\tand\t colored\t with\t 10\t colors\t such\t that\t every\t group\t of\t 100\t Olympiad Combinatorics 30 consecutive\t points\t contains\t all\t ten\t colors.\t Determine\t the\t smallest\tpositive\tinteger\tk\tsuch\tthat\tthere\tnecessarily\texists\ta\t group\tof\tk\tconsecutive\tpoints\tcontaining\tall\tten\tcolors.\t \t 23. [IMO Shortlist 2011, C6] Let\tn\tbe\t a\t positive\tinteger,\t and\t let\tW\t=\t …\tx-1\tx0\tx1\t…\t be\t an\t infinite\t periodic\t word,\t consisting\t of\t just\t letters\ta\tand/or\tb.\t Suppose\tthat\tthe\tminimal\tperiod\tN\tof\tW\tis\tgreater\tthan\t2 n.\t A\tfinite\tnonempty\tword\tU\tis\tsaid\tto\tappear\tin\tW\tif\tthere\texist\t indices\tk\t≤\tl\tsuch\t that\tU\t=\txk…xl.\t A\t finite\t word\t U\t is\t called\t ubiquitous\tif\tthe\tfour\twords\tUa,\tUb,\taU\tand\tbU\tall\tappear\tin\t W.\tProve\tthat\tthere\tare\tat\tleast\tn\tubiquitous\tfinite\tnonempty\t words.\t \t 24. [IMO Shortlist 2007, C8] Consider\ta\tconvex\tpolygon\tP\twith\tn\tvertices.\tA\ttriangle\twhose\t vertices\tlie\ton\tvertices\tof\tP\tis\tcalled\tgood\tif\tall\tits\tsides\thave\t equal\tlength.\tProve\tthat\tthere\tare\tat\tmost\t2n/3\tgood\ttriangles.\t \t 25. [Stronger version of IMO Shortlist 2008, C6] For\tn\t>\t2,\tlet\tS1\t,\tS2,\t…,\t\u0000\u0000\u0000\tbe\t2 n\tsubsets\tof\tA\t=\t{1,\t2,\t…,\t2 n+1}\t that\tsatisfy\tthe\tfollowing\tproperty:\tThere\tdo\tnot\texist\tindices\t a\tand\tb\twith\ta\t<\tb\tand\telements\tx,\ty,\tz\t∈\tA\twith\tx\t<\ty\t<\tz\tand\ty,\t z\t∈\tSa\tand\tx,\tz\t∈\tSb.\t\tProve\tthat\tat\tleast\tone\tof\tthe\tsets\tS1\t,\tS2,\t…,\t \u0000\u0000\u0000\tcontains\t at\t most\t 2n+1\t elements.\t (Note:\t the\t original\t problem\thad\ta\tweaker\tbound\tof\t4n\tinstead\tof\t2n+1.)\t\t \t 26. [IMO Shortlist 2005, C8] In\ta\tcertain\tn-gon,\tsome\t(n–3)\tdiagonals\tare\tcolored\tblack\tand\t some\t other\t (n–3)\t diagonals\t are\t colored\tred,\t so\t that\t no\t two\t diagonals\t of\t the\t same\t color\tintersect\t strictly\t inside\t the\t polygon,\talthough\tthey\tcan\tshare\ta\tvertex.\t(Note:\ta\tside\tis\tnot\t a\tdiagonal.)\tFind\tthe\tmaximum\tnumber\tof\tintersection\tpoints\t between\t diagonals\t colored\t differently\t strictly\t inside\t the\t polygon,\tin\tterms\tof\tn.\t \t Chapter 7: Extremal Combinatorics 31 27. [IMO Shortlist 2011, C7] On\t a\t 2011×2011\t square\t table\t we\t place\t a\t finite\t number\t of\t napkins\t that\t each\t cover\t a\t square\t of\t 52\t by\t 52\t cells.\t Napkins\t can\toverlap,\tand\tin\teach\tcell\twe\twrite\tthe\tnumber\tof\tnapkins\t covering\tit,\tand\trecord\tthe\tmaximal\tnumber\tk\tof\tcells\tthat\tall\t contain\t the\t same\t nonzero\t number.\t Considering\t all\t possible\t napkin\tconfigurations,\twhat\tis\tthe\tlargest\tvalue\tof\tk?\t \t Olympiad\t Combinatorics\t \t \t \t \t Pranav\tA.\tSriram\t August 2014\t Chapter 8: Graph Theory 1 Copyright notices \t All USAMO and USA Team Selection Test problems in this chapter are copyrighted by the Mathematical Association of America’s American Mathematics Competitions. © Pranav A. Sriram. This document is copyrighted by Pranav A. Sriram, and may not be reproduced in whole or part without express written consent from the author. About the Author Pranav Sriram graduated from high school at The International School Bangalore, India, and is currently pursuing undergraduate studies at Stanford University. Chapter 8: Graph Theory 1 8. GRAPH THEORY \t \t \t Introduction Graphs\t rule\t our\t lives:\t from\t Google\t Search\t to\t molecular\t sequencing,\t flight\t scheduling\t to\t Artificial\t Intelligence,\t graphs\t are\t the\tunderlying\tmathematical\tabstraction\tfueling\tthe\tworld’s\tmost\t advanced\t technology.\t Graphs\t are\t also\t pervasive\t in\t models\t of\t speech,\t group\t dynamics,\t disease\t outbreaks\t and\t even\t the\t human\t brain,\t and\t as\t such\t play\t a\t crucial\t role\t in\t the\t natural\t and\t social\t sciences.\t Where\t does\t this\t versatility\t come\t from?\t Problems\t in\t several\t of\t the\t above-mentioned\t fields\t involve,\t at\t their\t core,\t entities\t existing\t in\t complex\t relationships\t with\t each\t other:\t hyperlinks\t between\t web\t pages,\t subject-object\t relationships\t between\t words,\t flights\t between\t cities\t and\t synapses\t between\t neurons.\tThe\tpower\tof\tgraph\ttheory\tstems\tfrom\tthe\tsimplicity\tand\t elegance\t with\t which\t graphs\t can\t model\t such\t relationships.\t Once\t you’ve\t cast\t a\t problem\t as\t a\t problem\t on\t graphs,\t you\t have\t at\t your\t disposal\t powerful\t machinery\t developed\t by\t mathematicians\t over\t the\tcenturies.\tThis\tis\tthe\tpower\tof\tabstraction.\t This\t chapter\t is\t by\t no\t means\t an\t exhaustive\t reference\t on\t the\t subject\t–\tgraph\t theory\t deserves\t its\t own\t book.\t However,\t we\t will\t see\tseveral\tpowerful\tlemmas\tand\ttechniques\tthat\tunderlie\ta\tvast\t majority\t of\t Olympiad\t and\t classical\t graph\t theory\t problems,\tand\t hopefully\tbuild\tplenty\tof\tgraph\ttheoretic\tintuition\talong\tthe\tway.\t Olympiad Combinatorics 2 In\tthe\tfinal\tsection\tof\tthis\tchapter,\twe\twill\tleverage\tthe\tpower\tof\t graphs\t mentioned\t in\t the\t first\t paragraph\t to\t solve\t Olympiad\t problems\tthat\tinitially\tappear\tto\thave\tnothing\tto\tdo\twith\tgraphs.\t\t \t We\tnow\trecall\tsome\tresults\twe\thave\tproven\tin\tearlier\tchapters,\t that\tprove\tto\tbe\textremely\tuseful\tboth\tin\tOlympiad\tproblems\tand\t in\t classical\t graph\t theory\t problems.\t We\t also\t advise\t the\t reader\t to\t go\tover\ttheir\tproofs\tagain,\tbecause\tthe\tproof\ttechniques\tfor\tthese\t results\tare\tas\timportant\tas\tthe\tresults\tthemselves.\t\t \t \t \t Some Useful Results (i) In\ta\tgraph\tG\twith\tn\tvertices,\tsuppose\tno\tvertex\thas\tdegree\t greater\tthan\tΔ.\tThen\tone\tcan\tcolor\tthe\tvertices\tusing\tat\tmost\t Δ+1\t colors,\t such\t that\t no\t two\t neighboring\t vertices\t are\t the\t same\tcolor.\t[Chapter\t1,\texample\t1]\t \t (ii) In\t a\t graph\tG\twith\tV\tvertices\t and\tE\tedges,\t there\t exists\t an\t induced\tsubgraph\tH\twith\teach\tvertex\thaving\tdegree\tat\tleast\t E/V.\t(In\tother\twords,\ta\tgraph\twith\taverage\tdegree\td\thas\tan\t induced\t subgraph\t with\t minimum\t degree\t at\t least\td/2)\t [Chapter\t1,\texample\t3]\t \t (iii) Given\t a\t graph\tG\tin\t which\t each\t vertex\t has\t degree\t at\t least\t (n−1),\tand\ta\ttree\tT\twith\tn\tvertices,\tthere\tis\ta\tsubgraph\tof\tG\t isomorphic\tto\tT.\t[Chapter\t2,\texample\t3]\t \t (iv) In\ta\tgraph\tG,\tif\tall\tvertices\thave\tdegree\tat\tleast\tδ,\tthen\tthere\t exists\ta\tpath\tof\tlength\tat\tleast\tδ+1.\t[Chapter\t4,\texample\t6]\t \t (v) The\t vertex\t set\tV\tof\t a\t graph\tG\ton\tn\tvertices\t can\t be\t partitioned\tinto\ttwo\tsets\tV1\tand\tV2\tsuch\tthat\tany\tvertex\tin\tV1\t has\tat\tleast\tas\tmany\tneighbors\tin\tV2\tas\tin\tV1\tand\tvice\tversa.\t [Chapter\t4,\texample\t8]\t Chapter 8: Graph Theory 3 (vi) A\ttournament\ton\tn\tvertices\tis\ta\tdirected\tgraph\tsuch\tthat\tfor\t any\ttwo\tvertices\tu\tand\tv,\tthere\tis\teither\ta\tdirected\tedge\tfrom\t u\tto\tv\tor\t from\tv\tto\tu.\t A\tHamiltonian path\tis\t a\t path\t passing\t through\t all\t the\t vertices.\t Every\t tournament\t has\t a\t Hamiltonian\tpath.\t[Chapter\t4,\texample\t10]\t \t \t More Useful Results and Applications Dominating Sets In\t a\t graph\tG\twith\t vertex\t set\tV,\t a\t subset\tD\tof\tV\tis\t set\t to\t be\t a\t dominating set if\tevery\tvertex\tv\tis\teither\tin\tD\tor\thas\ta\tneighbor\tin\t D.\t The\t next\t lemma\t tells\t us\t that\t under\t certain\t simple\t conditions,\t there\texists\ta\tfairly\tsmall\tdominating\tset.\t \t Lemma 8.1:\tIf\tG\thas\tno\tisolated\tvertices,\tthen\tit\thas\ta\tdominating\t set\tof\tsize\tat\tmost\t |\u0000| \u0000 .\t\t \t Proof:\tBy (v),\tthere\texists\ta\tbipartition\tV\t=\tV1\t∪\tV2\tso\tthat\tevery\t vertex\t in\tV1\thas\t at\t least\t as\t many\t neighbors\tin\tV2\tand\t vice\t versa.\t Since\t each\t vertex\t has\t degree\t at\t least\t 1,\t this\t implies\t that\t every\t vertex\t in\tV1\thas\t at\t least\t one\t neighbor\t in\tV2\tand\t vice\t versa.\t Thus\t both\tV1\tand\tV2\tare\t dominating\t sets.\t One\t of\t them\t has\t at\t most\t |\u0000| \u0000 \t vertices\tand\twe\tare\tdone.\t\t \t Remark:\t In\t the\t next\t chapter\t we\t will\t show\t that\t if\t the\t minimum\t degree\tin\tan\tn-vertex\tgraph\tG\tis\td\t>\t1,\tthen\tG\thas\ta\tdominating\tset\t containing\tat\tmost\tn\t \u0000\u0000\u0000\u0000(\u0000\u0000\u0000) \u0000\u0000\u0000 \tvertices.\t\t \t Spanning Trees Recall\t that\t a\tspanning subgraph\tof\t a\t graph\tG\tis\t a\t subgraph\t of\tG\t containing\t all\t of\t the\t vertices\t of\tG.\t A\tspanning tree in\tG\tis\t a\t spanning\tsubgraph\tthat\tis\ta\ttree\t(that\tis,\tit\tis\tacyclic).\tNote\tthat\tif\t Olympiad Combinatorics 4 G\tis\tnot\tconnected,\t it\t cannot\t have\t a\t spanning\t tree\t (because\t otherwise\t there\t would\t be\t a\t path\t between\t every\t pair\t of\t vertices\t along\t edges\t in\t this\t tree,\t contradicting\t disconnectedness).\t Do\t all\t connected\tgraphs\thave\tspanning\ttrees?\t Figure 8.1. A graph G and a spanning tree of G Lemma 8.2: Every\t (finite)\t connected\t graph\tG\t=\t (V,\tE)\t has\t a\t spanning\ttree.\t\t \t Proof:\tDelete\tedges\tfrom\tG\tas\tfollows.\tAs\tlong\tas\tthere\tis\tat\tleast\t one\tcycle\tpresent,\ttake\tone\tcycle\tand\tdelete\tone\tedge\tin\tthat\tcycle.\t Notice\t that\t this\t procedure\t cannot\t destroy\t connectivity,\t so\t the\t graph\t obtained\t at\t each\t stage\t is\t connected.\t This\t process\t cannot\t continue\t indefinitely\t (we\t are\t dealing\t with\t finite\t graphs),\t so\t eventually\t we\t get\t a\t connected\t graph\t with\t no\t cycles.\t This\t is\t the\t required\t spanning\t tree\t (note\t that\t all\t the\t vertices\t of\tV\tare\t still\t present\tsince\twe\tonly\tdeleted\tedges).\t\t \t Spanning\t trees\t arise\t very\t often\t in\t the\t study\t of\t graphs,\t especially\tin\toptimization\tproblems.\tI\tlike\tto\tthink\tof\tthem\tas\tthe\t “skeleton”\t of\t the\t graph,\t since\t they\t are\t in\t a\t sense\tthe\t minimal\t structure\t that\t is\t still\t connected\t on\t its\t own.\t Their\t main\t usage\t on\t Olympiad\tproblems\tis\tthat\tinstead\tof\tfocusing\ton\tgeneral\tgraphs\tG\t which\tmay\t have\t a\tcomplicated\t structure,\t we\tcan\tsometimes\t find\t what\t we\t are\t looking\t for\t just\t by\t taking\t a\t spanning\ttree.\t For\t our\t purposes,\tall\tyou\treally\tneed\tto\tknow\tabout\tspanning\ttrees\tis\t a) They\tare\ttrees\t b) They\texist\t(unless\tG\tisn’t\tconnected).\t\t A\t B\t C\t D\t E\tF\t C B E F D A Chapter 8: Graph Theory 5 We’ll\t now\t use\t our\t arsenal\t of\t lemmas\t to\t reduce\t some\t rather\t challenging\tOlympiad\tproblems\tto\tjust\ta\tfew\tlines.\t \t\t\t Example 1 [Based on ELMO Shortlist 2011, C7] Let\tT\tbe\ta\ttree\twith\tt\tvertices,\tand\tlet\tG\tbe\ta\tgraph\twith\tn\tvertices.\t Show\t that\t if\tG\thas\t at\t least\t (t−1)n\tedges,\t then\tG\thas\t a\t subgraph\t isomorphic\tto\tT.\t \t Answer: By\t(ii),\tG has\ta\tsubgraph\tH\tsuch\tthat\tall\tvertices\tin\tH\thave\tdegree\t at\tleast\tt−1\t(in\tH).\tApplying\t(iii),\tH\thas\ta\tsubgraph\tisomorphic\tto\t T.\t■\t Remark: This\t is\t probably\t the\t shortest\t solution\t to\t a\t problem\t in\t this\tbook.\tNote\tthat\tit\twould\tactually\tbe\tquite\ta\tdifficult\tproblem\tif\t you\tdidn’t\tknow\tthe\tsuper\tuseful\tlemmas\tlisted\tabove!\t \t Example 2 [Based on ELMO Shortlist 2011, C2] Let\tG\tbe\ta\tdirected\tgraph\twith\tn\tvertices\tsuch\tthat\teach\tvertex\thas\t indegree\tand\toutdegree\tequal\tto\t2.\tShow\tthat\twe\tcan\tpartition\tthe\t vertices\t of\tG\tinto\t three\t sets\t such\t no\t vertex\t is\t in\t the\t same\t set\t as\t both\tthe\tvertices\tit\tpoints\tto.\t\t \t Answer: Take\t a\t partition\t that\t maximizes\t the\t number\t of\t “crossing\t edges”,\t that\tis,\tedges\tbetween\tdistinct\tsets.\tIf\tsome\tv belongs\tto\tthe\tsame\t set\tas\tboth\tof\tits\tout-neighbors,\tmoving\tv\tto\tone\tof\tthe\tother\ttwo\t sets\t (whichever\t has\t fewer\t in-neighbors\t of\tv)\t will\t add\t 2\t crossing\t edges\tbut\tdestroy\tat\tmost\t1\told\tone.\tThen\twe\tget\ta\tpartition\twith\t even\t more\t crossing\t edges,\t contradiction.\t Thus\t the\t original\t partition\tindeed\tworks.\t■\t Remark:\tThis\tis\tessentially\tthe\tsame\tidea\tused\tto\tprove\t(v).\t\t \t Example 3 [Russia 2001] A\tcompany\twith\t2n+1\tpeople\thas\tthe\tfollowing\tproperty:\tFor\teach\t group\t of\tn\tpeople,\t there\t exists\t a\t person\t amongst\t the\t remaining\t n+1\t people\t who\t knows\t everyone\t in\t this\t group.\t Show\t that\t there\t exists\t a\t person\t who\t knows\t all\t the\tpeople\t in\t the\t company.\t (As\t Olympiad Combinatorics 6 usual,\tknowing\tis\tmutual:\tA\tknows\tB\tif\tand\tonly\tif\tB\tknows\tA).\t\t \t Answer: Assume\t to\t the\t contrary\t that\t no\t one\t knows\t everyone\t else.\t Construct\t a\t graph\tG\twith\t 2n+1\t vertices\t representing\t the\t people,\t and\tan\tedge\tbetween\ttwo\tvertices\tif\tand\tonly\tif\tthose\ttwo\tpeople\t do not know\t each\t other.\t Our\t assumption\t implies\t that\t every\t vertex\thas\tdegree\tat\tleast\t1.\tNow\tapplying\tlemma\t8.1,\tthere\texists\t a\tdominating\tset\tof\tG\tcontaining\tn\tvertices.\tThis\tmeans\tthat\teach\t of\tthe\tother\tn+1\tvertices\thas\ta\tneighbor\tin\tthis\tset\tof\tn\tvertices.\tIn\t other\t words,\t no\t person\t outside\t this\t set\t of\tn\tpeople\t knows\t everyone\t in\t this\t set,\t contradicting\t the\t problem\t statement.\t This\t contradiction\testablishes\tthe\tresult.\t■\t \t \t \t The Extremal Principle We’ve\talready\tencountered\tthe\textremal\tprinciple\tseveral\ttimes\tin\t various\t forms.\t The\t true\t power\t of\t this\t technique\t lies\t in\t its\t ubiquitous\tuse\tin\tgraph\ttheory.\tIn\teach\tof\tthe\tnext\tfive\texamples,\t the\tstep\tin\twhich\twe\tuse\tthe\textremal\tprinciple\tis\tmarked\tin\tbold\t letters.\t \t Example 4 [IMO Shortlist 2004, C3] The\t following\t operation\t is\t allowed\t on\t a\t finite\t graph:\t choose\t any\t cycle\t of\t length\t 4\t (if\t one\t exists),\t choose\t an\t arbitrary\t edge\t in\t that\t cycle,\t and\t delete\t this\t edge\t from\t the\t graph.\t For\t a\t fixed\t integer\t n\t≥\t4,\t find\t the\t least\t number\t of\t edges\t of\t a\t graph\t that\t can\t be\t obtained\t by\t repeated\t applications\t of\t this\t operation\t from\t the\t complete\tgraph\ton\tn\tvertices\t(where\teach\tpair\tof\tvertices\tis\tjoined\t by\tan\tedge).\t\t \t Answer: Clearly\t the\t answer\t cannot\t be\t less\t than\tn−1,\tsince\t the\t graph\t obtained\tat\teach\tstage\twill\talways\tbe\tconnected.\tWe\tclaim\tthat\tthe\t Chapter 8: Graph Theory 7 graph\tobtained\tat\teach\tstage\tis\talso\tnon\tbipartite.\tThis\twill\timply\t that\tthe\tanswer\tis\tat\tleast\tn\t(since\ta\tgraph\twith\tn-1\tvertices\tis\ta\t tree\twhich\tis\tbipartite).\t\t \t Kn\tis\t non-bipartite\t (it\t has\t a\t triangle),\t so\t suppose\t to\t the\t contrary\t that\t at\t some\t stage\t the\t deletion\t of\t an\t edge\t makes\t the\t graph\tbipartite.\tConsider\tthe\tfirst\ttime\tthis\thappens.\tLet\tedge\tAB\t from\tthe\t4\tcycle\tABCD\tbe\tthe\tdeleted\tedge.\tSince\tthe\tgraph\tis\tnon\t bipartite\t before\t deleting\t AB\t but\t bipartite\t afterwards,\t it\t follows\t that\tA\tand\tB\tmust\tlie\ton\tthe\tsame\tside\tof\tthe\tpartition.\tBut\tsince\t BC,\tCD,\tDA\tare\tedges\tin\tthe\tnow-bipartite\tgraph,\tit\tfollows\tthat\tC\t and\t A\t are\t on\t one\t side\t and\t B\t and\t D\t are\t on\t the\t other\t side\t of\t the\t bipartition.\tContradiction.\t Figure 8.2. \t To\t show\tn\tcan\t be\t achieved,\t let\t the\t vertices\t be\tV1,\tV2,\t …,\tVn.\t Remove\tevery\tedge\tViVj\twith\t3\t≤\ti\t<\tj\t<\tn\tfrom\tthe\tcycle\tV2\tVi Vj Vn.\t Then\tfor\t3\t≤\ti\t<\tn\tdelete\tedges\tV2\tVi\tand\tVi Vn\tfrom\tcycles\tV1\tV2\tVi Vn\t and\tV1\tVi Vn V2\trespectively.\tThis\tleaves\tus\twith\tonly\tn\tedges:\tV1\tVi\t for\t2\t≤\ti\t≤\tn\tand\tV2\tVn.\t■\t \t Remark:\tYou\tmay\thave\tbeen\ttempted\tto\tguess\tthat\tthe\tanswer\tis\t (n−1),\t since\t the\t problem\t looks\t like\t the\t algorithm\t for\t obtaining\t a\t spanning\t tree.\t While\t guessing\t and\t conjecturing\t is\t an\t important\t part\tof\tsolving\tproblems,\tit\tis\timportant\tto\tverify\tthese\tguesses\tby\t experimenting\ta\tbit\tbefore\ttrying\tto\tprove\tthe\tguess.\tThe\tprocess\t of\trealizing\tyour\tguess\twas\twrong\tmay\tgive\tyou\ta\tclue\tas\tto\thow\t to\tproceed\twith\tthe\tproof.\tIn\tthis\texample,\tyou\tmay\thave\tnoticed\t that\t the\t graph\t you\t end\t up\t with\t always\t had\t an\t odd\t cycle,\t which\t C B D A Olympiad Combinatorics 8 would\t lead\t to\t the\t correct\t claim\t that\t the\t graph\t obtained\t is\t never\t bipartite.\t\t \t\t Example 5 [Croatian TST 2011] There\t are\tn\tpeople\t at\t a\t party\t among\t whom\t some\t are\t friends.\t Among\tany\t4\tof\tthem\t there\tare\teither\t3\twho\tare\tall\tfriends\twith\t each\tother\tor\t3\twho\taren’t\tfriends\twith\teach\tother.\tProve\tthat\tthe\t people\tcan\tbe\tseparated\tinto\ttwo\tgroups\tA\tand\tB\tsuch\tthat\tA\tis\ta\t clique\t(that\tis,\teveryone\tin\tA\tis\tfriends\twith\teach\tother)\tand\tB\tis\t an\t independent\t set\t (no\t one\t in\tB\tknows\t anyone\t else\t in\tB).\t (Friendship\tis\ta\tmutual\trelation).\t\t\t \t Answer Construct\ta\tgraph\tG\twith\tvertices\trepresenting\tpeople\tand\tedges\t between\ttwo\tpeople\tif\tthey\tare\tfriends.\tThe\tnatural\tidea\tis\tto\tlet\tA\t be\t the\tlargest clique in G,\t and\t the\t remaining\t people\t as\tB.\t We\t prove\tthat\tthis\tworks.\t \t If\tA=G\tor\t|A|=1\twe\tare\ttrivially\tdone,\tso\tassume\tthat\tn\t>|A|\t≥\t2.\t We\t only\t need\t to\t show\t that\tB\tis\t independent,\t that\t is,\tG-A\tis\t independent.\tAssume\tto\tthe\tcontrary\tv1,\tv2\tbelong\tto\tG−A\tand\tv1v2\t is\t an\t edge.\t Since\tA\tis\t the\t largest\t clique,\t there\t exists\tu1\tin\tA\tsuch\t that\tv1u1\tis\tnot\tan\tedge\t(otherwise\twe\tcould\tadd\tv1\tto\tA,\tforming\ta\t bigger\tclique).\t\t Figure 8.3. A u u1\t v 2 v 1 Chapter 8: Graph Theory 9 If\tu1v2\tis\tnot\tan\tedge,\tthen\tlet\tu\tbe\tany\tother\tvertex\tin\tA.\tSince\t v1v2\tand\tuu1\tare\tedges,\tby\tthe\tcondition\tof\tthe\tproblem\tthere\tmust\t be\t a\t triangle\t amongst\t these\t four\t vertices.\t The\t only\t possibility\t is\t uv1v2\tsince\tu1v2\tand\tu1v1\tare\tnot\tedges.\tThen\tuv1\tand\tuv2\tare\tedges\t for\tall\tu\tin\tA,\tso\tA\tU\t{v1,\tv2}\\\t{u1}\tis\ta\tlarger\tclique,\tcontradiction.\t \t Similarly,\t if\tv2u1\tis\t an\t edge,\t then\t for\t all\tu\tin\tA\teither\tv2u1u\tor\t v2v1u\tmust\tbe\ta\ttriangle.\tIn\teither\tcase\tv2u\tis\tan\tedge\tfor\tall\tu\tin\tA.\t Thus\tA\tU\t{v2}\tis\ta\tlarger\tclique,\tcontradiction.\t■\t \t Example 6 [Degree vectors] A\t vector\tv\t=\t [d1\td2\t…\tdk]\t with\td1\t≥\td2\t≥\t …\t ≥\tdk\tis\t said\t to\t be\t a\t graphical\tvector\tif\tthere\texists\ta\tgraph\tG\twith\tk\tvertices\tx1,\tx2,\t…,\txk\t having\tdegrees\td1,\td2,\t…,\tdk\trespectively.\tNote\tthat\tthere\tcould\tbe\t multiple\t graphs\tG\twith\t degree\t vector\tv.\t Let\tv’\t be\t the\t vector\t obtained\tfrom\tv\tby\tdeleting\td1\tand\tsubtracting\t1\tfrom\tthe\tnext\td1\t components\t of\tv.\t Let\tv1\tbe\t the\t non-increasing\t vector\t obtained\t from\tv’\tby\trearranging\tcomponents\tif\tnecessary.\t(For\texample,\tif\tv\t =\t[4\t3\t3\t2\t2\t2\t1\t1]\tthen\tv’\t=\t[2 2 1 1\t2\t1\t1]\tand\tv1\t=\t[2\t2\t2\t1\t1\t1\t1].)\t Show\tthat\tv1\tis\talso\ta\tgraphical\tvector.\t\t \t Answer: Let\tS\tbe\tthe\tsum\tof\tthe\tindices\tof\tthe\tneighbors\tof\tx1\t(for\tinstance,\t if\tx1\tis\tadjacent\tto\tx3,\tx4\tand\tx8,\tthen\tS\t=\t15).\tTake\tthe\tgraph\tG\twith\t degree\tvector\tv\tsuch\tthat\tthe\tS is as small as possible.\t\t \t Now\twe\tclaim\tthat\tthere\tdo\tnot\texist\tindices\ti\t<\tj\tsuch\tthat\tx1xi\t is\tnot\tan\tedge\tand\tx1xj\tis\tan\tedge\tin\tG.\tSuppose\tthe\tcontrary.\tSince\t di\t≥\tdj,\tthere\tmust\tbe\tsome\tvertex\txt\tsuch\tthat\txixt\tis\tan\tedge\tbut\txjxt\t is\t not\t an\t edge.\t Now\t in\tG,\t delete\t edges\tx1xj\tand\txixt\tand\t replace\t them\t with\t edges\tx1xi\tand\txjxt.\t Note\t that\t all\t degrees\t remain\t unchanged,\t but\t the\t sum\t of\t indices\t of\t neighbors\t of\tv1\thas\t decreased\tby\t(j–i),\tcontradicting\tour\tassumption\ton\tG.\tThis\tproves\t our\tclaim.\t\t Olympiad Combinatorics 10 Figure 8.4. Illustration of a swap that decreases S Our\t claim\t implies\t that\tx1\tis\t adjacent\t to\t the\t next\td1\tvertices,\t namely\tx2,\tx3,\t…,\txd1+1.\tHence\tv1\tis\tnothing\tbut\tthe\tgraphical\tvector\t of\tthe\tgraph\tobtained\tfrom\tG\tby\tdeleting\tx1,\tsince\tthen\tthe\tdegrees\t of\tits\tneighbors\tall\treduce\tby\tone.\tHence\tv1\tis\tgraphical.\t■\t \t Remark 1: How\tdid\twe\tcome\tup\twith\tour\trather\tstrange\textremal\t condition\tin\t the\t first\t paragraph?\tThe\t problem\t provides\t a\t hint:\t it\t says\twe\tdelete\td1\tand\tsubtract\t1\tfrom\tthe\tnext\td1\tcomponents\tto\t obtain\tv’.\t Hence\t we\t wanted\t a\t graph\t such\t that\tx1\tis\t connected\tto\t the\t next\td1\tvertices,\t since\t in\t this\t case\tsimply\t removing\t vertex\tx1\t would\thave\tprecisely\tthis\teffect\ton\tthe\tdegree\tvector\t(this\tis\tour\t reasoning\tin\tthe\tlast\tparagraph\tof\tthe\tproof).\tNow\tto\tprove\tsuch\ta\t graph\t exists,\t we\t needed\t a\t simple\t extremal\t property\t satisfied\t by\t such\t a\t graph.\t This\t naturally\t leads\t to\t our\t definition\t of\tS\tand\t the\t extremal\tcondition\tthat\tG\tminimizes\tS.\t\t \t Remark 2: This\t is\t quite\t a\t useful\t lemma\t for\t testing\t whether\t a\t given\tdegree\tsequence\tis\tgraphical\t(see\texercise\t27).\t\t \t Example 7 [MOP 2008] Prove\tthat\tif\tthe\tedges\tof\tKn,\tthe\tcomplete\tgraph\ton\tn\tvertices,\tare\t colored\t such\t that\t no\t color\t is\t assigned\t to\t more\t than\tn−2\t edges,\t there\texists\ta\ttriangle\tin\twhich\teach\tedge\tis\ta\tdistinct\tcolor.\t \t Answer Assume\tto\tthe\tcontrary\tthat\tthere\texists\tno\tsuch\ttriangle.\tDefine\ta\t C-connected component\tto\t be\t a\t set\t of\t vertices\t such\t that\t for\t any\t x1 xi xj xt x1 xi xj xt Chapter 8: Graph Theory 11 two\t vertices\t in\t that\t set,\t there\t exists\t a\t path\t between\t them,\t all\t of\t whose\tedges\tare\tof\tcolor\tC.\tNow\tlet\tX\tbe\tthe\tlargest C-connected\t component\tof\tthe\tgraph\tfor\tany\tcolor\tC,\tand\tsay\tthe\tcolor\tof\tX\tis\t red.\t\t \t Suppose\t there\t is\t a\t vertex\tv\tnot\t in\tX.\t Consider\t two\t vertices\tu1\t and\tu2\tthat\tare\tjoined\tby\ta\tred\tedge.\tNeither\tedge\tvu1\tnor\tedge\tvu2\t can\tbe\tred\t(otherwise\tv\tcould\tbe\tadded\tto\tX).\tSo\tvu1\tand\tvu2\tare\t the\tsame\tcolor\t(otherwise\tvu1u2\twould\thave\tthree\tdistinct\tcolors,\t contradicting\t our\t assumption).\t It\t follows\t that\tv\tis\t joined\t to\t all\t elements\tof\tX\tby\tthe\tsame\tcolor\tedge,\tsay\tblue.\tBut\tthen\tX\t∪\t{v}\tis\t a\tlarger\tconnected\tcomponent\t(of\tcolor\tblue),\tcontradiction.\t\t \t It\tfollows\tthat\tthere\tcannot\tbe\tany\tvertex\tv\toutside\tX,\tso\tall\tn\t vertices\tare\tin\tX.\tNow,\tsince\tX\tis\tred-connected\tand\thas\tn\tvertices,\t there\tmust\tbe\tat\tleast\tn−1\tred\tedges,\tcontradiction.\t■\t \t Example 8 [Generalization of USAMO 2007-4] Given\ta\tconnected\tgraph\tG\twith\tV\tvertices,\teach\thaving\tdegree\tat\t most\tD,\t show\t that\tG\tcan\t be\t partitioned\t into\t two\t connected\t subgraphs,\teach\tcontaining\tat\tleast\t \u0000\u0000\u0000 \u0000 \tvertices.\t\t \t Answer: We\tinduct\ton\tE,\tthe\tnumber\tof\tedges\tof\tG.\tWhen\tE\t=\t1,\tthere\tare\t only\t two\t vertices\t and\t the\t partition\t consists\t of\t two\t isolated\t vertices.\tFor\tthe\tinduction\tstep,\tnote\tthat\tif\twe\tcan\tdelete\tan\tedge\t and\tG\tremains\t connected,\t we\t are\t done\t by\t induction.\t Hence\t we\t only\tconsider\tthe\tcase\twhen\tG\tis\ta\ttree.\t\t \t Pick\t the\t root\tx\tsuch\t that\t the\t size\t of\t the\tlargest subtree T is minimized.\t Clearly\t |T|\t≥\t \u0000\u0000\u0000 \u0000 ,\t since\t there\tare\t at\tmost\tD\tsubtrees\t and\tV–1\tvertices\tamongst\tthem.\tAlso,\t|T|\t≤\t \u0000 \u0000 .\tThis\tis\tbecause\tif\t|T|\t >\t \u0000 \u0000 ,\tthen\tinstead\tof\trooting\tthe\ttree\tat\tx\twe\tcould\troot\tthe\ttree\tat\t the\t first\t vertex\ty\tof\tT.\t This\t would\t decrease\t |T|\t by\t 1,\t but\tT\\{y}\t would\tstill\tbe\tthe\tlargest\tsubtree\tsince\tit\twould\tstill\thave\tat\tleast\t Olympiad Combinatorics 12 \u0000\u0000\u0000 \u0000 \tvertices.\t This\t would\t contradict\t our\t assumption\t on\tx,\t as\t we\t would\thave\ta\tsmaller\tlargest\tsubtree.\t\t \t Thus\t \u0000 \u0000\t>|T|\t≥\t \u0000\u0000\u0000 \u0000 .\tTake\tT\tto\tbe\tone\tsubgraph\tand\tG\t–\tT\tto\tbe\t the\tother.\tBoth\thave\tsize\tat\tleast\t \u0000\u0000\u0000 \u0000 \tby\tthe\tbounds\ton\tT\tand\tare\t connected,\tso\twe\thave\tfound\ta\tvalid\tpartition.\t■\t \t Remark:\t The\t “induction”\t in\t the\t first\t paragraph\t is\t really\t just\t a\t formal\t way\t of\t saying\t “Well,\t the\tworst\tcase\t for\t us\t is\t when\tG\tis\t a\t tree,\tso\tlet’s\tjust\tforget\tabout\tgeneral\tgraphs\tand\tprove\tthe\tresult\t for\ttrees:\t\tif\tit’s\ttrue\tfor\ttrees,\tit’s\ttrue\tfor\teveryone”.\tAnother\tway\t of\treducing\tthe\tfocus\tto\tjust\ttrees\tis\tto\ttake\ta\tspanning\ttree\tof\tG.\t \t \t \t Hall’s Marriage theorem Given\tN\tsets\t(not\tnecessarily\tdistinct),\twe\tsay\tthat\tthe\tfamily\tof\tN\t sets\t has\t a\tsystem of distinct representatives\t(SDR)\t if\t it\t is\t possible\tto\tchoose\texactly\tone\telement\tfrom\teach\tset\tsuch\tthat\tall\t the\t chosen\t elements\t are\t distinct.\t For\t example,\t if\t we\t have\t 4\t sets\t {1,\t2,\t3},\t{2,\t4},\t{2,\t3,\t4}\tand\t{1,\t3}\tthen\tthis\tfamily\thas\t(1,\t2,\t4,\t3)\tas\t a\tsystem\tof\tdistinct\trepresentatives.\tUnder\twhat\tconditions\tdoes\ta\t family\t have\t a\t system\t of\t distinct\t representatives?\t One\t obvious\t necessary\tcondition\tis\tthat\tfor\tany\tsubfamily\tof\tk\tsets,\tthe\tunion\tof\t these\tk\tsets\t must\t have\t at\t least\tk\telements.\t It\t turns\t out\t that\t this\t condition,\tknown\tas\tthe\tmarriage\tcondition,\tis\talso\tsufficient.\t\t \t Example 9 [Hall’s Marriage Theorem]\t Show\tthat\tthe\tmarriage\tcondition\tis\tsufficient\tfor\tthe\texistence\tof\t an\tSDR.\t\t \t Proof:\tLet\tthe\tmarriage\tcondition\thold\tfor\tthe\tfamily\tA1,\tA2,\t…,\tAn.\t Keep\tdeleting\telements\tfrom\tthese\tsets\tuntil\ta\tfamily\tF’\t=\tA1’,\tA2’,\t …,\tAn’\tis\treached\tsuch\tthat\tthe\tdeletion\tof\tany\telement\twill\tcause\t Chapter 8: Graph Theory 13 the\tmarriage\tcondition\tto\tbe\tviolated.\tWe\tclaim\tthat\tat\tthis\tstage\t each\t set\t contains\t exactly\t one\t element.\t This\t would\t imply\t the\t result,\t since\t these\t elements\t would\t be\t distinct\t by\t the\t marriage\t condition,\tand\twould\thence\tform\tthe\trequired\tSDR.\t\t \t Suppose\t our\t claim\t is\t false.\t Then\t some\t set\t contains\t at\t least\t 2\t elements.\t WLOG\t this\t set\t is\tA1\tand\t let\tx\tand\ty\tbe\t elements\t of\tA1.\t Deleting\tx\tor\ty\twould\t violate\t the\t marriage\t condition\t by\t the\t definition\tof\tF’.\tThus\tthere\texists\tsubsets\tP\tand\tQ\tof\t{2,\t3,\t4,\t…,\tn}\t such\tthat\tX=(A1’–x)\t∪\t(⋃ \u0000\u0000′)\u0000є\u0000 \tand\tY=(A1’–y)\t∪\t(⋃ \u0000\u0000′)\u0000є\u0000 \tsatisfy\t |X|\t≤\t|P|\tand\t|Y|\t≤\t|Q|.\tAdding\tgives\t\t \t |X|\t+\t|Y|\t=\t|X\t⋂\u0000|\t+\t|X\t⋃\u0000|\t≤\t|P|\t+\t|Q|.\t \t Now,\tX\t⋃\u0000\t=\tA1’\t∪\t(⋃ \u0000\u0000′)\u0000є\u0000⋃\u0000 \tand\tX\t⋂\u0000\t=\t⋃ \u0000\u0000′\u0000є\u0000⋂\u0000 .\t \t Thus\tthe\tmarriage\tcondition\timplies\tthat\t\t \t |X\t∪\tY|\t≥\t1\t+\t|P\t∪\tQ|,\tand\t|X\t⋂\u0000|\t≥\t|P\t⋂\u0000|.\t\t \t Adding\tgives\t\t \t |X\t⋂\u0000|\t+\t|X\t⋃\u0000|\t≥\t1\t+\t|P\t∪\tQ|\t+\t|P\t⋂\u0000|\t=\t|P|\t+\t|Q|\t+\t1,\t \t contradicting\tour\tearlier\tbound.\t■\t \t Remark:\tThe\tkey\tidea\tin\tthis\tproof\twas\tthe\tfact\tthat\tthe\tmarriage\t condition\tholds\tfor\tthe\tsets\tA1’,\tA2’,…\tAn’\tbut\tnot\tfor\tA1\t\\\t{x},\tA2’,\t…,\t An’\tand\tA1\t\\\t{y},\tA2’,\t…,\tAn’.\tThis\tproof\tillustrates\tan\timportant\tidea:\t it’s\t useful\t to\t exploit\t conditions\t given\t to\t us,\t but\t it’s\t even\t more\t useful\tto\texploit\tsituations\twhen\tthe\tconditions\tdon’t\thold.\t \t Hall’s\tmarriage\ttheorem\twas\tphrased\tabove\tin\tthe\tlanguage\tof\tset\t theory,\t but\t we\t can\t also\t interpret\t it\t in\t graph\t theoretical\t terms.\t Consider\t a\t bipartite\t graph\tG\twith\t vertex\t set\tV\t=\tV1\t∪\tV2.\t A\t complete matching\tof\tthe\tvertices\tof\tV1\tis\ta\tsubset\tof\tthe\tedges\tof\tG\t Olympiad Combinatorics 14 such\tthat:\t (i) Every\tvertex\tof\tV1\tis\tincident\ton\texactly\tone\tedge\t (ii) Each\tvertex\tof\tV2\tis\tincident\ton\tat\tmost\tone\tedge\t \t In\t other\t words,\t it\t is\t a\t pairing\t such\t that\t every\t vertex\t in\tV1\tis\t paired\t with\t a\t vertex\t in\tV2\tand\t no\t two\t vertices\t in\tV1\tare\t paired\t with\tthe\tsame\tvertex\tof\tV2.\tThe\tvertices\tin\ta\tpair\tare\tjoined\tby\tan\t edge.\t\t \t If\t the\t vertices\t of\tV1\trepresent\t the\t sets\tA1,\tA2,\t …,\tAn\tand\t the\t vertices\t of\tV2\trepresent\t elements\t in\t⋃ \u0000\u0000 \u0000 \u0000\u0000\u0000 ,\t then\t a\t complete\t matching\t of\tV1\tgives\t us\t a\t system\t of\t distinct\t representatives\t (namely\t the\t vertices\t of\tV2\tto\t which\t the\t vertices\t of\tV1\tare\t matched).\t\t \t Example 10 [Canada 2006-3] In\t a\t rectangular\t array\t of\t nonnegative\t reals\t with\tm\trows\t and\tn\t columns,\teach\trow\tand\teach\tcolumn\tcontains\tat\tleast\tone\tpositive\t element.\t Moreover,\t if\t a\t row\t and\t a\t column\t intersect\t in\t a\t positive\t element,\tthen\tthe\tsums\tof\ttheir\telements\tare\tthe\tsame.\tProve\tthat\t m\t=\tn.\t Answer: Create\ta\tbipartite\tgraph,\twith\tthe\tleft\tside\trepresenting\trows\tand\t the\tright\tside\tfor\tcolumns.\tPlace\tan\tedge\tbetween\ttwo\tvertices\tif\t and\t only\t if\t the\t corresponding\t row\t and\t column\t intersect\t in\t a\t positive\telement.\tThe\tidea\tis\tto\tshow\tthat\tthere\tis\ta\tmatching\tfrom\t rows\tto\tcolumns,\tso\tn\t≥\tm.\tBy\tsymmetry\tthe\tsame\targument\twill\t give\tm\t≥\tn,\timplying\tm\t=\tn.\t \t Assume\t to\t the\t contrary\t there\t is\t no\t such\t matching.\t Then\t the\t marriage\tcondition\tmust\tbe\tviolated,\tso\tthere\texists\tsome\tset\tS\tof\t rows\t having\t a\t total\t set\tT\twith\t|T|\t<\t|S|\tof\t columns\t in\t which\t positive\tentries\tappear.\tLet\tthe\tsums\tof\tthe\t|S|\trows\tbe\ts1,\t…,\tsk.\tBy\t the\tproperty,\teach\tof\tthe\t|T|\tcolumns\thas\tsum\tequal\tto\tone\tof\tthe\t si.\tSo\tthe\ttotal\tsum\tof\tthe\telements\tin\tthe\tS\trows,\twhen\tcalculated\t from\t the\t column\t point\t of\t view\t (since\t entries\t outside\t are\t all\t Chapter 8: Graph Theory 15 nonnegative)\t is\t at\t most\ta\t sum\t of\t a\t subset\t of\t the\tsi.\t Yet\t from\t the\t row\t point\t of\t view,\t it\t is\t the\t full\t sum.\t As\t all\tsi\t>\t0,\t this\t is\t a\t contradiction.\t■\t \t Remark:\t This\t duality\t between\t arrays\t of\t numbers\t (i.e.\t matrices)\t and\t graphs\t (especially\t bipartite\t graphs)\t comes\t up\t very\t often.\t Keep\t an\t eye\t out\t for\t this\t trick,\t since\t it\t can\t prove\t very\t useful.\t In\t fact,\t analyzing\t and\t algebraically\t manipulating\t these\t matrices\t allows\t graph\t theory\t to\t be\t studied\t from\t an\t algebraic\t viewpoint,\t and\t fast\t algorithms\t for\t multiplying\t matrices\t form\t the\t basis\t of\t a\t class\t of\t algorithms\t for\t large\t graphs\t known\t as\t algebraic\t graph\t algorithms.\t\t\t \t \t \t Unexpected Applications of Graph Theory Most\t problems\t in\t previous\t sections\t suggested\t a\t natural\t graph\t theoretic\t interpretation.\t In\t this\t section,\t we\t will\t leverage\t the\t power\t of\t graphs\t to\t model\t complex\t relationships\t in\t nonobvious\t ways.\t Carefully\t constructed\t graphs\t can\t reduce\t unfamiliar,\t complex\tproblems\tto\tfamiliar\tgraph\ttheoretic\tones.\t \t\t Example 11 [Taiwan 2001] Let\tn\t≥\t3\tbe\tan\tinteger\tand\tlet\tA1,\tA2,\t…,\tAn\tbe\tn\tdistinct\tsubsets\tof\t S\t=\t{1,\t2,\t…,\tn}.\tShow\tthat\tthere\texists\tan\telement\tx\tє\tS\tsuch\tthat\t the\tsubsets\tA1\t\\\t{x},\tA2\t\\\t{x},\t…,\tAn\t\\\t{x}\tare\talso\tdistinct.\t \t Answer: We\t construct\t a\t graph\tG\twith\t vertices\tA1,\tA2,\t …,\tAn.\t For\t each\t element\ty,\tif\tthere\texist\tdistinct\tsets\tAi\tand\tAj\tsuch\tthat\tAi\t\\\t{y}\t=\t Aj\t\\\t{y},\twe\tselect\texactly one\tsuch\tpair\t(Ai,\tAj)\tand\tjoin\tthem\tby\t an\tedge\t(even\tif\tthere\tare\tmultiple\tsuch\tpairs,\twe\tselect\tonly\tone\t for\teach\ty).\tSuppose\tto\tthe\tcontrary\tthere\tdoesn’t\texist\tx\tas\tstated\t in\tthe\tproblem.\tThen\tall\telements\tof\tS\tcontribute\tat\tleast\tone\tedge\t to\tthe\tgraph.\tMoreover,\tit\tis\timpossible\tfor\ttwo\tdifferent\telements\t Olympiad Combinatorics 16 to\tcontribute\tthe\tsame\tedge\tsince\tif\tAi\t\\\ty1\t=\tAj\t\\\ty1\tand\tAi\t\\\ty2\t=\t Aj\t\\\ty2\tfor\tdistinct\ty1\tand\ty2,\tthis\twould\tforce\tAi\t=\tAj.\t\t \t Thus\tG\thas\t at\t least\tn\tedges,\t and\t hence\t has\t a\t cycle,\t WLOG\t A1A2…AkA1\tfor\tsome\tk\t≥\t3.\tThen\tthere\texists\tsome\tdistinct\tx1,\tx2,\t…,\t xk\tsuch\tthat\tA1\t\\\t{x1}\t=\tA2\t\\\t{x1};\tA2\t\\\t{x2}\t=\tA3\t\\\t{x2},\t…,\tAk\t\\\t{xk}\t=\t A1\t\\\txk.\tNow\tx1\tis\tin\texactly\tone\tof\tA1\tand\tA2\t(otherwise\tA1\t=\tA2).\t WLOG\tit\tis\tin\tA2\tbut\tnot\tin\tA1.\tBut\tthen\tx1\tmust\talso\tbe\tin\tA3\tsince\t A2\t\\\t{x2}\t =\tA3\t\\\t{x2},\t and\t similarly\t must\t be\t in\tA4,\t and\t so\t on.\t We\t finally\tget\tthat\tx1\tє\tA1,\ta\tcontradiction.\t■\t \t The\t next\t problem,\t like\t several\t others\t in\t this\t book,\t underscores\t the\t usefulness\t of\t induction.\t Problems\t with\t around\t “2 n ”\t objects\t practically\t beg\t you\t to\t induct:\t all\t you\t need\t to\t do\t is\t find\t an\t appropriate\t way\t to\t split\t the\t set\t of\t objects\t into\t two\t parts,\t and\t apply\t the\t induction\t hypothesis\t to\t the\t larger\t or\t smaller\t part\t as\t applicable.\tBut\thow\tdoes\tthis\tconnect\tto\tgraph\ttheory?\t\t \t Example 12 [USA TST 2002] Let\tn\tbe\ta\tpositive\tinteger\tand\tlet\tS\tbe\ta\tset\tof\t(2 n +1)\telements.\tLet\t f\tbe\ta\tfunction\tfrom\tthe\tset\tof\ttwo-element\tsubsets\tof\tS\tto\t{0,\t1,\t…,\t (2 n-1 −1)}.\t Assume\t that\t for\t any\t elements\t (x,\ty,\tz)\t of\tS,\t one\t of\t f({x,\ty}),\tf({y,\tz})\tand\tf({z,\tx})\tis\tequal\tto\tthe\tsum\tof\tthe\tother\ttwo.\t Show\tthat\tthere\texist\ta,\tb,\tc\tin\tS\tsuch\tthat\tf{a,\tb},\tf{b,\tc)\tand\tf{c,\ta}\t are\tall\tequal\tto\t0.\t \t Answer Step 1: The basic strategy Our\tidea\tis\tto\tfind\ta\tsubset\tS’\tof\tS\tsuch\tthat\t|S’|\t≥\t2 n-1\t+\t1\tand\tfor\tall\t x,\ty\tin\tS’\tf({x, y}) is even.\tThen\tif\twe\tlet\tg({x,\ty})\t=\t \u0000({\u0000,\u0000}) \u0000 \tfor\tall\tx,\ty\t in\tS’,\twe\twould\thave\ta\tfunction\tfrom\tpairs\tin\tS’\tto\t{0,\t1,\t…,\t2 n-2 –1}\t satisfying\t the\t same\tconditions\t as\tf\tand\t we\t could\t apply\t the\t induction\t hypothesis\t to\t get\t the\t result.\t It\t remains\t to\t show\t that\t such\ta\tset\tS’\texists.\t \t Chapter 8: Graph Theory 17 Step 2: Constructing the graph and a new goal Construct\ta\tgraph\tG\twith\t2 n+1\tvertices\trepresenting\telements\tin\tS\t as\tfollows:\tthere\tis\tan\tedge\tbetween\ta\tand\tb\tif\tand\tonly\tif\tf({a,\tb})\t is\todd.\tWe\tnow\tneed\tto\tfind\tan\tindependent\tset\tin\tG\tof\tsize\tat\tleast\t 2 n-1+1.\t Our\t hope\t is\t that\tG\tis\t bipartite:\t then\t we\t can\t just\t take\t the\t larger\t side\t of\t the\t bipartition,\t which\t will\t have\t size\t at\t least\t ⌈(2 \u0000+1)/2⌉\t=\t2 n-1+1.\tSome\texperimentation\tconfirms\tour\thope\t–\t but\tof\tcourse\twe\tstill\tneed\ta\tproof. \t Step 3: A key observation Note\t that\t for\t any\t 3\t vertices\ta,\tb,\tc\tthere\t must\t be\t 0\t or\t 2\t edges\t amongst\t them,\t since\tf({a,\tb})\t +\tf({b,\tc})\t +\tf({c,\ta})\t is\t even\t (since\t one\tof\tthese\tterms\tis\tthe\tsum\tof\tthe\tother\ttwo).\t\t \t Step 4: Proving G is bipartite If\tG\tis\tnot\tbipartite,\tit\thas\tan\todd\tcycle,\tso\tconsider\tits\tsmallest\todd\t cycle\tv1v2…v2k+1.\tConsider\tvertices\tv1,\tv3,\tv4.\tThere\tmust\tbe\tan\teven\t number\t of\t edges\t amongst\t them.\tAs\tv3v4\tis\t an\t edge,\tv1v3\tor\tv1v4\t must\t be\t an\t edge.\tv1v3\tis\t not\t an\t edge\t since\t otherwise\t amongst\t vertices\tv1,\tv2\tand\tv3\tthere\twould\tbe\tthree\tedges,\tcontradicting\tour\t earlier\tobservation.\tHence\tv1v4\tis\tan\tedge.\tBut\tthen\tv1v4…v2k+1\tis\ta\t smaller\todd\tcycle,\tcontradicting\tour\tassumption.\t■ Figure 8.5. The edge v1v4 creates a smaller odd cycle \t Remark 1: In\tstep\t4\twe\tessentially\tproved\tthe\tfollowing\tresult:\tIf\t G\tis\ta\tgraph\tin\twhich\tfor\tany\tthree\tvertices\tthere\tare\teither\t0\tor\t2\t v1 v2 v2k+1 v3 v4 Olympiad Combinatorics 18 edges\tbetween\tthem,\tG\tis\tbipartite.\tThis\tis\ta\tvery\thandy\tlemma\tto\t keep\t in\t mind,\t especially\t since\t so\t many\t Olympiad\t problems\t boil\t down\tto\tproving\tthat\ta\tcertain\tgraph\tis\tbipartite.\t \t Remark 2: The\tidea\tof\ttaking\ta\tshortest\tcycle\tarises\tvery\toften.\t \t Example 13 [IMO Shortlist 2002, C6] Let\tn\tbe\tan\teven\tpositive\tinteger.\tShow\tthat\tthere\tis\ta\tpermutation\t (x1,\tx2,\t…,\txn)\tof\t(1,\t2,\t…,\tn)\tsuch\tthat\tfor\tevery\ti\tє\t(1,\t2,\t…,\tn),\tthe\t number\txi+1\tis\tone\tof\tthe\tnumbers\t2xi,\t2xi\t−1,\t2xi−n,\t2xi–n–1.\tHere\t we\tuse\tthe\tcyclic\tsubscript\tconvention,\tso\tthat\txn+1\tmeans\tx1.\t\t \t Answer: Let\tn\t=\t2m.\tWe\tdefine\ta\tdirected\tgraph\twith\tvertices\t1,\t2,\t…,\tm\tand\t edges\tnumbered\t1,\t2,…,2m\tas\tfollows.\tFor\teach\ti\t≤\tm,\tvertex\ti\thas\t two\t outgoing\t edges\t numbered\t 2i−1\t and\t 2i,\t and\t two\t incoming\t edges\tlabeled\ti\tand\ti+m.\tAll\twe\tneed\tis\tan\tEulerian\tcircuit,\tbecause\t then\tsuccessive\tedges\twill\tbe\tof\tone\tof\tthe\tforms\t(i,\t2i−1),\t(i,\t2i),\t (i+m,\t 2i)\t or\t (i+m,\t 2i−1).\t Then\t we\t can\t let\tx1,\tx2,\t …,\txn\tbe\t the\t successive\tedges\tencountered\tin\tthe\tEulerian\tcircuit\tand\tthey\twill\t satisfy\tthe\tproblem’s\tconditions.\t\t \t Figure 8.6. Now,\t each\t vertex’s\t indegree\t is\t equal\t to\t its\t outdegree,\t so\t we\t just\tneed\tto\tshow\tweak\tconnectivity\tto\testablish\tthat\tthere\tis\tan\t Eulerian\t circuit.\t We\t do\t this\t by\t strong\t induction.\t There\t is\t a\t path\t from\t1\tto\tk:\tsince\tthere\tis\ta\tpath\tfrom\t1\tto\tj\twhere\t2j\t=\tk\tor\t2j–1\t=\t k,\t and\t an\t edge\t from\tj\tto\tk,\t there\t is\t a\t path\t from\t 1\tto\tk.\t Thus\tG\tis\t weakly\tconnected\tand\thence\thas\tan\tEulerian\tcircuit.\t■\t i i+m 2i 2i–1 i Chapter 8: Graph Theory 19 \t \t Exercises \t Hall’s Theorem and Related Problems \t 1. [Konig’s marriage theorem] Show\t that\t a\tk-regular bipartite graph\tG\t(all\t vertices\t have\t degree\tk)\thas\ta\tperfect\tmatching\t(a\tmatching\tcovering\tall\tits\t vertices).\t \t 2. [Konig’s theorem] A\tmatching\tin\t a\t graph\tG\tis\t a\t set\tM\tof\t edges\t such\t that\t each\t vertex\tin\tG\tis\tincident\tto\tat\tmost\tone\tedge\tin\tM.\tA\tvertex cover\t in\tG\tis\ta\tset\tof\tvertices\tC\tsuch\tthat\teach\tedge\tis\tincident\tto\tat least\tone\t vertex\t in\tC.\t Using\t Hall’s\t marriage\t theorem,\t show\t that\t in\t a\t bipartite\t graph\tG,\t the\t maximum\t possible\t size\t of\t a\t matching\t is\t equal\t to\t the\t minimum\t possible\t size\t of\t a\t vertex\t cover.\t\t \t 3. [Vietnam TST 2001] A\tclub\thas\t42\tmembers.\tSuppose\tthat\tfor\tany\t31\tmembers\tin\t this\t club,\t there\t exists\t a\t boy\t and\t a\t girl\t among\t these\t 31\t members\t who\t know\t each\t other.\t Show\t that\t we\t can\t form\t 12\t disjoint\tpairs\tof\tpeople,\teach\tpair\thaving\tone\tboy\tand\tone\tgirl,\t such\tthat\tthe\tpeople\tin\teach\tpair\tknow\teach\tother.\t \t 4. [IMO Shortlist 2006, C6] Consider\t an\t upward\t equilateral\t triangle\t of\t side\t length\tn,\t consisting\t of\tn 2 \tunit\t triangles\t (by\t upward\t we\t mean\t with\t vertex\ton\ttop\tand\tbase\tat\tthe\tbottom).\tSuppose\twe\tcut\tout\tn\t upward\t unit\t triangles\t from\t this\t figure,\t creating\tn\ttriangular\t holes.\tCall\tthe\tresulting\tfigure\ta\tholey triangle.\tA\tdiamond\tis\ta\t 60-120\tunit\trhombus.\tShow\tthat\ta\tholey\ttriangle\tT\tcan\tbe\ttiled\t by\tdiamonds,\twith\tno\tdiamonds\toverlapping,\tcovering\ta\thole\t or\t sticking\t out\t of\tT\tif\t and\t only\t if\t the\t following\t holds:\t every\t Olympiad Combinatorics 20 upward\t equilateral\t of\t side\t length\tk\tin\tT\thas\t at\t most\tk\tholes,\t for\tall\t1\t≤\tk\t≤\tn.\t\t \t 5. [Dilworth’s theorem] A\tdirected acyclic graph\t(DAG)\t is\t a\t directed\t graph\t with\t no\t directed\t cycles.\t An\tantichain\tin\t a\t DAG\t (with\t some\t abuse\t of\t notation)\tis\ta\tset\tof\tvertices\tsuch\tthat\tno\ttwo\tvertices\tin\tthis\t set\thave\ta\tdirected\tpath\tbetween\tthem.\tShow\tthat\tthe\tsize\tof\t the\t maximum\t antichain\t of\t the\t DAG\t is\t equal\t to\t the\t minimum\t number\t of\t disjoint\t paths\t into\t which\t the\t DAG\t can\t be\t decomposed.\t\t \t 6. [Romanian TST 2005] Let\tS\tbe\ta\tset\tof\tn 2 +1\tpositive\tintegers\tsuch\tthat\tin\tany\tsubset\t X\tof\tS\twith\tn+1\t integers,\t there\t exist\t integers\tx\t≠\ty\tsuch\t that\t x|y.\tShow\tthat\tthere\texists\ta\tsubset\tS’\tof\tS\twith\tS’\t=\t{x1,\tx2,\t…\t,\t xn+1}\tsuch\tthat\txi|xi+1\tfor\teach\t1\t≤\ti\t≤\tn.\t\t\t \t Coloring Problems 7. [Welsh-Powell theorem] (U*) A\tproper coloring\tof\tthe\tvertices\tof\ta\tgraph\tG\tis\tan\tassignment\t of\t one\t color\t to\t each\t vertex\t of\t a\t graph\tG\tsuch\t that\t no\t two\t adjacent\t vertices\t in\tG\thave\t the\t same\t color.\t Let\tG\tbe\t a\t graph\t with\tvertices\thaving\tdegrees\td1\t≥\td2\t≥\t…\t≥\tdn.\tShow\tthat\tthere\t exists\ta\tproper\tcoloring\tof\tG\tusing\tat\tmost\tmaxi\t(min{i,\tdi+1}\t colors.\t\t \t 8. [Dominating sets and coloring] (U*) If\ta\tgraph\ton\tn\tvertices\thas\tno\tdominating\tset\tof\tsize\tless\tthan\t k,\t then\t show\t that\t its\t vertices\t can\t be\t properly\t colored\t in\tn–k\t colors.\t\t\t \t 9. [IMO 1992, Problem 3] Let\tG\tbe\tthe\tcomplete\tgraph\ton\t9\tvertices.\tEach\tedge\tis\teither\t colored\tblue\tor\tred\tor\tleft\tuncolored.\tFind\tthe\tsmallest\tvalue\t Chapter 8: Graph Theory 21 of\tn\tsuch\tthat\tif\tn\tedges\tare\tcolored,\tthere\tnecessarily\texists\ta\t monochromatic\ttriangle.\t \t 10. [IMO Shortlist 1990] The\tedges\tof\ta\tK10\tare\tcolored\tred\tand\tblue.\t Show\tthat\tthere\t exist\ttwo\tdisjoint\tmonochromatic\todd\tcycles,\tboth\tof\tthe\tsame\t color.\t\t \t 11. [Szekeres-Wilf theorem] (U*) Show\tthat\tany\tgraph\tG\tcan\tbe\tproperly\tcolored\tusing\tat\tmost\t 1+max\tΔ(G’)\t colors,\t where\t the\t maximum\t is\t taken\t over\t all\t induced\t subgraphs\tG’\t of\tG\tand\tΔ(G’)\t refers\t to\t the\t maximum\t degree\tof\ta\tvertex\tin\tthe\tinduced\tsubgraph\tG’.\t\t\t \t 12. [Generalization of USA TST 2001] Let\tG be\ta\tdirected\tgraph\ton\tn\tvertices,\tsuch\tthat\tno\tvertex\thas\t out-degree\tgreater\tthan\tk.\tShow\tthat\tthe\tvertices\tof\tG\tcan\tbe\t colored\tin\t2k+1\tcolors\t such\tthat\tno\ttwo\tvertices\tof\tthe\tsame\t color\thave\ta\tdirected\tedge\tbetween\tthem.\t \t 13. [Brook’s theorem] (U*) We\t know\t from\t (i)\t that\t∆+1\t colors\t are\t sufficient\t to\t properly\t color\t the\t vertices\t of\t a\t graph\tG,\t where\t∆\t is\t the\t maximum\t degree\t of\tany\t vertex\t in\tG.\t Show\t that\tif\tG\tis\tconnected\tand\t is\t neither\t a\t complete\t graph\t nor\t an\t odd\t cycle,\t then\t actually\t∆\t colors\tsuffice.\t\t [Easy\t version:\t prove\t the\t result\t above\t with\t the\t added\t condition\tthat\tnot\tall\tvertices\thave\tthe\tsame\tdegree.]\t\t \t Turan’s theorem and applications \t 14. [Turan’s theorem] (U*) The\tTuran graph\tT(n,\tr)\tis\tthe\tgraph\ton\tn\tvertices\tformed\tas\t follows:\t partition\t the\t set\t of\tn\tvertices\t into\tr\tequal\t or\t almost\t equal\t(differing\tby\t1)\tparts,\tand\tjoin\ttwo\tvertices\tby\tan\tedge\tif\t and\tonly\tif\tthey\tare\tin\tdifferent\tparts.\tNote\tthat\tT(n,\tr)\thas\tno\t (r+1)-clique.\t Show\t that\t amongst\t all\t graphs\t having\t no\t (r+1)- Olympiad Combinatorics 22 clique,\t the\t Turan\t graph\t has\t the\t most\t edges.\t Hence,\t deduce\t that\t the\t maximum\t number\t of\t edges\t in\t a\tKr+1-free\t graph\t is\t (\u0000\u0000\u0000)\u0000\u0000 \u0000\u0000 .\t This\t generalizes\t the\t bound\t of\tn 2/4\t edges\t in\t triangle- free\tgraphs\tthat\twe\tproved\tin\tchapter\t6.\t\t \t [Hint:\tfirst\tprove\tthe\tfollowing\tclaim:\tthere\tdo\tnot\texist\tthree\t vertices\tu,\tv,\tw\tsuch\tthat\tuv\tis\tan\tedge\tin\tG\tbut\tuw\tand\tvw\tare\t not.\t Show\t this\t by\t assuming\t the\t contrary\t and\t then\t making\t some\t adjustments\t to\tG\tto\t obtain\t a\t graph\t with\t more\t edges,\t contradicting\t the\t fact\t that\tG\thas\t the\t maximum\t possible\t number\t of\t edges\t amongst\t all\tKr+1-free\t graphs.\t The\t claim\t establishes\t that\t if\t two\t vertices\tu\tand\tv\thave\t a\t common\t non- neighbor,\t then\tu\tand\tv\tthemselves\t are\t non-neighbors.\t This\t shows\t that\tG\tis\tk-partite\t for\t some\tk.\t Now\t show\t that\t the\t maximum\t number\t of\t edges\t will\t occur\t when\tk\t=\tr\tand\t the\t parts\tare\tequal\tor\tdiffer\tby\t1.]\t Remark:\t This\t method\t of\t proving\t that\tG\tis\t multipartite\t is\t extremely\t important,\t and\t is\t sometimes\t called\t Zykov\t symmetrization.\t\t \t 15. [Poland 1997] There\t are\tn\tpoints\t on\t a\t unit\t circle.\t Show\t that\t at\t most\tn 2 /3\t pairs\tof\tthese\tpoints\tare\tat\tdistance\tgreater\tthan\t√2.\t\t \t 16. [IMO Shortlist 1989] 155\tbirds\tsit\ton\tthe\tcircumference\tof\ta\tcircle.\tIt\tis\tpossible\tfor\t there\t to\t be\t more\t than\t one\t bird\t at\t the\t same\t point.\t Birds\t at\t points\tP\tand\tQ\tare\tmutually\tvisible\tif\tand\tonly\tif\tangle\tPOQ\t≤\t 10 o,\t where\t O\t is\t the\t center\t of\t the\t circle.\t Determine\t the\t minimum\tpossible\tnumber\tof\tpairs\tof\tmutually\tvisible\tbirds.\t \t 17. [USA TST 2008] Given\t two\tpoints\t (x1,\ty1)\t and\t (x2,\ty2)\t in\t the\t coordinate\t plane,\t their\tManhattan distance\tis\tdefined\tas\t|x1−x2|\t+\t|y1−y2|.\tCall\ta\t pair\tof\t points\t (A,\t B)\t in\t the\t plane\tharmonic\tif\t 1\t <\td(A,\t B)\t≤\t2.\t Chapter 8: Graph Theory 23 Given\t 100\t points\t in\t the\t plane,\t determine\t the\t maximum\t number\tof\tharmonic\tpairs\tamong\tthem.\t\t \t \t More Extremal Graph problems \t 18. [China TST 2012] Let\tn\tand\tk\tbe\tpositive\tintegers\tsuch\tthat\tn\t>\t2\tand\tn/2\t<\tk\t<\tn.\t Let\tG\tbe\ta\tgraph\ton\tn\tvertices\tsuch\tthat\tG\tcontains\tno\t(k+1)- clique\t but\t the\t addition\t of\t any\t new\t edge\t to\tG\twould\t create\t a\t (k+1)-clique.\tCall\ta\tvertex\tin\tG\tcentral\tif\tit\tis\tconnected\tto\tall\t (n−1)\t other\t vertices.\t Determine\t the\tleast\t possible\t number\tof\t central\tvertices\tin\tG.\t \t 19. [China TST 2011] Let\tG\tbe\ta\tgraph\ton\t3n 2\tvertices\t(n\t>\t1),\twith\tno\tvertex\thaving\t degree\t greater\t than\t 4n.\t Suppose\t further\t that\t there\t exists\t a\t vertex\tof\tdegree\tone\tand\tthat\tfor\tany\ttwo\tpoints,\tthere\texists\ta\t path\t of\t length\t at\t most\t 3\t between\t them.\t Show\t that\t G\t has\t at\t least\t(7n 2 –3n)/2\tedges.\t\t \t 20. [Generalization of IMO Shortlist 2013, C6] In\ta\tgraph\tG,\tfor\tany\tvertex\tv,\tthere\tare\tat\tmost\t2k\tvertices\tat\t distance\t 3\t from\t it.\t Show\t that\t for\t any\t vertex\tu,\t there\t are\t at\t most\tk(k+1)\tvertices\tat\tdistance\t4\tfrom\tit.\t\t \t 21. [IMO Shortlist 2004, C8] For\ta\tfinite\tgraph\tG,\tlet\tf(G)\tdenote\tthe\tnumber\tof\ttriangles\tin\t G\tand\tg(G)\t the\t number\t of\t tetrahedra\t(K4s).\t Determine\t the\t smallest\tconstant\tc\tsuch\tthat\tg(G) 3\t≤\tc f(G) 4\tfor\tall\tgraphs\tG.\t\t \t 22. [IMO Shortlist 2002, C7] In\t a\t group\t of\t 120\t people,\t some\t pairs\t are\t friends.\t A\t weak\t quartet\t is\t a\t group\t of\t 4\t people\t containing\t exactly\t one\t pair\t of\t friends.\t What\t is\t the\t maximum\t possible\t number\t of\t weak\t quartets?\t\t\t\t Olympiad Combinatorics 24 \t Tournaments \t 23. Show\t that\t if\t a\t tournament\t has\t a\t directed\t cycle,\t then\t it\t has\t a\t directed\ttriangle.\t\t\t \t 24. [Landau’s theorem] Call\t a\t vertex\tv\tin\t a\t tournament\tT\ta\t champion\t if\t for\t every\t vertex\tu\tin\tT,\tthere\tis\ta\tdirected\tpath\tfrom\tv\tto\tu\tin\tT\tof\tlength\t at\tmost\t2.\tShow\tthat\tevery\ttournament\thas\ta\tchampion.\t\t \t 25. [Moon-Moser theorem] A\t directed\t graph\tG\tis\t called\tstrongly connected\tif\t there\t is\t a\t directed\tpath\tfrom\teach\tvertex\tin\tG\tto\tevery\tother\tvertex\tin\tG.\t A\t directed\t graph\t with\tn\tvertices\t is\t called\tvertex-pancyclic\tif\t every\t vertex\t is\t contained\t in\t a\t cycle\t of\t length\tp,\t for\t each\t 3\t≤\tp\t≤\tn.\tShow\tthat\ta\tstrongly\tconnected\ttournament\tis\tvertex\t pancyclic.\t\t\t \t 26. [Based on USA TST 2009] Let\tn>m>1\tbe\tintegers\tand\tlet\tG\tbe\ta\ttournament\ton\tn\tvertices\t with\tno\t(m+1)-cycles.\tShow\tthat\tthe\tvertices\tcan\tbe\tlabeled\t1,\t 2,\t…,\tN\tsuch\tthat\tif\ta\t≥\tb+m–1,\tthere\tis\ta\tdirected\tedge\tfrom\tb\t to\ta.\t \t Miscellaneous \t 27. [Generalization of Saint Petersburg 2001] For\teach\tpositive\tinteger\tn,\tshow\tthat\tthere\texists\ta\tgraph\ton\t 4n\tvertices\twith\texactly\ttwo\tvertices\thaving\tdegree\td,\tfor\teach\t 1\t≤\td\t≤\t2n.\t\t Remark:\t The\t degree\t vector\t lemma\t kills\t this\t otherwise\t difficult\tproblem.\t\t \t 28. [Iran 2001] In\t an\tn×n\tmatrix,\t a\tgeneralized diagonal\trefers\t to\t a\t set\t of\tn\t Chapter 8: Graph Theory 25 entries\twith\tone\tin\teach\trow\tand\tone\tin\teach\tcolumn.\tLet\tM\tbe\t an\tn×n\t0-1\tmatrix,\tand\tsuppose\tM\thas\texactly\tone\tgeneralized\t diagonal\tcontaining\tall\t1s.\tShow\tthat\tit\tis\tpossible\tto\tpermute\t the\t rows\t and\t columns\t of\tM\tto\t obtain\t a\t matrix\tM’\t such\t that\t (i,\tj)\tentry\tin\tM’\tis\t0\tfor\tall\t1\t≤\tj\t<\ti\t≤\tn.\t\t \t 29. [Generalization of Russia 2001] Let\tG\tbe\ta\ttree\twith\texactly\t2n\tleaves\t(vertices\twith\tdegree\t1).\t Show\t that\t we\t can\t add\tn\tedges\t to\tG\tsuch\t that\tG\tbecomes\t 2-connected,\tthat\tis,\tthe\tdestruction\tof\tany\tedge\tat\tthis\tpoint\t would\tstill\tleave\tG\tconnected.\t\t \t 30. [Russia 1997] Let\tm\tand\tn\tbe\t odd\t integers.\t An\tm×n\tboard\t is\t tiled\t with\t dominoes\tsuch\tthat\texactly\tone\tsquare\tis\tleft\tuncovered.\tOne\t is\tallowed\tto\tslide\tvertical\tdominoes\tvertically\tand\thorizontal\t dominoes\t horizontally\t so\t as\t to\t occupy\t the\t empty\t square\t (thereby\tchanging\tthe\tposition\tof\tthe\tempty\tsquare).\tSuppose\t the\t empty\t square\t is\t initially\t at\t the\t bottom\t left\t corner\t of\t the\t board.\t Show\t that\t by\t a\t sequence\t of\t moves\t we\t can\t move\t the\t empty\tsquare\tto\tany\tof\tthe\tother\tcorners.\t \t 31. [Generalization of Japan 1997] Let\tG\tbe\ta\tgraph\ton\tn\tvertices,\twhere\tn\t≥\t9.\tSuppose\tthat\tfor\t any\t 5\t vertices\t in\tG,\t there\t exist\t at\t least\t two\t edges\t with\t endpoints\t amongst\t these\t 5\t vertices.\t Show\t that\tG\thas\t at\t least\t n(n−1)/8\tedges.\tDetermine\tall\tn\tfor\twhich\tequality\tcan\toccur.\t\t \t 32. [Japan 1997] Let\tn\tbe\ta\tpositive\tinteger.\tEach\tvertex\tof\ta\t2 n-gon\tis\tlabeled\t0\t or\t 1.\t There\t are\t 2 n\tsequences\t obtained\t by\t starting\t at\t some\t vertex\t and\t reading\t the\t first\tn\tlabels\t encountered\t clockwise.\t Show\tthat\tthere\texists\ta\tlabelling\tsuch\tthat\tthese\t2 n \tsequences\t are\tall\tdistinct.\t\t \t \t Olympiad Combinatorics 26 33. [Based on USA TST 2011] In\tan\tundirected\tgraph\tG,\tall\tedges\thave\tweight\teither\t1\tor\t2.\t For\teach\tvertex,\tthe\tsum\tof\tthe\tweights\tof\tedges\tincident\tto\tit\t is\t odd.\t Show\t that\t it\t is\t possible\t to\t orient\t the\t edges\t of\tG\tsuch\t that\t for\t each\t vertex,\t the\t absolute\t value\t of\t the\tdifference\t between\t its\t in-weight\t and\t out-weight\t is\t 1,\t where\t in-weight\t refers\tto\tthe\tsum\tof\tweights\tof\tincoming\tedges\tand\tout-weight\t refers\tto\tthe\tsum\tof\tweights\tof\toutgoing\tedges.\t\t \t 34. [IMO Shortlist 1990] Consider\t the\t rectangle\t in\t the\t coordinate\t plane\t with\t vertices\t (0,\t0),\t(0,\tm),\t(n,\t0)\tand\t(m,\tn),\twhere\tm\tand\tn\tare\todd\tpositive\t integers.\tThis\trectangle\tis\tpartitioned\tinto\ttriangles\tsuch\tthat\t each\t triangle\t in\t the\t partition\t has\tat\t least\tone\t side\t parallel\t to\t one\tof\tthe\tcoordinate\taxes,\tand\tthe\taltitude\ton\tany\tsuch\tside\t has\t length\t 1.\t Furthermore,\t any\t side\t that\t is\t not\t parallel\t to\t a\t coordinate\t axis\t is\t common\t to\t two\t triangles\t in\t the\t partition.\t Show\t that\t there\t exist\t two\t triangles\t in\t the\t partition\t each\t having\tone\tside\tparallel\tto\tthe\tx\taxis\tand\tone\tside\tparallel\tto\t the\ty\taxis.\t\t \t \t Olympiad\t Combinatorics\t \t \t \t \t Pranav\tA.\tSriram\t August 2014\t Chapter 9: The Probabilistic Method 1 Copyright notices \t All USAMO and USA Team Selection Test problems in this chapter are copyrighted by the Mathematical Association of America’s American Mathematics Competitions. © Pranav A. Sriram. This document is copyrighted by Pranav A. Sriram, and may not be reproduced in whole or part without express written consent from the author. About the Author Pranav Sriram graduated from high school at The International School Bangalore, India, and is currently pursuing undergraduate studies at Stanford University. Chapter 9: The Probabilistic Method 1 9. THE PROBABILISTIC METHOD \t \t \t Introduction Our\tfinal\tchapter\twill\tfocus\ton\tan\tidea\tthat\thas\thad\ta\ttremendous\t impact\t on\t combinatorics\t over\t the\t past\t sixty\t years,\t and\t that\t is\t playing\t a\t critical\t role\t in\t the\t “big\t data”\t driven\t applications\t of\t today’s\t digitized\t world.\t The\tprobabilistic method\tis\t a\t technique\t that\t broadly\t refers\t to\t using\t arguments\t based\t on\t probability\t to\t prove\t results\t in\t fields\t not\t necessarily\t directly\t related\t to\t probability.\t Probabilistic\t combinatorics\t is\t an\t extremely\t active\t area\t of\t research\t today,\t and\t several,\t if\t not\t most,\t recent\t developments\t in\t graph\t theory,\t extremal\t combinatorics,\t computational\t geometry,\t and\t combinatorial\t algorithms\t have\t relied\t extensively\t on\t probabilistic\t arguments.\t In\t addition,\t the\t probabilistic\tmethod\thas\tled\t to\t breakthroughs\t in\tnumber\t theory\t and\t additive\t group\t theory,\t and\t has\t surprisingly\t elegant\t connections\t to\t information\t theory\t and\t the\t theory\t of\t error\t correcting\t codes.\t Modern\t paradigms\t for\t efficiently\t monitoring\t computer\t network\t traffic,\t finding\thidden\t patterns\t in\t large\t datasets,\t and\t solving\t extremely\t large\t scale\t mathematical\t problems\thave\tleveraged\tthe\tpower\tof\tthe\tprobabilistic\tmethod\tin\t advanced\tways.\t\t Olympiad Combinatorics 2 \t Each\t section\tin\t this\t chapter\t illustrates\t one\t general\t method\t of\t solving\t combinatorial\t problems\t via\t probabilistic\t arguments.\t We\t will\t assume\t knowledge\t of\t basic\t concepts\t from\t high\t school\t probability,\t such\t as\t the\t notion\t of\t random\t variables,\t expected\t value,\t variance,\t independent\t events,\t and\t mutually\t exclusive\t events.\t No\t formal\t background\t in\t Lebesgue\t integration\t or\t real\t analysis\tis\trequired.\t\t \t Linearity of Expectation The\t linearity\t of\t expectation\t refers\t to\t the\t following\t (fairly\t intuitive)\tprinciple:\tif\tX\tis\tthe\tsum\tof\tn\trandom\tvariables\tX1,\tX2,\t…,\t Xn,\t then\t the\t expected\t value\t of\tX\tis\t equal\t to\t the\t sum\t of\t expected\t values\tof\tX1,\tX2,\t…,\tXn.\tIn\tsymbols,\t\t \t E[X]\t=\tE[X1\t+\tX2\t+\t…\t+\tXn]\t=\tE[X1]\t+\tE[X2]\t…\t+\tE[Xn].\t \t This\t holds\t even\t when\t the\t variables\tX1,\tX2,\t …,\tXn\tare\t not\t independent\tfrom\t each\tother.\tAnother\tintuitive\tprinciple\twe\twill\t use,\tsometimes\treferred\tto\tas\tthe\t“pigeonhole\tproperty”\t(PHP)\tof\t expectation,\tis\tthat\ta\trandom\tvariable\tcannot\talways\tbe\tless\tthan\t its\t average.\t Similarly,\t it\t cannot\t always\t be\t more\t than\t its\t average.\t For\texample,\tif\tthe\taverage\tage\tat\ta\tparty\tis\t24\tyears,\tthere\tmust\t be\tat\tleast\tone\tperson\tat\tmost\t24\tyears\told,\tand\tone\tperson\twho\tis\t at\tleast\t24\tyears\told.\t\t \t How\tcan\twe\tuse\tthis\tto\tsolve\tcombinatorial\tproblems?\t\t \t Example 1 [Szele’s Theorem] For\t each\tn,\t show\t that\t there\t exists\t a\t tournament\t on\tn\tvertices\t having\tat\tleast\t \u0000! \u0000\u0000\u0000\u0000\tHamiltonian\tpaths.\t\t \t Chapter 9: The Probabilistic Method 3 Answer:\t The\t basic\t idea\t is\t as\t follows:\t instead\t of\t explicitly\t constructing\t a\t tournament\t with\t the\t required\t properties,\t we\t use\t a\trandomized procedure\tfor\tcreating\tsome\ttournament\tT.\tWe\twill\tshow\tthat\ton average,\t the\t tournament\t we\t (randomly)\t construct\t contains\t \u0000! \u0000\u0000\u0000\u0000\t Hamiltonian\t paths.\t Then\t by\t the\t pigeonhole\t principle,\tsome\t tournament\tmust\tcontain\tat\tleast\t \u0000! \u0000\u0000\u0000\u0000\tHamiltonian\tpaths.\t\t \t The\trandomized\tprocedure\tis\tto\tconstruct\ta\ttournament\twhere\t each\t of\t the\t matches\tis\t decided\t independently\t by\t a\t flip\t of\t a\t fair\t coin.\tThus\tfor\ttwo\tvertices\tu\tand\tv,\tthe\tprobability\tthat\tu\tlost\tto\tv\t is\t 0.5\t and\t vice\t versa.\t To\t compute\t the\t expected\t total\t number\t of\t Hamiltonian\t paths,\t observe\t that\t each\t Hamiltonian\t path\t corresponds\tto\ta\tpermutation\tof\tthe\tvertices\tof\tthe\tgraph.\t \t Consider\ta\trandom\tpermutation\tof\tthe\tvertices\t(v1,\tv2,\tv3,\t…,\tvn).\t For\tthis\tsequence\t(in\torder)\tto\tform\ta\tHamiltonian\tpath,\twe\tneed\t to\t have\tv1\tlost\t to\tv2,\tv2\tlost\t to\tv3,\t …,\tvn-1\tlost\t to\tvn.\t Each\t of\t these\t happens\twith\tprobability\t0.5,\tso\tthe\tprobability\tthat\tthey\tall\toccur\t is\t (0.5) n-1 .\t Thus,\t each\t permutation\t of\t the\t vertices\thas\t probability\t (0.5) n-1\tof\tbeing\ta\tHamiltonian\tpath,\tand\tthere\tare\tn!\tpermutations\t that\tcan\tgive\trise\tto\tHamiltonian\tpaths.\tHence\tthe\texpected\ttotal\t number\t of\t Hamilton\t paths,\t by\t the\t linearity\t of\t expectation,\t is\t n!/2 n-1.\t It\t follows\t that\tsome\ttournament\t must\t have\t at\t least\t the\t expected\tnumber\tof\tHamiltonian\tpaths.\t■\t \t Example 2 [Generalization of MOP 2010] Let\tG\tbe\ta\tgraph\twith\tE\tedges\tand\tn\tvertices\twith\tdegrees\td1,\td2,\t…,\t dn.\tLet\tk\tbe\tan\tinteger\twith\tk\t≤\t \u0000\u0000 \u0000 .\tShow\tthat\tG\tcontains\tan\tinduced\t subgraph\tH\tsuch\t that\tH\tcontains\t no\tKk+1\tand\tH\thas\t at\t least\t \u0000\u0000\u0000 \u0000\u0000\u0000\u0000\t vertices.\t(Recall\tthat\ta\tKk+1\tis\ta\tcomplete\tgraph\ton\tk+1\tvertices.)\t \t \t Olympiad Combinatorics 4 Answer: The basic idea Note\tthat\tit\tif\tall\tthe\tvertices\tin\tH\thave\tdegree\tat\tmost\tk-1\t(in\tH),\t then\tH\tclearly\t cannot\t contain\t a\tKk+1.\t This\t gives\t us\t the\t following\t idea\tfor\ta\tgreedy\tconstruction.\t \t Take\t a\t random\t permutation\t of\t the\t vertices\tv1v2…vn.\t Starting\t from\tv1\tand\tcontinuing,\twe\tselect\tvertex\tvi\tif\tand\tonly\tif\tamongst\tvi\t and\tits\tneighbors,\tvi\tis\tone\tof\tthe\tfirst\tk\tappearing\tin\tthe\tsequence.\t This\t ensures\t that\t every\t chosen\t vertex\t has\tat\t most\tk-1\t chosen\t neighbors,\t so\t the\t final\t set\t of\t chosen\t vertices\t will\t not\t contain\t an\t induced\tKk+1.\t Then\t we\t just\t need\t to\t show\t that\t the\t expected\t number\tof\tchosen\tvertices\tis\tat\tleast\t \u0000\u0000\u0000 \u0000\u0000\u0000\u0000 .\t\t \t Computing the expectation Now,\teach\tvertex\tvi\twill\tbe\tchosen\twith\tprobability\t \u0000 \u0000\u0000\u0000\u0000 \t,\twhere\tdi\t is\tits\tdegree.\tThis\tis\tbecause\tvi\tis\tselected\tif\tand\tonly\tif\tamongst\tvi\t and\t its\tdi\tneighbors,\tvi\tis\t amongst\t the\t first\tk in\t the\t permutation.\t The\texpected\tnumber\tof\tchosen\tvertices\tis\thence\t∑ \u0000 \u0000\u0000\u0000\u0000 \u0000 \u0000\u0000\u0000 .\t\t \t And the rest is just algebra… The\t function\t 1/(x+1)\t is\t convex\t (check\t this).\t Hence\t by\t Jensen’s\t inequality,\t∑ \u0000 \u0000\u0000\u0000\u0000 \u0000 \u0000\u0000\u0000 \t≥\t\u0000 \u0000 \u0000\u0000\u0000,\t where\td\tis\t the\t average\t degree\t ( ∑ \u0000\u0000 \u0000 \u0000\u0000\u0000 \u0000 ).\tFinally\tusing\td\t=\t \u0000\u0000 \u0000 \tand\tmultiplying\tby\tk\ton\tboth\tsides\twe\t get\tthe\tresult.\t■\t \t Remark 1: Note\t that\t “ \u0000\u0000\u0000 \u0000\u0000\u0000\u0000 ”\t in\t the\t problem\t can\t be\t replaced\t by\t “∑ \u0000 \u0000\u0000\u0000\u0000 \u0000 \u0000\u0000\u0000 ”.\tAlso\t note\t that\t \u0000\u0000\u0000 \u0000\u0000\u0000\u0000\tis\t equal\tto\t \u0000\u0000 \u0000\u0000\u0000,\t where\t d\t is\t the\t average\t degree\tof\t a\t vertex,\t that\t is,\t d\t =\t 2E/n.\tBoth results are extremely useful.\tThe\tsummation\tform\tis\tobviously\tmore\tuseful\t in\tsituations\twhen\twe\thave\t(or\tcan\tfind)\tsome\tinformation\tabout\t the\t degrees\t of\t individual\t vertices\tin\t the\t graph\t we\t are\t analyzing\t Chapter 9: The Probabilistic Method 5 (see\texample\t5),\twhereas\tthe\tother\ttwo\tforms\tare\tuseful\twhen\twe\t have\t some\t information\t about\t the\t total\t number\t of\t edges\t in\t a\t graph.\t \t Corollary 1: Any\tgraph\tG\twith\tn\tvertices\tand\tE\tedges\tcontains\tan\t independent\t set\t containing\t at\tleast\t \u0000\u0000 \u0000\u0000\u0000\u0000\tvertices.\t (Recall\t that\t an\t independent\t set\t is\t a\t set\t of\t vertices\t such\t that\t no\t two\t vertices\t in\t that\tset\thave\tan\tedge\tbetween\tthem.)\t \t Proof:\tNote\t that\t an\t independent\t set\t can\t be\t interpreted\t as\t a\tK2- free\t graph.\t Apply\t the\t above\t result\t for\tk\t=\t 1,\t and\t the\t corollary\t follows.\t■\t \t Corollary 2: A\ttree\tT\ton\tn\tvertices\thas\tan\tindependent\tset\tof\tsize\t greater\tthan\tn/3. \t Proof: Apply\tcorollary\t1,\ttaking\tE\t=\tn\t–\t1.\t■\t\t (Exercise:\twhat\tis\tthe\tbest\tconstant\tc\tsuch\tthat\ta\ttree\talways\thas\t an\tindependent\tset\tof\tsize\tat\tleast\tn/c?)\t \t Remark 2:\tThe\tabove\tproblem\tis\trepresentative\tof\ta\ttypical\tclass\t of\t problems\t in\t extremal\t graph\t theory.\t These\t problems\t ask\t us\t to\t show\t that\t in\t graphs\t under\t certain\t conditions\t there\t exist\t sufficiently\tlarge\tor\tsmall\tsubgraphs\twith\tcertain\tproperties.\t\t \t Example 3 [dominating sets] Show\tthat\tif\tthe\tminimum\tdegree\tin\tan\tn\tvertex\tgraph\tG\tis\tδ\t>\t1,\t then\tG\thas\ta\tdominating set\tcontaining\tat\tmost\tn\t \u0000\u0000\u0000\u0000(\u0000\u0000\u0000) \u0000\u0000\u0000 \tvertices.\t\t \t Answer: Form\ta\tsubset\tS\tof\tthe\tvertices\tof\tG\tby\tchoosing\teach\tvertex\twith\t probability\tp,\twhere\tp\tis\ta\tparameter\tin\t(0,\t1)\twe\twill\tspecify\tlater.\t Let\tT be\tthe\tset\tof\tvertices\tthat\thave\tno\tneighbor\tin\tS.\tThen\tS\t⋃\u0000\t is\ta\tdominating\tset.\tWe\tnow\testimate\tits\texpected\tsize.\t\t \t Olympiad Combinatorics 6 Clearly\tE[|S|]\t=\tnp.\tThe\tprobability\tthat\ta\tvertex\tv\tis\tin\tT\tis\tthe\t probability\tthat\tneither\tv\tnor\tany\tof\tits\tneighbors\tis\tin\tS.\tThis\tis\tat\t most\t(1−\u0000) \u0000\u0000\u0000,\t since\tv\thas\t at\t least\td\tneighbors.\t Thus\tE[|T|]\t≤\t \u0000(1−\u0000) \u0000\u0000\u0000\t≤\t\u0000\u0000 \u0000\u0000(\u0000\u0000\u0000).\t\t \t Finally,\tE[|S\t∪\tT|]\t≤\t\u0000\u0000+\u0000\u0000 \u0000\u0000(\u0000\u0000\u0000).\t To\t minimize\t this\t expression,\t we\t choose\tp\t=\t \u0000\u0000\t(\u0000\u0000\u0000) \u0000\u0000\u0000 ,\t and\t we\t get\tE[|S\t∪\tT|]\t≤\t n\t \u0000\u0000\u0000\u0000(\u0000\u0000\u0000) \u0000\u0000\u0000 .\tThere\texists\tsome\tS\tand\tT\tsuch\tthat\t|S\t∪\tT|\tis\tat\tmost\t the\texpected\tvalue,\tand\twe\tare\tdone.\t■\t \t Remark 1:\tThe\tvalue\tof\tp\tminimizing\tthe\texpression\tnp\t+\tne -p(d+1)\t is\tfound\tby\tchoosing\tp\tso\tthat\tthe\tderivative\twith\trespect\tto\tp\tis\t0.\t Remember\t that\tp\tis\t a\t parameter\t we\t are\t free\t to\t choose,\t unlike\tn\t and\td.\t We\t could\t have\t also\tdirectly\tchosen\tp\tto\t be\t the\t value\t minimizing\tnp\t+\tn(1−p) d+1,\t and\t we\t could\t have\t skipped\t the\t step\t where\twe\testimate\tn(1−p) d+1 \t≤\tne -p(d+1). \tAlthough\tthis\twould\tgive\ta\t slightly\t sharper\t bound,\t it\t would\t have\t been\t a\t lot\t uglier.\t Anyway\t both\tbounds\tasymptotically\tapproach\t \u0000\u0000\u0000\u0000 \u0000 .\t\t \t Remark 2:\t The\t basic\t idea\t in\t this\t proof\t is\t quite\t typical.\t Pick\t something\t randomly,\t and\t then\t make\t adjustments\t for\t whatever\t got\tmissed.\t\t Example 4 [USAMO 2010-6]\t A\tblackboard\tcontains\t68\tpairs\tof\tnonzero\tintegers.\tSuppose\tthat\t for\t no\t positive\t integer\tk\tdo\t both\t the\t pairs\t (k,\tk)\tand\t (−k,\t−k)\t appear\t on\t the\t blackboard.\t A\t student\t erases\t some\t of\t the\t 136\t integers,\tsubject\tto\tthe\tcondition\tthat\tno\ttwo\terased\tintegers\tmay\t add\t to\t 0.\t The\t student\t then\t scores\t one\t point\t for\t each\t of\t the\t 68\t pairs\t in\t which\t at\t least\t one\t integer\t is\t erased.\t Determine,\t with\t proof,\t the\t largest\t number\tN\tof\t points\t that\t the\t student\t can\t guarantee\tto\tscore\tregardless\tof\twhich\t68\tpairs\thave\tbeen\twritten\t on\tthe\tboard.\t\t Note:\tThe\t68\tpairs\tneed\tnot\tall\tbe\tdistinct;\tsome\tmay\tbe\trepeated.\t Chapter 9: The Probabilistic Method 7 Answer: Note\t that\t if\t (j,\tj)\t occurs\t then\t (−j,\t−j)\t does\t not,\t so\t we\t can\t WLOG\t assume\tthat\tif\t(j,\tj)\toccurs\tthen\tj\t>\t0\t(by\treplacing\tj\tby\t(−j)).\t\t \t Now\t for\t each\t integer\tk\t>\t 0,\t we\t can\t either\t delete\t all\t appearances\tof\tk\ton\tthe\tboard\t(if\tany)\tOR\tall\tappearances\tof\t(−k)\t (if\t any),\t but\t not\t both.\t So,\t for\t each\tk\t>\t 0,\t we\t delete\t all\tk’s\t with\t probability\tp,\t and\t otherwise\t delete\t all\t (−k)’s,\t where\tp\tis\t a\t parameter\t in\t (1/2,\t 1)\t to\t be\t specified\t later.\t We\t now\t consider\t 3\t types\tof\tpairs\tof\tnumbers\tthat\tcan\toccur,\tand\tin\teach\tcase\tbound\t the\tprobability\tthat\twe\tscore\ta\tpoint.\t \t (i) A\tpair\tof\tthe\tform\t(k,\tk)\t We\tscore\t a\t point\tfor\t this\t pair\t with\t probability\tp,\tsince\tk\tis\t deleted\twith\tprobability\tp.\t\t \t (ii) A\tpair\tof\tthe\tform\t(k,\t−k)\t We\tscore\ta\tpoint\twith\tprobability\t1,\tsince\twe\tdelete\teither\tk\t or\t(−k)\t\t \t (iii) A\tpair\tof\tthe\tform\t(a,\tb),\twhere\tb\t≠\t±a\t We\tscore\ta\tpoint\twith\tprobability\t(1\t–\tP[a\tnot\tdeleted]\t×\tP[b\t not\tdeleted])\t≥\t(1\t-\tp 2 ).\tNote\tthat\twe\tare\tusing\tp\t>\t(1-p).\t\t\t \t In\t all\t the\t above\t cases,\t the\t probability\t of\t scoring\t a\t point\t is\tat least\tmin\t {p,\t (1−p 2)}.\t Thus\t the\t expected\t number\t of\t points\t we\t score\t totally\t is\t at\t least\t 68\t×\tmin\t {p,\t (1−p 2)}.\t This\t quantity\t is\t maximized\tby\tsetting\tp\t=\t √\u0000\u0000\u0000 \u0000 ,\tand\tat\tthis\tpoint\tthe\texpectation\tis\t at\tleast\t68\t×\tp\t=\t68\t×\t √\u0000\u0000\u0000 \u0000 ,\twhich\tis\tgreater\tthan\t42.\tTherefore,\tit\tis\t always\tpossible\tto\tscore\tat least 43 points.\t\t \t We\t leave\t it\t to\t the\t reader\t to\t construct\t an\t example\t demonstrating\t that\t it\t is\t not\t always\t possible\t to\t score\t 44\t points.\t Olympiad Combinatorics 8 This\twill\tshow\tthat\tthe\tbound\tof\t43\tis\ttight,\tand\thence\tthe\tanswer\t is\t43.\t■\t \t Example 5 [IMO Shortlist 2012, C7] There\tare\t2 500 \tpoints\ton\ta\tcircle\tlabeled\t1,\t2,\t…,\t2 500 \tin\tsome\torder.\t Define\tthe\tvalue\tof\ta\tchord\tjoining\ttwo\tof\tthese\tpoints\tas\tthe\tsum\t of\tnumbers\tat\tits\tends.\tProve\tthat\tthere\texist\t100\tpairwise\tdisjoint\t (nonintersecting)\tchords\twith\tequal\tvalues.\t Answer: Step 1: Basic observations Let\tn\t=\t2 499 .\tThere\tare\t\u0000 \u0000\u0000 \u0000\u0000\tchords\tjoining\tpairs\tof\tlabeled\tpoints,\t and\tall\tchord\tvalues\tclearly\tbelong\tto\t{3,\t4,\t…,\t4n–1}.\tFurthermore,\t note\tthat\tchords\twith\ta\tcommon\tendpoint\thave\tdifferent\tvalues.\t Step 2: Interpretation and reduction to familiar terms Let\tGc\tdenote\t the\t graph\t with\t vertices\t representing\t chords\t with\t value\t c.\t Two\t vertices\t in\tGc\tare\t neighbors\t if\t the\t corresponding\t chords\tintersect.\t(Note:\tdon’t\tconfuse\tvertices\tin\tour\tgraphs\twith\t points\ton\t the\t circle.)\t So\t we’re\t basically\t just\t looking\t for\t a\tlarge independent set\tin\tsome\tGc.\tWe\talready\tknow\tthat\tby\texample\t2,\t each\tGc\thas\tan\tindependent\tset\tof\tsize\tat\tleast\tI(Gc)\t=\t∑ \u0000 \u0000\u0000\u0000\u0000\u0000∈\u0000\u0000 \t.\t By\t the\t pigeonhole\t principle,\t it\t now\t suffices\tto\t show\t that\t the\t average\tof\tI(Gc)\tover\tall\tvalues\tc\tis\tat\tleast\t100.\t \t Step 3: From graphs to individual vertices Note\tthat\tthe\taverage\tvalue\tof\tI(Gc)\tis\t \u0000 \u0000\u0000\u0000\u0000\t∑ \u0000(\u0000\u0000) \u0000\u0000\u0000\u0000 \u0000\u0000\u0000 \t=\t \u0000 \u0000\u0000\u0000\u0000\t∑ (∑ \u0000 \u0000\u0000\u0000\u0000\u0000∈\u0000\u0000 ) \u0000\u0000\u0000\u0000 \u0000\u0000\u0000 The\t double\t summation\ton\t the\t right\t is\t nothing\t but\t the\tsum\t of\t \u0000 \u0000\u0000\u0000\u0000\tover\tall 2n vertices,\tsince\teach\tvertex\tbelongs\tto\texactly\tone\t of\tthe\t4n−3\tgraphs.\t\t \t Chapter 9: The Probabilistic Method 9 Step 4: Estimating the degrees For\t a\tgiven\t chord\tL,\t let\tm(L)\t denote\t the\t number\t of\t points\t contained\tby\tits\tminor\tarc.\tm(L)\t=\t0\tif\tthe\tchord\tjoins\tconsecutive\t points\tand\tm(L)\t=\tn−1\tif\tthe\tchord\tis\ta\tdiameter.\tClearly,\ta\tchord\tL\t can\tintersect\tat\tmost\tm(L)\tother\tchords.\t\t Now\tfor\teach\ti\t∈\t{0,\t1,\t2,\t…,\tn−1},\tthere\tare\texactly\t2n\tchords\t with\tm(L)\t=\ti.\tThus\tfor\teach\ti\t∈\t{0,\t1,\t2,\t…,\tn−1},\tthere\tare\tat\tleast\t 2n\tvertices\twith\tdegree\tat\tmost\ti.\tTherefore,\tthe\tsum\tof\t \u0000 \u0000\u0000\u0000\u0000\tover\t all\tvertices\tis\tat\tleast\t∑ \u0000\u0000 \u0000 \u0000 \u0000\u0000\u0000 .\tFinally,\t\t \t Average\tof\t\tI(Gc)\t≥\t \u0000\u0000 \u0000\u0000\u0000\u0000 \t∑ \u0000 \u0000 \u0000 \u0000\u0000\u0000 \t>\t \u0000 \u0000 \tln(n+1)\t \t >\t \u0000 \u0000 \tln(2 499 )\t=\t \u0000\u0000\u0000\t\u0000\u0000\t(\u0000) \u0000 \t>\t249.5\t×\t0.69\t>\t100.\t \t This\tproves\tthe\tdesired\tresult.\t■\t \t Remark:\tIn\tfact,\t \u0000\u0000\u0000\t\u0000\u0000\t(\u0000) \u0000 \t>\t172.\tEven\twith\trather\tloose\testimates\t throughout,\tthis\tproof\timproves\tthe\tbound\tsignificantly\tfrom\t100\t to\t 172.\t More\t generally,\t 2 500\tand\t 100\t can\t be\t replaced\t by\t 2n\tand\t \u0000\u0000\t\u0000\u0000\t(\u0000\u0000\u0000) \u0000\u0000\u0000\u0000 .\t\t \t Example 6 [Biclique covering]\t In\t a\t certain\tschool\t with\tn\tstudents,\t amongst\t any\t(α+1)\tstudents,\t there\t exists\t at\t least\t one\t pair\t who\t are\t friends\t (friendship\t is\t a\t symmetric\t relation\t here).\t The\t principal\t wishes\t to\t organize\t a\t series\t of\t basketball\t matches\tM1,\tM2,\t …,\tMj\tunder\t certain\t constraints.\tEach\tmatch\tMi\tis\t played\t by\t two\t teams\tAi\tand\tBi,\t and\t each\t team\t consists\t of\t 1\t or\t more\t students.\t Furthermore,\t each\t person\tin\tAi\tmust\tbe\tfriends\twith\teach\tperson\tin\tBi.\tFinally,\tfor\tany\t pair\tof\tfriends\tu\tand\tv,\tthey\tmust\tappear\ton\topposite\tteams\tin\tat\t least\tone\tmatch.\tNote\tthat\ta\tparticular\tstudent\tcan\tparticipate\tin\t Olympiad Combinatorics 10 any\tnumber\tof\tmatches,\tand\tdifferent\tmatches\tneed\tnot\tbe\tplayed\t by\ta\tdisjoint\tset\tof\tpeople.\tLet\t|Mi|\tdenote\tthe\tnumber\tof\tstudents\t playing\t match\tMi,\t and\t let\tS\tdenote\t the\t sum\t of\t |Mi|\t over\t all\t matches.\tShow\tthat\tS\t≥\tnlog2(n/α).\t \t\t Answer: For\teach\tmatch\tMi,\trandomly\tfix\tthe\twinner\tby\tflipping\ta\tfair\tcoin\t (note\tthat\twe\tare\tfree\tto\tdo\tthis\tas\tthe\tproblem\tmentions\tnothing\t about\t the\t winners\t of\t matches).\t Hence\t for\t each\ti,\tAi\twins\t with\t probability\t 0.5\t and\tBi\twins\t with\t probability\t 0.5.\t Call\t a\t student\t a\t champion\tif\the\tis\ton\tthe\twinning\tteam\tof\teach\tmatch\tthat\the\tplays.\t\t \t Key observation:\tthe\ttotal\tnumber\tof\tchampions\tis\tat\tmost\tα.\t\t Proof:\t If\t there\t were\t α+1\t champions,\t some\t pair\t must\t be\t friends\t (see\t first\t statement\t of\t the\t problem),\t and\t hence\t they\t must\t have\t played\t against\t each\t other\t in\t some\t match.\t But\t then\t one\t of\t them\t would\thave\tlost\tthat\tmatch\tand\twould\thence\tnot\tbe\ta\tchampion;\t contradiction.\t \t On\tthe\tother\thand,\tcall\tthe\tstudents\ts1,\ts2,\t…,\tsn.\tThe\tprobability\t that\t a\t student\tsk\tbecomes\t a\t champion\t is\t2 \u0000\u0000\u0000,\t where\tmk\tis\t the\t number\t of\t matches\t played\t by\tsk.\t Hence\t the\t expected\t number\t of\t champions\t is\t∑ 2 \u0000\u0000\u0000\u0000 \u0000\u0000\u0000 .\t Applying\t the\t AM-GM\t inequality,\t ∑ 2 \u0000\u0000\u0000\u0000 \u0000\u0000\u0000 \t≥\tn\t×\t2 \u0000(∑ \u0000\u0000)/\u0000 \u0000 \u0000\u0000\u0000 \t=\tn\t×\t2 -S/n .\t But\tthe\t number\t of\t champions\tis\t bounded\t by\t α,\t so\t the\t expectation\t obviously\t cannot\t exceed\tα.\tHence\tn\t×\t2 -S/n\t≤\tα.\tThis\timplies\tS/n\t≥\tlog2(n/α).\tHence\t proved.\t■\t \t Remark 1:\tAs\ta\tcorollary,\tnote\tthat\tthe\tnumber\tof\tmatches\tmust\t be\t at\t least\t log2(n/α),\t since\t each\t match\t contributes\t at\t most\t n\t people\tto\tthe\tsum.\t \t Remark 2:\tInterpreted\tgraph\ttheoretically,\tthis\tproblem\tis\tabout\t covering\t the\t edges\t of\t a\t graph\t by\t bipartite\t cliques\t (complete\t bipartite\t graphs).\tS\tis\t the\t sum\t of\t the\t number\t of\t vertices\t in\t each\t bipartite\tclique\tand\tα\tis\tthe\tindependence\tnumber\tof\tthe\tgraph.\t\t Chapter 9: The Probabilistic Method 11 \t \t Mutually Exclusive Events \t Two\tevents\tA\tand\tB\tare\tsaid\tto\tbe\tmutually exclusive\tif\tthey\tcannot\t both\t occur.\t For\t instance,\t if\t an\t integer\t is\t selected\t at\t random,\t the\t events\t A:\t the\t integer\t is\t divisible\t by\t 5,\t and\t B:\t the\t last\t digit\t of\t the\t integer\tis\t3\tare\tmutually\texclusive.\tMore\tformally,\tP(A|B)\t=\tP(B|A)\t =\t 0.\t If\tn\tevents\t are\t pairwise\t mutually\t exclusive,\t then\t no\t two\t of\t them\t can\t simultaneously\t occur.\t A\t useful\t property\t of\t mutually\t exclusive\tevents\tis\tthat\tif\tE1,\tE2,\t…,\tEn\tare\tmutually\texclusive,\tthen\t the\t probability\t that\t some\tEi\toccurs\t is\t equal\t to\t the\t sum\t of\t the\t individual\tprobabilities:\tP[⋃ \u0000\u0000] \u0000 \u0000\u0000\u0000 \t=\tP[E1]\t+\tP[E2]\t\t+\t…\t+\tP[En].\tOn\t the\tother\thand,\tall\tprobabilities\tare\tbounded\tby\t1,\tso\tP[⋃ \u0000\u0000] \u0000 \u0000\u0000\u0000 \t≤\t 1,\twhich\timplies\tP[E1]\t+\tP[E2]\t\t+\t…\t+\tP[En]\t≤\t1.\tThus\twe\thave\tthe\t following\tsimple\tlemma:\t\t \t Lemma: If\tE1,\tE2,\t…,\tEn\tare\tmutually\texclusive\tevents,\tthen\tP[E1]\t+\t P[E2]\t\t+\t…\t+\tP[En]\t≤\t1.\t \t Like\t so\t many\t other\t simple\t facts\t we\t have\t encountered\t in\t this\t book,\t this\t lemma\t can\t be\t exploited\t in\t non-trivial\t ways\t to\t give\t elegant\t proofs\t for\t several\t combinatorial\t results.\t The\t next\t five\t examples\tdemonstrate\thow.\t \t Example 7 [Lubell-Yamamoto-Meshalkin Inequality] Let\tA1,\tA2,\t…,\tAs\tbe\tsubsets\tof\t{1,\t2,…,\tn}\tsuch\tthat\tAi is\tnot\ta\tsubset\t of\tAj\tfor\tany\ti\tand\tj.\tLet\tai\tdenote\t|Ai|for\teach i.\tShow\tthat\t ∑ \u0000 \u0000 \u0000 \u0000\u0000 \u0000 \u0000 \u0000\u0000\u0000 \t≤\t1.\t Answer Take\ta\trandom\tpermutation\tof\t{1,\t2,\t…,\tn}.\tLet\tEi\tdenote\tthe\tevent\t that\tAi\tappears\t as\t an\t initial\t segment\t of\t the\t permutation.\t (For\t example,\tif\tn\t=\t5,\tthe\tpermutation\tis\t3,\t4,\t2,\t5,\t1\tand\tA2\t=\t{2,\t3,\t4},\t then\tevent\tE2\toccurs\tsince\tthe\telements\tof\tA2\tmatch\tthe\tfirst\tthree\t Olympiad Combinatorics 12 elements\t of\t the\t permutation.)\t The\t key\t observation\t is\t that\t the\t events\tEi\tare\tmutually exclusive:\t if\t two\t different\t sets\t matched\t initial\t segments\t of\t the\t permutation,\t one\t set\t would\t contain\t the\t other.\tAlso\tnote\tthat\tP[Ei]\t=\t \u0000 \u0000 \u0000 \u0000\u0000 \u0000 \t,\tas\tthere\tare\t\u0000 \u0000 \u0000\u0000 \u0000\tdifferent\tchoices\t for\tthe\tfirst\tai\telements.\tTherefore,\tthe\tprobability\tof\tsome\tevent\t occurring\tis\tP[E1]\t+\tP[E2]\t\t+\t…\t+\tP[Es]\t=\t∑ \u0000 \u0000 \u0000 \u0000\u0000 \u0000 \u0000 \u0000\u0000\u0000 .\tBut\tprobability\tis\t always\tat\tmost\t1,\tso\t∑ \u0000 \u0000 \u0000 \u0000\u0000 \u0000 \u0000 \u0000\u0000\u0000 \t≤\t1.\t■\t \t Corollary [Sperner’s theorem] Let\tA1,\tA2,\t…,\tAs\tbe\tsubsets\tof\t{1,\t2,…,\tn}\tsuch\tthat\tAi\tis\tnot\ta\tsubset\t of\tAj\tfor\tany\ti\tand\tj.\tSuch\ta\tfamily\tof\tsets\tis\tknown\tas\tan\tantichain. Show\t that\ts\t≤\t\u0000 \u0000 \u0000 \u0000 \u0000 \u0000\u0000.\t In\t other\twords,\t an\t antichain\t over\t the\t power\t set\tPn\thas\tcardinality\tat\tmost\t\u0000 \u0000 \u0000 \u0000 \u0000 \u0000\u0000.\tNote\tthat\tequality\tis\tachieved\t by\t taking\t all\t sets\t of\t size\t [n/2],\t since\t two\t sets\t of\t the\t same\t size\t cannot\tcontain\teach\tother.\t\t \t Proof: Since\t\u0000 \u0000 ⌊\u0000/\u0000⌋\u0000\tis\t the\t largest\t binomial\t coefficient,\t\u0000 \u0000 ⌊\u0000/\u0000⌋\u0000\t≥\t\u0000 \u0000 \u0000\u0000 \u0000\tfor\t each\t ai.\t Therefore\t∑ \u0000 \u0000 \u0000 \u0000\u0000 \u0000 \u0000 \u0000\u0000\u0000 \t≥\t∑ \u0000 \u0000 \u0000 ⌊\u0000/\u0000⌋\u0000 \u0000 \u0000\u0000\u0000 \t=\t \u0000 \u0000 \u0000 ⌊\u0000/\u0000⌋\u0000 .\t Combining\t this\t with\t the\t Lubell-Yamamoto-Meshalkin\t inequality\t gives\t \u0000 \u0000 \u0000 ⌊\u0000/\u0000⌋\u0000 \t≤\t 1,\t and\tthe\tresult\tfollows.\t\t■\t \t\t Example 8 [Bollobas’ Theorem] Let\tA1,\tA2,\t…,\tAn\tbe\tsets\tof\tcardinality\ts,\tand\tlet\tB1,\t…,\tBn\tbe\tsets\tof\t cardinality\tt.\t Further\t suppose\t that\tAi\t∩\tBj\t=\t∅\tif\t and\t only\t if\ti\t=\tj.\t Show\tthat\tn\t≤\t\u0000 \u0000\u0000\u0000 \u0000\u0000.\t\t \t Answer: We\tuse\ta\tvisual\ttrick\tsimilar\tto\tthat\tused\tin\tthe\tprevious\tproblem.\t Chapter 9: The Probabilistic Method 13 Take\t a\t random\t permutation\t of\t all\t elements\t in\tS,\t where\tS\tis\t the\t union\t of\t all\t 2n\tsets.\t Let\tEi\tbe\t the\t event\t that\t all\t elements\t of\tAi\t precede\tall\telements\tof\tBi\tin\tthe\tpermutation\t(in\tother\twords,\tthe\t first\t element\t of\tBi\tappears\t only\t after\tthe\t last\t element\t of\tAi).\t The\t key\t observation\t is\t that\t no\t two\t events\tEi\tand\tEj\tcan\t occur\t simultaneously:\tif\tEi\tand\tEj\toccurred\tsimultaneously,\tthen\tAi\t∩\tBj\t or\tAj\t∩\tBi\twould\tbe\t∅,\tas\tthese\tsets\twould\tbe\ttoo\t“far\tapart”\tin\tthe\t permutation.\t Hence,\t as\t in\t the\t previous\t problem,\t probability\t of\t some\tevent\toccurring\tis\tP[E1]\t+\t…\t+\tP[En]\t=\t \u0000 \u0000 \u0000\u0000\u0000 \u0000\u0000 \t≤\t1,\timplying\tthe\t result.\t■\t \t Example 9 [Tuza’s Theorem (Variant of Bollobas’ Theorem)] Let\tA1,\tA2,\t…,\tAn\tand\tB1,\tB2,\t…,\tBn\tbe\tsets\tsuch\tthat\tAi\t∩\tBi\t=\t0\tfor\tall\ti\t and\tfor\ti\t≠\tj\t(Ai\t∩\tBj)\t∪\t(Aj\t∩\tBi)\t≠\t∅.\tIn\tother\twords,\teither\tAi\t∩\tBj\t ≠\t∅\tor\tAj\t∩\tBi\t≠\t∅\t(or\tboth).\tThen\tshow\tthat\tfor\tany\tpositive\treal\t number\tp\t<\t1,\t∑ \u0000 |\u0000\u0000|\u0000 \u0000\u0000\u0000 (1−\u0000) |\u0000\u0000|\t≤\t1.\t\t Answer: The\tform\tof\tthe\tresult\twe\tneed,\tnamely\t“∑ \u0000 |\u0000\u0000|\u0000 \u0000\u0000\u0000 (1−\u0000) |\u0000\u0000|\t≤\t1”,\t gives\tus\ta\tgood\tclue\tas\tto\twhat\tour\trandom\tprocess\tshould\tbe.\tLet\t U\tbe\tthe\tuniverse\tof\tall\telements\tin\tsome\tAi\tor\tBi.\tRandomly\tselect\t elements\t from\tU\twith\t probability\tp.\t Then\t\u0000 |\u0000\u0000|(1−\u0000) |\u0000\u0000|\tclearly\t represents\t the\t probability\t that\t all\t elements\t from\tAi\tare\t selected\t and\t no\t elements\t from\tBi\tare\t selected.\t Call\t this\t event\tEi.\t For\t any\t pair\ti\t≠\tj,\twe\tclaim\tthat\tEi\tand\tEj\tare\tindependent.\tSuppose\tto\tthe\t contrary\tthat\tEi\tand\tEj\tboth\toccur\tfor\tsome\ti\t≠\tj.\tThen\tthat\tmeans\t that\tall\telements\tof\tAi\t∪\tAj\thave\tbeen\tselected,\tbut\tno\telements\tof\t Bi\t∪\tBj\thave\tbeen\tselected.\tThis\timplies\tthat\tthe\tsets\t(Ai\t∪\tAj)\tand\t (Bi\t∪\tBj)\tare\tdisjoint,\tso\tAi\t∩\tBj\t=\t∅\tand\tAj\t∩\tBi\t≠\t∅.\tContradiction.\t Thus\t the\tn\tevents\t are\t pairwise\t mutually\t exclusive,\t so\t the\t probability\tthat\tsome\tevent\toccurs\tis\tP[E1]\t+\t…\t+\tP[En]\t≤\t1,\twhich\t implies\t∑ \u0000 |\u0000\u0000|\u0000 \u0000\u0000\u0000 (1−\u0000) |\u0000\u0000|\t≤\t1.\t■\t Corollary: Let\tA1,\tA2,\t…,\tAn\tbe\tsets\tof\tcardinality\ta\tand\tlet\tB1,\tB2,\t…,\tBn\tbe\tsets\t Olympiad Combinatorics 14 of\tcardinality\tb,\tsuch\tthat\tAi\t∩\tBi\t=\t0\tfor\tall\ti\tand\tfor\ti\t≠\tj\t(Ai\t∩\tBj)\t∪\t (Aj\t∩\tBi)\t≠\t∅.\tShow\tthat\tn\t≤\t (\u0000\u0000\u0000)\u0000\u0000\u0000 \u0000\u0000\u0000\u0000 .\t Proof: Simply\tplug\tin\tp\t=\t \u0000 \u0000\u0000\u0000 \tin\tTuza’s\ttheorem.\t■\t Example 10 [Original Problem, Inspired by China TST 1997] There\tare\tn\tice\tcream\tflavors\toffered\tat\tan\tice\tcream\tparlor,\tand\tk\t different\tcone\tsizes.\tA\tgroup\tof\tkids\tbuys\tice\tcreams\tsuch\tthat\tno\t student\t buys\t more\t than\t one\t ice\t cream\tof\t a\t particular\t flavor.\t Suppose\tthat\tfor\tany\ttwo\tflavors,\tthere\texists\tsome\tkid\twho\tbuys\t both\t flavors\t but\t in\t different\t cone\t sizes.\t Show\t that\t the\t total\t number\tof\tice\tcreams\tbought\tby\tthis\tgroup\tis\tat\tleast\tnlogkn.\t\t Answer: How\t do\t we\t go\t from\t innocuous\t ice\t cream\t to\t those\t nasty\t logarithms?!\tAnswer:\tThe\tProbabilistic\tMethod.\t Label\tthe\tk\tsizes\tS1,\tS2,\t…,\tSk\tand\tthe\tn\tflavors\tF1,\tF2,\t…,\tFn.\tNow\t randomly\t label\t each\t student\t with\t one\t integer\t in\t {1,\t 2,\t …,\tk}.\t For\t each\t flavor\tFi,\t let\tEi\tdenote\t the\t event\t that\t“all\t students\t eating\t an\t ice\t cream\t of\t flavor\tFi\tare\t eating\t the\t size\t corresponding\t to\t their\t label”.\t For\t example,\t this\t would\t mean\t that\t a\t student\t with\t label\t 2\t eating\tflavor\tFi\tmust\tbe\teating\tit\tin\tcone\tsize\tS2.\t\t \t The\tprobability\tof\tEi\tis\t\u0000 \u0000|\u0000\u0000|\t,\twhere\t|\u0000\u0000|\tis\tthe\tnumber\tof\tkids\t eating\t flavor\tFi.\t This\t is\t because\t each\t of\t these\t |Fi|\t kids\t has\t probability\t1/k\tof\teating\tflavor\tFi\tfrom\tthe\t“correct”\tsize\tcone,\tas\t there\tare\tk\tsizes.\t\t\t The\tkey\tobservation\tis\tthat\tthe\tEi’s\tare\tmutually\texclusive:\tthis\t follows\t from\t the\t fact\t that\t for\t any\t two\t flavors,\t there\t exists\t some\t kid\twho\tbuys\tboth\tflavors\tbut\tin\tdifferent\tcone\tsizes,\tmeaning\tthat\t he\t cannot\t be\t eating\t from\t the\t size\t corresponding\t to\t his\t label\t for\t both\tflavors.\t\t It\t follows\t that\t 1\t≥\tP(⋃\u0000\u0000)\t =\t∑ \u0000 \u0000|\u0000\u0000|\u0000 \u0000\u0000\u0000 \t≥\tn\t×\t\u0000 \u0000∑ |\u0000\u0000| \u0000 \u0000\u0000\u0000 \t\u0000⁄ \t\t\t=\t Chapter 9: The Probabilistic Method 15 nk -T/n,\twhere\tT\t=\t∑ |\u0000\u0000| \u0000 \u0000\u0000\u0000 \tis\tthe\ttotal\tnumber\tof\tice\tcreams\tbought.\t Here\t we\t have\t used\t the\t AM-GM\t inequality.\t Hence\tk T/n\t≥\tn,\t which\t implies\tthat\tT\t≥\tnlogkn,\tas\tdesired.\t■\t \t Example 11 [IMO Shortlist 2009, C4] Consider\ta\t2 m\t×\t2 m\tchessboard,\twhere\tm\tis\ta\tpositive\tinteger.\tThis\t chessboard\t is\t partitioned\t into\t rectangles\t along\t squares\t of\t the\t board.\tFurther,\teach\tof\tthe\t2 m \tsquares\talong\tthe\tmain\tdiagonal\tis\t covered\t by\t a\t separate\t unit\t square.\t Determine\t the\t minimum\t possible\tvalue\tof\tthe\tsum\tof\tperimeters\tof\tall\tthe\trectangles\tin\tthe\t partition.\t Answer: Squares\t with\t position\t (i,\ti)\t have\t already\t been\t covered,\t and\t they\t symmetrically\t divide\t the\tboard\t into\t two\tparts.\t By\tsymmetry,\t we\t can\trestrict\tour\tattention\tto\tthe\tbottom\tportion\tfor\tnow.\t \t Suppose\tthe\tportion\tof\tthe\tboard\tbelow\tthe\tdiagonal\thas\tbeen\t partitioned.\t Let\tRi\tdenote\t the\t set\t of\t rectangles\t covering\t at\t least\t one\tsquare\tin\tthe\tith\trow,\tand\tCi\tthe\tset\tof\trectangles\tcovering\tat\t least\t one\t square\t in\t the\tith\t column.\t The\t total\t perimeter\t is\t P\t=\t2\t∑(|\u0000\u0000|+|\u0000\u0000|),\t because\t each\t rectangle\t in\tRi\ttraces\t two\t vertical\t segments\t in\t row\ti\tand\t each\t rectangle\t in\tCi\ttraces\t two\t horizontal\tsegments\tin\tcolumn\ti.\t\t \t Now\trandomly\t form\t a\t set\tS\tof\t rectangles\t by\t selecting\t each\t rectangle\t in\t the\t partition\t with\t probability\t ½.\t Let\tEi\tdenote\t the\t event\tthat\tall\trectangles\tfrom\tRi\tare\tchosen\tand\tno\trectangle\tfrom\t Ci\tis\tchosen.\tClearly,\tP[Ei]\t=\t2 \u0000(|\u0000\u0000|\u0000|\u0000\u0000|).\tBut\tfor\tdistinct\ti\tand\tj,\tEi\t implies\tthat\tthe\trectangle\tcovering\t(i,\tj)\tis\tin\tS,\twhereas\tEj\timplies\t the\t rectangle\t covering\t (i,\tj)\t is\tnot\tin\tS.\t Hence\tthe Ei’s are independent.\t\t\t \t Olympiad Combinatorics 16 Figure 9.1. The shaded rectangle belongs to R2, R3 and C4. Its perimeter is 6, twice the number of sets it belongs to. \t Therefore,\t∑2 \u0000(|\u0000\u0000|\u0000|\u0000\u0000|)\t≤\t 1.\t But\t by\t the\t AM-GM\t inequality,\t ∑ 2 \u0000(|\u0000\u0000|\u0000|\u0000\u0000|)\u0000\u0000 \u0000\u0000\u0000 ≥\t2 \u0000\t×\t2 \u0000∑(|\u0000\u0000|\u0000|\u0000\u0000|)/\u0000\u0000\t=\t 2 m \t×\t2 \u0000\u0000/\u0000\u0000\u0000\u0000 .\t Hence\t 2 \u0000/\u0000\u0000\u0000\u0000 ≥\t2 m,\tso\tP\t≥\t\u00002 \u0000\u0000\u0000.\t\t \t The\t same\t bound\t holds\t for\t the\t upper\tportion,\t so\t the\t overall\t perimeter\t is\t at\t least\t 2P\t+\t sum\t of\t perimeters\t of\t unit\t squares\t on\t diagonal\t≥\t2(\u00002 \u0000\u0000\u0000)\t+\t4(2 \u0000)\t=\t(m+1)2 m+2 .\tTo\tshow\tthat\tthis\tcan\t be\t achieved,\t use\t a\t recursive\t construction:\t split\t the\t board\t into\t 4\t squares\tof\tsizes\t2 m-1 \tx\t2 m-1 .\tTwo\tof\tthem\thave\tno\tsquares\talong\tthe\t main\t diagonal;\t leave\t these\t squares\t as\t they\t are.\t Two\t of\t them\t already\t have\t unit\t squares\t along\t their\t diagonals;\t recursively\t partition\tthese.\t\t■\t \t \t Bounding Violated Conditions \t In\tpractically\tall\texistence\tproblems,\twe\tessentially\tneed\tto\tprove\t the\texistence\tof\tan\tobject\tthat\tsatisfies\tcertain\tconditions.\tA\tuseful\t idea\t is\t as\t follows:\t construct\t the\t object\t randomly,\tand\t then\t show\t C1 C2 C3 C4 C5 R1 R2 R3 R4 R5 Chapter 9: The Probabilistic Method 17 that\tthe\texpected\tnumber\tof\tconditions\tviolated\tis\tless\tthan\t1.\tIn\t other\t words,\t the\t expected\t number\t of\t “failures”\t-\tconditions\t that\t fail\tto\thold\t-\tshould\tbe\tless\tthan\t1.\tThen\tsome\tobject\tmust\tviolate\t 0\t conditions;\t this\t is\t the\t required\t object.\t The\t next\t four\t examples\t illustrate\tthis\tidea.\t\t Example 12 [Erdos’ theorem on tournaments] Say\t that\t a\t tournament\t has\t the\t property\tPk\tif\t for\t every\t set\t of\tk\t players\tthere\tis\tone\twho\tbeats\tthem\tall.\tIf\tnCk\t×\t(1−2 −k) n−k\t<\t1,\tthen\t show\t that\t there\t exists\t a\t tournament\t of\tn\tplayers\t that\t has\t the\t property\tPk.\t \t Answer: Consider\t a\t random\t tournament\t of\tn\tplayers,\t i.e.,\t the\t outcome\t of\t every\tgame\tis\tdetermined\tby\tthe\tﬂip\tof\tfair\tcoin.\tFor\ta\tset\tS\tof\tk\t players,\tlet\tAS\tbe\tthe\tevent\tthat\tno\ty\tnot\tin\tS\tbeats\tall\tof\tS.\tEach\ty\t not\t in\tS\thas\t probability\t 2 −k \tof\t beating\t all\t of\tS\tand\t there\t are\tn−k\t such\t possible\ty,\t all\t of\t whose\t chances\t are\t independent\t of\t each\t other.\tHence\tPr[AS]\t=\t(1−2 −k) n−k.\tThus\tthe\texpected\tnumber\tof\tsets\t S\tsuch\t that\t event\tAS\toccurs\t is\t at\t most\tnCk\t×\t(1−2 −k) n−k,\t which\t is\t strictly\tsmaller\tthan\t1.\tThus,\tfor\tsome\ttournament\tT\ton\tn\tvertices,\t no\tevent\tAS\toccurs\tand\twe\tare\tdone.\t■\t \t Example 13 [Taiwan 1997] For\tn\t≥\tk\t≥\t3,\tlet\tX\t=\t{1,\t2,\t…,\tn}and\tlet\tFk\tbe\ta\tfamily\tof\tk-element\t subsets\t of\tX\tsuch\t that\t any\t two\t subsets\t in\tFk\thave\t at\t most\tk–2\t elements\tin\tcommon.\tShow\tthat\tthere\texists\ta\tsubset\tM\tof\tX\twith\t at\tleast\t⌊\u0000\u0000\u0000\u0000\u0000⌋\t+\t1\telements\tand\tnot\tcontaining\tany\tsubset\tin\tFk.\t\t \t Answer: The basic plan If\tk\t≥\tlog\u0000\u0000\tthere\t is\t nothing\t to\t prove,\t so\t assume\tk\t<\t log2n.\t Let\t m\t=\t⌊\u0000\u0000\u0000\u0000\u0000⌋\t+\t1.\tOur\tidea\tis\tto\tshow\tthat\tthe\texpected\tnumber\tof\t sets\tin\tFk\tthat\ta\trandomly\tchosen\tm-element\tsubset\twould\tcontain\t is\tstrictly\tless\tthan\t1.\t\t Olympiad Combinatorics 18 \t How large is |Fk|? Easy\tdouble\tcounting\tprovides\tthis\tkey\tdetail.\tSince\teach\t(k−1)\t element\tsubset\tof\tX\tlies\tin\tat\tmost\tone\tset\tin\tFk,\tand\teach\tset\tin\tFk\t contains\t exactly\tk\t(k−1)-element\t subsets\t of\tX,\t |Fk|≤\t \u0000 \u0000\u0000 \u0000 \u0000\u0000\u0000\u0000\t =\t \u0000 \u0000\u0000\u0000\u0000\u0000\t\u0000 \u0000 \u0000\u0000.\t\t \t Finding the expectation Now\t take\t a\t randomly\t chosen\tm-element\t subset\tS\tof\tX.\tS\t contains\t\u0000 \u0000 \u0000\u0000\tk-element\tsubsets\tof\tX.\tThus\tthe\texpected\tnumber\tof\t elements\tof\tFk\tit\tcontains\tis\t\t \t \u0000\u0000\u0000\u0000\u0000\u0000\t\u0000\u0000\t\u0000\t\u0000\u0000\u0000\u0000\u0000\u0000\u0000\t\u0000\u0000\u0000\u0000\u0000\u0000\u0000\t\u0000\u0000\t\u0000\t\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000 \u0000\u0000\u0000\u0000\u0000\t\u0000\u0000\u0000\u0000\u0000\u0000\t\u0000\u0000\t\u0000\t\u0000\u0000\u0000\u0000\u0000\u0000\u0000\t\u0000\u0000\u0000\u0000\u0000\u0000\u0000\t\u0000\u0000\t\u0000 \t×\t(number\tof\tsubsets\tin\tFk)\t\t \t =\t \u0000 \u0000 \u0000\u0000\t|\u0000\u0000| \u0000 \u0000 \u0000\u0000 \t≤\t \u0000 \u0000 \u0000\u0000 \u0000\u0000\u0000\u0000\u0000,\tusing\tthe\tbound\ton\t|Fk|.\t \t The final blow To\t prove\t that\tthis\t expression\t is\t less\t than\t 1,\t it\t is\t enough\t to\t show\t that\t \t\u0000 \u0000 \u0000\u0000\t≤\t \u0000\u0000 \u0000 ,\t since\t \u0000\u0000 \u0000(\u0000\u0000\u0000\u0000\u0000) \t<\t 1\t for\tn\t≥\t 3\t (Check\t this:\t remember\tk\t<\t log2n).\t Replacing\tn\t≥\t 2 m-1 ,\t we\t just\t need\t \u0000 \u0000 \u0000\u0000\t≤\t3\t×\t2 m-3\tfor\t all\tm\t≥\tk\tand\tm\t≥\t 3,\t which\t can\t be\t shown\t by\t induction\ton\tm:\tThe\tbase\tcase\tholds,\tand\tobserve\tthat\t\t \t \u0000 \u0000\u0000\u0000 \u0000 \u0000\t=\t\u0000 \u0000 \u0000\u0000\t+\t\u0000 \u0000 \u0000\u0000\u0000\u0000\t≤\t2\tmax\t{\u0000 \u0000 \u0000\u0000\t,\t\u0000 \u0000 \u0000\u0000\u0000\u0000}\t \t ≤\t2\t×\t3\t×\t2 m-3 \t=\t2\t×\t2 m-2\t(using\tthe\tinduction\thypothesis).\t \t Thus\tthe\texpectation\tis\tless\tthan\t1\tand\twe\tare\tdone.\t■\t \t Example 14 [Original problem, inspired by IMO Shortlist ‘87] Let\tn,\tk,\tl\tand\tj\tbe\t natural\t numbers\t with\tk\t>\tl,\t and\tj\t>\tl\t≥\t 1.\t Let\t S\t=\t{1,\t2,\t3,\t…,\tn}.\tEach\telement\tof\tS\tis\tcolored\tin\tone\tof\tthe\tcolors\t Chapter 9: The Probabilistic Method 19 c1,\tc2,\t …,\tcj.\t Call\t a\t set\t of\tk\tterms\t in\tS\tin\t arithmetic\t progression\t boring if\t amongst\t them\t there\t are\t only\tl\tor\t fewer\t colors.\t (For\t instance,\tif\tk\t=\t4,\tl\t=\t2\tand\tthe\tnumbers\t1,\t4,\t7\tand\t10\tare\tcolored\t c3,\tc5,\tc5\tand\tc3\trespectively,\tthen\t{1,\t4,\t7,\t10}\tis\tboring\tas\tamongst\t these\t 4\t numbers\t in\t AP\t there\t are\t just\t 2\t colors.)\t Show\t that\t if\t n\t<\t[( \u0000\u0000 \u0000\u0000)\t( \u0000 \u0000)(k-l)] 1/2,\tthere\texists\ta\tcoloring\tof\tS\tsuch\tthat\tthere\tare\t no\tboring\tsets.\t[Note:\tHere\te\t≈\t2.718\tis\tEuler’s\tconstant]\t Answer: Looks\t complicated?\t The\t solution\t is\t actually\t surprisingly\t straightforward.\tTake\ta\trandom\tcoloring\t(each\tnumber\treceives\ta\t particular\tcolor\twith\tprobability\t1/j).\tOur\tgoal\tis\tto\tshow\tthat\tthe\t expected\tnumber\tof\tboring\tsets\tis\tless\tthan\t1.\tThen\tsome\toutcome\t of\tthis\trandom\tcoloring\tproduces\t0\tboring\tsets.\tNow\tnote\tthat\tthe\t expected\tnumber\tof\tboring\tsets\tis\t(number\tof\tk-term\tAPs\tin\tS)\t×\t (probability\t that\t a\t given\tk-term\t AP\t is\t boring).\t Denote\t the\t later\t quantity\t by\tp\tand\t the\t former\t by\tA.\t We\t just\t need\t to\t show\t that\t pA\t<\t1.\t\t Bounding A Any\tk-term\t arithmetic\t progression\t {x,\tx+d,\t …,\tx+(k−1)d}\t is\t uniquely\tdefined\tby\tits\tstarting\tterm\tx\tand\tits\tcommon\tdifference,\t d\twhere\tx,\td\t>\t0.\tSince\twe\tneed\tall\tterms\tto\tbe\tin\tS,\tx+(k−1)d\t≤\tn,\t or\tx\t≤\tn\t−\t(k−1)d.\t Hence,\t for\t each\td\t≤\tn/(k−1),\t there\t are\t exactly\t n\t−\t(k−1)d\tpossible\t values\tx\tcan\t take,\t and\t hence\t there\t are\t (n\t−\t(k−1)d)\tk-term\tarithmetic\tprogressions\tfor\teach\td.\tTherefore,\t\t \t A\t=\t∑ [\u0000−(\u0000−1)\u0000] \u0000 \u0000 \u0000\u0000\u0000 \u0000 \u0000\u0000\u0000 \t \t =\tn\u0000 \u0000 \u0000\u0000\u0000\u0000\t–\t \u0000 \u0000(k−1)\t\u0000 \u0000 \u0000\u0000\u0000\u0000(\u0000 \u0000 \u0000\u0000\u0000\u0000+1)\t<\t \u0000\u0000 \u0000\u0000\t \t where\tthe\tlast\tstep\tis\tsimple\t(boring)\talgebra\t(do\tit\tyourself!).\t So\tA\t<\t \u0000\u0000 \u0000\u0000 .\t\t \t Olympiad Combinatorics 20 Bounding p For\ta\tparticular\tk-term\tAP,\tthe\ttotal\tnumber\tof\tways\tin\twhich\tit\t can\tbe\tcolored\tis\tj k .\tA\tcoloring\tmaking\tit\tboring\tcan\tbe\tcreated\tby\t choosing\tl\tcolors\tfirst\tand\tthen\tcoloring\tusing\tonly\tthese\tl\tcolors.\t There\t are\t\u0000 \u0000 \u0000\u0000\u0000 \u0000\tways\t of\t doing\t this.\t (In\t fact,\t this\t may\t be\t higher\t than\tthe\ttotal\tnumber\tof\tbad\tevents\tas\tthere\tis\tdouble\tcounting\t-\t irrelevant\there\tbut\tworth\tnoting).\tTherefore,\t\t \t p\t≤\t\u0000 \u0000 \u0000\u0000\u0000 \u0000/\tj k \t≤\t( \u0000\u0000 \u0000) \u0000( \u0000 \u0000) \u0000\t=\tel( \u0000 \u0000) \u0000\u0000\u0000.\t And finally… pA\t<\t \t \u0000\u0000 \u0000\u0000 × el( \u0000 \u0000) \u0000\u0000\u0000\t<\t 1,\t using\t the\t bound\t on\tn\tgiven\t in\t the\t problem.\t ■\t \t Example 15 [Based on a Result of Kleitman and Spencer] Let\tn,\tm\tand\tk\tbe\tpositive\tintegers\twith\tm ≥ k 2 k ln(n)\tand\tn\t>\tk\t>\t3.\t Define\tS\t=\t {1,\t 2,\t …,\tn}.\t Show\t that\t there\t exist\tm\tsubsets\t of\tS,\t A1,\tA2,\t…,\tAm,\tsuch\t that\t for\tany\tk-element\t subset\tT\tof\tS,\t the\tm\t intersections\tT\t⋂\u0000\u0000\tfor\t1\t≤\ti\t≤\tm\trange\tover\tall\t2 k\tpossible\tsubsets\t of\tT.\t\t \t Answer: Take\t a\t few\t minutes\t to\t completely\t understand\t the\t question.\t Our\t basic\tstrategy\twill\tbe\tto\tchoose\tthe\tAi’s\trandomly\tand\tthen\tshow\t that\tthe\tprobability\tof\t“failure”\tis\tless\tthan\tone.\t Randomly\t create\t each\t set\tAi\tby\t including\t each\t element\t with\t probability\t0.5.\tFix\ta\tpair\t(T,\tT1)\twhere\tT\tis\ta\tk-element\tsubset\tof\t S\tand\tT1\tis\ta\tsubset\tof\tT.\tFor\teach\ti,\tthe\tprobability\tthat\tAi\t∩\tT\t=\tT1\t is\t 2 -k,\t because\t we\t need\t each\t element\t in\tT1\tto\t occur\t in\tAi\t(0.5\t probability\teach)\tand\teach\telement\tin\tT\\T1\tto\tnot occur\tin\tAi\t(0.5\t probability\t each\t again).\t Therefore,\t the\t probability\t that\tno\tset\tAi\t satisfies\tAi\t∩\tT\t=\tT1\tis\t(1\t–\t2 -k ) m .\t\t \t Chapter 9: The Probabilistic Method 21 There\tare\t\u0000 \u0000 \u0000\u0000\tchoices\tfor\tT\tand\t2 k\tchoices\tfor\tT1\tonce\twe\thave\t chosen\tT.\tTherefore,\tthe\toverall\tprobability\tof\tfailure\tis\tat\tmost\t\t \t \u0000 \u0000 \u0000\u00002 k (1\t–\t2 -k ) m \t≤\t \u0000\u0000 \u0000!2 k e-m/2k \t ≤\t \u0000\u0000 \u0000!2 k \u0000 \u0000\u0000\u0000\u0000\u0000\u0000\t(\u0000)/\u0000\u0000 \t=\t \u0000\u0000 \u0000!\t<\t1,\tsince\tk\t>\t3.\t \t Thus,\twith\tpositive\tprobability,\tno\tcondition\tof\tthe\tproblem\tis\t violated,\t and\t hence\t there\t exist\tm\tsubsets\t of\tS\tsatisfying\t the\t problem’s\trequirements.\t■ \t \t \t Useful Concentration Bounds \t In\tmany\tsituations\twe\twant\tthe\toutcome\tof\ta\trandom\tprocess\twe\t design\t to\t closely\t match\t the\t expectation\t of\t that\t outcome.\t Concentration\t inequalities\t allow\t us\t to\t achieve\t this\t by\t bounding\t the\t probability\t that\t a\t random\t variable\t is\t far\t from\t its\t mean.\t The\t following\tthree\tlemmas\trepresent\tthree\tof\tthe\tmost\tbasic,\twidely\t used\t concentration\t inequalities.\t We\t omit\t rigorous\t measure\t theoretic\t proofs,\t but\t will\t provide\t some\t intuition\t as\t to\t why\t they\t hold.\t\t 1. Markov’s Bound:\t If\tx\tis\t a\t nonnegative\t random\t variable\t and\ta\tis\t a\t positive\t number,\t P[x\t≥\ta]\t≤\tE[x]/a.\t \t Equivalently\twritten\tas\t\t P[x\t≥\taE[x]]\t≤\t1/a.\t \t Intuition:\tIt’s\tnot\tpossible\tfor\t20%\tof\ta\tcountry’s\tpopulation\tto\t each\tearn\tmore\tthan\t5\ttimes\tthe\tnational\taverage.\t\t Olympiad Combinatorics 22 \t 2. Chebychev’s Inequality: Chebychev’s\tinequality\tallows\tus\tto\tbound\tthe\tprobability\tthat\t a\trandom\tvariable\tis\tfar\tfrom\tits\tmean\tin\tterms\tof\tits\tvariance.\t It\tis\ta\tdirect\tconsequence\tof\tMarkov’s\tbound.\t\t \t For\t a\t random\t variable\tx,\t applying\t Markov’s\t bound\t to\t the\t positive\t random\t variable\t (x−E[x]) 2 ,\t and\t applying\t the\t definition\tof\tvariance,\t\t \t P[|x–E[x]|\t≥\ta]\t=\tP[(x–E[x]) 2 \t≥\ta 2 ]\t≤\t \u0000[(\u0000\t–\t\u0000[\u0000])\u0000] \u0000\u0000 \t=\t \u0000\u0000\u0000{\u0000} \u0000\u0000 .\t \t This\tresult\tis\tintuitive:\tThe\t“spread”\tof\tthe\trandom\tvariable\tis\t directly\trelated\tto\tits\tvariance.\t\t \t 3. Chernoff’s Bound,\tsimple\tversion:\t Chernoff’s\t bound\t provides\t another\t bound\t on\t the\t probability\t that\t a\t random\t variable\tis\t far\t from\t its\tmean.\t It\tis\t particularly\t useful\t when\t we\t want\t relative\t guarantees\t rather\t than\t absolute,\t e.g.\t when\t we\t are\t not\t directly\t concerned\t about\t the\t difference\tbetween\ta\trandom\tvariable\tand\tits\tmean\tbut\trather\t want\t to\t estimate\tthe\t probability\t that\t it\tis\t ten\t percent\t higher\t than\tits\tmean.\tIn\taddition,\twe\tdo\tnot\tneed\tinformation\tabout\t the\tvariance,\tunlike\tin\tChebychev’s\tinequality.\t\t \t Let\tX\tbe\tthe\tsum\tof\tn\tindependent\t0-1\trandom\tvariables\tX1,\t X2,\t…,\tXn,\twhere\tE[Xi]\t=\tpi.\tDenote\tE[X]\t=\t∑ \u0000\u0000 \u0000 \u0000\u0000\u0000 \tby\tµ.\tThen\tfor\t any\t0\t<\tδ\t<\t1,\t (i) P[X\t>\t(1+\u0000)µ]\t≤\t\u0000 \u0000\u0000\u0000\u0000/\u0000\t (ii) P[X\t<\t(1−\u0000)µ]\t≤\t\u0000 \u0000\u0000\u0000\u0000/\u0000\t\t\t \t \t \t In\t some\t cases,\t it\t may\t be\t clear\t that\t you\t need\t to\t use\t a\t concentration\t inequality\t but\t you\t may\t not\t be\t sure\t which\t one\t to\t use.\tIn\tsuch\tcases,\tthere’s\tno\tharm\tin\ttrying\tall\tthree\tof\tthese\t(as\t long\t as\t the\t variance\t is\t not\t difficult\t to\t compute).\t These\t three\t Chapter 9: The Probabilistic Method 23 bounds\t are\t the\t only\t ones\t you\t will\t need\t for\t the\t exercises\t in\t this\t book.\t However,\t there\t exist\t a\t wealth\t of\t other\t powerful,\t more\t specialized\t concentration\t inequalities\t used\t in\t probabilistic\t combinatorics,\tand\tinterested\treaders\tare\tencouraged\tto\trefer\tto\t online\tresources\tdevoted\tto\tthese\tresults.\t\t \t \tThe\tnext\texample\trepresents\ta\tvery\ttypical\tand\tintuitive\tuse\tof\t concentration\t inequalities.\t Essentially,\t we\t want\t something\t to\t be\t roughly\t balanced,\t so\t we\t designed\t a\t randomized\t procedure\t that\t would,\t in\t expectation,\t produce\t something\t perfectly\t balanced.\t Then,\t we\t used\t a\t concentration\t inequality\t to\t show\t that\t with\t nonzero\t probability,\t we\t would\t get\t something\t “not\t too\t unbalanced.”\t\t Example 16 [Hypergraph discrepancy] Let\tF\tbe\t a\t family\t of\tm\tsubsets\t of\t {1,\t 2,\t …,\tn}\t such\t that\t each\t set\t contains\tat\tmost\ts\telements.\t Each\t element\t of\t {1,\t2,\t …,\tn}\tis\t to\t be\t colored\t either\t red\t or\t blue.\t Define\t the\tdiscrepancy\tof\t a\t set\tS\tin\tF,\t denoted\tdisc(S),\tto\tbe\tthe\tabsolute\tvalue\tof\tthe\tdifference\tbetween\t the\tnumber\tof\tred\telements\tin\tS\tand\tblue\telements\tin\tS.\tDefine\tthe\t discrepancy\tof\tF\tto\tbe\tthe\tmaximum\tdiscrepancy\tof\tany\tset\tin\tF.\t Show\tthat\twe\tcan\tcolor\tthe\telements\tsuch\tthat\tthe\tdiscrepancy\tof\t F\tis\tat\tmost\t\u00002\u0000\u0000\t\u0000\u0000(2\u0000)\u0000.\t Answer: Color\teach\tnumber\tin\t{1,\t2,\t…,\tn}\tred\twith\tprobability\t0.5\tand\tblue\t otherwise.\t We\t just\t need\t to\t show\t that\t for\t a\t particular\tS\tin\tF,\t the\t probability\t that\tS\thas\t discrepancy\t higher\t than\t our\t desired\t threshold\tis\tless\tthan\t1/m,\tfor\tthen\tthe\tresult\twill\tfollow\tfrom\tthe\t union\tbound.\t\t Let\tS\tbe\ta\tset\twith\tt\telements,\tand\tdenote\tby\tb\tthe\tnumber\tof\t blue\telements\tand\tby\tr\tthe\tnumber\tof\tred\telements\tof\tS.\tNote\tthat\t for\t a\t fixed\t number\td\t<\tt,\tdisc(S)\t >\td\tif\t and\t only\t if\t either\t b\t<\tt/2−d/2\tor\tr\t<\tt/2−d/2.\tHence\tthe\tprobability\tthat\tdisc(S)\t>\td\t is\tequal\tto\t Olympiad Combinatorics 24 \t P[disc(S)\t>\td]\t=\tP[b\t<\tt/2\t–\td/2]\t+\tP[r\t<\tt/2\t–\td/2]\t =\t2P[b\t<\tt/2\t–\td/2]\tby\tsymmetry.\t Note\tthat\tb\tis\tthe\tsum\tof\tt\tindependent\trandom\t0-1\tvariables,\t and\tE[b]\t=\tt/2.\tWrite\tµ\t=\tt/2,\tδ\t=\td/t.\tThen\tapplying\tthe\tChernoff\t bound\tand\tnoting\tthat\tt\t≤\ts,\t \t 2P[b\t<\tt/2\t–\td/2]\t=\t2P[b\t<\t(1\t–\tδ)\tµ]\t≤\t2\u0000 \u0000\u0000\u0000\u0000/\u0000\t =\t\t2exp(−d 2 /4t)\t≤\t2exp(−d 2 /4s).\t For\t the\t last\t quantity\t to\t be\t less\t than\t 1/m,\t we\t just\t need\td\t>\t 2\u0000\u0000\t\u0000\u0000(2\u0000)\t,\tas\tdesired.\t■\t Remark:\tNote\t that\t using\t the\t Chebychev\t inequality\t for\t this\t problem\twould\tprove\ta\tweaker\tbound.\tIt\tis\tinstructive\tfor\treaders\t to\ttry\tthis,\tas\tit\tis\ta\tgood\texercise\tin\tcomputing\tthe\tvariance\tof\ta\t random\tvariable.\t\t \t \t The Lovasz Local Lemma \t In\tthe\tsection\ton\tbounding\t“violated\tconditions,”\twe\tused\tthe\tfact\t that\t if\t the\t expected\t number\t of\t violated\t conditions\t is\t less\t than\t 1,\t then\tthere\texists\tan\tobject\tsatisfying\tall\tconditions.\tUnfortunately,\t we\taren’t\talways\tthis\tlucky:\tin\tmany\tcases,\tthe\texpected\tnumber\t of\tviolated\tconditions\tis\tlarge.\tThe\tLovasz local lemma\tprovides\ta\t much\t sharper\t tool\t for\t dealing\t with\t these\t situations,\t especially\t when\tthe\tdegree\tof\tdependence\t(defined\tbelow)\tbetween\tviolated\t conditions\tis\tlow.\t \t Definition:\tLet\tE1,\tE2,\t …,\tEn\tbe\t events.\t Consider\t a\t graph\tG\twith\t vertices\tv1,\t…,\tvn,\tsuch\tthat\tthere\tis\tan\tedge\tbetween\tvi\tand\tvj\tif\tand\t only\tif\tevents\tEi\tand\tEj\tare\tnot\tindependent\tof\teach\tother.\tLet\td\tbe\t Chapter 9: The Probabilistic Method 25 the\t maximum\t degree\t of\tany\t vertex\t in\tG.\t Then\td\tis\t known\t as\t the\t degree of independence between\tthe\tevents\tE1,\tE2,\t…,\tEn.\t\t \t Theorem [The Lovasz Local Lemma]: Let\tE1,\tE2,\t …,\tEn\tbe\t events\t with\t degree\t of\t dependence\t at\t most\td\t and\tP[Ei]\t≤\tp\tfor\teach\t1\t≤\ti\t≤\tn,\twhere\t0\t<\tp\t<\t1.\tIf\tep(d+1)\t≤\t1,\tthen\t P[E1’\t∪\tE2’\t∪\t…\t∪\tEn’]\t >\t 0,\t where\tEi’\t denotes\t the\t complement\tof\t event\tEi.\t In\t other\t words,\t if\tep(d+1)\t≤\t 1,\t then\t the\t probability\t of\t none of the n events occurring\tis\tstrictly\tgreater\tthan\t0.\t(Here\te\t is\tEuler’s\tconstant.)\t \t The\t Lovasz\t local\t lemma\t hence\t gives\t us\t a\t new\t way\t to\t solve\t problems\t in\t which\t we\t need\t to\t show\t that\t there\t exists\t an\t object\t violating\t0\tconditions.\tGiven\tn\tconditions\tthat\tneed\tto\thold,\tdefine\t Ei\tto\tbe\tthe\tevent\tthat\tthe\tith\tcondition\tis\tviolated.\tAll\twe\tneed\tto\t do\t is\t show\t compute\tp\tand\td\tfor\t these\t events,\t and\t show\t that\t ep(d+1)\t≤\t1.\t\t\t \t Example 17 [Generalization of Russia 2006] At\ta\tcertain\tparty\teach\tperson\thas\tat\tleast\tδ\tfriends\tand\tat\tmost\t∆\t friends\t(amongst\tthe\tpeople\tat\tthe\tparty),\twhere\t∆\t>\tδ\t>1.\tLet\tk\tbe\t an\t integer\t with\tk\t<\tδ.\t The\t host\t wants\t to\t show\t off\t his\t extensive\t wine\tcollection\tby\tgiving\teach\tperson\tone\ttype\tof\twine,\tsuch\tthat\t each\t person\t has\t a\t set\t of\t at\t least\t (k+1)\t friends\t who\t all\t receive\t different\t types\t of\t wine.\t The\t host\t has\tW\ttypes\t of\t wine\t (and\t unlimited\tsupplies\tof\teach\ttype).\t\t \t Show\tthat\tif\tW\t>\tk [e k+1 (∆ 2 −∆+1)] 1/(δ-k) ,\tthe\thost\tcan\tachieve\tthis\t goal.\t\t \t Answer: Interpret\t the\t problem\t in\t terms\t of\t a\t friendship\t graph\t (as\t usual),\t and\t interpret\t “types\t of\t wine”\t as\t coloring\t vertices.\t Note\t the\t presence\t of\tlocal\trather\t than\tglobal\tinformation-\tthe\t problem\t revolves\taround\tthe\tneighbors\tand\tdegrees\tof\tindividual\tvertices,\t Olympiad Combinatorics 26 but\tdoesn’t\teven\ttell\tus\tthe\ttotal\tnumber\tof\tvertices!\tThis\tsuggests\t using\t the\t Lovasz\t Local\t Lemma.\t We\t will\t show\t that\tep(d+1)\t≤\t 1,\t where\tp\tis\tthe\tprobability\tof\ta\tlocal\tbad event\tEv\t(defined\tbelow)\t and\td\tis\tthe\tdegree\tof\tdependency\tbetween\tthese\tevents.\t\t Defining Ev and bounding p = P[Ev] Randomly\t color\t vertices\t using\t the\tW\tcolors\t (each\t vertex\t receives\t a\t particular\t color\t with\t probability\t 1/W).\t Let\tEv\tdenote\t the\t event\t that\t vertex\tv\tdoes\tnot\thave\t (k+1)\t neighbors\t each\t receiving\ta\tdifferent\tcolor.\tHence,\t\t P[Ev]\t≤\t\u0000 \u0000 \u0000\u0000\t×\t( \u0000 \u0000 ) \u0000\u0000\t≤\t\u0000 \u0000 \u0000\u0000\t×\t( \u0000 \u0000 ) \u0000≤\t( \u0000 \u0000) \u0000( \u0000\u0000 \u0000) \u0000\t=\te k ( \u0000 \u0000 ) \u0000\u0000\u0000.\t Here\twe\tused\tdv\t≥\tδ.\t Bounding d Ev\tand\tEu\twill\tbe\tnon-independent\tif\tand\tonly\tif v\tand\tu\thave\ta\t common\tneighbor\t-\tin\tother\twords,\tu\tmust\tbe\ta\tneighbor\tof\tone\tof\t v’s\tneighbors.\tv\thas\tat\tmost\t∆\tneighbors,\tand\teach\tof\tthese\thas\tat\t most\t(∆−1)\tneighbors\tapart\tfrom\tv.\tHence\tfor\tfixed\tv,\tthere\tare\tat\t most\t (∆ 2−∆)\t choices\t for\tu\tsuch\t that\tEv\tand\tEu\tare\t dependent.\t It\t follows\tthat\td\t≤\t(∆ 2−∆).\t\t And finally… ep(d+1)\t≤\te\t×\te k( \u0000 \u0000) \u0000\u0000\u0000\t×\t(∆ 2−∆+1).\tRearranging\tthe\tcondition\t in\tthe\tproblem\t (namely\tW\t≥\tk [e k+1 (∆ 2 −∆+1)] 1/(δ-k) )\tshows\tthat\t this\texpression\tis\tat\tmost\t1.\tHence\tproved.\t■ \t Chapter 9: The Probabilistic Method 27 \t \t Exercises 1. [Max cut revisited] Give\ta\tprobabilistic\targument\tshowing\tthat\tthe\tvertex\tset\tV\tof\t a\tgraph\tG\twith\tedge\tset\tE\tcan\tbe\tpartitioned\tinto\ttwo\tsets\tV1\t and\tV2\tsuch\tthat\tat\tleast\t|E|/2\tedges\thave\tone\tendpoint\tin\tV1\t and\tone\tendpoint\tin\tV2.\t\t 2. [Hypergraph coloring] Let\tF\tbe\ta\tfamily\tof\tsets\tsuch\tthat\teach\tset\tcontains\tn\telements\t and\t|F|\t<\t2 n-1 .\tShow\tthat\teach\telement\tcan\tbe\tassigned\teither\t the\t color\t red\t or\t the\t color\t blue,\t such\t that\t no\t set\t in\tF\tis\t monochromatic\t(contains\telements\tof\tonly\tone\tcolor).\t\t 3. [A Bound on Ramsey Numbers] The\tRamsey number\tR(k,\tj)\tis\t defined\t as\t the\t least\t number\tn\t such\t that\t for\t any\t graph\tG\ton\tn\tvertices,\tG\teither\t contains\t a\t clique\t of\t size\tk\tor\t an\t independent\t set\t of\t size\tj.\t Show\t that\t R(k,\tk)\t≥\t2 k/2 \tfor\teach\tk.\t\t 4. [Stronger version of IMO Shortlist 1999, C4] Let\tA\tbe\ta\tset\tof\tn\tdifferent\tresidues\tmod\tn 2 .\tThen\tprove\tthat\t there\texists\ta\tset\tB\tof\tn\tresidues\tmod\tn 2 \tsuch\tthat\tthe\tset\tA+B\t =\t{a+b\t|a\tє\tA,\tb\tє\tB}\tcontains\tat\tleast\t(e–1)/e\tof\tthe\tresidues\t mod\tn 2 .\t 5. [Another hypergraph coloring problem] Let\tF\tbe\t a\t family\t of\t sets\t such\t that\t each\t set\t contains\tn\t elements.\t Suppose\t each\t set\t in\tF\tintersects\t at\t most\t 2 n-3 \tother\t sets\t in\tF.\t Show\t that\t each\t element\t can\t be\t assigned\t either\t the\t color\t red\t or\t the\t color\t blue,\t such\t that\t no\t set\t in\tF\tis\t monochromatic.\tImprove\tthis\tbound\t(that\tis,\treplace\t2 n-3 \tby\ta\t Olympiad Combinatorics 28 larger\tnumber\tand\tprove\tthe\tresult\tfor\tthis\tnumber).\t\t 6. [Based on Russia 1999] Let\tG\tbe\t a\t bipartite\t graph\t with\t vertex\t set\tV\t=\tV1\t∪\tV2.\t Show\t that\tG\thas\t an\t induced\t subgraph\tH\tcontaining\t at\t least\t |V|/2\t vertices,\tsuch\tthat\teach\tvertex\tin\tV1\t⋂\u0000\thas\todd\tdegree\tin\tH.\t\t 7. [USAMO 2012, Problem 2] A\tcircle\tis\tdivided\tinto\t432\tcongruent\tarcs\tby\t432\tpoints.\tThe\t points\t are\t colored\t in\t four\t colors\t such\t that\t some\t 108\t points\t are\t colored\t Red,\t some\t 108\t points\t are\t colored\t Green,\t some\t 108\tpoints\tare\tcolored\tBlue,\tand\tthe\tremaining\t108\tpoints\tare\t colored\tYellow.\tProve\tthat\tone\tcan\tchoose\tthree\tpoints\tof\teach\t color\t in\t such\t a\t way\t that\t the\t four\t triangles\t formed\t by\t the\t chosen\tpoints\tof\tthe\tsame\tcolor\tare\tcongruent.\t 8. [List coloring] Each\tvertex\tof\tan\tn-vertex\tbipartite\tgraph\tG\tis\tassigned\ta\tlist\t containing\tmore\tthan\tlog2n\tdistinct\tcolors.\tProve\tthat\tG\thas\ta\t proper\tcoloring\tsuch\tthat\teach\tvertex\tis\tcolored\twith\ta\tcolor\t from\tits\town\tlist.\t \t 9. Let\tA\tbe\tan\tn\t×\tn\tmatrix\twith\tdistinct\tentries.\tProve\tthat\tthere\t exists\t a\t constant\tc\t>\t 0,\t independent\t of\tn,\twith\t the\t following\t property:\tit\tis\tpossible\tto\tpermute\tthe\trows\tof\tA\tsuch\tthat\tno\t column\t in\t the\t permuted\t matrix\t contains\t an\t increasing\t subsequence\tof\tlength\tc√\u0000.\t(Note\tthat\tconsecutive\tterms\tin\ta\t subsequence\t need\t not\t be\t adjacent\tin\t the\t column;\t “subsequence”\tis\tdifferent\tfrom\t“substring.”) 10. [IMO Shortlist 2006, C3] Let\tS\tbe\t a\t set\t of\t points\t in\t the\t plane\t in\t general\t position\t (no\t three\tlie\ton\ta\tline).\tFor\ta\tconvex\tpolygon\tP\twhose\tvertices\tare\t in\tS,\tdefine\ta(P)\tas\tthe\tnumber\tof\tvertices\tof\tP\tand\tb(P)\tas\tthe\t number\tof\tpoints\tof\tS\tthat\tare\toutside\tP.\t(Note:\tan\tempty\tset\t,\t point\t and\t line\t segment\tare\t considered\t convex\t polygons\t with\t 0,\t 1\t and\t 2\t vertices\t respectively.)\t Show\t that\t for\t each\t real\t Chapter 9: The Probabilistic Method 29 number\tx,\t ∑\u0000 \u0000(\u0000)(1−\u0000) \u0000(\u0000)\t=\t1,\t \t where\tthe\tsum\tis\ttaken\tover\tall\tconvex\tpolygons\tP.\t\t \t 11. [Bipartite Expanders]\t A\tbipartite\tgraph\tG\twith\tvertex\tset\tV\t=\t\u0000\u0000⋃\u0000\u0000\tis\tsaid\tto\tbe\tan\t (n,\tm,\td,\tβ)\tbipartite expander\tif\tthe\tfollowing\tholds:\t \t (i) |\u0000\u0000|\t=\tn\tand\t|\u0000\u0000|\t=\tm\t (ii) Each\tvertex\tin\tV1\thas\tdegree\td\t (iii) For\t any\t subset\tS\tof\tV\twith\t |S|\t≤\tn/d,\t there\t are\t at\t least\t β|S|\tvertices\tin\t\u0000\u0000\tthat\thave\ta\tneighbor\tin\tS\t \t Show\t that\t for\t any\t integers\tn\t>\td\t≥\t 4,\t there\t exists\tan\t (n,\tn,\td,\t d/4)\tbipartite\texpander.\t \t 12. [Sphere packing]\t Let\tn\tbe\ta\tgiven\tpositive\tinteger.\tCall\ta\tset\tS\tof\tbinary\tstrings\t of\tlength\tn\tα-good\tif\tfor\teach\tpair\tof\tstrings\tin\tS,\tthere\texist\tat\t least\tnα\tpositions\t in\t which\t the\t two\t differ.\t For\t instance,\t if\t n\t=\t100\tand\tα\t=\t0.1,\tthen\tany\tpair\tof\tstrings\tin\tS\tmust\tdiffer\tin\t at\t least\t 10\t positions.\t Show\t that\t for\t each\t integer\tn\tand\t real\t number\t0\t<\tα\t<\t0.5,\tthere\texists\tan\tα-good\tset\tS\tof\tcardinality\t at\tleast\t\u0000√2\u0000 \u0000(\u0000.\u0000\u0000\t\u0000)\u0000 \u0000.\t\t \t As\t a\t (rather\t remarkable)\t corollary,\t deduce\t that\t the\t unit\t sphere\tin\tn\tdimensions\tcontains\ta\tset\tof\t\u0000√2\u0000 \u0000/\u0000\u0000\u0000\tpoints\tsuch\t that\t no\t two\t of\t these\tpoints\t are\t closer\t than\t one\t unit\t (Euclidean)\tdistance\tfrom\teach\tother.\t \t Remark:\tThe\tproblem\tof\tfinding\tlarge\tsets\tof\tbinary\tstrings\tof\t a\t given\t length\t such\t that\t any\t two\t differ\t in\t sufficiently\t many\t positions\t is\t one\t of\t the\t central\t problems\t of\t coding\t theory.\t Coding\ttheory\tis\ta\tremarkable\tfield\tlying\tin\tthe\tintersection\tof\t Olympiad Combinatorics 30 mathematics\tand\tcomputer\tscience,\tand\tuses\ttechniques\tfrom\t combinatorics,\t graph\t theory,\t field\t theory,\t probability\t and\t linear\talgebra.\tIts\tapplications\trange\tfrom\tfile\tcompression\tto\t mining\tlarge\tscale\tweb\tdata.\tCoding\ttheory\tis\talso\tthe\treason\t your\t CDs\t often\t work\t even\t if\t they\t get\t scratched.\t While\t this\t exercise\t asks\t for\t an\t existence\t proof,\t finding\t constructive\t solutions\t to\t several\t similar\t problems\t remains\t an\t active\t research\tarea\twith\thigh\tpractical\trelevance.\t \t 13. Let\tF\tbe\ta\tcollection\tof\tk-element\tsubsets\tof\t{1,\t2,\t…,\tn}\tand\tlet\t x\t=\t|F|/n.\tThen\tthere\tis\talways\ta\tset\tS\tof\tsize\tat\tleast\t\t \u0000 \u0000\u0000\u0000/(\u0000\u0000\u0000)\t which\tdoes\tnot\tcompletely\tcontain\tany\tmember\tof\tF.\t\t 14. [Another list coloring theorem] Each\tvertex\tof\tan\tn-vertex\tgraph\tG\tis\tassigned\ta\tlist\tcontaining\t at\t least\tk\tdifferent\t colors.\t Furthermore,\t for\t any\t color\tc\t appearing\t on\t the\t list\t of\t vertex\tv,\tc\tappears\t on\t the\t lists\t of\t at\t most\tk/2e\tneighbors\t of\tv.\t Show\t that\t there\t exists\t a\t proper\t coloring\t of\t the\t vertices\t of\tG\tsuch\t that\t each\t vertex\t is\t colored\t with\ta\tcolor\tfrom\tits\tlist.\t\t 15. [Due to Furedi and Khan] Let\tF\tbe\t a\t family\t of\t sets\t such\t that\t each\t set\t in\tF\tcontains\t at\t most\tn\telements\tand\teach\telement\tbelongs\tto\tat\tmost\tm\tsets\t in\tF.\t Show\t that\t it\t is\t possible\t to\t color\t the\t elements\t using\t at\t most\t1+(n–1)m\tcolors\tsuch\tthat\tno\tset\tin\tF\tis\tmonochromatic.\t\t 16. [Due to Paul Erdos] A\tset\tS\tof\tdistinct\tintegers\tis\tcalled\tsum-free\tif\tthere\tdoes\tnot\t exist\ta\ttriple\t{x,\ty,\tz}\tof\tintegers\tin\tS\tsuch\tthat\tx\t+\ty\t=\tz.\tShow\t that\tfor\tany\tset\tX\tof\tdistinct\tintegers,\tX\thas\ta\tsum-free\tsubset\t Y such\tthat\t|Y|\t>\t|X|/3.\t\t \t 17. [IMO 2012, Problem 3] The\tliar's guessing game\tis\t a\t game\t played\t between\t two\t players\tA\tand\tB.\tThe\trules\tof\tthe\tgame\tdepend\ton\ttwo\tpositive\t Chapter 9: The Probabilistic Method 31 integers\tk\tand\tn\twhich\tare\tknown\tto\tboth\tplayers.\t A\tbegins\tby\tchoosing\tintegers\tx\tand\tN\twith\t1\t≤\tx\t≤\tN.\tPlayer\t A\tkeeps\tx\tsecret,\t and\t truthfully\t tells\tN\tto\t player\tB.\t Player\tB\t now\t tries\t to\t obtain\t information\t about\tx\tby\t asking\t player\tA\t questions\tas\tfollows:\teach\tquestion\tconsists\tof\tB\tspecifying\tan\t arbitrary\t set\tS\tof\t positive\t integers\t (possibly\t one\t specified\t in\t some\tprevious\tquestion),\tand\tasking\tA\twhether\tx\tbelongs\tto\tS.\t Player\tB\tmay\task\tas\tmany\tquestions\tas\the\twishes.\tAfter\teach\t question,\tplayer\tA\tmust\timmediately\tanswer\tit\twith\tyes\tor\tno,\t but\t is\t allowed\t to\t lie\t as\t many\t times\t as\t she\t wants;\t the\t only\t restriction\t is\t that,\t among\t any\t (k+1)\t consecutive\t answers,\t at\t least\tone\tanswer\tmust\tbe\ttruthful.\t\t After\tB\thas\tasked\tas\tmany\tquestions\tas\the\twants,\the\tmust\t specify\ta\tset\tX\tof\tat\tmost\tn\tpositive\tintegers.\tIf\tx\tbelongs\tto\tX,\t then\tB\twins;\totherwise,\the\tloses.\tProve\tthat:\t 1. If\tn\t≥\t2 k,\tthen\tB\tcan\tguarantee\ta\twin.\t 2. For\tall\tsufficiently\tlarge\tk,\tthere\texists\tan\tinteger\tn\t≥\t1.99 k\t such\tthat\tB\tcannot\tguarantee\ta\twin.\t \t 18. [Johnson-Lindenstrauss Lemma]\t (i) Let\tX1,\tX2,\t …,\tXd\tbe\td\tindependent\t Gaussian\t random\t variables.\t Let\tX\t=\t (X1,\tX2,\t …,\tXd)\t be\t the\td-dimensional\t vector\twhose\tcoordinates\tare\tX1,\tX2,\t…,\tXd.\tLet\tk\t<\td\tand\tlet\t X’\tbe\tthe\tk-dimensional\tvector\t(X1,\tX2,\t…,\tXk).\t\tShow\tthat:\t \t a) If\tα\tis\ta\tconstant\tgreater\tthan\t1,\t\t\t Prob[\t||Xk||\t≥\tα k/d ]\t≤\texp(\t \u0000(\u0000\u0000\t\u0000\t\u0000\t\u0000\u0000\u0000) \u0000 )\t \t b) If\tα\tis\ta\tconstant\tsmaller\tthan\tthan\t1,\t\t Prob[\t||Xk||\t≤\tα k/d ]\t≤\texp(\t \u0000(\u0000\u0000\t\u0000\t\u0000\t\u0000\u0000\u0000) \u0000 )\t (ii) Part\t (i)\t says\t that\tthe\t norm\t of\ta\t vector\t of\tindependent\t Olympiad Combinatorics 32 randomly\t distributed\t Gaussian\t variables\t projected\t onto\t its\t first\tk\tcoordinates\t is\t sharply\t concentrated\t around\t its\t expectation.\t Equivalently,\tthe\t norm\t of\ta\t fixed\t vector\t projected\t onto\t a\t random\tk-dimensional\t subspace\t is\t sharply\t concentrated\t around\t its\texpectation.\t Use\t this\t result\t to\t show\t that\t given\t a\t set\tS\tof\tn\tpoints\t in\t a\td- dimensional\t space,\t there\t is\t a\t mapping\tf\tto\t a\t subspace\t of\t dimension\tO(n\tlog\tn/\u0000 \u0000)\tsuch\tthat\tfor\tall\tpoints\t\tu,\tv\tin\tS,\t\t (1–ε)\tdist(u,\tv)\t≤\tdist(f(u),\tf(v))\t≤\t(1+ε)\tdist(u,\tv).","libVersion":"0.3.1","langs":""}
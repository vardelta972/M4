{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Congruences.pdf","text":"3 Congruence arithmetic 3.1 Congruence mod n As we said before, one of the most basic tasks in number theory is to factor a number a. How do we do this? We start with smaller numbers and see if they divide a. You have probably know some basic divisibility tests: 2, 5, 10 — check last digit 3, 9 — check sum of digits 4, 25 — check last two digits 11 — check sum of odd vs even digits The natural way to explain these tests (and ﬁnd new ones) is by a more reﬁned approach to divisibility: congruences. Instead of just saying a number a is divisible or not by some number m, it is helpful to look at the remainder, denoted a mod n. Example. 0 mod 4 = 0 1 mod 4 = 1 2 mod 4 = 2 3 mod 4 = 3 4 mod 4 = 0 5 mod 4 = 1 6 mod 4 = 2 7 mod 4 = 3 8 mod 4 = 0 Deﬁnition 3.1. We say a is congruent to b modulo n, and write a ≡ b mod n if the remainders a mod m and b mod n are equal, i.e., if n|b − a. Example. 1003 ≡ 999 mod 4. 3.2 Congruence classes and their arithmetic Deﬁnition 3.2. The congruence class of a (mod n) is nZ + a = {nk + a : k ∈ Z} . Note: this is the set of all numbers which are congruent to a mod n. Proof: If b ∈ nZ + a then b − a = nk for some k so n|b − a, i.e., b ≡ a mod n. Conversely b ≡ a mod n precisely means b − a = nk for some k, i.e., b ∈ nZ + a. Example. 2Z = {even numbers} and 2Z + 1 = {odd numbers}. Note: the nZ + a representations for congruence classes are not unique: e.g., 2Z = 2Z + 6 and 2Z + 1 = 2Z − 1. Example. nZ = {all numbers divisible by n}. 17 Example. 4Z + 1 = {. . . − 7, −3, 1, 5, 9, . . .} Thus we see congruences mod n partition the integers into n “evenly distributed” classes, gen- eralizing the notion of even and odd. Observe that if x mod n = a and y mod n = b, then x + y mod n = (a + b) mod n. I.e., if x ∈ nZ + a and y ∈ nZ + b then x + y ∈ nZ + (a + b). Hence congruence classes respect addition. They also respect multiplication: if x = nk + a and y = nl + b then xy = n2kl + nla + nkb + ab ∈ nZ + ab. Hence we can work with the operations of + and × mod n just as with the integers. Example. Addition on a 12 hour clock. 5 hours after 8:00 is 1:00. Using congruences, we can write this as 8 + 5 ≡ 1 mod 12. Example. Let n = 2, 5 or 10. Write a = ak · 10k + ak−1 · 10k−1 + · · · + a1 · 10 + a0. Then a ≡ (ak · 0 + ak−1 · 0 + · · · + a1 · 0 + a0) ≡ a0 mod n since 10 ≡ 1 mod n. This explains why it suﬃces to check the last digit for divisibility by n = 2, 5, 10. Example. Let n = 3 or 9. Write a = ak · 10k + ak−1 · 10k−1 + · · · + a1 · 10 + a0. Then a ≡ (ak + ak−1 + · · · + a1 + a0) ≡ mod n since 10 ≡ 1 mod n. Hence a number is divisible by n = 3 if and only if the sum of its digits are, and the same is true for n = 9. Exercise 3.1. Exercises 3.1.3, 3.1.4 (no proof needed for 3.1.4). Exercise 3.2. Write a = ak · 10k + ak−1 · 10k−1 + · · · + a1 · 10 + a0. Prove that a is divisible by 11 if and only if the sum of the odd digits (ak where k odd) minus the sum of the even digits (ak where k even) is. (Hint: see Exercises 3.2.2, 3.2.3.) There are several methods for testing divisibility by 7, though they are more complicated. Can you ﬁgure any out? A more algebraic approach. Denote the set of congruence classes mod n by Z/nZ. Deﬁnition 3.3. We can deﬁne addition and multiplication in Z/nZ as follows. The sum of two congruence classes is given by (nZ + a) + (nZ + b) = nZ + (a + b). The product is given by (nZ + a)(nZ + b) = nZ + ab. 18 Note: The idea of congruence arithmetic is very simple. The integers modulo n (i.e., the remainders) are 0, 1, . . . , n − 1. For example for n = 7 we would like to say that 5 mod 7 + 3 mod 7 = 1. However this is technically incorrect as 5 mod 7 + 3 mod 7 = 5 + 3 = 8 ̸= 1. In other words, usual integer addition doesn’t make sense on the integers mod n. So one approach is to write equations as mod n equivalence relations, e.g., 5 + 3 ≡ 8 ≡ 1 mod 7. However, by deﬁning addition and multiplication on Z/nZ (equivalence classes), we can use the tools of modern algebra to study congruence arithmetic. In particular, we have made Z/nZ into a what is called a ring (formal deﬁnition later). In this way we would write our above equation as (7Z + 5) + (7Z + 3) = 7Z + 8 = 7Z + 1. In practice however, it is cumbersome to write elements of Z/nZ as nZ + a. So we will often refer to elements of nZ (e.g., class nZ + a) by a representative of the class (e.g., a). For instance, we may refer to the class 7Z + 6 as the element 5 in Z/7Z, or we might call it the element -2 in Z/7Z depending on which is convenient, with it being understood that we mean the class of integers containing that number. Nevertheless, to avoid confusion we will not write explicit equations in the form, say 52 = 4 (in Z/7Z), but rather in congruence notation: 52 ≡ 4 (mod 7). Example. Write down addition and multiplication tables for Z/5Z. Exercise 3.3. Write down addition and multiplication tables for Z/6Z. 3.3 Inverses mod p Assume n > 1. Deﬁnition 3.4. We say a is invertible mod n if there exists b ∈ Z such that ab ≡ 1 mod n. In this case b is called the (multiplicative) inverse of a (mod n). Note that this only depends on the congruence class, i.e., if a ≡ b mod n, then a is invertible mod n if and only if b is. In Z only a = ±1 are invertible (in the same sense: ∃a−1 ∈ Z), however we saw in Z/5Z, every non-zero element is invertible. This means the non-zero classes mod 5 form an abelian group. Deﬁnition 3.5. Let G be a set with a binary operation · . , i.e., · is a function from G × G → G, expressed as (g, h) 7→ g · h. If G satisﬁes the following properties, (i) · is associative: (g · h) · k = g · (h · k) for all g, h, k ∈ G; (ii) there is an identity 1 ∈ G such that 1 · g = g · 1 = g for all g ∈ G; (iii) every g ∈ G has an inverse g−1 such that g−1 · g = g · g−1 = 1; then we say (G, ·) (or just G) is a group. If (i) through (iii) and (iv) · is commutative: g · h = h · g for all g, h ∈ G also hold, we say (G, ·) (or just G) is an abelian group. When the operation is understood, we typically write gh for g · h. 19 Note: We will not prove the following elementary facts, but 1·g = g for all g is equivalent to g·1 = g for all g, and g−1g = 1 is equivalent to gg−1 = 1, so one does not need to check multiplications both ways. (This is of course trivial when G is abelian—our primary case of interest.) Also conditions (ii) and (iii) deﬁning the identity and the inverse of an element imply that such elements will be unique. The ﬁnite abelian groups are the simplest class of groups and have a simple characterization. If G is a ﬁnite group with n elements, we say it is a ﬁnite group of order n, and write |G| = n. In case you are not familiar with groups, here are some examples. Example. (Z, +) is an abelian group. So is (Q, +) and (R, +), but (N, +) is not (see below). Example. (Z/nZ, +) is an ﬁnite abelian group of order n. Exercise 3.4. Rewrite what properties (i) through (iv) mean when our operation is written as + (called additive) and not · (called multiplicative). Which properties fail for (N, +)? What is the (additive) inverse of 8Z + 5 in the group (Z/8Z, +)? Example. (n-th roots of unity) Fix n. Let Un = {e2πik/n : 0 ≤ k < n} . Then, with the standard multiplication, Un is a ﬁnite abelian group of order n. It has the same structure (is “isomorphic” to) (Z/nZ, +), the only diﬀerence being one group is written with multiplicative notation and one with additive notation. Example. (dihedral groups) Fix n > 2. Let P be a regular polygon with n vertices. The the set of automorphisms of P , namely the rotations and reﬂections which map P to itself, form a ﬁnite non-abelian group of order 2n called D2n, where the operation is composition. Example. (symmetric groups) Let Sn be the set of permutations of {1, 2, . . . , n}. Then Sn is a ﬁnite group of order n! with the composition operation. It is non-abelian for n > 2. Example. Q× = Q − {0} is an inﬁnite abelian group with multiplication. So is R× and C×. Similarly, the positive rational (or reals) also are. Example. Let SL(2, Z) = {( a b c d ) : ad − bc = 1 }. This is an inﬁnite non-abelian group with usual matrix multiplication, and is an important group in number theory. Okay, so those were some examples. Basically, a group (in multiplicative notation) is a collection of objects that you can multiply and divide, and has “1.” If the multiplication is commutative (which it is for numbers, but not in general for groups of functions or matrices), we say it is abelian (after Niels Abel). We are interested in the invertible elements mod n, or equivalently, the invertible elemtns of Z/nZ: (Z/nZ) × = {nZ + a ∈ Z/nZ : a invertible mod n} . Exercise 3.5. Prove (Z/nZ)× is a ﬁnite abelian group. You may take for granted that multiplication is well deﬁned on Z/nZ (from the previous section) and associative, though you should say a sentence about why it is well deﬁned on (Z/nZ)×. Before tackling (Z/nZ)× in general (as in, what are they? how many are there?) we ﬁrst deal with the case n is prime. 20 Proposition 3.6. Let p be prime. Then (Z/pZ)× is the set of non-zero classes in Z/pZ, i.e., it is a ﬁnite abelian group of order p − 1. (By the zero class, we mean pZ ∈ Z/pZ.) Proof. First note that the zero class Z/pZ cannot be invertible. For if it were, that would mean 0 is invertible mod p, but there is no b such that 0 · b ≡ 1 mod p. Now we want to show any other class pZ + a is invertible, i.e., for any a ̸≡ 0 mod p, show a is invertible mod p. Since p ∤ a and p is prime, gcd(a, p) = 1. Thus Section 2.3 implies there exist m, n ∈ Z such that ma + np = gcd(a, p) = 1. Hence ma ≡ 1 mod p and m is the inverse of p. This statement says that any non-zero class in Z/pZ is invertible, which implies Z/pZ is a ﬁeld with + and ·, for those of you that have seen ﬁelds before. Note that the proof shows we can determine the inverse of a mod p by the extended Euclidean algorithm. A little group theory. Deﬁnition 3.7. Let (G, ·) be a group. Let H be a subset of G. If (H, ·) is also a group then H is called a subgroup of G. The (left) cosets of H in G are the subsets of G of the form gH = {gh : h ∈ H} , g ∈ G. Example. nZ ⊆ Z. Just as congruences mod n partition Z into n diﬀerent classes, we will see that the cosets partition G into a certain number of diﬀerent classes (which we now call cosets). Let us ﬁrst look at a few more examples. Example. U2 ⊆ U4. Example. U2, U3 ⊆ U6. Example. H = {1} ⊆ G. Example. H = G ⊆ G. Proposition 3.8. (Lagrange’s theorem) If H is a subgroup of a ﬁnite group G, then |H| divides |G|. Proof. First note that any the size of any coset gH is |H|: if h, h′ ∈ H, then gh = gh ′ =⇒ g−1gh = g−1gh ′ =⇒ h = h ′, hence for a ﬁxed g, all the products gh are distinct. Now we claim that any two distinct g1H and g2H are disjoint. For if they intersect, then for some h1, h2 ∈ H, we have g1h1 = g2h2. We can write any h ∈ H as h1h −1 1 h, so g1h1 = g2h2 =⇒ g1h = g1h1h −1 1 h = g2(h2h −1 1 h) ∈ g2H, 21 i.e., any element of g1H must be inside g2H also. But since the have the same size (|H|), we must have g1H = g2H, proving the claim. Hence the cosets {gH} partition G into disjoint subsets, all of size |H|. In particular there must be |G|/|H| cosets, which proves Lagrange’s theorem. Exercise 3.6. Let G = (Z/7Z)×. We represent the elements of G by 1, 2, . . . , 6. (i) Write down the multiplication table for G. (ii) Let H = {1, 6}. Show H is a subgroup of G. (It suﬃces to check H is closed under multiplication and each element of H has an inverse in H. In other words, you may use the ﬁrst lemma of the next section.) (iii) Determine the cosets of H in G. (iv) Repeat (ii) and (iii) for the set H = {1, 2, 4}. 3.4 Fermat’s little theorem A basic way to test is something is a subgroup is Lemma 3.9. If G is a group and H is a nonempty subset of G, then H is a subgroup of G if and only if it is closed under multiplication and taking inverses. Proof. (⇐) Suppose H is closed under multiplication and taking inverses. Being closed under multiplication implies that the multiplication on G restricts to a well deﬁned binary operation on H. Associativity holds because it does in G. If H is closed under inverses, then pick any h ∈ H so h−1 ∈ H. (Here is where we need H nonempty.) By closure under multiplication hh−1 = 1 ∈ H. This takes care of all 3 properties required to be a group. (⇒) If H is a group, it is closed under multiplication and inverses by deﬁnition. Note this is similar to the result in linear algebra that something is a subspace of a vector space if and only if it is closed under addition and scalar multiplication. Lemma 3.10. Let G be a ﬁnite group and a ∈ G. Then (i) there is some n ∈ N such that an = 1. (ii) Take the smallest such n, called the order of a. Then C = {a, a2, a3, · · · , , an} is a subgroup of G of order n. Proof. (i) Since G is ﬁnite, and ak ∈ G for all k ∈ N there must be some j, k ∈ N with j ̸= k such that aj = ak. Assume j < k and let n = k − j. Then ajan = ajak−j = ak = aj. Multiplying by (aj)−1, we see an = 1. (ii) Let n be the order of a, i.e., n ∈ N is the smallest such that an = 1. Then the argument in (i) shows we can’t have aj = ak for 1 ≤ j < k ≤ n—otherwise ak−j = 1 but k − j < n. Hence C has precisely n elements. By the previous lemma, to check it is a subgroup it suﬃces to check closure under multplication and inverses. Take any aj and ak in C (with 1 ≤ j, k ≤ n). If j + k ≤ n, ajak = aj+k ∈ C trivially; if j + k > n, we see ajak = aj+k = aj+k−nan = aj+k−n ∈ C since 1 ≤ j + k − n ≤ n. Hence C is closed under multplication. Note since an = 1, (an)−1 = 1 = an ∈ C. For any 1 ≤ j < n, we have 1 ≤ n − j < n. Then since ajan−j = an 22 The group C in this lemma is called the cyclic subgroup generated by a because it consists only of elements that are powers of a single element a. (It is called cyclic because these powers cyclically repeat: an = 1, an+1 = ana = a, an+2 = ana2 = a2, . . ..) Exercise 3.7. Check that the powers of a cyclically repeat in this example. (i) With the notation in the previous exercise (in (Z/7Z)×), compute 3k for 1 ≤ k ≤ 10. (ii) What is the cyclic subgroup of (Z/7Z)× generated by 3? What about generated by 2? Proposition 3.11. (Fermat’s little theorem) If p is prime and a ̸≡ 0 mod p, then ap−1 ≡ 1 mod p. Proof. We have seen that (Z/pZ)× is an abelian group of order p − 1. Let a ∈ (Z/pZ)×. Fermat’s little theorem is equivalent to the statement that ap−1 = 1. Let C be the cyclic subgroup of (Z/pZ)× generated by a. Now C has order n where n ∈ N is minimal such that an = 1. By Lagrange’s theorem, n = |C| divides p − 1 = |(Z/pZ)×|. Hence we can write p = 1 = mn for some m. Thus ap−1 = amn = (an)m = 1m = 1. Example. (Formula for inverses mod p) Suppose gcd(a, p) = 1. Then the inverse a−1 of a mod p is given by a−1 ≡ ap−2 mod p. Check: a−1a ≡ ap−2a ≡ ap−1 ≡ 1 mod p. Recall we saw in Section 1.5 that we can do exponentiation quickly. This means we can compute inverses mod p quickly this way. We also showed we can compute them quickly via the extended Euclidean algorithm in the last section. However that was an algorithm and not a formula. In general, it will be more convenient to use this explicit formula. Exercise 3.8. Use the formula a−1 ≡ ap−2 mod p to compute the inverse of 5 mod 11. (Do this computation by hand.) 3.5 Congruence theorems of Wilson and Lagrange Proposition 3.12. (Wilson’s theorem). Let p be prime. Then (p − 1)! ≡ −1 mod p. Proof. Note if p = 2 it is trivial since 1 ≡ −1 mod 2. Suppose p > 2. By the previous section, we know every 1 ≤ a ≤ p − 1 is invertible mod p. If x ≡ x−1 mod p, then x2 ≡ 1 mod p so x2 − 1 ≡ (x − 1)(x + 1) ≡ 0 mod p, i.e., p|(x − 1) or p|(x + 1). By the prime divisor property, this means x ≡ ±1 mod p. Hence the only (equivalence classes of) 1 ≤ a ≤ p − 1 which are their own inverses mod p are (the equivalence classes of) a = 1 and a = p − 1. Now we write (p − 1)! ≡ 1 · 2 · 3 · · · (p − 2)(p − 1) ≡ −2 · 3 · · · (p − 2) mod p. However each of the remaining factors 2, 3, . . . , p − 2 are invertible and none of them are their own inverses. Hence any factor above, e.g., 2, will cancel with its inverse, e.g., 2−1, in the product above. Exercise 3.9. Exercises 3.5.1, 3.5.2, 3.5.3. (Correction: 3.5.1 should say if n > 5 is not prime, show n|(n − 1)!) 23 Above, we proved the quadratic polynomial x2 − 1 has at most two solutions (up to equivalence) mod p, given by 1 and p − 1. These are distinct if and only if p > 2, which is why we separated the case p = 2 ﬁrst. This is similar to the fact that a polynomial of degree n has at most n solutions in Z (or Q or R or C). This is also true for Z/pZ. Proposition 3.13. (Lagrange) Let P (x) be a polynomial of degree n over Z and p be prime. Then P (x) ≡ 0 has at most n solutions mod p (i.e., in Z/pZ). Proof. If P (x) ≡ 0 mod p has no solutions we are done. Otherwise, let x = r be a solution and write P (x) = anxn + an−1xn−1 + · · · + a1x + a0. Then P (x) − P (r) ≡ an(xn − rn) + an−1(xn−1 − rn−1) + · · · a1(x − r) ≡ (x − r)Q(x) mod p for some polynomial Q(x) of degree n − 1. This is because we can factor out an (x − r) from any xj − rj to get a polynomial of degree j − 1 over Z. However, since x = r is a solution to P (x) ≡ 0 mod p, P (x) ≡ P (x) − P (r) ≡ (x − r)Q(x) mod p. So if x is any solution to P (x) ≡ 0 mod p, we have either p|(x − r) or p|Q(x) by the prime divisor property. Thus any solution not equivalent to r mod p, must be a solution of the degree n − 1 equation Q(x) ≡ 0 mod p. Hence the number of solutions to P (x) ≡ 0 mod p is one plus the number of solutions to Q(x) ≡ 0 mod p. Applying our argument for P (x) to Q(x), we can inductively reduce the problem down (i.e, use descent) to the case n = 1, where the result is trivial. It often happens that P (x) = 0 will have more solutions mod p than in Z Exercise 3.10. Let P (x) = x2 +1. Clearly P (x) = 0 is not solvable in Z. However P (x) ≡ 0 mod 5 is solvable mod 5. Determine all solutions. 3.6 Inverses mod k When k is not prime, not every non-zero class mod k is invertible. For example 2 is not invertible mod 4: it is immediate from the deﬁnition that 2k ≡ 0, 2 mod 4. Proposition 3.14. a is invertible mod k if and only if gcd(a, k) = 1. Proof. (⇒) a invertible mod k means ma ≡ 1 mod k for some m, i.e., ma ∈ kZ + 1, i.e., for some n, ma + nk = 1. Since any common divisor of a and k must then divide 1, gcd(a, k) = 1. (⇐). gcd(a, k) = 1 implies ma + nk = 1 for some m, n ∈ Z. Reducing this mod k gives ma ≡ 1 mod k. Example. (Z/8Z)× consists of (the classes of ) 1, 3, 5, 7. Note that every element is it’s own inverse, i.e., every element satisﬁes x2 = 1 (in contrast to the mod p case). Hence (Z/8Z)× is non-cyclic (not generated by the powers of a single element) abelian group of order 4. 24 Exercise 3.11. For 2 ≤ k ≤ 7 and k = 9, do the following. Write down the elements in (Z/kZ)× and state the order of the group. For each a ∈ (Z/kZ)×, ﬁnd the smallest n such that an = 1. Determine if (Z/kZ)× is cyclic or not. If it is cyclic, state an element that generates the group. Deﬁnition 3.15. The Euler phi function is ϕ(k) := # {1 ≤ a ≤ k − 1 : gcd(a, k) = 1} . Hence the proposition tells us |(Z/kZ)×| = ϕ(k). Many introductory number theory courses will spend a fair amount of time studying ϕ(k) and the structure of (Z/kZ). We will limit our study of ϕ(k) to the following. We already showed for p prime |(Z/pZ)×| = p − 1, so ϕ(p) = p − 1. Exercise 3.12. Show ϕ(pj) = pj−1(p − 1) for j ≥ 1. (Exercises 3.6.1, 3.6.2, 3.6.3.) Exercise 3.13. We will show in Chapter 9 that if m and n are relatively prime, then ϕ(mn) = ϕ(m)ϕ(n). Check this in the special cases (i) m = 3 and n = 5 (Exercise 3.6.4), and (ii) m = 2 and n is an odd prime. These two results show that we can determine ϕ(k) from its prime factorization. Example. ϕ(33 · 5) = 32(3 − 1)(5 − 1) = 9 · 8 = 72. Exercise 3.14. Determine ϕ(60). Proposition 3.16. (Euler’s theorem) For any invertible a mod k, we have aϕ(k) ≡ 1 mod k Exercise 3.15. Following the proof of Fermat’s little theorem, prove Euler’s theorem in the same way. 3.7 Quadratic Diophantine equations We can now use congruence arithmetic to say some things about non-existence of solutions of Diophanine equations. Example. x2 + y2 = p has no solution for p of the form 4n + 3. Example. x2 + 2y2 = p has no solution for p of the form 8n + 5 or 8n + 7. Example. x2 + 3y2 = p has no solution for p of the form 3n + 2. Though p was not necessarily prime in the examples above, we can reduce the question of which numbers are of the form x2 + y2, etc., to the question of which primes are. This is because (a 2 + b 2)(c 2 + d 2) = (ac + bd) 2 + (ad − bc) 2, i.e., if two numbers are sums of two squares, so is their product. On the other hand is much harder is to show, for example, that any prime of the form 4n + 1 is a sum of two squares, and one cannot do this with simple congruences. Exercise 3.16. Exercise 3.7.1. Exercise 3.17. Show that if p = x2 + 4y2, then p is of the form 4n or 4n + 1. Exercise 3.18. Using congruences, prove that k3 + 2k is always divisible by 3. Exercise 3.19. Show that if p = x3 + y3, then p is not of the form 9n + 4 or 9n + 5. 25 3.8 *Primitive roots Note that 1/3 = 0.3333 · · · 1/7 = 0.142857 142857 · · · 1/13 = 0.076923 076293 · · · These are all periodic, with period lengths 1, 6, 6. Proposition 3.17. The decimal expansion of x ∈ R is periodic if and only if x ∈ Q. The proof is not diﬃcult but we will omit it. Note the expansion 1/2 = 0.5 is considered periodic with period length 1 because after the 5, it repeats with zeroes: 1/2 = 0.50000000 . . .. Deﬁnition 3.18. Suppose we have the decimal expansion 1/n = 0.a1a2a3 · · · ar. Then 1/n is called strictly periodic. The smallest such r is called the period length. Note 1/n is not always strictly periodic: 1/2 = 0.50 and 1/6 = 0.16. From now on, assume 1/n is strictly periodic. Proposition 3.19. If 1/n is strictly periodic with period length r, then 10 has order r in (Z/nZ)×. Proof. Write 1/n = 0.a1a2a3 · · · ar. Then 10r/n−1/n = a1a2 · · · ar ∈ Z which implies that 10r −1 ∈ nZ, i.e., 10r ≡ 1 mod n. Note 10 cannot have order less than r, or else the period of 1/n would be smaller. Note that this implies the period r ≤ ϕ(n). If r = ϕ(n) we say 1/n has maximal period length. Deﬁnition 3.20. We say a is a primitive root mod n if a generates (Z/nZ)×, i.e., (Z/nZ)× ={aj}. Equivalently, a is a primitive root mod n if the order of a in (Z/nZ)× is ϕ(n). Hence 1/n has maximal period length if and only if 10 is a primitive root mod n. Conjecture 3.21. (Gauss) There are inﬁnitely many primes such that 1/p has maximal period length. Still unknown! Exercise 3.20. Without dividing, determine the period length of 1/11. (For p > 5, we have gcd(p, 10) = 1, and one can show 1/p will be strictly periodic, so you may use the above propo- sition.) Check what the decimal expansion is on a calculator. 3.9 *Existence of primitive roots Let p be prime. Lemma 3.22. There are at most ϕ(n) elements of (Z/pZ)× of order n. 26 Proof. Suppose a ∈ (Z/pZ)× has order n. Then 1, a, a2, . . . an−1 are n distinct solutions to xn ≡ 1 mod p. By the theorem of Lagrange in Section 3.5, there are at most n solutions to this equation, so 1, a, a2, . . . an−1 are all of them. On the other hand, if gcd(j, n) = d > 1, then j(n/d) = kn for some k. Hence (aj) (n/d) ≡ a kn ≡ (an) k ≡ 1 mod p, i.e., aj has order n/d < n. In other words, aj only has order n if gcd(j, n) = 1. Lemma 3.23. ∑ d|N ϕ(d) = N . Proof. Write 1 N , 2 N , · · · , N N in reduced form, e.g., 1 6 , 2 6 , 3 6 , 4 6 , 5 6 , 6 6 −→ 1 6 , 1 3 , 1 2 , 2 3 , 5 6 , 1. Note that we will a reduced form a d with denominator d precisely ϕ(d) times. Thus counting this set in two ways give the result. Theorem 3.24. There is a primitive root mod p. Proof. By Fermat’s little theorem, ap−1 ≡ 1 mod p for any 1 ≤ a ≤ p − 1. Hence each a has order d for some d|p − 1. Thus the number of 1 ≤ a ≤ p − 1 with order less than p − 1 is ∑ d|p−1d<p−1 ϕ(d) = p − 1 − ϕ(p − 1) < p − 1. Hence some element has order p − 1 mod p, i.e., is a primitive root. 3.10 Discussion Read it if you want to. 4 RSA One important practical application to the material of the last chapter is the RSA cryptosystem. Last night: Bob ﬁnds two big primes p and q walking down the street, and multiplies them together: n = pq (blam!) He picks a random number e up at a bar, and posts e and n on his blog when he gets home. ννν playa: Alice wants to send Bob a smokin’ email m, without the ﬁnk sys admin Eve being able to read it. So she checks Bob’s webpage, sees e and n, and sends him a cipha’ c ≡ me mod n (blam! blam!) 27 Back in the crib: Since Bob is tight with p and q, he knows ϕ(n) = ϕ(p)ϕ(q) = (p − 1)(q − 1), and therefore d ≡ e−1 mod ϕ(n). So we he get’s Alice’s messsage, he’s just like, whoa, I know what Alice is sayin’: c d ≡ m ed ≡ m kϕ(n)+1 ≡ m mod n (blam! blam! blam!) Computer lab: Eve is hatin’ on Alice ’n Bob ’cuz she don’t know her p’s and q’s, so she don’t know ϕ(n) or m. 28","libVersion":"0.3.1","langs":""}
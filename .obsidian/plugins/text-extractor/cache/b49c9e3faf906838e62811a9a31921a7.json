{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Euler's trick Diophantines.pdf","text":"EULER’S TRICK AND SECOND 2-DESCENTS FRANZ LEMMERMEYER, ¨ONC ¨UL ¨OZT ¨UR ¨UN 1. Introduction The ﬁrst counterexamples to the Hasse principle for curves of genus 1 were con- structed independently by Lind [8] and Reichardt [9]. In his survey [2, p. 206], Cassels proves Reichardt’s result using a technique that “was suggested by unpub- lished work of Mordell”. Cassels starts with Reichardt’s equation (1) X 4 − 17Y 4 = 2Z 2, which is easily seen to have nontrivial solutions in every completion Qp of Q, in- cluding Q∞ = R (see [1] for a proof using only elementary number theory). Now assume that (1) has a nontrivial solution in rational numbers. Clearing denominators we may assume that X, Y, Z are nonzero integers with gcd(X, Y ) = gcd(X, Z) = gcd(Y, Z) = 1. Now we write (1) in the form (2) (5X 2 + 17Y 2) 2 − (4Z) 2 = 17(X 2 + 5Y 2) 2. Since the left hand side is a diﬀerence of squares, it can be factored, and it is easily checked that gcd(5X 2 + 17Y 2 − 4Z, 5X 2 + 17Y 2 + 4Z) is a square or twice a square. Thus there exist nonzero integers U, V such that 5X 2 + 17Y 2 ± 4Z = 17U 2, 5X 2 + 17Y 2 ∓ 4Z = V 2, X 2 + 5Y 2 = U V, or 5X 2 + 17Y 2 ± 4Z = 34U 2, 5X 2 + 17Y 2 ∓ 4Z = 2V 2, X 2 + 5Y 2 = 2U V. Eliminating Z from the ﬁrst two equations gives the systems 10X 2 + 34Y 2 = 17U 2 + V 2, X 2 + 5Y 2 = U V, or 5X 2 + 17Y 2 = 17U 2 + V 2, X 2 + 5Y 2 = 2U V. But since (5/17) = (10/17) = −1, none of these two systems of equations has a nonzero integral solution. 1 2 FRANZ LEMMERMEYER, ¨ONC ¨UL ¨OZT ¨UR ¨UN In modern language, quartics of genus 1 like (1) that have nontrivial points in every completion Qp but not in Q represent elements of order 2 in the Tate- Shafarevich group of their Jacobian. In his book [10, p. 317], Silverman uses this idea to study the curve Z 2 + 4Y 4 = pX 4 for primes p = a 2 + b2 ≡ 1 mod 8 and says that it is “a simple matter to verify the identity” (3) (pX 2 + 2bY 2) 2 − a 2Z 2 = p(bX 2 + 2Y 2) 2. Where do these factorizations come from? And for which type of equations do they exist? Cassels [2] mentions that Mordell considered equations f (x 2, y2, z), where f (X, Y, Z) is a quadratic form representing 0, but does not give more details. In this article we will present a method for factoring quartics of the form aX 4 + bY 4 = cZ 2 with local solutions everywhere; its main idea can be traced back to Euler, and probably is very close to Mordell’s unpublished work. We will show that Euler’s trick can be used to construct counterexamples to the Hasse principle using only elementary number theory; in previous articles (see e.g. [5, 6, 7]), techniques from algebraic number theory were used. We also remark that this method could very well have been used by P´epin, although there is no evidence that he did. 2. Euler’s Trick A simple way of deriving formulas giving Pythagorean triples is the following: write x 2 + y2 = z2 in the form y2 = z2 − x 2 = (z + x)(z − x) and then use unique factorization. This method does not seem to work for simple equations like x 2 + y2 = 2z2; Euler [3], however, saw that in this case multiplication by 2 saves the day because (2z) 2 = 2x 2 + 2y2 = (x + y) 2 + (x − y) 2, hence (2z − x − y)(2z + x + y) = (x − y) 2, and now the solution proceeds exactly as for Pythagorean triples. Remarks in his Algebra [4, art. 181] show that Euler was aware that this trick always works for conics aX 2 + bY 2 = cZ 2 with a nontrivial rational point: So oft es aber m¨oglich ist, [die Form ax 2 + cy2 zu einem Quadrat zu machen,] kann diese Form in eine andere verwandelt werden, in welcher a = 1 ist. Es kann z.B. die Form 2p2 − q2 zu einem Quadrat werden, sie l¨aßt sich aber auch in solcher Art darstellen: (2p + q) 2 − 2(p + q) 2. In fact, consider the conic AX 2 + BY 2 = CZ 2 and assume that it has a rational solution. First, multiplying through by A shows that it is suﬃcient to consider equations X 2 + aY 2 = bZ 2. Assume that (x, y, z) is a solution of this equation. Then (bzZ) 2 = bz2X 2 + abz2Y 2 = (x 2 + ay2)X 2 + (ax 2 + a 2y2)Y 2 = (xX + ayY ) 2 + a(xY − yX) 2; Similarly, (ayY ) 2 = aby2Z 2 − ay2X 2 = b(bz2 − x 2)Z 2 − (bz2 − x 2)X 2 = (xX + bzZ) 2 − b(xZ + zX) 2, EULER’S TRICK AND SECOND 2-DESCENTS 3 or even (xX) 2 = bx 2Z 2 − ax 2Y 2 = b(bz2 − ay2)Z 2 − a(bz2 − ay2)Y 2 = (bzZ + ayY ) 2 − ab(yZ + zY ) 2. Euler’s trick provides us with three diﬀerent factorizations of the form AB = mC 2; we have collected them in the following table: A B C m I bzZ + ayY + xX bzZ − ayY − xX xY − yX a II bzZ + ayY + xX bzZ − ayY + xX xZ + zX b III bzZ + ayY + xX bzZ + ayY − xX yZ + zY ab Table 1. Factorizations AB = mC 2 derived from Euler’s Trick In Euler’s example y2 + z2 = 2x 2 we have (x, zy, z, a, b) = (1, 1, 1, 1, 2), and the third factorization gives z2 = (2x + y) 2 − 2(x + y) 2. 3. Bounding the GCD For applying unique factorization we have to determine the greatest common divisor of the factors A and B in Table 2. First observe that we may assume that a and b are squarefree since we can subsume squares into Y 2 or Z 2. Lemma 1. Assume that a and b are squarefree. If C : X 2 + aY 2 = bZ 2 has a nontrivial solution (x, y, z), then it has an integral point (X, Y, Z) with gcd(X, Y ) = gcd(X, Z) = gcd(Y, Z) = 1. Proof. Multiplying through by the square of the gcd’s of a nontrivial solution we may clearly assume that there is an integral solution. Put d = gcd(X, Y ). Then d2 | bZ 2, and since b is squarefree, we easily conclude that d | Z. □ For bounding d = gcd(A, B) we need to make several assumptions: we will assume that gcd(Y, Z) = 1, which we are allowed to do by Lemma 1; we will call a solution (X, Y, Z) primitive if gcd(X, Y ) = gcd(Y, Z) = gcd(Z, X) = 1. By the same reason we may assume that (x, y, z) is primitive. The gcd of the two factors is then described by the following Theorem 2. Assume that (x, y, z) is a primitive solution of C : X 2 + aY 2 = bZ 2, where a and b are coprime and squarefree integers. Then for any primitive solution (X, Y, Z) of C, we have gcd(A, B) = δu2, where δ and u are integers satisfy the following conditions: I δ | 2b u | gcd(z, Z) II δ | 2a u | gcd(y, Y ) III δ | 2 u | gcd(x, X) Proof. The proofs for the three cases are completely analogous; thus it will be suﬃcient to give the proof only for case I. 4 FRANZ LEMMERMEYER, ¨ONC ¨UL ¨OZT ¨UR ¨UN In this case we clearly have d | (A + B) = 2bzZ, d | (A − B) = 2(ayY + xX), d2 | AB = a(yX − xY ) 2. Since a is squarefree, the last relation shows that d2 | (yX − xY ) 2, hence d | (yX −xY ). Now d | 2x(ayY +xX) and d | 2ay(yX −xY ) implies d | 2(x 2 +ay2)X = 2bz2X. Together with d | 2bzZ this implies d | 2 gcd(bz2X, bzZ) = 2bz gcd(z, Z) | 2bz2. From bZ 2 = X 2 + aY 2 we get bx 2Z 2 = x 2X 2 + ax 2Y 2 = (bz2 − ay2)X 2 + ax 2Y 2, hence (4) b(x 2Z 2 − z2X 2) = a(xY − yX)(xY + yX). Multiplying through by 2 we see that d | 2bx 2Z 2. Thus d | gcd(2bz2, 2bx 2Z 2) = 2b gcd(z2, x 2Z 2) = 2b(z, Z) 2. We now claim that d is a divisor of 2b times a square. We know that d | 2b gcd(z, Z) 2. Now write gcd(d, z, Z) = 2jβu, where u is the maximal odd divisor of d coprime to b. From u2 | z2, u2 | Z 2 and (4) we get u2 | a(xY − yX)(xY + yX). Next observe that gcd(z, Z) is coprime to a: in fact, if q is a prime divid- ing gcd(a, z), then q | x 2, hence q | z, and this contradicts the assumption that gcd(x, z) = 1. Thus we have u2 | (xY − yX)(xY + yX). Now we claim that no prime q | u divides the ﬁrst factor. Otherwise q would divide both factors, hence xY and yX. Since q | z we have q ∤ xy, hence q | X and q | Y : contradiction. This implies that u2 | (zY + yZ). But then u2 | d | 2 gcd(d, x, X) 2 = 2 j+1βu2. This implies the claim. □ The bounds for the gcd’s given at the end of Theorem 2 are best possible: they are attained for (X, Y, Z) = (x, y, −z). 4. Unique Factorization Consider the ﬁrst factorization AB = mC 2, where A = bzZ + ayY + xX, B = bzZ − ayY − xX, C = xY − yX, and m = a; then gcd(A, B) = βu2 for some β | 2b. Unique Factorization then gives the system of equations bzZ + ayY + xX = αβr2, bzZ − ayY − xX = α′βs2, xY − yX = βrs, where αα′ = a. Let us now consider P´epin’s examples. His quartics all have the form pX 4 − mY 4 = Z 2; the rational solution (α, b, α2a + βb) of the underlying conic x 2 + my2 = pz2 gives rise to the Euler factorizations = Eliminating Z gives 2(ayY + xX) = β(αr2 − α′s 2), xY − yX = βrs, EULER’S TRICK AND SECOND 2-DESCENTS 5 Eliminating X ﬁnally gives the equation 2bz2Y = β(αr2 − α′s 2 − 2xrs) 5. Silverman’s example We have X 2 +4Y 4 = pZ 4. The conic underlying Silverman’s example is ξ2 +η2 = pζ 2, where we have set ξ = X, η = 2Y 2 and ζ = Z 2. Here a = 1, b = p, and with p = c 2 + d2 we get the solution (x, y, z) = (c, d, 1). Euler’s factorizations are given by (pζ + cξ + dη)(pζ − cξ − dη) = (dξ − cη) 2, (cξ + pζ + dη)(cξ + pζ − dη) = p(cζ + ξ) 2, (pζ + dη + cξ)(pζ + dη − cξ) = p(dζ + η) 2. Introducing the original variables again, the third factorization gives p(dZ 2 + 2Y 2) 2 = (pZ 2 + 2dY 2 + cX)(pZ 2 + 2dY 2 − cX). Assuming that (X, Y, Z) is primitive, Theorem 2 tells us that gcd(pZ 2 + 2dY 2 + cX, pZ 2 +2dY 2 −cX) = 2je 2 for some odd integer e (note that z = 1 here). Unique factorization then implies (replacing Z by −Z if necessary) pZ 2 + 2dY 2 + cX = δpu2, pZ 2 + 2dY 2 − cX = δv2, dZ 2 + 2Y 2 = δuv, where δ ∈ {1, 2}. Eliminating X yields the pair of equations 2pZ 2 + 4dY 2 = δ(v2 + pu2), dZ 2 + 2Y 2 = δuv. Now we distinguish two cases: (1) δ = 1: reducing the equations modulo 8 and using 4 | d we ﬁnd 2Z 2 ≡ u2 + v2 mod 8. This implies u ≡ v mod 2, and the second equation shows that uv is even. Thus both u and v are even, and then the ﬁrst equation shows that 2 | Z, the second that 2 | Y : contradiction. (2) δ = 2: then we ﬁnd Z 2 ≡ u2 + v2 mod 8. If Z is even, then both u and v must be even, and then the second equation implies that Y is also even, which again contradicts (Y, Z) = 1. Thus Z is odd, hence one of u, v is odd and the other is divisible by 4 (because of v2 ≡ X 2 − u2 ≡ 0 mod 8). But then Y must be even, and the second equation gives d ≡ 0 mod 8. We have proved: Theorem 3. If the diophantine equation X 2 + 4Y 4 = pZ 4, where p = c 2 + d2 ≡ 1 mod 8 is a prime, has a nontrivial solution, then d ≡ 0 mod 8. 6. P´epin’s Results In [5], the theorem below was proved (under the additional assumption that α be prime) using genus theory; here we will show how Euler’s trick can be used to give an elementary proof. 6 FRANZ LEMMERMEYER, ¨ONC ¨UL ¨OZT ¨UR ¨UN Theorem 4. Let a, b, α, β, γ be integers such that p = α2a 2 + 2βab + γb2 is an odd prime. Then the conic X 2 + mY 2 = pZ 2, where m = α2γ − β2, has the integral point (α2a + βb, b, α). If, in addition, m ≡ 1 mod 8 is a prime and α ≡ 3 mod 4, then the equation (5) px 4 − my2 = z2 does not have any nontrivial rational solutions. 6.1. Preliminaries. We now prove a few simple properties that we will use later on: If we put z = X, y = Y and x 2 = Z, then (5) becomes (6) X 2 + mY 2 = pZ 2. Lemma 5. If m ≡ 1 mod 4, then any nontrivial solution of (6) with gcd(X, Y ) = 1satisﬁes Z ≡ 1 mod 2, and we have p ≡ 1 mod 4. Proof. If 2 | Z, then X ≡ Y mod 2, and since gcd(X, Y ) = 1 both X and Y are both odd. But then we ﬁnd the contradiction 0 ≡ pZ 2 ≡ X 2 + mY 2 ≡ 2 mod 4. Now px 4 ≡ my2 + z2 ≡ y2 + z2 mod 4 implies p ≡ 1 mod 4. □ 6.2. Euler’s Trick. We start with the factorization (7) m((α2a + βb)Y − bX) 2 = (pα2Z) 2 − ((α2a + βb)X + mbY ) 2. Now we put A = pαZ − X(α2a + βb) − mbY, B = pαZ + X(α2a + βb) + mbY, C = (α2a + βb)Y − bX and get AB = mC 2. 6.3. Unique Factorization. Since a = m and b = p, Theorem 2 shows gcd(A, B) = δu2 for some integer δ | 2p. Since AB = mC 2 for a prime m and gcd(A, B) = δu2, there exist r, s ∈ Z such that A = δr2, B = δms 2 or A = δmr2 and B = δs2. Since changing the signs of X and Y corresponds to switching A and B, we may assume that we have A = δr2 and B = δms 2. Note that since A + B = 2pαZ > 0 (since Z is a square) and AB = mC 2 > 0, we must have A, B > 0. Now consider the following cases: (1) δ ≡ 1 mod 4, i.e., δ ∈ {1, p}. Here 2pαZ = A+B = δ(r2 +ms 2). Now r and s must have the same parity; if they are both even, then Z is divisible by 4; therefore we may divide the equation 2pαZ = A+B = δ(r2 +ms 2) through by powers of 2 until both r and s are odd. But then pαZ ≡ 1 mod 4, hence Z ≡ 3 mod 4, hence Z cannot be a square. (2) δ ≡ 2 mod 4, i.e., δ ∈ {2, 2p}. Here pαZ = 1 2 (A + B) = δ′(r2 + ms 2) with δ′ ∈ {1, p}. As above we get Z ≡ 3 mod 4, and again Z cannot be a square. The only place where we have used the primality of m was in the last subsection. If m ≡ 1 mod 8 is a product of primes ≡ 1 mod 4, then we get the equations A = δµr2, B = δνs 2 with µν = m. Again we have to consider the following cases: EULER’S TRICK AND SECOND 2-DESCENTS 7 (1) δ ≡ 1 mod 4, i.e., δ ∈ {1, p}. Then 2pαZ = A + B = δ(µr2 + νs 2); now r and s must have the same parity, and since we know that their gcd is odd, we must have r ≡ s ≡ 1 mod 2. This implies pαZ ≡ 1 2 µ + ν ≡ 1 mod 4 (note that µ, ν ≡ 1 mod 4 and µν ≡ 1 mod 8 imply that µ + ν ≡ 2 mod 8), hence Z ≡ 3 mod 4, and Z cannot be a square. (2) δ ≡ 2 mod 4, i.e., δ ∈ {2, 2p}. Here pαZ = 1 2 (A + B) = δ′(µr2 + νs 2) with δ′ ∈ {1, p}. As above we get Z ≡ 3 mod 4, and again Z cannot be a square. The following examples were claims made by P´epin: α β γ m p 3 1 2 17 9a 2 + 2ab + 2b2 3 2 5 41 9a 2 + 4ab + 5b2 3 5 10 65 9a 2 + 10ab + 10b2 3 7 14 77 9a 2 + 14ab + 14b2 7 1 2 97 49a 2 + 2ab + 2b2 The example m = 77 is not covered by Theorem 4. We leave it to the reader to prove the following result: Proposition 6. Assume that m = pq ≡ 1 mod 8 for primes p ≡ 7 mod 8 and q ≡ 3 mod 8 such that (α/p) = −1. Then the equation does not have a nontrivial rational solution. References [1] W. Aitken, F. Lemmermeyer, Quartics of genus 1, preprint [2] J.W.S. Cassels, Diophantine Equations with special reference to elliptic curves, J. London Math. Soc. 41 (1966), 193–291 [3] L. Euler, Theorematum quorundam arithmeticorum demonstrationes, Comm. Acad. Sci. Petrop. 10 (1738) 1747, 125–146; Opera Omnia Ser. I vol. II, Commentationes Arithmeticae, 38–58 [4] L. Euler, Vollst¨andige Anleitung zur Algebra, Petersburg 1770; Russ. Transl. Petersburg 1768/69 [5] F. Lemmermeyer, A note on P´epin’s counter examples to the Hasse principle for curves of genus 1, Abh. Math. Sem. Hamburg 69 (1999), 335–345 [6] F. Lemmermeyer, On Tate-Shafarevich groups of some elliptic curves, Proc. Conf. Graz 1998, (2000), 277–291 [7] F. Lemmermeyer, Some families of non-congruent numbers, Acta Arith. 110 (2003), 15–36 [8] C.E. Lind, Untersuchungen ¨uber die rationalen Punkte der ebenen kubischen Kurven vom Geschlecht eins, Ph.D. thesis Uppsala 1940 [9] H. Reichardt, Einige im Kleinen ¨uberall l¨osbare, im Grossen unl¨osbare diophantische Glei- chungen, J. Reine Angew. Math. 184 (1942), 12–18 [10] J. Silverman, The arithmetic of elliptic curves, Springer-Verlag 1986","libVersion":"0.3.1","langs":""}
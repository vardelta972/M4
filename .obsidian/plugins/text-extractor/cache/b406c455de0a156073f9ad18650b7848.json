{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Franz/Algebraic NT/ch5.pdf","text":"Chapter 5 Diophantine Equations In this chapter, we will give a couple of applications of the number theory we have developed so far: • the solution of the diophantine equation x 2 + y2 = z2 (Pythagorean triples), • Fermat’s Last Theorem for the exponent 4; • and the theorem of Girard 1- Fermat2 that primes of the form 4n + 1 are sums of two squares. 5.1 Fermat’s Last Theorem for Exponent 4 The solution of x 2 + y2 = z2 will help us prove that the diophantine equation X 4 + Y 4 = Z 4 (5.1) has only trivial solutions, namely those with X = 0 or Y = 0. As a matter of fact, it is a lot easier to prove more, namely that X 4 + Y 4 = Z 2 (5.2) has only trivial solutions (this is more: if X 4 + Y 4 cannot be a square, it cannot be a fourth power). The proof is quite involved and uses a technique that Fermat called inﬁnite descent. In a nutshell, the idea behind inﬁnite descent is the following: if we want to prove that a certain diophantine equation is impossible in N, it is suﬃcient to show that for every solution in natural numbers there is another solution that is “smaller”, which eventually leads to a contradiction because there is no natural number smaller than 1. Here are some simple examples: 1Albert Girard (?), 1595 (St Mihiel, France)– 1632 (Leiden, Netherlands) 2Pi`erre de Fermat, ca. 1607 (Beaumont-de-Lomagne, near Toulouse, France)–1665 (Cas- tres, France) 44 Proposition 5.1. The diophantine equation x 2 + y2 = 3z2 does not have solu- tions in natural numbers. Proof. Assume there are natural numbers x, y, z > 0 such that x 2 + y2 = 3z2. Then x 2 + y2 ≡ 0 (mod 3). The following table gives the congruence class of x 2 + y2 modulo 3 in terms of x and y: 0 1 2 0 0 1 1 1 1 2 2 2 1 2 2 Note that, since 22 ≡ 12 mod 3, the last row and column were actually su- perﬂuous. What this table is showing is that if x 2 + y2 ≡ 0 mod 3, then x ≡ y ≡ 0 mod 3. A quicker way of seeing this is provided by the following argument: if 3 ∤ y, then x 2 + y2 ≡ 0 mod 3 implies (x/y) 2 ≡ −1 mod 3, contra- dicting the fact that −1 is not a square modulo 3. Thus x = 3x1 and y = 3y1 for natural numbers x1, y1. Now 3z2 = x 2 + y2 = 9x 2 1 +9y2 1 implies z2 = 3(x 2 1 +y2 1); since the right hand side is divisible by 3, so is the left hand side: z = 3z1 for some integer z1 > 0. But then 9z2 1 = 3(x 2 1 + y2 1), that is, x 2 1 + y2 1 = 3z2 1. We have shown: given any solution (x, y, z) in natural numbers of the equa- tion x 2 + y2 = 3z2, there is another solution (x1, y1, z1) in natural numbers with z1 = z/3. Repeating this argument gives yet another solution (x2, y2, z2) in natural numbers with z2 = z1/3 = z/9. Eventually, this will produce a contradiction because natural numbers cannot decrease indeﬁnitely. Proposition 5.2. The equation x 3 + 3y3 + 9z3 = 0 does not have any solutions in positive integers. Proof. Assume that (x, y, z) is a solution in positive integers. Clearly x is divisi- ble by 3, so x = 3x1 for some positive integer x1. But then 27x 3 1 + 3y3 + 9z3 = 0, hence 9x 3 1 + y3 + 3z3 = 0. Now y = 3y1, and we ﬁnd 3x 3 1 + 9y3 1 + z3 = 0. Finally, z = 3z1 for some positive integer z1, and x 3 1 + 3y3 1 + 9z3 1 = 0. Thus if (x, y, z) is a solution of the equation x 3 + 3y3 + 9z3 = 0 in positive integers, then so is ( x 3 , y 3 , z 3 ). Repeating this argument we ﬁnd that for every positive solution there is a smaller solution in positive integers: but this is nonsense, thus there is no solution in positive integers. Proposition 5.3. The number √2 is irrational. Proof. Assume not. Then √2 = m n for positive integers m, n, and squaring yields 2n2 = m 2. Thus m = 2p is even, and we ﬁnd n2 = 2p2. This shows that n = 2q for some positive integer q, hence 2q2 = p2. Thus if √2 = m n , then √2 = p q with integers p = m 2 and q = n 2 . Repeating this suﬃciently often leads to a contradiction since no positive integer is divisible by 2 inﬁnitely often. Fermat used this idea to give a proof of 45 Theorem 5.4. The Fermat equation (5.2) for the exponent 4 does not have any integral solution with XY Z ̸= 0. Proof. Assume that X, Y, Z ∈ N \\ {0} satisfy (5.2); we may (and will) assume that these integers are pairwise coprime (otherwise we can cancel common di- visors). Now we vaguely follow our solution of the Pythagorean equation: Z must be odd (if Z were even, then X and Y would have to be odd, and we get a contradiction as in the proof of Theorem 5.13). Thus we may assume that X is odd and Y is even. Since (X 2, Y 2, Z) is a Pythagorean Triple, there exist integers m, n such that X 2 = m 2−n2, Y 2 = 2mn and Z = m 2 + n2. Clearly gcd(m, n) divides both X and Y , hence m and n are coprime; moreover, since X is odd, we have 1 ≡ X 2 = m2 − n2 mod 4, which implies that m is odd and n = 2k is even. Thus (Y /2) 2 = mk with m and k coprime, hence m = a 2 and k = b2, giving X 2 = a 4 − 4b4. Now we repeat the trick: from X 2 + 4b4 = a 4 we see that (X, 2b2, a2) is a Pythagorean triple; thus X = m2 1 − n2 1, 2b2 = 2m1n1 and a 2 = m 2 1 + n2 1, where m1 and n1 are (necessarily coprime) positive integers. From m1n1 = b2 we deduce that m1 = r2 and n1 = s 2, hence a 2 = r4 + s 4, and we have found a new solution (a, r, s) to our equation Z 2 = X 4 + Y 4. Since Z = m 2 + n2 = a 4 + 4b4, we ﬁnd that 0 < a < Z; this means that for every solution (X, Y, Z) in natural numbers there exists another solution with a smaller Z. This is impossible, so there can’t be a nontrivial solution to the Fermat equation in the ﬁrst place. 5.2 Fermat’s Two-Squares Theorem A well known theorem ﬁrst stated by Girard, and probably ﬁrst proved by Fermat (the ﬁrst known proof is due to Euler) concerns primes that are sums of two squares, such as 5 = 12 + 22 or 29 = 2 2 + 52. The following characterization of such primes is a simple consequence of the notion of congruences; the converse is also true, but much harder to prove. Proposition 5.5. If a prime p is the sum of two integral squares, then p = 2 or p ≡ 1 mod 4. Proof. There are 4 residue classes modulo 4; their squares are [0] = [0] 2 and [1] = [1] 2, and in fact the squares [2] 2 = [0] and [3] 2 = [1] of the remaining classes don’t produce new ones. Now assume that p = a 2 + b2. Since a 2, b2 ≡ 0, 1 mod 4, we ﬁnd that a 2 + b2 must be congruent modulo 4 to one of 0 = 0 + 0, 1 = 1 + 0 = 0 + 1, or 2 = 1 + 1, that is, p ≡ 0, 1, 2 mod 4. Since no prime is congruent to 0 mod 4, and since 2 is the only prime ≡ 2 mod 4, we even have p = 2 or p ≡ 1 mod 4 as claimed. For the converse, we need to know when [−1] is a square in Z/pZ for primes p. Experiments show that [−1] is not a square modulo 3, 7, or 11, and that [2] 2 = [−1] for p = 5, and [5] 2 = [−1] for p = 13. The general result is 46 Proposition 5.6. Let p ≡ 1 mod 4 be prime; then the congruence a 2 ≡ −1 mod p has a solution. For the proof, we need some auxiliary results. Proposition 5.7 (Wilson’s Theorem). For p > 1, we have (p − 1)! ≡ −1 mod p if and only if p is a prime. Proof. Let p be a prime; the claim is trivial if p = 2, so assume that p is odd. The idea is to look at pairs of the elements of (Z/pZ) ×. In fact, for every a ∈ (Z/pZ) × there is an element a −1 ∈ (Z/pZ) × such that a · a −1 ≡ 1 mod p. In general, [a] and [a −1] are diﬀerent: [a] = [a −1] implies [a 2] = [1], so this can only happen (and does in fact happen) if [a] = [1] or [a] = [−1] = [p − 1] (here we use that Z/pZ is a ﬁeld; in ﬁelds, polynomials of degree 2 such as x 2 − 1 have at most 2 roots). Thus (Z/pZ) × \\{[−1], [+1]} is the union of pairs {[a], [a −1]} with [a] ̸= [a −1], hence the product over all elements of (Z/pZ) × \\ {[−1], [+1]} must be [1]. We can get [(p − 1)!] by multiplying this product with the two missing classes [1] and [−1], and this gives the claimed result [(p − 1)!] = [−1]. We still have to prove the converse: assume that (n − 1)! ≡ −1 mod n; if p is a prime divisor of n, this congruence implies (n − 1)! ≡ −1 mod p. But p < n also implies that p occurs as a factor of (n − 1)! on the left hand side, hence we would have 0 ≡ (n − 1)! mod p. But then 0 ≡ −1 mod p, a contradiction. Note that Wilson’s theorem provides us with a primality test; unfortunately the only known way to compute (n − 1)! is via n − 2 multiplications, so it takes even longer than trial division! Proposition 5.8. Let p be an odd prime and put a = ( p−1 2 )!; then we have a 2 ≡ (−1) (p+1)/2 mod p. In particular, a ≡ ±1 mod p if p ≡ 3 mod 4, and a 2 ≡ −1 mod p if p ≡ 1 mod 4. Proof. We start with Wilson’s theorem (p − 1)! ≡ −1 mod p; if, in the product (p − 1)!, we replace the elements p+1 2 , p+3 2 , . . . , p − 1 by their negatives − p+1 2 ≡ p−1 2 , − p+3 2 ≡ p−3 2 , . . . , −(p − 1) ≡ 1 mod p, then we have introduced exactly p−1 2 factors −1; thus (p − 1)! ≡ (−1) (p−1)/2a 2 mod p with a = ( p−1 2 )!). This proved the claim. Now we can prove Proposition 5.6: if p ≡ 1 mod 4, then we have just con- structed a solution of the congruence a 2 ≡ −1 mod p. The converse is also true: if p is an odd prime such that a 2 ≡ −1 mod p has a solution, then p must be ≡ 1 mod 4. This will follow from Fermat’s Little Theorem. The solvability of x 2 ≡ −1 mod p is the ﬁrst of two steps in our proof of the Theorem of Girard-Fermat; the second one is a result due to Birkhoﬀ, rediscovered by Aubry, and named after Thue: Proposition 5.9. Given an integer a not divisible by p, there exist x, y ∈ Z with 0 < |x|, |y| < √p such that ay ≡ x mod p. 47 Proof. Let f be the smallest integer greater than √p, and consider the residue classes {[u + av] : 0 ≤ u, v < f } modulo p. There are f 2 > p such expressions, but only p diﬀerent residue classes, hence there must exist u, u′, v, v′ such that u + av ≡ u′ + av′ mod p. Put x = u − u′ and y = v′ − v; then x ≡ ay mod p, and moreover −f < x, y < f . Now we can prove Theorem 5.10 (Girard-Fermat-Euler). Every prime p ≡ 1 mod 4 is a sum of two integral squares. Proof. Since p ≡ 1 mod 4, there is an a ∈ Z such that a 2 ≡ −1 mod 4. By Thue’s result, there are integers x and y such that ay ≡ x mod p and 0 < x, y < √p. Squaring gives −y2 ≡ x 2 mod p, that is, x 2 + y2 ≡ 0 mod p. Since 0 < x 2, y2 < p, we ﬁnd 0 < x 2 + y2 < 2p; since x 2 + y2 is divisible by p, we must have x 2 + y2 = p. 5.3 Quadratic Equations Next we will apply the Unique Factorization Theorem to the solution of the diophantine equation x 2 + y2 = z2 in integers x, y, z ∈ Z. Such triples of solutions are called Pythagorean 3 triples. The most famous of these triples is of course (3, 4, 5). It is quite easy to give formulas for producing such triples: for example, take x = 2mn, y = m2 − n2 and z = m 2 + n2 (special cases were known to the Babylonians, the general case occurs in Euclid). It is less straightforward to verify that there are no other solutions (this was ﬁrst done by the Arabs in the 10th century). Assume that (x, y, z) is a Pythagorean triple. If d divides two of these, it divides the third, and then (x/d, y/d, z/d) is another Pythagorean triple. We may therefore assume that x, y and z are pairwise coprime; such triples are called primitive. In particular, exactly one of them is even. Claim 1. The even integer must be one of x or y. In fact, if z is even, then x and y are odd. Writing x = 2X + 1, y = 2Y + 1 and z = 2Z, we ﬁnd 4X 2 + 4X + 4Y 2 + 4Y + 2 = 4Z 2: but the left hand side is not divisible by 4: contradiction. Exchanging x and y if necessary we may assume that x is even. Now we transfer the additive problem x 2 + y2 = z2 into a multiplicative one (if we are to use unique factorization, we need products, not sums) by writing x 2 = z2 −y2 = (z − y)(z + y). Claim 2. gcd(z − y, z + y) = 2. In fact, put d = gcd(z − y, z + y). Then d divides z − y and z + y, hence their sum 2z and their diﬀerence 2y. Now gcd(2y, 2z) = 2 gcd(y, z) = 2, so d | 2; on the other hand, 2 | d since z − y and z + y are even since z and y are odd. Thus d = 2 as claimed. This is the point where Unique Factorization comes in: 3Pythagoras of Samos (ca. 569 – 475 BC.). 48 Proposition 5.11. Let a, b ∈ N be coprime integers such that ab is a square. Then a and b are squares. Proof. Write down the prime factorizations of a and b as a = pa1 1 · · · par r , b = qb1 1 · · · qbs s . Now a and b are coprime, so the set of pi and the set of qj are disjoint, and we conclude that the prime factorization of ab is given by ab = pa1 1 · · · par r qb1 1 · · · qbs s . Since ab is a square, all the exponents in the prime factorization of ab must be even. This implies that the ai and the bj are even, therefore a and b are squares. Corollary 5.12. Let a, b ∈ N be integers with gcd(a, b) = d such that ab is a square. Then a/d and b/d are squares. Proof. Apply the proposition to the pair a/d and b/d. Applying the corollary to the case at hand (and observing that z − y ∈ N, since z + y > 0 and (z − y)(z + y) = x 2 > 0) we ﬁnd that there exist m, n ∈ N such that z − y = 2n2 and z + y = 2m2. Adding and subtracting these equations gives z = m2 + n2 and y = m2 − n2, and from x 2 = (z − y)(z + y) = m 2n2 and x ∈ N we deduce that x = 2mn. Note that we must have gcd(m, n) = 1: in fact, any common divisor of m and n would divide x, y and z contradicting our assumption that our triple be primitive. We have shown: Theorem 5.13. If (x, y, z) is a primitive Pythagorean triple with x even, then there exist coprime integers m, n ∈ N such that x = 2mn, y = m2 − n2 and z = m 2 + n2. Note that if y is even, then the general solution is given by x = m2 − n2, y = 2mn and z = m2 + n2. Moreover, if we drop the condition that the triples be primitive then the theorem continues to hold if we also drop the condition that the integers m, n be relatively prime. Lagrange’s Trick The same technique we used for solving x 2 + y2 = z2 can be used to solve equations of the type x 2 + ay2 = z2: just write the equation in the form ay2 = (z − x)(z + x) and use unique factorization. Equations like x 2 + y2 = 2z2 at ﬁrst seem intractable using this approach because we can’t produce a diﬀerence of squares. Lagrange, however, saw that in this case multiplication by 2 saves the day because (2z) 2 = 2x 2 + 2y2 = (x + y) 2 + (x − y) 2, hence (2z − x − y)(2z + x + y) = (x − y) 2, and now the solution proceeds exactly as for Pythagorean triples. 49 Let us now show that we can do something similar for any equation of type AX 2 + BY 2 = CZ 2 having at least one solution. First, multiplying through by A shows that it is suﬃcient to consider equations X 2 + aY 2 = bZ 2. Assume that (x, y, z) is a solution of this equation. Then (bzZ) 2 = bz2X 2 + abz2Y 2 = (x 2 + ay2)X 2 + (ax 2 + a 2y2)Y 2 = (xX + ayY ) 2 + a(yX − xY ) 2. Thus a(yX − xY ) 2 = (bzZ) 2 − (xX + ayY ) 2 is a diﬀerence of squares, and we can proceed as for Pythagoren triples. We have proved: Theorem 5.14. If the equation ax 2 + by2 = cz2 has a nontrivial solution in integers, then this equation can be factored over the integers (possibly after multiplying through by a suitable integer). Exercises 5.1 Solve the diophantine equation x 2 + 2y2 = z2. 5.2 Solve the diophantine equation x 2 − 2y2 = z2. 5.3 Solve the diophantine equation x 2 + y2 = 2z2. 5.4 Solve the diophantine equation x 2 − y2 = 3. 5.5 Prove that each odd prime p can be written as a diﬀerence of squares of natural numbers (p = y2 − x 2 for x, y ∈ N) in a unique way. 5.6 Fermat repeatedly challenged English mathematicians by sending them problems he claimed to have solved and asking for proofs. Two of them were the following that he sent to Wallis: • Prove that the only solution of x 2 + 2 = y3 in positive integers is given by x = 5 and y = 3; • Prove that the only solution of x 2 + 4 = y3 in positive integers is given by x = 11 and y = 5. In a letter to his English colleague Digby, Wallis called these problems trivial and useless, and mentioned a couple of problems that he claimed were of a similar nature: • x 2 + 12 = y4 has unique solution x = 2, y = 2 in integers; • x 4 + 9 = y2 has unique solution x = 2, y = 5 in integers; • x 3 − y3 = 20 has no solution in integers; • x 3 − y3 = 19 has unique solution x = 3, y = 2 in integers. 50 When Fermat learned about Wallis’s comments, he called Wallis’s problems men- tioned above “amusements for a three-day arithmetician” in a letter to Digby. In fact, while Fermat’s problems were hard (and maybe not even solvable using the mathematics known in his times), Wallis’s claims are easy to prove. Do this. 5.7 Assume that ab = rx n for a, b, r, x ∈ N and gcd(a, b) = 1. Show that there exist u, v, y, z ∈ N such that a = uyn, b = vzn, and uv = r. 5.8 Use inﬁnite descent to prove that √ 3 is irrational. 5.9 Let p be a prime; show that x 3 + py3 + p 2z3 = 0 does not have a solution. 51","libVersion":"0.3.1","langs":""}
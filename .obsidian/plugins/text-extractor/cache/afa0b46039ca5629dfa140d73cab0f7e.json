{"path":"iCloudDrive/bks/Combinatorics/Combinatorics/Generating Functions - Maria Monks - MOP 2010.pdf","text":"Generating Functions Maria Monks June 18, 2010 A generating function is a clothesline on which we hang a sequence of numbers up for display. –Herbert Wilf, Generatingfunctionology Generating function basics A (one-variable) generating function for a sequence a0, a1, a2, . . . is the formal power series a0+a1x+a2x2+· · · . Generating functions are useful for solving recurrences, counting certain combinatorial objects, and even just ﬁnding a nice formula for the generating function itself. The classic example of a generating function identity is 1 1 − x = 1 + x + x2 + x 3 + · · · . Ordinarily, we think of this as the geometric series formula, which converges for |x| < 1, but in the world of generating functions we are more concerned with the coeﬃcients of the series than with the values of x. Deﬁnition. A formal power series over the variable x is simply an expression of the form c0 + c1x + c2x2 + · · · = ∑∞ i=0 cixi where each ci is a complex number.1 We deﬁne addition and multiplication of formal power series as follows: ∞∑ i=0 aixi + ∞∑ i=0 bixi = ∞∑ i=0(ai + bi)xi ( ∞∑ i=0 aixi) · ( ∞∑ i=0 aixi) = ∞∑ n=0 ( n∑ i=0 aibn−i ) xn Exercise. Use the deﬁnition of formal power series multiplication to prove that the identity 1 1 − x = 1 + x + x2 + x3 + · · · holds when thought of as formal power series over x. We also deﬁne the derivative of a formal power series by d dx ( ∞∑ n=0 anxn) = ∞∑ i=1 nanxn−1. The derivative behaves exactly like ordinary derivatives from calculus. 1We will usually, however, encounter the case where each ci is an integer. 1 Exercise. Let F (x) and G(x) be generating functions (formal power series over x). Use the rules for formal manipulation of power series to prove that the derivative satisﬁes: • d dx (F (x) + G(x)) = d dx F (x) + d dx G(x) • d dx (F (x)G(x)) = G(x) · d dx F (x) + F (x) · d dx G(x) • d dx (F (x)/G(x)) = (G(x) d dx F (x) − F (x) d dx G(x)) /G(x)2. Taking derivatives enables us to ﬁnd new generating functions from old ones. For in- stance, taking the derivative of both sides of the geometric series formula yields 1 (1 − x)2 = 1 + 2x + 3x 2 + 4x 3 + 5x4 + · · · . This, in fact, holds for |x| < 1, which is somewhat harder to show. Using generating functions to solve recurrences Suppose we wish to ﬁnd an explicit formula for the nth Fibonnacci number Fn, where F0 = 0, F1 = 1, and Fn = Fn−1 + Fn−2 for all n ≥ 2. Consider the generating function G(x) = ∞∑ n=0 Fnx n. We can manipulate this to take advantage of the recursion: we have G(x) − xG(x) − x2G(x) = F0 + F1x − F0x + ∞∑ n=2 (Fn − Fn−1 − Fn−2)xn = x. Thus G(x) = x/(1−x−x2). Using partial fractions and expanding each term as a geometric series, we ﬁnd that G(x) = ∞∑ n=0 1 √5 (( 1 + √5 2 )n − ( 1 − √ 5 2 )n) xn, and so Fn = 1√5 (( 1+ √5 2 )n − ( 1−√5 2 )n). In general, the generating function for any linear recurrence of the form An = c1An−1 + c2An−2 + · · · + ckAn−k can be written as a rational function of x, obtained by multiplying it by the characteristic polynomial 1 − c1x − c2x2 − · · · − ckxk and using the initial conditions to solve for the generating function. We can then use partial fraction decomposition and the geometric series formula to ﬁnd an explicit formula for the nth coeﬃcient. Exponential generating functions The exponential generating function for the sequence {ai}∞ i=0 is the series ∑∞ n=0 an n! xn. Their product behaves somewhat diﬀerently from that of ordinary generating functions: ( ∞∑ n=0 an n! xn) · ( ∞∑ n=0 bn n! xn) = ∞∑ n=0 1 n! ( n∑ k=0 (n k ) akbn−k ) xn We deﬁne ex, sin(x), and cos(x) to be the exponential generating functions shown below. Interpreting these as formal power series, they satisfy all the trigonometric identities one would expect. • ex = ∑∞ n=0 1 n! xn • sin(x) = ∑∞ n=0(−1)n 1 (2n+1)! x2n+1 • cos(x) = ∑∞ n=0(−1)n 1 (2n)! x2n Exercise. Using the deﬁnition of ex as a formal power series, show that exey = ex+y. Problems 1. (From Andy Niedermaier’s 2009 MOP handout.) Find the generating function for each of the following sequences, and use it to ﬁnd an explicit formula for an: • a0 = 1, a1 = 5, an+2 = 4an+1 − 3an • a0 = 1, a1 = 6, an+2 = 4an+1 − 4an • a0 = 0, a1 = 5, a2 = 47, an+3 = 31an+1 + 30an • a0 = 0, a1 = 1, an+2 = an+1 + 2an + 1 • a0 = a1 = 1, an+2 = an+1 + 6an + n 2. Let Dn be the number of derangements of n, that is, the number of permutations ϕ of {1, 2, . . . , n} such that ϕ(i) ̸= i for any 1 ≤ i ≤ n. Find a closed form expression for the exponential generating function of Dn, and use it to ﬁnd a formula for Dn (the formula may include a ﬁnite sum.) 3. (David Savitt.) Let Pn be the number of ways a 2 × 2 × n pillar can be built out of 2×1×1 bricks. Find a closed form expression for the generating function ∑∞ n=0 Pnxn. 4. Let Cn denote the nth Catalan number, the number of ways of parenthesizing the addition of n ones. Find a closed form expression for the generating function C(x) =∑∞ n=0 Cnxn, and use it to show that Cn = 1 n+1 (2n n ). 5. Prove that ∑ i+j=n i,j≥0 ( 2i i )( 2j j ) = 4 n. 6. (High school mathematics 1994/1, Qihong Xie.) Find the number of subsets of {1, 2, . . . , 2000}, the sum of whose elements is divisible by 5. 7. (China 1996.) Let n be a positive integer. , Find the number of polynomials P (x) with coeﬃcients in {0, 1, 2, 3} such that P (2) = n. 8. Suppose that a ﬁnite number of arithmetic sequences a1 + b1n, a2 + b2n, . . ., ak + bkn partition the positive integers into disjoint subsets. That is, the sequences pairwise disjoint and every positive integer is in one of the k sequences. If b1 ≥ b2 ≥ · · · ≥ bk, show that b1 = b2. 9. Suppose that a ﬁnite number of arithmetic sequences a1 + b1n, a2 + b2n, . . ., ak + bkn partition the positive integers into disjoint subsets. Show that ∑k i=1 ai bi = k+1 2 . 10. (Richard Stanley.) Compute ∑ a1+a2+···+ak=n,k≥1 a1a2 · · · ak. 11. (IMO 1995.) Let p be an odd prime. Find the number of subsets A of {1, 2, . . . , 2p} such that • A has exactly p elements, and • the sum of all the elements of A is divisible by p. Some problems on partitions 1. Prove that the number of partitions of a positive integer n into distinct parts is equal to the number of partitions of n into odd parts. 2. Prove that the number of partitions of an integer n into distinct odd parts has the same parity as the total number of partitions of n. 3. Let p(n) be the number of partitions of n, that is, the number of sequences (λ1, . . . , λk) with λ1 ≥ · · · ≥ λk whose sum is n. Prove that ∞∑ n=0 p(n)xn = ( 1 1 − x ) ( 1 1 − x2 ) ( 1 1 − x3 ) · · · . 4. Let p(n, r) denote the number of partitions (λ1, λ2, . . . , λk) of n (written in nonincreas- ing order) such that λ1 − k = r. Let R(z, q) = ∑ n,r p(n, r)zrqn be its two-variable generating function. Prove that R(z, q) = 1 + ∞∑ n=1 qn2 ∏n k=1(1 − zqk)(1 − z−1qk) . 5. Prove Euler’s Pentagonal Number Theorem, that (1 − x)(1 − x 2)(1 − x3) · · · = ∞∑ n=−∞(−1) nxn(3n−1)/2 6. Prove that p(5n + 4) ≡ 0 (mod 5). You may ﬁnd the following identity useful: ((1 − x)(1 − x2)(1 − x3) · · · )3 = ∞∑ n=0 (−1) n(2n + 1)x n(n+1)/2. 7. Let Q(n) be the number of partitions of n into distinct parts, that is, the number of sequences (λ1, . . . , λk) with λ1 > · · · > λk whose sum is n. Prove that ∞∑ n=0 Q(n)x n = (1 + x)(1 + x2)(1 + x3) · · · . 8. Let Q(n, r) be the number of partitions of n into distinct (decreasing) parts (λ1, . . . , λk) such that λ1 − k = r. Let G(z, q) = ∑ n,r Q(n, r)zrqn be its two-variable generating function. Prove that G(z, q) = 1 + ∞∑ s=1 qs(s+1)/2 ∏s k=1(1 − zqk) .","libVersion":"0.3.1","langs":""}
{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Kimball Martin/NT 2 (To the skies)/Notes (Individual sections)/chap7.pdf","text":"7 Quadratic forms in n variables In order to understand quadratic forms in n variables over Z, one is let to study quadratic forms over various rings and ﬁelds such as Q, Qp, R and Zp. This is consistent with the basic premise of algebraic number theory, which was the idea that to study solutions of a Diophantine equation in Z, it is useful study the equation over other rings. Deﬁnition 7.0.8. Let R be a ring. A quadratic form in n variables (or n-ary quadratic form) over R is a homogenous polynomial of degree 2 in R[x1,x2,. .., xn]. For example x2 − yz is a ternary (3 variable) quadratic form over any ring, since the coeﬃcients ±1 live inside any ring R. On the other hand x2 − 1 2 yz is not a quadratic form over Z, since − 1 2 ￿∈ Z, but it can be viewed as a quadratic form over Q, Zp for p ￿=2, Q2, R or C since − 1 2 lies in each of those rings. In fact it can be viewed as a quadratic form over Z/nZ for any odd n,as −2 is invertible mod n whenever n is odd. The subject of quadratic forms is vast and central to many parts of mathematics, such as linear algebra and Lie theory, algebraic topology, and Riemannian geometry, as well as number theory. One cannot hope to cover everything about quadratic forms, even just in number theory, in a single course, let alone one or two chapters. I will describe the classiﬁcation of quadratic forms over Qp and R without proof, explain how one can use this to study forms over Zp and Z, subsequently prove Gauss’ and Lagrange’s theorems on sums of 3 and 4 squares, and then brieﬂy explain some of the general theory of representation of numbers by quadratic forms. In particular, we will describe how studying forms over Zp generalizes Gauss’s genus theory and lead to Siegel’s mass formula, which is a generalization of Dirichlet’s mass formula to n-ary quadratic forms. The main “algebraic” question about quadratic forms is how they can be classiﬁed, up to equiv- alence. Deﬁnition 7.0.9. Let Q1(x)= Q1(x1,. .., xn) and Q2(x)= Q2(x1,. .., xn) be n-ary quadratic forms over a ring R.We say Q1 and Q2 are equivalent over R denoted Q1 ∼ Q2,or Q1 ∼R Q2 when we want to specify R,ifthereexists σ ∈ GLn(R) such that Q2(x)= Q1(σx). In other words, two forms will be equivalent over R if one is obtained from the other by an invertible (linear) change of variables over R. This is the same as our deﬁnition of equivalence (not proper equivalence) for binary quadratic forms over Z. Note that equivalent forms over R will represent the same numbers. References for this chapter are [Serre], [Cassels], [Gerstein] and [Iwaniec]. 7.1 Quadratic forms over ﬁelds The main question about quadratic forms over ﬁelds is how they can be classiﬁed, and we start with ﬁelds because the classiﬁcation over ﬁelds is much simpler than the classiﬁcation over rings. 95 Let F be a ﬁeld of characteristic not 2,and Q be an n-ary quadratic form over F . We can write Q(x1,. .., xn)= ￿ i≤j cijxixj = ￿x1 x2 ·· · xn￿ A    x1 x2 ... xn    where A is a symmetric matrix in Mn(F ). Precisely let A =(aij) where aij =    cii i = j 1 2 cij i<j 1 2 cji i>j . For example if Q(x1,x2,x3)= x2 1 +2x2 2 +3x2 3 +4x1x2 +5x1x3 +6x2x3, then we may write Q(x1,x2,x3)= ￿x1 x2 x3￿  11 5 2 123 5 2 33    x1 x2 x3   . In this way, quadratic forms in n variables correspond to symmetric n × n matrices. Symmetric n × n matrices A correspond to symmetric bilinear forms B(x, y)= xT Ay on F n, hence quadratic forms Q(x) are essentially the same as symmetric bilinear forms B(x, y) (just set Q(x)= B(x, x)), which is how they arise in linear algebra and Lie groups. We say Q is nondegenerate if the determinant of the associated matrix is nonzero. This essentially means that Q is not equivalent to a quadratic form in less than n variables. We will always assume this. The ﬁrst classiﬁcation results for quadratic forms were in the cases F = R and F = C. Let’s ﬁrst go through these. Theorem 7.1.1. (Sylvester) Let Q be be a nondegenerate quadratic form in n-variables over R. Then Q is equivalent to x2 1 + ·· · + x2 k − x2 k+1 − · · · − x2 n for some 1 ≤ k ≤ n.Further no two of these are equivalent. Proof. Since any symmetric matrix is diagonalizable over R, up to equivalence we may assume the matrix for Q is diag(a1,. .., an), i.e., Q is the diagonal form a1x2 1 + a2x2 2 + ·· · anx2 n.What Q being nondegenerate means is that no ai =0 (or else the determinant of the diagonal matrix would be 0). Thus we can make the (invertible) change of variables which replaces each xi with 1√|ai| xi. Under this transformation, Q becomes Q(x1,. .., xn)= sgn(a1)x 2 1 + sgn(a2)x 2 2 + ·· · + sgn(an)x 2 n, where sgn(ai)= ai |ai| is the sign of ai. Since we can permute the xi’s, we can in fact assume the ﬁrst kai’s are positive and the remaining ai’s are negative. This shows any Q is equivalent to some x2 1 + ·· · + x2 k − x2 k+1 − · · · − x2 n.Note that the ai’s are the eigenvalues of the matrix A for Q. Sylvester showed that the number of positive and negative eigenvalues of ST AS is the same for any invertible matrix S. (This known as Sylvester’s law of inertia.) This proves the classiﬁcation theorem. 96 If we think back to the notion of deﬁnite and indeﬁnite forms, only two forms (up to equivalence) are deﬁnite (represent only positive or negative values), namely the positive deﬁnite form x2 1+·· ·+x2 n and the negative deﬁnite form −x2 1 − · · · − x2 n. Contrast what happens over R with what happens over Q. Theorem 7.1.2. Let Q be a nondegenerate quadratic form in n-variables over C.Then Q is equivalent to x2 1 + x2 2 + ·· · x2 n. Proof. As in the real case, we may assume Q is of the form a1x2 1 + ·· · + anx2 n. But now √ai ∈ C for all i, so making the change of variables 1√ai xi, proves the theorem. Over C, there is no real notion of deﬁnite or indeﬁnite since squares may be positive or negative. In any case, there is only one form over C, up to equivalence. Note that both over R and C, the classiﬁcation of quadratic forms is much simpler than the classiﬁcation of binary quadratic forms over Z. For one, there are inﬁnitely many equivalence classes of binary quadratic forms (with no restriction on the discriminant), and even for a ﬁxed discriminant the structure is rather complicated (though surprisingly beautiful, in that we have Gauss’s composition law) In particular, while the discriminant is an invariant of the form over Z, this is not true over R or C. Over R, there is a single invariant of a quadratic form, called the signature of the form, which is the number of +1 coeﬃcients minus the number of −1 coeﬃcients, assuming the form is written as x2 1 + ·· · + x2 k − x2 k+1 − · · · − x2 n. In general, for a quadratic form Q over any ﬁeld F (characteristic not 2), we may make a change of variables to write Q as a diagonal form Q(x1,. .., xn)= a1x 2 1 + a2x 2 2 + ·· · + anx 2 n. Then the question of classiﬁcation becomes simply a question of whether each √ai ∈ F . If so, then we can make a change of variables xi ￿→ 1√ai xi to see Q is equivalent to x2 1 + ·· · + x2 n. In particular, if F is algebraically closed, √ai is always in F , so there is only one (nondegenerate) quadratic form in n-variables up to equivalence. In light of the above, the following result should be fairly evident. Proposition 7.1.3. Any n-ary form Q over F is equivalent to a1x 2 1 + a2x 2 2 + ·· · + anx 2 n, where each ai lies in a set of representatives for F ×/F ×(2).Here F ×(2) denotes the subgroup of squares of F ×. One can show there are three invariants for a quadratic form Q = a1x2 1 + ·· · anx2 n,the rank (or number of variables) n,the discriminant disc(Q)= a1a2 ·· · an,and the Hasse invariant ￿(Q)=￿i<j ￿ai,aj F ￿ = ±1. Here ￿a,b F ￿ is the Hilbert symbol which is deﬁned to be +1 if ax2 + by2 = z2 has a nonzero solution over F and −1 otherwise. Proposition 7.1.4. For p odd, a set of representatives for Q× p /Q ×(2) p is {1,p, u,up} where u ∈ Z satisﬁes ￿u p￿ = −1.This quotient group is isomorphic to C2 × C2. Proposition 7.1.5. Aset ofrepresentativesfor Q × 2 /Q ×(2) 2 is {±1, ±2, ±5, ±10}.This quotient group is isomorphic to C3 2 . 97 Theorem 7.1.6. Let Q1 and Q2 be quadratic forms over Qp.They are equivalent if and only if they have the same rank, discriminant and Hasse invariant. See [Serre] for proofs. Things are much more complicated over Q since the quotient group Q×/Q×(2) is inﬁnite. For instance, the primes 2, 3, 5, 7, 11, 13,. .. are all distinct in Q×/Q×(2), as can be easily checked by the exercise below. Exercise 7.1. Suppose p and q are two distinct primes p and q.Show p and q do not diﬀer by a rational square. Consequently Q×/Q×(2) is inﬁnite. The way to study forms over the global ﬁeld Q is by reducing the question to studying forms over the local ﬁelds Qp. To be a little more precise, the philosophy is that we can study problems over Q by studying the associated problems in all of its completions (w.r.t. nontrivial absolute values), in other words in each Qp and R. This notion is called Hasse’s local-to-global principle. The simplest precise form of the local-to-global principle is the following theorem of Hasse and Minkowski. For a quadratic form Q over a ﬁeld F ,we always have Q(0) = 0, and the simplest representation question is whether Q(x)= 0 for any nonzero x ∈ F n.If Q(x)=0 for some 0 ￿= x ∈ F n,wesay Q represents 0 (nontrivially), or Q is isotropic. Theorem 7.1.7. (Hasse–Minkowski) Let Q be a quadratic form over Q.Then Q represents 0 (nontrivially) over Q if and only if it does over Qp for each p and over R. We remark that this statement makes sense because any form over Q can be regarded as a form over Qp or R since Q ⊆ Qp and Q ⊆ R. Proof. (Sketch) Let Q be a quadratic form of rank n over Q. By the above we can write Q(x1,. .., xn)= a1x2 1 + a2x2 2 + ·· · + anx2 n with each ai ∈ Q. Since Q represents 0 (over Q, Qp or R)if and only if the form 1 a1 Q does, we may replace Q with 1 a1 Q to assume that a1 =1. Also, by replacing xi with an appropriate multiple cixi, we may assume each ai ∈ Z and squarefree. Further it is clear that if Q represents 0 over Q, it also will over the completions Qp and R. Hence it suﬃce to show that Q represents 0 over Q if it does over each Qp and R. We consider various cases. n =1.If n =1, then we have Q(x1)= x2 1,so Q does not represent 0 (nontrivially) over any ﬁeld, and there is nothing to prove. n =2.If n =2, write Q(x, y)= x2 − ay2 (here a = −a2). Then Q represents 0 over a ﬁeld F if and only if x2 = ay2 has a solution in F , i.e., if and only if a =( x y )2 has a solution in F , i.e., if and only if a is a square in F .So we want to prove that if a is a square in Qp and a is a square in R, then a is a square in Q. The condition that a ∈ R×(2) just means a> 0.Note that a ∈ Q ×(2) p means that ordp(a) is even for each p (since a = b2 implies ordp(a) = 2ordp(b)). Write a = r s where r, s ∈ Z in reduced form. If p is a prime dividing r or s, then ordp(a) even means that p occurs to an even power in the prime factorization of r and s (it will be positive for one of r and s,and 0 for the other). Hence r s = a is a square in Q. n ≥ 3. One can treat the cases n =3 (due to Legendre) and n =4 separately, and then prove the theorem for n ≥ 5 by induction on n by breaking the form up into the sum of a binary form with a form of rank n − 2. This is done with fairly elementary p-adic analysis. 98 Now one might wonder if the Hasse–Minkowski theory unnecessarily complicates the problem by requiring us to check things over inﬁnitely many ﬁelds Qp. In practice however, one only needs things for ﬁnitely many primes. This can even be seen in our proof of the n =2 case: to check if a = r s is a square in Q, it suﬃces to check it over R and Qp for just the primes p dividing r and s. One reason representing 0 is a basic question is the following. Proposition 7.1.8. Suppose Q represents 0 over F .Then Q is universal,i.e., Q represents every element of F . The proof is fairly simple: A nontrivial representation Q(x1,. .., xn)= 0 implies Q “contains” a product of linear forms. For example, x2 1 + x2 2 − x2 3 = x2 1 +(x2 + x3)(x2 − x3)= x2 1 + yz where y = x2 + x3, z = x2 − x3. Setting x1 =0, y =1 and letting z vary, we see this form is universal. The general argument is similar, but we will not go through the details—in any event, this example is essentially the case we will be considering in the next section. In fact, the Hasse–Minkowski theorem really contains information about a form representing any a ∈ Q. Exercise 7.2. Consider a form Q(x1,. .., xn) over Q and set Qa(x1,. .., xn+1)= Q(x1,. .., xn) − ax2 n+1 for a ∈ Q.Show Q represents a if and only if Qa represents 0.(Hint: use Proposition 7.1.8.) Exercise 7.3. Let Q be a quadratic form over Q.Deduce from Hasse–Minkowski that Q represents some a ∈ Q over Q if and only if it does over R and each Qp.(Hint: use the previous exercise.) One can show that any quadratic form of rank ≥ 4 over Qp represents all p-adic numbers. Then from previous exercise, one can deduce that for any Q of rank ≥ 4, Q represents a ∈ Q over Q if and only if it does over R. With this you should easily be able to convince yourself that form of rank ≥ 4 over Q either represents (i) all nonnegative rationals, (ii) all nonpositive rationals, or (iii) all rationals, just based on the signs of the coeﬃcients of the form. This suggests the following phenonemon—it is easy to determine what numbers are represented by a form Q with rank ≥ 4 (at least over Q), and it is also fairly easy to determine what numbers are represented by a form of rank 2 (or 1), but the case of rank 3 is considerably more subtle. This phenomenon persists when restricting to forms over Z as well. This notion of some problems being easy in low dimensions and high dimensions, but very subtle in middle (often 3 or 4) dimensions, occurs in other areas of mathematics also, a famous example being the classiﬁcation of n-manifolds, which is “simple” in dimensions ≤ 2 or ≥ 5. 7.2 Sums of Squares Ideally, one would like to use the Hasse–Minkowski theorem to reduce representation problems over Z to problems over Zp. The general situation is rather complicated, so for simplicity and completeness, we will show how to apply these ideas to the cases of sums of three and four squares, following [Serre] and [Gerstein]. Let’s start with the sum of 3 squares over a ﬁeld F . Recall the Hilbert symbol ￿a,b F ￿ is 1 if ax2 + by2 − z2 represents 0 and is −1 else. Hence x2 + y2 + z2 represents 0 over F if and only if￿−1,−1 F ￿ =1. We claim that this is the case if F = Qp, p odd. One can treat speciﬁc cases via simple applications of quadratic reciprocity and Hensel’s lemma. Exercise 7.4. Suppose p ≡ 1 mod 4.Show −1 is a square in Zp.Deduce x2 + y2 + z2 represents 0 over Qp (in fact Zp), i.e., ￿−1,−1 Qp ￿ =1. 99 Exercise 7.5. Suppose p ≡ 3 mod 8.Show −2 is a square in Zp.Deduce x2 + y2 + z2 represents 0 over Qp (in fact Zp), i.e., ￿−1,−1 Qp ￿ =1. For the general case (well, really we only need it for p ≡ 7 mod 8 after the above exercises) we will appeal to the following formula. Proposition 7.2.1. Suppose p is odd, a, b ∈ Qp,and write a = pαu, b = pβv,where u, v are units of Zp.Then ￿a, b Qp ￿ =(−1) αβ p−1 2 ￿u p ￿β￿v p ￿α. (One extends the Legendre symbol ￿ · p ￿ to Z× p by putting ￿a p￿ = ￿a0 p ￿ for a = a0 + a1p + a2p2 + ·· · . However, we will only apply the above formula in the case where a, b ∈ Z.) Exercise 7.6. Let p be odd. Compute ￿−1,−1 Qp ￿.Deduce that x2 + y2 + z2 is universal over Qp. Lemma 7.2.2. Let α ∈ Q×.Then α is a sum of 3 rational squares if and only if α > 0 and −α ∈ Q ×(2) 2 . Proof. By Hasse–Minkowski, α is represented by Q = x2 + y2 + z2 over Q if and only if α is represented by Q over each Qp and R. The representation condition over R is equivalent to α > 0. By the above exercise, we know x2 + y2 + z2 represents all α in Qp for p odd, so it suﬃces to show x2 + y2 + z2 represents α in Q2 if and only if −α ￿∈ Q ×(2) 2 . By an earlier exercise x2 + y2 + z2 represents α in Q2 if and only if x2 + y2 + z2 − αw2 represents 0. One can show a rank 4 quadratic form a1x2 + a2y2 + a3z2 + a4w2 over Qp does not represent 0 if and only if the discriminant is a square and the Hasse symbol ￿ = ￿i<j ￿ai,aj Qp ￿ = − ￿−1,−1 Qp ￿. When p =2,we have ￿−1,−1 Qp ￿ = −1 so this Hasse symbol condition holds if the discriminant a1a2a3a4 is a square, which in our case is just −α. This proves the lemma. To pass to representations over Z, we need the following. Lemma 7.2.3. (Davenport–Cassels) Let Q be a positive deﬁnite quadratic form of rank n over Q given by a symmetric matrix A =(aij) ∈ Mn(Z).Suppose (DCH) for all x ∈ Q n,thereis a y ∈ Z n such that Q(x − y) < 1. Then if Q represents an integer m over Q,it does over Z. As in the binary case, positive deﬁnite means Q(x) ≥ 0 with equality only if x =0 ∈ Qn. Proof. Write ￿u, v￿ = uT Av for u, v ∈ Qn,so that ￿v, v￿ = Q(v). Suppose Q(v)= ￿v, v￿ = m where v ∈ Qn. Multiplying through by denominators in v = (v1,. .., vn), there is a multiple x = tv ∈ Zn of v (for some t ∈ Z)such that Q(x)= Q(tv)= t2m. Choose v and t such that t is minimal. We want to show t =1. (DCH) tells us there is a y ∈ Zn such that z = x t − y ∈ Qn satisﬁes Q(z)= ￿z, z￿ < 1.If ￿z, z￿ =0, then z =0 (since Q is positive deﬁnite), so x t = y ∈ Zn and t =1. Now suppose ￿z, z￿￿=0. Set a = ￿y, y￿− m, b = 2(mt −￿x, y￿),t￿ = at + b, x ￿ = ax + by. Then a, b, t￿ ∈ Z, and it is easy to compute that ￿x￿,x￿￿ = mt￿2 and tt￿ = t2￿z, z￿. Consequently t￿ = t￿z, z￿ <t, contradicting the minimality of t. 100 Theorem 7.2.4. (Gauss) Apositive integer n is a sum of 3 squares if and only if n ￿=4j(8k + 7). Proof. Let x =(x1,x2,x3) ∈ Q3. Choose y =(y1,y2,y3) ∈ Z3 such that |xi − yi| ≤ 1 2 . Then Q(x − y)=(x1 − y1) 2 +(x2 − y2) 2 +(x3 − y3) 2 ≤ 1 4 + 1 4 + 1 4 < 1, i.e., the form x2 + y2 + z2 satisﬁes (DCH). By the Davenport–Cassels Lemma and the previous lemma, n is a sum of 3 squares if and only if −n ∈ Q ×(2) 2 . Since −n ∈ Z ⊆ Z2, this is equivalent to −n is a square in Z2 (since x2 = −n in Q2 implies |x2|2 = | − n|2 ≤ 1 which implies |x|2 ≤ 1). Write −n =2 e(1 + a1 · 2+ a2 · 2 2 + ·· · ) ∈ Z2. If n is a square e must be even, and then n is a square in Z2 if and only if −n 2e =1 + a1 · 2+ a2 · 22 + ·· · is. Using a slight generalization of Hensel’s lemma, we see a ∈ Z × 2 is a square if and only if it is mod 8, i.e., if and only if a ≡ 1 mod 8. Hence −n is a square in Qp if and only if −n =4j(8m + 1), i.e., if and only if n =4j(8k + 7). Corollary 7.2.5. (Lagrange) Every positive integer n is a sum of 4 squares. Proof. If n ￿=4j(8k + 7), then it is a sum of 4 squares since it is a sum of 3 squares. If n =4j(8k + 7) then m =8k +6 is the sum of 3 squares so 8k +7 = m +12 is the sum of 4 squares, whence n is also. We remark that we can’t use the Davenport–Cassels Lemma for sums of 4 squares because (DCH) fails. Corollary 7.2.6. (Gauss) Ever positive integer n is a sum of 3 triangular numbers. (Recall a triangular number is one of the form m(m+1) 2 .) Proof. Applying the 3 squares theorem to 8n +3, we see 8n +3 = x2 + y2 + z2 for some x, y, z ∈ Z. But since the only squares mod 8 are 0, 1, 4,we must have x2 ≡ y2 ≡ z2 ≡ 1 mod 8,so x, y and z are odd. Write x =2a +1, y =2b +1, z =2c +1. Then a(a + 1) 2 + b(b + 1) 2 + c(c + 1) 2 = 1 8 ￿(2a + 1)2 +(2b + 1)2 +(2c + 1)2 − 3￿ = 1 8 (8n +3 − 3) = n. 7.3 Siegel’s mass formula Here we give a brief summary of Siegel’s mass formula, following [Iwaniec]. Let Q be a positive deﬁnite quadratic form over Z of rank r. The genus of Q is the set forms over Z which are equivalent to Q over each Qp and R. The group of automorphs Aut(Q) of Q is the set of σ ∈ GLr(Z) such that σT Aσ = A, where A is the symmetric matrix associated to Q.We say solutions Q(x)= n and Q(y)= n are equivalent if y = σx for some automorph σ of Q. 101 The number of automorphs Aut(Q) in general can be diﬀerent for diﬀerent forms in the same genus. Let gen(Q) denote the set of equivalence classes of forms in the genus of Q. The genus mass of Q is w(Q)= 1 |Aut(Q)|m(gen(Q)) where m(gen(Q)) = ￿ Qj ∈gen(Q) 1 |Aut(Qj)| . The total mass is ￿ Qj ∈gen(Q) w(Qj)=1. Then the number of ways n can be represented by some form in the genus of Q is rgen(Q)(n)= ￿ Qj ∈gen(Q) w(Qj)rQj (n). Siegel’s mass formula then states rgen(Q)(n)= ￿ p δp(n, Q) · δ∞(n, Q) where δp(n, Q) is the “density” of solutions Q(x)= n in Zr p. When r =2 this is essentially Dirichlet’s mass formula. So as in the binary case, when we have one class per genus (e.g., for sums of 3 or 4 squares), one knows the individual rQ(n)’s. But this only happens ﬁnitely often, and in general it is hard to separate out the information about individual forms Q. To attempt to do this, one approach is to associate to Q a modular form ΘQ(z)= ￿ n≥0 rQ(n)e 2πinz, which is a meromorphic function. Notice the rQ(n)’s are Fourier coeﬃcients for ΘQ. Consequently, one can apply analytic methods to study the rQ(n)’s and obtain beautiful formulas in many cases. Iwaniec uses analytic number theory to show an asymptotic formula for rQ(n) (as n →∞) for individual Q’s. We will not introduce modular forms or discuss other results in this direction here, but the study of quadratic forms and modular forms is a rich area, and there are many interesting open questions still out there. 102","libVersion":"0.3.1","langs":""}
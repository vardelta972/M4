{"path":"iCloudDrive/bks/Algebra/Algebra/Generating Functions/Generating Functions - Holden Lee - OMC.pdf","text":"Lecture 18 — Generating functions Holden Lee 4/23/11 1 Introduction Generating functions oﬀer a way to convert combinatorics questions into purely algebraic and analytic questions. The basic idea is this: we take a sequence a0, a1, a2, . . ., usually representating something of combinatorical interest—for example, an could be the number of ways to make change with n cents (see the ﬁrst lecture)—and then associate with it a power series. Deﬁnition 1.1: The generating function of the sequence a0, a1, a2, . . . is the formal series ∞∑ n=0 anxn = a0 + a1x + a2x2 + · · · . To ﬁnd the an, or identities involving the an, we rewrite the generating function in terms of familiar functions using algebra and calculus, manipulate the equation, and then extract the coeﬃcients. In Sections 2 we develop the algebraic and analytic machinery of generating functions; in Sections 3 and 4 we give applications to algebra and combinatorics. An impatient reader may also wish to skip to the examples, and look up the relevant algebraic and analytic facts as needed. In our above deﬁnition, we said that a generating function is a formal series. But what exactly is a formal series? 2 Formal series 2.1 The ring of formal series Deﬁnition 2.1: Let R be a ring. The ring of formal (power) series in R is the set of all expressions ∞∑ n=0 anxn = a0 + a1x + a2x2 + · · · . The ring of formal series will be denoted by R[[x]] (compare to the ring of polynomials R[x]). We will work exclusively with R = R, i.e. formal series with real coeﬃcients. Just like polynomials, we can repeat this process to obtain formal series in more than one variable, to get R[[x]][[y]] = R[[x, y]], etc. OMC 2011 Generating functions Lecture 18 Note a formal series is not a function. Right now we don’t care whether the sum∑∞ n=0 anxn “converges.” Don’t think of x as being the input value for a function; think of it just as the symbol x. Note this perspective was useful in our development of polynomials; it will also be essential for our development of formal series. (In Section 2.4 we will look at formal series as functions.) We said R is a ring, meaning that it has addition and multiplication deﬁned, satisfying the “usual” properties (see lecture 8). If f and g are power series, we deﬁne f + g by adding corresponding terms and multiplication by multiplying every term in f and every term in g, and adding. In symbols, if f (x) = ∞∑ n=0 anxn g(x) = ∞∑ n=0 bnxn then f (x) + g(x) = ∞∑ n=0(an + bn)xn f (x)g(x) = ∞∑ n=0(anb0 + an−1b1 + · · · + a1bn−1 + a0bn)xn. (1) Note that the coeﬃcient of f g is the sum of products of coeﬃcients in f and coeﬃcients in g, where the corresponding exponents sum to n. 1 This generalizes to the product of m factors in the obvious way (for 3 sequences f (x)g(x)h(x) = ∑ i+j+k=n aibjckxn, and so on), and will be important for combinatorial interpretations. It is simple to check that we have additive inverses and that the normal rules dis- tributivity, commutativity, and associativity hold. We will leave this for the fastidious reader. There is one more thing we could do: we can compose power series, that is, substitute one in for the other. Deﬁnition 2.2: Given f (x) = ∑∞ n=0 anxn and g(x) = ∑∞ n=1 bnxn, deﬁne the composi- tion f ◦ g to be f ◦ g(x) = ∞∑ n=0 ang(x)n. Note this makes sense, because for n > 0, the coeﬃcient of xn in f ◦g will only depend on the partial sum ∑n m=0 amg(x)m (why?). Note that we require the constant term of g to be 0 to avoid an inﬁnite sum for the constant term. This way, the constant term of f ◦ g equals a0, the constant term of f . 2.2 Inverses If f is a power series, a logical question is whether 1 f or f −1 is well-deﬁned. You may know the geometric series formula, 1 1 − x = 1 + x + x2 + x3 + · · · 1The sequence of coeﬃcients of f (x)g(x) is called the convolution of {an} and {bn}. 2 OMC 2011 Generating functions Lecture 18 which says that 1 + x + x2 + · · · is the multiplicative inverse of 1 1−x in R[[x]]. Indeed you can check using our deﬁnition of multiplication that (1 − x)(1 + x + x2 + · · · ) = 1. Now we see under what conditions 1 f and f −1 exist. Theorem 2.3: Suppose f = ∑∞ n=0 anxn where a0 ̸= 0. Then there exists a unique g such that f g = 1. g is called the multiplicative inverse of f and denoted by 1 f . Moreover, the coeﬃcient of xn in g only depends on a0, . . . , an. Proof. We ﬁnd the coeﬃcients b0, b1, . . . of g inductively. To make the constant term 1 we need b0 = 1 a0 . Suppose we know that g starts with b0 + b1x + · · · + bkxk and f (x)(b0 + b1x + · · · + bkxk) has coeﬃcients of 1, x, . . . , x k all equal to 0. Now we deﬁne bk+1 so that the coeﬃcients of 1, x, . . . , x k+1 in f (x)(b0 + b1x + · · · + bkxk + bk+1xk+1) are equal to 0. The coeﬃcients of 1, x, . . . , x k are not aﬀected by the addition of bk+1xk+1, so we just need the coeﬃcient of xk+1 to be 0: a0bk+1 + a1bk + · · · + ak+1b0 = 0. So let bk+1 = −a1bk − · · · − ak+1b0 a0 , and this is the only value that works. Then g = ∑∞ n=0 bnxn. Theorem 2.4: Suppose f = ∑∞ n=1 anxn. Then there exists a unique g such that f ◦g = 1. Moreover, g ◦ f as well. g is called the inverse of f and denoted by f −1. Moreover, the coeﬃcient of xn in g depends only on a1, . . . , an. Proof. Exercise. (Similar to the above proof.) 2.3 Derivatives We deﬁne the derivative the same way as in calculus. Deﬁnition 2.5: Let f (x) = ∑∞ n=0 anxn. The derivative of f is f ′(x) = ∞∑ n=1 nanxn−1 = ∞∑ n=0(n + 1)an+1xn. The following can be proved just like it is proved for polynomials. (Alternatively, conclude it from the corresponding result for polynomials, by noting that the coeﬃcients of xn depends on only ﬁnitely many terms in the expressions below.) Proposition 2.6: Let f, g be two power series and c be a constant. Then 1. (Linearity) (cf + g) ′ = cf ′ + g′. 2. (Product rule) (f g) ′ = f ′g + f g′. 3. (Chain rule) For g with constant term 0, (f ◦ g) ′ = (f ′ ◦ g)g′. We can state the product rule in a slightly diﬀerent form, that will often be of use. 3 OMC 2011 Generating functions Lecture 18 Proposition 2.7 (Logarithmic diﬀerentiation): Suppose f = f1 · · · fn where f1, . . . , fn are power series. Then f ′ = f ( f ′ 1 f1 + · · · + f ′ n fn ) . Proof. By the product rule, f ′ = f ′ 1f2 · · · fn + f1f ′ 2 · · · fn + · · · + f1f2 · · · f ′ n. which gives the above after using f = f1 · · · fn. Alternatively (and this is why the proposition is called logarithmic diﬀerentiation) take ln of both sides, diﬀerentiate, and use the chain rule, and note that (ln x)′ = 1 x : ln f = ln f1 + ln f2 + · · · + ln fn f ′ f = f ′ 1 f1 + f ′ 2 f2 + · · · + f ′ n fn (2) which rearranges into the same identity. Why is this justiﬁed? This identity is true if the fi’s are all polynomials, by calculus and Theorem 2.8 in the next subsection. Moreover, the coeﬃcient of xn on both sides of (2) will stay the same if each f, fi is replaced by a polynomial with coeﬃcients of 1, x, . . . , x n+1 agreeing (so the coeﬃcients of 1, . . . , xn of f ′ 1, . . . , f ′ n will be the same; use the last statement in Theorem 2.3), so the conclusion follows from the ﬁnite case. 2.4 Analytic point of view From calculus, we know how to expand functions in power series ∑∞ n=0 anxn. For each power series there is a r such that it converges absolutely2 for |x| < r, but not for |x| > r. In this domain we may diﬀerentiate and integrate and still have a convergent power series. A table of power series and generating functions can be found in the Appendix. For example, ex = 1 + x 1! + x2 2! + · · · . We have equality in the calculus sense: both sides are equal as functions, i.e. give the same result when we plug in any value for x. An identity in formal power series automatically transfers to an identity in functions, provided the functions converge. The following gives the opposite implication. Theorem 2.8: Suppose f (x) = ∑∞ n=0 anxn and g(x) = ∑∞ n=0 bnxn are two absolutely convergent power series on an interval (−ε, ε) around 0, and f (x) = g(x) for x ∈ (−ε, ε). Then an = bn for all n. Proof. Let h(x) = f (x) − g(x) = ∑∞ n=0 cnxn, where cn = an − bn. If cn is not the zero sequence, let m be the least integer so that cm ̸= 0. Then h(x) = xm(cm + j(x)) where j(x) = cm+1x + cm+2x2 + · · · . Since power series are continuous, j(x) is continuous. Note it equals 0 at x = 0, so is close to 0 for x close to 0. Taking x ̸= 0 suﬃciently small, we have |j(x)| < |am|, so am + j(x) ̸= 0 and h(x) ̸= 0, contradiction. 2That is, ∑∞ n=0 |anxn| is ﬁnite. 4 OMC 2011 Generating functions Lecture 18 As a simple example, we know 1 1 − x = 1 + x + x2 + x3 + · · · holds for x ∈ (−1, 1), so this is an identity of power series. (Recall we could also conclude this by directly multiplying (1 − x) and 1 + x + x2 + · · · .) Why is calculus useful? 1. It allows us to turn power series into familiar functions, which we can easily multiply, divide, and diﬀerentiate, taking full advantage of algebraic identities (ex. sin2 x + cos 2 x = 1—it would be annoying to the corresponding power series satisfy this identity using the deﬁnition of multiplication for formal series!). 2. It allows us to substitute in values for x to get identities involving the coeﬃcients, or take limits (see Section 4.4). 3. We could the tools of complex analysis to analyze the growth of the sequence. (This is beyond the scope of this lecture.) 3 Applications to Algebra We give two applications of generating functions to algebra. First, generating functions are useful for ﬁnding closed formulas for sequences. The general strategy is the following. 1. Convert the recurrence relation for an into an identity involving the generating function f . (a) Shift the sequence by multiplying by powers of x. For ﬁxed i, the generating function for an−i is f (x)xi; the generating function of an+i is x−i(f (x) − a0 − · · · − ai−1xi−1). (b) The sequence (n + 1)an+1 is obtained by taking the derivative of f . (c) A term like anb0 + · · · + a0bn is obtained by multiplying power series. 2. If we want a closed formula for the sequence, solve for f and extract the coeﬃcients. If we want to prove an identity or simplify and expression involving the sequence, massage the identity for f so that the desired identity can be read oﬀ from equating coeﬃcients of xn. 3.1 Solving recurrences Theorem 3.1: Suppose that c0 ̸= 0 and the roots of P (x) := xk + ck−1xk−1 + · · · + c1x + c0 = 0 are distinct and equal to r1, . . . , rk. The general solution to the linear recurrence an + ck−1an−1 + · · · + c0an−k = 0, n ≥ k where c0 ̸= 0, is an = b1rn 1 + b2rn 2 + · · · + bkrn k . (3) 5 OMC 2011 Generating functions Lecture 18 Proof. Let f (x) be the generating function for an, so that f (x) = ∑∞ n=0 anxn. We multiply f (x) by powers of x to get the shifted sequences {an−i}: xif (x) = ∞∑ n=0 anxn+i = ∞∑ n=i an−ixn. Thus the recurrence relation becomes f (x) + ck−1xf (x) + · · · + c0xkf (x) = 0, because the coeﬃcient of xn on left hand side is an + ck−1an−1 + · · · + c0an−k, which is equal to 0. Dividing by 1 + ck−1x + · · · + c0xk, we obtain f (x) = 0. Wait, that’s not right. What went wrong? The identity an + ck−1an−1 + · · · + c0an−k = 0 is only valid for n ≥ k. (Moral: always be careful with small cases.) So for n < k, there is no restriction on the coeﬃcient of xn on the LHS. So instead, we should write f (x) + ck−1xf (x) + · · · + c0xkf (x) = d0 + d1x + · · · + dk−1xk−1 (4) for some b0, . . . , bk−1. Now we use the following: Theorem 3.2 (Partial fraction decomposition): Suppose p(x) and q(x) are polynomials with deg p < deg q = k, and q has distinct roots r1, . . . , rn. Then there are b1, . . . , bk such that p(x) q(x) = b1 x − r1 + · · · + bk x − rk . Hence dividing (4) by 1 + ck−1x + · · · + c0xk, noting that 1 ri are the zeros of 1 + ck−1x + · · · + c0xk = xnP ( 1 xn ), and using the above theorem gives f (x) = b1 x − 1 r1 + · · · + bk x − 1 rk = −r1b1 1 − r1x + · · · + −rnbn 1 − rnx . for some bi. (Conversely, given f (x) in the above form, (4) holds for some bi, so f (x) gives a valid sequence.) Now using the geometric series formula gives f (x) = k∑ i=1 −ribi(1 + rix + r2 i x2 + r3 i x3 + · · · ). Extracting the nth coeﬃcient gives an = k∑ i=1 −ribirn i = k∑ i=1 b′ irn i after setting b′ i = −ribi. Remark 3.3: In the general case, the general solution to the linear recurrence an + ck−1an−1 + · · · + c0an−k = 0, n ≥ k 6 OMC 2011 Generating functions Lecture 18 where c0 ̸= 0, is given by an = ∑ r Pr(x)rn where the sum is over the roots r of the characteristic polynomial xk + ck−1xk−1 + · · · + c0 and Pr(x) is a polynomial of degree less than the multiplicity of the root r in P . The above proof can be adapted to solve the general version. Note that generating sequences do not necessarily make for the most elegant or short proofs. If we know the general form of the solution, we can prove show that it works just by substituting in, and ﬁnd an argument to show directly that all solutions are of that form. But generating sequences are especially useful if we do not know the solution, since they oﬀer a methodical way to ﬁnd it. For some deep results, though, no proof without generating functions is known! 3.2 Newton sums Let x1, x2, . . . be variables. In this subsection we develop the Newton formulas relating the symmetric polynomials in the xi sn = ∑ 1≤i1<···<in xi1xi2 · · · xin and the power sums pn = ∑ i≥1 xn i . (For example, when we have 3 variables, s2 = x1x2 +x1x3 +x2x3 and p2 = x2 1 +x2 2 +x2 3. For convenience of notation we don’t restrict the number of variables; if we are working with k variables we could just set 0 = xk+1 = xk+2 = · · · . By convention s0 = 1.) We note that the si and pi are the coeﬃcients of powers of t of the following generating functions. S(t) = ∏ i≥1(1 + xit) = 1 + s1t + s2t 2 + · · · P (t) = ∑ i≥1 xi 1 − xit = ∑ i≥1 (xi + x2 i t + · · · ) = p1 + p2t + · · · . Why do these expansions hold? Each term in the expansion of S(t) is a term of the form xi1 · · · xint n where the xij are distinct, since we can only get a factor of xij from the factor (1 + xij t). Since each xi always comes with a factor of t, t acts as a “counter” giving the total number of variables. Grouping the terms with tn we get all combinations of products of n of the xi. For P (t) the argument is simpler: expand in geometric series as shown above to get that the coeﬃcients of t n−1 are the nth powers of the xi. We want an identity involving si and pi so we look for an identity involving S(t) and P (t). First we turn the 1 + xti into 1 − xit: deﬁne Ψ(t) = S(−t) = ∏ i≥1(1 − xit) = 1 − s1t + s2t 2 − s3t 3 + · · · . 7 OMC 2011 Generating functions Lecture 18 Now use logarithmic diﬀerentiation (Proposition 2.7) to get Ψ ′(t) Ψ(t) = − ∑ i≥1 xi 1 − xit . The right-hand side is just −P (t) (TA-DA!). Thus we get −Ψ ′(t) = Ψ(t)P (t). Now we match coeﬃcients of tn−1 on both sides. Note −Ψ ′(t) = s1 − 2s2t + 3s3t2 − · · · so the coeﬃcient of t n−1 is (−1)n+1nsn. To get the coeﬃcients of the right-hand side, note that a term containing t n−1 on the RHS comes from multiplying (−1) isit i in Ψ(t) and a term pn−it n−i−1 in P (t). Thus the coeﬃcients of t n−1 are (−1) n+1nsn = n−1∑ i=0 (−1) isipn−i = s0pn − s1pn−1 + · · · + (−1) n−1sn−1p1 which is the Newton sum formula. 4 Applications to Combinatorics In some combinatorial problems, we ﬁnd a recurrence relation for the sequence of interest, and then turn it into a generating series (see Section 4.2). In others, we build the gener- ating function directly by multiplying together several power series, and note that every resulting term is obtained by choosing one term from each of the series; the exponents of the variable acts should like some “weight,” or some value of interest to the problem. (See Theorem 4.4 and Example 4.9.) See also the ﬁrst lecture (http://onlinemathcircle.com/wp-content/uploads/2010/ 12/1-beauty.pdf) for an application of generating functions to counting change. 4.1 Binomial coeﬃcients By the binomial formula, (1 + x)n = n∑ i=0 (n i )xn. Thus (1 + x) n is the generating function for the sequence (n i), i ≥ 0. This is a particularly simple function; in fact is is just a polynomial! We can use this and our knowledge of multiplying generating functions (or just polynomials) to get a quick identity. Example 4.1 (Vandermonde convolution): k∑ i=0 ( m i )( n k − i ) = ( m + n k ) . Proof. Consider the identity (1 + x)m(1 + x) n = (1 + x) m+n. The ith coeﬃcient of (1 + x) m is (m i ), the (k − i)th coeﬃcient of (1 + x)n is ( n k−i), and the kth coeﬃcient of (1 + x) m+n is (m+n k ) . The identity follows for the formula for the product of generating functions, (1). 8 OMC 2011 Generating functions Lecture 18 4.2 Catalan numbers The Catalan numbers are a famous sequence in combinatorics, and appear in many diﬀerent contexts. Below we give several equivalent deﬁnitions. Deﬁnition 4.2: The Catalan number Cn is the 1. Number of binary trees with n vertices. A binary tree is a rooted tree so that each vertex has at most two outgoing edges going to the left or right. For example, there are 5 rooted trees with 3 vertices: 2. Number of sequences of n X’s and n Y ’s such that in any initial segment, the number of X’s is at least the number of Y ’s. 3. Number of paths from (0, 0) to (n, n), that go right or up one unit at each step and that do not go above the main diagonal y = x. 4. Number of ways to triangulate a (n + 2)-gon. We ﬁrst derive an identity for the Cn. We claim Cn+1 = n∑ k=0 CkCn−k = C0Cn + C1Cn−1 + · · · + CnC0. (5) using any of the deﬁnitions. To count the number of binary trees with n + 1 vertices, note that if we take oﬀ the root vertex of a tree with n + 1 vertices, the tree is split into two smaller binary trees, of sizes k and n − k, for some 0 ≤ k ≤ n. There are CkCn−k possibilities for these smaller trees. Moreover, this operation is reversible. Thus summing over 0 ≤ k ≤ n gives (5). To see the formula holds for the second deﬁnition, given a sequence of X’s and Y ’s satisfying the conditions (a ballot sequence), let k be the smallest nonnegative integer so that there are as many X’s as Y ’s in the ﬁrst 2(k + 1) entries. Now delete the ﬁrst entry and the 2(k + 1)th entry, to get two sequences of lengths 2k and 2(n − k). The ﬁrst is a ballot sequence by minimality of k and the second is a ballot sequence since there are as many X’s as Y ’s before the second sequence. The construction is reversible, so we get the same formula as before. The third deﬁnition is equivalent to the second because we can associate taking a step to the right with X and taking a step up as Y . The last deﬁnition is left to the reader. Now let y be the generating function for Cn. We turn our recurrence relation into an identity involving f . Cn+1 is the coeﬃcient of xn in y−1 x —note we subtract out the constant term before dividing by x, so that the result is a power series. The RHS of (5), 9 OMC 2011 Generating functions Lecture 18 ∑n k=0 CkCn−k, is the coeﬃcient of xn in y2. Thus using the quadratic formula we get y − 1 x = y2 xy2 − y + 1 = 0 y = 1 ± √ 1 − 4x 2x . (6) Now using the binomial formula ((1 + x) r = ∑∞ n=0 (r n ) xn where (r n ) = rn n! = r(r−1)···(r−n+1) n! we get √ 1 − 4x = (1 − 4x) 1 2 = ∞∑ n=0 ( 1 2 n ) (−4) nxn = 1 − ∞∑ n=1 2 n ( 2(n − 1) n − 1 ) xn since for n > 0, ( 1 2 n ) (−4) n = 1 n! ( 1 2 ) (−1 2 ) · · · ( −2n + 3 2 ) (−4) n = − 1 n!2 n(2n − 3)(2n − 5) · · · 1 = − 1 n! 2 n (2n − 2)! (2n − 2)(2n − 4) · · · 2 = −2(2(n − 1))! n!(n − 1)! = − 2 n (2(n − 1) n − 1 ) In (6) we take the − sign so that the constant term of the numerator 0 and y is a valid power series. Then y = ∞∑ n=1 1 n ( 2(n − 1) n − 1 )xn−1 = ∞∑ n=0 1 n + 1 ( 2n n ) xn. Hence Cn = 1 n+1(2n n ). 4.3 Partitions One of the most famous generating functions in combinatorics is that of the partition function. Deﬁnition 4.3: Let m be a nonnegative integer. A partition of m is a way to write it as the sum of positive integers, with order not taken into account. In other words, it is a sequences of positive integers (λ1, . . . , λk) with λ1 ≥ · · · ≥ λk and ∑k i=1 λi = m. Deﬁne p(n) to be the number of partitions of n. By convention, p(0) = 1. Theorem 4.4: The generating function of the sequence p(n) is F (x) = ∞∏ n=1 1 1 − xn . (7) Proof. A partition of n can be speciﬁed by a sequence (a1, a2, . . .) where ai is the number of times i appears in the partition. In order for this to specify a partition of n, we must have n∑ i=1 iai = n. 10 OMC 2011 Generating functions Lecture 18 The number of such sequences ai is simply the coeﬃcient of xn in ∞∏ i=1(1 + xi + x2i + x3i + · · · ) since each term xn in the expansion comes from multiplying together terms of the form xiai, where xiai is taken from the ith factor in the product above. Using the geometric series formula gives (7). We use the generating function to give an identity for p(n). Example 4.5: For a positive integer m let σ(m) denote the sum of divisors of m. Then n · p(n) = n∑ i=1 σ(i)p(n − i). Proof. Note n · p(n) is the coeﬃcient of xn−1 in F ′(x): F ′(x) = ∞∑ n=1 np(n)xn−1. Now letting fn(x) = 1 1−xn , we have F (x) = ∏∞ n=1 fn(x). Note f ′ n fn = nxn−1 (1 − xn)2 (1 − xn) = nxn−1 1 − xn so by logarithmic diﬀerentiation3 F ′(x) = F (x) ∞∑ m=1 f ′ m fm = F (x) ∞∑ m=1 mx m−1 1 − xm . (8) Claim 4.6: ∞∑ m=1 mxm−1 1 − xm = ∞∑ t=1 σ(t)xt−1. Proof. We expand using the geometric series formula and then exchange the order of summation. ∞∑ m=1 mx m−1 1 − xm = ∞∑ m=1 mxm−1 ∞∑ k=0 xmk = ∞∑ m=1 ∞∑ k=1 mxmk−1 = ∑ m>0, m|t mx t−1 = ∞∑ t=1   ∑ m|t m   xt−1 = ∞∑ t=1 σ(t)xt−1. 3Note there are inﬁnitely many factors in the product. This is okay, because the coeﬃcient of xn will be the same in F ′(x) as in (f1 · · · fn+1) ′, so the equation follows from the ﬁnite version for each n. 11 OMC 2011 Generating functions Lecture 18 What we did above, with less math notation, is just switch from reading the rows to reading the columns of the below sum: 1 1−x = 1+ x+ x2+ x3+ x4+ x5+ · · · 2x 1−x2 = 2x+ 2x3+ 2x5+ · · · 3x2 1−x3 = 3x2+ 3x5+ · · · 4x3 1−x4 = 4x3+ · · · 5x4 1−x5 = 5x4+ · · · 6x5 1−x6 = 6x5+ · · · ... ... σ(1)+ σ(2)x+ σ(3)x2+ σ(4)x3+ σ(5)x4+ σ(6)x5+ · · · Putting the above result into (8) we get ∞∑ n=1 np(n)xn−1 = F ′(x) = F (x) ∞∑ t=1 σ(t)xt−1 = ( ∞∑ n=0 p(n)xn) ( ∞∑ t=1 σ(t)xt−1) . Matching the coeﬃcients of xn−1 on both sides gives the desired result. The generating function (7) for p(n) can in fact be used to obtain much more infor- mation about p(n), such as congruences like p(5n + 4) ≡ 0 (mod 5), and information on its asymptotic growth. 4.4 Arithmetic progressions For some problems we may use apply calculus to get information about the generating functions, such as taking a limit. Example 4.7: Suppose the the set of natural numbers is partitioned into arithmetic sequences with ﬁrst terms a1, . . . , ak and common diﬀerences r1, . . . , rk, respectively. Then 1. 1 r1 + · · · + 1 rk = 1. 2. a1 r1 + · · · + ak rk = k−1 2 . Proof. Every natural number occurs in exactly one of the sequences {a1+nr1} ∞ n=0, . . . , {ak+ nrk} ∞ n=0, so ∞∑ n=0 xa1+nr1 + · · · + ∞∑ n=0 xak+nrk = ∞∑ n=0 xn. Using the geometric series formula, this becomes xa1 1 − xr1 + · · · + xak 1 − xrk = 1 1 − x. This identity holds for |x| < 1. Multiply through by 1 − x: xa1 xr1−1 + · · · + x + 1 + · · · + xak xrk−1 + · · · + x + 1 = 1, |x| < 1 (9) 12 OMC 2011 Generating functions Lecture 18 Now take the limit as x → 1 − to get 1 r1 + · · · + 1 rk = 1. (10) as needed. To get an identity involving the ai, we diﬀerentiate (9) to bring the ai “out front”: k∑ i=1 aixai(xri−1 + · · · + 1) − xai((ri − 1)xri−2 + · · · + 1) (xri−1 + · · · + x + 1)2 = 0, |x| < 1 Now take the limit as x → 1 −: k∑ i=1 airi − ri(ri−1) 2 r2 i = −k 2 + ∞∑ i=1 ( ai ri + 1 2ri ) = 0. Now use (10) to get k∑ i=1 ai ri = k − 1 2 . 4.5 Extracting coeﬃcients In this section we consider generating functions which are polynomials. Sometimes, rather than ﬁnding a speciﬁc coeﬃcient, we want to ﬁnd a sum of coeﬃcients, for instance the sum of coeﬃcients of xn with n divisible by k. To do this, we evaluate the polynomial at the kth roots of unity and take the average.4 Lemma 4.8: Let ω = e 2πi k . Then the sum of the coeﬃcients of xn with k|n in the polynomial P (x) is P (1) + P (ω) + · · · + P (ωk−1) k . Proof. For a kth root of unity ζ, 1 + ζ + · · · + ζ k−1 = { 0, ζ ̸= 1 k, ζ = 1. If P (x) = ∑∞ n=0 anxn, the the contribution to the sum P (1) + P (ω) + · · · + P (ωk−1) from the xn terms is an(1 + ωn + · · · + ωn(k−1)), which by the above, is ank when ωn = 1 i.e. k|n, and 0 otherwise. (Query: Given r, how would you ﬁnd the sum of coeﬃcients of xn with n ≡ r (mod k)?) A quick example: Suppose we want to ﬁnd the number of subsets of an n-element subset with number of elements divisible by 3. This is just the sum of the coeﬃcients of 4For background on complex numbers see lecture 11, http://onlinemathcircle.com/wp-content/ uploads/2011/02/10-complex.pdf 13 OMC 2011 Generating functions Lecture 18 xi (which are binomial coeﬃcients ( n i)) for 3|i, in (1 + x) n. Using Lemma 4.8 and letting ω = −1+ √3i 2 be the third root of unity, the answer is 2 n + (1 + ω)n + (1 + ω2) n 3 = 2 n + ( 1+ √3i 2 )n + ( 1− √3i 2 )n 3 . Now for something more hardcore. Example 4.9 (IMO 1995/6): Let p > 2 be a prime number and let A = {1, 2, . . . , 2p}. Find the number of subsets of A having p elements and having sum of elements divisible by p. Solution. Consider the generating function (1 + x)(1 + x2) · · · (1 + x2p). The coeﬃcient of xi in the expansion is the number of subsets of A whose sum of elements is i. Indeed, each subset of A is associated with a term in the expansion, by taking 1 from the ith term if i ̸∈ A, and xi from the ith term if i ∈ A. Consider the generating function (1 + y)(1 + y) · · · (1 + y) | {z } 2p . The coeﬃcient of yj in the expansion is the number of subsets of A with j elements. Indeed, each subset of A is associated with a term in the expansion, by taking 1 from the jth term if j ̸∈ A, and y from the jth term if j ∈ A. But we want information about both the number of elements in the subset and the sum of the elements in the subset, at the same time. What do we do? Put the two together! Consider the generating function P (x, y) = (1 + xy)(1 + x2y) · · · (1 + x2py). The coeﬃcient of xiyj is the number of subsets of A with j elements with sum of elements equal to i. Think of the variables x and y as being counters for diﬀerent things. For example, in the case of p = 3, the term xy · 1 · x3y · 1 · x5y · 1 = x9y3 corresponds to the subset {1, 3, 5}. Thus we want the sum of the coeﬃcients of xiyp where p|i. Treating P (x, y) as a polynomial in x and applying Lemma 4.8, we want the coeﬃcient of yp in P (1, y) + P (ω, y) + · · · + P (ωp−1, y) p , ω = e 2πi p . (11) Note for ζ ̸= 1 a pth root of unity, 1, ζ, . . . , ζ p−1 runs through all pth roots of unity and hence t p − 1 = (t − 1)(t − ζ) · · · (t − ζ p−1). Then P (ζ, y) = [(1 + ζy) · · · (1 + ζ py)][(1 + ζ p+1y) · · · (1 + ζ 2py)] = [(1 + ζy) · · · (1 + ζ py)] 2 = y2p[(−y−1 − ζ) · · · (−y−1 − ζ p)] 2 = y2p[(tp − 1)|t=−y−1]2 = (yp + 1)2. 14 OMC 2011 Generating functions Lecture 18 When ζ = 1, P (ζ, y) = (y + 1)2p. Putting these two cases together, P (1, y) + · · · + P (ωp−1, y) p = (y + 1)2p + (p − 1)(yp + 1)2 p . The coeﬃcient of yp is (2p p ) + 2(p − 1) p which is the answer. 5 Problems 1. Find the generating function for the Fibonacci numbers, deﬁned by F0 = 0, F1 = 1 and Fn+2 = Fn + Fn+1 for n ≥ 0. Then simplify the following (i.e. write it as an expression involving only a ﬁxed number of Fi’s): (a) ∑n i=0 Fi (b) ∑n−1 i=0 F2i+1 (c) ∑n i=0 F2i (d) ∑n i=0 iFi (e) ∑n i=0 FiFn−i 2. Given that {an} ∞ n=0 satisﬁes ∑n i=0 anpn−i = bn for each integer n, ﬁnd an in terms of n and bn. Same problem, for ∑n i=0 an(n − i)pn−i = bn. 3. Let (1 + x + x2 + · · · + x8)100 = 800∑ n=0 anxn. Find ∑800 n=0 nan. 4. Prove that ∑m n=0 (n+k k ) = ( n+m+1 k+1 ). 5. Given n ∈ N0, ﬁnd the number of k-tuples of nonnegative integers (a1, . . . , ak) such that a1 + · · · + ak = n. 6. Let n > 1 and consider a fair die D with n2 faces, labeled 1, 2, . . . , n2. Prove that there exists two dice A and B, diﬀerent from D, each with n2 faces labeled by positive integers, such that the probability distribution of the sum of two rolls of D is the same as the probability distribution of the sum of one roll of A and one roll of B. 7. Let bn be the number of ways to write n as a sum of nonnegative integer powers of 2. (a) Find the generating function for bn. 15 OMC 2011 Generating functions Lecture 18 (b) Prove that bn = ⌊ n 2 ⌋∑ i=0 bi. Try to ﬁnd both a combinatorial and a generating function proof, for compar- ison. 8. Let an denote the number of ways to tile a 3 × n board with dominoes. Find a generating function for an, then give an explicit formula. (Note: you need to have two generating functions for this problem. One is for an; one is for the bn, the number of ways to tile a 3 × n rectangle with one corner missing.) 9. Five people stand at the vertices of a pentagon, throwing frisbees to each other. At time 0, two people at adjacent vertices have the frisbees, and in each time interval, each frisbee is thrown to the left or right with probability 1 2. This process continues until one person receives two frisbees simultaneously. Let pn be the probability that the game ends after exactly n steps. (a) Find a generating function for pn. (As in the previous problem, set up a system of equations involving generating functions.) (b) Find pn. (c) Find the expected number of steps until the game ends ( ∑∞ n=0 npn). Hint: diﬀerentiate. (This problem shows how generating functions can be useful in probability. See [2, §8.4] for a cool application of generating functions to coin-ﬂipping games.) 10. (AwesomeMath Team Contest 2008, David Rush) If any element of the set {0, 1, . . . , m3 − 1} is considered a digit in modiﬁed base m, prove that, for all positive integers n the number of modiﬁed base m representations of n is an integer multiple of ⌊ n m2 ⌋+1 2 . 11. Show that the number of partitions of n into odd parts equals the number of par- titions of n into distinct parts. 12. (IMO 2008/5) Let n and k be positive integers with k ≥ n and k − n an even number. Let 2n lamps labelled 1, 2, . . . , 2n be given, each of which can be either on or oﬀ. Initially all the lamps are oﬀ. We consider a sequence of steps: at each step one of the lamps is switched (from on to oﬀ or from oﬀ to on). Let N be the number of such sequences consisting of k steps and resulting in the state where lamps 1 through n are all on, and lamps n + 1 through 2n are all oﬀ. Let M be the number of such sequences consisiting of k steps and resulting in the state where lamps 1 through n are all on, and lamps n + 1 through 2n are all oﬀ, but where none of the lamps n + 1 through 2n is ever switched on. Determine the ratio N/M . 13. Suppose that the natural numbers are written as a disjoint union of arithmetic progressions with diﬀerences d1 ≥ d2 ≥ · · · ≥ dn. Show d1 = d2. 16 OMC 2011 Generating functions Lecture 18 14. (Euler’s pentagonal number theorem) Prove that ∞∏ n=1 (1 − xn) = ∑ k∈Z(−1) kxk(3k−1)/2 = 1 − x − x2 + x5 + x7 − x12 − x15 + · · · . Conclude that p(n) = ∑ k∈Z(−1) k−1p ( n − k(3k − 1) 2 ) . (Hint: One way to proceed is to distribute the (1 − x) in each term, then distribute the (1 − x2), and so on; proceed by induction after coming up with a suitable statement in terms of k. Combinatorial approaches are also possible.) 15. Show that ∞∏ n=1 1 1 − xn = 1 + ∞∑ m=1 xm2 (1 − x)2(1 − x2)2 · · · (1 − xm)2 . (Hint: Given a partition, its corresponding Ferrers diagram is a left-justiﬁed array of dots with k rows, where there are λi dots in the ith row. The Durfee square of a Ferrers diagram is the largest square of dots, at the upper left hand corner of the diagram. How does the Durfee square split up the Ferrers diagram?) 16. (AwesomeMath Team Contest 2010, Brian Basham) Fatty McButterpants is bored and decides to toss stones into two buckets. Both buckets start with no stones, and every second he throws a stone into the ﬁrst bucket, the second bucket, or no buckets, each with probability 1 3. After n seconds, what is the probability that the number of stones in each bucket is divisible by 3? 17. (Mathematical Reﬂections, O107) Let p1, p2, p3 be distinct primes and let n be a positive integer. Find the number of functions f : {1, 2, . . . , 2n} → {p1, p2, p3} for which f (1)f (2) · · · f (2n) is a perfect square. 18. How many subsets of {1, 2, . . . , 2000} have sum of elements divisible by 5? 19. Let p and q be distinct primes greater than 2. How many subsets of size pq in {1, 2, . . . , 2pq} have sum divisible by pq? 20. (ISL 2002/A5) Let m and n be integers greater than 1 and let a1, . . . , an be integers, none of which is divisible by mn−1. Prove that we can ﬁnd integers e1, . . . , en, not all zero, such that |ei| < m for all i and m n|e1a1 + · · · + enan. 21. (Putnam 1992) For nonnegative integers n and k, deﬁne Q(n, k) to be the coeﬃcient of xk in the expansion of (1 + x + x2 + x3) n. Prove that Q(n, k) = n∑ j=0 (n j )( n k − 2j ) . 22. (Putnam 1997/B4) Let am,n denote the coeﬃcient of xn in the expansion of (1 + x + x2)m. Prove that for all k ≥ 0, 0 ≤ ⌊2k/3⌋∑ i=0 (−1)iak−i,i ≤ 1. 17 OMC 2011 Generating functions Lecture 18 23. (Putnam 1999/B3) Let A = {(x, y) : 0 ≤ x, y < 1}. For (x, y) ∈ A, let S(x, y) = ∑ 1 2 ≤ m n ≤2 xmyn, where the sum ranges over all pairs (m, n) of positive integers satisfying the indi- cated inequalities. Evaluate lim (x,y)→1,(x,y)∈A(1 − xy2)(1 − x2y)S(x, y). 24. (Putnam 2003/A6) For a set S of nonnegative integers, let rS(n) denote the number of ordered pairs (s1, s2) such that s1 ∈ S, s2 ∈ S, s1 ̸= s2, and s1 + s2 = n. Is it possible to partition the nonnegative integers into two sets A and B in such a way that rA(n) = rB(n) for all n? 25. (Putnam 2005/B4) For positive integers m and n, let f (m, n) denote the number of n-tuples (x1, . . . , xn) of integers such that |x1| + · · · + |xn| ≤ m. Show that f (m, n) = f (n, m). 26. Start with a ﬁnite number of chips placed on the integers on a number line; suppose ci chips are placed on i. Let m and n be positive integers such that n > m. At each step, we may remove m + n chips from an integer i and place 1 chip on i + 1 and mn chips on i − 1. Suppose for each integer i, there is a time after which the number of chips on i is constant. Let di be this constant. Prove that ∑ i∈Z cini = ∑ i∈Z dini. Is this true for n replaced by m? 6 Appendix Note the deﬁnition (m n ) = m n n! = m(m − 1) · · · (m − n + 1) n! , m ∈ R, n ∈ N0. 18 OMC 2011 Generating functions Lecture 18 Sequence Generating function Closed form 1, 1, 1, . . . ∞∑ n=0 xn 1 1 − x 1, −1, 1, . . . ∞∑ n=0(−1)nxn 1 1 + x 1, r, r2, . . . ∞∑ n=0 rnxn 1 1 − rx 1, 0, . . . , 0 | {z } k 1, 0, . . . , 1, . . . ∞∑ n=0 xnk 1 1 − xk ( m 0 ) , (m 1 ) , . . . , ( m m ) , m ∈ N m∑ n=0 ( m n ) xn (1 + x) m (r 0 ), (r 1 ), (r 2 ) . . ., r ∈ R ∞∑ n=0 (r n ) xn (1 + x) r ( r r ) , (r + 1 r ), ( r + 2 r ) , . . . ∞∑ n=0 (r + n r ) xn 1 (1 − x)r 1, 1 1! , 1 2!, 1 3!, . . . ∞∑ n=0 1 n!xn e x 1, 0, − 1 2!, 0, 1 4!, . . . ∞∑ n=0 (−1)n (2n)! x2n cos x 0, 1 1!, 0, − 1 3!, . . . ∞∑ n=0 (−1) n (2n + 1)! x2n+1 sin x 1, 0, 1 2!, 0, 1 4!, . . . ∞∑ n=0 1 (2n)! x2n cosh x = e x + e−x 2 0, 1 1!, 0, 1 3!, . . . ∞∑ n=0 1 (2n + 1)! x2n+1 sinh x = e x − e −x 2 0, 1, −1 2 , 1 3, −1 4 , . . . ∞∑ n=1 (−1) n−1 n xn ln(1 + x) Let f (x) = ∑∞ n=0 anxn, g(x) = ∑∞ n=0 bnxn. Sequence Generating function can + bn cf + g an−m xmf an+m f − am−1xm−1 − · · · − a0 xm cnan f (cx) an/m (0 if m ∤ n) f (xm) (n + 1)an+1 f ′ nan xf ′ anb0 + · · · + a0bn f g a0 + · · · + an 1 1 − xf an−1 n , n ≥ 1 ∫ x 0 f (u) du 19 OMC 2011 Generating functions Lecture 18 References [1] Andreescu, T.; Dospinescu, G.: Problems from The Book. XYZ Press, Allen TX, 2008. [2] L. Graham, D. Knuth, and O. Patashnik. Concrete Mathematics: A Foundation for Computer Science. Addison-Wesley, 1989. [3] P. Flajolet and R. Sedgewick. Analytic Combinatorics. Cambridge University Press, 2009. http://algo.inria.fr/flajolet/Publications/book.pdf. [4] H. Wilf. generatingfunctionology. Academic Press, Inc., 1994. http://www.math. upenn.edu/~wilf/gfologyLinked2.pdf [5] Q. Yuan. Topics in Generating Functions, 2009. http://web.mit.edu/~qchu/ Public/TopicsInGF.pdf 20","libVersion":"0.3.1","langs":""}
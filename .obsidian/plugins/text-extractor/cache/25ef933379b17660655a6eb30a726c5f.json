{"path":"iCloudDrive/bks/OlympiadQPs/USAMO PYQ/2019.pdf","text":"USAMO 2019 Solution Notes Evan Chen《陳誼廷》 10 August 2023 This is a compilation of solutions for the 2019 USAMO. Some of the solutions are my own work, but many are from the official solutions provided by the organizers (for which they hold any copyrights), and others were found by users on the Art of Problem Solving forums. These notes will tend to be a bit more advanced and terse than the “official” solutions from the organizers. In particular, if a theorem or technique is not known to beginners but is still considered “standard”, then I often prefer to use this theory anyways, rather than try to work around or conceal it. For example, in geometry problems I typically use directed angles without further comment, rather than awkwardly work around configuration issues. Similarly, sentences like “let R denote the set of real numbers” are typically omitted entirely. Corrections and comments are welcome! Contents 0 Problems 2 1 Solutions to Day 1 3 1.1 USAMO 2019/1, proposed by Evan Chen . . . . . . . . . . . . . . . . . . 3 1.2 USAMO 2019/2, proposed by Ankan Bhattacharya . . . . . . . . . . . . . 5 1.3 USAMO 2019/3, proposed by Titu Andreescu, Vlad Matei, Cosmin Pohoata 8 2 Solutions to Day 2 10 2.1 USAMO 2019/4, proposed by Ricky Liu . . . . . . . . . . . . . . . . . . . 10 2.2 USAMO 2019/5, proposed by Yannick Yao . . . . . . . . . . . . . . . . . 11 2.3 USAMO 2019/6, proposed by Titu Andreescu, Gabriel Dospinescu . . . . 12 1 USAMO 2019 Solution Notes web.evanchen.cc, updated 10 August 2023 §0 Problems 1. A function f : N → N satisfies f (f (. . . f | {z } f (n) times (n) . . . )) = n2 f (f (n)) for all positive integers n. What are all possible values of f (1000)? 2. Let ABCD be a cyclic quadrilateral satisfying AD2 + BC2 = AB2. The diagonals of ABCD intersect at E. Let P be a point on side AB satisfying ∠AP D = ∠BP C. Show that line P E bisects CD. 3. Let K be the set of positive integers not containing the decimal digit 7. Determine all polynomials f (x) with nonnegative coefficients such that f (x) ∈ K for all x ∈ K. 4. Let n be a nonnegative integer. Determine the number of ways to choose sets Sij ⊆ {1, 2, . . . , 2n}, for all 0 ≤ i ≤ n and 0 ≤ j ≤ n (not necessarily distinct), such that • |Sij| = i + j, and • Sij ⊆ Skl if 0 ≤ i ≤ k ≤ n and 0 ≤ j ≤ l ≤ n. 5. Let m and n be relatively prime positive integers. The numbers m n and n m are written on a blackboard. At any point, Evan may pick two of the numbers x and y written on the board and write either their arithmetic mean 1 2 (x + y) or their harmonic mean 2xy x+y . For which (m, n) can Evan write 1 on the board in finitely many steps? 6. Find all polynomials P with real coefficients such that P (x) yz + P (y) zx + P (z) xy = P (x − y) + P (y − z) + P (z − x) for all nonzero real numbers x, y, z obeying 2xyz = x + y + z. 2 USAMO 2019 Solution Notes web.evanchen.cc, updated 10 August 2023 §1 Solutions to Day 1 §1.1 USAMO 2019/1, proposed by Evan Chen Available online at https://aops.com/community/p12189527. Problem statement A function f : N → N satisfies f (f (. . . f | {z } f (n) times (n) . . . )) = n2 f (f (n)) for all positive integers n. What are all possible values of f (1000)? Actually, we classify all such functions: f can be any function which fixes odd integers and acts as an involution on the even integers. In particular, f (1000) may be any even integer. It’s easy to check that these all work, so now we check they are the only solutions. Claim — f is injective. Proof. If f (a) = f (b), then a2 = f f (a)(a)f (f (a)) = f f (b)(b)f (f (b)) = b2, so a = b. Claim — f fixes the odd integers. Proof. We prove this by induction on odd n ≥ 1. Assume f fixes S = {1, 3, . . . , n − 2} now (allowing S = ∅ for n = 1). Now we have that f f (n)(n) · f 2(n) = n2. However, neither of the two factors on the left-hand side can be in S since f was injective. Therefore they must both be n, and we have f 2(n) = n. Now let y = f (n), so f (y) = n. Substituting y into the given yields y2 = f n(y) · y = f n+1(n) · y = ny since n + 1 is even. We conclude n = y, as desired. Thus, f maps even integers to even integers. In light of this, we may let g = f (f (n)) (which is also injective), so we conclude that gf (n)/2(n)g(n) = n2 for n = 2, 4, . . . . Claim — The function g is the identity function. 3 USAMO 2019 Solution Notes web.evanchen.cc, updated 10 August 2023 Proof. The proof is similar to the earlier proof of the claim. Note that g fixes the odd integers already. We proceed by induction to show g fixes the even integers; so assume g fixes the set S = {1, 2, . . . , n − 1}, for some even integer n ≥ 2. In the equation gf (n)/2(n) · g(n) = n2 neither of the two factors may be less than n. So they must both be n. These three claims imply that the solutions we claimed earlier are the only ones. Remark. The last claim is not necessary to solve the problem; after realizing f and injective fixes the odd integers, this answers the question about the values of f (1000). However, we chose to present the “full” solution anyways. Remark. After noting f is injective, another approach is outlined below. Starting from any n, consider the sequence n, f (n), f (f (n)), and so on. We may let m be the smallest term of the sequence; then m2 = f (f (m))·f f (m)(m) which forces f (f (m)) = f f (m)(m) = m by minimality. Thus the sequence is 2-periodic. Therefore, f (f (n)) = n always holds, which is enough to finish. ¶ Authorship comments I will tell you a great story about this problem. Two days before the start of grading of USAMO 2017, I had a dream that I was grading a functional equation. When I woke up, I wrote it down, and it was f f (n)(n) = n2 f (f (n)) . You can guess the rest of the story (and imagine how surprised I was the solution set was interesting). I guess some dreams do come true, huh? 4 USAMO 2019 Solution Notes web.evanchen.cc, updated 10 August 2023 §1.2 USAMO 2019/2, proposed by Ankan Bhattacharya Available online at https://aops.com/community/p12189455. Problem statement Let ABCD be a cyclic quadrilateral satisfying AD2 + BC2 = AB2. The diagonals of ABCD intersect at E. Let P be a point on side AB satisfying ∠AP D = ∠BP C. Show that line P E bisects CD. Here are three solutions. The first two are similar although the first one makes use of symmedians. The last solution by inversion is more advanced. ¶ First solution using symmedians We define point P to obey AP BP = AD2 BC2 = AE2 BE2 so that P E is the E-symmedian of △EAB, therefore the E-median of △ECD. Now, note that AD2 = AP · AB and BC2 = BP · BA. This implies △AP D ∼ △ADB and △BP C ∼ △BCA. Thus ∡DP A = ∡ADB = ∡ACB = ∡BCP and so P satisfies the condition as in the statement (and is the unique point to do so), as needed. ¶ Second solution using only angle chasing (by proposer) We again re-define P to obey AD2 = AP · AB and BC2 = BP · BA. As before, this gives △AP D ∼ △ABD and △BP C ∼ △BDP and so we let θ := ∡DP A = ∡ADB = ∡ACB = ∡BCP. Our goal is to now show P E bisects CD. Let K = AC ∩ P D and L = AD ∩ P C. Since ∡KP A = θ = ∡ACB, quadrilateral BP KC is cyclic. Similarly, so is AP LD. 5 USAMO 2019 Solution Notes web.evanchen.cc, updated 10 August 2023 A B D P C K L E Finally AKLB is cyclic since ∡BKA = ∡BKC = ∡BP C = θ = ∡DP A = ∡DLA = ∡BLA. This implies ∡CKL = ∡LBA = ∡DCK, so KL ∥ BC. Then P E bisects BC by Ceva’s theorem on △P CD. ¶ Third solution (using inversion) By hypothesis, the circle ωa centered at A with radius AD is orthogonal to the circle ωb centered at B with radius BC. For brevity, we let Ia and Ib denote inversion with respect to ωa and ωb. We let P denote the intersection of AB with the radical axis of ωa and ωb; hence P = Ia(B) = Ib(A). This already implies that ∡DP A Ia= ∡ADB = ∡ACB Ib= ∡BP C so P satisfies the angle condition. A B D P C K L 6 USAMO 2019 Solution Notes web.evanchen.cc, updated 10 August 2023 Claim — The point K = Ia(C) lies on ωb and DP . Similarly L = Ib(D) lies on ωa and CP . Proof. The first assertion follows from the fact that ωb is orthogonal to ωa. For the other, since (BCD) passes through A, it follows P = Ia(B), K = Ia(C), and D = Ia(D) are collinear. Finally, since C, L, P are collinear, we get A is concyclic with K = Ia(C), L = Ia(L), B = Ia(B), i.e. that AKLB is cyclic. So KL ∥ CD by Reim’s theorem, and hence P E bisects CD by Ceva’s theorem. 7 USAMO 2019 Solution Notes web.evanchen.cc, updated 10 August 2023 §1.3 USAMO 2019/3, proposed by Titu Andreescu, Vlad Matei, Cosmin Pohoata Available online at https://aops.com/community/p12189457. Problem statement Let K be the set of positive integers not containing the decimal digit 7. Determine all polynomials f (x) with nonnegative coefficients such that f (x) ∈ K for all x ∈ K. The answer is only the obvious ones: f (x) = 10ex, f (x) = k, and f (x) = 10ex + k, for any choice of k ∈ K and e > log10 k (with e ≥ 0). Now assume f satisfies f (K) ⊆ K; such polynomials will be called stable. We first prove the following claim which reduces the problem to the study of monomials. Lemma (Reduction to monomials) If f (x) = a0 + a1x + a2x2 + . . . is stable, then each monomial a0, a1x, a2x2, . . .is stable. Proof. For any x ∈ K, plug in f (10ex) for large enough e: the decimal representation of f will contain a0, a1x, a2x2 with some zeros padded in between. Let’s tackle the linear case next. Here is an ugly but economical proof. Claim (Linear classification) — If f (x) = cx is stable, then c = 10e for some nonnegative integer e. Proof. We will show when c ̸= 10e then we can find x ∈ K such that cx starts with the digit 7. This can actually be done with the following explicit cases in terms of how c starts in decimal notation: • For 9 · 10e ≤ c < 10 · 10e, pick x = 8. • For 8 · 10e ≤ c < 9 · 10e, pick x = 88. • For 7 · 10e ≤ c < 8 · 10e, pick x = 1. • For 4.4 · 10e ≤ c < 7 · 10e, pick 11 ≤ x ≤ 16. • For 2.7 · 10e ≤ c < 4.4 · 10e, pick 18 ≤ x ≤ 26. • For 2 · 10e ≤ c < 2.7 · 10e, pick 28 ≤ x ≤ 36. • For 1.6 · 10e ≤ c < 2 · 10e, pick 38 ≤ x ≤ 46. • For 1.3 · 10e ≤ c < 1.6 · 10e, pick 48 ≤ x ≤ 56. • For 1.1 · 10e ≤ c < 1.3 · 10e, pick 58 ≤ x ≤ 66. • For 1 · 10e ≤ c < 1.1 · 10e, pick x = 699 . . . 9 for suitably many 9’s. The hardest part of the problem is the case where deg f > 1. We claim that no solutions exist then: 8 USAMO 2019 Solution Notes web.evanchen.cc, updated 10 August 2023 Claim (Higher-degree classification) — No monomial of the form f (x) = cxd is stable for any d > 1. Proof. Note that f (10x + 3) is stable too. Thus f (10x + 3) = 3d + 10d · 3 d−1x + 100(d 2 ) · 3 d−1x2 + . . . is stable. By applying the lemma the linear monomial 10d · 3d−1x is stable, so 10d · 3d−1 is a power of 10, which can only happen if d = 1. Thus the only nonconstant stable polynomials with nonnegative coefficients must be of the form f (x) = 10ex + k for e ≥ 0. It is straightforward to show we then need k < 10e and this finishes the proof. Remark. The official solution replaces the proof for f (x) = cx with Kronecker density. From f (1) = c ∈ K, we get f (c) = c 2 ∈ K, et cetera and hence c n ∈ K. But it is known that when c is not a power of 10, some power of c starts with any specified prefix. 9 USAMO 2019 Solution Notes web.evanchen.cc, updated 10 August 2023 §2 Solutions to Day 2 §2.1 USAMO 2019/4, proposed by Ricky Liu Available online at https://aops.com/community/p12195861. Problem statement Let n be a nonnegative integer. Determine the number of ways to choose sets Sij ⊆ {1, 2, . . . , 2n}, for all 0 ≤ i ≤ n and 0 ≤ j ≤ n (not necessarily distinct), such that • |Sij| = i + j, and • Sij ⊆ Skl if 0 ≤ i ≤ k ≤ n and 0 ≤ j ≤ l ≤ n. The answer is (2n)!·2n2. First, we note that ∅ = S00 ⊊ S01 ⊊ · · · ⊊ Snn = {1, . . . , 2n} and thus multiplying by (2n)! we may as well assume S0i = {1, . . . , i} and Sin = {1, . . . , n + i}. We illustrate this situation by placing the sets in a grid, as below for n = 4; our goal is to fill in the rest of the grid.       1234 12345 123456 1234567 12345678 123 12 1 ∅       We claim the number of ways to do so is 2n2. In fact, more strongly even the partial fillings are given exactly by powers of 2. Claim — Fix a choice T of cells we wish to fill in, such that whenever a cell is in T , so are all the cells above and left of it. (In other words, T is a Young tableau.) The number of ways to fill in these cells with sets satisfying the inclusion conditions is 2|T |. An example is shown below, with an indeterminate set marked in red (and the rest of T marked in blue).       1234 12345 123456 1234567 12345678 123 1234 12346 123467 12 124 1234 or 1246 1 12 ∅ 2       Proof. The proof is by induction on |T |, with |T | = 0 being vacuous. Now suppose we have a corner [ B C A S ] where A, B, C are fixed and S is to be chosen. Then we may write B = A ∪ {x} and C = A ∪ {x, y} for x, y /∈ A. Then the two choices of S are A ∪ {x} (i.e. B) and A ∪ {y}, and both of them are seen to be valid. In this way, we gain a factor of 2 any time we add one cell as above to T . Since we can achieve any Young tableau in this way, the induction is complete. 10 USAMO 2019 Solution Notes web.evanchen.cc, updated 10 August 2023 §2.2 USAMO 2019/5, proposed by Yannick Yao Available online at https://aops.com/community/p12195834. Problem statement Let m and n be relatively prime positive integers. The numbers m n and n m are written on a blackboard. At any point, Evan may pick two of the numbers x and y written on the board and write either their arithmetic mean 1 2 (x + y) or their harmonic mean 2xy x+y . For which (m, n) can Evan write 1 on the board in finitely many steps? We claim this is possible if and only m + n is a power of 2. Let q = m/n, so the numbers on the board are q and 1/q. Impossibility: The main idea is the following. Claim — Suppose p is an odd prime. Then if the initial numbers on the board are −1 (mod p), then all numbers on the board are −1 (mod p). Proof. Let a ≡ b ≡ −1 (mod p). Note that 2 ̸≡ 0 (mod p) and a + b ≡ −2 ̸≡ 0 (mod p). Thus a+b 2 and 2ab a+b both make sense modulo p and are equal to −1 (mod p). Thus if there exists any odd prime divisor p of m + n (implying p ∤ mn), then q ≡ 1 q ≡ −1 (mod p). and hence all numbers will be −1 (mod p) forever. This implies that it’s impossible to write 1, whenever m + n is divisible by some odd prime. Construction: Conversely, suppose m + n is a power of 2. We will actually construct 1 without even using the harmonic mean. q q−1q+q−1 2 3q+q−1 4 q+3q−1 4 7q+q−1 8 5q+3q−1 8 3q+5q−1 8 q+7q−1 8 Note that n m + n · q + m m + n · 1 q = 1 and obviously by taking appropriate midpoints (in a binary fashion) we can achieve this using arithmetic mean alone. 11 USAMO 2019 Solution Notes web.evanchen.cc, updated 10 August 2023 §2.3 USAMO 2019/6, proposed by Titu Andreescu, Gabriel Dospinescu Available online at https://aops.com/community/p12195858. Problem statement Find all polynomials P with real coefficients such that P (x) yz + P (y) zx + P (z) xy = P (x − y) + P (y − z) + P (z − x) for all nonzero real numbers x, y, z obeying 2xyz = x + y + z. The given can be rewritten as saying that Q(x, y, z) := xP (x) + yP (y) + zP (z) − xyz (P (x − y) + P (y − z) + P (z − x)) is a polynomial vanishing whenever xyz ̸= 0 and 2xyz = x + y + z, for real numbers x, y, z. Claim — This means Q(x, y, z) vanishes also for any complex numbers x, y, z obeying 2xyz = x + y + z. Proof. Indeed, this means that the rational function R(x, y) := Q ( x, y, x + y 2xy − 1 ) vanishes for any real numbers x and y such that xy ̸= 1 2 , x ̸= 0, y ̸= 0, x + y ̸= 0. This can only occur if R is identically zero as a rational function with real coefficients. If we then regard R as having complex coefficients, the conclusion then follows. Remark (Algebraic geometry digression on real dimension). Note here we use in an essential way that z can be solved for in terms of x and y. If s(x, y, z) = 2xyz − (x + y + z) is replaced with some general condition, the result may become false; e.g. we would certainly not expect the result to hold when s(x, y, z) = x2 + y2 + z2 − (xy + yz + zx) since for real numbers s = 0 only when x = y = z! The general condition we need here is that s(x, y, z) = 0 should have “real dimension two”. Here is a proof using this language, in our situation. Let M ⊂ R 3 be the surface s = 0. We first contend M is two-dimensional mani- fold. Indeed, the gradient ∇s = ⟨2yz − 1, 2zx − 1, 2xy − 1⟩ vanishes only at the points (±1/√2, ±1/√2, ±1/√2) where the ± signs are all taken to be the same. These points do not lie on M , so the result follows by the regular value theorem. In particular the topological closure of points on M with xyz ̸= 0 is all of M itself; so Q vanishes on all of M . If we now identify M with the semi-algebraic set consisting of maximal ideals (x − a, y − b, z − c) in Spec R[x, y, z] satisfying 2abc = a + b + c, then we have real dimension two, and thus the Zariski closure of M is a two-dimensional closed subset of Spec R[x, y, z]. Thus it must be Z = V(2xyz − (x + y + z)), since this Z is an irreducible two-dimensional closed subset (say, by Krull’s principal ideal theorem) containing M . Now Q is a global section vanishing on all of Z, therefore Q is contained in the (radical, principal) ideal (2xyz − (x + y + z)) as needed. So it is actually divisible by 2xyz − (x + y + z) as desired. 12 USAMO 2019 Solution Notes web.evanchen.cc, updated 10 August 2023 Now we regard P and Q as complex polynomials instead. First, note that substituting (x, y, z) = (t, −t, 0) implies P is even. We then substitute (x, y, z) = ( x, i √2 , −i √2 ) to get xP (x) + i √2 ( P ( i √2 ) − P ( −i √2 )) = 1 2 x (P (x − i/√2) + P (x + i/ √2) + P (√2i) ) which in particular implies that P (x + i √2 ) + P ( x − i √2 ) − 2P (x) ≡ P ( √2i) identically in x. The left-hand side is a second-order finite difference in x (up to scaling the argument), and the right-hand side is constant, so this implies deg P ≤ 2. Since P is even and deg P ≤ 2, we must have P (x) = cx2 + d for some real numbers c and d. A quick check now gives the answer P (x) = c(x2 + 3) which all work. 13","libVersion":"0.3.1","langs":""}
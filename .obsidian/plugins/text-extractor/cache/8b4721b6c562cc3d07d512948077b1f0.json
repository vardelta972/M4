{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Kimball Martin/NT 2 (To the skies)/Notes (Individual sections)/chap1.pdf","text":"Part I The ﬁrst part 1 Number Fields I will assume that every one is familiar with the material in the ﬁrst year algebra sequence, notably groups, rings, ﬁelds, ideals and Galois theory, as well as the material from Number Theory I, though I will review some of the key deﬁnitions and results which the undergraduates may not be familiar with, and perhaps the graduate students have forgotten. In this ﬁrst section, we will go over the basics of number ﬁelds, which will largely be a review of the second half of last semester, with some generalizations of notions introduced in the context of quadratic ﬁelds. However some fundamental notions will be new to us, such as discriminants. We will for the most part omit proofs of results covered last semester (even if we only sketched the proof) or in a standard Algebra course. For complete proofs, refer to any standard texts on Algebra and Algebraic Number Theory. Since the material in this chapter should be largely familiar to you, and the point is to ﬁll in some things we missed last semester, we will go through this section rather quickly. The presentation of the material in this chapter is based on [Stewart–Tall]. 1.1 Algebraic Numbers Let R[x] denote the ring of polynomials in x with coeﬃcients in a ring R.We say p(x) ∈ R[x] is monic if the leading coeﬃcient of p(x) is 1. (All rings for us are commutative with 1.) By the Fundamental Theorem of Algebra, any polynomial in Q[x] factors into linear factors in C.We say α ∈ C is an algebraic number if it is the root of some p(x) ∈ Q[x] (or equivalently a polynomial in Z[x], but then we can’t assume it’s monic). Without loss of generality we may assume p(x) is monic. If p(x) is of smallest degree such that this is true, and we say p(x) is the minimum polynomial of α (over Q), and the degree deg(α) of α deﬁned to be the deg(p(x)). If in fact p(x) ∈ Z[x],we say α is an algebraic integer. Some basic facts from algebra are that (i) the minimum polynomial p(x) of α is uniquely determined (which is why we make the monic condition), (ii) p(x) is irreducible over Q (and therefore Z if p(x) ∈ Z[x]), and (iii) if q(x) ∈ Z[x] and q(α)=0, then p(x)|q(x) (in Q[x] or Z[x] if p(x) ∈ Z[x]). Lemma 1.1.1. Let α ∈ C.Then [Z[α]: Z] < ∞ if and only if α is an algebraic integer. In this case ￿1, α, ·· · , αm−1￿ is a Z-basis of Z[α] where m =deg(α). This was Proposition 10.9 from last semester. Lemma 1.1.2. Suppose α is an algebraic number. Then cα is an algebraic integer for some c ∈ Z. Proof. Suppose the minimum polynomial for α is p(x)= xn + an−1 bn−1 xn−1 + ·· · + a1 b1 x + a0 b0 where each ai,bi ∈ Z. Let c = b0b1 ·· · bn−1. Then p( y c )= yn cn + an−1 bn−1cn−1 yn−1 + ·· · + a1 b1c y + a0 b0 .Multiplying by cn, we see q(y)= c np( y c )= yn + an−1c bn−1 yn−1 + ·· · a1cn−1 b1 y + a0cn b0 ∈ Z[y]. But q(cα)= cnp(α)=0,so y is an algebraic integer. 4 Recall from algebra that if R is an integral domain (not the zero ring and has no zero di- visors), we can form the smallest ﬁeld F containing R by considering the set of fractions F =￿ a b : a, b ∈ R, b ￿=0 ￿. This is called the ﬁeld of fractions or fraction ﬁeld of R. Theorem 1.1.3. The set B of all algebraic integers form a subring of C,and the set A of all algebraic numbers form its ﬁeld of fractions. We omitted the proof last semester, so here it is, in all its glory. Proof. Note that by the Lemma 1.1.1, B consists precisely of all elements α ∈ C such that [Z[α]: Z] < ∞.To show it is a subring of C,we want to show if α, β ∈ B, then so are α + β, α − β and αβ. But these elements are all clearly in Z[α, β],and [Z[α, β]: Z]=[Z[α, β]: Z[α]] · [Z[α]: Z] ≤ [Z[β]: Z] · [Z[α]: Z] < ∞. Since Z[α + β], Z[α − β] and Z[αβ] are all contained in Z[α, β], they must all have ﬁnite degree. To see that A is its ﬁeld of fractions, one runs through the same argument for ﬁelds. Namely, one shows that [Q(α): Q] < ∞ if and only if α is algebraic. The above argument shows A is a ﬁeld. Lemma 1.1.2 shows that any element of A is a quotient of two elements in B. Exercise 1.1. Show by example that [Z[α, β]: Z[α]] need not equal [Z[β]: Z]. Deﬁnition 1.1.4. Let K be a subﬁeld of C We say K is a number ﬁeld if [K : Q] < ∞.Its ring of integers is OK = B ∩ K. From now on we let K denote a number ﬁeld. Proposition 1.1.5. K is the ﬁeld of fractions of OK. This follows from Lemma 1.1.2 as in the proof of Theorem 1.1.3. Proposition 1.1.6. We have K = Q(α) for some algebraic integer α. This is the Primitive Element Theorem from Galois theory. Here α is called a primitive element for K (over Q). Proposition 1.1.7. We have [K : Q]=[OK : Z]. Proof. Let α1,. .., αn be a Z-basis for OK. By Lemma 1.1.2, any x ∈ K is a Q-linear combination of α1,. .., αn. Hence to see α1,. .., αn is a Q-basis for K it suﬃces to show they are linearly independent of Q.Suppose a1 b1 α1 + ·· · + an bn αn =0 for some ai,bi ∈ Z.Multiplying through by b1b2 ·· · bn, the fact that the αi’s are linearly independent over Z (and no bi =0) implies each ai =0. If L ⊆ C is a ﬁeld containing K and [L : K] is ﬁnite, we say L is a ﬁnite extension of K of degree [L : K]. Clearly this means L is also a number ﬁeld since [L : Q]=[L : K] · [K : Q]. Corollary 1.1.8. If L is a ﬁnite extension of K,then [L : K]= [OL : OK]. Proof. [L : K]=[L : Q]/[K : Q]= [OL : Z]/[OK : Z]= [OL : OK]. 5 Suppose K is a quadratic ﬁeld, i.e., [K : Q]=2. Recall that we may write K = Q( √d) where d ∈ Z is squarefree (and d ￿=1). Recall d squarefree means n2|d =⇒ n2 =1. Example 1.1.9. Suppose d ∈ Z is squarefree, d ￿=1,andlet K = Q( √d).Then OK = ￿ Z[ 1+√d 2 ] d ≡ 1 mod 4 Z[ √d] d ≡ 2, 3 mod 4. If d> 0,we say K is a real quadratic ﬁeld since K ⊆ R. There are inﬁnitely many units of OK,and they are generated by a fundamental unit ￿ = x + y√n (the smallest ￿ > 1 such that N (￿)= x2 − ny2 = ±1)and −1. If d< 0,we say K is an imaginary quadratic ﬁeld since K ￿⊆ R.Here there are only ﬁnitely many units of OK,and precisely they are ±1, ±i (the 4-th roots of unity) if d = −1;they are ±1, ±ζ3, ±ζ 2 3 (the 6-th roots of unity) if d = −3;and they are ±1 (the 2-nd roots of unity) otherwise. (Recall the units of a ring R are the set of invertible elements and they are a group under multiplication.) 1.2 Some Galois theory Let L/K be an extension of number ﬁelds of degree n, i.e., [L : K]= n. An embedding of L ￿→ C is a ﬁeld homomorphism from L into C, i.e., a map σ : L → C such that σ(x + y)= σ(x)+ σ(y), σ(xy)= σ(x)σ(y), σ(−x)= −σ(x) and σ(x−1)= σ(x)−1. Necessarily σ(0) = 0, σ(1) = 1,and consequently σ ﬁxes Q, i.e., σ(x)= x for each x ∈ Q. Example 1.2.1. Let L = Q(i).A Q-basis for L is {1,i}.If σ : L ￿→ C is an embedding, it ﬁxes 1,so it is determined by what it does to i.We must have σ(i)2 = σ(i2)= σ(−1) = −1 so i must map to a square root of −1,i.e.,either i or −i.One may check that both of these give embeddings, σj : Q(i) → C given by σ1(a + bi)= a + bi (the trivial embedding), and σ2(a + bi)= a − bi (complex conjugation). The Galois group of L/K, denoted Gal(L/K) is the group of all embeddings of L ￿→ C which ﬁx (each element of) K. The Galois closure of L/K is the smallest extension L￿ of L such that each σ ∈ Gal(L/K) maps into L￿. We say the extension L/K is Galois if L￿ = L. Example 1.2.2. K = Q and L = Q(i).Every embedding of L into C ﬁxes K,so Gal(L/K)= {σ1, σ2} from the example above. Every embedding lies in L,so L/K is Galois. By the Primitive Element Theorem, we may write L = K(α) where α is an algebraic integer. Let f (x) ∈ K[x] be the minimum polynomial for α over K. This means f (x) is the irreducible monic polynomial of smallest possible degree with coeﬃcients in K (in fact OK since α is an integer) such that f (α)= 0. It is not diﬃcult to show that deg(f (x)) = n (in fact, we already did in the case K = Q). Example 1.2.3. K = Q( √2) and L = Q( 4√2) = K(α) where α2 = √2 ∈ K.The minimum polynomial for α over K is f (x)= x2 − √2.(Contrast this with the minimum polynomial for α over Q: p(x)= x4 − 2,ofdegree4). Exercise 1.2. In the above example, show L/K is Galois, but L/Q is not. 6 Theorem 1.2.4. Suppose L = K(α) and f (x) is the minimum polynomial of α over K.The n roots of f (x) are all distinct, call them α = α1, α2,. .., αn.Every embedding of L ￿→ C permutes the roots f (x),and Gal(L/K) acts transitively on the roots. Conversely, every embedding L ￿→ C is uniquely determined by the way it permutes the roots of f (x).Therefore, Gal(L/K) is isomorphic to a transitive subgroup of Sn.Further the Galois closure of L/K is L￿ = K(α1, α2,. .., αn),i.e., L/K is Galois if and only if L contains all the root of f (x). See any reference on Galois theory. Here Sn denotes the symmetric group on n-letters, i.e., the permutations of {1, 2,. .., n}.Note that L￿ = K(α1,. .., αn) is often called the splitting ﬁeld of f (x) (over K), since it is the smallest ﬁeld such that f (x) splits into linear factors. Corollary 1.2.5. Any quadratic extension L/K (i.e., [L : K]=2)isGalois. Proof. Write L = K(α) and f (x) as the minimum polynomial for α over K. It is immediate from the quadratic formula that once L contains one root of f (x), it contains the other. Hence L/K is Galois by the above theorem. Example 1.2.6. Let n> 0. The splitting ﬁeld for f (x)= x2 +n over K = Q is L = Q( √−n).This also splits the quadratic form x2 + ny2.The extension L/K is Galois by the above corollary, and the Galois group is given by the maps σ1(a + b√−n)= a + b√−n and σ2(a + b√−n)= a − b√−n. The map σ1 corresponds to the trivial permutation of the roots ± √−n of f (x),and σ2 interchanges these two roots. Exercise 1.3. Let K = Q and L = Q( 3√2).Determine the splitting polynomial f (x) for α = 3√2 over K.Using the above theorem, answer the following.(i) Is L/K Galois? If not, ﬁnd the Galois closure. (ii) Determine Gal(L/K) explicitly (either as embeddings or permutations of roots of f (x). All of the above is covered in any standard lectures on Galois theory (though we haven’t stated the main theorems of Galois theory), but now we will be introducing notions that are more properly a part of a course on Algebraic Number Theory. Deﬁnition 1.2.7. Let α ∈ L.The conjugates of α in L/K are the elements ασ = σ(α) where σ ∈ Gal(L/K).The norm of α from L to K is NL/K(α)= ￿σ∈Gal(L/K) ασ and the trace of α from L to K is TrL/K(α)= ￿ σ∈Gal(L/K) ασ. In the case K = Q and L is understood, we simply write N (α) and Tr(α) for NL/K(α) and TrL/K(α). It is a standard fact from Galois theory that α ∈ L in fact lies in K if and only if ασ = α for each σ ∈ Gal(L/K). Warning: If L/K is not Galois, then the conjugates of α in L/K may not lie in L. Precisely, if L/K is not Galois, then there exist σ ∈ Gal(L/K) such that the image of σ is not contained in L. Hence there is some α ∈ L such that the conjugate σ(L) ￿∈ L. What is true is that they always lie in the Galois closure L￿ of L, by deﬁnition of the Galois closure. Example 1.2.8. Let L = Q( √d) and K = Q.For α = a + b√d ∈ L, NL/K(α)= N (α)= a2 − db2 and TrL/K(α)=Tr(α)= 2a. Lemma 1.2.9. The norm map is multiplicative and the trace map is additive. For α ∈ L, NL/K(α), TrL/K(α) ∈ K.Further, if α ∈ OL,then NL/K(α) ∈ OK and TrL/K(α) ∈ OK. 7 Proof. The ﬁrst statement is immediate from the deﬁnitions. The second statement is true since the product and sum of all the conjugates of α are invariant under Gal(L/K), and therefore lie in K. For the last statement, observe α is an algebraic integer if and only if each of its conjugates are (since they all have the same minimum polynomial). Corollary 1.2.10. Let α be an algebraic number of degree 2 and L = Q(α).Then α is an algebraic integer if and only if NL/Q(α), TrL/Q(α) ∈ Z. Proof. The ⇒ direction follows from the lemma. The other direction follows from the fact that the minimum polynomial of α is x2 − TrL/Q(α)x + NL/Q(α), which was an exercise last semester. Note that this is not true for algebraic numbers of higher degree. In general if α is of degree n, one needs to consider the symmetric functions τj : L → Q where L = Q(α) and τj(x) is the sum of all products of j conjugates. For instance if x1 = x, x2,. .., xn denote the n conjugates (not necessarily distinct numbers) of x, then τ1(x)=x1 + x2 + .. . + xn =TrL/Q(x) τ2(x)=x1x2 + x1x3 + ·· · + x1xn + x2x3 + ·· · x2xn + ·· · + xn−1xn ... τn(x)=x1x2 ·· · xn = NL/Q(x). Then one can show the minimum polynomial for α is x n +(−1) n−1τ1(α)x n−1 + ·· · − τn−1(α)x + τn(α). Exercise 1.4. Suppose α, β ∈ L are conjugates in L/K.Show NL/K(α)= NL/K(β) and TrL/K(α)= TrL/K(β). Exercise 1.5. Let α ∈ OK.Prove α is a unit of OK if and only if NK/Q(α)= ±1. Exercise 1.6. Write down a Q-basis for K = Q( 3√2).For each α in this basis, compute NK/Q(α) and TrK/Q(α). Exercise 1.7. Let K = Q( √2) and L = K( √3) = Q( √2, √3).Write down a Q-basis for L. Compute Gal(L/K) and Gal(L/Q).(Hint for those who haven’t seen Galois theory before: it’s not so easy to ﬁnd a primitive element for L/Q and determine its minimum polynomial, so it’s better to just use the deﬁnition of the Galois group. Of course, if you know Galois theory, there are other ways to determine Gal(L/Q) and you may do it any you like.) For each α in this basis compute NL/K(α) and NL/Q(α).Check that NL/Q(α)= NK/Q(NL/K(α)). One thing you may have noticed in the examples and exercises above is that Gal(L/K) tends to equal [L : K]. In fact this is always true and is one of the standard results in Galois theory, though you may have only proved it for Galois extensions. Proposition 1.2.11. |Gal(L/K)| =[L : K]. Proof. Write L = K(α). Then 1, α,.. ., αn−1 is a Q-basis for K. Thus an embedding σ : L → C which ﬁxes every element of K is determined by what it does to α. Let f (x) be the minimum polynomial of α, which has degree n =[L : K]. Since σ is a ﬁeld homomorphism, σ(α) must also have minimum polynomial f (x). Since f (x) has n distinct roots, α = α1, α2,. .., αn, there are n possibilities for σ ∈ Gal(L/K) given by σ(α)= αi. One formally checks that each of these give an embedding into C. 8 1.3 Discriminants Let K be a number ﬁeld, n =[K : Q]. Then |Gal(K/Q)| = n.Write Gal(K/Q)= {α1,. .., αn}. Deﬁnition 1.3.1. Let {α1,. .., αn} be a Q-basis for K.The discriminant of {α1,. .., αn} is ∆[α1,. .., αn]=det (σi(αj)) 2 . If α1,. .., αn is a Z-basis for OK, we deﬁne the discriminant of K to be ∆K = ∆[α1,. .., αn]. If R is a ring, we deﬁne the Mn(R) to be the set of n × n matrices with coeﬃcients in R. This is also a ring, with the obvious identity element, and the invertible elements of Mn(R) form a group under multiplication, denoted by GLn(R), and called the general linear group of rank n over R. If R is an integral domain, then A ∈ Mn(R) lies in GLn(R) if and only if det(A) is a unit in R. Lemma 1.3.2. Let {α1,. .., αn} and {β1,. .., βn} be two Q-bases for K.Then we can write      β1 β2 ... βn      = C      α1 α2 ... αn      for some C ∈ GLn(Q).Then ∆[β1,. .., βn]=det(C)2∆[α1,. .., αn]. Further, if {α1,. .., αn} and {β1,. .., βn} are Z-bases (also called integral bases)for OK,then we may take C ∈ GLn(Z).in the above.Consequently, ∆[β1,. .., βn]= ∆[α1,. .., αn],i.e., ∆K does not depend on the choice of the integral basis for OK. Proof. The fact that there is some such C is elementary linear algebra. The equation about deter- minants follows from (σi(βj)) = C (σi(αj)), which holds because each σi ﬁxes Q. (If this isn’t clear to you, just write out the equations βk = ￿ cjkαj for, say n =2 or 3, and apply each σi.) The second paragraph follows in the same way. Here we note that if C ∈ GLn(Z), then det(C)= ±1,so det(C)2 =1. This provides at least one explanation for why we look at the square of the determinant in the deﬁnition of the discriminant—so that we can deﬁne ∆K as an invariant of a number ﬁeld, independent of choice of basis for OK. Exercise 1.8. Apriori, thediscriminant ∆[α1,. .., αn] is deﬁned for an ordered Q-basis α1,. .., αn of K.Show that the above lemma implies this discriminant does not depend upon the order, i.e., for any τ ∈ Sn,show ∆[ατ (1),. .., ατ (n)]= ∆[α1,. .., αn]. Note: the quantity det(σi(αj)), which is one of the square roots of the discriminant, is called the diﬀerent of {α1, α2, ·· · , αn}. We will not use the diﬀerent in this course (I don’t think), but you may see come up if it you look at other texts. A note on terminology: one can form the diﬀerent and discriminant for an arbitrary collection of n integers α1,. .., αn. Then the discriminant and diﬀerent are nonzero if and only if α1,. .., αn are linearly independent, i.e., form a Q-basis for K. Furthermore, if α1,. .., αn and β1,. .., βn have diﬀerent discriminants then the submodules M = { ￿ niαi : ni ∈ Z} and N = {￿ niβi : ni ∈ Z} are distinct. 9 Example 1.3.3. Let d ￿=1 be a squarefree integer and K = Q( √d).Suppose d ≡ 2, 3 mod 4 so OK = Z[ √d].We can take {α1, α2} = ￿ 1, √d￿ as a choice for an integral basis for OK.We can write Gal(K/Q)= {σ1, σ2} where σ1 is trivial and σ2 permutes √d and − √d.Hence the matrix (σi(αj)) = ￿1 √d 1 − √d ￿ , which has determinant −2 √d.Hence the discriminant of K is ∆K = ∆[1, √d]=4d. Exercise 1.9. Let d ￿=1 be a squarefree integer and K = Q( √d).Suppose d ≡ 1 mod 4.Compute the discriminant ∆K of K. Lemma 1.3.4. Let α1,. .., αn be a Q-basis for K.Then ∆[α1,. .., αn] ∈ Q\\{0}.If α1,. .., αn ∈ OK,then ∆[α1,. .., αn] ∈ Z\\{0}. Proof. By the previous lemma, the discriminants of any two bases for K diﬀer by rational squares. Hence it suﬃces to check that it is true for a single Q-basis of K. Then the second statement follows from the ﬁrst, since the discriminant is then a polynomial expression of algebraic integers, and thus an algebraic integer itself. We can write K = Q(α) where α is some algebraic number (integer if we like) of degree n. Then￿1, α, α2,. .., αn−1￿ is a Q-basis for K. Let α1 = α, α2,. .., αn denote the (distinct) conjugates of α. Then the conjugates of αi are αi 1 = αi, αi 2,. .., αi n. Hence the determinant of this basis is the square of the discriminant of A =      1 α1 α2 1 ·· · αn−1 1 1 α2 α2 2 ·· · αn−1 2 ... ... ... ... ... 1 αn α2 n ·· · αn−1 n      . This matrix is a Vandermonde matrix, and it is a standard algebra exercise that this has determinant￿1≤i<j≤n(αj − αi). (The determinant is a polynomial in the αi’s, and clearly it is zero if some αi = αj, so each polynomial αj − αi divides the determinant. Then one counts the degree of the polynomial, to show that this is correct up to a constant. Comparing coeﬃcients of one of the terms gives the Vandermonde determinant formula. You could also prove this by induction, but the above argument seems simpler.) Hence ∆[α1,. .., αn]= ￿i￿=j(αj − αi).Note any σ ∈ Gal(K/Q) simply permutes the terms in this product, i.e., ∆[α1,. .., αn] is Gal(K/Q)-invariant, and thus in Q. It is clear from the product expression that it is nonzero. Exercise 1.10. Verify the Vandermonde determinant formula given above for n =2 and n =3. While, the determination of OK was simple for quadratic ﬁelds K, in general it is not so easy. There are algorithms to determine OK, but we will not focus on this problem in general, as we will only need explicit determinations of OK in special cases. However, we will brieﬂy indicate how one can use discriminants to help ﬁnd a ring of integers. It suﬃces to ﬁnd an integral basis for OK. 1. Guess a possible integral basis {β1, ·· · , βn} for OK.Suppose {α1,. .., αn} is an actual integral basis for OK. Then ∆[β1, ·· · , βn]= det(C)2∆[α1,. .., αn]= det(C)2∆K. In other words, 10 ∆[β1, ·· · , βn] is a square (in Z) times ∆K. Hence if ∆[β1,. .., βn] is squarefree, then {β1,. .., βn} is an integral basis for OK. 2. If ∆[β1, ·· · , βn] is not squarefree, {β1, ·· · , βn} may still be a basis (see Example 1.3.3 above), but if it is not, then OK contains an integer of the form 1 p (c1β1 + c2β2 + ·· · + cnβn) for some cn ∈ Z and p is some prime such that p2|∆[β1, ·· · , βn]. Check to see if any numbers of this form give any new algebraic integers not generated by β1,. .., βn. If so, suitably modify the choice of β1,. .., βn and repeat. If not, then β1,. .., βn is an integral basis of OK. Exercise 1.11. In the last section, we considered general extensions of number ﬁelds L/K.One reason you might want to do this is the following. We want to use K = Q( √−5) to study the form x2 +5y2.However OK does not have unique factorization. But we can embed K in the ﬁeld L = Q( √−5,i) which does have unique factorization. Now one wants do determine OL.A ﬁrst guess might be ￿1, √−5,i, √5￿ is an integral basis for OL.It is certainly a Q-basis for L.Compute the discriminant of this Q-basis. Can you determine OL? However we will primarily be concerned with other applications of discriminants this semester, most immediately to ideals in the next section. Discriminants are a fundamental invariant of number ﬁelds. Another thing they provide is natural way to at least partially order number ﬁelds. (There are only ﬁnitely many ﬁelds of a ﬁxed discriminant.) The quadratic ﬁelds Q( √d) can easily be ordered by d (which actually is a function of the discriminant, but how can one order ﬁelds of a more complicated form, such as Q( √3, √−19) and Q( √−7, √11)?) Once one has some sort of ordering, it is meaningful to ask questions like what percentage of ﬁelds (of a certain type) have class number 1 or 2, or more generally, how many ﬁelds up to a certain point satisfy Property X? We also remark that there is a geometric interpretation of determinants (and diﬀerents), which comes from the geometric interpretation of discriminants. For now, we will just mention it in the simplest case K = Q( √−d) where d> 0 squarefree. Then if α, β is a Q-basis for K, α and β generate a lattice Λ = ￿α, β￿ = {mα + nβ : m, n ∈ Z}. Then vol(C/Λ) = 1 2 ￿ −∆[α, β].In particular, ∆K = −4vol(C/OK)2. We can state an analogue of this for arbitrary number ﬁelds when we study the geometry of numbers. 1.4 Ideals Let K be a number ﬁeld. Recall I is an ideal of OK if I is a nonempty subset of OK which is closed under addition and multiplication by OK. The norm of an ideal I of OK is N (I)= |OK/I|. Lemma 1.4.1. For any nonzero ideal I of OK,the norm N (I)= |OK/I| is always ﬁnite. Fur- thermore, if β1,. .., βn is a Z-basis for OK,then N (I)= ￿ ∆[β1,...,βn] ∆K . Recall a free abelian group of rank n is a group isomorphic to Zn. For the proof, we use the fact that if A is a free abelian group of rank n,and B is a subgroup of A, then B is also free abelian of rank ≤ n. Proof. Let n =[K : Q]. Then OK is a free abelian group of rank n (w.r.t. addition). We can regard I as a subgroup of OK, which must also be free of rank ≤ n. Let i ∈ I be nonzero. Then (OKi, +) is a (free abelian) subgroup of (I, +) of rank n, hence I has rank n. 11 Now we let β1, ·· · , βn be a Z-basis for I. Then there is a Z-basis α1, ·· · , αn of OK such that for each i we can write βi = ciαi for some ci ∈ Z. Then it is clear OK/I = ￿ Cci, where Cr denotes the cyclic group of order r. In particular N (I) is ﬁnite. Moreover, we have      β1 β2 ... βn      =      c1 c2 . . . cn           α1 α2 ... αn      . By Lemma 1.3.2, we have ∆[β1,. .., βn]= N (I)2∆[α1,. .., αn]= N (I)2∆K. This gives the result since N (I) ≥ 0. Note that the norm of the zero ideal is inﬁnite as we have deﬁned it, though it may make more sense to deﬁne it to be 0 in light of the the next result, which relates norms of ideals to norms of elements. In any case, since we have no particular reason to work with the zero ideal, in order to simplify statements we will from here on, assume all our ideals our nonzero, unless explicitly stated otherwise. Proposition 1.4.2. Suppose I =(α) is a principal ideal of OK.Then N (I)= |NK/Q(α)|. Here the norm on the left is the ideal norm, and the norm on the right is the norm of an element. Proof. Let α1,. .., αn be a Z-basis for OK. Then β1 = αα1,. .., βn = ααn is a Z-basis for I.Write Gal(K/Q)= {σ1,. .., σn}.Note ∆[β1,. .., βn]= det    σ1(α)σ1(α1) ·· · σ1(α)σ1(αn) ... . . . ... σn(α)σn(α1) ·· · σn(α)σn(αn)    2 =det      σ1(α) σ2(α) . . . σn(α)      2 det    σ1(α1) ·· · σ1(αn) ... . . . ... σn(α1) ·· · σn(αn)    2 = NK/Q(α) 2∆[α1,. .., αn]= NK/Q(α) 2∆K. Now apply the previous lemma. This implies that the ideal norm is multiplicative, at least for principal ideals. Of course, we want to know it’s multiplicative for all ideals, and this basically follows from some simple isomorphism theorems, but at one point, to keep our argument as simple as possible, we will use fractional ideals. This is justiﬁed by Theorem 1.4.4 below (which we have already given last semester), whose proof does not rely on this result. Recall that the product of two ideals I and J , is the ideal generated by all elements of the form ij for i ∈ I and j ∈ J , i.e., IJ = {￿ imjm : im ∈ I,jm ∈ J }. Proposition 1.4.3. Let I, J be ideals of OK.Then N (IJ )= N (I)N (J ). 12 Proof. By the ring isomorphism theorem, OK/I ￿ (OK/IJ )/(I/IJ ). (Just think about the case where OK = Z, I =(m), J =(n). Then this says Z/mZ ￿ (Z/mnZ)/(mZ/mnZ).) The details are in the exercise below. Hence N (IJ )= |I/IJ | · N (I). Now it suﬃces to show OK/J ￿ I/IJ , say as abelian groups. Consider the map φ : OK → I/IJ given by φ(α)= αI + IJ for α ∈ OK. It is clear it is a group homomorphism. Note φ(α)= IJ ⇐⇒ αI + IJ = IJ ⇐⇒ αI ⊆ IJ , which, multiplying by I −1 is equivalent to αOK ⊆ J , which is equivalent to α ∈ J . Hence ker(φ)= J . On the other hand, it is clear φ is surjective. Thus it induces the desired isomorphism φ : OK/J → I/IJ . Exercise 1.12. Show the map φ : OK/IJ → OK/I given by α + IJ ￿→ α + I for α ∈ OK is well-deﬁned (i.e., φ does not depend on the choice of coset representative α ∈ α + IJ ), has kernel I/IJ ,andis surjective. This gives theisomorphism OK/I ￿ (OK/IJ )/(I/IJ ) claimed above. If I ⊆ K such that aI is an ideal of OK for some a ∈ OK,we say I is a fractional ideal of OK. Moreover a fractional or ordinary ideal I is called principal, if it is generated by a single element, i.e., if it is of the form aOK for some a ∈ K. Denote by Frac(OK) the set of (nonzero) fractional ideals of OK,and Prin(OK) the set of (nonzero) principal fractional ideals of OK. Multiplication for fractional ideals is deﬁned the same as for ordinary ideals. Theorem 1.4.4. Frac(OK) is an abelian group under multiplication, and Prin(OK) is a subgroup. If I, J are ideals of OK,we say J divides I (J|I)if J ⊇ I, from which one can conclude from the above theorem that I = JJ ￿ for some ideal J ￿. An ideal I of OK is proper if I ￿= OK.We say a proper ideal p is prime if p|IJ implies p|I or p|J (technically, the zero ideal is prime, but we are ignoring the zero ideal), and it is maximal if I|p implies I = p or I = OK. Recall that p is prime if and only if OK/p is an integral domain, and p is maximal if and only if OK/p is a ﬁeld. (Remark: this kind of result is one reason we don’t allow for a ﬁeld to have just one element.) Since every ﬁnite integral domain is a ﬁeld, one is able to conclude every (nonzero) prime ideal is maximal and vice versa. Theorem 1.4.5. (Prime ideal factorization) Let I be a proper ideal of OK.Then I = p1 ·· · pr where the pi’s are prime ideals of OK.Moreover the pi’s are determined uniquely up to ordering. We proved these theorems last semester, modulo a couple of details about the ﬁrst theorem. If you want to ﬁll in these details for yourself, you can try to work it out yourself from the Chapter 12 notes from last semester, or see any text on Algebraic Number Theory, such as [Stewart–Tall]. Deﬁnition 1.4.6. The quotient group Frac(OK)/Prin(OK) is called the class group of K,and denoted Cl(OK) or ClK.The size of the class group is called the class number of K,and denoted by hK. Corollary 1.4.7. OK has unique factorization if and only if hK =1. Proof. Note hK =1 means OK is a PID. Since every PID is a UFD (from algebra or last semester), the ⇐ direction holds. To prove the ⇒ direction, suppose OK has unique factorization. Suppose p is a prime ideal of OK. Let n ∈ p and n = α1 ·· · αk be unique factorization of n into (non-unit) irreducibles. Note each αi satisﬁes the prime divisor property by unique factorization, each αi is a prime element 13 of OK, and therefore each (αi) is a prime ideal. Hence (n)= (α1)(α2) ·· · (αk) is the prime ideal factorization of (n). On the other hand, since p|(n), p must equal one of the (αi)’s by uniqueness of prime ideal factorization. Hence every prime ideal of OK is principal. Then by prime ideal factorization again, every ideal must be principal. We mentioned last semester that there are only ﬁnitely many imaginary quadratic ﬁelds with unique factorization, and conjecturally inﬁnitely many such real quadratic ﬁelds. We will a bit more talk more about this later, but ﬁrst we need a way to compute the class group or class number of a ﬁeld. In fact, perhaps even before that, we want to know the class number is ﬁnite. The standard proof for this is via Minkowski’s theory of the geometry of numbers, and it will in fact give us a bound on the class number, which will in turn allow us to compute the class group in explicit examples. In fact, to get an idea of how one can do such a thing, you may want to look at the Chapter 12 notes from last semester, where, following Stillwell, I prove directly that hQ(√−5) =2,though we didn’t have a chance to cover it in lecture last semester. The proof via Minkowski’s theorem is somewhat less direct, and to keep things as simple as possible, we will only give a complete proof in the case of quadratic ﬁelds. A more sophisticated proof of the ﬁniteness of the class group is via the theory of p-adic numbers and adèles which we will develop in Part III. Time permitting, we will give this proof in the 3rd part of the course for general number ﬁelds. Another way to compute the class number is to use a formula of Dirichlet, which we will turn to after Minkowski’s bound. An alternative way to compute the class number and group for quadratic ﬁelds will be given by Gauss’s theory of binary quadratic forms in Part II (which historically came ﬁrst). 1.5 Lattices Before explaining Minkowski’s geometry of numbers, we need to know some basic facts about lattices. Deﬁnition 1.5.1. A (complete) lattice Λ in Rn is a subset of Rn of the form ￿v1,v2,. .., vn￿ = {￿ aivi : ai ∈ Z} such that v1,. .., vn ∈ Rn are linearly independent over R.The set v1,. .., vn is called a basis for Λ (it is a Z-basis). As both Rn and Λ are abelian groups under addition, we let Rn/Λ denote the quotient group. A fundamental domain for Λ (or Rn/Λ)isaconnected, locally convex1 Ω of Rn such that Ω contains exactly one element from each coset of Rn/Λ. In other words, the (complete) lattices in Rn are the Z-spans of bases of Rn. The adjective complete refers to the fact that the number of basis elements of the lattice is maximal. An incomplete lattice of Rn would be the Z-span of a basis of a proper subspace of Rn. However, for us, all lattices will be complete unless stated otherwise. Note a lattice is a free abelian subgroup of Rn of rank n, but not all free abelian subgroups of rank n are lattices. For example, Z[ √2] ⊆ R is a free abelian subgroup of R2 of rank 2 (embedding R in R2), generated by 1 and √2, but not a lattice since 1 and √2 are not linearly independent over R. The main idea with fundamental domain is that it is a subset of Rn which looks like the quotient group Rn/Λ. More precisely, it is a connected subset of Rn comprising exactly one representative from each coset of Rn/Λ. The condition of local convexity is just to avoid pathological examples of 1Locally convex means if two “nearby” points are in the set, then the line between them is in the set. 14 fundamental domains (see examples below). In any case, it won’t be important for us to understand the subtleties of what kinds of sets make up fundamental domains, but rather just the basic idea of what one is, and understanding what the “standard” fundamental domain is. Hopefully this should be clear when we look at the cases in R1 and R2. It is a basic fact that any fundamental domain for Λ has the same volume (length in dimension 1, area in dimension 2). This volume is called the volume (or covolume) of the lattice Λ (or more properly the quotient R/Λn), denoted vol(Λ) (or more properly vol(Rn/Λ)). (To be formally complete, we can get away without proving this fact about all fundamental domains having the same volume by deﬁning the volume of the lattice to be the volume of the standard fundamental domain, deﬁned below.) If Λ is an incomplete lattice, then Rn/Λ will have will have inﬁnite volume. Example 1.5.2. Since any free abelian group of rank n is isomorphic, as an abelian group, to Zn, the most obvious example of a lattice in Rn is Zn.The standard fundamental domain for Zn is Ω = [0, 1)n ⊆ Rn.It should be clear any element of Rn is a Zn translate of exactly one element in Ω.It is obviously connected and convex, therefore locally convex.It is clear vol(Λ) = 1. While all lattices of Rn are isomorphic as abelian groups, they also have an inherent geometry coming from Rn, providing more structure. We will not need this, but just to clear up terminology, we will only say two lattices of Rn are isomorphic as lattices if they (or equivalently, their fundamen- tal domains) have the same shape and size—precisely, they will be isomorphic if one is the image of the other by an isometry (distance preserving map) of Rn. In linear algebra, you may have learned that the (linear) isometries of Rn are precisely the elements of O(n)= ￿A ∈ GLn(R): AtA = I￿, the real orthogonal group of rank n. This means that two lattices of Rn are isomorphic if and only if (a basis of) one can be transformed into (a basis of) the other by an element of O(n). Example 1.5.3. As a special case of the above example with n =1, Z is a lattice in R,as is Λk = kZ. Notice that Λk = Λk￿ if and only if k = −k￿.These are all the lattices in R,in 1 − 1 correspondence with R>0,parameterized by this number k.A fundamental domain for R/Λk (sometimes also referred to as R mod k)is [0,k). In fact any half-open interval of length k is a fundamental domain for Λk, and there are no other fundamental domains because of the connectedness requirement. We think of R/Λk as the interval [0,k] with the endpoints glued, hence topologically it is a circle. Geometrically, its length is vol(Λk)= k. Example 1.5.4. Alatticein R2 is determined by two generators, u =(x1,y1) and v =(x2,y2), provided they are linearly independent. Precisely, the lattice Λ = ￿u, v￿ generated by u and v is Λ = {mu + nv : m, n ∈ Z} ⊆ R2.The standard fundamental domain for Λ is Ω = {au + bv : a, b ∈ [0, 1)}. In other words, the standard fundamental domain for Λ is the interior of the parallelogram deter- mined by 0, u, v and u + v,together with half of the boundary (since opposite boundary points are equivalent modulo Λ,we can only include half of them,and one of the corners). Any R2-translate of Ω is also a fundamental domain for Λ. We may think of the quotient group R2/Λ as the fundamental domain (parallelogram) Ω,with the addition of two vectors being the sum in the fundamental domain, and if the vector lies outside of Ω, we let it wrap it around the edges of the parallelogram Pacman-style so the sum lies again in Ω.In other words, we think of R2/Λ as the parallelogram Ω,with opposite sides glued. Topologically this is a torus. Example 1.5.5. Let a, b > 0.The volume of the lattice Λa,b = ￿(a, 0), (0,b)￿ is ab,since a fun- damental domain is a rectangle with corners 0, (a, 0), (0,b), (a, b) (excluding appropriate bound- ary points). Two of these rectangular lattices Λa,b and Λc,d will be isomorphic if and only if 15 {a, b} = {c, d}. Hence there are inﬁnitely many non-isomorphic rectangular lattices of volume 1 given by Λa, 1 a . To generalize the above examples, the standard fundamental domain for Λ = ￿v1,v2 .. .,vn￿ (or more properly for the basis v1,. .., vn)is Ω = { ￿ aivi : ai ∈ [0, 1)}. It is straightforward to show this is in fact a fundamental domain. Then Rn/Λ looks like an n-dimensional parallelogram (parallelopiped?) and topologically is an n-dimensional torus (the product of n circles). (To be complete, if we deﬁne volume of a lattice as the volume of a standard fundamental domain, one should show that any two bases of Λ are related by an element of GLn(Z). Then, expressing the volumes of standard fundamental domains as determinants, one can conclude that the volume is independent of the choice of basis.) Exercise 1.13. Consider the lattice Λ = ￿u =(1, 0),v =( 1 2 , √3 2 )￿ in R2.Sketch the standard fundamental domain for {u, v} compute its volume. Write down 2 other bases {u1,v1}, {u2,v2} for Λ that do not just diﬀer by sign (i.e., {u, v} ￿= {±ui, ±vi} and {u1,v1} ￿= {u2,v2}). Sketch the standard fundamental domains for {u1,v1} and {u2,v2} and check they have the same volume. Exercise 1.14. Let Λ = ￿u, v￿ be a lattice in R2 such that Λ ⊆ Z2.Let Ω be the standard funda- mental domain for the basis {u, v} of Λ.Show the volume of R2/Λ is the number of integral points in Ω,i.e., vol(R2/Λ) = |Ω ∩ Z2|. Example 1.5.6. Consider the lattice Z2 in R2. A non-rectangular fundamental domain may be constructed as follows. Start with a standard fundamental domain and remove a semicirclular shape from one of the sides, then glue this shape onto the opposite side. (Draw a picture). This is no longer convex, but it is still locally convex. Now here is a non-example of a fundamental domain, which satisﬁes all properties except local convexity. Let Ω be the union of line segments Ly for 0 ≤ y< 1 where Ly is the line from (0,y) (inclusive) to (1,y) (exclusive) if y is rational and to (−1,y) (exclusive) if y is irrational. Then it is clear Ω contains exactly one representative from each coset of R2/Z2,and it is connected since it is a union of horizontal line segments which are joined by the y axis, but it is not locally convex. (Think why, draw a picture.) Now to apply this to ideal theory, we need to know Minkowski’s Theorem. Recall X ⊆ Rn is called symmetric if X = −X. Theorem 1.5.7. (Minkowski) Let Λ be a lattice in Rn and X aboundedsymmetric convex subset of Rn.If vol(X) > 2nvol(Rn/Λ),then X contains a nonzero point of Λ. Proof. (It may be helpful to draw a picture for n =2.) Let L be the lattice L = 2Λ. It is clear vol(Rn/L)=2nvol(Rn/Λ),so vol(X) > vol(Rn/L). Thus, if Ω is a fundamental domain for Rn/L, the natural map from Rn to Ω cannot be injective when restricted to X. Thus there must be two points x1,x2 ∈ X such that x1 ≡ x2 mod L (i.e., they map to the same point in Ω), i.e., x1 −x2 ∈ L. Since X is symmetric −x2 ∈ X. Then convexity implies 0 ￿= 1 2 x1 − 1 2 x2 ∈ X ∩ Λ. Two classical applications of Minkowski’s theorem is that is can be used to prove Fermat’s two square theorem or Lagrange’s four square theorem. See [Stewart–Tall] for both proofs, or the Chapter 8 notes from last semester for the proof of the four square theorem. However, we are more interested in the applications to ideals in the following sections. 16 1.6 The geometry of numbers: the quadratic case What Minkowski termed the geometry of numbers is most plain to see in the imaginary quadratic case. Let K = Q( √−d) with d> 0 squarefree. Then OK is a lattice in C ￿ R2. Hence, any ideal of OK is a lattice in C ￿ R2. In fact, even if K = Q( √d) is a real quadratic ﬁeld, we may think of OK as a lattice in R2.(As we remarked earlier with Z[ √2], even though K ⊆ R, OK is not a lattice in R, so Minkowski’s idea was to embed K into R2.) The most naive way to do this is to regard an element a + b√d ∈ K as the element (a, b √d) in R2. In other words, we are separating out the rational and irrational components on the x-and y- axes of R2, just like we separate the real and imaginary components of Q( √−d) or C onto the x-and y- axes in the complex plane picture. We can unify these two cases as follows. Suppose K = Q( √d) is a real or imaginary quadratic ﬁeld, i.e., d> 1 or d< 0 and assume d squarefree. Then we can embed K in R2 by the map φ : K → R2 such that φ(a + b√d)=(a, b￿ |d|) for a, b ∈ Q. In this picture OK,and thus any ideal of OK, is a lattice of R2. We will work out the part of Minkowski’s theory relevant for us in the case of quadratic ﬁelds. In the interest of time, we will just state the theorems in the general case, though the basic argument is the same. Proposition 1.6.1. Let I be an ideal of OK with Z-basis {α, β},regarded as a lattice in R2 via the embedding φ : K → R2 above. Then vol(R2/I)= 1 2 |∆[α, β]|1/2. In the case where K is imaginary quadratic and I = OK, we brieﬂy discussed this at the end of the section on discriminants. Proof. Let (x1,y1)= φ(α) and (x2,y2)= φ(β), so we can write α = x1 + y1√|d| √d and β = x2 + y2√|d| √d.Note ∆[α, β]= αβ − αβ. Since αβ = x1x2 + d |d| y1y2 +(x1y2 + x2y1) √d√|d| ,we have |∆[α, β]|1/2 =2|x1y2 − x2y1|. By the exercise below, this is twice the volume of the parallelogram with corners (0, 0), (x1,y1), (x2,y2) and (x1 +x2,y1 +y2), which is the standard fundamental domain of the lattice I ⊆ R2 (with respect to the basis (x1,y1), (x2,y2)). Exercise 1.15. Let u =(x1,y1) and v =(x2,y2) be linearly independent vectors in R2.Show the parallelogram with corners 0, u, v and u + v has area |x1y2 − x2y1|. Corollary 1.6.2. With the notation of the previous proposition, vol(R2/I)= 1 2 N (I) ￿ |∆K|. This gives a geometric interpretation of the norm of an ideal in terms of the volume of the corresponding lattice. Proof. This is immediate since N (I)= ￿ ∆[α,β] ∆K (Lemma 1.4.1.) Lemma 1.6.3. For any ideal I of OK,thereis anonzero α ∈ I such that |N (α)| ≤ 2 π N (I) ￿ |∆K|. 17 Proof. From the previous corollary, Minkowski’s theorem implies that if X is the (open) disc of radius r centered at the origin in R2, it contains a nonzero lattice point, i.e., a nonzero α ∈ I, whenever πr2 > 2N (I) ￿ |∆K|.Suppose r2 > 2 π N (I) ￿ |∆K| + ￿ for some ￿ > 0 so there is such an α. Now if we write α = x + y√|d| √d, we see N (α)= x2 ± y2 according to whether K is imaginary quadratic or real quadratic. Now α ∈ X means x2 + y2 <r2, which of course implies |x2 − y2| <r2, so in either the imaginary or real case we have |N (α)| <r2 = 2 π N (I) ￿ |∆K| + ￿.Taking ￿ → 0 gives the desired result. Recall if I, J are fractional or ordinary ideals of a ring R,we say I and J are equivalent if aI = bJ for some a, b ∈ R and write I ∼ J . Via this equivalence, the class group of R (which we technically have only deﬁned when R is the ring of integers of a number ﬁeld) is just the group of equivalence classes of fractional ideals. Lemma 1.6.4. Let I be an ideal of OK.Then I ∼ J for some ideal J with norm ≤ 2 π ￿ |∆K|. Proof. For some a ∈ OK, aI −1 ⊆ OK. Then I ￿ = aI −1 is a ideal of OK such that II ￿ =(a). Let α ∈ I ￿ such that |N (α)| ≤ 2 π N (I ￿) ￿|∆K|, whose existence is guaranteed by the previous lemma. Clearly I ￿|(α) so we can write (α)= I ￿J where J is an ideal of OK. Now we are done, since J ∼ I ￿−1 ∼ I and N (J )= N (I ￿)/N ((α)) ≤ 2 π ￿|∆K|. The point is that this lemma allows us to bound, and subsequently determine, the class number in any explicit case, as well as use this to show it is ﬁnite in general. Let’s ﬁrst start of with our canonical example. Recall from Section , for K = Q( √d) with d ￿=1 squarefree, the discriminant ∆K = d if d ≡ 1 mod 4 and ∆K =4d if d ≡ 2, 3 mod 4. Example 1.6.5. The class number of K = Q( √−5) is 2,andaset ofrepresentatives fortheclass group is ￿OK, (2, 1+ √−5) ￿. Proof. By the lemma, every ideal of OK is equivalent to one of norm ≤ 2 π √20 ≈ 2.85. There is only one ideal of norm 1 (think back to the deﬁnition of the norm of an ideal), OK.Suppose p is an ideal of norm 2. By Lemma 1.6.3 there is an nonzero α ∈ p with norm at most 5. However p|α implies N (p)|N (α) means N (α) is even, i.e., N (α)=2 or 4. But there are no elements of norm 2 (it is not of the form x2 +5y2 = N (x + y√−5)), so we must have α is of norm 4, i.e., α = ±2. This means p|(2), but the prime ideal factorization of (2) in OK is (2) = (2, 1+ √−5)2 either from last semester or the exercise below. Hence (2, 1+ √−5) is the only ideal of norm 2,and it is not principal. A more elementary proof of the above fact is in the Chapter 12 notes from last semester, based oﬀ of what was in Stillwell. It still uses the lattice picture of ideals, but does not require Minkowski’s theorem. In fact, a general proof of ﬁniteness of the class group which avoids Minkowski’s theorem is in [Lang]. Exercise 1.16. Consider the ideal p =(2, 1+ √−5) in Z[ √−5].We proved several things about this ideal last semester, but using norms we can give more elegant arguments. In any case, this exercise, and the following ones, should be a good review for you. (i) Show p|(2) but p ￿= (2).Using norms, conclude N (p)= 2. (ii) From (i) conclude p is non-principal and prime. (iii) Show the prime factorization of (2) is (2) = p2. 18 Exercise 1.17. Consider the ideals q =(3, 1+ √−5) and q =(3, 1 − √−5) in Z[ √−5]. (i) Show N (q)= N (q)=3. (ii) Show q, q are non-principal and prime. (iii) Show the prime factorization of (3) is (3) = qq. Exercise 1.18. From the previous two exercises, determine the prime ideal factorization of (6) in Z[ √−5]. Explain how the non-unique factorization of elements 6=2 · 3=(1 + √−5)(1 − √−5) in Z[ √−5] is resolved in terms of the prime ideal factorization of the ideal (6). Exercise 1.19. Let K = Q( √−5).By the above exercises, together with the fact that hK =2, p ∼ q in the notation above. Show this explicitly by ﬁnding nonzero α, β ∈ OK such that αp = βq. Exercise 1.20. Using Lemma 1.6.4, show Q( √d) has class number 1 for d = −1, −2, −3, −7, 2, 3, 5. These are all the cases where Lemma 1.6.4 immediately gives class number 1, but there are other cases. Exercise 1.21. Show Q( √−11) has class number 1. The only other imaginary quadratic ﬁelds with class number 1, i.e., with unique factorization in their ring of integers, are Q( √−d) with d = 19, 43, 67, 163 (making for a total of 9 such ﬁelds). It is not diﬃcult to see that these ﬁelds all have class number 1—it is much harder to show that they are the only ones. This is Gauss’s class number conjecture, and we will say a little more about this later. For now we will just say it was proven in 1934 by Heilbronn and Linfoot that there are only ﬁnitely many such imaginary quadratic ﬁelds, and eventually proved that there were no others by Heegner and Stark in the 50’s and 60’s. Contrast this with the real quadratic case where it is conjectured that there are inﬁnitely many instances of class number 1 (in fact, it is thought that about 75% should be). Tables of class numbers for small real and imaginary quadratic ﬁelds are given below. Exercise 1.22. Show Q( √−6) has class number 2. Now we want to show the ﬁniteness of the class number for a general quadratic ﬁeld. We need to know one more small fact about ideals ﬁrst. Lemma 1.6.6. Let K be a quadratic ﬁeld and n ∈ N. There are only ﬁnitely many ideals I of OK such that N (I)= n. Proof. Regarding OK as a lattice in R2 as above, the ideals of norm n correspond to the lattices of R2 contained in OK (i.e., sublattices of OK) of (co)volume n 2 ￿|∆K| by Corollary 1.6.2. It is geometrically clear that there are only ﬁnitely many such (sub)lattices. We will see another proof later when we study the behavior of primes in extensions. In particular we will show that if N (I)= n, then I|(n). But there are only ﬁnitely many ideals dividing (n) by the uniqueness of prime ideal factorization. Theorem 1.6.7. Let K be a quadratic ﬁeld. Then hK < ∞,i.e., ClK is a ﬁnite abelian group. Proof. By Lemma 1.6.4, there is some n such that any equivalence class of ideals has a representative with norm ≤ n. Now by the previous lemma, there are only ﬁnitely many ideals with norm ≤ n. 19 Table 1: Class numbers of small imaginary quadratic ﬁelds K = Q( √d) dhK -1 1 -2 1 -3 1 -5 2 -6 2 -7 1 -10 2 -11 1 -13 2 -14 4 -15 2 -17 4 -19 1 -21 4 -22 2 -23 3 -26 6 -29 6 -30 4 -31 3 -33 4 -34 4 -35 2 -37 2 -38 6 -39 4 -41 8 -42 4 -43 1 -46 4 -47 5 -51 2 20 Table 2: Class numbers of small real quadratic ﬁelds K = Q( √d) dhK 21 31 51 61 71 10 2 11 1 13 1 14 1 15 1 17 1 19 1 21 1 22 1 23 1 26 2 29 1 30 2 31 1 33 1 34 2 35 2 37 1 38 1 39 2 41 1 42 2 43 1 46 1 47 1 51 2 21 1.7 The geometry of numbers: the general case Now suppose K is a number ﬁeld of degree n. In order to look at OK “geometrically”, i.e., as a lattice, we need a way to embed K into Rn. Of course if α1,. .., αn is a basis for K (as a Q-vector space), we could send ￿ ciαi to (c1,. .., cn) ∈ Rn, but there are two issues: (i) this is not at all canonical since it is highly dependent on the choice of basis, and (ii) there is no way with such an arbitrary embedding to relate vol(Rn/I) with the discriminant/norm of an ideal I of OK in order to get an analogue of Proposition 1.6.1 and its corollary. In fact, if we look over the proof of Lemma 1.6.3, we see the key is that |N (α)| is ≤ the square of the distance from α to the origin in R2, with equality in the imaginary quadratic case. However, in some sense, the embedding we used in the real quadratic case, while perhaps the most obvious choice, was not natural in that it came from the “standard” basis 1, √d of K = Q( √d).One might then ask if there is a more “natural” embedding of a real quadratic ﬁeld K = Q( √d) ￿→ R2. There is, and the idea is to use the Galois group. Let σ1, σ2 be the embeddings of K ￿→ R (all embeddings are real) given by σ1(a + b√d)= a + b√d and σ2(a + b√d)= a − b√d. Consider the embedding K ￿→ R2 given by α ￿→ (σ1(α), σ2(α)). This is “natural” since it does not depend upon a choice of basis for K over Q, and the norm satisﬁes the desired geometric bound: if α = a+b√d ￿→ (x, y), then x = a+b√d, y = a−b√d,so x2+y2 = 2(a2+db2) ≥ 2|a2−db2| =2N (α). (Our naive embedding of a real quadratic ﬁeld into R2 was of course perfectly ﬁne for our goal in the previous section, but the problem was it is not so helpful in suggesting an appropriate generalization to arbitrary number ﬁelds. In fact, our naive embedding gives a better bound than the “natural” one given by the Galois group stated below.) The standard presentation of the geometry of numbers is as follows. Let K be a number ﬁeld of degree n. Then there are n embeddings of K ￿→ C,say σ1,. .., σn.Assume the ﬁrst s are real embeddings, i.e., σ1,. .., σs actually embed K in R, and that the remaining σi’s are complex embeddings, i.e., they do not map into R.If σi is a complex embedding, then σi also is, where σi(α)= σi(α) and the bar denotes usual complex conjugation. In particular, there are an even number 2t of complex embeddings, which occur in complex conjugate pairs. Let us denote them τ1, τ 1,. .., τt, τ t. Now we deﬁne the embedding φ : K → Rs × Ct ￿ Rs+2t = Rn by φ(α)=(σ1(α),. .., σs(α), τ1(α),. .., τt(α)). This is natural, in that it does not depend upon a basis for K. It does technically depend on the ordering of the embeddings σi and τi, as well as a choice among each conjugate pair of complex embeddings τi and τ i, but not in any signiﬁcant way. Example 1.7.1. If K = Q( √d) is a real quadratic ﬁeld, then s =2 and t =0,and φ(α)= (σ1(α), σ2(α)) is the embedding described above. If K = Q( √−d) is an imaginary quadratic ﬁeld, then s =0 and t =1,and Gal(K/Q)= {τ1, τ 1} where τ1 : K ￿→ C is the trivial embedding. Then also φ(α)= τ1(α)= α is the standard embedding into C ￿ R2.If we had chosen τ1 to be complex conjugation, then τ 1 would be the identity map on K and we would have that φ(α)= α is the conjugate embedding into C ￿ R2. Thus this embedding generalizes both what we did in the imaginary quadratic case (which was basically nothing, just the standard identiﬁcation of C with R2) as well as our second approach to the real quadratic case. 22 Example 1.7.2. Let K = Q( 3√2).Then Gal(K/Q)= {σ1, τ1, τ 1} where σ1 is the trivial auto- morphism of K, τ1 maps 3√2 to ζ3 3√2 and τ2 maps 3√2 to ζ 2 3 3√2.Thus φ : K ￿→ R × C ￿ R3 by φ(a + b 3√2+ c 3√4) = (a + b 3√2+ c 3√4,a + bζ3 3√2+ cζ 2 3 3√4). Exercise 1.23. Let K = Q( 4√2).Write down explicitly the map φ in this case. Compute φ(3), φ(3 + 4√2) and φ(1 + 3√2+ 4√2). Exercise 1.24. Let K = Q( √−5, √5).Write down explicitly the map φ in this case. Compute φ(1 + √5), φ(1 + √−5) and φ(2i). With the embedding φ given above, OK is a lattice in Rn, and as in the quadratic case we did earlier, one can prove the following. Proposition 1.7.3. Let I be an ideal of OK with basis α1,. .., αn,regarded as a lattice in Rn via the embedding φ.Then vol(Rn/I)=2−t∆[α1,. .., αn]=2−tN (I) ￿ |∆K|. Here t is the number of complex embeddings of K ￿→ C as above. This proposition gives a geometric interpretation of discriminants for general number ﬁelds. Lemma 1.7.4. Let I be an ideal of OK.Then I is equivalent to an ideal of OK with norm ≤ ￿ 2 π ￿t ￿ |∆K|. Note that in the case of real quadratic ﬁelds, this gives a weaker bound that what we got in the last section because there will be no factor of 2 π here. It’s possible to improve the bound in the lemma by being more careful. Precisely one can show Lemma 1.7.5. (Minkowski’s bound) Let I be an ideal of OK.Then I is equivalent to an ideal of OK with norm ≤ ￿ 4 π ￿t n! nn ￿ |∆K|. This is better than the simple bound we gave in the previous section in real quadratic case, and the same as our previous bound in the imaginary quadratic case. The better bound in the real case is in line with the notion that the class numbers for real quadratic ﬁelds tend to be smaller than those for imaginary quadratic ﬁelds, though it provides no real explanation. In any case, we will not be concerned overly much with optimal bounds. For us, the main point is Theorem 1.7.6. Let K be a number ﬁeld. Then hK < ∞. The proof for the general case is the same as the quadratic case, admitting one of the bounds in the previous lemmas. Complete proofs of these results should be available in any Algebraic Number Theory text. 1.8 Interlude: Dirichlet’s Units Theorem There are several applications of Minkowski’s geometry of numbers to classical problems. Apart from the applications to class groups and quadratic forms discussed above, other applications are to bounding the number of lattice points enclosed by a polygon and bounding the number of balls that can ﬁt in a given region (i.e., sphere packing bounds—a remarkable result around 15 years ago was the resolution of Kepler’s conjecture on the optimal way to pack spheres in space). In algebraic number theory, there is another major application of the geometry of numbers, and that is to prove Dirichlet’s Units Theorem. Since we will not have need of this theorem, we will not prove it in the interest of time, but it is such a fundamental result about number ﬁelds we would be remiss not to mention it. 23 Theorem 1.8.1. (Dirichlet’s Units Theorem) Let s be the number of real embeddings and 2t be the number of complex embeddings of a number ﬁeld K.Then the group of units U of OK is isomorphic (as an abelian group) to Zs+t−1 × C2m for some m ∈ N. The basic idea of the proof is to embed K in Rs+2t. Since the units are multiplicative, applying logarithms coordinate-wise makes an additive subgroup of Rs+2t, i.e., an incomplete lattice, which one shows is of rank s + t − 1. We note that the determination of the ﬁnite cyclic group C2m appearing in the theorem is simple to determine for any given K. It is simply given by the roots of unity which are contained in K,as any unit of ﬁnite order must be a root of unity, and all roots of unity are algebraic integers. 1.9 Debrieﬁng Dedekind introduced ideal theory to resolve the failure of unique factorization in OK for arbitrary number ﬁelds K. The ﬁrst suggestion is that this is a good theory to look at, is that it provides a clear characterization of when OK does have unique factorization—namely, if and only if OK is a PID, which is if and only if hK =1. (We stated this before the prime ideal factorization theorem last semester, even though we didn’t prove the only if direction until this chapter.) The prime ideal factorization theorem tells us it in fact is an excellent theory to look at, and we saw how it resolved the non-unique factorization of 6=2 · 3=(1 + √−5)(1 − √−5) in Z[ √−5]. Historically, it was the 3rd approach to resolve these non-unique factorizations, coming after Gauss’s theory of quadratic forms (for quadratic ﬁelds) and Kummer’s theory of “ideal numbers.” These ideas are still very interesting, and we will discuss them in Part II. We began this chapter by generalized some ideas such as conjugates and norms from quadratic ﬁelds to arbitrary number ﬁelds using Galois groups. As you may be aware from algebra, in many cases the Galois group of an extension can be somewhat diﬃcult to compute, but simple non- quadratic examples are still fairly easy to compute, as we have seen with examples. The point is the Galois group of a degree n extension is a transitive subgroup of Sn acting on the n roots of the minimal polynomial of a primitive element. When n =2, there is only one transitive subgroup of S2 ￿ C2, and the extension is necessarily Galois. Here it is immediate what the Galois group is. However for n> 2, there is more than one transitive subgroup of Sn (e.g., Sn, An, Cn), and one need to do some work to determine what is is. Further, sometimes the primitive element is obvious, but sometimes it is not, e.g., what is a primitive element for Q( √2, √3)?(You can show √2+ √3 works by a degree argument and the characterization of quadratic ﬁelds, but you can see how this can get complicated quickly. Even knowing this, how do you determine the minimum polynomial—what is the minimum polynomial of √2+ √3?) In general, one probably wants to use the main theorem of Galois theory (which I won’t review) to use the subﬁeld lattice to help determine the Galois group. However, the examples we will cover will be simple enough that we don’t need to use the full force of Galois theory to determine the Galois group. Knowing the Galois group of K over Q it is easy to determine the conjugates and norm of an element in K. What is not so simple is determining the ring OK. There is an algorithm for doing this using discriminants, though it turns out to be fairly computational even for simple examples like Q( √2, √3). However, our main reason for looking at discriminants is that they provide a fundamental invariant of a number ﬁeld K and its ideals (i.e., the ideals of OK). For K an imaginary quadratic ﬁeld, the discriminant of OK or an ideal I of OK is essentially the volume of the corresponding lattice, as well as essentially the norm of the ideal squared. (We only deﬁned 24 the discriminant of a basis of an ideal, but by the formula in terms of the norm, this is clearly independent of the choice of basis.) Then with Minkowski’s theorem, we were able to bound the norm of “minimal” representative of the class group in terms of the discriminant, providing a proof of the ﬁniteness of the class group ClK, as well as allowing us to explicitly determine the class group in particular cases. On the other hand, for real quadratic ﬁelds K ⊆ R, OK is not a lattice, but we have seen at least two ways to embed K in R2 which makes OK a lattice—the naive way, and the approach via Galois conjugates. The second approach generalizes for an arbitrary number ﬁeld K of degree n, allowing us to view OK as a lattice in Rn. As before the norm and discriminant of the ideal are essentially the (co)volume of the lattice OK, and Minkowski’s theorem allows us to show the class group is ﬁnite, and bound norms of a set of minimal representatives of the class group. Stillwell talked about the shape of ideals in imaginary quadratic ﬁelds. Two lattices (ideals) in C ￿ R2 will have the same shape if and only if they diﬀer by a complex scalar (principal ideal). Hence two ideals will have the same shape if and only if they are equivalent. Thus the class number is the number of diﬀerent possible shapes of ideals. Similarly, via the geometry of numbers developed by Minkowski, if two ideals are equivalent, they will have they same shape, regarded as lattices in Rn. The goal of this chapter was to show ﬁniteness of the class group (at least a complete proof in the quadratic case, and the general case is similar in spirit), and show in some speciﬁc cases how we can determine the class number and class group. There are two reasons for this: (i) to understand factorization in OK, which is a basic problem in algebraic number theory, and (ii) applications to Diophantine equations. First oﬀ, the class group of K measures the failure of unique factorization in OK. The larger it is the more diﬀerent the set of irreducible factorizations of some algebraic integer α ∈ OK can be. For example, K has class number 2 if and only if every element of OK does not have unique factorization but any factorization into irreducibles has the same number of factors. We will come back to this idea in Part II. Now what is the bearing of the class group on solving Diophantine equations? Well, ﬁrst of all, the simplest case is when OK has unique factorization, i..e, class number 1. We have shown the rings of integers of the ﬁelds Q( √d) for d = −1, −2, −3, −7, −11, 2, 3, 5 all have unique factorization. Following the approach last semester, this makes it easy to determine which primes are of the form x2 + dy2 for d =1, 2, 3, 7. In particular, we used unique factorization in Z[ √−2] to show y3 = x2 +2 has only one solution (5, 3) in N, and unique factorization in Z[ζ3] to show x3 + y3 = z3 has no solutions in N. Lamé gave an argument that xp + yp = zp has no solutions in n for p and odd prime whenever Z[ζp] has unique factorization. Even when Z[ √−d] does not have unique factorization, we can still use knowledge of the class group to determine the primes of the form x2 + dy2. Speciﬁcally, we used the fact that Z[ √−5] has class number 2 to determine the primes of the form x2 +5y2 at the end of last semester. (Refer to last semester’s Chapter 12 notes, or wait till we review this next chapter.) In order to approach this problem for general d> 0 squarefree, observe p = x2 + dy2 =(x + y√−d)(x − y√−d), which means the prime p splits into prime ideals (p)=(x + y√−d)(x − y√−d) in the ring Z[ √−d]. This is a particular case of the general question, given an extension of number ﬁelds L/K and a prime ideal p of OK, how do we determine how it behaves in L, i.e., what is the prime ideal factorization of pOL in OL? This is another basic question of Algebraic Number Theory, and in particular when K = Q, it will tell us what is the prime ideal factorization of (n) in OL. Hence, this is important for 25 studying general Diophantine equations also, and this question will be the focus of the next chapter. In the following chapter, we will brieﬂy talk about cyclotomic ﬁelds K = Q(ζp) where ζp is a primitive p-th root of unity and p is an odd prime. This is the next most important and basic type of number ﬁeld after the quadratic ﬁelds. This will (i) give us a better understanding of the concepts discussed in this chapter for non-quadratic ﬁelds, and (ii) provide an opportunity for more applications. The most famous application of these ﬁelds is to Kummer’s approach to Fermat’s last theorem. While a complete proof of Kummer’s result would take longer than we would like to spend on this, we will at least give a sketch of the argument using Dedekind’s ideal theory (as opposed to Kummer’s original approach via ideal numbers). Finally, a look at the class number tables in this chapter shows that even in the simple case of quadratic ﬁelds, the class numbers behave with apparently little regularity, just like prime numbers seem to behave with little regularity. Thus it might seem unlikely that one could come up with an exact formula for the class number hK. Remarkably, Dirichlet did just that, using the theory of L-functions, which itself is closely related to hidden regularities in prime numbers. This is what we will study at the end of Part I. 26","libVersion":"0.3.1","langs":""}
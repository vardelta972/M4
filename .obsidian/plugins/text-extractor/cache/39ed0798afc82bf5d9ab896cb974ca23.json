{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Kimball Martin/NT 2 (To the skies)/NT 2 Complete Notes.pdf","text":"Number Theory II Spring 2010 Notes Kimball Martin January 21, 2015 Exercise 0.1. Read the introduction. It’s a roadmap for the course. In fact, you may want to reread it several times throughout the course to remember where we’ve been and where we’re going. Introduction Last semester, we saw some of the power of Algebraic Number Theory. The basic idea was the following. If for example, we wanted to determine Which numbers are of the form x2 + ny2? (0.1) (For simplicity, assume n is squarefree.) Brahmagupta’s composition law tells us that the product of two numbers of this form is again of this form, and therefore it make sense to ﬁrst ask Which primes p are of the form x2 + ny2 = p? (0.2) The idea of Algebraic Number Theory is to work with the ring Z[ √−n] so any p such that p = x2 + ny2 = (x + y√−n)(x − y√−n) factors over Z[√ −n]. At this point one would like to use the Prime Divisor Property (or equivalently, Unique Factorization) to say that this means p is not prime in Z[ √−n]. Unfortunately this does not always hold in Z[ √−n], and there were two things we did to overcome this obstacle. The ﬁrst was to work with OQ(√−n) which is sometimes larger than Z[ √−n], and may have unique factorization when Z[ √−n] does not (we saw this for the case n = 3—it happens for other values of n also, but still only ﬁnitely many times when n > 0). Otherwise, we should use Dedekind’s ideal theory. The main idea here is we have the Prime Divisor Property and Unique Factorization at the level of ideas. Hence if p = x2 + ny2, the ideal (p) = pOQ( √−n) in OQ( √−n) is not a prime ideal and factors into two principal prime ideals (not necessarily distinct) (p) = p1p2, each of norm p. Further, p1 = (x + y√−n) and p2 = (x − y√−n). In fact, with some slight modiﬁcations, the converse is also true. To understand this, we ﬁrst need to understand the more basic question When is pOQ( √−n) a prime ideal, and when does it factor? (0.3) Once we know for which primes p ∈ N, (p) is not prime in OQ( √−n) (in which case we say p splits in Q(√−n)), we need to know What is the class group of Q(√−n)? (0.4) 1 to determine when (p) is a product of two principal ideals in OQ( √−n). The ﬁrst part of the semester will be motivated by these questions, though we shall spend a lot of our time pursuing related questions and topics along the way. In other words, our goal is not so much to seek a deﬁnitive answer to the question (0.2) (see [Cox]), but rather to use it as a guide to understand and pursue some important topics in number theory. Consequently, we will see how these ideas are related to (i) Dirichlet’s class number formula, (ii) Dirichlet’s theorem that any arithmetic progression with gcd 1 contains inﬁnitely many primes and (iii) Kummer’s approach to Fermat’s Last Theorem. Some references for this part of the course are [Cohn], [Stewart–Tall], [Borevich–Shafarevich], and [Cox], or more generally, any book on Algebraic Number Theory. Even knowing an answer to (0.2), we still won’t have a complete answer to (0.1), since the converse to Brahmagupta’s composition law is not true. For example 6 = x2 + 5y2 for x = y = 1, but neither 2 nor 3 are of the form x2 + 5y2. However, we can explain this via Gauss’s theory of quadratic forms, which in this case says the product of any two numbers of the form 2x2 + 2xy + 3y2 is of the form x2 + 5y2. Hence the question of which numbers are of the form x2 + 5y2 doesn’t quite reduce to just determining which primes are of this form. In the second part of the course we will use Gauss’s theory to determine which numbers are of the form x2 + 5y2 by studying the two forms x2 + 5y2 and 2x2 + 2xy + 3y2 in tandem (as well as understanding where the second form came from). In fact, we will see there is another approach to this question via Dirichlet’s mass formula, which in this case tells us the number of solutions to x2 + 5y2 = n and 2x2 + 2xy + 3y2 = n. I will conclude this section on binary quadratic forms by presenting illustrating how these forms can be used to quantitatively study the failure of unique factorization in OQ( √−5), a very interesting but largely neglectic topic. Some references for this section are [Cohn], [Cox], [Borevich–Shafarevich], [Landau], [Hurwitz], [Dirichlet] and [Narkiewicz]. In addition, many books on quadratic forms cover a large part of the material here, and some of the material in the next part. The third and ﬁnal part of the course is motivated by the theory of quadratic forms in n variables. Some of the theory of binary quadratic forms carries over to the case of more variables, but some crucial elements do not. We will not be attempting to develop a theory of quadratic forms in n variables, but rather introduce one of the key elements in this theory, the Hasse-Minkowski principle. Roughly, this principle says the following: an equation should have a solution in Z if and only if it has a solution in Z/pkZ for every prime power pk. This statement is not true in general, but is in special cases. To understand this principle, we’ll talk about valuations and p-adic numbers. The Hasse-Minkowski principle can then be used to prove Gauss’s famous theorem about which numbers are the sum of three squares. We will follow [Serre] for this. Another important use of p-adic numbers is the modern formulation of higher reciprocity (higher than quadratic) laws. These higher reciprocity laws are given by class ﬁeld theory, which is typically considered the crowning achievement in Algebraic Number Theory, most cleanly stated in the modern language of adèles. Time permitting, we will conclude with a brief discussion of adèles, class ﬁeld theory and higher reciprocity laws. Some references this are [Ramakrishnan–Valenza], [Ono], [Kato–Kurokawa–Saito], [Cohn2], [Cohn3]. See also any book on Class Field Theory. This may sound like a rather ambitious plan, and it is. Number Theory is a very rich subject, and one cannot learn even all the central topics of Algebraic Number Theory in a year long course. Any of these three parts could easily form a one semester long course by themselves (though perhaps the ﬁrst or third more so than the second), and class ﬁeld theory itself should be a year-long course. Consequently, we will not pursue many topics as deeply as they may deserve (such as Dirichlet’s Units Theorem), but I will mention important results and ideas throughout the text, which will 2 hopefully provide at least a good survey of the subject. This course is not a standard course in number theory, which is the reason we are not following a text. Part of this is due to the fact that the ﬁrst semester was a mix of elementary and algebraic number theory, whereas they are usually treated separately. But the main reason is my desire to treat the theory of binary quadratic forms (Questions (0.1) and (0.2) as well as the second part of the course), which is a very beautiful subject (and one of my interests, though not my primary research focus), but largely neglected in most modern treatments of Algebraic Number Theory (e.g., [Neukirch], [Marcus], [Janusz], [Lang], [Stewart–Tall], [Murty–Esmonde]). Notable exceptions are [Borevich–Shafarevich], [Cohn], and of course [Cox]. However [Borevich–Shafarevich] does not seem appropriate as a text for this class, [Cohn] virtually only treats quadratic ﬁelds, and [Cox] already assumes a fair amount of knowledge of algebraic number theory (he reviews it, but omits many proofs). Additionally, [Cohn] and [Cox] say nothing about p-adic numbers. Conversely most books on quadratic forms do not seem to contain much algebraic number theory, and have a diﬀerent focus than I intend for the course. Furthermore, while the bulk of the ﬁrst and third part of the course are part of a standard course in Algebraic Number Theory (usually without adèles), most Algebraic Number Theory courses in my experience focus on building up general theory for a long time, often requiring sizable tangents to develop the tools to prove theorems, before being able to get to many applications. While we will treat general number ﬁelds throughout the course (and see places where we need them for applications), we will in several places restrict our development of the theory to the case of quadratic ﬁelds (though not to the extent of [Cohn]), such as with Minkowski’s theory or the class number formula. One critique of this approach might be that one loses much depth this way, however I believe we will gain at least as much as we lose, by being able to go that much deeper into the study of quadratic ﬁelds and quadratic forms, thus gaining a more complete and global understanding of the “quadratic” theory, and hopefully a better appreciation of the subject. And in the future, if you need to understand some aspects of the general theory, it would be good to ﬁrst understand what happens in the simplest setting, that of quadratic ﬁelds. In fact, it is with future aims in mind, that I want to spend a considerable amount of time at the end of the semester on p-adic numbers and adèles. Speciﬁcally, they are (i) crucial to understanding modern number theory, (ii) something you need to know about if you end up working with Ameya Pitale, Alan Roche, Ralf Schmidt or myself, and (iii) something that comes up often in the representation theory seminar. During the last week of the course, I will plan on giving survey lectures about class ﬁeld theory, higher reciprocity laws, and how this leads into the Langlands Program, which is the general framework for most of the number theory research going on at OU and OSU. Finally, since we will be using primarily my notes and not a text, please let me know of any possible errors or unclear portions you may ﬁnd in the notes so I can address them. 3 Part I The ﬁrst part 1 Number Fields I will assume that every one is familiar with the material in the ﬁrst year algebra sequence, notably groups, rings, ﬁelds, ideals and Galois theory, as well as the material from Number Theory I, though I will review some of the key deﬁnitions and results which the undergraduates may not be familiar with, and perhaps the graduate students have forgotten. In this ﬁrst section, we will go over the basics of number ﬁelds, which will largely be a review of the second half of last semester, with some generalizations of notions introduced in the context of quadratic ﬁelds. However some fundamental notions will be new to us, such as discriminants. We will for the most part omit proofs of results covered last semester (even if we only sketched the proof) or in a standard Algebra course. For complete proofs, refer to any standard texts on Algebra and Algebraic Number Theory. Since the material in this chapter should be largely familiar to you, and the point is to ﬁll in some things we missed last semester, we will go through this section rather quickly. The presentation of the material in this chapter is based on [Stewart–Tall]. 1.1 Algebraic Numbers Let R[x] denote the ring of polynomials in x with coeﬃcients in a ring R. We say p(x) ∈ R[x] is monic if the leading coeﬃcient of p(x) is 1. (All rings for us are commutative with 1.) By the Fundamental Theorem of Algebra, any polynomial in Q[x] factors into linear factors in C. We say α ∈ C is an algebraic number if it is the root of some p(x) ∈ Q[x] (or equivalently a polynomial in Z[x], but then we can’t assume it’s monic). Without loss of generality we may assume p(x) is monic. If p(x) is of smallest degree such that this is true, and we say p(x) is the minimum polynomial of α (over Q), and the degree deg(α) of α deﬁned to be the deg(p(x)). If in fact p(x) ∈ Z[x], we say α is an algebraic integer. Some basic facts from algebra are that (i) the minimum polynomial p(x) of α is uniquely determined (which is why we make the monic condition), (ii) p(x) is irreducible over Q (and therefore Z if p(x) ∈ Z[x]), and (iii) if q(x) ∈ Z[x] and q(α) = 0, then p(x)|q(x) (in Q[x] or Z[x] if p(x) ∈ Z[x]). Lemma 1.1.1. Let α ∈ C. Then [Z[α] : Z] < ∞ if and only if α is an algebraic integer. In this case { 1, α, · · · , αm−1} is a Z-basis of Z[α] where m = deg(α). This was Proposition 10.9 from last semester. Lemma 1.1.2. Suppose α is an algebraic number. Then cα is an algebraic integer for some c ∈ Z. Proof. Suppose the minimum polynomial for α is p(x) = xn + an−1 bn−1 xn−1 + · · · + a1 b1 x + a0 b0 where each ai, bi ∈ Z. Let c = b0b1 · · · bn−1. Then p( y c ) = yn cn + an−1 bn−1cn−1 yn−1 + · · · + a1 b1c y + a0 b0 . Multiplying by cn, we see q(y) = c np( y c ) = yn + an−1c bn−1 yn−1 + · · · a1cn−1 b1 y + a0cn b0 ∈ Z[y]. But q(cα) = cnp(α) = 0, so y is an algebraic integer. 4 Recall from algebra that if R is an integral domain (not the zero ring and has no zero di- visors), we can form the smallest ﬁeld F containing R by considering the set of fractions F ={ a b : a, b ∈ R, b ̸= 0 }. This is called the ﬁeld of fractions or fraction ﬁeld of R. Theorem 1.1.3. The set B of all algebraic integers form a subring of C, and the set A of all algebraic numbers form its ﬁeld of fractions. We omitted the proof last semester, so here it is, in all its glory. Proof. Note that by the Lemma 1.1.1, B consists precisely of all elements α ∈ C such that [Z[α] : Z] < ∞. To show it is a subring of C, we want to show if α, β ∈ B, then so are α + β, α − β and αβ. But these elements are all clearly in Z[α, β], and [Z[α, β] : Z] = [Z[α, β] : Z[α]] · [Z[α] : Z] ≤ [Z[β] : Z] · [Z[α] : Z] < ∞. Since Z[α + β], Z[α − β] and Z[αβ] are all contained in Z[α, β], they must all have ﬁnite degree. To see that A is its ﬁeld of fractions, one runs through the same argument for ﬁelds. Namely, one shows that [Q(α) : Q] < ∞ if and only if α is algebraic. The above argument shows A is a ﬁeld. Lemma 1.1.2 shows that any element of A is a quotient of two elements in B. Exercise 1.1. Show by example that [Z[α, β] : Z[α]] need not equal [Z[β] : Z]. Deﬁnition 1.1.4. Let K be a subﬁeld of C We say K is a number ﬁeld if [K : Q] < ∞. Its ring of integers is OK = B ∩ K. From now on we let K denote a number ﬁeld. Proposition 1.1.5. K is the ﬁeld of fractions of OK. This follows from Lemma 1.1.2 as in the proof of Theorem 1.1.3. Proposition 1.1.6. We have K = Q(α) for some algebraic integer α. This is the Primitive Element Theorem from Galois theory. Here α is called a primitive element for K (over Q). Proposition 1.1.7. We have [K : Q] = [OK : Z]. Proof. Let α1, . . . , αn be a Z-basis for OK. By Lemma 1.1.2, any x ∈ K is a Q-linear combination of α1, . . . , αn. Hence to see α1, . . . , αn is a Q-basis for K it suﬃces to show they are linearly independent of Q. Suppose a1 b1 α1 + · · · + an bn αn = 0 for some ai, bi ∈ Z. Multiplying through by b1b2 · · · bn, the fact that the αi’s are linearly independent over Z (and no bi = 0) implies each ai = 0. If L ⊆ C is a ﬁeld containing K and [L : K] is ﬁnite, we say L is a ﬁnite extension of K of degree [L : K]. Clearly this means L is also a number ﬁeld since [L : Q] = [L : K] · [K : Q]. Corollary 1.1.8. If L is a ﬁnite extension of K, then [L : K] = [OL : OK]. Proof. [L : K] = [L : Q]/[K : Q] = [OL : Z]/[OK : Z] = [OL : OK]. 5 Suppose K is a quadratic ﬁeld, i.e., [K : Q] = 2. Recall that we may write K = Q( √d) where d ∈ Z is squarefree (and d ̸= 1). Recall d squarefree means n2|d =⇒ n2 = 1. Example 1.1.9. Suppose d ∈ Z is squarefree, d ̸= 1, and let K = Q( √d). Then OK = { Z[ 1+ √d 2 ] d ≡ 1 mod 4 Z[√d] d ≡ 2, 3 mod 4. If d > 0, we say K is a real quadratic ﬁeld since K ⊆ R. There are inﬁnitely many units of OK, and they are generated by a fundamental unit ϵ = x + y√n (the smallest ϵ > 1 such that N (ϵ) = x2 − ny2 = ±1) and −1. If d < 0, we say K is an imaginary quadratic ﬁeld since K ̸⊆ R. Here there are only ﬁnitely many units of OK, and precisely they are ±1, ±i (the 4-th roots of unity) if d = −1; they are ±1, ±ζ3, ±ζ 2 3 (the 6-th roots of unity) if d = −3; and they are ±1 (the 2-nd roots of unity) otherwise. (Recall the units of a ring R are the set of invertible elements and they are a group under multiplication.) 1.2 Some Galois theory Let L/K be an extension of number ﬁelds of degree n, i.e., [L : K] = n. An embedding of L ,→ C is a ﬁeld homomorphism from L into C, i.e., a map σ : L → C such that σ(x + y) = σ(x) + σ(y), σ(xy) = σ(x)σ(y), σ(−x) = −σ(x) and σ(x−1) = σ(x)−1. Necessarily σ(0) = 0, σ(1) = 1, and consequently σ ﬁxes Q, i.e., σ(x) = x for each x ∈ Q. Example 1.2.1. Let L = Q(i). A Q-basis for L is {1, i}. If σ : L ,→ C is an embedding, it ﬁxes 1, so it is determined by what it does to i. We must have σ(i)2 = σ(i2) = σ(−1) = −1 so i must map to a square root of −1, i.e., either i or −i. One may check that both of these give embeddings, σj : Q(i) → C given by σ1(a + bi) = a + bi (the trivial embedding), and σ2(a + bi) = a − bi (complex conjugation). The Galois group of L/K, denoted Gal(L/K) is the group of all embeddings of L ,→ C which ﬁx (each element of) K. The Galois closure of L/K is the smallest extension L′ of L such that each σ ∈ Gal(L/K) maps into L′. We say the extension L/K is Galois if L′ = L. Example 1.2.2. K = Q and L = Q(i). Every embedding of L into C ﬁxes K, so Gal(L/K) = {σ1, σ2} from the example above. Every embedding lies in L, so L/K is Galois. By the Primitive Element Theorem, we may write L = K(α) where α is an algebraic integer. Let f (x) ∈ K[x] be the minimum polynomial for α over K. This means f (x) is the irreducible monic polynomial of smallest possible degree with coeﬃcients in K (in fact OK since α is an integer) such that f (α) = 0. It is not diﬃcult to show that deg(f (x)) = n (in fact, we already did in the case K = Q). Example 1.2.3. K = Q(√2) and L = Q( 4√2) = K(α) where α2 = √2 ∈ K. The minimum polynomial for α over K is f (x) = x2 − √2. (Contrast this with the minimum polynomial for α over Q: p(x) = x4 − 2, of degree 4). Exercise 1.2. In the above example, show L/K is Galois, but L/Q is not. 6 Theorem 1.2.4. Suppose L = K(α) and f (x) is the minimum polynomial of α over K. The n roots of f (x) are all distinct, call them α = α1, α2, . . . , αn. Every embedding of L ,→ C permutes the roots f (x), and Gal(L/K) acts transitively on the roots. Conversely, every embedding L ,→ C is uniquely determined by the way it permutes the roots of f (x). Therefore, Gal(L/K) is isomorphic to a transitive subgroup of Sn. Further the Galois closure of L/K is L′ = K(α1, α2, . . . , αn), i.e., L/K is Galois if and only if L contains all the root of f (x). See any reference on Galois theory. Here Sn denotes the symmetric group on n-letters, i.e., the permutations of {1, 2, . . . , n}. Note that L′ = K(α1, . . . , αn) is often called the splitting ﬁeld of f (x) (over K), since it is the smallest ﬁeld such that f (x) splits into linear factors. Corollary 1.2.5. Any quadratic extension L/K (i.e., [L : K] = 2) is Galois. Proof. Write L = K(α) and f (x) as the minimum polynomial for α over K. It is immediate from the quadratic formula that once L contains one root of f (x), it contains the other. Hence L/K is Galois by the above theorem. Example 1.2.6. Let n > 0. The splitting ﬁeld for f (x) = x2 +n over K = Q is L = Q( √−n). This also splits the quadratic form x2 + ny2. The extension L/K is Galois by the above corollary, and the Galois group is given by the maps σ1(a + b √−n) = a + b √−n and σ2(a + b √ −n) = a − b √−n. The map σ1 corresponds to the trivial permutation of the roots ± √ −n of f (x), and σ2 interchanges these two roots. Exercise 1.3. Let K = Q and L = Q( 3√2). Determine the splitting polynomial f (x) for α = 3√ 2 over K. Using the above theorem, answer the following. (i) Is L/K Galois? If not, ﬁnd the Galois closure. (ii) Determine Gal(L/K) explicitly (either as embeddings or permutations of roots of f (x). All of the above is covered in any standard lectures on Galois theory (though we haven’t stated the main theorems of Galois theory), but now we will be introducing notions that are more properly a part of a course on Algebraic Number Theory. Deﬁnition 1.2.7. Let α ∈ L. The conjugates of α in L/K are the elements ασ = σ(α) where σ ∈ Gal(L/K). The norm of α from L to K is NL/K(α) = ∏σ∈Gal(L/K) ασ and the trace of α from L to K is TrL/K(α) = ∑ σ∈Gal(L/K) ασ. In the case K = Q and L is understood, we simply write N (α) and Tr(α) for NL/K(α) and TrL/K(α). It is a standard fact from Galois theory that α ∈ L in fact lies in K if and only if ασ = α for each σ ∈ Gal(L/K). Warning: If L/K is not Galois, then the conjugates of α in L/K may not lie in L. Precisely, if L/K is not Galois, then there exist σ ∈ Gal(L/K) such that the image of σ is not contained in L. Hence there is some α ∈ L such that the conjugate σ(L) ̸∈ L. What is true is that they always lie in the Galois closure L′ of L, by deﬁnition of the Galois closure. Example 1.2.8. Let L = Q(√d) and K = Q. For α = a + b √d ∈ L, NL/K(α) = N (α) = a2 − db2 and TrL/K(α) = Tr(α) = 2a. Lemma 1.2.9. The norm map is multiplicative and the trace map is additive. For α ∈ L, NL/K(α), TrL/K(α) ∈ K. Further, if α ∈ OL, then NL/K(α) ∈ OK and TrL/K(α) ∈ OK. 7 Proof. The ﬁrst statement is immediate from the deﬁnitions. The second statement is true since the product and sum of all the conjugates of α are invariant under Gal(L/K), and therefore lie in K. For the last statement, observe α is an algebraic integer if and only if each of its conjugates are (since they all have the same minimum polynomial). Corollary 1.2.10. Let α be an algebraic number of degree 2 and L = Q(α). Then α is an algebraic integer if and only if NL/Q(α), TrL/Q(α) ∈ Z. Proof. The ⇒ direction follows from the lemma. The other direction follows from the fact that the minimum polynomial of α is x2 − TrL/Q(α)x + NL/Q(α), which was an exercise last semester. Note that this is not true for algebraic numbers of higher degree. In general if α is of degree n, one needs to consider the symmetric functions τj : L → Q where L = Q(α) and τj(x) is the sum of all products of j conjugates. For instance if x1 = x, x2, . . . , xn denote the n conjugates (not necessarily distinct numbers) of x, then τ1(x) =x1 + x2 + . . . + xn = TrL/Q(x) τ2(x) =x1x2 + x1x3 + · · · + x1xn + x2x3 + · · · x2xn + · · · + xn−1xn ... τn(x) =x1x2 · · · xn = NL/Q(x). Then one can show the minimum polynomial for α is xn + (−1) n−1τ1(α)xn−1 + · · · − τn−1(α)x + τn(α). Exercise 1.4. Suppose α, β ∈ L are conjugates in L/K. Show NL/K(α) = NL/K(β) and TrL/K(α) = TrL/K(β). Exercise 1.5. Let α ∈ OK. Prove α is a unit of OK if and only if NK/Q(α) = ±1. Exercise 1.6. Write down a Q-basis for K = Q( 3√2). For each α in this basis, compute NK/Q(α) and TrK/Q(α). Exercise 1.7. Let K = Q(√2) and L = K(√3) = Q( √2, √3). Write down a Q-basis for L. Compute Gal(L/K) and Gal(L/Q). (Hint for those who haven’t seen Galois theory before: it’s not so easy to ﬁnd a primitive element for L/Q and determine its minimum polynomial, so it’s better to just use the deﬁnition of the Galois group. Of course, if you know Galois theory, there are other ways to determine Gal(L/Q) and you may do it any you like.) For each α in this basis compute NL/K(α) and NL/Q(α). Check that NL/Q(α) = NK/Q(NL/K(α)). One thing you may have noticed in the examples and exercises above is that Gal(L/K) tends to equal [L : K]. In fact this is always true and is one of the standard results in Galois theory, though you may have only proved it for Galois extensions. Proposition 1.2.11. |Gal(L/K)| = [L : K]. Proof. Write L = K(α). Then 1, α, . . . , αn−1 is a Q-basis for K. Thus an embedding σ : L → C which ﬁxes every element of K is determined by what it does to α. Let f (x) be the minimum polynomial of α, which has degree n = [L : K]. Since σ is a ﬁeld homomorphism, σ(α) must also have minimum polynomial f (x). Since f (x) has n distinct roots, α = α1, α2, . . . , αn, there are n possibilities for σ ∈ Gal(L/K) given by σ(α) = αi. One formally checks that each of these give an embedding into C. 8 1.3 Discriminants Let K be a number ﬁeld, n = [K : Q]. Then |Gal(K/Q)| = n. Write Gal(K/Q) = {α1, . . . , αn}. Deﬁnition 1.3.1. Let {α1, . . . , αn} be a Q-basis for K. The discriminant of {α1, . . . , αn} is ∆[α1, . . . , αn] = det (σi(αj)) 2 . If α1, . . . , αn is a Z-basis for OK, we deﬁne the discriminant of K to be ∆K = ∆[α1, . . . , αn]. If R is a ring, we deﬁne the Mn(R) to be the set of n × n matrices with coeﬃcients in R. This is also a ring, with the obvious identity element, and the invertible elements of Mn(R) form a group under multiplication, denoted by GLn(R), and called the general linear group of rank n over R. If R is an integral domain, then A ∈ Mn(R) lies in GLn(R) if and only if det(A) is a unit in R. Lemma 1.3.2. Let {α1, . . . , αn} and {β1, . . . , βn} be two Q-bases for K. Then we can write      β1 β2 ... βn  | | |  = C      α1 α2 ... αn  | | |  for some C ∈ GLn(Q). Then ∆[β1, . . . , βn] = det(C)2∆[α1, . . . , αn]. Further, if {α1, . . . , αn} and {β1, . . . , βn} are Z-bases (also called integral bases) for OK, then we may take C ∈ GLn(Z). in the above. Consequently, ∆[β1, . . . , βn] = ∆[α1, . . . , αn], i.e., ∆K does not depend on the choice of the integral basis for OK. Proof. The fact that there is some such C is elementary linear algebra. The equation about deter- minants follows from (σi(βj)) = C (σi(αj)), which holds because each σi ﬁxes Q. (If this isn’t clear to you, just write out the equations βk = ∑ cjkαj for, say n = 2 or 3, and apply each σi.) The second paragraph follows in the same way. Here we note that if C ∈ GLn(Z), then det(C) = ±1, so det(C)2 = 1. This provides at least one explanation for why we look at the square of the determinant in the deﬁnition of the discriminant—so that we can deﬁne ∆K as an invariant of a number ﬁeld, independent of choice of basis for OK. Exercise 1.8. A priori, the discriminant ∆[α1, . . . , αn] is deﬁned for an ordered Q-basis α1, . . . , αn of K. Show that the above lemma implies this discriminant does not depend upon the order, i.e., for any τ ∈ Sn, show ∆[ατ (1), . . . , ατ (n)] = ∆[α1, . . . , αn]. Note: the quantity det(σi(αj)), which is one of the square roots of the discriminant, is called the diﬀerent of {α1, α2, · · · , αn}. We will not use the diﬀerent in this course (I don’t think), but you may see come up if it you look at other texts. A note on terminology: one can form the diﬀerent and discriminant for an arbitrary collection of n integers α1, . . . , αn. Then the discriminant and diﬀerent are nonzero if and only if α1, . . . , αn are linearly independent, i.e., form a Q-basis for K. Furthermore, if α1, . . . , αn and β1, . . . , βn have diﬀerent discriminants then the submodules M = { ∑ niαi : ni ∈ Z} and N = {∑ niβi : ni ∈ Z} are distinct. 9 Example 1.3.3. Let d ̸= 1 be a squarefree integer and K = Q(√d). Suppose d ≡ 2, 3 mod 4 so OK = Z[ √d]. We can take {α1, α2} = { 1, √d } as a choice for an integral basis for OK. We can write Gal(K/Q) = {σ1, σ2} where σ1 is trivial and σ2 permutes √d and − √d. Hence the matrix (σi(αj)) = (1 √d 1 − √d ) , which has determinant −2 √d. Hence the discriminant of K is ∆K = ∆[1, √d] = 4d. Exercise 1.9. Let d ̸= 1 be a squarefree integer and K = Q(√d). Suppose d ≡ 1 mod 4. Compute the discriminant ∆K of K. Exercise 1.10. Let K be a quadratic ﬁeld of discriminant ∆. Show (i) ∆ ≡ 0, 1 mod 4, (ii) K is uniquely determined by ∆, and (iii) we can write OK = { x + y√∆ 2 : x, y ∈ Z, x ≡ 0 mod 2 } if ∆ ≡ 0 mod 4, and OK = { x + y√∆ 2 : x, y ∈ Z, x ≡ y mod 2 } if ∆ ≡ 1 mod 4. Part (ii) of the above exercise means that the discriminant is a complete invariant for quadratic ﬁelds. The point of part (iii) is that, while there is a fundamental diﬀerence between OK when ∆K ≡ 0 mod 4 and ∆K ≡ 1 mod 4 (which correspond to d ̸= 1 mod 4 and d ≡ 1 mod 4 for K = Q(√d) with d squarefree), we can always write an element of OK of the form x+y√∆ 2 with some simple congruence conditions on x, y. This will be useful when we want to treat both the ∆ ≡ 0 mod 4 and the ∆ ≡ 1 mod 4 cases together. Now let’s return to discriminants of general number ﬁelds. Lemma 1.3.4. Let α1, . . . , αn be a Q-basis for K. Then ∆[α1, . . . , αn] ∈ Q\\ {0}. If α1, . . . , αn ∈ OK, then ∆[α1, . . . , αn] ∈ Z\\ {0}. Proof. By the previous lemma, the discriminants of any two bases for K diﬀer by rational squares. Hence it suﬃces to check that it is true for a single Q-basis of K. Then the second statement follows from the ﬁrst, since the discriminant is then a polynomial expression of algebraic integers, and thus an algebraic integer itself. We can write K = Q(α) where α is some algebraic number (integer if we like) of degree n. Then{1, α, α2, . . . , αn−1} is a Q-basis for K. Let α1 = α, α2, . . . , αn denote the (distinct) conjugates of 10 α. Then the conjugates of αi are αi 1 = αi, αi 2, . . . , αi n. Hence the determinant of this basis is the square of the discriminant of A =      1 α1 α2 1 · · · αn−1 1 1 α2 α2 2 · · · αn−1 2 ... ... ... ... ... 1 αn α2 n · · · αn−1 n  | | |  . This matrix is a Vandermonde matrix, and it is a standard algebra exercise that this has determinant∏1≤i<j≤n(αj − αi). (The determinant is a polynomial in the αi’s, and clearly it is zero if some αi = αj, so each polynomial αj − αi divides the determinant. Then one counts the degree of the polynomial, to show that this is correct up to a constant. Comparing coeﬃcients of one of the terms gives the Vandermonde determinant formula. You could also prove this by induction, but the above argument seems simpler.) Hence ∆[α1, . . . , αn] = ∏i̸=j(αj − αi). Note any σ ∈ Gal(K/Q) simply permutes the terms in this product, i.e., ∆[α1, . . . , αn] is Gal(K/Q)-invariant, and thus in Q. It is clear from the product expression that it is nonzero. Exercise 1.11. Verify the Vandermonde determinant formula given above for n = 2 and n = 3. While, the determination of OK was simple for quadratic ﬁelds K, in general it is not so easy. There are algorithms to determine OK, but we will not focus on this problem in general, as we will only need explicit determinations of OK in special cases. However, we will brieﬂy indicate how one can use discriminants to help ﬁnd a ring of integers. It suﬃces to ﬁnd an integral basis for OK. 1. Guess a possible integral basis {β1, · · · , βn} for OK. Suppose {α1, . . . , αn} is an actual integral basis for OK. Then ∆[β1, · · · , βn] = det(C)2∆[α1, . . . , αn] = det(C)2∆K. In other words, ∆[β1, · · · , βn] is a square (in Z) times ∆K. Hence if ∆[β1, . . . , βn] is squarefree, then {β1, . . . , βn} is an integral basis for OK. 2. If ∆[β1, · · · , βn] is not squarefree, {β1, · · · , βn} may still be a basis (see Example 1.3.3 above), but if it is not, then OK contains an integer of the form 1 p (c1β1 + c2β2 + · · · + cnβn) for some cn ∈ Z and p is some prime such that p2|∆[β1, · · · , βn]. Check to see if any numbers of this form give any new algebraic integers not generated by β1, . . . , βn. If so, suitably modify the choice of β1, . . . , βn and repeat. If not, then β1, . . . , βn is an integral basis of OK. Exercise 1.12. In the last section, we considered general extensions of number ﬁelds L/K. One reason you might want to do this is the following. We want to use K = Q( √−5) to study the form x2 + 5y2. However OK does not have unique factorization. But we can embed K in the ﬁeld L = Q(√−5, i) which does have unique factorization. Now one wants do determine OL. A ﬁrst guess might be {1, √−5, i, √5} is an integral basis for OL. It is certainly a Q-basis for L. Compute the discriminant of this Q-basis. Can you determine OL? However we will primarily be concerned with other applications of discriminants this semester, most immediately to ideals in the next section. Discriminants are a fundamental invariant of number ﬁelds. Another thing they provide is natural way to at least partially order number ﬁelds. (There are only ﬁnitely many ﬁelds of a ﬁxed discriminant.) The quadratic ﬁelds Q(√d) can easily be ordered by d (which actually is a function of the discriminant, but how can one order ﬁelds of a more complicated form, such as Q(√3, √−19) 11 and Q(√−7, √ 11)?) Once one has some sort of ordering, it is meaningful to ask questions like what percentage of ﬁelds (of a certain type) have class number 1 or 2, or more generally, how many ﬁelds up to a certain point satisfy Property X? We also remark that there is a geometric interpretation of determinants (and diﬀerents), which comes from the geometric interpretation of discriminants. For now, we will just mention it in the simplest case K = Q(√−d) where d > 0 squarefree. Then if α, β is a Q-basis for K, α and β generate a lattice Λ = ⟨α, β⟩ = {mα + nβ : m, n ∈ Z}. Then vol(C/Λ) = 1 2 √ −∆[α, β]. In particular, ∆K = −4vol(C/OK)2. We can state an analogue of this for arbitrary number ﬁelds when we study the geometry of numbers. 1.4 Ideals Let K be a number ﬁeld. Recall I is an ideal of OK if I is a nonempty subset of OK which is closed under addition and multiplication by OK. The norm of an ideal I of OK is N (I) = |OK/I|. Lemma 1.4.1. For any nonzero ideal I of OK, the norm N (I) = |OK/I| is always ﬁnite. Fur- thermore, if β1, . . . , βn is a Z-basis for OK, then N (I) = √ ∆[β1,...,βn] ∆K . Recall a free abelian group of rank n is a group isomorphic to Zn. For the proof, we use the fact that if A is a free abelian group of rank n, and B is a subgroup of A, then B is also free abelian of rank ≤ n. Proof. Let n = [K : Q]. Then OK is a free abelian group of rank n (w.r.t. addition). We can regard I as a subgroup of OK, which must also be free of rank ≤ n. Let i ∈ I be nonzero. Then (OKi, +) is a (free abelian) subgroup of (I, +) of rank n, hence I has rank n. Now we let β1, · · · , βn be a Z-basis for I. Then there is a Z-basis α1, · · · , αn of OK such that for each i we can write βi = ciαi for some ci ∈ Z. Then it is clear OK/I = ∏ Cci, where Cr denotes the cyclic group of order r. In particular N (I) is ﬁnite. Moreover, we have      β1 β2 ... βn  | | |  =      c1 c2 . . . cn  | | |       α1 α2 ... αn  | | |  . By Lemma 1.3.2, we have ∆[β1, . . . , βn] = N (I)2∆[α1, . . . , αn] = N (I)2∆K. This gives the result since N (I) ≥ 0. Note that the norm of the zero ideal is inﬁnite as we have deﬁned it, though it may make more sense to deﬁne it to be 0 in light of the the next result, which relates norms of ideals to norms of elements. In any case, since we have no particular reason to work with the zero ideal, in order to simplify statements we will from here on, assume all our ideals our nonzero, unless explicitly stated otherwise. Proposition 1.4.2. Suppose I = (α) is a principal ideal of OK. Then N (I) = |NK/Q(α)|. Here the norm on the left is the ideal norm, and the norm on the right is the norm of an element. 12 Proof. Let α1, . . . , αn be a Z-basis for OK. Then β1 = αα1, . . . , βn = ααn is a Z-basis for I. Write Gal(K/Q) = {σ1, . . . , σn}. Note ∆[β1, . . . , βn] = det    σ1(α)σ1(α1) · · · σ1(α)σ1(αn) ... . . . ... σn(α)σn(α1) · · · σn(α)σn(αn)  |  2 = det      σ1(α) σ2(α) . . . σn(α)  | | |  2 det    σ1(α1) · · · σ1(αn) ... . . . ... σn(α1) · · · σn(αn)  |  2 = NK/Q(α)2∆[α1, . . . , αn] = NK/Q(α) 2∆K. Now apply the previous lemma. This implies that the ideal norm is multiplicative, at least for principal ideals. Of course, we want to know it’s multiplicative for all ideals, and this basically follows from some simple isomorphism theorems, but at one point, to keep our argument as simple as possible, we will use fractional ideals. This is justiﬁed by Theorem 1.4.4 below (which we have already given last semester), whose proof does not rely on this result. Recall that the product of two ideals I and J , is the ideal generated by all elements of the form ij for i ∈ I and j ∈ J , i.e., IJ = {∑ imjm : im ∈ I, jm ∈ J }. Proposition 1.4.3. Let I, J be ideals of OK. Then N (IJ ) = N (I)N (J ). Proof. By the ring isomorphism theorem, OK/I ≃ (OK/IJ )/(I/IJ ). (Just think about the case where OK = Z, I = (m), J = (n). Then this says Z/mZ ≃ (Z/mnZ)/(mZ/mnZ).) The details are in the exercise below. Hence N (IJ ) = |I/IJ | · N (I). Now it suﬃces to show OK/J ≃ I/IJ , say as abelian groups. Consider the map ϕ : OK → I/IJ given by ϕ(α) = αI + IJ for α ∈ OK. It is clear it is a group homomorphism. Note ϕ(α) = IJ ⇐⇒ αI + IJ = IJ ⇐⇒ αI ⊆ IJ , which, multiplying by I −1 is equivalent to αOK ⊆ J , which is equivalent to α ∈ J . Hence ker(ϕ) = J . On the other hand, it is clear ϕ is surjective. Thus it induces the desired isomorphism ϕ : OK/J → I/IJ . Exercise 1.13. Show the map ϕ : OK/IJ → OK/I given by α + IJ 7→ α + I for α ∈ OK is well-deﬁned (i.e., ϕ does not depend on the choice of coset representative α ∈ α + IJ ), has kernel I/IJ , and is surjective. This gives the isomorphism OK/I ≃ (OK/IJ )/(I/IJ ) claimed above. If I ⊆ K such that aI is an ideal of OK for some a ∈ OK, we say I is a fractional ideal of OK. Moreover a fractional or ordinary ideal I is called principal, if it is generated by a single element, i.e., if it is of the form aOK for some a ∈ K. Denote by Frac(OK) the set of (nonzero) fractional ideals of OK, and Prin(OK) the set of (nonzero) principal fractional ideals of OK. Multiplication for fractional ideals is deﬁned the same as for ordinary ideals. Theorem 1.4.4. Frac(OK) is an abelian group under multiplication, and Prin(OK) is a subgroup. If I, J are ideals of OK, we say J divides I (J |I) if J ⊇ I, from which one can conclude from the above theorem that I = J J ′ for some ideal J ′. An ideal I of OK is proper if I ̸= OK. We 13 say a proper ideal p is prime if p|IJ implies p|I or p|J (technically, the zero ideal is prime, but we are ignoring the zero ideal), and it is maximal if I|p implies I = p or I = OK. Recall that p is prime if and only if OK/p is an integral domain, and p is maximal if and only if OK/p is a ﬁeld. (Remark: this kind of result is one reason we don’t allow for a ﬁeld to have just one element.) Since every ﬁnite integral domain is a ﬁeld, one is able to conclude every (nonzero) prime ideal is maximal and vice versa. Theorem 1.4.5. (Prime ideal factorization) Let I be a proper ideal of OK. Then I = p1 · · · pr where the pi’s are prime ideals of OK. Moreover the pi’s are determined uniquely up to ordering. We proved these theorems last semester, modulo a couple of details about the ﬁrst theorem. If you want to ﬁll in these details for yourself, you can try to work it out yourself from the Chapter 12 notes from last semester, or see any text on Algebraic Number Theory, such as [Stewart–Tall]. Deﬁnition 1.4.6. The quotient group Frac(OK)/Prin(OK) is called the class group of K, and denoted Cl(OK) or ClK. The size of the class group is called the class number of K, and denoted by hK. Corollary 1.4.7. OK has unique factorization if and only if hK = 1. Proof. Note hK = 1 means OK is a PID. Since every PID is a UFD (from algebra or last semester), the ⇐ direction holds. To prove the ⇒ direction, suppose OK has unique factorization. Suppose p is a prime ideal of OK. Let n ∈ p and n = α1 · · · αk be unique factorization of n into (non-unit) irreducibles. Note each αi satisﬁes the prime divisor property by unique factorization, each αi is a prime element of OK, and therefore each (αi) is a prime ideal. Hence (n) = (α1)(α2) · · · (αk) is the prime ideal factorization of (n). On the other hand, since p|(n), p must equal one of the (αi)’s by uniqueness of prime ideal factorization. Hence every prime ideal of OK is principal. Then by prime ideal factorization again, every ideal must be principal. We mentioned last semester that there are only ﬁnitely many imaginary quadratic ﬁelds with unique factorization, and conjecturally inﬁnitely many such real quadratic ﬁelds. We will a bit more talk more about this later, but ﬁrst we need a way to compute the class group or class number of a ﬁeld. In fact, perhaps even before that, we want to know the class number is ﬁnite. The standard proof for this is via Minkowski’s theory of the geometry of numbers, and it will in fact give us a bound on the class number, which will in turn allow us to compute the class group in explicit examples. In fact, to get an idea of how one can do such a thing, you may want to look at the Chapter 12 notes from last semester, where, following Stillwell, I prove directly that hQ( √−5) = 2, though we didn’t have a chance to cover it in lecture last semester. The proof via Minkowski’s theorem is somewhat less direct, and to keep things as simple as possible, we will only give a complete proof in the case of quadratic ﬁelds. A more sophisticated proof of the ﬁniteness of the class group is via the theory of p-adic numbers and adèles which we will develop in Part III. Time permitting, we will give this proof in the 3rd part of the course for general number ﬁelds. Another way to compute the class number is to use a formula of Dirichlet, which we will turn to after Minkowski’s bound. An alternative way to compute the class number and group for quadratic ﬁelds will be given by Gauss’s theory of binary quadratic forms in Part II (which historically came ﬁrst). 14 1.5 Lattices Before explaining Minkowski’s geometry of numbers, we need to know some basic facts about lattices. Deﬁnition 1.5.1. A (complete) lattice Λ in Rn is a subset of Rn of the form ⟨v1, v2, . . . , vn⟩ = {∑ aivi : ai ∈ Z} such that v1, . . . , vn ∈ Rn are linearly independent over R. The set v1, . . . , vn is called a basis for Λ (it is a Z-basis). As both Rn and Λ are abelian groups under addition, we let Rn/Λ denote the quotient group. A fundamental domain for Λ (or Rn/Λ) is a connected, locally convex∗ Ω of Rn such that Ω contains exactly one element from each coset of Rn/Λ. In other words, the (complete) lattices in Rn are the Z-spans of bases of Rn. The adjective complete refers to the fact that the number of basis elements of the lattice is maximal. An incomplete lattice of Rn would be the Z-span of a basis of a proper subspace of Rn. However, for us, all lattices will be complete unless stated otherwise. Note a lattice is a free abelian subgroup of Rn of rank n, but not all free abelian subgroups of rank n are lattices. For example, Z[ √2] ⊆ R is a free abelian subgroup of R2 of rank 2 (embedding R in R2), generated by 1 and √2, but not a lattice since 1 and √2 are not linearly independent over R. The main idea with fundamental domain is that it is a subset of Rn which looks like the quotient group Rn/Λ. More precisely, it is a connected subset of Rn comprising exactly one representative from each coset of Rn/Λ. The condition of local convexity is just to avoid pathological examples of fundamental domains (see examples below). In any case, it won’t be important for us to understand the subtleties of what kinds of sets make up fundamental domains, but rather just the basic idea of what one is, and understanding what the “standard” fundamental domain is. Hopefully this should be clear when we look at the cases in R1 and R2. It is a basic fact that any fundamental domain for Λ has the same volume (length in dimension 1, area in dimension 2). This volume is called the volume (or covolume) of the lattice Λ (or more properly the quotient R/Λn), denoted vol(Λ) (or more properly vol(Rn/Λ)). (To be formally complete, we can get away without proving this fact about all fundamental domains having the same volume by deﬁning the volume of the lattice to be the volume of the standard fundamental domain, deﬁned below.) If Λ is an incomplete lattice, then Rn/Λ will have will have inﬁnite volume. Example 1.5.2. Since any free abelian group of rank n is isomorphic, as an abelian group, to Zn, the most obvious example of a lattice in Rn is Zn. The standard fundamental domain for Zn is Ω = [0, 1)n ⊆ Rn. It should be clear any element of Rn is a Zn translate of exactly one element in Ω. It is obviously connected and convex, therefore locally convex. It is clear vol(Λ) = 1. While all lattices of Rn are isomorphic as abelian groups, they also have an inherent geometry coming from Rn, providing more structure. We will not need this, but just to clear up terminology, we will only say two lattices of Rn are isomorphic as lattices if they (or equivalently, their fundamen- tal domains) have the same shape and size—precisely, they will be isomorphic if one is the image of the other by an isometry (distance preserving map) of Rn. In linear algebra, you may have learned that the (linear) isometries of Rn are precisely the elements of O(n) = { A ∈ GLn(R) : AtA = I} , the real orthogonal group of rank n. This means that two lattices of Rn are isomorphic if and only if (a basis of) one can be transformed into (a basis of) the other by an element of O(n). ∗Locally convex means if two “nearby” points are in the set, then the line between them is in the set. 15 Example 1.5.3. As a special case of the above example with n = 1, Z is a lattice in R, as is Λk = kZ. Notice that Λk = Λk′ if and only if k = −k′. These are all the lattices in R, in 1 − 1 correspondence with R>0, parameterized by this number k. A fundamental domain for R/Λk (sometimes also referred to as R mod k) is [0, k). In fact any half-open interval of length k is a fundamental domain for Λk, and there are no other fundamental domains because of the connectedness requirement. We think of R/Λk as the interval [0, k] with the endpoints glued, hence topologically it is a circle. Geometrically, its length is vol(Λk) = k. Example 1.5.4. A lattice in R2 is determined by two generators, u = (x1, y1) and v = (x2, y2), provided they are linearly independent. Precisely, the lattice Λ = ⟨u, v⟩ generated by u and v is Λ = {mu + nv : m, n ∈ Z} ⊆ R2. The standard fundamental domain for Λ is Ω = {au + bv : a, b ∈ [0, 1)}. In other words, the standard fundamental domain for Λ is the interior of the parallelogram deter- mined by 0, u, v and u + v, together with half of the boundary (since opposite boundary points are equivalent modulo Λ, we can only include half of them, and one of the corners). Any R2-translate of Ω is also a fundamental domain for Λ. We may think of the quotient group R2/Λ as the fundamental domain (parallelogram) Ω, with the addition of two vectors being the sum in the fundamental domain, and if the vector lies outside of Ω, we let it wrap it around the edges of the parallelogram Pacman-style so the sum lies again in Ω. In other words, we think of R2/Λ as the parallelogram Ω, with opposite sides glued. Topologically this is a torus. Example 1.5.5. Let a, b > 0. The volume of the lattice Λa,b = ⟨(a, 0), (0, b)⟩ is ab, since a fun- damental domain is a rectangle with corners 0, (a, 0), (0, b), (a, b) (excluding appropriate bound- ary points). Two of these rectangular lattices Λa,b and Λc,d will be isomorphic if and only if {a, b} = {c, d}. Hence there are inﬁnitely many non-isomorphic rectangular lattices of volume 1 given by Λa, 1 a . To generalize the above examples, the standard fundamental domain for Λ = ⟨v1, v2 . . . , vn⟩ (or more properly for the basis v1, . . . , vn) is Ω = { ∑ aivi : ai ∈ [0, 1)}. It is straightforward to show this is in fact a fundamental domain. Then Rn/Λ looks like an n-dimensional parallelogram (parallelopiped?) and topologically is an n-dimensional torus (the product of n circles). (To be complete, if we deﬁne volume of a lattice as the volume of a standard fundamental domain, one should show that any two bases of Λ are related by an element of GLn(Z). Then, expressing the volumes of standard fundamental domains as determinants, one can conclude that the volume is independent of the choice of basis.) Exercise 1.14. Consider the lattice Λ = ⟨u = (1, 0), v = ( 1 2 , √3 2 )⟩ in R2. Sketch the standard fundamental domain for {u, v} compute its volume. Write down 2 other bases {u1, v1}, {u2, v2} for Λ that do not just diﬀer by sign (i.e., {u, v} ̸= {±ui, ±vi} and {u1, v1} ̸= {u2, v2}). Sketch the standard fundamental domains for {u1, v1} and {u2, v2} and check they have the same volume. Exercise 1.15. Let Λ = ⟨u, v⟩ be a lattice in R2 such that Λ ⊆ Z2. Let Ω be the standard funda- mental domain for the basis {u, v} of Λ. Show the volume of R2/Λ is the number of integral points in Ω, i.e., vol(R2/Λ) = |Ω ∩ Z2|. Example 1.5.6. Consider the lattice Z2 in R2. A non-rectangular fundamental domain may be constructed as follows. Start with a standard fundamental domain and remove a semicirclular shape 16 from one of the sides, then glue this shape onto the opposite side. (Draw a picture). This is no longer convex, but it is still locally convex. Now here is a non-example of a fundamental domain, which satisﬁes all properties except local convexity. Let Ω be the union of line segments Ly for 0 ≤ y < 1 where Ly is the line from (0, y) (inclusive) to (1, y) (exclusive) if y is rational and to (−1, y) (exclusive) if y is irrational. Then it is clear Ω contains exactly one representative from each coset of R2/Z2, and it is connected since it is a union of horizontal line segments which are joined by the y axis, but it is not locally convex. (Think why, draw a picture.) Now to apply this to ideal theory, we need to know Minkowski’s Theorem. Recall X ⊆ Rn is called symmetric if X = −X. Theorem 1.5.7. (Minkowski) Let Λ be a lattice in Rn and X a bounded symmetric convex subset of Rn. If vol(X) > 2nvol(Rn/Λ), then X contains a nonzero point of Λ. Proof. (It may be helpful to draw a picture for n = 2.) Let L be the lattice L = 2Λ. It is clear vol(Rn/L) = 2nvol(Rn/Λ), so vol(X) > vol(Rn/L). Thus, if Ω is a fundamental domain for Rn/L, the natural map from Rn to Ω cannot be injective when restricted to X. Thus there must be two points x1, x2 ∈ X such that x1 ≡ x2 mod L (i.e., they map to the same point in Ω), i.e., x1 −x2 ∈ L. Since X is symmetric −x2 ∈ X. Then convexity implies 0 ̸= 1 2 x1 − 1 2 x2 ∈ X ∩ Λ. Two classical applications of Minkowski’s theorem are that it can be used to prove Fermat’s two square theorem or Lagrange’s four square theorem. See [Stewart–Tall] for both proofs, or the Chapter 8 notes from last semester for the proof of the four square theorem. However, we are more interested in the applications to ideals in the following sections. 1.6 The geometry of numbers: the quadratic case What Minkowski termed the geometry of numbers is most plain to see in the imaginary quadratic case. Let K = Q( √−d) with d > 0 squarefree. Then OK is a lattice in C ≃ R2. Hence, any ideal of OK is a lattice in C ≃ R2. In fact, even if K = Q( √d) is a real quadratic ﬁeld, we may think of OK as a lattice in R2. (As we remarked earlier with Z[ √2], even though K ⊆ R, OK is not a lattice in R, so Minkowski’s idea was to embed K into R2.) The most naive way to do this is to regard an element a + b √d ∈ K as the element (a, b √d) in R2. In other words, we are separating out the rational and irrational components on the x- and y- axes of R2, just like we separate the real and imaginary components of Q(√−d) or C onto the x- and y- axes in the complex plane picture. We can unify these two cases as follows. Suppose K = Q( √d) is a real or imaginary quadratic ﬁeld, i.e., d > 1 or d < 0 and assume d squarefree. Then we can embed K in R2 by the map ϕ : K → R2 such that ϕ(a + b √d) = (a, b √ |d|) for a, b ∈ Q. In this picture OK, and thus any ideal of OK, is a lattice of R2. We will work out the part of Minkowski’s theory relevant for us in the case of quadratic ﬁelds. In the interest of time, we will just state the theorems in the general case, though the basic argument is the same. Proposition 1.6.1. Let I be an ideal of OK with Z-basis {α, β}, regarded as a lattice in R2 via the embedding ϕ : K → R2 above. Then vol(R2/I) = 1 2 |∆[α, β]|1/2. 17 In the case where K is imaginary quadratic and I = OK, we brieﬂy discussed this at the end of the section on discriminants. Proof. Let (x1, y1) = ϕ(α) and (x2, y2) = ϕ(β), so we can write α = x1 + y1√|d| √d and β = x2 + y2√|d| √d. Note ∆[α, β] = αβ − αβ. Since αβ = x1x2 + d |d| y1y2 + (x1y2 + x2y1) √d√|d| , we have |∆[α, β]|1/2 = 2|x1y2 − x2y1|. By the exercise below, this is twice the volume of the parallelogram with corners (0, 0), (x1, y1), (x2, y2) and (x1 +x2, y1 +y2), which is the standard fundamental domain of the lattice I ⊆ R2 (with respect to the basis (x1, y1), (x2, y2)). Exercise 1.16. Let u = (x1, y1) and v = (x2, y2) be linearly independent vectors in R2. Show the parallelogram with corners 0, u, v and u + v has area |x1y2 − x2y1|. Corollary 1.6.2. With the notation of the previous proposition, vol(R2/I) = 1 2 N (I)√ |∆K|. This gives a geometric interpretation of the norm of an ideal in terms of the volume of the corresponding lattice. Proof. This is immediate since N (I) = √ ∆[α,β] ∆K (Lemma 1.4.1.) Lemma 1.6.3. For any ideal I of OK, there is a nonzero α ∈ I such that |N (α)| ≤ 2 π N (I) √ |∆K|. Proof. From the previous corollary, Minkowski’s theorem implies that if X is the (open) disc of radius r centered at the origin in R2, it contains a nonzero lattice point, i.e., a nonzero α ∈ I, whenever πr2 > 2N (I) √ |∆K|. Suppose r2 > 2 π N (I) √ |∆K| + ϵ for some ϵ > 0 so there is such an α. Now if we write α = x + y√|d| √d, we see N (α) = x2 ± y2 according to whether K is imaginary quadratic or real quadratic. Now α ∈ X means x2 + y2 < r2, which of course implies |x2 − y2| < r2, so in either the imaginary or real case we have |N (α)| < r2 = 2 π N (I)√ |∆K| + ϵ. Taking ϵ → 0 gives the desired result. Recall if I, J are fractional or ordinary ideals of a ring R, we say I and J are equivalent if aI = bJ for some a, b ∈ R and write I ∼ J . Via this equivalence, the class group of R (which we technically have only deﬁned when R is the ring of integers of a number ﬁeld) is just the group of equivalence classes of fractional ideals. Lemma 1.6.4. Let I be an ideal of OK. Then I ∼ J for some ideal J with norm ≤ 2 π √ |∆K|. Proof. For some a ∈ OK, aI −1 ⊆ OK. Then I ′ = aI −1 is a ideal of OK such that II ′ = (a). Let α ∈ I ′ such that |N (α)| ≤ 2 π N (I ′) √|∆K|, whose existence is guaranteed by the previous lemma. Clearly I ′|(α) so we can write (α) = I ′J where J is an ideal of OK. Now we are done, since J ∼ I ′−1 ∼ I and N (J ) = N (I ′)/N ((α)) ≤ 2 π √|∆K|. The point is that this lemma allows us to bound, and subsequently determine, the class number in any explicit case, as well as use this to show it is ﬁnite in general. Let’s ﬁrst start of with our canonical example. Recall from Section 1.3, for K = Q( √d) with d ̸= 1 squarefree, the discriminant ∆K = d if d ≡ 1 mod 4 and ∆K = 4d if d ≡ 2, 3 mod 4. 18 Example 1.6.5. The class number of K = Q( √−5) is 2, and a set of representatives for the class group is { OK, (2, 1 + √ −5) }. Proof. By the lemma, every ideal of OK is equivalent to one of norm ≤ 2 π √20 ≈ 2.85. There is only one ideal of norm 1 (think back to the deﬁnition of the norm of an ideal), OK. Suppose p is an ideal of norm 2. By Lemma 1.6.3 there is an nonzero α ∈ p with norm at most 5. However p|α implies N (p)|N (α) means N (α) is even, i.e., N (α) = 2 or 4. But there are no elements of norm 2 (it is not of the form x2 + 5y2 = N (x + y√−5)), so we must have α is of norm 4, i.e., α = ±2. This means p|(2), but the prime ideal factorization of (2) in OK is (2) = (2, 1 + √−5)2 either from last semester or the exercise below. Hence (2, 1 + √ −5) is the only ideal of norm 2, and it is not principal. A more elementary proof of the above fact is in the Chapter 12 notes from last semester, based oﬀ of what was in Stillwell. It still uses the lattice picture of ideals, but does not require Minkowski’s theorem. In fact, a general proof of ﬁniteness of the class group which avoids Minkowski’s theorem is in [Lang]. Exercise 1.17. Consider the ideal p = (2, 1 + √−5) in Z[√−5]. We proved several things about this ideal last semester, but using norms we can give more elegant arguments. In any case, this exercise, and the following ones, should be a good review for you. (i) Show p|(2) but p ̸= (2). Using norms, conclude N (p) = 2. (ii) From (i) conclude p is non-principal and prime. (iii) Show the prime factorization of (2) is (2) = p2. Exercise 1.18. Consider the ideals q = (3, 1 + √−5) and q = (3, 1 − √−5) in Z[ √−5]. (i) Show N (q) = N (q) = 3. (ii) Show q, q are non-principal and prime. (iii) Show the prime factorization of (3) is (3) = qq. Exercise 1.19. From the previous two exercises, determine the prime ideal factorization of (6) in Z[ √−5]. Explain how the non-unique factorization of elements 6 = 2 · 3 = (1 + √ −5)(1 − √ −5) in Z[ √−5] is resolved in terms of the prime ideal factorization of the ideal (6). Exercise 1.20. Let K = Q(√−5). By the above exercises, together with the fact that hK = 2, p ∼ q in the notation above. Show this explicitly by ﬁnding nonzero α, β ∈ OK such that αp = βq. Exercise 1.21. Using Lemma 1.6.4, show Q(√ d) has class number 1 for d = −1, −2, −3, −7, 2, 3, 5. These are all the cases where Lemma 1.6.4 immediately gives class number 1, but there are other cases. Exercise 1.22. Show Q(√−11) has class number 1. The only other imaginary quadratic ﬁelds with class number 1, i.e., with unique factorization in their ring of integers, are Q(√−d) with d = 19, 43, 67, 163 (making for a total of 9 such ﬁelds). It is not diﬃcult to see that these ﬁelds all have class number 1—it is much harder to show that they are the only ones. This is Gauss’s class number conjecture, and we will say a little more about this later. For now we will just say it was proven in 1934 by Heilbronn and Linfoot that there are only ﬁnitely many such imaginary quadratic ﬁelds, and eventually proved that there were no others by Heegner and Stark in the 50’s and 60’s. 19 Contrast this with the real quadratic case where it is conjectured that there are inﬁnitely many instances of class number 1 (in fact, it is thought that about 75% should be). Tables of class numbers for small real and imaginary quadratic ﬁelds are given below. Exercise 1.23. Show Q(√−6) has class number 2. Now we want to show the ﬁniteness of the class number for a general quadratic ﬁeld. We need to know one more small fact about ideals ﬁrst. Lemma 1.6.6. Let K be a quadratic ﬁeld and n ∈ N. There are only ﬁnitely many ideals I of OK such that N (I) = n. Proof. Regarding OK as a lattice in R2 as above, the ideals of norm n correspond to the lattices of R2 contained in OK (i.e., sublattices of OK) of (co)volume n 2 √|∆K| by Corollary 1.6.2. It is geometrically clear that there are only ﬁnitely many such (sub)lattices. We will see another proof later when we study the behavior of primes in extensions. In particular we will show that if N (I) = n, then I|(n). But there are only ﬁnitely many ideals dividing (n) by the uniqueness of prime ideal factorization. Theorem 1.6.7. Let K be a quadratic ﬁeld. Then hK < ∞, i.e., ClK is a ﬁnite abelian group. Proof. By Lemma 1.6.4, there is some n such that any equivalence class of ideals has a representative with norm ≤ n. Now by the previous lemma, there are only ﬁnitely many ideals with norm ≤ n. 1.7 The geometry of numbers: the general case Now suppose K is a number ﬁeld of degree n. In order to look at OK “geometrically”, i.e., as a lattice, we need a way to embed K into Rn. Of course if α1, . . . , αn is a basis for K (as a Q-vector space), we could send ∑ ciαi to (c1, . . . , cn) ∈ Rn, but there are two issues: (i) this is not at all canonical since it is highly dependent on the choice of basis, and (ii) there is no way with such an arbitrary embedding to relate vol(Rn/I) with the discriminant/norm of an ideal I of OK in order to get an analogue of Proposition 1.6.1 and its corollary. In fact, if we look over the proof of Lemma 1.6.3, we see the key is that |N (α)| is ≤ the square of the distance from α to the origin in R2, with equality in the imaginary quadratic case. However, in some sense, the embedding we used in the real quadratic case, while perhaps the most obvious choice, was not natural in that it came from the “standard” basis 1, √ d of K = Q( √d). One might then ask if there is a more “natural” embedding of a real quadratic ﬁeld K = Q( √d) ,→ R2. There is, and the idea is to use the Galois group. Let σ1, σ2 be the embeddings of K ,→ R (all embeddings are real) given by σ1(a + b √d) = a + b √d and σ2(a + b √d) = a − b √d. Consider the embedding K ,→ R2 given by α 7→ (σ1(α), σ2(α)). This is “natural” since it does not depend upon a choice of basis for K over Q, and the norm satisﬁes the desired geometric bound: if α = a+b √d 7→ (x, y), then x = a+b √d, y = a−b √d, so x2+y2 = 2(a2+db2) ≥ 2|a2−db2| = 2N (α). (Our naive embedding of a real quadratic ﬁeld into R2 was of course perfectly ﬁne for our goal in the previous section, but the problem was it is not so helpful in suggesting an appropriate generalization to arbitrary number ﬁelds. In fact, our naive embedding gives a better bound than the “natural” one given by the Galois group stated below.) The standard presentation of the geometry of numbers is as follows. Let K be a number ﬁeld of degree n. Then there are n embeddings of K ,→ C, say σ1, . . . , σn. Assume the ﬁrst s are 20 Table 1: Class numbers of small imaginary quadratic ﬁelds K = Q( √d) d hK -1 1 -2 1 -3 1 -5 2 -6 2 -7 1 -10 2 -11 1 -13 2 -14 4 -15 2 -17 4 -19 1 -21 4 -22 2 -23 3 -26 6 -29 6 -30 4 -31 3 -33 4 -34 4 -35 2 -37 2 -38 6 -39 4 -41 8 -42 4 -43 1 -46 4 -47 5 -51 2 21 Table 2: Class numbers of small real quadratic ﬁelds K = Q( √d) d hK 2 1 3 1 5 1 6 1 7 1 10 2 11 1 13 1 14 1 15 1 17 1 19 1 21 1 22 1 23 1 26 2 29 1 30 2 31 1 33 1 34 2 35 2 37 1 38 1 39 2 41 1 42 2 43 1 46 1 47 1 51 2 22 real embeddings, i.e., σ1, . . . , σs actually embed K in R, and that the remaining σi’s are complex embeddings, i.e., they do not map into R. If σi is a complex embedding, then σi also is, where σi(α) = σi(α) and the bar denotes usual complex conjugation. In particular, there are an even number 2t of complex embeddings, which occur in complex conjugate pairs. Let us denote them τ1, τ 1, . . . , τt, τ t. Now we deﬁne the embedding ϕ : K → Rs × Ct ≃ Rs+2t = Rn by ϕ(α) = (σ1(α), . . . , σs(α), τ1(α), . . . , τt(α)). This is natural, in that it does not depend upon a basis for K. It does technically depend on the ordering of the embeddings σi and τi, as well as a choice among each conjugate pair of complex embeddings τi and τ i, but not in any signiﬁcant way. Example 1.7.1. If K = Q(√d) is a real quadratic ﬁeld, then s = 2 and t = 0, and ϕ(α) = (σ1(α), σ2(α)) is the embedding described above. If K = Q( √−d) is an imaginary quadratic ﬁeld, then s = 0 and t = 1, and Gal(K/Q) = {τ1, τ 1} where τ1 : K ,→ C is the trivial embedding. Then also ϕ(α) = τ1(α) = α is the standard embedding into C ≃ R2. If we had chosen τ1 to be complex conjugation, then τ 1 would be the identity map on K and we would have that ϕ(α) = α is the conjugate embedding into C ≃ R2. Thus this embedding generalizes both what we did in the imaginary quadratic case (which was basically nothing, just the standard identiﬁcation of C with R2) as well as our second approach to the real quadratic case. Example 1.7.2. Let K = Q( 3√ 2). Then Gal(K/Q) = {σ1, τ1, τ 1} where σ1 is the trivial auto- morphism of K, τ1 maps 3√2 to ζ3 3√2 and τ2 maps 3√2 to ζ 2 3 3√2. Thus ϕ : K ,→ R × C ≃ R3 by ϕ(a + b 3√2 + c 3√4) = (a + b 3√2 + c 3√4, a + bζ3 3√2 + cζ 2 3 3√4). Exercise 1.24. Let K = Q( 4√2). Write down explicitly the map ϕ in this case. Compute ϕ(3), ϕ(3 + 4√2) and ϕ(1 + 3√2 + 4√2). Exercise 1.25. Let K = Q( √−5, √5). Write down explicitly the map ϕ in this case. Compute ϕ(1 + √5), ϕ(1 + √−5) and ϕ(2i). With the embedding ϕ given above, OK is a lattice in Rn, and as in the quadratic case we did earlier, one can prove the following. Proposition 1.7.3. Let I be an ideal of OK with basis α1, . . . , αn, regarded as a lattice in Rn via the embedding ϕ. Then vol(Rn/I) = 2−t∆[α1, . . . , αn] = 2−tN (I) √ |∆K|. Here t is the number of complex embeddings of K ,→ C as above. This proposition gives a geometric interpretation of discriminants for general number ﬁelds. Lemma 1.7.4. Let I be an ideal of OK. Then I is equivalent to an ideal of OK with norm ≤ ( 2 π )t √ |∆K|. Note that in the case of real quadratic ﬁelds, this gives a weaker bound that what we got in the last section because there will be no factor of 2 π here. It’s possible to improve the bound in the lemma by being more careful. Precisely one can show 23 Lemma 1.7.5. (Minkowski’s bound) Let I be an ideal of OK. Then I is equivalent to an ideal of OK with norm ≤ ( 4 π )t n! nn √ |∆K|. This is better than the simple bound we gave in the previous section in real quadratic case, and the same as our previous bound in the imaginary quadratic case. The better bound in the real case is in line with the notion that the class numbers for real quadratic ﬁelds tend to be smaller than those for imaginary quadratic ﬁelds, though it provides no real explanation. In any case, we will not be concerned overly much with optimal bounds. For us, the main point is Theorem 1.7.6. Let K be a number ﬁeld. Then hK < ∞. The proof for the general case is the same as the quadratic case (Theorem 1.6.7), admitting one of the bounds in the previous lemmas. Complete proofs of these results should be available in any Algebraic Number Theory text. 1.8 Interlude: Dirichlet’s Units Theorem There are several applications of Minkowski’s geometry of numbers to classical problems. Apart from the applications to class groups and quadratic forms discussed above, other applications are to bounding the number of lattice points enclosed by a polygon and bounding the number of balls that can ﬁt in a given region (i.e., sphere packing bounds—a remarkable result around 15 years ago was the resolution of Kepler’s conjecture on the optimal way to pack spheres in space). In algebraic number theory, there is another major application of the geometry of numbers, and that is to prove Dirichlet’s Units Theorem. Since we will not have need of this theorem, we will not prove it in the interest of time, but it is such a fundamental result about number ﬁelds we would be remiss not to mention it. Theorem 1.8.1. (Dirichlet’s Units Theorem) Let s be the number of real embeddings and 2t be the number of complex embeddings of a number ﬁeld K. Then the group of units U of OK is isomorphic (as an abelian group) to Zs+t−1 × C2m for some m ∈ N. The basic idea of the proof is to embed K in Rs+2t. Since the units are multiplicative, applying logarithms coordinate-wise makes an additive subgroup of Rs+2t, i.e., an incomplete lattice, which one shows is of rank s + t − 1. We note that the determination of the ﬁnite cyclic group C2m appearing in the theorem is simple to determine for any given K. It is simply given by the roots of unity which are contained in K, as any unit of ﬁnite order must be a root of unity, and all roots of unity are algebraic integers. 1.9 Debrieﬁng Dedekind introduced ideal theory to resolve the failure of unique factorization in OK for arbitrary number ﬁelds K. The ﬁrst suggestion that this is a good theory to look at is that it provides a clear characterization of when OK does have unique factorization—namely, if and only if OK is a PID, which is if and only if hK = 1. (We stated this before the prime ideal factorization theorem last semester, even though we didn’t prove the only if direction until this chapter.) The prime ideal factorization theorem tells us it in fact is an excellent theory to look at, and we saw how it resolved the non-unique factorization of 6 = 2 · 3 = (1 + √ −5)(1 − √−5) in Z[ √−5]. Historically, it was the 3rd approach to resolve these non-unique factorizations, coming after Gauss’s theory of quadratic 24 forms (for quadratic ﬁelds) and Kummer’s theory of “ideal numbers.” These ideas are still very interesting, and we will discuss them in Part II. We began this chapter by generalizing some ideas such as conjugates and norms from quadratic ﬁelds to arbitrary number ﬁelds using Galois groups. As you may be aware from algebra, in many cases the Galois group of an extension can be somewhat diﬃcult to compute, but simple non- quadratic examples are still fairly easy to compute, as we have seen with examples. The point is the Galois group of a degree n extension is a transitive subgroup of Sn acting on the n roots of the minimal polynomial of a primitive element. When n = 2, there is only one transitive subgroup of S2 ≃ C2, and the extension is necessarily Galois. Here it is immediate what the Galois group is. However for n > 2, there is more than one transitive subgroup of Sn (e.g., Sn, An, Cn), and one need to do some work to determine what is is. Further, sometimes the primitive element is obvious, but sometimes it is not, e.g., what is a primitive element for Q( √2, √3)? (You can show √2 + √3 works by a degree argument and the characterization of quadratic ﬁelds, but that this can get complicated rather quickly. Even knowing this, how do you determine the minimum polynomial—what is the minimum polynomial of √2 + √3?) In general, one probably wants to use the main theorem of Galois theory (which I won’t review) to use the subﬁeld lattice to help determine the Galois group. However, the examples we will cover will be simple enough that we don’t need to use the full force of Galois theory to determine the Galois group. Knowing the Galois group of K over Q it is easy to determine the conjugates and norm of an element in K. What is not so simple is determining the ring OK. There is an algorithm for doing this using discriminants, though it turns out to be fairly computational even for simple examples like Q(√2, √3). However, our main reason for looking at discriminants is that they provide a fundamental invariant of a number ﬁeld K and its ideals (i.e., the ideals of OK). For K an imaginary quadratic ﬁeld, the discriminant of OK or an ideal I of OK is essentially the volume of the corresponding lattice, as well as essentially the norm of the ideal squared. (We only deﬁned the discriminant of a basis of an ideal, but by the formula in terms of the norm, this is clearly independent of the choice of basis.) Then with Minkowski’s theorem, we were able to bound the norm of “minimal” representatives of the class group in terms of the discriminant, providing a proof of the ﬁniteness of the class group ClK, as well as allowing us to explicitly determine the class group in particular cases. On the other hand, for real quadratic ﬁelds K ⊆ R, OK is not a lattice, but we have seen at least two ways to embed K in R2 which makes OK a lattice—the naive way, and the approach via Galois conjugates. The second approach generalizes for an arbitrary number ﬁeld K of degree n, allowing us to view OK as a lattice in Rn. As before the norm and discriminant of the ideal are essentially the (co)volume of the lattice OK, and Minkowski’s theorem allows us to show the class group is ﬁnite, and bound norms of a set of minimal representatives of the class group. Stillwell talked about the shape of ideals in imaginary quadratic ﬁelds. Two lattices (ideals) in C ≃ R2 will have the same shape if and only if they diﬀer by a complex scalar (principal ideal). Hence two ideals will have the same shape if and only if they are equivalent. Thus the class number is the number of diﬀerent possible shapes of ideals. Similarly, via the geometry of numbers developed by Minkowski, if two ideals are equivalent, they will have they same shape, regarded as lattices in Rn. The goal of this chapter was to show ﬁniteness of the class group (at least a complete proof in the quadratic case, and the general case is similar in spirit), and show in some speciﬁc cases how we can determine the class number and class group. There are two reasons for this: (i) to understand 25 factorization in OK, which is a basic problem in algebraic number theory, and (ii) applications to Diophantine equations. First oﬀ, the class group of K measures the failure of unique factorization in OK. The larger it is the more diﬀerent the set of irreducible factorizations of some algebraic integer α ∈ OK can be. For example, K has class number 2 if and only if every element of OK does not have unique factorization but any factorization into irreducibles has the same number of factors. We will come back to this idea in Part II. Now what is the bearing of the class group on solving Diophantine equations? Well, ﬁrst of all, the simplest case is when OK has unique factorization, i..e, class number 1. We have shown the rings of integers of the ﬁelds Q( √d) for d = −1, −2, −3, −7, −11, 2, 3, 5 all have unique factorization. Following the approach last semester, this makes it easy to determine which primes are of the form x2 + dy2 for d = 1, 2, 3, 7. In particular, we used unique factorization in Z[ √−2] to show y3 = x2 + 2 has only one solution (5, 3) in N, and unique factorization in Z[ζ3] to show x3 + y3 = z3 has no solutions in N. Lamé gave an argument that xp + yp = zp has no solutions in n for p and odd prime whenever Z[ζp] has unique factorization. Even when Z[ √−d] does not have unique factorization, we can still use knowledge of the class group to determine the primes of the form x2 + dy2. Speciﬁcally, we used the fact that Z[ √−5] has class number 2 to determine the primes of the form x2 + 5y2 at the end of last semester. (Refer to last semester’s Chapter 12 notes, or wait till we review this next chapter.) In order to approach this problem for general d > 0 squarefree, observe p = x2 + dy2 = (x + y√−d)(x − y√−d), which means the prime p splits into prime ideals (p) = (x + y√−d)(x − y√−d) in the ring Z[ √−d]. This is a particular case of the general question, given an extension of number ﬁelds L/K and a prime ideal p of OK, how do we determine how it behaves in L, i.e., what is the prime ideal factorization of pOL in OL? This is another basic question of Algebraic Number Theory, and in particular when K = Q, it will tell us what is the prime ideal factorization of (n) in OL. Hence, this is important for studying general Diophantine equations also, and this question will be the focus of the next chapter. In the following chapter, we will brieﬂy talk about cyclotomic ﬁelds K = Q(ζp) where ζp is a primitive p-th root of unity and p is an odd prime. This is the next most important and basic type of number ﬁeld after the quadratic ﬁelds. This will (i) give us a better understanding of the concepts discussed in this chapter for non-quadratic ﬁelds, and (ii) provide an opportunity for more applications. The most famous application of these ﬁelds is to Kummer’s approach to Fermat’s last theorem. While a complete proof of Kummer’s result would take longer than we would like to spend on this, we will at least give a sketch of the argument using Dedekind’s ideal theory (as opposed to Kummer’s original approach via ideal numbers). Finally, a look at the class number tables in this chapter shows that even in the simple case of quadratic ﬁelds, the class numbers behave with apparently little regularity, just like prime numbers seem to behave with little regularity. Thus it might seem unlikely that one could come up with an exact formula for the class number hK. Remarkably, Dirichlet did just that, using the theory of L-functions, which itself is closely related to hidden regularities in prime numbers. This is what we will study at the end of Part I. 26 2 Primes in extensions This chapter is about the following basic question: given an extension of number ﬁelds L/K and a prime ideal p in OK, how does pOL factor into prime ideals of OL? This question is intimately tied up with many questions of arithmetic. Going back to our motivating question of which primes p are of the form p = x2 + ny2 (n ̸= 1 squarefree), we will see that these are essentialy the p for which (p) is a product of two principal ideals in Q(√ −n). After addressing this general question about splitting of prime ideals, we will apply this to primes of the form x2 + ny2. Afterwards, we may do some more stuﬀ, but then again maybe we won’t. Note: we will sometimes talk about “ideals” of K or L, or “primes” of K or L. This is merely a simpliﬁcation of terminology and simply means (ordinary) ideals of OK or OL, or prime ideals of OK or OL. Another piece of notation to be careful of: if α ∈ OK, then (α) may represent αOK or αOL depending upon whether we are talking about ideals of K or ideals of L. This should hopefully be clear from context in most cases. If not, we will explicitly write αOK or αOL. The presentation of this material in this chapter is, for the most part, based on [Marcus] and, to a lesser extent, [Cohn] (for the quadratic case) and [Neukirch]. 2.1 Splitting of primes Throughout L/K denotes an extension of number ﬁelds. Before we give the basic deﬁnitions, let’s recall what happens in the simplest example, which we studied last semester. Example 2.1.1. Let K = Q and L = Q(i). Since OK = Z is a PID, any prime ideal of OK is of the form (p) where p is a prime of Z. If p = x2 + y2 = NL/K(x + yi), then p = αβ for some α, β ∈ OL and (p) = (α)(β) in OL, i.e., (p) is a product of two principal ideals in OL. Furthermore p1 = (α) and p2 = (β) are both prime since they have norm p. The ideals p1 and p2 are distinct except in the case p = 2 = (1 + i)(1 − i) since 1 + i = −i(1 − i), i.e., 1 + i and 1 − i diﬀer by units. If p is not a sum of two squares, then this means there is no element of norm p in OL, so p is irreducible in OL. Hence if some prime ideal p of OL divides (p) but p ̸= (p), then it can’t be principal (otherwise, the generator of p would divide p). However hL = 1 so OL is a PID. Thus (p) = pOL = {pα : α ∈ OL} is itself a prime ideal. Hence in this example, there are 3 possibilities for what happens to a prime ideal pOK of K in the extension L: (1) it splits as a product of two distinct prime ideals (p) = p1p2 in OL iﬀ ±p = x2 + y2 and p ̸= 2, i.e., iﬀ p ≡ 1 mod 4; (2) it ramiﬁes as the square of a prime ideal (p) = 2OL = (1 + i)2 = p2 in OL iﬀ ±p = 2; and (3) it remains prime or is inert, i.e., pOL is a prime ideal of OL, if and only if ±p ̸= x2 + y2, i.e., iﬀ p ≡ 3 mod 4. If a is an ideal of OK, we deﬁne aOL = {a1x1 + a2x2 + · · · + akxk : ai ∈ a, xi ∈ OL} . Notice this is just like the deﬁnition of the product of two ideals of the same ring. It is easy to see that this is the smallest ideal of OL which contains the set a (see exercise below). Note if a = (a) is a principal ideal of OK, then aOL = (a) = {ax : x ∈ OL}. 27 Exercise 2.1. Let a be an ideal of OK and A be an ideal of OL. Show aOL is an ideal of OL and A ∩ K = A ∩ OK (justify this equality) is an ideal of OK. We call aOL the extension of a to L and A ∩ OK the restriction of A to K. It is tradition to use gothic lower case letters for ideals of OK and upper case gothic letters for ideals of OL. (Though I suppose it’s also tradition to write OK as OK, I’m not as fond of that one.) However if K = Q, we just use integers for the ideals of OK = Z since they are all principal, and lower case gothic letters for ideals of the extension L, as in the example above. If you have trouble writing gothic letters by hand, you can just write the corresponding roman letter with an underscore, or use another script. While the extension and restriction of ideals are deﬁned uniquely, this is not a 1-to-1 correspon- dence, as there are more ideals of OL than ideals of OK. Precisely, we will see that diﬀerent ideals of OK extend to diﬀerent ideals of OL, but diﬀerent ideals of OL can restrict to the same ideal of OK. Deﬁnition 2.1.2. Let p be a prime ideal of OK and P be a prime ideal of OL. We say P lies over (or lies above) p in L/K if P|pOL. We sometimes write this as P|p. Going back to the previous example, in case (1) p1 and p2 lie above (p); in case (2) p lies above (p) and in case (3) (p) = pOL lies above (p) = pOK. Let p be a prime (ideal) of OK and P be a prime (ideal) of OL. Lemma 2.1.3. The following are equivalent: (a) P|p, i.e., P|pOL (b) P ⊇ p (c) P ∩ OK = P ∩ K = p. Proof. (a) ⇒ (b) since P ⊇ pOL ⊇ p. To see (b) ⇒ (c), observe that P ⊇ p implies P ∩ OK ⊇ p. Since p is maximal, and P ∩ OK is an ideal by the exercise above, we have P ∩ OK is either p or OK. The latter is impossible since it would imply 1 ∈ P. To see (c) ⇒ (b) ⇒ (a), note that (c) implies P ⊇ p is obvious, and then P ⊇ pOL since P is an ideal of OL. In light of the equivalence (a) ⇐⇒ (b), the notation P|p for one ideal lying over another agrees with the usage of the notation I|J to mean divides (contains) for ideals of OK. Another thing this lemma shows is that two diﬀerent ideals of L can restrict to the same ideal of K. For example if p is a prime of K = Q, and pOL = p1p2 with p1 ̸= p2, then p1 and p2 both restrict to the ideal pZ of Z. More generally, all primes P of OL lying above a prime p of OK restrict to p. Proposition 2.1.4. Every prime P of OL lies above a unique prime p of K. Conversely, every prime p of K is contained in some prime P of OL, i.e., there is some prime P of OL such that P|p. Proof. Suppose P ∩ OK|ab for some ideals a, b of OK. Then P ⊇ (aOL)(bOL) so P ⊃ aOL or P ⊃ bOL since P is prime. Restricting to K, we see P ∩ OK|a or P ∩ OK|b. Hence P ∩ OK is a prime ideal p of OK by deﬁnition, i.e., P|p. By the previous lemma, P|p implies P ∩ OK = p, hence 28 p is unique. This proves the ﬁrst statement, though technically one should also show P ∩ OK ̸= {0}. This is easy—see the exercise below. The second statement is seemingly obvious: given p, the extension pOL has a prime ideal factorization in OL, so any prime ideal P occurring in the factorization lies above p. However as before, one needs to show a seemingly obvious technicality: pOL ̸= OL (otherwise pOL would not have a prime ideal factorization). This is also an exercise. Exercise 2.2. Let L/K be an extension of number ﬁelds and I be a (nonzero) ideal of OL. Show I ∩ OK ̸= {0}. (You may want to consider using norms.) Exercise 2.3. (a) Let a be a proper ideal of OK. Show there exists a γ ∈ K − OK such that γa ⊆ OK. (b) Let L/K be an extension of number ﬁelds and p a prime ideal of OK. Show pOL ̸= OL. (Use (a) to get a contradiction if pOL = OL.) Exercise 2.4. (a) Let a, b be ideals of K. Show aOL|bOL =⇒ a|b. (Think about prime factoriza- tions in K and L.) (b) Show aOL ∩ OK = a for any ideal a of OK, i.e., the restriction of an extension gives the ideal you started with. (Use (a) with b = aOL ∩ OK.) (c) Determine which ideals A of L satisfy (A ∩ OK)OL = A, i.e., determine when the extension of the restriction of an ideal is the ideal you started with. Looking back at the case of K = Q and L = Q(i) from Example 2.1.1, we see sometimes the number of primes lying above p is 1 and sometimes it is 2. In general, the number of primes above p is never greater than n = [L : K], and if we count with primes with “multiplicty” and “weight” it will always be n. Multiplicity is easy to imagine: if [L : K] = 2 and p = P2 then it makes sense to count P two times—technically this multiplicity is called the ramiﬁcation index (or ramiﬁcation degree). There is only one prime that is ramiﬁed in the extension Q(i)/Q, namely 2Z[i] = (1 + i)2. The notion of some primes being “weighted” is a little more subtle, but it can obviously happen that p = P, i.e., a prime p of K remains prime (or is inert) in L, i.e., pOL = P is prime in L. If we go back to Example 2.1.1, half of the primes in Q are inert in Q(i), the ones ≡ 3 mod 4, i.e., the primes not sums of 2 squares. One way to diﬀerentiate the case of inert and “split” primes in this example is the following. For split primes (p ≡ 1 mod 4), we have pOL = pOL = P1P2, then [OL : Pi] = N (Pi) = p (this also holds for the ramiﬁed case of p = 2), but for inert primes (p ≡ 1 mod 3), then P = pOL = pOL is prime in L and we have [OL : P] = N (P) = NL/K(p) = p2. Hence, if we think of the exponent of p in N (P) = [OL : P] as the “weight” of P, then we can say the weighted sum of the primes above p (with multiplicity) is always 2, at least in Example 2.1.1. In general, when the base ﬁeld K ̸= Q, this deﬁnition of weight needs to be appropriately modiﬁed, and we give the formal deﬁnitions of the appropriate multiplicity (ramiﬁcation index) and weight (inertial degree) below. Exercise 2.5. Suppose P ∩ OK = p. Show the ring embedding OK ,→ OL yields a ﬁeld embedding OK/p ,→ OL/P. In other words, the ﬁnite ﬁeld OL/P is an extension of OK/p. Deﬁnition 2.1.5. Let p be a prime of K. Suppose the prime ideal factorization of pOL is p = ∏ Pei i where each Pi is distinct. The ramiﬁcation index of Pi over p is e(Pi|p) = ei and the inertial degree of Pi over p is f (Pi|p) = fi = [OL/Pi : OK/p]. 29 This deﬁnition of inertial degree is really the natural generalization of the “weight” of P we suggested in the case of Q(i)/Q (see also lemma below). The previous exercise guarantees it makes sense. For instance, if K = Q, then and P = pOL is prime in L, then f (P|(p)) = [OL/pOL : Z/pZ]. Now OL/pOL must be the ﬁnite ﬁeld of order N (pOL) = NL/Q(p) = pn where n = [L : K], which has degree n over Z/pZ, so the inertial degree is f (P|(p)) = n. The above deﬁnition of inertial degree, is the standard one, but it is clearly equivalent to the following form, which will be useful to us. Lemma 2.1.6. The inertial degree fi = f (Pi|p) satisﬁes N (Pi) = N (p)fi. Proof. We know OK/p is a ﬁnite ﬁeld of some order, say q = N (p). By the exercise above OL/P is an extension of OK/p, and the order of this extension ﬁeld is qfi = N (Pi) by the deﬁnition of the inertial degree. Hence N (p)fi = N (P). Theorem 2.1.7. (The fundamental identity) With the notation in the deﬁnition, ∑ eifi = n = [L : K]. For simplicity, we will omit some details of the proof when K ̸= Q. Proof. Note N (pOL) = ∏ N (Pi)ei = ∏ N (p) eifi, by the previous lemma. Then the theorem follows from the statement that N (pOL) = N (p)n. This is true but not entirely obvious—one must check some details. However in our main case of interest, which is K = Q, it is particularly simple, and in the interest of time and simplicity we will restrict to when K = Q. Then p = (p) for some p ∈ N and N (pOL) = N (pOL) = NL/K(p) = pn. Hence if pOL = ∏ P ei i (with each Pi distinct), the number of Pi lying above p is at most n = [L : K], and is exactly n if we count multiplicities ei’s and “weights” fi’s. Now let’s give a couple names for diﬀerent ways in which p (i.e., pOL) can factor in OL. Deﬁnition 2.1.8. Write pOL = ∏g i=1 Pei i (with each Pi distinct). If ei > 1 for some i, we say p ramiﬁes in L. Otherwise, we say p is unramiﬁed in L. If g > 1, i.e. there is more than one prime of L above p, then we say p is split in L. If g = 1, i.e. there is only one prime of L above p, we say p is nonsplit in L. If g = n, i.e. pOL = P1P2 · · · Pn, then we say p is totally split (or splits completely) in L. If g = 1 and e1 = 1, i.e. if pOL = P1, then we say p is inert (or remains prime) in L. Note by the fundamental identity, if p is totally split in L, then ei = fi = 1 for each i. Similarly if p is inert in L then f (P|p) = n where P = pOL. In particular if p is totally split or inert in L, then it is unramiﬁed. We will see shortly that ramiﬁcation is a special phenomenon which only happens for ﬁnitely many primes. We now give a couple of simple consequences of the lemma and fundamental identity. Corollary 2.1.9. Let p be a prime ideal of K which lies above a prime p ∈ N. Then N (p) = pk for some 1 ≤ k ≤ [K : Q]. Proof. It follows from the lemma above (or the argument before with the base ﬁeld being Q), that N (p) = pf (p|(p)). We know k = f (p|(p)) ≤ n by the fundamental identity. 30 Knowing this is useful in determining whether an ideal is prime or not, and in determining how a prime of Q splits in K. A consequence of this (without requiring the bound on k) is the fact that an ideal of K divides (the ideal generated by) its norm. Recall we mentioned this result can be used to prove that the class number of K is ﬁnite (see Lemma 1.6.6. Corollary 2.1.10. Let I be an ideal of K and m = N (I). Then I|mOK. Proof. Write I = ∏ pi where the pi’s are (not necessarily distinct) prime ideals of K. Then m = N (I) = ∏ N (pi). By the previous corollary, we can write N (pi) = pfi i for some fi where pi|pi. In particular pi ⊇ piOK ⊇ pfi i OK. Hence I = ∏ pi ⊇ ∏ p fi i OK = mOK. Now one might ask if all primes of L above p have the same ramiﬁcation index and inertial degree. This is not true in general, but it is true if we pass to the Galois closure of L. Precisely, we have the following. Theorem 2.1.11. Suppose L/K is Galois and write p = P e1 1 · · · Peg g where the Pi’s are distinct prime ideals of L. Then Gal(L/K) acts transitively on P1, . . . , Pg. In particular e1 = e2 = · · · = eg and f1 = f2 = · · · = fg. In this case, if we set e = e1 and f = f1, we have pOL = Pe 1P e 2 · · · Pe g and the fundamental identity becomes n = ef g. Proof. Let σ ∈ Gal(L/K) and P|p. Since L/K is Galois, σ(P) ⊆ OL. It follows immediately from the deﬁnitions that σ(P) is an ideal of OL and σ(P) is prime. Note if x ∈ p, then σ(x) = x since x ∈ OL. Thus P ⊇ p implies σ(P) ⊇ p, i.e., σ(P)|p. This implies Gal(L/K) acts on P1, . . . , Pg. Now we want to show this action is transitive. Suppose it is not, i.e., suppose P, P′|p but P′ ̸= σ(P) for any σ ∈ Gal(L/K). By the Chinese Remainder Theorem (for general rings) there is an x ∈ OL such that x ≡ 0 mod P ′, x ≡ 1 mod σ(P) for all σ ∈ Gal(L/K). Now y = NL/K(x) = ∏ σ(x) ∈ P′ ∩ OK = p. On the other hand P ∤ (y) = ∏(σ(x)) since no σ(x) ∈ P. But this means y ̸∈ p = P ∩ OK, a contradiction. This shows Gal(L/K) acts transitively on P1, . . . , Pg. On the other hand, Gal(L/K) ﬁxes pOL = Pe1 1 Pe2 2 · · · P eg g , so all the ramiﬁcation indices ei are the same by uniqueness of prime ideal factorization. Also, because P1, . . . , Pg are Galois conjugates of each other, they all have the same norm. Hence the all the inertial degrees fi are the same. The restatement of the fundamental identity is immediate. When L/K is Galois, we say the ideals σ(P) are conjugates of P. We remark that just like one can deﬁne the norm of elements from L to K, one can deﬁne the norm of ideals from L to K. Precisely, if A is an ideal of L, then the norm from L to K of A is NL/K(A) = ∏ σ∈Gal(L/K) σ(A) ∩ OK. 31 Of course, this norm is an ideal, not a number, but remember that ideals are a sort of generalization of numbers. One can show this satisﬁes various nice properties, and thus it can be useful like the usual norm is useful. Exercise 2.6. Suppose L/K is Galois. (a) Suppose P is a prime of L lying above p, a prime of K. Let f = f (P|p). Show NL/K(P) = pf . (b) Show NL/K(AB) = NL/K(A)NL/K(B) for any ideals A, B of OL. (c) Let A be an ideal of L with norm n = N (A) = |OL/A|. Show NL/Q(A) = (n). In other words, the notion of an “ideal-valued norm” from L to K agrees with the original deﬁnition of the integer-valued norm when K = Q (identifying the principal ideal (n) with the integer n). 2.2 Splitting in quadratic ﬁelds In this section, we will let K = Q( √d) be a quadratic ﬁeld. As usual we will assume d ̸= 1 is squarefree. Further p will denote a prime (element) of Z and p will denote a prime (ideal) of OK. In this case, the splitting of p (i.e., of pZ) in K is particularly simple. By the fundamental identity there are at most 2 prime ideals of K lying above p (i.e., pZ), counting multiplicity. Hence either p is inert in K, i.e., pOK is a prime ideal of OK, or pOK = p1p2 where p1 and p2 are prime ideals of OK. When p1 = p2, p is ramiﬁed in OK, and when p1 ̸= p2, p splits in OK. Note that since K is quadratic, p splitting and p splitting completely are one and the same. Let ∆ = ∆K be the discriminant of K. Recall ∆ = d if d ≡ 1 mod 4 and ∆ = 4d if d ≡ 2, 3 mod 4. Let (a p) denote the Kronecker symbol mod p. If p is odd, (a p) is the ordinary Legendre symbol deﬁne for any a ∈ Z, i.e., (a p) = 1 when gcd(a, p) = 1 and a is a square mod p, (a p) = −1 when gcd(a, p) = 1 and a is a nonsquare mod p, and (a p) = 0 when p|a. If p = 2, we set ( a 2 ) =  |||| |||| 0 4|a 1 a ≡ 1 mod 8 −1 a ≡ 5 mod 8 undeﬁned a ̸≡ 0, 1 mod 4. This is an extension of the Legendre symbol where we have allowed p = 2 on the bottom, and p|a for p odd. Note the deﬁnition for p = 2 satisﬁes (a 2 ) = (2 a ) whenever a ≡ 0, 1 mod 4. Since the squares mod 8 are 0, 1, 4, the Kronecker symbol mod 2 detects whether an a ≡ 0, 1, mod 4 is a square mod 8. The problem with a ̸≡ 0, 1 mod 4, is one cannot extend the Kronecker symbol to integer values for such a so that it is multiplicative in a. However, this is ﬁne for us, since we only want that (∆ p ) is deﬁned for any prime p ∈ N, which it is since ∆ ≡ 0, 1 mod 4. The utility of this deﬁnition is apparent from the following result on the splitting of p in K. Theorem 2.2.1. Let p ∈ N be prime. (i) If (∆ p ) = 0 then p is ramiﬁed in K. 32 (ii) If (∆ p ) = 1 then p is split in K. (iii) If (∆ p ) = −1 then p is inert in K. Note this say the primes with ramify in K are precisely the ones dividing ∆. In particular, there are ﬁnitely many. Proof. Let p be a prime of K lying above p. Then p is a subgroup of OK which is free of rank 2 over Z. In particular, p is generated (as an ideal) by at most 2 elements of OK. We may take one of them to be p, and write p = (p, π) for some π ∈ OK. Write π = a+b √d 2 . Further, since N (p)|NK/Q(π) we have p|NK/Q(π) = a2−db2 4 , so a2 ≡ db2 mod p (in fact, mod 4p). We ﬁrst prove the contrapositive of (iii). Suppose pOK is not inert and p is odd. Then p ̸= pOK, so p ∤ π, i.e., a and b are not both divisible by p. This implies b ̸≡ 0 mod p. Let b−1 such that b−1b ≡ 1 mod p. Then a2 ≡ db2 mod p implies (ab−1)2 ≡ d mod p, i.e., d is a square mod p so either (d p) = 1 or 0, according to whether p ∤ d or p|d. Since ∆ = d or ∆ = 4d, (d p) ̸= −1 implies (∆ p ) ̸= −1. This proves (iii). A similar argument works for p = 2. Now suppose (∆ p ) = 0 and p odd. Then (∆ p ) = (d p), so p|d. In this case, we can take p = (p, √d). To see this, observe that any element of p looks like 1 2 ((x + y√d)p + (z + w√d) √d) = 1 2 (px + dw + (z + py) √d) for some x, y, z, w ∈ Z. Since p|d, this means OK ⊋ (p, √d) = { 1 2 (px + y√d) : x, y ∈ Z } ∩ OK ⊋ pOK. Hence p = (p, √d) lies above p. Thus pOK = pp where p is the conjugate ideal of p in K, but p = (p, − √d) = p, so p is ramiﬁed in K. The case of (∆ p ) = 0 and p = 2 is an exercise below. Now assume (∆ p ) = 1 and p odd, so that (∆ p ) = (d p) = 1. Let a ∈ Z be such that a2 ≡ d mod p. Note p ∤ a since p ∤ d. We claim we can take p = (p, a + √d). Then the conjugate ideal is p = (p, a − √d). It is clear thatp, p ⊋ pOK, so it suﬃces to show p ̸= OK. To see this, observe that pp = (p2, pa + p√d, pa − p√d, a 2 − d) ⊆ pOK. Hence pOK = pp (and p, p are primes of K). It remains to show p ̸= p. If p = p, then we would have 2a = a + √d − a − √d ∈ p ∩ Z = pZ, which is impossible since p ∤ 2a. This shows p splits in K. Suppose (∆ p ) = 1 and p = 2. Then ∆ ≡ 1 mod 8. Then as in the p odd case one shows one can take p = (2, 1+ √d 2 ), p ̸= p and pp = 2OK. Exercise 2.7. Suppose (∆ 2 ) = 0. Show p = (2, π) is a proper ideal of K containing 2OK, where π = √d or 1 + √d according to whether d is even or odd. Use this to verify (i) in the above theorem for p = 2. Exercise 2.8. Let K = Q( √−5). Determine which primes of Q ramify in K and which are unramiﬁed. Then determine which primes of Q split completely in K and which are inert. 33 Note that in the course of the proof of the above theorem, we were able to explicitly describe the prime ideals of K lying above p. For convenient reference, we summarize this below. Corollary 2.2.2. If p ̸= 2 is ramiﬁed in K, then p = (p, √d) is a prime of K lying above p. (For p = 2 ramiﬁed in K, see Exercise 2.7 above.) If p ̸= 2 splits in K, then p = (p, a + √d) is a prime of K lying above p for any a such that a2 ≡ d mod p. If 2 splits in K, then d ≡ 1 mod 4 and p = (2, 1+ √d 2 ) is a prime of K lying above 2. The above theorem is very useful for many things. One application is to determining class numbers and class groups of quadratic ﬁelds. Example 2.2.3. Let K = Q( √−19). This has determinant ∆ = −19. By Lemma 1.6.4 (or Minkowski’s bound, which is the same in this case), every ideal of OK is equivalent to one of norm at most 2 π √19 ≈ 2.85. There is only ideal of norm one, namely OK, which is principal. Any ideal of norm 2 must lie above 2 (Corollary 2.1.9), but (∆ 2 ) = −1 since ∆ = −19 ≡ 5 mod 8, i.e., 2 is inert in K. Hence there is no ideal of norm 2, which means the class number hK = 1. Exercise 2.9. Show K = Q( √−15) has class number 2. Exercise 2.10. Show K = Q(√−43) has class number 1. Another application of the above theorem is to determining primes of the form x2 + ny2, which we consider next. 2.3 Primes of the form x2 + ny2 Recall that one of our motivating questions, both this semester and last semester, was to study numbers of the form x2 + ny2. Any two number of the form x2 + ny2 have a product which is also of the form x2 + ny2 by Brahmagupta’s composition law, so this question largely reduces to the question of which primes p are of the form x2 + ny2. It is clear that p = x2 + ny2 means p is reducible in the ring of integers of K = Q( √−n). For simplicity, we assume n is a square free integer, and put d = −n, so K = Q( √d) which coincides with the notation in the previous section. For the result below we will allow n to be negative, because it is no extra work (it just involves including a ± sign), though our main interest is in n > 0. We will also assume n ̸= −1, because then K = Q. So the case of n = −1 is particularly simple, as our question is: which primes are of the form p = x2 − y2 = (x − y)(x + y). But this factorization means (say for p > 0) that x − y = 1 so p = 2y + 1, i.e., all odd p > 0 are of the form x2 − y2. Interchanging x and y also shows that any odd p < 0 is of the form x2 − y2. Proposition 2.3.1. Let p be a prime of Z. If p = x2+ny2 for some x, y ∈ Z, then pOK = p1p2 where p1 and p2 are (not necessarily distinct) principal prime ideals of OK. Conversely, if pOK = p1p2 where p1 and p2 are principal prime ideals of OK, then (i) ±p is of the form x2 + ny2 if n ≡ 1, 2 mod 4; (ii) ±4p is of the form x2 + ny2 if n ≡ 3 mod 4. Proof. (⇒) As above, set d = −n to match with notation from the previous section. Suppose p = x2 + ny2 = x2 − dy2 = (x + y√d)(x − y√ d). Since p is squarefree, both x and y must be nonzero so α = x + y√d and β = x − y√−d are nonzero nonunits of OK. Thus pOK = (α)(β) 34 is the prime ideal factorization of pOK. (The ideals (α) and (β) are prime either by the argument that NK/Q(α) = NK/Q(β) = ±p or using the fundamental identity to count the prime ideals in the factorization of pOK). (⇐) Suppose pOK is a product of two principal prime ideals p1 = (α) and p2 = (β). Since the ideals (α) and (β) are conjugate, we may assume α and β are conjugate, i.e., α = x + y√d, β = x−y√d for some x, y ∈ Q. Then NK/Q(α) = NK/Q(β) = p, and the factorization pOK = (α)(β) implies p = uαβ = u(x2 − dy2) for some unit u of OK. Since x2 − dy2 ∈ Z, we must have u = ±1. If d ≡ 2, 3 mod 4, then we may assume x, y ∈ Z so we have shown (i). If d ≡ 1 mod 4, then x, y ∈ 1 2 Z and (ii) follows. Note that we can rephrase the n ≡ 1, 2 mod 4 case as follows: ±p = x2 + ny2 if and only if pOK is a product of 2 (not necessarily distinct) principal ideals in OK. When n > 0, the ± sign here is moot: negative p are never of the form x2 + ny2, but for n < 0 the distinction of whether p or −p is of the form x2 + ny2 is somewhat more subtle. Our main focus is when n > 0, so we will not worry about this now, but it can be treated via the general theory of binary quadratic forms. We will discuss binary quadratic forms in Part II, but again our focus there will be mostly on the “positive” cases. One can make a similar if and only if statement when n ≡ 3 mod 4. Exercise 2.11. Suppose n ≡ 3 mod 4. Show pOK = p1p2 for two (not necessarily distinct) prime ideals p1, p2 of OK if and only if ±4p = x2 + ny2 for some x, y ∈ Z. To see that these two cases are necessary, look at K = Q( √−11). Then p = 3 = 1+ √−11 2 1−√−11 2 so p splits in OK, but 3 ̸= x2 + 11y2 for x, y ∈ Z. Of course 12 = 4 · 3 = 12 + 11 · 12. We remark that one could treat the n ≡ 3 mod 4 and the n ≡ 1, 2 mod 4 uniformly as follows: ±p = x2 + ny2 if and only if pZ[ √−n] is a product of two proper principal ideals of Z[ √−n]. However the issue with this is that the ideals of Z[√ −n] (when n ≡ 3 mod 4) are more diﬃcult to study than OK, e.g., the prime ideal factorization theorem does not hold for Z[ √−n]. Now let’s see how we can use this to give alternative (simpler) proofs of some of our main results from last semester. New cases are contained in the exercises. Below p denotes a prime number in N and x, y ∈ Z. Corollary 2.3.2. (Fermat’s two square theorem) We can write p = x2 + y2 if and only if p = 2 or p ≡ 1 mod 4. Proof. By the proposition, p = x2 + y2 if and only if p is a product of two (not necessarily distinct) principal ideals in Q(i). (−p cannot be a sum of 2 squares so the ± in the proposition is not an issue here.) Since we know the class number of Q(i) is 1, we in fact have p = x2 + y2 if and only if p splits or ramiﬁes in Q(i). Here ∆ = ∆Q(i) = −4, so by Theorem 2.2.1, p = x2 + y2 if and only if p = 2 (the ramiﬁed case) or (∆ p ) = (−4 p ) = (−1 p ) = 1. But the ﬁrst supplementary law to quadratic reciprocity tells us (−1 p ) = 1 if and only if p ≡ 1 mod 4. Exercise 2.12. We have p = x2 + 2y2 if and only if p = 2 or p ≡ 1, 3 mod 8. We proved this in Chapter 9 last semester, but you should give a simpler argument using the above results. Then we left the case of x2 + 3y2 as an exercise in Chapter 9, which you may recall was considerably more challenging than the x2 + 2y2 case. In fact, we still haven’t made things any 35 easier on ourselves for this case since this corresponds to d ≡ 1 mod 4 above. It may be worthwhile to see what the issue is, so let’s go through this. Suppose p = x2 + 3y2. Then by the above proposition pOK is a product of two principal ideals of OK, where K = Q( √−3). In this case hK = 1, so every ideal is principal. Hence p either splits or ramiﬁes in OK which means (∆ p ) = (−3 p ) = (p 3) = 0 or 1, i.e., p = 3 or p ≡ 1 mod 3. Clearly p = 3 is of the form x2 + 3y2. It remains to show if p ≡ 1 mod 3, then p = x2 + 3y2. By this same computation of (∆ p ), if p ≡ 1 mod 3, the p splits into two (prinicipal) ideals of K. However since d = −n ≡ 1 mod 4, the above proposition only tells us that 4p = x2 + 3y2. For instance 4 · 7 = 52 + 3 · 12. It is not clear how to conclude that we must have p = (x′)2 + 3(y′)2 for some x′, y′, though it is true. Roughly, one might like to use Brahmagupta’s composition law (the product of two numbers of the form x2 + ny2 is again of this form—this is simple, but not pretty, computation) in reverse: 4 = 12 + 3 · 12 and 4p are both of the form x2 + 3y2, so their quotient p = 4p/4 should be. We will see that one can more or less do just this using Gauss’s theory of binary quadratic forms in Part II. Hence for now, we will forget about the case n ≡ 3 mod 4 (i.e., d ≡ 1 mod 4). Corollary 2.3.3. We have p = x2 + 5y2 if and only if p = 5 or p ≡ 1, 9 mod 20. Proof. Let K = Q( √−5) so ∆ = ∆K = −20. Only two primes p ramify in K, p = 2 and p = 5. Clearly 2 ̸= x2 + 5y2 and 5 = x2 + 5y2, so from now on, assume p is unramiﬁed. (By the proposition above, this corresponds to the fact that 2OK is the square of the nonprincipal ideal (2, 1 + √−5) and 5OK is the square of the principal ideal ( √−5).) Note that p is split in K if and only if (∆ p ) = (−5 p ) = 1, i.e., if and only if p ≡ 1, 3, 7, 9 mod 20. (⇒) If p = x2 + 5y2, then p splits in K by the proposition, so p ≡ 1, 3, 7, 9 mod 20. On the other hand, x2 + 5y2 ≡ x2 + y2 ≡ 0, 1, 2 mod 4 so p ̸≡ 3, 7 mod 20. (Alternatively, one can look at the squares mod 20.) (⇐) Suppose p ≡ 1, 9 mod 20 but p ̸= x2 + 5y2. The congruence conditions imply pOK = pp where p is a prime ideal of K, and p ̸= x2 + 5y2 means p is nonprincipal. Since hK = 2, this means p ∼ (2, 1 + √−5), i.e., p = α(2, 1 + √−5) for some α ∈ K. Write α = a c + b d √−5 for some a, b, c, d ∈ Z. Note that 2α and (1 + √−5)α must lie in OK. Since 2α ∈ OK, c|2 and d|2 so we can write α = a+b √−5 2 (replacing a and b with 2a and 2b if necessary). Then one has (2)p = (a + b √−5)(2, 1 + √−5). Taking norms yields 2p = a 2 + 5b 2. Reducing this equation mod 5 yields a2 ≡ 2, 3 mod 5 (since p ≡ 1, 4 mod 5), which is a contradic- tion.∗ For a slightly diﬀerent argument, see last semester’s Chapter 12 Notes. One could simplify this proof if we knew we could use Brahmagupta’s composition law in reverse (see above remarks on x2+3y2). In particular, for the argument in the (⇐) direction, p ∼ (2, 1+√−5) means (a+b √ −5)p = (c + d √−5)(2, 1 + √−5) for some a, b, c, d ∈ Z[ √−5]. Taking norms gives p(a2 + 5b2) = 2(c2 + 5d2). Since 2 is not of the form x2 + 5y2, one would like to conclude p is not either, but it is not obvious how to make this argument work. We will essentially be able to via genus theory in Part II. ∗Thanks to Victor Flynn for correcting an earlier argument. 36 Before moving on, let us observe there is another interesting characterization of which primes are of the form x2 + 5y2. Suppose n > 0 and n ≡ 1, 2, mod 3. As before, set K = Q(√−n). When hK = 1, the above proposition and the theorem if that a prime p is of the form x2 + ny2 if and only if (∆ p ) = 0 or 1. By quadratic reciprocity, one can then essentially say an prime p is of the form x2 + ny2 if and only if p is a square mod ∆. (One can formalize this with a diﬀerent extension of the Legendre symbol called the Jacobi symbol—we won’t go through the details, but you can observe it in the simplest case: p ̸= 2 is of the form x2 + y2 if and only if p is a square mod ∆Q(i) = −4.) When hK = 2 (or larger), the problem is the quadratic residue symbol can essentially only detect 2 things—whether p is split or inert (or ramiﬁed). But we need to distinguish when a p splits into principal ideals and when p splits into nonprincipal ideals. Check the following criterion for x2 + 5y2. Exercise 2.13. Let K = Q(√ −5), and p ∈ N be a rational prime. Show p = x2 + 5y2 if and only if (∆ p ) = 1 and p is a square mod ∆. One can treat other forms x2 + ny2 similar to x2 + 5y2 when the class number of Q(√−n) is 2. Exercise 2.14. Determine all primes of the form x2 + 6y2. When the class number of K = Q(√−n) is larger than 2, determining the primes of the form x2 + ny2 can get considerably more complicated, and the solution will depend upon the structure of the class group ClK. In general, primes of the form x2 + ny2 are not characterized just by simple congruence conditions (though it always will be if ClK ≃ (Z/2Z)r). We will explore some of the issues involved in Part II. 2.4 General splitting results In this section, let L/K be an extension of number ﬁelds, let p denote a prime of K and P denote a prime of L. If pOL = ∏ Pei i with the Pi’s distinct prime ideals of L, then fi denotes the inertial degree fi = f (Pi|p). In Section 2.2, we saw that it is simple to understand completely the way a prime p splits in L when K = Q and L is quadratic. (It is also not much harder when K is arbitrary and L/K is quadratic.) In general things are not so simple, but there are some general fundamental results which describe the splitting of primes in L/K. We will not give complete proofs in both the interest of time and simplicity. Note that OK[α] is a free OK-module of rank n = [L : K], so it has ﬁnite index (either as an abelian group or OK-module) in OL. Thus OL/OK[α] is a ﬁnite abelian group. Theorem 2.4.1. Write L = K(α) and let q(x) ∈ OK[x] be the minimum polynomial for α over K. Suppose p is a prime of Z such that p ∤ |OL/OK[α]| and p is a prime ideal of K lying above p. Write q(x) ≡ q1(x)e1q2(x) e2 · · · qg(x)eg mod p where the qi’s are distinct irreducible polynomials (of positive degree) in the ﬁnite ﬁeld OK/p. Then pOL = P e1 1 Pe2 2 · · · P eg g for distinct prime ideals P1, . . . , Pg of OL such that fi = f (Pi|p) = deg qi(x). 37 This theorem provides a way to determine how prime ideals p of K split in L. For technical reasons, a ﬁnite number of primes p are excluded from this result. Proof. (Sketch.) One ﬁrst shows OL/pOL ≃ (OK[α])/(pOK[α]) ≃ (OK/p)[x]/(q(x)), where q(x) is the image of q(x) in (OK/p)[x]. The ﬁrst isomorphism requires that pOL + F = OL where the conductor F is the largest ideal of OL contained in OK[α]. This is where the technicality that p ∤ |OL/OK[α]| comes in. The second isomorphism is straightforward. Then one can use the Chinese Remainder Theorem (for general rings, whose proof is essentially the same as for Z), (OK/p)[x]/(q(x)) ≃ g⊕ i=1 (OK/p)[x]/(qi(x)ei), where qi(x) is the image of qi(x) in (OK/p)[x]. Exercise 2.15. Suppose K = Q and L = Q( √−5). Determine |OL/OK[α]| where α = √−5. Verify the above theorem in this case. Theorem 2.4.2. Consider the extension K/Q. Then a prime (p) of Q ramiﬁes in K if and only if p|∆K. In particular, only ﬁnitely many primes of Q ramify in K. Corollary 2.4.3. Let L/K be an extension of number ﬁelds. If a prime p of K ramiﬁes in L, then p lies above a prime of N dividing ∆L. In particular, only ﬁnitely many primes p of K ramify in L. Exercise 2.16. Deduce this corollary from the previous theorem. 38 3 Zeta and L-functions In this section we will use analytic methods to (i) develop a formula for class numbers, and (ii) use this to prove Dirichlet’s theorem in arithmetic progressions: that any arithmetic progression: a + m, a + 2m, a + 3m, . . . contains inﬁnitely many primes gcd(a, m) = 1. This chapter follows [Cohn], though our presentation is reversed from his, together with some supplementary material taken from various other sources. More general treatments are found in [Marcus] and [Neukirch], though they do not do everything we will do here. 3.1 Zeta functions Recall one deﬁnes the Riemann zeta function by ζ(s) = ∑ 1 ns . (3.1) One knows from calculus that this converges for s > 1 (compare with ∫ ∞ 1 1 xs dx = x1−s 1 − s ]∞ x=1 = 1 1 − s < ∞.) Euler observed that (for s > 1) one also has the product expansion ζ(s) = ∑ 1 ns = ∏ p ( 1 + 1 ps + 1 p2s + · · ·) = ∏ 1 1 − p−s . Here p runs over all primes of N. The last equality just follows from the formula for a geometric series: ∑∞ n=0 an = 1 1−a if |a| < 1. To see the why product expansion (middle equality) is valid, it’s perhaps easiest to ﬁrst notice that it is formally true for s = 1,∗ where it says ∑ 1 n = ( 1 + 1 2 + 1 22 + 1 23 + · · ·) ( 1 + 1 3 + 1 32 + 1 33 + · · ·) ( 1 + 1 5 + 1 52 + 1 53 + · · ·) · · · (3.2) What does this (formal) inﬁnite product on the right mean? It just means a (formal) limit of the sequence of ﬁnite subproducts: 1 + 1 2 + 1 22 + 1 23 + · · · = ∑ n∈N2 1 n ( 1 + 1 2 + 1 22 + 1 23 + · · ·) ( 1 + 1 3 + 1 32 + 1 33 + · · ·) = 1 + 1 2 + 1 3 + 1 2 · 3 + 1 22 + 1 32 + 1 22 · 3 + 1 2 · 32 + · · · = ∑ n∈N2,3 1 n ∗When s = 1, neither side of the equality actually converges, but the explanation for why both sides should be equal is perhaps more transparent. Here “formally” is not to be confused with rigorously—we mean we can formally manipulate one side to get to the other. 39 ( 1 + 1 2 + 1 22 + 1 23 + · · ·) ( 1 + 1 3 + 1 32 + 1 33 + · · ·) ( 1 + 1 5 + 1 52 + 1 53 + · · ·) = ∑ n∈N2,3,5 1 n ... where Np1,p2,...,pk = { pe1 1 pe2 2 · · · pek k : ei ∈ N ∪ {0}} , i.e., Np1,p2,...,pk is the set of natural numbers which only contain the primes p1, . . . pk in their prime decomposition. We now prove rigorously that the formal product expansion for ζ(s) given above is valid for s > 1. Deﬁnition 3.1.1. Let {p} denote the set of primes of N. Let ap ∈ C for each p. We deﬁne ∏ p ap = lim n→∞ ∏ n<x ap. Hence we will say ∏ ap converges (diverges) if the limit on the right does. We say ∏ ap con- verges absolutely if lim n→∞ ∏ i<n api converges for any ordering {p1, p2, p3, . . .} of the set of primes {p}. In other words, a product converges absolutely if it converges regardless of the way we order the terms in the product. One can of course similarly deﬁne inﬁnite product over any denumerable index set Example 3.1.2. If some ap = 0, then after some point (no matter how the p’s are ordered), we will have a ﬁnite subproduct of ∏ ap = 0. Thus ∏ ap will converge to 0 absolutely. Note that if every ap > 0, then log( ∏ ap) = ∑ log ap. An immediate consequence is that ∏ ap converges (absolutely) if and only if the series ∑ log ap converges (absolutely). Proposition 3.1.3. Let (an)∞ n=1 be a totally multiplicative sequence of complex numbers, i.e., amn = aman for any m, n ∈ N, and assume a1 = 1. If ∑ an converges absolutely, then so does ∏p 1 1−ap and ∞∑ n=1 an = ∏ p 1 1 − ap , where the product is taken over all primes p of N. Proof. Suppose ∑ an converges absolutely. Let ϵ > 0. Then for some N ∈ N we can say ∑ n>N |an| < ϵ. Let {p1, p2, . . .} be any ordering of the set of primes of N. Then there is some K ∈ N such that {p1, . . . , pK} contains all ≤ N . Observe K∏ i=1 1 1 − api = K∏ i=1 (1 + ap + a 2 p + · · ·) = ∑ n∈Np1,...,pK an. 40 Since Np1,...,pK contains 1, . . . , N , we have \f \f \f \f \f ∞∑ n=1 an − K∏ i=1 1 1 − api \f \f \f \f \f ≤ \f \f \f \f \f ∑ n>N an \f \f \f \f \f ≤ ∑ n>N |an| < ϵ. Corollary 3.1.4. For any s > 1 the Euler product expansion ζ(s) = ∏ 1 1 − p−s (3.3) is valid. Proof. Apply the proposition with an = n−s. The Euler product expansion demonstrates that the zeta function captures information about primes. In fact, it contains a surprising amount of information about primes. The simplest appli- cation of the zeta function to the study of primes is Euler’s proof of the inﬁnitude of primes. Theorem 3.1.5. There are inﬁnitely many primes. Proof. Assume there are ﬁnitely many primes, p1, . . . , pk. Then ζ(s) = 1 1 − p −s 1 · 1 1 − p−s 2 · · · 1 1 − p−s k → 1 1 − 1/p1 · 1 1 − 1/p2 · · · 1 1 − 1/pk < ∞ as s → 1. On the other hand ζ(s) = ∑ 1 ns → ∑ 1 n = ∞ as s → 1. Contradiction. Exercise 3.1. For any integer k > 1, one can show 1/ζ(k) represents the probability that k “ran- domly chosen” integers are coprime (have gcd 1). Let f (x) = x on [−π, π), compute the Fourier coeﬃcients and apply Parseval’s identity. Use this to compute ζ(2), and hence determine the proba- bility that 2 randomly chosen integers are coprime. (Alternatively, you can try to derive the product expansion sin x x = ∞∏ n=1 ( 1 − ( x nπ )2) , and look at the x2 coeﬃcient to ﬁnd ζ(2).) We will brieﬂy discuss some deeper connections of ζ(s) to the study of primes, but ﬁrst let us give a generalization of the Riemann zeta function. Deﬁnition 3.1.6. Let K be a number ﬁeld. The Dedekind zeta function for K is ζK(s) = ∑ a 1 N (a)s , for s > 1 where a runs over all (nonzero) ideals of OK. 41 As before, one can show this series indeed converges for all s > 1, and we have an Euler product expansion ζK(s) = ∏ p 1 1 − N (p)−s valid for s > 1 as above. Hence the Dedekind zeta function can be used to study the prime ideals of of K. We remark that another way to write the above deﬁnition is ζK(s) = ∑ an ns where an denotes the number of ideals of K with norm n (convince yourself of this). Consequently, the Dedekind zeta function can be used to study the number of ideals of norm n. However, we will be interested in it for its applications to the class number hK of K. 3.2 Interlude: Riemann’s crazy ideas Riemann published a single paper in number theory, On the Number of Primes Less Than a Given Magnitude in 1859, which was 8 pages long, contained no formal proofs, and essentially gave birth to all of analytic number theory. We will summarize the main ideas here. We only deﬁned the Riemann zeta function for real s > 1, but in fact Riemann considered it for complex values of s. In general if a > 0 and z ∈ C, then one deﬁnes a z = ez ln a where ez = ∑ zn n! . This allows one formally to make sense of the deﬁnition ζ(s) = ∑ 1 ns for s ∈ C, and one can show the sum actually converges provided Re(s) > 1. Riemann showed that ζ(s) can be extended (uniquely) to a diﬀerentiable function on all of C except at s = 1, where ζ(s) has a pole (must be ∞). However the above series expression is only valid for Re(s) > 1. Riemann showed that ζ(s) has a certain symmetry around the line Re(s) = 1 2 , namely one has the functional equation ζ(1 − s) = Γ ∗(s)ζ(s) where Γ∗(s) is a function closely related to the Γ function. The functional equation says one can compute ζ(1 − s) in terms of ζ(s), so we can indirectly use the series for ζ(s) to compute ζ(s) when Re(s) < 0. The region 0 < Re(s) < 1 is called the critical strip, and the central line of symmetry Re(s) = 1 2 is called the critical line. Let {ρ} denote the set of zeroes of ζ(s) inside of the critical strip. There are countably (inﬁnitely) many, and let us order them by their absolute value. Let f (x) = π(x) + 1 2 π(x1/2) + 1 3 π(x1/3) + · · · 42 where π(x) is the number of primes less than x. Riemann discovered the following formula for f (x) f (x) = Li(x) − ∑ ρ Li(xρ) − log(2) + ∫ ∞ x dt t(t2 − 1) ln t where Li(x) = ∫ x 0 dt ln t . Hence this formula relates π(x) with the (values of Li at the) zeroes of ζ(s). In fact, using Möbius inversion, one can rewrite π(x) in terms of f (x) (and therefore the zeroes of ζ(s)) as π(x) = f (x) − 1 2 f (x1/2) − 1 3 (x 1/3) − · · · Essentially this says the following: if we know exactly where all the zeroes ρ of ζ(s) are we know exactly where the primes are (these are the places on the real line where π(x) jumps). Here is where Riemann made his famous conjecture, the Riemann hypothesis, that all the zeroes of ζ(s) lying in the critical strip actually lie on the critical line. (It is easy to see from series expansion that ζ(s) ̸= 0 for Re(s) ≥ 1. Then by the functional equation, ζ(1 − s) = 0 for Re(s) > 1 if and only if Γ∗(s) = 0, which happens precisely for s a positive odd integer. Thus the only zeroes of ζ(s) outside of the critical strip, are the so-called trivial zeroes occurring when s = −2k, k ∈ N.) In 1896, Hadamard and de la Vallée Poussin used Riemann’s ideas to prove the prime number theorem, that π(x) ∼ Li(x) ∼ x ln x as x → ∞. (This notation means π(x) is approximately x ln x for x large.) This is important, for example, in cryptography where one wants to know that the primes don’t get too thinly spread out, so that large primes provide suitably secure keys for RSA. The Riemann hypothesis is equivalent to the “best possible bound” for the error term in the prime number theorem, precisely that |π(x) − Li(x)| < 1 8π √x ln(x) for x ≥ 2657. The Riemann hypothesis has natural generalizations to Dedekind zeta functions and L-functions (see below). Due to a host of applications, the generalized Riemann hypothesis is considered one of the most important open problems in mathematics. 3.3 Dirichlet L-functions Let m ∈ N. In 1837 (before Riemann!)∗, Dirichlet introduced L-functions as a generalization of the Riemann zeta function in order to study the primes mod m. In particular, Dirichlet used these L-functions to show that there are inﬁnitely many primes ≡ a mod m, which will be one of the main results of this chapter. This result had been conjectured by Euler for a = 1 and by Legendre in general. Let’s start with the example of p ≡ 1 mod 4. (Last semester we were able to use a trick together with the ﬁrst supplemental law of quadratic reciprocity to show there are inﬁnitely many primes p ≡ 1 mod 4, and the case of p ≡ 3 mod 4 was an exercise using a diﬀerent trick. Legendre tried to use quadratic reciprocity to treat the general case, but was unsuccessful, and as far as I know, there is no proof of the general case which does not use Dirichlet L-functions.) ∗Riemann’s zeta function was studied before Riemann as a function of natural numbers by Euler. 43 Knowing Euler’s proof of the inﬁnitude of primes, one might be tempted to try to deﬁne a series by ∏ p≡1 mod 4 1 1 − p−s . This expands out as a sum ∑ n∈N1 1 ns where N1 is the set of all natural numbers which only contain primes ≡ 1 mod 4 in their prime factorization. If the number of such primes is ﬁnite then the product expansion converges as s → 1, and one would like to show the series expansion diverges to obtain a contradiction. However summing over N1 is not a natural thing to do and there is no simple way to directly analyze it. Hence we will have to be a little more subtle than this. Dirichlet, being smarter than this, had the following idea using characters. Let’s ﬁrst recall a couple things about characters of ﬁnite abelian groups. Deﬁnition 3.3.1. Let G be a ﬁnite abelian group. A character (or 1-dimensional representa- tion) of G is a group homomorphism into C×. The set of characters of G is denoted by ˆG, and is called the dual of G. Exercise 3.2. Let G be a ﬁnite abelian group. Let χ, λ ∈ ˆG. (i) Show χλ, deﬁned by (χλ)(g) = χ(g)λ(g), is also in ˆG. (ii) Show χ, deﬁned by χ(g) = χ(g), is also in ˆG. (Here the bar denotes complex conjugation.) (iii) For any g ∈ G, show χ(g) is a (not necessarily primitive) n-th root of unity† where n is the order of g in G. (iv) Deduce that χχ = χ0, where χ0 denotes the trivial character, i.e., χ0(g) = 1 for all g ∈ G. (v) Conclude that ˆG is an abelian group. Proposition 3.3.2. Let G be ﬁnite abelian group. Then ˆG ≃ G. Proof. Let us ﬁrst prove the proposition in the case G = Cn (the cyclic group of order n). Let α be a generator of G. By (iii) of the exercise above, if χ ∈ ˆG, then χ(α) must be an n-th root of unity ζ. Furthermore any n-th root of unity ζ deﬁnes (uniquely) a character on G by setting χ(αk) = ζ k. (Observe this is character, and that nothing else can be.) In other words, a character is determined by what it does to a generator of G. Let ζn denote a primitive n-th root of unity (take ζn = e2πi/n if you wish). There are n n-th roots of unity, given by ζ 0 n = 1, ζn, ζ 2 n, . . . , ζ n−1 n . Hence there are precisely n distinct character of G, χ0, χ1, χ2, . . . , χn−1 given by χi(α) = ζ i n. It is obvious then that (χiχj)α = ζ i+j n , i.e., χiχj = χi+j mod n. Hence ˆG ≃ Z/nZ ≃ Cn. Now that we have prove the proposition in the case where G is cyclic, let us assume G is an arbitrary ﬁnite abelian group. Then we know by the classiﬁcation of such groups, G ≃ ∏ Cri ni. Set ζni = e2πi/ni and let αi ∈ G be a generator for Cni. As above, we can deﬁne characters χij on Cni by χij(αi) = ζ j ni. We can extend each χij to a character on G by setting χij(αk) = 1 whenever i ̸= k and using multiplicativity. In other words, view and g ∈ G as g = (αe1 1 , αe2 2 , . . . , αet t ) †ζ ∈ C is a primitive n-th root of unity if ζ n = 1 but ζ d ̸= 1 for any d|n. For example there are four 4-th roots of unity: ±1, ±i, but only ±i are primitive. 44 and set χij(g) = ζ jei ni . Hence for each i, we get disjoint subgroups of ˆG each isomorphic to ˆCni ≃ Cni. It is straightforward to check that any character of G is a product of some χij’s, i.e., we have ˆG ≃ ∏ ˆCni ≃ ∏ Cni ≃ G. We will be interested in the case where G = (Z/mZ)×. Example 3.3.3. Suppose G = (Z/2Z)×. Then G = {1} = C1 so ˆG = {χ0}. In other words, the only character of G is the trivial one χ0 which sends 1 to 1. Example 3.3.4. Suppose G = (Z/3Z)×. Then G = {1, 2} ≃ C2 (here 1 and 2 represent the corresponding congruence classes in Z/3Z). Since 2 generates G and has order 2, there are two possibilities for characters: χ0 : 1 7→ 1, 2 7→ 1 and χ1 : 1 7→ 1, 2 7→ −1 So ˆG = {χ0, χ1} ≃ C2. Note that G = (Z/4Z)× ≃ C2 also, so this case is essentially the same as (Z/3Z)×. Example 3.3.5. Suppose G = (Z/5Z)×. Then G = {1, 2, 3, 4} ≃ C4. Here 2 generates G, so a character of G is determined by what 4-th root of unity 2 maps to. Explicitly, we have 4 characters, whose values are read oﬀ of the following character table: 1 2 3 4 χ0 1 1 1 1 χ1 1 −1 −1 1 χ2 1 i −i −1 χ3 1 −i i −1 Looking at this table, it is easy to see ˆG is cyclic of order four, generated either by χ2 or χ3. Exercise 3.3. Determine all characters of (Z/15Z)× and (Z/16Z)×. (Write them down in character tables like our (Z/5Z)× case. Feel free to order the columns and rows however you ﬁnd easiest.) Theorem 3.3.6. Let CG = {f : G → C} denote the space of complex valued functions from a ﬁnite abelian group G into C (the group algebra of G). This is a |G|-dimensional vector space over C. The characters χ ∈ ˆG form a C-basis for CG. We omit the proof, and in fact we do not need this precise result, but it is helpful for motivation. What this means for us is the following. We want to study the primes p in a congruence class mod m. As long as p ∤ m, we have p ≡ a mod m for some a ∈ (Z/mZ)×. Let {χ} denote the the set of characters of G = (Z/mZ)× and ﬁx a ∈ (Z/mZ)×. Consider the function f ∈ CG given by f : (Z/mZ) × → C 45 f (x) = { 1 x = a 0 else. In other words, f tells me if p mod m is a or not. What the above says is that f (x) = ∑ cχχ(x) for some cχ ∈ C. Hence knowing χ(p mod m) for all χ tells us whether p ≡ a mod m or not. Slightly more generally, the above theorem says knowing χ(p mod m) for all χ and p ∤ m is the same as knowing p mod m for all p ∤ m. Put another way, the characters of (Z/mZ)× distinguish all the (invertible) congruence classes mod m. This suggest it is possible to study the primes ≡ a mod m using the characters of (Z/mZ)×. To somehow connect this with something like the zeta function, one actually wants to think of the characters of (Z/mZ)× as “characters” of Z. Deﬁnition 3.3.7. Let χ be a character of (Z/mZ)×. We extend χ to a function χ : Z → C by χ(a) = { χ(a mod m) if a is invertible mod m 0 else. The resulting function χ : Z → C is called a Dirichlet character mod m. Note that the values of χ only depend upon congruence classes mod m. Then our remarks before the deﬁnition can be rephrased as follows: knowing the value of χ(p) for every Dirichlet character χ mod m and every p ∤ m is equivalent to knowing the value of p mod m for every p ∤ m. Example 3.3.8. Consider χ2 from our earlier (Z/5Z)× example. Then the corresponding Dirichlet character is χ2(a) =  |||||| |||||| 0 a ≡ 0 mod 5 1 a ≡ 1 mod 5 i a ≡ 2 mod 5 −i a ≡ 3 mod 5 −1 a ≡ 4 mod 5. Exercise 3.4. Let χ be a Dirichlet character mod m. Then χ(ab) = χ(a)χ(b) for any a, b ∈ Z. Deﬁnition 3.3.9. Let χ be a Dirichlet character mod m. Then Dirichlet L-function (or L-series) for χ is given by L(s, χ) = ∞∑ n=1 χ(n) ns . (3.4) for s > 1. Note that since |χ(n)| ≤ 1 for all n (see Exercise 3.2(iii)), we can say |L(s, χ)| ≤ ∑ 1 ns = ζ(s) (s > 1), 46 hence the series deﬁning L(s, χ) converges absolutely for s > 1. Because χ is multiplicative by the exercise above, the same expansion trick we used for ζ(s) above works to give a product expansion L(s, χ) = ∏ p 1 1 − χ(p)p−s , (3.5) which again is valid for s > 1. (Just apply Proposition 3.1.3 with an = χ(n) ns .) Just like ζ(1) = ∞ told us there were inﬁnitely many primes, the most important value of L(s, χ) for primes in arithmetic progressions is L(1, χ) (which is not typically ∞—it will be if and only if χ = χ0 is the trivial character mod m). Example 3.3.10. To return to the case of studying primes ≡ 1 mod 4, look at the Dirichlet char- acters mod 4. Since (Z/4Z)× ≃ C2, there are only two Dirichlet characters mod 4. We can write them as χ0(a) = { 0 a ≡ 0, 2 mod 4 1 a ≡ 1, 3 mod 4 (the trivial character) and χ1(a) =  | | 0 a ≡ 0, 2 mod 4 1 a ≡ 1 mod 4 −1 a ≡ 3 mod 4 (the nontrivial character). Then, for s > 1, we have L(s, χ0) = ∑ n odd 1 ns = ∏ p̸=2 1 1 − p−s and L(s, χ1) = ∑ n≡1 mod 4 1 ns − ∑ n≡3 mod 4 1 ns = ∏ p≡1 mod 4 1 1 − p−s · ∏ p≡3 mod 4 1 1 + p−s . Hence these L-functions are not too far from our original naive suggestion, and they are not too diﬃculty (though not trivial) to analyze. We also note that L(s, χ0) is essentially ζ(s)—it is oﬀ by a single factor ζ(s) = 1 1 − 2−s L(s, χ0), so L(1, χ0) = (1 − 2−1)ζ(1) = ∞. From the series expansion of L(s, χ1) it’s not to hard to see that L(1, χ1) = 1 − 1 3 + 1 5 − 1 7 + 1 9 − · · · = π 4 (The latter equality, known as Leibnitz’s formula, follows from let x → 1 in the Taylor series for arctan(x).) Now we can use this to show there are inﬁnitely many primes ≡ 1 mod 4 and ≡ 3 mod 4. Suppose there were ﬁnitely many primes p ≡ 3 mod 4. Then the above formula for L(s, χ1) shows ζ(s)/L(s, χ1) = 1 1 − 2−s ∏ p≡3 mod 4 1 + p−s 1 − p−s 47 for s > 1. But then letting s → 1 yields 1 1 − 1 2 · ∏ p≡3 mod 4 1 + 1 p 1 − 1 p = ζ(1) · 4 π = ∞, which is a contradiction since the left hand side must be ﬁnite if there are only ﬁnitely many p ≡ 3 mod 4. Similarly suppose there were ﬁnitely many primes p ≡ 1 mod 4. Then ζ(s)L(s, χ1) = 1 1 − 2−s   ∏ p≡1 mod 4 1 1 − p−s   2 ∏ p≡3 mod 4 1 1 − p−2s = 1 1 − 2−s   ∏ p≡1 mod 4 1 1 − p−s   2  ζ(2s)(1 − 2 −2s) ∏ p≡1 mod 4 (1 − p−2s)   = (1 + 2−s) ∏ p≡1 mod 4 1 − p−2s (1 − p−s)2 · ζ(2s). for s > 1. Letting s → 1, we see the right hand side is ﬁnite, since ζ(2) = π2 6 < ∞ and the product has only ﬁnitely many terms, but the left hand side approaches ζ(1)/L(s, χ1) = 4 π ∞ = ∞, a contradiction. Hence just knowing that 0 < |L(1, χ1)| < ∞ allows us to conclude there are inﬁnitely many primes p ≡ 1 mod 4 and inﬁnitely many p ≡ 3 mod 4. Theorem 3.3.11. (Dirichlet’s theorem on arithmetic progressions) Suppose gcd(a, m) = 1. Then there are inﬁnitely many primes p ≡ a mod m. Proof. Let {χ} be the set of Dirichlet characters mod m. We consider the complex logarithm deﬁned by log(1 + z) = z − z2 2 + z3 3 − · · · . for |z| < 1. Then for any χ, we have \f \f \f \flog ( 1 1 − χ(p)p−s )\f \f \f \f = | log(1 − χ(p)p−s)| = \f \f \f \f χ(p) ps + χ(p2) 2p2s + χ(p3) 3p3s + · · · \f \f \f \f . It follows from the Taylor expansion of log(1 + x) that log ( 1 1 − χ(p)p−s ) = − log(1 − χ(p)p−s) = χ(p) ps + ϵp(s) where ϵp(s) is an error term satisfying |ϵp(s)| < 1 p2s . Hence log L(s, χ) = ∑ p χ(p) ps + ϵχ(s) where ϵχ(s) = ∑p ϵp(s) so |ϵχ(s)| < ∑ 1 p2s . 48 Now consider the sum ∑ χ χ−1(a) log L(s, χ) = ∑ χ,p χ−1(a)χ(p) ps + ϵ(s) (3.6) where ϵ(s) = ∑ χ χ−1(a)ϵχ(s) is an error term. Now we appeal to a fundamental result from repre- sentation theory (see exercise below), the orthogonality relation for characters. This is essentially a reﬁnement of Theorem 3.3.6, saying that the characters ˆG of a group G form an orthogonal basis for CG. In our case, the orthogonality relation says ∑ χ χ −1(a)χ(p) = { ϕ(m) a ≡ p mod m 0 else. (Here ϕ(m) = |(Z/mZ)×|.) Hence by ﬁrst summing over χ, we see the only p that contribute are those ≡ a mod m. In other words ∑ χ χ−1(a) log L(s, χ) = ϕ(m) ∑ p≡a mod m χ(p) ps + ϵ(s). (3.7) It is straightforward to check that the error term ϵ(s) remains bounded as s → 1 (exercise below). Thus if there are only ﬁnitely many primes p ≡ a mod m, then the right hand side converges as s → 1. In other words, it suﬃces to show the left hand diverges when s → 1. Consider the trivial character χ0. Then L(s, χ0) = ∏ p∤m 1 1 − p−s = ∏ p|m(1 − p−s) · ζ(s), hence L(s, χ0) → ∏p|m(1 − p−1) · ζ(1) = ∞ as s → 1. Thus log L(s, χ0) → ∞ as s → 1. This means the sum (3.6) must tend to ∞ as s → 1 provided no single term χ−1(a) log L(s, χ) → −∞ as s → 1. This follows from the fact that L(s, χ) ̸= 0, which is the content of Proposition 3.4.7 in the next section. The fact that L(s, χ) ̸= 0 follows from Dirichlet’s class number formula, which is itself of great interest. Historically, Dirichlet proved his class number formula, and used this to prove his theorem on arithmetic progressions, though now there are other proofs that L(1, χ) ̸= 0. We will follow Dirichlet’s approach (at least the presentation in [Cohn]) and prove the class number formula, and use this to conclude the proof of Theorem 3.3.11 in the next section. Exercise 3.5. Let G = Z/nZ. Let a, b ∈ G. Show ∑ χ∈ ˆG χ−1(a)χ(b) = { |G| a = b 0 else. (Hint: use the fact that we know explicitly what the characters are as in the proof of Proposition 3.3.2.) This proves the orthogonality relation we used above in the case of cyclic groups. Exercise 3.6. Check that the error term ϵ(s) appearing in the proof is bounded as s → 1. 49 3.4 The class number formula The class number formula will fall out of analysis of the Dedekind zeta function. Let K = Q(√d) where d ̸= 1 is squarefree. Let ∆ = ∆K. Recall that for s > 1, ζK(s) = ∏ p 1 1 − N (p)−s . If p|p where p is a prime of N, then N (p) = p if p is split or ramiﬁed and N (p) = p2 if p is inert. If p splits in K there are 2 prime ideals p lying above p, and otherwise there is just 1. So we can rewrite ζK(s) = ∏ p ramiﬁed 1 1 − p−s ∏ p split ( 1 1 − p−s )2 ∏ p inert 1 1 − p−2s = ∏ p ramiﬁed 1 1 − p−s ∏ p split ( 1 1 − p−s )2 ∏ p inert ( 1 1 − p−s ) ( 1 1 + p−s ) = ∏ p 1 1 − p−s ∏ p split 1 1 − p−s ∏ p inert 1 1 + p−s = ζ(s) ∏ p split 1 1 − p−s ∏ p inert 1 1 + p−s . Note that the two products on the right, look like one of Dirichlet’s L-functions. In fact, we know p splits in K if and only if (∆ p ) = 1, and p is inert in K if and only if (∆ p ) = −1. Hence if we extend the Kronecker symbol (∆ p ) to a function from Z → C by χ∆(n) =  | | 0 gcd(n, ∆) > 1 (∆ p1)e1(∆ p2)e2 · · · ( ∆ pk)ek n > 0, n = pe1 1 pe2 2 . . . p ek k and gcd(n, ∆) = 1 χ∆(−n)χ∆(|∆| − 1) n < 0. One easily checks that χ∆ is a totally multiplicative function on Z which depends only upon con- gruences classes mod ∆. Restricting to (Z/∆Z)× gives only nonzero values, so we get a (group) character of (Z/∆Z)×. In other words, χ∆ is a Dirichlet character mod ∆, and one has (for s > 1) L(s, χ∆) = ∏ χ∆(p)=( ∆ p)=0 1 · ∏ χ∆(p)=( ∆ p)=1 1 1 − p−s · ∏ χ∆(p)=(∆ p)=−1 1 1 + p−s . In other words, we have shown Lemma 3.4.1. For s > 1, ζK(s) = ζ(s)L(s, χ∆). Theorem 3.4.2. (Dirichlet’s class number formula for imaginary quadratic ﬁelds) Let K = Q( √d) where d < 0 is squarefree. Then L(1, χ∆) = lim s→1 ζK(s) ζ(s) = 2πhK w√−∆ , where w is the number of roots of unity in OK, i.e., w = 6 if d = −3, w = 4 if d = −1 and w = 2 otherwise. 50 Theorem 3.4.3. (Dirichlet’s class number formula for real quadratic ﬁelds) Let K = Q( √d) where d > 1 is squarefree. Then L(1, χ∆) = lim s→1 ζK(s) ζ(s) = 2 log η hK√ ∆ , where η is the fundamental unit in OK. (For us, the fundamental unit η of OK where K is real quadratic is the unique unit η > 1 such that any unit of OK is of the form ±ηm for some m ∈ Z.) The quantity lims→1 ζK (s) ζ(s) is called the residue of ζK(s) at s = 1. The idea is that while ζK(s) and ζ(s) both have a simple pole at s = 1∗, these poles should cancel in the quotient to give us a ﬁnite number that tells us about the arithmetic of K. Indeed, the quotient ζK(s)/ζ(s) = L(1, χ∆) is (or can be continued to) a well-deﬁned continuous function at s = 1. Example 3.4.4. Let ∆ = −4. The quadratic ﬁeld of discriminant ∆ = −4 is K = Q(i), and Dirichlet’s class number formula says L(1, χ−4) = 2πhK 4 √4 = πhK 4 . But we saw last section, that L(1, χ−4) = 1 − 1 3 + 1 5 − 1 7 + · · · = π 4 , hence the class number formula provides another proof that hK = 1. Or if one wishes to approach things from the opposite direction, we see that the fact that hK = 1 (which we proved in two other ways before: by showing Z[i] is a Euclidean domain and by using Minkowski’s bound) implies Leibnitz’s formula for π = 4(1 − 1/3 + 1/5 − · · · ). Exercise 3.7. Using the fact that Q( √−3) has class number 1, determine value of the series 1 − 1 2 + 1 4 − 1 5 + 1 7 − 1 8 + · · · from the class number formula. Exercise 3.8. Analogous to the previous exercise, explicate the class number formula in the cases Q( √−5) and Q( √2). (I.e., write down explicitly what the series L(1, χ∆) is and determine its value from the class number formula.) Now you may think above exercises, while interesting, are sort of the opposite of what we want. Instead of using hK to determine L(1, χ∆), we would prefer to use L(1, χ∆) to determine the class number, as we gave an alternate proof for hQ(i) = 1 in the example above. Thus we will need some way of evaluating the series L(1, χ∆) = ∑ n≥1 χ∆(n) n (which converges conditionally). In fact, one can write down a ﬁnite expression for L(1, χ∆) to actually compute class numbers and we will discuss this later. First we want to prove the class number formula. This immediately implies L(1, χ∆) ̸= 0 for any ∆. From this one can deduce that L(1, χ) ̸= 0 for any Dirichlet character χ, which will complete the proof of Dirichlet’s theorem on primes in arithmetic progressions. The proof of the class number formula relies on simple geometric lattice point counting problems. ∗This means that they go to inﬁnity at the “same rate” as 1 1−s . 51 Lemma 3.4.5. (Gauss) Suppose A, B, C are integers with B2 − 4AC < 0. The number λ(T ) of lattice points (points in Z2) contained in the solid ellipse Ax2 + Bxy + Cy2 ≤ T satisﬁes λ(T ) = 2πT √4AC − B2 + O(√T ) Recall the big-O notation means the following: for f, g : R → R, we say f (x) = O(g(x)) if |f (x)| ≤ cg(x) for all x > X where X and c are some constants. Another way to say this is that f (x) = O(g(x)) means lim supx→∞ |f (x)| g(x) < ∞ (assuming g is positive). Proof. First we observe the area of the ellipse is 2πT√4AC−B2 . To see this, note that there is a change of variables ( x′ y′ ) = ( cos θ sin θ − sin θ cos θ ) ( x y ) for some θ such that Ax2+Bxy+Cy2 = A′x′2+C′y′2 for some A′, C′. (In other words, we just rotate the ellipse so its major and minor axes are on the x′ and y′ axes.) However since the determinant of this transformation (a rotation matrix) is 1, the determinant B2 −4AC of the form Ax2 +Bxy +Cy2 equals the determinant −4A′C′ of the form A′x′2 + C′y′2. (Just check this explicitly.) Since the major and minor axes of the ellipse must have length 2 √T /A′ and 2 √ T /B′, we know the area of the ellipse is A(T ) = πT√A′C′ = 2πT√4AC−B2 . Now we can tile R2 with squares, with each square having area one and centered about some lattice point (x, y) ∈ Z2. Let m(T ) be the number of squares completely contained in our ellipse Ax2 + Bxy + Cy2 ≤ T and M (T ) be the smallest number of squares which completely contain the ellipse. Since λ(T ) is the number of squares whose center is contained in the ellipse, we clearly have m(T ) ≤ λ(T ) ≤ M (T ). The point is that m(T ) and M (T ) are both roughly the area A(T ) of the ellipse. Precisely, let n(T ) denote the number of squares which intersect the boundary Ax2 + Bxy + Cy2 = T of the ellipse. Note that m(T ) ≥ A(T ) − n(T ) and M (T ) ≤ A(T ) + n(T ). (Draw a picture.) Thus A(T ) − n(T ) ≤ λ(T ) ≤ A(T ) + n(T ) for all n. So it suﬃces to show that n(T ) = O(√T ). Interchanging x and y if necessary, we may assume that A ≤ C, so the ellipse is wider in the x-direction than it is tall in the y-direction. Then n(T ) ≤ 8 + 8√ T /A = O( √T ) by the exercise below. Exercise 3.9. Show there are 4 points of slope ±1 on the ellipse Ax2 + Bxy + Cy2 = T with A ≤ C. This breaks the ellipse up into 4 arcs. Show each arc intersects at most 2 + 2√ T /A squares in the tiling above by considering projections onto the x- and y- axes. 52 To put the proof in simpler terms, the number of lattice points in an ellipse is essentially the area of the ellipse, with some error term which is essentially determined by the arclength. If the area increases like T , then the arclength will increase like √T , hence the O(√T ) bound on the error. Let F (T ) denote the number of (nonzero) ideals I of OK with norm N (I) ≤ T . We know F (T ) is ﬁnite for any T . Lemma 3.4.6. We have F (T ) = κhKT + O( √T ) where κ = { 2π w√−∆ ∆ < 0 2 log η√∆ ∆ > 0, using the notation above. The number κ is called Dirichlet’s structure constant. So in this notation Dirichlet’s class number formula reads (in both cases) L(1, χ∆) = κhK. Proof. For a nonzero ideal I of OK, set G(I, T ) = {(α) ⊆ I : 0 < |N (α)| ≤ T }, i.e., G(I, T ) is the number of principal ideals contained in I of (absolute) norm at most T . Suppose J is an ideal of OK equivalent to I −1. Then IJ = (α) is a principal ideal contained in I. Conversely, any principal ideal (α) ⊆ I is of this form α = IJ for J ∼ I −1 and we have N (J ) ≤ T ⇐⇒ |N (α)| = N (J I) ≤ T N (I). Hence G(I, T N (I)) is the number of ideals of norm ≤ T which are equivalent to I −1. Thus we may write F (T ) = G(I1, T N (I1)) + G(I2, T N (I2)) + · · · + G(Ih, T N (Ih)) where I1, . . . , Ih are a set of ideal representatives for the class group ClK. Consequently, the lemma follows if we can show G(I, T N (I)) = κT + O( √T ) for any ideal I of OK. Suppose ∆ < 0. Let β1, β2 be a Z-basis for I. Write α = β1x + β2y. Then N (α) = αα = Ax2 + Bxy + Cy2, where A = N (β1), B = T r(β1β2) and C = N (β2). Hence the number of α with norm ≤ T N (I) is the number of lattice points (points of Z2) contained inside the solid ellipse Ax2 + Bxy + Cy2 ≤ T N (I). Note α and α′ generate the same principal ideal if and only if they diﬀer by units. Hence G(I, T N (I)) is 1 w times the number of nonzero lattice points inside the ellipse Ax2 + Bxy + Cy2 ≤ T N (I). This ellipse has discriminant B2 − 4AC = ∆[β1, β2] = ∆KN (I)2, so the desired estimate of G(I, T N (I)) follows from Gauss’s lemma above. Suppose ∆ > 0. The idea is basically the same. If β1, β2 is a Z-basis for I and α = β1x + β2y then |N (α)| = |Ax2 + Bxy + Cy2| where A = N (β1), B = T r(β1β2) and C = N (β2). However there will be inﬁnitely many solutions to |N (α)| ≤ T N (I) owing to the inﬁnitude of units. But there is a one-to-one correspondence of 53 elements α ∈ I satisfying 1 ≤ |α/α| < η2, α > 0 and principal subideals (α) of I. Hence we may write G(I, T N (I)) as the number of nonzero solutions to the following system of equations: −T ≤ Ax2 + Bxy + Cy2 ≤ T, 1 ≤ | β1x + β2y β1x + β2y | < η2, β1x + β2y > 0. Since the discriminant B2 − 4AC of the quadratic form Ax2 + Bxy + Cy2 is positive, one gets not an ellipse but a hyperbolic region from the ﬁrst equation. The latter two equations leave us with two ﬁnite hyperbolic sectors to count lattice points in. By setting up an appropriate integral one can show the area is 2 log η T√∆ . For more details, see [Cohn]. Now we can prove the class number formula. Proof. We want to show L(s, χ∆) = κhK. Recall we can write ζK(s) = ∑ an ns where an is the number of ideals of norm n. Hence ζK(s) = F (1) 1s + F (2) − F (1) 2s + F (3) − F (2) 3s + · · · = F (1) ( 1 1s − 1 2s ) + F (2) ( 1 2s − 1 3s ) + · · · = ∞∑ T =1 F (T ) { 1 T s − 1 (T + 1)s } . For a ﬁxed T , we have 1 T s − 1 (T + 1)s = 1 T s {1 − ( T T + 1 )s} = 1 T s { 1 − ( 1 + 1 T )−s} = 1 T s {1 − ( 1 − s T + s(s + 1) 2!T 2 − s(s + 1)(s + 2) 3!T 3 + · · ·)} = s T s+1 + ϵ(T, s). The third line follows from the Taylor expansion of (1 + x) −s about x = 0, and the ϵ(T, s) is an error term satisfying |ϵ(T, s)| < C s2 T s+2 for some constant C from Taylor’s theorem with remainder. Hence ζK(s) = ( s ∞∑ T =1 · F (T ) T s+1 + ∞∑ T =1 F (T )ϵ(T, s) ) . Bear in mind that we will want to take the limit as s → 1+. By the above lemma, we know F (T ) ≤ C1T for some C1. So for s in the range 1 < s < 2, we have ∞∑ T =1 F (T )|ϵ(T, s)| ≤ CC1s2T ∞∑ T =1 1 T s+2 ≤ 4C ∞∑ n=1 1 n2 = 4Cζ(2) < ∞. 54 Thus we may write ζK(s) = s ∞∑ T =1 F (T ) T s+1 + f.e. where f.e. (ﬁnite error) represents an error term which remains ﬁnite as s → 1+. Again using the lemma above, we have ζK(s) = sκhk ∞∑ T =1 1 T s | {z } ζ(s) + ϵ2(T )s ∞∑ T =1 1 T s+1 + f.e., where ϵ2(T ) is an error term satisfying |ϵ2(T )| ≤ C2√T for some constant C2. Then the middle term satisﬁes |ϵ2(T )|s ∞∑ T =1 1 T s+1 ≤ 2C2 ∞∑ T =1 1 T s+ 1 2 ≤ 2C2ζ(s + 1 2 ) ≤ 2C2ζ( 3 2 ) < ∞ for 1 < s < 2. So we may write ζK(s) = sκhkζ(s) + f.e. Dividing both sides by ζ(s) and sending s → 1+ gives the class number formula. Proposition 3.4.7. Let χ be a nontrivial Dirichlet character mod m. Then 0 < |L(1, χ)| < ∞. This result completes the proof of Dirichlet’s theorem on primes in arithmetic progressions. Proof. If χ is nontrivial, one can show the series ∑ χ(n) n for L(1, χ) converges conditionally as one shows the alternating harmonic series converges in calculus. One shows that the series L(s, χ) = ∑ χ(n) ns converges uniformly for s ≥ 1 so that ∑ χ(n) n actually equals lims→1 L(s, χ). The details are standard analysis and we will omit them. It remains to show L(1, χ) ̸= 0. First suppose χ is a real character, i.e., the image of χ is contained in R. In particular, χ can only take on the values ±1 and 0. We claim that χ(n) = χ∆(n) for some discriminant ∆ of a quadratic ﬁeld K. Recall that (Z/mZ)× = ∏(Z/pei i Z)× where m = ∏ pei i by the Chinese Remainder Theorem. This means any Dirichlet character mod m is just a product of Dirichlet characters mod p ei i . Hence it suﬃces to prove the claim when m = pe for some prime p. Assume p is odd. (The case p = 2 is an exercise below.) In this case (Z/mZ)× is cyclic. Let ξ be the restriction of χ to G = (Z/mZ)×, i.e., ξ is the group character of G = (Z/mZ)× which gives rise to the Dirichlet character χ : Z → R. Note that ξ only takes on values ±1 so ξ2 = 1. If ξ is trivial, then so is χ, contrary to our assumption. Hence ξ must be an element of order 2 in ˆG. (ξ is called a quadratic character.) But ˆG ≃ G is cyclic, so there is only 1 element of order 2 in ˆG. Let K = Q( √p) if p ≡ 1 mod 4 and K = Q( √−p) if p ≡ 3 mod 4, so |∆| = p where ∆ = ∆K. Thus (∆ · ) deﬁnes a quadratic character of (Z/pZ)×. Composing this with the natural map from (Z/peZ)× → (Z/pZ)× (just taking elements mod p) gives a nontrivial quadratic character of (Z/peZ)×, which must equal ξ since it has order 2 in ˆG. Hence χ∆ = χ. (χ∆ is naturally a Dirichlet character mod p, but it may also be regarded as a Dirichlet character mod m = pe.) This proves the claim that any real Dirichlet character mod m is of the form χ∆ for some quadratic ﬁeld discriminant ∆ (which will sometimes be positive and sometimes be negative). But the class number formula immediately implies that L(1, χ∆) ̸= 0. 55 Now suppose χ is a complex character, i.e., the image of χ is not contained in R. Note the derivative L ′(s, χ) = − ∞∑ n=1 χ(n) log n ns exists and is continuous for s ≥ 1 (this series converges uniformly). If χ′ is a complex Dirichlet character mod m such that L(s, 1) = 0, then by the mean value theorem for any s > 1 there is a 1 < s0 < s such that, L(s, χ ′) = L(s, χ ′) − L(1, χ ′) = L′(s0, χ ′)(s − 1). Similarly we have L(s, χ′) = L′(s0, χ′)(s − 1) where χ′ is the complex conjugate of χ′ (which is easily seen to also be a Dirichlet character mod m). This means that L(s, χ′) and L(s, χ′) go to 0 at least as fast as s − 1 as s → 1 (faster if L′(s0, χ′) also goes to 0). From (3.7) with a = 1, we have ∑ χ log L(s, χ) = ϕ(m) ∑ p≡1 mod m 1 ps + f.e. where χ runs over all Dirichlet characters mod m and f.e. represents an error term which remains ﬁnite as s → 1. As s → 1, both log L(s, χ′) and log L(s, χ′) approach −∞ at least as fast as log(s − 1). But there is only one term on the left, log L(s, χ0) where χ0 is the trivial Dirichlet character mod m, which goes to ∞. It goes to ∞ at the same rate as log ζ(s), which is − log(s − 1). Hence the left hand side of the above equation goes to −∞, but the right hand side stays positive (in fact goes to +∞), a contradiction. Exercise 3.10. Suppose χ is a real Dirichlet character mod m = 2e. Using the fact that (Z/mZ)× ≃ C2 × C2e−2 for e > 1, show χ = χ∆ for ∆ the discriminant of some quadratic ﬁeld. Exercise 3.11. Determine all real nontrivial Dirichlet characters mod m for m = 3, 5, 6, 9, 15. For each of these characters χ determine a quadratic ﬁeld discriminant ∆ such that χ = χ∆. For which χ we can choose a ∆ > 0 so that χ = χ∆ and when we can choose a ∆ < 0? In the proof for real characters, we used a Dirichlet character mod p to get a Dirichlet character mod pe. Exercise 3.12. If χ is a Dirichlet character mod m, is it a Dirichlet character mod mn for any n? We have now seen how to prove the class number formula (omitting some details in the real quadratic case), and how one can use this to prove Dirichlet’s theorem on arithmetic progressions. Of course, the natural thing to try to use this formula for is computing class numbers. Dirichlet could do this by obtaining a ﬁnite expression for L(1, χ) using Gauss sums. Let χ be a Dirichlet character mod m. We say χ is even if χ(−1) = 1 and χ is odd if χ(−1) = −1. By multiplicativity, these conditions are equivalent to the conditions χ(−n) = χ(n) and χ(−n) = −χ(n), respectively, justifying the terminology of even and odd. For k ∈ N ∪ {0}, deﬁne the k-th Gauss sum associated to χ to be τk(χ) = ∑ a∈(Z/mZ)× χ(a)e 2πiak/m. 56 From the deﬁnition, notice that the Gauss sums are something like “Fourier coeﬃcients” for χ. We will assume that χ is primitive, which means that χ is nontrivial and (regarded as a character of (Z/mZ)×) it does not come from a character of (Z/dZ)× for any proper divisor d of m. (If d|m, then any character of (Z/dZ)× gives a character of (Z/mZ)× just by composition with the mod d map (Z/mZ)× → (Z/dZ)×.) Exercise 3.13. Determine which Dirichlet characters mod m are primitive for m = 4, 8, 15. Find a formula for the number of primitive Dirichlet characters mod m for any m ∈ N. Proposition 3.4.8. Let χ be a primitive character mod m. Then L(1, χ) = { πiτ1(χ) m2 ∑ k∈(Z/mZ)× χ−1(k)k χ odd − τ1(χ) m ∑ k∈(Z/mZ)× χ−1(k) log sin kπ m χ even. Proof. For s > 1, the absolute convergence of the L-series for L(s, χ) implies we can write L(s, χ) = ∑ a∈(Z/mZ)× { χ(a) ∑ n∈mN+a 1 ns } . Note the characters for the additive group (Z/mZ) are just given by ωk(a) = e2πiak/m for 0 ≤ k ≤ m − 1. Hence the character orthogonality relations, namely that m−1∑ k=0 ωk(a)ω−1 k (n) = { m a ≡ n mod m 0 else, tell us we can rewrite the inner sum above as 1 m ∞∑ n=1 ∑m−1 k=0 ωk(a)ω−1 k (n) ns = 1 m ∞∑ n=1 ∑m−1 k=0 e2πi(a−n)k/m ns . Plugging this in to our ﬁrst equation gives L(s, χ) = 1 m m−1∑ k=0 { τk(χ) ∞∑ n=1 ω−nk ns } , for s > 1, where ω = e2πi/m. It is easy to see the Dirichlet series ∑∞ n=1 ω−nk ns converges for s > 1, and as s → 1+, one can check it approaches − log(1 − ω−k). (Plugging in s = 1 gives the Taylor expansion for − log(1 − z) evaluated at z = ω−k.) This gives L(1, χ) = − 1 m m−1∑ k=1 τk(χ) log(1 − ω−k). (Up to here, we do not need that χ is primitive, just nontrivial.) We again use some simple character theory to obtain that τk(χ) = { χ−1(k)τ1(χ) gcd(k, m) = 1 0 gcd(k, m) > 1. 57 Then L(1, χ) = − τ1(χ) m ∑ k∈(Z/mZ)× χ−1(k) log(1 − ω−k). We can replace k with −k in the sum and pull out a χ(−1) to get L(1, χ) = − χ(−1)τ1(χ) m ∑ k∈(Z/mZ)× χ −1(k) log(1 − ωk). Using the fact that log(1 − ωk) = log 2 + log sin kπ m + ( k m − 1 2 ) πi one can write L(1, χ) = − χ(−1)τ1(χ) m ∑ k∈(Z/mZ)× χ −1(k) ( log sin kπ m + kπi m ) . Note that the log 2 terms drop out since ∑ k χ−1(k) = 0 by orthogonality relations. One ﬁnishes the proof by checking that ∑ k χ−1(k) log sin kπ m = 0 if χ is odd and ∑ k χ−1(k)k = 0 if χ is even. This immediately gives a more useable version of Dirichlet’s class number formula. Though the version we give below comes from one additional simpliﬁcation—namely, since hK > 0, we only need a formula for the absolute value |L(1, χ)| to compute hK. By taking absolute values in the above proposition, one can get rid of the Gauss sum (which has absolute value √m). We omit the details of the complete simpliﬁcation, but in the end, one has the following. Theorem 3.4.9. (Dirichlet’s class number formula, second form) Let K = Q(√d) be the quadratic ﬁeld of discriminant ∆. Then hK =    1 2−χ∆(2) \f \f \f ∑ 1≤k<|∆|/2 χ∆(k)\f \f \f ∆ < 0, ∆ ̸= −3, −4 1 log η \f \f \f ∑ 1≤k<∆/2 χ∆(k) log sin kπ ∆ \f \f \f ∆ > 0. Here η denotes the fundamental unit of OK when ∆ > 0. Note with this form of the class number formula, we can eﬀectively compute the class number of any quadratic ﬁeld, and this is much easier than the approach via Minkowski’s bound (though in the real quadratic case one needs to determine the fundamental unit). Additionally, since χ∆(n) = 0 unless gcd(n, ∆) = 1, we may restrict the above sums to k relatively prime to ∆. Example 3.4.10. For d = −2, i.e., K = Q(√−2), we see ∆ = −8, χ∆(n) = { 1 n odd 0 n even, so hK = 1 2 |χ∆(1) + χ∆(3)| = 1. Exercise 3.14. Using the second form of the class number formula compute hK where K = Q(√d) for d = −5, −6, −7, −10, 2. 58 3.5 Postlude: Beyond Dirichlet In this chapter we have shown (modulo a few details) two landmark results in number theory: (i) Dirichlet’s theorem on primes in arithmetic progressions (ii) Dirichlet’s class number formula for quadratic ﬁelds both of which used Dirichlet L-functions. Subsequent key developments in number theory, general- izing the above, are (I) prime density theorems (II) class number formulas for general number ﬁelds. Let us ﬁrst discuss the density theorems. Let P denote the set of primes in N, and S ⊆ P. We say S has (natural) density‡ ρ if lim x→∞ | {p ∈ S : p < x} | | {p ∈ P : p < x} | = ρ. Of course any ﬁnite set of primes will have density 0, but inﬁnite sets of primes can have density 0 also. Using this notion, one can strengthen Dirichlet’s theorem on arithmetic progressions to the following: Theorem 3.5.1. Let m > 1 and a ∈ N such that gcd(a, m) = 1. Then the set of primes ≡ a mod m has density 1 ϕ(m) . In other words, the number of primes ≡ a mod m is the same for any a ∈ (Z/mZ)×. Or put another way, the primes are distributed equally among the invertible congruence classes mod m. For example, there are the same number or primes ≡ 1 mod 4 as there are ≡ 3 mod 4 (in the sense of density). This is one example of a statistical regularity that prime numbers satisfy, despite their apparent randomness. Proving this requires signiﬁcantly more sophisticated analysis of Dirichlet L-functions. Another way to think about distribution of primes is in terms of how they split in extensions K of Q. For example the above statement about the number of primes ≡ 1 mod 4 being the same as the number of primes ≡ 3 mod 4 can be recast as saying the number of primes with split in Q(i) is the same as the number of primes which are inert in Q(i). In fact the above theorem is essentially equivalent to the following Theorem 3.5.2. Let K be a quadratic ﬁeld. The set of primes in P which split in K has density 1 2 , as does the set of primes which remain inert in K. In other words, half the primes split in K and half remain prime in K, for any quadratic ﬁeld K. This is a special case of a very strong theorem, called the Chebotarev density theorem. This provides much stronger regularity results about distributions of primes than just considering congruence classes. We haven’t deﬁned everything we need at this point to state the complete theorem, but here is a (corollary of a) special case. Theorem 3.5.3. Let K be a number ﬁeld of degree n and S be the set of primes in P which split completely in K. Then S has density ρ ≥ 1 n . Further ρ = 1 n if and only if K/Q is Galois. ‡There is another weaker notion of density, now called Dirichlet density, that coincides with natural density if the natural density exists, which is essentially what Dirichlet originally considered. 59 A proof of Chebotarev density involves a more general kind of L-function called an Artin L- function. The basic idea is the following. Even though we have several Dirichlet characters mod m for a given m, the most important Dirichlet characters are those of the form χ∆ where ∆ is the discriminant of some quadratic ﬁeld K. On the other hand, if we start with some number ﬁeld K, there is a natural group associated to it, Gal(K/Q), and so one can look at the irreducible representations ρ of Gal(K/Q). Artin deﬁned an L-function L(s, ρ) associated to each such Galois representation ρ in order to study how the primes split in K/Q (or more generally, an arbitrary extension L/K). This L-function has some L-series expansion as well as an Euler product. If ρ is the trivial character of Gal(K/Q), then L(s, ρ) is essentially ζK(s) (they have the same Euler product expansions except at a ﬁnite number of primes). In the case where K is quadratic, then Gal(K/Q) has only 2 irreducible representations, both of dimension 1, i.e., both characters. If ρ is the nontrivial character of Gal(K/Q), then L(s, ρ) = L(s, χ∆) where ∆ = ∆K. If ρ0 is the trivial character, then L(s, ρ0) = L(s, χ0) where χ0 is the trivial Dirichlet character mod ∆. Hence the Artin L-functions are a generalization of (at least the most important cases of) Dirichlet L-functions. In this quadratic case we have L(s, ρ0)L(s, ρ) = L(s, χ0)L(s, χ) ≃ ζK(s)L(s, χ) = ζ(s), where ≃ means equal up to a ﬁnite number of factors in the Euler product. Similarly in the case of K a general number ﬁeld, we have ∏ ρ L(s, ρ) ≃ ζK(s) ∏ ρ nontrivial L(s, ρ) = ζ(s), where ρ runs over all irreducible representations of Gal(K/Q). One has the following generalization of Dirichlet’s class number formula. Theorem 3.5.4. (General class number formula) Let K be a number ﬁeld and {ρ} be the set of irreducible representations of Gal(K/Q). Then ∏ ρ nontrivial L(1, ρ) = lim s→1+ ζK(s) ζ(s) = 2r1(2π)r2R w√|∆K| hK, where r1 (resp. r2) is the number of real (resp. complex) embeddings of K, w is the number of roots of unity in K, and R is the regulator of K. The regulator is basically the volume of a certain lattice which comes up in Dirichlet’s units theorem. This provides a way to compute and study class numbers for number ﬁelds of degree greater than 2. In the case K = Q(ζp) where ζp is a primitive p-th root of unity, the class number formula provides a way to determine which primes are regular, i.e., for which p is gcd(p, hK) = 1. The signiﬁcance of this is that Kummer was able to prove Fermat’s Last Theorem in the case of regular prime exponents. In fact, Wiles proved Fermat’s Last Theorem by (more or less) proving the Taniyama–Shimura Conjecture, which is itself a statement about L-functions. To certain curves (irreducible smooth cubic curves) called elliptic curves E one associates an L-function L(s, E). (It can be given by an Euler product where the factor corresponding to the prime p is given by the number of points on E mod p.) On the other hand, one also has L-functions L(s, f ) attached to modular forms f , which 60 are certain periodic functions on the upper half plane. (The Euler product factors are given by the p-th Fourier coeﬃcients in a certain Fourier expansion.) The Taniyama–Shimura Conjecture is that every elliptic curve E corresponds to a modular form f in the sense that L(s, E) = L(s, f ). (Going from modular forms to elliptic curves is easier, and is known by work of Eichler and Shimura.) While the whole story is rather involved, let me just say that it is diﬃcult to directly compare el- liptic curves and modular forms, but one can associate to both of these objects certain 2-dimensional Galois representations. Thus to prove Taniyama–Shimura, one wants to show the Galois represen- tations coming from elliptic curves are contained in the set of Galois representations coming from modular forms. In a herculian endeavor, Wiles reduced (a suﬃcient part of) the Taniyama–Shimura conjecture to a theorem of Langlands and Tunnell (also a very diﬃcult result) which tells us every (odd) 2-dimensional complex Galois representation ρ : Gal(K/Q) → GL2(C) with solvable image corresponds to a modular form. Let me emphasize 2 points: 1) L-functions provide a practical (though not typically easy) way to compare objects of diﬀerent types: geometric objects (curves and varieties), algebraic/arithmetic objects (number ﬁelds/Galois representations) and analytic objects (modular/automorphic forms). 2) Galois representations and/or automorphic forms/automorphic representations provide a gen- eral framework for studying many number theoretic problems. For example, if K is an abelian extension of Q, i.e., K/Q is Galois with abelian Galois group, then all representations of Gal(K/Q) are 1-dimensional. Hence the theory of 1-dimensional Galois representations provides a way to study abelian extensions of Q, and contains the case of Dirichlet characters and everything we did in this chapter. The fact that 1-dimensional Galois representations correspond to “1-dimensional” automorphic forms is essentially class ﬁeld theory, which provides a way to understand the abelian extensions of a number ﬁeld, and is the crowning achievement of classical algebraic number theory. In this context, we can view the Taniyama-Shimura conjecture as a sort of “2-dimensional” analogue of class ﬁeld theory. A large amount of present work in modern number theory is studying higher-dimensional analogues of class ﬁeld theory (often called non-abelian class ﬁeld theory). In fact, this is essentially the area of research Ralf Schmidt, Ameya Pitale and I specialize in (and it is related to Alan Roche and Tomasz Prezbinda’s research as well). For example, in my thesis I proved that certain 4-dimensional Galois representations with solvable image correspond to automorphic forms. We will give a brief introduction to class ﬁeld theory and higher-dimensional analogues in Part III. 61 Part II The second part 4 Binary Quadratic Forms A binary quadratic form (over Z) is a binary (two variable) polynomial of the form Q(x, y) = ax2 + bxy + cy2, where a, b, c ∈ Z. This generalizes the forms x2 + ny2 that we looked at earlier, and we will see that looking at general binary quadratic forms will help us with the study of the forms x2 + ny2. Recall the two main questions about a quadratic form Q(x, y) are: (1) What numbers n are represented by Q, i.e., when is n = Q(x, y) solvable? (2) If n is represented by Q, what are the solutions to n = Q(x, y)? Using Gauss’s theory of composition of quadratic forms, we will be able to obtain very nice results on these problems, though it is surprisingly diﬃcult to give a complete explicit answer even to the ﬁrst question for an arbitrary binary quadratic form. It turns out the main obstruction to answering these questions completely is closely related to the class groups of quadratic ﬁelds. In light of this, there appears to be no elementary answer to (1) in general, though as we have seen with x2 + dy2 for d = 1, 2, 3, 5, 6, there is in special cases. Nevertheless, the theory one obtains in the end is quite beautiful and powerful. In regards to the second question, for a given n and Q, it is not hard to answer the question computationally. Further, using Gauss’s theory of composition, one can study the structure of the solutions in general. However to explicitly say what the solutions are requires some explicit computations. We will not focus so much on explicit computation, but rather general theory. In particular, we will study the following related question. (2’) What is the number rQ(n) of solutions to n = Q(x, y)? Note this is somehow weaker, but much more reasonable to ask in general, than (2), and it also contains (1) as a special case. Speciﬁcally, (1) just asks for which n is rQ(n) > 0. Modulo some obstruction coming from class groups, Dirichlet proved a beautiful formula for rQ(n), which (apart from this obstruction) answers (1) and (2’) at the same time. Now you might have wondered if rQ(n) is always ﬁnite. The way we deﬁned it in (2’), it is not: for example x2 − 2y2 = n has inﬁnitely many solutions for n = 1 because there are inﬁnitely many units in the ring of integer of Q( √2). However, one can still make sense of rQ(n) by counting solutions “up to units.” If one does this, there will always be ﬁnitely many (possibly zero) solutions to x2 − 2y2 = n for any n. However, for simplicity of exposition, we will restrict to forms ax2 + bxy + cy2 whose discrimi- nant b2 − 4ac < 0. These will correspond to imaginary quadratic ﬁelds and the number of solutions to ax2 + bxy + cy2 = n will be ﬁnite for any n, so we can get by with our naive deﬁnition of rQ(n). For the basic theory we will more or less follow a combination of [Cox], [Cohn] and [Buell]. For a nice historical treatment of quadratic forms, see [Scharlau–Opolka]. Much of the material is rather elementary, and in the interest of time, we will often not give complete proofs. Most treatments of binary quadratic forms do not cover Dirichlet’s formula for rQ(n), but [Dirichlet], [Landau] and [Hurwitz] are some sources. 62 4.1 Reduction theory Let Q(x, y) = ax2 + bxy + cy2 be a binary quadratic form (a, b, c ∈ Z). The discriminant of Q is ∆ = ∆Q = b2 − 4ac. This is a fundamental invariant of the form Q. Exercise 4.1. Show there is a binary quadratic form of discriminant ∆ ∈ Z if and only if ∆ ≡ 0, 1 mod 4. Consequently, any integer ≡ 0, 1 mod 4 is called a discriminant. We say two forms ax2 + bxy + cy2 and Ax2 + Bxy + Cy2 are equivalent if there is an invertible change of variables x′ = rx + sy, y′ = tx + uy, r, s, t, u ∈ Z such that a(x′)2 + bx′y′ + c(y′)2 = Ax 2 + Bxy + Cy2. Note that the change of variables being invertible means the matrix (r s t u ) ∈ GL2(Z). In fact, in terms of matrices, we can write the above change of variables as (x′ y′ ) = (r s t u ) ( x y ) . Going further, observe that (x y) ( a b/2 b/2 c ) ( x y ) = ax 2 + bxy + cy2, so we can think of the quadratic form ax2 + bxy + cy2 as being the symmetric matrix ( a b/2 b/2 c ) . It is easy to see that two quadratic forms ax2 + bxy + cy2 and Ax2 + Bxy + Cy2 are equivalent if and only if ( A B/2 B/2 C ) = τ T ( a b/2 b/2 c ) τ (4.1) for some τ ∈ GL2(Z). Note that the discriminant of ax2 + bxy + cy2 is −4disc ( a b/2 b/2 c ) . Lemma 4.1.1. Two equivalent forms have the same discriminant. Proof. Just take the matrix discriminant of Equation (4.1) and use the fact that any element of GL2(Z) has discriminant ±1. What this means then is that GL2(Z) acts on the space F∆ of binary quadratic forms of dis- criminant ∆ for any ∆. The importance of equivalent forms is in the following. We say Q(x, y) ∈ F∆ represents an integer n if Q(x, y) = n for some x, y ∈ Z. Lemma 4.1.2. Two equivalent forms represent the same integers. 63 Proof. This is obvious from the deﬁnition of equivalence—just make the change of variables! To prove some basic results, it will be helpful to have more reﬁned notions of equivalence and representations of integers. Deﬁnition 4.1.3. We say two forms ax2+bxy+cy2 and Ax2+Bxy+Cy2 are properly equivalent if they satisfy Equation (4.1) for some τ ∈ SL2(Z). In this case we will write ax2 + bxy + cy2 ∼ Ax2 + Bxy + Cy2. Recall SL2(Z) means 2×2 integer matrices of determinant 1, so GL2(Z) = SL2(Z)∪ ( 0 1 1 0 ) SL2(Z) since GL2(Z) consists of matrices of determinant ±1 In other words the quotient GL2(Z)/SL2(Z) consists of two cosets. We can take ( 1 0 0 1 ) and (0 1 1 0 ) as a set of representatives for these cosets. Clearly proper equivalence implies equivalence but the converse is not true. In fact, the notion of proper equivalence turns out to give a nicer theory as we will see below.∗ Example 4.1.4. Using the matrix (1 0 0 −1 ) we see ax2 + bxy + cy2 is always equivalent to ax2 − bxy + cy2. Sometimes they are properly equivalent (e.g., 2x2 ± 2xy + 3y2—see exercise below) and sometimes they are not (e.g., 3x2 ± 2xy + 5y2—see exercise below). Exercise 4.2. Determine the discriminants of Q1(x, y) = 2x2 + 2xy + 3y2, Q2(x, y) = 2x2 − 2xy + 3y2, Q3(x, y) = 3x2 + 2xy + 5y2 and Q4(x, y) = 3x2 − 2xy + 5y2. Show Q1 and Q2 are properly equivalent but Q3 and Q4 are not. (If you have trouble, see the theorem below.) Exercise 4.3. Fix a, b, c ∈ Z and let Q1(x, y) = ax2 + bxy + cy2 and Q2(x, y) = cx2 + bxy + ay2. (i) Show Q1 and Q2 are equivalent. (ii) If b = 0 show Q1 and Q2 are properly equivalent. (iii) Can you ﬁnd a, b, c so that Q1 and Q2 are equivalent by not properly equivalent? (One often calls this improper equivalence.) There are three types of binary quadratic forms Q(x, y) = ax2 + bxy + cy2 based on the sign of the discriminant ∆ = b2 − 4ac: 1) If ∆ = 0, then Q factors into two linear forms and we say Q is degenerate. Otherwise Q is nondegenerate. If ∆ = b2 − 4ac = 0, then Q(x, y) = ( √ax + √cy)2 and it is easy to see what numbers Q represents. Hence, one may just consider nondegenerate forms. 2) If ∆ < 0, then Q(x, y) has no real roots. In other words, considering x, y real, the graph of z = Q(x, y) in R3 never crosses the z = 0 plane. Hence Q(x, y) takes on either only positive values or negative values (and zero if x = y = 0). Accordingly we say, Q is either a positive deﬁnite form (e.g., x2 + y2) or a negative deﬁnite form (e.g., −x2 − y2). Note positive deﬁnite implies a, c > 0 and negative deﬁnite implies a, c < 0. (This is not if and only if: x2 − 100000xy + y2 is not positive deﬁnite.) Since −Q will be positive deﬁnite whenever Q is negative deﬁnite, it suﬃces to study the positive deﬁnite case. ∗For this reason, many authors use the term “equivalence of forms” to mean proper equivalence. If you consult other references, take note of this. 64 3) If ∆ > 0, then Q(x, y) has a real root and Q(x, y) takes on positive and negative values for x, y ∈ Z. In this case, we say Q is an indeﬁnite form. Note whenever a and c have diﬀerent sign (or one is 0), Q must be indeﬁnite. The theory of indeﬁnite forms is similar to the theory of (positive) deﬁnite forms, but there are some technical diﬀerences which make it more complicated. For simplicity, as well as the fact that positive deﬁnite forms tend to be of more interest, we will restrict our study to positive deﬁnite forms, though we will make some comments about what happens for indeﬁnite forms along the way. Hence, from now on, we assume all our forms are positive deﬁnite (in particular have discriminant ∆ < 0) unless otherwise stated. Deﬁnition 4.1.5. Let Q(x, y) = ax2 +bxy +cy2 be a (positive deﬁnite) form. We say Q is reduced if |b| ≤ a ≤ c and b ≥ 0 if a = c or a = |b|. Lagrange introduced the notion of reduced forms, and the point is the following. Theorem 4.1.6. Any (positive deﬁnite) form Q is properly equivalent to a unique reduced form. Proof. First we will show Q is properly equivalent to a reduced form ax2 + bxy + cy2. Suppose |b| is minimal such that there is a form R(x, y) = ax2 + bxy + cy2 with Q ∼ R. If |b| > a, then there exists m ∈ Z such that |2am + b| < |b|. But this implies R′(x, y) = R(x + my, y) = ax 2 + (2am + b)xy + (am 2 + bm + c)y2 ∼ R(x, y) = ax2 + bxy + cy2, so R′ ∼ Q has smaller xy coeﬃcient than ax2 + bxy + cy2, contradicting the choice of R. Hence |b| ≤ a and similarly |b| ≤ c. If necessary, we may replace R(x, y) with R(y, −x) = cx2 − bxy + ay2 to assume |b| ≤ a ≤ c. We also need to show we can take b ≥ 0 if a = c or a = |b|. If a = c, then the xy-coeﬃcient of either R(x, y) or R(y, −x) is nonnegative, so we may assume b ≥ 0. Similarly if b = −a, then R(x + y, y) = ax2 + ax + cy2, so again we may assume b ≥ 0 (in fact b > 0 since a > 0). This shows Q is properly equivalent to some reduced form R(x, y) = ax2 + bxy + cy2. Now we show that this R is unique. Suppose not, so Q ∼ S where S = dx2 + exy + f y2 is also reduced. Interchanging R and S if necessary, we may assume a ≥ d. Recall R ∼ S means we can write S(x, y) = R(rx + sy, tx + uy) = a(rx + sy) 2 + b(rx + sy)(tx + uy) + c(tx + uy)2 with r, s, t, u ∈ Z such that ru − st = 1. Since S clearly represents d and, we know R ∼ S, we know R represents d. Thus d = ax 2 0 + bx0y0 + cy2 0 ≥ a(x2 0 + y2 0) + bx0y0 ≥ a(x2 0 + y2 0) − a|x0y0| ≥ a|x0y0| for some x0, y0 ∈ Z. Since d ≤ a we must either have x0y0 = 0 or |x0y0| = 1. We will ﬁnish the proof in three cases. First suppose y0 = 0. Then d = ax2 0 together with d ≤ a means x2 0 = 1 and d = a. Then the x2-coeﬃcient of S(x, y) is ar2 + brt + ct 2 = R(r, t) = d = a. 65 Observe the minimum nonzero value of a reduced form R(x, y) is obtained precisely when (x, y) = (±1, 0), so we must have r = ±1, t = 0.† (Hence the minimum positive value of a reduced form is the x2-coeﬃcient, in this case a.) Further ru − st = ru = 1 implies u = r−1. Then the xy-coeﬃcient of S(x, y) is 2ars + bru = 2ars + b = b ± 2as = e. Since S is reduced, we have |e| ≤ d = a, but the only was this can happen is if s = 0 (which means R = S) or if b = a and s = ±1, which means e = −d, which we have excluded from our deﬁnition of reduced. This shows uniqueness when y0 = 0. Next suppose x0 = 0. Similar to the above, we see d = c and looking at the x2-coeﬃcient of S(x, y) one can conclude r = 0, s = t = ±1 as the second smallest minimum nonzero value of a reduced form R(x, y) is c and is obtained precisely when (x, y) = (0, ±1)§—see Remark below. This means the xy-coeﬃcient of S(x, y) must be b + 2cu. Then |e| = |b + 2cu| ≤ a ≤ c means either u = 0 (so R = S) or b = a = c and u = −1 in which case S(x, y) = ax2 − axy + ay2, which is not reduced. Finally suppose |x0y0| = 1. The above inequalities for d say a ≥ d ≥ a|x0y0| so a = d. The rest follows like the y0 = 0 case. Remark. It should be fairly obvious that for a reduced form R(x, y) = ax2 +bxy+cy2 the minimum nonzero value is obtained is a, which happen precisely when (x, y) = (±1, 0) (assuming a < c). It may be less clear that the second smallest nonzero value obtained is c, but both of these assertions follow from the simple exercise that R(x, y) ≥ (a − |b| + c) min(x2, y2). If you want, you can work this out on your own, but I’m not assigning it as homework. The above theorem tells us that if we want to study positive deﬁnite forms, it suﬃces to consider reduced forms. 4.2 The mass formula One of the most important early discoveries about quadratic forms is that they are better studied collectively than individually. Precisely, we make the following Deﬁnition 4.2.1. Let ∆ be a discriminant. The form class group Cl(∆) of discriminant ∆ is the set of proper equivalence classes of forms of discriminant ∆, i.e., Cl(∆) = F∆/ ∼. We will later see how to deﬁne a group structure on this, justifying the name. From the last section, we know we can take a set of representatives for Cl(∆) to be the set of reduced forms of discriminant ∆. Proposition 4.2.2. For any discriminant ∆, the number h(∆) := |Cl(∆)| < ∞. Proof. Note h(∆) is the number of reduced forms of discriminant ∆. If ax2 + bxy + cy2 is reduced of discriminant ∆, then |b| ≤ a ≤ c so 4b2 ≤ 4ac = b2 + ∆, i.e., 3b2 ≤ |∆|. In other words, there are only ﬁnitely many choices for b. Each choice for b determines ac, and the product ac determines a ﬁnite number of choices for a and c. †If a = c, the minimum nonzero value of the form is also obtained at (0, ±1), which corresponds to r = 0, t = ±1. Though we technically omit this case here, we can actually absorb this situation into our argument for the subsequent x0 = 0 case. §Again, technically if a = c, this actually gives the minimum nonzero value of the form, but this does not aﬀect our argument. 66 Using the notion of the class group, we can get a formula for the number of representations of n by a quadratic form of discriminant ∆. It will be convenient to consider proper representations. Deﬁnition 4.2.3. We say Q(x, y) ∈ F∆ properly represents n if n = Q(x, y) for some x, y ∈ Z with gcd(x, y) = 1. In this case, the solution (x, y) is called a proper representation of n by Q. Example 4.2.4. Let Q(x, y) = x2 + y2. Then Q represents 4 = 22 + 02 = Q(2, 0), but it does not properly represent 4 since gcd(2, 0) = 2 and (±2, 0) and (0, ±2) are the only solutions to Q(x, y) = 4. On the other hand even though 25 has an improper representation by Q, namely 25 = 52 + 02 = Q(5, 0) and gcd(5, 0) = 5, 25 also has a proper representation by Q: 25 = 32 + 42 = Q(3, 4) and gcd(3, 4) = 1. Hence we say Q(x, y) properly represents 25. Lemma 4.2.5. Q(x, y) represents n if and only if Q(x, y) properly represents m for some m|n such that n m is a square. Proof. (⇒) Suppose Q(x, y) represents n. If Q properly represents n, we can just take m = n and we are done. If not, then Q(x, y) = n for some x, y with gcd(x, y) = d > 1. Then Q(x/d, y/d) = Q(x, y)/d2 is a proper representation of m = n/d2. (⇐). Suppose Q(x, y) properly represents m where n = d2m. Then Q(dx, dy) = d2Q(x, y) = d2m = n. In other words, understanding what numbers are properly represented by Q tells us which num- bers are represented by Q, since the latter numbers are just squares times the former numbers. Let rQ(n) (resp. RQ(n)) denote the number of proper representations (resp. number of representations) of Q by n. Theorem 4.2.6. (Dirichlet’s mass formula, ﬁrst version) Let d > 1 be squarefree and set ∆ = −4d. Let Q1, Q2, . . . , Qh be a set of representatives for the form class group Cl(∆). Then rQ1(n) + rQ2(n) + · · · + rQh(n) = 2 ∏ p|n ( 1 + ( ∆ p )) where p runs over prime divisors of n > 0 and gcd(n, ∆) = 1. (This statement is from [Cox], but seems to be only be correct when d ≡ 1 mod 4.) There are many diﬀerent versions of the statement of this result, but the above one is the most applicable to the forms x2 + dy2 (with d squarefree). The proof of the mass formula is quite elementary, and we will omit it now, but John Paul will present a proof of the following version later this semester. Theorem 4.2.7. (Dirichlet’s mass formula, second version) Let ∆ be the discriminant of an imaginary quadratic ﬁeld, Q1, Q2, . . . , Qh a set of representatives for Cl(∆) and n > 0 such that gcd(n, ∆) = 1. Then RQ1(n) + RQ2(n) + · · · + RQh(n) = w ∑ k|n (∆ k ) , where w is the number of units in the ring of integers of Q( √∆). (Recall (∆ 1 ) = 1 for any ∆.) The ﬁrst version of the mass formula immediately gives 67 Corollary 4.2.8. Suppose ∆ = −4d with d > 1 squarefree. Then n > 0 relatively prime to ∆ is properly represented by some form of discriminant ∆ if and only if (∆ p ) = 1 for all primes p|n. The point is that while it is diﬃcult to study the numbers represented by an individual quadratic form in general, it is relatively easy to understand which numbers are represented by some quadratic form of discriminant ∆, for ﬁxed ∆. However, if the class number h(∆) = 1, then the above formulas are in fact formulas for a speciﬁc rQ(n) (resp. RQ(n)). Example 4.2.9. Consider Q(x, y) = x2 +y2. This has discriminant ∆ = −4, which is the discrimi- nant of the quadratic ﬁeld Q(i). If ax2 +bxy+cy2 is a reduced form of discriminant −4, then 3b2 ≤ 4 (see proof of Proposition 4.2.2), so b = 0 or b = ±1. Clearly b = ±1 makes b2 − 4ac = 1 − 4ac = −4 unsolvable, so b = 0. Then we must have ac = 1 so a = c = 1 (since we are just working with posi- tive deﬁnite forms). In particular the class number h(−4) = 1, and {Q} is a set of representatives for Cl(∆). Then the second version of Dirichlet’s mass formula reads RQ(n) = 4 ∑ k|n (∆ k ) , for n odd. If n = p is prime, then for p ≡ 1 mod 4 we have RQ(p) = 4 {( ∆ 1 ) + ( ∆ p )} = 4(1 + 1) = 8 and if p ≡ 3 mod 4 we have RQ(p) = 4 {( ∆ 1 ) + ( ∆ p )} = 4(1 − 1) = 0. In other words, x2 + y2 represents an odd prime p if and only if p ≡ 1 mod 4. So Dirichlet’s mass formula gives Fermat’s two square theorem as a special case. Moreover, it tells us two more things about x2 + y2. If p = x2 0 + y2 0 is odd, then x0 ̸= y0 so (±x0, ±y0) and (±y0, ±x0) are also solutions to Q(x, y) = p. This accounts for 8 solutions. Since RQ(p) = 8, this means up to sign and interchanging x and y, p = x2 0 + y2 0 is the only way to write p as a sum of 2 squares. Recall Brahmagupta’s composition tells us the product of two numbers of the form x2 + y2 is again of the form x2 + y2. Since 2 = 12 + 12 and p2 = p2 + 02 for any p, we know that n is of the form x2 + y2 if any p|n with p ≡ 3 mod 4 occurs to an even power in the prime factorization of n. In fact, these are the only n represented by x2 + y2, and we can actually prove this for n odd using the mass formula. Indeed, suppose n is odd and not of the above form, i.e., there is a prime p ≡ 3 mod 4 dividing n which occurs to an odd power in the prime factorization of n. Let D1 be the set of divisors k of n such that p occurs to an even power in the prime factorization of k, and let D2 = {pk : k ∈ D1}. Then D1 ∪ D2 are the divisors of n and D1 and D2 are disjoint. So RQ(n) = 4    ∑ k∈D1 ( ∆ k ) + ∑ pk∈D2 ( ∆ pk )  ‖  = 4 ∑ k∈D1 {( ∆ k ) + ( ∆ p )(∆ k )} = 0 since (∆ p ) = −1. 68 Exercise 4.4. Determine the reduced forms of discriminant ∆ for ∆ = −3, −8, −12, −20, −24. In particular, determine h(∆) for these ∆. Exercise 4.5. Use Dirichlet’s mass formula and Brahmagupta’s composition law to determine to which odd numbers are of the form x2 + 2y2. Exercise 4.6. Use Dirichlet’s mass formula, Brahmagupta’s composition law and (i) to determine to which numbers prime to 6 are of the form x2 + 3y2. 4.3 The form class group The idea behind Gauss’s composition of binary quadratic forms comes from Brahmagupta compo- sition, which says the product of two numbers of the form x2 + dy2 is again of the form x2 + dy2. Precisely, Brahmagupta’s composition law is (x 2 1 + dy2 1)(x2 2 + dy2 2) = (x1x2 − dy1y2)2 + d(x1y2 + x2y1)2 = X 2 + dY 2 where X = x1x2 −dy1y2, Y = x1y2 +x2y1. Gauss’s composition says that if Q1 and Q2 are quadratic forms of discriminant ∆, then there is a form Q3 of the same discriminant such that Q1(x1, y1)Q2(x2, y2) = Q3(X, Y ) where X, Y are some (homogeneous) quadratic expressions in x1, y1, x2 and y2. In other words, the product of a number of represented by Q1 with a number represented by Q2 is represented by Q3. We will write this composition as Q1 ◦ Q2 = Q3 and this will make Cl(∆) into a ﬁnite abelian group. However, the explicit determination of X, Y and the coeﬃcients of Q3 in Gauss’s composition is rather complicated and we will not describe it explicitly. Instead, we will approach Gauss com- position via ideals. But to get a feeling of how this composition can be done without ideal, we will brieﬂy explain Dirichlet’s approach to Gauss composition. Two forms Q1(x, y) = a1x2 + b1xy + c2y2 and Q2(x, y) = a2x2 + b2xy + c2y2 of discriminant ∆ are called united if gcd(a1, a2, b1+b2 2 ) = 1. If they are united, there exist B, C ∈ Z such that a1x2 + b1xy + c2y2 ∼ a1x2 + Bxy + a2Cy2 and a2x2 + b2xy + c2y2 ∼ a2x2 + Bxy + a1Cy2. Then the Dirichlet composition is deﬁned to be Q1 ◦ Q2 = a1a2x2 + Bxy + Cy2. To see that this follows our notion of what composition should be, observe (a1x 2 + Bxy + a2Cy2)(a2x2 + Bxy + a1Cy2) = a1a2X 2 + BXY + CY 2 where X = x1x2 − Cy1y2 and Y = a1x1y2 + a2x2y1 + By1y2. One can check that the latter form has discriminant ∆. Note that Dirichlet composition does not deﬁne composition of any two forms of discriminant ∆ (only united forms), but it is enough to deﬁne a composition (or multiplication) law on the proper equivalences classes Cl(∆). Now we will present the approach to Gauss’s composition via ideals. For simplicity we will work with forms whose discriminant ∆ is the discriminant of a quadratic ﬁeld. We say ∆ is a fundamental discriminant if ∆ = ∆K for some quadratic ﬁeld K. 69 Exercise 4.7. Let ∆ be the discriminant of Q(x, y) = ax2 + bxy + cy2. Show if ∆ is a fundamental discriminant, then Q is primitive, i.e., gcd(a, b, c) = 1. We remark that in working with quadratic forms, one often restricts to primitive forms, since any form is just a multiple of a primitive form. From now on, for the rest of this section we assume ∆ < 0 is a fundamental discriminant. Let K = Q(√∆) be the imaginary quadratic ﬁeld of discriminant ∆. Deﬁnition 4.3.1. Let I be an ideal of OK with ordered Z-basis {α, β}. Then the quadratic form associated to I is QI(x, y) = N (αx + βy)/N (I) = ax 2 + bxy + cy2. Here the ﬁrst norm is the norm of the element αx + βy ∈ OK, and the second is of course the ideal norm. Explicitly we have N (αx + βy) = N (α)x 2 + T r(αβ)xy + N (β)y2 so a = N (α)/N (I), b = T r(αβ)/N (I) and c = N (β)/N (I) in the deﬁnition above. Technically, the form QI depends upon the choice of an ordered Z-basis for I, but it is not too diﬃcult to see that a diﬀerent basis will lead to a properly equivalent form. Further QI has discriminant ∆. Example 4.3.2. Let ∆ = −4 so K = Q(i). Consider the ideals I = ⟨1, i⟩ = Z[i] and J = ⟨1 + i, 1 − i⟩ = (1 + i) of OK. Then QI(x, y) = N (x + iy)/N (I) = N (x + iy) = x2 + y2 and QJ (x, y) = N ((1 + i)x + (1 − i)y)/N (J ) = (2x2 + T r(2i) + 2y2)/2 = x2 + y2. So we see diﬀerent (but equivalent) ideals may lead to the same form. Exercise 4.8. Let ∆ = −20 so K = Q(√−5) and consider the ideals I = ⟨2, 1 + √−5⟩ and J = ⟨3, 1 + √−5⟩. Compute QI and QJ . Check they have discriminant ∆. Are they properly equivalent? Deﬁnition 4.3.3. Let Q(x, y) = ax2 + bxy + cy2 be a form of discriminant ∆. The ideal of OK associated to Q is IQ = (a, b − √∆ 2 ). Lemma 4.3.4. For any form Q, QIQ = Q. In other words, if we take the ideal IQ = (a, b− √∆ 2 ) associated to Q(x, y) = ax2 + bxy + cy2, then the form N (ax + b− √∆ 2 y)/N (IQ) associated to IQ equals Q. This lemma says the association I 7→ QI is a right inverse to Q 7→ IQ. The proof is elementary. However the converse is not true in general. What we can say is the following Lemma 4.3.5. Let I be an ideal of OK and let QI be the associated form. If J = IQI is the ideal associated to QI, then J ∼ I. 70 Then we can deﬁne multiplication of forms QI and QJ associated to ideals by QI ◦ QJ = QIJ . Upon showing the map ClK → Cl(∆) induced by I 7→ QI is surjective, this deﬁnes a multiplication on the form class group Cl(∆). Precisely, one gets Theorem 4.3.6. We have an isomorphism ClK ≃ Cl(∆) I ↣ QI IQ ↢ Q. Proofs may be found in [Cohn]. The proof are not diﬃcult, but we omit them in the interest of time. Exercise 4.9. Show x2 + −∆ 4 y2 is the identity of Cl(∆) if ∆ ≡ 0 mod 4 and x2 − xy + 1−∆ 4 y2 is the identity of Cl(∆) if ∆ ≡ 1 mod 4. Exercise 4.10. Show Q2(x, y) = ax2 − bxy + cy2 is the inverse of Q1(x, y) = ax2 + bxy + cy2. We know Q1 and Q2 are always equivalent by a transformation of determinant −1, namely (x, y) 7→ (x, −y). Deduce that Q1 ∼ Q2 if and only if Q1 has order 2 in Cl(∆Q1). Exercise 4.11. We say Q(x, y) = ax2 + bxy + cy2 is ambiguous if a|b. Show if Q is ambiguous, then Q has order 1 or 2 in Cl(∆Q). In fact it can be shown that Q has order ≤ 2 in the form class group if and only if Q ∼ Q′ for some ambiguous form Q′. In this case, the reduced form in the proper equivalence class of Q is either ambiguous (so b = a or b = 0) or of the form ax2 + bxy + ay2. Exercise 4.12. Determine all reduced forms of discriminant ∆ = −84. Use this to deduce Q(√−21) has class group isomorphic to V4 = C2 × C2. 4.4 Genus theory As in the previous section, let K be an imaginary quadratic ﬁeld of discriminant ∆. Dirichlet’s mass formula tells us which numbers are represented by some form in F∆, but it doesn’t tell us which numbers are represented by a speciﬁc form of discriminant ∆. The problem of distinguishing between forms (or rather equivalence classes of forms) of discriminant ∆ is not at all a simple problem in general, however there is a simple approach which gives a complete solution when the class group is isomorphic to Cr 2 . To motivate genus theory, let’s consider our favorite example. Example 4.4.1. Let ∆ = −20 so K = Q( √−5). The reduced forms of discriminant ∆ are Q1(x, y) = x2 + 5y2 and Q2(x, y) = 2x2 + 2xy + 3y2. Hence ClK ≃ Cl(∆) has order 2, so must be isomorphic to C2. From the exercises in the previous section, Q1 is the identity and Q2 has order 2 in Cl(∆). First let us determine the primes represented by Q1 and Q2. By the mass formula (ﬁrst version) we know RQ1(p) + RQ2(p) = rQ1(p) + rQ2(p) = 2(1 + ( ∆ p )) = { 4 p ≡ 1, 3, 7, 9 mod 20 0 p ≡ 11, 13, 17, 19 mod 20 71 for p ∤ ∆. (Note for p prime, RQ(p) = rQ(p) for any form Q.) Note that if RQ1(p) > 0 for p ∤ 20, then RQ1(p) ≥ 4 because if (x, y) is a solution to x2 + 5y2 = p, then so are (±x, ±y), which gives 4 diﬀerent solutions as long as p ̸= 5. In other words, any p ≡ 1, 3, 7, 9 mod 20 is represented either by Q1 or Q2, but not both. However, looking at what numbers relatively prime to 20 are of the form x2 + 5y2 mod 20 we see 3 and 7 are not possible. Similarly, simple computations show that 1 and 9 are not of the form 2x2 + 2xy + 3y2 mod 20. (In fact, it suﬃces to observe x2 + 5y2 does not represent 3 mod 4 and 2x2 + 2xy + 3y2 does not represent 1 mod 4.) Hence we have p is represented by { Q1 ⇐⇒ p = 5 or p ≡ 1, 9 mod 20 Q2 ⇐⇒ p = 2 or p ≡ 3, 7 mod 20 Now we can ask what integers n > 0 are represented by Q1. By the mass formula (ﬁrst form), we know if Q1 represents n, then n cannot be divisible by any prime p such that (∆ p ) = −1, i.e., any p ≡ 11, 13, 17, 19 mod 20. Write n = ∏ pei i · ∏ qfj j where each pi is represented by Q1 and each qj is represented by Q2. Gauss’s composition says n is represented by ∏i Qei 1 · ∏j Q fj 2 (where the multiplication here denotes Gauss composition). In other words, n is represented by Q1 if ∑ fj is even and n is represented by Q2 if ∑ fj is odd. We would like to say the above statement about which n’s are represented by Q1 and which are represented by Q2 is if and only if. Note that Q1 represents 0, 1, 2 mod 4 and 0, 1, 4 mod 5, where as Q2 represents 0, 2, 3 mod 4 and 0, 2, 3 mod 5. The only overlap here are the numbers ≡ 0, 2 mod 4 and ≡ 0 mod 5. Hence Q1 and Q2 cannot represent the same numbers, except possibly for numbers divisible by 10. The case where n is not prime to the discriminant is more subtle, and we will not prove this, but it turns out Q1 and Q2 never represent the same numbers, so the above characterization of numbers represented by Q1 (or Q2) is if and only if. Genus theory allow us to generalize the above example to separate (at least partially) represen- tations by diﬀerent forms of discriminant ∆. Deﬁnition 4.4.2. Let Q1, Q2 ∈ F∆. We say Q1 and Q2 are in the same genus if they represent the same values mod ∆. The principal genus is the genus containing the identity of the form class group. It is a theorem that Q1 and Q2 are in the same genus if and only if Q1 and Q2 represent the same values mod m for every m. What is more important for us however, is that forms in diﬀerent genera (the plural of genus) represent disjoint sets of numbers in (Z/∆Z)×. This is the content of the following proposition. Proposition 4.4.3. Regard χ∆ = (∆ · ) as a real character of (Z/∆Z)×. Let H = ker χ∆. Let Q0 (resp. Q) be in the prinicipal genus (resp. any genus) of F∆ and H0 (resp. HQ) denote the set of values in (Z/∆Z)× represented by Q0 (resp Q). Then H0 is a subgroup of H and HQ is a coset of H0 in H. (Note that H being the kernel of a group homomorphism, is a subgroup of (Z/∆Z)×.) For instance, in the above example, with Q0 = x2 + 5y2 and Q = 2x2 + 2xy + 3y2, we have H = {1, 3, 7, 9} ⊆ (Z/20Z)×, H0 = {1, 9} and HQ = {3, 7} = 3 {1, 9}. 72 Proof. Let n ∈ (Z/∆Z)×. If n is represented by a form of discriminant ∆, we have n ∈ H = ker χ∆ by Dirichlet’s mass formula. To see that H0 is a subgroup of H, observe it must be closed under multiplication by Gauss composition. To show it is closed under inversion, note by Exercise 4.9, we can assume Q0 = x2 − ∆ 4 y2 or x2 +xy + 1−∆ 4 y2. Using either Brahmagupta or Dirichlet composition, it is straightforward to explicitly check H0 is closed under inverses (and is nonempty—it contains 1). It follows from Gauss composition that HQ must be a translate of H0 in H. Since the cosets of H0 in H are disjoint, the integers n relatively prime to ∆ can only be represented by forms in a single genus of F∆. In particular, if we want to determine which numbers are of the form x2 + dy2 (say relatively prime to ∆ = −4d), we can at least say n are represented by some form in the principal genus. In particular, if, up to equivalence, x2 + dy2 is the only form in the principal genus, we can say exactly which primes are represented by x2 + dy2 by (i) the mass formula and (ii) considerations mod ∆. In this case, we say ∆ has one class per genus (see exercise below). Exercise 4.13. Let Q1, . . . , Qh denote representatives for Cl(∆). Using Gauss composition, show the number of Qi in a given genus is the same for each genus. Exercise 4.14. Pick representatives Q1, Q2 for Cl(−24). Determine what values Q1 and Q2 rep- resent mod 24. Using this with Dirichlet’s mass formula, determine all primes represented by Q1 and all primes represented by Q2. In particular, you should get a determination of all primes of the form x2 + 6y2. Now of course it’s natural to ask, for which discriminants ∆ do we have one class per genus? It’s clearly true if the class number h(∆) = 1. We know there are only 9 fundamental discriminants ∆ < 0 with class number 1 (Gauss’s class number problem), and this was easy to determine. Conversely, it is still an unsettled problem (also posed by Gauss) for which ∆ have one class per genus. It is conjectured that there are precisely 65 fundamental discriminants (and 101 arbitrary negative discriminants) ∆ < 0 with one class per genus. It is not too diﬃcult to show the following. Theorem 4.4.4. The principal genus of Cl(∆) consists of the subgroup of squares of Cl(∆). Corollary 4.4.5. ∆ has one class per genus if and only if Cl(∆) ≃ Cr 2 for some r ≥ 0. We remark that for a speciﬁc r, we can compute all imaginary quadratic ﬁelds with class group Cr 2 . There shouldn’t be any for large enough r, and this is the most diﬃcult part. In the case of one class per genus, one can always determine the primes of the form x2 + dy2 by simple congruence conditions. However, at least conjecturally, this only happens ﬁnitely many times (for negative ∆). In the rest of the cases, the determination of primes of the form x2 + dy2 is more complicated. Example 4.4.6. Consider Q0 = x2 + 14y2. This has discriminant ∆ = −56 and corresponds to the ﬁeld K = Q(√−14). There are 3 other reduced forms of discriminant −56, given by Q1 = 2x2 +7y2, Q2 = 3x2 + 2xy + 5y2 and Q3 = 3x2 − 2xy + 5y2. It is easy to check the (form) class group Cl(∆) ≃ C4 (see exercise below). One can show p = x2 + 14y2 if and only if (i) (−14 p ) = 1, and (ii) (x2 + 1)2 ≡ 8 mod p has a solution. See [Cox]. We will discuss this brieﬂy in the next chapter. Exercise 4.15. Check that Q2 ◦ Q2 ∼ Q3 ◦ Q3 ∼ Q1. Conclude Cl(−56) ≃ C4. 73 5 Non-unique factorizations In this chapter we brieﬂy discuss some aspects of non-unique factorization, ending with an applica- tion of quadratic forms (and more generally ideals) to factorization problems in rings of integers. 5.1 Principalization Let K be a number ﬁeld. Kummer approach to resolving the non-unique factorization of OK was essentially to work in a larger ring of integers R where every (nonzero nonunit) element of OK factors uniquely (up to order and units) into irreducibles in R. We can recast this approach in Dedekind’s language of ideals with the following notion. Deﬁnition 5.1.1. We say an ﬁnite extension L of K is a principalization ﬁeld for K, or prin- cipalizes K, if IOL is a a principal ideal of L for any ideal I of OK. Some authors instead say K capitulates in L. Proposition 5.1.2. Suppose L principalizes K. Leta be a nonzero nonunit in OK and write aOK =∏ pi be the prime ideal factorization of aOK in OK. Write piOL = (αi) for some αi ∈ OL. If a = ∏ βj is any irreducible factorization of a in OK, then each βj is, up to a unit of OL, a subproduct of the αi’s. In other words all irreducible factorizations of a in OK, comes from diﬀerent groupings of a single (not necessarily irreducible) factorization a = ∏ αj in OL. E.g., we may have something like a = (α1 · · · αi1) | {z } β1 (αi1+1 · · · αi2) | {z } β2 · · · (αik+1 · · · αm) | {z } βk+1 and any irreducible (or even non-irreducible) factorization of a in OK, just comes from a regrouping of the αi’s. Proof. Since L principalizes K, then for each i, we can write piOL = (αi) for some αi ∈ OL. (It is not necessarily true that each αi is irreducible.) Hence aOL = ∏(piOL) = ∏ (αi). On the other hand, aOK = ∏(βj) so each (βj) is a subproduct of the pi’s, say βj = pj1pj2 · · · pjk so βj = uαj1 . . . αjk for some unit u ∈ OL. Example 5.1.3. Let K = Q( √−5) and L = Q( √−5, √2). To show L principalizes K, it suﬃces to show (2, √−5)OL is principal since (2, √−5) ⊆ OK generates the class group of K. (Justify to yourself that this is suﬃcient.) Note that (2, √−5)2 = (2). On the other hand (2) = ( √2)2 in OL. Since (√2) is prime in OL, we must have ( √2) = (2, √−5)OL by the unique prime ideal factorization in OL. Thus L is a principalization ﬁeld for K. Let’s see how we can resolve the non-unique factorization 6 = 2 · 3 = (1 + √−5)(1 − √−5) 74 in OK using principalization. Recall the prime ideal factorization of (6) in OK is (6) = (2, 1 + √−5) 2(3, 1 + √−5)(3, 1 − √−5). One can check that (2, 1 + √−5)OL = ( √2) (we did this above) and (3, 1 + √−5)OL = ( √2 + √−10 2 ) (3, 1 − √−5)OL = ( √2 − √−10 2 ) (we’ll discuss this below). The above proposition says the irreducible factorizations of 6 in OK come from diﬀerent groupings of the factorization 6 = (√2 · √2) | {z } 2 ( √2 + √−10 2 · √2 − √−10 2 ) | {z } 3 = ( √2 · √ 2 + √−10 2 ) | {z } 1+ √−5 (√2 · √2 − √−10 2 ) | {z } 1−√−5 . Thus we see principalization provides an alternative viewpoint to the resolution of non-unique factorization in a ring of integers OK. Furthermore, we will see there are some advantages to using principalization (essentially Kummer’s approach) instead of ideal theory (Dedekind’s approach) by giving an application of principalization in the next section, even though these two approaches are more or less equivalent by Proposition 5.1.2. Now of course it is natural to ask when K has a principalization ﬁeld and how can we ﬁnd one. It turns out to be quite easy to answer. Proposition 5.1.4. Let I1, . . . , Ih be ideals of OK which generate the class group. If ej is the order of Ij in ClK, then we can write I ej j = (αj) for some αj ∈ OK. Then L = K( e1 √α1, . . . , eh √αh) is a principalization ﬁeld for K. The proof is immediate. It is worthwhile to remark that even though passing to OL resolves non-unique factorization in OK (in the sense of Proposition 5.1.2), it is not necessarily the case that any element of OL has a unique irreducible factorization in OL. In particular, there are examples of number ﬁelds K such that no ﬁnite extension L of K has class number 1. This was shown by Golod and Shafarevich in 1964 with the example of K = Q( √−3 · 5 · 7 · 11 · 13 · 17 · 19). One particular principalization ﬁeld is particularly noteworthy, and is important for studying primes of the form x2 + dy2. We say L/K is an abelian extension if it is Galois and Gal(L/K) is abelian. Further, L/K is unramiﬁed if every prime ideal p of OK is unramiﬁed in L. Deﬁnition 5.1.5. The Hilbert class ﬁeld HCF (K) is the maximal unramiﬁed abelian extension of K. An important component of class ﬁeld theory, which we hope to discuss in Part III, is the following result. 75 Theorem 5.1.6. H = HCF (K) is a well-deﬁned ﬁnite extension of K satisfying Gal(H/K) = ClK. Further H principalizes K. Example 5.1.7. Let K = Q. Then any nontrivial extension L of K must be ramiﬁed (since the |∆L| > 1 and any p|∆L ramiﬁes in L), hence there is only one unramifed extension of Q—namely Q itself. Thus HCF (Q) = Q. More generally if hK = 1, the above theorem tells us HCF (K) = K. Example 5.1.8. Let K = Q(√−5). If L/K is unramiﬁed, then p|∆L implies p|∆K = −20. One might be tempted to guess the Hilbert class ﬁeld of K is L = Q( √−5, √2) from Example 5.1.3. Indeed L/K is abelian with Galois group ≃ C2 ≃ ClK, but it is not unramiﬁed. The Hilbert class ﬁeld of K is Q( √−5, i). Exercise 5.1. Check HCF (Q( √−5)) = Q( √−5, i) using the deﬁnition and the theorem above. One use of the Hilbert class ﬁeld can be seen in the following result ([Cox]). Theorem 5.1.9. Let d > 0 be squarefree and d ̸≡ 3 mod 4. Let K = Q(√−d), H = HCF (K), and p be an odd prime not dividing ∆ = −4d. Write H = K(α) and let f (x) be the minimum polynomial for α. Then the following are equivalent: (i) p is represented by x2 + dy2 (ii) p splits completely in H (iii) (∆ p ) = 1 and f (x) has a root mod p. Exercise 5.2. Check the above theorem in the case of d = 5. 5.2 Counting non-unique factorizations In this section, we will show how one can use quadratic forms to determine and count the irreducible factorizations of an integer in OK, where K is a quadratic ﬁeld with class number 2. (In fact, one can treat the case of ClK ≃ Cr 2 by the same approach.) For simplicity, we will just go through the speciﬁc case of K = Q( √−5). Afterwards, we will discuss what happens in an arbitrary number ﬁeld, where one must use ideal theory to obtain the analogous result. In particular, this gives a qualitative and quantitative way to see that the class group ClK really does measure the failure of unique factorization in OK in a precise way. Both these results and this approach using principalization seems to be new (in fact I proved it just to show you how the class group measures the failure of unique factorization in OK!), see [Martin] for more details. For an introduction to other work on irreducible factorizations (in diﬀerent directions), see [Narkiewicz]. Let K = Q(√−5) so ∆ = ∆K = −20. Denote by C1 the set of principal ideals in OK and C2 the set of nonprinicpal ideals of OK. The reduced forms of discriminant ∆ are Q1(x, y) = x2 + 5y2 and Q2(x, y) = 2x2 + 2xy + 3y2. Let P0 denote the primes p ∈ N which are not represented by Q1 or Q2 and Pi denote the primes p ∈ N which are represented by Qi for i = 1, 2. Then P0 is the set of inert primes in K/Q, P1 is the set of primes p such that the ideal pOK factors into two principal ideals in OK, and P2 is the set of primes p such that pOK factors into two nonprincipal ideals of OK. 76 Set P ram i = {p ∈ Pi : p is ramiﬁed in K} , and P unr i = {p ∈ Pi : p is unramiﬁed in K} . Explicitly, we have P0 = {p : p ≡ 11, 13, 17, 19 mod 20}, P ram 1 = {5}, P unr 1 = {p : p ≡ 1, 9 mod 20}, P ram 2 = {2} and P unr 2 = {p : p ≡ 3, 7 mod 20}. If p ∈ P0 ∪ P1 then any prime ideal p of OK lying above p is in C1, and if q ∈ P2, then any prime ideal of OK lying above q is in C2. Speciﬁcally, if q = 2 ∈ P ram 2 , then qOK = r2 where r is the prime ideal (2, 1 + √−5) of OK, and if q ∈ P unr 2 then q = qq where q and q are distinct prime ideals of OK. Here q denotes the conjugate ideal of q in K/Q. Now let n > 1 and write the prime ideal factorization of nOK as (n) = p d1 1 · · · p dr r q e1 1 qe1 1 · · · qes s qes s rf , where each pi ∈ C1, qj ∈ C2 with conjugate qj, and the pi’s, qj’s, qj’s and r are all distinct. Since each pi = (πi) for some irreducible πi of OK, any irreducible factorization of n must contain (up to units) πd1 1 · · · πdr r . Thus it suﬃces to consider irreducible factorizations of n′ = n/(πd1 1 · · · πdr r ). Let qj be the prime in N such that qj lies above qj. Since qj is nonprincipal, we must have that qj ∈ P2, i.e., qj is represented by Q2. Note that we can factor the quadratic form into linear factors Q2(x, y) = ( √2x + √2 + √−10 2 y)( √2x + √ 2 − √−10 2 y) (5.1) over the ﬁeld L = K( √2). Hence, while qj is irreducible over OK (otherwise the prime ideal factors of qjOK would be principal), the fact that qj = Q2(x, y) for some x, y gives us a factorization qj = αjαj in L where αj = √2x + √2+ √−10 2 y and αj = √2x + √2− √−10 2 y. Since √2, √2±√−10 2 ∈ OL, we have αj ∈ OL (in fact irreducible). Since αj and αj are conjugate with respect to the nontrivial element of Gal(K/Q), the ideals (αj) ∩ OK and (αj) ∩ OK must be conjugate ideals of OK which divide qj, and hence in some order equal qj and qj. Thus, up to a possible switching αj and αj, we can write qjOL = (αj) and qjOL = (αj). Similarly rOL = ( √2). This means the following. If n′ = ∏ βi is any irreducible factorization of n′ in OK, we have ∏(βi) = (n′) = rf qe1 1 qe1 1 · · · q es s qes s = ( √2) f s∏ j=1 (αj) ej (αj)ej as ideals of OL. From Proposition 5.1.2, we know that each (βi) is a subproduct of the product of ideals on the right. In other words, to the irreducible factorizations of OK come from diﬀerent groupings of the factorization n′ = √2f s∏ j=1 αej j αej j . (5.2) Thus to determine the factorizations of of n′ in OK, it suﬃces to determine when a product of the αij is an irreducible element of OK. But this is simple! Note from the factorization of Q2(x, y) in (5.1), we see that each αij ∈ √2K. Hence the product of any two αi’s (or √2 · αj or √2 · √2) lies in K, and therefore OK, and must be irreducible since no individual αj ∈ OK. In other words, 77 the irreducible factorizations of n′ in OK are precisely what we get from grouping the terms on the right of (5.2) in pairs. What we have proved is the following. If {ai} is a collection of distinct objects, denote the multiset containing each ai with cardinality mi by { a (mi) i } . Let ηK(n) denote the number of distinct (up to order and units) irreducible factorizations of n in OK. Proposition 5.2.1. With notation as above (K = Q(√−5)), the irreducible factorizations of n in OK are, up to units, n = ∏ πi ∏ βk where each βk is a product of two numbers of the following types: √2, αj, or αj. In particular, ηK(n) is the number of ways we can arrange the multiset{√2 (f ), α(ej ) j , α(ej ) j } in pairs. The length of an irreducible factorization is the number of irreducibles occurring in the factor- iziation, with multiplicity. Corollary 5.2.2. Any two irreducible factorizations of n in OK have the same length. Hence the above result tells us about the structure of the irreducible factorizations in OK, not just their number. In fact, the above approach tells us how to explicitly obtain all irreducible factorizations of some n in OK. Example 5.2.3. Let n = 2 · 72 · 29. Here 29 ∈ P1 and 2, 7 ∈ P2. We have 2 = Q2(1, 0) = √2 · √2 7 = Q2(1, 1) = ( √2 + √2 + √−10 2 ) | {z } α (√2 + √2 − √−10 2 ) | {z } α 29 = Q1(3, 2) = 32 + 5 · 22 = (3 + 2√−5) | {z } π (3 − 2 √−5) | {z } π using the factorization of Q1 and Q2 into linear forms over OL. Then the above tells us the ir- reducible factorizations of n in OK are precisely those obtained from grouping the terms in square brackets on the right in pairs in the following factorization in OL: n = ππ [√2 · √2 · α · α · α · α] . Precisely, we have ηK(n) = 5 factorizations and they are explicitly given by n = ππ( √2√2)(αα)(αα) n = ππ( √2√2)(αα)(αα) n = ππ( √2α)( √2α)(αα) n = ππ( √2α)( √2α)(αα) n = ππ( √2α)( √2α)(αα). (Each product of two terms in OL in parentheses above is an irreducible element of OK. If you feel a need, you can compute these products explicitly, and check that they are all distinct factorizations in OK.) 78 Exercise 5.3. Determine all irreducible factorizations of n = 60 in OK = Z[ √−5]. Exercise 5.4. Let p ∈ N be prime and e ≥ 1. Determine a formula for ηK(pe) where K = Q( √−5). (It will depend on the value of p mod 20 as well as e.) Exercise 5.5. Let q1, . . . , qk be distinct primes in P unr 2 . Show ηK(q1 · · · qk) = (2k − 1)!! = (2k − 1)(2k − 3)(2k − 5) · · · 3 · 1. (Again K = Q( √−5).) We remark that there seems to be no simple algebraic formula for ηK(n) for general n, despite the fairly simple combinatorial description. However, there is a simple way to compute ηK(n) in terms of generating functions, a technique often used in combinatorics. We give it precisely in the following alternate version of the above proposition. Proposition 5.2.4. Let K = Q(√−5), L = K( √2) and n > 1. Write the prime ideal factorization of (n) in OK as (n) = ∏ p di i ∏ qej j , where each pi ∈ C1, qj ∈ C2 and the pi’s and qj’s are all distinct. Let πi ∈ OK and αj ∈ OL such that pi = (πi) and qjOL = (αj). Then the irreducible nonassociate factorizations of n are precisely n = u ∏ πdi i ∏ βk where u is a unit, each βk is a product of two (not necessarily distinct) αj’s and ∏ βk = ∏ αej j . In particular ηK(n) is the number of ways we can arrange the multiset { α(ej ) j } in pairs, i.e., the number of partitions of this multiset into sub-multisets of size 2. In other words, if the number of distinct qj’s is m, then ηK(n) is the coeﬃcient of ∏ xej j in the formal power series expansion of ∏i≤j 1 1−xixj in Z[[x1, x2, . . . , xm]]. In fact we stated this proposition for n ∈ OK, not just n ∈ Z, but it is no more diﬃcult to prove. Moreover, the description of ηK(n) in terms of coeﬃcients of a power series is essentially a tautology (use the geometric series expansion for 1 1−xixj and count). In general, one can prove an analogue of the above using (just) ideals, and the proof is just as simple as the case of K = Q(√−5) we did with quadratic forms. The advantage of the quadratic forms approach above however is one can explicitly write down the irreducible factorizations of a rational integer n in OK in terms of the explicit representations of p|n by quadratic forms of discriminant ∆K, provided ClK ≃ Cr 2 . See [Martin] for the details when r > 1. (The problem when ClK ≃ Cr 2 , which is tied to the one class per genus problem, is that if Q is a quadratic form which does not have order 2 in Cl(∆), then there is no number ﬁeld L such that Q factors into linear forms over OL. One can always factor Q into linear forms over some quadratic ﬁeld, since Q is just a quadratic polynomial, but the problem is that the coeﬃcients of these linear forms will only be algebraic integers when Q is ambiguous, hence of order 2 in Cl(∆).) In [Martin], we prove the following. Theorem 5.2.5. Let K be a number ﬁeld and ClK = {Ci}. Let n ∈ OK be a nonzero nonunit. Suppose the prime ideal factorization of nOK is (n) = ∏(i,j)∈T pij where the pij’s are (not necessarily distinct) prime ideals such that pij ∈ Ci, and T is some ﬁnite index set. Let Ki be a principalization ﬁeld for Ci, so pijOKi = (αij) for some αij ∈ OKi. Let L = ∏ Ki. Then the irreducible factorizations of n in OK are precisely the factorizations of the form n =∏ βl where ∏ βl ∼ ∏ αij in OL and each βl is of the form βl ∼ ∏(i,j)∈S αij in OL for S a minimal (nonempty) subset of T such that ∏(i,j)∈S Ci = I. (Here each βl is irreducible in OK.) In other words, all irreducible factorizations n in OK come from diﬀerent groupings of the factorization n ∼ ∏ αij in OL. Now a grouping of terms of this factorization in OL gives an 79 irreducible factorization in OK if and only if every group of terms gives an irreducible element of OK (possibly up to a unit in OL). A product of αij’s gives an element of OK if and only if the corresponding product of ideal classes Ci is trivial in ClK, and this element of OK will be irreducible if and only if no proper subproduct of the corresponding ideal classes is trivial. It should be clear that this theorem gives a precise way that the class group measures the failure of unique factorization in OK. In particular, the larger the class group, the more complicated the structure of the irreducible factorizations of an element can become. Corollary 5.2.6. Let K be a number ﬁeld and ClK = {Ci}. Let n ∈ OK be a nonzero nonunit. Suppose (n) = ∏(i,j)∈T p eij ij , where the pij’s are distinct prime ideals, each pij ∈ Cj and T is some index set. Let U be the multiset U = { (i, j)(eij ) : (i, j) ∈ T }. Then ηK(n) is the number of ways one can partition the multiset { xeij ij } into minimal subsets V such that ∏xij ∈V Ci = I. Exercise 5.6. Deduce the following result of Carlitz: Let K be a number ﬁeld. We say OK is half-factorial if every irreducible factorization of a given n ∈ OK has the same length. Then OK if half-factorial if and only if hK ≤ 2. In general, one deﬁnes the elasticity ρK of OK to be maxn∈OK ρK(n) where ρK(n) is the maximum ratio of lengths of two irreducible factorizations of n in OK. Similarly, one can use our theorem above to determine ρK in terms of the structure of the class group (it depends upon more than just hK). See [Narkiewicz] for complete statements (needless to say, proved there without recourse to our theorem). 80 Part III Part III In this, the ﬁnal part of the course, we will introduce the notions of local and global viewpoints of number theory, which began with the notion of p-adic numbers. (p as usual denote a rational prime.) The basic idea is that many problems in number theory can be treated by looking at solutions mod m. We saw, say with the example of x2 + y2, that we can rule out any number ≡ 3 mod 4 being of the form x2 + y2. On the other hand, suppose, for a given n, we knew a mod m solution to x2 + y2 ≡ n mod m for each m. Hasse’s idea was that if these local solutions (solutions mod m for each m) are “suﬃciently compatible,” then we can paste them together to actually construct a global solution in Z. In fact it suﬃces to consider the cases where m = pe is a prime power. What it means for the solutions to be suﬃciently compatible means is the following. Consider x2 + y2 = 244. A solution to this in Z would mean in particular we have solutions mod 2 and mod 4. Here are two: x2 + y2 ≡ 12 + 12 ≡ 0 mod 2, x2 + y2 ≡ 0 2 + 22 ≡ 0 mod 4 In the mod 2 solution x, y must both be odd, but in the mod 4 solution both x and y are even, so there is no way to paste together these local solutions to get a solution in integers, hence we say they are not compatible. Essentially what the p-adic integers Zp are, are the elements of (Z/pZ) × (Z/p2Z) × (Z/p3Z) × · · · which are compatible in the above sense. In other words, a p-adic integer x = (xn) gives a congruence class xn mod pn for each n such that xn+1 ≡ xn mod pn. We can form the ﬁeld of fractions of the p-adic integers to obtain the ﬁeld of p-adic number Qp. The advantage of this is we can use ﬁeld theory, which is much stronger than ring theory, whereas we couldn’t do this with a single Z/pnZ, since Z/pnZ doesn’t embed in a ﬁeld as there are nontrivial zero divisors (unless n = 1). (Even though Zp “contains” all of these Z/pnZ’s, it turns out to be an integral domain.) After discussing the p-adic numbers, we will discuss applications to quadratic forms in several variables. This naturally leads into the topic of modular forms, which is slated to be taught next year, and we will not discuss them in any detail here. We will follow this with an introduction to adéles, which is considered a global way of studying things. Just like the p-adic numbers put together information mod pn for all n, the adèles AQ put together Qp for all p. Moreover, one can do all this over an arbitrary number ﬁeld. Namely, for any number ﬁeld K and prime ideal p of OK, one can deﬁne the ﬁeld Kp of p-adic numbers. Then one deﬁne the adéles AK of K, which is essentially a product of all the Kp’s. It turns out that AK provides an alternative way to study the class group ClK as well as class ﬁeld theory, which studies the abelian extensions of K. The adelic picture is important for several reasons, not least of which is it allows for a vast generalization of class ﬁeld theory, known as Langlands’ program, or non-abelian class ﬁeld theory. As a special case, Langlands’ program (together with Wiles’ famous work) includes the famous 81 Taniyama–Shimura(–Weil) correspondence between elliptic curves and modular forms, which is famous for proving Fermat’s Last Theorem. While (abelian) class ﬁeld theory is more or less considered a closed book now (which is of course not to say that everything is known about abelian extensions), the Langlands’ program is only in a toddler stage, and lies at the heart of the research of several faculty members here. The Langlands’ program and the generalized (or grand) Riemann hypothesis are the two most important outstanding problems in both number theory and the theory of automorphic forms/representations. Time permitting, we will give a brief introduction to abelian class ﬁeld theory and Langlands’ program. The second semester of next year’s Modular Forms course should contain a more detailed introduction to Langlands’ program. 6 p-adic numbers Throughout this chapter p will denote a ﬁxed prime number of N. In the introduction to Part III, we brieﬂy described the p-adic integers are elements in (an) ∈ (Z/pZ) × (Z/p2Z) × (Z/p3Z) × · · · which are compatible in the sense that the natural map Z/pn+1Z → Z/pZ maps an+1 to an. There are several diﬀerent ways to describe the p-adic numbers, which were ﬁrst introduced by Hensel at the end of the 1800’s. Before we proceed into the formalities of the p-adic numbers, it may be interesting to describe Hensel’s original viewpoint of the p-adic numbers. The basic idea came from an analogy with algebraic geometry. The basic premise of modern mathematics is that to study some object X, it is helpful to study functions on X. In particular, to study the complex numbers C, one may choose to study the polynomial ring C[x]. (The space C is the set of points, and the ring C[x] is called the coordinate ring of C.) One of the early observations in complex algebraic geometry was that the set of maximal ideals of C[x] is just the set of (principal) ideals generated by a linear polynomial of the form x − p0 for some point p0 ∈ C. In other words, there is a bijection between C and the maximal ideals of C[x], given by a point p0 ∈ C corresponds to the ideal of all polynomials which vanish at p0. Further if f (x) ∈ C[x], then we have the map C[x] → C[x]/(x − p0) ≃ C f (x) 7→ f (p0), i.e., to mod out by a maximal idea (x − p0) in C[x], just means substituting in x = p0 for a polynomial f (x) ∈ C[x], i.e., this “mod (x − p0)” map C[x] → C just sends a polynomial f (x) to its value at a point p0. Now instead, let’s try to imagine Z in place of C[x] as a coordinate ring. What should the space of points be? Well, in analogy with the above, a good candidate is the set of maximal ideals of Z, i.e., the set of all nonzero prime ideals (p) of Z. In other words, if we consider the space P = {pZ : p ∈ N} of points as the natural number primes, then the coordinate ring “P[x],” i.e., the “polynomials on the space P,” are just the integers n ∈ Z. How do we evaluate a “polynomial” n ∈ Z on a point p ∈ P? Just consider the map Z → Z/pZ n 7→ n mod p. 82 In other words, the analogue of polynomials in one variable over C, when we replace C with the set of primes P, are the functions on P given by integers n ∈ Z such that n(p) = n mod p. One obvious diﬀerence is that for any p0 ∈ C, the space C[x]/(x − p0) ≃ C, so all functions in the coordinate ring C[x] really map into C. But in the case of p ∈ P, the spaces Z/pZ are all non-isomorphic, so it’s harder to think of n(p) = n mod p ∈ Z/pZ as a function, since its image lands in a diﬀerent space (Z/pZ) for each p. To go further with this analogy, one can ask about a notion of derivatives of the functions n(p) = n mod p. Observe for a polynomial f (x) ∈ C[x], we can always write f (x) in the form f (x) = a0 + a1(x − p0) + a2(x − p0) 2 + · · · + ak(x − p0)k where each ai ∈ C, and the m-th derivative at p0 is just given by m!am. Similarly, for any n ∈ Z, we can write n in the form n = a0 + a1p + a2p 2 + · · · + akpk where 0 ≤ ai < p, so the m-th derivative at p should be m!am. Since power series are such a powerful tool in function theory, Hensel wanted to apply the tech- niques of power series to number theory. If we work with more general functions than polynomials in C[x], namely analytic functions at p0, we can write them as power series about x = p0 f (x) = a0 + a1(x − p0) + a2(x − p0)2 + · · · ∈ C[[x]] (ai ∈ C). Analogously, we can consider formal power series in a prime p ∈ P given by n = a0 + a1p + a2p 2 + · · · ∈ Zp (0 ≤ ai < p). These formal power series are the p-adic integers Zp. (Note Zp contains Z by just restrict to ﬁnite sums, i.e., “polynomials” in p.) Even more generally than analytic functions at p0, one often considers meromorphic functions on C which may have a pole (go to inﬁnity) at p0, e.g., the Riemann zeta function ζ(s) has a pole at s = 1. These functions still have a series expansion at p0, but it needs to start with some negative power of x − p0. These are called Laurent series, and explicitly are of the form f (x) = a−k(x − p0)−k + a1−k(x − p0) 1−k + · · · + a0 + a1(x − p0) + a2(x − p0)2 + · · · ∈ C((x)) (ai ∈ C). Analogous to this, one can take formal power series in p with coeﬃcients between 0 and p with a ﬁnite number of negative terms n = a−kp −k + a1−kp 1−k + · · · + a0 + a1p + a2p 2 + · · · ∈ Qp (0 ≤ ai < p), and this will give us the p-adic numbers Qp. (Note Qp contains all rational numbers with denomi- nator a power of p.) This analogy may seem a little far fetched, and you might wonder if Hensel had one too many beers at this point, but the usefulness of the p-adic numbers allows us to recognize his ideas as brilliant, as opposed to crazy talk. We summarize the analogy in the table below, though to fully appreciate it, one should be familiar with complex function theory. Nevertheless, even if you are not, it may be helpful to refer back to this table after learning more about Zp and Qp. We can now explain why Zp and Qp are called local objects, speciﬁcally, local rings and local ﬁelds. A power or Laurent series expansion of some function f (x) around a point p0 may only 83 Table 3: Complex functions vs. p-adic numbers C—space of points P = {p}—set of primes C[x]—polynomials over C Z—“polynomials” over P f (x) = a0 + a1(x − p0) + · · · ak(x − p0)k n = a0 + a1p + · · · + akpk functions analytic at p0 Zp—p-adic integers f (x) = ∑∞ i=0 ai(x − p0)i n = ∑∞ i=0 aipi functions meromorphic at p0 Qp—p-adic numbers f (x) = ∑∞ i=−k ai(x − p0)i n = ∑∞ i=−k aipi converge nearby p0, even though the function may be deﬁned (as a meromorphic function) on all of C. Since a power series is essentially meaningless outside its radius of convergence, power series in general only give local information about functions f (x) (namely, near p0). Similarly, the elements of Zp and Qp will give “local” information about the prime p ∈ P. The main references I will be using for this chapter are [Neukirch] and [Serre], as these were the books I originally learned the theory from, though most if not all of this material may be found in many books on algebraic number theory, and of course any book speciﬁcally on p-adic numbers, of which there are a few. There is also a nice analytic/topological presentation in [Ramakrishnan–Valenza], which leads into adèles. 6.1 Deﬁnitions Fix a prime p ∈ N. Deﬁnition 6.1.1. The set of p-adic integers, denoted Zp, are the formal power series of the form ∞∑ i=0 aip i = a0 + a1p + a2p2 + · · · , 0 ≤ ai < p. Observe the series ∑∞ i=0 aipi converges if and only if it is ﬁnite, i.e., if ai = 0 for all i > k for some k. In this case, this ﬁnite sum is an integer, and we can get any non-negative integer this way. Accordingly we will view N ∪ {0} ⊆ Zp. We can abbreviate this representation as an “inﬁnite” base p representation of a “number:” ∞∑ i=0 aipi = · · · a2a1a0 Note if the series is in fact ﬁnite, then this really is the base p representation of the corresponding integer: akak−1 · · · a2a1a0| {z } base p = a0 + a1p + a2p2 + · · · + akp k. Naively, we can think of a p-adic integer x as just a sequence (ai)∞ 0 of numbers between 0 and p, but the p-adic numbers will have more structure than just this. We deﬁne addition and multiplication on Zp by just extending the usual addition and multiplication on base p representations of positive integers. 84 Example 6.1.2. Let x = 1 + 4 · 5 + 3 · 52, y = ∑∞ i=0 1 · 5i ∈ Z5, and z = 4 + 2 · 52 + ∑∞ i=3 4 · 5i. We can compute the sums · · · 0000341 x + · · · 1111111 y · · · 1112002 x + y · · · 0000341 x + · · · 4444104 z · · · 0000000 x + z · · · 1111111 y + · · · 4444104 z · · · 1110220 y + z and we can compute a product · · · 1111111 1 × · · · 1111111 + · · · 4444440 40 × · · · 1111111 + · · · 3333300 300 × · · · 1111111 · · · 4444401 x · y Since x + z = · · · 00000, we may identify x with 396 and z with −396 in Z5. It is easy to see in general, that for any x ∈ Zp, the additive inverse of x (the additive zero is of course · · · 00000 ∈ Zp) also lies in Zp. Hence we may regard Z ⊆ Zp. Exercise 6.1. Find the 7-adic representations for −7 and −121. Exercise 6.2. Let x = 64 ∈ Z7 and y = 4 + 6 · 7 + ∑∞ i=2 2 · 7i ∈ Z7. Compute x + y and x · y. Exercise 6.3. What are the p-adic representations for −1 and 1 1−p for arbitrary p? Proposition 6.1.3. We have that Zp is a ring with Z as a subring. The proof of this is elementary—it is just base p arithmetic with inﬁnite sequences—but we will see another justiﬁcation for this from a more algebraic description below. The statement about Z being a subring just means that with the identiﬁcation of Z ⊆ Zp described above, the addition and multiplication deﬁned on Zp are compatible with those on Z, which is evident from the way we deﬁned them. Speciﬁcally, let ϕn denote the natural maps · · · −→ Z/pn+1Z ϕn −→ Z/pnZ −→ · · · ϕ2 −→ Z/p2Z ϕ1 −→ Z/pZ Deﬁnition 6.1.4. The projective limit (or inverse limit) of Z/pnZ (with respect to ϕn) as n → ∞ is lim ←− Z/pnZ = { (xn) ∈ ∏ n Z/pnZ : ϕn(xn+1) = xn for all n ≥ 1 } In other words an element (xn) of lim ←− Z/pnZ is a sequence of elements xn ∈ Z/pnZ which is compatible in the sense that xn+1 ≡ xn mod Z/pnZ. (Recall a direct or injective limit, written lim −→, is for when we have a sequence of objects which are successively included in each other. A projective limit is for when we have a sequences of objects which are successive quotients (or projections) of 85 each other. This is the natural way to construct an object X, in this case lim ←− Z/pnZ, such that each Z/pnZ is a quotient of lim ←− Z/pnZ. It’s of course not the smallest space X such that every Z/pnZ is a quotient of X—that would be Z—but it is certainly just as natural, if not more so. If you doubt this, try to ﬁgure out how you could construct Z from the set of Z/pnZ’s.) The reason for the compatibility requirements was already described in the introduction to Part III. To state this reason a little diﬀerently, the idea was that we want to use Zp to study solutions to equations in Z. If we just look at ∏n Z/pnZ, it’s not very meaningful. Note that any element (xn) ∈ Zp is the limit of integers xn ∈ Z, whereas a non-compatible sequence is not a limit of integers. For instance, the sequence (1, 2, 3, 0, 0, 0, . . .) in ∏ Z/pnZ Proposition 6.1.5. We have a bijection Zp → lim ←− Z/pnZ ∞∑ n=0 anpn 7→ (sn)∞ n=1 where sn is the (image in Z/pnZ) of the n-th partial sum sn = a0 + a1p + a2p2 + · · · + an−1p n−1. From now on we use this bijection to identify Zp with lim ←− Z/pnZ, and sometimes write our p-adic integers as formal power series expansions in p, and sometimes write them as sequences in the projective limit of the Z/pnZ’s. There are some nice features of the projective limit approach. First, there is a natural map from Z → Zp = lim ←− Z/pnZ given by a 7→ (a mod p, a mod p 2, a mod p 3, . . .) ∈ ∏ n Z/pnZ for any a ∈ Z. Further we can just deﬁne addition of and multiplication of elements of ∏ Z/pnZ. Then it is immediate that Zp is a ring with Z as a subring, i.e., the proof of Proposition 6.1.3 is immediate. (We did not actually check that the two deﬁnitions of addition and multiplication match, but this is certainly true when we restrict to the subring Z, since + and · are the standard operations then. Since we can approximate any x ∈ Zp as a limit of xn ∈ Z, a density argument shows + and · extend in a unique way to Zp, so the two deﬁnitions of + and · agree.) Example 6.1.6. Suppose p = 2. Consider n = 75 ∈ Z. As a power series, we can write n = 1 · 1 + 1 · 2 + 1 · 23 + 1 · 26. Alternatively, we can write n = (1 mod 2, 3 mod 4, 3 mod 8, 11 mod 16, 11 mod 64, 75 mod 128, 75 mod 256, 75 mod 512, . . .) as a sequence in the projective limit of Z/2nZ. Note in the projective limit version, it’s easier to write down −n, namely −n = (−1, −3, −3, −11, −11, −75, −75, −75, −75, . . .). The usefulness of p-adic integers is that the precisely capture the answer of when an equation is solvable mod pn for all n. 86 Proposition 6.1.7. Consider a polynomial F (x1, . . . , xk) ∈ Z[x1, . . . , xk]. Then F (x1, . . . , xk) ≡ 0 mod p n is solvable for all n if and only if F (x1, . . . , xk) = 0 is solvable in Zp. Proof. (⇐) Suppose we have a Zp-solution F (x,1 , . . . , xk) = 0. Write xi = (xi1, xi2, xi3, . . .) ∈∏ Z/pnZ. Then F (x1n, . . . xkn) ≡ 0 mod pn for each n. (⇒) Let x1n, . . . xkn ∈ Z/pnZ be a solution to F (x1n, . . . , xkn) ∈ Z/pnZ for each n. One would like to say that xi = (xin) ∈ Zp , but the (xin)’s will not in general be compatible. Nevertheless, we can construct a compatible sequence of solutions. By the (inﬁnite) pigeonhole principle, there is a (y11, . . . , yk1) ∈ (Z/pZ)k such that (x1n, . . . , xkn) ≡ (y11, . . . , yk1) mod p for inﬁnitely many n. Then F (y11, y21, . . . , yk1) ≡ 0 mod p since any of the (x1n, . . . , xkn) above give a solution mod p. Similarly, there is a (y12, . . . , yk2) ∈ (Z/p2Z)k such that (y12, . . . , yk2) ≡ (y11, . . . , yk1) mod p and (x1n, . . . , xkn) ≡ (y12, . . . , yk2) mod p 2 for inﬁnitely many n. Again we have F (y12, y22, . . . , yk2) ≡ 0 mod p2. We continue this ad inﬁnitum, and set yi = (yin) ∈ ∏n Z/pnZ, so in fact each yi ∈ Zp. Then we have F (y1, . . . , yk) = 0 ∈ Zp since this expression must be 0 in each component of Zp = lim ←− Z/pnZ. In many cases, one can reduce checking the solvabilty of an equation mod pn to simply solvability mod p. Here is a special case. Lemma 6.1.8. (Hensel) Let f (x) ∈ Z[x], p a prime and n ∈ N. If p = 2, we assume n ≥ 2. Suppose f (a) ≡ 0 mod pn for some a ∈ Z, but p ∤ f ′(a). Then for each n ≥ 1 there is an b ∈ Z/pn+1Z such that f (b) ≡ 0 mod pn+1 and b ≡ a mod pn. Starting with n = 1 (or 2 if p = 2) applying this inductively, we see that if we have a root a of a one-variable polynomial f (x) mod p (or mod 4), it lifts to a root an mod pn for all n, provided f ′(a) ̸= 0. In fact, these roots an can be chosen to be compatible so that (an) ∈ ∏ Z/pnZ lies in Zp. Here f ′(x) is the formal derivative of f (x), in other words the derivative as a real polynomial. Proof. The Taylor series for f (x) (regarded as a function of a real variable x) about x = a is f (x) = f (a) + f ′(a)(x − a) + f ′′(a)(x − a)2 2! + · · · + f (d)(a)(x − a)d d! 87 where d is the degree of f (x). Suppose we take x of the form x = a + pny. Then we have f (x) = f (a) + f ′(a)pny + f ′′(a)p2ny2 2! + · · · + f (d)pdnyd d! By induction on j, it is easy to see for j ≥ 2 (or j ≥ 3 if p = 2) that pn+1 divides pjn j! . In other words, we can have f (x) ≡ f (a) + f ′(a)p ny mod p n+1. Since f (a) ≡ 0 mod pn, we can write f (a) = a0pn so f (x) ≡ a0pn + f ′(a)yp n ≡ (a0 + f ′(a)y)pn mod p n+1. Since f ′(a) is nonzero mod p, we can choose 0 ≤ y < p such that a0 + f ′(a)y ≡ 0 mod p, so f (x) ≡ 0 mod pn+1 and we can take b = x. There are several ways in which one can generalize Hensel’s lemma, but we will not worry about these here. Exercise 6.4. Let a = a0 + a1p + a2p2 + · · · ∈ Zp. Show a is a unit in Zp if and only if a0 ̸= 0. Exercise 6.5. Show Zp is an integral domain, i.e., there are no zero divisors. Exercise 6.6. Show x2 = 2 has a solution in Z7. Exercise 6.7. Write 2 3 as a 5-adic integer. Since Zp has no zero divisors, it has a ﬁeld of fractions. By Exercise 6.4, we know the only nonzero elements of Zp which are not invertible (w.r.t. multiplication) are the elements divisible by p, hence the ﬁeld of fractions is obtained by adjoining 1 p to Zp, i.e., the ﬁeld of fractions of Zp is Zp[ 1 p ]. Note that we can write the elements of Zp[ 1 p ] uniquely in the form p−da where a ∈ Zp and d ≥ 0. If a = a0 + a1p + a2p2 + · · · , we can write p−da = a0p−d + a1p1−d + a2p 2−d + · · · = ∑ n≥−d a ′ np n (6.1) where a′ n = an+d. Thus we may deﬁne the p-adic numbers as formal series starting with some ﬁnite negative power of p (called a formal Laurent series in p). Deﬁnition 6.1.9. The p-adic numbers Qp is the set of formal Laurent series Qp =    ∑ n≥−d anp n : 0 ≤ an < p, d ≥ 0  ‖  . We identify Qp with the ﬁeld of fractions Zp[ 1 p ] of Zp as in (6.1). Exercise 6.8. Write 5 12 as a 2-adic number. 88 6.2 Valuations If R is an integral domain, a map | · | : R → R which satisﬁes (i) |x| ≥ 0 with equality if and only if x = 0, (ii) |xy| = |x||y|, and (iii) |x + y| ≤ |x| + |y| is called an absolute value on R. Two absolute values |·|1 and |·|2 are equivalent on R if |·|2 = |·|c 1 for some c > 0. If we have an absolute value | · | on R, by (ii), we know |1 · 1| = |1| = 1. Similarly, we know | − 1|2 = |1| = 1, and therefore | − x| = |x| for all x ∈ R. Now a absolute value | · | on R makes R into a metric space with distance d(x, y) = |x − y|. (The fact | − x| = |x| guarantees |y − x| = |x − y| so the metric is symmetric, and (iii) gives the triangle in- equality.) Recall that any metric space is naturally embued with a topology. Namely, a basis of open (resp. closed) neighborhoods around any point x ∈ R is given by the set of open (resp. closed) balls Br(x) = {y ∈ R : d(x, y) = |x − y| < r} (resp. Br(x) = {y ∈ R : d(x, y) = |x − y| ≤ r}) centered at x with radius r ∈ R. Ostrowski’s Theorem says, that up to equivalence, every absolute value on Q is of one of the following types: | · |0, the trivial absolute value, which is 1 on any non-zero element | · |∞, the usual absolute value on R | · |p, the p-adic absolute value, deﬁned below, for any prime p. Here the p-adic absolute value deﬁned on Q is given by |x| = p −n where x = pn a b with p ∤ a, b. (Note any x ∈ Q can be uniquely written as x = pn a b where p ∤ a, b and a b is reduced.) In particular, if x ∈ Z is relatively prime to p, we have |x| = 1. More generally, if x ∈ Z, |x| = p−n where n is the number of times p divides x. Note any integer x ∈ Z satisﬁes |x|p ≤ 1, and |x|p will be close to 0 if x is divisible by a high power of p. So two integers x, y ∈ Z will be close with respect to the p-adic metric if pn|x − y for a large n, i.e., if x ≡ y mod pn for large n. Example 6.2.1. Suppose p = 2. Then |1|2 = 1, |2|2 = 1 2 , |3|2 = 1, |4|2 = 1 4 , |5|2 = 1, |6|2 = 1 2 , . . . | 3 4 |2 = 4, | 12 17 |2 = 1 4 , | 57 36 |2 = 4. With respect to | · |2, the closed ball B1/2(0) of radius 1 2 about 0 is simply all rationals (in reduced form) with even numerator. Similarly B1/4(0) of radius 1 4 about 0 is simply all all rationals (in reduced form) whose numerator is congruent to 0 mod 4. Exercise 6.9. Prove | · |p is an absolute value on Q. 89 Recall, for a space R with an absolute value | · |, one can deﬁne Cauchy sequences (xn) in R— namely, for any ϵ > 0, |xm − xn| < ϵ for all m, n large. One forms the completion of R with respect to | · | by taking equivalence classes of Cauchy sequences. Everyone knows that the completion of Q with respect to | · |∞ is R. On the other hand, the completion of Q with respect to | · |p is Qp. To see this, observe that x0 = a−dp −d + a1−dp1−d + · · · + a0 x1 = a−dp −d + a1−dp1−d + · · · + a0 + a1p x2 = a−dp −d + a1−dp1−d + · · · + a0 + a1p + a2p2 ... gives a Cauchy sequence in Q with respect to | · |p. Precisely |xn+1 − xn|p = |an+1pn+1|p = 1 pn+1 (unless xn+1 = xn, in which case it is of course 0). Hence these are Cauchy sequences, and their limits are just formal Laurent series in Qp. Hence Qp is contained in the completion of Q with respect to | · |p. It is also not hard to see that any Cauchy sequence in Qp converges (convince yourself). Hence, the Qp’s are an arithmetic analogue of R, just being completions of the absolute values on Q (Q is already complete with respect to the trivial absolute value—Q is totally disconnected with respect to | · |0). This approach to constructing Qp gives both an absolute value and a topology on Qp, which are the most important things to understand about Qp. Precisely, write any x ∈ Qp as x = amp m + am+1pm+1 + · · · , am ̸= 0 for some m ∈ Z. Then we deﬁne the p-adic (exponential) valuation∗ (or ordinal) of x to be ordp(x) = m. Then |x|p = p−m = p−ordp(x). Proposition 6.2.2. Zp = {x ∈ Qp : ordp(x) ≥ 0} = {x ∈ Qp : |x|p ≤ 1}. In particular Zp is a closed (topologically) subring of Qp. Proof. This is clear since Zp =    ∑ n≥0 anp n  ‖  , so Zp is precisely the set of x ∈ Qp with ordp(x) ≥ 0. Corollary 6.2.3. The group of units Z× p of Zp is Z × p = {x ∈ Qp : ordp(x) = 0} = {x ∈ Qp : |x|p = 1} . ∗One often calls absolute values | · | valuations on a ﬁeld. Thus sometimes there is a question of whether one means the exponential valuation or the absolute value by the term “valuation.” For clarity, we will reserve the term valuation for exponential valuation, and always refer to our absolute values as absolute values. Even the term exponential valuation is somewhat confusing, as the exponential valuation is really the negative logarithm − logp | · | of the absolute value. “The exponent valuation” might be clearer terminology. 90 Proof. This is immediate from Exercise 6.4. Exercise 6.10. Let p = 5. Determine ordp(x) and |x|p for x = 4, 5, 10, 217 150 , 60 79 . Describe the (open) ball of radius 1 10 centered around 0 in Qp. Exercise 6.11. Let x ∈ Q be nonzero. Show |x|∞ · ∏ p |x|p = 1. This result will be important for us later. Despite the fact that R and Qp are analogous in the sense that they are both completions of nontrivial absolute values on Q, there are a couple of fundamental ways in which the p-adic absolute value and induced topology are diﬀerent from the usual absolute value and topology on R. Deﬁnition 6.2.4. Let | · | be an absolute value on a ﬁeld F . If |x + y| ≤ max {|x|, |y|}, we say | · | is nonarchimedean. Otherwise | · | is archimedean. The nonarchimedean triangle inequality, |x + y| ≤ max {|x|, |y|}, is called the strong triangle inequality. Proposition 6.2.5. | · |∞ is archimedean but | · |p is nonarchimedean for each p. Proof. Everyone knows | · |∞ or Q or R is archimedean—this is what we are use to and the proof is just |1 + 1|∞ = 2 > 1 = max {|1|∞, |1|∞}. Now let’s show | · |p is nonarchimedean on Q. Since Q is dense in Qp (Qp is the completion of Q), this will imply | · |p is nonarchimedean on Qp also. Let x, y ∈ Q. Write x = pm a b , y = pn c d , where a, b, c, d are relatively prime to p, and m, n ∈ Z. Without loss of generality, assume m ≤ n. Then we can write x + y = p m ( a b + pn−m c d ) = p m ad + pn−mbc bd . Since n ≥ m, the numerator on the right is an integer. The denominator are relatively prime to p since b, d are, though the numerator is possibly divisible by p (though only if n = m and p|(ad+bc)). This means that we can write x + y = pm+k e f where e, f ∈ Z are prime to p and k ≥ 0. Thus |x + y|p = p −m−k ≤ p−m = max {p−m, p −n} = max {|xp|, |yp|} Notice that our proof shows that we actually have equality |x + y|p = max {|x|p, |y|p} (since k = 0 above) except possibly in the case |x|p = |y|p. Exercise 6.12. Find two integers x, y ∈ Z such that (i) |x|3 = |y|3 = 1 3 but |x + y|3 = 1 9 . (ii) |x|3 = |y|3 = |x + y|3 = 1 3 . Proposition 6.2.6. Every ball Br(x) in Qp is both open and closed. Thus the singleton sets in Qp are closed. 91 Using the fact that the balls are closed, one can show that Qp is totally disconnected, i.e., its connected components are the singleton sets. However the singleton sets are not open, as that would imply Qp has the discrete topology, i.e., every set would be both open and closed. Proof. Each ball is open by deﬁnition. The following two exercises show Br(x) is also closed. Then for any x ∈ Qp, the intersection of the closed sets ⋂r>0 Br(x) = {x}, which must be closed. Exercise 6.13. Show Br(x) = x + Br(0) = {x + y : y ∈ Br(0)}. Exercise 6.14. Show that Br(0) is closed for any r ∈ R. Your proof of the second exercise should make use of the fact that | · |p is a discrete absolute value, i.e., the valuation ordp : Qp → R actually has image Z, which is a discrete subset of R. In other words, the image of | · |p = p−ordp(·), namely pZ, is discrete in R except for the limit point at 0. On the other hand, the image of the ordinary absolute value | · |∞ on R is a continuous subset of R, namely R≥0. Another strange, but nice thing, about analysis on Qp is that a series ∑ xn converges if and only if xn → 0 in Qp. While these are some very fundamental diﬀerences between R and Qp, you shouldn’t feel that Qp is too unnatural—just diﬀerent from what you’re familiar with. To see that Qp isn’t too strange, observe the following: Proposition 6.2.7. Qp and R are both Hausdorﬀ and locally compact, but not compact. Proof. The results for R should be familiar, so we will just show them for Qp. Recall a space is Hausdorﬀ if any two points can be separated by open sets. Qp is Hausdorﬀ since it is a metric space: namely if x ̸= y ∈ Qp, let d = d(x, y) = |x + y|p. Then for r ≤ d 2 , Br(x) and Br(y) are open neighborhoods of x and y which are disjoint. Recall a Hausdorﬀ space is locally compact if every point has a compact neighborhood. Around any x ∈ Qp, we can take the closed ball Br(x) of radius r. This is a closed and (totally) bounded set in a complete metric space, and therefore compact. (In fact one could also take the open ball Br(x), since we know it is closed from the previous exercise.) Perhaps more instructively, one can show Br(x) is sequentially compact in Qp, which is equiva- lent to compactness being a metric space. We may take a speciﬁc r if we want, say r = 1. Further since B1(x) = x + B1(0) by the exercise above, it suﬃces to show B1(0) = {x ∈ Qp : |x|p ≤ 1} = Zp is sequentially compact. If x1 = a10 + a11p + a12p 2 + · · · x2 = a20 + a21p + a22p 2 + · · · x3 = a30 + a31p + a32p 2 + · · · ... is a Cauchy sequence, then for any ϵ > 0, there is an N ∈ N such that |xm − xn|p < ϵ for all m, n > N . Take ϵ = p−r for r > 0. Then |xm − xn|p < ϵ = p−r means xm ≡ xn mod pr+1, i.e., the coeﬃcients of 1, p, p2, . . . , pr must be the same for all xm, xn with m, n > N . Let a0, a1, . . . , ar 92 denote these coeﬃcients. We can do this for larger and larger r (note that a0, . . . , ar−1 will never change) to get a sequence (an), and then it is clear that the above sequence converges to x = a0 + a1p + a2p2 + · · · ∈ Zp. This provides a second proof of local compactness. To see Qp is not compact, observe the sequence x1 = p−1, x2 = p−2, x3 = p−3, . . . has no convergent subsequence. Geometrically, |xn| = pn, so this is a sequence of points getting further and further from 0, and the distance to 0 goes to inﬁnity. We remark that Q, with either usual subspace topology coming from R or the one coming from Qp, is a space which is not locally compact. The reason is any open neighborhood about a point is not complete—the limit points are contained in the completion of Q (w.r.t. to whichever absolute value we are considering), but not in Q. (The trivial absolute value |·|0 induces the discrete topology on Q, meaning single points are open sets, so it is trivially locally compact.) The general deﬁnition of a local ﬁeld is a locally compact ﬁeld, hence we see that Qp and R are local ﬁelds, whereas Q (with the usual topology) is not. 93 7 Quadratic forms in n variables In order to understand quadratic forms in n variables over Z, one is let to study quadratic forms over various rings and ﬁelds such as Q, Qp, R and Zp. This is consistent with the basic premise of algebraic number theory, which was the idea that to study solutions of a Diophantine equation in Z, it is useful study the equation over other rings. Deﬁnition 7.0.8. Let R be a ring. A quadratic form in n variables (or n-ary quadratic form) over R is a homogenous polynomial of degree 2 in R[x1, x2, . . . , xn]. For example x2 − yz is a ternary (3 variable) quadratic form over any ring, since the coeﬃcients ±1 live inside any ring R. On the other hand x2 − 1 2 yz is not a quadratic form over Z, since − 1 2 ̸∈ Z, but it can be viewed as a quadratic form over Q, Zp for p ̸= 2, Q2, R or C since − 1 2 lies in each of those rings. In fact it can be viewed as a quadratic form over Z/nZ for any odd n, as −2 is invertible mod n whenever n is odd. The subject of quadratic forms is vast and central to many parts of mathematics, such as linear algebra and Lie theory, algebraic topology, and Riemannian geometry, as well as number theory. One cannot hope to cover everything about quadratic forms, even just in number theory, in a single course, let alone one or two chapters. I will describe the classiﬁcation of quadratic forms over Qp and R without proof, explain how one can use this to study forms over Zp and Z, subsequently prove Gauss’ and Lagrange’s theorems on sums of 3 and 4 squares, and then brieﬂy explain some of the general theory of representation of numbers by quadratic forms. In particular, we will describe how studying forms over Zp generalizes Gauss’s genus theory and lead to Siegel’s mass formula, which is a generalization of Dirichlet’s mass formula to n-ary quadratic forms. The main “algebraic” question about quadratic forms is how they can be classiﬁed, up to equiv- alence. Deﬁnition 7.0.9. Let Q1(x) = Q1(x1, . . . , xn) and Q2(x) = Q2(x1, . . . , xn) be n-ary quadratic forms over a ring R. We say Q1 and Q2 are equivalent over R denoted Q1 ∼ Q2, or Q1 ∼R Q2 when we want to specify R, if there exists σ ∈ GLn(R) such that Q2(x) = Q1(σx). In other words, two forms will be equivalent over R if one is obtained from the other by an invertible (linear) change of variables over R. This is the same as our deﬁnition of equivalence (not proper equivalence) for binary quadratic forms over Z. Note that equivalent forms over R will represent the same numbers. References for this chapter are [Serre], [Cassels], [Gerstein] and [Iwaniec]. 7.1 Quadratic forms over ﬁelds The main question about quadratic forms over ﬁelds is how they can be classiﬁed, and we start with ﬁelds because the classiﬁcation over ﬁelds is much simpler than the classiﬁcation over rings. 94 Let F be a ﬁeld of characteristic not 2, and Q be an n-ary quadratic form over F . We can write Q(x1, . . . , xn) = ∑ i≤j cijxixj = (x1 x2 · · · xn) A    x1 x2 ... xn  |  where A is a symmetric matrix in Mn(F ). Precisely let A = (aij) where aij =  | | cii i = j 1 2 cij i < j 1 2 cji i > j . For example if Q(x1, x2, x3) = x2 1 + 2x2 2 + 3x2 3 + 4x1x2 + 5x1x3 + 6x2x3, then we may write Q(x1, x2, x3) = (x1 x2 x3)  1 1 5 2 1 2 3 5 2 3 3    x1 x2 x3   . In this way, quadratic forms in n variables correspond to symmetric n × n matrices. Symmetric n × n matrices A correspond to symmetric bilinear forms B(x, y) = xT Ay on F n, hence quadratic forms Q(x) are essentially the same as symmetric bilinear forms B(x, y) (just set Q(x) = B(x, x)), which is how they arise in linear algebra and Lie groups. We say Q is nondegenerate if the determinant of the associated matrix is nonzero. This essentially means that Q is not equivalent to a quadratic form in less than n variables. We will always assume this. The ﬁrst classiﬁcation results for quadratic forms were in the cases F = R and F = C. Let’s ﬁrst go through these. Theorem 7.1.1. (Sylvester) Let Q be be a nondegenerate quadratic form in n-variables over R. Then Q is equivalent to x2 1 + · · · + x2 k − x2 k+1 − · · · − x2 n for some 1 ≤ k ≤ n. Further no two of these are equivalent. Proof. Since any symmetric matrix is diagonalizable over R, up to equivalence we may assume the matrix for Q is diag(a1, . . . , an), i.e., Q is the diagonal form a1x2 1 + a2x2 2 + · · · anx2 n. What Q being nondegenerate means is that no ai = 0 (or else the determinant of the diagonal matrix would be 0). Thus we can make the (invertible) change of variables which replaces each xi with 1√|ai| xi. Under this transformation, Q becomes Q(x1, . . . , xn) = sgn(a1)x2 1 + sgn(a2)x 2 2 + · · · + sgn(an)x2 n, where sgn(ai) = ai |ai| is the sign of ai. Since we can permute the xi’s, we can in fact assume the ﬁrst k ai’s are positive and the remaining ai’s are negative. This shows any Q is equivalent to some x2 1 + · · · + x2 k − x2 k+1 − · · · − x2 n. Note that the ai’s are the eigenvalues of the matrix A for Q. Sylvester showed that the number of positive and negative eigenvalues of ST AS is the same for any invertible matrix S. (This known as Sylvester’s law of inertia.) This proves the classiﬁcation theorem. 95 If we think back to the notion of deﬁnite and indeﬁnite forms, only two forms (up to equivalence) are deﬁnite (represent only positive or negative values), namely the positive deﬁnite form x2 1+· · ·+x2 n and the negative deﬁnite form −x2 1 − · · · − x2 n. Contrast what happens over R with what happens over Q. Theorem 7.1.2. Let Q be a nondegenerate quadratic form in n-variables over C. Then Q is equivalent to x2 1 + x2 2 + · · · x2 n. Proof. As in the real case, we may assume Q is of the form a1x2 1 + · · · + anx2 n. But now √ai ∈ C for all i, so making the change of variables 1√ai xi, proves the theorem. Over C, there is no real notion of deﬁnite or indeﬁnite since squares may be positive or negative. In any case, there is only one form over C, up to equivalence. Note that both over R and C, the classiﬁcation of quadratic forms is much simpler than the classiﬁcation of binary quadratic forms over Z. For one, there are inﬁnitely many equivalence classes of binary quadratic forms (with no restriction on the discriminant), and even for a ﬁxed discriminant the structure is rather complicated (though surprisingly beautiful, in that we have Gauss’s composition law) In particular, while the discriminant is an invariant of the form over Z, this is not true over R or C. Over R, there is a single invariant of a quadratic form, called the signature of the form, which is the number of +1 coeﬃcients minus the number of −1 coeﬃcients, assuming the form is written as x2 1 + · · · + x2 k − x2 k+1 − · · · − x2 n. In general, for a quadratic form Q over any ﬁeld F (characteristic not 2), we may make a change of variables to write Q as a diagonal form Q(x1, . . . , xn) = a1x2 1 + a2x2 2 + · · · + anx 2 n. Then the question of classiﬁcation becomes simply a question of whether each √ai ∈ F . If so, then we can make a change of variables xi 7→ 1√ai xi to see Q is equivalent to x2 1 + · · · + x2 n. In particular, if F is algebraically closed, √ai is always in F , so there is only one (nondegenerate) quadratic form in n-variables up to equivalence. In light of the above, the following result should be fairly evident. Proposition 7.1.3. Any n-ary form Q over F is equivalent to a1x2 1 + a2x2 2 + · · · + anx2 n, where each ai lies in a set of representatives for F ×/F ×(2). Here F ×(2) denotes the subgroup of squares of F ×. One can show there are three invariants for a quadratic form Q = a1x2 1 + · · · anx2 n, the rank (or number of variables) n, the discriminant disc(Q) = a1a2 · · · an, and the Hasse invariant ϵ(Q) =∏i<j (ai,aj F ) = ±1. Here (a,b F ) is the Hilbert symbol which is deﬁned to be +1 if ax2 + by2 = z2 has a nonzero solution over F and −1 otherwise. Proposition 7.1.4. For p odd, a set of representatives for Q× p /Q ×(2) p is {1, p, u, up} where u ∈ Z satisﬁes (u p) = −1. This quotient group is isomorphic to C2 × C2. Proposition 7.1.5. A set of representatives for Q × 2 /Q ×(2) 2 is {±1, ±2, ±5, ±10}. This quotient group is isomorphic to C3 2 . 96 Theorem 7.1.6. Let Q1 and Q2 be quadratic forms over Qp. They are equivalent if and only if they have the same rank, discriminant and Hasse invariant. See [Serre] for proofs. Things are much more complicated over Q since the quotient group Q×/Q×(2) is inﬁnite. For instance, the primes 2, 3, 5, 7, 11, 13, . . . are all distinct in Q×/Q×(2), as can be easily checked by the exercise below. Exercise 7.1. Suppose p and q are two distinct primes p and q. Show p and q do not diﬀer by a rational square. Consequently Q×/Q×(2) is inﬁnite. The way to study forms over the global ﬁeld Q is by reducing the question to studying forms over the local ﬁelds Qp. To be a little more precise, the philosophy is that we can study problems over Q by studying the associated problems in all of its completions (w.r.t. nontrivial absolute values), in other words in each Qp and R. This notion is called Hasse’s local-to-global principle. The simplest precise form of the local-to-global principle is the following theorem of Hasse and Minkowski. For a quadratic form Q over a ﬁeld F , we always have Q(0) = 0, and the simplest representation question is whether Q(x) = 0 for any nonzero x ∈ F n. If Q(x) = 0 for some 0 ̸= x ∈ F n, we say Q represents 0 (nontrivially), or Q is isotropic. Theorem 7.1.7. (Hasse–Minkowski) Let Q be a quadratic form over Q. Then Q represents 0 (nontrivially) over Q if and only if it does over Qp for each p and over R. We remark that this statement makes sense because any form over Q can be regarded as a form over Qp or R since Q ⊆ Qp and Q ⊆ R. Proof. (Sketch) Let Q be a quadratic form of rank n over Q. By the above we can write Q(x1, . . . , xn) = a1x2 1 + a2x2 2 + · · · + anx2 n with each ai ∈ Q. Since Q represents 0 (over Q, Qp or R) if and only if the form 1 a1 Q does, we may replace Q with 1 a1 Q to assume that a1 = 1. Also, by replacing xi with an appropriate multiple cixi, we may assume each ai ∈ Z and squarefree. Further it is clear that if Q represents 0 over Q, it also will over the completions Qp and R. Hence it suﬃce to show that Q represents 0 over Q if it does over each Qp and R. We consider various cases. n = 1. If n = 1, then we have Q(x1) = x2 1, so Q does not represent 0 (nontrivially) over any ﬁeld, and there is nothing to prove. n = 2. If n = 2, write Q(x, y) = x2 − ay2 (here a = −a2). Then Q represents 0 over a ﬁeld F if and only if x2 = ay2 has a solution in F , i.e., if and only if a = ( x y )2 has a solution in F , i.e., if and only if a is a square in F . So we want to prove that if a is a square in Qp and a is a square in R, then a is a square in Q. The condition that a ∈ R×(2) just means a > 0. Note that a ∈ Q ×(2) p means that ordp(a) is even for each p (since a = b2 implies ordp(a) = 2ordp(b)). Write a = r s where r, s ∈ Z in reduced form. If p is a prime dividing r or s, then ordp(a) even means that p occurs to an even power in the prime factorization of r and s (it will be positive for one of r and s, and 0 for the other). Hence r s = a is a square in Q. n ≥ 3. One can treat the cases n = 3 (due to Legendre) and n = 4 separately, and then prove the theorem for n ≥ 5 by induction on n by breaking the form up into the sum of a binary form with a form of rank n − 2. This is done with fairly elementary p-adic analysis. 97 Now one might wonder if the Hasse–Minkowski theory unnecessarily complicates the problem by requiring us to check things over inﬁnitely many ﬁelds Qp. In practice however, one only needs things for ﬁnitely many primes. This can even be seen in our proof of the n = 2 case: to check if a = r s is a square in Q, it suﬃces to check it over R and Qp for just the primes p dividing r and s. One reason representing 0 is a basic question is the following. Proposition 7.1.8. Suppose Q represents 0 over F . Then Q is universal, i.e., Q represents every element of F . The proof is fairly simple: A nontrivial representation Q(x1, . . . , xn) = 0 implies Q “contains” a product of linear forms. For example, x2 1 + x2 2 − x2 3 = x2 1 + (x2 + x3)(x2 − x3) = x2 1 + yz where y = x2 + x3, z = x2 − x3. Setting x1 = 0, y = 1 and letting z vary, we see this form is universal. The general argument is similar, but we will not go through the details—in any event, this example is essentially the case we will be considering in the next section. In fact, the Hasse–Minkowski theorem really contains information about a form representing any a ∈ Q. Exercise 7.2. Consider a form Q(x1, . . . , xn) over Q and set Qa(x1, . . . , xn+1) = Q(x1, . . . , xn) − ax2 n+1 for a ∈ Q. Show Q represents a if and only if Qa represents 0. (Hint: use Proposition 7.1.8.) Exercise 7.3. Let Q be a quadratic form over Q. Deduce from Hasse–Minkowski that Q represents some a ∈ Q over Q if and only if it does over R and each Qp. (Hint: use the previous exercise.) One can show that any quadratic form of rank ≥ 4 over Qp represents all p-adic numbers. Then from previous exercise, one can deduce that for any Q of rank ≥ 4, Q represents a ∈ Q over Q if and only if it does over R. With this you should easily be able to convince yourself that form of rank ≥ 4 over Q either represents (i) all nonnegative rationals, (ii) all nonpositive rationals, or (iii) all rationals, just based on the signs of the coeﬃcients of the form. This suggests the following phenonemon—it is easy to determine what numbers are represented by a form Q with rank ≥ 4 (at least over Q), and it is also fairly easy to determine what numbers are represented by a form of rank 2 (or 1), but the case of rank 3 is considerably more subtle. This phenomenon persists when restricting to forms over Z as well. This notion of some problems being easy in low dimensions and high dimensions, but very subtle in middle (often 3 or 4) dimensions, occurs in other areas of mathematics also, a famous example being the classiﬁcation of n-manifolds, which is “simple” in dimensions ≤ 2 or ≥ 5. 7.2 Sums of Squares Ideally, one would like to use the Hasse–Minkowski theorem to reduce representation problems over Z to problems over Zp. The general situation is rather complicated, so for simplicity and completeness, we will show how to apply these ideas to the cases of sums of three and four squares, following [Serre] and [Gerstein]. Let’s start with the sum of 3 squares over a ﬁeld F . Recall the Hilbert symbol (a,b F ) is 1 if ax2 + by2 − z2 represents 0 and is −1 else. Hence x2 + y2 + z2 represents 0 over F if and only if(−1,−1 F ) = 1. We claim that this is the case if F = Qp, p odd. One can treat speciﬁc cases via simple applications of quadratic reciprocity and Hensel’s lemma. Exercise 7.4. Suppose p ≡ 1 mod 4. Show −1 is a square in Zp. Deduce x2 + y2 + z2 represents 0 over Qp (in fact Zp), i.e., (−1,−1 Qp ) = 1. 98 Exercise 7.5. Suppose p ≡ 3 mod 8. Show −2 is a square in Zp. Deduce x2 + y2 + z2 represents 0 over Qp (in fact Zp), i.e., (−1,−1 Qp ) = 1. For the general case (well, really we only need it for p ≡ 7 mod 8 after the above exercises) we will appeal to the following formula. Proposition 7.2.1. Suppose p is odd, a, b ∈ Qp, and write a = pαu, b = pβv, where u, v are units of Zp. Then ( a, b Qp ) = (−1) αβ p−1 2 ( u p )β( v p )α. (One extends the Legendre symbol ( · p) to Z× p by putting (a p) = (a0 p ) for a = a0 + a1p + a2p2 + · · · . However, we will only apply the above formula in the case where a, b ∈ Z.) Exercise 7.6. Let p be odd. Compute (−1,−1 Qp ). Deduce that x2 + y2 + z2 is universal over Qp. Lemma 7.2.2. Let α ∈ Q×. Then α is a sum of 3 rational squares if and only if α > 0 and −α ∈ Q ×(2) 2 . Proof. By Hasse–Minkowski, α is represented by Q = x2 + y2 + z2 over Q if and only if α is represented by Q over each Qp and R. The representation condition over R is equivalent to α > 0. By the above exercise, we know x2 + y2 + z2 represents all α in Qp for p odd, so it suﬃces to show x2 + y2 + z2 represents α in Q2 if and only if −α ̸∈ Q ×(2) 2 . By an earlier exercise x2 + y2 + z2 represents α in Q2 if and only if x2 + y2 + z2 − αw2 represents 0. One can show a rank 4 quadratic form a1x2 + a2y2 + a3z2 + a4w2 over Qp does not represent 0 if and only if the discriminant is a square and the Hasse symbol ϵ = ∏i<j (ai,aj Qp ) = − (−1,−1 Qp ). When p = 2, we have (−1,−1 Qp ) = −1 so this Hasse symbol condition holds if the discriminant a1a2a3a4 is a square, which in our case is just −α. This proves the lemma. To pass to representations over Z, we need the following. Lemma 7.2.3. (Davenport–Cassels) Let Q be a positive deﬁnite quadratic form of rank n over Q given by a symmetric matrix A = (aij) ∈ Mn(Z). Suppose (DCH) for all x ∈ Q n, there is a y ∈ Z n such that Q(x − y) < 1. Then if Q represents an integer m over Q, it does over Z. As in the binary case, positive deﬁnite means Q(x) ≥ 0 with equality only if x = 0 ∈ Qn. Proof. Write ⟨u, v⟩ = uT Av for u, v ∈ Qn, so that ⟨v, v⟩ = Q(v). Suppose Q(v) = ⟨v, v⟩ = m where v ∈ Qn. Multiplying through by denominators in v = (v1, . . . , vn), there is a multiple x = tv ∈ Zn of v (for some t ∈ Z) such that Q(x) = Q(tv) = t2m. Choose v and t such that t is minimal. We want to show t = 1. (DCH) tells us there is a y ∈ Zn such that z = x t − y ∈ Qn satisﬁes Q(z) = ⟨z, z⟩ < 1. If ⟨z, z⟩ = 0, then z = 0 (since Q is positive deﬁnite), so x t = y ∈ Zn and t = 1. Now suppose ⟨z, z⟩ ̸= 0. Set a = ⟨y, y⟩ − m, b = 2(mt − ⟨x, y⟩), t′ = at + b, x′ = ax + by. Then a, b, t′ ∈ Z, and it is easy to compute that ⟨x′, x′⟩ = mt′2 and tt′ = t2⟨z, z⟩. Consequently t′ = t⟨z, z⟩ < t, contradicting the minimality of t. 99 Theorem 7.2.4. (Gauss) A positive integer n is a sum of 3 squares if and only if n ̸= 4j(8k + 7). Proof. Let x = (x1, x2, x3) ∈ Q3. Choose y = (y1, y2, y3) ∈ Z3 such that |xi − yi| ≤ 1 2 . Then Q(x − y) = (x1 − y1) 2 + (x2 − y2) 2 + (x3 − y3) 2 ≤ 1 4 + 1 4 + 1 4 < 1, i.e., the form x2 + y2 + z2 satisﬁes (DCH). By the Davenport–Cassels Lemma and the previous lemma, n is a sum of 3 squares if and only if −n ∈ Q ×(2) 2 . Since −n ∈ Z ⊆ Z2, this is equivalent to −n is a square in Z2 (since x2 = −n in Q2 implies |x2|2 = | − n|2 ≤ 1 which implies |x|2 ≤ 1). Write −n = 2 e(1 + a1 · 2 + a2 · 2 2 + · · · ) ∈ Z2. If n is a square e must be even, and then n is a square in Z2 if and only if −n 2e = 1 + a1 · 2 + a2 · 22 + · · · is. Using a slight generalization of Hensel’s lemma, we see a ∈ Z × 2 is a square if and only if it is mod 8, i.e., if and only if a ≡ 1 mod 8. Hence −n is a square in Qp if and only if −n = 4j(8m + 1), i.e., if and only if n = 4j(8k + 7). Corollary 7.2.5. (Lagrange) Every positive integer n is a sum of 4 squares. Proof. If n ̸= 4j(8k + 7), then it is a sum of 4 squares since it is a sum of 3 squares. If n = 4j(8k + 7) then m = 8k + 6 is the sum of 3 squares so 8k + 7 = m + 12 is the sum of 4 squares, whence n is also. We remark that we can’t use the Davenport–Cassels Lemma for sums of 4 squares because (DCH) fails. Corollary 7.2.6. (Gauss) Ever positive integer n is a sum of 3 triangular numbers. (Recall a triangular number is one of the form m(m+1) 2 .) Proof. Applying the 3 squares theorem to 8n + 3, we see 8n + 3 = x2 + y2 + z2 for some x, y, z ∈ Z. But since the only squares mod 8 are 0, 1, 4, we must have x2 ≡ y2 ≡ z2 ≡ 1 mod 8, so x, y and z are odd. Write x = 2a + 1, y = 2b + 1, z = 2c + 1. Then a(a + 1) 2 + b(b + 1) 2 + c(c + 1) 2 = 1 8 ((2a + 1)2 + (2b + 1)2 + (2c + 1)2 − 3) = 1 8 (8n + 3 − 3) = n. 7.3 Siegel’s mass formula Here we give a brief summary of Siegel’s mass formula, following [Iwaniec]. Let Q be a positive deﬁnite quadratic form over Z of rank r. The genus of Q is the set forms over Z which are equivalent to Q over each Qp and R. The group of automorphs Aut(Q) of Q is the set of σ ∈ GLr(Z) such that σT Aσ = A, where A is the symmetric matrix associated to Q. We say solutions Q(x) = n and Q(y) = n are equivalent if y = σx for some automorph σ of Q. 100 The number of automorphs Aut(Q) in general can be diﬀerent for diﬀerent forms in the same genus. Let gen(Q) denote the set of equivalence classes of forms in the genus of Q. The genus mass of Q is w(Q) = 1 |Aut(Q)|m(gen(Q)) where m(gen(Q)) = ∑ Qj ∈gen(Q) 1 |Aut(Qj)| . The total mass is ∑ Qj ∈gen(Q) w(Qj) = 1. Then the number of ways n can be represented by some form in the genus of Q is rgen(Q)(n) = ∑ Qj ∈gen(Q) w(Qj)rQj (n). Siegel’s mass formula then states rgen(Q)(n) = ∏ p δp(n, Q) · δ∞(n, Q) where δp(n, Q) is the “density” of solutions Q(x) = n in Zr p. When r = 2 this is essentially Dirichlet’s mass formula. So as in the binary case, when we have one class per genus (e.g., for sums of 3 or 4 squares), one knows the individual rQ(n)’s. But this only happens ﬁnitely often, and in general it is hard to separate out the information about individual forms Q. To attempt to do this, one approach is to associate to Q a modular form ΘQ(z) = ∑ n≥0 rQ(n)e 2πinz, which is a meromorphic function. Notice the rQ(n)’s are Fourier coeﬃcients for ΘQ. Consequently, one can apply analytic methods to study the rQ(n)’s and obtain beautiful formulas in many cases. Iwaniec uses analytic number theory to show an asymptotic formula for rQ(n) (as n → ∞) for individual Q’s. We will not introduce modular forms or discuss other results in this direction here, but the study of quadratic forms and modular forms is a rich area, and there are many interesting open questions still out there. 101 8 Adèles Adèles and idèles were introduced in the early 20th century as an approach to class ﬁeld theory, which may be viewed as a vast generalization of quadratic reciprocity. First we introduce the notion of adèles AQ and idèles A× Q over Q. Then we will discuss p-adic numbers for arbitrary number ﬁelds K, and use these to deﬁne the adèles AK and idèles A× K of a number ﬁeld K. One deﬁnes the quotient group A× K/K× to be the idèle class group of K. Our goal will be to show that this is essentially the ideal class group of K, and then use this to describe some of the main results of class ﬁeld theory. 8.1 AQ The adèles of Q are the ring AQ = { (α2, α3, α5, . . . ; α∞) ∈ ∏ p Qp × R : αp ∈ Zp for a.a. p } . Here “for a.a. (almost all)” p means for all but ﬁnitely many primes p. Exercise 8.1. With addition and multiplication deﬁned component-wise, show AQ is a ring. Note that AQ puts together the information one gets from all the completions of Q, but the whole direct product ∏ Qp × R is too large to work with by itself, so we only consider sequences where almost all terms are p-adic integers. This is analogous to an inﬁnite direct sum of vector spaces Vi. Speciﬁcally, ⊕∞ i=1 Vi = {(vi) ∈ ∏ Vi : vi = 0 for a.a. i}. For instance if each Vi = R, then a basis for ⊕ Vi is {ei} where ei = (0, . . . , 0, 1, 0, . . .) is the vector with a 1 in the i-th coordinate and 0’s elsewhere. If one removes the “for almost all i” condition, then (1, 1, 1, . . .) = e1 + e2 + e3 + · · · would be in the direct sum, but this is not a ﬁnite linear combination of basis elements. Let us simplify now our notation slightly. We call a nontrivial absolute value on Q a place of Q. Hence the places of Q are | · |v where v is either a prime p or v = ∞. The places v = p are called ﬁnite places, and the place v = ∞ is called the real place or inﬁnite place.† Let Qv denote the completion of Q w.r.t. | · |v, so Qp still denotes Qp and now Q∞ denotes R. Let Zv denote the set {xv ∈ Qv : |xv|v ≤ 1}, so that Zv = Zp if v = p and Z∞ = [−1, 1]. While Zp is the completion of Z in each Qp, Z∞ admittedly has little to do with Z. Nevertheless this notation is convenient. We also remark that Zv is compact inside each Qv. In fact when v < ∞, i.e., v = p, Zv is open in Qv. Now we can denote the adèles as AQ = { (αv) ∈ ∏ Qv : αv ∈ Zv for a.a. v} . While the condition αv ∈ Zv for a.a. v may at ﬁrst glance look stronger than the condition αp ∈ Zp for a.a. p because v = ∞ is allowed, thinking about it for a second shows they are equivalent. (Think about it for a second: α ∈ AQ means the local components αv can lie outside of Zv only for v in some ﬁnite set S of places (S of course depends on α— it is like the “support” of an element †It is standard to call places primes and still use the letter p, since they correspond to the usual primes and inﬁnity. Then the ordinary primes are called ﬁnite primes, and denoted by p < ∞, and the inﬁnite place is called the inﬁnite prime p = ∞. 102 y in the inﬁnite direct sum R∞ = ⊕∞ i=1 R, which is the set of i for which the i-th component of y is nonzero. We can always add the place ∞ to S if it is not included, and S will still be ﬁnite, meaning we have the condition αv can lie outside of Zv for v ∈ S ∪ {∞}.) The following examples will tell us a little bit about AQ. Example 8.1.1. Let x = a b ∈ Q with a, b ∈ Z. Let α = (x, x, x, . . .). Note that 1 b ∈ Zp for any p s.t. p ∤ b. Hence x = a b ∈ Zp for any p s.t. p ∤ b, i.e., x = αv ∈ Zv for almost all v. Thus α ∈ AQ. Hence we have an (injective) ring homomorphism from Q → AQ given by x 7→ (x, x, x, . . .). So the additive identity of AQ is (0, 0, 0, . . .) and the multiplicative identity of AQ is 1 = (1, 1, 1, . . .). We will typically identify elements of Q with their image in AQ under this map. Example 8.1.2. Let α = (1, 0, 0, 0, . . .), β = (0, 1, 1, 1, . . .). Since each component αv, βv ∈ Zv for all v, we have α, β ∈ AQ. Then αβ = (0, 0, 0, . . .) = 0 ∈ AQ. In other words, α and β are zero divisors in AQ, so AQ is not an integral domain. Proposition 8.1.3. For α = (αv) ∈ AQ, let |α| = ∏v |αv|v. Then | · | : AQ → R satisﬁes (i) |α| ≥ 0 (ii) |αβ| = |α||β| Proof. First note that |α| is well deﬁned: since α = (αv) ∈ AQ satisﬁes αv ∈ Zv for almost all v, we have |αv|v ≤ 1 for almost all v, and therefore the inﬁnite product |α| = ∏v |α|v converges. It is clear that |α| ≥ 0. Further (ii) follows immediately because it does for each |α|v. Example 8.1.4. Taking α = (1, 0, 0, 0, . . .) from the previous example, we see |α| = |1|2 ∏v̸=2 |0|v = 0, so | · | can be zero on nonzero elements. Therefore, | · | cannot technically be an absolute value. Of course, our earlier deﬁnition of absolute values was only for integral domains because any mul- tiplicative homomorphism | · | : R → R for a non-integral domain must be 0 on some zero divisors. (αβ = 0 implies |α||β| = |αβ| = 0 so either |α| or |β| is 0.) However we can even ﬁnd α ∈ AQ which is not a zero divisor such that |α| = 0. Namely consider α = (αv) where αp = p and α∞ = 1. Each component αv ∈ Zv so α ∈ AQ, but α = ∏ p |p|p · |1|∞ = ∏ p 1 p = 0. In fact, another crucial property of absolute values fails also, namely the triangle inequality. Exercise 8.2. Find α, β ∈ AQ such that |α + β| > |α| + |β|. Example 8.1.5. Let x ∈ Q and α = (x, x, x, . . .). If x = 0, then |α| = 0. Otherwise |α| = 1 by Exercise 6.11. The fact that AQ is not an integral domain makes it a little hard to work with, but the idèles A× Q = {α ∈ AQ : α invertible}, namely the multiplicative subgroup of AQ, become a nice space to work with. Proposition 8.1.6. The idèle group A× Q = {(αv) ∈ ∏v Q× v : αv ∈ Z× v for a.a. v} . 103 Note that technically we did not deﬁne Z× v for v = ∞, but as above including or removing a single place v = ∞ from a “for all but ﬁnitely many” condition does not change anything. However, if one wishes, one can set Z× v = {αv ∈ Q× v : |αv|v = 1} so Zv = Zp for v = p and Zv = {−1, 1} for v = ∞. Proof. Let α = (αv) ∈ A× Q. It is clear that αv ∈ Q× v for all v, otherwise some component will be zero. Let β = (βv) = α−1 ∈ AQ. Since βv ∈ Zv and αv ∈ Zv for almost all v, there is a ﬁnite set S of places v such that αv, βv ∈ Zv for all v ̸∈ S. Then αβ = (1, 1, 1, . . .) means αvβv = 1 for all v, so αv, βv ∈ Z× v for all v ̸∈ S, i.e., αv ∈ Z× v for a.a. v. This proves ⊆. ⊇ is straightforward—see the next exercise. Exercise 8.3. Let α = (αv) ∈ AQ such that αv ̸= 0 for all v and αv ∈ Zv for almost all v. Show there is a β ∈ AQ such that αβ = 1 = (1, 1, 1, . . .). One can use the topologies on Qv and Q× v to deﬁne topologies on the additive group of adèles and multiplicative group of idèles, to make them both into topological groups. (We already deﬁned the topology on Qv in terms of a basis of neighborhoods. One can do the same thing for Q× v , or just give Q× v the subspace topology from Q× v ⊆ Qv. Both methods give the same topology.) To deﬁne a topology on a group, it suﬃces to specify a basis of open neighborhoods of the identity. A basis of open neighborhoods of 0 in AQ is given by a collection of sets of the form ∏ v∈S Uv ∏ v̸∈S Zv ⊆ AQ where S is a ﬁnite set of places containing ∞ and for each v ∈ S, Uv is an open neighborhood of 0 in Qv. Note the requirement that ∞ ∈ S is because Z∞ = [−1, 1] is a closed set in Q∞ = R, so we do not want v = ∞ occurring in the product on the right. Similarly, a basis of open neighborhoods of 1 in A × Q is given by a collections of sets of the form ∏ v∈S Uv ∏ v̸∈S Z × v ⊆ AQ where S is a ﬁnite set of places containing ∞ and for each v ∈ S, Uv is an open neighborhood of 1 in Q× v . We remark that one can also form a topology of AQ by taking the product topology on ∏ Qv, and put the subspace topology on AQ. This is diﬀerent than the topology we described above, and this topology induced by the product topology is too strong for our purposes. Similar remarks are true for the topology on A× Q. Further, the topology on A × Q is not the subspace topology induced from the inclusion A× Q ⊆ AQ, as the open sets in the subspace topology will be too large. For example, Exercise 8.4. Consider the open set U = R × ∏p Zp ⊆ AQ. This is an open neighborhood of 1 in AQ. Show the restriction U ∩A× Q contains but does not equal the open neighborhood V = R× ×∏p Z× p of 1 in A× Q. A similar, but slightly more technical, argument shows that if V = ∏v∈S Uv ∏v̸∈S Z× v is an open neighborhood of 1 in AQ (where as usual S is a ﬁnite set of places), then there is no open neighborhood U of 1 in AQ whose restriction to A × Q will be contained in V . 104 Proposition 8.1.7. AQ and A× Q are locally compact. Furthermore, (i) a subset U of AQ is relatively compact if and only if U ⊆ ∏v Kv where each Kv is compact in Qv and Kv = Zv for almost all v; and (ii) a subset U of A× Q is relatively compact if and only if U ⊆ ∏v Kv where each Kv is compact in Q× v and Kv = Z× v for almost all v. (Recall a set is called relatively compact if its closure is compact.) Proposition 8.1.8. Q and Q× are discrete subgroups of AQ and A × Q. Proposition 8.1.9. AQ/Q is compact with the quotient topology, and AQ/Q ≃ lim ←− n Z/nZ = {(a1, a2, a3, a4, . . .) : an ∈ Z/nZ, an ≡ am mod m if m|n} . Hence, just like Zp = lim ←− Z/pnZ, we can view AQ/Q as a projective limit, i.e., as a way of putting together, all the Z/nZ’s in a compatible way. See [Ramakrishnan–Valenza] for proofs. 8.2 p-adic ﬁelds There are several ways to treat the theory of p-adic ﬁelds, just like there are several ways to treat the theory of p-adic numbers. One common way of deﬁning them is as ﬁnite extensions of Qp. However, I will opt for a concrete approach via completions w.r.t. absolute values, as it is in my mind more natural. Let K be a number ﬁeld and p a prime ideal of K. In the case K = Q and p = (p), one deﬁnes the p-adic absolute value by |x|p = p−m where x = pm a b and a, b are relatively prime to p. If x = pma ∈ Z, another way to say this is that |x|p = p−m where m is the highest power of p that divides x, i.e., m is the unique integer such that p m = (p) m ⊇ (x) ̸⊆ p m+1 = (p) m+1. In fact, using fractional ideals, we can say the same thing even if x ̸∈ Z. Speciﬁcally, we have a ﬁltration of Q: · · · ⊇ p −2 ⊇ p −1 ⊇ p 0 = Z ⊇ p 1 ⊇ p 2 ⊇ · · · We deﬁne ordp(x) to be the largest m such that x (or (x) if you prefer) is contained in pm = (p)m, and then set |x|p = p−ordp(x). Now we return to the general case. Deﬁnition 8.2.1. Let K be a number ﬁeld and p be a prime ideal of K. For x ∈ K, deﬁne the p-adic valuation ordp(x) to be the largest integer m such that x ∈ pm. Then the p-adic absolute value on K is given by |x|p = N (p)−ordp(x). Exercise 8.5. Let p be a prime ideal of K lying above a prime p of Q. Then for x ∈ Q ⊆ K, show |x|p = |x| f p where f = f (p|p) is the inertial degree of p above p. As in the case K = Q, these give, up to equivalence, all non-archimedean absolute values on K. The archimedean values are slightly more complicated then the case of Q, and they are essentially parametrized by Gal(K/Q). This is because if we want to restrict the usual absolute value on R or 105 C to K, it depends upon the embedding of K into R or C, and the embeddings of K into C was precisely our deﬁnition for the Galois group Gal(K/Q). Let {σ1, . . . σr} denote the set of real embeddings of K and {τ1, τ 1, . . . , τs, τ s} denote the set of complex embeddings of K. Then we deﬁne the archimedean absolute values |x|σi = |σi(x)|R and |x|τj = |τj(x)|C where | · |R is the usual absolute value on R and |z|C = zz is the square of the usual absolute value on C. It is immediate from the deﬁnition of equivalence that \f \f cdot|C is equivalent to the usual absolute value on C, but it is preferable for us to take this normalization, as |z|C is more like a norm than √ | · |C. In particular it maps Z[i] into Z. For instance |1 + i|C = (1 + i)(1 − i) = 2, but if we use the usual absolute value, then |1 + i| = √2. Example 8.2.2. Let K = Q( √3). Then Gal(K/Q) = {σ1, σ2} where σ1( √3) = √3 and σ2(√3) = − √3. Then |1 + √3|σ1 = |1 + √3|R ̸= |1 − √3|R = |1 + √3|σ2. Example 8.2.3. Let K = Q(√ −3). Then Gal(K/Q) = {τ, τ } where τ (√−3) = i √3. Then |1 + √−3|τ = |1 + i √3|C = |1 − i √3|C = |1 + √−3|τ . In general, no absolute values corresponding to two diﬀerent σi’s or τj’s will be equivalent, but we will always have | · |τj = | · |τ j since |z|C = |z|C. Theorem 8.2.4. The places (equivalence classes of non-trivial absolute values) on K are precisely given by (i) v = p where p is a prime ideal of K (non-archimedean places) (ii) v = σi where σi is a real embedding of K (real places) (iii) v = τj where τj runs over the set of complex embedding of K, up to complex conjugation (complex places). Deﬁnition 8.2.5. For a place v of K, let Kv denote the completion of K with respect to | · |v. Let OKv = {x ∈ Kv : |x|v ≤ 1} and O× Kv = {x ∈ Kv : |x|v = 1}. If v = p is a non-archimedean place, we call Kv the p-adic numbers and OKv the p-adic integers over K. If K = Q and p = (p) this coincides with our previous deﬁnitions. Most of the results on p-adic numbers over Q extend to p-adic numbers over K, but due to time constraints we will not explain these in detail except where we need to. A similar remark is true for the theory of adèles and idèles, which we can now deﬁne. Deﬁnition 8.2.6. The adèles of K are AK = {α = (αv) : αv ∈ Kv for all v, αv ∈ Zv for a.a. v} ⊂ ∏ v Kv. Similarly, the idèles of K are A× K = {α = (αv) : αv ∈ K× v for all v, αv ∈ Z × v for a.a. v} ⊂ ∏ v K× v . In both statements, v runs over the set of places of K. 106 As with Q, K and K× embed diagonally into AK and A × K, and in this way we will regard K and K× as additive and multiplicative subgroups of AK and A × K. One deﬁnes the absolute value on AK or A × K by |α| = |α|AK = ∏ v |αv|v where α = (αv) ∈ AK. We will usually simply denote the absolute value on AK by |·|, but sometimes we will use | · |AK for clarity. Deﬁnition 8.2.7. The idèle class group of K is CK = A× K/K×. While AK/K is compact, it is not the case that A× K/K× is, owing to the fact that the open sets of A× K are much smaller than the open sets of AK (see above remarks about the diﬀerence between the topologies on AQ and A× Q). However one can prove the following. Theorem 8.2.8. Let A1 K ⊂ A× K be the subgroup of idèles of K having absolute value 1. Then K× ⊆ A1 K and the norm 1 idèle class group C1 K = A 1 K/K× is compact. Recall in the case K = Q, you proved in Exercise 6.11 that the adèlic absolute value |(x, x, x, . . .)|AQ = 1 for x ∈ Q×. A similar argument shows that |x|AK = |(x, x, x, . . .)|AK = 1 for any x ∈ K×, which means K× ⊆ A1 K. Deﬁnition 8.2.9. The ∞-idèles are deﬁned to be A× K,∞ = { (αv) ∈ A× K : αv ∈ O× Kv for all v < ∞ } ⊆ A× K Exercise 8.6. Check A × K,∞ is a subgroup of A× K. Show its intersection with the subgroup K×, i.e. A× K,∞ ∩ K×, is the group of units O× K (regarded as a subgroup of A× K). Theorem 8.2.10. The map A× K → ClK α = (αv) 7→ ∏ p ordp(αp) is a surjective homomorphism with kernel K× · A× K,∞. In particular, this deﬁnes an isomorphism CK/A× K,∞ ≃ ClK of the idèle class group mod the ∞-idèles with Dedekind’s ideal class group. Proof. Note that if αp ∈ O× Kp, then ordp(αp) = 0 so pordp(αp) = (1) = OK. Since α ∈ A× K means αp ∈ O× Kp for all but ﬁnitely many p, the product in the deﬁnition of the homomorphism is in fact a ﬁnite product so the deﬁnition makes sense. It is then obvious it is a homomorphism. Exercise 8.7. (i) Show for A× K,∞ is in the kernel of the above map into ClK (ii) Show K× is kernel of the above map into ClK. (Hint: show if x ∈ O× K, then the ideal (x) = xOK = ∏ pordp(x).) 107 It is not much more diﬃcult to show that these subgroups give the whole kernel. To complete the proof, one needs to show the above map is surjective. Let I be an arbitrary ideal in ClK, and write the prime ideal factorization as I = ∏p∈S pep where S is some ﬁnite set of primes. Then we can construct an idèle α = (αv) where αv = 1 if v ̸∈ S and αp = ϖep p . Here ϖp is a uniformizer of OKp, i.e., ordp(ϖp) = 1. To see that such a ϖp always exists, just take ϖp ∈ OK such that ϖp ∈ p but ϖp ̸∈ p2. This leads us to a topological proof of Corollary 8.2.11. The ideal class group ClK is ﬁnite. Proof. We consider the above map restricted to A1 K. It is easy to see that this is still surjective—in our construction of α above, we were free to do what we want at the inﬁnite places so we can ensure |α| = 1. Hence we have an isomorphism C1 K/A 1 K,∞ ≃ ClK where A1 K,∞ = A× K,∞ ∩ A× K. However C1 K is compact, and A1 K,∞ is an open subset. Hence the quotient ClK is both compact and discrete, whence ﬁnite. 8.3 Elements of class ﬁeld theory Class ﬁeld theory is regarded as the crowning acheivement of algebraic number theory, just as quadratic reciprocity was the crowning achievement of elementary number theory. Class ﬁeld theory is often described as a characterization of the abelian extensions of a number ﬁeld, but its explicit forms generalize quadratic and higher reciprocity laws. What do we mean by higher reciprocity laws? Well the most basic way of thinking about quadratic reciprocity is a way to tell if something is a square mod p. Cubic reciprocity is a way to tell if something is a cube mod p, and similarly there are notions of biquadratic (4th power) and higher reciprocity laws. Looked at from the point of view of rings of integers, quadratic reciprocity tells us about the way primes split in quadratic extensions. So you might guess cubic reciprocity should tell us about the way primes split in (normal) cubic extensions, and so on. In general, Artin reciprocity (a more explicit form class ﬁeld theory) tells us how primes split in abelian extensions. Even to state the main theorems of class ﬁeld theory is not so simple, and we still need to make some more deﬁnitions. Let L/K be an extension of number ﬁelds. Let P be a prime ideal of L lying above p, a prime ideal of K. The decomposition group of L/K at P is G(P|p) = {σ ∈ Gal(L/K) : σ(P) = P} . Recall that Gal(L/K) acts on the primes of L above p, so the G(P|p) is just the stabilizer of P. Each element of G(P|p) extends to an automorphism of the completion LP which is trivial on Kp. One can deﬁne Galois groups for extensions of local ﬁelds (LP/Kp is a ﬁnite extension of degree f (P|p)) and show Gal(LP/Kp) ≃ G(P|p). As in the case of number ﬁelds one can deﬁne a norm from LP to Kp given by NP|p(x) = NLP/Kp(x) = ∏ σ∈Gal(LP/Kp) σ(x). 108 One can also do something similar for the archimedean, or inﬁnite, places. In particular, if v is an inﬁnite place of L (i.e., an element of Gal(/Q), up to complex conjugation) and w is an inﬁnite place of K (i.e., an element of Gal(K/Q) up to complex conjugation), we write v|w if the embedding v : L ,→ C restricted to K gives the embedding w : K ,→ C (up to complex conjugation). If v|w, then Nv|w(z) = z if Lv = Kw = R or C, and Nv|w(z) = zz if Lv = C and Kw = R. Using this, one can deﬁne a norm from A× L to A × K given by NL/K((αv)v) = ( ∏ v|w Nv|w(αv))w Exercise 8.8. Let x ∈ L× and regard x = (x, x, x, . . .) ∈ A× L . Show the idèlic norm NL/K(x) lies in K× ⊆ A× K. For a number ﬁeld K, let K denote its algebraic closure, and for a group G let Gab denote is abelianization (quotient via the commutator subgroup). Note that Gal(K/K)ab “contains” the Ga- lois group of any abelian extension L/K as a quotient. In fact, there is a maximal abelian extension Kab of K inside K (inﬁnite degree of course), and we will have Gal(Kab/K) = Gal(K/K)ab. The extension Kab contains all ﬁnite abelian extensions of K. Now we can at least state some of the “non-explicit” assertions of class ﬁeld theory: Theorem 8.3.1. Let K be a number ﬁeld. There is a homomorphism, called the Artin map, θK : CK → Gal(Kab/K) such that (i) For every ﬁnite abelian extension L/K, let θL/K denote the composition of θL/K : CK θK→ Gal(Kab/K) → Gal(L/K) Then ker θL/K = NL/K(CL), which yields an isomorphism CK/(NL/KCL) = A× K/(K× · NL/K(A× L )) ≃ Gal(L/K) (ii) Given any open subgroup of N of CK of ﬁnite index, there is a ﬁnite abelian extension L of K with N = ker θL/K. Hence CK/N ≃ Gal(L/K). There are also some functoriality results which say how the Artin maps θK and θL are related for an extension L/K, but we will pass over these now. Let ζn = e2πi/n. Corollary 8.3.2. (Kronecker–Weber) Every abelian extension of Q is contained in Q(ζn) for some n. An equivalent way to state this is that the maximal abelian extension Qab of Q in Q is the compositum of the extensions Q(ζn) for all n. The basic idea of the proof is the following. Class ﬁeld theory says the abelian extensions of Q correspond to the open subgroups of the idèle class group CQ. To understand what these are, we want to determine the structure of A × Q. Speciﬁcally, one can show A× Q ≃ Q × × R>0 × ˆZ × 109 where ˆZ× = lim ←−(Z/nZ)× = ∏p Z× p . Consequently CQ ≃ R>0 × ˆZ ×. Hence if U is an open subgroup of CQ with ﬁnite index, then U must be of the form U ≃ R>0 × U ′ where U ′ is an open subgroup of ﬁnite index in Z×. (Since there are no nontrivial open subgroups of ﬁnite index in R>0.) Then one uses a basis of neighborhoods for 1 in ˆZ× to show that U must contain NK/Q(CK) where K is some Q(ζn). Consequently the extension corresponding to U must contain K. (The functor from open subgroups of CK to abelian extensions of K is contravariant (i.e., inclusion-reversing), just like the functor from subgroups of the absolute Galois group of K to extensions of K.) The above theorem of class ﬁeld theory was established by Takagi, but the existence of a ho- momorphism θK was given abstractly. It was Artin who was able to give it in an explicit fashion, which we now brieﬂy describe. Let L/K be a Galois extension of number ﬁelds, p a prime of K and P a prime of L lying above p. Let f = f (p|p) where p is the prime of Q lying under p, so the residue ﬁeld OK/p has order q = pf . The Frobenius map F rq : x 7→ xq generates the Galois group Gal((OL/P)/(OK/p)). The decomposition group maps to Gal((OL/P)/(OK/p)) via ϕ : G(P|p) → Gal((OL/P)/(OK/p)) by σ 7→ (aP 7→ σ(a)P). This is an isomorphism if P|p is unramiﬁed, and in this case and we let the Frobenius element ϕP|p of Gal(P|p) ⊆ Gal(L/K) be the inverse image ϕP|p = ϕ−1(F rq) of F rq in Gal(P|p). Exercise 8.9. Let L/K be a Galois extension of number ﬁelds. Let P and P′ be primes of L lying above p. Show the decomposition groups G(P|p) and G(P′|p) are conjugate in Gal(L/K). We regard each Frobenius element ϕP|p ∈ Gal(P|p) as an element of Gal(L/K). The above exercise implies for two primes P and P′ of L above p, the Frobenius elements ϕP|p and ϕP′|p are conjugate in Gal(L/K). If L/K is abelian, then the conjugacy classes of Gal(L/K) are just single elements and the Frobenius ϕP|p ∈ Gal(L/K) does not depend upon the choice of prime P above p. Hence in this case we deﬁne the Frobenius at p to be ϕp = (L/K p ) := ϕP|p ∈ Gal(L/K) where P is a prime of L above p. The symbol (L/K p ) is called the Artin symbol. One can similarly deﬁne the Artin symbol (L/K v ) for any place v of K, which will be some element of Gal(L/K). See [Neukirch] for the complete details. Theorem 8.3.3. (Artin) Let L/K be a ﬁnite abelian extension of number ﬁelds. Let ϖp be a uniformizer for OKp, i.e., an element of OKp such that ordp(ϖp) = 1. Let xp = (αv) ∈ A× K be the idèle such that αv = ϖp for v = p and αv = 1 otherwise. 110 We may take Artin map θK above such that θL/K(xp) = ϕp = (L/K p ) for all primes p of K which are unramiﬁed in L/K. The Artin symbol can be used to describe n-th power reciprocity laws. In order to make sense of this, we should deﬁne n-th power residue symbols (a p) n. This should be 1 if a is an n-th power mod p. But if this is going to be multiplicative, it can’t simply be −1 if a is not an n-th power mod p (think about the case n = 3). What we need is (a p) n should give a group homomorphism into the n-th roots of unity, such that the kernel is precisely the set of n-th powers mod p. In fact because of this, it won’t make sense to deﬁne n-th power residue symbols over Q (or Z), but only over number ﬁelds which contain the n-th roots of unity. Let µn denote the n-th roots of unity. Deﬁnition 8.3.4. Let K be a number ﬁeld containing µn and v be a place of K. The n-th Hilbert symbol ( −, − v ) n : K× v × K× v → µn is given by ( Kv( n√b)/Kv v ) n√b = ϕv( n√b) = ( a, b v ) n n√b. In other words, the Frobenius ϕv = (Kv( n√b)/Kv v ) is an element of Gal(Kv( n√b)/Kv). But the conjugates of n√b in Kv( n√ b)/Kv are just n√b times the n-th roots of unity. Hence ϕv( n√b) is some n-th root of unity times n√b, and we let the n-th Hilbert symbol (a,b v ) n be that root of unity. Theorem 8.3.5. Let K be a number ﬁeld containing µn and v be a place of K. For a, b ∈ K×, we have ∏ v ( a, b v ) n = 1. Proof. We have ∏ v (a, b v ) n n√ b = ∏ v (Kv( n√b)/Kv v ) n√ b = ∏ v θK( n√b)/K(a) n√b. However, any element of K× is in the kernel of the Artin map θK( n√b)/K, so the above must equal n√b and the asserted product formula follows. Deﬁnition 8.3.6. Let a ∈ K× where µn ⊆ K. For p a prime of K, we deﬁne the n-th power residue symbol to be (a p ) n = ( a, ϖp p ) n where ϖp is a uniformizer for Kp. If b ∈ K×, we set (a b ) n = ∏ pi∤n ( a pi )ei n , where (b) = ∏ p ei i ideal of K. 111 It is not too hard to check that ( a p ) n = 1 ⇐⇒ a ≡ xn mod p and more generally (a p ) n ≡ a N (p)−1 n mod p. Theorem 8.3.7. (n-th power reciprocity) Suppose µn ⊆ K×. If a, b ∈ K×, then ( a b ) n = (b a ) n ∏ v|n∞ (a, b v ) n. This follows simply from the above product formula (the previous theorem). See [Neukirch]. In particular, if a and b are prime elements of OK (i.e., they generate prime ideals of OK), and∏v|n∞ (a,b v ) n = 1, then a is an n-th power mod b if and only if b is an n-th power mod a. Corollary 8.3.8. (Quadratic Reciprocity) Let K = Q and n = 2. Let a, b be odd coprime integers. Then ( a b ) 2 (b a ) 2 = (−1) a−1 2 b−1 2 (−1) sgn(a)−1 2 sgn(b)−1 2 , and (−1 b ) 2 = (−1) b−1 2 , ( 2 b ) 2 = (−1) b2−1 8 . Corollary 8.3.9. (Cubic Reciprocity) Let K = Q(ζ3) and n = 3. Suppose p, q are primes (i.e., they generate prime ideals) in OK such that p, q ≡ ±1 mod 3. (If (α) is prime in OK which does not lie above 3, then it has 6 associates, 2 of which are ≡ ±1 mod 3.) Then if p and q lie above diﬀerent primes of Q, we have ( p q ) 3 = (q p ) 3. Hence class ﬁeld theory generalizes quadratic and higher reciprocity laws. 8.4 Non-abelian class ﬁeld theory The n-th power reciprocity law says that if p and q are prime elements of K ⊃ µn, then we can determine whether p is an n-th power mod q based on whether or not q is an n-th power mod p. In particular, we have ( p q ) n = (q p ) n if the product ∏v|n∞ (p,q v ) n = 1. The proof of this reciprocity law is essentially to look at the Artin map θL/K : CK → Gal(L/K) for the extension L/K where L = K( n√a). Since this applies only to abelian extensions, we see the need for the requirement that µn ⊆ K from the point of view of class ﬁeld theory. Speciﬁcally, 112 assuming none of the n-roots of xn − a lie in K, the extension K( n√a)/K is abelian (in fact cyclic of degree n) if and only if µn ⊂ K. Hence if one wanted to extend the n-th power reciprocity law to Q, one would want some sort of non-abelian version of class ﬁeld theory. In fact, one might guess a reciprocity law roughly of the following form: Let f (x) be an irreducible polynomial over Z. If p and q are odd primes not dividing n, then one can determine when f (x) ≡ p is solvable mod q in terms of when f (x) ≡ q is solvable mod p. Indeed this is essentially what n-th power reciprocity says in the case f (x) = xn. Though it seems likely that a “non-abelian reciprocity law” will be more complicated than this. To put the notion of reciprocity in a little more imprecise way, recall that x2 ≡ q mod p has a solution, i.e., x2 − q has a root mod p, if and only if p is split in Q(√q). Similarly if p and q are primes in K, then xn ≡ q mod p has a solution if and only if xn − q has a root mod p, which means p is split in K( n√q). If K( n√q)/K is Galois, i.e., if µn ⊂ K, we can in fact say xn ≡ q mod p if and only if p splits completely in K( n√q)/K. Hence we may think of n-th power reciprocity as a description of which primes split in K( n√q)/K. Class ﬁeld theory can then be thought of as a description of which primes split in an abelian extension L/K. Thus non-abelian class ﬁeld theory, or a non-abelian reciprocity law, should be a description of which primes split in a non-abelian extension L/K. Before we think about what the statement of non-abelian class ﬁeld theory should look like in general, we sketch out an example. Example 8.4.1. (Koike, 1985) Let f (x) be an irreducible polynomial of degree 3 over Q, and let K be the splitting ﬁeld of f (x). Assume Gal(K/Q) ≃ S3 and K contains an imaginary quadratic extension. One can to associate to f (x) the elliptic curve E : y2 = f (x) as well as a corresponding modular form F : H = {z ∈ C : Im(z) > 0} → C F (τ ) = ∞∑ n=1 ane 2πinτ , where the an’s are certain Fourier coeﬃcients which determine the function F (τ ). Let np be the number of solutions #E(Fp) to y2 ≡ f (x) mod p. Then the precise correspondence between E and F is that ap = p + 1 − np. One version of a non-abelian reciprocity law in this case say that, apart from p lying in a ﬁnite set of primes, p splits completely in K ⇐⇒ ap = 2. Hence we can describe the set of primes which split completely in K in terms of either (i) arithmetic data associated to an elliptic curve, or (ii) arithmetic data associated to a modular form. 113 Langlands’ conjecture In order to think about how one might set up a general non-abelian class ﬁeld theory, let’s go back to understanding what (abelian) class ﬁeld theory says. Class ﬁeld theory says there is an isomorphism between the idèle class group CK ≃ AK/K× and Gal(Kab/K), which satisﬁes certain properties. In particular, we have an isomorphism CK/NL/KCL ≃ Gal(L/K) for any ﬁnite abelian extension L/K. If one wants to extend this to non-abelian extensions L/K, we need a “non-abelian class group” G(K) such that we have something like G(K) ≃ Gal(K/K) such that for any ﬁnite extension L/K, we have G(K)/NL/K(G(L)) ≃ Gal(L/K), where NL/K(G(L)) is a certain normal subgroup of G(K) associated to the “non-abelian class group” G(L) of L. It is not clear at present exactly how such a “non-abelian class group” should be constructed, however there are very speciﬁc conjectures if we put things in terms of group representations and L-functions. If G is a locally compact abelian group, we can consider the set of characters, ˆG, consisting of continuous homomorphisms G → S1. The set ˆG is naturally made into a locally compact abelian group, called the dual group of G. Since ˆG ≃ G (in a canonical way), exhibiting an isomorphism CK ≃ Gal(Kab/K) is the same as exhibiting an isomorphism ̂CK ≃ ̂Gal(Kab/K) In fact, if ω is an idèle class character (or Hecke character), i.e., a character of CK, the continuity condition means ω is trivial on some open subgroup N of ﬁnite index, so that ω factors through CK/N , i.e., ω : CK/N → C×. Similarly if χ is a character of Gal(Kab/K), χ factors through a ﬁnite extension χ : Gal(L/K) → C×. Then class ﬁeld theory, in terms of group characters, says that the Hecke characters are in 1 − 1 correspondence with the characters of Gal(Kab/K): { ω : CK/N → C×} 1−1 ←→ {χ : Gal(L/K) → C×} . Of course, this correspondence should be such that N = ker θL/K = NL/K(CL). Moreover, since any character (1-dimensional representation) of the absolute Galois group Gal(K/K) must factor through Gal(Kab/K) (in fact a ﬁnite abelian extension Gal(L/K)), we may state this correspon- dence simply as {Hecke characters ω of CK} 1−1 ←→ { 1-dimensional representations χ of Gal(K/K) } . Now the natural guess for a “higher dimensional,” or non-abelian analogue of this would be to get a correspondence with n-dimensional representations of Gal(K/K) for any n. (Again, by continuity, any given representation will factor through a ﬁnite extension Gal(L/K). Moreover, if n > 1 and the representation is irreducible, then L/K will not be abelian.) The question is, what group should we pick on the left? This was an insight of Langlands (building on the work of many before him). Note that we can view the idèle class group as CK = A× K/K× = GL1(K)\\GL1(AK). 114 (Read the latter as GL1(AK) mod GL1(K). We typically write the mod on the left as above however—we also sometimes write K×\\A× K. Of course in this case our groups our abelian, so it doesn’t matter which side we mod out on, but it will for the non-abelian groups below. The reason for putting mod on the left is because we sometimes want to mod out by another subgroup on the right—of course which goes on the left and which on the right is just a matter of convention.) Conjecture 8.4.2. (Langlands) There is a 1 − 1 correspondence {automorphic representations π of GLn(K)\\GLn(AK)} 1−1 99K ←− { n-dimensional representations ρ of Gal(K/K)} . Roughly, an automorphic representation of a locally compact group G is a irreducible rep- resentation of G on L2(G). The diagonal subgroup GLn(K) ⊂ GLn(AK) is not normal (for n > 1), so the quotient GLn(K)\\GLn(AK) is not actually a group. Hence this requires some explanation. First note if G is a ﬁnite group, L2(G) is just the C-vector space of C-valued functions on G. We can take for a basis {eg}g∈G where eg is the characteristic function of g in G. Hence L2(G) ≃ C[G], the group algebra, and we know C[G] decomposes as a direct sum of the irreducible representations of G. When G is not ﬁnite, things are more complicated, but in any event G acts on the space L2(G) by right multiplication, i.e., g : f (x) → f (xg) for any f ∈ L2(G). In fact if G = GLn(AK), G acts on L2(GLn(K)\\GLn(AK)) in the same way. This representation, the right regular representation on L2(GLn(K)\\GLn(AK)), decomposes into irreducible constituents. What we mean by an auto- morphic representation of GLn(AK) (or GLn(K)\\GLn(AK)) is one of these irreducible constituents. The term automorphic means that the representation is realized on a space of automorphic forms, which are functions on GLn(AK) invariant under GLn(K). Langlands’ conjecture states that to each n-dimensional Galois representation ρ : Gal(K/K) → GLn(C), there is associated (in a way we shall describe below) an automorphic representation π = π(ρ) of GLn(AK). However in general there will be more automorphic representations than n-dimensional Galois representations, i.e., not every automorphic representation will correspond to a Galois representation. This is indicated by the dashed arrow going from left to right in the conjecture above. However in the case n = 1, the left hand side is just the set of Hecke characters of CK, and there is an honest 1 − 1 correspondence between these two sets of representations in this case, which is precisely class ﬁeld theory. This conjecture of Langlands suggests that the conjectural group G(K) should contain in some way each GLn(K)\\GLn(AK), so that the representations of G(K) correspond to all Galois repre- sentations. However this situation is even more ambiguous than the state of Langlands’ conjecutre above, and in any case understanding the conjecture above would be extraordinary progress to developing a non-abelian class ﬁeld theory. For these reasons, we will spend the rest of our time trying to explain what the above conjecture means. L-functions To describe the conjecture of Langlands above∗, one needs to specify exactly how the represen- tations should correspond. The answer comes via the construction of L-functions associated to each representations. Let’s ﬁrst see what happens in the case n = 1. ∗This conjecture is also called the strong Artin conjecture or the modularity conjecture. Indeed Langlands made a series of far-reaching related conjectures, so if one just says “Langlands conjecture,” it is not always clear which one is being referred to. 115 Suppose χ is a 1-dimensional representation of Gal(K/K). Then χ factors through a ﬁnite abelian extension χ : Gal(L/K) → C× = GL1(C). If p is a prime of K, recall we have a Frobenius element ϕp ∈ G(P|p) ⊆ Gal(L/K) where P is a prime of L above p. Then we deﬁne the L-function associated to χ to be L(s, χ) = ∏ p unram 1 1 − χ(ϕp)N (p)−s . One can regard this as a generalization of the Dirichlet L-series, as specializing to the case K = Q and L = Q(ζm) gives the Dirichlet L-functions mod m. On the other hand, if ω is a Hecke character ω : CK = K×\\A × K → C×, we can view ω as a character of A× K which is trivial on K×. This gives a character ωv : K× v → C× for any place v of K simply by restricting to the v-component of A × K. Speciﬁcally ωv(xv) = ω(1, . . . , 1, xv, 1 . . .) where the xv occurs in the v-th place. Then one can think of ω = ∏v ωv. When v = p, we say ωp is unramiﬁed if ωp is trivial on O× Kp. Then one can deﬁne the Hecke L-function L(s, ω) = ∏ ωp unram 1 1 − ωp(ϖp)N (p)−s , where ϖp is a uniformizer for OKp. We say the Galois character χ and the Hecke character ω correspond if L(s, χ) = L(s, ω), i.e. if χ(ϕp) = ωp(ϖp) for each unramiﬁed p. This is the L-function interpretation of class ﬁeld theory. This explicit correspondence of L-functions is amounts the explicit description of the Artin map. Now we can deﬁne L-functions for higher-dimensional representations. Let ρ : Gal(K/K) → GLn(C) be an n-dimensional Galois representation. Continuity of ρ means there is a ﬁnite extension L/K such that ρ restricted to the subgroup Gal(K/L) is trivial, i.e., ρ factors through ρ : Gal(L/K) → GLn(C). For any prime p of K and P of L with P|p, we have a surjective homomorphism G(P|p) → Gal((OL/P)/(OK/p)). Recall the group on the left, the decomposition group of P|p, is just the subgroup of Gal(L/K) which stablizes P. If the inertial degree f (P|p) = 1, in particular if p is unramiﬁed in L/K, then this 116 map is an isomorphism and the group on the right is generated by F rq : x → xq where q = N (p). In this case, the Frobenius element ϕP|p ∈ G(P|p) ⊆ Gal(L/K). Since all the primes of L lying above p are conjugate in Gal(L/K), all the elements ϕP|p are conjugate as P ranges over the primes above p. We let the Frobenius ϕp = ϕP|p for some P, so this is well-deﬁned up to conjugacy. Of course if L/K is abelian, each element is its own conjugacy class, and ϕp is well-deﬁned as an element of Gal(L/K). Since almost all primes p of K are unramiﬁed, we can deﬁne the (partial) Artin L-function by L(s, ρ) = ∏ p unram 1 det(In − ρ(ϕp)N (p)−s) . Note even though ϕp is only well deﬁned up to conjugacy in Gal(L/K), the quantity det(In − ρ(ϕp)N (p)−s) is well deﬁned because the determinant is invariant under conjugation. We say this is a partial L-function because the full or completed Artin L-function is actually deﬁned as a product of terms over all places v (including the archimedean ones), but the partial and the full L-function only diﬀer by a product of ﬁnitely many terms (which are well understood). For simplicity we will not deﬁne the full L-function, but just mention that at unramiﬁed primes p, one needs to take into account the kernel of the map G(P|p) → Gal((OL/P)/(OK/p)), called the inertial subgroup of G(P|p). Let π be an automorphic representation of GLn(AK) ⊂ ∏v GLn(Kv). Then π = ⊗πv where each πv is a representation of GLn(Kv). For v = p, we say πp is unramiﬁed if πp restricted to the subgroup GLn(OKp) is trivial. At such a place, πv is induced from n 1-dimensional representations ω1, . . . , ωn placed on the diagonal subgroup of GLn(Kv). Set A(πv) = diag(ω1(ϖp), . . . , ωn(ϖp)). Then we deﬁne the (partial) automorphic L-function L(s, π) = ∏ πp unram 1 det(In − A(πp)N (p)−s) . Now we can restate Langlands’ conjecture above in more precise terms Conjecture 8.4.3. (Langlands) There is a 1 − 1 correspondence {automorphic representations π of GLn(AK)} 1−1 99K ←− { n-dimensional representations ρ of Gal(K/K)} such that L(s, π) = L(s, ρ), i.e., for almost all primes p of K, we have det(In − A(πp)N (p) −s) = det(In − ρ(ϕp)N (p) −s). (If the local factors—called local L-factors or local L-functions—agree for L(s, π) and L(s, ρ) for almost all places, one can show that the local factors (in the completed L-functions) will all be the same.) The ﬁrst application of Langlands program (this program of attaching automorphic representa- tions to Galois representations, which has grown into a much more general setting than what we have presented) is to the following. 117 Conjecture 8.4.4. (Artin) Let ρ : Gal(K/K) be an irreducible nontrivial Galois representation. Then L(s, ρ) is entire. If ρ is trivial, then L(s, ρ) = ζK(s), the Dedekind zeta function of K, has a pole at s = 1. If ρ is not trivial, Artin conjectures L(s, ρ) is entire, i.e., it has no poles. (The L-function as deﬁned, converges for Re(s) large, but is known to have meromorphic continuation to the whole complex plane.) If ρ is 1-dimensional, then this is known because ρ = χ corresponds to a Hecke character ω, and the Hecke L-functions L(s, ω) for nontrivial ω are known to be entire. It is also easy to see that if ρ is induced from a 1-dimensional representation χ, then L(s, ρ) = L(s, χ) so L(s, ρ) is entire. Not much was known about Artin’s conjecture for higher dimensional representations. However, it is known that if π is a cuspidal automorphic representation, then L(s, π) is entire, so if ρ ↔ π, then L(s, ρ) is also entire. (Any automorphic representation corresponding to a nontrivial irreducible Galois representation will be cuspidal.) Hence Langlands conjecture implies Artin’s conjecture, wherefore the above conjecture of Langlands is sometimes called the strong Artin conjecture. (In fact, the strong Artin conjecture and the Artin conjecture are known to be equivalent in the case of 2 or 3 dimensional representations. It is not clear if they should be equivalent in higher dimensions.) The ﬁrst success of the Langlands program is the following result. Theorem 8.4.5. (Langlands, Tunnell) Suppose ρ : Gal(L/K) → GL2(C) is an irreducible 2- dimensional representation. If the image of ρ is solvable (a solvable subgroup of GL2(C)), then ρ ↔ π for some cuspidal automorphic representation π of GL2(AK). This gave new instances of Artin’s conjecture. We remark that Artin’s conjecture, together with the Grand Riemann Hypothesis (the analogue of the Riemann Hypothesis for more general L-functions), yields estimates for the error term in the prime number theorem. However, there is a much more famous consequence of this theorem of Langlands and Tunnell— Fermat’s Last Theorem. Very roughly, Frey, Ribet and Serre showed that Fermat’s Last Theorem follows from the Taniyama–Shimura conjecture, which says that to each elliptic curve over Q, there is an associated modular form, in the sense that their associated L-functions are equal. To prove Taniyama–Shimura, one associates to an elliptic curve E a family of p-adic Galois representa- tions ρp : Gal(Q/Q) → GL2(Qp). This much is not diﬃcult. Wiles essentially showed that (for “semistable” E, which is suﬃcient for Fermat’s Last Theorem) one can (reduce to a case where one can) further associate to E a 2-dimensional complex Galois representation ρ : Gal(Q/Q) → GL2(C), where ρ has solvable image. Then Langlands–Tunnell applies, and ρ (and hence the elliptic curve E) corresponds to an automorphic representation π of GL2(AQ). This representation π is naturally associated to some modular form f , and this gave Taniyama–Shimura (for semistable curves, which was enough for Fermat’s last theorem—the general case was ﬁnished later), and hence Fermat’s last theorem. 118 References As needed, I will periodically update these references throughout the semester. [Borevich–Shafarevich] Borevich, A. I.; Shafarevich, I. R. Number theory. Translated from the Russian by Newcomb Greenleaf. Pure and Applied Mathematics, Vol. 20 Academic Press, New York-London 1966. [Buell] Buell, Duncan A. Binary quadratic forms. Classical theory and modern computations. Springer- Verlag, New York, 1989. [Cassels] Cassels, J.W.S. Rational quadratic forms, Academic Press, 1978. [Cohn] Cohn, Harvey. Advanced number theory. Reprint of A second course in number theory, 1962. Dover Books on Advanced Mathematics. Dover Publications, Inc., New York, 1980. [Cohn2] Cohn, Harvey. A classical invitation to algebraic numbers and class ﬁelds. Universitext. Springer-Verlag, New York-Heidelberg, 1978. [Cohn3] Cohn, Harvey. Introduction to the construction of class ﬁelds. Corrected reprint of the 1985 original. Dover Publications, Inc., New York, 1994. [Cox] Cox, David A. Primes of the form x2 + ny2. Fermat, class ﬁeld theory and complex multipli- cation. A Wiley-Interscience Publication. John Wiley & Sons, Inc., New York, 1989. [Dirichlet] Dirichlet, P. G. L. Lectures on number theory. Supplements by R. Dedekind. Translated from the 1863 German original and with an introduction by John Stillwell. History of Mathematics, 16. American Mathematical Society, Providence, RI; London Mathematical Society, London, 1999. [Frolich–Taylor] Fröhlich, A.; Taylor, M. J. Algebraic number theory. Cambridge Studies in Advanced Math- ematics, 27. Cambridge University Press, Cambridge, 1993. [Gerstein] Gerstein, Larry J. Basic quadratic forms, Graduate Studies in Mathematics, 90. American Mathematical Society, Providence, RI, 2008. [Hurwitz] Hurwitz, Adolf. Lectures on number theory. Translated from the German and with a preface by William C. Schulz. Translation edited and with a preface by Nikolaos Kritikos. Universi- text. Springer-Verlag, New York, 1986. [Iwaniec] Iwaniec, Henryk. Topics in classical automorphic forms. Graduate Studies in Mathematics, 17. American Mathematical Society, Providence, RI, 1997. [Janusz] Janusz, Gerald J. Algebraic number ﬁelds. Second edition. Graduate Studies in Mathematics, 7. American Mathematical Society, Providence, RI, 1996. [Kato–Kurokawa–Saito] Kato, Kazuya; Kurokawa, Nobushige; Saito, Takeshi Number theory. 1. Fermat’s dream. Translated from the 1996 Japanese original by Masato Kuwata. Translations of Mathematical Monographs, 186. Iwanami Series in Modern Mathematics. American Mathematical Society, Providence, RI, 2000. 119 [Landau] Landau, Edmund. Elementary number theory. Translated by J. E. Goodman. Chelsea Pub- lishing Co., New York, N.Y., 1958. [Lang] Lang, Serge. Algebraic number theory. Second edition. Graduate Texts in Mathematics, 110. Springer-Verlag, New York, 1994. [Marcus] Marcus, Daniel A. Number ﬁelds. Universitext. Springer-Verlag, New York-Heidelberg, 1977. [Martin] Martin, Kimball. Non-unique factorIzations and principalization in number ﬁelds, Preprint. [Murty–Esmonde] Murty, M. Ram; Esmonde, Jody Problems in algebraic number theory. Second edition. Grad- uate Texts in Mathematics, 190. Springer-Verlag, New York, 2005. [Narkiewicz] Narkiewicz, Wladyslaw Elementary and analytic theory of algebraic numbers. Third edition. Springer Monographs in Mathematics. Springer-Verlag, Berlin, 2004. [Neukirch] Neukirch, Jürgen. Algebraic number theory. Translated from the 1992 German original and with a note by Norbert Schappacher. With a foreword by G. Harder. Grundlehren der Mathematischen Wissenschaften [Fundamental Principles of Mathematical Sciences], 322. Springer-Verlag, Berlin, 1999. [Ono] Ono, Takashi. An introduction to algebraic number theory. Translated from the second Japanese edition by the author. The University Series in Mathematics. Plenum Press, New York, 1990. [Ramakrishnan–Valenza] Ramakrishnan, Dinakar; Valenza, Robert J. Fourier analysis on number ﬁelds. Graduate Texts in Mathematics, 186. Springer-Verlag, New York, 1999. [Scharlau–Opolka] Scharlau, Winfried; Opolka, Hans From Fermat to Minkowski. Lectures on the theory of numbers and its historical development. Translated from the German by Walter K. B§hler and Gary Cornell. Undergraduate Texts in Mathematics. Springer-Verlag, New York, 1985. [Serre] Serre, J.-P. A course in arithmetic. Translated from the French. Graduate Texts in Mathe- matics, No. 7. Springer-Verlag, New York-Heidelberg, 1973. [Stewart–Tall] Stewart, Ian; Tall, David. Algebraic number theory and Fermat’s last theorem. Third edition. A K Peters, Ltd., Natick, MA, 2002. 120","libVersion":"0.3.1","langs":""}
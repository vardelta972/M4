{"path":"iCloudDrive/bks/Number Theory/NT Calvin.pdf","text":"ELEMENTARY INTRODUCTION TO NUMBER THEORYEEEE’QN Calvin T. Long WashingtonState Universit PRENTICE—HALL, INC.,EnglewoodCli ﬂ 's, NewJersey 07632 Library ofCongress Cataloging-in—Publication Data LONG, CALVIN T. Elementary introduction to numbertheory. Bibliography:p. Includes index. 1. Numbers, Theory of. I. Title. QA241.L661987 512’.7 86-2537 ISBN 0-13-257502-7 Editorial/producti supermanand interior design:% Cover design: Photo Plus Manufacturing buyer: JohnB. Hall Cover illustration:Pascal’s triangle modulo2 givesa triangle Withln“11311316 withina triangle ad in ﬁ nitum. © 1987, 1972, 1965 by Prentice-Hall, Inc., Englewood Cliffs, NewJersey 07632 Allrights reserved. No part ofthis book maybe reproduced, inany form orby anymeans, withoutpermission in writing fromthe publisher. Printed inthe UnitedStates ofAmerica 10 9 8 7 65 43 21 ISBN D-lEI-E'575lJE-7 Ell PRENTICE-HALL INTERNATIONAL (UK)LIMITED, London PRENTICE-HALLOF AUSTRALIA PTY. LIMITED, Sydney PRENTICE-HALL CANADA INc., Toronto PRENTICE-HALL HISPANOAMERICANA, S.A., Mexico PRENTICE-HALLOF INDIAPRIVATE LIMITED, New Delhi PRENTICE-HALLOF JAPAN, INc., Tokyo PRENTICE-HALLOF SOUTHEAST ASIAPTE. LTD., Singapore EDITORA PRENTICE—HALL DoBRASIL, LTDA., Riode Janeiro WHITEHALLBOOKS LIMITED, Wellington, New Zealand Contents PREFACE 1. PRELIMINARY CONSIDERATIONS 1.1 Summation and Multiplication Notation2 1.2 Inductive Reasoning and the FibonacciSequence8 1.3 The Postulates ofMathematical Induction and Well-Ordering13 1.4 Mathetical Induction14 1.5 The Well—Ordering Principle21 1.6 Equivalence ofthe Principles ofInduction and Well-Ordering 23 1.7 The Division Algorithm24 1.8 Positional Notation26 1.9 Computational Complexity33 2. DIVISIBILITY PROPERTIES OF INTEGERS 2.1 Basic Properties 39 2.2 The Greatest Common Divisor41 2.3 The Euclidean Algorithm42 2.4 The Least Common Multiple49 2.5 The Fundamental Theorem ofArithmetic53 2.6 Pythagorean Triples59 2.7 The Greatest Integer Function62 3. PRIME NUMBERS 3.1 The Sieve ofEratosthenes 70 vii 39 70 Contents 3.2 The In ﬁ nitude ofPrimes 72 3.3 The Prime NumberTheorem77 3.4 Mersenne, Fermat, and Perfect Numbers81 CONGRUENCES 87 4.1 Basic De ﬁ nitionsand Properties88 4.2 Special DivisibilityCriteria96 4.3 Reduced Residue Systems and the EulerqS-Function98 4.4 Pseudoprimes andTests for Primality105 4.5 Some Contacts withAbstract Algebra109 CONDITIONAL CONGRUENCES 112 5.1 LinearCongruences 112 5.2 The Chinese Remainder Theorem117 5.3 PolynomialCongruences ofDegree Greater than1 124 5.4 Theorems ofLagrange and Wilson129 5.5 Quadratic Congruences133 5.6 The Quadratic Reciprocity Law ofGauss136 5.7 PrimitiveRoots, Indices, and PowerResidues148 CRYPTOGRAPHY 1 58 6.1 Caesar Ciphers 159 6.2 Exponentiation Ciphers163 6.3 Public Key EncryptionSystems 166 SUMS OF SQUARES 171 7.1 Sums ofTwoSquares171 7.2 Sums ofMore than TwoSquares 176 7.3 Waring’s Problem181 Contents 8. MULTIPLICATIVE NUMBER-THEORETIC FUNCTIONS 8.1 De ﬁ nitions185 8.2 Notation187 8.3 Multiplicative Number-Theoretic Functions189 8.4 The Mobius Inversion Formula193 8.5 The Euler ¢-Function196 8.6 Other Inversion Formulas 200 8.7 A Further Inversion Formula206 9. SIMPLE CONTINUED FRACTIONS 9.1 Finite Simple Continued Fractions 210 9.2 Convergents 214 9.3 In ﬁ nite Simple Continued Fractions221 9.4 Periodic Simple Continued Fractions225 9.5 Approximation ofIrrationals by Rationals 230 REFERENCES Number Theory 233 Number Theory and Computing 234 Cryptography 234 ComputerScience 234 TABLES Table ofPrime NumbersLess than10,000 235 Factorizations ofPositive IntegersLess than1000 239 Table ofIndices forPrimes p,3 S p S199 244 ANSWERS TO SELECTED PROBLEMS INDEX 185 209 233 235 253 290 PrefaceTo The Third Edition In writing this third editionthe attempthas been made to maintainthe text’sappeal for mathematics and mathematics education majors andalso tomake itattractive and useful for computerscience majors. Fortunately,these goals are not antitheti- cal. The opportunity to investigate mathematicalideas experimentallyusinga com- puter not onlyenhances analytic and computationalskills butalso gives anadded dimension to problem solving. Aswe all know,the thrillofdiscoveryis veryreal and many ofthe computerexercises at the end ofeach sectionhave been designed to provide precisely this opportunity.Also, itis ourexperience thatthe activity of writing computer programs to implementsuchprocessesas, forexample, the Euclid- ean algorithmis very effective in ﬁ xingtheideas instudents’ mindsand inenhancing understanding. Beyond the addition ofcomputer-orientedproblems, arguments have been altered tostress computationalaspects whenpossible and entirenew sections have been added. These includea briefdiscussion ofcomputationalcom- plexity, some comments on currentaspects ofprimalitytesting and factoring, anda short chapter on publickey encryption. Certain otherchanges shouldalso be noted. Tokeep the text fromgrowing unreasonably large, sections suchas the one on decimalexpansions ofreal numbers have been dropped entirely and othersections and problemsets have been short- ened. Also, arguments have been shortened and simpli ﬁ edwheneverpossible. This applies particularly tothe discussion ofmth-powerresidues, where the proofshave been both shortened and simpli ﬁ ed bytheuse ofindices. Inthis connection,a table ofindices for primes p with3 sp s199 has nowbeen includedat the back ofthe book. Isuggest that the reader consultthepreface tothesecond edition forcomments regarding material that mightbe covered inone-quarter orone-semestercourses. Of course, since the bookis intentionallysmall, thereis inadequate material fora full-yearcourse, and perhaps notenough fora fulltwoquarters. Finally, in addition tothe acknowledgments intheprefaces to boththe ﬁ rstand second editions, itis proper that Iagainexpress my obligation to both myown students and tothose whohave used the textat othercolleges and universities. They have not onlyenabled me tocatch small errors and obscurities buthave evensug- gested two orthree alternative andeasier arguments. Iamalso particularlyapprecia— tive of helpfulsuggestions fromProfessor G. L. Alexanderson andProfessor Lawrence Egan. The textis betterbecause oftheirhelp; Ifear that Iam still responsible for its shortcomings. C. T.L. vii PrefoceTo The Second Edition The second edition differs fromthe ﬁ rst inseveral signi ﬁ cantways. In the ﬁ rstplace, various proofs and parts ofthe discussion inthe ﬁ rst edition have been rewritten orreplaced inorder toremove ambiguitiesand tomake the text more readable. Secondly, the number ofproblemshas been more than doubledso that well over 600 are now included. And, thirdly,twonew chapters, one onsums of squares and Waring’s problem and one on simple continuedfractions,have been added to providea wider variety oftopics, particularly forthose teachingone-semes- ter courses. Additionally,some ofthe problems, theorems, andone or twoentiresections have been starred to indicate thattheyare more dif ﬁ cult. Thisis invariablytrue of those parts which involvethe calculus, andsuch materialcanbe safely disregarded if the students lack thenecessary background. Atthesame time itseems appropriate to include such materialas the prime numbertheorem and Ialways attempt tocover the section at whatever depth the background ofthe immediateaudience indicates. Fora one-quartercourse, Iwouldsuggest thatone cover Chapter1, Chapter2, appropriate parts ofChapter3, Chapter4, and Chapter5 throughthe law ofquadratic reciprocity. Forsemester courses or ifonehas additional time ina one-quarter course, I wouldsuggest thatone cover the above mentioned materialplussuch parts ofthe last fourchaptersas seem most attractive.Since the last three chaptersare independent ofone another, maximum ﬂ exibilityis allowed. Finally, in addition tothe acknowledgments inthepreface tothe ﬁ rst edition, I must again acknowledgea considerable debt both to myownstudents and tostudents who have used the textat othercolleges and universities who, by theirquestions and responses, have enabled me to clarifyobscurities at many points inthe text. Also, I am particularly grateful forthe many helpfulcriticismsandsuggestions fromProfes- sors Evelyn Frank, John Olmsted,Eugene Maier,LawrenceEggan, EckfordCohen, and FrankPalas. While Ihave not invariablyadopted theirsuggestions, Ihave in many instances. Theydeserve much ofthe credit forimprovement inthe text; Imust take the responsibility forthe short-comings thatremain. C. T.L. PrefaceTo The First Edition This bookis designed fora one-semester course inthe theory ofnumbersata level somewhat below that ofthe usual introductorycollege course. Itis the result ofthe eight-year development ofa course taught toundergraduate mathematics and math- ematics-education majors at the sophomore-juniorlevel and to participants inNa- tionalScience Foundation Summer Institutes. Except inChapter3, no background is presumed other than the equivalent ofa course incollege algebra. Inparticular, knowledge ofthe calculusis notpresumed except intwosections ofChapter3, and those results depending on the calculus maybe omitted bystudents lacking this background. The textshould prove tobe particularlyappropriate foruse inteacher pre-service and in-service trainingprograms. In attempting to make the materialaccessible tothe intendedaudience, an efforthas been made togive especially complete and detailed arguments, illustrating de ﬁ nitions, theorems, and subtleties ofproof withexplicitnumericalexamples when- ever possible. An attempthas also been made toorganize theresults and construct the arguments insucha wayas toreveal theessential structure ofthe subject and to impartan understanding ofthe various methods ofproofas methods rather than tricks. Since learning mathematics involves doing mathematics,some 300 exercises have been distributed throughoutthe textattheends ofthesections. These range in dif ﬁ culty from simple numerical problems and direct applications ofresults inthe text to extensions ofthe theory and toexercises whichendeavor tolead the student to discover results forhimself. Many oftheexercises contain hints toaid the student in ﬁ nding solutions. Answers toselected exercises, includingmanyproofs,are given at the back ofthe book. Innocase is the development ofthe theorymade todepend on the result ofan exercise. Since this bookis intentionallysmall,some ofthe topics usually treated inan introductorycourse have been omitted.Thosediscussed were chosenbecause they are basic to any study ofthe theory ofnumbers andbecause theyhave proved tobe of special interest to the authorand his students. The discussion ofmathematical induction and well-ordering inChapter1, a topic notusuallycovered insucha course, is treated here inconsiderable detailsince students at the sophomore-junior level frequentlyhave onlythe most rudimentaryknowledge ofthese importantand useful ideas. Ofnecessity, the discussion ofprimenumbers inChapter3 is largely expository, but itwas felt thatthe notions involvedareso intrinsicallyinteresting that they shouldbe presented inas much detailas possible. Thediscussion ofmultiplica- xi xii Preface tive number-theoretic functions inChapter8 leads toa particularlynice derivation of the formula for ¢(n)and tosome interesting generalizations. In an effort to impartsomesense ofhistoricalperspective, many ofthe theorems and proofs have been attributed to theirdiscoverers, although no efforthas been made tobe complete inthis detail. Iamalso indebted to many otherwriters, to colleagues, and tostudents, all ofwhomhave had an in ﬂ uence onthe development of this book. Particular thanksare due toProfessorJames H. Jordan, who carefully read the original manuscript ando ﬂ 'ered many helpfulcriticisms. Finally, Iwould like to acknowledge mydebt ofgratitude toProfessor Ivan Niven,whose excitingand impeccable lectures ﬁ rst introducedme to this delightfulstudy. Itis myhope that some ofthatsamesense ofexcitementhas been captured inthesepages and willserve to arouse instudentsa desire forfurtherstudy. Pullman, Washington CalvinT. 'Long 1 Preliminary Considerations Number theoryis one ofthe most appealing and estheticallypleasing ofallbranches ofmathematics. Carl FriedrickGauss (1777 -1855), one ofthegreatest mathemati- cians, physicists, and astronomers ofall time,once remarked that “mathematicsis the queen ofthe sciences, but number theoryis thequeen ofmathematics.” Again referring to number theory,Gauss extolled “theenchantingcharms ofthis sublime science.. . .”As the reader is almost surelyaware, mathematicshas a substance and beauty all its own, and itis this quality thathas continuallyattracted the attention ofpeople suchas Gauss. The matteris wellsummed up by W.F. White,who wrote: “The beautifulhas its place inmathematics forhere are triumphs ofthe creative imagination, beautifultheorems, proofs andprocesses whose perfection offormhas made them classic. He mustbea ‘practical’ man whocansee no poetry inmathe- matics.” Beauty, ofcourse, isa matter oftaste and itis not foranyone todetermine the taste ofanother. Yetsurprisingresults, economicallystated and subtly proved,have been a source ofpleasure and satisfaction tothe human mindthroughouttheages. Our hope is thatreaders willderive similarenjoyment fromthe followingpages. Not all ofthe succeeding theoremscan appropriatelybe classedas beautiful, nor are all the proofs neat andelegant, butthe theory ofnumbershas more than its fair share ofsuch results. Itisa fascinating study and ourhope is thatas readers ofthis book penetrate more deeply into it,they too willbe pleasantly surprised andpleased at the statement ofa theorem orthe turn ofa proof.Even more,we hope thatthey may know the special pleasure ofdiscovering and provingresults forthemselves. But there are otherreasons forstudying number theory quiteapart from intel- 1 2 Preliminary ConsiderationsChap.1 lectual satisfaction. In our modern computer-orientedsociety itis widelyrecognized that discrete mathematics, ofwhich number theoryis an integral part,is increasingly the applicable mathematics oftheday. Importantnotions incomputerscience which depend in signi ﬁ cantways on number-theoreticresults includelarge integer arithmetic; binary, octal, and hexadecimal representations ofintegers; factoring in- tegers; generation ofpseudo-random numbers; recursion; computationalcomplex- ity; cryptography, including public-key encryptionsystems, and muchmore. In- deed, the references to number-theoreticideas in Donald Knuth’s de ﬁ nitive three-volume work,The Art ofComputer Programming,are legion, and itissafe to say that no one ignorant ofnumber theorycanbea serious student ofcomputer science. Finally,we note thatthe art ofsolving problemsis ofparamount importance to students ofboth mathematics and computerscience. Howdoes one reasonably proceed to analyze an unusual situationnever encounteredbefore, topose itas a well-de ﬁ ned problem, and then tosolve it? Theanswer tothisquestionis dif ﬁ cult, indeed, since thereare manyapproaches and diverse heuristics, and itis rarelyclear which willbe effective at any given time.Perhaps thebest way tobecomea capable problem solveris tosolve many nonroutineproblems, anda course innumber theory provides ample opportunity topractice this skill. Solving problemsand proving theorems can certainlybe frustrating, butas one’s skillimprovesand insightand ingenuity increase, the activitycan also be the source ofgreat satisfaction. Thus,a ﬁ nal hope for ourreaders is thatthey willcome increasingly to enjoy thisspecial pleasureas they grapple withthe interesting problems withwhichthe theory of numbers is replete. 1.1 SUMMATION AND MULTIPLICATION NOTATION From time to timeas ourdevelopmentproceeds we shallhave occasion touse special notation to simplifythe writing ofsums and products. The notationis standard but it may notbe amiss to begin ourstudy by reviewing itsessential features. Summation Notation For r Ss, we use 2,2,(I, torepresent the sum a,+a,+l +' '‘ +615; s and rare called the upper and the lower limits ofsummation,and iis called the index of summation. Forexample, 4 2ai=ao+al+a2+a3+a4 i=0. Sec.1 .1 Summation and Multiplication Notation 3 and analogously, 3 21?:12+22+32. j=l The idea is to replace the index ofsummation intheexpression being summed by consecutive integers, starting withthe lower limit ofsummationand stopping with the upper limit,and then toadd the resultingexpressions. With this in mind, itis not difficulttoderivea number ofinterestingresults ofa general nature. Ineach ofthe followingcases, we shalluse1 andn forthe lowerand upper limits, but itis clear thatany integers rands couldbe used justas well. Firstwe consider Edibi=albl+a2b2+' ' ' +anbn. (1.1) i=1 Ifwe setbi=kfori=1,2,.. . ,nin(l.1),weobtain Ekai=k'Edi. (1.2) i=1 i=1 This simply notes thata constant factor (independent ofthe index ofsummation)can be factored out ofthe entire summation. Moreover, ifa,- = las wellasb,- =kforeach i=1, 2,.. .,nin(1.1),we obtain 2\"; k =nk. (1.3) i=1 Thus, the summation ofa constant(i.e.,a quantityindependent ofthe index of summation)is equal tothe value ofthe constant times the number ofvalues the index assumes. Forexample, 17 5 23=3~13=39and 27b=42b. i=5 j=0 Itis sometimesnecessary touse multiplesummation. Ifk =b jin(1 .2), we have iaibj=bj' iai, (1.4) i=1 i=1 and ifwe now sum bothsidesas jruns from1 tom,we obtain iﬁ a,b,=§(bj- ﬁ ai).(1.5) j=li=1 i=1j=1 Since with regard tothe summation on j,the entiresum 2%;a,- is constant, itfollows from (1.2) that 4 Preliminary Considerations Chap.1 Combining this with(1.5), we obtain the very importantresult m n Ezaibj=iai' ibj.(1.7) i=1 j=lj=li=1 Another importantand useful summation formulais i0h+h ﬁﬂ m+bo+wr+m%t”'4%%+b0 i-l =(a,+---+a,,)+(b,+---+b,,)(1.8) =iai+ibi. i=1 i -l Multiplication Notation For r Ss, we use S Ha: i=r to represent the product ofthe numbers a,, (1,“,. . . , as. Forexample, 5 Hai=ala2a3a4a5 i=1 and n n! = Hi. 1\"“1 As in thecase ofsums, itis possible toderivea number ofuseful formulas for special types ofproducts. As before, weuse It and1 forupperand lower limitsinthe following products, but other limitscanbe used justas well. The derivations ineach case are analogous totheones forthe correspondingsums. Inthe ﬁ rstplace, ﬁ mm=mmmws~-mm» i=1 =(a1a2. '. anXbIbZ' ' 'bu) (19) = ﬁ ai' ﬁ bi' i=1 i“! Ifwe setbi=kfori=l,2,. . . ,nin(1.9),weobtain ﬁ kai=k”- ﬁ ai. (1.10) i=1 i‘l Sec. 1.1 Summation and Multiplication Notation 5 Moreover, ifweset ai=1for i=1, 2,.. . , n in(1.10),we obtain ﬁ k=k\", (1.11) i=1 whichsays that the product ofa constantis equal tothe constantraised toa power equal to the number ofvalues thatthe index ofmultiplicationassumes. As examples ofthe preceding results, we note that ﬁ i(i+1)= ﬁ i- ﬁ (i+l) i=1 i=1 i-l =n!(n + l)!, that ﬁ 21=2\"-n1, i-l and that 132:2». i‘l One ﬁ nal result concerning productsis suggested by(1.9). Ifa,- =b,-, then(1.9) becomes n n n n 2 Ha§= ﬂ ai'Ha,~=( ai). i-l i-l i-l i-l This suggests that, ingeneral, n n k Haf=<Hai). (1.12) i-l i-l The easy proof ofthisis left tothe readeras Exercise10 ofSection1.4. Finally,we observe that itis often useful tomakea change ofindices ineither summations or products muchas onechanges variables inalgebra or inintegration problems incalculus. Forexample, ifweset j+1 =i,we have that $12=§(1+1)2; (1.13) i=1 j-O in bothcases we are referring tothe sum 12+22+32+- - - +r2. (1.14) Note that to transform the ﬁ rstsum in(1.13) intothesecond we replace the iini2 by j+1 to obtain (j+1)2 and adjust the limitsby noting thatwhen i =1, j=0 and when i =r, j= r— 1. As an additionalexample,suppose thatweset i =r— k. Then 6 Preliminary ConsiderationsChap.1 when i =1, k = r—1 and when i =r, k =0. Thus, substituting r— kforionthe left side of(1.13), we obtain r 212: 20— k)2=2(r-k)2(1.15) i'l k=r-l k-O since a sum is the same ifwe sum either forward orbackward. Inthiscase the substitutionseems tomake the sum more involved, butthe idea is importantand the device ofsubstitution ofindices is often useful inmanipulating withsums and products. EXERCISES1.1 1. Write out the followingsums. 6 0 (a)25; (21‘— 1) (b) 2sin ix(c) 2111‘) i-l i-o i-O 10 (d)j;1j(j+l)(6)2353 (02;? 2. Use the change ofindices1' = j+1 to rewritethe summations inExercise 1(a)—(d). 3. Write the following insummation notation. (a) 2+4+6+8+10 (b) 1+8+27+64+125 (c) 28+31+34+37+40+43 (d) n+(n+2)+(n+4)+'- - +(n+2m) 4. Evaluate 21-1 (ai— aH)given thatdo =0. 5. Use the result ofExercise 4 toprove thatEll-1 i =n(n +l)/2. Hint: Let ai= i(i+1)/2. 6. Use the result ofExercise 4 toprove that 2\": i(i +1) =n(n +l)(n +2)/3. i=1 7. With only slight modi ﬁ cations, the equations inExercises5 and6 couldhave been written inthe form .(i)=(\"‘§‘)and é<i3‘)=(”§2)’ (n) _n! k _k!(n— k)!'M= where Sec.1 .1 Summation and Multiplication Notation 7 10. ll. 12. 13. 14. 15. 16. 17. is the usual binomialcoe ﬂ icient notation. Whatmoregeneral resultdothese suggest? . Use simple algebraic manipulation toshow that (n>+<n )=n+1 k k+1 k+1 for all integersn and kwith0 S ksn. \" i+k—1 n+k 2(k )‘(kH)’ where n and kare integers withn 21 and k 20. Note that itis customary toset . Prove that Z) =0 forintegers a and bif0Sa <b. n i . . Evaluate E (k)where n and kare nonnegativeIntegers. i-O Hint: Note that (1:) =0for OS1' <kanduse the substitution i = j+ k— 1, where jis the new index ofsummation. Use the results ofExercises5 and6 toderivea formula for n 21\". i=1 Write out the followingproducts: 4 5. (a) Haj—1) (b) [hf1 .i'l j-O p+n 2. (c) H i (d) H6\" ”=p i-2 Use the change ofindices i= j—1 to rewrite allthe products inExercise12. Write the following in product notation. (a) 2-4-6-8-10-12 (b) (\"1)\" ' n! <0<1-%)(1-%)(1-,—2)~-(1—;) Evaluate ILL, aiand115;] ai(i+1). Evaluate Ha,- given thatdo =1. i=1 1-1 Use the result ofExercise16 toprove the following: \" i1 \"1 n +2 “0 131141—11“ 0’) 13[1_(i+1)2]—2(n+1)l 8 Preliminary Considerations Chap.1 Computer Exercise 18. (a) Writea computer program tocompute and print n S,,=2i3 forlSnSZO. i=1 (b) On the basis ofthe printout,endeavor toguess a general formula forSn. (c) Use Exercise5 to prove that yourguess inpart(b)is correct. 1.2 INDUCTIVE REASONING ANDTHE FIBONACCISEQUENCE It should notsurprise any reader toassert thatthe learning ofmathematics involves acquiring an array ofmanipulativeskills, learninga substantial battery oftheorems, and learning how to prove theorems. Appropriately,these mattersare stressed in mathematicsclasses from kindergarten throughcollege. On the other hand, itis notthecase thataxiomatics and proofare the sum total ofmathematics oreven its most importantpart. Contrary to popularbelief, mathe- matics is nota body ofmaterialdiscovered by theGreeks some 2000yearsago and long since embalmed intextbooks. Itisa vital, vibrant, livingsubject, currentlybeing created ata rate unprecedented inall ofhistory.Unless students ofmathematics understand something ofthisprocess ofcreation, itcan be rathereffectivelyargued that they really understand very little ofwhatmathematicsis allabout. Itis welland good to knowa particulartheorem,say the Pythagorean theorem;one ought to know something about the proof ofthe theorem and oughtalso tobe able touse ittosolvea variety oftheoretical and practical problems. Butwhere didthe Pythagorean theorem come from,and howdoes onego aboutdevising othertheorems that might be useful in solving other theoretical and practical problems ofimportance? Itis precisely at this point thatguessing orinductive reasoningenters intomathematics. No one toldPythagoras thatthe Pythagorean theoremwas true, andhe did notsimply look ina crystal ballandsay, “Aha! Isee a theorem!”;andagain, “Aha! Isee the proof!” No,Pythagoras orone ofhis contemporarieshad toguess thatthe Pythago- rean theorem was true, and then had toguess how toarriveata proof. Withoutthe guess there wouldhave been no theorem,and withoutmoreguessing there would have been no proof. Thishas always been thecase and this willalwaysbe thecase. Withoutguessing there wouldbe no theorems; withoutguessing there wouldbe no mathematics! Thus,as indicated inthe introduction,an importantaim ofthis book willbe to develop mastery ofthe art ofintelligentguessing and ofproblem'solving. For intelligentguessing and problem solvingare the spirit ofinquiry,and inquiryis the spirit ofmathematics. Ofcourse, the latter aim shouldbe pursued inothercoursesas well. But itis particularly suitable fora course innumbertheory. Thegreat Euler(1707— 1783) once wrote: Sec.1 .2 Inductive Reasoning and theFibonacci Sequence 9 As Ishall show here withvery goodreasons, the properties ofthe numbers known today have been mostlydiscovered by observation, and discovered long before their truthhas been con ﬁ rmed by rigiddemonstrations. Thereare even many properties ofthe numbers withwhichwe are wellacquainted butwhich we are not yet able toprove; onlyobservationshave ledus to theirknowledge. Hence wesee that inthe theory ofnumbers, whichis stillvery imperfect,we can place our highest hopes inobservations; they willleadus continuallytonew properties whichwe shall endeavor toprove afterwards. Now how does one go about makingan intelligentguess ina given situation? How does one go about solvinga di ﬂ icultproblem inan unusualsetting, and how does one go aboutguessing the key toa proofeven ifa resulthas beenguessed or stated? No doubt many thingscan be said by way ofanswer,’1 butperhaps one ofthe best things thatcan be doneis toconsidera series ofspeci ﬁ c examples.Because they have so many elegant properties thatcan easilybe discovered bythe simple expedient of scrutinizing examples, we begin by considering the famous Fibonaccisequence, named after Leonardo ofPisa (c.1 170— 1250), whowas also called Fibonacci,and the closely related sequence ofLucas named after the French mathematicianE. Lucas (1842— 1891). The twosequences are de ﬁ ned, respectively, bythe equations F1=F2=19 Fn+2=Fn+l+Fna 141:1: L2=39 Ln+2=Ln+l+Ln for alln 21 and their ﬁ rstfew terms (called Fibonacciand Lucas numbers,respec- tively)are given inthe accompanyingtable. (1.16) THE FIRST 25FIBONACCI AND LUCAS NUMBERS n F,l L,n F,, L, 1 1 1 14 377 843 2 1 3 15 610 1,364 3 2 4 16 987 2,207 4 3 7 17 1,597 3,571 5 5 ll18 2,584 5,778 6 8 18 19 4,181 9,349 7 13 29 20 6,765 15,127 8 21 47 21 10,946 24,476 9 34 76 22 17,711 39,603 10 55 123 23 28,657 64,079 1 l 89 199 24 46,368 103,682 12 144 322 25 75,025 167,761 13 233 521 * The reader shouldsee in particularthe excellent book Mathematics and PlausibleReasoning, Vol.1, by G. Polya (Princeton, N.J.: Princeton UniversityPress, 1954), orthe morerecent two-volume work, MathematicalDiscovery, bythesame author(New York:John Wiley &Sons, Inc.,1981). 1 0 Preliminary ConsiderationsChap.1 With the data at hand, suf ﬁ ce ittosay thatone considers examples, tries to identify regular and consistent patterns, and ﬁ nallyformulatesgeneral statements which one then endeavors to prove. Forexample, ifwe consider the table fora moment,we may note that 1+2=3, l+3=4, 2+5=7, 3+8=ll, 5+13=18, and be led toguess that Fn+Fn+2=Ln+l (1-17) for alln 21. Thisis not hard toprove, but inthissectionwe devote ourattention to guessing, and the proofs willbe postponed untilSection1.3 andeven later forthe more dif ﬁ cultresults. As anotherexample,we note that 1 +1 =2, 1 +4 =5, 4 +9 =13, 9 +25 =34, 25 +64 =89, and a moment’s re ﬂ ectionsuggests that F§+F ﬁ +l=F2n+b 1121. (1.18) In the exercises that follow,the reader willﬁ ndmanyexamples ofthissort. Some- times theguess is easy to make; sometimes itis relatively difficult. Inanycase, allare interesting and somewhat surprising, and the more dif ﬁ cultones willprovidethe greater opportunity forreaders tostrengthen theirmathematicalmuscles and better prepare themselves forthe rigors yet tocome inthisand othercourses. EXERCISES 1.2 1. Guess a formulasuggested byeach ofthe followingsets ofequations. (a) 1+4=5(b) 1+1=2 3+7=10 1+3=4 4+11=15 2+4=6 7+18=25 3+7=10 ll+29=40 5+11=16 Sec. 1.2 Inductive Reasoning and theFibonacci Sequence 11 (c) 1—1=0 (d) 1~1=1 4—1=31 3=3 9—4=5 2-4=8 25—9=16 3-7=21 64—25=39 5-11=55 2. Exercise 1(c) suggests that itmightbe useful tode ﬁ neF0 =0. (a) Is this consistent withthe patternestablished bythe de ﬁ ningequations (1.16)? (b) De ﬁ ne F.l, F_2, F_3, F_4, andF_5 ina way thatisalso consistent with (1.16). (c) Can youguess a relationbetween F\"andF_,,? 3. Exercise 1(c) also suggests that itis sometimes interesting to lookat the differ- ences ofsquares. What formulasare suggested bythe followingsets ofequa- tions? Note that more thanone correctanswer maybe possible. m) 4—1=3 w) 9—1=8 9—1=8 25—1=M 25—4=21 64—4=60 64—9=55 w9—9=1w (o 25—1=24 m) 9—1=8 64—1=63 16—9=7 m9—4=1w w—u6=33 441—9=432 121—49=72 1U6—%=IBI y4~u1=m3 (e) 16—1=15 49—9=40 nL—m=1w 324—49=275 4. Exercise 3(d)suggests that itmightbe useful tode ﬁ ne L0 =2. (a) Is this consistent withequations(1.16)? (b) How would you de ﬁ ne L_1, L_2,and L_3? (c) Can youguess a relationshipbetween L_,, and L\"? 5. What formulasare suggested by the followingarrays? Use summation notation in expressing youranswer. (a) 1=1 (b) 1=1 1+1=2 1+2=3 1+1+2=4 1+2+5=8 1+1+2+3=7 1+2+5+13=21 (c) 1=1(d) 1=1 1+3=4 1—2=—1 1+3+8=12 1—2+5=4 1+3+8+21=33 1—2+5—13=—9 12 Preliminary Considerations Chap.1 6. Guess formulas likethose inExercise5 forthe followingsummations. 10. ll. 12. (a) 2\": (-1)\"~1F2,- i=1 (0) 2\": F2i—l i=1 (e) i(—1>\"-‘F2.-_i i-l (g) i(—1)\"-'F.- i=1 (a) iFat—2 i-l (c) iFsi i-l (e) i(—1)‘-1F3.--1 (b) iL,- i-‘l (d) $i (f) :(—1)i—'L2.- (h) ﬂ ew-1L.- i=1 . Guess formulas forthe followingsummations. (b) iPsi—i i-l (d) i(—1)\"-‘F3.--2 i=1 (f) ieuHFy i-l i=1 . Guess formulas forthe followingsummations. n n (a) 2F? (b) 2FiFi+i i-l i-l (c) 2FiFi+2 (d) 2FiFi+3 i-l i-l n (e) 2Fi ﬁ -+4, where dis any i=1 nonnegative integer . Letf1 =a,f2 =b, andf,, = ﬁ ,_,+ ﬁ ,_2 forn 23. Findjg, ﬁ ,andfsandguessa general formula for ﬁ ,. Consider the followingarrays andguess the formulatheysuggest. 82—5-13=-1 132—8-21=1 82—3-21=l 132—5-34=—1 82—2-34=—4 132—3-55=4 82—1-55=9 132—2-89=—9 82—1-89=—-25 132—1-144=25 Let n, k, and rbe positive integers with k <n.See ifyoucanguess how to complete the following equation: FnFn+r -Fn—a+r+k = One ofthe most importantphrases ina mathematician’s vocabularyis “what if.” For example, what ifone replaces allthe Fibonacci numbers inthe formulas Sec.1 .3 The Postulates ofMathematical Inductionand Well-Ordering 13 in Exercises 6, 7, and8 byLucas numbers? Willvalid formulasresult, oratleast similar formulas? Trysome. 13. Note thatExercise 8(e) isa generalization of8(a)—(d) and thatExercise11 isa generalization ofExercise10. Could you ﬁ ndgeneralizations ofotherresults in this section? 14. What Fibonacci numbersare evenly divisible by(a)3, (b)4, (c)5, and (d)6? Can you makea generalguess? Computer Exercises 15. Writea computer program togenerate the ﬁ rst100 Fibonaccinumbers; the ﬁ rst 100 Lucas numbers. 16. Writea computer program to ﬁ nd all positive integer solutions (x, y) to x2— 5y2 =4. Can you makea generalguess? 17. Writea computer program to ﬁ nd allpositive integer solutions tox2— 5 y2 = —- 4. Can you makea generalguess? 1.3 THE POSTULATES OF MATHEMATICAL INDUCTION AND WELL-ORDERING Like the rest ofmathematics, theset ofpositiveintegersis a postulationalsystem. For example, one mighttake the integers themselves andthe operations ofadditionand multiplicationas unde ﬁ ned terms and statements suchas the closure law foraddi- tion, whichstates thatthe sum ofany two positiveintegersis a positive integer,as postulates. Ingeneral, these postulatesare wellunderstood andwe willnotconsider them here. However,we do considerone postulate thatis often foundconfusing. The postulate in questionis the principle ofmathematical induction orits equivalent, the well-ordering principle. We listthree alternativestatements and thensuggest some further variations on the general theme. 11. First form ofthe principle ofmathematicalinduction. Anyset ofpositive integers that contains the integer1, and thatcontains k +1 whenever itcon- tains the positive integer k, contains allpositiveintegers. 12. Second form ofthe principle ofmathematicalinduction. Anyset ofpositive integers that contains the integer1, and thatcontains k +1 whenever itcon- tains the positive integers1 to kinclusive, contains allpositiveintegers. I3. The well-ordering principle. Every nonemptyset ofpositiveintegers containsa least element. The reader should bear in mind thatone oranother ofthese principles mustbe takenas a postulate forthesystem ofpositiveintegers, andwe shall show thatthe other two can thenbe provedas theorems. Thus, allthree hold fortheset ofpositive 1 4 Preliminary ConsiderationsChap.1 integers. What do they tellus about thesystem ofpositiveintegers, and howcanwe make use ofthis information? In effect, the ﬁ rst form ofthe principle ofmathematical induction,I1, simply says thattheset ofall positiveintegers canbe generated by starting with1, and adding 1 successively ad in ﬁ nitum;thatis, thatthe in ﬁ nitesequence1,1 +1 =2, 2 +1 =3, 3 +1 =4,. .. contains all positiveintegers. Thereader should note thatthisis said in IIby giving two conditions whichguarantee thataset ofpositiveintegersis the set ofall positive integers. The ﬁ rst conditionspeci ﬁ es thatthe integer1 be intheset, while the second conditionstates that ifany particularintegeris intheset, thenso is its successor. But if1 is intheset and thesuccessor of1 is intheset, then2 is intheset. And if2 is intheset, thenso is 3, andso on. Thuswe have an in ﬁ nitesequence that contains all the positiveintegers. The second form ofthe principle ofmathematical induction,12 , says thesame thing about the system ofpositiveintegersas does Il, but ina slightly differentway. Again, there are two conditions whichguarantee thata set ofpositiveintegersis the set ofall positive integers. This time,however, thesecond conditionstates that ifall positive integers from1 up to and includingany given integerare intheset, thenthe successor to thatintegeris also intheset. The ﬁ rst condition,as before,speci ﬁ es that 1 be in theset. Taken together,these conditions implythat2 is intheset. Butthen1 and 2 are intheset andso 3 is intheset, andso on,as before. Finally, the well-ordering principle,I3, guarantees that ifonehas aset actually containing positive integers and onlypositiveintegers, thentheset containsa small- est member. Atﬁ rst thought, itmightseem thatthis wouldbe true ofany nonempty set ofnumbers, butthisis notthecase. Forexample, theset ofpositivereal numbers fails to havea least element andso does theset ofnegative integers. As noted earlier, itis not dif ﬁ culttoshow that inthepresence ofthe other postulates forthe positiveintegers,these three principlesare equivalent. First itmay be worthwhile tosee how theycan be used inthe formulation ofproofs. 1.4 MATHEMATICAL INDUCTION We illustrate theuse ofIIbyassuming itas a postulate and using ittoprove the following theorem. THEOREM1.1. Forevery positive integern, 25;] i =n(n +1)/2. Proof. Let Cbe theset ofallpositive integralvalues ofn forwhichthe formula ofthe theorem is true. Clearly, I is inCsince forn = l,the assertionis simply that 1 =(1 +1)/2. Nowsuppose that kis inC, where kisa ﬁ xed butunspeci ﬁ ed positive integer; thatis, suppose that1 +2 +-- - +k =k(k +1)/2. Then Sec.1 .4 Mathematical Induction 1 5 k(k+1) 2 = k(k+1)+2(k+1) 2 2 _(k+1)(k+2) __T_‘ Thus, ifthe formula istrueform =k, itisalso true forn = k+1;sok+ lisinC ifkis in C. Finally,since Csatis ﬁ es both conditions ofII, itmust contain allpositive integers. Hence, the given formulais true forallpositiveintegersn,as claimed. 1+2+---+k+(k+1)= +(k+1) In practice, one does notusually framea proofbased on Il(such proofsare called proofs by mathematical induction,as are thosebased on12) interms ofa set C, as in the preceding argument. Itwas donehere onlytomake itsdependence on Il completelyclear. Theessential features ofthe proofare thatone mustshow that(step 1) the result in question holds forn =1 and that(step 2) itholds forn =k +1 whenever itholds forn =k, and thisis all thatis usually writtendown. Thus, for example, the preceding proofwouldmore oftenbe written inthe followingmore abbreviated form. Proof. Forn = l,the assertion ofthe theoremis clearly true. Now,assume that EM i—— k(k +1)/2, where kis any ﬁ xed butunspeci ﬁ ed positiveinteger. Then \"i‘i=k__(k+l) (k+l)(k+2) i=1 2 2 Thus, since the assertion is true forn =k +1 ifitis true forn =k, itis true forevery positive integern by the principle ofmathematical induction. +(k+ l)= The reader should note thatbothsteps ina proofbased on Ilmustbe carried out before the desired conclusioncan be drawn. Forexample,step1 canbe completed for the false formula I: i -1 whereas step 2 cannot, andstep 2 can be completed forthefalse formula iin__=(n2+l)+5, whereas step1 cannot. One mustalso be sure thatthe argumentmade instep2 ofthe proofdoes not depend on any particularvalue fork. The argument must hold forany ﬁ xed but unspeci ﬁ ed positive integer korelse the “andso on” ofthe preceding paragraph will 1 6 Preliminary ConsiderationsChap.1 break down. Forexample, letus “prove”that allpositiveintegersare equal. The statement “any11 positiveintegersare equal”is certainly true incase n =1. Letus now assume ittobe true forn =kand prove that itmust, therefore,be true for n = k +1. Let r———-—J——-—- ﬁ 01,02,513,-~ - ,ak,ak+1 M—4 be any k +1 positiveintegers. By assumption, the ﬁ rst kmustbe equal andalso the last k mustbe equal,as indicatedabove by thebraces. Butthen,because ofthe overlap, itis apparent that allthe numbers mustbe equal. Thus, theassertionis true for n = k +1 ifitis true forn =kand the “proof”is complete. The dif ﬁ culty, of course, is thatthere is no overlapbetween the ﬁ rst knumbers and thelast knumbers in the foregoing diagram incase k =1. Thus,step2 ofthe argumentis valid only for k 22 and cannotbe used to conclude thatthe result claimedis true forn =2 ifitis true forn =1. However, itmightbe noted that ifa separate argument couldbe given to prove the validity ofthe assertion forn =2, thenstep2 couldbe used toextend the result upward from2. The preceding remarksuggests thatthe method ofproofbased on IIcanbe modi ﬁ ed to prove thata resultis true forallintegers greater than orequal toany ﬁ xed integer,so thatthe inductiondoes nothave tobegin withn =1. Forexample, ifone wanted to prove thata resultwere true forallintegers greater than orequal to29, it would suf ﬁ ce to prove itforn =29 and forn =k +1 onthebasis ofthe assumption of its truth forn =k, where kis any ﬁ xed butunspeci ﬁ ed integergreater than orequal to 29. A proofbased on12 is exactly likeonebased on11 , withone exception. Instep2 of the proof, one assumes the truth ofthe assertion forallvalues ofn from1 to k inclusive and, on the basis ofthis assumption, must then prove its truth forn = k +1. The pointis thatthe truth ofthe (k +l)stcase oftendoes not follow directly from the truth ofthe kthcase, butdoes follow fromthe truth ofthe assertion forsome or all ofthe positive integers preceding k +1. Even insuchcases, itis possible (bya devious trick) touse11 , buta proofbased on12 wouldbe muchmore natural. Before giving an example ofsucha situation,we note thatthesame general remarks apply to proofsbased on I;as tothosebased onI1. By thiswe mean that both steps ofthe proofmustbe carried outbefore the conclusioncanbe drawn, and that the argument inthe second step ofthe proofmust notdepend on any particularvalue ofk. Also,as indicated inthe discussion of Il, the inductioncan begin with2, or29, or any other integer inplace of1 . Forexample, if2 wereused inplace of l, this would amount to saying that12 couldbe modi ﬁ ed toreadas follows: Anyset ofintegers not less than2 which contains2 and contains k +1 whenever itcontains theintegers2 to k inclusive contains allintegers notless than2. We mentionthis casein particular since one ofthe simplestexamples ofa result thatlends itself ina naturalway to proof based on12 isa theorem true for allintegers notless than2. Before discussing this theorem, it willbe necessary to introducesome terminology. Sec.1 .4 Mathematical Induction 1 7 DEFINITION1.1. Ifa and b are integers witha96 0 andthereexists an integerc such thatb =ac, thenwesay thata dividesb and writealb. Wealso calla a divisor ofb and b a multiple ofa. If1 Sa <b and alb, thena is calleda proper divisor ofb. Ifa does not divideb, we writea1’ b. DEFINITION1.2. Ifpis an integergreater than1 whose onlypositive divisors are1 and p itself, then pis calleda prime. Ifpexceeds1 andis nota prime, then itis called composite. As examples ofthese de ﬁ nitions,we note that1, 2,3, and6 are alldivisors of6, and all but6 are proper divisors. Also,2 and3 are primes and6 is composite. The integer1 is neither prime norcomposite. We now illustrate the method ofproofbased on12 . Note thatwe assume12 , as modi ﬁ ed aboveas a postulate and prove the theorem inthe simpli ﬁ ed form without introducinga set Cas inthe ﬁ rst proof ofTheorem1.1. THEOREM1 .2. Every integern 22 is eithera prime orcanbe represented as a product ofprimes. Proof. The assertion is triviallytrue forn =2 since2 isa prime.Assume that it is true for allintegers n with2 sn Sk, where kis any ﬁ xed butunspeci ﬁ ed integer notless than2. We mustshow thaton thebasis ofthisassumption,the assertion of the theorem is also true forn =k +1. Ifk +1 isa prime,thereis nothing toshow. If k +1 is composite, there exist integers rands with2 S rS kand2 Ss S ksuch that k +1 =rs. Since rands both liebetween2 andk,we have, byassumption, that both are either primes or products ofprimes. Therefore, inthiscase, k +1 mustbea product ofatleast two primes. Inanycase, k + lisa prime ora product ofprimes and the assertion ofthe theorem is true forn =k +1 ifitis true forallintegersn with 2 sn S k. Thus, by12 as modi ﬁ ed, itis true foralln S2. The reader shouldobserve thatthesecond part ofthe preceding proofdepended on knowing thatthe assertion ofthe theorem held forboth rands. Since we knew only that rand slaysomewhere between2 and k itwas necessary toassume thatthe assertion ofthe theorem held forallintegers inthisrange. Using II ina naturalway and making the inductionassumption only forn =kwould nothave suf ﬁ ced. Itturns out thata wide variety ofother variationson the theme ofmathematical inductionare possible. Ifwe consider the de ﬁ nition ofthe Fibonacci numbers in Section 1.2, forexample, F3 can be computedsince we knowitstwopredecessors F1 and F2. ThenF4 can be computed fromF2 and F3 , andso on. Thissuggests thatthe logic ofmathematical inductionis essentially thesameas the logic ofconstructinga DO LOOP in computing. Italsosuggests an alternative principle ofmathematical induction. 1 8 Preliminary Considerations Chap.1 14. Third form ofthe principle ofmathematicalinduction. Anyset ofpositive integers that contains1 and2, and thatcontains k +2 whenever itcontainsthe positive integers kand k +1, contains allpositiveintegers. In makinga proofbased on14 one wouldbegin by provingthedesired result true forn =1 and n =2. One would thenassume thatthe resultis true forn =kand n = k +1, where kis any ﬁ xed butunspeci ﬁ ed positive integerand, onthebasis of this assumption, prove thatthe result mustalso hold forn =k +2. Ofcourse,as usual, both parts ofthe proofare necessary and thesecond part ofthe argument must not depend on khavingsome particularvalue. Finally, howdoes one decide whether touseI1,12 , I4, orsome other variation of mathematical induction? Actually,perhaps onscratch paper, onehas todo the second part ofthe prooftosee whatis required toget “thenextcase.” letP(n)bea proposition about the integern. Ifthe truth ofP(k +1) follows fromthe truth of P(k), II willdo nicely. Ifthe truth ofP(k +1) depends on the truth of P(i)for 1 S i S k, one mustuse12. Ifthe truth ofP(k +2) follows fromthe truth ofP(k)and P(k +1), then clearly I,is needed. Butsuppose thatthe truth ofP(k +2) depends on the truth ofP(k); whatthen? Amoment’s re ﬂ ectionmakes itclear that itwillsuf ﬁ ce to begin by proving that both P(l)and P(2)are true. This wouldbe yet another variation ofmathematical induction. EXERCISES 1.4 1. Show that none ofthe followingsets containsa least element: (a) Theset ofpositive real numbers. (b) Theset ofallintegers. (c) Theset ofallreal numbersgreater than2. 2. Find the least element intheset F={1,1/2,1/22,. . . ,1/2\",. .. }. 3. The following equalitiesare false formost positiveintegersn. Trytoproveeach by the method ofmathematical inductionandshow whythe methodfails. Also, in each case, givea positive integralvalue forn forwhichthe equalityis false. (a) 2n:(2i+1)=n2+2(b) 2n:(i+3)=n2+n+2 i=1 i=1 2 n(n+1) 2 (d)i(3i—2)=n2+n+1 i-l (c) i2i—1 i=1 Sec. 1.4 Mathematical Induction 19 4.\\l 12. 13. Prove that g1 = _n_ i=1 i(i+1) n+1 for every positive integern. . Prove that $11.3 =[n(n?:|- 1)]2 i=1 for every positive integern. . Use Ilto prove that22\" -1 is divisible by3 forevery positive integern. H int: Forthe second part ofthe proofmake yourassumption byassuming that there exists an integerq such that22\"— l =3q. Thenconsider FW ﬁ —1=4-FL—u=ra%+2%—1=3~ ﬂ +3q . Prove that 22'\"1 +1 is divisible by3 forevery positive integern. . Prove that f(n) =3n5 +5n3 +7nis divisible by15 forevery integern. Hint: Note that f(— n) =—f(n). . Prove that32\"+1 +2\"+2is divisible by7 forevery nonnegative integern. 10. l1 . Prove that1'17“ a; =(115‘.l ai)’forevery positive integern[see (1.12)]. For any positive integern, prove intwo differentways that n Eum=m+m—L i-l Hint: Forone way, note thatthe ﬁ rst ioftheexpression being summedcanbe writtenas (i +1)—1 and thensee Exercise 4 ofSection1.1. Let Fn denote the nth Fibonacci numberand prove thatthe followingare true for every positive integern. n n (a) 21:1‘=F'n+2—1 (b) 2F12=FnFn+l i-l i=1 n n (C) 2F2i—1 =F271 ((1) 2F21\": F2n+1_1 i=1 i-l (e) 2(—1)i—1F'i=(_l)n_a—l+1 i-l Let a =(1 +J5)/2and ,6=(1— J5)/2so that aandB are the roots ofx2 = x +1; thatis, a2 = a +1and/32 = ﬂ +1. ProvethatFn =(6!\"— ﬁ \")/\\/§ forall n 20. H int: You mayuse either IIor14; in eithercase start by provingthe result for n =1 and n =2. Why? This formulais due toJ. P. M.Binet in1843. Note: F0 =0. 20 14. 15. 16. 17. 18. 19. 20. 21. 22. 23. 24. 25. Preliminary Considerations Chap.1 Prove that L,= a\" +,6” forallintegersn 20. Note: L0 =2. Use12 to prove that a\"‘2S F\" S 01\"\"forevery positive integern. Note that itis again necessary to make the ﬁ rst part ofthe proofforn =1 andn =2. Prove that a\" =F,,_.l +01F\" forn 21, provided thatwe de ﬁ neF0 =0. Prove thatF,,+,,,+1 =FnFm +EMF\",+lform 20, n 20. Hint: Hold m constant anduse inductiononn. Deduce from Exercise17 thatF,, dividesF2\" foreveryn 21. Prove thatFn dividesFm\" forn 21, m 21. H int: Fixn anduse inductionon m. Let P(n)be a statement aboutn such that forevery positive integer k, the truth of P(k) implies the truth ofP(k +3). Whatmustbe done toprove thatP(n)is true for every positive integern? Let P(n)be an assertion aboutthe positive integern such that forevery positive integer k, the truth ofP(k) impliesthe truth ofP(k + l)forall k 25. Whatmust be done to show that P(n)is true forevery positive integern? Let P(n)be a statement aboutn such that P(l)is true, thatthe truth ofP(k) implies the truth ofP(k +1) and P(k +2) ifkis odd. Whatcan youconclude about P(n)? Prove that n 2FiFi+l = 1\"! F,,F,,+2 forn even, F3,“ for11 odd, where n is positive. Hint:Use Exercise 22. Prove that {FnFn+,+d forIt even, ’1E Fi ﬁ ”=F,,+,F,,+d forn odd,i-l where n is positive and disa ﬁ xed positiveinteger. Computer Exercise What would the following program compute? J =1 DO1 I= 2,51 J= (I— 1)*J 1 PRINT, J STOP Sec. 1.5 The Well-Ordering Principle 21 1.5 THE WELL-ORDERING PRINCIPLE We now illustrate the method ofproofbased on the well-ordering principle,13 , by proving the following littleresult concerning the number1. THEOREM1.3. Ifa isa positiveinteger, thena 21; thatis,1 is theleast positive integer. Proof. Suppose, on the contrary, thatthere exists an integera such that 0 <a <1. Then, ifCis theset ofsuch integers, itis notempty. Therefore, by13 , C must have a least element. Letb be theleast element ofC. Then0 <b <1 and, on multiplication byb,O <b2 <b. Butthenb2 is an element ofC whichis smaller than b and this contradicts the fact thatb was theleast element ofC. Because ofthis contradiction, our originalassumption mustbe false,so thata 2lforevery positive integera. As in thiscase, many proofsbased on the well-ordering principle involvethe method of proofby contradiction. Toprovea theorem by contradiction,one pro- ceeds, ingeneral,as follows. One begins byassuming thatthe theoremis false, and then deduces from this assumptiona result thatis known tobefalse, or thatcontra- dicts the primaryassumption. We shallhave manyoccasions inthediscussions that follow touse this method ofproof. The proof ofTheorem1.3 also provides aneasy illustration ofthe method of proofdue toP. Fermat(1601— 1665) and knownas Fermat’s method ofin ﬁ nite descent. Ingeneral, sucha proofhas the following form.Oneassumes thatthereisa positive integer rpossessing some propertyP. One thendeduces thatthere issome positive integers < rwhichalso has propertyP. Butsince this argument couldbe repeated ad in ﬁ nitum, itcontradicts the fact thatthere mustbea smallest positive integer with propertyP. Hence, there mustbe no positive integerpossessing prop- erty P. Also, itshouldbe observed thatthe well-ordering principlecanbe generalized along the same linesasI1 and12. Forexample, itcouldbe shown fromthe well-or- dering principleas stated thatany nonemptyset ofintegers, none ofwhichisless than some ﬁ xed integerb, has a least element. Also,one could prove thatany nonempty set ofintegers, none ofwhichis greater thansome ﬁ xed integerc, has a greatest element. A second example ofproofbased on the well-ordering principleis the follow- ing interesting demonstration that J2is irrational,due originallytoHugoSteinhaus. THEOREM1.4. The number 5is irrational. Proof. Since1 <2 <4, itfollows that1 <J2 <2. Nowsuppose thatJ2is rational. Then by the well-ordering principle,thereexistsa least positive integerb and an integera such that J2 =a/b. This implies that l<a/b <2 andhence that 22 Preliminary ConsiderationsChap.1 b <a < 2b and that0 <a— b <b. Thus,a— bisapositiveintegerless thanb. But sincex/E = a/b, itfollows that a2 2 =p, 2b2=a2, 2b2— ab =a2— ab, b(2b -a) =a(a -b), a 2b—a ﬁ _b_a—b' But this gives J5as a ratio oftwointegers withpositiveinteger denominatorless than b. Since this isa contradiction, the theoremis true. EXERCISES 1.5 1. Use the well-ordering principle toprove that J3is irrational. 2. The Archimedean axiomstates that ifa andb are positiveintegers, thereexists an integer n such thatan 2b. Use the well-ordering principle toprove thatthisisso. Hint:Suppose that the assertion isfalse and consider theset C ofall positive integers ofthe formb— ma. 3. Use the well-ordering principle toprove thatany nonemptyset C ofintegers none of which is less thena speci ﬁ ed integer ahas a least element. Hint: Consider theset D ofallintegers ofthe formc— a +1, wherec is an element ofC. 4. Use the well-ordering principle(as modi ﬁ ed inExercise3 witha =2) toprove that every integern 22 is eithera prime ora product ofprimes. 5. Use Fermat’s method ofdescent to prove that 25;. i =n(n +1)/2. Note thatthe critical arithmetic ofthe argumentis essentially thesameas inthe proof ofthis result by II inSection1.4. 6. Use Fermat’s method ofdescent toprove that ii3 =n2(n +1)2/4. i=1 Computer Exercise 7. Writea program to determine theleast positive integer thatcanbe written (nontrivially)as the sum oftwocubes ofpositiveintegers intwo differentways. Sec. 1.6 Equivalence ofthe Principles ofInductionand Well-Ordering- 23 1.6 EOUIVALENCE OF THE PRINCIPLESOF INDUCTION AND WELL-ORDERING In this section we show that inthepresence ofthe otherpostulates forthe positive integers, 1,,I2, and13 are equivalent. First, toavoid circularproofs ofTheorems1.6 and 1.7, we give an alternative proof ofTheorem1.3 based on eitherI1 or12 and then deduce a needed corollary. Proof ofTheorem 1.3 Using I1 or12. Itis clear that1 21. Forthe proof based onI1, assume that k 2 l,where kis any ﬁ xed butunspeci ﬁ ed positiveinteger. (For the proofbased on12, assume that i21 forallpositiveintegers ifrom1 to k inclusive, where kis any ﬁ xed butunspeci ﬁ ed positiveinteger.) Then k +l 2k 21 and itfollows by Il(12) thatn 21 forevery positive integern. Thus, bothI1 and12 imply that1 is the least positive integer,as claimed. COROLLARY1.5. Ifkis any positiveinteger, thenthereexists no positive integer n such that k <n < k +1. Proof Thisis an immediateconsequence ofTheorem1.3 andhence ofanyone ofI1, I;, and13. Tosee this,observe that ifthereexistsa positive integern such that k <n < k +1, then0 <n— k <1,so thatn— kisa positive integerless than1, in contradiction to Theorem1.3. Thus, nosuch n can exist. We now proceed tothe equivalence of1,,12, andI3. THEOREM1.6. II implies12. Proof. We take11 as a postulate and must prove12 as a theorem. Let Cbe any set ofpositive integers satisfying the conditions of12. The problemis toshow that C contains all positiveintegers. Let A,, denote the statement “theintegers1 to11 inclusiveare in C.”A1 is true by hypothesis. Now,assume that Akis truewhere kis any ﬁ xed butunspeci ﬁ ed positive integer. Then1 to kinclusiveare inC. Hence, again byhypothesis, k +1 is in C and Ak+1 is true. Therefore, byI1, Anis true forevery positive integern,so C contains all positive integers. THEOREM1.7.12 implies13. Proof. We now take12 as a postulate and prove13 as a theorem. Let Cbea nonemptyset ofpositiveintegers. We mustshow that Chas a least element. Assume that Chas noleast element and let A\"denote the statement “nis notan element of C.” Then Alis true, forotherwise1 wouldbe theleast element ofCby Theorem1 .3, whichwe justproved usingI2. Assume that A\"is true foralln from1 to k inclusive. Then, by Corollary1.5, Ak+1 mustalso be true, forotherwise k +1 would be the least element inC. Thus, by12, A\"is true forevery positive integern. 24 Preliminary ConsiderationsChap.1 But this implies that Cis empty, contrary tohypothesis. Therefore, the assumption that C has no least elementis false and the theoremis proved. THEOREM1.8.13 implies11. Proof Let Cbe aset ofpositiveintegers satisfying the conditions ofII. Assum- ing13 as a postulate, we must prove thatC contains allpositiveintegers. Suppose that Cdoes not contain all positiveintegers. Thentheset C * ofall positive integers not in Cis nonempty. Therefore, by13 , C*has a least element. It follows from Theorem1.3, whichwe proved byusingI3, thatnoelements ofC *are less than1 and, hence, thattheleast element ofC*is notless than1. Moreover,the least element of C*cannotbe1 since, byhypothesis,1 is inC. Thus,again by Corollary1.5, the least element in C*canbe written inthe form k +1, where kisa positive integer. But thissays that kis inCwhereas k +1 is not, indirect contradic- tion to the hypothesis. Thus, the assumption that Cdoes notcontain allpositive integers is false and the theorem is proved. Theorems1 .6 to l.8 show that Ilimplies12 , that I;impliesI3, and that13 implies 11. Thus, ifany ofthese propositionsis assumedas a postulate forthe positive integers, the othersare immediatelyavailableas theorems. We shallhavea number ofoccasions touse each ofthese principles inwhatfollows. 1.7 THE DIVISION ALGORITHM To simplify notationhere and throughoutthe remainder ofthe book,we shall always use lowercase Latinletters todenote integers unless explicitlystated tothe contrary. THEOREM1.9. (The Division Algorithm). Foranyb >0 anda, there exist unique integers q and rwith0 S r <b such thata =bq +r. Proof. The proofdepends on the modi ﬁ cation ofthe well-ordering principle discussed inSection1.5. Let C be theset ofall nonnegative integers ofthe forma— sb. Ifa 20, then a — 0b is an element ofC. Ifa<0, thena— ab =a(l— b) 20 is an element ofC since b 21. Thus, ineithercase, Cis notempty. Hence, bythe well-ordering principle, Chas a least element. Letq denote thatvalue ofs whichyields theleast element ofC andset a— bq =r. Thus,since ristheleast nonnegative element ofthis form, itfollows that0 S rand r—b=a—bq-b=a—(q+l)-b<0, since r— b is ofthe forma— sb and yetisless thantheleast nonnegative integer of this form. Thus, 0 S r <b,as claimed. The ﬁ rst part ofthe proofhas shown thatq and rwiththedesired properties must exist. Toshow thatq and rare unique,we mustshow thattheyare the only Sec. 1.7 The Division Algorithm 25 integers withthe desired properties.Suppose thata =bq’ +r’,where0 S r’<b. It suf ﬁ ces to show that r = r’andq =q’. Ifq’<4, then q’ +1 Sq since q and q’are both integers. Therefore, r=a—-qa-b(q’+l)=a—bq’—-b=r'—b<0, and this is a contradiction. Similarly,we obtaina contradiction ifq’ >q. Thus, it must be thecase thatq =q’. Butthenbq +r =a =bq +r’,so r = r’as well. Stated somewhat di ﬁ ‘erently, this theorem simplysays that ifone dividesa by the positive integerb, one obtainsa quotientq anda remainder rwhere ris nonnega- tive andless thanb. However, the restriction thatb be positiveis not strictlyneces- sary, and the theorem couldalso be written inthe form: Givenintegersa andb with b=15 0, there exist uniqueintegers q and rwith0 S r<|b| such thata =bq +r. The division algorithmis surprisinglyuseful,as we shallsee subsequently. Asa ﬁ rst example, note that withb =2, the theorem implies thatevery integera is either ofthe form 2k or ofthe form 2k + l(i.e., even orodd). Thus,a2 is either ofthe form 4k2 = 4r or 4k2 +4k + l =4s +1. Hence, thesquare ofan integer mustleavea remainder of0 or1 when divided by4; itcannotleavea remainder of2 or3. Similarly, any integer a mustbe ofthe form3k, or 3k + l,or 3k +2. Thus,a2 must be ofthe form 9k2=314, or 9k2+6k+l =3v+1, or 9k2+ 12k+4=3w+1. Hence, the square ofan integer mustleavea remainder of0 or1 when divided by3; it cannot leave a remainder of2. Admittedly,these are onlysmallresults, buttheyare not without interest and they indicatean importantway inwhichthe division algorithm can be used. EXERCISES 1.7 1. Prove that no numberinthesequence11, 111, 1111, 11111,. . . , isaperfect square. 2. Ifp is a prime other than2 or5, prove that pmustbe one ofthe forms 10k +1, 10k +3, 10k +7, or 10k +9. 3. Prove that the product ofany two odd numbers mustbe odd. 4. Prove thatone ofany twoconsecutive integers mustbe even. 5. Prove thatone ofany three consecutive integers mustbe divisible by3. 6. Ifa is an integer, prove thatone ofthe numbersa, a +2, anda +4 is divisible by 3. 7. Ifn is an integer not divisible by2 or3, show thatn2 +23 mustbe divisible by24. Hint: Any integer mustbe oftheform6k, 6k + l,. .. , or 6k +5. 8. Ifa, b, andc are integers witha2 +b2 =02, show thata andb cannot bothbe odd. 9. Ifa andb are integers withb <0, prove thatthere exist uniqueintegersq and r withO S r<|b| such thata =bq +r. 26 Preliminary ConsiderationsChap.1 10. Ifa and b are integers withb ¢0, prove thatthere exist unqiueintegersq and r with—-|b|/2 < r s|b|/2such thata =bq +r. Computer Exercise 11. (a) Writea program to compute and printn, f(n), f(f(n)), f(f(f(n))),. . . for l Sn S100, wheref(n) =71/2 ifnis even andf(n) =3n + lifnis odd. (b) Makea conjecturebased on part(a). 1.8 POSITIONAL NOTATION For many theoreticalpurposes inthe theory ofnumbers itis immaterialwhatsystem one uses forthe representation ofnumbers. TheGreeks, forexample, witha very cumbersome notation,were able todiscover and prove manybasic properties ofthe integers. For practicalpurposes, however, and fortheoretical matters requiring detailed computation, itis importanttohavea notation thatfacilitates calculation. The Hindu— Arabicsystem ofnotation, inworldwideuse today, certainlymeets this requirement, and although itis well known fromconstantusage, itmay notbe amiss to discuss ithere insome detail. In the ﬁ rstplace, the Hindu—Arabicsystem isa positionalsystem ofnotation. For example,we write2922as shorthand forthe muchmore cumbersomeexpression 2- 103 +9- 102 +2- 10 +2 and let the position ofeach digitdetermineits contri- bution to the totalvalue ofthe numberbeingrepresented. Thus,the three2’s above contribute, respectively, twothousand, twenty,and two, and the nine contributes nine hundred to the totalvalue oftwo thousand nine hundred twenty-two. In the second place, the Hindu— Arabicsystemis said tohave thebase10, since all numbersare expressedas sums ofmultiples ofpowers of10, as inthe preceding example. Incidentally, itis not di ﬂ iculttoimagine how this allcame about. Members ofthe humanrace normallycome equipped with built-incalculators with 10 keys and, quite naturally, countlarge numbers by repeatedly countingthe10 ﬁ ngers. Indeed, the numbersweuseas multipliers ofthepowers of10 inourpresent system are called digits,as are the ﬁ ngers andtoes. The great power ofthissystem ofnotationis thatanyinteger, howeverlarge, can be represented conveniently byrepeateduse ofonly10 symbols and thatsimple algorithms, or orderly methods ofcomputation,can be devised forcarrying out arithmetical computations. Othersystems, suchas the Roman, forexample, require the creation ofmore and more symbols forthe representation ofever-larger numbers, and even such simple operationsas additionand multiplicationare quitetedious, to say nothing about division: forexample, XXVIII + XXXIV = XXVIII + XXXIIII = XXXXXVIIIIIII = LVVII = LXII Sec.1 .8 Positional Notation 27 and (XIX)- (II) = (XVIIII)- (II) = XVIIII + XVIIII = XXVVIIIIIIII = XXXVIII. One need only comparethese calculations withthe correspondingones using ordi- nary base 10 arithmetic toappreciate the advantage positional notationaffords. The usual simple rules for borrowingand carrying insubtractionand addition,as wellas the methods for multiplication,and division,depend entirelyon this notion. The following theoremshows that itis always possible torepresent an integer in decimal form and also suggests some interesting alternatives. THEOREM1.10. Letb be greater than1. Thenevery a>0 canbe uniquely represented inthe form a=cnbn+cn_1b\"—l+'’ ' +clb+Co withcnaEO,n20,andOSc,~<bfori=0,1,2,. .. ,n. Proof. We ﬁ rstshow thatevery(I >0has a representation ofthe desired form and then show thatthe representationsare unique. (i) Fora =1, itsuf ﬁ ces totaken =0,c0 =1. (ii) Assume thatevery integer from1 to kinclusivecanbe represented inthe desired way. On thebasis ofthis assumption, itmustbe shown that k +1 canalso be represented in this way. By Theorem1 .9, there existintegersco andq with0 Sco <b such that k+1 =bq+co. Ifq=0,thencoaéO and k+1=co,so that k+lis represented inthe desired form. Ifq >0, thenq =(k +1 — c0)/b s(k +1)/2 Sk, since b 22 and k 21. Thus, by the inductionassumption,q canbe represented in the desired way; thatis, there exist constants whichwe maydenote byc1,62, ..,cmwithcmaEOandOSci<bfori=1,2,. . . ,msuchthat q=cmb\"‘\"+cm_,b\"\"2+- - - +czb+c,. Hence, k+ l =bq+co=cmbm+- -- +c1b+co and so can be represented inthe desired way. Thus, by mathematical induction, every positive integera canbe represented inthisway. (iii) We must stillshow thatthe representation ofeach integerais unique. Suppose thatsome a can be represented intwoessentially differentways,say a=co+clb+- - - +cnb\" =do+dlb+- - - +dmb’\" withc,,=# 0,dm ¢0, 0 Sc,- <b foreach i,0 S61,- <b for eachj,and withm 2n. Then by subtraction, 0=e0+elb+'' ' +€mbm 28 Preliminary ConsiderationsChap.1 whereei=di—c,-fori=0,.. . ,n,ande,-=d,-fori=n+l,. . . ,mifm>n. In View ofthe inequalities on thec’s and d’s, itfollows that—(b— 1) Se,- S(b -1) for each1'. Also,e,aé 0 forsome isince we assumed thatthe tworepresentations fora were essentially different. Letek be the nonzeroe withthelargest subscript. Then —ekb\"=eo+e,b+-- - +ézk.lb\"—l and bksl_ekbkl=leo+elb+' ' ' +ek_1bk_ll Sieol+lerlb+'‘ ' +|ek—1|bk-l S(b—1)+(b—1)b+- - - +(b—1)b\"\"=b\"—1. Since this is a clear contradiction, itmustbe thecase thatm =n andc,- =d, foralli. Thus, the representationis unique. Theorem 1.10 shows that positionalrepresentation ofnumbersis possible with any integer b >1 as base. Forexample, ifb =8, Theorem1.10 guarantees thatany positive integercan be written uniquelyas a sum ofmultiples ofpowers of8 where the multipliers come from among the integers 0 through7. Thus,one hundred thirty- one can be writtenas 2- 82 +0~ 8 +3 and justas the representations ofintegersas sums ofmultiples ofpowers of10 are abbreviated todecimal notation, this mightbe abbreviated inoctal notation to203. Indeed, thisis almost certainlythe way the number wouldhave been written ifhumanbeings hadbeen equipped with fourdigits instead ofﬁ ve oneach hand. Toavoid confusion,we shall frequentlyuse a subscript, written inbase 10 notation, to indicate thebase. Forthe exampleabove, we have that 13110 =2033- Incidentally,2033 shouldbe read “twozero three,base eight”and not “two hundred three”since ourlanguage fornumbersis already oriented tobase10. Since ourrules for numerical computation, by hand orbymachine,depend on the positional character ofdecimal notationand noton thebase, calculations with numbers written inoctal notation wouldbe carried outas usual except thatwe would have touse dilferent additionand multiplicationtables,as shown below. ADDITION TABLEFOR BASE 8+.—NU)4 5 6 7 4 5 6 7 10 5 6 7 10 11 6 7 10 11 12 10 11 12 13 10 11 12 13 14 ll12 13 14 15 12 13 14 15 16\\IONUIAWN—.—OQCBUIﬁLBN.._.._.F-ONONUI-kw\\l Sec.1 .8 Positional Notation 29 MULTIPLICATION TABLEFOR BASE 8 l 2 3 45 6 7X 2 3 4 5 6 7 4 6 10 12 14 16 61 1 14 17 22 25 10 14 20 24 30 34 12 17 24 31 36 43 14 22 30 36 44 52 16 25 34 43 52 61\\lO‘UI-PWNH\\lO‘MAt— For example, the product oftwenty- ﬁ veand twenty wouldbe found, inbase8, as follows, where the notationis octal: 31 ﬁ 144 Q 764 Thus,7648 =7- 82 +6- 8 +4 =500,0. Similarly,the sum ofthirty- ﬁ veand thirty would appear in octal notationas 1 43 i 101 and 1018 =1- 82 +0 '8 +1 =6510,as itshould. Thereader should workthrough these calculations withthe help ofthe tables above tosee whatis involvedateachstep. As almost everyone knows, modern computersdo arithmetic inbinary(base 2) notation. Octal(base 8) and hexadecimal(base 16) notationare also used incom- puting. Base 2 is the natural notation forthe internalworkings ofa machinesince only the digits 0 and1 are required, andthese can easilybe expressed inthe machine by a switch being either on oroff,a spot ona magnetictape being magnitized or not magnetized,a spot on theface ofan electrostatic tube being eithercharged or not charged, andso on. Ofcourse, arithmetic tobase2 is greatly simpli ﬁ edsince one need only learn the additionand multiplicationtables throughtheones. Forexam- ple, multiplyingeleven byseven inbase 2, one wouldhave 1011 A 1011 1011 1011 1001101 30 Preliminary ConsiderationsChap.1 Sixty is divided by10 as follows: 110 1010) 111100 M 1010 lQLQ The reader should check tosee that allthese calculationsare correct. Now, ithappens thatthereisa very simple method forobtainingthe positional representation ofany positive integer a toanybase b >1. By Theorem1.9, we are assured thatthere exist integersq1 andr1 such thata =bql +rland0 5r1 <b. Also, there existqz andr2 such thatq1 = q+r2 with0 Sr2 <b. Again, thereexistsq3 andr3 such that(12 =bq3 +r3 with0 5r3 <b, andso on. Now, itis clear that a >q1 >q2 >43 >- - - . Thus,we must ﬁ nallyreach theplace wheresome q is smaller thanb, though stillpositive; thatis, forsome k,0 <qk <b. Ifwe divideonce more by b, we obtainqk =0- b +rkH with0 <rk+l <b and thisends theprocess. Now a = bq1+r1 =b(bq2 +r2) + r1=bzq2 +br2 +r1 =2(bq3 +r3) +brz +r1 =b3q3 +b2r3 +brz +rl =b\"rk+1 +bk‘1rk+'- - +br2+r1, which is a representation ofa inthe formdescribed inTheorem1.10. Butsince a is uniquely expressible inthe form, this mustbe thedesired representation. For example, ifwe want to write35610 inpositional notation tobase 7, we perform the successive divisionas follows: 7 IE 7|5_0 =q1 ’ r1 =6 7L7. =(12, r2 =1 7L1 =q3: r3 =0 0 =q49 r4 =1' Thus,35610 =10167. Octal(base 8) and hexadecimal(base 16) notationare used incomputingsince binary representations tend tobe quite lengthy andcanbe greatly shortened byusing octal or hexadecimal notation. Also, itis veryeasy tochange from binary notationto either octal or hexadecimal, and conversely. To illustrate thiswe note that17110 is written inbase 2 as 101010112. Now Sec. 1.8 Positional Notation 31 10,101,0112=1'27+0'26+1'25+0'24+1'23+0'22+1'2+l =(l'2+0)26+(l'22+0-21+l)23+(0-22+1'2+1) =2'82+5'8+3 =2538' Thus, to go frombase 8 tobase 2 we replaceeach digit inbase8 bythe triple ofdigits that give its representation inbase 2 andconversely. Ofcourse, 2:102,5 =1012, and3 =112=0112 since initial0’s may ormay notbe needed to ﬁ llouta triple.Thehexadecimal digits for10, 11, 12, 13, 14, and15 are normallyrepresented by A,B, C, D,E, and F and their four-digit binaryrepresentationsare given by 0 =00002 8 =10002 1=00012 9=10012 2=00102 A=10102 3=00112 B=10112 4=01002 C=11002 5=01012 D=11012 6=01102 E=11102 7=01112 F=11112. Since 16 =24, we maygo fromhexadecimal to binary notationby replacingeach digit by its four-digit binaryrepresentation, and conversely. Thus17110 is repre- sented in binary by101010112 vv-A-v-r \\. and in hexadecimal byAB16. EXERCISES 1.8 1. Express 24710 to (a)base 7, (b)base 2, (c)base8, and (d)base16. 2. What number tobase 10 is represented by(a)3248, (b)324,6, (c)107, (d)105, (e) 1008, and (f)D9B16? 3. What number tobase10 is represented by21.78? (Thishas notbeen discussed, but the extension shouldbe clear.) 32A 10. 11. 12. Preliminary Considerations Chap.1 . Carry out the following computationsusing octal notation throughout.Check your work by converting to decimal notation. (a) 257,s +3618 (b)2578 X3618 (c) 3618— 2578 (d)1356,;-2- 318 . Construct additionand multiplicationtables forbase5 and inthatbase carry out the following calculations. (a) 4235 +2425 (b)4235 X2425 (c) 3315-Z- 235 . Convert the following tooctal notationand hexadecimal notation. (a) 1111001012 (b)11001012 . Convert the following to binary notation. (a) 2578 (b)3018 (C) AF316 (d) 10C\"; . Letb be greater than1. Show thatevery integera (positive,negative, orzero) can be represented uniquely inbase ~b,thatis, inthe form a =cn(—b)\" +c,,_,(—b)\"‘l +- -° +c1(—b) +co withcnaéOifa¢0and0$ci<bforOS isn. Ifa<0,showthatnisodd. If a >0, show thatn is even. . Show thatthe method forchanging frombase10 notation tobase b is also valid for changing tobase— b. Forexample, to write39210 inbase -10, we have that 392 =(— 10)(— 39) +2 —39 =(—10)(4) +1 4=(—10)-0+4, so that39210 =412-10. Inshort formas above, this couldhave been written —10| ﬂ -10|-_39 =q1, r1 =2 — 10E =q2, r2 =1 0 =q3, r3 =4. Write (a)8210 and (b) -76110 inbase— 10 notation. Write the numbers fromone through20 inbase— 10 notation. Show that, inadding or multiplyingnumbers tobase— 10, one mustsubtractthe “carries.” Forexample, 87_.o and 206_loare added inthe followingway: I 87 M. 273 Write these numbers inbase 10 notationand check thatthe additionis correct. Sec.1 .9 Computational Complexity 33 13. In subtracting tobase— 10, show thatwhenone borrows,one mustincrease rather thandecrease the digitborrowed from. Forexample, insubtracting29-10 from 57_10, one proceedsas follows:N‘bla\\O\\l48 Write these numbers inbase 10 notationand check thatthe subtractionis correct. 14. Carry out the following calculationsusingbase— 10 notationthroughout. (a)347—10 +58.10 (1)) 347-10 _58-[0 (c)78—10 +86—10 (d)28—10 X57—10 (e) 534_10— 2476.lo (r)193600.lo +35.10 15. Write the following inbase10 notation. (a) 276 ﬂ (b)27._6_lo (c) 2760—10 ((1) 27.509.lo (e)0.90_10 (019.09.lo Note that 27.6% indicates the in ﬁ niterepeating decimal27.6909090. . . where the 90 repeats ad in ﬁ nitum. Computer Exercises 16. Writea program to printany numbern inbase b notation,whereb is an integer and2 S b S9. Yourprogram should printoutthebase b representation ofn. In particular, write18456203 inbase 2. 17. (a) Lets(n) denote the sum ofthesquares ofthe digits ofn. Writea program to investigate the behavior ofn, s(n), s(s(n)), s(s(s(n))),.. . for1 Sn S100. Be careful not toget caught inan in ﬁ niteloop. (b) Makea conjecture on thebasis ofpart(a). 1.9 COMPUTATIONAL COMPLEXITY In Section1.8 we discussed positional notation forintegers inanybase and pointed out thatbase 2, base 8, andbase16 are particularly importantanduseful incomputer science. The usual algorithms forinteger computationare, ofcourse, essentially the same in anybase, and itiseasy enough to write outcareful proofs thatthey produce correct results. Ofcourse, no claimis made foruniqueness ofmethodand therearea number ofalternatives foreach ofthebasic operations ofinteger arithmetic. Inthe case ofmultiplication, forexample, one reasonably well-known, butrather surprising algorithm is the method known variouslyas Russianpeasant multiplication orEgyp- 34 Preliminary ConsiderationsChap.1 tian multiplication. To multiply27 times38, forexample,one divides27 and its successive quotients by2 (ignoring any remainders that mightresult) untila quotient of1 is obtained, and simultaneously doubles38 and itssuccessive doubles,as illus- trated: 27 38 13 76 6+53L 3 304 1 ﬂ 1026 One then deletes theeven numbers inthe “halving”columnand the corresponding numbers inthe “doubling”columnandadds the remainingnumbers inthe “dou- bling” column to obtain the desired result. Thus,27- 38 =1026. The questionis not correctness butquickness ore ﬂ iciency. In general, in computing, itis importantthatjobsbe doneas ef ﬁ cientlyas possible. Because ofthe cost ofcomputing, thisis particularlytrue oflarge jobs that mustbe run repeatedly. But itis equally true ofverylarge and/orcomplicated jobs if they are to be completed at all. Asfastas theyare,as we willsee later, there exist computational problems ofsuf ﬁ cientsize and complexity thatthey cannotyetbe calculated in “ ﬁ nite time”on even thelargest, fastest, and mostsophisticated of today’s computers. To obtaina bitdeeper understanding ofthe problem,we investi- gate brie ﬂ y the complexity ofthe usual algorithms ofinteger arithmetic.Theneeded de ﬁ nitions follow. DEFINITION1.3. If fand gare positive-valued functions withdomainD, we say that fis 0(g)and write f=0(g) ifthereisa positive constant Csuch that f(x) < Cg(x) for all xinD. 0(g)is usuallyread “big-0 of g”andwesay that fis big-0 ofg or that fis ofthe order ofg. THEOREM1 .l1. If f=0(g)on the domain Dandc isa positiveconstant, then cf = 0(g)on D; thatis, 60(g) =0(g). Proof. If f= 0(g),there isa positive Csuch that f(x) <Cg(x) forall xinD. Therefore, cf(x) <cCg(x) for all xinD,so cf =0(g). THEOREM1.12. If f=0(cg)on the domain Dandc >0, then f=0(g)on D; thatis, 0(cg) =0(g). Proof f=0(cg) implies thatthereexistsa positive constant Csuch that f(x) < c(x)for all xinD. Butthen f=0(g),as claimed. Sec.1 .9 Computational Complexity 35 THEOREM1.13. If fl=0(g1)and f2=0(g2)on the domain D,then f1 +13 =0(31 +g2)andf1f2 =0(8182) on D. ProofSincef1 =0(g1)andf2 =0(g2),there exist positiveconstantsC1 and C2 such thatf1 (x) <C lgl(x) and f2(x) <C2g2 (x) forall xinD. Butthen 1306) +1306) <C1g1(X) +C2g2(X) <C[g1(X) +g2(X)], where C is the larger ofC1 andC2. Also, ﬁ (X)f2(C) <C1C2g1(x)g2(X) for all x in D. These two inequalities implythat f,+f2 =0(gl +g2) and flfz = 0(g1g2)- COROLLARY1.14. Iff,and f2 are 0(g)on the domainD, then fl+f2 = 0(g) andf1 f2 =0(g2)on D. Proof Setting g =gl =g2 inTheorem1.13, we have that f,+f2 =0(2g) = 0(g) andf,f2 =0(g2),as claimed. THEOREM 1.15. Ifg(x) S h(x) for all xina domain D, then 0(g) + 0(h) = 0(h)and 0(g)0(h) =0(gh). Proof Iff1 = 0(g)andf2 =0(h)on D, then there exist positiveconstants Cl and C2 such that f,(x) <C, g(x) S C, h(x)and f;(x) <C2h(x) forall xinD. There- fore, ﬁ (x) +f2(x) <(C1 +C2)h(x) and f,(x)f2(x) <C1C2g(x)h(x) forall xinD. But this implies that f,+f2 =0(h)andf1 f2 =0(gh),as claimed. We mentioned that itis natural thatcomputers shouldrepresent integers and do calculations in binary notation—theyrepresent numbers usingbits, or binary digits. Thus, we can discuss the computational complexity ofan algorithm interms of bit operations, by whichwe mean the addition,subtraction, or multiplication oftwo binary digits, the division ofa two-bitinteger bya one-bitinteger, orthe shifting by one place ofan integer written inbinary notation. Consider the operation ofaddition, forexample. Inadding twon—bit integers by the usual algorithm,we add the digits twoata time,andeven allowing fora “carry”each time, the number ofbitoperationsis clearly at most3n. Hence, addition and also subtraction oftwon—bit integers takes 0(n)operations. Onthe other hand, the usual multiplication algorithm clearlyrequires71 2 bitmultiplications and 0(n)additions,carries, and shifts. Thus,since n Sn2, itfollows fromTheorem 1.15 that 0(n2)-bit operationsare required. Somewhat surprisingly, however, faster algorithms for multiplicationare avail- able. Suppose, forexample, that P(n)denotes the number ofbitoperations required to multiply two n-bitintegers and thatwe want to multiplytwo 2n-bitintegers 2n—l 2n—1 a= 2a,-2i and b= 2biZ‘. i=0 i=0 35 Preliminary ConsiderationsChap.1 Note that a=A1'2\"+A0and b=Bl'2n+B0, where A0 =2?;01ai2', A1=2%:;1a,-2\"‘\",Bo =3:01 bi2‘,andB1 =2,251 bi2i‘\". The straightforward multiplication ofa andb gives ab =AlBl' 22\" +AIBO ' 2n +AOB1'2n +A030, which is the sum ofthe fourproducts oftwo11-bit integers withappropriateshifts and carries. Thisgives P(2n) =4P(n) +cn, wherec isa positive constant,so P(2n) = 4- 0(n2) = 0(n2) by Theorem1.11. A littleingenuity,however, improves there- sult. One has only to do the algebra tosee that ab =(22\" +20/113, +2\"(A,——Ao)(Bo — Bl) +(2\"+1)AOBO. (1.19) This clearly requires the computation ofthree products ofn-bitintegers, AlBl, (Al— A0)(B0-— B1), andAoBo, inaddition toa number ofshifts and additions. Thus, P(2n) S 3P(n) +cn, (1.20) where c is a positive constantsince the additionsand shifts clearly require only 0(n) operations. Now itfollows from (1.20) that P(2\")sq(3\"—2\"), (1.21) where q is the larger ofP(2) andc. Forn =1, thisis clearly truesince P( l) =0 and, by (1.20), P(2) s3P(1) +c =c(3l— 2‘).Assume that P(2\") S 4(3k -2k), where k 21 is ﬁ xed. Then,again by(1.20), P(2\"+') S 3P(2\") +c- 2\" S 3q(3\"— 2\") + c- 2\" Sq3\"+‘—q~3 -2\"+q-2\" =q(3k+l _2k+l), and the resultis true foralln 2 lby mathematical induction. Before showing thatthe algorithm of(1.19)is more ef ﬁ cient thanthe usual algorithm,we note that forany real(1, by[oz] we mean the integer satisfying [a]S a < [a] +1; thatis, [a]is the largest integer notexceeding a. THEOREM1.16. P(n) =0(n1°323). Proof Since n =21°82\" S2['°32\"1+', itfollows from(1.19) that P(n) sP(2['°82\"1+') Sq(3 ﬂ og2nl+l _2[log2n]+l) <3q- 3'°32\" =3qnl°g23 Sec. 1.9 Computational Complexity 37 since log2 n ' logz3 =log23- logz It implies that logz31°32\" =log2”10323, which in turn implies that3‘°82\" =#0323. Butthen P(n) =0(n1°323), as claimed. Note thatlog23 =1.5849.. . , so thatthe algorithm of(1.19)is considerably better than the usual algorithm, whichrequires 0(n2) operations,as we have already seen. Buteven better algorithmsexist. Thebest algorithm todate can multiplytwo n-bit integers in 0(n- logn- log log n) operations, andn- logn- log logn is much smaller thann1°323 forlarge values of11. Note, by the way, that 0(logwn) =0(logbn), whereb is any real number greater than1. Tosee this, we have only tonote thatloglon =log“,b- log,J n. Finally, althoughwe choose not to prove ithere, the followingtheoremshows that the number ofbitoperations fordivisionand multiplicationare related. THEOREM1 .17. Ifa isa 211-bit integer andbhas no more thann bits, there is an algorithm for computingthe quotientand remainder ofthe division ofa byb in P(n) steps, the same number ofstepsas required for multiplyingtwo n-bitintegers. For our purposes, itwillsuf ﬁ ce to take P(n) =0(n2)rather thanone ofthe sharper estimates given above. EXERCISES 1.9 1. (a) Find thebase 10 analog to identity(1.19). (b) Using part(a), multiply63 by57 using only addition,subtraction,shifts, and just three multiplications ofone-digitintegers. (c) Use part(a) twice to multiply7431 by7283 using onlyadditions,subtractions, shifts, and justnine multiplications ofone-digitintegers. 2. Ifn =Ef=o n ibiwith0 Sn,- <b and n,=# 0 is thebase b representation ofn, show that r =[10gb n] +1. 3. Use Exercise 2 to determine the number ofdigits inthebase10 representation of 26“. 4. lift= 0(g)onsome domain D for i =1, 2,. . . , n, prove that 2L1]? =0(g) and117:1 ﬂ = 0(g\")on D forevery positive integern. 5. Ifa >1, b >1, and f(n) = 0(a\")forall positiveintegersn, under what circum- stances does itfollow that f(n) =0(b\")? 6. IfF\" denotes the nth Fibonacci number, prove thatF,, = 0(a\"“),whereoz = (1 + J3 )/2 and the domainis theset ofallpositiveintegers. 38 Preliminary ConsiderationsChap.1 7. IfLn denotes the nthLucas number,show thatL,, = 0(a\"),where the domainis the set ofall positiveintegers. Computer Exercises 8. Writea computer program toadd two arbitrarilylarge positiveintegers. 9. Writea computer program to multiplytwo arbitrarilylarge positiveintegers. Divisibili’ry Properties ofIntegers Among the most importantideas inthe theory ofnumbersis that ofthe divisibility of integers; we introduced this concept in De ﬁ nitions1.1 and1.2 inSection1.4. Questions concerning primes and divisorswere among the earliest tobe considered when human beings ﬁ rstbegan tore ﬂ ect on the properties ofnumbers, and thesearch foranswers continues to thisday. How many primesare there? Howmanydivisors does an integerhave? Arethere any otherintegers like6 =1 +2 +3, where thesum ofthe proper divisors ofthe numberis equal tothe originalnumber? Can one ﬁ nda formula forthe nthprime? Does the formula F(n) =22 +1 yield primevalues for every positive integern? Forwhatvalues ofItdoes 2\"—1 give primevalues? We shall considerthese and other questions concerning divisibilityas we develop the theory. 2.1 BASIC PROPERTIES The ﬁ rstconsequences ofDe ﬁ nition1.1, whichshouldbe reviewed at this time,are contained inthe followingtheorems. Recall thatweare usinglowercase Latinletters to designate integers unless expressly stated tothe contrary. THEOREM2.1 (i) IfaHE 0, then a|0 and ala. (ii) l|b foranyb. (iii) Ifalb, then albc foranyc. (iv) Ifalb and blc, then alc. (v) Ifa|b and alc, then a|(bx +cy) forany xandy. 39 40 Divisibility Properties ofIntegersChap. 2 Proof Parts (i) and (ii)are trivialsince a- 0 =0, a-1 =a, and1 - b =b. (iii) Ifalb, there exists 4 such thataq =b. Therefore,a(qc) =be, so albc for any0. (iv) Ifa|b and blc, there exist integers rands such that ar =b andbs =c. But then c =a(rs),so alc,as claimed. (v) Ifalb and alc, there existu and1) such thatau =b andav =6. Then bx +cy =aux +avy =a(ux +vy),so that a|(bx +cy) forany xandy. Property (v) in Theorem2.1 is especially useful insolving many divisibility problems. In particular,we may note that ifalbandalc, then a|(b +c) and a|(b— 6). Also, property (v) extends tosums ofmore than twoterms. Thus, ifalbi for i = 1,. . . , n, then a|(b1x1+- - - +bnxn) foranyintegers x1, x2,.. . , x\". THEOREM2.2. Ifalbandb=l= 0, then|a| S|b|. Proof Ifalb and b#= 0, there existsc9E 0 such thatac =b. Butthen|b| = |a|- |c| 2|a| since[cl 21. COROLLARY2.3. Ifa andb are positive and alb andbla, thena =b. Proof By Theorem 2.2,|a| S|b| and|b| S|a|. Butsince a andbare positive, the absolute value bars are super ﬂ uous. Thus,a Sb Sa,so a =b. In what follows,we shall havea number ofoccasions touse this corollaryas a simple buteffective tool in proving equality ofnumbers. EXERCISES 2.1 . Ifalb and a +b =c, prove thatalc. . Ifa|c and a +b =c, prove thatalb. . Ifm|(35n +26), m|(7n +3), and m >1, prove thatm =11. . Ifm|(8n +7) and m|(6n +5), prove thatm = :1.UIAWNH. Ifa >0, b >0, and; +%is an integer, prove thata =b. Also,Show thata =1 or2. . Ifa= bq+ rwithOS r<bandbla, prove that r=0. . Let S be theset ofall positiveintegers ofthe form ax +by. Suppose thatSis not empty and let d =axo +byo be theleast element inS. Show thatevery element ofS is divisible bya’. Hint: Letn be an element ofS. Thenthere exist integersq andr, with0 S r <d, such thatn =qd +r. Using thespecial nature ofn andd, argue that r =0.\\l6\\ Sec. 2.2 The Greatest Common Divisor 41 8. Let S be theset ofExercise7; show thatS contains allpositive integral multiples of d =axo +bye. 9. Let Nn be the integerwhose decimalexpansionconsists ofn consecutiveones. For example, N2 =11 andN7 =1,111,111. Show thatlifandonly ifnlm. Computer Exercise 10. Writea program to determine ifone positive integer divides another. 2.2 THE GREATEST COMMON DIVISOR Ifdla and dlb, then dis said tobea common divisor ofa andb. Ifa andb are both equal to zero, itfollows from property (i) ofTheorem2.1 thattheyhave in ﬁ nitely many common divisors. However, ifatleast one ofa andb is di ﬂ ‘erent fromzero, it follows from Theorem 2.2 thatthe number ofcommondivisorsis ﬁ niteandhence that there mustbe a largest common divisor. DEFINITION2.1. Ifdis thelargest common divisor ofa andb, itis called the greatest common divisor ofa andb andis denoted by(a, b). In view ofthe preceding discussion, itis clear that(a, b) is de ﬁ ned only incase a and b are not bothzero. Thus, whenwe subsequentlyhave occasion to write(a, b),. we shall always imply thata andb are notbothzero. Also, itis clear that(a,b) isa positive integer. Ifeithera orb is small, the problem ofﬁ nding(a, b)is not di ﬂ icultsince there are onlya few alternatives. Forexample, itiseasy tosee that i1, i2, i3, and i6 are the only common divisors of12 and18 and that6 =(12,18). However, trial-and- error methodsare notvery ef ﬁ cient when itcomes tolarge values ofa andb. Thereis an efficient and systematic way forcomputing(a,b), butbefore discussing it, itwillbe convenient topresent two interesting and very useful alternativecharacterizations of the greatest common divisor. THEOREM2.4. Ifa andb are notbothzero and ifd =(a,b), then disthe least element intheset ofallpositiveintegers ofthe form ax +by. Proof Consider theset C ofallpositiveintegers ofthe form ax +by. By hypothesis, at least one ofa andb is different fromzero. Forde ﬁ niteness,suppose thata95 0. Ifa >0, thena itselfisa member ofC, and ifa <0, -a isa member ofC. Therefore, C is notempty, andso, by the well-ordering principle,musthavea least element. Let e=ax0+byo be the least element ofC. Itsu ﬂ ices toshow that d =e. 42 DivisibilityProperties ofIntegersChap. 2 By Theorem1.9, there exist integersq and rwith0 S r <e such thata =eq +r. Thus, r =a— eq =a -(axo + mm =a(1 -qxo) +b(— qyo), which is ofthe form ax +by. Ifrwere notzero, itwouldbea member ofC, and this would contradict ourassumption thate is the smallest member ofC. Thus, r =0 and ela. Similarly,one can show thate| b. Thus,e isa common divisor ofa andb,so that, by De ﬁ nition2.1,e Sd. On the otherhand,sincee =axo +byo and dlaand(II b, it follows from property (v) ofTheorem2.1 thatd|e. Hence, dSe by Theorem2.2,so d =e. THEOREM2.5. d =(a, b) ifand only ifd >0, dla,d|b, and fld forevery common divisor fofa andb. Proof As noted earlier,since weare discussing (a,b), weare tacitlyassuming that a and b are not bothzero. (i) Suppose, ﬁ rst, that d =(a, b). Then dla,d|b, and by Theorem2.4, d = ax + by >0 forsome integers xandy. Butthen, if f|a and fl b, fId by property(v) of Theorem 2.1. (ii) Conversely, suppose that d >0, dla,dlb, and fId forevery common divisor fofa andb. Then disa common divisor ofa andb and, byTheorem2.2,| f| Sd. Thus, d =(a, b) by De ﬁ nition2.1. 2.3 THE EUCLIDEAN ALGORITHM We are now ina position todiscuss an orderlyand systematicprocess forﬁ ndingthe greatest common divisor oftwononzerointegers. Sucha methodis given inBook VI of Euclid’s Elements andis now knownas Euclid’s algorithm. For a >b >0, we proceedas follows. Dividea byb getting, according to Theorem 1.9, a quotient qland remainderr1 such thata =bql +rlwith0 Sr1 <b. Ifr1 =0, then bla and(a, b) =b. Ifr1=# 0, we divideb by rl, gettinga quotientqz and remainderr2 such thatb =(1271 +r2 with0 Sr2 <r1. Ifr2 =0, theprocess stops. If r2 ¢0, we continue and getr1 =q3r2 +r3 with0 Sr3 <r2, andso on. Eventually, the process must terminate witha zero remaindersince thedecreasingsequence of nonnegative numbersb > rl >r2 >r3 >- - - can extend forat mostb terms before reaching zero. Suppose that rkHis the ﬁ rstzero remainder,so thatwe have the equations Sec. 2.3 The Euclidean Algorithm 43 a=bq1+r1, b=rlq2+r2, rk—3 =rk—q—l +rk—19 ’k—2= rk-lqk+rk, rk—l = rq+1- Itis easy to show thatrk, the last nonzero remainder,is thedesiredgreatest common divisor ofa andb. We have thatrklrk_l andrklr,c so, using thenext-to—last ofthe preceding equations and property(v) ofTheorem2.1, rklrk_2. Butthen rklrk_land rklrk_2, so, using the thirdequation fromthe last and property(v) ofTheorem2.1, rkl rk_3. Thisprocess maybe continued toshow thatrkla andrklb. Onthe otherhand, if fla and flb, itfollows fromthe ﬁ rst ofthe preceding equations and property(v) of Theorem 2.1 that fIr1 . Butthen flb and f| rland itfollows fromthesecond equation and property (v) ofTheorem2.1 that f| r2. Continuingthis argumentstep bystep, one ﬁ nallyhas that f| rk. Thus,rk satis ﬁ es the conditions ofTheorem2.5,so rk = (a, b), as claimed. To make the methodclear, we ﬁ ndthegreatest common divisor of288 and51. Performing the appropriate divisions,we obtain 288=51-5+33, 51=33'1+18, 33=18~1+15, 18=15-1+3, 15=3-5. Thus, according to the preceding discussion,3 =(288,51). Moreover,one canuse the preceding equations to ﬁ nd xand ysuch that3 =288x +5 ly, whichwe know exist by Theorem 2.4. Startnwiththenext—to-last equation and eliminatingsucces- sive remainders, we obtain 3=18—15 =18—(33—18) =2-18—33 =2(51—33)—33 =2-51—3-33 =2-51—3(288—5-51) =288(—3)+51- 17. 44' DivisibilityProperties ofIntegers Chap. 2 Thus,3 = 288x +51 y, where x =— 3 and y =17. Inpassing, itmaybe noted that the xand yare notunique. Forexample, 3=288(—3)+51- 17 =288(—3)+288- 51 —288- 51+51-17 =288- 48+51(—271), so that x =48, y =— 271 woulddo justas well. Infact, itiseasy tosee thatthereare in ﬁ nitely many pairs ofvalues that xand ymayassume. Note that while the preceding calculation of xand yis easily accomplished by hand ifthe number ofsteps is notlarge, itis notthe most ef ﬁ cient formachine computation. To do itthis way by machine,onehas tocreatea ﬁ le tostore the successive quotients and remainders and then compute backward,as above. This can be avoided ifateach successive division,we immediatelyupdate by writingthe new remainderas a combination ofa andb. For288 and51, we wouldproceedas follows. 288=51~5+33 33=288—5-51 51=33-1+18 18=51—33 =51—(288—5-51) =—288+6-51 33=18-1+15 15=33-l8 =(288—5- 51)—(—288+6-51) =2-288—11-51 l8=15-1+3 3=18—15 =(-288+6-51)—(2-288—11-51) =—3°288+17-51 15=3'5 Thus,3 =(288, 51) =288x + Slywith x =—3 and y =17,as above. The point ofTheorem 2.4 is notso muchthe fact that d =(a, b) is theleast positive integer ofthe form ax +by, but that dcanbe written inthis format all. This fact was needed inthe proof ofTheorem2.5, which formedthebasis forthediscus- sion ofEuclid’s algorithm,and itwillprove useful at other pointsas we continue to develop the theory. Note, by the way, that ifa andb are bothpositive, then d < a +b, so one of xand y in d =ax +by mustbe positiveand the othernegative. or0 Incidentally,an expression ofthe form ax +byis said tobea linearcombina- tion ofa andb since each termis of ﬁ rstdegree ina andb. Thus, Theorem2.4 implies that (a, b) can be representedas a linear combination ofa andb. Itis importantto note, however, thatthe converse ofthisstatementis nottrue. Thatis, ifd =ax +by, itdoes not follow that d =(a, b). For ifd =ax +by, then kd =a(kx) +b(ky)isa linear combination ofa andb forevery k, and not allthese values can equal(a,b). From d =ax +by one can conclude that(a, b)|d, but withoutfurther information, Sec. 2.3 The Euclidean Algorithm 45 this is all thatcan be said. On the otherhand, if1 =ax +by, then(a,b)|1, andsince (a, b) is a positive integer, itfollows that(a, b) =1. Thus,we have provedthe following littletheorem. THEOREM 2.6. (a, b) =1 ifand only ifthere existintegers xand ysuch that1 = ax +by. COROLLARY2.7. Ifd =(a, b) and Aand Bare de ﬁ ned bythe equations a =Ad,b =Bd, then (A, B) =1. Proof. Since d =(a, b), there exist integers xand ysuch that d =ax +by. Therefore, 2 d and (A, B) =1, by Theorem2.6. 1= x+§y=Ax+By DEFINITION2.2. If(a, b) =1, thena andbare said tobe relatively prime. More generally, if((1,,(1,) =1 fori=/= j,1 S iSr,1 S jSr, theintegersa1, a2,. . . , a, are said tobe pairwise relatively prime. A great deal more can be said about thespecialcase when twonumbersare relatively prime thanis contained inTheorem2.6 and Corollary2.7. Furtherresults, appear inthe followingsequence oftheorems, andwe shallhave occasion to return to the idea again and again. THEOREM2.8. Ifalbc and (a, b) =1, thenalc. Proof Since (a, b) =1, there exist integers xand ysuch that1 =ax +by. Therefore,c =acx +bcy. Butalbc, byhypothesis,so a|(acx +bcy) by property(v) of Theorem 2.1. Therefore, ale and the proofis complete. COROLLARY2.9. Ifpisa primeand plbc, then plb, orplc. Proof Ifplb,there is nothing toshow. IfpXb, then(p, b) =1 since the only positive divisors ofpare1 and11 itself. Butthen plc, by Theorem2.8. COROLLARY2.10. Ifpisa primeand plalaz- - - an, then plai forsome i, lsisn. This corollarycan easily be proved by mathematical inductionand the proofis left for the reader. COROLLARY2.11. p,p,,p2,. .. ,p,,areprimesandplplp2- - - pm thenp=p,- forsome i,1 sisn. 46 Divisibility Properties ofIntegers Chap. 2 Proof By Corollary2.10, plpi forsome i,1 S i s11. But pwe1 and the only positive divisors ofp,- are land pi.Therefore, p =p,- and the proofis complete. THEOREM2.12. If(a,b,-)=1 fori=1,2,. .. ,n,then (a,12.12,. .. b,,)=1. ProofSuppose that(a, blbz- - - bu) =d >1. Then, by Theorem1.2, there exists a prime1) such that pld.Since did and dlb1 b2- - - b\", itfollows fromproperty (iv) ofTheorem2.1 that plaand plblbz-~ - b\". Therefore, by Corollary2.10, plbi for some i,1 S1' Sn. But then p|aand plbi,and this contradicts(a, bi) =1 forall i =1, 2,. . . , n. Therefore, itmustbe thecase that d =l. THEOREM2.13. Ifalc, blc, and(a, b) =1, thenablc. Proof. Since ale and blc, there exist integers rands such that or =c =bs. From this itfollows that blar. But(a, b) =1 andso, by Theorem2.8, blr.Thus, bl = r forsome tandc =or =abt. Therefore, able andthe proofis complete. COROLLARY2.14. Ifmbmz,. .. , m\"are pairwise relatively primeand mila fori=1, 2,. . . ,n,then mlawherem=m1m2- - . m\". Proof. The result is certainly true forn =1. Suppose that itis also true for n = k and consider the integers m1, m2,. . . , mmwith (m,m,) =1 for ia ﬁ j, ls iSk+1,1 Sjsk+1. By Theorem 2.12, (m’,mkH) =1where m’ = mlmz- - - rm,and by the inductionassumption, m’la. Butthen, by Theorem 2.13, m’mk+1|a and m’mk+1 =mlmz-- - mkH.Thus, the resultis true forall n 21, by mathematical induction. We close this section by provinga theoremdue toGabrielLame in1844 which. gives an upper bound on the number ofsteps needed tocomplete the Euclidean algorithm for computing(a, b). Firstwe need toprovea smallresult about Fibonacci numbers. LEMMA2.15. Let a =(1 +15)/2.Then F\" > a\"'2forn 23. Proof Note thatF3 =2 >1.618. .. =(1 +J5)/2and thatF4 =3 > 2.618. . . ={(1 +J3)/2)2. Thus, the resultis true forn =3 andn =4. Assume that Fk >ark—2 andFk+1 > ak“forsome ﬁ xed k 23. Then Fk+2 = Fk+1+Fk >01\"“ +a\"‘2 =ak‘2(oz +1) =01\" since01 +1 =112. Thus, the resultis true foralln 23 by mathematical induction. THEOREM2.16. Leta >b >0. The number ofdivisionsneeded to ﬁ nd (a, b) by the Euclidean algorithmis at most5 times the number ofdecimal digits inb. Proof Referring totheset ofequations describing the Euclidean algorithmat the beginning ofSection 2.3, we note thatwe have used k +1 divisions. Moreover, Sec. 2.3 The Euclidean Algorithm 47 61:21 for1 S i skand q22 sincerk <rk_ ,.Asusual, let F\"denote the nth Fibonacci number. Then, bythe equations at the top ofpage 43, rk>_1 =F2, rk— 1\"‘2rk22=F3, rk-2>— \"k—r +VkZFs + F2:F4, 71 >\"2'i'7'3>1;‘k+Fk—1 =Fk+la b271+722Fk+1 +Fk=Fk+2- Thus, ifthere are k + ldivisions, itfollows thatb 2 FH2 >a\"for k 2 lby Lemma 2.15. Hence, loglo b > klogw a>1? since logoat =0.208.. . . Let rbethe number ofdecimal digits inb. Thenb <10’ and loglo b <r. Thus, fromabove, k<510g10b<5r and k +1 5 5r since rand kare integers. Thiscompletes the proof. COROLLARY2.17. The number ofbitoperationsneeded to ﬁ nd(a, b) with a >b >O is 0((log2a)3). Proof Since b <a, itfollows fromLamé’s theorem thatthe number ofdivi- sions required to compute(a, b) is 0(log10b) =0(log2b) =0(log2a). Also, by Theorem 1.16, the number ofbitoperations required to performeach ofthese divisions is 0((log2(1)2). Thus, (a, b) can be found in0((log2a)2)0(log2a) = 0((log2(1)3) bitoperations,as claimed. EXERCISES 2.3 1. (a) Compute (357, 629) and determine xand ysuch that (357, 629) =357x +629y. (b) Compute(— 357, 629) and ﬁ nd xand ysuch that (— 357, 629) =— 357x +629y. 48QUIJKO)\\q 11. 12. l3. 14. 15. 16. 17. *18. *19. Divisibility Properties ofIntegers Chap. 2 . (a) Compute (7700, 2233) and determine xand ysuch that (7700, 2233) =7700x +2233 y. (b) Compute (7700, —2233) and determine xand ysuch that (7700, —2233) =7700x— 2233 y. . Ifais an integer, prove that(14a +3, 21a +4) = l. . Ifb ¢0, prove that(0, b) =|b|. . Prove that b|a ifand only if(a, b) =|b|. . Ifblc, prove that(a, b) =(a +c, b). Hint: Let d =(a, b),e =(a +c, b) and show thatdle andeld. . If(a, c) =1 and blc, prove that(a, b) =1. . If(a, c) =1, prove that(a, bc) =(a, b). . Ifc >0, prove that(ac, bc) =c(a,b). 10.If(a,b) =1, prove that(a +b, a— b) =1 or2. Hint:Suppose that d =(a +b, a— b). Show thatd|2b, dl2a,anduse the result ofExercise 9. If(a, b) =1, prove that (2a +b, a +2b) =1 or3. Ifdlmnand (m, n) =1, prove thatd=d1d2,whered.|m,dzln and(d1, d2) =1. Hint: Let(I, =(d, m). If(a, b) =(c, d) =1, b >0, d >0, and a/b +c/dis an integer, prove thatb =d. Prove that the product ofany three consecutive integersis divisibleby6. Suggestion: Use Theorem 2.13 andExercises4 and5 ofSection2.2. If(a, b) =r, (a, c) =s, and(b,c) =1, prove that(a,be) =rs. Givean example to show that thisneed notbe true if(b,c) >1. For the Fibonaccisequence(see Section1.2), prove that(Fn, Fn+l) =1 for every positive integern. For the Fibonaccisequence, prove that(Fn,Fn+3) =1 or2 forn 21. Hint: Let d|(F,,,Fn+3) and show thatdl2. In Exercise17, (F,,, F,,+3) =2 ifand only if2|F,,. Show that2|Fn ifand only if n = 3q forsome positive integerq. Hint: For the “if”part, note that2 =F3 anduse Exercise19 ofSection1.4. For the “only if”part,deduce fromExercise17 ofSection1.4 that F” = F3q_1F , +F3qF,+1 forn =3g +randargue by contradictionusing the results ofExercises16 and7. Exercise18 can be generalized. Form >2, show that lF\"ifand only ifmln. Hint: Forthe “only if”part ofthe proof,deduce fromExercise17 ofSection1.4 that F\" = q— lF, + qF,+1, wheren =mq +randagainargue by contradic- tion using Exercises16 and7. Sec. 2.4 The Least Common Multiple 49 *20. Let t Z2 andsuppose thatm is theleast positiveintegersuch thattlFm. Prove that t|F,, ifand only ifmln. Note: Thatsuch an m always exists is guaranteed byExercise28 ofSection4.1. *21. Let N”be the integerwhose decimalexpansionconsists ofn consecutiveonesas in Exercise9 ofSection 2.1. Show that(Nn, N\") =N(,,,m). *22. If(a, b) = l,and a >b >0, prove that (am — b’”, a\"— b”) =a‘m’”)— W”) for any positive integers m andn. Computer Exercises 23. Writea computer program tocompute d =(a, b) and to determine xand ysuch that d =ax +by forany positiveintegers a andb. 24. Use your program to compute(Fm, F\") for1 sn <m S35, where F\"denotes the nth Fibonacci number. Makea conjecture on thebasis ofthis computation and prove that yourconjectureis correct. 2.4 THE LEAST COMMON MULTIPLE Ifalm and blm, then m is calleda common multiple ofa andb. Since divisionbyzero_ is meaningless, itis clear that this de ﬁ nitionhas meaning only ifa andb are both different from zero. Inthiscase itis clear thatab and—abare both common multiples ofa and b and thatone ofthemis positive. Therefore, by the well-ordering principle, there must exista least positive common multiple. DEFINITION2.3. Ifmis the smallest positive common multiple ofa andb, itis called the least common multiple ofa andb andis denoted by[a, b]. In View ofthe preceding discussion, whenwe write[a, b] we shall always understand thata and bare different fromzero. The following twotheorems provide alternative characterizations oftheleast common multipleas wellas a method for computing it. THEOREM2.18. m =[a, b] ifand only ifm >0, a|m, b|mand mln for every common multiplen ofa andb. Proof. Since we are discussing [a, b],we tacitlyassume thata andbare di ﬂ ‘erent from zero. (i) Suppose, ﬁ rst, thatm =[a, b] and thatn is any common multiple ofa and b. By de ﬁ nition, m >0, alm,and blm,so we have onlytoshow thatmln.Thereis no loss in generality inassuming thatn is positive, for ifn were negative,we would consider—11. Since, by de ﬁ nition,mis theleast positive common multiple ofa andb, 50 Divisibility Properties ofIntegersChap. 2 it follows that m Sn. By Theorem1.9, there existq and rwith0 S r <msuch that n = qm +r. Then r =n— qm and itfollows from property(v) ofTheorem2.1 that r is a common multiple ofa andb since both m andnare common multiples ofa and b. Ifr=/= 0, this violates the given condition thatmis theleast common multiple. Therefore, r =0 and mln,as claimed. (ii) Suppose that m >0, alm, blm, and that mln forevery common multiplen ofa andb. Clearly, misa positive common multiple ofa andb,so we have only to show that itis the least positive common multiple.Since mln,wheren is any common multiple, itfollows fromTheorem2.2 thatm S|n|. Thus, mis theleast positive common multiple ofa andb and the proofis complete. THEOREM 2.19. Ifab=# 0, then[a, b] =lab/(a,b)|. Proof Let d =(a, b), a =Ad,b =Ed, and m =lab/d]. Thenm =|Ab| =laBl, so that m >0, alm, and b|m. Ifa|n and bln, thenthere exist rands such that ar=n =bs. Therefore, Adr =Bds and Ar=35. This implies thatA|Bs. But (A, B) =1 by Corollary2.7,so, by Theorem2.8, A|sand thereexists Isuch that At =s. But then11 =bs =Abt = imt,so mln.Thus, msatis ﬁ es the conditions of Theorem 2.18 and m =[a, b],as we were toprove. In view ofTheorem2.19, the computation oftheleast common multiple oftwo nonzero integers can be made todepend on the computation oftheirgreatest com- mon divisor, which, in turn,can be computed by Euclid’s algorithm. Forexample, since we found earlier that(288, 51) =3, we nowhave that [288, 51] =38—83—51 =4896. Ofcourse, the ideas ofgreatest common divisor(g.c.d.) andleast common multiple can be extended ina naturalway tomore than twonumbers. Thus, ifal, a2,. . . , a,are notallzero, theyhave a largest positive common divisorwhichwe denote by((11, a2,. . . , ar). Itcanbeshown that distheg.c.d. ofal, a2,. . . , a,if and onlyifd >0, dlai, fori =1, 2,. . . , r, andfldforeverycommon divisorfofal, a2,.. . , (1,. Also, itcan be shown that distheleast positive integer ofthe form alxl +azxz +- - - +a,x,. The integersa1, a2,.. . , a,are said tobe relatively prime incase (a,,a2,. . . , a,) =1. As before, ((11,612,. . . ,a,)=1 ifand only ifthere exist integers x1, x2,.. . , x,such that a1x1+' ' ' +a,x,=1. Similarly, ifnone ofa1, a2,.. . , a,are zero, theyhavea least positive common multiple whichwe denote by [aba2,. . . , (1,]. Itcanbe shown that m = [a1,a2,. . . ,a,]ifandonlyifm >0,a,-|mforeachi=1,2,. . . ,r,andm|n for every common multiplen ofthea’s. Sec. 2.4 The Least Common Multiple 51 The calculation ofthegreatest common divisorandleast common multiple of more than two integers can be accomplished insuccessive steps inaccordance with the following theorems. THEOREM 2.20. Ifnone ofa1, a2,.. . , a,is zero, then (ab02,- - - aar)=((al’- '- 9ar—1)s at)- Proof Let d=(a1, a2,. . . , a,) ande =((a1,. . . , a,_1),(1,); then dande are both positive. By Corollary2.3, itsuf ﬁ ces toshow thatdle andeld. Since d=(a1,. . . , a,), dlai for i=1, 2,.. . , r. Therefore, d|(a1,. . . ,a,_,)and dla,. But then dle by Theorem2.5. Onthe otherhand, ela, and e|(al,. . . , a,_l). Therefore, ela, for1 S iSr,so eld. Thiscompletes the proof. THEOREM 2.2]. Ifnone of(11,02,. .. ,a,iszero, then [al’aZs-~ ' 9dr]=[[al9° ° - sat-Ilsar]° The proof ofthis theorem, whichis exactlyanalogous to that ofTheorem2.20, is left to the reader. Theorems 2.20 and2.21 providea systematic method forcomputingthegreat- est common divisor and least common multiple ofmore than twointegers. For example, to ﬁ nd(108, 84, 78) we ﬁ rstuse the Euclidean algorithm to ﬁ nd that(108, 84) =12 and that(12, 78) =6. Hence, by Theorem2.20, (108,84, 78) =6. Also, from the equations ofthe Euclidean algorithmused tocompute(108,84) =12 and (12, 78) =6, itis easy to ﬁ ndx1, x2,x3 such that6 =108x, +84x2 +78x3.These equations give12 =4- 84— 3- 108 and6 =78— 6 '12, whichcanbe combined to give 6=78—6(4- 84-3-108) =18- 108—24- 84+78. Thus, we can take x, =18, x2 =--24,andx3 =1. As before, itiseasy tosee that x,, 96;, and x3 are not unique. By Theorem 2.19, [108, 84] =108 ' 84 =756. 12 Using the Euclidean algorithm,we ﬁ nd that(756, 78) =6. Again, by Theorem2.19, [756, 78] =756 ' 78 =9828. Therefore, by Theorem 2.21, [108, 84, 78] =[756, 78] =9828. 52 Divisibility Properties ofIntegers Chap. 2 EXERCISES 2.4 1. 2.A Find the following. (a) [357, 629] (b){—357, 629] (c) [299, 377] Find (357, 629, 221) and determine x,y, and2 such that (357, 629, 221) =357x +629 y +2212. . Find [357, 629, 221]. . Find (299, 377, 403) and x,y, and2 such that (299, 377, 403) =299x +377 y +4032. 5. Find [299, 377,403]. 6. Ifc >0, prove that[ac, bc] =c[a, b]. 7. Prove that alb ifand only if[a, b] =|b|. 8. For any integern, prove that [9n +8, 6n +5] =54n2 +93n +40. 9. Find (12n2 +16n +6, 6n+5) and [12n2+16n +6, 6n +5], wheren is an integer. 10. Leta1, a2,. . . , a,be nonzerointegers. Let d=(11xl +azxz +-- ' +a,x, be that smallest positive linear combination ofa1, a2,. . . , a,. Prove that d=(a,,a2,. .. ,ar). 11. Prove that(a,, a2,. .. , a,) =1 ifand only ifthere exist integersxl ,xz,. . . , x,such that1 =a1x1+azxz +- - - +a,x,. 12. Give an example toshow thatthe equation l3. l4. (alsaZa- ' ' 9dr)[alsa2’' '' aarl=ala2' ' ' ar is notnecessarily true. Give an example toshow thatthe equation ofExercise12 is sometimes true.Can you discover under what conditionsthe equationis generally true? Computer Exercise Writea computer program todetermine the positive integer solutions tothe equation y2 -xy— x2 =1 andy2— xy -x2 =— 1. Makea conjecture onthe basis ofthe printout ofyourprogram. Trytoprove atleast part ofyourconjec- ture. 2.5 THE FUNDAMENTAL THEOREM 0FARITHMETIC As shown in Theorem1 .2, every positive integergreater than1 eitherisa prime orcan be successively factored intoa product ofprimes. Forexample,36 =4- 9 = Sec. 2.5 The Fundamental Theorem ofArithmetic 53 2- 2- 3- 3where2and3areprimes.Again, 36=6- 6=2- 3- 2- 3andwesee that the same prime factors occur ineachcase. Indeed, itis commonexperience that apart from the order inwhich the factors occur, factorization ofan integer intoa product ofprimes can be carried out inone and onlyone way. Commonexperience, however, is a poor substitute forproof. To illustrate this point, itis ourpresent purpose to exhibitsystems ofnumberspossessing many ofthesame propertiesas the set ofpositive integers, butwhere factorization intoprimesis notunique. We begin by letting Idenote theset ofallpositiveintegers, and considering the set Tofall positive integers ofthe form 3k+1, where kisa nonnegativeinteger. That is, T={1, 4, 7, 10, 13, 16, 19, 22, 25, 28,.. .} consists ofjustthose positiveintegers which leave a remainder of1 when divided by3. Since (3r+1)(3s+1)=3(3rs+ r+s)+1, it follows that the product ofany twoelements of Tis again an element of Tor, in more technical terms, that Tisclosed withrespect to multiplication.Also,since Tisa subset of I,certain properties of Inecessarily hold inT. Thus,we need no further argument tobe sure thatthe commutativeandassociative laws for multiplication hold in Tand that1 is the multiplicative identity forT, justas itis for I. In addition to the similaritiesalready mentioned, itis clear thatTalso contains prime and composite numbers, justas Idoes. Thatis, some elements in Tcanbe factored into products ofotherelements in Tandsome cannot. Forexample, 16 =4- 4 and 28 =4- 7, so16 and28 are composite inT. Onthe otherhand, none of4, 7, 10, 13, 19, 22, or25 canbe furtherfactored inTandso are called primes inT.’ But the similaritybetween Iand Tceases at this pointsince itiseasy tosee that factorization intoprimes in Tis notunique. Forexample,100 =4- 25 =10- 10, yet 4, 10, and25 are all prime inT. Ofcourse, none of4,10, and25 are prime inthe ordinarysense, buttheyare prime in Tandso we havea legitimateexample ofa multiplicativesystem where prime factorizationis notunique. Since Tand Ipossess precisely thesame multiplicativeproperties, itis apparent that some other property mustbe basic to unique factorization. Ofcourse, one suspects thatsome additive property, oratleast some property involvingbothaddi- tion and multiplication,maybe the crux ofthe matter, and itis certainly true that I and T differ considerably inthisrespect. Infact,since (3r+1)+(3s+l)=3(r+s)+2, itis clear that Tdoes not contain the sum ofany two ofitselements andso is noteven closed withrespect to addition. Ifwe consider additive propertiesas wellas multiplicativeproperties, then, in addition to the laws already mentioned, itis well known that Iis closed withrespect to addition, that the commutativeand associative laws for additionhold,and thatthe distributive law involving both additionand multiplicationis valid in I. However, not even all ofthese propertiesare su ﬂ icient toguarantee unique factorization,as the following example shows. We consider theset C ofallcomplex numbers ofthe forma +bx/5 i, wherea 54 Divisibility Properties ofIntegersChap. 2 and b are integers. Typicalelements ofC includesuch numbersas 2 +3 J51, 1— J31, 261' =0 +2s/EL and4 =4 +051'. Inparticular,we note thata = a +0 J31, so that allintegers are themselves members ofC. Itis easy tosee thatthe closure, commutative,andassociative laws forboth addition and multiplication hold inC, thatthe distributivelawholds, and thatoneis the multiplicative identity. Forexample, (a + b ﬁ i)+ (c+ d6i)=(a +c) +(b+dNEi and (a + [#3c+dJEi) =(ac— d)+ (ad+bc)J§i, so that C is closed withrespect to both additionand multiplication.Thereader should check tosee thatthe otherproperties holdas well. Since we have closure under multiplication, itis obvious that Ccontains com- posite elements. Although notas easy tosee, itis also true thatsome numbersare prime inC. Since21 =3- 7 =(1+2\\/§i)(1— 250,itwillfollow that prime factorization in Cis notunique, providedwe show that3, 7, l +2 x/Ei, and1 -2 J3 i are all prime inC. To show that3 is prime inC, we mustshow that itis impossible to ﬁ ndelements a and,6 inC, both different from i1, such that3 =a ﬂ .Thisis mosteasily accom- plished in the followingway. Ifa =a +b x/gi is any element ofC, de ﬁ ne N(a),called the norm ofoz, by the equation N(a) =a2 +5 b2. Thereadercan easily show by direct calculation that forany two numbers aand,6 inC, Ma ﬁ ) =N(a). N( ﬂ ).Now, suppose that a =a +bx/gi, ﬂ =c +(ix/3i witha, b,c, and dintegers, and that 3 =043. Then9 =M3) =N(a)- N(,B) =(a2 +5b2)(c2 +5d2). Since thisis an equation inintegers and1 - 9 =9-1 =3~ 3 are the onlypossibilities forfactoring9 in positive integers, itfollows that N(a) =1, or MB) = l,orN(a) =NU?) =3. Inthe ﬁ rstcase, itis clear thata = il,b =0,so that a = i1andwe have the trivial factorizations3 =1 - 3 or3 =(— 1)(— 3). Similarly,N(,6) =1 impliesthe trivial factorization3 =3-1 or3 =(— 3)(—1). Finally, N(a) =3 is impossiblesince if |b| >0, then Ma) 25; ifb =0 anda = i1, thenN(oz) =1; and ifb=O andlal Z2, then N (a) 24. Thus, itis impossible to ﬁ nda nontrivialfactorization of3 inCand3 is prime inC,as claimed. Similar calculations whichthe reader can easily performsuf ﬁ ce toshow that7, 1 +2 J31, and1 — 2 \\[57 are also prime inC. Thus,we may ﬁ nallysay thatunique factorizationdoes not hold inC, even through Capparentlysatis ﬁ es most ofthesame arithmeticallawsas does I,where prime factorizationis unique. The preceding examples clearly demonstrate theneed forgivinga carefuland rigorous proof ofthe fact that prime factorization in Iis unique,even thoughweare quite certain, by “commonexperience,” thatthisis true. Therehave beencases where claims supported by equally ﬁ rmconvictionshave been provedfalse. Sec. 2.5 The Fundamental Theorem of Arithmetic 55 THEOREM2.22. (The Fundamental Theorem ofArithmetic).Every in- teger n 22 is eithera prime ora product ofprimes, and the productis uniqueapart from the order in which the factorsappear. ProofSince the ﬁ rst part ofthe theoremis simplya restatement ofTheorem 1.2, we have only toshow thatthe representation ofany integergreater than1 as a product ofprimes is unique.Suppose that forsome integera 22, a=P1P2' ' ' pm=qlq2' ' '(In, where the p’s andq’s are primes, m 21, andn 21. Itis no restriction toassume that m_<_ n and that P1$P25\"'5Pmand (115425\"‘Sqn. Since the equalityabove implies that pl|qlq2- - - q\", itfollows from Corollary2.11 that p, =q,- forsome iwith1 S iSn. This implies that p, =q, 2q,.Similarly, it can be shown thatq, 2 pl, so, infact,q1 =pl. Dividingthese equal factors out ofthe initial equality,we obtain P2P3 '' ' Pm=0243'‘ '4n- But the argumentcan nowbe repeated toshow thatp2 =q2 and, similarly, thatp,- =q,- for i=3, 4,. . . , m. Atthisstage, ifmwereless thann, one wouldhave1 = 4\",“q~ '- q\", whichis clearlyfalse since4,- >1 foreach i. Therefore, m =n, p, =q,- foreach i, and the representationis unique,as claimed. Since the primes into whichan integercanbe factoredneed notbe distinct, it follows from the Fundamental Theorem ofArithmeticthateach integera 22 canbe representedas a producta =Hi=1 p? ofprimepowers. Thisrepresentationis called the canonical representation ofa. Thus22- 3,24- 34, and22- 5- 11 are the canoni- cal representations of12, 1296, and 220 inthatorder. If, ina given problem, onlyone numberis represented inthisway, we usually requirea, tobe positive foreach1'. However, for notationalconvenience when two ormore numbersare involved,we sometimes allowsome ofthe exponents tobe zero. Ifa1 =0, forexample, the prime p1 simplydoes notoccur inthe canonical representation ofa. Thisdevice makes it possible to write the canonical representation ofany twopositiveintegersso thatthey appear to involve thesame primefactorseven though theymay, infact, fail tohave any nontrivial commonfactors. Forexample,we could write12 =22- 3- 5° and 20 =22- 3°- 5; and one couldeven write1 =2°- 3°- 5°. Theusefulness ofthis device is apparent inthe following importanttheorem. THEOREM 2.23. Leta =ILL;p5“ witha, >0 foreach ibe the canonical representation fora and letb >0. Then b|a ifand only ifb =HEpf-h' withO Sb,- Sa, for each i. 56 Divisibility Properties ofIntegers Chap. 2 Proof Ifb =H§=1pfi with0 Sb,- S(1,, then a=Hp?“ i=1 r = Hplqi_bl+bi i=1 r = I]pit—”mi\" l=l = Hpgi-bi. Hp'bi 1\"] [-1 =c- b, where c = TIL, pfi‘b'andc 21 since a, -bi Z0 foreach i. Therefore, bla,as we wished to prove. To prove the converse, suppose thatbla. Then,since thereexists0 such that bc =a, the canonical representation ofa canbe formed by takingthe product ofthe canonical representations ofb andc. (Acanonicalrepresentation fora canbe formed in this way, and since the canonical representation mustbe unique by Theorem2.22, this mustbe the canonical representation.) Thus, the primes thatappear inthe canonical representations ofb andc mustbe thesameas those inthe canonical representation ofa; thatis, b =H5-1 p?‘ andc =115-: p? withb,- 20 andc,- 20. Since bc =a, itfollows that(1, =b,- +ci,so (1,2 bi. Thiscompletes the proof. Theorem 2.23 makes itextremelyeasy to writedown allthe positive divisors of a positive integer once its canonical representationhas been obtained. Forexample, since 72 =23- 32, the divisors of72 are 1'1 1'3 1'32 2'1 2'3 2'32 22.1 22.3 22.32 23.1 23.323.32_ It may be noticed thatthereare 4- 3 =12 such divisors and thattheyare the terms in the expansion ofthe product(1 +2 +22 +23)(1 +3 +32). Infact, this product gives the sum ofthe positive divisors of72. Ingeneral, ifa =II5.. 11);”, itis clear that H i=1(a,~ +1) is the number ofpositive divisors ofa and thatthe sum ofthese divisors is given by the product r ?i_1 H(1+p.-+p?+---+p$\"')=l'[- i=1 i=1 pi—l Itis customary todenote the number ofpositive divisors ofa by1(a) and theirsum by 0(a). Thus, we have obtained the followingtheorem. Sec. 2.5 The Fundamental Theorem ofArithmetic 57 THEOREM 2.24. Ifa =11.2117? witha,- >0 foreach iisthe canonicalrep- resentation ofa, then 1(a) = f](a, +1) and 0(a) = ﬂgit—ll i=1 i-li Also, 1(1) =0(1) =1. Canonical representationsalso make itveryeasy to ﬁ ndgreatest common divisors and least common multiples. THEOREM 2.25. Ifa ={If—1p? andb =11.5.1125?i anda,- 20 andb,- 20 for each iare the canonical representations ofa andb, then (a, b) = HI)?“ and la,b] = Hpl”, i=1 i-l where u, is the smaller ofa,- andb,— andv,- is the larger ofa,- andb,- foreach i. Proof Let d =11.5.1 pf-‘i. Since uiisthe smaller ofa,- andb,,u,~ Sa, andu,» Sb,- for each1'. Therefore, by Theorem 2.23, dla and dlb.Suppose that fla and flb. Then [fl =[1,21 p? with12 Sa,- andf,- Sb,- foreach1’. Butsinceu,- is the smaller ofa,- and bi, this implies thatf,- Su,- foreach1'. Therefore,again by Theorem2.23,l fl Id,so f| d. Since d >0, itfollows from Theorem2.5 thatTIE—1p?“ =d =(a,b),as claimed. To complete the proof, note that by de ﬁ nition ofu, andvi,a, +bi—u,- =2),. Thus, by Theorem 2.19, ab (a, b) Hp?’- Hpi\" = i-l i-l Hpl“ i-l r = Hpqi+bi_ui 1 i=1 r = Hp131, i=1 [a, b] = as claimed. For example, since 1296 =24- 34 and 9720 =23- 35- 5, we immediately have that (1296, 9720) =23- 34 =648 and [1296, 9720] =24 '35° 5 =19,440. 58 Divisibility Properties ofIntegers Chap. 2 EXERCISES 2.5qamawN 10. ll. 12. 13. 14. 15. 16. . Find the canonical representation ofeach ofthe followingnumbers. (a) 4725 (b) 3718 (c) 3234 . Find (4725, 3234) and [4725, 3234]. . Find (3718, 3234) and [3718, 3234]. . Find 1(4725) and 0(4725). . Find 1(3718) and 0(3718). . Find the sum ofthesquares ofthe positive divisors of4725. . Ifa =l'[5211);“ witha,- >0 foreach iisthe canonicalrepresentation ofa, deducea formula forthe sum ofthesquares ofthe positive divisors ofa. . Leta =H i=1pf-‘i Witha, >0 foreach thethe canonicalrepresentation ofa. Prove thata is the square ofan integer ifand only ifa,- is even foreach i. . Show thatthe number ofpositive divisors ofa positive integera is odd ifand only ifa is the square ofthe integer. Let a =[if—1p? andb =11,211)? with(1,20, bi 20 foreach ibe the canonical representations ofa andb. Prove that(a, b) =1 ifand only ifa,b,- =0 foreach i, thatis, ifand only ifa, orbiis zero foreach i. Ifa =Hf=1p€i, b =Hf=lp£’i, c=115.1pfi, with aizo,b,- 2O,c,- 2O are the canonical representation ofa, b, andc, prove that(a,b, c) =Hf=1p19 and [a, b, c] =115—117;”, whereu,- is the smallest ofa,, b,c,- andv,- is thelargest ofa,, bi, c, for each i. This result couldbe extended inthesame way to more than three integers. State the most general conditions whichassure that for r 23, (a,,a2,. . . ,a,)[a1,a2,. , , ,ar]=alaz. . . a\" Leta, b, c be positive integers. (a) Prove thatabc =(a,b, c)[(a,b), (a,c), (b, c)][a,b, c]. (b) Prove thatabc =(a,b, c)[ab,bc, ac]. (c) Prove thatabc =(ab,ac, bc)[a,b, c]. Finda result like any one ofthose inExercise13 forintegersa,b,c, andd. Let C be theset ofall complex numbers ofthe forma +bw/g i,wherea andb are integers. Prove that7,1 +251',and1 — 251'are all prime inC. Computer Exercise For each n writea computer program todetermine the minimumnumber of squares needed to writenas a sum ofnonzero perfectsquares. Execute the program for1 Sn S200 and printoutthe representations ofeach nas the sum of the minimum number ofsquares. Makea conjecture onthebasis ofthe print- out. Sec. 2.6 Pythagorean Triples 59 2.6 PYTHAGOREAN TRIPLES Everyone is familiar withthe fact thatthe triangle withsides3, 4, and5 isa right triangle, or, whatis thesame thing, that y+¥= ﬂ Only slightlyless familiaris the fact that 52+122=132 and 82+152=172. The problem we wish to considerhere is that ofﬁ nding allsuch triples ofpositive integers, called Pythagorean triples. In the ﬁ rstplace, itis clear that ifa,b, c isa Pythagorean triple,thenso is ka, kb, kc, for any integer k. Thus6, 8,10 and9,12,15 are such triples, although neitheris essentially different fromthe parent triple3, 4,5. InView ofthisfact, itis clear that our chore willbe essentially completed ifwe ﬁ ndallPythagorean tripleswhose elements are relatively prime.Such triplesare called primitivePythagorean triples. Suppose, now, that x,y, z isa primitivePythagorean tripleso thatx2 +y2 =22 and (x, y, z) =1. We ﬁ rstshow that this implies that(x, y) =(x,z) =(y,z) =1. For example, if(x, z) =d >1, then, by the Fundamental Theorem ofArithmetic,there exists a prime psuch that pld.Since d|xand dlz, itfollows that plx,plz,plzz, plxz,and p|z2— x2. But22— x2 =y2. Thus, ply2 and, by Corollary2.9, ply. This contradicts (x, y, z) =1, so itmustbe thecase that(x,z) =1. Similarly,one can show that (x,y)=(y,2)=1. From the preceding paragraph, itfollows that xand ycannot bothbe even. Itis also true that they cannot bothbe odd. This follows fromthefact,discussed in Section 1.7, thatthe square ofan odd integer mustbe ofthe form 4q+1 and the square ofan even integer mustbe ofthe form4q,so thatthesquare ofan integer cannotbe ofthe form 4g +2 or 44 +3. Thus, ifxand ywere bothodd, then x2 = 4r +1andy2 =4s +lforsome randsandz2 =x2 +y2 =4(r +s) +2. This says that22 is ofthe form 44 +2, and thisis impossible,as notedabove. Hence, it must be thecase thatone of xand yis even, the otherodd. For de ﬁ niteness, take xeven and yodd. Ofcourse,22 willthenbe ofthe form 4g +1, so 2 is also odd. Hence, z— yandz +yare botheven and x2=22-y2=(z-y)(z+y). Letz—y=2uandz+y=2v.Then z=v+uand y=v-u, and itcan be shown thatone ofu andv iseven, the otherodd, and that(u,v) =1. For if(u, v) =d >1, then dlu, dlv,so dlzandd| y, incontradiction tothe fact that (z, y) =1. Moreover, ifu andv are bothodd, then2 and yare even, and thisis alsoa contradiction. 50 Divisibility Properties ofIntegersChap. 2 Since xis even, x/2is an integer and x2_z---y.z+y=_ (2)2——2 u1). Let x/2 =Il€=1p;-\"‘ be the canonical representation ofx/2.Thenu- v =i=1p,?“i. It follows from Theorem 2.23 thatu =i=1 pf”,v ={=1pf\",b,- 2O, c,_>. 0, and that b,- +c, =2a,. Ifbi andc,- are both different fromzero forsome i, thenpi|u and pilv, in contradiction to the fact that(u,v) =1. Thus,one ofb,- andc,- is zero foreachi. It follows that bandciare even foreach i,sayb,- =2u,- andc,- =212,-. Thenu =s2, v =t2, where s =f=ip1 ﬁ and t =Hf=1p§-\"‘. Also(s, t) =1 andone ofs and tis even and the other odd, since the same statementsare true aboutu and1). Since x >O and x =2 M,itfollows that ifx,y, zisa primitivePythagorean triple, then there exist integerss andt, with(s, t) =1 and withone ofs and Ieven and the other odd, such that x=25t, y=t2-s2, z=t2+s2. Ofcourse, we mustalso choose t >s since y >0. Itis not dif ﬁ cult to prove thattheconverse ofthis resultis also true. Inthe ﬁ rst place, ifx, y, z are de ﬁ ned by the preceding formulas, x2 +y2 =(25t)2 +(t2— 32)2 =t4 +2t2s2 +s4 =(t2 +s2)2 =22. Also, if(s, t) =1 withone ofs and teven and the otherodd, then xis even and yand z are both odd. Suppose that(y,z) =d >1. Thenthereexistsa prime psuch thatpld. Therefore, ply, plz, sop divides z +y =2t2 and z— y =2s2. But17 mustbe oddsince plz and z is odd. Therefore, plt2 andplsz,so pltand pls by Corollary2.9. This contradicts(s, t) =1, so itmustbe thecase that(y,z) =1. Similarly, itcanbe shown that (x, y) =(x,z) =1. Therefore, x,y,2 de ﬁ nedas above forma primitivePy- thagorean triple and we have proved the followingtheorem. THEOREM 2.26. The positive integers x,y, and z with xeven forma primitive Pythagorean triple ifand only ifthere exist integerss andt, withs <t, with (s, t) =1 and withone ofs and1 even and the otherodd,such that x =23t, y = t2 — 32, and z =t2 +s2. Since A =xy/2and xis even, itis obvious thatthearea ofthe righttriangle associated witha Pythagorean tripleis always an integer. Itis interesting thatthe inradius ofthe associated righttrianglealsois always an integer. Thisis easilyseen by computing the area ofthe triangle shown in two differentways. Sec. 2.6 Pythagorean Triples 61 Suppose that x,y, zisa primitivePythagorean tripleso that x =ZSt, y =t2 -s2, and z =t2 +32. Then, ifris the inradius, = ﬂ =£§Q E A 2 2+2+2 and xy__ 23t(t2—sz) r=x+y+z_231+(t2—s2)+(t2+32) _2st(t— s)(t+s) _ 2t(s+t) =s(t-s), which is an integer. Ifx,y, zis nota primitivetriple,then x =k- 2st, y =k(t2 -s2), 2 = k(t2 +s2) forsome kand the argument stillholds. EXERCISES 2.6 1. Constructa table ofprimitivePythagorean triples forthe followingvalues of (s, t): (1, 2), (1, 4), (2, 3), (1, 6), (2, 5), (3, 4), (1,8), (2,7), and(4,5)- 2. The table ofExercise1 suggests thatone ofthe numbers inany primitivePy- thagorean tripleis divisible by4, one (notnecessarilya differentone)is divisible by 3, and one (again notnecessarily different)is divisible by5. Prove thatthisis so. Hint: By Theorem1.9, every integercanbe written inthe form3q, 3g +1, or 3g +2. Similarly, any integer is ofthe formSq, 5q+1, 5q+2, 5q+3, or 5g +4. 3. Give values ofx,y,2 such that(x, y,z) =1 and yet (x, y) >1, (x,z) >1, and (y, z) >1. 4. Ifx2 +y2 =22 and (x, y, z) =1, prove that(x, y) =(y,z) =l. 5. If(s, t) = land one ofs and tis even, the otherodd, prove that(x, y) = (x, z) =1, where x=2st, y=t2— 32, and z=1f2 +32. 62 Divisibility Properties ofIntegers Chap. 2 6. Let x, y,2 be a Pythagoren tripleand consider theescribed circleas shown inthe 10. ll. 12. diagram. Prove thatthe radiusrx is an integer. Hint: Calculate thearea ofthe triangle intwo differentways. . Prove that the radiiry and r, ofthe other twoescribed circles forthe triangle of Exercise6 also have integralvalues. . Show that(3, 4, 5) is the only primitivePythagorean tripleconsisting ofconsecu- tive integers. . Show thatthe onlyPythagorean triples inarithmeticprogressionare ofthe form (3k, 4k, 5k) for k 21. Show that any positive odd integercan be theside ofa primitivePythagorean triangle whose otherside and hypotenuseare consecutiveintegers. Prove that ifthe sum oftwoconsecutive integersisa square, then the smaller of the two integers isa side and the larger ofthe twointegersis the hypotenuse ofa primitive Pythagorean triangle. Computer Exercise Writea computer program to ﬁ nd allPythagorean triples (x,y,2) such that |x— y| =1. Note that this implies thatx =y ilandhence thatthe triplefound is primitive. Thus, x =2st, y =t2— sz, and z =12 +s2 forsuitableintegerss and t with t >s, as notedabove. Printa table ofvalues oft,s, x,y, and z ordered by increasing values of2. Carefullyconsider thistable and makea conjecture concerning the values oftands thatgenerate the triples found. 2.7 THE GREATEST INTEGER FUNCTION The greatest integer functionis frequently quiteuseful intreating number-theoretic problems. In this section we de ﬁ ne the function,develop its principalproperties, and exhibitsome interesting and surprising applications. Thereader should note thatwe continue touse small Latinletters torepresentintegers. Sec. 2.7 The Greatest Integer Function 63 DEFINITION2.4. Ifoz isa real number, then[(1] denotes the greatest in- teger not exceeding(1. Alternatively, [a]is the integer satisfying the inequality [a]Sa<[a]+1. THEOREM 2.27. Inthe following,01, ﬂ ,and0 denote real numbers. (i) a—1<[a]sa (ii) Ifa S a, thena S[0:]. (iii) Ifa >a, thena 2[a] +1 >[(1]. (iv) Ifoz SB, then [a]S[/1]. (V) If6=a-[a],thenOS0<1. (vi) Ifa=n+0with0S0<1,thenn=[a]. (vii) For any integern,[01 +n] =[a] +n. (viii) Ifa =bq + rwith0 S r <b, then4 =[a/b]. Proof. (i) The inequality(1 -1 <[a]S ais simplya restatement ofthe de ﬁ n- ing inequality for [a]. (ii) Ifa +1 >a, then a S a <a +1 and a=[a]by De ﬁ nition2.4. If a+1}a,thena+lSaandaSa—l<[a],bypart(i). (iii) By de ﬁ nition, [a]S a.Since a >a, itfollows thata >[a].Thus,a 2 [a] +1 since a and [a]are bothintegers. (iv) By de ﬁ nition, [a] S0:. Therefore,since aS ﬂ , itfollows that [a]S ﬂ . But [a]is an integer andso, by part (ii), [a] S[ ﬂ ]. (v) The inequalityO S a— [a] <1 follows immediately frompart(i). Thus, 0S6<1,since0=oz—[a]. (vi) Since 0 S0 <1 and a =n +6, itfollows thatn S a <n +1. Butthen n = [a] by De ﬁ nition2.4. (vii) By part (v), a =[a] +0with0S0 <1. Therefore,or +n =[a] +n +0 and [a +n] =[a] +n by part (vi). (viii) Since a =bq + rwith0 S r <b, itfollows that a r 5‘+3 with 0 S r/b <1. Therefore, by part (vi),q =[a/b]. THEOREM 2.28. Forany real number aand any integern >0, [[1,3] =[—3]. Proof By de ﬁ nition 64 Divisibility Properties ofIntegers Chap. 2 n-[2]Sa<n-[g]+n, n n and itfollows from properties (i)and (iii) ofTheorem2.27 that n-[g]s[a]<n- g]+n. n _ n [2]S_[ ﬂ ]<[ ﬂ -+1 n n In’ [3-] = [Li by De ﬁ nition2.4, since [oz/n] is an integer. Therefore, But this implies that SO DEFINITION2.5. Let pbe any primeandn any positiveinteger. IfpfIn and pf+l4’ n, we say that pfexactly divides n and write pflln. An alternative way ofexpressing De ﬁ nition2.4is tosay that pfnn ifand only if pfappears inthe canonical representation ofn. Thatis, ifn =Ill-1p?”is the canoni- cal representation ofn, thanp\"-‘||n foreach1’. Againone cansay that pfII n ifand only if pfis the highest power ofp dividingn. Ofcourse, ifpX n, then f=0 andwe could still write p°||n. As we willsee immediately, this notationaldeviceis concise and useful. THEOREM 2.29. Ifn isa positive integer and pisa prime,then12‘\" n!, where e=[%]+[§]+~~+[,%] and ris determined byn bythe inequality p'Sn < p’“. Proof Fora given integer k, the multiples ofp\"thatdo notexceed n are pk, 2 p\",. . . , qp\", where q is the largest integersuch thatqp\" Sn. Butthissays thatq is the largest integer notexceeding n/p\",so thatq =[rt/pk]. Thus, [n/pk]gives the number ofpositive multiples of1)\" thatdo notexceedn. Now, if1 Sm Sn, then m = qp\" with(q, p) = l,0 S kSr, and m contributesprecisely ktothe totalexpo- nente with which pappears inthe canonical representation ofn! Moreover,mis counted precisely ktimes by the sum n + [17][%]+[%]+~ once as a multiple ofp,onceas a multiple of112,. .. , onceas a multiple ofp\",and no more. Ofcourse, ifk =0, then mis notcounted inthesum. Therefore, the sum Sec. 2.7 The Greatest Integer Function 65 above accounts exactly forthe contribution ofeach mbetween1 andn tothe exponente, as claimed. As an example ofTheorem 2.29, consider thecase forn =28, p =3. For 0 S k S3, let Skdenote theset ofintegers mwithlSm S28 oftheformm =q- 3\", (q, 3) =1. Thus, S0 ={1, 2, 4, 5,7,8, 10, ll,13, 14, 16, l7,19, 20, 22, 23,25, 26, 28}, S ={3, 6,12,15,21, 24} S: ={9, 18}, 53 ={27}, and this accounts forallthe integersn, l.<_ n s28,each appearing preciselyonce. Clearly, each element ofS0 contributes nothing tothe exponente withwhich3 appears inthe canonical representation of28! Each element ofS1 contributes ltoe, each element ofS2 contributes2, andeach element ofS3 contributes3. Thus, inthis case e=6+4+3=13. Moreover, [28/3] =9, the number ofelements inS1, S2, andS3; [28/9] =3, the number ofelements inS2 andS3; [28/27] =1, the number ofelements inS3; and 9 +3 +1 =13 =e. Now, by Theorem 2.28, [gsHﬂéﬂl Bart—”:11 Also, by property (viii) ofTheorem 2.27, [n/p]is the quotientobtained whenn is divided by p,[MI/1p 1] Thus, the work ofdetermining the exponent ofp inthe canonicalrepresentation ofn! can be convenientlyarrangedas a sequence ofdivisions byp, the sum ofthesucces- sive quotients yielding the desired exponent. Forexample, for p =3 andn =28, one would have is the quotientobtained when [n/p]is dividedby p, andso on. 3|2_8 312 3E 311 0, 66 Divisibility Properties ofIntegers Chap. 2 where 28 is divided by3, and theneach successive quotient(ignoringremainders)is divided by3 untila quotient of0 is obtained. Thus, [28/3] =9, [28/32] =3, [28/33] =1, and the desired exponentis13,as before. The preceding computation ofthe exponent of3 inthe canonicalrepresenta- tion of28! bearsa marked resemblance tothe calculation ofthe digits inthe posi- tional representation of28 tobase3. Thatthisresemblanceis more thansuper ﬁ cialis shown by the followingtheorem. THEOREM 2.30. Ifpis prime, if n=ao+a1p+a2p2+- - - +a,p’ with a,95 0 and 0 5ca <p foreach i, and ifpellnl, then e=n—(ao+a1+'° ' +a,) p -1 ' Proof. Since n=a0+alp+- - - +a,p’ with a,aé 0 and0 sai <p foreach i, itis clear that [g]=al+a2p+- -- +a,p\"‘, [£5]=a2+a3p+- ‘- +arp\"2, 11— F n ar—l+pl:?J =p,_l:|a Sec. 2.7 The Greatest Integer Function 67 Ifwe now add these equations and makeuse ofthe fact that ema-1HI7 l7 P (a0+a,+- - - +a,)+pe=n+e, from which the desired result immediatelyfollows. we obtain Note that 28“, =10013. Therefore, using the formula ofTheorem2.30,we again obtain 28-(1+0+0+1)9=T= as the exponent of3 such that3e||28l In computerscience, itis typical todenote[oz] bythe symbol[oz] and todenote the least integer notless thanoz by[oz]. The notationused here is standard in mathematics and the reader should understand both. Note, bythe way, that [a] = -[— oz], as the reader is asked toshow inExercise3 below. Thus, theleast integer notation,[oz], is actually notnecessary. However, itis regularlyused incomputer science and shouldbe familiar to allstudents ofbothmathematics and computer sc1ence. 13 EXERCISES 2.7 1. Evaluate the following. (a) [2.7] (b)l— 3.5] (e)[— ‘5](d)[145] (e)— [— 2.7] (f)— [35] (g)— [‘5](h)—[—145] (i) [2.7 +0.5] (j)[— 3.5 +0.5] (k)[—x/E +0.5] (l)[141 + ﬂ 2. (a) Under what conditionsis [a] +[oz] =[2a]? (b) Under what conditionsis[oz] +[— a]#= 0? 3. Prove that— [—oz] is theleast integer notless thanoz, thatis, that— [—oz] =[a]. 4. Prove that no integeris neareroz than [a +%1- Iftwointegersare equallynear, show that[oz + ais the larger ofthe twointegers. 5. Prove that no integeris neareroz than— [—a +a. Iftwointegersare equally near a, show that— [—a +é] is the smaller ofthe twointegers. 6. Prove that[oz] +[a + a =[2a] forevery real numberoz. Hint:oz =[n] +0 with0 s0 <1. Consider twocases: 0 S0 <% and %s 6 <1. 7. Prove that[oz] + [a + ﬂ+[a +%] =[3a] forevery real number a. 68 13. 14. 15. 16. 17. 18. 19. Divisibility Properties ofIntegers Chap. 2 . Prove that [a]+[a+%]+[a+%]+-~+[a+—k;1]=[ka] for every real number aand any integer k 21. Hint:or = [a] +0 with0 S6 <1 and thereexists rwith0 S r <ksuch that r/k s0 < (r +1)/k. . Find the exponente such that3\"||91! 10. 11. 12. Show that3 does not divide the binomialcoe ﬂ icient (11)). Find the highest power of10 thatdivides 91! Ifoz and B are real numbers, prove that [a] + [ ﬂ ] 5[0‘ +13]- Hint:Use property (ii) ofTheorem2.27. Use the result ofExercise12 to prove that (a+b)! a!b! is an integer forany positiveintegers a andb. Prove that the product ofany kconsecutive positiveintegersis divisible by kl. Let a and b be positive integers andsuppose thata =25.0akp‘,b =25.0bip', and a +b =2.5.0 cip‘, respectively,are the representations ofa, b, anda +b to the base p. pfl|(a:1- b),show thatf=iii-ow,- +b,- — c,~)/(p— 1). Let a, b, a +b, pand fbeas inExercise15. Show that fis thesum ofthe carries one makes when adding a tob inbase p. Hint: Letdo, d1,. . . , d,be the carries inthe aforementioned additionand note that a0+bo=co+dop, d0+a1+bl=cl+d,p,. . . , d,_1+a,+b, = c, +(1,1). Note that d, =0. Suppose thatwe numberthe rows ofPascal’s triangle starting withzeroso that the zeroth row consists ofa single1 , the ﬁ rst rowconsists oftwoones, thesecond row is the triple,1, 2, l in thatorder, andso on. Show thatthe number ofodd entries inthe nth row ofPascal’s triangleis 2’,where sisthe number of1 ’s inthe positional representation ofn tobase 2. Itis only natural to extend Exercise17 andask how manyentries inthe nth row ofPascal’s triangleare not divisible bya given prime1). Ifn =ELoaip‘is the positional representation ofn tobase p,show thatthe number inquestionis H5=o(a,- +1). Ifp is a prime and p“||n,prove that pX (1:!). Sec. 20. *21. *22. *23. *24. *25. *26. 27. 28. 29. 30. 2.7 The Greatest Integer Function 69 Let S ={sl, 32,. . . , sm) be a set ofm nonnegativeintegers, and foreach i21, let f(i)denote the number ofSi inS forwhich Si:1‘. Then Ej'ilsj = 2111f“)- (a) Illustrate the result fortheset S=(3,1, 5, 2}. (b) Prove the equality claimed. Use the result ofExercise 20 togive an alternative proof ofTheorem2.27. Hint: Foreach j,with1 s jsn, letsjbe thelargest integersuch thatp521 j.Then 9 = 2f’.1sj =2?—1f(i) and itis onlynecessary toargue that f(i) =[n/p‘] for each i. Ifn 2O, a =(1 +J3)/2, and F\"is the nth Fibonacci number,prove that a\"1F, = [_+ _], J3 2 thatis, that F\"is the integernearest toa\"/x/§. Hint: Note that|(1— J3)/2| <1 anduse Binet’s formuladeveloped inExercise 13 ofSection1.4. For n 22, prove that L, =[a\" + j]where L\"is the nthLucas number. Hint:See Exercise14 ofSection1.4. For n 22, prove that Fn ﬂ =[aFn +)5]. For n.>_ 4, prove that Ln“=[aLn +1l]. For n 2O, prove that \"1 n—i Fn+l=[§(i ) i-O Hint: Consider the twocases n =2m +1 and n =2m +2 and prove them simultaneously by induction onm. Computer Exercises Writea computer program togenerate and printPascal’s triangle. Writea computer program todetermine and printthe product ofthesix entries surrounding any given entry inPascal’s triangle. Makea conjecturebased on the printout ofyourprogram. Try to generalize yourconjecture inExercise28. Writea program totest special cases ofyour more general conjecture. Let a1, a2, a3, a4, a5,61.; be the six entries inorder aroundany given entry in Pascal’s triangle. Writea program tocalculate and print((11 , a3, a5) and(a2, a4, as) for any givena. Makea conjecturebased on the printout ofthisprogram. 3 Prime Numbers The study ofprime numbers naturallybegins withthe problem ofdetermining whethera given integern is prime orcomposite. Innocentas itmayseem, this problem has no simple general solution,andwe shallhave tobe content withpartial answers. In view ofthe Fundamental Theorem ofArithmetic, itis clear that inany given case, the determination couldbe made bysuccessively dividingthe integer in question byeach ofthe primes thatprecede it,provided thatthese primesare known. In fact, since itis evident thateach composite positive integer musthavea nontrivial factor notexceeding its ownsquare root,the answer couldbe found foranyn by successively dividing byeach ofthe primes notexceedingx/r—t. Thisgreatlyreduces the amount ofwork that mustbe done, buttheprocess is still notfeasible for extremely large values ofn since the primesare not known muchbeyond107. 3.1 THE SIEVE OF ERATOSTHENES A simple and ingenious approach tothe problem whichenables one to ﬁ ndallthe primes up to any prescribed limitis theone called theSieve ofErathosthenes, afterthe Greek mathematicianEratosthenes (276— 194 B.C.). This methodconsists ofwriting down allthe integers from2 up to the given limitn and thensieving out,as itwere, the composite numbers. We note ﬁ rst that2 is the smallest primeand thatthe multiples of2, 2-2,2-3,2-4,.. . ,2k,. . . , occur in the list ofintegers at intervals oftwo following2. Thus, ifwe strike fromthe list every second number after2, we “sieve out”all multiples of2 notexceedingn, and 70 Sec. 3.1 The Sieve ofEratosthenes 71 we retain only multiples oflarger primes. Now3, the nextlargest integer notstruck out, is clearlya primesince itis nota multiple ofthe only primesmaller thanitself. Again, the multiples of3 occur inthe list ofintegers at intervals ofthree following3,so we now strike outeach ofthese numbers notyetdeletedas multiples of2. The next number not already deleted mustalso bea prime,since itis nota multiple of2 or3, the only primes thatprecede it. Thus,5 isa primeandevery ﬁ fthnumberafter5 must be deletedas a multiple of5. Since every composite numbermusthavea primefactor not exceeding its own square root,every composite number inour listmusthavea prime factor notexceedingx/ ﬁ. Thus, by the timewe have deleted all multiples ofall primes notexceedingx/ ﬁ, we shallhave sieved out allcomposite numbersandthose that remain willbe all ofthe primes notexceedingn. The table that followsshows the completedsieve forn =200. Note thatsince 172 =289, the process is completed bythe timeall multiples of13 have been struck from the list. The prime numbershave been circled tomake themstand out inthe table. THE SIEVE 0F ERATOSTHENESFOR n=2006%55Weegeeaeexeee\\100@%%@@%@®%%%zaamam¥%%%§¥¥¥%§aazaa¢as¢@ﬁgigaigiggzaasxaaxz¢gi¥%§¥%§%§s%¢eaess¢¢©§6§55%;?i’Qgéaaaz$9696ggiggﬁgggiisgaggsggz%%%§%%%§%§sassaessx@§iiiiiiii%xxizxrrs¢t@351g®§®§36¢$3®¢G®¢®@275 72 Prime Numbers Chap. 3 Variations on thesieve method stillprovidethe mosteffectivemeans forcom- puting factortables and tables ofprimenumbers. Probablythebest such tables (and certainly the best accessible) are those by D. N. Lehmer[Carnegie Institution of Washington, DC,Publications No.105 (1909) and No.165 (1914); New York: Hafner Publishing Company,1956], whichextend tosomewhat beyond10 million. Unpublished tables byJ. P. Kulik(1773— 1863) inpossession ofthe Academy of Sciences ofVienna extend up to100 million,butthereis some doubtas to their accuracy. Foreasy reference inconnection withmaterial inthistext,a table ofprimesless than 10,000 is given onpages 235—238 anda table ofcomplete factorizations of positive integersless than1000 is given onpages 239—243. 3.2 THE INFINITUDEOF PRIMES Careful study ofthe tables ofprimessuggests many interestingconjectures,some of which have been proved,whereas others stillresist attack. Forexample, inthe ﬁ rst ﬁ ve groups of1000 positive integers thereare, respectively, 168, 135, 127, 120, and119 primes. However, ifwe skip over tothe last ﬁ ve groups of1000 integers preceding 10,000,000, we ﬁ nd thatthey contain 62, 58, 67, 64, and53 primes, respectively. Thissuggests thatthe primes occurless andless frequently among the larger integers, and italsosuggests thatthereis noend tothesequence of primes. Itis, infact, relativelyeasy toprove thatthereare in ﬁ nitelymanyprimes. Many such proofs exist, and the ﬁ rst proofis due to Euclid(?330— 265B.C.). Itis also possible to prove thatthe primes occurless andless frequentlyamong the larger integers, butthe proofsare much more dif ﬁ cult.The ﬁ rstresults along this linewere obtained by the Russian mathematicianP. L.Tchebychef in1850. We consider Tchebychef’s work inSection3.3. The proof ofthe followingtheoremisa variant of that ofEuclid. THEOREM 3.1. Thereare in ﬁ nitelymanyprimes. Proof We ﬁ rstnote thatsome primes doexist,so thatthe followingargumentis not vacuous. Suppose thatthere are onlya ﬁ nite number ofprimes,say111 , p2,. . . , p,,and consider the integern =plp2- - - p, +1. Clearly,n >p,- for i =1, 2,. . . , r,so n mustbe composite. By the Fundamental Theorem ofArithmetic,it musthave prime divisors. Thus, piln forsome i. Butthen11,1 1, and thisis impossible. Therefore, there mustbe in ﬁ nitely many primes. Sec. 3.2 The ln ﬁ nitude ofPrimes 73 A glance at the table onpage71 shows thatexcept for2 and5, allthe primes occur in the ﬁ rst, third,seventh, and ninthcolumns ofthe table and thatthereare nearly the same number ofprimes ineach column.Largertables show thatthis trend continues,so thatone mightreasonablyguess that ifthe table onpage71 were extended ad in ﬁ nitum,there wouldbe in ﬁ nitelymany primes ineach ofthese columns. More neatly put,one mightguess thatthereare in ﬁ nitelymany primes of the form 10k +1, in ﬁ nitelymany ofthe form10k +3, in ﬁ nitelymany ofthe form 10k +7, and in ﬁ nitely many ofthe form10k +9. Similarly, ifthe primesare arranged according to divisibilityby4, allexcept the prime2 are ofthe form 4k + lor 4k +3 and thereseem tobe about equally many ofeach type. Thus,one might reasonably guess thatthere are in ﬁ nitelymany primes ofthe form 4k +1 and in ﬁ nitely many ofthe form 4k +3. The factis that alltheseguesses are correct; the results mentionedare allspecialcases ofa most remarkable theorem proved byG. L. Dirichlet in1837. The proof, whichdepends on the analyticmethods ofcomplex function theory,is much too di ﬂ icult forinclusionhere,so we mustbe content with just the statement ofthe theorem. THEOREM 3.2. (Dirichlet’sTheorem). If(a, d) = lwitha >0 andd >0, then there are in ﬁ nitelymany primes ofthe forma +kd. Itis clear that the conditions ofDirichlet’stheoremare necessary since if (a, d) = r >1, then r|(a +kd) foreverykanda +kdisneveraprime fork 21. The dif ﬁ cultyarises inshowing thatthe conditionsare suf ﬁ cient. However, certain specialcases ofDirichlet’s theorem canbe handled byarguments similarto that of Theorem 3.1. The following theorem provides an example. Note that, by the division algorithm, allodd primes mustbe ofthe form 4k +1 or4k +3. But4k +3 =4(k +1)—1 is ofthe form 4k -1. Thus, itis also true that all odd primes mustbe ofthe form 4k 1l. THEOREM 3.3. Thereare in ﬁ nitelymanyprimes ofthe form 4k—1. Proof. Since3, 7, and11 are ofthis form,the followingargumentis notvac- uous. Suppose thatthereare only ﬁ nitelymanyprimes ofthis form,say p1, p2, . , p,, and consider the number m=4p1p2-'-pr-1. Since m is ofthe form 4k—1 and m >pi foreach i, itfollows thatmis composite and must have prime factors ofthe form 4k +1 or 4k— 1. Since the product ofany two numbers ofthe form 4k +1 is again ofthat form, itfollows thatmhas atleast one prime divisor ofthe form 4k— 1. Thus, pilm forsome1'. Butthen pil l,and thisis impossible. Therefore, there mustbe in ﬁ nitelymanyprimes ofthe form 4k—1. Another conjecturesuggested bythetables ofprimesis thatthereare in ﬁ nitely many so-called twin primes, thatis, pairs1) and p +2 whichare both primes. The 74 Prime Numbers Chap. 3 table on page 71 contains15 such pairs, and moreextensive tables show thatthese pairs continue to appear. Thereare, infact,36 pairs oftwinprimesbetween 1012 — 104 and1012 +10“, and l,000,000,009,649 and1,000,000,009,651are the largest in thisrange. However, unlikethe proofthatthereare in ﬁ nitelymanyprimes, no proof thatthereare in ﬁ nitelymany twinprimeshas been found. Anumber of criteria for theirexistence have been established, buta proofthat twinprimesare in ﬁ nite in numberhas resisted the efforts ofthebest mathematicians overtheyears. The most signi ﬁ cant, though inconclusive, resultwas obtained in1921 by Viggo Brun, usinga variation on the method oftheSieve ofEratosthenes. Again,we must be content tostate the theorem withoutproof. THEOREM 3.4. (Brun’s Theorem). Ifq runs throughthesequence oftwin primes, then 2(1 /q) converges. Ifthe precedingseries were divergent, there wouldnecessarilybe in ﬁ nitely many twin primes. As itis, one can only inferthatthe twinprimesare relatively scarce and, possibly, only ﬁ nite innumber. This, bythe way,canbe contrasted with the corresponding theorem for allprimes. THEOREM 3.5. If1) runs through all primevalues, then2(1/17) diverges. Proof Let xand jbe any two positiveintegers, let p,~ denote the ithprime,and let N(x, j)denote the number ofpositiveintegersn S xsuch thatp,- Xn forany i > j. Ifn is such an integer,we may writen =rsz, where rands are positiveintegers and where ris square-free, thatis, ris notdivisible bythesquare ofany prime.We may now estimate N(x, j)by considering the number ofways ofchoosing rands soas to construct n’s ofthe desired type. Inthe ﬁ rstplace,s Sx/Z Sx/J—c, so thatthereare at most‘/)_C possible choices fors. Also,since ris square-free, j r = Hp?‘ i-l witha,- =0 or1 foreach1'. Since thereare twochoices foreach01,-, itfollows thatthere are precisely 2\"possible choices forr. Thus,we ﬁ nallyhave thatthere exist at most 21'- J)? positive integers n satisfying the given conditions. Thus, N(x,j)S21'- J} (3.1) for any two positive integers xand j. Now,suppose that 2:201 /piconverges. Then, bythegeneral theory ofin ﬁ nite series, there must exist some jsuch that E i< l. (3.2) i=j+lp,- 2 For this particularvalue of j,we reestimate N(x, j)by estimating the number of integers n S xthatare divisible bysome1),- with i > jand thatare, therefore, not Sec. 3.2 The Infinitude ofPrimes 75 counted by N(x, j).Forsuch an i, the integers pi,2p,~,. . . , kphwhere kis the largest integer such that kpiS x,are thevalues ofn S xthatare divisibleby11,-. Thus, for each i > j,there are at most x/pisuch values ofn. Itfollows thatthe number of values ofn S xnotcounted by N(x, j)is at most22°=j+1 x/pi.Thus, using(3.2),we obtain an x—N(x,j)s 2 i<§(3.3) i=j+1 i and itfollows that §<N(x, j). (3.4) Combining this result with(3.1), we obtain §<213 J}or x<22j+2 for every positive integer x. Butthisis clearlyfalse, since theset ofpositiveintegers is unbounded. Therefore, the assumption that223:1 1/p,- converges is false and the proofis complete. Although itis obvious fromTheorems3.4 and3.5 thattheset oftwinprimesis muchless numerous thantheset ofallprimes, the inductiveevidence thatthereare in ﬁ nitely many twinprimesis quitestrong. Onthe otherhand, itiseasy toshow that there are arbitrarily longstretches ofconsecutive composite numbers;so the distri- bution ofthe primes among the integers mustbe extremely irregular. Tosee thatthis last assertion is true, consider thesequence n! +2, n! +3,. . . , n! +n forn 22. The ﬁ rst ofthese numbersis clearly divisibleby2, thesecond by3, the thirdby4, and so on. Thus, we have n—1 consecutive compositeintegers foranyn 22. In view ofthis great irregularity inthe occurrence ofprimes, itis notsurprising that no general formulahas been found forﬁ ndingthe nthprime. Ithas noteven been possible to ﬁ nd simple functions thatassume only primevalues forintegral arguments, and the only simple functions thatare known toassume in ﬁ nitelymany prime values are the linear functions f(n) =a +ml ofDirichlet’stheorem. Whilethe function f(n)=n2—81n+1681 =(n—40)2—(n—40)+41 yields primevalues foralln =1, 2,. . . , 80, itis notpresently knownwhethereven such a simple quadratic functionas h(n) =n2 +1 assumes in ﬁ nitelymany prime values for integralvalues ofn. Thatno polynomialcan assume only primevaluesis shown in the followingtheorem. THEOREM 3.6. Iff(n) =aknk+ak_1n\"“l +- - - +aln +a0 isa non- constant polynomial withintegral coe ﬂ icients, then f(n)mustbe composite for in ﬁ nitely many values ofthe integern. 76 Prime Numbers Chap. 3 Proof Itis no restriction toassume that ak>0so that limnemfm) =00. Hence, foran integer m su ﬂ icientlylarge, the integer f(m) >1. Let y = f(m). Then, for any r, f(m+ry)=ak(m+ry)\"+- - - +a,(m+ry)+ao =f(m) +y- g(r) =y+y-g(r) =y{1 +g(r)}, where g(r)is a polynomial in rwithintegral coe ﬂ icientswhose leading termis akyk‘lr\".Therefore, lim,_,,. g(r) =00, and there mustexistan integerr0 such that g(r) >1 for all r 2r0. Thus, f(m +ry)is composite forallintegers r 2re and the theorem is proved. EXERCISES 3.2 1. Ifp is a prime different from2 or3, show that itmustbe ofthe form 6k +1 or 6k +5. Note that 6k +5 =6(k +1)—1 is oftheform 6k— 1. Thus, itis also true that all primes but2 or3 are ofthe form 6k i1. 2. Prove thatthere are in ﬁ nitelymany primes ofthe form 6k—— 1. 3. Try to prove thatthereare in ﬁ ntelymany primes ofthe form 4k +1 by imitating the proof ofTheorem3.3. Whydoes the proofbreak down? 4. How many twinprimes lie intherange 9000 Sn <10,000? 5. pand p +2 are twinprimes and p >3, prove that 6|(p +l). 6. Ifp 2q 25 and pandq are bothprimes, show that24|(p2— qz). Hint:Use Theorem 2.12. LetN=p1p2- - - p,+p,+lp,+2- - - p,+,withr2lands 2landwherethe p,- are distinct primes. Show thatp,- lNfor1 si sr +s andhence deduce again that there exist in ﬁ nitelymanyprimes. 8. Show thatwe cannothavea prime triplet ofthe formp, p +2, p +4 for p >3. Hint:See Exercise6 ofSection1.7. 9. What would you conjecture about primepairs ofthe formp, p +4? p, p +6? p, p +8? Check the table ofprimes at the back ofthe book.>' Computer Exercise 10. Writea computer program implementingtheSieve ofEratosthenes for1 s n S 500. Sec. *3.3 The Prime Number Theorem 77 *3.3 THE PRIME NUMBER THEOREM As we have seen, the distribution ofthe primesconsidered individuallyappears tobe most erratic. Over all, however, their distributionturns out tobe amazinglyregular. One measure ofthe distribution ofthe primesis the function7z(x) thatdenotes the number ofprimes notexceeding)6. Forexample,75(1) =0,7r(2) =1, 7r(4) =2, and 7t(p,,) =n, where1),, denotes the nthprime. Anexplicit formula for7t(n) forevery72 wouldbe equivalent toa formula for p\"and,as mentionedearlier, nosuch formulais known. However,7t(x) was studied inmuch detailas earlyas the latter part ofthe eighteenth century byLegendre andalso byGauss, then still inhisteens, witha View toward ﬁ ndinga relatively simple functionwhose value approximated that of7z(x). In particular, both men soughta function f(x)such that, forlarge values ofx,the difference between7r(x) and f(x)was small inrelation to7t(x). Infact, they hoped to ﬁ nd f(x) such that m2200 —f(x) =lim {1 _ f(x)}=0, x—m 7t(x) x—m 7t(x) or what amounts to thesame thing,such that . 7t(x) 11m —= H» f(x) Legendre conjectured that forthe natural logarithm, In x =logex, 4 In x— 1.08366 was such an approximating function,andGaussguessed that both x/In xand . _x du Lz(x)—2 1n u were good approximating functions, with Li(x)givingthe betterresults. Although neither hada proofthathis functionwasa good approximation to7t(x) inthesense described above, itis interesting tosee what actuallyhappens forvariousvalues ofx. In the accompanying table, the values inthe last three columnsare given tothe nearest integer. x X. x ”(x) TIT} lnx—1.08366 1\"“) 1,000 168 145 172 178 10,000 1,229 1,086 1,231 1,246 100,000 9,592 8,686 9,588 9,630 1,000,000 78,498 72,382 78,543 78,628 10,000,000 664,579 620,419 665,138 664,918 78 Prime Numbers Chap. 3 This line ofresearch ﬁ nally culminated inthe following twovery remarkable theorems, which we must offerhere withoutproof. THEOREM 3.7. (Tchebychef’s Inequality).There exist positiveconstants c, andcz such that, forall x 22, £11 62x <—. In x < ”(x)In x THEOREM 3.8. (The Prime NumberTheorem) 7r(x) =1 x—>°° x/ln x It follows from Tchebychef’s inequality thatthere exist positiveconstantsc3 and64 such that c3nlnn<pn<c4nlnn for all n 22, where p\"denotes the nthprime. This, inturn,yieldsan alternative proof ofTheorem3.5 since 1 1 17,, c4nlnn and 22;; l/n1n n diverges. Also, itfollows from the prime numbertheorem (Theorem3.8) that P»lim = l, n->°° n1n n and conversely,so that this statementis equivalent to that ofthe prime number theorem. Itmaybe ofinterest tosee how the implicationgoes inatleast one direction. Suppose we assume that ﬂ=1 x->°° x/ln x' Setting x = p\",we have 7t(p,,) =n and itfollows that . n In \"_’°° pn 1. (3.5) Since the logarithmis a continuous function,the logarithm ofthe limit ofa function is the limit ofthe logarithm ofthe function,provided thatthe limitofthe functionis positive. Thus, taking the logarithm ofthe preceding limit,we have that 1im{1nn+lnlnp,,—~lnp,,}=0 n—boo Sec. *3.3 The Prime Number Theorem 79 and, hence, that l1 1 For this is tobe true, the limit ofthe quantity inbraces mustbe zero, andsince lim ln ln p\" = n—>°° 1n1),, 5 it follows that Inn =1. lim n—>w 1n1),, Using this result in(3.5),we ﬁ nally obtain 1=1im_nlnp,, ”\"m pn =1im nlnn. lnpn n-m pn lnn =lim nlnn’ ”_”° pn as claimed. The reader willﬁ nd itinteresting toprove the implication inthe other direction. Itis also ofinterest to note thatthe prime numbertheoremis equivalent tothe assertion that 1m 7r(x)___ ’ n—>°° Lz(x) where Li(3:) = I3‘ dt/In tis the approximating function ofGauss. Tosee this, itis only necessary toshow that Li(x) =1 x->°° x/ln x For ifthis is so, we have =. 7t(x) l11:13: x/ln x 75(x)_ Li(x) _x330 Li(x) x/ln x = ”(X) 231 Li(x)' 80 Prime Numbers Chap. 3 Integrating byparts, we obtain x dt x2 x dt — =——— —+ —.3.6Llntlnx ln2 Llnzt() Since 1/ln2 tis positive and decreasing for t >1, itfollows that for x 24, t‘E‘dt t “LE—f2 mJ’Lm JE—z x—Jx\\b—c 4x < ln22 lln2x<ln22+ln2x' From this itfollows that x (dt/ln2 t) 0 < L <In x +4, x/ln x J}- 1n22 In x so that r(alt/1n2 t) 2 i ﬂ w ﬂ -(3”) Finally,since limx_,., x/In x =GO, ifwe divide bothsides of(3.6) by x/In xand make use of(3.7), we obtain 11m L (dt/lnt)=l‘Li(x) =1 rm x/lnxx—m x/lnx 9 as claimed. EXERCISES 3.3 *1. Deduce from the prime number theorem that ”(X) _ x—m x/(ln x— c) for any constantc. *2. Assume that nmn=L lim ”9‘” pn where p\"denotes the nth prime anddeduce the prime numbertheorem. Sec. 3.4 Mersenne, Fermat, and Perfect Numbers 81 Him: For x 22, determinen by p\"S x < aso that n =7t(pn) S ”(10575(Pn+1) =n +1 andx—Noasn—MO. Computer Exercises 3. Using the program ofExercise10 ofSection3.2as a subroutine, writea computer program tosee which ofthe primesless than500 can be representedas the sum of two squares ofpositiveintegers. Endeavor tomakea generalguess based onthe output ofyour program. 4. Writea computer program toascertain which ofthe primesless than500 can serve as the length ofthe hypotenuse ofa primitivePythagorean triangle. En- deavor to makea generalguess based on the output ofyourprogram. 3.4 MERSENNE, FERMAT, ANDPERFECT NUMBERS Various methods have been developed fordeterminingwhether certainspecial types ofnumbersare prime orcomposite, and thelargest primes knownhave been discov- ered in this way. The current championis221\"091 -1, an enormous giant with 65,050 digits inits decimalexpansion. Determination that2216991 —1 isa primeis only the latest ina long and interestingseries ofevents thatstarted in1644 whena French monk, Father MarinMersenne, found thatthe ﬁ rstfew primes pforwhich MI, =21’ —1 is primeare p =2,3, 5, 7,13, 17, and19. Beyond this,he conjectured that MI, wouldbe prime for p =31, 67,127, and257 and thatno othersuch primes would occur for p inthisrange. Mersennewas later found tobe mistaken inthe ﬁ ve cases p =61, 67, 89, 107, and257; thatis, M51, M39 , andM107 are primeandM67 and M257 are not. Nevertheless, inhis honor, numbers ofthe form 2\"—1 are called Mersenne numbers and primes ofthis formare called Mersenne primes. We show below that ifa\"— lis a prime, then itmust, infact,be a Mersenne prime. M127 was shown tobe prime in1876 bya Frenchman, EdouardLucas, who developeda neat and e ﬂ icient method ofattack. In1930, D. H.Lehmer improved Lucas’s algorithm and began touse computers totest MI, forfurthervalues ofp. By 1963, the list ofknownMersenne primeshad grown to23, withthe additionscorre- sponding to the primes p =521, 607, 1279, 2203, 2281, 3217, 4253, 4423, 9689, 9941, and 11,213. When2“,213— lwas shown tobe primeat the University of Illinois, the resultwas subtly announced tothe worldbyusing themetered stamp cancellation shown on all university mail fora period ofseveral months. The next E-..__,--n_~ “emu—I1- E211213_1 lS PRIME u...- 82 Prime Numbers Chap. 3 numbers added to the listwereM11737 in1971 ; M21.701 in1978 aftera three-year effort by two teenagers, Laura Nickeland Curt Noll,then ﬁ rst-yearstudents at California State Universityat Hayward;M23309 inFebruary1979, also by NickelandN011; M44,497 in April1979; M36,243 andM132,049 in1983, andM216,091, the currentcham- pion in September, 1985. The determination ofthislast giant tookover3 hours on thenew Cray X-MP computer. Indeed, searching fornew Mersenne primeshas becomea standardtest to demonstrate thespeed ofnewlydeveloped computers. Historically, ithas required about four timesas much computer time todiscovereach new Mersenne primeas it would to rediscover allpreviously knownMersenne primes. However, humanna- ture being what itis, we can expect thatthesearch forthese extremelylarge primes will notend here. Infact, theLucas— Lehmertest for primality ofMersenne primesis given in the exercises ofSection 4.2. Thus, ifsufficient running timeona suf ﬁ ciently powerful machine can be secured, the readercan happilyenter the competitionand perhaps at least brie ﬂ yreceive recognition inthe Guinness Book ofWorldRecords. But what about other numbers ofthe form a\"— 1? Mightthey provideeven more huge primes? The answer, inthenegative,is given inthe followingtheorem. THEOREM 3.9. Ifa\"— lisaprime,n >1,anda >1,thena =2 andnisa prime. Proof. Since a\"—1=(a—1)(a\"’1+a\"'2+- - - +a+1) and the second factoris clearly greater than1, itfollows thata—1 =landa =2. Otherwise, the ﬁ rst factor wouldalso exceed1 and a\"—1 wouldbe composite. Moreover, ifn were compositeso thatn =rs with r >1, s >1, then 2rs— 1=(2r—1)(2r<s-1>+2'<s-2>+- - - +2r+1) and each factor on the rightclearlyexceeds1. Thisis againa contradiction,so n must be a prime. A statement similar to that ofMersennewas made byFermat, who conjectured that22\" +1 isa prime forevery nonnegative integern. Thisis certainly true for n =0,1, 2, 3, and4. But in1732, Eulershowed that22’ +1 is divisible by641 andso is nota prime. Indeed, inspite ofextensive theoreticaland computationalefforts, no more Fermat primes have been discovered and many numbertheoristssuspect that no more exist. Still, Fermat’sguess was notunreasonable,as the followingtheorem shows. THEOREM 3.10. Ifa\" + lisa prime,a >1, n >0, thenais even and n = 2’ forsome r. Proof Ifa were odd, then a\" +1 24 wouldbe even andso would notbea prime. Moreover,suppose thatn had an odd factorgreater than1, say n =mg withq Sec. 3.4 Mersenne, Fermat, and Perfect Numbers 83 odd and q >1. Then a\" +1 = we +1 =(am+1)(am(q-l)_am(q-2) +. . . __ am+1). Since(1 Z3, both factorsare greater than1 and this contradictsthe fact that a\" +1 is a prime. Therefore,n has no odd factorandso mustbe ofthe formn =2’forsome nonnegative integerr. Finally,we consider an interestingset ofnumbers called perfect numbers which were certainly studied by the Greeks and possiblyeven before and whichare inti- mately related to Mersenne primes. Most simply,a perfect numberis one suchas 6 =1 +2 +3 whichis equal to the sum ofits properdivisors. Using more modern notation,we give the following de ﬁ nition interms ofthe function0(n),thesum ofthe positive divisors of12 (see Section 2.5). DEFINITION3.1. Apositive integera is called perfect incase 0(a) =2a. For example, since a(6)=1+2+3+6=12 and a(28)=1+2+4+7+14+28=56, it follows that6 and28 are bothperfect. Similarly,496 and8128are perfect, and the reader may notice thateach ofthese numbersis even. Indeed, the onlyknownperfect numbers are even, and all ofthese areas characterized inthe followingtheorem,the ﬁ rst part ofwhichwas known to Euclid. THEOREM 3.11. If2”—1 isa prime, thena = 2\"“(2\"— 1) is perfect and every even perfect numberis ofthis form. Proof. Leta = 2\"‘1(2\"— 1), where 2\"—1 isaprime.Then, by Theorem2.24, 0(a) = a[2\"‘1(2\"—- 1)] = 2\"— l 2_1-(2—1+1) =2\"(2\"—1) =2a, and itfollows thata is perfect. Conversely, suppose thata is an even perfect number. Determinen and m by the equation a=m2”—l 84 Prime Numbers Chap. 3 and the conditions It 22, m odd, m >0. Since a is perfect,we have again m2\" =2a =0(a) = a(m2\"”‘) = a(m)a(2\"‘1) =a(m)(2”— 1). Therefore, Since is an integer and (2 \", 2\"— 1) =1, this implies that (2\"-1)}m andhence that m m 2\"—1 ' Moreover, m2\" m a(m)—2n_1 —m+2n_1’ so that a(m)is equal to the sum ofm and one other positive divisor ofm. Thus, m must have only two positive divisors, andso mustbe a prime. Also, itmustbe the case that m 2\"—1 1' Therefore, m = 2”— landa = 2\"“(2\"—1),where 2\"—1 is a prime. Ofcourse, itis not known ifthere exist in ﬁ nitelymanyeven perfect numbers since, as Theorem3.11 shows, there isa one-to-one correspondence between even perfect numbers and Mersenne primes and itis not known iftheset ofMersenne primes is in ﬁ nite. Also, itis notpresently known ifany odd perfect numbersexist, although, curiously, theorems do exist whichshow that ifmis an oddperfect number, then m mustbe verylarge. Peter Hagishas shown thatevery odd perfect numberm must have at least8 distinct primefactors and G. Cohenhas shown thatm must exceed 108°. In1977, M. BuxtonandS. Elmoreannounced that, infact, m must exceed10200 butthey have never publisheda paper tothise ﬁ ‘ect. Inanycase, itseems increasingly likely that no odd perfect numbersexist. Sec. 3.4 Mersenne, Fermat. and Perfect Numbers 85 EXERCISES 3.4 10. 11. 12. . Ifn is even, show by exhibitingthe other factor thata +1 is alsoa factor of a\"—1. . Show thata + lis nota factor ofa\" +1 ifnis even anda >1. . If 9(n) is the nth Fermat number,show that(9? (n), g(n +k)) =lforevery pair ofpositive integers n andk. Hint: Show that97 (n)|{97 (n +k)— 2}. . Deduce fromExercise3 thatthereare in ﬁ nitelymanyprimes. . (a) If% (n) is the nth Fermat number, prove that21:01 9(k) =9\" (n)— 2 for every positive integern. (b) Use part(a) to again deduce that (9(n), 9(n +k)) =1 forallpositive integers n and k. . Test for primalityeach ofthe numbers2 +1, 22 + l,222 +l,2222 +1. Since 251 is the largest prime notexceeding thesquare root of2222 +1, itwillprobably be easier to do this problem by checking Lehmer’s table ofprimes mentioned in Section3.1, which, hopefully,is in your library. . On the basis ofExercise6, could youmakea conjecture? . Let4 =2 \"‘1- p, where p =2 \"—1 is a Mersenne prime. Listallthe divisors of q and show directly thatq isa perfect number. . Is either of523,776 or33,550,336a perfect number? Itmayhelp torefer tothe table ofprimes at the back ofthe book. The following triangulararrays ofdots led the early Greeks to call the numbers1, 3, 6,10, 15,. . . triangular num- bers justas 1, 4, 9, 16,. . . are calledsquare numbers andcanbe associated with square arrays ofdots. Since1 =1,1 +2 =3,1 +2 +3 =6, 1 +2 +3 +4 =10, andso on, itis clear thatthe nth triangularnumberis given by the formula = n(n+ l) —2. Prove thatevery even perfect numberisa triangularnumber. Which triangular numberis 2\"“(2\"— 1)? If0(a) =ra, a is called multiplyperfect ormoreaccurately,r-perfect. Verifythat 120 and 672 are 3-perfect and that2,178,540is 4-perfect. Inmakingthelast t(n)=l+2+- -- +n 86 *13. 14. 15. Prime Numbers Chap. 3 veri ﬁ cation itmaybe helpful toconsultthe small factortable at the back ofthe book. Let rands be even positive integers such that a(r) =2s and0(s) =2r. Prove that there exist Mersenne primes21’—1 and2‘1 —1 such that r =2 ‘1“(21’— 1) and s = 2”“(2‘1— l),and conversely. Computer Exercises The positive integer ais called abundant if0(a) >2a and de ﬁ cient if0(a) <2a. Writea computer program toclassify aas abundant,perfect, orde ﬁ cient for 1 S a S100. Study the outputcarefullyand makeseveral conjectures. Use a modi ﬁ ed version ofthe program ofExercise14 tosee ifthereare any odd abundant numbersless than10,000. Can youmake any conjecture on thebasis ofthese data? 4 Congruences As we have alreadyseen inSection1 .7, the solution ofmanyproblems inthe theory of numbers depends on focusing attention on the remainders obtained when numbers are divided by other numbers. Forexample, whenwe talkabouttheset ofeven integers, we are talking about theset ofnumbers thatleavea remainder of0 when divided by2. Similarly,the odd numbersare those thatleavea remainder of1 when divided by2. Fromthese results itfollows thatthesquare ofan integer mustleavea remainder of0 or1 when divided by4; itcannotleavea remainder of2 or3. This in turn is the key to the solution ofExercise1 ofSection1.7, where thereaderwas asked to show that no number inthesequence1 1, 111, 1111, 11111,. . . isa perfect square. Again, inshowing that allprimes other than2 or5 mustbe ofthe form 10k +1, 10k +3, 10k +7, or10k +9, we are simplyshowing thatthey mustleave remainders of1, 3, 7, or9 when divided by10; no otherremaindersare possible. And another way ofstating the celebrated theorem ofDirichlet(Theorem3.2)is tosay that if0 S a < dand (a, d) =1, then thereare in ﬁ nitelymany primes thatleavea re- mainder ofa when divided byd. This idea occurredso frequentlyandwas ofsuch importance innumber-theor- etic investigations thatthe great CarlGauss was led to introducespecial terminology and notation to indicate when two numbers leftthesame remainderwhen dividedby some numberm. Gauss’s idea, whichisa remarkableexample oftheuse ofwell-cho- sen notation to facilitate mathematical argument, maybe statedas follows:a is congruent tob modulo m andis writtena Eb (modm) incase a andb yieldthesame remainder when divided bym. Aswe shallsoonsee, this notation not onlyprovides a powerful and convenient tool forattacking manytypes ofdivisibilityproblems, but also suggest an extensive list ofinteresting investigations. 87 88 Congruences Chap. 4 4.1 BASIC DEFINITIONS ANDPROPERTIES Instead ofde ﬁ ning congruence ofintegers interms ofremaindersas suggested above, we begin by giving the following equivalent de ﬁ nition. DEFINITION4.1. Ifm is positive and m|(a—- b), wesay thata is congruent to b modulo m andwe writea Eb (modm). Ifais notcongruent tob modulom,we write a E b (mod m). For example,7 E1 (mod3),6 E—2 (mod4), anda E0 (modm) ifand only ifmla. Moreover, ifa is divided bym to obtain4 and rsuch thata =mq +rwith 0.<_ r <m, then m|(a— r)and a E r(modm). Thus,we have thata is congruent modulo m to its remainder when dividedby m. DEFINITION4.2. Ifa =mq +rwith0 sr <m, then ris called theleast residue ofa modulom. Ingeneral, ifa Eb (modm), thenb is calleda residue ofa modulo m. THEOREM4.1. Ifa andb have thesame least residue modulom, then a E b (mod m), and conversely. Proof Let rand r’be the least residues ofa andb modulom, respectively. Then there exist q and q’such thata =qm +r, b =q’m +r’,0 S r <m, and0 S r’ < m. By de ﬁ nition,a Eb (mod m) ifand only ifm|(a— b). Since a—b=m(q—q’)+r—r’, it follows that m|(a— b) ifand only ifm|(r— r’).But —m<—(m-1)Sr—r’Sm—l<m and since zero is the only multiple ofm larger than—m and smaller thanm, m|(r— r’) ifand only ifr— r’=0. Thus,a Eb (mod m) ifand only ifrE r’,as was to be proved. The use ofthe symbol “E”forcongruence ofintegersis reminiscent oftheuse ofthe symbol “=”forequality. We shall soonsee thatthe similarityis more than just notational. Infact, both relationsare examples ofa moregeneral mathematical notion, that ofan equivalence relation. DEFINITION4.3. Anequivalence relationisa binary relationE (i.e.,a relation involving twoobjects) de ﬁ ned forpairs ofelements ofa set S and having the following three properties, where aEb means “ais related to b.” (i) aEa forany a inS. (ii) Ifa and b are inS and aEb, thenbEa. (iii) Ifa, b, andc are inS withaEb andbEc, thenaEc. Sec. 4.1 Basic Definitionsand Properties 89 These three propertiesare called, respectively, thereflexive, symmetric, and transitive properties. Itis easy tosee thattheequals relation forreal orcomplexnumbers and the congruence and similarityrelations forgeometricalﬁ guresare examples ofequiva- lence relations. On the otherhand, “isa divisor of,”referring tononzerointegers, is re ﬂ exive and transitive but not symmetric andso is notan equivalence relation. Similarly, “is perpendicular to,”referring tostraightlines, is symmetric but not re ﬂ exive or transitive andso also fails tobe an equivalence relation. Now, an equivalence relationE ona set S partitionsS intoa collection of mutually exclusivesubsets inthe followingway. Associate witheach elementa ofS the set S, ofallelements ofS whichare equivalent toa withrespect tothe relationE. Since aEa foranya inS, a is inS, foranya. Thus,each element inSis contained inat least one ofthe subsets justdescribed. Moreover, ifS,andSb are any two ofthese subsets, either theyare identical, ortheyhave no elements incommon. Tosee that this is so, we note that ifc is inboth S,andSb, thenaEc and c.Butthen, bythe transitive property,aEb. Thus, again by transitivity,any element equivalent toa is also equivalent tob, and conversely. Thus, S, andSb are identical. The subsets ofequivalentelements ofthe preceding paragraphare calledequiv- alence classes and any element ofa givenclass is calleda representative ofthatclass. For example, ifwe are concerned withthe equivalence relation ofsimilarity of geometrical ﬁ gures, one equivalenceclass wouldbe theset ofallequilateraltriangles, and any particular equilateral triangleisa representative ofthe wholeclass. The terminologyis especially appropriatesince the representative ofan equivalenceclass truly represents every element oftheclass withrespect tothe property involved. Thus, the triangle withsides ofunitlength faithfullyrepresents any equilateral trian- gle as faras shape is concerned, although itis notrepresentative withrespect tosome other propertysuchas area. In the following theorem,we show thatcongruence ofintegers is an equivalence relation. THEOREM 4.2. Letmbe a positive integer. Thenthe followingthree properties hold: (i) a E a (mod m) foranya. (ii) Ifa Eb (mod m), thenb Ea (modm). (iii) Ifa Eb (mod m) andb Ec (modm), thena E6 (modm). Proof Allthree assertions follow directly fromthe de ﬁ nition ofcongruence. One might prove part (iii)by noting that, by Theorem4.1,a,b, andc allhave the same least residue modulom,so a Ec (modm),as was tobe proved. The re ﬂ exive, symmetric, and transitiveproperties ofcongruencesare ofcon- siderable importance and willbe inconstantuseas ourexpositionproceeds. Since it is easy to overlook, the reader should note inparticularthat, bythe re ﬂ exive property, 90 Congruences Chap. 4 numbers thatare equalare also congruent. Thus, ifa =b,thena Eb (modm) for any m. Furthermore,since congruence ofintegers modulomis an equivalence rela- tion, itdivides theset ofallintegers into mutuallyexclusive equivalenceclasses or residue classes,as theyare called inthiscase. Anyinteger ina givenresidueclass is congruent modulo m to any other integer inthatclass, and notcongruent toany integer inany otherclass. Since, by Theorem4.1, every integeris congruent toits least residue modulom and the onlyleast residues orremainders modulomare the integers 0, l,. . . , m— 1, itfollows thatevery integer mustbe congruent modulom to one ofthese numbers. Also,since no two ofthese remaindersare congruent modulo m, itfollows thatthereare precisely mresidueclasses modulom, and thatthe integers 0,1,. . . , m— lare representatives oftheseclasses. Ifwe denote bySo the residue class ofallintegers congruent tozero modulom, then So={0,im,i2m,. . .}. Similarly, S1={1,1im,1i2m,. . .}, $2 ={2,2im,2i2m,. . .}, sm'.’—'{'ni;i'n;'—'1¥n;'ni~'1+2m...}. Modulo3, the three residueclasses wouldbe So={0,i3,i6,...} ={..3—036 ...}, S,={1,li3,li6,...}={..—,,,,2147...}, Sz={2,2i3,2i6,. ..}={..—,,,,1258 ...}, and 0,1, 2 are representative oftheclasses. Ofcourse, one couldchoose other numbers, suchas 6, 4, and— 4, or0, l,and— l,as representatives oftheclasses since any number ina class is a representative ofthatclass. Somewhat dilferentlyput, itis clear from the construction oftheclasses thatany threeintegers, no two ofwhichare congruent modulo3, constitutea completeset ofrepresentatives forthe threeresidue classes modulo3. Also, any m integers, no two ofwhichare congruent modulom, constitutea completeset ofrepresentatives forthe mresidueclasses modulom. In this connection,we make the following de ﬁ nition. DEFINITION4.4. Theset ofintegers {0,1, 2,. . . , m— l}is called the least residue system modulom. Anyset ofmintegers, no two ofwhichare congruent modulo m, is calleda complete residuesystem modulom. Itis clear from the preceding discussion thattheleast residue system isa complete residue system, and thata completeresiduesystem is simplyaset contain- ing precisely one representative ofeach residueclass modulom. Sec. 4.1 Basic Definitionsand Properties 91 The importance ofthe precedingideas is made clear inthe followingsequence oftheorems, whichshow that inmanysituations,a number ina congruence modulo m may be replaced by any otherrepresentative ofthesame residueclass modulom without disturbing the congruence. Thetheoremsalso show that,as faras addition, subtraction, and multiplicationare concerned, congruences maybe treated like equalities. THEOREM 4.3. Ifa,- Eb,- (modm) fori=1, 2,. . . , n, then (i) i41,- E ib,- (mod m), and i-l 1\"] (ii) iia, E Hb,- (modm). i-l i=1 Proof (i) Sincea,- Eb,- (mod m), there exist integersq,- such that m—m=ma for each1'. Thus, and 2\":a,- E ib, (modm). i=1 i-l (ii) Similarly,since a, =b,- +mq, foreach i, H “i: ﬁ(bi +mqi) i-li=1 n = Hb,- +mq i-l since the ﬁ rst term inthe second productis 1'1lb, and allthe otherterms must containa factor ofm. Therefore, itfollows that ﬁ aiE ﬁ b,(modm) i-li=1 as claimed. COROLLARY4.4. Ifa Eb (modm), then (i) aicabic(modm),and (ii) ac Ebc (mod m) forany integer6. Proof Since6 Ec (mod m),these assertions follow directly fromTheorem4.3 withn=1, a,=a,b, =b,anda2=b2=ic. 92 Congruences Chap. 4 COROLLARY4.5. Ifa Eb (modm), then a\" Eb” (modm) forany in- teger n 20. Proof This follows from property (ii) ofTheorem4.3 witha,- =a andb,- =b for each i. As an example oftheuse ofthe preceding theorems and corollaries,suppose that we endeavor tocalculate theleast residue modulo7 ofthe quantity 25- 34 +9- 85. One approach, ofcourse, is to performthe indicatedoperations, to dividethe result- ing number by7, and then tosee whatthe remainderis. However, ifwe note that 8 E1 (mod7), then we obtain85 E15 E1 (mod7) by Corollary4.5. Also,9 E 2 (mod 7). Combiningthese last tworesults by property (ii) ofTheorem4.3,we obtain 9- 85 E2 (mod7). Again, 25 E— 3 (mod7) and34 E --1 (mod7),so that 25- 34 E(—3)(—1) E3 (mod7). Combiningthese results, by property (i) ofTheorem4.3 we ﬁ nallyobtain 25- 34+9' 85E2+3E5(mod7). Thus,5 is the desired least residue. Withexperience, the workcanbe greatly short- ened by simply replacing the various numbers (other thanexponents) bynumbers to which they are congruent. Forexample,we may write 25- 34+9- 85E(—3)(-1)+2 ~15E3+2E5(mod7). Doing itthe hard way, the doubtfulreader willﬁ ndthat 25- 34+9- 85=7- 42,251 +5. We submit that the preceding approachis mucheasier! In later chapters we willneed to work withlarge powers ofintegers. Suppose, for example, thatwe want to knowtheleast residue of3472 modulo242. Inthiscase, it is quite simple since35 =243 E1 (mod242). Thus 3472 =35- 94+2 =(35)9432 E194. 32 E9 (mod242). However, to compute theleast residue ofsomething like357281 modulo4001 is somethingelse again. Perhaps theeasiest approach,reasonable witha hand-held calculator and certainly suitable fora computer,is the following.We write 28110=1000110012=l+23+24+28=1+8 +16+256, so that Sec. 4.1 Basic Definitionsand Properties 93 357281 =357l+8+l6+256 =357 ' 3578 '35716 '357256. Note, moreover, thatthe factors on the right of(4.1) can be selected fromthe following list ofsuccessive squares: 357, 3572, 3574=(3572)2, 3578=(3574)2, Since the work ofconverting28110 tobase 2 canbe accomplished bysuccessively dividing by2 and notingthe remaindersas observed inSection1 .8, the work forhand computation ofthe least residue of357281 modulo4001 mightreasonablybe ar- rangedas follows. Note that allcongruencesare modulo4001. (4.1) 298i 2w1 357 a357 2|7_0 e—aylsamr 21g —6———35—74E3805- E1355 2|1_71 3578 E2407 2|§1 357\"5 a2553 a934 213 49—35432Erse 2L2 9—3578—3392L s396 211 —0———35—7-m—=—t62(r 0 l357256 E3216 where 3216- 2553 E396, 396- 2407 E934, and934- 357 E1355. Thus, 357281 E1355 (mod4001). Because ofthe similaritybetween this computationand theRussianpeasant method, of multiplicationdiscussed inSection1.9, thisis sometimes called the Russian peasant method forﬁ ndingpowerresidues. Withonlya littlepractice itcan easilybe done on a hand-held calculator (ifthe numbers do notexceed its capability)and itis easily programmed fora computer. As noted above, the analogy between the treatment ofcongruences and equali- ties does not extend to division. Thatis, ifae Ebe (modm), itis notnecessarily the case thata Eb (modm). Forexample,10 E2 (mod8), yet5 E1 (mod8). A moment’s re ﬂ ection willreveal why thisis sometimesso. Saying thatac E be (mod m)is thesameas saying thatm|(ac— be), thatis, that m|(a— b)c. However, this does notnecessarily imply that m|(a -b) and a Eb (modm). Itcouldeasilybe the case that part ofm dividesc and partdivides a -b, oreven thatmlc. The following theorems show what conclusioncanbe drawn forthegeneralcase. THEOREM 4.6. Ifac Ebe (modm), thena Eb (mod m/d),wherea' = (c, m). Proof. Ifac Ebe (mod m), then thereexists 4 such thatmq =ae— be = (a — b)c. Dividing bothsides ofthis equation by d =(c, m),we obtain Mq = 94 Congruences Chap. 4 (a — b)C, where c =Cd, m =Md,and(C, M) =1 by Corollary2.7, Section2.3. Now M|C(a-— b), and since (M, C) =1, itfollows fromTheorem2.8, Section2.3 that M|(a—- b). Therefore,a Eb (mod M).Since M=m/d, thiscompletes the proof. COROLLARY4.7. IfacEbc (mod m) and(c, m) =1, thena E b (mod m). Proof This follows directly from Theorem4.6 since d =1. THEOREM 4.8. Ifc E0 and ac Ebe (modme), thena Eb (modm). ProofSince ac Ebe (modme), there exists an integerq such that ac — bc =qmc. This implies thata— b =qm,so thata Eb (modm),as claimed. THEOREM 4.9. Ifa Eb (modm),a Eb (modn), and (m,n) =1, then a E b (mod mn). Proof. Since a Eb (mod m) anda Eb (modn), itfollows thatm|(a— b) and n|(a—- b). Butsince (m,n) =1, Theorem2.13 implies thatmn|(a— b). Butthen a E b (mod mn),as claimed. COROLLARY4.10. If aEb(modm,) for i=1,2,.. . , rand m1, m2,. . . , m,are pairwise relatively prime, then aEb (modm), where m = Hf—l mi. Proof This couldbe derived fromTheorem4.9 using mathematical induc- tion. However, we use Corollary2.14. Since a Eb (modm,), itfollows that m,|(a— b). But then m|(a— b) by Corollary2.14 anda Eb (modm),as claimed. EXERCISES 4.1 l. Which ofthe followingare equivalence relations? Ifa relationis notan equiva- lence relation, explain why. (a) The relation ofparallelism forlines. (b) The relation of“less than orequals” forreal numbers. (0) The inclusion relation forsets. (d) The equality relation forsets. 2. Give an example ofa relationde ﬁ ned ona set and havingthe followingproper- ties: (a) The relationis re ﬂ exive and symmetric, but nottransitive. (b) The relationis symmetric and transitive, but notre ﬂ exive. (c) The relationis re ﬂ exive and transitive, but notsymmetric. Sec.\\IQUIA 4.1 Basic Definitionsand Properties 95 . Criticize the following argument thatthe re ﬂ exive property forequivalence relations isa consequence ofthe symmetric and transitiveproperties: Accord- ing to the symmetric property, ifaEb, thenbEa. Then, according tothe transi- tive property withthec ofDe ﬁ nition4.3, property (iii),replaced bya, aEa and the relationE is re ﬂ exive ifitis symmetric and transitive[see Exercise 2(b)]. . Find the least residue modulo7 ofthe quantity22- 51 +6985. . Find the least residue modulo5 of32 and32°. . Find the least residue modulo7 of10515. . Prove that the thirty-seventh Mersenne number,237 — 1, is divisible by223, thatis, that237 E1 (mod223). . Show that the numbers—13, —9, —4,— 1, 9,18, 21 forma completeresidue system modulo7. 9. Show that any m consecutive integers forma completeresiduesystem modulo m. 10. Ifall, a2,. . . , am forma completeresidue system modulom and (k, m) =1, prove that kal, kaz,. .. , kam also forma completeresiduesystem modulo m. 1 1 . Finda complete residue system modulo5 composed entirely ofmultiples of9. 12. Show that12, 22,. .. , m2 is nota completeresidue system modulom if m >2. 13. Prove thata perfectsquare musthave one of0, l,4,5, 6, or9 forits units digit and thata perfect fourthpower musthave0,1, 5, or6 forits units digit. Hint: An integeris congruent modulo10 toits units digit. 14. Show that any one ofthe10 digitscan occuras the units digit ofthecube of an integer. 15. Prove that17 does not divide5n2 +15 forany integern. 16. Ifa Eb (mod m) and nlm, prove thata Eb (modn). 17. Ifn is an integer not divisible by2 or3, show thatn2 E1 (mod24). 18. Ifa is a positive odd integer, prove thata2\" E1 (mod 2\"”)forevery positive integern. 19. Compute the least residues modulo7 of f(2),f(—5), f(16),f(—12), and f(9) if f(x) =23x4— 9x3 +5. 20. Compute the least residues modulo12 of f(— 4), f(8), f(20), and f(32) if f(x) = 11x4— 7x2 + 23x+7. 21. Carefully examine the results ofExercises19 and 20 andsee ifyoucanguessa general rule. 22. Determine the least residue of(n— l)!modulon forseveral values ofn andsee if you can guess a general rule. 23. Prove thata5 Ea (mod3) andas Ea (mod5) forevery integera. 24. Prove thata5 Ea (mod15) forevery integera. 96 Congruences Chap. 4 25. Prove thata21 Ea (mod15) forevery integera. 26. Ifpis a prime anda2 E1 (modp), prove thata E i1 (modp). 27. Give an example toshow thatthe result ofExercise26 is notnecessarily valid ifp is nota prime. *28. Note thatF0 =0, whereFn denotes the nth Fibonacci number.Prove that for any positive integer m, there exist in ﬁ nitelymany positiveintegersn such that F\" E 0 (mod m). Hint: The pigeonhole principlestates that ifyouhave n pigeons toplace inm pigeonholes and n >m, then atleast twopigeons mustgo inone pigeonhole. Use the pigeonhole principle toshow thatthesequence F0, F1, F2,. . . isa repeating sequence modulo m forany m 22. Computer Exercises 29. Writea computer program to determine theleast positive integer a(p)such that Fam E 0 (mod p) for allprimes p <150. Also, printtheleast residues of F1 , F2,. . . ,Fam. 30. Repeat Exercise 29 modulop2 forallprimes p <150. 31. Repeat Exercise 29 modulo pq forall distinctprimes pandq notexceeding150. 32. Make conjecturesbased on the results ofExercises 29 to31 and any otherdata you mightfeel itdesirable to compute. 4.2 SPECIAL DIVISIBILITY CRITERIA Everyone knows thatan integeris divisible by2 ifand only ifthe last digit inits decimal representationis even. Thisisso since an integern canbe represented inthe form n =10k +u, where u is the last digit inthe decimal representation ofn. Clearly, 2|n ifand only if2|u. Similarly,an integeris divisible by5 ifand only ifthe last digit inits decimal representationis 0 or5. Simple criteria for divisibilityby3, 9, and11 also exist and can easily be deduced fromthe theorems inSection4.1. We shall ﬁ rst provea general theorem having todo withcongruences involvingpolyno- mials with integral coef ﬁ cients. THEOREM 4.11. Let f(x) = 2L0ckx\", wherec0,c1 ,. . . , c\" are in- tegers. Ifa Eb (mod m), then f(a) E f(b) (modm). Proof. By Corollary4.5, a\" E b\" (modm) for k =1, 2,. . . , n. Therefore, by Corollary 4.4, cka\" E ckb\" (mod m) for each k. Thus, using property (i) ofTheorem4.3, we obtain Sec. 4.2 Special DivisibiiityCriteria 97 icka\" E ickb\" (modm). k=0 k=0 Thus, f(a) E f(b) (mod m) and the proofis complete. THEOREM 4.12. Leta =Eié=o ak10\"be the decimalrepresentation ofa, lets =E ﬁ =o ak, and letI =Efé=o(— l)\"ak.Then (i) 9|a ifand only if9|s; (ii) 3|a ifand only if3|s; (iii) 11|a ifand only if1 1 it. Proof (i) Itis clear thata = f( 10), where f(x) = 2L0akx\", and thats = f(1). Since 10 E1 (mod9), itfollows from Theorem4.11 thataE5 (mod9). Therefore, a — s =94 forsome(1 and from this itfollows that9|a ifand only if9|s. (ii) and (iii) The proof for3 is exactly thesameas for9. The prooffor11 follows from the fact that10 E—1 (mod11) and that t = f(— 1). As examples ofTheorem 4.12, we note that340,722is divisible by9, since9 divides3 +4 +O +7 +2 +2; that41,811 is divisible by3, since3 divides 4 +1 +8 +1 +1; and that304,161 is divisible by11, since11 divides —3 +0— 4 +1 — 6 +1. On the otherhand,357,266is not divisible by3, 9, or11, since3 +5 +7 +2 +6 +6isnotdivisibleby3or9and—3 +5 -7 +2— 6 +6is not divisible by11. EXERCISES 4.2 1. Check the following numbers for divisibilityby3, 9, and11. (a) 37,686 (b)113,058 (c) 20,004 (d)371,684 2. Note that103 E—1 (mod7) and developa criterion for divisibilityby7. 3. Developa criterion for divisibilityby13. 4. Leta =akbk +ak_1b\"‘l +- - - +a.b +do be the positionalrepresentation of a tobase b, where b >1. Develop criteria for divisibility ofa bydivisors ofb—1 and b + l. 5. A common error inbankingis tomake an interchange ortransposition ofsome ofthe digits involved inan amount. Forexample,a teller maypay $43.34 ona check actually written for$34.43 andso be short$8.91 at the end oftheday. Prove thatsuch an erroralways leads toanoutage, inpennies, whichis divisible by 9. 6. Leta ands beas inTheorem 4.12. (a) Prove that 4|a ifand only if4|(10al +a0). (b) Prove that 6|a ifand only if3|s and 2|ao. (c) Prove that 8|a ifand only if8|(100a2 +10al +a0). 98 Congruences Chap. 4 7. Ifpis a prime and (p,10) =1, prove thatthere exist integers kand ysuch that yp = 10k +1. 8. Show that the y ofExercise7 can be chosen tobe1, 7,3, or9, respectively, accordingas p E1, 3, 7, or9 (mod10). 9. Letn =10a +b. Note thatb is the units digit inthe decimalrepresentation ofn. Ifp is a prime with (p,10) =1, prove that pln ifand only ifp|(a— kb), where kis determinedas inExercises7 and8. Computer Exercise 10. Without proof,we give the Lucas-Lehmertest fordetermining primalityor nonprimality ofa Mersenne numberMn =2\"—1. De ﬁ nea sequence ofintegers recursivelyas follows:r1 =4; for k 22, rk is theleast residue of ri.l— 2 modulo Mn. Then Mnis prime ifand only ifr-1 E0 (mod M\").We note thatthetest can be completed inn—1 steps using only0(n3) bitoperations.As an example, we note that the test for M7 proceedsas follows:r1 =4,r2 E42 -2 E 14 (mod 127),r3 E142 -2 E67 (mod127),r4 E672 -2 E42 (mod127), r5E422—2E111 E—l6(mod127), and ﬁ nally r6E(—16)2-2E0 (mod 127). Therefore, M7 =127 isa Mersenne prime,as we know. Writea program to implementthe Lucas—Lehmertest and run itfor several values where M,isa primeand where M,is nota prime. Or,go forthe gusto, and ﬁ ndthe nextlargest Mersenne primeafter M216,091. Just watch out for your large-integer arithmeticsubroutine! 4.3 REDUCED RESIDUE SYSTEMS ANDTHEEULER (b-FUNCTION Many times inthe theory ofcongruences, numbers thatare relatively prime tothe modulus playa unique role. Thus,as we haveseen, ifac Ebe (modm) and (c, m) = 1,thena Eb (modm). Again, byExercise10, Section 4.1,ifa1, a2,.. . , a,,, forma complete residue system modulom and (k, m) =1, then kal, kaz,. . . , kam also forma complete residue system modulom. Similarsituations occurfre- quently, and itis worthwhile togive special attention tonumbers thathave this property. First ofall, we note that ifa and mare relatively prime, then all oftheintegers in the residue class S,are also relatively prime tom. Infact,as the followingtheorem shows, if(a, m) =d, then(b, m) =d foranyb intheresidueclassSa. THEOREM4.13. Ifa Eb (modm), then(a, m) =(b, m). ProofSince a Eb (modm), thereexistsq such thata— b =mq. Fromthis it follows thatany common divisor ofa and mis alsoa common divisor ofb andm, and conversely. Therefore,since a and m andb and m have thesame commondivisors, they have the same greatest common divisor. Sec. 4.3 Reduced Residue Systemsand theEuler ¢—Function 99 Since all the elements inS,are relatively prime tom ifais relatively prime tom, it follows that any two complete residuesystems modulo m containthesame number ofintegers thatare relatively prime to m and thatthese integersare congruent modulo m in pairs. Forexample, inthe completeresiduesystems {1,2, 3, 4,5, 6, 7, 8} and{9, 10, —5, -4,21,— l,7, 16} modulo8, the integers l,3,5,7 and9,— 5, 21,7 are relatively prime to8, and lE9,3 E— 5,5 E21, and7 E7, all modulo8. More generally, to ﬁ nd whichintegers are relatively prime tom, itis onlynecessary to determine which ofthe integers1, 2,.. . , mhave this property. Anyotherinteger thatis relatively prime to m must thenbe congruent toone ofthoseselected fromthis set. These considerationsare formalized inthe followingde ﬁ nitions. DEFINITION4.5. The number ofpositiveintegers notexceeding m that are relatively prime to m is designated bythe function(Mm).¢v(m) is called the Euler qS-function after its originator, Leonard Euler(1707—1783). DEFINITION4.6. Anyset of(Mm)integers thatare relatively primeto m and thatare mutually incongruent modulomis calleda reduced residue system modulo m. According tothese de ﬁ nitions, ¢(8) =4, and{1,3, 5, 7} and{9, -5, 21, 7}are reduced residue systems modulo8. Also, ¢(1) =1, (M2) =1,115(6) =2, and ¢(7) =6. Since allthe positiveintegers notexceeding pare relatively prime to1) ifpis a prime, we have further that (Mp) =p—1 and thatthe numbers1, 2,. . . , p—1 form a reduced residue system modulop. Also, ifpisa primeand a 21 is an integer, those positive integers notexceeding pand not relatively prime to p“are justthe pa“ numbers l-p,2-p,.. . ,p‘H-p and itfollows that 1 ¢(p“)=p“-p°‘“ =p“\"(p-1)=p\"‘<1 7;).(4.2) The result formore general n is not much more involved,as the followingtheorem shows. THEOREM 4.14. Ifn isa positive integer, then ¢(1)=1 and ¢(n) = Hp?\"'(p.- -1) = H05(1)?) i=1 i-=l ifn =H i=1 p?“ witha,- E lforall iisthe canonical representation ofn. Equivalently, q.’>(n)=n- 111(1—i). i=1 1),- 1 OO Congruences Chap. 4 Proof By de ﬁ nition, ¢(1)=1. Ifm=Hf=117'?\" with 3,21foralli, let dam,”_____ pj(m) denote the number ofpositiveintegersless than orequal tom and not divisible by any one ofp,, p2,. . . , pi.Weuse induction toshow that ’1 ¢(m)=mH(1 ~-—). i=1 1),- Those integersless than orequal tom divisible byp1 are m I.pl,2.pla- '* ,p_l'pl and they are m/pl innumber. Thus, ¢pl(m)is the totalnumber ofpositiveintegersless than or equal to m minusthe number divisible by p],thatis, ¢p,(m)=m-:-,n-=m(l——). 1 Assume that forsome ﬁ xed k,1 .<_ k <r. k1 (1,171.1); .....pk(m) =m° H(1 ..”—) (43) i-lPi To obtain (ppm,. . . ,pk,pk+l(m), we mustsubtract from915,”: ,,,,,pk(m) the number ofpositive multiples of pk“less than orequal to m whichare notmultiples ofany of p1, p2,. . . , pk. As above, the multiples ofpk+1 less than orequal tomare m 1'Pk+1,2 'Pk+1,-- -,—’'Pk+1 Pk+1 and, by assumption, the numbers thatare not multiples ofatleast.one of p], p2,. . . , pk is, by (4.3) withm replaced bym/pk+1, 1. ﬁ <1_i> Pk+1 i=1 Pk. k ¢Phpz -----Pk+|(m) =¢phpz .....pk(m)— 1' II(1 _ 1) Pk+1 i-lpi k1 mk < l) =. 1—...— . 1—— m i13< Pi)Pk+1i131 Pi so the resultis true for k +1 ifitis true fork. Thus, by limitedmathematical induction (since kwas limitedto thevalues1 S k <r), the resultis trueas claimed. Note, ofcourse, that Thus, Sec. 4.3 Reduced Residue Systemsand theEuler cit-Function 101 n-L'I.(1-i)= ﬁ r- ﬂ (l-i)1 i-li=1 by (4.2). This theorem can be proved inmanyways, anda particularlyelegant proof will be given in Chapter7. As an example ofTheorem4.14, we note that1, 5, 7, and1 lare the fourpositive integers less than or equal to12 and relatively prime to12 and thatqS( 12) = 2(2— 1)-(3—1)=4. THEOREM 4.15. If(11, a2,.. . , dam) forma reduced residue system modulo m and (k, m) =1, then kal, kaz,.. . , ka ﬂ m)also forma reduced residue system modulo m. Proof Since we have the correct number ofelements intheset consisting of ka1,. . . , ka¢(m), itis onlynecessary toshow thateach ofthe numbers intheset is relatively prime to m and thatno twoare congruent modulom. Ofcourse, sincea1, a2,. .. , a¢(m) forma reduced residue system modulom,we have that(a,, m) =1 for each ianda,- aé aj (mod m) ifi55 j. (i) Since(61,-, m) =1foreach iand (k, m) =1, itfollows directly from Theorem 2.12 that (kai, m) =1 foreach i. (ii) Suppose that kai Ekaj (mod m) with1'95 j.Since (k, m) =1, itfollows from Corollary4.7 that a,5aj (modm). But thisis a contradiction,so ka,3E kaj (mod m) for i95 jand the proofis complete. THEOREM 4.16. (Fermat’s Theorem). Ifpisa primeand p Ia, then a?“E1 (modp). Proof. Since ¢(p) =p— 1, this theoremisa direct corollary ofthe following more general result ofEuler. THEOREM 4.17. (The Euler—Fermat Theorem). If(a, m) =1, then aw\") E1 (modm). Proof Leta1, a2,. . . , aw\")constitutea reduced residuesystem modulom. Since (a, m) =1, itfollows from Theorem4.15 that aal, aaz,. . . , aa ﬂ m)also form 102 Congruences Chap. 4 a reduced residue system modulom. Hence toeach iwith lS is¢(m),there corresponds precisely one jwith lS jS ¢(m)such that act, E aj (mod m). Taking the product ofthese qb(m) congruences and noting that MM) ¢(m) Hai = Haj9 i-1 j=l we obtain MM) 4:0\") aw”)- HaiE Ha, (modm). i=1 i=1 Since (ai, m) = lforeach i, itfollows fromTheorem2.12 that (“Hi\")(1,, m) =1. Therefore, by Corollary4.7, we may divide bothsides ofthe preceding congruence by Hi’i’f‘)a,- to obtain aw”) E1 (mod m), as desired. Itis easy tosee that Fermat’s theorem canbe stated ina slightlymoregeneral way which removes the restriction that pXa. COROLLARY4.18. (AlternativeStatement ofFermat’s Theorem). Ifpisa prime, then a” Ea (mod p) foranya. Proof IfpX a, then a!\"1 E1 (modp). Therefore, multiplyingbothsides of the congruence bya according to Corollary4.4, we obtain a” Ea (modp). Ifpla, then a E 0 (mod p)and a” E0 (modp), by Corollary4.5. Therefore, by transitivity, a” Ea (mod p) inthiscase as well. Itis reasonable toexpect thattheEuler— Fermat theorem mightbe generalized along the same linesas the preceding generalization ofFermat’s theorem. Anatural guess wouldbe that a'” E am‘W\") (mod m) for any(1 since form =p, thisreduces tothe statement ofCorollary4.18. Itturns out that thisguess is correct, butwe shall notgive the proofhere. Amore exoticgeneral- ization whichalso reduces to Corollary4.18 form =pis 2<I>(d)a\"‘/d E0 (modm). dlm Sec. 4.3 Reduced Residue Systemsand theEulercit—Function1 03 EXERCISES 4.3 10. 11. 12. 13. 14. 15. 16. 17. 18. 19. 20. . Show that the numbers— 30,— 19,— 15,— 4,15, and39 forma reduced residue system modulo7. . Finda reduced residue system modulo7 composed entirely ofmultiples of3. . Let S ={(11, a2,. . . , {law} witha,- <a,-+1 forall ibe thereduced residue system chosen from among the least residue system modulom,so that0 < a, <m and((1,, m) =1 foreachi. Showthatm—a,- =a¢(m)_,-+1 foreach iso that S= T,where T={m—a1,m—a2,. . . ,m—a¢(m)}. . Forn 22, prove thatthe sum ofallawithlSa S nand(a, n) =1 is (Mn)- n/2. Hint: Note that if(a, n) =1, then (n -a, n) =1 byExercise3. . Show that the numbers3,32, 33, 3“,35, 36 forma reduced residuesystem modulo 7. . Ifpis a prime and pzl’ a, then aI’\"E1 (modp), by Fermat’s theorem. Ifp— l is the smallest positive value ofe such thata\" E1 (modp), prove thata, a2,.. . , a!\"1 forma reduced residue system modulop. . Ifp is an odd prime and p«l’ a, show that(IV—”’2 E :1(modp). . Give an example toshow thatthe result ofExercise7 is notnecessarily true ifpis replaced by an arbitrary positive n with(a, n) = l. . Ifp is odd and p anda satisfy thehypotheses ofExercise6, show thatelm—W2 E —1 (mod p). Show that5,52, 53, 54, 55, 56 forma reduced residue system modulo18. Prove thata‘3 E a (mod2730) forany integera. Ifp and q are distinctprimes, prove that 12\"\" +q”—1 E1 (modpq). Ifp and q are distinctprimes, prove that p\" +q” E p +q (modpq). Ifp is a prime other than2 or5, prove that pdivides in ﬁ nitelymany ofthe numbers9, 99, 999, 9999,.. . . pis a prime and1 S k Sp— 1, prove that p_p! =(k)— k!(p— k)!— 0 (modp). Use the result ofExercise15 toshow that(a +b)” E a” +b” (mod p) forany prime p. Use the result ofExercise16 and mathematical induction togive an alternative proof ofthe second form ofFermat’s theorem. Deduce the result ofExercise16 fromFermat’s theorem. Ifp is an odd prime and a” E b” (modp), prove that a”Eb\" (modp2). H int: Deduce from Fermat’s theorem thata Eb (modp). Let al, a2,.. . , am andb1, b2,.. . , b\"be completeresiduesystems modulo 104 Congruences Chap. 4 m and n, respectively, and let(m, n) =1. Show thattheset S ofallintegers ofthe form nai +mbj, for1 S iS m and1 S jSn, isa completeresiduesystem mod- ulo mn. 21. Letm, n, a1, a2,. .. , am, andbl,b2,. . . , bnbeasinExercise 20. Showthat for ﬁ xed1' and j, if (nai +mbj, mn) = d>1, then (m, a.) >1 or(n, bj) >1, and conversely. Hence, conclude that if and bjl,biz,. . . , b1111,61,}, .. . ,a I'M\") 'NM) are reduced residue systems modulom andn, respectively, theset R ofallintegers ofthe formnaik +mbjh with1 S kS ¢(m)and1 Sh S ¢(n)isa reduced residue system modulo mn. 22. Itfollows fromExercise21 that ¢(mn) =¢(m)q.'>(n) if(m,n) =1. Show that ¢(H.‘=1 m) =115.1 ¢(m,-) ifthe mare pairwise relatively prime.Hence, con- clude that ¢(1'If.1 pg“) =H 5.,(15(1)?) anduse this todeduce again the result of Theorem 4.12. 23. Show by example thatq')(mn) is notnecessarily equal to ¢(m)¢(n) if(m,72) 9E 1. 24. Leta, b,c, and dbe any integers. Show thattheset ofnumbers inthe array 8a 8b+1 8c+4 8d+5 8a+2 8b+3 8c+6 8d+7 8a+8 8b+9 8c+12 8d+13 8a+10 8b+11 8c+14 8d+15 is a complete residue system modulo16. 25. Forn >2, is itever thecase that13, 23,.. . , n3 is (is not)a completeresidue system modulon? Giveexamples. 26. Let pbe an odd prime. (a) Prove that11\"1 +21\"1 +- -- +(p— 1)\"’1 E-1(modp). (b) Prove that 1P+ 29+- - - +(p—1)!’ E0 (modp). Computer Exercises 27. Writea computer program to printoutthe ﬁ rst11 rows ofPascal’s triangle modulo1) for all primes p <100, wheren isas largeas youcanchoose without using multiple-precision arithmeticon the machine youare using. Makeone or more conjecturesbased on the output ofyourprogram. 28. Repeat Exercise 27 modulopz. 29. Repeat Exercise 27 modulon for2 Sn S32. Sec. 4.4 Pseudoprimes and Tests forPrimality 105 4.4 PSEUDOPRIMES AND TESTSFOR PRIMALITY According to Fermat’s theorem, a” Ea (mod p) forallintegersa. This actually providesa test for nonprimalitysince, givenn, ifwe can ﬁ ndan integera such that a\" E a (modn), thenn mustbe composite. Forexample,511 is nota primesince 25'1 =29-56+7 215627 a128 E2 (mod511). Note, by the way, thatwe have shown that51 lis composite withoutactually exhibit- ing any factor. Itwouldbe more useful iftheconverse ofFermat’s theoremwere truesince it would providea ready test for primality.Indeed, ancientChinese mathematicians believed that if2\" E2 (modn), thenIt mustbea prime,and modern work with computershas shown this tobe true forpositiveintegersn <300. Itiseasy tosee, however, that itis not true ingeneral. Forexample,since 1024 E1 (mod341), 23“1 =2- 2lo‘34 =2(1024)“ E2 (mod341), yet 341 =11° 31 is nota prime.Nevertheless, we have the following de ﬁ nition. DEFINITION4.7. Ifn is composite and 2\" E2 (modn), then11 is calleda pseudoprime. Moregenerally, ifn is composite and a\" Ea (modn), then71 is calleda pseudoprime t0 the base a. Itturns out thatthe number ofpseudoprimes toa givenbase a is relatively much smaller than the number ofprimes. Forexample, thereare 455,052,512 primes not exceeding1010 and only14,884 pseudoprimes tothebase 2. Thus, checking tosee if a\" E a (modn) is an effective test for primalitysince the number ofcomposite numbers thatcanpass thistest is small. Although theyare relatively much morerare thanthe primes, itis not dif ﬁ cult to show that there are still in ﬁ nitelymanypseudoprimes. Infact,we provethe following interesting result, whichshows thatthereare in ﬁ nitelymanyoddpseudo- primes tobase 2 since 341 is sucha pseudoprime. THEOREM 4.19. Ifn is an odd pseudoprime tobase 2, thenso is m = 2\" -1. ProofSince n isa pseudoprime tobase 2, n is composite and 2\" E2 (modn). We must show that mis composite and 2'\" E2 (modm).Sincen is composite, n =rs with1 < r <n and1 <s <11. Therefore, m=2\"—1=2\"— 1=(2'—1)(2r<s-l>+2r<s-2>+- - - +2r+1), so m is composite. Moreover,since 2\" E2 (modn), thereexists an integerq such that 2\"— 2 =qn. Therefore, 106 Congruences Chap. 4 2’\" 2—= 2(2\"\"l— 1) =2(22’I“—2— 1) =2(2\"\"— 1) =2(2\"—- 1)(2\"(‘1“)+2\"(‘1‘2)+- - - +2\" +1) = 2m(2\"“\"‘)+2\"“1‘2)+- - - +2\" +1) E 0 (mod m), so that \"‘ E2 (mod m), as claimed. Since m =2\"—1 >n forn >1, Theorem4.19shows thatthereare in ﬁ nitely many odd pseudoprimes tobase 2. In1951, the Dutchmathematician N.G. W. H. Beeger proved thatthereare in ﬁ nitelymanyeven pseudoprimes tobase2. Ofcourse, the ultimate inpseudoprimes wouldbe an integern that wouldbea pseudoprime ineverybase a.>_ 2. Such numbersare called Carmichaelnumbers and the smallest is 561 =3- 11- 17. Other Carmichaelnumbersare known, but itis not known ifthere are in ﬁ nitelymany. We also de ﬁ ne strong pseudoprimes tobase b interms ofthe followingtest. DEFINITION4 8. Letn be a positive odd integer and de ﬁ ne rands by n —1 = 2'-s, wheres is odd. Wesay thatnpasses the Millertest tobase a if a’El(mod n) or (1s—1 (modn) for someiwithO < i <r. Ifn is composite and npasses the Millertest tobase a, then itis clear that (a, n) =1. Also, a’ El(modn) oraz'SE—1 (modn) forsome iwith0 S i<r. In eithercase, since an—l =as- 2’ andan—I___ (‘12i. s)2'_‘ and r— i>0, itfollows that(1\"‘1 E1 (modn) andhence thata” Ea (modn). Thus, itis clear thatn isa pseudoprime tobase a. However,since the conditions of Miller’stest are stronger thanneeded toguarantee theexistence ofa pseudoprime to base a, we give the following de ﬁ nition. DEFINITION4.9. Ifn is composite andnpasses the Millertest tobase a, then a is calleda strong pseudoprime tobasea. THEOREM 4.20. Ifpisa primeand p1’ a, then ppasses the Millertest to base a. ,— Proof. Let rands beas in De ﬁ nition4.8 withn =pand de ﬁ ne xk =a‘P‘IW‘ = a2 \"fork =0,1,. . . , r. By Fermat’s theorem,x0 =a”—1 E1 (modp). There- fore, =-a[(p—1)/212 =all-1 =Xo=_1 (mod p) Sec. 4.4 Pseudoprimes and Tests forPrimality 107 and p|(x%— 1). Thus, p|(x1 -1)(x1 +1), so p|(xl +1) orp|(x1— 1); thatis, x, E 1 (mod p) or xlE—1 (mod p). IfxlE—1 (modp), theprocesses stops; ifx1 E1, then x% =a[(P‘l)/4]'2 =a(P_l)/2 =x1—=’ 1 (mod p) and as before,x2 E1 orx2 E—1 (modp). Continuing inthisway, eitherx0 E x1 E- - - Ex,E1(modp) orthere exists i=r—kwith0 <k<r,so that 0< i < rsuch that azi\"=a2'—k“=xkE—l(modp). In eithercase, ppasses the Millertest. EXAMPLE4.1. Show that25 is a strong pseudoprime tobase 7. Proof. Since 25 is composite, itremains toshow that itpasses the Millertest. Since 25—1 =23 ' 3, we set xk =724”\" andproceed tocheck xk (mod25) for k =1, 2, 3. Ifeither ofx, orx2 are congruent to -1orx3 E1 (mod25),25passes the Millertest. For k =1, we havex1 =712 =72‘6 E496 E(—1)6 E1 (mod25) and x2 E72'3 E(— 1)3 E—1 (mod25). Thus,25 is a strong pseudoprime tobase7. Itis worth noting thatthe smallest odd strong pseudoprime tobase2 is 2047. Thus, ifn <2047 is odd andpasses the Millertest tobase 2,11 mustbe prime. Similarly, 1,373,653 is the smallest odd strong pseudoprime tothebases 2 and3. Thus again, ifn <1,373,653 is odd andpasses the Millertest tobases 2 and3,11 must be a prime. The smallest odd pseudoprime tobases 2,3, and5 is 25,326,001, and this clearly leads toa primalitytest foroddn <25,326,001. Finally,the onlyoddpseu- doprime to thebase 2,3, 5, and7 less than(2.5)- 10lo is 3,215,031,751. Thus, if n < (2.5)- 101°, n E3,215,031,751,is odd andpasses the Millertest forthebases 2, 3, 5, and 7, thenn mustbea prime. Ifthe generalized Riemannhypothesis(a deep conjecture inanalytic number theory whichwe cannot explainhere) is true, itcanbe shown thatthe Millertest will discover ifn is a prime in0((log2n)5) bitoperations and there exist muchfaster algorithms. Thisis inmarked contrast tothebest known algorithm foractually factoringn, which requires 0(e‘”°3 \"'1°“ 1°“ \", bitoperations. Thus, itmighttakesome- thing like 40 seconds to determine ifa given lOO-digit numberisa prime, but itwould take something like109 years to factortheZOO-digit product oftwo100-digit primes! Finally,we note that itis impossible tohavea strong pseudoprime toeverybase a Z 2. Thisisa consequence ofthe followingtheorem, whichwestate withoutproof. THEOREM 4.21. Letn be odd, positive, and composite. Then11 passes the Millertest forat most (n -1)/4bases a with1 Sa Sn—1. This leads to the following probabilistictest forprimality. Ifn is composite and we choose kbases less thann, the probability thatnpasses the Millertest foreach of 108 Congruences Chap. 4 these bases is at mostG)\". Tosee this,we note thatby Theorem4.21, the probability thata nonprime12 passes the Miller’stest forsome randomlychosenbase a <nis at most (n— 1)/4 _1 n—1 4' Since the events are independent, the probability thatnpasses the Millertest for k arbitrarilychosenbases less thann is at most (3\".Thus, ifevenas fewas 10 basesless than n are randomlychosen, the probability thata nonprimepasses the Millertest to all10 bases isless than9 X10‘7, thatis, the probabilitythatn is nota primeis very nearly zero. EXERCISES 4.4 1. Show that91 is a pseudoprime tobase 3. . Show that368 is a pseudoprime tobases17 and19. 3. Show that161,038 =2- 73- 1103 isa pseudoprime tothebase2. Itturns out that 161,038 is the smallest even pseudoprime tobase 2. 4. Ifn is an odd pseudoprime tobase a, prove thatn is alsoa pseudoprime tobase n — a. 5. Show thatevery composite Fermat number95\", =22’\" +1 isa pseudoprime to the base 2. 6. Ifpis a prime and the Mersenne number M, =2\"—-1 is composite, prove that Mp is a pseudoprime tothebase 2. 7. Prove that ifn isa pseudoprime tobases a andb, itisalsoa pseudoprime tobase ab. 8. Prove that the followingare Carmichael numbers. (a)561=3-11-17 (b)1105=5-13-17 (c) 2821=7- 13-31 (d) 10,585=5-29-73 (e) 15,841 =7- 31- 73 (f)29,341 =13 '37- 61 9. Show that1387 =19- 73 is a pseudoprime but nota strong pseudoprime to base 2. 10. Show that2047 =23- 89 is a strong pseudoprime tobase 2.N Computer Exercises 11. Writea program to determine ifa” Ea (modn), wheren isa ﬁ xed positive integerless thanIt. Ifso, thenIt is eithera prime ora pseudoprime tobase a. In particular, run your program forthe values11 =564,651,361 andn = 1,000,000,009,649. Sec. 4.5 Some Contacts with AbstractAlgebra 109 12. Writea program to determine whether itpasses the Millertest tothebasea. In particular, run yourprogram forn =1,373,653 and a =3. 4.5 SOME CONTACTS WITH ABSTRACT ALGEBRA We close this chapter withsome very briefcomments aboutabstractalgebra. Var- ious subsets ofthe integers and the integers modulom providethe simplestexamples ofthe various mathematicalstructures ofabstractalgebra. The necessary de ﬁ nitionsareas follows. Note that ifS denotesa set and sisan element ofS, we writes ES. For additionalconveniencewe willalsouse thesymbols V andEl forthe phrases “for all”and “there exists,”respectively. DEFINITION4.10. Agroup(g isa set ofelements anda binaryoperationas for combining elements twoata timesuch thatthe followinghold. (i) Closure property.aa: b 6£6 Va, b E 9. (ii) Associative property. (a *b) *c =a *(b *c) Va,b, c E(g, (iii) Existence ofan identity.El e E‘5 such thate *a =a *e =a Va E 9. (iv) Existence ofinverses. Va E‘5El a\"'E 9such thata * a“=a\"1 *a =e. DEFINITION4.11. Ifaa: b =b *a Va, b E g,we say the commutative property is satis ﬁ ed andalso say that$9 is commutative. Note that the operation * may indicate any operation,suchas ordinary multi- plication or addition, multiplication or addition ofmatrices, convolution offunc- tions, andso on. Also,we have used multiplicative notation to indicatethe inverse of an operation withrespect to*. Inadditive situationswe would, ofcourse,use —a in place of a“. Note that theset ofallintegers formsa group withrespect to additionand the same is true oftheset ofall rationalnumbers, theset ofallreal numbers, and theset of all complex numbers. Also,theset ofnonzero rationalnumbers formsa group under multiplication,as does theset ofnonzeroreal numbers and theset ofnonzero complex numbers. Butthese are all in ﬁ nitegroups. Simple examples ofﬁ nitegroupsare provided by theintegers modulom. We have seen that, modulom, thereare effectively onlymelements,0,1, 2,. . . , m — 1. By addition and subtraction modulomwe willmean ordinary additionand subtraction ofintegers withthe result ineachcase replaced by itsleast residue modulo m. Thus, modulo4 we wouldhave 3+2=1and 3-2=2 since 3+ZEl(mod4)and 3-252(mod4). 1 10 Congruences Chap. 4 Complete addition and multiplicationtables modulo4 areas follows,wherea +b modulo4 is found at the intersection ofthea—row and b-column,andso on. + 0 l2 3 0 0 l2 3 O 0 l2 3 0 0O 0 0 l l2 3 0 l0 l2 3 2 2 3 0 l2 0 2 0 2 3 3 0 l2 3 03 21 Since the result ofa +b orab modulo4 is foundby takingtheleast residue modulo4 ofthe usual sum or product, itis clear thatproperties liketheclosure,associative, and commutative properties hold forbothoperations. Moreover,O is the identity for addition and the inverses withrespect to addition ofthe variouselements (now indicated bya minussign) are —0 =0, —l =3, —2 =2, and—3 = l,as is easily checked. Thus, the integers modulo4 forma ﬁ nite commutativegroup offour elements under addition. However, theydo not forma group under multiplication. Clearly,I is the identity for multiplication,and theclosure,associative, and commu- tative laws hold. However, 0‘1 and 2‘1 do notexist. Onthe otherhand, the reader can easily check thatthe integers modulo5 forma ﬁ ve-element commutativegroup under addition, and the nonzero integers modulo5 forma commutative multiplica- tive group offourelements. In general, we have the followingtheorems, whichwe state withoutproof. THEOREM 4.22. Letm >1 be an integer. Then theintegers modulom form a commutative group under addition. THEOREM 4.23. Let pbe a prime. Thenthe nonzerointegers modulo p form a commutative group under multiplication. This leads us to the next de ﬁ nition.Weuse additive and multiplicativenota- tion and language, butany other two binaryoperations woulddo justas well. DEFINITION4.1 2. Let9? be a set withtwo binaryoperations whichwe will call addition and multiplication. If 9isa commutative group under addition, ifthe nonzero elements of9? forma commutative group under multiplicationand iffora, b, c E 9,a(b +c) =ab +ac (i.e., ifthe distributive lawholds), then 9is calleda ﬁ eld. The rationalnumbers forma ﬁ eld,as do thereal numbers andalso the complex numbers. Ofcourse, these ﬁ elds are all in ﬁ nite. For ﬁ niteﬁ eldswe note the follow- ing theorem. Sec. 4.5 Some Contacts with AbstractAlgebra 111 THEOREM 4.24. Ifpisa prime,the integers modulo1) forma ﬁ eld. It turns out thatthere are other ﬁ niteﬁ elds butallhave17 elements forsome prime p and some positive integer rand maybe derived ina special way fromthe integers modulo1). Fordetails, the reader should consultany standard text inab- stract algebra. EXERCISES 4.5ooqaxy- . (a) Form an additiontable forthe integers modulo6. (b) Show thatthe integers modulo6 forma commutativegroup under addition. Be sure to explicitly listthe identityand the additiveinverse ofeach element. . (a) Forma multiplicationtable forthe integers modulo6. (b) Is therea multiplicative identity fortheintegers modulo6? (c) Do the integers modulo6 forma group under multiplication? Why orwhy not? Listthose nonzero integers modulo6 that fail tohave multiplicative inverses. (d) An elementa ofan algebraic system is said tobea divisor ofzero ifthesystem has a zero (i.e., an additive identity), ifa9E 0, and ifthereexists b95 0 inthe system such thatab =0. Listthe divisors ofzero inthesystem ofintegers modulo6 under multiplication. . In the group ofintegers modulo6 under addition,solve the equations2 +x =5 and5 + x =2. In the system integers modulo6, ﬁ nd allsolutions tothe equation 2x—5 =0 and the equation 4x =2. Prove Theorem 4.22. . Prove Theorem 4.23. . Prove Theorem 4.24. . Let9? (p) denote the ﬁ eld ofintegers modulop. If( p, a) =1, show that itis always possible to solve the equation ax +b =c, whereb andc are anyelements of g( p). . Ifa E9? ( p), where 9( p)isas inExercise8 and tis theleast positive integersuch that a‘ =1 in97(1)), prove that t|(p— l). 5 Conditional Congruences If f(a) =0, a is said tobea solution ofthe conditionalequation f(x) =0. Similarly, if f(a) E0 (mod m), a is said tobe a solution ofthe conditionalcongruence f(x) E 0 (mod m). In this chapterwe consider the problem ofﬁ ndingintegral solutions of conditionalcongruences where f(x)isa polynomial withintegralcoef ﬁ cients. Since, by Theorem 4.11,f(a) E f(b) (modm) ifa Eb (modm), itis clear that all the solutions willbe known provided thatwe ﬁ ndallthe solutions inany complete residue system modulom. Thus,unless thereisa special reason fordoingotherwise, we shall list onlythose solutions intheleast residue system 0, l,. . . , m-— 1. Also, ifwe say thata congruencehas rsolutions or rincongruentsolutions,we shall mean that precisely r ofthe numbers inany completeresidue system modulomare solu- tions ofthe congruence. 5.1 LINEAR CONGRUENCES As with equations, the conditionalcongruence f(x) E0 (modm)is said tobe linear in thecase where f(x)isa polynomial ofﬁ rstdegree. Conditions forthe solvability of such congruences are easily given. THEOREM 5.1. The linearcongruence ax Eb (modm)is solvable ifand only if0' lb, where d =(a, m). Ifthereare any solutions, thenthereare precisely d incongruent solutions. 112 Sec. 5.1 Linear Congruences 1 13 ProofSuppose that dlb; then kd =b forsome integer k.Since (I =(a, m), it follows from Theorem 2.4, Section 2.2, thatthere exist integers rands such that d = ar +ms. Multiplyingby k,we obtainb =kd =akr +mks. Therefore, akr E b (mod m) and kris a solution ofthe given congruence. Conversely, suppose thatx0 isa solution ofthe givencongruence. Thenaxo E b (mod m) and there exists an integerq such thataxo -b =qm. Since dla and dlm, this implies that dlb,as claimed. Finally, ifx0 is a solution ofthe given congruence, gaaxoab(modm)a(xo+k7m)=a.xo+km- since dIa. Thus, kmW7 is a solution ofthe given congruence forevery integerk. Moreover, ifx0 and x,are both solutions ofthe congruence, then ax, Eb Eaxo (modm). Therefore, by Theorem 4.6, Section 4.1, x15x0 (mod m/d) and there must exist an integer ksuch that k x1=xo+—m. d Thus, itfollows that ifx0 is a solution ofthe givencongruence, thenx0 +km /disa solution forevery kand thatevery solutionis ofthis form. In view ofthe preceding paragraph, theseries 2m x +(d— 1)m dmm m .,xO_7,xO,x°+7,xO+—d,...,0 d ,xO+—,... contains allsolutions ofthe given congruence. Howmanyare incongruent modulo m? Itis clear thatthe dsolutions m (d—1)m xo,xo+g,. . . ,xo+—d— 1 1 4 Conditional Congruences Chap.5 are incongruent,since no two ofthese can differbya multiple ofm. Moreover, for any k, x0 +km /dis congruent toone ofthese dsolutions modulom. Tosee this, note that for any kthere existq and rwith0 sr <dsuch that k =qd +r. Therefore, km d+r)m xo+—d—=x0+(—q—d—— rm =xo+qm+7 Ex0 +:31 (mod m) and x0 + rm/dis one ofthe foregoing list ofdsolutions. EXAMPLE5.1. Solve 51x E21 (mod36). Solution. Inthe ﬁ rstplace, since51 E15 (mod36), 51x E15x (mod36) for any xand the given congruence canbe replaced by 15x E21 (mod36). Since (15, 36) =3 and 3|21, there mustbe three incongruentsolutions. Indeed, since —1 is obviouslya solution and m/d =12, itfollows fromTheorem5.1 that any number which differs from— lbya multiple of12 isalsoa solution.Thus, the three solutions inthe least residue system 0, l,.. . , 35 are11, 23, and35. If itis notpossible toguess a solution toa linearcongruence, one canuse the Euclidean algorithm and the construction ofthe proof ofTheorem5.1 to obtainthe desired result. For Example5.1, one obtains3 =5- 15— 2- 36,so that21 = 35- 15 — 14- 36. Converting this toa congruence, we obtain35- 15 E 21 (mod 36),so that35 isa solution ofthe givencongruence. The othersolutionsare now foundas before. Another possibility for ﬁ ndingthe solution ofthe given congruenceis toreduce 15XE21 (mod36) to SxE7 (mod12) by Theorem4.6, Section4.1. Withthe congruence in this form, itis not di ﬂ icultto ﬁ nda numberwhose product with5 is congruent to1 modulo12. Inthiscase,5 is the desired numberand multiplication of both sides ofthe congruence by5 yields 25x E35 (mod12). But25 E1 (mod12) and 35 E11 (mod12), so that thisis equivalent to xE11 (mod12). Since this argumentis reversible, x =11 is a solution ofthe given congruence and the other solutions maybe found from thisone,as before. EXAMPLE5.2. Solve 22x E4 (mod30). Solution. A briefsolution ofthiscongruence might lookas follows: Sec. 5.1 Linear Congruences 1 15 22x E4 (mod30), ll2 (mod15), —4XE2 (mod15), —16XE8 (mod15), —XE8 (mod15), xE—8 (mod15). Therefore, the two solutions intheleast residue system 0,1,. . . , 29 are —8 + 15=7and—8+30=22. The preceding methods make itpossible tosolve a host ofinteresting problems in a systematic and e ﬁ icientway. Forexample, consider the followingproblem, proposed by Euler. “Divide100 intotwo positive summandsone ofwhichis divisi- ble by7 and the other by 11.” Obviously, the problemreduces to that ofﬁ nding positive integralvalues of xand ythatsatisfy the equation 7x+11y=100. It is clear that integralvalues x0,y0 satisfying this equation exist ifand only if 7x0 E 100 (mod11) and11 yo E100 (mod7). Thus, the solution ofthe equation 7x +1 1 y =100 inintegers is equivalent tothe solution ofeither ofthecongruences 7x E 100 (mod11) or11 y E100 (mod7). Working withthe lattercongruence because ofits smaller modulus,we obtain 4y E2 (mod7), 8y E 4 (mod7), y E4 (mod7). Thus, possible positive values ofythatsatisfy the originalequationare 4,11, l 8,. . . . Computing the correspondingvalues of xfromthe originalequation,we obtain8,— 3,— 14,. . . . Thus, the only solution inpositiveintegers isx =8, y =4 and the desired summandsare 56 and44. In general, an equation tobe solved inintegersis calleda Diophantineequation after the Greek mathematician Diophantus ofAlexandria, who livedabout AD.250. The preceding argument, whichis essentially general, shows thatthe solution ofthe linear Diophantine equation ax +by =r is equivalent to the solution ofeither ofthecongruences ax E r(modb) or by E r(moda). By Theorem5.1, we know that solutionis possible ifand only ifd| r, where d =(a,b). 1 16 Conditional Congruences Chap.5 Also, ifx0 is any solution ofax E r(modb), thenevery solutionis given by kb xk =X0 + 7. Moreover, the yvalue corresponding toeach xvalue canbe computed from ax + by =r. Therefore, r—ax Yo:b0 and foreach k, r—ax yk= bk = r— a(xo + kb/d) b _w_ ﬂ b d = -E yo (1. Thus, we have proved the followingtheorem. THEOREM 5.2. The linear Diophantineequation ax +by =ris solvable (in integers) ifand only ifd|r, where d =(a, b). Ifx0,yo is any solution,thenevery solution is given by xk x0 d9 ykyO d, wherek=0,il,i2,. . .. EXERCISES 5.1 1. Solve the following conditionalcongruences. (a) 25x 54 (mod11) (b) 15x E3 (mod9) (c) 34xE60 (mod 98) (d) 35xE15 (mod182) 2. Find all integral solutions ofthe equation 15x +7y =110. 3. A farmer buys100 birds for$100. Ifchickscost50 centseach, ducks$3 each, turkeys $10 each, and the farmer obtained atleast one bird ofeach type, how many ofeach type did the farmerbuy? Sec. 5.2 The Chinese Remainder Theorem 117 4. Whena mancasheda check, the clerk mistookthe number ofcents forthe number ofdollars, and viceversa. Afterspending68 cents, the mandiscovered that he stillhad precisely twiceas much moneyas the amount forwhichthe check was originally written. Whatis the smallest amount forwhichthecheck could have been written? 5. Find all solutions, inintegers, of17x— 11 y =272. 6. Prove that ax +by +cz =ris solvable inintegers ifand only ifdlr,where d =(a, b, c). 7. Finda solution inintegers of48x +17y— 662 =9. 8. Note thatthe general solution tothegeneral linear Diophantineequation intwo variables,as indicated inTheorem5.2, containsone arbitraryconstant. Itis not surprising thatthe general solution tothe linear Diophantineequation inthree variables contains two arbitraryconstants. Finda general solution inintegers to 21x+13y— 22=7. 9. If(a, m) =1, then(14’0\") E1 (mod m) bythe Euler-Fermattheorem. There- fore, to solve ax Eb (mod m),one can multiplybothsides ofthe congruence by a‘bW\", obtaining Use this method tosolve 77x 528 (mod36). 10. Use the method ofExercise9 tosolve 77x 514 (mod105). Hint: Firstuse Theorem4.6. Computer Exercises 11. Writea program to ﬁ ndthe general solution tothegeneral linear Diophantine equation ax +by =c. 12. Writea program to ﬁ nd all solutions intheleast residue system modulom tothe general linearcongruence ax Eb (modm). 5.2 THE CHINESE REMAINDER THEOREM Ifthe modulus ofa conditionalcongruence is composite, solution ofthe congruence is frequently made easier by factoringthe modulus intoa product offactors thatare pairwise relatively prime and solvinga system ofsimplercongruences inplace ofthe single given congruence. The followingtheoremgives the details ofthe method. THEOREM5.3. Ifm =115.1 miand (mi, mi) = lforiaéj,1 S isr, and l S jS r, then any solution of f(x) E0 (mod m)isa simultaneous solution ofthe system 1 1 8 Conditional Congruences Chap.5 f(x) E0 (mod\"11), f(X) E0 (mod\"12), f(X) E0 (modmy), and conversely. ProofSuppose that f(x0) E0 (modm). Then,since mi|m, itis clear that f(x0) E 0 (mod m,-) foreach i. Thus, any solution of f(x) E0 (modm)isa solution of the system. Now,suppose that f(x0) E0 (modm,-) foreach i,so thatx0 isa solution ofthe system. Then,since (m,, m) =1 for iE j,itfollows from Corollary4.10, Section 4.1, that f(x0) E0 (mod m) and x0 isa solution ofthe givencongruence. In theorem 5.3, the question leftunansweredis: Howdoes one ﬁ ndthe solution to the system ofcongruences involved? Thiscanbe accomplished by ﬁ rstsolv- ing each congruence ofthe system separately, thus ﬁ ndingx,- such that f(xi) E 0 (mod m i) foreach i, and then ﬁ ndinga solutionx0 tothesystem xE x,(modm1), x Ex2 (modm2), (5.1) xE x,(mod m,). Then, since x0 E x, (mod mi) foreach i, f(Xo) Ef(x.-) E0 (mod m.) for each iand x0 isa solution ofthesystem ofTheorem5.3. The problemis ultimately reduced, therefore, to that ofsolving the linearsystem (5.1). Differently put, the problem ofsolving the precedingsystem oflinearcon- gruences is essentially that ofﬁ ndingan integer xthatleavesa remainder ofx]when divided by m1, x2 when divided bym2,. . . , and x,when dividedby m,.Such problems were studied in antiquity, particularlyby ancientChinese mathematicians, so the theorem thatgives the solutionprocess is called the Chinese remainder theorem. THEOREM 5.4. (TheChinese Remainder Theorem). If(m,, mj) =l for i E j,then the system xE cl (modm1), xEc2 (modm2), .........., xE6, (mod m,), is solvable and the solutionis unique modulom, where m =I'LL,m,-. Sec. 5.2 The Chinese Remainder Theorem 1 19 Proof. Let M, = m/m,foreach1'. Then, mlifor i Ej.Also, (m,, M,) =1 by Theorem 2.12, Section 2.3, since (m,, m,) =1 for i Ej.Since (mi, M,) =1, the congruence MiyEl(mod mi) has a solutionb,- foreach1'. Thatis, foreach ithereexistsb,- such that Mib, E1 (mod mi). Setx0 = 2i=lc,-M,-b,-. Thenx0 Ec,- (modm,-) foreach isince ciMib, Ec,- (mod mi)and M,- E0 (mod m,) for jEi. Thus,x0isa solution ofthe system. Now, suppose that x1 and x0are any two solutions ofthesystem. Then xlEc,- Ex0 (mod mi) and since (m,, m,) = lfor iE j,itfollows from Corollary4.10, Section4.1, that x1 E x0 (mod m). Therefore, ifa solutionexists, itis unique modulom. The preceding proof ofthe Chinese remainder theoremis constructiveand, therefore, providesa method forsolvinga system ofcongruences. EXAMPLE5.3. Find the simultaneous solution ofthe system x E1 (mod2), xE2 (mod3), xE1 (mod5), and xE5 (mod7). Solution1. Herewe have ml=2, M1=105, 61:1, \"12:3, M2:70, C2=2, ”13:5, M3:42, 63:1, \"14:7, M4:30, (34:5, and we must solve M,- yE1 (mod m,) foreach i. The ﬁ rstcongruence,105 y E 1 (mod 2), reduces to yE1 (mod2),so bl =1. Similarly, 70yE1 (mod3) re- duces to y E1 (mod3), so b2 =1 also. 42y E1 (mod5) reduces to 2y E 1 (mod 5) and b, =3. Finally, 30y E1 (mod7) reduces to 2yE1 (mod7) and b4 =4. Thus, the desired solutionis 4 x0 = 2CibiMi =971. i=1 This solutionis unique modulo210 =2- 3- 5- 7. Therefore, any other solution differs from971 bysome multiple of210, andconversely, any number thatdiffers from 971 bya multiple of210 isa solution. Forexample, theleast positive solution would be 131 =971—4- 210. An alternative and easier solution ofthis problem runsas follows. Solution2. Itis clear that x =1 isa solution ofthe ﬁ rstand thirdcongruences ofthe system. Also,since the solution ofthese twocongruences is unique modulo10 1 20 Conditional Congruences Chap.5 by the Chinese remainder theorem, any other solution mustbe ofthe form1 +10y for some integer y. Now,a number ofthis form willalso bea solution of xE 2 (mod 3), provided that 1+10y E2 (mod3). Solving this congruence fory, we obtain 10y E1 (mod3), y E1 (mod3). Thus,1 +10 y =11 is a solution ofthe ﬁ rstthreecongruences ofthesystem. Since the solution ofthese congruences is unqiue modulo30,11 +302satis ﬁ es the ﬁ rst three congruences forany integer2. Hence, to ﬁ nda solution tothe completesystem, we seek 2 such that 11+30z E5 (mod7). We have 302 E—6 (mod7), 22 E—6 (mod7), 2E—3 E4(mod7). Thus,11 +302 =131 isa solution ofthesystem and any other solutionis congruent to this one modulo210. The Chinese remainder theoremis a specialcase ofthe followingresult, which we state withoutproof. THEOREM 5.5. Thesystem xE61 (mod m,), xEc2 (modm2), x-E-c; {1508'a is solvable ifand only if(m,,mj)|(c,~— c,) foreach iand jwithi= ﬁ j.Ifthereisa solution, itis unique modulo m =[m1, m2,. . . , m,]. EXAMPLE5.4. Find the solution ofthesystem xE1 (mod2), x E 2 (mod3), x E1(mod5), xE5 (mod7), xE2 (mod9). Solution. Thissystem, whichdiffers fromtheone ofExample5.3 only inthe addition ofthe congruence xE2 (mod9), clearlysatis ﬁ es the conditions of Theorem 5.5. Thus, ithas a unique solution modulo630, theleast common multiple of the moduli involved. From Example5.3 we have thatany number ofthe form Sec. 5.2 The Chinese Remainder Theorem 121 131 + 210y satis ﬁ es the ﬁ rst fourcongruences ofthesystem. Therefore, itis only necessary to ﬁ nd ysuch that 131+ 210y E2 (mod9). This reduces to 3y E— 3 (mod9) and y =— lis an obvious solution. Thus,131— 210 =— 79 is a solution ofthe given system. The least positive solutionis —79 +630 =551. EXAMPLE5.5. Find the solution ofthe system SxE2 (mod3), 2x E 4 (mod10), 4x E7 (mod9). Solution1. Neither Theorem5.4 nor5.5 applies directly tothesystemas given. However, the general remarks about solution ofsystems thatpreceded the Chinese remainder theorem do apply. Accordingly,we ﬁ rstsolveeach congruence separately, obtaining1 as a solution ofthe ﬁ rstcongruence,2 and7as incongruent solutions ofthe second congruence, and4as the solution ofthelast. Now,using the Chinese remainder theorem,we solve the twosystems x E1 (mod3), xE1 (mod3), x E 2 (mod10), and xE7 (mod10), x E 4 (mod9), xE4 (mod9). The pointis thateach ofthe twosolutions ofthesecond congruence, when paired with the solutions ofthe othercongruences, yieldsa separate solution ofthe original system modulo90. The workis easily ﬁ nished,as inthe precedingexamples, and the solutions are 22 and 67. These solutionsare unique modulo90. Solution2. Solving thecongruences sequentiallyas inExample5.3, Solution 2, we proceedas follows. Clearly, x =1 isa solution to 5xE2 (mod3) andevery solution is ofthe form1 +3y. Nowseek yso that1 +3yisa solution to 4xE 7 (mod 9). Thisgives 4(1+By) E7 (mod9), 12y E3 (mod9), 4y E1 (mod3), y E1 (mod3), so that l and4 are solutions modulo9. Butthen1 +3yyields4 and13, both of which are congruent to4 modulo9. Thus, allsolutions tothese congruencesare of the form 4 +92. Finally,weseek 2 so that4 +92isa solution to 2xE4 (mod10). This gives 122 Conditional Congruences Chap.5 2(4 +92) E4 (mod10), 182 E—4 (mod10), 92 E—2 (mod5), -—z E—2 (mod5). Thus, the solutions modulo10 are2 and7. Thus,4 +92 yields the solutions22 and 67 to the entire system andthese solutionsare unique modulo90. EXERCISES 5.2 1. Find the least positive integer thatleaves remainders of2,3, and2 when divided by 3, 5, and7, respectively. 2. Find the integer xsuch that—2310 S xS2310, and xE1 (mod21), xE2 (mod20), x E3 (mod11). 3. Find the least positive integer thatleaves remainders of1, 1, 4, and3 when divided by2, 3, 5, and4, respectively. 4. Find the solution ofthesystem 3x E7 (mod5), xE1 (mod4), 5xE2 (mod11). 5. Solve the system 2x E5 (mod7), 4x E2 (mod6), x E3 (mod5). There willbe two incongruent solutions modulo210 =[7,6, 5]; ﬁ nd both of them. 6. Solve the followingcongruences using the method ofTheorem5.3 etseq. Note that there are six incongruent solutions ofpart(d). (a) 371x E287 (mod 460) (b) 2837xE1601 (mod1710) (c) 1663x E2571 (mod7735) (d) 606XE138 (mod1710) Sec. 5.2 The Chinese Remainder Theorem 123 7. 10. ll. 12. 13. 14. 15. Let f(x)be a polynomial withintegralcoe ﬂ icients. If f(l)E 0 (mod2), f(2)E 0 (mod3), f(3)E0 (mod4), and f(4) E 0 (mod5), ﬁ nda solution ofthe congruence f(x)-=- 0 (mod60). . Find ﬁ ve consecutive positive integers such thatthe ﬁ rstis divisibleby2, the second is divisible by3, the thirdis divisible by5, the fourthis divisible by7, and the ﬁ fthis divisible by11. Suggestion: Use the Chinese remaindertheorem. . Prove that forany positive integer11, there existn consecutive positiveintegers a1, a2,. . . , an such thatp,|a,- foreach i,where1),- denotes the ithprime. Recall thatan integeris said tobe square-free ifitis notdivisibleby thesquare of any prime. Prove that forany positive integern, there exist it consecutive nonsquare-free positiveintegers. Generalize Exercise10 to apply to kthpowers instead ofsquares. Prove Theorem5.5 forthecase r =2. If f(x) 50 (mod mi)hasn,- solutions modulom,- for i=1, 2,.. . , r, where m1, m2,. . . , m,are pairwise relatively prime,prove thatthesystem f(X) E0 (modm1), f(x) E0 (modm2), f(x) 50 (mod mr) has n = I'LL,n, solutions modulo m = HLImi. Find all solutions to thesystem 3x2 + 6x+5 '=' 0 (mod7), 7x+4—=— 0 (mod13) which are incongruent modulo91. Hint:Since the ﬁ rst modulusis small, solutions tothe ﬁ rstcongruenceare easily found by checking the values 0, i1, i2,and i3. Laterwe discuss systematic methods for solving quadraticcongruences. Computer Exercise Writea program for implementingtheChinese remaindertheorem. 1 24 Conditional Congruences Chap.5 5.3 POLYNOMIAL CONGRUENCESOF DEGREE GREATER THAN1 Throughout this section, f(x) willdenotea polynomial ofdegreen 22 withinteger coef ﬁ cients. Ourpurpose is todevelop methods forsolving the conditionalcon- gruence f(x) E0 (mod m), where m =Hf=lp?“ with(1,21 foreach iis the canoni- cal representation ofm. Ifwe setm,- =f‘i for i=1, 2,. . . , r, itis clear fromTheorem5.3 thatthe solution of f(x) E0 (mod m)is equivalent tothe solution ofthesystem f(X) E0 (mod pi“), f(X) E 0 (mod11?), ..........., f(X) E0 (mod1\",”). We have alreadyseen thatthe solution ofsuch a system canbe e ﬂ 'ected bysolving each ofthe congruences separately, and then using theChinese remaindertheorem. Thus, the problem reduces to that ofsolvingcongruences ofthe form f(x) E 0 (mod p“).The next two theorems show how thiscanbe accomplished. LEMMA5.6. If f(x) =22-0 akx\"isa polynomial withintegralcoef ﬁ cients, then f(a +b) =f(a) +bf’(a) +bzq, where a, b, and q are integers and f’(a) = ikakak“. k-l Proof. By the binomialtheorem, for k >1, (a +b)\" =a\" + kba\"’l +bzqk, where \" k. . 4k: 2( )ak—s—z i-2 ’ is an integer depending ona, b, and k. Therefore, n f(a +b) = 2ak(a +b)\" k=0 = 2ak(a\" +kbak‘l +bzqk) +a,(a +b) +a0 k=2 = 1;) (1k+b kg] kakak_l +b2 ’22 (1q =f(a) +bf’(a) +bzq, where q = 2L2 aqis an integersince ak andqk are integers foreach k. Sec. 5.3 Polynomial Congruences ofDegree GreaterThan1 125 THEOREM 5.7. Let f(x)be a polynomial withintegralcoef ﬁ cients, let pbe a prime, and let aE2 be an integer. Thenx0 isa solution of f(x) E0 (mod p\") if and only if xo =a + yaw“, where a is a solution of f(x) E0 (mod 12“\")andyo isa solution of g+yf’(a) E0 (mod I”- Itsuf ﬁ ces to take 0 Sa <p\"“1and0 Eyo <p. Proof Since p“\"|p°‘, itfollows that ifx0 is a solution of f(x) E0 (mod p“), itis also a solution of f(x) E0 (mod p““).Therefore, 9‘0 =a +.VoPaH, where a is asolution of f(x) E0 (mod p“\"),0 Ea <12““,andyo is an integer,since every solution of f(x)E0 (mod p“\")can be represented inthisway. Now, a + yop‘”lwillbe a solution of f(x)E0 (mod1)“) ifand only iff(a+yop‘z‘l)E 0 (mod p“).By Lemma5.6, f(a + yep“)=f(a) + yap“\"f’(a)+qyépza‘z, where q is an integer and 2a— 2 Eor since aE2. Thus,a + yop“\"isa solution of f(x) E 0 (mod p“) ifand only if f(a) +yopa‘1f’(a) +qytuvz‘r2 E0 (mod p“). Since 172°” E0 (mod p“),thisreduces to f(a) + yopa\"f’(a)E0 (mod p“). Also, since f(a) E0 (mod p““),p““‘| f(a). Thus, by Theorem4.6, Section4.1,we obtain £591 +Yof’(a) E0 (modp). Since the last twosteps are reversible, we have thata +yopa“lisa solution of f(x E 0 (mod p“) ifand only ifyo is a solution of f(a) pat—l+)g\"(a) E0 (mod1)). By Theorem 5.1, this congruence willhave pincongruent solutions modulo p if pl f’ (a) and pal f(a), one incongruent solution modulo p ifp f f’(a), and no solution if plf’(a)and p“ ”(60-. Finally, ify0 is an admissible value ofy, thenso1s yo +kp foranyk. However, a +(yo +kph)\"—l =a + yop““‘ +kp\"Ea +yopm‘l (mod p“), 1 26 Conditional Congruences Chap.5 so yo +kp yields thesame solution modulo1)“as yo. Thus, itsu ﬂ ices totake 0 S yo <p. EXAMPLE5.6. Find allsolutions ofx3— x2 +7x +1 E0 (mod8). Solution. Ofcourse, withsucha small modulusthe simplest procedure would be to tryeach ofthe numbers inthe completeresidue system— 3,— 2,— 1, 0,1, 2,3, 4 in the given congruence. Inthisway, one quicklyﬁ nds thatthe solutionsare— 3,— 1, 1, and 3, or thatthe least positive solutionsare l,3, 5, and7. However, itwillbe instructive touse the method ofTheorem5.7. Using the theoremrepeatedly,we ﬁ rst ﬁ nd the solution(s) of f(x) E0 (mod2), thenthose of f(x) E0 (mod4), and ﬁ nally those off(x)E0 (mod8), wheref(x) =x3— x2 +7x +1. (i) Itis clear that x =1 is the only solution to f(x) E0 (mod2). (ii) To ﬁ nd the solutions to f(x) E0 (mod4), weuse Theorem5.7 with p =2, a =2, and a =1. Thus, a +yopa“l =1 +2yo willbe a solution, provided thatyo is a solution of f—(21)+yf’(l)=0 (mod2). Sincef(1) =8 andf’(l) =8, we mustsolve 4 +8y E0(mod2). Clearly, y =O and y = lare both solutions andthese yield thetwo solutions1 and3 of f(x) E 0 (mod4). We must nowcheckeach ofthese solutions tosee ifitgeneratesa solution of f(x) E0 (mod8). (iii) First, take a = l,p =2, a =3. Then a + Yopa_l=1 +4yo is a solution of f(x) E0 (mod8), provided thatyo isa solution of f—-(41) +yf’(1)==0 (mod2). This reduces to 2+8yE0(mod2), and again y =0 and y = lare bothsolutions.These yield1 and5 as solutions to f(x) E 0 (mod8). Finally, taking a =3, a + yopa“ =3 +4yo is a solution of f(x) E0 (mod8), provided thatyo isa solution of f—(43) + )f’(3)==0 (mod2). Sec. 5.3 Polynomial Congruences ofDegree Greater Than1 127 Since f(3) =40 and f’(3) =28, the congruence inquestionbecomes 10 +28y E0 (mod2) with y =0 and y =1 as solutions. These yield3 and7as solutions of f(x)E 0 (mod 8). EXAMPLE5.7. Find allsolutions ofx3— x2 +7x + lE0 (mod200). Solution. Since 200 =23- 52, weseek the solution tothesystem f(X) E0 (mod8), f(x)E 0 (mod25), where f(x)=x3-x2+7x+1. In Example 5.6 we found that1, 3, 5, and7 are the solutions of f(x)E0 (mod8). In the same way, one can determine that23 is the only solution of f(x)E 0 (mod25). It follows that the solutions ofthe originalsystem are found byusing theChinese remainder theorem tosolve the fourseparate systems x E1 (mod8), xE3 (mod8), x E 23 (mod 25), xE23 (mod25), x E5 (mod8), xE7 (mod8), x E 23 (mod25), xE23 (mod25). The values 23, 73, 123, and173 thatresultare thedesired solutions ofthe given congruence, f(x) E0 (mod200). The preceding discussion shows thatthe problem ofsolving the polynomial congruence f(xE 0 (mod m) can be reduced to that ofsolving f(x) E0 (mod p), where pis a prime. If f(x)is ofdegree n 2p, further simpli ﬁ cation ofthe problemis possible since f(x)can be replaced bya polynomial ofdegree at most p— 1. Tosee 1 28 Conditional Congruences Chap.5 that this is so, we divide f(x) by x”— x, obtaining polynomials q(x)and r(x) with integral coef ﬁ cients, where r(x)is ofdegree at most p— 1, andsuch that f(x) =40006” -x) +r06)- Since a” E a (mod p) by Fermat’s theorem, itfollows that f(a)E r(a) (mod p) for any integer(1. Therefore, f(a) E0 (mod p) ifand only ifr(a) E0 (mod p)and one need only consider the simplercongruence r(x) E0 (modp). EXERCISES 5.3 l.Solve: (a) 5x3 -2x + lE0 (mod343) (b) 5x3 -2x +1 E0 (mod25) (c) 5x3-— 2x + lE0 (mod8575) 2. Solve 2x9 +2x6— x5— 2x2 -xE0 (mod5). . Solve x3— 3x2 +27 E0 (mod1125). 4. Solve the systemc» 5x2+4x-3EO(mod6), 3x2 +10 E0 (mod17). 5. Ifa is an integer and f(x)is a polynomial withintegralcoe ﬂ icients, prove that f(a) E r (mod m), where ris the remainder obtained when f(x)is divided by x - a. 6. If f(x)is a polynomial ofdegree n withintegralcoe ﬁ icients anda isan integer such that f(a) E0 (mod m), prove thatthereexists a polynomialq(x) ofdegree n —1 such that f(x) E (x— a)q(x) (modm). 7. In Exercise 6, let m =p, where pisa prime.Prove thatsolutions of f(x) 0 (mod p) whichare notcongruent toa modulo pare also solutions ofq(x) 0 (mod p). 8. If f(x) and q(x)are polynomials withintegralcoe ﬂ icients f(Z)E5 (mod7) and f(3)E2 (mod7), determinea linear polynomial r(x)such that f(x) E (x -2)(x -mm+r(x)(mod7) for integral values ofx. Sec. 5.4 Theorems ofLagrange and Wilson 129 9. Let f(x) and g(x)be polynomials withintegralcoe ﬂ icients and havingdegree h and k, respectively. Let pbe a prime withh +k =pand f(x)g(x) E x”— x (mod p). Prove that f(x)has preciselyh incongruentsolutions modulo p and g(x)has precisely kincongruent solutions modulop. 10. Ifpis a prime and d|( p— 1), prove that xd—1 E0 (modp)has precisely d incongruent solutions modulop. Computer Exercises 11. Note that ax4+bx3+ cx2+dx+ e=x(x[x(ax+b)+c] +d}+e and writea computer program toevaluate any polynomialfunction. Note that, for the polynomialabove, the computation a*x*x*x*x+b*x*x*x+c*x*x+d*x+e requires10 multiplicationsand fouradditions,whereas the computation forthe right-hand side ofthe equation requires only four multiplicationsand four additions. 12. Writea computer program tosolve thegeneral polynomialcongruence with integer coe ﬁ icients. 5.4 THEOREMS OF LAGRANGE AND WILSON Unlike polynomialequations, polynomialcongruences ofdegreen frequentlyhave more than n incongruentsolutions. Thus, the linearcongruences ofExamples5.1 and 5.2 had three and two incongruentsolutions, respectively, and the cubiccon- gruence ofExamples 5.6 and5.7 had fourincongruentsolutions ineachcase. Onthe other hand, ifpisa prime, then the linearcongruence ab(modp) has one and onlyone solution,except inthe trivialcase when plaand plb.As the following theoremshows, this situationis typical ofcongruences withprime moduli. This theorem is the work ofthe eminentFrench mathematicianJ. L.Lagrange (1736—1813). THEOREM 5.8. (Lagrange’s Theorem). Ifp isaprimeand f(x) =2;;0a ,x’ is a polynomial ofdegree n 21 withintegralcoef ﬁ cients and withanaé 0 (modp), then f(x) E0 (mod p)has at mostn incongruentsolutions modulop. Proof Forn =1, we havef(x) =a1x+do with alEF 0 (modp), sof(x)E 0 (mod p)has one and onlyone solution, by Theorem5.1. Assume thatthe claim ofTheorem5.8 is true forany polynomial ofthespeci- 130 Conditional Congruences Chap.5 ﬁ ed type ofdegree k 21. Suppose that f(x)is ofdegree k +1 andhas atleast k +2 incongruent solutions modulop. Lets be one ofthese solutions. Then f(X) =(x -S) '(106) +r, where ris an integer and q(x)is a polynomial ofdegree kwithintegralcoef ﬁ cients. Also, the leading coefficient ofq(x)isak+1 and akH E0 (modp).Since q(x)isa polynomial ofdegree k ofthe speci ﬁ ed type, ithas, bythe inductionassumption,at most k incongruent roots modulop. However, (3 -S)- q(S) + rEf(S) E0 (mod1)). so r E 0 (mod p). Therefore, forany x,we have fromthe equationabove that (x -S)- q(X) Ef(X)(mod17). From this itfollows that iftis any one ofthe incongruentsolutions ofthe congruence f(x) E 0 (mod1)) other thans, then (I -S)° 40) EN)E0 (mod12). Since I E3 (mod p), this implies that W)E0 (mod p) so that tis a solution ofq(x) E0 (modp). But tcanbe anyone ofthe incongruent solutions of f(x) E0 (mod p) other thans. Sincethese are atleast k +1 innumber, this contradicts the fact that q(x) E0 (mod p)hasas most ksolutions. Therefore, the assumption that f(x)has atleast k +2 incongruentsolutions modulo pmustbe false. As a corollary toLagrange’s theorem, itis possible todeduce another important theorem whichgives a necessary condition that pbea prime. The resultis ascribed to John Wilson by Edward Waring inhis MeditationesAlgebraicae published in1770, and itis stillcalled Wilson’s theorem. However, the ﬁ rst proofwas given by La- grange, also in1770(see Exercise 22 ofSection 4.1). THEOREM 5.9. (Wilson’s Theorem). Ifpisa prime, then (p— 1)! E—1 (modp). Proof Let p—l f(X)= H (x- i)-06\"”1— 1) i=1 =Cp_2xp—2+cp_3xp—3+' ' ' +C1x+CO. In view ofFermat’s theorem, itis clear that f(x) E0 (mod p)has the p—1 incon- gruent solutions1, 2,. .. , p— 1. ButthisviolatesLagrange’s theoremunless Sec. 5.4 Theorems ofLagrange and Wilson cp_2 E cp-3 E- - - E61 Ec0 E0 (modp). Therefore, forany integer x, ”1:11 (x—i)--(x\"‘l -1)E0(modp) i=1 and 11:11 (x-i)Exp—i _1 (mod1?)- i=1 Setting x =p, we obtain ([7 —1)!E \"1(m0dp) and the theorem is proved. EXERCISES 5.4 l.Prove the converse ofWilson’s theorem. 2. pis a prime andh + k=p— 1, prove that h!k! E(—1)\"+1 (modp). 131 Hint: Notethatp— l E—l (modp),p—2E-2(modp),. . . ,(p—k)E —k (mod p) anduse Wilson’s theorem. . Ifp is an odd prime,show that s1 (mod p)has precisely two incongruent solutions modulo p. . Ifpis a prime and p 25, use Theorem5.1 and the result ofExercise3 toshow that the members oftheset S ={2,3,. . . , p -2}canbe grouped intopairsa, b such thata Eb (mod p) and ab E1 (modp). . For p 25, itfollows fromExercise4 that1153.32 iE1 (modp).Use this fact to derive an alternative proof ofWilson’s theorem. Note that p =2 and p =3 must be handled separatelyas specialcases. . Let theset T={(11, a2,. . . , (law) witha,- <a,+1 foreach ibe the reduced residue system selected from among theleast residue system modulom. Thus, 0 < a, <m and((1,, m)—— l foreach1 Prove that Him”a,- E +1(modm). Suggestion: Carefully review the proof ofWilson’s theorem contained1n Exer- cises 3 through5. Itwas found thatexcept for1 and p— 1, the elements ofthe reduced residue system1, 2,. . . , p—1 couldbe grouped intopairsa, b such thata Eb (modp)and ab\"1 (modp).Since1 (p—1) E—l(modp), it followed that115:11 iE—-1 (modp). Ifa——1 or a=p— 1, there stillexistsb such thatab E1 (mod p), but1n each ofthesecases b—— a. Adjustthis proofto ﬁ t the present situation.Use Theorem5.1 toshow that foreach ithereexists j such that aiajE1 (modm). If jEi, thereis no dif ﬁ culty. If j=i, thena? E 1 (mod m) and, byExercise3 ofSection 4.3, a311(m)—i+l =(m _002 E1 (modm). 1 32 Conditional Congruences Chap.5 Therefore, forthe pair(1,, “aim—mwe have that ai“¢(m)—i+1 =“Km \"at) E ’0?E—1 (modm). Fill in the details and make the desired conclusion. 7. Ifpis an odd prime and a 2 lis an integer, prove thatx2 E1 (mod1)\")has precisely two incongruent solutions p“. Hint: From x2 E1 (mod p“) itfollows that (x— l)(x +1) E0 (mod p“). 8. Prove that x2 E1 (mod 2‘”)has one incongruent solution modulo 2“ ifa =1, two incongruent solutions modulo 2“ ifa =2, and fourincongruentsolutions modulo 2“ ifais an integergreater than2. Suggestion: Use mathematical induction toshow thatthe solutionsare1, 2““1— 1, 2\"“1 +1, and 2“—1 fora 23. 9. Ifm =2\"“p‘ftl- - - g“, witha,- 21 andp,- an odd prime foreach i,is the canoni- cal representation ofm, prove thatx2 E1 (modm)has 2 ’incongruentsolutions modulo m ifa =0 or a =1, 2’+lincongruentsolutions modulom ifa =2, and 2’+2 incongruent solutions modulom ifais an integer and a >2. 10. Let T ={a1, a2,. . . , can»)as inExercise6. Deduce fromExercises6 through9thatl'l ﬂ ’f\"a, E -1(modm) ifm =4, m =p°‘, orm =2p“,wherepis an odd prime, and that11223;\" a, E1 (modm) ifmis any otherpositiveinteger. This generalization ofWilson’s theoremis due toGauss. 11. Show thatx2 E -1(mod2)has a solution. 12. Let pbe an odd prime and deduce fromExercise 2 thatx2 E—1 (mod p)is solvable ifp E1 (mod4). 13. Ifpis an odd prime,use Fermat’s theorem toshow thatx2 E—1 (mod1)) hasa solution only ifp E1 (mod4). 14. Use the results ofExercises12 and13 toprove that forn >1, allodd prime divisors ofn2 +1 are ofthe form 4k +1. 15. In Theorem 3.3, we proved thattherewere in ﬁ nitelymany primes ofthe form 4k— 1. InExercise3 ofSection 3.2 the readerwas asked toshow whya similar effort to prove thatthereare in ﬁ nitelymany primes ofthe form 4k +1 must fail. Modify this method ofproofand, using the result ofExercise14, show thatthere are in ﬁ nitely many primes ofthe form 4k +1. 16. Ifp is an odd prime, prove that 12 . 32. . . (p_2)2522. 42. . . (p_1)2E(__1)(p+1)/2 (modp). 17. By Exercise5 ofSection 5.3, if f(a) E0 (modp), then f(X) E (x -a)q(x) (modp), where f(x) and q(x)are polynomials withintegralcoe ﬂ icients.Usethese ideas and the fact that1, 2,. .. , p—1 are allroots ofthe polynomialcongruence Sec. 5.5 Quadratic Congruences 1 33 x1\"1—1 E0 (mod p) toprove that x!\"1—1 E(x— l)(x—2)-- - (x—p+1) (modp) and hence again deduce Wilson’s theorem. Computer Exercise 18. Exercise10 above andExercise 26 ofSection 4.3suggest that2111?)a,- may yield an interestingleast residue modulom. Writea computer program tosee ifyou can discovera theorem. 5.5 QUADRATIC CONGRUENCES Suppose thatwe want tosolve the quadraticcongruence ax2+bx+CE0(modm). As we have seen inthe generalcase, the solution ofsucha problem ultimately depends on the solution ofcongruences ofthe form ax2+bx+CEO(modp), where pis a prime. Forsmallvalues ofp,such congruencesare easily solved by trial and error. But, ifpis verylarge, more sophisticated methods willbe needed. Suppose, then, that pis odd and that(a, p) =1. Since (4, p) =1, itfollows that (4a,1)) =1. Therefore, the solution ofax2 +bx +c E0 (modp)is equivalent to the solution of4azx2 +4abx +4ac E0 (modp), whichcan be rewritten inthe form (2ax +b)2 E(b2—- 4ac) (modp). Thiscongruence canbe solved ifand only if we can ﬁ nd an integerx0 thatisa solution ofZax +b Eyo (modp),whereyo isa solution ofy2 Eb2— 4ac (modp).Since (2a, p) =1, the ﬁ rst ofthese congruences is always solvable. Thus, the solutiondepends on the solvability ofa congruence of the form y2 E k (mod17). IfkE0 (modp), the congruence is triviallysolvable. Before we consider thecase kE0 (modp),we note whatcan be done already with the tools at hand. Ifa =b, then certainlya Eb (modm). Thus, the usual methods ofalgebra apply to the solution ofquadratic and other polynomialcongruences except, of course, that division may notbe possible, and when itis, itis oftenaccomplished by multiplying by the multiplicativeinverse ofa number modulom. Also,as noted above, itis notalways clear ifa number khas a square rootmodulomor, ifitdoes, what the square root ofkis. Nevertheless, combining ourknowledge ofcongruences with our knowledge ofsolutionmethods fromalgebra canbe quiteeffective. EXAMPLE5.8. Ifthey exist, ﬁ ndthe solutions of 3x2+x+3 E 0 (mod17). 1 34 Conditional Congruences Chap.5 Solution1. We have the followingseries ofcongruences all modulo17. 3x2 + x +3 E0, 18x2 + 6x+18 E0, x2+6x E—l, x2+6x+ 9E8, (x+3)2525, x+3Ei5, x5-8,2or x52,9. Solution2. In Solution1 weused properties ofcongruence and the method of completing the square to ﬁ nd the solutions. We couldhaveused the quadratic formula appropriately modi ﬁ ed totakecare ofthe divisioninvolved. Noting that 3- 6 =18 E1 (mod17), itfollows that 6‘1 E3 (mod17). Thus,we have x56\"(—1-|_- J1-36) s3(—1:J—35). The dif ﬁ cultycomes in ﬁ nding4— 35 modulo17 ifitexists. However, adding17 repeatedly to -35, we ﬁ nd that—35 E16 (mod17), so xs3(—1i7i6)s3(—1:4)E~15,922,9(mod17), as before. Ofcourse, if—35 inExample5.8 had had nosquare root modulo17, no solution to the given congruence wouldhave existed. Thisleads us toconsider more closely the question ofwhena given integerisa square moduloa prime pso that it does have a square root modulop. DEFINITION5.1. Let pbe an odd prime with(n, p) =1. Ifthecongruence x2 E n (mod p)is solvable, then11 is calleda quadraticresidue modulop. Otherwise, n is called a quadratic nonresidue modulop. Itis apparent from the de ﬁ nition thatthe quadraticresidues modulo pare, essentially, the squares modulop. Thus,1 and4 are quadraticresidues modulo5;1, 4, and2 are quadraticresidues modulo7; anda2 isa quadraticresidue moduloany odd prime p, provided that(a, p) = l. The following notationaldevice, due toLegendre,is veryuseful inthe study of quadratic residues. DEFINITION5.2. For pan odd primeand(n, p) =1, we de ﬁ ne the Le- gendre symbol (g)by the equations Sec. 5.5 Quadratic Congruences 1 35 (n) _ {1 ifn isa quadraticresidue modulop, Z —1 ifn is a quadratic nonresidue modulop. In terms ofthe Legendre symbol,we have that 1 4 2 3 a2_ = _ = _ = _ =_1__ =. (5) (5)1’ <5) (5)’ and (p)1 foranyoddpnmep, provided that(a, p) =1. Moreover, ifn E m (mod p), itis clear thatx2 E 11 (mod p)is solvable ifand only ifx2 Em (mod p)is solvable. Thislast statement serves as the proof ofthe theorem, whichwe nowstate. THEOREM 5.10. Let pbe an odd prime with(n, p) =(m, p) =1. Ifn E m (mod p), then 2 = E (p) (P). In view ofTheorem5. 10, itis onlynecessary todetermine the quadraticcharac- ter ofeach ofthe numbers ina reduced residue system modulo pto knowthe quadratic character ofany integern. Thus, when determining quadraticresidues, one usually lists onlythose inthesystem1, 2,. . . , p— 1. Also,whenwesay inthe next theorem thatthereare precisely (p— 1)/2 quadraticresidues modulop,we mean that there are (p— l)/2quadraticresidues inanyreduced residue system modulo p. THEOREM 5.11. Thereare precisely (p— 1)/2 incongruent quadraticresi- dues modulo p, where pis an odd prime. Proof. We determine the number ofintegersn with(n, p) =1 forwhichx2 E n (mod p)is solvable byseeing how many differentvalues ofn we can generate by taking differentvalues ofx. Inthe ﬁ rstplace, ifx2 En (mod p)and(n, p) =1, then (x, p) =1. Therefore, sincex2 Ey2 (mod p) ifxE y(modp), itis clear thatwe need to consider onlythose values of xinthe reducedsystem1, 2,. . . , p— 1. Moreover, (p -x2 E x2 (mod p),so thatthesquares ofthe numbers inthe twosets 1, 2,.. . ,(p —1)/2and(p+l)/2,. .. ,p—1arecongruentinpairs,andwecan further restrict our attention to the ﬁ rst ofthesesets. Butthesquares12, 22,.. . , (p— 1)2/4 are all incongruent modulop. Ifthiswere notthecase, a congruence ofthe form x2 En (mod p) wouldhave atleast fourincongruentsolutions,a contradiction to Lagrange’s theorem. Thus, thereare precisely (p -1) /2 incongruent quadratic residues modulo p and any quadraticresidueis congruent toone ofthe numbers 12, 22,. . . , (p—1)2/4. EXERCISES 5.5 1. (a) Determine the quadraticresidues modulo11. (b) Determine the quadraticresidues modulo13. 1 36 Conditional Congruences Chap.5 2. Ifpossible, solve the followingcongruences. (a) 3x2+6x+SEO(mod7)(b) x2+6x+2EO(mod7) (c) 7x2—4x+1 E0(mod11) (d) 7x2—4x+250(mod11) 3. Ifpossible, solve the followingcongruences. (a) 3x2 + 6x +5 E0 (mod49) (b) 3x2 +6x +5 E0 (mod539) Note that539 =11- 49. 4. Ifpossible, solve the followingcongruences. (a) 7x2— 4x +2 E0 (mod7) (b) 7x2— 4x+2 E0 (mod77) 5. Ifpossible, solve the followingcongruences. (a) 3x2 + 2x E0 (mod13) (b) x2 +9x +4 E0 (mod13) 5.6 THE QUADRATIC RECIPROCITY LAWOF GAUSS According to Theorem 5.11, any quadraticresidue modulo7 mustbe congruent to one ofthe numbers12, 22,32. Thus, the quadraticresidues inthereduced residue system1, 2,. . . , 6 are1, 4, and2,as notedabove. Modulo17, the quadratic residues are1, 4, 9, 16, 8, 2,15, and13. Inthesame way, one could ﬁ ndthe quadratic residues moduloany odd primep, but itis clear thatthe work involved would be prohibitive ifpis large. The followingremarkablesequence oftheorems, which culminates inthe famous law ofquadratic reciprocity ofGauss, providesa more practicable method ofdeterminingthe quadraticcharacter ofany particular integer11. First discovered by Euler, the quadratic reciprocity lawwas subsequently (1785) rediscovered and given itspresent formbyLegendre.Gauss claimed tohave discovered the remarkable result yetagain in1795 whenhe was only18 years old, but some are not convinced thathe was unaware ofthe earlier work ofEulerand Le- gendre. In anycase, the ﬁ rst proof ofthe resultwas given byGauss, whowrites ofhis initialeffort: “Fora whole year this theorem tormentedme andabsorbed mygreatest efforts until,at last, Iobtaineda proof.. . .”Eventually,Gauss devisedseven different proofs and laterresearchers have added manymore. Those ofGauss, however,seem tobe the mostbasic. The proofofferedhere is essentiallydue toGauss and depends on Gauss’s lemma, whichis an ingenious transformation ofthe follow- ing criterion ofEuler. THEOREM 5.12. (Euler’s Criterion). Ifpis an odd primeand( p,n) =1, then (1%) E n‘IH)”(modp). Proof. ByTheorem 5.1,if1 S r Sp—1,thereexistsswithlss Sp—1 such that rs En (mod p). Ifn isa quadraticnonresidue modulop, then r9E s and the Sec. 5.6 The Quadratic Reciprocity Law ofGauss 1 37 numbers1, 2,.. . ,p—1 can be grouped into (p— 1)/2pairsr,-,s,- such that r,-s,- E n (mod p) for i=1, 2,. . . , (p— 1)/2. Takingthe product ofthese con- gruences, we obtain, by Wilson’s theorem, _1 E (p—1)! En‘P'W2 (modp)- But (3)=—1,so p as desired. On the other hand, ifn isa quadraticresidue modulop, then forsome pairr0, so, we have thatr0 =so andr3 En (modp). Moreover,we have alreadyseen that (g)E norm(modp), (p -ro)2 Er3 En (mod p) and by Lagrange’s theorem,these are the onlysolutions tox2 E11 (modp). Thus, excludingre and p -r0 from consideration, the other p— 3 numbers intheset1, 2,. .. , p—1 can again be grouped into (p -3)/2pairsr,-,s,- forwhich risi E n (mod p) withr,- Es, for i=1, 2,.. . , (p -3)/2. Takingthe product ofthese congruences and multiplyingbothsides ofthe result byro( p— r0), we obtain, by Wilson’s theorem, ‘15(1) _1)! E70(P _ramp—3’” E _r3\"(p—3m E ~n‘P“)/2(mod1)) since— r3 E—n (mod p). Thus,110—1)” E1 (mod p)andagain n _ EnU‘lyzmod’(p) ( p) as we wished to prove. COROLLARY5.13. Ifpis an odd prime,n =HLIm,,and (m,,p) =1 for each i, then n3 m,- (p)1.1 (p ) Proof. Since (m,, p) =1 foreach i, itfollows fromTheorem2.12, Section2.3, that (n, p) =1. Therefore, byEuler’s criterion, n (_)E”(p—m2 = ﬂmy—n/z E ﬂ(%)(modp), p i=1 i=1 <2>—;:<%>=kp and 1 38 Conditional Congruences Chap.5 for some integerk. But by de ﬁ nition ofthe Legendre symbol, the onlypossible values for the leftside ofthis equalityare i2 or0. Since pis an odd prime, itmustbe thecase thatk=0and n5 mi (1)) 131(17)’ Ifn =H i=1 p?iwitha,- 21 foreach iis the canonicalrepresentation ofn and ifp is an odd prime with(n, p) =1, itfollows immediately from Corollary5.13 that (E)=1'1 (g)I7 i.]17 Thus, the problem ofdeterminingthe quadratic character ofn withrespect to p reduces to that ofdeterminingthe quadraticcharacter ofeach prime divisor ofn with respect to p. Thisis the object ofthe next twotheorems ofGauss. as claimed. THEOREM 5.14. (Gauss’s Lemma). Let pbe an odd primeandn an in- teger with(n, p) =1. Let Sdenote theset ofleast positiveresidues oftheintegersn, 2n,. . . , %( p— 1)- n. Ifrdenotes the number ofelements ofS thatexceed p/2, n =__rthen(;) (1). Proof De ﬁ nes by r +s =(p— 1)/2 and denote the elements ofS by(11, a2, . . . ,a,,b1,b2,.. . ,b,,where ai<p/2foreachiandbj>p/2foreachj.Since the elements ofSare theleast residues ofn, 2n,.. . , §( p— l)- n, itfollows that ﬂa, [Ib- s (1L1)mew-W2 (modp). (5.2) i=1 j-lJ 2 Sincep/2 <bj <p, itfollowsthatO <p— b]. <p/2foreachj.Moreover,a,- ¢p—b,- for any iand j.Tosee that thisisso, suppose thata,- =p— b jforsome iand j. Then (h+k)nEhn+knEai+bjEpEO(modp) for some integers h, k withh#= k,1 Sh S (p —1)/2, 1S kS (p —1)/2.This im- plies that p|(h +k)nand, since (p,n) =1, thatp|(h +k). However, thisis impos- sible since 0 <h + k <p. Itfollows thatthe (p— 1)/2integersa1,(12,. . . , as, p— b1,. . . , p— b,are all distinctandsatisfy the inequality1 S xS (p— 1)/2. Hence, they mustbe justthe integers1, 2,.. . , (p— 1)/2 insome order. There- fore, using (5.2), we obtain Sec. 5.6 The Quadratic Reciprocity Law ofGauss 1 39 (”T)!=f[a.-f1(p—b) i=1 j=l =ew ﬂ m ﬁ a am i-l=1 5(— 1)’ ($):nw-M (moda- Since itis clearly relatively prime top,we may divide bothsides of(5.3) by (3—31)! to obtain 1 E (—-1)’n(1\"‘)/2 (modp). (5.4) Multiplying bothsides of(5.4) by(— l)’and using Euler’s criterion,we obtain t—D’EnW'W’E(%)(modp) 65) Therefore,(— l)’ -(g)=tp forsome integert. Butsince the left-handside ofthis last equality must equal :2or0 by de ﬁ nition of (2),itfollows that t=0 and (g) =(— 1)’,as we wished toprove. THEOREM 5.15. (The Quadratic Reciprocity Law ofGauss). Ifpandqare distinct odd primes, then (E) (2)= (.1)ir(p—l)'i(q—l)_ ‘1 P Proof. The proofdepends onGauss’s lemma. Consider theintegersq, 2q,.. . , %(p- l)- q. For lsks(p—l)/2,let kq=q+t,cwithqk andtk integers such that1 <tk S p— 1. Thus,tkis theleast residue ofkq modulop. Also, by property (viii) ofTheorem2. 27, qk=[kq/p] Let(1,, a2,.. . , (1, denotethose values oftk whichareless than p/2 and let bl, b2,. . ,b,denotethose values oftk which exceed17/ 2. Then, byGauss’s lemma,% =(—1)’. Let a = 2;,a, andb = 2;b-,so that (p—l)/2 a+b= Eai+2b~=21 tk. (5.6) i=1 j=l AsintheproofofGauss slemma,thenumbersa1,. . . ,as,p—b1,. . . ,p—b, are just the numbers1, 2,. .. , (p— 1)/2 insome order. Therefore, 140 Conditional Congruences Chap.5 a+rp— b= 2a+2(p—b-) '=1 =1 :p—l)/2 J P2__ l (5.7) _ k = k=1 8 Moreover, summing the equations kq = q+tk and using (5.6),we obtain (p—1)/2 (p—1)/2 p 2 qk+a+b=2‘, (q+tk) k-] (rs/2 p2 _1 (5.8) = 2kq =8o q. k-l Subtracting (5.7) from(5.8), we obtain (p—l)/2 [72—1 1) 2 qk+2b-rp=8 '(q-1)-(5.9) k-l [Note that equation (5.9)has been obtained withoutmakinguse ofthe fact thatq is odd. We shall have occasion torefer to this inthe proof ofTheorem5.16.] We now make use ofthe fact thatq is odd and convert equation(5.9) intoa congruence modulo2. The pointis thatwe eventually want tosay something about(— 1)’, and the nature ofthis quantitydepends on whether rE0 or r—=— 1 (mod2). Since (p2— 1) /8 is an integer and p'=- q E1 (mod2), (5.9) implies that (p—l)/2 2qk E r(mod2). (5.10) k-l For convenience, we let (p—1)/2 (p-1)/2 u = 2qk = 2[kq/p]. k-l k-l Then, from (5.10) andGauss’s lemma,we have that ﬂ =_ r=_u(p) (1) (1). Now, ifwe repeat the preceding argument withtheroles ofpandq interchanged and let (q-l)/2. 2[JP/q], i=1 it follows thatwe obtain (q)—— (—1)\". Therefore, (alga-w Sec. 5.6 The Quadratic Reciprocity Law ofGauss 141 and the proof willbe complete ifwe can show that u+v=%(p—1)-%(q*1). Consider theset T ofallelements ofthe form jp— kg with k =1, 2,. . . , %( p—— l)and j=1, 2,.. . , %(q — 1). Itis clear thatnone oftheelements ofTare zero. For ifjp -kq=0, then jp=kq and p|kq. Butthisis impossiblesince (p, q) =1 and1 sk s(p—- 1)/2. Also,essentially thesame argumentshows thatall the elements of Tare distinctandhence that Tcontains ap— 1)- §(q— l)ele- ments. We now determine how manyelements ofTare positive and how many elements are negative. Forﬁ xed j,jp— kq >0 for allvalues ofk = l,2,. . . , x, where xis the largest integersuch that jp >xq. Thatis, forﬁ xed jthereare x = [jp/q] values of kthat yield positive elements ofT. Therefore, the totalnumber ofpositive elements of Tis (4-l)/2 v=2‘, lip/q]. j-l Similarly, (P—l)/2 u= 2WW] k-l is the number ofnegative elements inT. Since thisaccounts forallelements ofT, we have u +v =%( p— 1)- %(q — 1) and the proofis complete. EXAMPLE5.9. Determine the quadraticcharacter of19 withrespect to 283. 2 Solution. Since (g)= i1,(1%) =1 and the law ofquadratic reciprocity can be put inthe form (2) = ( ﬂ )(-1)s(p—1)-s(q—1)_ G P Therefore, since19 and 283 are primes,we have that .12 _ E. _9.141 (283)< 19)( 1) = _ (E) 19 ' Since 283 E17 (mod19), itfollows fromTheorem5.10 that are)- 1 42 Conditional Congruences Chap.5 Again, by quadratic reciprocity, l 9) (-1)“9 and since 19 E2 (mod17). Thus, (21—893)=-(%7) and we have only to determine the quadraticcharacter of2 withrespect to17. Since 62 E 2 (mod17), 2 19 ('1—7') —1 and (Egg)— — 1. Thus,19 is a quadratic nonresidue modulo283. Ofcourse, since (1_9 (&)=_lg.m=_l 283 19 ’ we also have immediately that283 is a quadraticresidue modulo19. In Example 5.9, note thatthe quadratic reciprocity law could notbe used to 2. . . . . . evaluate (l7)smce1t apphes only toodd primes. The followmgtheoremmakes1t possible to evaluate (%> foran odd primep. THEOREM 5.16. Ifpis an odd prime: 2 =1 forpEi1(mod8), p —1 forpEi3(mod8). Proof Recall that equation (5.9) inthe proof ofTheorem5.15 was obtained withoutusing the oddness ofq. Thus, itis valid incase q =2. Moreover, ifq =2, we have1 5kg Sp— 1, so thatqk =0 foreach kwith1 S kS (p—-1)/2. Therefore, equation (5.9) becomes 172-12b—rp=8 Sec. 5.6 The Quadratic Reciprocity Law ofGauss 143 Since p E1 (mod2), this implies that so, by Gauss’s lemma, 2 _ = -1 r:_1(p2—1)/8_(p)( ) ( ) Furthermore,since pis odd, p E :1or p E i3 (mod8). Ifp E i1 (mod8), then p = il + 8k forsome integer kand p2 =1 il6k+64k2. Therefore, (p2— 1)/8 is even and <2> =1- P On the other hand, ifp—=— :3(mod8), then p E i3 +8k forsome integer kand p2 =9 i48k +64k2. Therefore, (p2 -1)/8 is odd and EXAMPLE 5.10. Evaluate(1—27). Solution. Since17 El(mod8), itfollows from Theorem5.16 that EXAMPLE5.11. Determine the quadraticcharacter of42 withrespect to 997. Solution. We give onlythe bareessentials ofthe solution.Readers shouldbe sure that they understandeach step. Since 42 =2- 3- 7, itfollows that (54—927)=(6§‘7‘)(%)%)' Moreover, by the preceding theorems, <—>-— <a>=<a>=<g>=h (wee—1. 144 Conditional Congruences Chap.5 . 42 . . . Combiningthese results, we obtaln(39—7) =1, so that42IS a quadratlcres1due modulo 997. EXAMPLE5.12. For what odd primes pis3 a quadraticresidue? Solution. By the law ofquadratic reciprocity, 3) ipl(mod4), crew:<3p 3 —(§) ifpE3 (mod4), Moreover, by Theorem 5.10,(13)) = (g), where ristheleast residue ofpmodulo3. Thus, 1 ifp E1 (mod3),(g): (a 3 <%)=—1 ip2(mod3). Hence, itfollows that l ifpE1 (mod4) and p E1 (mod3), 2 =1 ifpE3 (mod4) and p E2 (mod3), p —1 ifpE1 (mod 4) and p E2 (mod3), —1 ip3(mod4)and pEl(mod3) By the Chinese remainder theorem, p E1 (mod 4) and p E1 (mod3) imply pE1 (mod12), p E3 (mod 4) and p E2 (mod3) imply p E11 E -1(mod12), p E1 (mod 4) and p E2 (mod3) imply pE5 (mod12), p E3 (mod 4) and p E1 (mod3) imply pE7 E—5 (mod12). Therefore, the conclusion above can be summarized by (3)_{1 ipil(mod12), 5‘1 ipi-5(mod12). 53—) =1 since 37 E1 (mod12), and (i)=—1 since41 EFor example, (37 41 5 (mod12). Sec. 5.6 The Quadratic Reciprocity Law ofGauss 145 EXERCISES 5.6 10. ll. 12. 13. 14. 15. 16. . Determine the quadratic character ofthe followingnumbers modulothe prime 379. Note that307 and 293 are primes. (a)3 (b)5 (c) 60 (d)—1 (e) 307 (f)293 . Let pbe an odd prime. Deduce fromEuler’s criterion that(—71) =(—DOD—”’2. . Deduce fromExercise2 that—1 is a quadraticresidue moduloan odd prime p if and only ifp E1 (mod4). . For what odd prime pis— 3 a quadraticresidue? nonresidue? . For what odd primes pis11 a quadraticresidue? nonresidue? . Ifp and q are distinctodd primes with porq congruent to1 modulo4, show that p is a quadratic residue moduloq ifand only ifq isa quadraticresidue modulop. Suggestion: Use Theorem5.15. . Ifp and q are distinctodd primes with p Eq E3 (mod4), show that pisa quadratic residue moduloq ifand only ifq isa quadraticnonresidue modulop. . Note that2717 =11- 13- 19 and determine ifx2 E295 (mod2717)is solv- able. . Let pbe an odd prime with(a, p) =1 and ( )=1. Show thatx2 Ea (mod p) a P has precisely two incongruent solutions modulop. Ifa and pareas inExercise9, prove thatx2 Ea (mod p\")has precisely two incongruent solutions modulo p\"forevery positive integern. Suggestion: Use mathematical induction. Let m =115., p5\", witha,- 21 andp,- 23 foreach i,be the canonicalrepresenta- tion ofm and leta be relatively prime tom. Show thatx2 Ea (modm)is a solvable ifand only if ( )=1 foreach i. I Let m and a beas inExercise1 1. Ifx2 Ea (modm)is solvable, prove thatthere exist precisely 2'incongruent solutions modulom. Let pbe an odd prime with (p,a) = l.Prove thatax2 +bx +c E0 (mod p)has two, one, or no solutions accordingas b2— 4acisa quadraticresidue, is con- gruent to zero, oris a quadratic nonresidue modulop. Ifp is a prime and p E1 (mod4), prove thatn isa quadraticresidue modulo p if and only ifp— n is a quadraticresidue modulop. Ifp is a prime and p E3 (mod4), prove thatn isa quadraticresidue modulo p if and only ifp—- n isa quadratic nonresidue modulop. Use the result ofExercise3 toprove that all primedivisors ofn2 +1, forn >1, are ofthe form 12k+ lor 12k+5. 146 Conditional Congruences Chap.5 17. Let P*be theset ofallprimes ofthe form12k +land 12k +5. Prove that P* contains in ﬁ nitely manyelements. 18. Let pbe an odd primeand let S and Pdenotethe sum and product,respectively, ofthe quadraticresidues modulop. Prove thatS E0 (mod p) ifp >3 and that P E i1 (mod p). In particular,show that P E1 (mod p) ifpE3 (mod4) and PE—1(modp)ipl(mod4). Suggestion: Use Exercise2 ofSection 5.4 forthe result concerningP. 19. Let p be an odd prime (p,a) =1. Then, by Fermat’s theorem, a!\"1E 1 (mod p). Ifp—1 is the smallest positive value ofe such thata9 E1 (modp), prove thata2, a4,. . . , at\"—1 are the quadraticresidues modulo p(see Exercise6 ofSection 4.3). 20. Let m be a positive odd integer,say m =H§=1 pi,where thep,- are odd primes which are not necessarily distinct, and let(n, m) =1. The symbol (51—), called the Jacobi symbol,is de ﬁ ned bythe equation 11 ’n (m).11. (p), n where (—>is the Legendre symbol. Clearly, if(%)=— 1, then (3)=—1 for i 1' some i, x2 En (mod p,)is notsolvable,so x2 E11 (mod m)is notsolvable. On the other hand, if7::- =1, then x2 En (modm) may ormay notbe solvable; we can onlybe sure that 1=—l foran even number ofvalues ofi. For i 1 . 2 example, (T5) =1 and x2 E1 (mod15)1s solvable,whereas(1—5) =1 and x2 E 2 (mod15) is notsolvable. Nevertheless, the Jacobi symbolis useful in determining quadratic character,as the followingresults show. (a) For m >0, m odd, (m,n) =1, and n E11’ (modm), prove that ere)- (b) For m >0, m odd, n = 11lmj,and (m, mj) =1 foreach j,prove that (He)- Suggestion: Use Corollary5.13. (e) Let m =11,1.l p,,where thep,- are odd primes notnecessarily distinct; let n =1'1}.=1 qj,where theq, are odd primes notnecessarily distinct;and let (m, n) =1. Deduce fromthe law ofquadratic reciprocity that Sec. 5.6 The Quadratic Reciprocity Law ofGauss 147 (“)(%)=J:,I11(Z:)(Z-i) IS = H H(_1)1(p.--1)-1(q,~—1) i-1j=1 =(—1)&2:-l(pi_1) ‘i‘zi-“qj—1) (d) Let ahaz,. .. , a,be oddintegers. Use mathematical induction toshow that 12(a.-— 1121(1'1a1— 1) (mod2) i=1 1\"] for every r 22. Hint: For r =2, note that 5(01‘12 _(11\"az +1)=%(ai_1)(az _1) E0 (mod2), so that )(alaz —1)E%(a1—l)+%(a2—1)(mod2). (e) Use parts(0) and (d) toprove that(12—) (%)=(— 1)*('\"’1)‘ W“)formand n, as in part(c). (f) For m >0, m odd, prove that(731—) =(—1)(\"'\"‘)/8. (g) For m >0, m odd, prove that (i1)= (-l)(\"’“)’2. (h) The preceding results can oftenbe used toshorten the computation ofthe quadratic character ofn withrespect top. Forexample, <§1>=e>=e>=e>=<g>=l so that21 isa quadraticresidue modulothe prime89. Use parts (e)-(g) to evaluate the followingLegendre symbols: (3i) (Bi)and (1) 179 ’ 167 ’ 151 ' 21. Leta,- be odd for all i21 and show that 2:” 2m2\"—1) =#(1'1”a? —1)(mod 2\"“) i=1 forall n21 andall r21. Him:Use Exercise18 ofSection 4.1. 1 48 Conditional Congruences Chap.5 Computer Exercises 22. Writea program toevaluate Legendre’s symbolusing Euler’s criterion. Inpar- t'1 a1 t2207 1cu ar, ev uae—9349. 23. Writea program toevaluate Legendre’s symbolusingGauss’s law ofquadratic 15127 3571 ' reciprocity. In particular,evaluate ( 5.7 PRIMITIVE ROOTS. INDICES, ANDPOWER RESIDUES In the preceding sections we considered the problem ofsolvingthe pure quadratic congruence x2 E11 (mod p) foran odd prime p with(p,n) =l.Anaturalextension of this investigationis toask whathappens if2 is replaced bym, andwe shall now consider the mth-ordercongruence x'\"En (modp). DEFINITION5.3. Ifx'\"En (mod p)is solvable with pan odd prime, (p, n) =1, and m 21, thenIt is called an mth-powerresidue modulop. Since the problem ofdetermining mth-powerresidues isa generalization ofthe problem ofdetermining quadraticresidues, itis notunreasonable toexpect thatthe solution to the present problem mightresemble that ofthe former.Recall thatby Euler’s criterion, 2En(1\"‘)/2 (modp). Thus, for(p,n) =1, x2 En (mod p)is solvable ifand only ifn\"\"‘)/2 E1 (modp), andwe note that2 =(p— 1, 2). Simi- larly, suppose thata is a solution to x'\"En (mod p) and that (p,n) =1. Then (p, a) =1 and, by Fermat’s theorem, n‘P‘W\" E a‘l\"‘)\"‘/d E1 (modp), where d =(m, p— 1), so that m/dis an integer. Thus, for(p,n) = l,a necessary condition that x'\"En (mod p)be solvable is that n‘P‘IW E1 (modp), where d =(p— l,m). Itturns out thatthis conditionisalso suf ﬁ cientandso isa valid generalization ofEuler’s criterion. To prove the suf ﬁ ciency ofthe preceding condition,we ﬁ rstdevelopsome general ideas concerningcongruences oftype11\" E1 (modr) for(n, r) =1. Bythe Euler—Fermat theorem,n‘W) E1 (modr). Therefore, thereexistsa least positive integer ksuch that n\"E1 (modr). DEFINITION5.4. Ifkis theleast positive integersuch thatnk E1 (modr), we say that kis the order ofn modulo randwe write k =ord,n.Whenno confusion will resultwe willsimply write k E0rdn. Sec. 5.7 Primitive Roots, Indices, and PowerResidues 149 Note that De ﬁ nition5.4 is meaningless unless (n, r) =1. Thus, whenwesay that k =ordrn,we always imply that(n, r) =1. For example, consider the powers of2 modulo7. By direct computationwe obtain 222, 2224, 2351, 2422, 2524, 2621, 2752, Thus, itis apparent thatord72 =3. Also,we note thatthe powers of2 modulo7 repeat ina cycle of3 and thatthose exponentsh forwhich 2”E1 (mod7)are multiples of3. Thisis true ingeneral,as the followingtheoremshows. Thistheorem is the key toa sequence ofresults thateventually culminate inthedesired result concerning mth-powerresidues. THEOREM 5.17. Iford,n =kand n\" E1 (modr), then klh,and con- versely. Proof. Since ord,n =k, itfollows that n\"E1 (modr) and(n, r) =1. Dividing h by k, we obtain integers q ands with0 Ss <ksuch thath =kq +s. Thus, nh =nkq+s =(nk)qns and since n” E n\"E1 (modr), itfollows that n’E1 (modr). Butsince5 <k, this contradicts the hypothesis that ord,n =kunlesss =0. Therefore,s =O and klh,as claimed. Conversely, ifklh,there exists an integerq such thatkq =h. Thus n”=n’“1=(n\")\"ElqE1(modn) since ord,n =k. COROLLARY5.18. (i) Ifk =ord,n,thenk|<;b(r). (ii) Ifk =0rd,,n, where pis a prime, thenk| p— 1. Proof This follows directly from Theorem5.17 since nib\") E1 (modr) and 71\"“1 E1 (mod p) by the Euler—Fermat theorem and Fermat’s theorem,respec- tively. COROLLARY5.19. Let k =ord,n. Then n“E n”(modr) ifand only if a E b (mod k). Proof. Withoutloss ofgenerality,we mayassume thata 2b. Since k =ord,n, it follows that(n, r) =1. Thus, n\" E11” (mod r) ifand only ifn“—b E1 (modr). But by Theorem 5.7, thisisso ifand only ifk|(a— b), thatis, ifand only ifa E b (mod k). COROLLARY5.20. Ifkis positive and ord,n =hk, then ord,n\" =k. Proof By hypothesis, n\"\" E1 (modr). Suppose that ord,n\" =e. Then, by Theorem 5.17, elk. On the otherhand, It“E1 (modr)and, bythesame theorem, hklhe. This implies thatkle,so k =e, since bothe and kare positive. 1 50 Conditional Congruences Chap.5 COROLLARY5.21. Iford,n =h and ord,m =k, and if(h, k) =1, then ord,mn =hk. ProofSuppose that ord,nm =e. Then (rim)? E1 (modr) andnhemhe E 1 (mod r). Since ord,n =h, n’\"E1\" E1 (mod r)and itfollows that m’”E 1 (mod r). But ord,m =kso, by Theorem5.17, klhe.Since (k,h) =1, this implies that kle. Similarly,one can show thath|e. Therefore, by Theorem2.13, Section2.3, hkle. On the other hand, mm)“ = (n”)k(m\")”E1 (modr) so elhk. Thus,e =hkand the proofis complete. COROLLARY5.22. Iford,q =¢(r),thenq, q2,q3,.. . , q¢(” froma re- duced residue system modulor. Proof. A reduced residue system modulo rconsists of¢(r)numbers allrela- tively prime to rand mutually incongruent modulor. Since ord,q =¢(r), itfollows that(q, r) =1 and hence that(q’, r) =1 forall1'. Suppose that qi EqJ' (modr) with 1 S j< iS<b(r). Then,since (qj, r) =1, qi‘jE1 (modr). Butthen, by Theorem 5.17, ¢(r)|(z'— j).But thisis impossiblesince 0 < i-— j<¢(r).Thus, thepowersare distinct modulo rand the proofis complete. Iford,q = ¢(r),Theorem5.17 providesa particularlyneat and useful method for obtaininga reduced residue system modulor. Inview ofthis importantproperty, we distinguish such values ofq witha special name. DEFINITION5.5. Iford,q =¢(r),thenq is calleda primitiveroot mod- ulo r. Primitive roots do notexist forallvalues ofr. They do exist for r =2, 4, p“,and 2 p“, where pis an odd prime, butwe shall notgive the proofhere. We doshow, however, that primitiveroots exist forevery odd primep. LEMMA5.23. Let pbe an odd prime,ha positive integer, andqa prime such that q\"|( p— 1). Then thereexists an integer msuch thatordpm =q”. Proof. By Lagrange’s theorem, the congruence x‘P‘W‘I E1 (mod p) (5.11) has at most3 solutions, where = D< D< _s q _2 _. p2 since p 23. Itfollows thatatleast one element cintheset C =(1,2,. . . , p— 1} is nota solution to (5.11); thatis, Sec. 5.7 Primitive Roots, indices, and PowerResidues 151 c‘”“’/”E1 (mod p) (5.12) and (c, p) =1. Let m =001—1t and suppose that ordpm =9. Since m4” =61’\" E1 (modp), it follows that elq”. Ife <q\", then elq”‘land itfollows that c‘”“”‘1 =m‘l’\"l E1 (modp). This is a clear contradiction of(5.12). Therefore,e =q”and0rd,, m =q”,as claimed. THEOREM 5.24. Ifpis a prime,thereexists atleast one integerq such thatq is a primitive root modulop. Proof Since1 is a primitive root modulo2, we may immediately turntothe case where pis an odd prime. Let p -1 = Hpf\" i-l where h i 21 for alli,be the canonical representation ofp—1. By Lemma5 .23, there exist integersm,- such that ordpim, =p?\" for i =1, 2,. . . , r. Therefore, bya slight extension ofCorollary5.21, ifm =HQ.lm,~, then ordpm =H§_lp§‘i =p— 1, and m is the required primitiveroot. We now introducea remarkably useful toolthatplaysa role innumber theory similar to that played by the logarithm inelementaryalgebra. Let pbe an odd prime andqa primitive root modulop. By Corollary5. 12, since q° E q?\"1 E1 (mod p), the numbers q°, q‘,qz,. .. , q”—2 forma reduced residue system modulo p. Thus, if(n, p) =1, thereis an integer rwith0 S r <p—1 such that n E q’(mod p). Thisleads tothe following: DEFINITION5.6. Let pbe an odd primeandqa primitiveroot modulop. We say that ris an index ofnto thebaseq modulo pand write r =indqn modulo p if andonlyiaq’(modp) andOSr<p—1. In any given discussion,1) andq are usually ﬁ xed and itis typicalto write simply r = indn. EXAMPLE5.13. The powers of2 modulo11 are 2° E1,21 E2,22 E4, 23 E 8, 24 E5,25 E10,26 E9,27 E7,28 E3,29 E6,210 E1. Thus,2 isaprimitive root, ind10 =5 since25 E10 (mod11), ind3 =8 since28 E3 (mod11), andso on. Indeed,a table ofindices tobase 2 modulo11 isas follows: 1 52 Conditional Congruences Chap.5 nl l2 3 4 5 6 7 8 9 10 indnl 0 l8 2 4 9 73 65 A table ofindices forprimesless than200appears at the back ofthe book. The following theorem shows how closely the theory ofindices parallels the theory oflogarithms. THEOREM 5.25. Let pbe an odd primeandq a primitiveroot modulop. Also let (m, p) =(n, p) =1. Then (i) m E11 (mod p) ifand only ifindm E indn (mod p -1). (ii) qind\" En (mod p) and ind q'E r(mod p— 1). (iii) ind1 =0 and indq =1. (iv) ind (mn) E indm +indn (mod p— l). (v) ind (n‘) E t indn (modp— 1). Proof (i) Let r =indm ands =indn; then q’Em En Eqs (modp) ifand only ifindm = rEs =indn (modp— l)by Corollary5.19 since ordpq =p -1. (ii) Lets =indnas inpart(i). Then q‘“\"=q‘En (modp). Also, let r = ind m. Then q'E m (mod p)and ind q'E indm E r(modp -- l)by part(i). (iii) Since1 E q° (modp), ind1 =0. Similarly,since q Eq1 (mod p), ind q =1. (iv) Let r =ind m ands =indn,as above. Then q'Em (modp)and q‘E n (mod p). But then 4’“= q'q’E m(mod p) and itfollows that indmnEr+s=indm+indn(modp—1). (v) Again, ifs =indn, then q‘En (mod p)and q\"E11‘ (modp). Butthen ind n‘E ts=tindn(modp—1). EXAMPLE5.14. Use the table ofindices modulo11 inExample5.13 to solve the congruence 6x E5 (mod11). Solution. Weuse ifas an abbreviation forthephrase “ifand only if.” 6x E5 (mod11) ill\" ind 6x Eincl5 (mod10), ill ind6 +ind xE ind5 (mod10), HT 9 +ind xE4 (mod10), iii” ind xE5 (mod10), i ﬂ ‘‘ xE10 (mod11). Sec. 5.7 Primitive Roots, lndices, and PowerResidues 153 Note that in making the laststep weuse the indextable backward (likean old-fash- ioned antilog table) to ﬁ ndthe numberwhose indexis5. Ofcourse, the preceding isa trivialexample that certainlydoes notrequirethe use ofindices. Asomewhatless trivialexampleis the following. EXAMPLE5.15. Ifpossible, solve the congruencex25 E3 (mod11). Solution. x25 E3 (mod11) i ﬂ ‘ indx25 Eincl3 (mod10), i ﬂ ‘ 25 ind xE8 (mod10). Since (25, 10) i8, thiscongruence is notsolvable. EXAMPLE5.16. Ifpossible, solve the congruencex24 E3 (mod11). Solution. x24 E3 (mod11) i ﬂ ‘ indx24 E ind3 (mod10), i ﬂ ‘ 24 ind xE8 (mod10). Since (24, 10) =2 and 2|8, thiscongruencehas two distinctsolutions modulo10. We have 24 ind xE8 (mod10) i ﬂ ‘ 4 ind xE8 (mod10), i ﬂ ‘ ind xE2 (mod5). Thus, the two solutionsare ind xE2 (mod10) and ind xE7 (mod10), sox E4 or 7 (mod11). We now return to the problem ofdeterminingthe mth-powerresidues modulo an odd prime p. The followingtheoremgivesa necessary and sufficient condition. THEOREM 5.26. Let pbe an odd prime. Let(n, p) =1, and letq bea primitive root modulo p. For m >1, x'\"En (mod p) ifand only ifdlindqn, where d = (m, p— 1). Ifthe congruence is solvable, thereare precisely dincongruent solutions modulo p. Proof. x’\"En (mod p)is solvable ifand only if m indqx E indqn (mod p— 1). 1 54 Conditional Congruences Chap.5 But this is solvable andhas dsolutions ifand only ifd|indqn,where d =(m, p— 1). Thus, ifitis solvable, thereare dincongruent solutions modulop,as claimed. We are now ina position toprove the aforementioned generalization ofEuler’s criterion for mth-powerresidues moduloan odd primep. THEOREM 5.27. (Generalization ofEuler’s Criterion). Let pbe an odd prime with (p,n) =1. Then x’”En (mod p)is solvable ifand only ifn‘P'IW E 1 (mod p), where d =(m, p— 1). Proof As noted at the beginning ofthissection, the conditionisnecessary. We now show that itis also su ﬁ icient.Suppose that n‘P‘W\" E1 (mod p)and letq bea primitive root modulop. Then p— l d since indql =0. This implies thatthe integer indqn E0 (modp— 1) 1’;1 indqn=k(p—1) or indqn =ka'. Thus, d [indqn and the congruence is solvable by Theorem5.26,as claimed. THEOREM 5.28. Letp, m,n,q, and dbeas inTheorems5.26 and5.27. Then the mth-powerresidues modulo pare justthe numbers(1\", q“, q“,. . . , -d 4 Proof Since indqq\"d E kd (mod p— 1), itfollows fromTheorem5.26 thatall these numbers are mth-powerresidues. Moreover, allare distinct modulo psince they forma subset ofthe reduced residue systemq, qz,. . . , ql’“.Nowsuppose that a is an mth-powerresidue modulop. Itfollows that(a, p) =1, so indqaexists. Moreover, by Theorem 5.26, indqa =kd; anda E (1“(mod p) forsome integerk. Dividing k by (p— 1)/d,we have =P_—l.k d s+t with o st <(p— l)/d.Butthen aEq\"d =(101—;. 3+1). 5q(p—l)sqtd E61‘“ (mod p) Sec. 5.7 Primitive Roots, lndices, and PowerResidues 155 since q!\"1 E1 (mod p). Therefore,a is congruent toone ofthe numbers inthe list above and the proofis complete. EXAMPLE 5.17. Findthe fourth-powerresidues modulo11. Solution. As we have alreadyseen, 2 isa primitive root modulo11. Thus, since1) —1 =10, m =4, and d =2, itfollows fromTheorem5.28 that22 E4, 24 E 5, 26 E9,28 E3, and21° E lare the fourth-powerresidues modulo11. Of course, thisis easily checked directly by computingthe fourthpowers ofthe numbers in the reduced residue system i1, i2, i3, i4,:5.Asbefore, we have that (:1)4 E1, (i2)4E5, (:3)4E4,(-|_-4)‘ E3, and (i5)4E9. EXERCISES 5.7 1. By direct calculation determine the following. (a) Ord172. (b) The least residue ofeach of22°,21°24,2500 modulo17. 2. For which positive exponentse is 2\" E1 (mod17)? 3. Determineord172‘2. 4. By direct calculations, show that3 isa primitive rootmodulo l7and constructa table ofindices to thebase3 modulo17. 5. Using the table ofindices ofExercise4, computethe following. (a) ind328 (b) ind3 5'0 (c) The least residue of15- 13 modulo17. (d) The least residue of710 modulo l7. 6. Use the table ofindices ofExercise 4 tosolve the following ifpossible. (a) 7xE5 (mod17) (b) x7 E5 (mod17) (c) x8 E8 (mod17) 7. Find the cubicresidues modulo7. 8. Use Theorem 5.27 (the generalization ofEuler’s criterion) todetermine if (a) 3 is a ninth-powerresidue modulo31. (b) 2 is a tenth-powerresidue modulo 3]. (c) 16 is a cubic residue modulo31. 9. Use the table ofindices at the back ofthe book todetermine if15 is a seventh- power residue modulo29. 10. Find all solutions to x9 E25 (mod29). Suggestion: Againuse the table ofindices at the back ofthe book. 11. Find all seventh-powerresidues modulo29. 12. Find all solutions to x7 E12 (mod29). 13. Determineord7 2, ords 2,ord35 2. Does thissuggest a general rule? Tryother examples in order to re ﬁ ne yourguess. 1 56 Conditional Congruences Chap.5 14. Iford,m =h and ordsm =k, and if(r,s) =1, prove that 0rd,,m =[h, k]. 15. Iford,n =k, prove that ord,n\" =k/d,whereh >0 and d =(h, k). 16. Ifp is an odd prime and ordpa =t, show thatthere exist precisely ¢(t)incon- gruent numbers intheset (a,a2,.. . , a‘}each ofwhichhas orderI. 17. Ifq is a primitive root modulothe odd primep, show that (p— l)/2 is theleast positive integral value ofe such that q‘E—-1 (modp), andconversely. 18. Ifpis an odd prime andq isa primitive root modulop, prove that—q isa primitive root modulo p ifand only ifp E1 (mod4). 19. Use the result ofExercise14, Theorem5.24, and Corollary5.22 toprove that there are ¢(p— l)primitiveroots modulothe odd primep. 20. Find the ¢(28) =12 primitiveroots modulo29. 21. Prove thatthe product ofthe primitiveroots modulo29 is congruent to lmodulo 29. Do you suppose that thisis generally true? Trysome otherexamples. 22. For p >3, prove thatthe primitiveroots modulo poccur inpairs,u,1) such that up E1 (mod p). Hint: Note that if(a,p— 1) =1, then (p -1—a, p— 1) =1 also. 23. Prove thatthe product ofthe primitiveroots modulothe prime pis congruent to l modulo p ifp>3. 24. Letq be a primitive root ofthe odd primep. Prove thatq isa primitiveroot modulo p2 ifand only ifq!\"1 $1 (modp2). 25. Use the fact thateach primepossesses a primitiveroot toprove Wilson’s theorem. 26. In Section4.1 we discussed the Russianpeasant algorithm forﬁ ndingtheleast residue modulo p ofa power ofa given integer. A. L.Crellegavea simple method in 1844 thatis certainlyreasonable touse forsmallvalues ofpandeven for relatively large values ifonehasaccess toan electronic computer. Letabea given integerwith1 Sa Sp —landlets,-andtjwith1SiSp— land1 SjS p—1 be the least residues modulo p ofidanda}, respectively; thatis,s,- 5 id (mod p) and ti 5aj(mod p)and1 S si, tiS p -1. Then itturns out that tj=Stj—l’ so that the values oftican easily be calculated recursively. Forexample, consider the powers of3 modulo7. The workis neatlyarranged intabular formas shown. t5» 3 6 2 5 l4jar Sec. 5.7 Primitive Roots, Indices, and PowerResidues1 57 27. 28. One begins by ﬁ lling inthe values1' from1 through6 inorderand theleast residues ofs,- =31'. Since the tjare simplyvalues ofs,-, thes, rowis also the If row and itis simplya matter ofdeterminingthe appropriate placement ofthesucces- sive values of j.Since I,is theleast residue of31' modulo7,t1 =3 =s1 andwesee that j=1 goes inthe ﬁ rst column ofthe table. Nowt2 =st] =s3 =2,so that j=2 goes inthe third column ofthetable. Again, I; =5,2 =s2 =6,so j=3 goes in the second column ofthe table. Proceeding inthiswaywe conclude that 3 E 3,32 E2,33 E6,34 E4,35 E5, and36 E11 all modulo7. Withjustalittle practice the workbecomes essentially automaticand very quick. Note that ord73 =6 (i.e.,3 is a primitive root modulo7) and that, by Corollary5.19, the least residues ofthe powers of3 willnowrepeat ina cycle oflength6. Ingeneral, the least residues ofa willrepeat ina cycle oflength p— 1, althoughthere maybe a shorter cycle oflengthk, where ordpa =k. Thus, the tablecanbe considered complete when one ﬁ rstreaches t jwhere j=k. Inthe presentcase k =6 and, for example,350° =36‘ 83“E32 E2 (mod7). Ingeneral, ifordpa =kand m = kq +r, where 0 S r <k, then a’\" =ak‘la' E a’(modp). Finally, forlarger values ofp itmaybe convenient to rewritethe jand t j=(1’ portion ofthe table in order ofincreasing values of j.Thus, fromabove, we mightrewrite the tableas follows: (a) Find the least residues modulo7 of51' for1 S jS6. (b) Find the least residues modulo7 of5\" forallintegers jZ l. (c) Find the least residues modulo7 of21' forallvalues of j2l. (d) Prove thatCrelle’s method forﬁ ndingt,is correct, thatis, that ti =32,—; for ISjSp—1, where we de ﬁ ne to=1. Computer Exercises Writea program to implementCrelle’s method for ﬁ ndingtheleast residue of a' moduloa primep. The program shouldaccept p,a, and ras inputsandbe able to print outthe least residue of a’modulop. Inparticular, ﬁ ndtheleast residue of 217384 modulo9929. In Section 1.4 we discussed the Russian peasant method forﬁ ndingtheleast residue ofa 'modulop. Writea program to implementthe Russianpeasant algorithm for computingtheleast residue of a’modulop. Inparticular, ﬁ ndthe least residue of21 7384 modulo9929 and compare the time thisprogramrequires with the time required by yourprogram forExercise27. c3 Cryptography Cryptography, the art ofsecret writing,has been practicedatleast since the time of Julius Caesar, Emperor ofRome from49 to44 3.0. Initiallyused primarily in military and diplomatic communications,theneed forsecurity insophisticated computersystems, inthe electronic transfer offunds, and inother industrialand business contextshas made the development ofquick,e ﬂ icient,andsecure systems of transformingmessages intomeaningless gobblydegook intelligible only tothe in- tended recipienta matter ofwide current importance. Wehave no intention of attempting here a detailed study ofthis enormous ﬁ eld but willconsider primarily some recent and remarkable innovations thatdepend onresults inChapter5. To begin, we introducesome terminology. The original unaltered form ofa message willbe referred toas plaintext.The process ofrendering the plaintext unintelligibleis called enciphering orencrypting and the resultingmessage actuallysent tothe recipientis called ciphertext. The method the recipientuses to convertthemessage received back intoplaintextis called deciphering or decrypting. Given thata particularmethod ofenciphermentwas used, the key is the bit ofinformation thatdetermines exactly howthe methodwas implemented. Ingeneral, the key mustbe known not only bythesender butalso by the recipient, whouses itinthe decipheringprocess. The methodsused byan unintended recipient to determine the plaintext ofan interceptedmessage incipher- text is called cryptanalysis. Obviously,the security ofa method ofencipherment depends on making the job ofthe cryptanalyst di ﬂ icultoreven impossible. In modern applications, itis also importantthatmethods ofenciphermentanddeci- 158 Sec. 6.1 Caesar Ciphers 159 phermentbe very quick—thatis, they shouldbe readily implementableonelec- tronic computers. 6.1 CAESAR CIPHERS One ofthe ﬁ rst methods ofciphermentwas devised byJuliusCaesar, whoused itto communicate withhis generals duringthe Gallicwars. Caesar’s ideawas simply to replace each letter inthe alphabet by the letterthreeplaces toits right withthe stipulation thatx be replaced bya, ybyb, and2 byc. Thus,the plaintext REINFORCEMENTS COMING would become, inciphertext, ULHQIRUFHPHQWV FRPKQJ. The deciphermentis then easily carried outby replacingeach letter inthe ciphertext by the letter three places to its left. This methodis easily computerizedas follows. Numberthe letters0 through25 and let P and C represent plaintextand ciphertextletters, respectively,as shown. ABCDEFGHIJKLMNOPQRSTUVWXYZ 012345678910111213141516171819202122232425 Then, in numerical form, CEP+3 (mod26) and PEC—3 (mod26) with the restriction0 S P <26, 0 S C <26. Thus, themessage above would ﬁ rstbe converted to the numerical plaintext 1748135141724124131918 214128136 and then, using the foregoing transformation, tothe numerical ciphertext 20711168172057157162221 5171511169. To disguise word length, themessage actually transmitted wouldbe inthe form of numbers grouped intoblocks oflength5. Thus, 2071116817205715 71622215 171511169 would be sent. Using P E C— 3 (mod26), the recipient would transform thisback to the numerical plaintext 160 CryptographyChap. 6 174813514172412 41319182 14128136 and then to the alphabetic REINF ORCEM ENTSC OMING. This then can be easily reassembled intothe original REINFORCEMENTS COMING. A generalized Caesar cipher would employan enciphering transformation CErP+s(mod26), OSC<26, where we call rthe multiplierands the shiftconstant. Thechoice fors canbe arbitrary butwe need (r, 26) =1 so that rP +s runs througha completeresidue system modulo26as Pdoes andalsoso that r‘1exists, where r’1is the solution to rx E1 (mod26). Then the deciphering transformationis clearly P E r\"(C—s) (mod26), 0 sP <26, where we numberthe letters ofthe alphabetas before. The dif ﬁ culty withCaesar ciphers is thattheyare easily broken bycryptana- lysts. Since the substitutions oflettersare one forone, the letters thatappear most frequently inthe ciphertextare the substitutes forthe letters thatappear most often in the plaintext. Allsuch methods ofenciphermentwhere one systematicallyreplaces each letter ofthe alphabet bysome other letterare called substitutionciphers and all suffer from thisdefect. Indeed, tofacilitatecryptanalysis, frequencytables ofthe occurrence ofletters in writtenEnglish and otherlanguages have been carefully compiled. For writtenEnglish,studies show thatE appears withfrequency13%; T with frequency9%; I, N,and Rappear withfrequency8%; and Aand 0appear with frequency7%. Ofcourse, completetables are available butwe willnotneed them here. Also, italmostgoes withoutsaying that fora givenmessage, particularly for short messages, these ﬁ gures maybe grossly misleading.Nevertheless, theyare suf ﬁ ciently accurate that with onlya few trials they usuallymake itpossible tobreaka cipher. EXAMPLE6.1. ACaesar cipher withshiftconstant kuses the enciphering transformation C E P +k(mod26), 0 S C <26, where the plaintextlettersare numberedas above. Assuming that itwas enciphered withsucha cipher, decipher the message BPMKW LMJZM ISMZA. Solution. A frequency count ofthe letters inthe ciphertextreveals that M occurs most frequently with fourappearances, followed by Zwithtwo,and all other letters appearing once or notat all. Thus, itis highly likelythat M inciphertext Sec. 6.1 Caesar Ciphers 161 represents E in plaintext.Since the numericalequivalents ofE and Mare4 and12, respectively, and C E P +k(mod26), wesuspect that12 E4 +k(mod26),so that k =8. Converting the ciphertext intonumerical form,we have 115121022 111292512 81825120 and using P E C— k E C— 8 E C +18 (mod26), the numericalequivalent ofthe plaintext should be 1974214 34117401017418. Converting to alphabetic notationwe have THECO DEBRE AKERS, which we quickly regroupas THECODEBREAKERS. This, bythe way, is the title ofa huge, though interesting tome on cryptography by David Kahn(New York: Macmillan Publishing Company,1967). Ofcourse,as noted above, inany givenmessage, E need notbe the most numerous letter and we would simplyhave to trythe next most numerousletters in order untila solution madesense. EXAMPLE6.2. Assume thatamessage is enciphered witha generalized Caesar transformation C E rP +s (mod26), 0 sC <26. Suppose thata count reveals that Xappears most frequentlyand Qappears next most frequently. Deter- mine rands and the deciphering transformation. Solution. Since the numericalequivalents ofE, T, X,and Qare 4,19, 23, and 16, respectively, weguess thatwe shouldhave 23 E 4r +3 (mod26) and 16 E 19r +3 (mod26). Subtracting these congruences gives 7 E— 15r (mod26), 7 E llr(mod26), 21 E 33r (mod26), 21 E 7r(mod26), 3 E r(mod26), and this implies thats E11 (mod26). 162 Cryptography Chap. 6 EXERCISES 6.1 l.Encipher themessage FOUR SCORE AND SEVEN YEARS AGO using a Caesar cipher with k =20. . Assuming that itwas enciphered witha Caesar cipher withshiftconstant k, decipher themessage UWJUF WJYTR JJYYM DITTR. . Assuming that itwas enciphered witha Caesar cipher withshiftconstantk, decipher the message YKIAH APQON AWOKJ PKCAP DANMP. . Encipher themessage IT’S AN ILL WIND THATBODES NO GOOD using a generalized Caesar transformation with multiplier5 and shiftconstant7. . Ifthe frequency count ofa message enciphered bya generalizedCaesar transfor- mationgives Qas the most frequent cipher letter and Las the next most frequent, determine the most likelyvalues of rands such that C E rP +s (mod26). . Assuming that itwas enciphered witha generalizedCaesar cipher with multiplier r and shift constant3, ﬁ nd rands and decipher themessage ZWSTO BPJOG BYQIP JOUWO OZGVS MPJOS MPQAI. . One way to make cryptanalysis ofsubstitutionciphers more difficultis tosubsti- tute by blocks ofletters instead ofsingly. Forexample, ifone substitutes bypairs, there are 262 =676 possible, and althoughusefultables offrequencies ofoccur- rences ofpairs have been complied, the available100% is spread muchmore thinly and hence uniformlyover allpossible pairs. Ifwe substitute ingroups of live there are 265 =(1.2)- 107 possible groups and the frequencytables become essentially meaningless. Apairwise substitution similar toa Caesar cipherde- pends on the pair ofencipheringcongruences Cl E aPl +bP2 (mod26) C2 E cPl + s(mod26) and the related decipheringcongruences P1 E edCl— ebC2 (mod26) P2 E -ecC1 +eaCz (mod26), where eE(ad— bc)‘1 (mod26); thatis, e is the solution to (ad— bc)x E Sec. 6.2 Exponentiation Ciphers 163 1 (mod 26). Ofcourse, fore toexist itis necessary and suf ﬁ cient that ((ad— be), 26) =1. Encipher EUCLIDusing the transformation Cl 52P1 +3P2 (mod26) C2 E 5P1+2P2 (mod26). 8. (a) Find the deciphering transformation forthe enciphering transformation of Exercise 7. (b) Decipher EKPDP EQGBGassuming that itwas enciphered bythe trans- formation ofExercise7. Computer Exercises 9. Writea computer program toencipher anymessage usinga generalizedCaesar transformation C E rP +3 (mod26). The program shouldaccept alphabetic input and output ﬁ ve-letter alphabetic ciphertext. 10. Writea computer program tomake frequency counts ofletters inciphertext enciphered bya generalizedCaesar transformation. The program should print the frequency count,choices for rands, and the resulting plaintext. Ifthe plaintextdoes notmakesense, itshouldbe possible torestart the program with an operator selection for rands. 6.2 EXPONENTIATION CIPHERS As we saw inSection 6.1, the main dif ﬁ culty withCaesar and other substitution ciphers is that theyare quiteeasily broken by experienced cryptanalysts. Overthe years many variationshave been devised toovercome this dif ﬁ culty, withvarying degrees ofsuccess. During World War IIthe German andJapanese militaryestab- lishment utilized variations ona commerciallydeveloped German cipher machine called the Enigma. Thiswas an ingeniousdevise witha collection ofwheels that clicked alongas successive letters were encoded and effectively utilizeda different substitution alphabet forthe encipherment ofeach successive letter. Bothcountries were convinced thatthe resulting ciphermessages were unbreakable, and itwasa tribute to the skilland tenacity ofcryptanalysts on bothsides ofthe Atlantic thatthe Allies were able to intercept and reada very highpercentage ofthemessages enci- phered on these machines. Particularly interestingaccounts ofthese effortsare contained inThe UltraSecret byF. W. Winterbotham (New York:McGraw—Hill Book Company,1978), inThe Enigma War byJ. Garlinski (New York:Charles Scribner’s Sons, 1979), and in UltraGoes to War byR. Lewin (New York:McGraw- Hill Book Company,1978),as wellas inThe Codebreakers by David Kahnmen- tioned earlier. In this section we discuss brie ﬂ ya class ofciphers called exponentiationciphers which have been developed only relatively recently andare quiteresistant to crypt- 164 CryptographyChap. 6 analysis. As before, we numberthe letters ofthe alphabet from0 to25, thoughusing two digits each time. Thus, Ais 00, Bis 01, Cis 02, andso on. Let pbe an odd prime and choose a key ksuch that (k, p— l) =1. Toenciphera message we replace the letters by their two-digitequivalents andmergethese numbers intoa single stream of digits whichwe then break up intoblocks of2 m decimal digits withmchosenso that the largest integer formed by adjoiningm decimalequivalents ofplaintextlettersis less than p. We then encipher the plaintext block P intothe ciphertext block Cby means ofthe congruence CEP\"(modp), OSC<p. Since (k, p— 1) =1, there exists q such thatkq E1 (mod p— 1), so kq = l + h( p— l)forsome integerh. Thus, the plaintext Pis easily recovered by the recipient who knows k, and henceq, since C? EPk? EPH‘MP—l).=_ P. PU-Uh E P(modp), by Fermat’s theorem. The resulting cipheris di ﬂ iculttocryptanalyzeeven ifthe cryptanalyst knows p and an example ofa Pand its correspondingC. The dif ﬁ cultycomes indetermining k since the fastest algorithms knownrequire 0(e‘”°“’'°310’3”) bitoperations, whichis simply too time consuming forverylarge values ofp. For loo-digitprimes this would require something like75 years and forZOO-digit primes something like4- 109 years on the fastest existing computers. Note, too, thatmuchfaster algorithms for ﬁ nding k exist ifp—1 is the product ofonlysmall primes. Thiscan easilybe avoided, however, by choosing p =2g + l,whereq is itselfa large prime. EXAMPLE6.3. Encipherthe word FIRE withan exponential cipherusing p=5801, k=61, and m =2. Solution. The numericalequivalents ofF, I,R, andEare 05,08,17, and04 and we form the four-digitblocks0508 and1704. Usingthe method ofExercise27 of Section 5.7, we determine that 50861 E2713 (mod5801) and 1704“1 E3726 (mod5801). Thus, the ciphertextis 2713 3726. To decipher themessage we computeq such that61 q E1 (mod5800). Since q =1141 by the Euclidean algorithm,we must compute 27131141 (mod 5801) and37261141 (mod5801). The results, ofcourse, are 0508 and1704, orFIRE, withwhichwe began. Suppose that anumber ofindividuals I1, [2,. . . ,I,,are using thecode just described. Allthe individuals know pand an integer rsuch that(r, p) = Sec. 6.2 Exponentiation Ciphers 1 65 (r, p—- 1) =1. Also,each individualchooses his own key ki. If I1 and [2 wish to communicate privately, theycan establish theirownsecret key kas follows. I1 calculates x1 E rkl (mod p) andsends itto12, who,at thesame time,calculates x2 Erk2 (mod p) andsends itto I1. NowIlcalculatesk Ex’z‘l Erkzkl (modp)and12 calculates k Ex’fz Erkzkl (mod p) and the commonkey known onlytoI1 and12 since they alone know theirownk1 andk2 is established. Note that(k, p) =1 = (k, p— 1), since (r, p) = l = (r,p -l). Surprisingly, though itis more cumbersome, I1 and12, say, can communicate even withoutestablishinga commonkey. I1 knows kland computesq, such that qlE1 (mod p— 1). Similarly,12 knowsk2 and computesqz so thatkzqz E 1 (mod p— 1). I1 sends P toI2as follows. 1. I1 calculates the least residue ofPk1 modulo pandsends itto12. 2. 12 calculates the least residue ofPklk2 modulo pandsends itback to11. 3. 11 now calculates the least residue of Pkqmodulo pandsends itback to12. 4. Finally,12 calculates theleast residue ofPklkzq'qz modulop. But since km, E1 (modp—1) and kzql(modp—1), itfollows that k1k2q1q2 E1 (modp— 1), so that klkqqz=1 +h(p—1) forsome integerh. Thus, Pklkqqz =P1+h(P—1) =P(PP—1)h E P(modp), by Fermat’s theorem. Thus, [2 ﬁ nallyhas P. The di ﬂ icultyhere, ofcourse,is that it requires fourtransmissions tosend a singlemessage. EXERCISES 6.2 1. In an exponential ciphersystem (a) Whatis the smallest prime p thatcanbe used ifmessages are tobe sent in blocks oftwoletters? (b) Whatis the largest value ofm, thesize ofthe blocks inwhichthemessage will be sent, ifp =131,071? 2. Determine the decipheringkeys forthe followingchoices ofprimes pand enci- phering keys k. (a)p=29,k=11 (b)p=191,k=33 (c)p=1009,k=55 3. Ifp =29 and the enciphering key k = l1, choosea suitable m and encipherthe word HALT. 4. Ifp =29 and the enciphering kis11, decipher 23 03 27 10 05 12 5. Suppose that I1 and12 are exchangingmessages using an exponentialcode with 166 CryptographyChap.6 p =2531, where11’s enciphering keyisk1 =49 and I2’s enciphering keyis k2 =17. They want tocreate a commonenciphering key kbased onthe choice r =3. (a) Determine their common enciphering keyk. (b) Determine their common deciphering keyd. 6. Suppose thatI1, 12, kl, k2, and pareas inExercise5. Suppose also thatI1 wants to send I2 themessage consisting ofthesingle word NO buttheyhave notestablished a common key. (a) Whatis the ﬁ rstmessage I1 sends to12? (b) Whatis the ﬁ rstmessage12 sends to I1 ? (c) Whatis the secondmessage I1 sends to12? (d) Check tosee that I2 correctlyunderstands the originalmessage I1 desired to send. Suggestion: Use the Russian peasant method ofExercise28 ofSection5 .7 for computingthese powers modulo2531. 7. Show how three individuals, I1 , 12, and I3 , can establish theirown privatekey kin an exponential ciphersystem. Computer Exercises 8. Writea program to enciphera message using an exponentiation cipher witha given odd prime pand enciphering keyk. 9. Writea program to deciphera message enciphered usingan exponentiation cipher witha given prime pand enciphering keyk. The program shouldaccept numeri- cal ciphertext inputand outputalphabetic plaintext. 6.3 PUBLIC KEY ENCRYPTION SYSTEMS One ofthe latest developments inciphersystems is public-key encryption. Theidea is quite general, butthebest implementationsdepend on number-theoreticideas very closely related to the exponentiationciphers ofSection6.2. Suppose thatthereare a number ofindividuals A,B,C,. . . who want tobe able to communicate withone anotherusing thesystem. Each personchooses an encryption orenciphering key Ewhichis published ina book ofkeys made available to allusers ofthe system, andalso chooses a decryption ordecipheringkey Dwhichis kept secret. Tobe secure, each individual’sdeciphering key Dshouldbe essentially impossible to discover or computeeven though the encipheringkey Eis known. Suppose that individuals Aand Bwant to communicateusing thesystem, that EA and DA are A’s enciphering and decipheringkeys, and that EB andDB are B’skeys. Since EA and EB are known toeveryone, Bcansendmessage MtoA by actually sending EA(M). Since only A knows DA , the deciphering algorithm, onlyAcan compute DA(E A(M)) = Mandso read themessage. Torespond to B withmessage N, Sec. 6.3 Public Key Encryption Systems 167 A transmits E 5(N) toB, whoreads itusing D3, which only Bknows; thatis, N = DB(EB(N))-_ Note that itis even possible toSign a message ifthe composition ofthe enci- phering and deciphering functionsis commutative, thatis, provided that EA(DA(M» =DA(EA(M)) = M for allmessages M. Ifthisis thecase, Acansend (by radio ortelegraph, forinstance)a signed message to B thathas the followingproperties: 1. B willknow whosigned themessage since noone, includingB,can forge A’s signature. 2. A cannot later deny sending thesignedmessage toB. Thus, Bcouldeasily prove to an impartialjudge thata message received from Aandsigned by A did, in fact, come from A. Obviously,these characteristicsare ofparamount importance insuch matters, for example,as the electronic transfer oflarge amounts ofmoney. It works like this. Tosend a signedmessage MtoB, A actuallysends EB(DA(M)) using B’s published encipheringkey. Using A’s published enciphering algorithmas wellas B’s ownsecret deciphering algorithm, B nowcomputes EA(DB(EB(DA(M))» =E4(D.4(M)) = M since DB (EB (N)) = Nforallmessages N. Moreover, Bknows thatthemessage came from A, since B obtained itusing EA on DA(M)and only AknowsDA. Thus,the “signature”is actually the entire transformedmessage DA(M), which Aalonecan create. Itis therefore not onlysender dependent, butalsomessage dependent—the signature and themessage cannotbe separated any more thanthesignature and the sender. Since all Breceives is a message N =EB(DA(M)),one mightwonder how B knows touse EA to recover the originalmessage. Infact, B wouldnot knowunless this fact were sent inclear (i.e., not incode) telling B thatthemessage was fromA. Of course, this would notaffect the security ofthemessage itselfsince only Aknows DA and only B knows DB. Finally, tobe useful, itis clear thatboth E(M)and D(N) should be easily and quickly computable foranymessages Mand N. We now describe an exponential cipher realization ofthe public-key encryption scheme justdescribed whichappears tomeet allthe requirements forbothsecurity and ease ofimplementation. Thesystem was developed in1978 byR. L.Rivest, A. Shamir, and L. Adleman ofthe MITLaboratory forComputerScience and Depart- ment ofMathematics. Each individual Iinthe system chooses twolarge primes pandq of,say, approximately100 digits. Set r =pq and determinean integers such that (s, ¢(r)) =(s, (p— 1)(q— 1)) =1. The pair(r,s) form I’5 key andare published in 1 68 CryptographyChap.6 the public register ofsuch keys. Ialso computes tsuch thatst E1 (mod ¢(r)),butIis keptsecret. Since st E1 (mod ¢(r)),note thatst =1 +h¢(r)forsome integerh. In order to send Ia message M, Mis converted intonumbersas forthe exponential cipher system and these are grouped intoblocks of2m digits withmas largeas possible,as before. Tosend Mto I,thesuccessive numericalblocks Pobtained from the plaintextare enciphered using I’3 key bythe transformation C=E,(P)EP’(modr), OSC<r. Ithen deciphers each ciphertextcode group andhence the entiremessage using the transformation D,(C) E C‘ E P‘t E PHW’) E P- PW)‘ h E P (modr), 0 S P <r, since PME1 (mod r) by the Euler—Fermat theorem. Ofcourse, this requires that(P, r) =1, and thisis notnecessarilyso. However,as shown below, itis so with very high probabilityand is not likely tocause anyreal dif ﬁ culty intransmit- ting messages. EXAMPLE6.4. Let I’5 choice ofp,q, ands be 7, l1, and7, respectively,so that r =77, ¢(r) =6- 10 =60 and(s, ¢(r)) =1. IfJwants tosendas a message to I the single letter Z, what ciphertextdoes he actuallysend, and howdoes Idecipherit? Solution. The numericalvalue ofZis25. Since 257 E53 (mod77), J transmits53 to I. Todecipher themessage, since t =43 willhave been previously computed by Ito satisfy st E1 (mod ¢(r)), Icomputes 5343 E25 (mod77) and so recovers the plaintextmessage Z. Note the followingfacts. 1. Each individualcan ﬁ nd twolarge primes pandq withapproximately100 decimal digits in justa few minutes ofcomputer timeusing the probabilistictest described inSection 4.4. A numbers such that(s, ¢(r)) =1, where r =pq,is also easily found; forexample, one might simply picka thirdprimelarger than either por q. Finally,1 such thatst E1 (mod ¢(r))is easily found bythe Euclidean algorithm. Thus, an individual’skeys forbothenciphen'ng and decipheringare quicklyand easily found, and all ofthisneeds tobe done onlyonce. 2. Ofcourse,s shouldbe chosenso that 2‘ >r,so that,when enciphered, every plaintext block other than P =O or P =1 must actuallybe reduced modulo rtoa ciphertext blockC. Ifthiswere notso, P couldbe obtained simplyby extractingthe sth root ofC =P5. 3. The exponentiationneeded to bothencipher and deciphermessages canbe Sec. 6.3 Public Key Encryption Systems 169 done in onlya few seconds ofcomputer timeeven when the modulus,the exponent, and the plaintextand ciphertext blockshaveas manyas 200 decimaldigits. 4. The system is secure since, even ifrands are known, inorder to computethe deciphering key t itis necessary to know ¢(r) =(,‘b(pq) =(p— 1)(q— 1). Butthis involves knowing or computing pandq and thebest knownexisting algorithms for factoring numbers with approximately200 decimal digits on thefastest available machines require on the order of4- 109 years ofcomputing time. Obviously, intensive research is aimed at discoveringa way ofﬁ ndingthe decipheringkey t without factoring r =pq, but itseems unlikely that this willbe successful. 5. Finally, to avoid certain special tricks forfactoringpq, itis best that both 1) —1 andq—1 have large primefactors, that (p— 1, q— 1)be reasonably small, and that p and q have roughly thesame number ofdecimaldigits. Thus, given the preceding observations, itis clear thatthe realization ofthe public-key system by Rivest, Shamir, and Adleman (RSA)satis ﬁ es allthe require- ments ofsuch a system. Inparticular, itiseasy to implementand itis essentially unbreakable. The crux ofthe matter, ofcourse, is computational complexity—itis not a complex or time-consumingtask todiscoverlarge primes, but itis an enor- mously complex and time-consumingtask to ﬁ ndthe factors ofthe product oftwo large primes. We noted above that forcorrect encipherment and decipherment ofa plaintext block Pinnumerical form, itwas necessary thatPbe relatively prime tor. Inpractice this would simplybe assumed, since itis extremely unlikely thatP would notbe relatively prime tor. Note that0 S P <r =pq, and ifPis notrelatively prime tor, it must be a multiple of p orq or both. The multiples ofpless thanpqare 0,17,217,317,.- . ,(q-1)p and there are q ofthese. Similarly,thereare pmultiples ofqless thanpq. Finally,the only nonnegative multiple ofpqless than pqis 0. Thus, the number ofvalues ofPin the interval0 S P < r =pq whichare notrelatively prime to ris p +q—1 andthe probability thatP, assuming that itoccurs randomly,is relatively prime to ris ——————+———<2-1o-1°° r pq pq pq ifp and q are lOO-digit primes. Thus, the likelihood ofthisever occurringis ex- tremely small. EXERCISES 6.3 1 . Suppose that Aisa member ofan RSA public-keysystem and thathis choices for r ands are r =53- 71 =3763 ands =11. IfBwants tosend themessage NOW to A, what is actually transmitted toA? 170 CryptographyChap. 6 Suggestion: Think ofthemessageas NOWXso thattwo four-digitblockscanbe sent. Also,use the Russian peasant method to compute theleast residues of powers modulo 3763. 2. Suppose that Aisas inExercise1 and Areceived from Bthe ciphertextmessage 0737 1627. (a) Compute A’s decipheringkey. (b) Decipher B’smessage to A. 3. Let r =pq, where pandq are primes with p >q. (a) Show thatp + q=r— 90) +1. (b) Show thatp— q =(p +q)2— 4r. (c) Find p and q interms of(Mr) and r. . Ifr =1829 andqb(r) =1740,use the results ofExercise3 todetermine1) andq. 5. We noted that itis possible forthe plaintext numerical block P different from zero not tobe relatively prime tor. Show that ifthisisso, itcanbe discovered by a cryptanalyst, who can then factor rand break the cipher. 6. Suppose that Bis a member ofthesame RSA publickeysystemas individualA in Exercise1. LetB’s publickeys be rB=47- 73 =3431 andS3 =7. Itis not dif ﬁ cult to computet3 =490. Suppose that Bwants tosend Athesigned mes- sage I YIELD. (a) Whatdoes B actually transmit toA? (b) Describe thesteps that A willtake indeciphering B’smessage.A Computer Exercises 7. Writea program to enciphermessages withan RSA cipher. The program should accept r’s whichare the product ofany twoprimesless than104 (for simplicity) and anys such that(s, ¢(r)) =1. 8. Writea program to decipher RSA ciphers withthesame restrictionsas inExer- cise 7. 9. Writea program to enciphersignedmessages withan RSA cipher. Assume that both sender and receiver willbe using textblocks ofthesame length. 10. Writea program to deciphersignedmessages enciphered withan RSA cipher. Assume that bothsender and receiverare using textblocks ofthesame length. 7 Sums of Squares 7.1 SUMS OF TWO SQUARES In Chapter2 we considered the problem ofﬁ nding allpositiveintegers x,y, and2 such that x2 +y2 =22. Froma di ﬂ 'erent point ofview this amounts toasking forwhich squares 22 there existsquares x2 andy2 such thatz2 =x2 +yz. Moregenerally,one may ask for which positive integersn itis possible to ﬁ ndsquares x2andy2 such that n = x2 +yz. Inthis connection, itmaybe ofinterest toconsiderthe followingtable ofsuch representations, where an incomplete equationindicates thatnosuch repre- sentation exists. REPRESENTATION OF INTEGERS ASTHE SUMOF TWO SQUARESFOR1 sn s42 l=0+l 2=l+1 3= 4=0+4 5=1+4 6= 7: 8=4+4 9=0+9 10=l+9 ll= 12: l3=4+9 l4= 15= 16=0+16 l7=l+l6 l8=9+9 l9= 20=4+16 21= 22= 23= 24= 25=0+25=9+l6 26=l+25 27= 28= 29= 4+25 30= 3l= 32=l6+16 33= 34= 9+25 35= 36= 0+36 37= 1+36 38= 39= 40= 4+36 4l=l6+25 42= 171 1 72 Sums ofSquares Chap.7 Itis immediately clear fromthe table that notallpositiveintegersnare repre- sentableas the sum oftwosquares ofintegers, but itis notat allapparentat ﬁ rstglance which n are representable and whichare not. On the otherhand,wesaw inSection 1.7 that both x2 andy2 are congruent toeither0 or1 modulo4. Thus, ifn =x2 +y2, it follows immediately that n E3 (mod4), although11 mightbe congruent to0,1, or2. Thisaccounts forthe fact that3, 7,1 1, l5, 19, 23, 27, 31, 35, and39 inthe tableare notrepresentableas the sum oftwosquares, but itdoes not explain why nosuch representationexists for6,12,14, 21,22, 24, 28, 30, 33, 38, or42. From a different point ofview,we note that ifn =x2 +y2 and plnwhere pisa prime, then x2 E—y2 (mod17). Thus, -y2 isa quadraticresidue modulop. But erreve)=<r.—l>=<—»<v—w=—1 ifp E3 (mod 4), and thisis a contradictionunless xE y E0 (modp). Inthe latter case, itfollows that pzlx2 andp2|y2,so thatpzln, andwe obtain _2 \"1—x1+}’ia wherex =px1, y =pyl andn =pznl. IfpX n,, we stophere, but ifplnl, we proceed as before to show that p2|nl and ﬁ ndx2,y2, andn2 such thatpxz =x1, pyz =y1, pznz = m,and x3 +y2 =n2. Continuing in this way untilpno longer dividesn,- forsome i,wesee that n =p2n1=p4n2 =' ' ' =p2ini, so that p appears inthe canonical representation ofn withan even exponent ifn is to be representable inthe desired way. Ofcourse, thisgeneralizes the preceding condi- tion that11 notbe congruent to3 modulo4, and ifwe strike fromthe table allthose n that fail to meet this new requirement[i.e., allthose divisiblebyan odd power ofa prime p E3 (mod 4)],we ﬁ nd that allthe remainingvaluesare representableas the sum oftwosquares ofintegers. Thissuggests thatthe conditionis notonlynecessary, as we have justseen, but that itis also su ﬁ icient. We now prove thatthisis thecase. The proofdepends on the following identity, whichseems ﬁ rst tohave appeared in the book LiberAbaci by Leonardo ofPisa ofFibonaccifame: (a2 +b2)(c2 +d2) =(ac +bd)2 +(ad— bc)2. (7.1) Checking this identityis onlya matter ofsimple algebraic manipulationthat willbe left to the reader. Simple ornot,the importance ofthe formulais clear, for itshows Sec. 7.1 Sums of TwoSquares 173 that ifu andU can individuallybe representedas the sum oftwointegralsquares, then so can uv, and this immediatelysuggests an approach tothedesired proof.Indeed, any n satisfying the aforementioned conditioncanbe formedas the product ofprimes of the form 4k + l, ofsquares ofprimes ofthe form 4k +3, and ofpowers of2. Thus, itis onlynecessary toshow thateach such numberis representable inthe desired way. Since 2 =1 +1, equation(7.1) implies that2’\" =u2 +02 forsomeu and v and all m 21. Also, forany p,p2 =02 +172. Thus, inparticular,thesquare of any prime ofthe form 4k +3 is representableas the sum oftwosquares ofintegers. To complete the proof,we have only toshow thatevery prime ofthe form 4k +lis representableas the sum oftwo integralsquares. We ﬁ rst note that for pE1 (mod4), —_1 ._—__ (p-l)/2= (p)( 1) 1’ so that—1 is a quadraticresidue modulop. Thus, thereexists an integer z with 0 < z < p/Z and an integers such thatsp =z2 +1, thatis, such thatsp is the sum of two integralsquares. Also, itis clear that 2 0<Sp=22+1<%—+1<p2, so thatO <s <p. Now lets, be theleast positive integersuch thats, pis the sum of two integralsquares. Then 0<slss<p (7.2) and s,p =x2 +y2 (7.3) for some integers xand y. If31 >1, weuse a slight modi ﬁ cation ofthe division algorithm(see Exercise10 ofSection 1.7) to write x=qlsl+rla y=42sl+72 (7-4) with 0 S|r,-| S s1/2 for i = l,2. Thus, from(7.3), 31” =x2 +yz (7.5) = (fist + qsm+ ri+4&3? +2qzslr2 +r% and itfollows thatthere exists a nonnegative integer52 such that S,2 sls2=r¥+r§52—2— <s§, (7.6) so that0 S32 <s,. However, ifs2 =0, thenr1 =r2 =0, x =qlsland y =qzs1, so that sip =x2 +y2 =Sim? +(1%). 174 Sums ofSquares Chap.7 This implies that51| p, contrary to(7.2). Therefore,we actuallyhave 0 <s2 <s1. (7.7) Now, replacingr? +r§ byslsz in(7.5) and dividingbothsides ofthe equation bys1, we obtain p =s1(qi +4%) +2(qlr1 +qzrz) +s2, so that, by (7.6), 5217 =5132(‘Ii +4%) +232(‘11’1 +4272) +5% = (ri +r%)(qi +4%) +2s2(q.r1 +qzrz) +Si =(32 +4171+42792 +(41\"2 \"42702- But this is a representation ofszpas the sum oftwointegralsquares, inviolation ofthe minimality conditiononsl because of(7.7). Therefore,51 =1 and pitselfis the sum of two integralsquaresas claimed. Thus,we have proved the followingtheorem. THEOREM7.1. Anintegern canbe representedas the sum oftwosquares ifand only ifevery prime divisor ofn ofthe form 4k +3 appears inthe canonical representation ofn withan even exponent. Now itis clear from the table that noteveryn is uniquelyrepresentableas the sum oftwo integralsquares (one counterexample, after all,suf ﬁ ces toshow thatan assertion is notgenerally true). On the otherhand,as the next theoremshows, itis true that every prime p ofthe form 4k +lis uniquelyrepresentable inthisway. THEOREM7.2. Ifpis a prime ofthe form 4k+1, then pis uniquely representable inthe form p =a2 +b2 (7.8) ifwe agree to ignore the order andsigns ofthe integers a andb. Proof. Since we have already shown representability,we need onlyconcern ourselves withuniqueness. Suppose thatthereexistsa prime pE1 (mod4) such that p =a2 +b2 =c2 +d2. (7.9) Since p E1 (mod4),—1 isa quadraticresidue modulo pand itfollows fromLa- grange’s theorem thatthere exist precisely two incongruentsolutions irtothe congruence x2 E—1 (mod p). Thus,again byLagrange’s theorem,there exist pre- cisely two incongruent solutionsa = irb tothe congruencea2 E— b2 (mod p)and two incongruent solutions6 = irdtothe congruencec2 E—012 (mod1)). Since the signs are immaterial,we mayas wellsuppose that a E rb (mod p), c E rd(modp). (7.10) Thus, from (7.1) and (7.9), we obtain Sec. 7.1 Sums of TwoSquares 1 75 p2 =(a2 +b2)(c2 +(F) =(ac +M)2 +(ad— bc)2 (7'11) and, by (7.10), ad— bc E rbd— rbd E0 (modp). Thus, p2 divides all terms on boththe leftand rightsides of(7.1 1) and thisimplies,on dividing through by122, thatthere exist integersu andD such that l =u2 +v2. But this can happen only ifu =0 orv =0, and this implies that ac+bd=0 or ad—bc=0. (7.12) But since (7.9) clearly implies that(a, b) =(c, d) =1, itfollows thatad— bc =0 if andonlyifa=candb=dora=—candb=— d;andac+bd=0ifandonlyif a = -d andb =c ora =dandb = -c. Ineithercase, thisproves thattherepresen- tation (7.8) is unique withinthe limitsset. As in Theorem 7.2, itis sometimes desirable toconsider representationssuchas ﬁ =y+¥ =(— 3)2 +42 =¥+y as the same. Thatis, ineach ofthecases above, we are simplysaying that25 = 9 +16. On the other hand, ifone takes both order andsigns intoaccount, itis possible to prove the followingremarkable resultdue toJacobi. Wepresent ithere without proof. THEOREM7.3. Ifr(i,n) denotes the number ofpositive divisors ofthe positive integern whichare congruent to imodulo4, then the number ofrepresenta- tions ofnas the sum oftwo integralsquares, takingsigns and order intoaccount,is 4{r(1, n)— 1(3,72)}. EXERCISES 7.1 1. Show that Theorem 7.3 is correct forn =20, 21, and25. 2. Ifp is a prime and p E3 (mod4), we know thatp2 Ea2 +b2 forsome integersa and b. Prove that eithera =0 orb =0. 3. Itfollows fromExercise2 that ifp2 =a2 +b2 witha andb integers andab E0, then p E1 (mod4). Prove the converse ofthisassertion. Hint: We know that ifp E1 (mod4), then p =u2 +122 withuv E0. 4. Find rational nonintegers rands andan integern such thatn =r2 +s2. 5. Which integers n can be representedas the sum oftwosquares ofrational numbers? 1 76 Sums ofSquares Chap.7 6. Finda positive integern forwhichthere exist atleast three distinctrepresenta- tions ofn as the sum oftwo nonzerosquares (disregarding orderandsigns). Hint:Use equation (7.1). 7. Prove thatthe only representation of22\"~las the sum oftwointegralsquaresis 22\"“1 =22'\"2 +22’\"2 forall k 21. 8. Prove that forany nonnegative integer k,22\" =a2 +b2 witha andb integers only ifone ofa and b is zero. 9. IfnE 0 (mod 4) andn =a2 +b2, prove that(a, b)95 l. 10. Ifr =a2 +b2, s =c2 +d2, and (r,s) =(a, b) =(c, d) =1, prove thatthere exist u andU such thatrs =u2 +122 and(u,v) =1. Computer Exercise 11. Writea program tocheck Theorem7.3 for1 Sn s1000. 7.2 SUMS OF MORE THAN TWOSQUARES We have alreadyseen that not all positiveintegers canbe representedas the sum of two squares. On the otherhand,since1 isa square, itis clear thatevery positive integer is representableas the sum ofa suitable number ofnonzero integralsquares, and one wonders just how manyare needed torepresenta given integern. Inthis context, itis reasonable tosuppress thezeros and to forma table inorder tosee ifwe can gain some insight intothe problem. REPRESENTATION OF n WITH AMINIMUMNUMBEROF NONZERO SQUARESFOR1 S n s37 l=l 20=4+l6 2=1+1 21=l+4+l6 3=l+l+l 22=4+9+9 4=4 23=l+4+9+9 5=1+4 24=4+4+l6 6=l+1+4 25=25 7=l+l+l+426=1+25 8=4+4 27=9+9+9=1+1+25 9=9 28=1+9+9+9=1+1+1+25 10=l+9 =4+4+4+16 ll=l+l+929=4+25 12=4+4+4 30=1+4+25 l3=4+9 31=4+9+9+9=l+l+4+25 14=l+4+9 32=l6+l6 15=l+l+4+9 33=1+16+16=4+4+25 16=l6 34=9+25 17=l+l6 35=1+9+25 18=9+9 36=36 l9=l+9+9 37=1+36 Sec. 7.2 Sums ofMore Than TwoSquares 177 In the preceding table, we note thatat most fournonzerosquares suf ﬁ ce to represent anyn inthe interval1 Sn S37 and that only7, 15, 23,28, and31 actually require foursquares. Thissmallsample ofdata couldeasilybe enlarged, and careful inspection mightsuggest atleast two plausible conjectures: 1. Every positive integer canbe representedas the sum ofat most fournonzero, integralsquares. 2. No positive integer ofthe form 8k +7 canbe representedas the sum offewer than four nonzero, integralsquares. As a matter offact, bothconjecturesare true, although the fact that28 also required four nonzero squares makes itclear thatwe have notyetguessed the whole truth of the matter. Indeed, since any integralsquare is congruent toO, 1, or4 modulo8, itis clear that the only possibilities fora2 +b2 +c2 modulo8 are 0,1, 2,3, 4,5, and6. Thus, no It congruent to7 modulo8 is representable inthisway. Moreover,no multiple of4, say 4w, is representableas the sum ofthree nonzerosquares unless w itselfis representable in thisway. Tosee this,we note thateverysquareis congruent to 0 or1 modulo4 andhence 4w =a2 +b2 +c2 only if aEbECEO(mod2). w=<%)’+(%)’+(—:—>z with a/2, b/2, and c/2 nonzero ifabc is nonzero. Combiningthese results, itfollows that we have now obtained the followingtheorem. But then THEOREM 7.4. Nointeger ofthe form 4\"(8k +7) withh 20 and k 2O can be representedas the sum ofthree nonzero, integralsquares. The converse ofTheorem 7.4 is also true inthatevery integer not ofthe form 4\"(8k +7) can be representedas the sum ofthree nonzero, integralsquares. The ﬁ rst proof ofthis resultwas due to Dirichlet in1837, butno known proofis veryeasy and we willnot present one here. Turning now to conjecture1, we derive the followingresult, ﬁ rst proved by Lagrange in1770, seven years before the birth ofGauss. THEOREM 7.5. Every positive integercanbe representedas the sum ofat most four nonzero, integralsquares. Proof. The proof, whichis quite similartothe proof ofTheorem7.1, depends on the following identity, whichrequires onlydiligence forchecking. 178 Sums ofSquares Chap.7 (a2 +b2 +c2 +dz)(r2 +s2 +u2 +02) = (ar +bs +cu +dv)2 +(as— br— cv +a’u)2 (7.13) +(au +bv— cr -ds)2 +(av -bu +cs -air)2 In view of(7. l3), itis onlynecessary toprove thatevery prime pis representableas the sum ofat most fournonzero, integralsquares. Since we have already shown this tobe true for p =2 and all primes p E1 (mod4), itonlyremains toconsiderthose primes p E 3 (mod4). Let pbe congruent tothree modulo4. Then,as noted inthe preceding section, — y2 is a quadratic nonresidue modulop. Moreover,since thereare (p— 1)/2 qua- dratic residues12, 22,. . . , [( p— 1)/2]2 modulo pandprecisely p—1 numbers ina reduced residue system, the numbers—12, —22,. . . , — [( p— 1)/2]2are the qua- dratic nonresidues modulop. Differently put, ifu isa quadraticnonresidue modulo p, there exists a y with0 <y <p/2such that u E—y2 (modp). (7.14) Now, since1 is a quadraticresidue modulo1), itfollows thatthereexistsa least quadratic nonresidue u >1. Therefore,as notedabove, (7.14) holds with yinthe indicated range andu-— l =v 2 lisaquadraticresidue modulop. Thusagain, there exists xsuch that xZEvEu—l(modp) (7.15) with 0 < x <p/2. Combining(7.14) and(7.15), we obtain x2+y2+ l E(u— 1)—u+1 E0(modp), so there exists a positive integers such that sp =x2 +y2 +1. From thiswe also obtain 2 2 0<sp<(%) +(g)+1<p2, so that0 <s <p. Now let31 be theleast positive integersuch that31 pis the sum ofat most four integralsquares. Then 0 <s Ss <p, ‘ (7.16) slp=a%+a§+a§+a§, and the proof willbe complete ifwe can show that31 =1. Suppose, contrary to whatwe desire, that31 >1. We must then consider two cases. Case I. If31 is even, then itis clear that al, a2, a3, and(14 canbe grouped intotwo pairs ofequal parity,say al Ea2 (mod2) anda3 E(14 (mod2). Butthen, by(7.16), Sec. 7.2 Sums ofMore Than TwoSquares 1 79 al+az2 (ll—(122 (a3+a4)2((13—042+ + — (2 )+(2 )2 2 =a¥+a§+a§+a§_ ﬂ . 2 2 withS1 /2 an integer, and this violates the minimalityconditionon51 . Case 2. If31 is odd, thenas inthe proof ofTheorem7.1, we obtainintegersq,- and r, with0 S|r,-| <31/2 such that ai=qisl+ria i:1:2a 39 4- (7.17) Note that the oddness ofS1 is importanthere since ifs. is even, the inequalityon ther,- becomes 0 S|r,-| S s1/2,as inExercise10 ofSection1.7, and the remainder ofthe proof willthen break down. Inanycase, by(7.17), sm=a¥+a§+a§+a§ = qisi +2413171 +7i +qgsf +2qzslr2 +r§ (7.18) +433% +2q3slr3 +r3 +qis? +2q4slr4 +r3 and itfollows thatthere existsa nonnegative integers2 such that 2 sm=r¥+r§+r§+r§<4°(%)=Si- (7-19) Thus, 0 5s2 <51 and we nowargue thats2 #0. Indeed, ifs2 =0, thenr1 =r2 = r3 =r4 =0 and (7.18)gives slp =star? +q% +4% +4%). But this implies thats1| p, in contradiction to(7.16). Therefore,32=# O andwe have 0 <s; < sl. (7.20) Replacingr? +r3 +r§ +r3 byslsz in(7.18) and dividing bothsides ofthe equation by s,, we obtain 12 =s1(q%+4% +4% +4%) +2(q1r1 +qzrz +4373 +4m) +s2, so that, by (7.19), s21) =S.s2(q% +(1% +4% +4%) +23201171 +(1272 +4373 +4474) +3% =(r? +r% +r3 + rim? +(1% +(1% +61%) +23201171 +(1272 +(13\": +(1470+3% =(32 +(1171+(1272 +(1373 +614702 _((1171 +(1272 +4373 +(14702 +(r%+r%+r%+r§)(q¥+q%+q§+q ﬁ ) =a2+b2+cz+d2, 1 80 Sums ofSquares Chap.7 where the last equality follows byuse of(7.13). But thisshows that32p canbe representedas the sum offourintegralsquares, inviolation ofthe minimalitycondi- tion on31 in view of(7.20). Therefore,s1 =1 and pcanbe represented inthe desired form,as claimed. Again, representationsas the sum offourintegralsquares are notnecessarily unique,as we have alreadyseen. Indeed, takingorderandsigns intoaccount, Jacobi obtained the most remarkable result thatthe number ofrepresentations ofthe posi- tive integer nas the sum offoursquares is 80*(n),where a*(n)is the sum ofthose divisors ofn thatare not multiples of4, thatis, 0*(n) = 2d. dln 41d For example, 80*(8) = 8(1+2) =24 and the number ofrepresentations of 8=4+4+0+0 as the sum offoursquares takingsigns and order intoaccountis 4! 2'2'-2T2—!=24, as claimed. EXERCISES 7.2 1. Show thatJacobi’s resultis correct forn =4,5, 6, and15. 2. Find an integern and rationalnonintegersa, b,c, dsuch thatn =a2 +b2 + c2 +(1\". 3. Finda positive integern forwhichthere exist atleast fourrepresentationsas the sum of four integralsquares, disregarding orderandsigns. 4. If3k =x2 +y2 +22 with xyz E0, prove that kE5 (mod8) and, withproper ordering, thatone ofthe following must hold: (i) x2 Ey2 E22 E1 (mod4), (ii) x2 Ey2 E22 E0 (mod4), (iii) x2 Ey2 E1, z2 E0 (mod4), (iv) x2 Ey2 E0,22 E1 (mod4). . Ifx2+y2+zz+w2E0(mod8), provethatyEZEWEO (mod2). 6. If(x, y, z) =1 andu is even, show thatu2 =x2 +y2 +22 is impossible.UI Computer Exercise 7. Writea program to verifyJ acobi’s four-square theorem for1 Sn S1000. Sec. 7.3 Waring'sProblem 181 7.3 WARING'S PROBLEM The fact thatevery nonnegative integercanbe representedas the sum ofatmost four integralsquares is a specialcase ofa famous assertion due toEdward Waring in1770 and now knownas Waring’s problem. According to Waring,every positive integer can be representedas the sum ofat most4 squares, at most9 cubes, at most19 fourth powers, andso on, although itis almost certain thathe had no proof ofthese results. The “andso on” inthe precedingsentence was particularly intriguingsince itseemed to imply thatthere existsa least number g(k)such thatevery nonnegative integercan be represented by at most g(k) kthpowers. Itwas not until1909 that David Hilbert, in a most remarkable paper, infactshowed that g(k)exists forall k 22. We willnot prove Hilbert’s theorem here but willcontentourselves by provinga partialresult which gives a lower bound forg(k). THEOREM 7.6. Let kbe an integer and g(k)as above. Then k g(k) 22\" + [(g)]—2, (7.21) where the square brackets denote thegreatest integer in(3/2)\". Proof Fora given value ofk, let Him—1- We show thatIt cannotbe representedas a sum offewer than 2\" + [(q— 2 kth powers. From the notion ofgreatest integer, itfollows that k n52\"(%)—1<3\", so that only the powers 1\" and 2\"can be used inrepresentingnas a sum ofkth powers. Moreover, itis clear thatno more than [(3/2)\"] -lsummands of2\"canbe used withoutexceeding11. Since the remainder mustbe made up ofpowers1\", itis clear thatwe mustuse precisely 3 \" 3 \" 3 \"_k _ _ =k ___ _k _ k= k_ . 211(2)]1} 21(2)]1 21W”2 I powers 1\". Thus, the total number ofsummands requiredis just 3 k k k 3)\"]_ _ _ = _ _2[(2)]1+21 2 +[(2, and this implies the desired result. Itis interesting tonote that equalityis essentially known tohold inTheorem7.6 except in thecase of k =4, when 1 82 Sums ofSquares Chap.7 19 S g(4), although we willnotprove thisassertion. Itis also interesting tonote thatvalues of w(k) = 2\" +[(3/2)\"]— 2 are justthose given by Waringabove. Thus, wearer—2 =4+2—2=£ 33 w(3)=23+[(—) ]—2 2 =8+3—2=% and 34 w<4>=24+[<—>1-2 2 =16+5—2=19. Actually, equality in(7.21) is known to hold provided that k =2 or3, or k 26 and 3\"— 2\" +2 <(2\"-— l) [(%)k]. (7.22) And Mahlershowed in1957 that(7.22)is true forall but ﬁ nitelymanyvalues ofk. The conjectureis that itis true forall k 26. There is another function G(k)associated withWaring’s problem which in some ways is even more interesting than g(k). Toillustrate,we note that for k =3, it is known that only 23=23+23+13+13+13+13+13+13+13 and 239=43+43+33+33+33+33+13+13+13 actually require9 cubes, that alln >239 require at most8 cubes, and that alln suf ﬁ ciently large can be represented by7 cubes. Thus, foreach k 22, weare led to let G (k) denote the least positive integersuch that allintegers fromsome pointoncanbe representedas a sum ofat most G(k) kthpowers. Then,again for k =3, the following table suggests that itmay actuallybe thecase thatG(3) S5. Sec. 7.3 Waring'sProblem 183 NUMBER OF INTEGERSIN SELECTED RANGESOF 1000 THATREQUIRE nCUBES n Range1 2 3 45 6 7 8 9 1—1000 10 41 122 142 293 202 7315 2 1000—2000 2 27 113 283 358 194 23 0 0 9000— 10,0001 17 121 377 401 83 0 0 0 19,000 -20,0001 12 100 400 426 61 0 0 0 29,000— 30,0001 11 105 448 388 47 0 0 0 39,000—40,0001 13 117 457 384 28 0 0 0 On the other hand,as the followingtheoremshows, itiseasy toprove that G(3) 24. THEOREM7.7. g(3) 2G(3) 24. Proof. Ifxis an integer, then xE0,1, or—1 (mod3) andthesame is clearly true forx3. Therefore, ifx1, x2,x3 are anythree integers, itfollows that x?+x3+x§EO,il,i2, ori3(mod9). Therefore, ifn E :4(mod9), itfollows that itcannotbe representedas a sum of fewer than fourcubes. Since g(3) 2G(3)is obvious, itfollows that 57(3) 2G(3) Z4, as claimed. A great deal ofworkhas been expended inan effort toevaluate G(k), butaside from the fact thatG(S) =16, the problemseems quite dif ﬁ cultandthe onlyresults have established upper and lowerbounds. EXERCISES 7.3 1. Evaluate w(k) =2\" +[(3/2)\"]— 2 for k =5, 6, and7. 2. Show that1729 can be representedas the sum oftwocubes injusttwoessentially differentways. [See page12 ofRamanajuan byG. H. Hardy(Cambridge:Cam— bridge UniversityPress, 1940) foran extraordinaryanecdote concerning this number!] 3. Show that 6n2=(a+b)4+(a—b)4+(a+c)4+(a—c)4 +(a+d)4+(a-d)“+(b+c)“+(b—c)4 +(b+d)4+(b—d)4+(c+d)4+(c—d)‘, 184 Sums ofSquares Chap.7 where n=a2+b2+c2+d2. 4. Since every integer m can be written inthe formm =a2 +b2 +c2 +a’2 andevery integern can be written inthe form 6m +rwithO S r <6, prove thatg(4) S53. Hint: Use Exercise3. 5. Since n4 E0 or1 (mod16) accordingas nis even orodd, prove thatnon E 15 (mod16) can be representedas a sum offewer than15 fourthpowers and hence that G(4) 215. 6. Prove that G(4) 216. Hint: Assume thatevery integer ofthe form31~ 16’”is the sum of15 fourth powers, say31- 16’\" =x? +x3 +- - - +x15 forsome m 21. As inthepreced- ing example, this implies thatx,- E0 (mod2) foreach i. Hence note that .m—1= ﬂ ‘ m“3116 (2)+ +(2) and use the method ofdescent. Youmayalso want tonote that31 =24 +15- 14 is not the sum of15 fourthpowers. Computer Exercise 7. Writea program to determine the minimumnumber ofnonzero fourthpowers required to represent each n, lSn S1000,as a sum. 8 Multiplicative Number—Theoretic Functions 8.1 DEFINITIONS From time to time inthecourse ofourdiscussion we have had occasion toconsider functions whose domain ofde ﬁ nitionis theset ofpositiveintegers. Thus, inSection 2.5, we considered the functions t(n)and a(n), whichdenote, respectively, the num- ber ofpositive divisors and the sum ofthe positive divisors ofthe positive integern. And in Section 4.3, we introducedthe Euler ¢-function, ¢(n),whichdenotes the number ofpositive integers notexceedingn whichare relatively prime ton. Such functions, de ﬁ ned on theset ofpositiveintegers,are called number-theoretic func- tions. In Section 2.5 we show that t(n)= ﬂ(n,+1) (8.1) i-l and r (5+1 _1 0(n) =' i131 Pi _1 where n =i=1 p5\" is the canonical representation of11. Suppose now thatm andn are relatively prime positiveintegers. Thenwe can writen =H§=1 p3“ and m = [If-=1 qj-\"i, where thep,- andqj are distinctprimes, and itfollows that , (8.2) 185 1 86 Multiplicative Number-Theoretic Functions Chap. 8 1(mn) = fl(mj +1)- ﬂ(ni +1) =t(m)t(n) i=1 i=1 and s qlgnj+l _1r {n+1— 0(mn) = —' 11;! qj _1 il=_[1 Pi _1 Ofcourse, itis not generally true thata function fpossesses the property that f(mn) = f(m) f(it) when (m,n) =1. Onthe otherhand, itisa useful property thatis present suf ﬁ ciently often to make the study offunctionspossessing the property quite worthwhile. =a(m)a(n). DEFINITION8.1. Anumber-theoretic function fis called multiplicative if f(mn) = f(m) f(n) whenever (m,n) =1. Iff(mn) = f(m) f(n)forallmandn, then f is said tobe completely multiplicative. We have justseen thatthe functions t(n)and 0(n)are multiplicative,and readers can easily convincethemselves thatneither functionis completely multipli- cative. On the other hand, the functionq(n) =1 foralln and h(n) =n foralln are, clearly, completely multiplicative. Our purpose in this chapteris to study multiplicativenumber-theoretic func- tions in some detail. EXERCISES 8.1 1. Ifris ﬁ xed, show thatthe functionh(n) =n'is completely multiplicative. 2. Let p(n) denote the number ofdistinct primedivisors ofn. Forexample, p(12) = p(24) =2 and p(60) =3. Letq(n) = a”),whereais ﬁ xed andshow thatq(n)is multiplicative, but not completely multiplicative. . If fis completely multiplicativeand mln,show that f(n/m) = f(n)/ f(m). . If fis multiplicative, mln, and (m, n/m) =1, show that f(n/m) = f(n)/ f(m). 5. Ifn is a positive integer, show thatthe number ofpositive divisors ofn is odd ifand only ifn is a perfectsquare. 6. If fis multiplicative,prove that f(m1m2m3) =f(m1)f(m2)f(m3) ifthe mare pairwise relatively prime. 7. Ifm1, m2,. .. , m\"are pairwise relatively primeand fis multiplicative,prove that f(H i=1 m) =115;] f(m,~). 8. Let t*(n)denote the number ofpositive odd divisors ofthe positive integern. Show that 1*is multiplicative but notcompletely multiplicative. Hint: Trya few examples inorder toget started. Alsoargue that for(m,n) =1,:59) Sec. 8.2 Notation 1 87 dlmn and disodd ifand only ifd =d1 d2, where dl|m, dzln, andd1 andd2 are both odd. Ifyou need furtherassistance,see the hint forExercise5 ofSection8.2, noting that the number ofpositive divisors ofn is given byEdln1. 9. Let t’(n)denote the number ofeven divisors ofthe positive integern. Show that1’ is not multiplicative. 8.2 NOTATION In the next few sections we shall frequently want toadda number-theoretic function over the positive divisors ofa positive integern andwe shall indicate thissum by writing 24'\" f(d): forexample, 2f(d) =f(1) dll and 2f(d)=f(1) +f(2) +f(3)+f(6)- d|6 Also, 0(n) =2,1,\" dand 1(n) =24,” l. Manipulatingsuch sums can sometimesbe confusing andreaders may want to prepare themselves by ﬁ rst reviewing the formulasdeveloped inSection1.1. In particular, formulas(1 .2) to(1 .4), (1.6), and( l.7) wouldappear inthepresent context as follows: 2kf(d) = k' E ﬂ d), (8.3) dln dln 2k=k-21=k-t(n),(8.4) dln (III: 22f<d>g<b) = 2{f(d)- 2gun}. (8.5) din17\"\" dln blm 2Ef(d)g(b) = dZ ﬂ d)' 1;£0?) (86) dln blm In lm 2{f(d)+g(d)}=d2f(d)+2g(d)-(8-7) dln In dln Finally,we note that ifddividesn, then n/dalso dividesn; andas 0' runs through the divisors ofn, n/druns throughthe divisors ofn, inreverse order. Forexample,as d assumes, successively, the values1, 2,3, and6, 6/dassumes thevalues6,3, 2, and 1. In general, we have that E ﬂ d)= 21(2), (8.8) dln dln and this formulais frequentlyuseful. 1 88 MultiplicativeNumber—Theoretic Functions Chap. 8 EXERCISES 8.2 1. Write outthe followingpairs ofsums and show thattheyare equal. (a) 22f(d)g(b)and E ﬂ d)- 2g(b) dI6 b|9 d|612]!) (b) 2 2f(d)g(b)and 2 2f(d)g(b) d|12 b|(12/d) b|12 d|(12/b) 2. Show that 2 2f(d)g(b)=2 2f(d)g(b) dln b|(n/d) bin d|(n/b) for every positive integern. Argue thatevery term inthe left-handsumappears in the right-hand sum, and viceversa, byshowing that ifdlnand b|(n/d),then bln and d|(n/b), and conversely. 3. Show that 1 =91112 nkldln for every positive integern. 4. Ifn is perfect, show that 5. Let 0*(n)denote the sum ofthe positive odd divisors ofthe positive integern; that is, 0*(n) = Ed. d|n dodd Prove that 0*is multiplicative but notcompletely multiplicative. Hint:See Exercise8 ofSection8.1. Alsoargue that, for(m,n) =1, 261:2E“W: d|mn dllmdzln dodd dlodddzodd by showing thateach summand on the leftisa summand on the right,and conversely. 6. If fis completely multiplicativeand h(n) = 2 f(d), dln (1 odd show that h(n)is multiplicative but notnecessarily completely multiplicative. H int:See Exercise5. Sec. 8.3 MultiplicativeNumber—Theoretic Functions 189 7. Let fbe a multiplicative functionand let h’(n) = 2f(d)- d|n deven Prove that h’(n)is notnecessarily multiplicative. 8. Let a’(n)denote the sum ofthe positive divisors ofn whichare notthemselves divisible by4. Show that a’(n)is multiplicative. 9. Generalize Exercise8. 10. Positive integers m andn are called amicable numbers if0(m) =0(n) =m +n. Show that220 and 284 are amicable. 11. Ifm and n are amicable,as de ﬁ ned inExercise10, prove that (aél\"+(a%)“=l- 8.3 MULTIPLICATIVE NUMBER-THEORETIC FUNCTIONS The following theorems develop thebasic properties ofmultiplicativenumber- theoretic functions. THEOREM 8.1. If fis multiplicativeand not identicallyzero, then f( 1) =1. Proof. If fis not identicallyzero, thenthere mustexist an integern such that f(n)95 0. Since fis multiplicativeand(1, n) =1 foranyn, itfollows that f(n)=f(1 'n)=f(1)f(n)- Since f(n)#= 0, we may divide bothsides ofthisequation by f(n) toobtain f(1) =1, as desired. THEOREM 8.2. Letn =Hi=ipi\"be the canonical representation ofthe positive integerIt. If fis multiplicative,then f(n) = grow. Proof. The proofis made by inductiononr. Ifr =1, the assertionis obviously true. Suppose thatthe assertion is true for r =kand letn =1152”} 5“. Byassump- tion, f(.1:p5”) = iljl ﬂ pi“). 190 MultiplicativeNumber—Theoretic Functions Chap. 8 Also, since k (Hpt\", pm)=1 i=1 and fis multiplicative, itfollows that k k M) =f(1:1l P?\"P1’é¢‘l)=f(l—[ pi”)'f(P2’-‘tl)- i-l But then k+ l f(n) = Hlfont\"), as desired. Theorem 8.2 is particularly importantsince itreduces the problem ofevaluat- ing a multiplicative number-theoretic function ingeneral tothe problem ofevaluat- ing itfor primepowers, and thisis usually mucheasier. Forexample, ifone knewat the outset that 0(n)wasa multiplicative function,then Theorem8.2 would imply that 0(n) =11-l 0(1):”)- But {'1 =0(1), )Emir! d pri+l__1 =1+pi+p3+‘ ' ' +p?'= prl Hence, itfollows that r ?i+l _1 a n = —, ()11:11 Pi _1 as before. Similarly,since 1(n) is multiplicativeand1(1):“) is clearlyequal ton, + l, we obtain r(n) ={=1 up?) = :1(n, +1). THEOREM 8.3. If fand gare multiplicative,thenso are F = f' gand G = f/g,whenever the latter functionis de ﬁ ned. Proof Since fand gare multiplicative,we have for(m, n) = l, Sec. 8.3 Multiplicative Number-Theoretic Functions1 91 F (W)=f(mn)g(mn) =f(m)f(n)g(m)g(n) =f(m)g(m)f(n)g(n) = F(m)F(n). Thus, Fis multiplicative.G is shown tobe multiplicative inthesame way. THEOREM 8.4. If fand gare multiplicative,thenso is F(n) =Ed...f(n)g (n/d). Proof If(m, n) =1, itfollows immediately fromconsideration ofthe canoni- cal representations ofthe numbers involved that dlmn ifand only ifd =d1 d2, where dllm and dzln. Itis clear that(61,, d2) =1 =(m/dl, n/dz). Therefore,since fand g are multiplicative,we have that mm= 2f(d)g(3’15) = 2m2f<dld2)g(dm—d) dtlm dzln n= 2 2 female) (I). dilmdzln 2 But, by (8.6)as adapted from Chapter1, g,\" zlnf(d1)f(dz)g(§ —)g(ti—2): gnf(d1)g(%—) ;f(d2)g(dn2) = F(m)F(n). Therefore, F(mn) = F(m)F(n) and Fis multiplicative. COROLLARY 8.5. If fis multiplicative,thenso is F(n) =Edln f(d). Proof This follows immediately fromTheorem8.4 since the constant function g(n) =1 foreveryn is clearly multiplicative. Theorem 8.4 and Corollary8.5 make itpossible to constructnew multiplicative functions from functions thatare known tobe multiplicativeand frequentlymake it easy to show that functionsare multiplicative. Forexample,since 1(n) = El dln and the constant function g(n) =1 is multiplicative,we easily deduce that1(n)is multiplicative. Again,since 0(n) = 2d din 192 Multiplicative Number-Theoretic Functions Chap. 8 and the function f(d) =dis multiplicative, itfollows thata(n)is multiplicative. Finally, suppose thatwe de ﬁ ne00,01) =2d.\" d“.Since the function f(d)=d“is multiplicative, itfollows from Corollary8.5 that0,,(n)is also multiplicative.There- fore, by Theorem 8.2, 0a(n) = H04115\") i=1 ifn = Hi-ipf”is the canonical representation ofn. But forat=# 0, 001(1)?) =1“ +p? +p?“ +- -+p’h\"t p?(n,‘+ l) _1 -p? -1 Thus, itfollows that r pa(n,+ l) _11 0am)“; [IL—— -1 pi- and we have proved the followingtheorem. THEOREM 8.6. Ifaa(n) =2d,\" d“, a95 O, andn =TIE—1 1);\" is the canonical representation ofn, then r p?(ni+l) _1 a n = — EXERCISES 8.3 1. Ifn = Hi-ip5“ is the canonical representation ofn and fis completely multipli- cative, show that f(n) =I'LL.{ f( p,)}\"‘. 2. Show that00(11) =1(n) and01(n) =0(n). r \"1+1 1 '. . 3. Show that 02(n)— =0(n) H—+—1——, wheren = Hpg\"15 the canomcal i=1 i-l representation ofn. 4. For n >0, show that 22L=02(2n)' (1|!!a 5. Let p(n) denote the number ofdistinct primedivisors ofn and letq(n) =am\"). For n >0, let F(n) =2d,” q(d)and ﬁ nda formula for F(n) interms ofa and the canonical representation ofn. Sec. 8.4 The Mobius Inversion Formula 193 6. 7. 11. 12. 13. Forn >0, let12(n) =2d\", 1(d). Show that901)is multiplicativeand derivea formula for12(n) interms ofthe canonicalrepresentation ofn. Let r3(n) =Ed,\" 301) and derivea formula for13(n) interms ofthe canonical representation ofn. Hint: You mayneed the result ofExercise5 ofSection1.1. . Let tk(n) =2,1\", rk_1(d) for k 22, where11(n) =t(n). Derivea formula fortk(n) in terms ofthe canonical representation ofn. . If F(n) =Edl\" 13(d), show that F(n) =t§(n). 10.Let 1*(n) denote the number ofpositive odd divisors ofthe positive integern(see Exercise8 ofSection 8.1). Finda formula for1:*(n) interms ofthe canonical representation ofn. Let 0*(n)denote the sum ofthe positive odd divisors ofthe positive integern(see Exercise5 ofSection 8.2). Finda formula for0*(n) interms ofthe canonical representation ofn. Finda representation for a’(n) interms ofthe canonical representation ofn, where a’(n)isas inExercise8 ofSection8.2. Let(t: denote the Euler ¢- ﬁ 1nctionand let f(n) = 2¢(d). dIn Finda formula for f(n) interms ofthe canonical representation ofn. 8.4 THE MéBIUS INVERSION FORMULA In Corollary8.5 we considered the function Fde ﬁ ned interms ofthe function fby the equation F(n)= Z ﬂ d) dln for every positive integern. Thus,we have 1’0) =f(1), F(2) =f(1) +f(2), F(3) =f(1) +f(3), F(4) =f(1) +f(2) +f(4), F(5) =f(1) +f(5), F(6) =f(1) +f(2) +f(3)+f(6), and so on. Itis apparent thatthese equationscanbe solvedsuccessively forthevalues of fin terms ofthe values ofF, andwe obtain 194 Multiplicative Number-Theoretic Functions Chap. 8 f0)= F(l), f(2) =F(2) -F(1), f(3) =F(3) -F(l), f(4) =F(4)— F(2), f(5) =F(5) -F(l), f(6) =F(6)— F(3)— F(2) +F(l). Now, itis quite natural toask how f(n)canbeexpressed interms of F(l), F(2),. .. , F (n) for any value ofn. Indeed, itis not di ﬂ iculttoguess fromthe preceding equations thatthe desired relationshipis ofthe form M)= 2n<d>F (S) dln where [1(1) =1, 11(2) = -1,M3) =— 1, M4) =0, 11(5) = -1, M6) =1. The problem, ofcourse, is to determine the nature of ”(n)foreveryn. Since F(p) =f(1) +f(p) for any prime p, itis clear that f0?) =F(p) -F0) and that,u( p) should have the value— 1. Similarly,since F(pz) =f(1) +f(p)+f(p2), it follows that f(pz) =F(pz)— [F(p)— F(1)l ‘-F(l) = F(P2)— F(1)), so that“(122) should equal0. Inthesame way,we can conclude that,u(p°‘) should equal 0 forevery(1 >1. Moreover, fordistinctprimes pandq, since F(pq) =f(1) +f(p)+f(q) +f(pq) it follows that mm =F(pq) -[F(p) -F(l)] -[F(q) -F(1)] -M) = F(pq) -F(p) -F(q) +F(1), so that,u(pq) =1 =,u(p)p(q). Thissuggests thatthedesired functionis multiplica- tive. Making this presumption,we have the following de ﬁ nitiondue to A.F. Mobius (1790— 1868). Sec. 8.4 The Mobius Inversion Formula 195 DEFINITION8.2. The number-theoretic function,u, called the Mobius function,is de ﬁ ned by the equations #(1) =1, Mn) =(— 1)’ ifn =p1 p2- -- p,,where thep,- are distinctprimes, Mn) =0 if[FM forany primep. The following theoremshows that ourguess concerning Mn)and the relation- ship between the functions fand Faboveis correct. THEOREM 8.7. (The Mobius Inversion Formula). If f(n)is any number- theoretic function and F(n) =2,1,\" f(d) forn 21, then M)= 2#(d)F (g). dln Before proving this theorem itwillbe helpful tohave the followingresult, which depends on the fact that Mn)is multiplicative. THEOREM 8.8 _ l ifn=1, %”(d)‘{o ifn>1. Proof Ifn =1, then 2u(d)=2#(d)= ﬂ (1)=1- dln d|l Forn>1,let M<n>= 2M). dln Since,u is multiplicative, itfollows from Corollary8.5 that M(n)is multiplicative. Therefore, ifn =115.1 p3“ is the canonical representation ofn, Mm) = [1Most), i-l by Theorem 8.2. However, foreach i, M095\") = 2#(d) till)!\" =M(1)+M(p.~)+u(p%)+- - - +u(p£\"') =1+(—1)+0+- - - +0 =0. Thus, forn >1, Ed\", Md) =M(n) =0,as claimed. Proof ofTheorem8.7. Suppose that F(n) =2m» f(d). Then 196 MultiplicativeNumber—Theoretic Functions Chap. 8 2 mm (3)= 2#(d)- 2M) dln dln bln/d (89) = E 2ﬂ (d)f(b)- d|n bln/d w b is an integer. ButHowever, ifdln and b|(n/d),then n/dis an integer and ﬂ _\"_ ﬂ b bd a” L”). d bln and (dln/b). Therefore,as inExercise2 ofSection8.2, E 2#(d)f(b) = 2 I;”(d)f(b) (8.10) bin ln/bdln bIn/d so n/b is an integer and is an integer. Thissays that dlnand b|(n/d) ifand only if since any term appearing inthe left-handsum mustalso appear inthe right-hand sum, and vice versa. Ifwe now combine(8.9) and(8.10),we obtain dF 5>= dbSM)(d zg ﬂ mfu dln bln = E ﬂ b) 2Md) bln d|n/b =f(n) since, by Theorem 8.8, the innersum inthe last expressionis equal tozero, except in the case b =n, when itequals1. 8.5 THE EULER ¢-FUNCTION The Euler (b-function, ¢(n),whichgives the number ofpositiveintegersless than or equal to n and relatively prime ton, was introduced inSection4.3. Inthissectionwe prove again that W\") =1:\"[1192'i”(p.--1), where Hf=ip5” withn,- 21 foreach i,is the canonical representation ofn. The ﬁ rst theorem is the converse ofCorollary8.5. THEOREM 8.9. IfFis multiplicativeand F(n) =Ed,\" f(d) forn 21, then f is multiplicative. Sec. 8.5 The Euler ¢-Function 197 Proof. Since F(n) =2d,” f(d),we have bythe Mobius inversion formulathat f<n>=2 n(d)F(§). dln But then, by Theorem 8.4, fis multiplicativesince uand Fare both multiplicative. THEOREM 8.10. Ifn is a positive integer, then n = 2<l>(d)- dln Proof Corresponding toeach positive divisor d ofn isa set ofpositiveintegers allless than or equal ton whose greatest common divisor withn isd. Moreover,each positive integer notexceedingn associates withone and onlyone dinthisway. We shall, therefore, counteach ofthe integers1 throughn precisely once ifwe counthow many are associated witheach dand take the sum over allvalues ofd. Forexample, for n =12, the followingtable lists the various possibilities for dandshows with which deach ofthe integers from1 through12 isassociated. Values of d Associated Integers[VG-AWN—_ In the generalcase, those integers thatassociate witha given d inthedesired wayare just those members oftheset d, 2d,. . . , kd,. .. , (n/d)' d forwhich (kd, n) =d, thatis, those integers kd forwhich(k, n/d) =1 and kSn/d. Ofcourse, by de ﬁ nition ofthe (b-function, thereare just ¢(n/d)such values ofk. Therefore, summing over all the positive divisors ofn, we obtain = 2_ ” E”5 (d) Finally,since 2<15 (3)= 2¢(d) dln dln by (8.8), we obtain n = 2q')(d). dln 198 Multiplicative Number-Theoretic Functions Chap. 8 THEOREM 8.11.(b isa multiplicative function. Proof. As noted before, the function F(n) =n is completely multiplicative. Therefore, since F(n) =n = 2(Md) dln by Theorem 8.10, itfollows from Theorem8.9 thatqS is multiplicative. THEOREM8.12. Ifn isa positive integer, then ¢(n)=n2%d’. dln Proof. Applyingthe Mobius inversion formulatothe formula F(n) =n = 2(Md), dln we obtain M)= 2u<d>F (g) dln = _n#(d)_= M 2d E. d- THEOREM 8.13. Ifn =H€=1 p?\" withn, 21 foreach i, then ¢(n) = ﬂp?\"‘(p.~— 1). i=1 Proof Since ¢(n)is multiplicative, itfollows fromTheorem8.2 that (Mn) = Hl(Mp?)- Also, by Theorem 8.12, ¢(p§\")=p£\"'- 2#31) df’I _n../‘_(1_)£‘_(£i_) ﬂ 1£§2...m=. -1 _pi{l+pi+p%+ }\"(1) since ,u(p“) =0 fora 22. Therefore, ¢(p£\"') =p7“‘(p.-— 1) Sec. 8.5 The Euler ¢—Function 199 for each1', and «mm =1:11 (15(1)?) ={'1 pl‘“‘(p.-— 1). i=1 EXERCISES 8.5 1. 2. 10. 11. 12. Letn =H{=1 pi”With71, 2 lforall ibethe canonicalrepresentation ofn. Prove that 2m|,u(d)| =2'. Letn = Hf-lP?“ withn,- 2 lforeach i. Let f(n) =2d,\" y(d)r(d)and prove that f(n) =(—1)’« Hint: Note that fis multiplicativesince,u and rare multiplicativeanduse Theorem 8.2. . Ifg(n) =2d,\" ,u(d)a(d), ﬁ nda formula forg(n) interms ofthe canonicalrepre- sentation ofn. . Ifh(n) =2d\", u(d)¢(d),ﬁ nda formula forh(n) interms ofthe canonicalrepre- sentation ofn. . If fis a multiplicative number-theoretic functionand F(n) =2.11» ”(d) f(d) for every positive integern, prove that F(n) =H§=1 {l— f( pi)} ifn =ILL]p?“ with n,- 2 l foreach i. . Ifa(n) =2d\", u2(d)/¢(d) forevery positive integern, prove that a(n) =n/¢(n). . Ifn >0 and,6(n) =24”, ﬂ 2(d)/‘t(d), ﬁ nda formula for ﬂ (n) interms ofthe canonical representation ofn. . Ifn >0 andn2 =2d\", g(d), ﬁ nda formula forg(n) interms ofthe canonical representation ofn. . Let f(1) =1 and f(n) =(— 1)\" forn >1, where kis the totalnumber ofprime factors ofn. For example,f(2) =—1,f(6) = l,f(9)=1, andf(12) =— 1. De- ﬁ ne F(n) by F(n) =Ed.\" f(d)and prove that F(n) =1 or F(n) =0. Forwhat values ofn is F(n) =1? Prove that ¢(mn) =d¢(m)¢(n)/q’)(d) forany positiveintegers m andn, with d = (m, n). Let n and m1, m2,.. . , m\"be positiveintegers. Let d1= land let di= (Hjllmi, m)for2 S iSn. Prove that If l/n =2d\", g(d) forn 21, ﬁ nda formula for g(n) interms ofthe canonical representation ofn. 200 MultiplicatiVe Number-Theoretic Functions Chap. 8 13. If¢(n) =2d,\" h(d) forn 21, ﬁ nda formula forh(n) interms ofthe canonical representation ofn. 14. IfF(n) =Edln ﬂ d) for alln >1, prove that M)= 2xt(d)F (g)- ﬂ (n)[F(1)—f(1)]. dln 15. IfF(n) =Ildlnf(d) forn 21, show that fun =['1 FM (3) 16. IfF(n) =11d,\" f(d) and fis multiplicative,prove that Fis multiplicative.Is the converse true? 17. IfF(n) =Hap: d, ﬁ nda formula for F(n) interms ofthe canonicalrepresentation ofn. 18. Prove the converse ofTheorem8.7; thatis, iff(n) =2”,,,u(d)F(n/d) forall n 21, prove that F(n) =2,1,\" f(d). 8.6 OTHER INVERSION FORMULAS The French mathematician HenriPoincaréhas said: “Suppose Iapply myselftoa complicated calculation and withmuch dif ﬁ cultyarriveata result, Ishallhave gained nothing by my trouble ifithas notenabled me toforesee theresults ofotheranalo- gous calculations, and to direct them withcertainty, avoidingthe blindgroping with which Ihad tobe content the ﬁ rst time.”Thus, itis often worthwhile togive one’s worka careful reappraisal tosee ifthe methods employed might notbe used to obtain similar, or, perhaps moregeneral, results. Forexample, careful consideration ofthe result n = 2(Md) dln ofTheorem8. 10 reveals thatthe left-handside ofthe equalityis the sum21\".]1 , while the right-handside is the sum over the positive divisors ofn ofthe function ¢(d), which maybe de ﬁ ned by the summation d (W) = 21. '=1 (jfd)=1 This suggests the possibility ofprovingthe equality SW = 2g(d), dln where the functionss and gare de ﬁ ned bythe equations Sec. 8.6 Other Inversion Formulas 201 SW = i ﬂ j)(8.11) j=1 and g(d)= 2 f(j) (Illd)=l and one would naturally trytouse a method ofproofsimilar to that ofTheorem8. 10. Thus, letus associate each integer m,1 Sm Sn, witha divisor d ofn provided that (m, n) =0'. As before, those integers associated witha given dare ofthe form kdwith l S k S n/dand (k, n/d) =1. The sumEf=1 f( j) may thenbe obtained by summing over all values ofd thesums associated witheach d. Thatis, n n/d Z ﬂ j)= 2 2f(kd)- (8.12) 1-1 dln (ht/71;“ Suppose, in addition, thatwe assume that fis completely multiplicativeas the func- tion f(n) = lwas thatgave us n =Em (Md)above. Then f(kd) = f(k) f(d) and from (8.11) and (8.12) we have nd s<n> = 2 if(k)f(d) dln k-l (kan/d)-1 \"M =2f(d)° 2NC) (8.13) ”\"\" (ti/2L1 = 2‘,f(a’)s\"‘(-’3(1,) dln where n n/d S*<c_1)= 2f(k). k=l (kyn/d)‘l But since d runs through the divisors ofnas n/ddoes, (8.13)canbe rewrittenas n W) = Ef(-)S*(d) f_(n)s...=2f—(d)s(d) (8.14) =f‘”) 2~:f((dd))‘ dln 202 Multiplicative Number-Theoretic Functions Chap. 8 This is an interesting result inits own right, butthereason forobtainingn =Edln ¢(d) above was not just to obtain that formula butto obtain from itusing the Mobius inversion formulaa formula for(“11). Similarly,here ifwe write S_(n) S*(d) f(n) =2f(d)dln and use the Mobius inversion formula,we obtain s_(_*n) s(n/d) 7—02 ) =%”(d)f(n/d) =2 w(7’3 )iEi—i dln since fis completely multiplicative. Multiplyingthrough by f(n),wesee thatwe have proved the followinguseful theorem. THEOREM 8.14. If fis completely multiplicative, s(n)= ﬁ fe)and s*(n)= if(k), i‘l k-l (kJI)‘1 then 3*(n)— = 2#(d)f(d)S(% ) (8.15) dln This makes itpossible to compute the somewhat awkwardsum s*(n) interms of the much more easily founds(n). Asexamples, we note the following. COROLLARY8.15. Forany positive integern, ¢(n)— =n 2—(— ﬂd) dln Proof Ofcourse, thisis already knownas Theorem8.12. However, itfollows here directly from Theorem 8.14 bysetting f(x) =1 foralln. Then d>(n)=S*(n)= k}:1 and s(%) =g=§11 (kin)=1 and the result is immediate. COROLLARY 8.16. Forn 22, the sum ofthe positiveintegersless than or equal to n and relatively prime ton is just ¢(n)- n/2. Sec. 8.6 Other Inversion Formulas 203 Proof. Thisis the result ofExercise 4 ofSection 4.3, but itfollowshere trivially ifwe set f(n) =n for alln, forthen s*(n)is thedesired sum ofthe positiveintegersless than or equal ton and relatively prime ton and 43424231). d 2 Thus, n n * 71(71 +1) s (n)=2u(d)- d- ~2— d'\" (8.16) n M+(d) =— n (d) 2 2Ld +512\" But since n 22, Ed\", ”((1) =0 by Theorem8.8, and M— -¢<n) dln by Corollary 8.15. Substitutingthese results in(8.16), we obtain S*(n) =(Mn)° n/2, as desired. An interesting and inStructive alternative proof ofTheorem8.14 canbe ob- tained by makinguse ofthe result ofTheorem8.8 that E ﬂ (d)={l forn=1, d.\" forn >1. The desired conclusionis a corollary tothe followingtheorem. THEOREM 8.17. If fis any number-theoretic functionandn isa positive integer, then s\"‘(n)-= E#(d)S (g, ) dln where S(n/d) = 2,1\"; f(dj)and s*isas de ﬁ ned inTheorem8.14. Proof By Theorem 8.8, 2Md) = d|(k,n) 1 if(k, n)=1, 0 if(k, n)>1. Therefore, 204 MultiplicativeNumber—Theoretic Functions Chap. 8 s*(n)= ;f(k) (.53; = 2{f(k)' 2mm} (8.17) 16-1 diam!) = i2f(k)u(d). k=ld|(k,n) But1 S k Sn and d|(n, k) ifand only ifdln, k =jd,and1 S jS n/d. Therefore, n n/d 2 2f(k)/t(d)= 22f(jd) ﬂ (d),(8-18) k-ld|(k,n) dln j-l since each term inthe left-handsum appears inthe right-handsum, andviceversa. Combining (8.17) and (8.18),we obtain u/d S*(n) = 22f(jd)u(d) dln j-l n d =42 {#(d) 2mm} In j=l = 2Md) 3 (g). dln Alternative Proof ofTheorem 8.14. Suppose that fis completely multiplica- tive. Then, in Theorem 8.17, n/d S (3,) =1;f(jd) n/d = 2f(j)f(d) 1-1 71/4 =f(d) EfU) .i'l =f(d)s (3), where sisas in Theorem 8.14. Thus, fromTheorem8.17, we obtain s*(n) = 2u(d)f(d)s (g), dln as required. Sec. 8.6 Other Inversion Formulas 205 EXERCISES 8.6 1. *7. Prove that 2 k,_n ¢_(n>+ EH(1_ k=1 (k. n)=1 ifn >1 and n =Hf=1 p?‘ is the canonical representation ofn. Hint:Use Exercise5 ofSection8.5 to conclude that 2a711(al)= H(1—17,-) dln . Prove that ik3=_3__nd>(n)+ ”72151 (1— k=-l i-1 (k, n)-1 ifn >1 and n =115.; p5\" is the canonical representation ofn. . Forn >1, ﬁ nda formula for f(n)= i(2k—1) (if); in terms ofn and ¢(n). . If F(a) = Elfil f(oz/n) for allreal a 21, prove that f(a)=2]MODF(an ) n=l . If f(a) =25311 u(n)F(a/n) forallreal a Z l,prove that Hw= 2f(%) n-l . Deduce fromExercises 4 and5 that §MM[%] n=1 for all realoz 21. Let f3E 0 be completely multiplicativeand let 22.1 f(n)be absolutely conver- gent. If fis not identicallyzero, prove that E ﬂ n) 2M(M)f(M)- =1 m-l 206 MultiplicativeNumber—Theoretic FunctionsChap. 8 8.7 A FURTHER INVERSION FORMULA Careful consideration ofthe statement and proof ofTheorem8.17 reveals thatthe same method ofproofcan be used to obtainthe followingmoregeneral result involving the greatest integer function. THEOREM 8.18. Let S*(m, n) = Ef(k) k-l (k, n)-1 where fis any number-theoretic function. Then [tn/d] S*(m, n) = 2[#(d)' 2f(dj)]. dln j-l Proof. As inthe proof ofTheorem8.17, s*(m, n)= 2{f(k)- 2you} k-=1 dl(k,n) = 2 2f(k)/4d) = 2 2f(dJ')/t(d) dln j-l[MM] = 2{#(d)' 2f(dj)}. d|n j-I COROLLARY8.19. Let ¢(m,n) denote the number ofpositiveintegers not exceeding m whichare relatively prime ton. Then ¢<m n)=2y(d)[% ] dln Proof In Theorem8 18, take f(n)— lforeveryn. Then s*(m,n) =<;b(m, n), [m/d] [WI/d] 2f<dj>= 21=[—] j=l and itimmediately follows that ¢(m,n) = 2Md) [ ﬁ ] dln Chap. 8 Exercises 207 THEOREM8.20. As usual, let n(m)denote the number ofprimes notex- ceeding the positive integer m. Ifp,- denotes the ithprime, p, s M<p,+1, and n = Hf=1pi, then 7r(m) = 74%)—1 + 2Md) [g]. dln Proof. By Corollary8.19, ¢(m,n) = 2#(d) [g] dln gives the number ofpositiveintegers notexceeding m whichare relatively prime ton. But since n is the product ofallthe primes notexceeding J’,those integers not exceeding m and relatively prime ton are the integer1 andthe primesgreater than51—1 and less than orequal tom. Thus, 7r(m)— MM)+1 = 2#(d) [ ﬂ dln and the result follows immediately. EXERCISES 8.7 l. Ifm andn are positiveintegers, let g(m,n) denote the sum ofthe positiveintegers not exceeding m and relatively prime ton. Show that _ ﬂ ﬂg(m,n)—d2md/r(d)[d][d+l]/2. 2. Use the result ofTheorem 8.20 to ﬁ nd7r(168). 3. If fis completely multiplicativeand k >0, prove that kn S*(kn’ n) = 2”(d)f(d)s (7)9 dln where sis de ﬁ ned in Theorem 8.14 and s*is de ﬁ ned inTheorem8.18. 4. For k >0, n >0, prove that ¢(kn,n) =k- ¢(n). 5. For k >0, n >1, prove that k\" n 2h =k2¢(n) ' E. h=l (h,n)=l 208 Multiplicative Number-Theoretic Functions Chap. 8 6. For k >0, n >1, prove that 2h2=k_“n3¢(n)+ +_6_”1:[l(1_p (h,n=1) where n ={=1 pg”, withn,- 2 lforeach i,is the canonical representation ofn. Computer Exercise 7. Writea program to compute7t(m) forany integerm. Inparticular, compute 7t(10,000). 9 Simple Continued Fractions In this chapterwe considersome ofthe interesting, unusual, and useful properties of “fractions” ofthe type [10+ (11+ where do is an integer and wherea,- isa positive integer for all i 21. Sucha fractionis calleda simple continued fraction. Ifthereis a lastat, sayan, the fractionis said tobe ﬁ nite and clearly simpli ﬁ es toa rationalnumber. Ifthesequence a0,a1, a2, . . . continuesad in ﬁ nitum,the fractionis said tobe in ﬁ niteandone is immedi- ately faced withthe problem ofdeciding what, ifany, useful mathematicalmeaning it can be given. We willconsider this problem induecourse, butﬁ rstwe introduce additional notation and develop some ofthe properties ofﬁ nitesimple continued fractions. It willbe convenient todenote the ﬁ nite fraction 1 +—..____ a0 (11+.1 an 209 210 Simple Continued Fractions Chap. 9 by the (n +1)-tuple[(10, a1,. .. , an] and the corresponding in ﬁ nitefraction by [(10, a1, a2,.. .]. The fact thatwe mean simple continued fractions bythese nota- tions and notleast common multiples willbe clear fromthe contextand shouldcause no dif ﬁ culty. Observe thatwe willsometimesuse the notation[(10, al,. . . , ak, a,] with areal, todenote the fraction a+———— ° al+..l even though this fractionis notsimple. 9.1 FINITE SIMPLE CONTINUED FRACTIONS We have already remarked thata ﬁ nitesimple continued fractionsimpli ﬁ es toan ordinary rational fraction. Thattheconverse ofthisobservationis trueis shown in the following theorem. THEOREM 9.1. Any rational numbercanbe expressedas a ﬁ nitesimple continued fraction. Proof Let rbe any rationalnumber. Ifr =0, itis alreadyrepresented inthe desired form. Ifr ¢0, there exist integers u andv withv >0 anduaé 0 such that r = u/v. By the division algorithm,there existintegersa0 andr0 withO Sr0 <12 such that u=vao+ro (9.1) and we note thata0 <0,a0 =0, ordo >0 accordingas u <0, 0 Su <v, u 2v. If r0 =0, we have the u/v =a0 and theprocess stops. Ifr0aé 0, theprocess maybe continued to obtain v=roal+r,, 05rl<ro, ro=r1a2+r2, OSr2<r1, ................., (9.2) rk-3 =rk—Zak—l +rk—la 0 5rk—l <\"k—z, rk—2=rk—lak+rka 0=rk~ Sincer0 >r1 >r2 >- - - >0, itis clear thattheprocess can continue for onlya ﬁ nite number ofsteps, so that kmustexistsuch thatrk =0. Nowequations(9.1) and(9.2) can be rewritten inthe form Sec. 9.1 Finite Simple Continued Fractions 211 v/ro’ v r,1 _' =(11+— _a1 +, 0 r0 0/“ ............, r_ _1 —\" 3= k_1+ \" '=ak_.+——— ’k—z \"k—z rk—z/rk—l rk—2 “a _k9 rk—l and these clearly combine to yield _1_ a1 +.._ + i ak =[a0’a1,‘ ' ' wak]' Incidentally,we note thatak >1 sincerk_2 >rk_l andrk_2 =rk_,ak. Thiscompletes the proof. r=ao+ Since thea,- are the quotients inthe divisions inthe preceding proof, theyare called the partialquotients ofthe resulting ﬁ nitesimple continued fraction. This terminologyis also used inthe in ﬁ nitecase, even thoughthe division algorithm will no longer playa role. EXAMPLE9.1. Express 11/7as a simple continued fraction. Solution. Since 11=7~ 1+4, =4-1+3, 4=3~1+1, and 3=1-3+0, it follows that —1%=1+;1=[1,1,1,3]. 1+———1— 1+— Simple Continued Fractions Chap. 9212 Alternatively, 11 417—1+7—1+W: =1+——1—=1+ 11 _ 1+— 1+4 4/3 1 —1+———l—. 1+— 1 +— 1 3 Moreover, since3 =2 +1, we can also write %=1+——1—-1—=[1,1,1,2,l]. 1+——-l—- 1+——— 1 2+T This is illustrative ofthe followingtheorem. THEOREM 9.2. Ifak>1, then [ao,a1,. .. Proof The resultis immediatesince 9ak]=[a09ala- - - yak—l:11‘ ak=(ak— l)+'i'. Theorem 9.2 makes itclear thatevery rational numberhas two ﬁ nitesimple continued fraction expansions—one witha ﬁ nalpartial quotientak >1 andasec- ond the sameas the ﬁ rstexcept thatthe penultimate partial quotientisak—1 and the last is ak+1 =1. Ifthe last quotient inthe expansion ofa rational numberexceeds1, then,as the next theoremshows, the expansionis unique. Ifak> 1,bj> landTHEOREM9.3. a ak] =[b03 bl,-- -a bjL[£111,611,- .- thenk=jandai=bifori=0,1,2,. .. ,k. Proof Let €,-=[a,-,a,-+,,. . . ,ak]forOSiSkand ”i=[bisbi+l9-~ - ,bj] Sec. 9.1 Finite Simple Continued Fractions 213 for 0 s i s j.Withoutloss ingeneralitywe mayassume that k sj.Then :.-=a.-+———‘—— ai+l+-_ 1 u +— 0k 1 =a.+* I [ai+l9ai+2a- .- ’01:] l =ai+— €i+l for 0_<. i < kand {k =ak. Sincea,- is an integer anda, s5,- <a,- +1, itfollows that a,- = [5,] for0 S isk. Also, i,=a,- + 1/{mfor0 si<k. Similarly,b,- =[m]for 0 s i S jand u; =b,- +l/,u,.+, for0 S i< j.Note thatthese assertions require that ak >1 and bi >1 forthe casesi =k—1 and i= j-— 1, respectively.Since50 =go by hypothesis, itfollows thatdo =[60] =[,uo] =b0 andone can easily continuestep by step (or by mathematical induction) toshow thatat, =b, for0 S iSk. Finally, if k < j,then 1 ak=€k= ﬂ k=bk+— .uk+l with pk“ >0, and thisis impossiblesince(1,, =bk. Thus, k = jand the proofis complete. EXERCISES 9.1 1. Express the followingas simple continuedfractions. (a)15152 (b)—% (C) lit 2. Find the rational numbers represented by the followingsimple continuedfrac- tions. (a) [1, 2,1,3] (b)[1, 2,1,2,1] (C) {—5, 2, 4, 3] (d)[0,1, 4, 2] 3. Prove that[(10, a1,. . . , an] =[(10, a1,. .. , ak_1, Q]for1 S ksnwhere5,, is as in the proof ofTheorem9.3. 4. Examine the simple continued fractionexpansions ofrand— rforseveral differ- ent rationalvalues ofr. Does any patternseem toemerge? 5. Ifk>2,r=[ao,a1,a2,.. . ,ak]and a1> 1,provethat —r=[_(a0+1), 1,a1— 1,02,'' ' yak} 6. Ifk>2,r=[ao,al,a2,. . . ,ak]and al=1,provethat —r=[—(a0+ l),a2+1,a3,.. . ,ak]. 214 Simple Continued FractionsChap. 9 7. Ifa >b >0 and a/b =[(10, a1,. . . , an], ﬁ ndthe simple continued fraction expansion ofb/a. 8. Let§=[(10, a1,. . . , an]andlet,u =[£10, (11,.. . , an +a],whereaisaposi- tive real number. Prove that f>,u ifn is odd and i<,u ifn is even. Hint: Think of,u as a function of aanduse mathematical inductiononn. Computer Exercise 9. Writea program to ﬁ ndthe simple continued fractionexpansion ofany rational number. 9.2 CONVERGENTS In working withdecimals, itis frequentlyuseful to “round off”the decimalanduse an approximation inplace ofthe entire expansion. Thesame ideais useful with regard to simple continued fractions andwe are thus led tothe followingconsidera- tions. Leta0, a1,. .. , anbeasequence ofintegers witha, >0 forO <iSn. De ﬁ ne the sequences {pk};'__2 and{qi}?__2 bythe equations P—2=0:P—1 =lapi=aipi—l+Pi—2 forOSiSn, . (9.3) (1—2: 1,4—1=0a qi=aiqi—l+qi-2 forOSlSn. LEMMA9.4. Let{0.},(1).},{(1.} beas above. Then, forany positivereal0:, a,_ +_ [a0, a1,.. . ,a,_l,a]= ﬁ :_—: for0 S rSn. Proof. For r =0, the result maybe interpretedas a =cap—1 +17—2. ail—1 +4—2 which is true by (9.3). For r =1, the claimis that =«2% +17—1 a,a. [o] “Go‘l'q—l Since [(10, a] =a0 + l/a=(aao + l)/aand, by(9.3), ape +1L1 =oz(aop—1 +P—2) +p—1 aqo +61—1 a(aoq—1 +4—2) +(1—1 __ aao + l_ T’ Sec. 9.2 Convergents 21 5 the result is true for r =1. Assume itis also true for r =k;i.e.,assume that “Pk—1+17k—2a,a,...,a_,a=———-. [01 k1] a—l+qk—2 Then, by assumption, [(10, a1: ' '- sak—laaka a] l =a0+1 a +———-— ' (12+ ._1 . +1 ak+a l =aOaala-~~ yak—loak+a 1 (a): + a)pk-l +pk—Z 1 (ak + a)qk—l +qk—z =a(akpk—. +pic—2) +pk—l Mam—1 + qH)+qk—l ___ “Pk +pk—l aqk +qk—. by (9.3). Thus, the result follows by mathematical induction. DEFINITION9.1. Let r =[(10, a1,. . . , an] where thea, are integers and a,- >0 for0 < iSn. Then the rational numberr,~ =[(10, a,, .. . , ai]is called the ith convergent to the simple continued fractionr. The next theorem makes itquiteeasy tocalculate recursivelythesuccessive convergents toa given simple continued fraction. THEOREM 9.5. Let r=[(10, a1,.. . , an] andr,~= [a0,a1,. . . , oi]as in the preceding de ﬁ nition. Thenr, =pi/qias in(9.3) for0 S iSn. Proof. For i =O, (9.3) yieldsp0 =a0 ' 1+0 =do,go =a0- 0 +1 =1 so that p0 /q0 =a0 =r0 as required.Suppose thatthe resultis true for i=h whereh is some ﬁ xed but unspeci ﬁ ed integer withO Sh <n. Then, by(9.3) and Lemma9.4, 21 6 Simple Continued Fractions Chap. 9 rh+l=[a09als-- - ,ahaahH] l =[ao,al,. . . ,ah+ ah+l =(ah +l/ah+1)ph—l +pix—2 (ah +1/0h+1)4h—1 +411—2 =ahph—l +ph—2 +Ph—1/ah+1 tWill—1 +qh-Z +qh—l/ah+l =ph +ph—1/a1.+1 411 +qh—l/ah+l =ah+lph +ph—l =Ph+1 ah+lqh +qh-l qh+l and the desired result holds forh +1 ifitholds forh. Thus, itholds forall iwith O S iS nas claimed. The work ofcalculating thesuccessive convergents can nowbe arranged ina convenient tabular form. Forexample,suppose we wantthe convergents for [2, 1, 4, 3, 2]. We then have i —2 —1 01 2 3 4 a, 21 43 2 p,» 01 2 3 14 45 104 q,1 01 1 5 16 37 wherepo=2 -1+0=2, pl=1-2+1 =3,andso on forboth thep’sandq’s. Thus, the desired convergents are 14 45 104 2, 3, '3‘, E,and W. Incidentally, itiseasy tosee thatthesuccesssive convergentsare here alternately smaller than and larger than the ultimatevalue of104/37 and thateach is closer to 104/37 than itspredecessor. Inthis particularcase, we have Sec. 9.2 Convergents 21 7 2_&__m 37 2960’ -241:560 37 2960’ E_19‘! =5 16 37 2960’ and ﬁ nally 1% _101 = 37 37 This is true ingeneral,as the followingsequence ofresultsshows. THEOREM 9.6. Let[(10, a1,. . . , an] and pi/qibeasin(9.3). Then pq—l “qkpk—l = (‘1)k_l,1 5k 511. (9-4) Proof From (9.3),we have thatp0 =a0,qo =1, p1 =alao +1, andq1 =a1,so that P140 ‘41170 =(“100 +1) “alao = 1=(—1)1’1. Thus, the result is true for k =1. Suppose that itis also true for k=h, where 1 S h <n. Then Ph+1qh \"4h+1Ph =(ah+1ph +Pix—1M}; — (ah+lqh +4h—1)Ph =_(phqh—l _ th-l) =—(—1)h-1=(—1)h. Since the resultis true forh +1 ifitis true forh, whereh is any integer with1 sh <n, it follows that itis true for all iwith1 S iSn. COROLLARY 9.7. For0 S kS11, (pk,qk) =1. Proof Ifd =(pk,(1,), then, by(9.4), d|(—1)\"“.Thus, d =1, as claimed. COROLLARY9.8. For1 S kSn, ‘11: qk—l (Ik—l ' Proof. This follows from(9.4) by dividingthrough by qq_1. 21 8 Simple Continued Fractions Chap. 9 COROLLARY9.9. For2 S kSn, ﬂ_ pH= (-1)\"d:._ (96) 61k t1k—2 qq—z Proof Using (9.3), we have that qk—z _QkPk—z =(akpk—l +Pk—2)Qk—2 _(“Mk—1 +4k—2)Pk—2 =ak(pk—1qk—2 -qk—lpk—Z) = (“1)kak. The desired result now follows immediately on dividingthrough by qq_2. THEOREM 9.10. Ifq, denotes the denominator ofthe ithconvergent to [(10, a1,. . . , an], as above, then iqH, lsisn with strict inequality for i>1. Also,q,- 2 iforalli. Proof. Sinceq0 =1, the last assertionisa clear consequence ofthe ﬁ rst. Also, sinceqo =1 Sa1 =q,,the ﬁ rstassertionis true for i=1. Suppose itis also true for all isuch that1 S iS kforsome ﬁ xed positive k <n. Then, by Theorem9.5, qk+1= ak+lqk +qk-l >(1k +0 =qk since ak+1 21 and the result holds foralli,as claimed. THEOREM 9.11. The convergents to[£10, a,,. . . , an] satisfy the follow- ing inequality: &<&<...<&<...<&&(9_7) ‘10 Q2 qn ‘13 41 Proof. Since the right-handside of(9.6)is clearly positive ifkis even, the even-numbered convergents forma strictlyincreasingsequence. Similarly,the odd- numbered convergents forma strictlydecreasingsequence. Therefore, itfollows that pn/qn is the largest even-numbered convergent orthe smallest odd-numberedcon- vergent accordingas n is even orodd. Nowleth be odd and kbe even. Ifh <k, then h S k—1, and since k—1 is odd, ﬂ2Pk—l 61h qk—l Also, by Corollary9.8, since kis even and qq_l>0 by Theorem9.10. Therefore, Sec. 9.2 Convergents 219 ﬂ ZPk—i > ﬂ . (1h qk—l 4k On the other hand, ifh >k, thenh—1 2kand the preceding argumentcan be repeated using h instead ofktoagain obtain “>3 (1h qk Thus, ﬁ nally, any odd-numbered convergentexceeds any even-numbered conver- gent and the proofis complete. THEOREM 9.12. Let a =[a0,a1,. . . , an] withan >1 so that ais the rational numberpn/qn. Then, for1 S iSn, we have that la— ﬂ l<la— b(9.8) (I: (Ii—1 and that Iaqi _I7i| <[OIQi—l _pi-l|- (9.9) Proof Assume that(9.9) holds. Thensince qi Zqi_1 Z1 foriZ lby Theorem 9.9, Pi1 l a \"— =—01 \"'Pi l 4:\" ‘1: qt 1 < E“(Ii—1 _pi—l ' (9.10) = hla _ El ‘1;- (Ii—1 S la— h. (Ii—1 Thus, we need only prove (9.9), Let ai =[ab am,. . . , an] for0 S iSn. Then 1 = + a a0 a, +._ 1 - a,- + — ai+l +- .1 . + _ an =[00, a],- -- , ai9ai+l] =ai+1pi +Pi~1 ai+lqi +qi—l by Lemma 9.4. From thiswe easily obtain 220 Simple Continued FractionsChap. 9 ai+l(aqi _Pi) =*(a4i—1 \"Pi—1)- Taking absolute values, we obtain laCIi—1 _Pi—1|= ai+1|aqi _Pil >ICWIi _Pii since ai+1>1. Thus, the result holds for1 Si<n. For i =n, we have that Iaqn _pnl =0 and _pn—la >0iaqn—l _pit—II =qn-l n—l by Theorem 9.11 since q\".l >0,so the resultis true for i=n also. EXERCISES 9.2 1 . Find the convergents forthe followingsimple continued fractionsandshow that they satisfy Theorems9.11 and9.12. (a) [1, 2,1, 3, 2] (b) [-3,2,1,1,2] (C) [3.7.1,1,7,1](d) [2,1,1,2] (e) [3, 2, 3] (f)[4.1, 2,1, 4] 2. Compute the ﬁ rst three convergents inthe continued fractionexpansion of 3.14159. 3. If(10 >0 and pn/qn =[a0, a,,. . . , an], prove that pn/pn-1=[amart-1:- ‘-9 (11, do]. 4- pn/qn=[ao,a1,. . . ,an], prove thatqn/qn—1=[ama,.—1,- -- ,all- 5. A ﬁ nite simple continued fractionis said tobe symmetric incase a, =an_,- for 0 S iS n. Forexample, [2,1, 3,1, 2] is symmetric. Ifthe rational fraction r/s with r >s >0 and (r,s) =1 expands intoa symmetricsimple continued fraction, prove thatr|{s2 +(— l)\"”‘}. Suggestion: Use Exercise4. 6. Suppose that r> s>0, that(r, s)= l,and that r/s=[a0,a1,. . . , an]. If pn|{q,2,+(-1)\"“),prove thata,- =an_,-for0 S isn,so that[(10, a1,. . . , an] is symmetric. Computer Exercise 7. Writea computer program toevaluate ﬁ nitesimple continuedfractions. Sec. 9.3 In ﬁ nite Simple Continued Fractions 221 9.3 INFINITE SIMPLE CONTINUED FRACTIONS Let[£10, a,,a2. . .] be an in ﬁ nitesimple continued fractionand let pn/qn= [(10, a1,. .. , an] be its nthconvergent. Then itis clearthatthe formulas ofSection 9.2 still hold but withthe upper limitson the indices removed. Thuswe have that Pi =aipi—l +Pi—2, i20, (9.11) 41' =aiqi—l +(Ii—2, where12.2 =q—t =0 and17—1 =q—z =1, pq—l -qkpk_1=(-1)\"\", k 21, (9.12) (pk, qk)=1’ kZOa (9'13) __ k-l ﬂ—\"—\"\"=——————( I), ka1, (9.14) qk ilk—1 (Ik—i __ k ﬂ _h=m’[(22,(9.15) 61k 4k—2 tqk——2 41 2‘10, qi>qi—l, i>13 (9-16) qt 2i, 1209 and, in thiscase, (9.7) becomes 0 2 4 (9.17) a>a>&>.u_ (11 43‘15 Also, we stillhave that Q < Q,h even, kodd. (9.18) (I). ‘11: Now, since the sequence {s/qzk}k>ois increasing and boundedabove, itis convergent. Similarly,the decreasing sequence {P2k+1 /q2k+,}k>0 is also convergent. Let lim Q= s 16-“42k and 1i mP2k+1 =T. k‘”42k+1 222 Simple Continued FractionsChap. 9 Ifwe can show that S =T, itwillfollow that lim &=S k-*°° 4k and it willbe reasonable tode ﬁ ne S tobe the value of[(10,a1, a2, . . .]. Tothisend, we use (9.14) and (9.16) to obtain 0 < a_EEC = __l_S _____l__ 42k+1 42k qZk+qk (2k + ”2\" Therefore, 0 5 lim11—2,.“ —& s0, k-W 42k+1 42k so that S = Tand we have proved the followingtheorem. THEOREM 9.13. If[a0,a1, a2,. . .] is any in ﬁ nitesimple continued fraction and1),, /q,, is its nthconvergent, then thereexistsa real number6 such that . Pn = llm — 6 \"“°qn and we de ﬁ ne i=[a03ab(12,° ° '1' THEOREM 9.14. The real number5 ofTheorem9.13is irrational. Proof. We have noted that iis the common limit ofthe increasingsequence {s/42k}kzoand the decreasing sequence {p2k+1 /q2k+,}k20. Therefore, foranyn, é lies between pn/qn and 1),,“/q,,+1, so that, by(9.14), Pn+1 _ ﬂ1 qn+1 qn qn+1 q)! Now suppose that6 is rational,say 6 =a/b,where a andb are integers withb >0. Then an n 0< < l t‘InH ﬂ _En.< Obqn and hence <10 <laqn -bpnl < n+1 forn 2b sinceq,,+1 2n +1. But thisis impossiblesinceaqn— bpn is an integer,so i is irrational,as claimed. Sec. 9.3 In ﬁ nite Simple Continued Fractions 223 Theorem 9.13 shows thatevery in ﬁ nitesimple continued fractionconverges to an irrational number. We nowshow thatevery irrational5 canbe represented uniquelyas an in ﬁ nitesimple continued fraction whichconverges tothe value5. THEOREM 9.15. Let ibe an irrationalnumber. Thenthere existsaunique simple continued fraction[(10, a,, a2,. . .] such that i:[‘10, a1: a2,- - .1. Proof Let60 = fand recursively de ﬁ ne a: =[61‘], 4+1 =é—l—E’ i20- (9.19) Itis clear that 5,.“is irrational if6,- is irrational.Since60 is irrational, itfollows that ii is irrational for all i Z0. Moreover,since5,- -a,- is the fractionalpart of6,, itis clear that {m >1 and thatthe integer a,“21 forall i20. Since (9.19)canbe put inthe form 1 €i=ai+é—,1.20, i+l we obtain by repeated application that i 51 1 1 a+— ‘ £2 §o=ao+ =ao+ =[‘10,(11,-° 'a an, {n+1} ____ 571+a +pn—l €n+lqn +qn-l by Lemma 9.4. Therefore, by (9.12) and (9.16), Pu 0 S60 —q—n €n+lpn +Pn—i__ £4 €n+lqn +(In—1 4n pn—lqn _(In—1P» qn(€n+lqn +(In—1) 1 l <—S-. (1» n 224 Simple Continued Fractions Chap. 9 Thus, €=€o=lim &, \"“\"°qn as desired. To show uniqueness, we suppose thatwe also have60 =[b0,b1, b2,. . .]. Let pg/q ﬁ , denote the nthconvergent to[[70,b1 , b2,. . . ],1et{,- =[a,-, am,51,-”,. . .], and let it, =[biabH—l’ bi+29.. .]. Then p6 pi1b=—< = <—=b +—sb+1 ° 46 6 5° qi°b1 ° and itfollows thatb0 =[(0] =(10. Moreover, €0=lim[b09 b1:0 - - abn] . l ‘33:{b°+[b,,b2,. .. ,bnl} 1 =b +—. 0 ii But then,as above, b. =[6;]and Since a, =[51], we nowhave a, =b,also. Proceeding by induction,we ﬁ nallyobtain a, =b, for i 20 and the proofis complete. EXERCISES 9.3 1 . Forn 22, show thatq\" 2\"+1, where F\"is the nthFibonacci numberand1),, /q,, is the nth convergent to[(10, a1, a2,. . .]. . Evaluate [1,1, 1,. . .] = [l]by two differentmethods. . Find the simple continued fractionexpansion ofJ2. . Evaluate the simple continued fraction[2,1, 1,1,. . .] =[2, i]. . Evaluate each ofthe following. .. (a) [2, 2, 2,. . .] =[2] (b) [2,1, 2,1, 2,1,. . .] =[2,1] 6. Given that[(10, a1, a2,.. .] and[b0,b1, b2,. . .] have identicalconvergents pi/q, for0 S isn, prove thata,- =b,- for0 siSn. 7. Let iand ube tworeal numbers. Wesay thatC is equivalent to uand write6 ~g inUI-BWN Sec. 9.4 Periodic Simple Continued Fractions 225 case there exist integers a,b,c, and d withlad -bcl =1 such that €=a ﬂ +b c,u+d' (a) Prove that this relationis an equivalence relation inthe usual technicalsense. (b) Prove that any rational numberis equivalent tozero andhence, by part(a), that all rational numbers lie inthesame equivalenceclass. (c) If i=[ao,a,,. . . ,an,c,,c2,c3,. . .] and y=[bo,b,,. . . ,bm, cl, cz, c3,. . .], prove that6 and uare equivalent. (Theconverse ofthis assertion is also true, but itis much more di ﬂ iculttoshow.) Computer Exercise 8. Writea program to compute the simple continued fractionexpansion ofx/ ﬁ for l S n S 100. Can youguess a theorem? 9.4 PERIODIC SIMPLE CONTINUED FRACTIONS The readerhas probably noticed thatthe “periodic”simple continued fractions inthe exercises ofSection9.3 were expansions ofirrationalnumbers ofthe form(a +bx/E)/ d, where a, b,c, and dare integers withc >0 and nota perfectsquare andconversely. These numbersare called quadraticsurds and mayalso be de ﬁ nedas the real irratio- nal roots ofquadratic equations withintegralcoe ﬂ icients. Thatquadraticsurds always have periodic simple continued fractionexpansions, andconversely,is shown in the next two theorems. THEOREM 9.16. If:=[a0,a1,. . . , (2,,. . . , d,+k],where randkare nonnegative integers, then5 is a quadraticsurd. Proof Let u =[11,,. .. , d,+k]. Then, by Theorem9.14, pis irrationaland .u = lat:ar+l”: '' 'a ar+ka #] (920) =up +p M’+ q”’ where p’/q’and p”/q”are the last twoconvergents to[a,, a,“,.. . , a,+k]. From (9.20) itfollows that #211' +#01” -p’) -p” =, (9.21) so that,u is a quadraticsurd. Thus[1 =(a +bx/E)d witha,b, c, dintegers andc >0 and nota perfectsquare. But 226 Simple Continued Fractions Chap. 9 i=[a0’a1,- -- :ar—I’Il] =upr—1+p,_2 ”qr—1+qr—2 a+bx/Z’ d 'pr—l +pr-2 =a +bx/E d ' qr-l+qr—2 =A+BJE D for some integers A, B, and D. Thus5 is also a quadraticsurd,as claimed. THEOREM 9.17. Let €=[ao,a,,a2,. . .] bea quadraticsurd; then [(10, a1, a2,.. .] is periodic fromsome pointon. ProofSince 5 isa quadraticsurd, there existintegersa,b, c withb2— 4ac >0 and nota perfect square such that a? +b6 +c =0. (9.22) LCt in =[am an+l9an+29 ' ' '1' ThCIl c:[(10, a1,(12,-- -a arr-l:ﬁ n] ={um—1 +pn—2 énqn—l +qn—2 Substituting this into(9.22), we obtain 2 a (énpn—l +pn—2) +b (énpn—l +pn—2) +C =0, inqn—l +qn—z {nan—1 +(In—2 and itrequires only diligence on the part ofthereader toshow thatthisreduces to Anéf. +Bnén +C, =0, (9.23) where An =(11731—1 +bpn-lqn-l + nx-i, Bu =2apn_1pn_2 +b(q,.—2p,._1 +(In—lpn—z) +Zeqn—lqn—z, C. =aIJi—z +bpn—a—Z +(113—2 = AH, and 2 _ =2 — _2B\" 4 AnCn =21; _44$)(pn—1t1n—2 qn—lpn—z) (9.24) Thus, since ithas thesame discriminant,b2— 4ac,as (9.22), itfollows that, for each n, Sec. 9.4 Periodic Simple Continued Fractions 227 A,,x2 + a+C\" =0 (9.25) is a quadratic equationwhose rootsare real and irrationalandhenceare quadratic surds. Therefore, by (9.23),6,, isa quadraticsurd thatsatis ﬁ es (9.25) foreachn 20. Now,as in the proof ofTheorem 9.14, but withn replaced byn— 1, we have that _p_,,._1 _1_<1 5(In—1 <qn—lqn _qtzl-l for n 21. But this implies that = M_ a (In—1 (Ii—1 with |6 _,| < l,and hence that 17,—. ={qt—1 +:\"—':. (9.26) Using this inthe expression for A\"above, we obtain 6\".2 6\". An =a (éqn—l +q I)+b (éqn—l +q I)qn—l +Cq3,_1 n-1 n—1 2 =(41:2 + b: +c)q§,_l +2a§6,_, +262\"“ + b6,.,. 71—] Since(162 + b: +c =0 by (9.22) and|6_1| <1, this implies that IAnl <2laél +Ial +W =K, so that|A,,| is bounded for alln. Since C\" =A\"-1 , itfollows that|C,,| is also bounded for all11. Finally, by (9.24), Bf, =4A,,C,, +b2— 4ac s4|A,,||C,,| +b2— 4ac, so that|B,,| is boundedas well. Nowthe boundedness ofA\",B\", and C\" implies that even though It assumes in ﬁ nitelymanyvalues, there exist only ﬁ nitelymany different triples(An, B\", C\"). Thus, there mustexista triple(A, B, C) thatoccurs atleast three times, say (A, B, C) =(Am, Bni,Cm), i=1, 2, 3, and our argumenthas shown that ineachcase,in,- isa root of s+Bx +C =0. Since this equation can have only tworoots, itfollows thattwo off,“, {n2, and in,are equal, say in, =ﬁ nk. But then 0», =[43\",] =[ink] =any 1 €nj+1 = a:*= —‘_'=Cm,“, an,» €711; _an), and so on. This implies thatthe simple continuedexpansion ofC is eventually periodic,as claimed. 228 Simple Continued FractionsChap. 9 EXERCISES 9.4 1. Let a be a positive integer and let u =[d]. (a) Show that,u =(a +Vaz +4)/2. (b) Evaluate [0, d]. (c) Letv =(a -Jaz +4)/2 and show that ”n+l_vn+l 4\" «m’ where pn/qn is the nthconvergent to [a] forn 20. Hint: Itmay help toshow ﬁ rst that#2 =up +1 andv2 =av +1. (d) Show that p\" =q,,+1 forn 20, wherepn andq”areas inpart(c). (e) Lettn =q,,_2 +q\" forn 20 and show thattn = at”.l +tn_2 forn 22. (f) Show thatt,, =,u\" +v” forn 20. (g) Show that =at\" +(a2 +2)q,,_l \" 2 for n 20. 2. Ifa =1 inExercise1, itis clear fromBinet’s formula(see Exercises12 and14 of Section1 .4) thatq\" = F“,and thattn =L\",where F\"and L,are the nthFibonacci and Lucas numbers, respectively. (a) Prove thatLn + L,”=5F,,+1 forn 20. (b) Prove thatLn +F” =2F,,+1 forn 20. (c) Prove that for alln 20. 1’2t=F4119 L2n+lF2n =F4n+l _1, L2nF2n+l =F4n+1+1, L2n+lF2n+l =F4n+2- (d) Prove that, for alln 20, Li-5F3.=(-1)\"-4, LnLn+1_5FnFn+1 =(_1)\"'2- (e) Prove that 2Fm+n = Fa+ Fa for n 20, m 20. 3. In Exercise 2 and inearlierexercises scattered throughoutthe textwe have exhib- ited numerous properties ofthe Fibonacci andLucassequences. Trytogeneralize some ofthese results to apply toq\" andtn ofExercise1. 4. Let f=[a'o, al,.. . , an] withn 21. Then, by Theorem9.16,E isa quadratic Sec. 9.4 Periodic Simple Continued Fractions 229 surd and hence _a+b\\/Z‘ 5“d witha, b, c, and dintegers andc >0 and nota square. Prove that f>1 and that —1 < 5’ <0, where ,__a-b\\/Z* ‘5— d is the conjugate of i. Hint:Observe that6 and 5’ bothsatisfy f(X) = Xa+x(qn—l-1711) —pn—l =0 and show that f(x) musthave a rootbetween— land0 byshowing that f(0) <0 and f(— I) >0. 5. The converse ofthe assertion inExercise4 is also trueandcanbe proved inthe following way. (a) Ifa andB are quadraticsurds and1 /oz = ﬂ— rwhere ris an integer, prove that l/a’ =[3’— rwhere a’and,B’ are the conjugatesurds to aandB. Hence conclude, from (9.19), that 1 it“ where the quadratic surd 6 =[(10, a1, a2,. . .] >1. (b) Let3: beas in part(a) and—1 <6’ <0. Use mathematical inductiontoprove that-—1 <6; <0 for i20, where we recall that50 =6. Hence conclude from part (a) that =éi_aia 0<_—,1—'—ai<1, ai=[— ,1]. i+l i+l (c) Since 5 isa quadratic irrational,we have that£1={J- forsome integers iand j with 0 < i < j.Hence deduce thata,~_l =(ll--1 and {H=61-. 1- Hence,re- peating thisprocess1' times, conclude that co: 5:[am a],- -- , dj—ll' 6. Ifd >0 is nota perfectsquare, prove thatx/c—1'= [ao,d1, a2,. .. , aj,2&0]. Hint: Note thatdo =[J71], so that JZI+[J21] =[2%,a1,.. . ,aj]. Computer Exercise 7. Writea program to compute the simple continued fractionexpansion ofnot for 1 S n S 100, where a =(a +J3)/2. Can youguess a theorem ortheorems? Could youguess even more generalresults? 230 Simple Continued Fractions Chap. 9 9.5 APPROXIMATION 0F IRRATIONALSBY RATIONALS One ofthe interesting and useful properties ofsimple continued fractionsis that their successive convergents providebest rationalapproximations tothe numbersrepre- sented by the simple continued fractions,where by “best rational approximation”we mean closest rational approximation withdenominator notexceeding the denomi- nator ofthe convergent inquestion. Forexample, the familiar22/7is thesecond convergent ofthe simple continued fractionexpansion of7! and no rational number with denominatorless than orequal toseven givesas goodan approximation. That this is so ingeneral is shown inthe followingtheorem. Indeed, togeta better approximation interms ofthe inequality ofthesecond part oftheorem,one mustgo to fractions with denominators atleastas largeas q,,+l. THEOREM 9.18. Let f=[(10, a1, a2,. . .]be irrationaland let1),, /q,, be the nth convergent to6. Leta, b, andn be integers withb andn positive. If _ 2 _ &Ifb <6 q\", (9.27) then b >q\", and if then b 2 qr“. Proof Note ﬁ rst thatthe second part ofthe theorem impliesthe ﬁ rst. For suppose that(9.27) holds and yet thatb Sq”. Thenwe wouldhave Iéb-a|=b c— ﬂ a 6-3<q,. =|€qn-pnl. n But, presuming the truth ofthesecond assertion ofthe theorem, this would imply that qn+1 S b Squa in contradiction to(9.16). Suppose now that(9.28) holds and yet thatb\" <q,,+l. Since the determinant of the system m. +yqn+1 =b xpn + ypm =a is i1, itis clearly solvable andhas a unique integral solution x0,yo. Moreover,we have thatxoyo9% 0. Forsuppose thatx0 =0. Thenb =yoqmtl and this implies that yo 21 and hence b 2(1,,+1. Since this contradicts ourassumption,we conclude that x095 0. Also, ifyo =0, then a =xopn, b =xoqn and (9.29) Sec. 9.5 Approximation ofIrrationals by Rationals 231 Iéb _(II =Iéxoqn _xopni =Ixol liq\" -ml 2léqn _pnl: in contradiction to(9.28). Thus,yo ¢0 also. Indeed, not onlyisxoy095 0, butwe actually have xoyo <0,so thatx0 andyo have oppositesign. Tosee this,suppose that yo <0. Then xoqn =b _.Voqn+1 >0 and itfollows thatx0 >0. Similarly, ifyo >0, thenb < aimplies thatb < yoa. But then xoqn =b -yoqn+1<0 so that x0 <0. Since P éqn—pn=qn( ~33) and 17 a+1—Pn+1 =qn+l (f_ ﬂ ) qn+1 also have oppositesigns by(9.17), itfollows thatxo(€q,,— p\")andyo(€q,,+1— 12\"“) have the same sign. Finally,since x0,yo satisfy (9.29), lib— al = lawn +yoqm) -(xopn +yam“)! =Ixo(€¢In \"Pn) +Yo(€‘1n+1 _Pn+1)| =|x0(€qn— pn)| +|y0(€qn+l _pn+1)| 2|x0|Iéqn _pnl 2 liq\"— pnl, which again contradicts the hypothesis. Therefore, the assumption thatb <q,,+1 is false and the theorem is proved. The problem ofapproximating irrationals by rationalscanbe carried much further and very importantand elegant results have been achieved. The most inter- esting ofthese results are quitedeep, however, andwe choose toclose ourdiscussion here. Interested readers may want toconsultmoreadvanced books onthe theory of numbers or, more speci ﬁ cally, on Diophantine approximation. EXERCISES 9.5 1. (a) Find the fourthand ﬁ fthconvergents toE = [i]=(1 + 5)/2. (b) Find the least positive integerb forwhichthereexists an integera such that 232 Simple Continued Fractions Chap. 9 1 +J3 _ g <1 +J3 _g 2 b 2 3 ' (c) Find the least positive integerb forwhichthereexists an integerasuch that + J‘ b-1-'-\\/§—(1<3'1 5--5. 2 2 2. Given that7: =[3,7, 15,1, 292,. . .], determine tohow manydecimalplaces each ofthe ﬁ rst fourconvergents correctly approximate71. (Also,see the next exercises in this connection.) 3. Let 5 =[(10, a],a2,. . .] and letp,,/qnbe the nthconvergent toE. Forn 20 show that 1 l p,1 <6— — <—. 243:“ qn (I: Hint: Recall that4‘ lies between pn/qn and pm”/q,,+, andcloser tothe latter. 4. Let6 and pn/qn beas inExercise3. (a) For everyn 20, show thatatleast one ofthe followingholds: be1 _1_ qn 2%? 243:“- Suggestion: Argue by contradictionanduse the hint ofExercise3. (b) Give an example toshow that both inequalities inpart(a) can hold simulta- neously. Hint: Look fora 6 withconvergents withsmall denominators. (c) Conclude from part(a) thatthere exist in ﬁ nitelymany solutions inintegersa and b to the inequality < pn+l:— —— < qn+l a l '5’;5?- [Ifthis inequality holds withC irrationaland a andb integers withb >O and (a, b) =1, one can also show that a/bisa convergent ofthe simple continued fraction expansion of6. However, this result should probablybe presentedas a theorem rather thana problem and the interested reader can ﬁ ndthe proof in more advanced discussions ofthe topic.] < Computer Exercise 5. Writea computer program tocompute the simple continued fractionexpansion of .1+\\/§ 2 r S Chap. 9 References 233 for1 s rS50,1 Ss S50. Can youguess a theorem ortheorems? Could you guess more general theorems? Suggestion: First start withs =1. REFERENCES Number Theory 1. 2. 3. 10. 11. 12. 13. 14. 15. 16. 17. 18. 19. Andrews, G. E., NumberTheory, W.B. Saunders Company, Philadelphia,1971. Carmichael, R. D., The Theory ofNumbers and DiophantineAnalysis, DoverPublica- tions, Inc., New York,1959. Davenport, H., The HigherArithmetic,5thed., Cambridge UniversityPress, Cambridge, 1982. . Dickson, L.E., History ofthe Theory ofNumbers, three volumes,Chelsea Publishing Company, Inc., New York,1952. . Dickson, L.E., Introduction to the Theory ofNumbers, DoverPublications, Inc., New York,1957. . Grosswald, E., Topics fromthe Theory ofNumbers, 2nded. BirkhauserBoston, Inc., Boston, 1982. . Guy, R. K.,Unsolved Problems in NumberTheory, Springer-Verlag, New York,1981. . Hardy, G. H., and Wright,E. M., An Introductiontothe Theory ofNumbers, 5thed., Oxford UniversityPress, Oxford,1979. . Hoggatt, V.E.,J r., Fibonacci and LucasNumbers, Houghton Mi ﬂ linCompany,Boston, 1969. Lehmer, D. H., Guide toTables in the Theory ofNumbers, Bulletin ofthe National Research Council, No.105, Washington, D.C.,1941. LeVeque, W.J., Elementary Theory ofNumbers, Addison-Wesley PublishingCo., Inc., Reading, Mass., 1962. LeVeque, W.J., Reviews in NumberTheory, six volumes, American MathematicalSoci- ety, Providence, R.I.,1974. Niven, I., and Zuckerman, H.S., An Introductionto the Theory ofNumbers, 4thed., John Wiley &Sons, Inc., New York,1980. Ore, 0.,Number Theory and ItsHistory,McGraw—Hill BookCompany, New York,1 948. Ore, 0., An Invitationto NumberTheory, RandomHouse, Inc., New York,1967. Rademacher, H., Lectureson Elementary NumberTheory, Blaisdell Publishing Com- pany, Waltham,Mass., 1964. Roberts,J., Elementary NumberTheory, The MITPress, Cambridge,Mass.,1977. Rosen, K., Elementary NumberTheory and ItsApplications, Addison-WesleyPub.Co., Reading, 1984. Shanks, D., Solved andUnsolved Problems in NumberTheory, 2nded., Chelsea Publish- ing Company, Inc., New York,1978. 234 Simple Continued Fractions Chap.9 20. 21. 22. 23. 24. Sierpinski, W., Elementary Theory ofNumbers, Polski Akademic Nauk,Warsaw,1964. Sierpinski, W., ASelection ofProblems in NumberTheory, PergamonPress, Inc.,Elms- ford, N.Y.,1964. Sierpinski, W., 250 Problems in Elementary NumberTheory, Polish Scienti ﬁ cPublishers, Warsaw, 1970. Stark, H. M., An Introduction to NumberTheory, The MITPress, Cambridge,Mass., 1978. Uspensky,J. V., and Heaslet, M.A., Elementary NumberTheory, McGraw-HillBook Company, New York,1939. Number Theory and Computing 1. 2. 3. Atkin, A. O. L., and Birch,B.1., Computers in NumberTheory, Roystar Printers Ltd., London,1971. Kirch, A. M., Elementary Number Theory—AComputerApproach, IntextEducational Publishers, New York,1974. Spencer, D. D., Computers in NumberTheory, Hayden Book Company, Inc.,Rochelle Park, N.J., 1982. Cryptography 1. 2. Bostworth, B., Codes, Ciphers andComputers, Hayden Book Company, Inc.,Rochelle Park, N.J.,1982. Denning, D.E. R., Cryptography and DataSecurity, Addison-Wesley Publishing Com- pany, Inc., Reading, Mass,1982. . Gaines, H.F., Cryptanalysis—A Study ofCiphers and TheirSolution, DoverPublications, Inc., New York,1956. 4. Kahn, D., The Codebreakers: The Story ofSecret Writing, Macmillan,New York,1967.LII. Konheim, A. G., Gryptography—A Primer, John Wiley &Sons, Inc., New York,1981. 6. Meyer,C. H., and Matyas,S. M.,Cryptography: ANew Dimension in Computer Data Security, John Wiley &Sons, Inc., New York,1982. . Sinkov, A., Elementary Cryptanalysis, MathematicalAssociation ofAmerica,Washing- ton, D.C.,1966. Computer Science 1. Hwang, K., Computer Arithmetic—Principles,Architecture andDesign, John Wiley & Sons, Inc., New York,1979. . Knuth, D.E., The Art ofComputer Programming,three volumes, Addison-Wesley, Pub- lishing Company, Inc., Reading, Mass,1968— 1973. . Kronsjo, L., Algorithms: Their Complexity andE ﬂ ‘iciency, John Wiley &Sons, Inc., New York,1979. . Szabé, N.S., and Tanaka, R.J., Residue Arithmeticand ItsApplicationto Computer Techn010gy, McGraw-HillBook Company, New York,1967. Tables TABLE OF PRIME NUMBERS LESS THAN 10,000v—IKIQHOJN 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97 101 103 107 109 113 127 131 137 139 149 151 157 163 167 173 179 181 191 193 197 199 211 223 227 229 233 239 241 251 257 263 269 271 277 281 283 293 307 311 313 317 331 337 347 349 353 359 367 373 379 383 389 397 401 409 419 421 431 433 439 443 449 457 461 463 467 479 487 491 499 503 509 521 523 541 547 557 563 569 571 577 587 593 599 601 607 613 617 619 631 641 643 647 653 659 661 673 677 683 691 701 709 719 727 733 739 743 751 757 761 769 773 787 797 809 811 821 823 827 829 839 853 857 859 863 877 881 883 887 907 911 919 929 937 941 947 953 967 971 977 983 991 997 1009 1013 1019 1021 1031 1033 1039 1049 1051 1061 1063 1069 1087 1091 1093 1097 1103 1109 1117 1123 1129 1151 1153 1163 1171 1181 1187 1193 1201 1213 1217 1223 1229 1231 1237 1249 1259 1277 1279 1283 1289 1291 1297 1301 1303 1307 1319 1321 1327 1361 1367 1373 1381 1399 1409 1423 1427 1429 1433 1439 1447 1451 1453 1459 1471 1481 1483 1487 1489 1493 1499 1511 1523 1531 1543 1549 1553 1559 1567 1571 1579 1583 1597 1601 1607 1609 1613 1619 1621 1627 1637 1657 1663 1667 1669 1693 1697 1699 1709 1721 1723 1733 1741 1747 1753 1759 1777 1783 1787 1789 1801 1811 235 TABLE OF PRIME NUMBERS LESS THAN 10,000(Cont.) 1823 2131 2437 2749 3083 3433 3733 4073 1831 2137 2441 2753 3089 3449 3739 4079 1847 2141 2447 2767 3109 3457 3761 4091 1861 2143 2459 2777 3119 3461 3767 4093 1867 2153 2467 2789 3121 3463 3769 4099 1871 2161 2473 2791 3137 3467 3779 4111 1873 2179 2477 2797 3163 3469 3793 4127 1877 2203 2503 2801 3167 3491 3797 4129 1879 2207 2521 2803 3169 3499 3803 4133 1889 2213 2531 2819 3181 3511 3821 4139 1901 2221 2539 2833 3187 3517 3823 4153 1907 2237 2543 2837 3191 3527 3833 4157 1913 2239 2549 2843 3203 3529 3847 4159 1931 2243 2551 2851 3209 3533 3851 4177 1933 2251 2557 2857 3217 3539 3853 4201 1949 2267 2579 2861 3221 3541 3863 4211 1951 2269 2591 2879 3229 3547 3877 4217 1973 2273 2593 2887 3251 3557 3881 4219 1979 2281 2609 2897 3253 3559 3889 4229 1987 2287 2617 2903 3257 3571 3907 4231 1993 2293 2621 2909 3259 3581 3911 4241 1997 2297 2633 2917 3271 3583 3917 4243 1999 2309 2647 2927 3299 3593 3919 4253 2003 2311 2657 2939 3301 3607 3923 4259 2011 2333 2659 2953 3307 3613 3929 4261 2017 2339 2663 2957 3313 3617 3931 4271 2027 2341 2671 2963 3319 3623 3943 4273 2029 2347 2677 2969 3323 3631 3947 4283 2039 2351 2683 2971 3329 3637 3967 4289 2053 2357 2687 2999 3331 3643 3989 4297 2063 2371 2689 3001 3343 3659 4001 4327 2069 2377 2693 3011 3347 3671 4003 4337 2081 2381 2699 3019 3359 3673 4007 4339 2083 2383 2707 3023 3361 3677 4013 4349 2087 2389 2711 3037 3371 3691 4019 4357 2089 2393 2713 3041 3373 3697 4021 4363 2099 2399 2719 3049 3389 3701 4027 4373 2111 2411 2729 3061 3391 3709 4049 4391 2113 2417 2731 3067 3407 3719 4051 4397 2129 2423 2741 3079 3413 3727 4057 4409 236 TABLE OF PRIME NUMBERS LESS THAN 10,000(Cont.) 4421 4423 4441 4447 4451 4457 4463 4481 4483 4493 4507 4513 4517 4519 4523 4547 4549 4561 4567 4583 4591 4597 4603 4621 4637 4639 4643 4649 4651 4657 4663 4673 4679 4691 4703 4721 4723 4729 4733 4751 4759 4783 4787 4789 4793 4799 4801 4813 4817 4831 4861 4871 4877 4889 4903 4909 4919 4931 4933 4937 4943 4951 4957 4967 4969 4973 4987 4993 4999 5003 5009 5011 5021 5023 5039 5051 5059 5077 5081 5087 5099 5101 5107 5113 5119 5147 5153 5167 5171 5179 5189 5197 5209 5227 5231 5233 5237 5261 5273 5279 5281 5297 5303 5309 5323 5333 5347 5351 5381 5387 5393 5399 5407 5413 5417 5419 5431 5437 5441 5443 5449 5471 5477 5479 5483 5501 5503 5507 5519 5521 5527 5531 5557 5563 5569 5573 5581 5591 5623 5639 5641 5647 5651 5653 5657 5659 5669 5683 5689 5693 5701 5711 5717 5737 5741 5743 5749 5779 5783 5791 5801 5807 5813 5821 5827 5839 5843 5849 5851 5857 5861 5867 5869 5879 5881 5897 5903 5923 5927 5939 5953 5981 5987 6007 6011 6029 6037 6043 6047 6053 6067 6073 6079 6089 6091 6101 6113 6121 6131 6133 6143 6151 6163 6173 6197 6199 6203 6211 6217 6221 6229 6247 6257 6263 6269 6271 6277 6287 6299 6301 6311 6317 6323 6329 6337 6343 6353 6359 6361 6367 6373 6379 6389 6397 6421 6427 6449 6451 6469 6473 6481 6491 6521 6529 6547 6551 6553 6563 6569 6571 6577 6581 6599 6607 6619 6637 6653 6659 6661 6673 6679 6689 6691 6701 6703 6709 6719 6733 6737 6761 6763 6779 6781 6791 6793 6803 6823 6827 6829 6833 6841 6857 6863 6869 6871 6883 6899 6907 6911 6917 6947 6949 6959 6961 6967 6971 6977 6983 6991 6997 7001 7013 7019 7027 7039 7043 7057 7069 7079 7103 7109 7121 7127 7129 7151 7159 7177 7187 7193 7207 237 TABLE OF PRIME NUMBERS LESS THAN 10,000 (Cont) 7211 7561 7907 8273 8647 8971 9337 9677 7213 7573 7919 8287 8663 8999 9341 9679 7219 7577 7927 8291 8669 9001 9343 9689 7229 7583 7933 8293 8677 9007 9349 9697 7237 7589 7937 8297 8681 9011 9371 9719 7243 7591 7949 8311 8689 9013 9377 9721 7247 7603 7951 8317 8693 9029 9391 9733 7253 7607 7963 8329 8699 9041 9397 9739 7283 7621 7993 8353 8707 9043 9403 9743 7297 7639 8009 8363 8713 9049 9413 9749 7307 7643 8011 8369 8719 9059 9419 9767 7309 7649 8017 8377 8731 9067 9421 9769 7321 7669 8039 8387 8737 9091 9431 9781 7331 7673 8053 8389 8741 9103 9433 9787 7333 7681 8059 8419 8747 9109 9437 9791 7349 7687 8069 8423 8753 9127 9439 9803 7351 7691 8081 8429 8761 9133 9461 9811 7369 7699 8087 8431 8779 9137 9463 9817 7393 7703 8089 8443 8783 9151 9467 9829 7411 7717 8093 8447 8803 9157 9473 9833 7417 7723 8101 8461 8807 9161 9479 9839 7433 7727 8111 8467 8819 9173 9491 9851 7451 7741 8117 8501 8821 9181 9497 9857 7457 7753 8123 8513 8831 9187 9511 9859 7459 7757 8147 8521 8837 9199 9521 9871 7477 7759 8161 8527 8839 9203 9533 9883 7481 7789 8167 8537 8849 9209 9539 9887 7487 7793 8171 8539 8861 9221 9547 9901 7489 7817 8179 8543 8863 9227 9551 9907 7499 7823 8191 8563 8867 9239 9587 9923 7507 7829 8209 8573 8887 9241 9601 9929 7517 7841 8219 8581 8893 9257 9613 9931 7523 7853 8221 8597 8923 9277 9619 9941 7529 7867 8231 8599 8929 9281 9623 9949 7537 7873 8233 8609 8933 9283 9629 9967 7541 7877 8237 8623 8941 9293 9631 9973 7547 7879 8243 8627 8951 9311 9643 7549 7883 8263 8629 8963 9319 9649 7559 7901 8269 8641 8969 9323 9661 238m3bémm:«2mw.ma:a:mv.m5.5asm:.~m.N5TNNmwNh.m.mNQTNhm.uNmN.m.NFNmmNmm.~Nmbe5.:mm.m$—52Kim>2bN~m~.~mbeh«KKNN~m.m.N:J‘Nmw.Nm~.m.~Nmh.NEJNb.~m.NmN.~Nmm.Nwm~.m.m5minNimm:.m.m~m.maN.mmémmmmN.mb.m.mmhaNMNlmNmN.m.NETNN:.h.N«mivN$.NSANa_.m.NSANVma58m2m254m2.:3;.I?mm2mgmm.wNm~.b.NQTNNemNQJNEXN:.m.NNSNhéNE.m.NN3“Hm“3.mmmN.b#2Evlm#2a:bm.m2:H3.m.Nm.~m.~N:.m.Nm.mN~m.m.Nb.m.~Nm_.m.Nm.m.mN:.m.N~m.uN0Nakm“*5N3N3N3N2N3N:No“N:.NmamormN.manNbmfmoNaumm«KINSANm—.m.N:éNaN.Nm.vN3.NNANum.NnNwhaaN.mS.»no31m5»hmmm2bbm.mNmvNEJN:.m.NbimNmN.Num.~N2NVNm.Nw3%5%um.m26:.mm.~mKim«mm.mmnSYNh.m.~NtwNmmN:.~NSNm.mN“IN\"N.v~m.mmmm5.1”mmmv:LmmN2mmmN.~NSYNum.mN3NSANh.m.N“N:.Nm.NNNN2.5emF3:83»:m“In2ﬂHm.um.Nm.vNh.n.Nn.m.NNum.Nn.mNm.m.Nm.~Nn.N0kmkwNbNekmNVRmRNVJNoR000—.24...:wwm:mmmomkzm>_._._m0m”.0wZO_._.<N_mO._.o<u_ 2393.51mawmohmSTNmmmmawnm:.m5‘4.aN.:87mmSTNSJNb.mm.NmN.¢NQLNaN.m.~N~m~.NSTmNmm.m.NSAXNNwanmvém3.2new5.7mSumhmm87mCmhemN.:.~m.nNmaHNETmN$.m.Naw.NNQTNh.m..vNQTNahJN:.~m.N@ah.m2.5%mm.mmh.wK6MN.m.m50%24mh.m.um$.mmSTNméN:.:.NSLINNmm.m.Nmv.nNSTNvm.~NETNaéN.v126mwmmum~28mmmnhhmém3.:2m57mmlimNETN~m.m.~NETN:.mNm~.~m.Nmw.uNMN.N..Nmﬁ.m.mN“SNN3.:bNTnmmé«aSimmHm.2“mmbalm:mmvé.Hm~.n.m.N3.m.~Nhm.m.Nm.nm.mNb.~m.NS.n.~N:.m.m.Nm.oNHm.m.Num.m.~NoNamNamtNewNmmN3”NmmNNmN1”Namk.mN.m~u:_m.~mSNhmémw.mamNmNNSim3.:mSANmm.mNam_.N$.NNmv.m.N~m.mNS.h.N3.m.~NaSNmHJNw:.nm3.x.RNmm.mRN2.236hNNSHEmN.~mhhméN2.:NmN.m.NN3.5.NwNmv.m.Nam.~Nm:.Nmm.nNmoH.Noam.mm~.n.m:.~mmm.m:.m.m«Tn57m~m.ummv.mEfmm~h.m.N:éNSTN:.m.mNRTN$.NNm~.~m.Nb.mNNOTNS.m.~N.vmaNmwN2.5;.“mwN.mN.:mmmmNmNNKimmN.bmMbANhv.m.N:JNSUTNb.~m.~N«ZNaN.mNhm.m.Nmm.~NSTNN3.mENENaNém3N3N:.b.m5.2:N$.mﬂmN.m.Nb.m.mNm.mm.Nm_.m.~Nmm.Nm.m.vNmN.n.N:.m.uNh.m.m.N«mimNoNQNNMNkhN\\NoNkmNktNNmNNNNVJNNONN3:00.ooowz<_._._.wmm:mmmwmhzm>_._._w0n_“.0mZO_._.<NEO._.U<u_042aamSTEm2.mown9?:$.mm2.1.NmNm:.m8namN.m~.Nub.m.~N«ENEimN~m.~m.NhﬂéNawN.N:LmJNhm.h.NbNTnNwm3.mhwmFm54%53Sam97*”3.:EV.:~28hQEANmmNNum.eNmwN.NmQJNm~.b.m.N$.«NmoN.Nmw.m.~NmN.:.Nw5.5%2%.?mN.~wm:.mhm.m.m87mbOTWh.~n.m87m87mm:.mm.Nmh.nNSTFNh¢.m.~NFN.NC.nNmm.m.NHQJNtNb.~m.nN.vmammm.2“a.mmomEL.57mSfmﬁMNm38mmommhmJNha.m.N2.2.«N~wN.NmN.m.nN:NN3.7%mN.~m.NmNHmN.NN57m8.“.2%S.:8mN.33mamém~NmmbéSTmHmm.n.NmN.m.~N3.m.m.Nh.m.vN:.~m.Nm.mm.~Nmm.m.Nm—.m.mN:66Nmm.uNoNamNanNunNwmNmmKgRmm\\wmN:NewNaavmg.m2%No.556mmi.amvmH.:.ma?mowmmw.m.N$.nNamN.Nm~.~m.~NmNN.Nb.oNmb.m.NhO—JN3.2.N:.m.nNw21>5vmmémbwvhmvQEQH3.35.592.mhm.:h~m.vNmm.N:.b.~NMMN.Na.m.mNMNN.NmoTNN:1m.NmH.mNaN.b.Nw:.m.nmhm.m3.~m~m.m.mm~.b.maw.maN.m.mEénmw.mnémm3.2.NN:.~Nah.m.N«NJN5NN.Nhm.m.~NELINmm.mNmN.nm.NSTnN.v3.:mN.b.m9?:m3ETM9%$2»hvdmmm.b3.2m$.M.NN~¢N.Nam.mN:.b.m.Nm:.NN5.2.Nmm.¢N:N.N8—.«N$.m.NN3v5.2524”3v5..3«hémHmvN?hm8vuah.m.Nm.m.mNhv.m.NmN.m.NNum.~m.N:.m.nNmv.m.Nh.n.m.~N~¢.m.NumJNoNovvNS.NS»km?N3»N9.NNvN;NovN3:09CoopZ<I._.wmm:wmwwmhzw>_._._m0m\".0wZO_._.<NEO._.U<u_ 2415?:moN.m:73a2.mN.:.m53.5$2.mma:a9.am~.b.m.uRTNNawm.N«Jawahm.N:.:.~N~v.~m.N2.58Mmmm.Nmm.m.~Nw3h5:.SLIMan.2hpmmémhe.:hNhamN.m2:.bhQQHJN~m_.m.ubaéamwm.Nb.mm.~Nmnm.NmN.mNN:.m.Natéummm.Nwmm.m.mmm—m.~m:.m.~mETWa3.nah.m.mmN.~m2.2%h¢.m.mmham.NNFJNmv.um.N87%oN.m~.N~m.m.mNSm.~37%5.5.m.N3....Nv5.:mN.mmm:aogé.HmN.m9%mp3N83.85.3m:.~m.mNmN.:.NmaéNhN~.m.NSTQNmn.h.NG.m.~N«QTNawémmH.mm.NN27>F.:\\lmN.mGBﬁnk3.2.m9?:87hSiamSbﬂah.m.Nm~.m.m.-:.b.m.N3.m.nNmm.m.Nhm.m.~Nmh.m.NméméNE..m.Nh.am.uN0~43.wN55R65N:NE.tNabN:Nabk.mmN.m3.2ha.bm~N.mawemm.:Siam5.:2wm~.n.mmQATNvNm:.m.NhoﬁéNS?b.~emduaN.:.NaéNmo~.m.NQTmNw:3:aNN.mPo¢N.mNmhém5%2.1a.:.m55how5QN.m.nNKIN«SANhm.~m.N33K2.5.Nmm.m.~Nm_M.N2.51%ETTNw37m57m~m.nm3E637mm¢.m.mhNTWvn$.m.m~26mhvm.N3.17%hmm.Nmwém8~.m.NmNEéNCTNm~.m.¢NNOTNHQJN.v:.b.~m30who5.2;”mm@m3.:N.mawém554mmm:.~N_m.:.Nh.m.nN~mm.Nmwﬁémhc_.m.NQBAN:m.N:.~m.~Nmv.h.NN80RNA.”3.3So.m.b.mSawﬁmwmainv.7280ﬂmn.m.m.N:.m.mN$.m.N:.m.m.~Nm~.~m.NméNh.w.um.NHm.m.~NG.m.u~m.m.mN0RawNwwNSkwcwvwNaeNENewN3:09COOPZ<Ihwwm:mam—EMF;m>_._._m0n_”.0wZO_H<N_r_O._.Q<u_ 242hmémmv.mNaw.:3.54”52%$22m~m.moa;Sﬁémammv.~3.2.NNmw~.m.N~:.mNmifmab.m.~N$.5.NmN.mN:.mm.NNNNJNwam5.58Km53mm.2.mhembmamogém37>boabmw.m.~NmN.:.NSJNmN.b.m.NamN.~Nmv.:.Nm_.~m.mNmov.NaunénETTNcQTW87mm_.~m.m87m37mNimém5.2%bmém$66:26mEXTN38.xhwv.NSuNéNmm.~m.~mmJN$v.~:.h.m.~Nhmv.mm:.mNvﬁmm.mmwaamﬁéhafummmmSTmN:m.m5.:mm.2mv.b.mmFfmuaimmm.~NtmTN5.b.mNhmﬁ.m.ummN.~NSv.~36.3_.v.:.NN3amoﬁémH3inSm.mCum3.Nb8m.m:mmm.§_:.m.~m.NNh.m.~Nhm.m.Nm.m.eNa.~m.uhv.m.~N~m.m.m.NmN.m.mNm~.b.m.N«mémém0N3NwaNhaReaN3N3N3kNaNSNookHmém52;.maNLm21:amwmwN.mamwamw2.h.~mmowaQATNbm.m.mNaﬂTN_m.\\..~mm_.:.m.Nmmémm_.v.NmN.~m.~N@97NSHANwmN.m7m5wFmN:.m5mm«2.53.8mRm373awaéN.béNm3?~mb.m.~Nmm¢.NhoNhv.~m.N3.2.NNangim56:3Hm.m_.NoQTmmm.m.m51mmm:.m3%.?«2%Sfm:.~m.mmo_.mmN.>.mmmE.m.N5.2.NNmN.2.Nmm.mN5.».N:N.~Nam_.m.N87mmhm.:.N$.M.NNvSTEmww3.~mnewmwwSN.m5.:mgFN.mm».SmmNN.~NNb.~m.NmoTnN—m.v.NE..m.~N~N¢.Nm~.oNbmfméQNEJNHov.NN:1%Smno.3:ThShm.mNNamRN.m“Nw:wamémHow.m.N:.m.v~mN.m.m.Nmv.m.~N:.~m.Nh.m.m.mNmw.m.N$.n.~Nm.em.Num.mNoNamNwwtNeww*vwNSNSNewN3:00.89‘24.1...wwm:mam—052.m>_._._w0m”.0mzo_._.<N_mO._.U<u_ 2430NvcmmNmNHNmHwH9MNMNmwHoHmONmaEm5HHm5HvmHommNvHHymNHNHum9NH3mNmHHmNNNNm0HmmVNhmmNHmNmwHmmNH5vmHmmHHwNcmNHOmmmamHNNNHmHNo00HmNm5NMNNoNHooawhomwmNHoawhcwvmNHoHvﬂmmm\"aomHma0Hmm3MH5N5HaNmNEmHmH0Hm0NcNNH.vNNv0NboHNNNHHaHMNvHHaHHHNvNmHmHnmNMNHNNHwNmNONM:HNoo0HmNH9NNNmHoommbonvmNHoawH.cmwmNHoHm\"aaN\"aHHmHmNmHNH5m5HHNvHONamHN3vHHnmmHNH5HH0Ho2wHHv0HNoowmoE0HNmHHooawnomvmNHoawbcwvmNHo3Ha2HawoavMH5mHo5OHHN3HHmHmNHHHoowmHHmaNvHoomwbcnvmNHoawnomwmNHohHHQ2\"AomHomhovNwHoomnvHNoomwnonvmNHoawhonvmNH0HH\"ah\"aNmHooHoomwhenvmNHommhcwvmNHom\"&mun.Hﬂ5?:08:3Page2:a88:80E68:8935t2:85omHm202NH»HSH9:KNHHaSHHE“SHEE:.2HEon“mac..nEton—En:nﬁsHoo05HENH3.59:5:38undo53085::2:35H55532wBEEEmH8€58on.HHHBJESSESHSHSH:.HonHEHEm.85a2E..n....N.Hho>H0>Hmwooo=m3:385:v.8v.30.—oﬁcan.m.....m“N.H6EvansEN38382t:25802m2wqwmdmmémmmom$052.”659¢ 244NOOOmOmmNON_OmOwmm3OmNOOmhmwNwmNvmmmm3O?hmmvwmOhOvONNwemv:ON(‘1ON3OmONmvOmwO_mVO3ONmmOvOmNNHOOmNOmmNmmvmOVfNV3OONmOOmm%ONNONm3mmONON3ONOvmNOmONONmmOOOn2W—‘FNvmONmmOmXnOQmmEmmmmNmONO—OmNNmm223Omm—ON:ONOmO—D»mONND»2ONNOVN3ON9M:mmON:OmmmNm3OvOﬁmNv—1 —a F‘Ol‘VOMIONvmNO~ON2SOmmmM:mm2OO2mmOmOmOO 0\"vWebO—‘v-nO—‘NMV '000—“v_mmmOwmmONN—ON2vOvhmVmmm2‘O—3OnNNmﬁmmm—OmO—N“mm~~NmmOOmmONOmOwNwONOwNmONOmOOD“OvvvOmSO~3mmmmmO3ﬂN«O3VNNm3tVNON5OOmO~ONOmvmONhmvm__3ONNNONNvN_5‘w—ONONmmmN3mmm_OmONNNmNOmVN2mmO_Nm2mmOmOmwmON2m“ONOOON2NmmmOONOOvOOOVVmOm3ONONVNmNmvOmmHOvwvNN:OmOO O—‘NMV 1005O—‘NMVW O—‘NMV ‘00O—‘NMV3:omayWQWmimus—En.mou—Mmoaz.“.0m4m<k 245mmaM:me3em8w»wmOmEbememm2Qwwmwemwmm:beSwNeNm3mmemmm__NNNoononmmmmﬁehwwﬁamuwemm2enww2meNMmmmemgmm8mH9.mm3mmmmwmaiam8mmmwmmmmommmemmmaeeNwwmwewe3wbmmmwmmmmwmpm2eaonowawm“eweasmuwwNNﬂmmmwe5mmmNm”VNOx-nbe ll mEo—waS—awmmcmowmammw»wNNwwm_wweanas;muwhemame_wememmewewca_Nmmawemew3wwmmmw3._weemwemmemm1memm—weon3aman O .— OF'NMVWOFOOON o—wWKOFDOQo—wWOFDOE“Nwemeammgmm8eammNwwemwwnwNanmmmm_m3mm2Nm@—emNmNamm3Iamwwowmmmmme3mmM:wwmmonm—:em«eN—Nmoemm5meweememoeE.enenwe25mwmwmmam33mmwk.mwmmmmN—hmowheonmwhe9wm.wmamwe5ONwe5cmhmNemmwwmawNehmmeeNbmeNm:.onww—anwehmewmeNeﬂanMmane5wmmNw3eneeme3mmmmommmmmmmwwmmEowmeeNwm_mwwewﬁwmmweonw\"KpmOnbwmmA:owNemme_w”oeNwwmNVO‘NO [\\NweweaemNwww_mnwmmmmemwmmeOnmewNwmmmaw5NwaeNmmewanmewe0m5wwﬁew_wKowwnbeonee 0 —1 Ov-‘NMVI' \"10500 O—‘NMV '00t0\"vmob3:00.ampWQwmdmus—ELmou—mmoaz.”.059.2. 2465N:Obmm09mga:2:mmm:vwanwNmmmwEuow__VmmmX:we30mmm3‘emmmmmOmE.omVmmuwmwe3awevmevmmmeeaNv3v:pmmemwoewmwmm:ew2ma2Swvmmovmemm9:2N92onheonowemmme92wwvwm9co3NHNwEQmNH3mmmmowenwvww5woemvweeammanNbS»cmeno:ew—nmﬁHamm3wamew_mow5vswN3mmN_n:R::mea—«5—.mmeeobememavcm5mmheNmVNWN:_m—eNmaw:N:wewe—33NbvmamNo—am2.mm3aeanwehmo—3m2mwe—w»amoweve:weR:03wk.9mm3.3mawwan2:eemmmm_mmeo—ON—3VM3—mmon.Nwwmeem2:“MPNwmN O—‘Nmu— O—‘NMV '00wo —¢ 0\"v“\\OFOOO\\ehmammN?E.e—mmowaemwwwaem3ewVwNww»v».“NwN0:mmmm5—av:—Nm3em5wmmmw2mmE.an3mmmevo—ommwa2OSbel‘OOWM2:NSmeme—NVeewmI:ammeweean25w3.mmem3”wvm_mmmmoeowmaevweemﬂ:mmonwwmmme—3mw3wevwmwwe9enwmeae#wcaEmM_SwewemmasmmmHwa5mmonVNm:\"a.Cmeamwe—VNowMN3Neno“HQanEovme2Nm5wm51vmmMmm3ONmwRNmamNowe3onmemwHwee9wmNeev_NoeewmmNﬁo9we2»5mwN2mmN»wewanE.Now3OnEwwmmweaw9moow5NNNhmw»33meweeeeaR:maemNwwe23anSavwv Ou—1 —‘—1 O—‘NMV InxohooaO .— O—‘NMV WOBOOQ3:omm:WQWmimm=>=mn_m0”.mEZ.”.0m.._m<._. 247mmNmx:mmm2¢:mNVmmm02o:ONHVm0Nmmonom_VN~09mmoN~VoﬁVw0N30VV5mmm:nmﬁN:a:0N“~N~3mmVV~NonV:MNVa3cmmm2:_VwmNoN_0mmm2cmonoN_mmm20:«NweNum:VNHNVHCBNw~umNamNon5V3N9mmNV2hN__NNNHaNoVaowmVm3cowNVmwwweVm_:3R:wemm”N59:NNOV:bVﬁno02w:HN~m:09BR5:cm5:V2VNcm22mwmV:_:mN_N:co2wV7m3MKMN“NSNN:.mN~N~ON3mawV3mmmmwwON—a0:VsEWNﬁVV3:3MN_mN~mNweonam0V—V03NVaNmm—mmN»o:mw[\\NwmVasNmmmwVmmomNS#N3R5“oh2EVNm3wmmo_VN2S2:anweno“oano3V2mma:m«VN—0230V8No3:we3mV52:VV9:m9c:oc—:.Vmmmm—_5N—omVNwe33mm O—‘Nm ﬁ ' v—4—4—v—‘—‘ 0\"vIO\\OI\\OOO\\o—‘NMV '00ww—9am0NV200we“Noo—2:V@GNm3NN~onV2mm3NwNecagmmmV“moNNmN—2:3.on:asmwwwmean3mVNmonemma(’1onN:VbmNmm—cN_@—NO—moowmN_bo—OmnoNm22:mN_NNKbe—no._VcwmV30:mm—mawV0V0:m0m2mmwNVwweNV2*mm5NE.mNHmmasEON—2—mmmmmmN“VN02acVw5owVmVwNSowNﬁNaw:0V2wmm95ama3VN~E.mo—Smwo—N09OVNVchmwm3.m»SNv5Ha_:MbV923NHaVN?m:5:FNVwVcmmm2:Ib:o:0NVNHwN~MN2Nbma:mmVm:oNmmmmhmweNaEMVonOS0:mNbN~NbV__N_1:V:0N0Vmm9NmonaonN:m:VmV:wNmmmmm:oNHmNmmon902mNcm3”oo52mNﬁmm3wNHmmmm3NHm8Va5on2ONﬁmooV9ﬂwVV2O—‘N v—‘v—‘mNM 0—!vWONOOQ I— ﬂ v—1 Ov—t v—tv—G O—‘NMV WOFOOO‘3:0“:mm_.WQWm.0.mus—En—mOu$552.”.0m._m<._. 248hmm:m:mHhogcmv3mohNm:Oh“m0m_mmNNmmﬁhmmm09mmmm3mvwm_me“am”v2ame:2he«2mm#cm0:w:hmm“VNmmmoNmNwo3owow#momowmN—mmﬁma9v:NNash:a:_:wv2#2Nmmmmm“mmchwh2:m2Nmﬁmm“0:mmm:voav03Vmmo#mﬁmm3NhOmNo3ﬂomowh:mm#2as3wea:wNﬁhm—wmﬁN2NhomﬁNSm3of#2mh2:EHGE33.mo3maNSON“vmHomhemm—a#2h:o9hvmmVmca2:onmma:omﬁ8cm“chmg2.ghmomw:mm2ON2am0Nhm0N—5—chom—wemowmﬁ2:mmmmhm~hhmv2:wemhv2mmhmum—0N—Bumm3mh#mﬁ0—mmmhhm—mewv«mm:moﬁohmm—3;mm3‘mm—mmm:0:mm—0NQmvwN—mmcm2:N:3mﬁhm~N:om—h—owVmweowahowohhmhemea:hvNm—mm3mﬁNm2:#mhhoo9cmmm~ahmmmv3h:hmcawemmm:mgawcmNVvuhﬁSonmwNQmmmm“mm3:9.anSmo#2omﬁNVa“mm—2‘men:N—mm3wmﬁOm_hmmm—mmm:N:wehN—NE O—‘NMV' \"'50wO—‘NMVWWFOOONmmmm—mmam—cm—3hmm:ma0:mm—03mm“hemm—0\\m303ammNﬁm3wo—mNh:0?cm32NN—:—caN—comm:—cm—m:S:cmmmﬁamweme03o:o».09mmmNV3VmSo—hmNw~Nmmmm—mm—hm—mo9.ON“mm3mmmm2:hmmhmeNowemmwwmv:mo3on8mowmhev2mm—ccv:a:micc—amha“9:oho—H?mmNo—hmw:a:we3_m_whowmahm—mm:—Om—oemNN~om—mwvmhNo:Nh_m_weNommmmOm0:ohmmomhh92NmONMl!)omVS3Vhm¢N—_m_N_3on“hmeem33VMN3ou—mm—2»—hmmo:_m_unhmmacm3N:hm02hmﬁm:3:mmm:_m8—mm“Nmﬁ022:mgh:oho2mmm::V3;mm“mo0mﬂahhhmmﬂ2S:mv0hmm2wvm9hmm—amhvmmm9~N~NhmamweOmEhOhNwNNascm33:RHv5owNamhmm_03mo3h...hehNmmhaacweVNEa:Q:_mmmw»:Va8Nm_oohea:mommcm9amw:«mEh:h#3mh2mhme02we3.mmmmmm33NNm:NSNm “’10 —1—4 O—‘NMVHan—1'4 0\"vWOFOOO‘O—‘NMV W‘Ol‘OOG\"3:09mapWQWmdmus—Emm0\".mEZ—”.0w._m<._. 249w:hN_me_Ne8N2mmmmNwenﬁnm2Nm2a2mwmmmm2meoeﬁwe“www:wmwmem5NNwem:RN9mwaeemNM—amweN_:—eeﬁeuwwﬁmeﬁm—mwweem:N:mmm:anomNba:eeme—n:mNﬁ2mamo_:8Nwewamﬂ5NNmHon—bewwemNeeemaweeweeedELMmeweNm3mmm:wt92e2e:02amNewwmme~NmONHNN_m:aemwNHw:e2owm:a9h:EwwﬁeNNeem2No2OSeeHcm3mmNNwne2mm3eEeN~wNwnm2e2:2«Nwewmﬁmwebeem2omw»N_m:Nw_mmmNmm“a\"aaw52Nw5wwemegC—mmmo—OS52Ebe—_:N:NaSHENN—5“~m~m:mN:weN:e:ON.3eN@—5wmmmmmwﬁo:wNmmem~N—owmNﬁ92w:mgmweNM2w:oNO—weommN~NNwEbe0emN~mum:3mm—em—_wmee:NSe—o:_~wmaww2:—wNweem:3mmNawN_wmwwﬁmNom3w»:2:enamNbemm2Ne5—0ﬂww—em—emehwew:NM:0Nm2wohNﬁm:aNmm“mm:wee0252NENm~ona:1aeow“a: O .— 0—‘Nf ﬁﬂ ' webooox0“v '00tmNw:eweNwﬁasemOmwwm2N:we3e:03:—we—NaKmm:—hwhw—2>2ww—mmweon—“mwewh:owoee22m:eNﬁN2we“wwwwﬁmm@—eNmm—m5ww—Mmwm3mm5:me—we—RNO—2QeNweew:2w:camwNwﬁR:n:~N_#5w:onoeweNe—5mm3mo3#N52a:m—wew:me—mmon—beeen02eweem_Nmmmmmemma~Nem3:MNhwH:#2ow—mmmm:—NmHNme2mm:22ON_N:ame“NbN:meme_Nemmmbeew“mNNoeﬁwee2one_SSHE03a:mmKwo_5m9wewN~meﬁ5—m2«NHOwNNH3ONw:mewe—emeN_5N—me—meme_w:awoNHeeHawem2wwOm0No95NNmwewwm:02eeﬁNR.memmema?emeaNmwea2:NN92bemo“NSMN_wNaNon$2wwmNHmNHﬁemwa3Nemmm:o:a5mew5mimmwoe2202mm:NENHMN3:amoe_N:wmmm—a2mmma52m:wweo—emHo:aemeowwmmwm2weanNwhe_wow — o—‘Nm ﬂ 'W‘OFOOOK Co—wIl‘o\\Ol\\OO0\\3:00.mayWQWmiMus—Emm0”.mmUEZ.”.0m.._m_<.r 2505—3Onhmhmmgnomo“02mammho_m9emScmVm#ofam_m2VmmNH0Vmo—Va—ohweemVmﬁweV32:m2hoNm:_o_hmmm:m2wV~tHmh—on2:m2VSw:wVmwﬁ2:M:o9aV:weH3mm—mm3m:hﬁam“weN9#2a20:mm:92m2hVwhhea2V9mahN_mmMVNM0VN2h:wmmh3:ohonﬂmi_N_mod0NNmﬁm3_h02hm:OVhe_N#3mmwsmeVmm2VV~h9VNhVNmm2V:w:anmmm:Vhaw33mmmmM:02V2mmmm_mmN:o:o:2mV_0V_mmhem9m9N:2ofV3hV_haHQchmeo:wNNNmh$—02aVcwmeam—VmV3mammm302NVmV3HNhV_o9mm3:hm3:V20:N:ahhﬁhm:Nh—owhm_hm_on3no02m:N3#2@—NV“hmN2emmm—hm—omwmﬁmm_hm3m2h:VwNSVN—OhmuE2—mmhhﬁmmh—99aVoV3O:#V#.m—amE:«Vm:hmmVa:o:_m_WV5mmVaVo—#Vm:hha:cm:8maOVohah—mamh3cammcm.onOha:2weah— O—‘NMV WOFOOQV2NVomH2mm—03mgw»:02on_hV—hSVmwVH2mmmm_m:mgaw:mm—maNSoh0—ha3:maMhww0VNM:wNHonmahe3hw—mma:N:2Ne—03Vhm3wNo:hmNNOVah0V—8—o:m—h:V2mm—2mmM:hmam00“mV9Nowea:onV2ahcowhm—025—mgm2V:a“:—Nomm3oc—V_VVwh—om—m:3NENV5wh—mgonv9:ohmmVS5m33:93NmowNV—VM:ofme—hV_VamhVNVV_meamNhmVhNasN:Nm02_h3moV0on3Vaamwe9:m2mo—mmwh0:m22:NH.2m2MNNM—hmmV_Vheofmm—aOwhhVNmhNE#V_Vwmammha:0Vofmm“hmcahmmmw:mm2m:SwVoVHwmmm:who:hH0mo:mNNmﬂVmNNmVw?CEOS02a02onHNHVh02m:cmVhHmmVmﬁmmVV~hhﬁhVm:H2Nwmm:mm:hewem2acmVVSmmofmVwe_h_ONHm:o:hm:omOhIhmﬁa2m2ommea:mommomN2#3m:_V_mmam WWPOOON v—«v—1—1—‘u— O—‘NMVFi ﬁ —(HMO—‘NMVWNOFOOO‘M:h#22V#2NM23:00.93WQWmdmus—En.m0”.mung—Dz.“—059.x... 2519:mm93am“mmVmamno5:a“we02m2m9cwm:onmmmaca3wwmN5Nmgm25me“Iabec:owG“02ma:02w:09mmofhm:—MN95mm.m—2.mm“no“onon2mgNE02MN.33mm—mm3Nm33mm“v2awwmwecmScmmmR:m:9:mm02v223:M:mmmmmemeorN:asQ:Nwwham_mm~mmm9.n:5“3cmm_w:NEvmN?>2b:NV2:m_m#30m3va.\"Qbea:m2m2mg53mm:mmmmm2m3SH3;wemm03m:N:_mVNNoﬁo:m5m2VM0:NMNSmuN2Nb3:E3:3209_NhmNomsEmmem:5mm0:avomﬁv2n2v2m3a3HX:v2ofE2:caON3mmmm3of3:m2vowEvmﬂ0v WWFOOON ._‘._‘,_.._‘,_‘ 0\"v v—1—¢—:—4—4O—‘NMV “\\DFOOQ3:8.m?wawmd82Emo;$05;nomama; 252 AnswersTo Selec’red Exercises Exercises1.1 1. (a) 1+3+5+7+9 (e) 3+3+3+3+3+3 4 -l 2- (a) 201+1) (C) 2 f(j+1) j=0 j--l 3. (a) 2532i (1)) ii3 i-l i-l 4- 2(ax—“#0:“!‘ao)+(31'75k)+(a~1_3~2)+' ' ' +(an_ui-l) i-l =an _do =an since a0 =0. Thisis often calleda collapsingsum. 5. Since 2(a,- -a,_,) =an ifa0 =0, weset i=1 n(n+1 an=——-—2 ). Thenao=0and ii+1 i—liai—ai-1=(2 )_( 2) =i2+i-—i2+i_l. 2 Thus, \" \" nn+1 21:2(a1—ai—1)=an= (2)9 z=1 i=1 byExercise4. 253 254 Answers toSelectedExercises _ n+k _ k _ 9. Swan—(k+1).Thenao—(k+l)—0and _a =i+k _i—l+k “i H k+1 k+1 _ (i+k)! (i—1+k)! —(k+l)!(i—1)!_(k+1)!(i—2)! = (i—1+k)! [i+k__l] (k+1)!(i—2)!1—1 _ (i—1+k)! .k+1 _(k+l)!(i—2)! (i—l) =(i_-L+_k>!=(i+k—1) k!(i—l)! k' n i+k—1 _ n+k :4k Him), by Exercise 4. Students should probably write outthe formula inthe form (g)+(k;1)+.. . +(k+z“)=(’;:’:): which is easier tokeep in mindthan when written insummation notation. This is sometimes called the “hockey stick”formulasince itsays thatthe sum ofthe entries inPascal’s triangle inthe handle ofa “hockey stick”as shown Thus, l2 1 3 l l 4 4 l 1 5 10 5 l 1 6 15 15 61 is equal to the entry at the point oftheblade. Ofcourse, sincePascal’s triangleis symmetric, we have Answers to Selected Exercises 255 and the general formula :(i3571)=(2f’f)- Not using summation notation, this wouldbe (,3)+(.,.)+..,+(.,,,>=(Z,,), 5 7 2.1.1.; 3 4 s 5 12. (a) (b) 1 3 $1.1.- 16 2 14. (a) f121‘ Exercises 1.2 1. (a) We must inspecteach set ofequations withcare and attempt todiscover some pattern. Note thaton the rightside ofthe equationswe have multiples of5;5 = 5- 1,10=5- 2,15 =5- 3,25 =5- 5,and40= 5-8.Since1,2, 3, 5, and8 are consecutive Fibonaccinumbers,we writethe equations using the general notation to obtain L +L,=5F2 L2+L4=5F3 L3+L5=5F4 L4+L6=5F5 and itis natural toguess that Ln +Ln+2 =5Fn+1 for alln 21. 256 Answers toSelectedExercises (c) Using the same ideas witha littleextra attention tothe rightside ofthe equations, we can write the followingcomplete withthe appropriateguess: Fg —- F2 =0- F; Thissuggests thatwe should de ﬁ neF0 =0. F§ — Fg =F1F4 F3, -F3 =F2F5 Fg — F2 =F3F6 F2 — F§ =F4F-, Fn+1-F3: =Fn-1Fn+2- 2. (b) In order for(1.16) to hold forn=—1, -2,—3, -,4and—5, we wouldhave tode ﬁ neF_=1,_,F2=—1F_3 =2,F_4 =—3, F_5=5 3. Proceedingas inExercise1, we would write (a) F§—Fi=F4 (b) Fi—F¥=4F2F3 F2—F§=F6 F§—F§=4F3F4 F2 F—2=F3 F2— F2=4F4F5 F2_ F2=F10 TF2:4F5F6 Fn+2— Fi=F2(n+1) Fi+3_F2=4Fn+a+2 Note: One mightalsoguess that Fn+2 _ F:= Fn+a+l- 5.(8)2Fi=Fn+2—1 (b)2F2i—1=F2n i-l i-l 6. (a) i(—1)\"\"F2.-=(—1)\"-'FnF,.+1 (c) iFZH =F2, [-1 i-l 10- F3; — Fn—a+k =(—1)\"+\"F§ Exercises 1.4 1 . (a) Suppose thatthere is a least positivereal number,say r. Then r/2 <rand r/2 is a positive real number. Thisisa contradiction. 3. (a) Thisis clearly true forn=1. AssumethatE’F—=1 (21' +l)— =k2 +2. Thenwe would have to show that2’52} (2i + 1)-— (k +1)2 +2 But,by assumption, 25-“:11(2i+ 1)=k2+2+2(k+1)+1 =(k+1)2+3ae(k+1)2+2 Answers to Selected Exercises 257 6. Since22' l -1 =3, the resultis true forn =1. Assume thatthe resultis true for n =k. Then there exists an integerq such that22\"—1 =3q, Butthen 22<k+1)—1=4-22k—1 =3-2k+2k—1 =3 -2\"+3q =3(2\"+q) and the resultis true forn =k +1 ifitis true forn =k. Therefore, the resultis true for alln 2 l,by principle Il. 9. Since 32‘ °+1 +2°+2 =7, the result is true forn =0. Assume that 32\"+1 +2\"+2 =74 forsome integerq where k 20 is ﬁ xed. Then 32(k+l)+l +2(k+l)+2 =32k+3 +2k+3 =9. 32k+l +2. 2k+2We write itthis way to bring inthe32\"+1 and 2\"+1 ofthe assumption. Since we’re interested in =(7 +2)32\"+1 +2- 2\"+2 divisibility by7, we write9 as 7 +2. =7. 32k+1 +2(32k+1 +2k+2) =7' 32k+'+2- 7q =7(32k+l +2q) and the resultis true forn =k +1 ifitis true fork. Therefore, the resultis true for alln 20 by Il, starting with0 instead of1. 12. (a) Thisis easily checked forn =1. Assume that 25:. F,- =Fk+2—1. Then k+lk 21 Fi=2Fi+Fk+1 ,= i-l =Fk+2—1+Fk+l =Fk+3_1, by (1.16). Thus, the result follows by principle Il. 13. Clearly, (a0— [PM/E =0 =F0 and(a1— [mp/3 =[(1 +J3)/2— (1— J3)/2]/ J3 = 6/6=1 =F],so the resultis true forn =0 and n =1. Assume that Fk= (ak— mmand FH,=(ak+1 —pk+')/J§ forﬁ xed k20. Then, by (1.16), 258 Answers toSelected Exercises Fk+2=Fk+l+Fk ak+l _ﬂ k+1 ak- Bk _ J5 +J3 =a\"(a+l)-B\"( ﬂ +l) J3 Since =a_k¢£2% ﬂ _k ﬁ _2 a2=a+lak+2_5/;k+2 and ﬂ z= ﬁ +l. —T and the result follows by principle14. 18. Since the result inExercise17 is true forallnonnegativeintegersn and m,we may set m =n— 1. Thisgives F2n ==Fn+(n-l)+l = FnFn—l + Fn+a _n(Fn—l +Fn+l)a which implies that Fazn- Exercises 1.5 1. Note that4 <5 <9, so that2 <J3 <3. Nowsuppose thatJ3is rational. Then there exists a least positive integerb anda positive integer asuch thatJ3 =a/b. Thus, 2 <a/b <3 and itfollows that 2b <a <3b andhence that 0 <a— 2b <b. Since J3 =a/b, itfollows that a2 5 =33, 5 b2 = 5b2 -2ab =a2— 2ab, b(5b— 2a) =a(a— 2b), a 5b— 2a 6— _ _a— 2b' But this gives J3as the ratio ofthe twointegers where the denominatOris positive butless thanb. Since thisis a contradiction, J3is irrational. 5. Suppose thatthe assertion isfalse. Thenthereexistsa least positive integer rsuch that 2i=1 i=# r(r +1)/2. Note that r >1 since the equalityclearly holds for r =1. Thus, we may write r =k +1, where kisa positiveinteger. Now, ifthe assertion holds forn =k, we have that Answers to Selected Exercises 259 k+1 k(k+l)2(k+1) (k+lk+2 gli=2i+(k+l)=+2 =)2( ), so the assertion also holds forn =k +1. But itdoes not hold forn =k +land therefore cannot hold forn =k. Repeating thisargument ktimes,we have that the assertion is false forn =1, whichisa clear contradiction.Therefore,the original assmption thatthe assertionwas false isfalse and the resultis true,as claimed. Exercises1. 7 1.Each number inthesequence is ofthe form100k +1 l =4(25k +2) +3 with k a nonnegative integer. Thus, every integer inthesequence leavesa remainder of3 when divided by4 andso cannotbea square. . Leta, a + l,anda +2 be any three consecutiveintegers. By the divisionalgo- rithm,there exist uniqueintegers q and rwith0 S r <3 such thata =3g +r. If r=0,3|a. If r=1, a+2=3(q+1)and 3|(a+2). If r=2,then a+l = 3(q +1) and 3|(a +1). . By the division algorithm,there existintegers u and rwith0 S r <|b| such that = lq+r. Since b <0, |b| = -b.Therefore, setting —u =q, we obtain a=—bu+r=bq+r, as desired. Exercises 1.8 l.(a) 24710 =5027 . (a) 3248 =21210 4. Note: Octal notationis used throughout. (a) 257 (b) 257N 4-éél ><§§1 640 1257 2032 1015 122277 6.(a)ii11001012——745,,1111001012=1E516 PM ,-~. PM 7. (a) 257,,=0101011112 10. (a)8210 =122.10 12. Suppose thatwe are adding inthe kthcolumnandneed tocarry tothe (k +1)st column. That part ofthe computation wouldcorrespond to 260 Answers toSelected Exercises [dk+l(_10)\"+1 +dk(_10)\"] +[ck+l(_10)k+1 +ck(_10)\"], where dk +ck =10 +ek, whereek is the digit inthe kthcolumn ofthesum. We would have [dk+l(_ 10)“! +dk(— 10)k] +[Ck+1(— 10),?” +Ck(_10)k] = dk+l(_10)k+l +Ck+1(_10)k+l +(dk +ck)(-10\") = dk+l(_10)k+1 +Ck+1(_10)k+1 +(10 +ek)(_10k) =(dk+l— 1)(— 10)\"+1 +Ck(— 10)\"+1 +ek(—10)ks which shows thatwe subtract fromthe digitdk+1 inthe (k +l)stcolumn. 14. In the following,base— 10 notationis used throughout. (a)1 b5 347 ( ) 3417 + _5§ — ﬂ 385 309 15. Note: Unsubscripted numbers willbe written inbase10. (a) 276-10 =2(—10)2 +7(—10)+6 =206— 70 =136 (c) 27.6%.“, =2(— 10) +7 +6(—10)'l +9(-10)2 +9(—-10)\"‘ +9(—10)“ +- - - 0.09 =— 13.6 +1_—0.01=—l3.6 +0.09 =—13.509 Exercises 1.9 l. (a) Leta =2%23' a,.10i andb =2,3151 b,-10i be the decimalrepresentations ofa and b, respectively. Setting A0 =25:01(1110\", AI =213:? ailoi‘\",Bo = 2?:01b, 10‘, and Bl=2%:;‘b,-10\"‘\",we have thata =10\"A1 +Aoandb = 10\"B1 +Bo. Onehas only to multiplyoutthe left-and right-handsides tosee that ab =(102\" +10\")AlBl +10n(A1_A0)(Bo _Bl) +(10\" +1)AoBo. 4. Both results are true forn =1 byhypothesis and itfollows thatthereexistsa positive constant Csuch that f(x) <Cg(x) forall xinD.Assume that bothresults are true forn =k, where k_>1 IS ﬁ xed. Thenthere exist positiveconstantsC1 and C2 such thatE\"—=1 f(x) <C1g(x) andH-—=1 f(x) < n\"(x)forall xinD. Butthen [(+1 2ﬁ (X) = E ﬂ x)+ ﬁ c+1(X) <C1g(x) +C’g(X) SCagOC), i-l i-l whereC3 IS the larger ofCl and C’.Similarly,l'I\"+1 f(x)H1-1 f(x) ﬁ c+,(x) < n\"(x)-C’ g(x)=C4gk+‘(x), where C4=C2C’. Butthese last twosentences imply that 2§i11f= 0(g)andI'll-‘1'} O=(g\"+‘) and the result now follows by mathematical induction. Answers to Selected Exercises 261 Exercises 2.1 1. 3. Since ala, alb, andc =a +b, itfollows from property (v) ofTheorem2.1 thatalc. Since m|(35n +26), m|(7n +3), and 11 =(3571 +26)— 5(7): +3), it follows from property (v) ofTheorem2.1 thatm|11.Since m >1 and11 isa prime, itfollows that m =11. . Ifa =bq +r, then r =a— bq. Since bla, itfollows fromproperty(v) ofTheorem 2.1 that blr. Butsince 0 S r <b, this contradicts Theorem2.2 ifr9% 0. Therefore, r =0 and bla,as claimed. Exercises 2.3 1. (a) (357,629) =17 =357(—7) +629- 4 (—357,629) =17 =—357- 7 +629 +4 5. Ifbla, there exists an integerq such thatbq =a. Therefore, a = iqlbl and|b|la. 10. 15. 18 Since lbllb,|b| isa common divisor ofa andb. If fis any other commondivisor, then fla, flb, and hence f||b|. Therefore,(a, b) =|b| by Theorem2.5. Con- versely, if(a, b) =lbl, itfollows that|b||a,so thata =|b|q forsomeq. Butthen a = iq- b and blaas claimed. . Let d =(a, b) ande =(a +c, b). Then dla,dlb, andsince blc,dlc. Therefore, by property (v) ofTheorem 2.1, d|(a +c). Thus, disa common divisor ofa +c and b, so dle, by Theorem2.5. On the otherhand,sincee =(a +c, b), e|(a +c) ande| b. Butsince blc, itfollows thatelc. Therefore, by property(v) ofTheorem 2.1, e|a since a =a +c— c. Thus,e isa common divisor ofa andb, so eld,as before. Therefore,e =d, by Corollary2.3. Let d=(a+b,a—b).Since 2a=(a+b)+(a-b)and 2b=(a+b)- (a -b), itfollows that d|2aand d|2b. Therefore, d|(2a,2b). ButbyExercise9, (2a, 2b) =2(a, b) =2-1 =2. Therefore, d|2 and d=1 or2. Lete =(a, bc). Since r =(a, b) ands =(a,c), itis clear thatr|eandsle, and rq1 =b andsqz =c forsuitable integers ql and q;. Butsince (b,c) =1, there exist integers xand ysuch that 1 =bx +cy =r(q1x) +S(¢12J’) and hence that(r,s) =1. Thus, by Theorem2.13,rsle. Onthe otherhand, there exist integers h, i, j,and ksuch that r =ah +biands =aj +ck. Therefore, rs =azhj +achk +abij +bcik = a(ahj +chk +bij) +bc(ik) and itfollows thate| rs. Therefore,e =rs,as claimed, by Corollary2.3. . Since 2 =F3 andF3|F3q byExercise19 ofSection1.4, itfollows that2|F,, if 262 Answers toSelectedExercises n =3 q forsomeq. Nowsuppose that2|F,,. Bythe division algorithmthere exist q and r with0 S r <3 such thatn =3q +r. Butthen, byExercise17 ofSection 1.4, Fn =F3q-l+r+l =F3q—lFr + qFr+1- Since 2|F,, andF2|F3q, itfollows that2|F3q_,F,. But(F3q_1,F34) =1, byExer- cise 16. Since 2|F3q, itfollows that(2,1734-1) =1 andhence, by Theorem2.8, that 2|F,. But F, =0 or1 since 0 S r <3. Therefore, r =0 and3|n,as claimed. Exercises 2.4 1. (a) [357, 299] =357- 299/17 =13,209 2. (357, 629, 221) =17 =357(—7) +629- 4 +221- 0 7. By Exercise5 ofSection 2.3, (a,b) =|a| ifand only ifalb. Therefore,[a,b] = la- b/(a,b)| =Id- b/lall =|b|ifandonly ifalb. 9. Since12712 +16n +6 =(6n +5)(2n + l) +1, itfollows that(12n2 +16n +6, 6n +5) =1and[12712 +16n +6, 6n +5] =(12112 +16n +6)(6n +5)/1 = 72n3 +156712 +11671 +30 forevery integern. Exercises 2.5 1. (a) 4725 =33- 52- 7l 2. (4725, 3234) =2o- 3l- 5°- 7l- 11°=21 [4725, 3234] =2l- 33- 52- 72-111—— 727, 650 4. r(4725)-—— 4- 3- 2=24, 0(4725)=—::—1—- —5—:—l-- ﬂ=9920 9. Leta—— HM piiwitha, >Oforall1. Then1(a) =115.1(a,- + l)isoddifandonly ifa,- +1 is odd foralli, thatis, ifand only ifa,- is even foralli. Butthisisso ifand only ifa is a square byExercise8. 13. If{r1, r2,.. . , r.) is anyset ofintegers, let min(r1,r2,. . . , r,) and max (r,,r2,. . . , r.) denote, respectively, the smallest andlargest ofther,-, IS iS t. Leta =Hf=1p?i,b =H£=1pf-’i,andc =HE=1 pf'witha,>0,17, >0, and c, 20 for all ibe the canonical representations ofa, b, andc, respectively. Without further indication, inwhat followsweuse Exercise11 repeatedly. (a) Letu, =min(at,b,-, 6,),v,- =max(a,, b,,6,), andw, =max [min(a,, bi), min((1,, ct), min (bi,c,)] for alli. Then(a,b, c) =H£=1 1);“ [a,b, c] =Hf=1p231, and [(a, b), (a,c), (b, c)] =Hf=1 p)”. Withoutloss ingenerality,we may, forany i, take a, Sb,- S6,. Thenu, =a,- andv,- =c,-. Also, Wi =max [min(at: bi), min(abCi): min(bi,6%)] =max((1,,(1,, b,-) =b, Therefore, ui, vi, andw,- are the numbers a,, bi,andc,- insome order foreach i, and itfollows that Answers to Selected Exercises 263 (a,1). C)[(a, b), (a,C),(b, 6)]la,b,c} r = Hpf ﬂ +wi+ui i=1 =r 4i+bi+ci.131 p. =abc, as claimed. 14. Allthe followingare possible. abcd =(a,b,c, d)- [(a,b,C), (a,b, d),(a,c, d),(b,c, d)l - ([a,b, c], [a,b, d],[a,c, d],[b,c, d])- [a,b,c, d] abcd =(a,b, c, d)[abc,abd, acd, bcd] abcd =(abc, abd, acd, bcd)[a,b,c, d] abcd =(ab,ac, ad,bc, bd, cd)[ab,ac, ad,bc, bd, cd] abcd =(a,b,c, d)[(a,b,C), (a,b, d),(a,c, d),(b,c, d)] - [ab, ac, ad,bc, bd, cd] abcd =[a,b,6. d]([a,17. 0], la,b, d],[a,c, d],lb,6, dl) - (ab, ac, ad,bc, bd, cd) Exercises 2.6 2. Ifeithers or tis ofthe form3q, then clearly 3|x. Ifneither3 nortis ofthe form3q, then since (3q +1)2 =3(3q2 +2q) +1 and (3q +2)2 =3(3q2 +4q +1) +1, itfollows thatthere existu and12 such that32 =3 u +1 andt2 =3 v +1. Butthen y=t2—sz=(3v+1)—(3u+1)=3(v—u) and 3| y. The argument for5 is completelyanalogous tothe argument for3. Finally,since x =231? and one ofs and tis even, itfollows that4|x. 4. Suppose that (x, y) =d >1. Thenthereexists a prime psuch that pld.Since dlx and d| y, itfollows that plxand ply,andhence also that plx2and plyz. Butthen plz2 since22 =x2 +yz. But then plzand thisviolates (x,y,z) =1. Similarly, if (y, z) = d >1, there existsa prime psuch that pld.Since dl yand dlz, itfollows that plyand plz,and hence p| y2 and plzz. Butthen plx2since x2 =z2— y2, and it follows that p|x. This violates (x, y, z) = land the proofis complete. 8. Let x, x +1, and x +2 forma primitivePythagorean triple.Since one ofany two 264 Answers toSelected Exercises consecutive integers is even and the other odd andsince twomembers ofany primitive Pythagorean tripleare odd andone is even, itfollows that x +1 is even and xand x +2 are odd. Therefore, there exist positiveintegerss and t withs >t, (s, t) =1, and one ofs and teven and the other oddsuch that36+1 =2st, x=s2—t2, andx+2=s2+t2. Butthen2=(x+2)—x=2t2,so thatt=1, and 1=(x+1)—x=2st—(sz—t2)=2s—s2+1. Thus 0=s(s—2).But this implies thats =2 andhence thatx =3, x +1 =4, and x +2 =5 is the only primitive Pythagorean tripleconsisting ofconsecutiveintegers. Exercises 2. 7 1. (a) [2.7] =2 (e) —[— 2.7] =3 (j) {—3.5 +0.5] =—3 4. Itsuf ﬁ ces to show that |[a + 5— a] S1. By property(a) ofTheorem2.27we have that a—§<[a+§]sa+§. Therefore —%<[a+%]‘0tS%, so |[a + ﬂ— alS%- Suppose that twointegersare equallynear0:. Then a = n + §forsome integer11,01 +% =n + l,and[a +1;] =n +1. Thus, inthiscase, [a + ﬂis the larger ofthe twointegers equallynear a. 8. Let a=n+6with OS 0<1. Thenthereexists rwith0 Sr<ksuch that r/k50<(r+1)/k. Since ka=kn+k0with rsk0<r+1, itfollows that [ka]=kn+r.Also, a+i/k=n+0+i/kwith (r+i)/kst9+i/k< (r+1+i)/k52k/k=2for0Si<k. But050+i/k<1forOSi<k—r and 130+i/k<2for k-rsi<k.Thatis, 030+i/k<1forthe k—r values of ifrom0 to k— r—1 and lS0 + i/k<2 forthe rvalues ofifrom k— rtok—1. Thus, [a]+[a+—]1;]+- - - +[a+k;kl]=(k—r)n+r(n+l) =kn+r=[ka], as claimed. 9. 3m Since 30 +10 +3 +1 =44, itfollows that 3“]l9ll. 3139 3ll_0 3|; 3ll 0 Answers to Selected Exercises 265 15. Let p\"||(a +b)!, p\"||a!, and pwllbl. Therefore, if pI (\"J; b), it follows that f=u— v -w. But, by Theorem2.30, a+b-:c,- b—ibi a—iat i=0 ___ = i-O _ _i-OuD W p_1 p—l17—1 2(ai+bzcl) =i=0 17—1 and the result follows. 19. Ifpalln, thebase prepresentation mustbe ofthe formn =25.0c,-pi withco = cl =-- - =ca_1 =0, r 2a,andca=# 0. Also, thebase1) representation of p“is 219:0 dipi withda =1 anddo =d, =- - - =da_1 =0. Thus,thebase prepre- sentation ofn -p“is 2?;o'cip‘ +(c“‘— l)p°‘ +25.0,“cipi and itfollows that there is no carry inadding p“ton— p“inbase1). Thus, byExercise16, P’1 (prim). 22. Itis easy to check directly thatthe resultis true forn =0 andn =1. Since l ﬂ l =|(1 — J§)/2| =0.618- - - , itis clear that|,B\"| <0.4 forn 22. Therefore, forn 22, an _ﬁ n an +I ﬂ ln an1 ann Fn=—S——<—+—-<—+1 ——=F,,+l J3 J3 J32 J3 J3 and the result follows. Exercises 3.2 2. Since 5, 11, and 23 are ofthis form,the followingargumentis notvacuous. Suppose there are only ﬁ nitelymany primes ofthis form,say p1 , p2,. . . , p,and consider m=6p1p2° ' ' 15-1 Since m is ofthe form 6k—1 and m clearlyexceeds pi for lS iSr, itfollows that m mustbe composite. Therefore, m musthave primefactors ofthe form 6k +1 or 6k— 1. Since the product ofany twonumbers ofthe form 6k +1 is again of that form, m musthave atleast one prime factor ofthe form 6k— 1; thatis, pilm for some1‘. But this implies thatpil1, and thisisa contradiction. 5. We know fromExercises4 and5 ofSection1.7, thatatleast one ofthe numbersp, p +1, p +2 is even and atleast oneis a multiple of3. Since1) >3 and pand p +2 266 Answers toSelectedExercises are both primes, itfollows that2|( p +1)and3 |( p +1). Since (2, 3) =1, itfollows from Theorem 2.13 that 6|(p +l). Exercises 3.3 2. We are assuming that . nlnn 11m = n—pco p\" 1. (1) From this itfollows that lim pm =1im{ pm ,nlnn,(n+1)1n(n+1)}=1_ n—m 1),, n—>°° (n + l)ln(n +1) p\" n1n n (2) Also, since the logarithmic functionis continuousand, by Tchebychef’s theorem, . n1n n 11m ”\"W’ pn >0, the logarithm ofthe limitin(1) is equal tothe limit ofthe logarithm.Thus,we obtain lim (lnn+1n1nn—lnp,,)=0 n—bm 01’ limlnn-(l+ n—Nx: lnlnn lnpn)——=0. lnn lnn Since the second factor inthislast limitmust tend tozero andsince lnlnn_ 9 lim n—m 1n n it follows that lim 13.12:1. n—>°° 1n It Now, for x 22, determinen by the inequality aX<pn+1. (3) Then x—>00 as n—>00 and conversely. Also, n = Mp\") S ”(x)Sn(p..+1) =n +1 (4) and 1n1),, S In x<1npn+1. (5) Answers to Selected Exercises 267 From (3) and (5) we obtain pn <X <pn+1 1n Pn+1 EIn p.‘ (6) Combining (6) and (4), we obtain 11 <75(x) n +1 (7) pn+1/lnpn x/lnx pn/lnpm' Now . . 1 ,,. ln1hm__n_=hmm=hm(nn\". _P_. ﬂ )=1(8) \"—m PHI/11117» n-’°° Pn+1 \" I’nPn+1 1“n by (2), (3), and the hypothesis. Similarly, n+1 =1im(n+l)lnp,,+l 1m 71\"” pn/ln pn+l \"'\"°pn (9) ___ lim [01 +1)1n(n+1)_Pn+1. lnPn+1 :l=1 ,,_.., pmpn mm +1) ' But, since x—>00 as n—> 00, (7), (8), and (9) together implythat 191= n—>°° x/lnX ’ as desired. Exercises 3.4 1. an_1=(a+1)(an—l_an-2+an—3_.. . +a_1) 3. Consider f(n +k)— 2 =22\"\"—1 =22-21: — 1. Let h(x) =x2” -1. Since h(— 1) =0, itfollows fromthe factor theorem ofelementaryalgebra that h(x)has x +1 as a factor. Setting x =22\", itfollows that f(n) =22” +1 isa factor of f(n +k)— 2 =2m\"— 1. Therefore, ifd = (f(n),f(n +k)), itfollows that d|2and d =1 or d =2. But f(n) is odd foreveryn,so d =1, as claimed. 9. By direct calculation itis easy toshow that523,776 =29(2l0— 1). Since10 is not aprime, this numberis notperfect. Also,33,550,336 =212(213— 1). Since M13is a Mersenne prime, this numberis perfect. Exercises 4.1 1. (a) This is an equivalence relation. (b) “Less than or equals”is notan equivalencesince itis notsymmetric. 2. (a) Forintegers, leta=I= b ifand only ifla— b| <2. This relationis re ﬂ exive and symmetric but not transitive. 268 Answers toSelectedExercises 6. 10. 23. 28. Since 10 E3 (mod7),102 E32 E2 (mod7),103 E20 E—1 (mod7), and it follows that10515 =103‘ ”1+2 =(103)171102 E(—1)171- 2 E5 (mod7). Since there are m numbers we onlyneed toshow thatno twoare congruent modulo m. Suppose that aik E ajk (modm) with1 S i < jSm. Since (k, m) =1, itfollows from Corollary4.7, thata,- Eaj (modm), and thisisa contradictionsince al, a2,. . . , a\", forma completeresiduesystem modulom. Modulo3 any integera is congruent toone of— l,0, or1. Consequently,a3 is congruent to— 1, 0, or1, respectively, anda3 Ea (mod3) ineverycase. Multi- plying byaz, we havea5 Ea3 (mod3). Therefore,a5 Ea (mod3). Similarly, any a is congruent modulo5 toone of—2,— l,0,1, or2. Since25 =32 E 2 (mod 5), itfollows that(— 2)5 E -2 (mod5). The computationsare trivialin the othercases, so againa5 Ea (mod5) ineverycase. How many different ordered pairs ofintegers (x, y)are there modulom? Since there are precisely m choices for xand mchoices fory, thereare preciselym2 different ordered pairs ofintegers modulom. Nowconsider them2 +1 pairs (E_1, F,),1 S iSm2 +1, ofFibonaccinumbers.Since thereare onlym2 dif- ferent possible pairs modulom, itfollows fromthe pigeonhole principle thatat least two ofthese pairs mustbe thesame modulom. Thatis, there mustexist k and k+h with k2l,h 21,such that Fk_1 E Fk+,,_l (mod m)and Fk EFk+h (modm). But then, modulo m, Fk+h+1=Fk+h +Fk+h—l EFk +Fk—l =Fk+la Fk+h+2 =Fk+h+l +Fk+h E Fk+1+Fk =Fk+2, and wesee thatthe cycle Fk_1, Fk,. . . , Fk+h_,repeats ad in ﬁ nitummodulo m. In fact, itis easy tosee thatthe periodstarts with0 since, fromabove and the Fibonacci recurrence, Fk—z =Fk _Fk—l—=' Fk+h— Fk+h~1=Fk+h—2 (modm), so the period can be shown to start withFk_2. Butthesame argument would show that itstarts with Fk_3 , andso on. Thus, after ksteps, wesee that itcanbe considered to start withF0 =0. Therefore,sinceF0 E0 (modm), itfollows that F}, E 0 (mod m),F2h E0 (modm),F3}, E0 (modm), andso on. Exercises 4.2 1. (a)s=3+7+6+8+6=30and t=3—7+6-—8+6=0,so 37,686is divisible by3 and11 but notby9. Answers to Selected Exercises 269 2. Modulo7 we note that IE],10 E3,102 E2,103 E -1,104 E—3,105 E—2, 10‘5 E1, and thatthe consecutive subsequent powers of10 continue torepeat this pattern ofresidues. Nowsuppose that n = an10”+ a,,.,10\"‘l +- - ' + (“'10+a0 is the decimal representation ofn. Itthen follows that nEa0+3a,+2a2-a3—3a4—2a5+a6+3a7+-- - (mod7), so thatn is divisible by7 ifand only if u=a0+3a1+2a2—a3—3a4—2a5+a6+3a7+- - - is divisible by7. The ambiguous dotsare intended to indicate thatthe pattern1, 3, 2,— 1, — 3, -2 is repeated consecutively untilallthe digits inthe representation of n are used in the computation ofu. Forexample,20, 135,738 is divisibleby7 since 8+3-3+2'7-1'5—3-3—2-1+1-0+3-2=21 is divisible by7. Indeed, we obtaina shortertest than justdescribed ifwe note thatsince 103 E—1 (mod7), n =anIO\" +c1,,_110”\"l +'- - +al- 10 +a0 =(a0 + 10a1+102a2)+103(a3 +10a4+102a5)+'- . E (a0 + 10a1+102a2) -(a3 + Na, +102(15) +'- - (mod7), so thatn is divisible by7 ifand only if v=(ao+10al+102a2)—(a3+10a4+102a5)+- - - is divisible by7. Then, ifonedesires, the ﬁ rsttest described mightevenbe used on v. For example, for20,135,738 we have v=738—135+20=623 and we can eithertest 623 directlyor, using the ﬁ rsttest, note that for623 u=3+3~2+2-6=21, and again we conclude that20,135,738 is divisible by7. 7. Since (10, p) =1, there exist integers xand ysuch that10x +py =1. Setting —x =k, this implies that py =10k +1. Exercises 4.3 1. Since we have(15(7) =6 numbers, allare relatively prime to7, and no twoare congruent toeach other modulo7, the given numbers forma reduced residue system modulo7. 3. By hypothesis, ai<ill-+1, (aim) =1, and0 < ai<m foreach1'. Also,a, E aj (mod m) for ia.Consider the numbers m— a,,m— a2,. . . , 270 Answers toSelected Exercises 12. 19. m — aw”).Sincea,- < am foreach i, itfollows thatm— am <m -a,- foreach i; that is, m—a¢(m,<m—r14,(,,,)_l <- - - < m—al.Since m —a,-E -a,- (mod m) foreach iandsince a, Eaj (modm) for iEj,itimmediately follows that m—a,- E m— aj (mod m) fori=# j.Also,since(—(1,, m) = (ai, m) =1 and m -a, E—ai (modm), itfollows fromTheorem4.13 that (m— at, m) =1 foreach1'. Finally,since 0 <a, <m foreach i, itfollows that O < m— a,- <m also. Thus,since a],a2,. . . , awn)are the onlynumbers that satisfy the given conditions, andsince m— aw\"),m— a¢(m)_1,. . . , m — al satisfy the same conditions,the twosets ofnumbersare identicaland al=m_a¢(m), a2=m_a¢(m)_l,. .. , a¢(m)_l=m_a2, a¢(m)=m_al, as desrred. . Since ¢(p) =p— 1, a reduced residue system modulo pmust contain p—1 integers, each relatively prime to pand no two ofwhichare congruent modulop. Thus, we have only toshow that(a', p) =1 for i=1, 2,. . . , p -1 and that a‘ Ea1 (mod p) for iE j.The ﬁ rst ofthese results follows directly from Theorem 2.12, since (p,a) =1. Nowsuppose that ai Ea1 (mod p) with1 s j< isp— 1. Since(a1, p) =l foreach j,we may divide bothsides ofthis congruence bya1 to obtain (1H E1 (mod p)and1 S i— jsp— 2. Butthis violates the condition that p- lis the smallest positivevalue ofe such that a“ E1 (mod p). Therefore, ai E aj (mod p) for i=# jand the proofis complete. By Fermat’s theorem, p\"’1 E1 (modq). Since ql\"_l E0 (modq), itfollows that p\"-1 +q“\"1 E1 (modq). Similarly,we obtain p\"’] +q\"-1 E1 (modp). Since (p,q) =1, itfollows fromTheorem4.9 that p\"‘1 +ql\"1 E1 (modpq). By the second form ofFermat’s theorem a” Ea (mod p)and b” Eb (modp). Since a” E b” (mod p), itfollows thata Eb (modp). Thus, a =b +prfor some integer rand, by the binomialtheorem, a” =(b +pr)” =b» +(’1’) bp“(pr) +(’2’)bp—2(p,)2 +-- - + (pry =N+ ﬁ Q where q is an integersince allterms on the rightafterthe ﬁ rstare integers divisible by p2. Therefore, a” E b” (modp2),as was tobe shown. Answers to Selected Exercises 271 Exercises 4.4 l. 4. Since 36 =729 E1 (mod91), itfollows that391 = 3\" ‘5“=(3“)15- 3 E 3 (mod 91). Yet91 =7- 13, so 91 isa pseudoprime tothebase3. Ifn is an odd pseudoprime tobase a, thenn is composite and a\" Ea (modn). But then (It -a)\" E (—a)\" =(— 1)\"- a\" E—a En— a (modn) andn isa pseudo- prime tobase n— a. . Since pis a prime, 2\" E2 (mod p) by Fermat’s theorem. Thus, 2\"— 2 =kp for some integer k. Therefore, 2M» — 2 =22\"-1—2 =2(22\"-2— 1) =2(2kn— 1) = zap-1)(2p(k-1)+2p(k-2) +. . . +2p +1) E 0 (mod14,) since Mp =21’ — 1. Therefore,since Mpis composite, itisa pseudoprime tothe base 2. . By hypothesis a\" Ea (modn) and b\" Eb (modn) andn is composite. There- fore, there exist integers h and ksuch that a” =a +kn andb\" =b +hn. Butthen (ab)” =a”b\" =ab +ahn +bkn +hkn2 E ab (modn). Therefore,n is a pseudoprime tothebase ab. Exercises 4.5 l.(a) 01 2 3 45 Additionmodulo6 0 01 2 3 45 1 1 2 3 4 5 0 2 2 3 4 5 01 3 3 4 5 0 l2 4 4 5 01 2 3 5 5 01 2 3 4 (b) Since the entries inthe tableare theleast residues oftheresults oftheusual additions and since addition ofintegers is closed, associative, and commuta- tive and 0 is the additive identity,thesame is true foraddition modulo6. Moreover,-—0 =0,—1 =5, —2 =4, —3 =3, —4 =2, and—5 =1,so all elements have additiveinverses. Therefore, the integers modulo6 forma group under addition. 272 Answers toSelectedExercises 8.Since the integers modulo p forma ﬁ eld,bhas an additiveinverse whichwe may writeas— b and ahas a multiplicativeinverse whichwe may writeas (1“.Thus, ax +b =c ifandonly ifax =c +(—b), ifandonly ifx= a“(c+(— b)). Exercises 5.1N . (a)5 (c) 45, 94 . xk=5 +7k,yk=5—15kfork=0,i1,i2,.. . . A general solutionis (9 —3h +13k,— 14 +5h— 21k,h). Ofcourse, performing the solutionsteps ina differentorder, one could obtaina general solution that appears different—(1 + r +2s, r,7 +17r +213), forexample. Note that ifh = k =0, the ﬁ rst solutiongives (9,— 14, 0), whichderives fromthesecond solution whenr=—l4 ands=11. Exercises 5.2 l.The solution23 is unique modulo105. 4. Solutions of3x E7 (mod5), xE1 (mod4), and 5x E2 (mod11) are, respec- tively,— 1, 1, and—4. Using the Chinese remainder theorem tosolve simulta- neously the system xE—l(mod5), xEl(mod4), xE-4(mod11), we obtain 29as a solution to thissystem andhence tothe originalone. The solution is unique modulo220. . (a) 157 (c) 6997 . Consider the system xE 0 (mod2), xE -1(mod3), x E—2 (mod5), x E—3 (mod7), XE—4 (mod11). Ifx0 is a solution then x0 E0 (mod2), x0 +1 E0 (mod3), x0 +2 E 0 (mod 5), x0 +3 E0 (mod7), andx0 +4 E0 (mod11). Since x0 =788is a solution, ﬁ ve consecutive integers withthe desired propertyare 788, 789, 790, 791, and 792. 12. Consider the system xEcl (modm1), XE62 (modm2), where (m,m2)| (cl— c2). Clearly,C; isa solution tothesecond congruence andc2 +mzzisa Answers to Selected Exercises 273 solution foreach2. Thus, we mustbe able tosolvec2 +mzz Ecl (mod m,), that is, mzz Ec1 — c2 (modm1). Butthisis solvable ifand only if(m1, m2)|(c1— c2). Moreover, any solution to thislast congruence is ofthe form20 +kml/d,where d =(m1, m2). Thus, every solution ofthesystem is given by CZ +m2(Zo +kml /d) =C2 +mzzo +kmlmz/d for some integer k. But mlmz/d =[ml, m2],so allsolutionsare unique modulo m = [mlmzl- Exercises 5.3 l 3. . (a) 89 51, 426, 801 5. By elementary algebra there exista polynomial q(x)and an integer rsuch that f(x) =(x— a)q(x) +r. Therefore, f(a) =(a -a)q(a) +r =rand f(a) E r (mod m),as was tobe shown. 8. Since r(x)is linear,we may write r(x) =ax +b. Therefore, f(x)E (x -2)(x -3)q(x) +ax +b (mod7) and since f(2) E5 (mod7) and f(3)E2 (mod7), we obtainthesystem 2a+bE5(mod7), 3a+bE2(mod7). Subtracting the ﬁ rstcongruence fromthesecond, we obtaina E— 3 (mod7), and this implies thatb E4 (mod7). Therefore, r(x)=—3x+4 satis ﬁ es the given conditions. Exercises 5.4 2. As indicated inthe hint inthe statement ofthe problem, p—1 E—1 (modp), p— 2 E—2 (modp),.. . , p— kE—k (modp).Therefore, (p—1)(p—2)' ' ' (p—k)E(—1)\"k!(mail?)- Also, since h+k=p—1, it followsthath=p—k—1 andh! =(p—k—l)!. Combining this with (l),we now obtain (1)— l)!E (—1)kh!k! (modp) or, on multiplying through by(— l)\", 274 Answers toSelectedExercises 12. 15. h!k! E(— 1)\"(p— l)!E(— 1)\"+1 (mod p) since (p— 1)! E—1 (mod p), by Wilson’s theorem. . Suppose thata is an element ofS ={2,3,. .. , p— 2}. Since p la, the con- gruence ax E1 (mod p)has a solutionb with0 Sb <p. Clearly,b E0, since 0 E1 (mod p). Similarly,b E1, since this would implythata E1 (modp). In like manner,a E p— 1, since this would implythat—a E1 (modp); thatis, a E p—1 (mod p). Finally,b Ea (mod p)since this would implythata2 E 1 (mod p), and hence thata E i1 (modp). Thus,1 <b <p—1 andb=# a,as required. . Certainly, I and—1 are solutions ofthe given congruence. Moreover, ifa is any solution, thena2 E1 (mod p“)and p“|(a— 1)(a +1). Since (a+l)-(a-1)=2 and p is odd, itis clear the pcannot simultaneously divide botha +1 anda— 1. Therefore, p“|(a +1) or p“|(a— 1). Thus,a E i1 (mod p“),and itfollows that l and—1 are the only solutions ofthe given congruence. Ifp E 1(mod 4), then there exists 4 such that p =4q +1. Leth =k =2q. Then h + k =4q =p -1 and itfollows fromExercise2 that[(2q)!]2 E(—1)2‘1+1 E —1 (mod p). Therefore, x =(2 q)! isa solution,as desired. Suppose thatthere are only ﬁ nitelymany primes ofthe form 4k +1, say p1, p2,. . . , p,, and consider the number n=4pip§° '- p3+l. Clearly, n >p,- foreach1'. Since n is ofthe form 4k +1 andexceeds all primes of this form, itmustbe composite. Therefore, bythe Fundamental Theorem of Arithmetic,11 musthave primedivisors. By the result ofExercise14, all prime divisors ofIt mustbe ofthe form 4k +1. Thus, piln forsome i. Butthis implies that pil1, and thisis impossible. Exercises 5.5 1. 2. 5. (a) Modulo11 we have, by Theorem5.11,12 E1, 22 E4,32 E9,42 E5, and 52 E3. (a) Modulo7 we have 3x2 +6x +5 E0, 15x2 + 30x+25 E0, x2 +2x + 4E0, (x+ 1)2E4,x+1 Ei2,xE—3or 1,xE4or1. Thesame result would have followed fromthe quadratic formula. (b) Using the quadratic formula,we have modulo7, xE 2‘1(-6 iV36 -8) E 4(—6 iJ25) E4(—6 1‘ J3), Butas noted inthe text, thesquares modulo7 are 1, 4, and 2. Thus,5 is nota square and the congruenceis notsolvable. (a) Modulo13 we have 3x2 +2x E0, x(3x +2) E0, xE0 or 3x +2 E0 since 13 is a prime. Thus, the solutionsare 0 and8 modulo13. Answers to Selected Exercises 275 Exercises 5. 6 1. 5. 10. 13. (a) 3 is a quadratic nonresidue modulo379. (c) 60 is a quadratic nonresidue modulo379. 11 p %) ifp a3 (mod4). ( ﬁ )ifp 21(mod4), (2)= (1L)(_1)(p—1)/2 = ( (1&1) = (L),where ris theleast residue ofpmodulo11. Thus, 11 i=1 ifp ll—1 ifP It follows that , 4, 5, or9 (mod11), 7, 8, or10 (mod11). 1,3 2,63 , 5, or9 (mod11), 8, or10 (mod11), 8 5uNun)!—wage:uANN-h 1 ifp E1 (mod4) and E___ 1 ifp E3 (mod4) and p —1 ipl(mod4)and p —1 ip3(mod4)and pEl,’Q‘6IIIIIIIII\\a, , or10 (mod11), , ,or9(mod11).vu Using the Chinese remainder theorem, itfollows that 11 =1 ipil,i5,i7,i9,il9(mod44), p —1 ipi3,i13,i15,il7,i21(mod44). . Ifp orq is congruent to1 modulo4, thenatleast one of( p— l)/2and(q— 1)/2 is even and(17;) =(1%), by Theorem5.15. Step one ofthe inductionis done inExercise9. Suppose thatx2 Ea (mod p\") has two incongruent solutions,say b andc, modulo12\", where k 21 is ﬁ xed. Then, by Theorem 5.7, oneset ofsolutions ofx2— a E0 (mod 17\"“)is ofthe form b +yop\", whereyo is a solution of b2.— pk“+2by a0 (mod p) (*) and b is a solution ofx2 Ea (modpk). Since (a, p) =1, and pis odd, itfollows that (2b, p) =1. Thus, (*)has one solutionyo andb +yop\"isa solution of x2 E a (mod pk“).Similarly,the solutionc ofx2 Ea (mod1)\") gives rise toa solutionc +zopk. Moreover,these are incongruent modulo p\"+l(orelse b and0 wouldbe congruent modulo17\"). Sincethese are the onlysolutions modulopk+ ‘, the inductionis complete. Since pis odd and p ia, (p, 2a) =1. Therefore, the solution ofax2 +bx +c E 276 Answers toSelected Exercises 0 (mod p) is equivalent tothe solution of4ax2 +4abx +4ac E0 (modp), which can be written inthe form (2ax +b)2 E(b2-— 4ac) (modp). IfI)2 -4ac is a quadratic residue modulop, there is an rsuch thatr2 Eb2— 4ac (modp). But then (2ax +b)2 Er2 (mod p) and 2ax +b E ir(modp), whichyields two solutions to the congruence. Ifb2— 4acisa quadraticnonresidue, nosuch r exists and the congruencehas no solutions. Ifb2— 4ac =0, (2ax +b)2 E 0 (mod p), and this implies 2ax +b E0 (modp), whichyieldsa single solution since p1 2a. Exercises 5. 7 l. 12. 19. 24. (a) Modulo17, 2 E2, 22E4,23 E8, 24E16 E -l,25 E—2,26 E—4, 27 E —8,28 E— 16 E1. Therefore,2 has order8 modulo17. Note that ¢(17) =8 and818. . Modulo17 we have the following:3 E3,32 E9,33 E27 E10,34 E30 E13, 35E39E5,36E15, 37E45E11, 3‘E33El6E—1,39E—3E14, 31°E —9E8, 3“E—10E7,3‘2E—13E4, 3‘3E12, 3‘4E2,315E6, 3“E1. Therefore,3 has order16. Thus, the table ofindicesis n12345678910111213l41516 ind3n 0 15 ll10 2 3 713 4 9 68 . Herep =7, m =3, andd=(p— 1, 3) =(6,3) =3. Thus, by Theorem5.28 the cubic residues areq3 and q2'3, where q is a primitive root modulo7 since (p -l)/d =6/3 =2. A quickcheck ofsuccessive powers (orthe table ofindices at the back ofthe book)reveals that3 isa primitiveroot modulo7. Thus, the cubic residues are33 E6 and32‘3 E1 modulo7. Aneasier solutionis simply to check the cubes ofthe numbers inreduced residue system modulo7. Wehave 13E1, 23E1, 33E6,—13E—1 E6,—23E—l E6,and —33E—6E1. Thus,1 and6 are the cubicresidues. . (a) Herep=31, m =9, d=(p-1,m) =(30, 9)=3. Thus,we needto know if330/3 = 3‘°E1 (mod31). However,3‘0 E25(mod31),so3 is nota ninth-powerresidue modulo31. x7 E12 (mod29), 7 ind xE ind12 E7 (mod28), ind xE1 (mod4), indx E1, 5, 9,13,17,21, 25 (mod28), XE2, 3,19,14,21, 17,11 (mod29). By Theorem 5.24, there exists a primitive rootq modulop. Therefore, by Corollary 5.22, the numbersq,q2, q3,. . . , q”'lforma reduced residue system modulo p. Butany primitive rootmustbe relatively prime to pandso mustbe congruent modulo p toone ofthese powers ofq. ButbyExercise14, precisely qb( p-— 1) ofthese numbers belong to p—1 modulop, thatis, are primitiveroots modulo p. Ifq is a primitive root modulop2, thenqhas orderqS(p2) =p( p— 1) >p— 1. Therefore, q?“1 E1 (modp2). Conversely,suppose that q!\"1 E1 (modp2). Answers to Selected Exercises 277 Since q is a primitive root modulo p, q’\"1 E1 (mod p)and(q, p) =1. There- fore, by the Euler—Fermat theorem, ql’(l’“’E1 (mod122), since (Mp2) = p( p— 1). Suppose thatq has ordere modulo122. Thene|p( p— l)and there exists k>0 such that ek= p(p— 1). Since q“ E1 (modp2), itfollows that q\" E1 (mod p) and hence that (p— l)|e.Therefore, thereexists rsuch that r(p— l) =e. Combining this with ek=p(p—1), we obtain rk(p— 1)= p(p— 1). Thus, rk =pand itfollows that k=1 or k=p. Ifk=p,thene = p— 1, and this violates the condition that q!\"1 E1 (mod[22). Therefore, k =1, e = p( p— 1) =(15022), andq isa primitive root modulo122. Exercises 6.1 l. ZIOLM WILYU HXMYP YHSYU LMUAI 2. PREPARE TO MEET THY DOOM 5. Assume thatQ is the cipherreplacement forE and that Lis the replacement forT. Then we mustsolve the system16 E 4r +3 (mod26),11 E19r +s (mod26). Subtracting, we obtain5 E— 15r (mod26), whichgives rE—9 (mod26) and s E 0 (mod 26). Exercises 6.2 1. (a) 2531, the ﬁ rst primegreater than2525 2. (a) 23 5. (a) k=2419 (b) d=2418 6. (a) 1365 since131449 E1365 (mod2531) Exercises 6.3 l.1265 2583 3. (a)r-<i>(r)+1 =pq-(p- 1)(q-1)+1=pq-pq+p+q-1+ 1= p +q 5. If(P, r) =d >1 and P E0, then pldorqld. Withoutloss ingeneralityweassume that pld. Then pIPand plr. But C EP5 (modr),so plC.Thus, (C, r) >1 and it follows that (C, r) =p. Thus, the cryptanalystcan ﬁ nd pusing the Euclidean algorithm. Exercises7.1 2. Ifn =p2, the argument ofpage 172 shows thata Eb E0 (modp). Hence it follows thata =0 andb = iporb =0 and a = ip,as claimed. 4. Since 25 =9 +16, itfollows that 1=%+%=(%)2+(%)2- Indeed, this wouldbe possible forany Pythogorean triplesincez2 =x2 +y2 implies that1 =(x/z)2 +(y/z)2. Ofcourse, ifz is compositeas forthe triple (7, 24, 25), then252 =242 +72 implies that25 =(24/5)2 +(7/5)2,so that num- bers other than1 can also be represented inthisway. 278 Answers toSelectedExercises 7. Suppose that 22\"\"l =a2 +b2. Ifone ofa andb is even and the otherodd, then a2 +b2 is odd and thisis a clear contradiction. Ifbotha andb are odd, then a2 Eb2 E1 (mod4) anda2 +b2“=— 2 (mod4). But 2”“1 =4- 22\"”3 E 0 (mod 4) ifk 22, and thisis againa contradiction. Ifk =1, then22\"~1 =2 = 1 +1 =22\"—2 + 2””,as required. Finally, ifa andb are botheven, neithercan be 0 since 22\"“1 is nota square. Therefore,wefa_ctor outthe highest power of2_ from both a and b and writea =2’Eandb =2’b with r >0,s >0 and Eandb odd. Ifr <s, then 22k—l—2r =52 +22(s—r)b2, which is impossible since the expression on the left-handside ofthe equationis even and the one on the rightodd. Therefore, r 2s. Ina similarway, we show thats 2 rand itfollows that r =3. Butthen 22(k—r)—l =52 +52’ which,as seen above, is impossibleunless k— r =1 and E =b =1. Butthen r = k—1 and a =b =2\"’1and22k‘1 =22\"‘2 +22’\"2is the onlyrepresentation of22\"\"1 as the sum oftwosquares. Exercises 7.2 3. Choose products suchas (4+1+1+1)(1+4+9+l6), (1+4+1+1)- (1+4+9+16), (l+1+4+1)(1+4+9+16),and (l+1+l+4)- (1 +4 +9 +16). Using (7.13),these generate 210=112+72+62+22=122+82+12+12 =132+42+42+32=142+32+22+12. 41k5 (mod8), then 3kE15 (mod8) and 3k=15 +8q=7 +8(q+ l)for some integerq. But then 3k=x2+y2 +22,and xyzaé0 is impossible by Theorem 7.4. Since thesquare ofan integeris congruent to0,1, or4 modulo8, the possibilitiesareas follows. k (mod 8) 3k (mod8) x2+y2+z2(mod8) x’+y2+z2(mod4) 0 0 0+0+00r4+4+0 0+0+0 l 3 l+l+l1+1+1 2 6 4+l+l 0+1+l 3 l l+0+00r1+4+4 l+0+0 4 4 4+0+00r4+4+4 0+0+0 6 2 l+l+0 l+l+0 7 5 4+l+0 0+l+0 This implies the desired result. Answers to Selected Exercises 279 Exercises 7.3 4. By Theorem 6.5, every positive integer m canbe representedas the sum offour squares, say m=a2+b2+c2+d2. Therefore, 6m =6a2 +6b2 +602 +6d2 =af+a§+- - - +a18, by Exercise3. Nowevery positive integern can be written inthe formn =6 m +r with0 S rS5. Therefore, 11 =6m + r =af+a§+- - - +a§3 since each r inthe indicatedrange can be represented byat mostﬁ veIs. 6. Assume thatevery integer ofthe form31- 16'”is the sum of15 fourthpowers,say 31° 16m=xf+x§+- - - +x‘,‘5. Since each fourth poweris congruent to0 or1 modulo l6and31. 16'\" E 0 (mod 16), itfollows thatx? E0 (mod16) andhencex,- E0 (mod2) foralli. Butthen .m—1=n‘ e“...m43116 (2)+(2)+ +(2) and 31- 16\"\"lis also representableas the sum of15 fourthpowers. Continuing in this way, we eventually conclude that31- 160 =31 canbeso represented. But this is clearly impossiblesince31 =24 +15- 14 requires atleast16 fourthpowers for each m, and since m can be taken arbitrarilylarge, itfollows thatc6(4) 216. Exercises 8.1 1. h(mn) =(mn ’ = m’n’ =h(m)h(n) 3. Since mln, there exists an integerq such thatqm =n. Thus, f(n) = f(qm) = f(q)f(m) andm)=f(q) =f(n)/f(M)since q = MM 6. Since ml, m2, and m3 are pairwise relatively prime, itfollows fromTheorem2.12, that(m1 m2, m3) =1. Butthen f(mimzms) =f((mlm2)m3) =f(m1m2)f(m3) =f(m1)f(m2)f(m3), as required. 280 Answers toSelectedExercises Exercises 8.2 1- (a) 22f(d)g(b)= 2[f(d)g(l)+f(d)g(3)+f(d)g(9)] 1% b|9 «\"6 =f(1)g(l)+f(1)g(3) +f(l)g(9) +f(2)g(1) +f(2)g(3) +f(2)g(9) +f(3)8(1) +f(3)g(3) +f(3)g(9) +f(6)g(1) +f(6)g(3) +f(6)g(9) = [f(l)+f(2) +f(3)+f(6)][g(1) + £0) +g(9)] = E ﬂ d)' 25'0?) d|6 m9 5. Let (m, n) =1. Inthe solution toExercise8 ofSection8.1 we showed that d1 mn, d odd, ifand only ifd =d1 (1;, where dllm,dzln,((1,,d2) = l,and d,andd2 are both odd. Thus, 2d = 2 2dldz dlmn dllmdzlm dodd dlodddzodd since each term inthe left-hand sum equals one and onlyone term inthe right- hand sum. But a*(mn)= 2d 21:: and 0*(m)a*(n)= 2 dr 2d2= 2 2dldz, dllm dz\"! dllmdzl’l dlwdzodd 41mdzodd by (8.6). 8. This problem is mosteasily solved using Corollary8.5. However,as onpage 56, if f n = 2“- Hp9“, i=1 where thep,- are distinct odd primes and a >0, then r ai+l _l a’(n)=(l+2) uh. i=11 Ofcourse, ifa =0, then a'(n) =0(n). Ineithercase, itfollowsas inSection8.1 that a’(n)is multiplicative. Answers to Selected Exercises 281 Exercises 8.3 1. Since fis completely multiplicative, f(n) =f(Hp2») = ﬁﬂ pm= [1 ”(PM i=1 4'gd—2=,§(—n/d)zl =$2 —i22=d2”—;‘\"’—ndlnn dln 6. Since Iis multiplicative,so is1:2 . Since 3+1, s+ls+2 s+212(p3)= 21(d)=21=—-—-—-—( ’2‘ )=(2 ) dlpl i=1 it follows that 901) = HL; (’1‘;- 2). 9. Since1' is multiplicative,so is1'3 andhenceso is F(n).Therefore, F(n) = Hi-1F(p'-'l). Now F(p’)= 213(d) dlp’ =13+23+.~ . +(s+1)3 __ (s+l)(s+2)2__ 3+22 _ —2—_2 Thus, r 2 F(n) = n(71:: 2) =t§(n). i=1 12. Letn = 2“III-=1 p?“ withp,- odd and 01,21 foralli. Ifa.>_1, a’(2°‘) =l +2. For an odd prime, a’(p°‘)= l +p+p2+- - - +p\"‘=(p\"‘+1 - l)/(p—1). Since a’is multiplicative, itfollows that r pai+l_11 (1+2)Hl—— forazl, 0’01):r ai+tl=_1p H'—=a(n)fora=0. i=1 p,-—'1 282 Answers toSelected Exercises Exercises 8.5 l. 10. Since Md)is multiplicative,so is |,u(d)| andhence also s(n) = 2m|,u(d)|. Thus, 3(1)“) = 2Md)! dlp“ =1+1=2. Therefore, by Theorem 8.2, s(n) =Hf=1 s(p?\") =H£=1 2 =2’. . As in Exercise 2, gis multiplicative.Since g(p“) = 2u(d)0(d) =u(1)0(1) +”(p)a(p) =1—(p +1) = -p, dlp“ it follows that g(n) =(— 1)’H5=117,-. . By the Mobius inversion formula, g(n)-= 2M)Z—:= n2 2ET“). dln dln Also, since f(n) =n2 is multiplicative,g(n)is multiplicativeby Theorem8.9. Therefore, g(n) = flg(p‘,-\"\") i=1 for n =115., pg“. Now d 1 57(1)? ‘)=p?” Ella,-(2—)= I)?” (I—F)=%“\"2(p%—1), dlp?‘ so that gm) = IIp%““2(p% -1)- i-l This can be simpli ﬁ ed further to gm) =¢<n> 1’] psi-1o.- +1). i=1 The principal dif ﬁ culty inthis problemis notational. Fora =H€=1 p? with a,- 21 for alli, we may write t ¢(=a) Hp?l(p.~— 1)=l'[p§-\"'(l ——)=aH(1——) i=1 '1 p, Moreover, ifwe de ﬁ ne 6(0) =0 and 6(n) =1 ifn95 0, we may write I 1 601:) ¢(a)—ai1;II(I-17), i Answers to Selected Exercises 283 15. where a =H§=1 p? witha, 2O foralli. Thisdevice is to allow fortheuse ofzero exponents inthe canonical representation of(1. Nowlet T r r m=Hp£\"\", n=Hp?\", d=Hp:-\"‘, i=1 i=1 i-l withm,- 20,n,- 20, n, +m,=# 0, and diequal tothe smaller ofmiand niforeach 1'. Then, using 6as de ﬁ ned above, we have that d r (1—1)5(mi) r (1—1)5(ni) d¢<m>¢<n> =“”1131p.- ,U. 3.- ¢(d) d]:(1——)Mi) i-l =mm H 1 ami)+6<n.)—a(d1) =¢(mn) i-l 1 ._ _ since 6(mi) +6(n,-)— 6(d,-) = lforeach iand mn =Hi=1p§\"\"+\"\" with m,- +11,21 foreach i. Tosee that6(m,-) +502,-) -6(d,-) =1 foreach i, we note that ifm, >O and n, >0, thend,- >O and 6(m,-) +501,.)— 6(4) =1 +1 —1 =1. On the other hand, ifone ofm, orn,- is zero, the otheris notzero andd,- is zero. Thus, 6(d,) =0, one of6(mi)and6(n,-) is zero and the otheris1. Note that In F(n) =2,1,\" In f(n). Therefore, bythe Mobiusinversion formula, lnf(n)= 2u(d)lnF(d)=21nF”w(d) d|n dln and f(n) =eEJInlnFIKa/d) = HelnFu(d)(n/d) -3F111,(n) dln Exercises 8. 6 1. Let f(n) =n2 and s(n) =HZ=1 (k). Then scam—611(— >61“) and, by Theorem 8.14, 284 Answers toSelectedExercises 2 22k =2u(d)d2- 6—d(d+1)(;+1) k=l dln (k,n)=l 3 _ ﬂ __”-6dzln ﬂ ”(d)d( 2+d+l) =%[2n22”—:1—d )+3n2u(d)+2dll(d)] dln dln dl\" 2 6[2n¢(n) + E(l— 1%)] 1\"! since n 2$31) = W» by Theorem 8.12, W 2Md) =0, dln by Theorem 8.8 since n >1, and 2d ﬂ (d)— = H(1-1).), dln by the result ofExercise5 ofSection8. 4. [a] [a/n] [or] [am 4. 2#(n) 2f(“—/—\")= 2 2MMfW/mn) n-l m=1 n-lm=l [alla/n] 2 2u(n)f(a/k) k-lnlk =[alla/nl —2 f(a/k)2/t(n)f=(a), n|k where the last equality follows from Theorem8.8. Exercises 8. 7 1. In Theorem 8.18, take f(k) =k forallk. Then [m/d] S*(m, n) =21461) 2f(dj) dln j=l [m/d]. = 21101) 2d] dln j=1 wel[%+ll/2’ as required. Answers to Selected Exercises 285 4. In Exercise3, setf(n) =1 forn. Then ¢(kn,n) =s*(kn,n) = 2 i ﬂ=kn 2#21) =k¢(n), dln dln by Corollary8.15. Exercises 9.1 1. (a) 119=35- 3+14, 35 =14- 2+7, l4=7- 2. Therefore, 119/35 = [3,2,2]. 2. (a) [1,2,1,3]=1+—11—=1+;3=+_1‘}f=1_f 2+—— 2+— 1+1 4 3 5. Since r=[ao,a,,a2,. . . ,ak]=ao+ l,wecan readilyshow that a+—— '£2 i=1—ra,+aoal £2 7—00 Now,ifweset —s=[—(ao+1),1,a1—1,a2,. . . ,ak] ={—(ao +1),1,a1-1,€2], we obtain again that 1_1—sa1+aoa1 Z;—. S _do. Thus, itis clear that r=5. Note that al >1 was needed,so thatthesecond fraction was indeeda simple continued fraction. Exercises 9.2 1. (a) Givena common denominator,the convergentsare 1650 2475 2200 2250 2244 1650’ 1650’ 1650’ 1650’1650 and itis clear that they satisfy Theorems9.11 and9.12. (b) —1170 —975 -1040—1014 —1020 390 ’ 390 ’ 390 ’ 390’ 390' 3. Forn =0, we have that = = ﬂ =£o_ [a0] a01 1,—1- 286 Answers toSelectedExercises Thus, the result is true forn =0. Assume that PI. =[ah,ah_1,. . . ,al,ao], Ph—1 where h is ﬁ xed and0 Sh <n. Then [ah+l9 a!”ah—la.~ . , a1 “0] =ah+1+ —‘—‘— ’ [ah,a,,_,,.. . ,al,ao] 1 =ah+l + ph/ph—l =ah+1ph +Ph—I = ﬂ y; , Ph Ph by Theorem 9.5. Therefore, the resultis trueas claimed by limitedmathematical induction. Exercises 9.3 l. By(917),q,>zfor1>0 Nowq2= ala2+1>2=F3. Also, q3= a3q2+q12 qz+ql_>_2+l=3=F4. Assume that a,>1+1 for2<1<kw1thk3,k ﬁ xed. Then 4k+1= ak+lqk +qk—l 2qk +(Ik—r —Fk+l + Fk=Fk+2 and the result follows by mathematical induction. 3. ao=w21=1,=c, J’=1\\/2+1, soa,=[J”+1]=2. 1 1 _ __________.=_____=,SO a =a =2 and, indeed, itfollows€2—f+1—2 J—_1£l2_—[€2:!1 that a,- -2 for all i 21. Therefore, J2 =[1, 2]. 5. (a) Let . . 1 c=r21=[2,2]=2+—. 6 Then 62-26—1 =0 and :=1:J2. Since 6 >0, itis clear that6 =1 +J2. Answers to Selected Exercises 287 7. (a) We note that _1- {+0 ﬂ _O-§+1and HI0-0|—1 Therefore,3: ~5 forall6. Moreover, if(5 ~It, then =au+b ___ é c,u+d’ ladbcl1. Solving for u interms of6, we have _-d~f+b _ — 65%,|( d)(a) bcI—l, so,u ~6. Finally, if5 ~ gand[4 ~v, then a,u +b a’v +b’ f=cu+dand ﬂ =c’v+d’ with lad -bcl = la’b’- c’d’l =1. Itnow requires onlydiligence toshow that _(aa’ +bc’)v +ab’ +bd’ :_ (a’c + c’d)v +cb’ +dd’ and that |(aa’ + bc’)(cb’ +dd’)— (a’c +c’d)(ab’ +bd’)| =|(ad— bc)(a’d’— b’c’)| =1, so that5 ~v. Thus ~is an equivalence relation. Exercises 9.4 1. (a) ,u=[d]=a+l/[d]=a+l—ll—. Therefore,u2—au—1=0and/t= (a 1Ja2 +4)/2. Since,u is clearly positive,we musttake ,u =(a +Vaz +4)/2. (d) We have thatp_2 =0,1).l =1,andp,- =ap,-_l +p,_2 fori 21. From part(c), q_1 =0 andgo =1. Thus,since both1),, and q”satisfy thesame de ﬁ ning relation withconsecutive starting terms of0 and1, bothsequences are the same except thatq_1 corresponds top_2,qo corresponds top_1, andso on. Thus,1),, = aforalln. 2. (a) This couldbe proved by inductionas inExercise1. However, itis interesting to use Binet’s formulas. Recall that F\" =(01\"— ﬂ ”)/\\/§and L,=a\" +B\", where a =(1 +J5)/2and B=(1—J3)/2. Now,a2 =a +1,so that (12+1 =a+2and a+1/a=1+2/a=1—2 ﬁsince a ﬂ =—1.Simi- larly,,3 +1/)? = l -2a. Therefore, 288 Answers toSelectedExercises Ln +Ln+2 =CI» +ﬁ n +an+2 +ﬂ n+2 =an+l ($4. a)+Bn+1 (% + ﬂ ) =a\"+‘(1— 2,?) +pn+1(1— 20:) = an+l‘/§_Bn+1J'5‘ = an+l_ ﬁ n+l) 5(J3 =5Fn+1~ (e) Withoutloss ingeneralitywe may take m 2n. Then Fa+Fa=(—“m ”3“)~ (a\" +3\") + (0” ﬂ ”)- (aw/3'\") J3 J3 =am+n _ﬂ m+nn. am—n _ ﬂ m-n ‘5 +(Oil?) —\\/3 am+n _Bm+n _n .C\\‘m—w _ ﬂ m—n + J3 (01,3) —J§ =2‘Fm+n° 5. (a) Let abe a quadratic surd and de ﬁ ne the real number)3 by ﬂ =r +1 /a.Since a is a quadratic surd there exist integersa,b,c, and d with dsquare-free such that a=a+b\\/Z'and a,=a—b~/(_: d d’ so that a’is the conjugate of0:. Now ﬁ =r+l=r+d =r+da _dbx/Z\" a (1+saz-bzcaz—bzc so that,3 is a quadraticsurd. Moreover, ﬂ '=(r+i)=r+dd + dE —r+i a2— bzc a2— bzc— 05’ since 1 _ d _da dbx/E E—a—bx/E_a2—bzc az—bzc' Now ifthequadratic surdf=[(10, a1, a2,. . . ]>1,then1/€,-+,={i—a,- and itfollows fromabove that 1/5“= if— ai. Answers to Selected Exercises 289 Exercises 9.5 l.(a) a, l1 1 l1 5 p.- 01 1 2 3 5 8,&=—, &=§-. 4,. 1 o1 1 23 5 ‘14 3‘15 5 3. Since 5 lies between pn/qn and1),,+,/c1,,+1 and closer tothe latter, itfollows that 1 1 ._ > qg— qnqn+l pnqn+l— qnpn+l qnqn+l & _ M qn qn+l pn >5 4n 22 _ h; qn qn+l =1 > ; 2qnqn+l— 2q:+l’ l 2 as claimed. Index A Abundant number, 86 Adleman, L.,167 Approximation ofirrationals,230 B Beeger, N.G.W.H.,106 Big-O, 34 Binary notation, 29 Binary relation,88 Binet, J.P.M., l9 Binet’s formulas,19, 20 Bit, 35 Brun, V.,74 Brun’s Theorem, 74 Buxton, M.,84 C Caesar, 1., 158, 159 Caesar cipher,159 Canonical representation,55 Carmichael numbers,106 Carmichael, R. D.,106 Chinese remainder theorem,118 Ciphenext,158 Cohen, 0.,84 Common divisor,41 Common multiple,49 Completely multiplicative functions,186 Composite,17 Computational complexity,35 Conditional congruences: linear, 112 polynomial,124 quadratic,133 Congruence ofintegers,88 Convergent ofcontinued fraction,215 Crelle, A. L.,156 290 Cryptanalysis,158 Cryptography,158 D De ﬁ cientnumbers, 86 Diophantine equations,115 Diophantus ofAlexandria,115 Dirichlet,G. L.,73,177 Dirichlet'sTheorem,73 Divides, l7 Divides exactly,64 Divisibilitycriteria,96 Division algorithm,24 Divisor,17 DO LOOP,17 E Egyptian multiplication,33 Elmore, S.,85 Equivalence: class, 89 relation,88 Eratosthenes, 70 Euclid,72,83 Euclidean algorithm,42 Euler—Fermat Theorem,101 Euler, L.,8, 99,136 Euler’s criterion,136 Euler0—function, 197 Exponentiation ciphers,163 F Fermat, P.,21, 82,85 Fermat’s method ofdescent, 82 Format numbers,82 Fermat’s Theorem,101, 102 Fibonacci,9 Fibonacci numbers, 9 Field,110 Fundamental theorem ofarithmetic,55 Index G Garlinski, J.,163 Gauss, C. F.,1, 87, 132, 136, 139 Gauss’s lemma,138 Greatest common divisor,41 Greatest integer notation, 36, 62 Group, 109 H Hagis, P., 84 Hardy, G. H.,183 Hexadecimal notation,29 Hilbert, D.,181 I Index ofa number,151 Induction, mathematical ﬁ rst form,13 proof by,14 second form,13 third form,18 In ﬁ nite simple continued fraction, 22] Inversion formulas: Mobius’s formula,195 Other formulas,201 J Jacobi, K.,146, 175, 180 Jacobi symbol,146 K Kahn, D.,161, 163 Key, 158 Knuth, D.,2 Kulik,J. P., 72 L Lagrange,J. L.,129, 130, 177 Lagrange’s Theorem,129 Lame, G,, 46 Least common multiple,49 Least residue, 88 Legendre, A.,134, 136 Lehmer, D. H.,81 Lehmer, D. N.,72 Leonardo ofPisa, 9,172 Lewin, R.,163 Linear combination, 44 Lucas, E.,9,81 Lucas—Lehmer test, 82, 98 Lucas numbers,9 291 M Mersenne, M.,81 Mersenne: numbers,81 primes,81 Miller’stest, 106 Mobius, A. F.,194 Mobius function,195 Mobius inversion formula, [95 mth powerresidue,148 Multiple, l7 Multiplicationnotation, 4 Multiplicative function,186 Multiplyperfect numbers,85 N Nickel, L.,82 Noll, C.,82 Norm,54 Number theoretic function,185 completely multiplicative,186 multiplicative,185 0 Octal notation,28 Order ofn modulo r,148 P Partial quotients,211 Pairwise relatively prime,45 Perfect numbers,83 Plaintext,158 Poincare, H.,200 Polya, G.,9 Positional notation,26 Prime,17 twin,73 Prime number theorem,78 Primitive root,150 Proper divisor,17 Pseudoprime,105 strong,106 Public key encryption,166 Pythagorean triples,59 Q Quadratic reciprocity law,139 Quadratic: residue,134 nonresidue,134 292 R Ramanujan, S.,183 Re ﬂ exive property, 89 Relatively prime, 45, 50 Residue, 88 Residue system: complete, 90 least, 90 reduced, 99 Rivest, R. L.,167 Russian peasant method forpowers,93 Russian peasant multiplication,33 S Sieve ofEratosthenes, 70 Simple continued fractions: convergents of,209 partial quotients of,211 periodic,225 Shamir, A.,167 Steinhaus, H.,21 Index Substitution cipher, l60 Summation notation,2 Symmetric property,89 T Tchebychef,P. L.,72 Tchebychef’s inequality,78 Transitive property,89 Triangularnumbers,85 Twinprimes,73 W Waring, E.,130,181 Waring‘s problem, 18l Well-ordering principle,13 proof by,21 White, W. F.,1 Wilson,1.,130 Wilson’sTheorem,131 Winterbotham,F. W.,I63","libVersion":"0.3.1","langs":""}
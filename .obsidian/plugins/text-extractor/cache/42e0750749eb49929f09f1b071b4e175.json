{"path":"iCloudDrive/bks/OlympiadQPs/USAMO PYQ/2015.pdf","text":"USAMO 2015 Solution Notes Evan Chen《陳誼廷》 10 August 2023 This is a compilation of solutions for the 2015 USAMO. Some of the solutions are my own work, but many are from the official solutions provided by the organizers (for which they hold any copyrights), and others were found by users on the Art of Problem Solving forums. These notes will tend to be a bit more advanced and terse than the “official” solutions from the organizers. In particular, if a theorem or technique is not known to beginners but is still considered “standard”, then I often prefer to use this theory anyways, rather than try to work around or conceal it. For example, in geometry problems I typically use directed angles without further comment, rather than awkwardly work around configuration issues. Similarly, sentences like “let R denote the set of real numbers” are typically omitted entirely. Corrections and comments are welcome! Contents 0 Problems 2 1 Solutions to Day 1 3 1.1 USAMO 2015/1, proposed by Titu Andreescu . . . . . . . . . . . . . . . . 3 1.2 USAMO 2015/2, proposed by Zuming Feng, Jacek Fabrykowski . . . . . . 4 1.3 USAMO 2015/3, proposed by Gabriel Carroll . . . . . . . . . . . . . . . . 7 2 Solutions to Day 2 9 2.1 USAMO 2015/4, proposed by Maria Monks Gillespie . . . . . . . . . . . . 9 2.2 USAMO 2015/5, proposed by Mohsen Jamaali . . . . . . . . . . . . . . . 11 2.3 USAMO 2015/6, proposed by Iurie Boreico . . . . . . . . . . . . . . . . . 12 1 USAMO 2015 Solution Notes web.evanchen.cc, updated 10 August 2023 §0 Problems 1. Solve in integers the equation x2 + xy + y2 = ( x + y 3 + 1)3 . 2. Quadrilateral AP BQ is inscribed in circle ω with ∠P = ∠Q = 90◦ and AP = AQ < BP . Let X be a variable point on segment P Q. Line AX meets ω again at S (other than A). Point T lies on arc AQB of ω such that XT is perpendicular to AX. Let M denote the midpoint of chord ST . As X varies on segment P Q, show that M moves along a circle. 3. Let S = {1, 2, . . . , n}, where n ≥ 1. Each of the 2n subsets of S is to be colored red or blue. (The subset itself is assigned a color and not its individual elements.) For any set T ⊆ S, we then write f (T ) for the number of subsets of T that are blue. Determine the number of colorings that satisfy the following condition: for any subsets T1 and T2 of S, f (T1)f (T2) = f (T1 ∪ T2)f (T1 ∩ T2). 4. Steve is piling m ≥ 1 indistinguishable stones on the squares of an n × n grid. Each square can have an arbitrarily high pile of stones. After he finished piling his stones in some manner, he can then perform stone moves, defined as follows. Consider any four grid squares, which are corners of a rectangle, i.e. in positions (i, k), (i, l), (j, k), (j, l) for some 1 ≤ i, j, k, l ≤ n, such that i < j and k < l. A stone move consists of either removing one stone from each of (i, k) and (j, l) and moving them to (i, l) and (j, k) respectively, or removing one stone from each of (i, l) and (j, k) and moving them to (i, k) and (j, l) respectively. Two ways of piling the stones are equivalent if they can be obtained from one another by a sequence of stone moves. How many different non-equivalent ways can Steve pile the stones on the grid? 5. Let a, b, c, d, e be distinct positive integers such that a4 + b4 = c4 + d4 = e5. Show that ac + bd is a composite number. 6. Consider 0 < λ < 1, and let A be a multiset of positive integers. Let An = {a ∈ A : a ≤ n}. Assume that for every n ∈ N, the multiset An contains at most nλ numbers. Show that there are infinitely many n ∈ N for which the sum of the elements in An is at most n(n+1) 2 λ. 2 USAMO 2015 Solution Notes web.evanchen.cc, updated 10 August 2023 §1 Solutions to Day 1 §1.1 USAMO 2015/1, proposed by Titu Andreescu Available online at https://aops.com/community/p4769940. Problem statement Solve in integers the equation x 2 + xy + y2 = ( x + y 3 + 1)3 . We do the trick of setting a = x + y and b = x − y. This rewrites the equation as 1 4 ((a + b) 2 + (a + b)(a − b) + (a − b) 2) = ( a 3 + 1)3 where a, b ∈ Z have the same parity. This becomes 3a 2 + b 2 = 4 ( a 3 + 1)3 which is enough to imply 3 | a, so let a = 3c. Miraculously, this becomes b 2 = (c − 2) 2(4c + 1). So a solution must have 4c + 1 = m2, with m odd. This gives x = 1 8 (3(m2 − 1) ± (m 3 − 9m) ) and y = 1 8 (3(m 2 − 1) ∓ (m 3 − 9m)) . For mod 8 reasons, this always generates a valid integer solution, so this is the complete curve of solutions. Actually, putting m = 2n + 1 gives the much nicer curve x = n3 + 3n2 − 1 and y = −n3 + 3n + 1 and permutations. For n = 0, 1, 2, 3 this gives the first few solutions are (−1, 1), (3, 3), (19, −1), (53, −17), (and permutations). 3 USAMO 2015 Solution Notes web.evanchen.cc, updated 10 August 2023 §1.2 USAMO 2015/2, proposed by Zuming Feng, Jacek Fabrykowski Available online at https://aops.com/community/p4769957. Problem statement Quadrilateral AP BQ is inscribed in circle ω with ∠P = ∠Q = 90◦ and AP = AQ < BP . Let X be a variable point on segment P Q. Line AX meets ω again at S (other than A). Point T lies on arc AQB of ω such that XT is perpendicular to AX. Let M denote the midpoint of chord ST . As X varies on segment P Q, show that M moves along a circle. We present three solutions, one by complex numbers, two more synthetic. (A fourth solution using median formulas is also possible.) Most solutions will prove that the center of the fixed circle is the midpoint of AO (with O the center of ω); this can be recovered empirically by letting • X approach P (giving the midpoint of BP ) • X approach Q (giving the point Q), and • X at the midpoint of P Q (giving the midpoint of BQ) which determines the circle; this circle then passes through P by symmetry and we can find the center by taking the intersection of two perpendicular bisectors (which two?). ¶ Complex solution (Evan Chen) Toss on the complex unit circle with a = −1, b = 1, z = − 1 2 . Let s and t be on the unit circle. We claim Z is the center. It follows from standard formulas that x = 1 2 (s + t − 1 + s/t) thus 4 Re x + 2 = s + t + 1 s + 1 t + s t + t s which depends only on P and Q, and not on X. Thus 4 \f \f \f \fz − s + t 2 \f \f \f \f 2 = |s + t + 1| 2 = 3 + (4 Re x + 2) does not depend on X, done. ¶ Homothety solution (Alex Whatley) Let G, N , O denote the centroid, nine-point center, and circumcenter of triangle AST , respectively. Let Y denote the midpoint of AS. Then the three points X, Y , M lie on the nine-point circle of triangle AST , which is centered at N and has radius 1 2 AO. 4 USAMO 2015 Solution Notes web.evanchen.cc, updated 10 August 2023 A B S T O XP Q M G N Y Let R denote the radius of ω. Note that the nine-point circle of △AST has radius equal to 1 2 R, and hence is independent of S and T . Then the power of A with respect to the nine-point circle equals AN 2 − ( 1 2 R)2 = AX · AY = 1 2 AX · AS = 1 2 AQ 2 and hence AN 2 = ( 1 2 R)2 + 1 2 AQ 2 which does not depend on the choice of X. So N moves along a circle centered at A. Since the points O, G, N are collinear on the Euler line of △AST with GO = 2 3 N O it follows by homothety that G moves along a circle as well, whose center is situated one-third of the way from A to O. Finally, since A, G, M are collinear with AM = 3 2 AG it follows that M moves along a circle centered at the midpoint of AO. ¶ Power of a point solution (Zuming Feng, official solution) We complete the picture by letting △KY X be the orthic triangle of △AST ; in that case line XY meets the ω again at P and Q. 5 USAMO 2015 Solution Notes web.evanchen.cc, updated 10 August 2023 A B S T O X M Y K P Q V The main claim is: Claim — Quadrilateral P QKM is cyclic. Proof. To see this, we use power of a point: let V = QXY P ∩ SKM T . One approach is that since (V K; ST ) = −1 we have V Q · V P = V S · V T = V K · V M . A longer approach is more elementary: V Q · V P = V S · V T = V X · V Y = V K · V M using the nine-point circle, and the circle with diameter ST . But the circumcenter of P QKM , is the midpoint of AO, since it lies on the perpendicular bisectors of KM and P Q. So it is fixed, the end. 6 USAMO 2015 Solution Notes web.evanchen.cc, updated 10 August 2023 §1.3 USAMO 2015/3, proposed by Gabriel Carroll Available online at https://aops.com/community/p4769949. Problem statement Let S = {1, 2, . . . , n}, where n ≥ 1. Each of the 2n subsets of S is to be colored red or blue. (The subset itself is assigned a color and not its individual elements.) For any set T ⊆ S, we then write f (T ) for the number of subsets of T that are blue. Determine the number of colorings that satisfy the following condition: for any subsets T1 and T2 of S, f (T1)f (T2) = f (T1 ∪ T2)f (T1 ∩ T2). For an n-coloring C (by which we mean a coloring of the subsets of {1, . . . , n}), define the support of C as supp(C) = {T | f (T ) ̸= 0} . Call a coloring nontrivial if supp(C) ̸= ∅ (equivalently, the coloring is not all red). In that case, notice that • the support is closed under unions and intersections: since if f (T1)f (T2) ̸= 0 then necessarily both f (T1 ∩ T2) and f (T1 ∪ T2) are nonzero; and • the support is obviously upwards closed. Thus, the support must take the form supp(C) = [X, S] def = {T | X ⊆ T ⊆ S} for some set X (for example by letting X be the minimal (by size) element of the support). Say C has full support if X = ∅ (equivalently, ∅ is blue). Lemma For a given n and B ⊆ {1, . . . , n}, there is exactly one n-coloring with full support in which the singletons colored blue are exactly those in B. Therefore there are exactly 2n n-colorings with full support. Proof. To see there is at least one coloring, color only the subsets of B blue. In that case f (T ) = 2|T ∩B| which satisfies the condition by Inclusion-Exclusion. To see this extension is unique, note that f ({b}) is determined for each b and we can then determine f (T ) inductively on |T |; hence there is at most one way to complete a coloring of the singletons, which completes the proof. For a general nontrivial n-coloring C, note that if supp(C) = [X, S], then we can think of it as an (n − |X|)-coloring with full support. For |X| = k, there are (n k) possible choices of X ⊆ S. Adding back in the trivial coloring, the final answer is 1 + n∑ k=0 ( n k ) 2k = 1 + 3n . 7 USAMO 2015 Solution Notes web.evanchen.cc, updated 10 August 2023 Remark. To be more explicit, the possible nontrivial colorings are exactly described by specifying two sets X and Y with X ⊆ Y , and coloring blue only the sets T with X ⊆ T ⊆ Y . In particular, one deduces that in a working coloring, f (T ) is always either zero or a power of two. If one manages to notice this while working on the problem, it is quite helpful for motivating the solution, as it leads one to suspect that the working colorings have good structure. 8 USAMO 2015 Solution Notes web.evanchen.cc, updated 10 August 2023 §2 Solutions to Day 2 §2.1 USAMO 2015/4, proposed by Maria Monks Gillespie Available online at https://aops.com/community/p4774079. Problem statement Steve is piling m ≥ 1 indistinguishable stones on the squares of an n × n grid. Each square can have an arbitrarily high pile of stones. After he finished piling his stones in some manner, he can then perform stone moves, defined as follows. Consider any four grid squares, which are corners of a rectangle, i.e. in positions (i, k), (i, l), (j, k), (j, l) for some 1 ≤ i, j, k, l ≤ n, such that i < j and k < l. A stone move consists of either removing one stone from each of (i, k) and (j, l) and moving them to (i, l) and (j, k) respectively, or removing one stone from each of (i, l) and (j, k) and moving them to (i, k) and (j, l) respectively. Two ways of piling the stones are equivalent if they can be obtained from one another by a sequence of stone moves. How many different non-equivalent ways can Steve pile the stones on the grid? The answer is (m+n−1 n−1 )2. The main observation is that the ordered sequence of column counts (i.e. the number of stones in the first, second, etc. column) is invariant under stone moves, as does the analogous sequence of row counts. ¶ Definitions Call these numbers (c1, c2, . . . , cn) and (r1, r2, . . . , rn) respectively, with∑ ci = ∑ ri = m. We say that the sequence (c1, . . . , cn, r1, . . . , rn) is the signature of the configuration. These are the 2m blue and red numbers shown in the example below (in this example we have m = 8 and n = 3). c1 = 5 c2 = 2 c3 = 1 r1 = 3 r2 = 3 r3 = 2 Signature: (5, 2, 1; 3, 3, 2) By stars-and-bars, the number of possible values (c1, . . . , cn) is (m+n−1 n−1 ). The same is true for (r1, . . . , rm). So if we’re just counting signatures, the total number of possible signatures is (m+n−1 n−1 )2. ¶ Outline and setup We are far from done. To show that the number of non-equivalent ways is also this number, we need to show that signatures correspond to pilings. In other words, we need to prove: 1. Check that signatures are invariant around moves (trivial; we did this already); 9 USAMO 2015 Solution Notes web.evanchen.cc, updated 10 August 2023 2. Check conversely that two configurations are equivalent if they have the same signatures (the hard part of the problem); and 3. Show that each signature is realized by at least one configuration (not immediate, but pretty easy). Most procedures to the second step are algorithmic in nature, but Ankan Bhattacharya gives the following far cleaner approach. Rather than having a grid of stones, we simply consider the multiset of ordered pairs (x, y) corresponding to the stones. Then: • a stone move corresponds to switching two y-coordinates in two different pairs. • we redefine the signature to be the multiset (X, Y ) of x and y coordinates which appear. Explicitly, X is the multiset that contains ci copies of the number i for each i. For example, consider the earlier example which had • Two stones each at (1, 1), (1, 2). • One stone each at (3, 1), (2, 1), (2, 3), (3, 2). Its signature can then be reinterpreted as (5, 2, 1; 3, 3, 2) ←→ { X = {1, 1, 1, 1, 1, 2, 2, 3} Y = {1, 1, 1, 2, 2, 2, 3, 3}. In that sense, the entire grid is quite misleading! ¶ Proof that two configurations with the same signature are equivalent The second part is completed just because transpositions generate any permutation. To be explicit, given two sets of stones, we can permute the labels so that the first set is (x1, y1), . . . , (xm, ym) and the second set of stones is (x1, y′ 1), . . . , (xm, y′ m). Then we just induce the correct permutation on (yi) to get (y′ i). ¶ Proof that any signature has at least one configuration Sort the elements of X and Y arbitrarily (say, in non-decreasing order). Put a stone whose x-coordinate is the ith element of X, and whose y-coordinate is the ith element of Y , for each i = 1, 2, . . . , m. Then this gives a stone placement of m stones with signature (X, Y ). For example, if X = {1, 1, 1, 1, 1, 2, 2, 3} Y = {1, 1, 1, 2, 2, 2, 3, 3} then placing stones at (1, 1), (1, 1), (1, 1), (1, 2), (1, 2), (2, 2), (2, 3), (3, 3) gives a valid piling with this signature. 10 USAMO 2015 Solution Notes web.evanchen.cc, updated 10 August 2023 §2.2 USAMO 2015/5, proposed by Mohsen Jamaali Available online at https://aops.com/community/p4774020. Problem statement Let a, b, c, d, e be distinct positive integers such that a4 + b4 = c4 + d4 = e5. Show that ac + bd is a composite number. Assume to the contrary that p = ac + bd, so that ac ≡ −bd (mod p) =⇒ a 4c 4 ≡ b 4d 4 (mod p) =⇒ a 4(e 5 − d 4) ≡ (e5 − a 4)d 4 (mod p) =⇒ a 4e 5 ≡ d 4e5 (mod p) =⇒ e 5(a 4 − d 4) ≡ 0 (mod p) and hence p | e5(a − d)(a + d)(a 2 + d 2). Claim — We should have p > e. Proof. We have e5 = a4 + b4 ≤ a5 + b5 < (ac + bd)5 = p5. Thus the above equation implies p ≤ max(a − d, a + d, a2 + d2) = a2 + d2. Similarly, p ≤ b2 + c2. So ac + bd = p ≤ min {a 2 + d 2, b2 + c 2} or by subtraction 0 ≤ min {a(a − c) + d(d − b), b(b − d) + c(c − a)} . But since a4 + b4 = c4 + d4 the numbers a − c and d − b should have the same sign, and so this is an obvious contradiction. 11 USAMO 2015 Solution Notes web.evanchen.cc, updated 10 August 2023 §2.3 USAMO 2015/6, proposed by Iurie Boreico Available online at https://aops.com/community/p4774023. Problem statement Consider 0 < λ < 1, and let A be a multiset of positive integers. Let An = {a ∈ A : a ≤ n}. Assume that for every n ∈ N, the multiset An contains at most nλ numbers. Show that there are infinitely many n ∈ N for which the sum of the elements in An is at most n(n+1) 2 λ. For brevity, #S denotes |S|. Let xn = nλ − #An ≥ 0. We now proceed by contradiction by assuming the conclusion fails for n large enough; that is, n(n + 1) 2 λ < ∑ a∈An a = 1(#A1 − #A0) + 2(#A2 − #A1) + · · · + n(#An − #An−1) = n#An − (#A1 + · · · + #An−1) = n(nλ − xn) − [(λ − x1) + (2λ − x2) + · · · + ((n − 1)λ − xn−1)] = n(n + 1) 2 λ − nxn + (x1 + · · · + xn−1). This means that for all sufficiently large n, say n ≥ N0, we have xn < x1 + · · · + xn−1 n ∀n ≥ N0. In particular, each xn is the less than the average of all preceding terms. Intuitively this means xn should become close to each other, since they are also nonnegative. However, we have a second condition we haven’t used yet: the “integer” condition implies |xn+1 − xn| = |λ − #{n ∈ A}| > ε for some fixed ε > 0, namely ε = min {λ, 1 − λ}. Using the fact that consecutive terms differ by some fixed ε, we will derive a contradiction. If we let M be the average of x1, . . . , xN0, then we ought to have xn < M ∀n > N0. Hence for n > N0 we have xn + xn+1 < 2M − ε, and so for large enough n the average must drop to just above M − 1 2 ε. Thus for some large N1 > N0, we will have xn < M − 1 3 ε ∀n > N1. If we repeat this argument then with a large N2 > N1, we obtain xn < M − 2 3 ε ∀n > N2 and so on and so forth. This is a clear contradiction. 12 USAMO 2015 Solution Notes web.evanchen.cc, updated 10 August 2023 Remark. Note that if A = {2, 2, 3, 4, 5, . . . } and λ = 1 then contradiction. So the condition that 0 < λ < 1 cannot be dropped, and (by scaling) neither can the condition that A ⊆ Z. Remark (Suggested by Zhao Ting-wei). Despite the relation xn < x1 + · · · + xn−1 n ∀n ≥ N0 implying that xn is bounded, it does not alone imply that xn converges, not even to some nonzero value. Zhao Ting-Wei showed me that one can have a sequence which is zero “every so often” yet where the average is nonzero. A counterexample is given explicitly by xn =  | | 1000 n = 1 0 n is a power of 10 1 + 1 n otherwise which does not have a limit. For completeness, let’s check this — let Hn denote the n’th harmonic number, and compute n−1∑ 1 xn = 1000 + (n − 1) + Hn−1 − ⌊log10 n⌋∑ k=1 (1 + 1 10k ) > n + 999 + Hn−1 − log10 n − (1 + 1 10 + . . . ) > n + 997 + Hn−1 − log10 n > n + 1 so 1 + 1 n < 1 n ∑n−1 1 xn as needed. 13","libVersion":"0.3.1","langs":""}
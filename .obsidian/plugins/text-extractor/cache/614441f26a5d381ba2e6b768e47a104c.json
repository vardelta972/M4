{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Factoring Lemma - Iurie Boreico - MR 2007.pdf","text":"A Factoring Lemma Iurie Boreico, Roman Teleuca 1 Introduction The following classical problem was used in the Moldavian Mathematical Olympiad. Problem 1. Let a, b, c, d be positive integers with ab = cd. Prove that a + b + c + d is composite. Solution. Let N = a + b + c + d. Then aN = a 2 + ab + ac + ad. (1) Because to ab = cd, we can rewrite (1) as aN = a 2 + cd + ac + ad = (a + c)(a + d). Both a + c and a + d are greater than a, so each contributes a factor greater than 1 to N. Thus N is composite. This solution relies on a clever algebraic trick. However, there is a more consis- tent and motivated solution that relies on the Factoring Lemma. Lemma 1. Let a, b, c, d be positive integers with ab = cd. Then there are positive integers m, n, p, q such that gcd(n, p) = 1 and a = mn, b = pq, c = mp, d = nq. Proof. The condition ab = cd can be rewritten as a c = d b . Both fractions have the same representation n p in lowest terms m = a n = c p , q = b p = d n . It is clear that m and q are integers and m, n, p, q have the desired properties. Alternative solution to problem 1. We can ﬁnd positive integers m, n, p, q satisfying the conditions in Lemma 1. Then a + b + c + d = mn + pq + mp + nq = (m + n)(p + q), which explicitly shows that a + b + c + d is composite. Not only does Lemma 1 make problem 1 trivial, but it also appears to be use- ful in many other problems proposed to national and international mathematical olympiads. The techniques can be applied in solving equations and systems of equations over integers. Interesting results can be obtained when this lemma is used in connection with Euclidean rings other than the integers. Mathematical Reflections 6 (2007) 1 2 Diophantine Equations The problem of Pythagorean triples can be solved using the Factoring Lemma. Problem 2. Pairwise relatively prime integers a, b, c satisfy a2 + b2 = c2. If a is odd, then there exist integers u and v such that a = u2 − v2 and b = 2uv. Solution. Let us rewrite the given condition as b2 = (c − a)(c + a). By Lemma 1 there exist m, n, p, q such that b = mn = pq, c − a = mp, c + a = nq. Again, by Lemma 1, there exist x, y, z, w such that m = xy, n = zw, p = xz, q = yw. This means that b = xyzw and a = nq − mp 2 = yz 2 (w2 − x 2). Because w2 and x2 are congruent to either 0 or 1 modulo 4 and a is odd, it follows that 2 | yz. On the other hand, yz divides both b and 2a, so yz = 2. This ﬁnishes the proof. Problem 3. Pairwise relatively prime positive integers a, b, c satisfy a2 + b2 = 2c2. Prove that there exist integers u and v such that a = u2 − v2 + 2uv b = v2 − u2 + 2uv c = u2 + v2. Solution. We have (a − c)(a + c) = (c − b)(c + b). From Lemma 1, there exist m, n, p, q such that a − c = mn, a + c = pq, c − b = mp, c + b = nq. We thus have pq − mn = mp + nq, implying p(q − m) = n(q + m). Again, there exist x, y, z, w such that p = xy, q − m = zw, n = xz, q + m = yw. We have a = 1 2 (mn + pq) = 1 2 ( yw − zw 2 xz + zw + yw 2 xy) = xw 4 (y2 + 2zy − z2) Mathematical Reflections 6 (2007) 2 and b = 1 2 (nq − mp) = 1 2 ( yw + zw 2 xz − yw − zw 2 xy) = xw 4 (−y2 + 2zy + z2). It follows that either xw = 4 and one of z and y is odd or xw = 1 and both z and y are even. We then set u = y, v = z or u = y 2 , v = z 2 , respectively. Problem 4. Prove that there are no positive integers x, y, z such that 2(x 4 − y4) = z2. Solution. Suppose there exist such x, y, z. Then consider such a triple with the minimum possible x + y + z. If two of x, y, z are divisible by a prime r, then the third number is also divisible by r. If x = rx1, y = ry1, z = rz1, then 2r2(x 4 1 − y4 1) = z2 1. Hence p | z1 and z1 = pz2, so 2(x 4 1 − y4 1) = z2 2. Then x1, y1, z2 is a smaller triple. Thus x, y, z must be pairwise relatively prime. We have gcd(x2 −y2, x2 +y2) | gcd(2x2, 2y2) = 2. If it equals 1, then both x2 −y2 and x2 + y2 are squares, which is impossible. Therefore gcd(x2 − y2, x2 + y2) = 2 and both x, y are odd. Thus x 2 − y2 = 4u2 x 2 + y2 = 2v2 (2) for some integers u and v. By Problem 2, there exist integers a and b such that u = ab, y = a 2 − b2, x = a 2 + b2. We have x 2 = 2u2 + v2, y2 = v2 − 2u2. Thus (x−v)(x+v) = 2u2 and (v −y)(v +y) = 2u2. There exist integers a, b, c, d with {x − v, x + v} = {2a2, 4b2}, and {v − y, v + y} = {2c2, 4d2}. Because u = ab = cd, there exist m, n, p, q ∈ Z with a = mn, b = pq, c = mp, d = nq. We have v = |a2 − 2b2| = c2 + 2d2. There are two possible cases: (a) If a2 − 2b2 = c2 + 2d2, then m 2n2 = 2p2q2 + m 2p2 + 2n2q2, m2(n2 − p2) = 2q2(n2 + p2), implying that |n|, |p|, |mq| form a smaller solution. (b) If 2b2 − a2 = c2 + 2d2, then 2p2q2 = m2n2 + m 2p2 + 2n2q2, 2q2(p2 − n2) = m 2(n2 + p2), implying that |n|, |p|, |mq| form a smaller triple. Because both cases lead to a contradiction, the original equation has no solutions. Mathematical Reflections 6 (2007) 3 3 Sums of two squares and Z[i] The following is a well-known fact in Number Theory which also appeared as a problem at the Moldavian IMO team selection tests in 2004. Problem 5. Let (a, b) and (c, d) be two diﬀerent unordered pairs of integers such that a2 + b2 = c2 + d2 = k. Prove that k is composite. Solution. Without loss of generality, a > c (for if a = c, then b = d and the pairs would be the same). We can rearrange the terms to obtain (a − c)(a + c) = (d − b)(d + b). (3) We immediately see that d > b. Then a + c, a − c, d + b, d − b are positive integers and due to (3) and Lemma 1 we can ﬁnd positive integers m, n, p, q with gcd(n, p) = 1 such that a + c = mn, a − c = pq, d + b = mp, d − b = nq. Then a = mn + pq 2 , b = nq − mp 2 and 4k = 4(a 2 + b2) = (mn + pq) 2 + (nq − mp) 2 = m 2n2 + p2q2 + n2q2 + m2p2 = (m 2 + q2)(n2 + p2). (4) Suppose k is prime. Then from (4), without loss of generality, k | m2 + q2. Hence either n2 + p2 = 4 or n2 + p2 = 2. The former is impossible, because 4 cannot be represented as the sum of two positive perfect squares. The latter case yields n = p = 1, which implies a = c, b = d that is again impossible. Thus our assumption is wrong and k is composite. Note that along the way we proved the following simple statement. Lemma 2. If a, b, c, d ∈ Z and a2 + b2 = c2 + d2, then there exist m, n, p, q ∈ Z such that 2a = mn + pq, 2b = mp − nq, 2c = mp + nq, 2d = mn − pq. The Factoring Lemma also holds true in the Euclidean ring Z[i]. One application is the following lemma which leads to many interesting results. Lemma 3. If a, b, c, d are positive integers such that a2 + b2 = cd then there exist integers x, y, z, w, t such that c = t(x 2 + y2), d = t(z2 + w2), a = t(xz − yw), b = t(xw + yz). Mathematical Reflections 6 (2007) 4 Proof. Let t = gcd(a, b, c, d), a = ta1, b = tb1, c = tc1, d = td1. Then a 2 1 + b2 1 = c1d1, which can be rewritten as (a1 + b1i)(a1 − b1i) = c1d1. (5) From Lemma (1), there exist m, n, p, q ∈ Z[i] such that a1 + b1i = mn, a1 − b1i = pq, c1 = np, d1 = mq. (6) Because np and mq are positive integers, it follows that n = kp and q = lm, for some positive rational numbers k and l. On the other hand, |mn| = |pq| implies |kmp| = |lpm| and k = l. Let u, v be relatively prime positive integers such that k = u v . Then a1 + b1i = u v mp, a1 − b1i = u v pm, c1 = u v pp, d1 = u v mm. This means that u | a, b, c, d and thus u = 1. We also have a1 + b1i = v u nq, a1 − b1i = v u qn, c1 = v u nn, d1 = v u qq, implying v | a, b, c, d and thus v = 1. Let n = x + yi and m = z + wi, where x, y, z, w ∈ Z. Then (6) implies a1 = xz − yw, b1 = xw + yz, c1 = x 2 + y2, d1 = z2 + w2, and thus a = t(xz − yw), b = t(xw + yz), c = t(x 2 + y2), d = t(z2 + w2). Corollary 1. If a, b, c are positive integers such that ab = c2 + 1, then a and b can be represented as sums of two perfect squares. Proof. By lemma 3 there exist integers x, y, z, t such that t(x 2 + y2) = a, t(z2 + w2) = b, t(xz − yw) = c, t(xw + yz) = 1. This implies t = 1 and a = x2 + y2, b = z2 + w2. Corollary 2. Every prime p of the form 4k + 1 can be represented as a sum of two integer squares. Mathematical Reflections 6 (2007) 5 Proof. By Wilson’s theorem, −1 ≡ (p − 1)! = 1 · 2 · · · 4k ≡ 1 · 2 · · · 2k · · · (2k + 1 − p) · (2k + 2 − p) · · · (4k − p) ≡ (−1) 2k(2k!) 2 = (2k!) 2 (mod p). (7) From (7), we have (2k!) 2 + 1 = ap, for some integer a and by Corollary 1, p is a sum of two integer squares. 4 Exercises The following problems may help the readers sharpen their skills in applying tech- niques associated with the Factoring Lemma. Problem 6. Find all integer solutions to the equation x2 + 3y2 = z2. Problem 7. Find all integer solutions to the equation x2 + y2 = 5z2 Problem 8. Prove that if N = a2 + 2b2 = c2 + 2d2 and {a, b} ̸= {c, d}, then N is composite. Problem 9. Prove that no four perfect squares form a non-constant arithmetic sequence. Problem 10. (IMO Shortlist, 1998) Find all positive integers n for which there is an integer m with 2n − 1 | m2 + 9. References [1] Titu Andreescu, Dorin Andrica, An Introduction to Diophantine Equations, GIL Publishing House, 2003. [2] Titu Andreescu, Dorin Andrica, Zuming Feng, 104 Number Theory Problems: From the training of USA IMO Team, Birkhauser, 2006. [3] Laurentiu Panaitopol, Alexandru Gica, O introducere in aritmetica si teoria numerelor, Editura Universitatii din Bucuresti, 2001. Mathematical Reflections 6 (2007) 6","libVersion":"0.3.1","langs":""}
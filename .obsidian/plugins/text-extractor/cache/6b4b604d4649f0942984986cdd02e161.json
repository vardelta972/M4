{"path":"iCloudDrive/bks/Calculus/Books/rudin.pdf","text":"INTERNATIONAL SERIES IN PURE AND APPLIED MATHEMATICS PRINCIPLES OF MATHEMATICAL ANALYSIS INTERNATIONAL SERIES IN PURE AND APPLIED MATHEMATICS William Ted Martin, E. H. Spanier, G. Springer and P. J. Davis. Consulting Editors AHLFORS: Complex Analysis BucK: Advanced Calculus BUSACKER AND SAATY: Finite Graphs and Networks CHENEY: Introduction to Approximation Theory CHESTER: Techniques in Partial Differential Equations CODDINGTON AND LEVINSON: Theory of Ordinary Differential Equations CONTE AND DE BooR: Elementary Numerical Analysis: An Algorithmic Approach DENNEMEYER: Introduction to Partial Differential Equations and Boundary Value Problems DETTMAN: Mathematical Methods in Physics and Engineering GOLOMB AND SHANKS: Elements of Ordinary Differential Equations GREENSPAN: Introduction to Partial Differential Equations HAMMING: Numerical Methods for Scientists and Engineers HILDEBRAND: Introduction to Numerical Analysis HousEHOLDER: The Numerical Treatment of a Single Nonlinear Equation KALMAN, FALB, AND ARBIB: Topics in Mathematical Systems Theory LASS: Vector and Tensor Analysis McCARTY: Topology: An Introduction with Applications to Topological Groups MONK: Introduction to Set Theory MOORE: Elements of Linear Algebra and Matrix Theory MosTOW AND SAMPSON: Linear Algebra MouRSUND AND DURIS: Elementary Theory and Application of Numerical Analysis PEARL: Matrix Theory and Finite Mathematics PIPES AND HARVILL: Applied Mathematics for Engineers and Physicists RALSTON: A First Course in Numerical Analysis RITGER AND RosE: Differential Equations with Applications RITT: Fourier Series RUDIN: Principles of Mathematical Analysis SHAPIRO: Introduction to Abstract Algebra SIMMONS: Differential Equations with Applications and Historical Notes SIMMONS: Introduction to Topology and Modern Analysis SNEDDON: Elements of Partial Differential Equations STRUBLE: Nonlinear Differential Equations McGraw-Hill, Inc. New York St. Louis San Francisco Auckland Bogota Caracas Lisbon London Madrid Mexico City Milan Montreal New Delhi San Juan Singapore Sydney Tokyo Toronto WALTER RUDIN Professor of Mathematics University of Wisconsin,-Madison • • • THIRD EDITION This book was set in Times New Roman. The editors were A. Anthony Arthur and Shelly Levine Langman; the production supervisor was Leroy A. Young. R. R. Donnelley & Sons Company was printer and binder. This book is printed on acid-free paper. Library of Congress Cataloging in Publication Data Rudin, Walter, date Principles of mathematical analysis. (International series in pure and applied mathematics) Bibliography: p. Includes index. 1. Mathematical analysis. I. Title. QA300.R8 1976 515 75-17903 ISBN 0-07-054235-X PRINCIPLES OF MATHEMATICAL ANALYSIS • Copyright © 1964, 1976 by McGraw-Hill, Inc. Al] rights reserved. Copyright 1953 by McGraw-Hill, Inc. All rights reserved. Printed in the United States of America. No part of this publication may be reproduced, stored in a retrieval system, or transmitted, in any form or by any means, electronic, mechanical, photocopying, recording, or otherwise, without the prior written permission of the publisher. 28 29 30 DOC/DOC O 9 8 7 6 5 4 3 2 1 0 Preface Chapter 1 The Real and Complex Number Systems Introduction Ordered Sets Fields The Real Field The Extended Real Number System The Complex Field Euclidean Spaces Appendix Exercises Chapter 2 Basic Topology Finite, Countable, and Uncountable Sets Metric Spaces Compact Sets Perfect Sets CONTENTS • lX 1 1 3 5 8 11 12 16 17 21 24 24 30 36 41 Vi CONTENTS Connected Sets Exercises Chapter 3 Numerical Sequences and Series Convergent Sequences Subsequences Cauchy Sequences Upper and Lower Limits Some Special Sequences Series Series of Nonnegative Terms The Number e The Root and Ratio Tests Power Series Summation by Parts Absolute Convergence Addition and Multiplication of Series Rearrangements Exercises Chapter 4 Continuity Limits of Functions Continuous Fur1ctions Continuity and Compactness Continuity and Connectedness Discontinuities Monotonic Functions Infinite Limits and Limits at Infinity Exercises Chapter 5 Differentiation The Derivative of a Real Function Mean Value Theorems The Continuity of Derivatives L'Hospital's Rule Derivatives of Higher Order Taylor's Theorem Differentiation of Vector-valued Functions Exercises 42 43 47 47 51 52 55 57 58 61 63 65 69 70 71 72 75 78 83 83 85 89 93 94 95 97 98 103 103 107 108 109 110 110 111 114 Chapter 6 The Riemann-Stieltjes Integral Definition and Existence of the Integral Properties of the Integral Integration and Differentiation Integration of Vector-valued Functions Rectifiable Curves Exercises Chapter 7 Sequences and Series of Functions. Discussion of Main Problem Uniform Convergence Uniform Convergence and Continuity Uniform Convergence and Integration Uniform Convergence and Differentiation Equicontinuous Families of Functions The Stone-Weierstrass Theorem Exercises Chapter 8 Some Special Functions Power Series The Exponential and Logarithmic Functions The Trigonometric Functions The Algebraic Completeness of the Complex Field Fourier Series The Gamma Function Exercises Chapter 9 Functions of Several Variables Linear Transformations Differentiation The Contraction Principle The Inverse Function Theorem The Implicit Function Theorem The Rank Theorem Determinants Derivatives of Higher Order Differentiation of Integrals Exercises Chapter 10 Integration of Differential Forms Integration CONTENTS vii 120 120 128 133 135 136 138 143 143 147 149 151 152 154 159 165 172 172 178 182 184 185 192 196 204 204 211 220 221 223 228 231 235 236 239 245 245 YID CONTENTS Primitive Mappings Partitions of Unity Change of Variables Differential Forms Simplexes and Chains Stokes' Theorem Closed Forms and Exact Forms Vector Analysis Exercises Chapter 11 The Lebesgue Theory Set Functions Construction of the Lebesgue Measure Measure Spaces Measurable Functions Simple Functions Integration Comparison with the Riemann Integral Integration of Complex Functions Functions of Class !t'2 Exercises Blbllograpby List of Special Symbols • Index 248 251 252 253 266 273 275 280 288 300 300 302 310 310 313 314 322 325 325 332 335 337 339 PREFACE This book is intended to serve as a text for the course in analysis that is usually taken by advanced undergraduates or by first-year students who study mathe- matics. The present edition covers essentially the same topics as the second one, with some additions, a few minor omissions, and considerable rearrangement. I hope that these changes will make the material more accessible amd more attrac- tive to the students who take such a course. Experience has convinced me that it is pedagogically unsound (though logically correct) to start off with the construction of the real numbers from the rational ones. At the beginning, most students simply fail to appreciate the need for doing this. Accordingly, the real number system is introduced as an ordered field with the least-upper-bound property, and a few interesting applications of this property are quickly made. However, Dedekind's construction is not omit- ted. It is now in an Appendix to Chapter I, where it may be studied and enjoyed whenever the time seems ripe. The material on functions of several variables is almost completely re- written, with many details filled in, and with more examples and more motiva- tion. The proof of the inverse function theorem-the key item in Chapter 9'-iS X PREFACE simplified by means of the fixed point theorem about contraction mappings. Differential forms are discussed in much greater detail. Several applications of Stokes' theorem are included. As regards other changes, the chapter on the Riemann-Stieltjes integral has been trimmed a bit, a short do-it-yourself section on the gamma function has been added to Chapter 8, and there is a large number of new exercises, most of them with fairly detailed hints. I have also included several references to articles appearing in the American Mathematical Monthly and in Mathematics Magazine, in the hope that students will develop the habit of looking into the journal literature. Most of these references were kindly supplied by R. B. Burckel. Over the years, many people, students as well as teachers, have sent me corrections, criticisms, and other comments concerning the previous editions of this book. I have appreciated these, and I take this opportunity to express my sincere thanks to all who have written me. WALTER RUDIN THE REAL AND COMPLEX NUMBER SYSTEMS INTRODUCTION A satisfactory discussion of the main concepts of analysis (such as convergence, continuity, differentiation, and integration) must be based on an accurately defined number concept. We shall not, however, enter into any discussion of the axioms that govern the arithmetic of the integers, but assume familiarity with the rational numbers (i.e., the numbers of the form m/n, where m and n are integers and n =fi 0). The rational number system is inadequate for many purposes, both as a field and as an ordered set. (These terms will be defined in Secs. 1.6 and 1.12.) For instance, there is no rational p such that p 2 = 2. (We shall prove this presently.) This leads to the introduction of so-called ''irrational numbers'' which are often written as infinite decimal expansions and are considered to be ''approximated'' by the corresponding finite decimals. Thus the sequence 1, 1.4, 1.41, 1.414, 1.4142, ... ''tends to J2.\" But unless the irrational number J2 has been clearly defined, the question must arise: Just what is it that this sequence ''tends to''? 2 PRINCIPLES OF MATHEMATICAL ANALYSI~ This sort of question can be answered as soon as the so-called ''real number system'' is constructed. 1.1 Example We now show that the equation (1) p 2 = 2 is not satisfied by any rational p. If there were such a p, we could write p = m/n where m and n are integers that are not both even. Let us assume this is done. Then (1) implies (2) m2 = 2n 2 , This shows that m 2 is even. Hence m is even (if m were odd, m 2 would be odd), and so m2 is divisible by 4. It follows that the right side of (2) is divisible by 4, so that n2 is even, which implies that n is even. The assumption that (1) holds thus leads to the conclusion that both m and n are even, contrary to our choice of m and n. Hence (I) is impossible for rational p. We now examine this situation a little more closely. Let A be the set of all positive rationals p such that p 2 < 2 and let B consist of all positive rationals p such that p 2 > 2. We shall show that A contains no largest number and B con- tains no smallest. More explicitly, for every pin A we can find a rational q in A such that p < q, and for every p in B we can find a rational q in B such that q < p. (3) Then (4) To do this, we associate with each rational p > 0 the number p 2 -2 2p + 2 q=p- = . p+2 p+2 2 2 - 2(p2 - 2) q - - (p + 2)2 . If p is in A then p 2 - 2 < 0, (3) shows that q > p, and (4) shows that q 2 < 2. Thus q is in A. If pis in B then p 2 - 2 > 0, (3) shows that O < q < p, and (4) shows that q2 > 2. Thus q is in B. 1.2 Remark The purpose of the above discussion has been to show that the rational number system has certain gaps, in spite of the fact that between any two rationals there is another: If r < s then r < (r + s)/2 < s. The real number system fills these gaps. This is the principal reason for the fundamental role which it plays in analysis. THE REAL AND COMPLEX NUMBER SYSTEMS 3 In order to elucidate its structure, as well as that of the complex numbers, we start with a brief discussion of the general concepts of ordered set and field. Here is some of the standard set-theoretic terminology that will be used throughout this book. 1.3 Definitions If A is any set (whose elements may be numbers or any other objects), we write x e A to indicate that xis a member (or an element) of A. If xis not a member of A, we write: x,; A. The set which contains no element will be called the empty set. If a set has at least one element, it is called nonempty. If A and B are sets, and if every element of A is an element of B, we say that A is a subset of B, and write A c B, or B => A. If, in addition, there is an element of B which is not in A, then A is said to be a proper subset of B. Note that A c A for every set A. If Ac Band B c A, we write A= B. Otherwise A#: B. ' 1.4 Definition Throughout Chap. l, the set of all rational numbers will be denoted by Q. ORDERED SETS 1.5 Definition Let S be a set. An order on S is a relation, denoted by <, with the following two properties: (i) If x e S and ye S then one and only one of the statements x<y, x=y, y<x is true. (ii) If x, y, z e S, if x < y and y < z, then .x < z. The statement ''x < y'' may be read as ''xis less than y'' or ''xis smaller than y'' or ''x precedes y''. It is often convenient to write y > x in place of x < y. The notation x Sy indicates that x < y or x = y, without specifying which of these two is to hold. In other words, x Sy is the negation of x > y. 1.6 Definition An ordered set is a set Sin which an order is defined. For example, Q is an ordered set if r <sis defined to mean thats - r is a positive rational number. 1.7 Definition Suppose S is an ordered set, and E c S. If there exists a /J e S such that x S fJ for every x e E, we say that Eis bounded above, and call /J an upper bound of E. Lower bounds are defined in the same way (with ~ in place of s ). 4 PRINCIPLES OF MATHEMATICAL ANALYSIS 1.8 Definition Suppose S is an ordered set, E c S, and E is bounded above. Suppose there exists an ex e S with the following properties: (i) ex is an upper bound of E. (ii) If y < ex then y is not an upper bound of E. Then ex is called the least upper bound of E [that there is at most one such ex is clear from (ii)] or the supremum of E, and we write ex= sup E. The greatest lower bound, or infimum, of a set E which is bounded below is defined in the same manner: The statement ex= inf E means that ex is a lower bound of E and that no {J with {J > cx is a lower bound of E. 1.9 Examples (a) Consider the sets A and B of Example 1.1 as subsets of the ordered set Q. The set A is bounded above. In fact, the upper bounds of A are exactly the members of B. Since B contains no smallest member, A has no least upper bound in Q. Similarly, B is bounded below: The set of all lower bounds of B consists of A and of all re Q with r S 0. Since A has no lasgest member, B has no greatest lower bound in Q. (b) If cx = sup E exists, then cx may or may not be a member of E. For instance, let E1 be the set of all r e Q with r < 0. Let E2 be the set of all r e Q with r S 0. Then sup E1 = sup E2 = 0, and O ¢ E1 , 0 e E2 • (c) Let E consist of all numbers 1/n, where n = 1, 2, 3, .... Then sup E = 1, which is in E, and inf E = 0, which is not in E. 1.10 Definition An ordered set Sis said to have the least-upper-bound property if the following is true: If E c S, Eis not empty, and Eis bounded above, then sup E exists in S. Example l .9(a) shows that Q does not have the least-upper-bound property. We shall now show that there is a close relation between greatest lower bounds and least upper bounds, and that every ordered set with the least-upper- bound property also has the greatest-lower-bound property. , THE REAL AND COMPLEX NUMBER SYSTEMS S 1.11 Theorem Suppose Sis an ordered set with the /east-upper-bound property, B c S, B is not empty, and B is bounded below. Let L be the set of a// lower bounds of B. Then ex= supL exists in S, and ot: = inf B. In particular, inf B exists in S. Proof Since B is bounded below, L is not empty. Since L consists of exactly those y e S which satisfy the inequality y ~ x for every x e B, we see that every x e B is an upper bound of L. Thus L is bounded above. Our hypothesis about S implies the ref ore that L has a supremum in S; call it ex. If y < ex then (see Definition 1.8) y is not an upper bound of L, hence y ¢ B. It follows that ex~ x for every x e B. Thus ot: e L. If ex < f3 then /3 ¢ L, since ex is an upper bound of L. We have shown that ex e L but f3 ¢ L if /3 > ex. In other words, ot: is a lower bound of B, but f3 is not if /3 > ex. This means that ex= inf B. FIELDS 1.12 Definition A field is a set F with two operations, called addition and multiplication, which satisfy the following so-called ''field axioms'' (A), (M), and (D): (A) Axioms for addition (Al) If x e F and ye F, then their sum x + y is in F. (A2) Addition is commutative: x + y = y + x for all x, ye F. (A3) Addition is associative: (x + y) + z = x + (y + z) for all x, y, z e F. (A4) F contains an element O such that O + x = x for every x e F. (AS) To every x e F corresponds an element -x e F such that X +(-x) = 0. (M) Axioms for multiplication (Ml) If x e F and ye F, then their product xy is in F. (M2) Multiplication is commutative: xy = yx for all x, ye F. (M3) Multiplication is associative: (xy)z = x(yz) for all x, y, z e F. (M4) F contains an element 1 'I: 0 such that Ix= x for every x e F. (MS) If x e F and x 'I: 0 then there exists an element 1/x e F such that x·(l/x)=l. 6 PRINCIPLES OF MATHEMATICAL ANALYSIS (D) The distributive law x(y + z) = xy + xz holds for all x, y, z e F. 1.13 Remarks (a) One usually writes (in any field) X 2 3 x - y, - , x + y + z, xyz, x , x , 2x, 3x, ... y in place of X + (-y), X' 1 - ' (x + y) + z, (xy)z, xx, XXX, X + X, X + X + x, .... (b) The field axioms clearly hold in Q, the set of all rational numbers, if addition and multiplication have their customary meaning. Thus Q is a field. (c) Although it is not our purpose to study fields (or any other algebraic structures) in detail, it is worthwhile to prove that some familiar properties of Q are consequences of the field axioms; once we do this, we will not need to do it again for the real numbers and for the complex numbers. 1.14 Proposition The axioms for addition imply the following statements. (a) If x + y = x + z then y = z. (b) If x + y = x then y = 0. ( c) If x + y = 0 then y = - x. (d) -(-x) = x. Statement (a) is a cancellation law. Note that (b) asserts the uniqueness of the element whose existence is assumed in (A4), and that (c) does the same for (AS). Proof If x + y = x + z, the axioms (A) give y = 0 + y = ( -x + x) + y = -x + (x + y) = -x + (x + z) = (-x + x) + z = 0 + z = z. This proves (a). Take z = 0 in (a) to obtain (b). Take z = -x in (a) to obtain (c). Since -x + x = 0, (c) (with -x in pl~ce of x) gives (d). THE REAL AND COMPLEX NUMBER SYSTEMS 7 1.15 Proposition The axioms for multiplication imply the following statements. (a) If x =I= 0 and xy = xz then y = z. (b) Ifx =I= 0 and xy = x then y = 1. (c) If x =I= 0 and xy = 1 then y = 1/x. (d) If x =I= 0 then 1/(1/x) = x. The proof is so similar to that of Proposition 1.14 that we omit it. 1.16 Proposition The field axioms imply the following statements, for any x, y, zeF. (a) Ox= 0. (b) If x =I= 0 and y =I= 0 then xy =I= 0. (c) (-x)y = -(xy) = x(-y). (d) (-x)(-y) = xy. Proof Ox+ Ox= (0 + O)x = Ox. Hence l.14(b) implies that Ox= 0, and (a) holds. Next, assume x =I= 0, y =I= 0, but xy = 0. Then (a) gives 1 1 1 1 = - - xy = - y X y a contradiction. Thus (b) holds. The first equality in (c) comes from 1 - 0 = 0, X ( - x)y + xy = ( - x + x)y = Oy = 0, combined with 1.14(c); the other half of (c) is proved in the same way. Finally, (-x)(-y)= -[x(-y)]= -[-(xy)]=xy by (c) and 1.14(d). 1.17 Definition An ordered.field is a.field F which is also an ordered set, such that (i) x + y < x + z if x, y, z e F and y < z, (ii) xy > 0 if x e F, y e F, x > 0, and y > 0. If x > 0, we call x positive; if x < 0, xis negative. For example, Q is an ordered field. All the familiar rules for working with inequalities apply in every ordered field: Multiplication by positive [negative] quantities preserves [reverses] in- equalities, no square is negative, etc. The following proposition lists some of these. 8 PRINCIPLES OF MATHEMATICAL ANALYSIS 1.18 Proposition The following statements are true in every ordered field. (a) If x > 0 then - x < 0, and vice versa. (b) If x > 0 and y < z then xy <xz. (c) If x < 0 and y < z then xy > xz. (d) If x 'I: 0 then x 2 > 0. In particular, 1 > 0. (e) If O < x < y then O < 1/y < 1/x. Proof (a) If x > 0 then O = -x + x > -x + 0, so that -x < 0. If x < 0 then 0 = -x + x < -x + 0, so that -x > 0. This proves (a). (b) Since z > y, we have z - y > y - y = 0, hence x(z - y) > 0, and therefore xz = x(z - y) + xy > 0 + xy = xy. (c) By (a), (b), and Proposition l.16(c), -[x(z -y)] = (-x)(z -y) > 0, so that x(z - y) < 0, hence xz < xy. (d) If x > 0, part (ii) of Definition 1.17 gives x 2 > 0. If x < 0, then -x > 0, hence (-x) 2 > 0. But x 2 = (-x) 2 , by Proposition l.16(d). Since 1 = 1 2 , 1 > 0. (e) lfy > 0 and v ~ 0, thenyv ~ 0. Buty · (1/y) = 1 > 0. Hence 1/y > 0. Likewise, 1/x > 0. If we multiply both sides of the inequality x < y by the positive quantity (1/x)(l/y), we obtain 1/y < 1/x. THE REAL FIELD We now state the existence theorem which is the core of this chapter. 1.19 Theorem There exists an ordered field R which has the /east-upper-bound property. Moreover, R contains Q as a subfield. The second statement means that Q c R and that the operations of addition and multiplication in R, when applied to members of Q, coincide with the usual operations on rational numbers; also, the positive rational numbers are positive elements of R. The members of Rare called real numbers. The proof of Theorem 1.19 is rather long and a bit tedious and is the ref ore presented in an Appendix to Chap. 1. The proof actually constructs R from Q. THE REAL AND COMPLEX NUMBER SYSTEMS 9 The next theorem could be extracted from this construction with very little extra effort. However, we prefer to derive it from Theorem 1.19 since this provides a good illustration of what one can do with the least-upper-bound property. 1.20 Theorem (a) If x e R, y e R, and x > 0, then there is a positive integer n such that nx > y. (b) If x e R, ye R, and x < y, then there exists ape Q such that x < p < y. Part (a) is usually referred to as the archimedean property of R. Part (b) may be stated by saying that Q is dense in R: Between any two real numbers there is a rational one. Proof (a) Let A be the set of all nx, where n runs through the positive integers. If (a) were false, then y would be an upper bound of A. But then A has a least upper bound in R. Put a= sup A. Since x > 0, a - x < a, and a - xis not an upper bound of A. Hence a - x < mx for some positive integer m. But then °' < (m + l)x e A, which is impossible, since a is an upper bound of A. (b) Since x < y, we have y - x > 0, and (a) furnishes a positive integer n such that n(y - x) > 1. Apply (a) again, to obtain positive integers m1 and m2 such that m1 > nx, m 2 > -nx. Then -m 2 < nx < m1 • Hence there is an integer m (with -m 2 ~ m ~ m1) such that m - 1 ~ 11x < m. If we combine these inequalities, we obtain nx < m ~ 1 + nx < ny. Since n > 0, it follows that This proves (b), with p = m/n. m X < - < y. n 10 PRINCIPLES OF MATHEMATICAL ANALYSIS We shall now prove the existence of nth roots of positive reals. This proof will show how the difficulty pointed out in the Introduction (irration- ality of y'2) can be handled in R. 1.21 Theorem For every real x > 0 and every integer n > 0 there is one and only one positive real y such that y\" = x. This number y is written i-;; or x 1'\"· Proof That there is at most one such y is clear, since O < y1 < y 2 implies )\";<)1. Let E be the set consisting of all positive real numbers t such that t\" < x. If t = x/(1 + x) then O S t < 1. Hence t\" s t < x. Thus t e E, and E is not empty. If t > 1 + x then t\" ~ t > x, so that t ¢ E. Thus 1 + x is an upper bound of E. Hence Theorem 1.19 implies the existence of y = sup E. To prove that y\" = x we will show that each of the inequalities y\" < x and y\" > x leads to a contradiction. The identity b\" - a\"= (b - a)(b\"- 1 + b\"- 2a + · · · + a\"- 1) yields the inequality b\" - a\"< (b - a)nb\"- 1 when O <a< b. Assume y\" < x. Choose h so that O < h < 1 and h< x-y\" . n(y + l)n-1 Put a = y, b = y + h. Then (y + h)\" - y\" < hn(y + h)n-l < hn(y + l)\"- 1 < x - y\". Thus (y + h)\" < x, and y +he E. Since y + h > y, this contradicts the fact that y is an upper bound of E. Assume y\" > x. Put y\" - X k=--· ny\"-1 Then O < k < y. If t ~ y - k, we conclude that y\" - t\" ~ y\" - (y - k)\" < kny\"- 1 = y\" - x. Thus t\" > x, and t ¢ E. It follows that y - k is an upper bound of E. THE REAL AND COMPLEX NUMBER SYSTEMS 11 But y - k < y, which contradicts the fact that y is the least upper bound of E. Hence y\" = x, and the proof is complete. Corollary If a and b are positive real numbers and n is a positive integer, then (ab)lfn = a1fnb1fn. Proof Put ot: = a 11\", /3 = b 11\". Then ab = a.\" /3\" = ( a.{3)\", since multiplication is commutative. [Axiom (M2) in Definition 1.12.J The uniqueness assertion of Theorem 1.21 shows the ref ore that (ab)tfn = a.{3 = a11nb11n. 1.22 Decimals We conclude this section by pointing out the relation between real numbers and decimals. Let x > 0 be real. Let n0 be the largest integer such that n0 ~ x. (Note that the existence of n0 depends on the archimedean property of R.) Having chosen n0 , n1 , ••• , nk-t, let nk be the largest integer such that n1 nk no + 10 + ... + 10k ~ x. Let Ebe the set of these numbers (5) (k = 0, 1, 2, ... ). Then x = sup E. The decimal expansion of x is (6) no . n1n2 n3 .... Conversely, for any infinite decimal (6) the set E of numbers (5) is bounded above, and (6) is the decimal expansion of sup E. Since we shall never use decimals, we do not enter into a detailed discussion. THE EXTENDED REAL NUMBER SYSTEM 1.23 Definition The extended real number system consists of the real field R and two symbols, + oo and - oo. We preserve the original order in R, and define -oo<x<+oo for every x e R. 12 PRINCIPLES OF MATHEMATICAL ANALYSIS It is then clear that + oo is an upper bound of every subset of the extended real number system, and that every nonempty subset has a least upper bound. If, for example, E is a nonempty set of real numbers which is not bounded above in R, then sup E = + oo in the extended real number system. Exactly the same remarks apply to lower bounds. The extended real number system does not form a field, but it is customary to make the following conventions: (a) If xis real then X + 00 = +oo, x-oo=-oo ' X = X = O. +oo -oo (b) If x > 0 then x · (+oo) = +oo, x · (-oo) = -oo. ( c) If x < 0 then x · ( + oo) = - oo, x · ( - oo) = + oo. When it is desired to make the distinction between real numbers on the one hand and the symbols + oo and - oo on the other quite explicit, the former are called.finite. THE COMPLEX FIELD 1.24 Definition A complex number is an ordered pair (a, b) of real numbers. ''Ordered'' means that (a, b) and (b, a) are regarded as distinct if a-:/= b. Let x = (a, b), y = (c, d) be two complex numbers. We write x = y if and only if a= c and b = d. (Note that this definition is not entirely superfluous; think of equality of rational numbers, represented as quotients of integers.) We define x + y = (a + c, b + d), xy = (ac - bd, ad+ be). 1.25 Theorem These definitions of addition and multiplication turn the set of all complex numbers into afield, with (0, 0) and (1, 0) in the role ofO and 1. ' Proof We simply verify the field axioms, as listed in Definition 1.12. (Of course, we use the field structure of R.) Let x = (a, b), y = (c, d), z = (e,f). (Al) is clear. (A2) x + y =(a+ c, b + d) = (c + a, d + b) = y + x. THE REAL AND COMPLEX NUMBER SYSTEMS 13 (A3) (x + y) + z = (a + c, b + d) + (e,f) = (a + c + e, b + d + f) = (a, b) + (c + e, d + f) = x + (y + z). (A4) x + 0 = (a, b) + (0, 0) = (a, b) = x. (A5) Put -x = (-a, -b). Then x + (-x) = (0, 0) = 0. (Ml) is clear. (M2) xy = (ac - bd, ad+ be) = (ca - db, da + cb) = yx. (M3) (xy)z = (ac - bd, ad+ bc)(e,f) = (ace - bde - adf - bcf, acf - bdf + ade + bee) = (a, b)(ce - df, cf+ de)= x(yz). (M4) Ix= (1, O)(a, b) = (a, b) = x. (M5) If x-:/= 0 then (a, b) -:/= (0, 0), which means that at least one of the real numbers a, b is different from 0. Hence a2 + b2 > 0, by Proposition l. l 8(d), and we can define 1 a -b - -- X • a2 + b2 ' a2 + b2 Then 1 a x . ~ = (a, b) a2 + b2' (D) x(y + z) = (a, b)(e + e, d + f) -b = (], 0) = 1. a2 + b2 = (ac + ae - bd- bf, ad+ af +be+ be) = (ac - bd, ad+ be) + (ae - bf, af + be) = xy + xz. 1.26 Theorem For any real numbers a and b we have (a, 0) + (b, 0) = (a + b, 0), The proof is trivial. (a, O)(b, 0) = (ab, 0). Theorem 1.26 shows that the complex numbers of the form (a, 0) have the same arithmetic properties as the corresponding real numbers a. We can there- fore identify (a, 0) with a. This identification gives us the real field as a subfield of the complex field. The reader may have noticed that we have defined the complex numbers without any reference to the mysterious square root of - 1. We now show that the notation (a, b) is equivalent to the more customary a + bi. 1.27 Definition i = (0, 1 ). 14 PRINCIPLES OF MATHEMATICAL ANALYSIS 1.28 Theorem i 2 = -1. Proof i 2 = (0, 1)(0, 1) = (-1, 0) = -1. 1.29 Theorem If a and bare real, then (a, b) =a+ bi. Proof a+ bi= (a, 0) + (b, 0)(0, 1) = (a, 0) + (0, b) = (a, b). 1.30 Definition If a, b are real and z =a+ bi, then the complex number z = a - bi is called the conjugate of z. The numbers a and b are the real part and the imaginary part of z, respectively. We shall occasionally write a= Re(z), b = Im(z). 1.31 Theorem If z and w are complex, then (a) z + w = z + w, (b) (c) (d) - -zw = z. w, z + z = 2 Re(z), z - z = 2i lm(z), zz is real and positive (except when z = 0). Proof (a), (b), and (c) are quite trivial. To prove (d), write z = a + bi, and note that zz = a 2 + b2 • 1.32 Definition If z is a complex number, its absolute value I z I is the non- negative square root of zz; that is, I z I = (zz) 112 • The existence (and uniqueness) of lzl follows from Theorem 1.21 and part ( d) of Theorem 1. 31. Note that when x is real, then x = x, hence Ix I =J x 2 • Thus Ix I = x if x ~ 0, Ix I = -x if x < 0. 1.33 Theorem Let z and w be complex numbers. Then (a) lzl > 0 unless z = 0, IOI = 0, (b) lzl = lzl, (c) I zw I = I z I I w I, (d) I Re z I ~ I z I, (e) I z + w I ~ I z I + I w I . THE REAL AND COMPLEX NUMBER SYSTEMS 15 Proof (a) and (b) are trivial. Putz= a+ bi, w = c + di, with a, b, c, d real. Then I zw I 2 = (ac - bd)2 + (ad+ bc)2 = (a2 + b2)(c2 + d2) = I z I 2 I w I 2 or I zw I 2 = ( I z I I w I ) 2 • Now (c) follows from the uniqueness assertion of Theorem 1.21. To prove (d), note that a 2 ~ a 2 + b 2 , hence lal = Ja2 ~ Ja2 + b2. To prove (e), note that zw is the conjugate of zw, so that zw + zw = 2 Re (zw). Hence I z + w I 2 = (z + w)(z + w) = zz + zw + zw + ww = I z I 2 + 2 Re ( zw) + I w I 2 ~ I z I 2 + 2 I zw I + I w I 2 = I z I 2 + 21 z 11 w I + I w l 2 = < I z I + I w I ) 2 • Now (e) follows by taking square roots. 1.34 Notation If x1 , ••• , Xn are complex numbers, we write n X1 + X2 + • •. + Xn = L Xj. J= 1 We conclude this section with an important inequality, usually known as the Schwarz inequality. 1.35 Theorem If a 1 , .•• , an and b1 , ••. , bn are complex numbers, then Proof Put A= l:lajl 2 , B = l:lbjl 2 , C = l:aj5j (in all sums in this proof, j runs over the values l, ... , n). If B = 0, then b1 = · · · = bn = 0, and the conclusion is trivial. Assume therefore that B > 0. By Theorem 1.31 we have I I Baj - Cbj 1 2 = L (Baj - Cbj)(Baj - Cbj) = B2 L I aj 12 - BC L aj 5j - BC L iij bj + I Cl 2 L I bj 12 = B 2A - Bl c1 2 = B(AB - I Cl 2). 16 PRINCIPLES OF MATHEMATICAL ANALYSIS Since each term in the first sum is nonnegative, we see that B(AB - I Cl 2) ~ 0. Since B > 0, it follows that AB - I Cl 2 ~ 0. This is the desired inequality. EUCLIDEAN SPACES 1.36 Definitions For each positive integer k, let Rk be the set of all ordered k-tuples X = (X1, X2,,,,, Xk), ' where x1 , •.. , xk are real numbers, called the coordinates of x. The elements of Rk are called points, or vectors, especially when k > 1. We shall denote vectors by boldfaced letters. If y = (y1, ••• , Yk) and if et is a real number, put x + Y = (x1 + Y1, • • • , xk + Yk), CtX = (etX1, , . , , CtXk) so that x + y e Rk and etx e Rk. This defines addition of vectors, as well as multiplication of a vector by a real number (a scalar). These two operations satisfy the commutative, associative, and distributive laws (the proof is trivial, in view of the analogous laws for the real numbers) and make Rk into a vector space over the real field. The zero element of Rk (sometimes called the origin or the null vector) is the point 0, all of whose coordinates are 0. We also define the so-called ''inner product'' (or scalar product) of x and y by k X. y = L XiYi i= 1 and the norm of x by k 1/2 Ixf • 1 The structure now defined (the vector space Rk with the above inner product and norm) is called euclidean k-space. 1.37 Theorem Suppose x, y, z e Rk, and et is real. Then (a) lxl ~ O; (b) !xi = 0 if and only ifx = O; ( C) I CtX I = I Ct I I X I ; ( d) I X • y I ~ I X I I y I ; (e) lx+yl ~lxl + !YI; (f) lx-zl ~ lx-yl + ly-zl, THE REAL AND COMPI.EX NUMBER SYSTEMS 17 Proof (a), (b), and (c) are obvious, and (d) is an immediate consequence of the Schwarz inequality. By (d) we have Ix + y 1 2 = (x + y) · (x + y) =x·x+2x·y+y·y S lxl 2 +21xl IYI + IYl 2 = ( I X I + I Y I ) 2, so that (e) is proved. Finally, (f) follows from (e) if we replace x by x - y and y by y - z. 1.38 Remarks Theorem 1.37 (a), (b), and (f) will allow us (see Chap. 2) to regard Rk as a metric space. R 1 (the set of all real numbers) is usually called the line, or the real line. Likewise, R 2 is called the plane, or the complex plane ( compare Definitions 1.24 and 1.36). In these two cases the norm is just the absolute value of the corre- sponding real or complex number. APPENDIX Theorem 1.19 will be proved in this appendix by constructing R from Q. We shall divide the construction into several steps. Step 1 The members of R will be certain subsets of Q, called cuts. A cut is, by definition, any set rx c Q with the following three properties. (I) rx is not empty, and rx #:. Q. (II) If p e rx, q e Q, and q < p, then q e rx. (Ill) If p e rx, then p < r for some re rx. The letters p, q, r, ... will always denote rational numbers, and rx, p, y, ... will denote cuts. Note that (III) simply says that rx has no largest member; (II) implies two facts which will be used freely: If p e rx and q ¢ rx then p < q. If r ¢ rx and r < s then s ¢ rx. Step 2 Define ''rx < P'' to mean: rx is a proper subset of p. Let us check that this meets the requirements of Definition 1.5. If rx < P and P < y it is clear that rx < y. (A proper subset of a proper sub- set is a proper subset.) It is also clear that at most one of the three relations (X < p, (X = p, p < a, 18 PRINCIPLES OF MATHEMATICAL ANALYSIS can hold for any pair rx, p. To show that at least one holds, assume that the first two fail. Then rx is not a subset of p. Hence there is ape rx with p,; p. If q e p, it follows that q < p (since p ,; P), hence q e rx, by (II). Thus p c rx. Since P =I= rx, we conclude; p < rx. Thus R is now an ordered set. Step 3 The ordered set R has the least-upper-bound property. To prove this, let A be a nonempty subset of R, and assume that p e R is an upper bound of A. Define y to be the union of all rx e A. In other words, p e y if and only if p e rx for some et e A. We shall prove that ye R and that y = sup A. Since A is not empty, there exists an et0 e A. This et0 is not empty. Since et0 c y, y is not empty. Next, y c /3 (since et c P for every et e A), and therefore y =I= Q. Thus y satisfies property (I). To prove (11) and (III), pick p e y. Then p e et1 for some rx1 e A. If q < p, then q e et1 , hence q e y; this proves (II). If r E Ct1 is so chosen that r > P, we see that r E '}' (since Ct1 C y), and therefore '}' satisfies (III). Thus ye R. It is clear that et ~ y for every et e A. Suppose <> < y. Then there is an s e y and that s ¢ o. Since s e y, s e et for some rx e A. Hence o < et, and o is not an upper bound of A. This gives the desired result: y = sup A. Step 4 If et e R and Pe R we define et + f3 to be the set of all sums r + s, where re et ands e p. We define O* to be the set of all negative rational numbers. It is clear that O* is a cut. We verify that the axioms for addition (see Definition 1.12) hold in R, with O* playing the role of 0. (Al) We have to show that et+ p is a cut. It is clear that rx + f3 is a nonempty subset of Q. Take r' ¢ et, s' ¢ p. Then r' + s' > r + s for all choices of re et, s e p. Thus r' + s' ¢ et + p. It follows that et + p has property (I). Pick p e et + p. Then p = r + s, with re et, s e p. If q < p, then q - s < r, so q - s e et, and q = (q - s) + s e et+ {3. Thus (11) holds. Choose t e et so that t > r. Then p < t +sand t + s e et+ fl. Thus (Ill) holds. (A2) et+ pis the set of all r + s, with re et, s e p. By the same definition, f3 + et is the set of all s + r. Since r + s = s + r for all re Q, s e Q, we have et + p = P + et. (A3) As above, this follows from the associative law in Q. (A4) Ifr e et ands e O*, then r + s < r, hence r + s e et. Thus rx + O* c et. To obtain the opposite inclusion, pick p e et, and pick re rx, r > p. Then THE REAL AND COMPLEX NUMBER SYSTEMS 19 p - re O*, and p = r +(p - r) e rx + O*. Thus rx c rx + O*. We conclude that ex + O* = rx. (AS) Fix rx e R. Let P be the set of all p with the following property: There exists r > 0 such that - p - r ,; rx. In other words, some rational number smaller than - p fails to be in rx. We show that Pe Rand that rx + P = O*. If s ,; ex and p = - s - 1, then - p - 1 ,; ex, hence p e P. So P is not empty. If q e rx, then -q ¢ p. So p -:/= Q. Hence f3 satisfies (I). Pick p e P, and pick r > 0, so that -p - r,; ex. If q <p, then -q - r > -p - r, hence -q - r ¢ ex. Thus q e p, and (II) holds. Put t=p+(r/2). Then t>p, and -t-(r/2)= -p-rfiex, so that tep. Hence p satisfies (Ill). We have proved that P e R. If r e ex and s e /3, then --s ,; ex, hence r < -s, r + s < 0. Thus (X +PC 0*, To prove the opposite inclusion, pick v e O*, put w = -v/2. Then w > 0, and there is an integer n such that nw e ex but (n + l)w ¢ ex. (Note that this depends on the fact that Q has the archimedean property!) Put p = -(n + 2)w. Then pep, since -p - w ¢ ex, and v = nw + p e rx + p. Thus O* c ex+ p. We conclude that ex+ f3 = O*. This /3 will of course be denoted by - ex. Step 5 Having proved that the addition defined in Step 4 satisfies Axioms (A) of Definition 1.12, it follows that Proposition 1.14 is valid in R, and we can prove one of the requirements of Definition 1.17: If ex, {3, ye R and f3 < y, then ex + f3 < ex + y. Indeed, it is obvious from the definition of + in R that ex +pc ex + y; if we had ex + p = ex + y, the cancellation law (Proposition 1.14) would imply /3 = '}', It also follows that ex > O* if and only if - ex < O*. Step 6 Multiplication is a little more bothersome than addition in the present context, since products of negative rationals are positive. For this reason we confine ourselves first to R+, the set of all ex e R with ex> O*. If ex e R+ and Pe R+, we define ex/3 to be the set of all p such that p::::;; rs for some choice of re ex, s e p, r > 0, s > 0. We define 1 * to be the set of all q < 1. 20 PRINCIPLES OF MATHEMATICAL ANALYSIS Then the axioms (M) and (D) of Definition 1.12 hold, with R+ in place of F, and with 1 * in the role of 1. The proofs are so similar to the ones given in detail in Step 4 that we omit them. Note, in particular, that the second requirement of Definition 1.17 holds: If rx > O* and p > O* then rxp > O*. Step 7 We complete the definition of multiplication by setting rxO* = O*rx = O*, and by setting rxP = (-rx)(-P) -[(-rx)P1 -[ex· (-P)1 if rx < O*, p < O*, if rx < 0*, p > O*, if ex > O*, p < O*. The products on the right were defined in Step 6. Having proved (in Step 6) that the axioms (M) hold in R+, it is now perfectly simple to prove them in R, by repeated application of the identity y = -( -y) which is part of Proposition 1.14. (See Step 5.) The proof of the distributive law rx(P + y) = rxP + rxy breaks into cases. For instance, suppose rx > O*, p < O*, p + y > O*. Then y = (P + y) + ( -P), and (since we already know that the distributive law holds in R+) rxy = rx(P + y) + rx · (-p). But rx · (-P) = -(rxp). Thus rxP + rxy = rx(P + y ). The other cases are handled in the same way. We have now completed the proof that R is an ordered field with the least- upper-bound property. Step 8 We associate with each re Q the set r* which consists of all p e Q such that p < r. It is clear that each r* is a cut; that is, r* e R. Thec;e cuts satisfy the following relations: (a) r* + s* = (r + s)*, (b) r*s* = (rs)*, (c) r* < s* if and only if r < s. To prove (a), choose per* + s*. Then p = u + v, where u < r, v < s. Hence p < r + s, which says that p e (r + s)*. THE REAL AND COMPLEX NUMBER SYSTEMS 21 Conversely, suppose p e (r + s)*. Then p < r + s. Choose t so that 2t = r + s - p, put r' = r - t, s' = s - t. Then r' er*, s' es*, and p = r' + s', so that per* + s*. This proves (a). The proof of (b) is similar. If r < s then res*, but r ¢ r*; hence r* < s*. If r* < s*, then there is apes* such that p ¢ r*. Hence r ~ p < s, so that r < s. This proves (c). Step 9 We saw in Step 8 that the replacement of the rational numbers r by the corresponding ''rational cuts'' r* e R preserves sums, products, and order. This fact may be expressed by saying that the ordered field Q is isomorphic to the ordered field Q* whose elements are the rational cuts. Of course, r* is by no means the same as r, but the properties we are concerned with (arithmetic and order) are the same in the two fields. It is this identification of Q with Q* which allows us to regard Q as a subfield of R. The second part of Theorem 1.19 is to be understood in terms of this identification. Note that the same phenomenon occurs when the real numbers are regarded as a subfield of the complex field, and it also occurs at a much more elementary level, when the integers are identified with a certain subset of Q. It is a fact, which we will not prove here, that any two ordered fields with the least-upper-bound property are isomorphic. The first part of Theorem 1.19 therefore characterizes the real field R completely. The books by Landau and Thurston cited in the Bibliography are entirely devoted to number systems. Chapter 1 of Knopp's book contains a more leisurely description of how R can be obtained from Q. Another construction, in which each real number is defined to be an equivalence class of Cauchy sequences of rational numbers (see Chap. 3), is carried out in Sec. 5 of the book by Hewitt and Stromberg. The cuts in Q which we used here were invented by Dedekind. The construction of R from Q by means of Cauchy sequences is due to Cantor. Both Cantor and Dedekind published their constructions in 1872. EXERCISES Unless the contrary is explicitly stated, all numbers that are mentioned in these exer- cises are understood to be real. 1. If r is rational (r =I=- 0) and x is irrational, prove that r + x and rx are irrational. 22 PRINCIPLES OF MATHEMATICAL ANALYSIS 2. Prove that there is no rational number whose square is 12. 3. Prove Proposition 1.15. 4. Let E be a nonempty subset of an ordered set; suppose IX is a lower bound of E and f3 is an upper bound of E. Prove that IX ::;: {3. 5. Let A be a nonempty set of real numbers which is bounded below. Let - A be the set of all numbers - x, where x E A. Prove that inf A = -sup(-A). 6. Fix b > 1. (a) If m, n, p, q are integers, n > 0, q > 0, and r = m/n = p/q, prove that (bm)lfn = (b\")lfq, Hence it makes sense to define b' = (bm) 11n. (b) Prove that br+s = b'bs if rands are rational. (c) If x is real, define B(x) to be the set of all numbers b', where t is rational and t ::;: x. Prove that b' = sup B(r) when r is rational. Hence it makes sense to define b\" = sup B(x) for every real x. (d) Prove that b\"+)I = b\"b)I for all real x and y. 7. Fix b > 1, y > 0, and prove that there is a unique real x such that b\" = y, by completing the following outline. (This xis called the logarithm of y to the base b.) (a) For any positive integer n, bn - 1 ~ n(b - 1). (b) Hence b - 1 ~ n(b 11n - 1). (c) If t > 1 and n > (b - 1)/(t - 1), then b11n < t. (d) If w is such that bw < y, then bw+<ltn> < y for sufficiently large n; to see this, apply part (c) with t = y · b-w. (e) If bw > y, then bw-< 11n> > y for sufficiently large n. (/) Let A be the set of all w such that bw < y, and show that x = sup A satisfies b\" = y. (g) Prove that this x is unique. 8. Prove that no order can be defined in the complex field that turns it into an ordered field. Hint: -1 is a square. 9. Suppose z = a + bi, w = c + di. Define z < w if a < c, and also if a = c but b < d. Prove that this turns the set of all complex numbers into an ordered set. (This type of order relation is called a dictionary order, or lexicographic order, for obvious reasons.) Does this ordered set have the least-upper-bound property? 10. Suppose z = a + bi, w = u + iv, and a= l wl + u 112 2 ' b= I w l - u 112 2 • THE R.EAL AND COMPLEX NUMBER. SYSTEMS 23 Prove that z2 = w if v ~ 0 and that (z)2 = w if v ~ 0. Conclude that every complex number (with one exception!) has two complex square roots. 11. If z is a complex number, prove that there exists an r ~ 0 and a complex number w with I wl = 1 such that z = rw. Are wand r always uniquely determined by z? 12. If z1, ... , Zn are complex, prove that lz1+z2+···+znl ~lz1I + lz2I +···+lznl• 13. If x, y are complex, prove that llxl - IYII ~ lx-yl, 14. If z is a complex number such that lzl = 1, that is, such that zi= 1, compute 11 +zl2+ ll-zl2, 15. Under what conditions does equality hold in the Schwarz inequality? 16. Suppose k ~ 3, x, y ER\", Ix- YI = d> 0, and r > 0. Prove: (a) If 2r > d, there are infinitely many z e R\" such that lz-xl = lz-yl =r. (b) If 2r = d, there is exactly one such z. (c) If 2r < d, there is no such z. How must these statements be modified if k is 2 or 1 ? 17. Prove that Ix+ Yl 2 + Ix- Yl 2 = 2lxl 2 + 2IYl 2 if XE R\" and ye R\". Interpret this geometrically, as a statement about parallel- ograms. 18. If k ~ 2 and x ER\", prove that there exists y ER\" such that y ~ 0 but x • y = 0. Is this also true if k = 1 ? 19. Suppose a e R\", b ER\". Find c e R\" and r > 0 such that Ix-al =2lx-bl if and only if Ix - cl = r. (Solution: 3c = 4b- a, 3r = 2lb - al.) 20. With reference to the Appendix, suppose that property (III) were omitted from the definition of a cut. Keep the same definitions of order and addition. Show that the resulting ordered set has the least-upper-bound property, that addition satisfies axioms (Al) to (A4) (with a slightly different zero-element!) but that (AS) fails. BASIC TOPOLOGY FINITE, COUNTABLE, AND UNCOUNTABLE SETS We begin this section with a definition of the function concept. 2.1 Definition Consider two sets A and B, whose elements may be any objects whatsoever, and suppose that with each elen1ent x of A there is associated, in some manner, an element of B, which we denote by f(x). Then/ is said to be a function from A to B (or a mapping of A into B). The set A is called the domain off (we also say .f is defined on A), and the elements f(x) are called the vali1es off The set of all values off is called the range off 2.2 Definition Let A and B be two sets and let f be a mapping of A into B. If E c: A,f(E) is defined to be the set of all elements f(x), for x EE. We call f(E) the image of E under f. In this notation, f(A) is the range off. It is clear that/(A) c: B. If /(A) = B, we say that/ maps A onto B. (Note that, according to this usage, onto is more specific than into.) If E c: B,1·- 1(E) denotes the set of all x EA such thatf(x) EE. We call 1- 1 (E) the inverse image of E under f If y E B,f- 1(.Y) is the set of all x EA BASIC TOPOLOGY 25 such that f(x) = y. If, for each ye B,/- 1(y) consists of at most one element of A, then f is said to be a 1-1 (one-to-one) mapping of A into B. This may also be expressed as follows: / is a 1-1 mapping of A into B provided that f(x1) #= f(x2) whenever x1 #= x 2 , x1 e A, x 2 eA. (The notation x1 #= x 2 means that x1 and x 2 are distinct elements; other- wise we write x1 = x 2 .) 2.3 Definition If there exists a 1-1 mapping of A onto B, we say that A and B can be put in 1-1 correspondence, or that A and B have the same cardinal number, or, briefly, that A and B are equivalent, and we write A ,...,, B. This relation clearly has the following properties: It is reftexi ve: A ,...,, A. It is symmetric: If A ,...,, B, then B,...,, A. It is transitive: If A ,...,, B and B ,...,, C, then A ,...,, C. Any relation with these three properties is called an equivalence relation. 2.4 Definition For any positive integer n, let Jn be the set whose elements are the integers 1, 2, ... , n; let J be the set consisting of all positive integers. For any set A, we say: (a) A is finite if A ,...,, Jn for some n (the empty set is also considered to be finite). (b) A is infinite if A is not finite. (c) A is countable if A,...,, J. (d) A is uncountable if A is neither finite nor countable. (e) A is at most countable if A is finite or countable. Countable sets are sometimes called enumerable, or denumerable. For two finite sets A and B, we evidently have A ,...,, B if and only if A and B contain the same number of elements. For infinite sets, however, the idea of ''having the same number of elements'' becomes quite vague, whereas the notion of 1-1 correspondence retains its clarity. 2.5 Example Let A be the set of all integers. Then A is countable. For, consider the following arrangement of the sets A and J: A: 0, 1, - 1, 2, - 2, 3, - 3, ... J: 1, 2, 3, 4, 5, 6, 7, ... 26 PRINCIPLES OF MATHEMATICAL ANALYSIS We can, in this example, even give an explicit formula for a function f from J to A which sets up a 1-1 correspondence: n (n even), - 2 f(n) = n-1 (n odd). - 2 2.6 Remark A finite set cannot be equivalent to one of its proper subsets. That this is, however, possible for infinite sets, is shown by Example 2.5, in which J is a proper subset of A. In fact, we could replace Definition 2.4(b) by the statement: A is infinite if A is equivalent to one of its proper subsets. 2. 7 Definition By a sequence, we mean a function f defined on the set J of all positive integers. If f(n) = Xn, for n e J, it is customary to denote the sequence f by the symbol {xn}, or sometimes by x1, x 2 , x 3 , •••• The values of/, that is, the elements Xn , are called the terms of the sequence. If A is a set and if Xn e A for all n e J, then {xn} is said to be a sequence in A, or a sequence of elements of A. Note that the terms x1, x 2 , x 3 , ••• of a sequence need not be distinct. Since every countable set is the range of a 1-1 function defined on J, we may regard every countable set as the range of a sequence of distinct terms. Speaking more loosely, we may say that the elements of any countable set can be ''arranged in a sequence.\" Sometimes it is convenient to replace J in this definition by the set of all nonnegative integers, i.e., to start with O rather than with 1. 2.8 Theorem Every infinite subset of a countable set A is countable. Proof Suppose E c A, and E is infinite. Arrange the elements x of A in a sequence {xn} of distinct elements. Construct a sequence {nk} as follows: Let n1 be the smallest positive integer such that Xn, e E. Having chosen n1 , ... , nk-l (k = 2, 3, 4, ... ), let nk be the smallest integer greater than nk- i such that x,.k e E. Puttingf(k) = Xnk (k = 1, 2, 3, ... ), we obtain a 1-1 correspondence between E and J. The theorem shows that, roughly speaking, countable sets represent the ''smallest'' infinity: No uncountable set can be a subset of a countable set. 2.9 Definition Let A and n be sets, and suppose that with each element ix of A there is associated a subset of n which we denote by E«. BASIC TOPOLOGY 27 The set whose elements are the sets E 11 will be denoted by {E11}. Instead of speaking of sets of sets, we shall sometimes speak of a collection of sets, or a family of sets. The union of the sets E11 is defined to be the set S such that x e S if and only if x e E11 for at least one ex e A. We use the notation (I) S = LJ Eai, ll&A If A consists of the integers I, 2, ... , n, one usually writes n (2) S= LJ Em m•l or (3) If A is the set of all positive integers, the usual notation is (4) The symbol oo in ( 4) merely indicates that the union of a countable col- lection of sets is taken, and should not be confused with the symbols + oo, - oo, introduced in Definition 1.23. The intersection of the sets E11 is defined to be the set P such that x e P if and only if x e E11 for every ex e A. We use the notation (5) or n (6) P = n Em = E1 (\"I E2 (\"I • • • (\"I E,., m=l or (7) as for unions. If A (\"I B is not empty, we say that A and B intersect; otherwise they are disjoint. 2.10 Examples (a) Suppose E 1 consists of I, 2, 3 and E2 consists of 2, 3, 4. Then E 1 u E 2 consists of I, 2, 3, 4, whereas E1 (\"I E2 consists of 2, 3. 28 PRINCIPLES OF MATHEMATICAL ANALYSIS (b) Let A be the set of real numbers x such that O < x :s-; 1. For every x e A, let E:% be the set of real numbers y such that O < y < x. Then (i) (ii) (iii) E:% c Ez if and only if O < x :s': z :s': 1 ; LJ E:% = E1 ; :%EA n E:% is empty; :%EA (i) and (ii) are clear. To prove (iii), we note that for every y > 0, y ¢ E:% if X < y. Hence y ¢ n:%EA E:%. 2.11 Remarks Many properties of unions and intersections are quite similar to those of sums and products; in fact, the words sum and product were some- times used in this connection, and the symbols l: and TI were written in place of LJ and n. (8) (9) The commutative and· associative laws are trivial: AuB=BuA; An B = B n A. (A u B) u C = A u (B u C); (A n B) n C = A n (B n C). Thus the omission of parentheses in (3) and (6) is justified. The distributive law also holds: (10) A n (B u C) = (A n B) u (A n C). To prove this, let the left and right members of (10) be denoted by E and F, respectively. Suppose x e E. Then x e A and x e B u C, that is, x e B or x e C (pos- sibly both). Hence x e A n B or x e A n C, so that x e F. Thus E c F. Next, suppose x e F. Then x e An B or x e An C. That is, x e A, and x e B u C. Hence x e A n (B u C), so that F c E. It follows that E = F. We list a few more relations which are easily verified: (11) (12) AC Au B, An B c A. If O denotes the empty set, then (13) If A c: B, then (14) Au O =A, Au B =B, An O = 0. An B =A. BASIC TOPOLOGY 29 2.12 Theorem Let { En}, n = 1, ,7, 3, ... , be a sequence of countable sets, and put 00 (15) S = LJ En. n= 1 Then Sis countable. (16) (17) Proof Let every set En be a1·ranged in a sequence {xnk}, k = 1, 2, 3, ... , and consider the infinite array Xr1' • • • X24 • • • 31 X34 • • • X42 X43 X44 • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • in which the elements of En form the nth row. The array contains all elements of S. As indicated by the arrows, these elements can be arranged in a sequence If any two of the sets En have elements in common, these will appear more than once in (17). Hence there is a subset T of the set of all positive integers such that S ~ T, which shows that S is at most countable (Theorem 2.8). Since E 1 c S, and E 1 is infinite, S is infinite, and thus countable. Corollary Suppose A is at most countable, and, for every ex EA, Ba. is at most countable. Put T/1en Tis at most countable. For Tis equivalent to a subset of (15). 2.13 Theorem Let A be a countable set, and let Bn be the set of all n-tuples (a1 , •.• , an), where ak E A (k = 1, ... , ti), and the elements a 1 , ••• , an need not be distinct. Then Bn is countable. Proof That B1 is countable is evident, since B1 = A. Suppose Bn-t is countable (n = 2, 3, 4, ... ). The elements of Bn are of the form (18) (b,a) (bEBn-1,aEA). For every fixed b, the set of pairs (b, a) is equivalent to A, and hence countable. Thus Bn is the union of a countable set of countable sets. By Theorem 2.12, Bn is countable. The theorem follows by induction. 30 PRINCIPLES OF MATHEMATICAL ANALYSIS Corollary The set of all rational numbers is countable. Proof We apply Theorem 2.13, with n = 2, noting that every rational r is of the form bf a, where a and b are integers. The set of pairs (a, b), and therefore the set of fractions bf a, is countable. In fact, even the set of all algebraic numbers is countable (see Exer- cise 2). That not all infinite sets are, however, countable, is shown by the next theorem. 2.14 Theorem Let A be the set of all sequences whose elements are the digits 0 and 1. This set A is uncountable. The elements of A are sequences like 1, 0, 0, 1, 0, 1, 1, 1, .... Proof Let E be a countable subset of A, and let E consist of the se- quences s1 , s2 , s3 , •••• We construct a sequences as follows. If the nth digit in sn is 1, we let the nth digit of s be 0, and vice versa. Then the sequence s differs from every member of E in at least one place; hence s ¢ E. But clearly s EA, so that Eis a proper subset of A. We have shown that every countable subset of A is a proper subset of A. It follows that A is uncountable (for otherwise A would be a proper subset of A, which is absurd). The idea of the above proof was first used by Cantor, and is called Cantor's diagonal process; for, if the sequences s1 , s2 , s3 , ••• are placed in an array like (16), it is the elements on the diagonal which are involved in the construction of the new sequence. Readers who are familiar with the binary representation of the real numbers (base 2 instead of 10) will notice that Theorem 2.14 implies that the set of all real numbers is uncountable. We shall give a second proof of this fact in Theorem 2.43. METRIC SPACES 2.15 Definition A set X, whose elements we shall call points, is said to be a metric space if with any two points p and q of X there is associated a real number d(p, q), called the distance from p to q, such that (a) d(p, q) > 0 if p # q; d(p, p) = O; (b) d(p, q) = d(q, p); (c) d(p, q) ~ d(p, r) + d(r, q), for any re X. Any function with these three properties is called a distance function, or a metric. BASIC TOPOLOGY 31 2.16 Examples The most important examples of metric spaces, from our standpoint, are the euclidean spaces Rk, especially R 1 (the real line) and R2 (the complex plane); the distance in Rk is defined by (19) d(x, y) = Ix - y I By Theorem 1.37, the conditions of Definition 2.15 are satisfied by (19). It is important to observe that every subset Y of a metric space Xis a metric space in its own right, with the same distance function. For it is clear that if conditions (a) to (c) of Definition 2.15 hold for p, q, re X, they also hold if we restrict p, q, r to lie in Y. Thus every subset of a euclidean space is a metric space. Other examples are the spaces <G(K) and !R 2(µ), which are discussed in Chaps. 7 and 11, respec- tively. 2.17 Definition By the segment (a, b) we mean the set of all real numbers x such that a< x < b. By the interval [a, b] we mean the set of all real numbers x such that a~ x ~ b. Occasionally we shall also encounter ''half-open intervals'' [a, b) and (a, b]; the first consists of all x such that a ~ x < b, the second of all x such that a< x ~ b. If a;< b; for i =I, ... , k, the set of all points x = (x1 , ••• , xk) in Rk whose coordinates satisfy the inequalities a;~ X; ~ b; (I ~ i ~ k) is called a k-cell. Thus a I-cell is an interval, a 2-cell is a rectangle, etc. If x E Rk and r > 0, the open (or closed) ball B with center at x and radiu~ r is defined to be the set of ally E Rk such that jy - xi< r (or IY - xi:::; r). We call a set E c Rk convex if AX+ (I - A)Y EE whenever x e E, y e E, and O < A < I. For example, balls are convex. For if I y - x I < r, I z - x I < r, and 0 < A < I, we have I AY + (I - A)z - x I = I A(Y - x) + (1 - A)(z - x) I ~AI y - x I + (1 - A) I z - x I <Ar+ (1 - A)r -r - . The same proof applies to closed balls. It is also easy to see that k-cells are convex. 32 PRINCIPl,ES OF MATHEMATICAL ANALYSIS 2.18 Definition Let X be a metric space. All points and sets mentioned below are understood to be elements and subsets of X. (a) A neighborhood of p is a set N,(p) consisting of all q such that d(p, q) < r, for some r > 0, The number r is called the radius of N,(p). (b) A point p is a limit point of the set E if every neighborhood of p contains a point q ¥= p such that q e £. (c) If p e E and p is not a limit point of E, then p is called an isolated point of E. (d) Eis closed if every limit point of Eis a point of E. (e) A point p is an interior point of E if there is a neighborhood N of p such that N c: E. (f) E is open if every point of E is an interior point of E. (g) The complement of E (denoted by Ee) is the set of all points p e X such that p ¢ E. (h) E is perfect if E is closed and if every point of E is a limit point of E. (i) Eis bounded if there is a real number Mand a point q e X such that d(p, q) < M for all p e E. (j) E is dense in X if every point of X is a limit point of E, or a point of E (or both). Let us note that in R 1 neighborhoods are segments, whereas in R 2 neigh- borhoods are interiors of circles. 2.19 Theorem Every neighborhood is an open set. Proof Consider a neighborhood E = N,(p), and let q be any point of E. Then there is a positive real number h such that d(p, q) = r - h. For all points s such that d(q, s) < h, we have then d(p, s):::;; d(p, q) + d(q, s) < r - h + h = r, so that s e E. Thus q is an interior point of E. 2.20 Theorem If p is a limit point of a set E, then every neighborhood of p contains infinitely many points of E. Proof Suppose there is a neighborhood N of p which contains only a finite number of points of E. Let q1 , •.. , qn be those points of N n E, which are distinct from p, and put r = min d(p, qm) 1:Sm:Sn BASIC TOPOLOGY 33 [we use this notation to denote the smallest of the numbers d(p, q1), ••• , d(p, qn)J. The minimum of a finite set of positive numbers is clearly posi- tive, so that r > 0. The neighborhood Nr(P) contains no point q of E such that q ~ p, so that p is not a limit point of E. This contradiction establishes the theorem. Corollary A finite point set has no limit points. 2.21 Examples Let us consider the following subsets of R2 : (a) The set of all complex z such that I z I < 1. (b) The set of all complex z such that I z I s; I. (c) A nonempty finite set. (d) The set of all integers. (e) The set consisting of the numbers 1/n (n = 1, 2, 3, ... ). Let us note that this set E has a limit point (namely, z = 0) but that no point of E is a limit point of E; we wish to stress the difference between having a limit point and containing one. (f) The set of all complex numbers (that is, R2). (g) The segment (a, b). Let us note that (d), (e), (g) can be regarded also as subsets of R1 • Some properties of these sets are tabulated below: Closed Open Perfect Bounded (a) No Yes No Yes (b) Yes No Yes Yes (c) Yes No No Yes (d) Yes No No No (e) No No No Yes (f) Yes Yes Yes No (g) No No Yes In (g), we left the second entry blank. The reason is that the segment (a, b) is not open ifwe regard it as a subset of R2, but it is an open subset of R1• 2.22 'I'heorem Let { E.} be a (finite or infinite) collection of sets E. . Then (20) Proof Let A and B be the left and right members of (20). If x e A, then X ¢ u. E.' hence X ' E. for any IX, hence Xe E: for every IX, so that X en E!. Thus Ac: B. 34 PRINCIPLES OF MATHEMATICAL ANALYSIS Conversely, if x e B, then x e E! for every IX, hence x ¢Ea.for any IX, hence x ¢ U. E., so that x e ( U11 E.)c. Thus B c A. It follows that A = B. 2.23 Theorem A set E is open if and only if its complement is closed. Proof First, suppose Ee is closed. Choose x e E. Then x ¢ Ee, and xis not a limit point of Ee. Hence there exists a neighborhood N of x such that Ee r. N is empty, that is, N c E. Thus x is an interior point of E, and E is open. Next, suppose E is open. Let x be a limit point of Ee. Then every neighborhood of x contains a point of Ee, so that x is not an interior point of E. Since E is open, this means that x e Ee. It follows that Ee is closed. Corollary A set Fis closed if and only if its complement is open. 2.24 Theorem (21) (a) For any collection {G.} of open sets, U. G. is open. (b) For any collection {F.} of closed sets, n. F. is closed. (c) For any finite collection G1, ••• , Gn of open sets, ni= 1 Gi is open. (d) For any finite collection F1, ••• , Fn of closed sets, Ui = 1 F, is closed. Proof Put G = U. G.. If x e G, then x e G. for some IX. Since x is an interior point of G., x is also an interior point of G, and G is open. This proves (a). By Theorem 2.22, and F! is open, by Theorem 2.23. Hence (a) implies that (21) is open so that n/A F. is closed. Next, put H = n;= 1 G,. For any x e H, there exist neighborhoods N, of x, with radii r,, such that N, c G, (i = 1, ... , n). Put r = min (r1, ••. , rn), and let N be the neighborhood of x of radius r. Then N c G, for i = 1, ... , n, so that N c H, and His open. By taking complements, (d) follows from (c): BASIC TOPOLOGY 35 2.25 Examples In parts (c) and (d) of the preceding theorem, the finiteness of the collections is essential. For let Gn be the segment - ! , ! (n = 1, 2, 3, ... ). n n Then Gn is an open subset of R 1• Put G = ():-'= 1 Gn. Then G consists of a single point (namely, x = 0) and is therefore not an open subset of R 1 • Thus the intersection of an infinite collection of open sets need not be open. Similarly, the union of an infinite collection of closed sets need not be closed. 2.26 Definition If X is a metric space, if E c: X, and if E' denotes the set of all limit points of E in X, then the closure of E is the set E = E u E'. 2.27 Theorem If Xis a metric space and E c: X, then (a) Eis closed, (b) E = E if and only if Eis closed, (c) E c: F for every closed set F c: X such that E c: F. By (a) and (c), E Is the smallest closed subset of X that contains E. Proof (a) If p e X and p ¢ E then p is neither a point of E nor a limit point of E. Hence p has a neighborhood which does not intersect E. The complement of E is the ref ore open. Hence E is closed. (b) If E = E, (a) implies that Eis closed. If Eis closed, then E' c: E [by Definitions 2.18(d) and 2.26], hence E = E. ( c) If F is closed and F =:J E, then F =:J F', hence F =:J E'. Thus F =:J E. 2.28 Theorem Let Ebe a nonempty set of real numbers which is bounded above. Let y = sup E. Then y e E. Hence y e E if Eis closed. Compare this with the examples in Sec. 1.9. Proof If y e E then y e E. Assume y ¢ E. For every h > 0 there exists then a point x e E such that y - h < x < y, for otherwise y - h would be an upper bound of E. Thus y is a limit point of E. Hence ye E. 2.29 Remark Suppose E c Y c: X, where Xis a metric space. To say that E is an open subset of X means that to each point p e E there is associated a positive number r such that the conditions d(p, q) < r, q e X imply that q e E. But we have already observed (Sec. 2.16) that Y is also a metric space, so that our definitions may equally well be made within Y. To be quite explicit, let us say that E is open relative to Y if to each p e E there is associated an r > 0 such that q e E whenever d(p, q) < r and q e Y. Example 2.21(g) showed that a set 36 PRINCIPLES OF MATHEMATICAL ANALYSIS may be open relative to Y without being an open subset of X. However, there is a simple relation between these concepts, which we now state. 2.30 Theorem Suppose Y c: X. A subset E of Y is open relative to Y if and only if E = Y n G for some open subset G of X. Proof Suppose Eis open relative to Y. To each p e E there is a positive number r P such that the conditions d(p, q) < r P, q e Y imply that q e E. Let VP be the set of all q e X such that d(p, q) < rP, and define G = u VP. peE Then G is an open subset of X, by Theorems 2.19 and 2.24. Since p e VP for all p e E, it is clear that E c: G n Y. By our choice of VP, we have VP n Y c: E for every p e E, so that G n Y c: E. Thus E = G n Y, and one half of the theorem is proved. Conversely, if G is open in X and E = G n Y, every p e E has a neighborhood VP c: G. Then VP n Y c: E, so that Eis open relative to Y. COMPACT SETS 2.31 Definition By an open cover of a set E in a metric space X we mean a collection {G11} of open subsets of X such that E c: U11 Ga.. 2.32 Definition A subset K of a metric space X is said to be compact if every open cover of K contains a finite subcover. More explicitly, the requirement is that if { G11} is an open cover of K, then there are finitely many indices oc1 , ••• , °'\" such that Kc:G u···uG «1 IZn \" The notion of compactness is of great importance in analysis, especially in connection with continuity (Chap. 4). It is clear that every finite set is compact. The existence of a large class of infinite compact sets in Rk will follow from Theorem 2.41. We observed earlier (in Sec. 2.29) that if E c: Y c: X, then E may be open relative to Y without being open relative to X. The property of being open thus depends on the space in which E is embedded. The same is true of the property of being closed. Compactness, however, behaves better, as we shall now see. To formu- late the next theorem, let us say, temporarily, that K is compact relative to X if the requirements of Definition 2.32 are met. BASIC TOPOLOGY 37 2.33 Theorem Suppose K c Y c X. Then K is compact relative to X if and only if K is compact relative to Y. By virtue of this theorem we are able, in many situations, to regard com- pact sets as metric spaces in their own right, without paying any attention to any embedding space. In particular, althot1gh it makes little sense to talk of open spaces, or of closed spaces (every metric space Xis an open subset of itself, and is a closed subset of itself), it does make sense to talk of compact metric spaces. (22) (23) Proof Suppose K is compact relative to X, and let { Va} be a collection of sets, open relative to Y, such that Kc U« Va. By theorem 2.30, there are sets Ga, open relative to X, such that Va = Y n G «, for all (X; and since K is compact relative to X, we have for some implies KC Ga1 U • · • U G«n choice of finitely many indices ct1 , ••. , (Xn. Since Kc Y, (22) K C Va, U • • • U Van• This proves that K is compact relative to Y. Conversely, suppose K is compact relative to Y, let { Ga} be a col- lection of open subsets of X which covers K, and put Va = Y n Ga. Then (23) will hold for some choice of ct 1 , ... , (Xn; and since Va c Ga, (23) implies (22). This completes the proof. 2.34 Theorem Compact si,bset.fi of metric spaces are closed. Proof Let K be a compact subset of a metric space X. We shall prove that the complement of K is an open subset of X. Suppose p E X, p ¢ K. If q E K, let Vq and Wq be neighborhoods of p and q, respectively, of radius less than }d(p, q) [see Definition 2.18(a)]. Since K is compact, there are finitely many points q1 , ••. , qn in K such that K C wq1 U \" \" \" U Wqn = w. If V = Vq 1 n · · · n Vq\", then Vis a neighborhood of p which does not intersect W. Hence V c Kc, so that p is an interior point of Kc. The theorem follows. 2.35 Theorem Closed subsets of compact sets are compact. Proof Suppose F c Kc X, Fis closed (relative to X), and K is compact. Let { Va} be an open cover of F. If pc is adjoined to { Va}, we obtain an 38 PRINCIPLES OF MATHEMATICAL ANALYSIS open cover n of K. Since K is compact, there is a finite subcollection Cl> of n which covers K, and hence F. If pc is a member of Cl>, we may remove it from Cl> and still retain an open cover of F. We have thus shown that a finite subcollection of { Voi} covers F. Corollary If Fis closed and K is compact, then F n K is compact. Proof Theorems 2.24(b) and 2.34 show that F n K is closed; since F n Kc: K, Theorem 2.35 shows that F n K is compact. 2.36 Theorem If { Ka} is a collection of compact subsets of a metric space X such that the intersection of every finite subcollection of {Ka} is nonempty, then n Ka is nonempty. Proof Fix a member Ki of {K.} and put G. = K!. Assume that no point of K1 belongs to every .K •. Then the sets G. form an open cover of Ki; and since Ki is compact, there are finitely many indices (X1 , ••• , (Xn such that K1 c: G. 1 u · · · u G.n. But this means that K 1 n K. 1 n · · · n Koin is empty, in contradiction to our hypothesis. Corollary If {Kn} is a sequence of nonempty compact sets such that Kn => Kn+ 1 (n = 1, 2, 3 •... ), then ni Kn is not empty. 2.37 Theorem If E is an infinite subset of a compact set K, then E has a limit point in K. Proof If no point of K were a limit point of E, then each q e K would have a neighborhood Vq which contains at most one point of E (namely, q, if q e E). It is clear that no finite subcollection of {Vq} can cover E; and the same is true of K, since E c: K. This contradicts the compactness of K. 2.38 Theorem If {In} is a sequence of intervals in R1 , such that In=> In+t (n = 1, 2, 3, ... ), then ni In is not empty. Proof If In = [an, bn], let E be the set of all an. Then E is nonempty and bounded above (by b1). Let x be the sup of E. If m and n are positive integers, then an ::5: am+n ::5: bm+n ::5:bm, so that x ::5: bm for each m. Since it is obvious that am ::5: x, we see that x e Im form = l, 2, 3, .... BASIC TOPOLOGY 39 2.39 Theorem Let k be a positive integer. If {In} is a sequence of k-cells such that In=> In+ 1(n = I, 2, 3, ... ), then n;_io In is not empty. Proof Let In consist of all points x = (x1, •.. , xk) such that an,}~ X1 ~ bn,J (I ~j ~ k; n = I, 2, 3, ... ), and put In,J = [an,J, bn,1]. For each j, the sequence {In,J} satisfies the hypotheses of Theorem 2.38. Hence there are real numbers xj(l ~j ~ k) such that an,J ~xj ~ bn,J (1 ~j ~ k; n = 1, 2, 3, ... ). Setting x* = (x!, ... , xt), we see that x* e In for n = I, 2, 3, . . . . The theorem follows. 2.40 Theorem Every k-cell is compact. Proof Let I be a k-cell, consisting of all points x = (x1 , ..• , xk) such that a1 ~x1 ~ b1 (1 ~j ~ k). Put 1/2 • Then I x - y I ~ b, if x e /, y e I. Suppose, to get a contradiction, that there exists an open cover {Ga} of I which contains no finite subcover of /. Put c1 = (a1 + b1)(2. The intervals [a1 , c1] and [c1 , b1] then determine 2k k-cells Qi whose union is I. At least one of these sets Qi, call it / 1 , cannot be covered by any finite subcollection of {Ga} (otherwise I could be so covered). We next subdivide I1 and continue the process. We obtain a sequence {In} with the following properties: (a) I=> 11 => 12 => /3 => · • • ; (b) In is not covered by any finite subcollection of {Ga}; (c) ifxe/nandye/n, then lx-yl ~2-nb. By (a) and Theorem 2.39, there is a point x* which lies in every In. For some tx, x* e Ga. Since Ga is open, there exists r > 0 such that I y - x* I < r implies that ye Ga. If n is so large that 2-nb < r (there is such an n, for otherwise 2n ~ b/r for all positive integers n, which is absurd since R is archimedean), then ( c) implies that In c Ga, which con- tradicts (b). This completes the proof. The equivalence of (a) and (b) in the next theorem is known as the Heine- Borel theorem. 40 PRINCIPLES OF MATHEMATICAL ANALYSIS 2.41 Theorem If a set E in Rk has one of the following three properties, then it has the other two: (a) Eis closed and bounded. (b) Eis compact. (c) Every infinite subset of E has a limit point in E. Proof If (a) holds, then E c / for some k-cell /, and (b) follows from Theorems 2.40 and 2.35. Theorem 2.37 shows that (b) implies (c). It remains to be shown that (c) implies (a). If E is not bounded, then E contains points Xn with (n = 1, 2, 3, ... ). The set S consisting of these points xn is infinite and clearly has no limit point in Rk, hence has none in E. Thus (c) implies that Eis bounded. If E is not closed, then there is a point x 0 e Rk which is a limit point of E but not a point of E. For n = 1, 2, 3, ... , there are points xn e E such that I xn - x 0 I < 1/n. Let S be the set of these points xn. Then Sis infinite ( otherwise I xn - x 0 I would have a constant positive value, for infinitely many n), S has x0 as a limit point, and S has no other limit point in Rk. For if ye Rk, y \"::/: x0 , then I Xn - Y I ~ I Xo - Y I - I Xn - Xo I 1 1 ~ I Xo - YI - ~ ~ 2 I Xo - Y I for all but finitely many n; this shows that y is not a limit point of S (Theorem 2.20). Thus S has no limit point in E; hence E must be closed if (c) holds. We should remark, at this point, that (b) and (c) are equivalent in any metric space (Exercise 26) but that (a) does not, in general, imply (b) and (c). Examples are furnished by Exercise 16 and by the space !t' 2 , which is dis- cussed in Chap. 11. 2.42 Theorem (Weierstrass) Every bounded infinite subset of Rk has a limit point in Rk. Proof Being bounded, the set E in question is a subset of a k-cell / c Rk. By Theorem 2.40, / is compact, and so E has a limit point in I, by Theorem 2.37. BASIC TOPOLOGY 41 PERFECT SETS 2.43 Theorem Let P be a nonempty perfect set in Rk. Then Pis uncountable. Proof Since P has limit points, P must be infinite. Suppose P is count- able, and denote the points of P by x1 , x2 , x 3 , .•.. We shall construct a sequence { Vn} of neighborhoods, as follows. Let V1 be any neighborhood of x 1 • If V1 consists of all y e Rk such that I y - x1 I < r, the closure V1 of V1 is the set of all ye Rk such that IY-X1I ~r. Suppose Vn has been constructed, so that Vn n Pis not empty. Since every point of Pis a limit point of P, there is a neighborhood Vn+i such that (i) Yn + 1 C: vn , ( ii) Xn ¢ Yn + 1, (iii) Vn + 1 n p is not empty. By (iii), Vn+i satisfies our induction hypothesis, and the construction can proceed. Put Kn = Yn n P. Since Yn is closed and bounded, Yn is compact. Since Xn ¢ Kn+l, no point of plies in n'? Kn. Since Kn C: P, this implies that nf Kn is empty. But each Kn is nonempty, by (iii), and Kn=> Kn+t, by (i); this contradicts the Corollary to Theorem 2.36. Corollary Every interval [a, b] (a < b) is uncountable. In particular, the set of all real numbers is uncountable. 2.44 The Cantor set The set which we are now going to construct shows that there exist perfect sets in R 1 which contain no segment. Let E0 be the interval [O, l]. Remove the segment (½, f), and let E 1 be the union of the intervals [O, t] [t, 1 ]. Remove the middle thirds of these intervals, and let E2 be the union of the intervals [0, ½], [¾, ¾], [t, ¾], [!, 1]. Continuing in this way, we obtain a sequence of compact sets En, such that (a) E1 => E2 => E3 => ••• ; (b) En is the union of 2n intervals, each of length 3-n. The set 00 P= n En n= 1 is called the Cantor set. Pis clearly compact, and Theorem 2.36 shows that P is not empty. 42 PRINCIPLES OF MATHEMATICAL ANALYSIS No segment of the form (24) ' where k and m are positive integers, has a point in common with P. Since every segment (ix, /3) contains a segment of the form (24), if P contains no segment. 3-m f3 - IX < 6 ' To show that Pis perfect, it is enough to show that P contains no isolated point. Let x e P, and let S be any segment containing x. Let In be that interval of En which contains x. Choose n large enough, so that In c S. Let Xn be an endpoint of In, such that Xn :#: x. It follows from the construction of P that Xn e P. Hence xis a limit point of P, and P is perfect. One of the most interesting properties of the Cantor set is that it provides us with an example of an uncountable set of measure zero (the concept of measure will be discussed in Chap. 11). CONNECTED SETS 2.45 Definition Two subsets A and B of a metric space X are said to be separated if both A n Band An Bare empty, i.e., if no point of A lies in the closure of Band no point of B lies in the closure of A. A set E c X is said to be connected if E is not a union of two nonempty separated sets. 2.46 Remark Separated sets are of course disjoint, but disjoint sets need not be separated. For example, the interval [O, 1] and the segment (1, 2) are not separated, since 1 is a limit point of (1, 2). However, the segments (0, 1) and (1, 2) are separated. The connected subsets of the line have a particularly simple structure: 2.47 Theorem A subset E of the real line R1 is connected if and only if it has the following property: If x e £,ye£, and x < z < y, then z e £. I Proof If there exist x e £,ye£, and some z e (x, y) such that z ¢ E, then E = A:z u B:z where A:z =En (-oo, z), B:z =En (z, oo). BASIC TOPOLOGY 43 Since x e Az and ye Bz, A and Bare nonempty. Since Az c: (- oo, z) and Bz c: (z, oo ), they are separated. Hence E is not connected. To prove the converse, suppose Eis not connected. Then there are nonempty separated sets A and B such that A u B = E. Pick x e A, y e B, and assume (without loss of generality) that x < y. Define z = sup (A n [x, y]). By Theorem 2.28, z e A; hence z ¢ B. In particular, x ~ z < y. If z ¢ A, it follows that x < z < y and z ¢ E. If z e A, then z ¢ B, hence there exists z1 such that z < z1 < y and z1 ¢ B. Then x < z1 < y and z1 ¢ E. EXERCISES 1. Prove that the empty set is a subset of every set. 2. A complex number z is said to be algebraic if there are integers ao, ... , an, not all zero, such that ao z\" + a1zn-l + ''' + an-1Z + an = 0. Prove that the set of all algebraic numbers is countable. Hint: For every positive integer N there are only finitely many equations with n+ laol + la1I + ···+ lanl =N. 3. Prove that there exist real numbers which are not algebraic. 4. Is the set of all irrational real numbers countable? S. Construct a bounded set of real numbers with exactly three limit points. 6. Let E' be the set of all limit points of a set E. Prove that E' is closed. Prove that E and E have the same limit points. (Recall that E = Eu E'.) Do E and E' always have the same limit points? 7. Let A1, A2, A3, ... be subsets of a metric space. (a) If Bn = Ur .. 1 A,, prove that Bn = Ur .. 1 A,, for n = 1, 2, 3, .... (b) If B = U? .. 1 A,, prove that .ii~ U? .. 1 A,. Show, by an example, that this inclusion can be proper. 8. Is every point of every open set E c R2 a limit point of E? Answer the same question for closed sets in R2 • 9. Let £ 0 denote the set of all interior points of a set E. [See Definition 2.18(e); E 0 is called the interior of£.] (a) Prove that £ 0 is always open. (b) Prove that Eis open if and only if E 0 = E. (c) If G c E and G is open, prove that G c £ 0 • (d) Prove that the complement of E 0 is the closure of the complement of E. (e) Do E and E always have the same interiors? (/) Do E and E 0 always have the same closures? 44 PRINCIPLES OF MATHEMATICAL ANALYSIS 10. Let X be an infinite set. For p e X and q e X, define 1 d(p,q) = 0 (if p ¢ q) (if p = q). Prove that this is a metric. Which subsets of the resulting metric space are open? Which are closed? Which are compact? 11. For x e R1 and ye R1, define d1(x, y) = (x - y) 2 , d2(X, y) = VIX - YI, d3(X, y) = I x 2 - y 2 I, d4(X, y) = Ix - 2yj, lx-yl ds(x, y) = 1 + Ix - y I . Determine. for each of these, whether it is a metric or not. 12. Let Kc. R1 consist of O and the numbers 1/n, for n = 1, 2, 3, .... Prove that K is compact directly from the definition (without using the Heine-Borel theorem). 13. Construct a compact set of real numbers whose limit points form a countable set. 14. Give an example of an open cover of the segment (0, 1) which has no finite sub- cover. 15. Show that Theorem 2.36 and its Corollary become false (in R 1, for example) if the word ''compact'' is replaced by ''closed'' or by ''bounded.\" 16. Regard Q, the set of alt rational numbers, as a metric space, with d(p, q) = Ip - q I, Let E be the set of all p e Q such that 2 < p 2 < 3. Show that E is closed and bounded in Q, but that Eis not compact. Is E open in Q? 17. Let Ebe the set of all x e [O, 1] whose decimal expansion contains only the digits 4 and 7. Is E countable? Is E dense in [0, 1]? Is E compact? Is E perfect? 18. Is there a nonempty perfect set in R 1 which contains no rational number? 19. (a) If A and B are disjoint closed sets in some metric space X, prove that they are separated. (b) Prove the same for disjoint open sets. (c) Fix p e X, S > 0, define A to be the set of all q e X for which d(p, q) < S, define B similarly, with > in place of <. Prove that A and Bare separated. (d) Prove that every connected metric space with at least two points is uncount- able. Hint: Use (c). 20. Are closures and interiors of connected sets always connected? (Look at subsets of R 2 .) 21. Let A and B be separated subsets of some Rt, suppose a e A, be B, and define p(t) = (1 - t)a + tb forte R 1 • Put Ao= p- 1(A), Bo= p- 1(B). [Thus t e Ao if and only if p(t) e A.] (a) Prove that Ao and Bo are separated subsets of R1 • (b) Prove that there exists to E (0, 1) such that p(to) <t A u B. (c) Prove that every convex subset of Rk is connected. BASIC TOPOLOGY 45 22. A metric space is called separable if it contains a countable dense subset. Show that Rk is separable. Hint: Consider the set of points which have only rational coordinates. 23. A collection { Va} of open subsets of X is said to be a base for X if the following is true: For every x e X and every open set G c X such that x E G, we have x e Va c G for some oc. In other words, every open set in X is the union of a subcollection of { Va}, Prove that every separable metric space has a countable base. Hint: Take all neighborhoods with rational radius and center in some countable dense subset of X. 24. Let X be a metric space in which every infinite subset has a limit point. Prove that Xis separable. Hint: Fix S > 0, and pick X1 EX. Having chosen x1, ••• , x 1 EX, choose x1 + 1 EX, if possible, so that d(x,, x1+1)> S for i = 1, ... ,j. Show that this process must stop after a finite number of steps, and that X can therefore be covered by finitely many neighborhoods of radius S. Take S = 1/n (n = 1, 2, 3, ... ), and consider the centers of the corresponding neighborhoods. 25. Prove that every compact metric space K has a countable base, and that K is therefore separable. Hint: For every positive integer n, there are finitely many neighborhoods of radius 1/n whose union covers K. 26. Let X be a metric space in which every infinite subset has a limit point. Prove that Xis compact. Hint: By Exercises 23 and 24, X has a countable base. It follows that every open cover of X has a countable subcover {Gn}, n = l, 2, 3, .... If no finite subcollection of {Gn} covers X, then the complement Fn of G1 u · · · u Gn is nonempty for each n, but n Fn is empty. If Eis a set which contains a point from each Fn, consider a limit point of E, and obtain a contradiction. 27. Define a point p in a metric space X to be a condensation point of a set E c X if every neighborhood of p contains uncountably many points of E. Suppose E c Rk, E is uncountable, and let P be the set of all condensation points of E. Prove that P is perfect and that at most countably many points of E are not in P. In other words, show that pc 11 Eis at most countable. Hint: Let {Vn} be a countable base of Rk, let W be the union of those Vn for which E 11 Vn is at most countable, and show that P = we. 28. Prove that every closed set in a separable metric space is the union of a (possibly empty) perfect set and a set which is at most countable. (Corollary: Every count- able closed set in Rk has isolated points.) Hint: Use Exercise 27. 29. Prove that every open set in R 1 is the union of an at most countable collection of disjoint segments. Hint: Use Exercise 22. 46 PRINCIPLES OF MATHEMATICAL ANALYSIS 30. Imitate the proof of Theorem 2.43 to obtain the following result: If Rk = U f Fn, where each Fn is a closed subset of Rk, then at least one Fn has a nonempty interior. Equivalent statement: If Gn is a dense open subset of Rk, for n = 1, 2, 3, ... , then nron is not empty (in fact, it is dense in R\"). (This is a special case of Baire's theorem; see Exercise 22, Chap. 3, for the general case.) NUMERICAL SEQUENCES AND SERIES As the title indicates, this chapter will deal primarily with sequences and series of complex numbers. The basic facts about convergence, however, are just as easily explained in a more general setting. The first three sections will the ref ore be concerned with sequences in euclidean spaces, or even in metric spaces. CONVERGENT SEQUENCES 3.1 Definition A sequence {Pn} in a metric space Xis said to converge if there is a point p e X with the following property: For every B > 0 there is an integer N such that n ~ N implies that d(pn, p) < e. (Here d denotes the distance in X.) In this case we also say that {Pn} converges to p, or that p is the limit of {Pn} [see Theorem 3.2(b)], and we write Pn ➔ p, or lim Pn = p. n ➔ oo If {Pn} does not converge, it is said to diverge. 48 PRINCIPLES OF MATHEMATICAL ANALYSIS It might be well to point out that our definition of ''convergent sequence'' depends not only on {Pn} but also on X; for instance, the sequence {1/n} con- verges in R 1 (to 0), but fails to converge in the set of all positive real numbers [with d(x, y) = Ix - y I]. In cases of possible ambiguity, we can be more precise and specify ''convergent in X'' rather than ''convergent.\" We recall that the set of all points Pn (n = 1, 2, 3, ... ) is the range of {Pn}. The range of a sequence may be a finite set, or it may be infinite. The sequence {p n} is said to be bounded if its range is bounded. As examples, consider the following sequences of complex numbers (that is, X = R 2 ): (a) If sn = 1/n, then limn-+oo sn = O; the range is infinite, and the sequence is bounded. (b) If sn = n2 , the sequence {sn} is unbounded, is divergent, and has infinite range. (c) If sn = 1 + [( - l)n/n], the sequence {sn} converges to I, is bounded, and has infinite range. (d) If sn = in, the sequence {sn} is divergent, is bounded, and has finite range. (e) If sn = 1 (n = 1, 2, 3, ... ), then {sn} converges to 1, is bounded, and • has finite range. We now summarize some important properties of convergent sequences in metric spaces. 3.2 Theorem Let {p n} be a sequence in a metric space X. (a) {Pn} converges to p e X if and only if every neighborhood o.f p contains Pn for all but finitely many n. (b) If p e X, p' e X, and if {Pn} converges top and top', then p' = p. (c) If {Pn} converges, then {Pn} is bounded. (d) If E c X and if p is a limit point of E, then there is a sequence {Pn} in E such that p = lim Pn . n-+ oo Proof (a) Suppose Pn ➔ p and let V be a neighborhood of p. For some e > 0, the conditions d(q, p) < e, q e X imply q e V. Correspond- ing to this e, there exists N such that n ~ N implies d(p n, p) < e. Thus n ~ N implies Pn E V. Conversely, suppose every neighborhood of p contains all but finitely many of the Pn. Fix e > 0, and let V be the set of all q e X such that d(p, q) < e. By assumption, there exists N (corresponding to this V) such that Pn E V if n ~ N. Thus d(pn, p) < e if n ~ N; hence Pn > p. NUMERICAL SEQUENCES AND SERIES 49 (b) Let e > 0 be given. There exist integers N, N' such that n~N implies n ~ N' implies Hence if n ~ max (N, N'), we have d(p, p') ~ d(p, Pn) + d(pn, p') < e. Since e was arbitrary, we conclude that d(p, p') = 0. (c) Suppose Pn • p. There is an integer N such that n > N implies d(pn, p) < 1. Put r = max {l, d(p1 , p), ... , d(pN, p)}. Then d(pn,P) ~ r for n = 1, 2, 3, .... (d) For each positive integer n, there is a point Pn e E such that d(pn, p) < 1/n. Given e > 0, choose N so that Ne> 1. If n > N, it follows that d(pn, p) < e. Hence Pn > p. This completes the proof. For sequences in Rk we can study the relation between convergence, on the one hand, and the algebraic operations on the other. We first consider sequences of complex numbers. 3.3 Theorem Suppose {sn}, {tn} are complex sequences, and limn➔oo Sn = s, limn➔ 00 tn = t. Then (a) lim (sn + tn) = s + t; n ➔ oo (b) lim csn = cs, lim ( c + sn) = c + s, for any number c; n ➔ oo n ➔ oo (c) lim Sntn = st; n ➔ oo (d) . 1 1 . l1m - = - , provided sn =I= 0 (n = 1, 2, 3, ... ), and s =I= 0. n➔ oo Sn S Proof (a) Given e > 0, there exist integers N 1 , N 2 such that n ~ N 1 implies n ~ N 2 implies • 50 PRINCIPLES OF MATHEMATICAL ANALYSIS (1) If N = max (N1 , N 2), then n ~ N implies I (sn + tn) - (s + t) I ~ I Sn - SI + I tn - t I < B. This proves (a). The proof of (b) is trivial. (c) We use the identity Sntn - st = (sn - s)(tn - t) + s(tn - t) + t(sn - s). Given e > 0, there are integers N 1 , N 2 such that n ~ N 1 implies lsn - sl < J;, n ~ N 2 implies I tn - ti < J;. If we take N = max (N1 , N 2 ), n ~ N implies I (sn - s)(tn - t)I < B, so that lim (sn - s)(tn - t) = 0. n ➔ oo We now apply (a) and (b) to (1), and conclude that lim (sntn - st)= 0. n ➔ oo (d) Choosing m such that I sn - s I < ½Is I if n ~ m, we see that (n ~ m). Given e > 0, there is an integer N > m such that n ~ N implies I Sn - SI < ! IS I 2 B. Hence, for n ~ N, 1 1 --- = s - s n 2 < IS I 2 \\ Sn - SI < B. 3.4 Theorem (a) Suppose Xn e Rk (n = 1, 2, 3, ... ) and Then { xn} converges to x = ( cc1 , •.• , eek) if and only if (2) lim IX1,n = (1.J (1 ~j ~ k). n ➔ oo NUMERICAL SEQUENCES AND SERIES 51 (b) Suppose {x,,}, {Yn} are sequences in Rk, {Pn} is a sequence of real numbers, and Xn ➔ x, Yn > y, Pn ➔ p. Then lim (Xn + Yn) = X + Y, lim Xn • Yn = X. y, lim Pn Xn = f3x. n ➔ oo n ➔ oo n ➔ oo Proof (a) If Xn ➔ x, the inequalities l°'J,n -· °'JI S lxn - xi, which follow immediately from the definition of the norm in Rk, show that (2) holds. Conversely, if (2) holds, then to each e > 0 there corresponds an integer N such that n ~ N implies (1 Sj S k). Hence n ~ N implies k 1/2 lxn - xi = L l°'J,n - °'112 < B, J=l so that Xn > x. This proves (a). Part (b) follows from (a) and Theorem 3.3. SUBSEQUENCES 3.S Definition Given a sequence {pn}, consider a sequence {nk} of positive integers, such that n1 < n2 < n3 < · · · . Then the sequence {Pn,} is called a subsequence of {Pn}. If {Pn,} converges, its limit is called a subsequential limit of {Pn}. It is clear that {Pn} converges to p if and only if every subsequence of {Pn} converges top. We leave the details of the proof to the reader. 3.6 Theorem (a) If {Pn} is a sequence in a compact metric space X, then some sub- sequence of {Pn} converges to a point of X. (b) Every bounded sequence in Rk contains a convergent subsequence. 52 PRINCIPLES OF MATHEMATICAL ANALYSIS Proof (a) Let Ebe the range of {Pn}. If Eis finite then there is ape E and a sequence {n1} with n1 < n2 < n3 < · · ·, such that P -p -···-p n, - na - - • The subsequence {Pn1} so obtained converges evidently to p. If E is infinite, Theorem 2.37 shows that E has a limit point p e X. Choose n1 so that d(P,Pn 1 ) < 1. Having chosen n1, ••• , n1_ 1, we see from Theorem 2.20 that there is an integer n1 > n1_ 1 such that d(P,Pn,) < 1/i. Then {Pn,} converges top. (b) This follows from (a), since Theorem 2.41 implies that every bounded subset of Rk lies in a compact subset of Rk. 3.7 Theorem The subsequential limits of a sequence {Pn} in a metric space X form a closed subset of X. Proof Let E* be the set of all subsequential limits of {Pn} and let q be a limit point of E*. We have to show that q e E*. Choose n1 so that Pn1 =I= q. (If no such n1 exists, then E* has only one point, and there is nothing to prove.) Put ~ = d(q, Pn1 ). Suppose n1 , ••• , n1_ 1 are chosen. Since q is a limit point of E*, there is an x e E* with d(x, q) < 2- 1 ~. Since x e E*, there is an n1 > n1_ 1 such that d(x,Pn,) < 2- 1 ~. Thus d(q, Pn,) ~ 21-1~ for i = 1, 2, 3, . . . . This says that {Pn,} converges to q. Hence q e E*. CAUCHY SEQUENCES 3.8 Definition A sequence {pn} in a metric space X is said to be a Cauchy sequence if for every s > 0 there is an integer N such that d(pn , Pm) < e if n ~ N and m ~N. In our discussion of Cauchy sequences, as well as in other situations which will arise later, the following geometric concept will be useful. 3.9 Definition Let E be a nonempty subset of a metric space X, and let S be - - - the set of all real numbers of the form 1d(p, q), with .p e E and q e E. The sup of S is called the diameter of E. NUMERICAL SEQUENCES AND SERIES 53 If{pn} is a sequence in X and if EN consists of the points PN, PN+ 1,PN+ 2 , ••• , it is clear from the two preceding definitions that {Pn} is a Cauc/1y sequence if and only if lim diam EN= 0. N-+oo 3.10 Theorem (a) If E is the closure of a set E in a metric space X, then diam E = diam E. (b) If Kn is a sequence of compact sets in X such that Kn::::, Kn+i (n = 1, 2, 3, ... ) and if lim diam Kn= 0, n ➔ oo then n '? Kn consists of exactly one point. Proof (a) Since E c E, it is clear that diam E::; diam E. Fix a > 0, and choose p E E, q E £. By the definition of E, there are points p', q', in E such that d(p, p') < s, d(q, q') < B. Hence d(p, q) ::; d(p, p') + d(p' q') + d(q', q) < 2s + d(p', q') ~ 2s -+ diam E. It follows that diam E ~ 2s + diam E, and since e was arbitrary, (a) is proved. (b) Put K = n '?Kn. By Theorem 2.36, K is not empty. If K contains more than one point, then diam K > 0. But for each n, Kn ::::, K, so that diam Kn ~ diam K. This contradicts the assumption that diam Kn ---+ 0. 3.11 Theorem (a) In any metric space X, every convergent sequence is a Cauchy sequence. (b) If Xis a compact metric space and if {Pn} is a Cauchy sequence in X, then {pn} converges to some point of X. (c) In Rk, every Cauchy sequence converges. Note: The difference between the definition of convergence and the definition of a Cauchy sequence is that the limit is explicitly involved in the former, but not in the latter. Thus Theorem 3.11 (b) may enable us 54 PRINCIPLES OF MATHEMATICAL ANALYSIS (3) to decide whether or not a given sequence converges without knowledge of the limit to which it may converge. The fact (contained in Theorem 3.11) that a sequence converges in Rk if and only if it is a Cauchy sequence is usually called the Cauchy criterion for convergence. Proof (a) If Pn ➔ p and if e > 0, there is an integer N such that d(p, Pn) < e for all n ~ N. Hence d(pn, p,,.) ~ d(pn, p) + d(p, Pm) < 2B as soon as n ~ N and m ~ N. Thus {pn} is a Cauchy sequence. (b) Let {Pn} be a Cauchy sequence in the compact space X. For N = 1, 2, 3, ... , let EN be the set consisting of PN, PN+t, PN+2, ... . Then lim diam EN= 0, N ➔ oo by Definition 3.9 and Theorem 3. lO(a). Being a closed subset of the compact space X, each EN is compact (Theorem 2.35). Also EN:::> EN+i, so that EN=> EN+1• Theorem 3.lO(b) shows now that there is a unique p EX which lies in every EN. Let e > 0 be given. By (3) there is an integer N O such that diam EN < e if N ~ N 0 • Since p E EN, it follows that d(p, q) < B for every q E EN, hence for every q E EN. In other words, d(p, Pn) < e if n ~ N O • This says precisely that Pn • p. (c) Let {xn} be a Cauchy sequence in Rk. Define EN as in (b), with x, in place of Pi. For some N, diam EN< 1. The range of {xn} is the union of EN and the finite set {x 1, ... , xN- 1}. Hence {xn} is bounded. Since every bounded subset of Rk has compact closure in Rk (Theorem 2.41), (c) follows from (b). 3.12 Definition A metric space in which every Cauchy sequence converges is said to be complete. Thus Theorem 3.11 says that all compact metric spaces and all Euclidean spaces are complete. Theorem 3.11 implies also that every closed subset E of· a complete metric space Xis complete. (Every Cauchy sequence in Eis a Cauchy sequence in X, hence it converges to some p EX, and actually p e E since Eis closed.) An example of a metric space which is not complete is the space of all rational numbers, with d(x, y) = Ix - YI. NUMERICAL SEQUENCES AND SERIES 55 Theorem 3.2(c) and example (d) of Definition 3.1 show that convergent sequences are bounded, but that bounded sequences in Rk need not converge. However, there is one important case in which convergence is equivalent to boundedness; this happens for monotonic sequences in R1• 3.13 Definition A sequence {sn} of real numbers is said to be (a) monotonically increasing if Sn~ Sn+l (n = 1, 2, 3, ... ); (b) monotonically decreasing if Sn~ Sn+i (n = 1, 2, 3, ... ). The class of monotonic sequences consists of the increasing and the decreasing sequences. 3.14 Theorem Suppose {sn} is monotonic. Then {sn} converges if and only if it is bounded. Proof Suppose Sn~ Sn+i (the proof is analogous in the other case). Let E be the range of {sn}. If {sn} is bounded, let s be the least upper bound of E. Then (n = 1, 2, 3, ... ). For every B > 0, there is an integer N such that for otherwise s - s would be an upper bound of E. Since {sn} increases, n ~ N the ref ore implies s - e <Sn~ s, which shows that {sn} converges (to s). The converse follows from Theorem 3.2(c). UPPER AND LOWER LIMITS 3.15 Definition Let {sn} be a sequence of real numbers with the following property: For every real 1\\1 there is an integer N such that n ~ N implies sn ~ M. We then write Sn ➔ +OO. Similarly, if for every real M there is an integer N such that n ~ N implies sn ~ M, we write Sn ► - 00. 56 PRINCIPLES OF MATHEMATICAL ANALYSIS It should be noted that we now use the symbol ➔ (introduced in Defini- tion 3.1) for certain types of divergent sequences, as well as for convergent sequences, but that the definitions of convergence and of limit, given in Defini- tion 3.1, are in no way changed. 3.16 Definition Let {sn} be a sequence of real numbers. Let Ebe the set of numbers x (in the extended real number system) such that sn,. ) x for some subsequence {j'n,.}. This set E contains all subsequential limits as defined in Definition 3.5, plus possibly the numbers + oo, - oo. We now recall Definitions 1.8 and 1.23 and put s* = sup E, s* = inf E. The numbers s*, s* are called the upper and lower limits of {sn}; we use the notation lim sup Sn= s*, lim inf Sn = s*. n ➔ oo ft ➔ 00 3.17 Theorem Let {sn} be a sequence of real numbers. Let E ands* have the same meaning as in Definition 3.16. Thens* has the following two properties: (a) s* e E. (b) If x > s*, there is an integer N such that n ~ N implies Sn < x. Moreover, s* is the only number with the properties (a) and (b). Of course, an analogous result is true for s*. Proof (a) Ifs* = + oo, then Eis not bounded above; hence {sn} is not bounded above, and there is a subsequence {sn,.} such that sn,. ) + oo. Ifs* is real, then Eis bounded above, and at least one subsequential limit exists, so that (a) follows from Theorems 3.7 and 2.28. If s* = - oo, then E contains only one element, namely - oo, and there is no subsequential limit. Hence, for any real M, Sn > M for at most a finite number of values of n, so that sn ) - oo. This establishes (a) in all cases. (b) Suppose there is a number x > s* such that Sn ~ x for infinitely many values of n. In that case, there is a number ye E such that y ~ x > s*, contradicting the definition of s*. Thuss* satisfies (a) and (b). To show the uniqueness, suppose there are two numbers, p and q, which satisfy (a) and (b), and suppose p < q. Choose x such thatp < x < q. Since p satisfies (b), we have sn < x for n ~ N. But then q cannot satisfy (a). NUMERICAL SEQUENCES AND SERIES 57 3.18 · Examples (a) Let {sn} be a sequence containing all rationals. Then every real number is a subsequential limit, and lim sup Sn= + 00, ft➔ OO (b) Let s,1 = ( - 1 \") /[1 + (1/n)]. Then lim sup Sn= 1, n ➔ oo lim inf Sn= - oo. ft➔ OO lim inf Sn = - 1. ft➔ OO (c) For a real-valued sequence {sn}, lim sn = s if and only if lim sup Sn= lim inf Sn= s. ft➔ 00 ft➔ 00 We close this section with a theorem which is useful, and whose proof is quite trivial: 3.19 Theorem If Sn ~ tn for n ~ N, where N is fixed, then lim inf Sn ~ lim inf tn, lim sup Sn ~ lim sup tn. ft➔ 00 ft➔ 00 SOME SPECIAL SEQUENCES We shall now compute the limits of some sequences which occur frequently. The proofs will all be based on the following remark: If O ~ Xn ~ sn for n ~ N, where N is some fixed number, and if Sn ➔ 0, then Xn ➔ 0. 3.20 Theorem (a) If p > 0, then lim 1 P = 0. n ... oo n (b) If p > 0, then lim iP = 1. (c) lim in= 1. ft➔ OO n« (d) If p > 0 and~ is real, then lim (l )\" = 0. ft➔OO + P (e) If lxl < 1, then lim x\" = 0. ft➔ OO 58 PRINCIPLES OF MATHEMATICAL ANALYSIS Proof (a) Take n > (1/s) 11P. (Note that the archimedean property of the real number system is used here.) (b) If p > 1, put Xn = ::jp - 1. Then Xn > 0, and, by the binomial theorem, so that p-1 0 <Xn ~--• n Hence xn ➔ 0. If p = 1, (b) is trivial, and if O < p < 1, the result is obtained by taking reciprocals. (c) Put xn = ::/; - 1. Then Xn ~ 0, and, by the binomial theorem, Hence nn-1 2 n-1 (n ~ 2). (d) Let k be an integer such that k > ex, k > 0. For n > 2k, (l )\" (n) k _ n(n - 1) · · · (n - k + 1) k nkpk. + P > k P - k ! P > 2kk ! Hence na. 2kk ! Q < (} + p )\" < pk na. - k (n > 2k). Since ex - k < 0, na.-k ) 0, by (a). (e) Take ex = 0 in (d). SERIES In the remainder of this chapter, all sequences and series under consideration will be complex-valued, unless the contrary is explicitly stated. Extensions of some of the theorems which follow, to series with terms in Rk, are mentioned in Exercise 15. NUMERICAL SEQUENCES AND SER.IES 59 3.21 Definition Given a sequence {an}, we use the notation n=p to denote the sum aP + ap+l + · · · + aq. With {an} we associate a sequence {sn}, where For {sn} we also use the symbolic expression a1 + a2 + a3 + ... or, more concisely, 00 (4) Lan. n=l The symbol (4) we call an in.finite series, or just a series. The numbers Sn are called the partial sums of the series. If {sn} converges to s, we say that the series converges, and write 00 Lan= s. n= 1 The number s is called the sum of the series; but it should be clearly under- stood that s is the limit of a sequence of sums, and is not obtained simply by addition. If {sn} diverges, the series is said to diverge. Sometimes, for convenience of notation, we shall consider series of the form 00 (5) Lan. n=O And frequently, when there is no possible ambiguity, or when the distinction is immaterial, we shall simply write :I:an in place of (4) or (5). It is clear that every theorem about sequences can be stated in terms of series (putting a 1 = s1 , and an = Sn - Sn - i for n > 1 ), and vice versa. But it is nevertheless useful to consider both concepts. The Cauchy criterion (Theorem 3.11) can be restated in the following form: 3.22 Theorem :I:an converges if and only if for every B > 0 there is an integer N such that (6) if m ~ n ~ N. 60 PRINCIPLES OF MATHEMATICAL ANALYSIS In particular, by taking m = n, (6) becomes I an I ~ B (n ~ N). In other words: 3.23 Theorem lf :I:an converges, then limn➔oo an = 0. The condition an ➔ 0 is not, however, sufficient to ensure convergence of :I:an. For instance, the series CX) 1 I - n= 1 n diverges; for the proof we refer to Theorem 3.28. Theorem 3.14, concerning monotonic sequences, also has an immediate counterpart for series. 3.24 Theorem A series of nonnegative1 terms converges if and only if its partial sums form a bounded sequence. We now tum to a convergence test of a different nature, the so-called ''comparison test.\" 3.25 Theorem (a) If I an I ~ Cn for n ~ N 0 , where N 0 is some fixed integer, and if :I:cn converges, then :I:an converges. (b) If an~ dn ~ 0 for n ~ N 0 , and 1f :I:dn diverges, then :I:an diverges. Note that (b) applies only to series of nonnegative terms an. Proof Given e > 0, there exists N ~ N 0 such that m ~ n ~ N implies by the Cauchy criterion. Hence m m ~ L I ak I ~ L ck ~ B, k=n k=n and (a) follows. Next, (b) follows from (a), for if :I:an converges, so must :I:dn [note that (b) also follows from Theorem 3.24]. 1 The expression ''nonnegative'' always refers to real numbers. NUMERICAL SEQUENCES AND SERIES 61 The comparison test is a very useful one; to use it efficiently, we have to become familiar with a number of series of nonnegative terms whose conver- gence or divergence is known. SERIES OF NONNEGATIVE TERMS The simplest of all is perhaps the geometric series. 3.26 Theorem If O ~ x < 1, then CX) 1 Ix\"=-· n=O 1 - X If x ~ 1, the series diverges. Proof If x -::f:. 1, 1 - Xn+l Xk=---• 1-x The result follows if we let n ---+ oo. For x = 1, we get 1+1+1+···, which evidently diverges. In many cases which occur in applications, the terms of the series decrease monotonically. The following theorem of Cauchy is therefore of particular interest. The striking feature of the theorem is that a rather ''thin'' subsequence of {an} determines the convergence or divergence of l:a\". 3.27 Theorem Suppose a 1 ~ a2 ~ a 3 ~ · · · ~ 0. Then the series I:= 1 an con- verges if and only if the series (7) CX) L 2ka2 ,. = a1 + 2a2 + 4a4 + 8a8 + · · · k=O converges. Proof By Theorem 3.24, it suffices to consider boundedness of the partial sums. Let Sn = 01 + 02 + ... + an' tk = a1 + 2a2 + · · · + 2ka2 ,.. 62 PRINCIPLES OF MATHEMATICAL ANALYSIS (8) (9) 3.28 so that Sn~ a 1 + (a2 + a 3) + · · · + (a2 k + · · · + a 2 k+1- 1) ~ a1 + 2a2 + · · · + 2ka2 k On the other hand, if n > 2k, so that Sn ~ a1 + a2 + (a 3 + a 4 ) + · · · + (a2k- 1 + 1 + · · · + a2k) ~ ½a1 + a2 + 2a4 + · · · + 2k- 1a2 k = ½tk, 2Sn ~ fk. By (8) and (9), the sequences {sn} and {tk} are either both bounded or both unbounded. This completes the proof. I Theorem I - converges if p > 1 and diverges if p ~ 1. nP Proof If p ~ 0, divergence follows from Theorem 3.23. If p > 0, Theorem 3.27 is applicable, and we are led to the series C() 1 C() '°' 2k. __ '°' 2(1-p)k L.., 2kp - L.., . k=O k=O Now, 21 -p < 1 if and only if 1 - p < 0, and the result follows by com- parison with the geometric series (take x = 21 - P in Theorem 3.26). As a further application of Theorem 3.27, we prove: 3.29 Theorem If p > 1, C() 1 n~2 n(lo converges,· if p ~ 1, the series diverges. (10) Remark ''log n'' denotes the logarithm of n to the base e (compare Exercise 7, Chap. 1); the number e will be defined in a moment (see Definition 3.30). We let the series start with n = 2, since log 1 = 0. (11) (12) NUMERICAL SEQUENCES AND SERIES 63 Proof The monotonicity of the logarithmic function (which will be discussed in more detail in Chap. 8) implies that {log n} increases. Hence {1/n log n} decreases, and we can apply Theorem 3.27 to (10); this leads us to the series 00 1 00 1 1 00 1 L2k. ___ z:-----z:- k= 1 2k(log 2k)P - k= 1 (k log 2)P - (log 2)P k= 1 kP' and Theorem 3.29 follows from Theorem 3.28. This procedure may evidently be continued. For instance, 00 1 n~3 n log n log log n diverges, whereas (13) 00 1 n~3 n log n(log log n)2 converges. We may now observe that the terms of the series (12) differ very little from those of (13). Still, one diverges, the other converges. If we continue the process which led us from Theorem 3.28 to Theorem 3.29, and then to (12) and (13), we get pairs of convergent and divergent series whose terms differ even less than those of (12) and (13). One might thus be led to the conjectt1re that there is a limiting situation of some sort, a ''boundary'' with all convergent series on one side, all divergent series on the other side:-at least as far as series with monotonic coefficients are concerned. This notion of ''boundary'' is of course quite vague. The point we wish to make is this: No matter how we make this notion precise, the conjecture is false. Exercises 11 (b) and 12(b) may serve as illustrations. We do not wish to go any deeper into this aspect of convergence theory, and refer the reader to Knopp's ''Theory and Application of Infinite Series,\" Chap. IX, particularly Sec. 41. THE NUMBER e 3.30 Definition e = I; 1 . n=on! Here n ! = 1 · 2 · 3 · · · n if n ~ 1, and O ! = 1. 64 PRINCIPLES OF MATHEMATICAL ANALYSIS Since 1 1 1 s =1+1+-+---+···+---- n 1·2 1·2·3 1·2···n 1 1 1 <1 +1 +-+--,-+···+-<3 2 22 2n-l , the series converges, and the definition makes sense. In fact, the series converges very rapidly and allows us to compute e with great accuracy. It is of interest to note that e can also be defined by means of another limit process; the proof provides a good illustration of operations with limits: 3.31 Theorem lim Proof Let 1 n 1 + - = e. n n 1 Sn= L kl, k=O • By the binomial theorem, 1 tn = l + 1 + 1 2. 1 1 1-- +- n 3! Hence tn ~Sn' so that 1 1 - - n 1 n t = l+- · n 2 1 - - n n + ... 1 1 +- 1-- n! n 2 1 - - n (14) lim sup tn ~ e, n ➔ oo by Theorem 3.19. Next, if n ~ m, n-1 ... 1- -- n 1 tn ~ 1 + 1 + 2 1 1-- n 1 + ... +- 1 1-- n m-1 ... 1--- • ml n Let n ➔ oo, keeping m fixed. We get 1 n ➔ oo so that n-+ oo Letting m > oo, we finally get (15) e ~ lim inf tn. n-+ oo The theorem follows from (14) and (15). • NUMERICAL SEQUENCES AND SERIES 65 The rapidity with which the series L 1 converges can be estimated as n! follows: If sn has the same meaning as above, we have 1 1 1 e-s =---+---+---+··· n (n + 1) ! (n + 2) ! (n + 3) ! 1 1 1 1 <--- 1+--+---+··· =- (n + 1) ! n + 1 (n + 1)2 n !n so that (16) 1 0 < e-s < -· n n!n Thus s10 , for instance, approximates e with an error less than 10- 1 . The inequality (16) is of theoretical interest as well, since it enables us to prove the irrationality of e very easily. 3.32 Theorem e is irrational. (17) Proof Suppose e is rational. Then e = p/q, where p and q are positive integers. By (16), 1 0 <q!(e-sq) <-· q By our assumption, q!e is an integer. Since q!sq = q! 1 1 l+l+-+···+- 2 ! q! is an integer, we see that q!(e - sq) is an integer. Since q ~ l, (17) implies the existence of an integer between O and 1. We have thus reached a contradiction. Actually, e is not even an algebraic number. For a simple proof of this, see page 25 of Niven's book, or page 176 of Herstein's, cited in the Bibliography. THE ROOT AND RATIO TESTS 3.33 Theorem (Root Test) Given :Ean, put a = lim sup ::/Ian I - Then (a) if a< 1, :Ean converges,· (b) if a> 1, :Ean diverges; (c) if a = 1, the test gives no information. 66 PRINCIPLES OP MATHEMATICAL ANALYSIS Proof If °' < 1, we can choose /J so that °' < /J < 1, and an integer N such that n lanl </J for n ~ N [by Theorem 3.17(b)]. That is, n ~ N implies lanl < pn. Since O < /J < 1, 'E/Jn converges. Convergence of '£an follows now from the comparison test. If°'> 1, then, again by Theorem 3.17, there is a sequence {nk} such that Hence I an I > 1 for infinitely many values of n, so that the condition an ➔ O, necessary for convergence of '£an, does not hold (Theorem 3.23). To prove (c), we consider the series For each of these series oc = 1, but the first diverges, the second converges. 3.34 Theorem (Ratio Test) The series '£an if 1. an+l 1 (a) converges 1 1m sup -- < , n➔ oo an (b) diverges if an+t ~ 1 for all n ~ n0 , where n0 is some.fixed integer. an Proof If condition (a) holds, we can find /J < 1, and an integer N, such that </J for n ~ N. In particular, I aN + 1 I < /JI aN I , I aN + 2 I < /JI aN + 1 I < /1 2 I aN I, • • • • • • • • • • • • • • • • • • • NUMERICAL SEQUENCES AND SERIES 67 That is, lanl < laNIP-N • pn for n ~ N, and (a) follows from the comparison test, since r,pn converges. If I an+ 1 I ~ I an I for n ~ n0 , it is easily seen that the condition an ➔ 0 does not hold, and (b) follows. Note: The knowledge that lim an+ 1/an = 1 implies nothing about the convergence of !:.an. The series !:-1/n and !:.l/n2 demonstrate this. 3.3~ Examples (a) Consider the series 1 1 1 1 1 1 1 1 2 + 3 + 22 + 32 + 23 + 33 + 24 + 34 + ... ' for which I. . f an+l 1· 2 n 0 1m 1n = 1m 3 - = , n➔ oo an n➔ oo 1. • f n l' 2n 1m 1n an = 1m n ➔ oo n ➔ oo I . an+l }' 1 3 n 1m sup -- = 1m - - = + oo. n➔OO an n➔oo 2 2 The root test indicates convergence; the ratio test does not apply. ( b) The same is true for the series 1 1 1 1 1 1 1 2 + 1 + 8 + 4 + 3 2 + 16 + 128 + 64 + ... ' where 1 . . f an+ l 1 Im In -- = -, n➔oo an 8 I. an+l 2 1msup -- = , n➔ 00 an but 68 PRINCIPLES OF MATHEMATICAL ANALYSIS 3.36 Remarks The ratio test is frequently easier to apply than the root test, since it is usually easier to compute ratios than nth roots. However, the root test has wider scope. More precisely: Whenever the ratio test shows conver- gence, the root test does too; whenever the root test is inconclusive, the ratio test is too. This is a consequence of Theorem 3.37, and is illustrated by the above examples. Neither of the two tests is subtle with regard to divergence. Both deduce divergence from the fact that an does not tend to zero as n > oo. 3.37 Theorem For any sequence { en} of positive numbers, (18) 1· . f Cn+l Im Ill C ~ lim inf n en' n-+oo n n-+oo C l. nl l' n+l Im sup v en ~ Im sup · n-+ oo n-+ oo Cn Proof We shall prove the second inequality; the proof of the first is quite similar. Put 1 . Cn+ 1 a= Imsup--• n-+ 00 en If a = + oo, there is nothing to prove. If a is finite, choose f3 > a. There is an integer N such that for n ~ N. In particular, for any p > 0, (k = 0, 1, ... , p - 1 ). Multiplying these inequalities, we obtain CN+p ~ fJPcN' or C < C p-N. pn n - N (n ~ N). Hence so that lim sup icn ~ /3, n-+oo NUMERICAL SEQUENCES AND SERIES 69 by Theorem 3.20(b). Since (18) is true for every f3 > r.<, we have lim sup n Cn ~ r.<. n-+ oo POWER SERIES 3.38 Definition Given a sequence {en} of complex numbers, the series (19) 00 L CnZn n=O is called a power series. The numbers en are called the coefficients of the series; z is a complex number. In general, the series will converge or diverge, depending on the choice of z. More specifically, with every power series there is associated a circle, the circle of convergence, such that (19) converges if z is in the interior of the circle and diverges if z is in the exterior (to cover all cases, we have to consider the plane as the interior of a circle of infinite radius, and a point as a circle of radius zero). The behavior on the circle of convergence is much more varied and can- not be described so simply. 3.39 Theorem Given the power series !:en zn, put n-+ oo 1 R =-· a (/fa= 0, R = +oo; if a= +oo, R = 0.) Then I:cnzn converges if lzl < R, and diverges if I z I > R. Proof Put an= cnzn, and apply the root test: Note: R is called the radius of convergence of .!:en zn. 3.40 Examples (a) The series :Enn zn has R = 0. Zn (b) The series L I has R = + oo. (In this case the ratio test is easier to n. apply than the root test.) 70 PRINCIPLES OF MATHEMATICAL ANALYSIS (c) The series :Ezn has R = 1. If lzl = 1, the series diverges, since {zn} does not tend to O as n ➔ oo. n (d) The series L :._ has R = 1. It diverges if z = 1. It converges for all n other z with I z I = 1. (The last assertion will be proved in Theorem 3.44.) n (e) The series L z2 has R = 1. It converges for all z with I z I = 1, by n the comparison test, since I zn/n 2 1 = 1/n2 • SUMMATION BY PARTS 3.41 Theorem Given two sequences {an}, {b,,}, put ifn ~ O; put A_ 1 = 0. Then, ifO ~p ~ q, we have (20) q q-1 L anbn = L An(bn - hn+1) + Aqbq - Ap-lbp. n=p n=p Proof and the last expression on the right is clearly equal to the right side of (20). Formula (20), the so-called ''partial summation formula,\" is useful in the investigation of series of the form :Eanbn, particularly when {bn} is monotonic. We shall now give applications. 3.42 Theorem Suppose (a) the partial sums An of :Eanform a bounded sequence,· (b) ho ~ b1 ~ b2 ~ · · · ; (c) lim bn = 0. n ➔ oo Then :Ean bn converges. NUMERICAL SEQUENCES AND SERIES 71 Proof Choose M such that I An I ~ M for all n. Given e > 0, there is an integer N such that bN ~ (e/2M). For N ~ p ~ q, we have - q-1 - - I - LAn(bn hn+i)+Aqbq Ap-lbp1 n=p I q-1 ~ M L (bn - b,,+1) + bq + hp n=p = 2MbP ~ 2MbN ~ e. Convergence now follows from the Cauchy criterion. We note that the • first inequality in the above chain depends of course on the fact that bn - bn+l ~ 0. 3.43 Theorem Suppose (a) I C1 I ~ I C2 I ~ I c3 I ~ · · · ; (b) C2m-l ~ 0, C2m ~ 0 (m = 1, 2, 3, ... ); (c) limn➔oo Cn = 0. Then Icn converges. Series for which (b) holds are called ''alternating series''; the theorem was known to Leibnitz. Proof Apply Theorem 3.42, with an = ( -1 )n + 1 , bn = I cn I , 3.44 Theorem Suppose the radius of convergence of Icn zn is 1, and suppose c0 ~ c1 ~ c2 ~ • • ·, limn➔oo Cn = 0. Then Icnzn converges at every point on the circle I z I = 1, except possibly at z = 1. Proof Put an= zn, bn = cn. The hypotheses of Theorem 3.42 are then satisfied, since n I An I = L Zm = m=O if I z I = 1, z :;l: 1. ABSOLUTE CONVERGENCE 1 - zn+l 1-z 2 ~11-zl' The series Ian is said to converge absolutely if the series I I an I converges. 3.4~ Theorem If Ian converges absolutely, then Ian converges. 72 PRINCIPLES OF MATHEMATICAL ANALYSIS Proof The assertion follows from the inequality m m L ak ~ L I akl, k=n k•n plus the Cauchy criterion. 3.46 Remarks For series of positive terms, absolute convergence is the same as convergence. If Lan converges, but L l an l diverges, we say that Lan converges non- absolutely. For instance, the series converges nonabsolutely (Theorem 3.43). The comparison test, as well as the root and ratio tests, is really a test for absolute convergence, and therefore cannot give any information about non- absolutely convergent series. Summation by parts can sometimes be used to handle the latter. In particular, power series converge absolutely in the interior of the circle of convergence. We shall see that we may operate with absolutely convergent series very much as with finite sums. We may multiply them term by term and we may change the order in which the additions are carried out, without affecting the sum of the series. But for nonabsolutely convergent series this is no longer true, and more care has to be taken when dealing with them. ADDITION AND MULTIPLICATION OF SERIES 3.47 Theorem If Lan = A, and Lbn = B, then L(an + bn) = A + B, and Lean = cA, for any fixed c. Proof Let Then n An + Bn = L (ak + bk). k=O Since limn➔oo An= A and limn➔oo Bn = B, we see that n ➔ oo The proof of the second assertion is even simpler. NUMERICAL SEQUENCES AND SERIES 73 Thus two convergent series may be added term by term, and the result- ing series converges to the sum of the two series. The situation becomes more complicated when we consider multiplication of two series. To begin with, we have to define the product. This can be done in several ways; we shall consider the so-called ''Cauchy product.\" 3.48 Definition Given La\" and Lb\", we put \" en= L akbn-k k=O (n=0,1,2, ... ) and call LC\" the product of the two given series. This definition may be motivated as follows. If we take two power series Lanz\" and \"'£b\"z\", multiply them term by term, and collect terms contain- ing the same power of z, we get 00 00 L a\" z\" · L bn z\" = (a0 + a1z + a2 z2 + · · ·)(b0 + b1z + b2 z 2 + · · ·) n=O n=O = a0 b0 + (a0 b1 + a1 b0}z + (a0 b2 + a1 b1 + a2 b0}z 2 + · · · = Co + C 1 Z + C 2 z2 + ' ' ' . Setting z = 1, we arrive at the above definition. 3.49 Example If and A\" ➔ A, B\" ➔ B, then it is not at all clear that { C\"} will converge to AB, since we do not have C\" = A\" B\". The dependence of { C\"} on {A\"} and {.B\"} is quite a complicated one (see the proof of Theorem 3.50). We shall now show that the product of two convergent series may actually diverge. The series 00 ( -1)\" 1 1 1 I ----;===1--+---+··· n=oJn + I J2 J3 J4 converges (Theorem 3.43). We form the product of this series with itself and obtain 00 LC\"= 1 - n=O 1 1 1 J3 + JiJ2 + J3 1 1 1 1 - J4+ J3J2 + J2J3 + J4 + ... ' 74 PRINCIPLES OF MATHEMATICAL ANALYSIS so that Since we have n 1 en =(-I)nL --:=====· k = o J (n - k + 1 )(k + I) ( n - k + 1 )(k + I) = n -+I 2 2 n - - -k 2 I I ~ 2 _ 2(n + I) C > L, -- ----, n -k=on +2 n +2 n -+I 2 2 • so that the condition en ➔ 0, which is necessary for the convergence of l:cn , is not satisfied. In view of the next theorem, due to Mertens, we note that we have here considered the product of two nonabsolutely convergent series. 3.50 Theorem Suppose Then 00 (a) L an converges absolutely, n=O 00 (b) Lan= A, n=O 00 (c) L bn = B, n=O n (d) Cn = L ak bn-k k=O (n = 0, I, 2, ... ). 00 L Cn = AB. n=O That is, the product of two convergent series converges, and to the right value, if at least one of the two series converges absolutely. Proof Put Then Cn = aobo + (aob1 + a1bo) + · · · + (aobn + a1bn-1 + · ·· + anbo) = a0Bn + a1 Bn-i +···+an Bo = ao(B + Pn) + a1(B + Pn-1) + · · · + an(B + Po) = AnB + aoPn + a1Pn-1 + ''' + anPo NUMERICAL SEQUENCES AND SERIES 75 Put Yn = ao/Jn + a1/Jn-l +'''+an/Jo• We wish to show that Cn ➔ AB. Since An B ► AB, it suffices to show that (21) lim Yn = 0. Put [It is here that we use (a).] Let e > 0 be given. By (c}, /Jn ► 0. Hence we can choose N such that I /Jn I ~ e for n ~ N, in which case IYnl ~I/Joan+···+ fJNan-NI + I/JN+lan-N-1 + ·· · + /Jnaol ~I/Joan+···+ fJNan-NI + ea. Keeping N fixed, and letting n ➔ oo, we get lim sup I Yn I ~ ea, n ➔ oo since ak ➔ 0 ask ➔ oo. Since e is arbitrary, (21) follows. Another question which may be asked is whether the series ten, if con- vergent, must have the sum AB. Abel showed that the answer _is in the affirma- tive. 3.51 Theorem If the series tan, tbn, ten converge to A, B, C, and Cn = ao bn + ... + an ho' then C = AB. Here no assumption is made concerning absolute convergence. We shall give a simple proof (which depends on the continuity of power series) after Theorem 8.2. REARRANGEMENTS 3.52 Definition Let {kn}, n = 1, 2, 3, ... , be a sequence in which every positive integer appears once and only once (that is, {kn} is a 1-1 function from J onto J, in the notation of Definition 2.2). Putting ' a = ak n \" (n=l,2,3, ... ), we say that ta~ is a rearrangement of tan . 76 PRINCIPLES OF MATHEMATICAL ANALYSIS If {sn}, {s~} are the sequences of partial sums of tan, ta~, it is easily seen that, in general, these two sequences consist of entirely different numbers. We are thus led to the problem of determining under what conditions all rearrangements of a convergent series will converge and whether the sums are necessarily the same. 3.53 Example Consider the convergent series (22) 1-½+¼-¼+½--l;+··· and one of its rearrangements (23) 1 + ¼ - ½ + t + t - ¼ + ½ + 1 1 1 - ¼ + ... in which two positive terms are always followed by one negative. If s is the sum of (22), then s < 1 - ½ + ½ = i, Since 1 1 1 - 3 + 4k - 1 - 2k > O for k ~ 1, we see that s; < s~ < s~ < · · · , where s~ is nth partial sum of (23). Hence 1 . , , _S_ Im sup Sn > S3 = 0 , n ➔ oo so that (23) certainly does not converge to s [we leave it to the reader to verify that (23) does, however, converge]. This example illustrates the following theorem, due to Riemann. 3.54 Theorem Let tan be a ,fleries of real numbers which converges, but not absolutely. Suppose -00 ~ CX ~ p ~ 00. Then there exists a rearrangement ta~ with partial sums s~ such that (24) lim inf s~ = ex, lim sups~ = p. n ➔ oo n ➔ oo Proof Let (n = 1, 2, 3, ... ). NUMERICAL SEQUENCES AND SERIES 77 Then Pn - qn = an, Pn + qn = I an I, Pn ~ 0, qn ~ 0. The series \"'f.pn, \"'f.qn must both diverge. For if both were convergent, then would converge, contrary to hypothesis. Since N N N N L an = L (Pn - qn) = L Pn - L qn, n=1 n=1 n=1 n=1 divergence of \"'f.pn and convergence of \"'f.qn ( or vice versa) implies diver- gence of \"'f.an , again contrary to hypothesis. Now let P1 , P 2 , P 3 , ••• denote the nonnegative terms of \"'f.an, in the order in which they occur, and let Q 1 , Q 2 , Q 3 , .•. be the absolute values of the negative terms of \"'f.an, also in their original order. The series \"'f.Pn, \"'f.Qn differ from \"'f.pn, \"'f.qn only by zero terms, and are therefore divergent. We shall construct sequences {mn}, {kn}, such that the series (25) P1 + ·•· +P,,, 1 - Q1 - ··· - Qk1 +Pm1+1 + ··· +Pm2 - Qk1+1 - ··• - Qk2 + •••, which clearly is a rearrangement of \"'f.an, satisfies (24). Choose real-valued sequences {C<n}, {/3n} such that C<n---+ C<, /3n---+ /3, an < Pn, /31 > o. Let m1 , k1 be the smallest integers such that P1 + ··· +Pm1 > /31, P1 + • • • + P m1 - Ql - • • • - Qk1 < C(l; let m 2 , k 2 be the smallest integers such that P1 + ••• +Pm 1 - Q1 - •·• - Qk1 +P,,,1+1 + ••• +Pm2 > /32, P1 + ••• +P,n1 - Q1 - ·•• - Qk1 +Pm1+l + ••• +Pm2 - Qk1+l - ... - Qk2 < C<2; and continue in this way. This is possible since \"'f.Pn and \"'f.Qn diverge. If xn, Yn denote the partial sums of (25) whose last terms are Pm\", -Qkn, then Since Pn---+ 0 and Qn---+ 0 as n---+ oo, we see that Xn---+ /3, Yn---+ C(. Finally, it is clear that no number less than C< or greater than /3 can be a subsequential limit of the partial sums of (25). 78 PRINCIPLES OF MATHEMATICAL ANALYSIS 3.SS Theorem lf\"f.an is a series of complex numbers which converges absolutely, then every rearrangement of \"f.an converges, and they all converge to the same sum. Proof Let \"f.a~ be a rearrangement, with partial sums s~. Given e > 0, there exists an integer N such that m ~ n ~ N implies (26) • 1=n Now choose p such that the integers 1, 2, ... , N are all contained in the set k 1 , k 2 , ••• , kP (we use the notation of Definition 3.52). Then if n > p, the numbers a1 , ... , aN will cancel in the difference sn - s~, so that I sn - s~ I ~ e, by (26). Hence {s~} converges to the same sum as {sn}. EXERCISES 1. Prove that convergence of {sn} implies convergence of { I Sn I}. Is the converse true? 2. Calculate lim (V n 2 + n - n). n ➔ OO 3. If s1 = V2, and (n = 1, 2, 3, ... ), prove that {sn} converges, and that Sn< 2 for n = 1, 2, 3, ... . 4. Find the upper and lower limits of the sequence {sn} defined by St =0; S. For any two real sequences {an}, {bn}, prove that lim sup (an + bn) ::::;; lim sup On + lim sup bn' n ➔ OO n ➔ OO n ➔ OO provided the sum on the right is not of the form oo - oo. 6. Investigate the behavior (convergence or divergence) of :l:an if (a) On ='Vn + 1- Vn; (b) On = v n + 1 - Vn; n (c) On= (v\" n - l)n; 1 (d) On = 1 + zn' for complex values of z. 7. Prove that the convergence of :l:an implies the convergence of van :E n , if On::?: 0. NUMERICAL SEQUENCES AND SERIES 79 8. If Lan converges, and if {bn} is monotonic and bounded, prove that Lan bn con- verges. 9. Find the 1·adius of convergence of each of the following power series: 2n (c) I: 2 zn, n 2n (b) L ~ zn, 10. Suppose that the coefficients of the power series I:an zn are integers, infinitely many of which are distinct from zero. Prove that the radius of convergence is at most 1. 11. Suppose On > 0, Sn = 01 + ... + On' and La,. diverges. (a) Prove that L 1 :nan diverges. (b) Prove that and deduce that I:~ diverges. Sn (c) Prove that \"\"an and deduce that ,t.., 2 converges. Sn (d) What can be said about +,,,+ON +k 2: l _ SN SN+k SN+k On 1 1 2~---- sn Sn-1 Sn L On 1 + nan and 12. Suppose an > 0 and Lan converges. Put (a) Prove that 00 rn= L Om, m=n 1 rn > -- rm if m < n, and deduce that I:~ diverges. rn 80 PRINCIPLES OF MATHEMATICAL ANALYSIS (b) Prove that On and deduce that L A 1 - converges. ·v rn 13. Prove that the Cauchy product of two absolutely convergent series converges absolutely. 14. If {sn} is a complex sequence, define its arithmetic means an by So+ S1 +'''+Sn Un= n+l (n =0, 1, 2, ... ). (a) If lim Sn = s, prove that lim Un = s. (b) Construct a sequence {sn} which does not converge, although lim an= 0. (c) Can it happen that Sn> 0 for all n and that lim sup Sn= oo, although lim an= 0? (d) Put On = Sn - Sn- 1, for n 2: 1. Show that 1 n Sn - Un= l L kak. n + k=l Assume that lim (nan)= 0 and that {an} converges. Prove that {sn} converges. [This gives a converse of (a), but under the additional assumption that nan ► 0.] (e) Derive the last conclusion from a weaker hypothesis: Assume M < oo, I nan I~ M for all n, and lim an= a. Prove that lim Sn= a, by completing the following outline: If m < n, then m+ 1 1 n Sn - Un= -- (an - Um) + -- L (sn - s,), n-m n-m l=m+l For these i, Fix e > 0 and associate with each n the integer m that satisfies Then (m + 1)/(n - m) < 1/e and I Sn - s, I < Me. Hence lim suplsn - al ~Me. ft ➔ 00 Since e was arbitrary, Jim Sn = a. NUMERICAL SEQUENCES AND SERIES 81 15. Definition 3.21 can be extended to the case in which the an lie in some fixed Rk. Absolute convergence is defined as convergence of :l: I an I, Show that Theorems 3.22, 3.23, 3.25(a), 3.33, 3.34, 3.42, 3.45, 3.47, and 3.55 are true in this more general setting. (Only slight modifications are required in any of the proofs.) 16. Fix a positive number IX. Choose Xi > v IX, and define X2, X3, X4, ... , by the recursion formula IX Xn+- Xn • (a) Prove that {xn} decreases monotonically and that lim Xn = v IX. (b) Put Bn = Xn - v;, and show that so that, setting f3 = 2 v IX, 2 8 2 en n Bn +1 = 2 < . ;- Xn 2v IX 2n Bi e,, + 1 < /3 (3 ( n = 1, 2, 3, ... ) . (c) This is a good algorithm for computing square roots. since the recursion formula is simple and the convergence is extremely rapid. For example, if IX= 3 and X1 = 2, show that e1//3 < 11 0 and that therefore 85 < 4. 10- 16 , 17. Fix IX> 1. Take X1 >VIX, and define 86 < 4' 10- 32 • 2 IX+ Xn IX - Xn Xn+i=l-L =xn+l+ • (a) Prove that X1 > X3 > Xs > · · · . (b) Prove that X2 < X4 < x6 < · · · . (c) Prove that lim Xn = VIX. , Xn Xn (d) Compare the rapidity of conve1·gence of this process with the one described i11 Exercise 16. 18. Replace the recursion formula of Exercise 16 by p-1 +IX -p+t Xn+1 = --Xn -Xn p p where p is a fixed positive integer, and describe the behavior of the resulting sequences {xn}, 19. Associate to each sequence a= {1Xn}, in which IXn is O or 2, the real number oo IXn x(a) = L 3n. n=l Prove that the set of all x(a) is precisely the Cantor set described in Sec. 2.44. 8.2 PRINCIPLES OF MATHEMATICAL ANALYSIS 20. Suppose {Pn} is a Cauchy sequence in a metric space X, and some subsequence {p,.,} converges to a point p e X. Prove that the full sequence {Pn} converges top. 21. Prove the following analogue of Theorem 3.lO(b): If {En} is a sequence of closed nonempty and bounded sets in a complete metric space X, if En => E,. + 1, and if lim diam En = 0, n ➔ oo then n f En consists of exactly one point. 22. Suppose Xis a nonempty complete metric space, and {G,.} is a sequence of dense open subsets of X. Prove Baire's theorem, namely, that n f Gn is not empty. (In fact, it 1s dense in X.) Hint: Find a shrinking sequence of neighbor~ hoods E,. such that£,. c G,., and apply Exercise 21. 23. Suppose {pn} and {qn} are Cauchy sequences in a metric space X. Show that the sequence {d(Pn, qn)} converges. Hint: For any m, n, d(pn, qn) ~ d(pn, Pm) + d(Pm, qm) + d(qm , qn); it follows that is small if m and n are large. 24. Let X be a metric space. (a) Call two Cauchy sequences {Pn}, {qn} in X equivalent if lim d(pn, q,.) = 0. n ➔ oo Prove that this is an equivalence relation. (b) Let X* be the set of all equivalence classes so obtained. If Pe x•, Q e X*, {p,,} e P, {qn} e Q, define !l.(P, Q) = lim d(pn, qn); n ➔ OO by Exercise 23, this limit exists. Show that the number !l.(P, Q) is unchanged if {Pn} and {qn} are replaced by equivalent sequences, and hence that fl. is a distance function in X*. (c) Prove that the resulting metric space X* is complete. (d) For each p e X, there is a Cauchy sequence all of whose terms are p; let Pp be the element of X* which contains this sequence. Prove that !l.(Pp, P4 ) = d(p, q) for all p, q e X. In other words, the mapping <p defined by <p(p) =PP is an isometry (i.e., a distance-preserving mapping) of X into X*. (e) Prove that <p(X) is dense in X*, and that <p(X) = X* if Xis complete. By (d), we may identify X and <p(X) and thus regard X as embedded in the complete metric space X*. We call X* the completion of X. 25. Let X be the metric space whose points are the rational numbers, with the metric d(x, y) =Ix - y I, What is the completion of this space? (Compare Exercise 24.) CONTINUITY The function concept and some of the related terminology were introduced in Definitions 2.1 and 2.2. Although we shall (in later chapters) be mainly interested in real and complex functions (i.e., in functions whose values are real or complex numbers) we shall also discuss vector-valued functions (i.e., functions with values in Rk) and functions with values in an arbitrary metric space. The theo- rems we shall discuss in this general setting would not become any easier if we restricted ourselves to real functions, for instance, and it actually simplifies and clarifies the picture to discard unnecessary hypotheses and to state and prove theorems in an appropriately general context. The domains of definition of our functions will also be metric spaces, suitably specialized in various instances. LIMITS OF FUNCTIONS 4.1 Definition Let X and Y be metric spaces; suppose E c X, f maps E into Y, and p is a limit point of E. We write f(x) ~ q as x ~ p, or (1) lim/(x) = q x ➔ p 84 PllINCIPLES OF MATHEMATICAL ANALYSIS if there is a point q e Y with the following property: For every e > 0 there exists a o > 0 such that (2) d1(f(x), q) < e for all points x e E for which (3) 0 < dx(x,p) < o. The symbols dx and dr refer to the distances in X and Y, respectively. If X and/ or Y are replaced by the real line, the complex plane, or by some euclidean space Rk, the distances dx, dr are of course replaced by absolute values, or by norms of differences ( see Sec. 2.16). It should be noted that p e X, but that p need not be a point of E in the above definition. Moreover, even if p e E, we may very well have f(p) f:. limx➔pf(x). We can recast this definition in terms of limits of sequences: 4.2 Theorem Let X, Y, E, f, and p be as in Definition 4. I. Then (4) limf(x) =q x ➔ p if and only if (5) lim f(pn) =q n ➔ oo for every sequence {Pn} in E such that (6) Pn f:. P, lim Pn = p. n ➔ oo Proof Suppose ( 4) holds. Choose {Pn} in E satisfying (6). Let e > 0 be given. Then there exists o > 0 such that dr(f(x), q) < e if x e E and O < dx(x, p) < o. Also, there exists N such that n > N implies 0 < dx(Pn ,p) < o. Thus, for n > N, we have dy(f(pn), q) < e, which shows that (5) holds. Conversely, suppose ( 4) is false. Then there exists some e > 0 such that for every o > 0 there exists a point x e E (depending on o), for which dr(f(x), q) :2:: e but O < dx(x, p) < o. Taking on = I/n (n = I, 2, 3, ... ), we thus find a sequence in E satisfying (6) for which (5) is false. Corollary If f has a limit at p, this limit is unique. This follows from Theorems 3.2(b) and 4.2. CONTINUITY 85 4.3 Definition Suppose we have two complex functions,/ and g, both defined on E. By f + g we mean the function which assigns to each point x of E the number f(x) + g(x). Similarly we define the difference f - g, the product fg, and the quotientf/g of the two functions, with the understanding that the quo- tient is defined only at those points x of E at which g(x) \"I:- 0. If f assigns to each point x of E the same number c, then f is said to be a constant function, or simply a constant, and we write f = c. If f and g are real functions, and if f(x) ~ g(x) for every x e E, we shall sometimes write f ~ g, for brevity. Similarly, if f and g map E into Rk, we define f + g and f · g by (f + g)(x) = f(x) + g(x), (f · g)(x) = f(x) • g(x); and if). is a real number, (lf)(x) = ).f(x). 4.4 Theorem Suppose E c X, a metric space, p is a limit point of E, f and g are complex functions on E, and lim f(x) = A, lim g(x) = B. x ➔ p Tl1en (a) lim (f + g)(x) = A + B; x ➔ p (b) lim (fg)(x) = AB; x ➔ p (c) lim [_ (x) = ~, if B \"I:- 0. x➔p g B Proof In view of Theorem 4.2, these assertions follow immediately from the analogous properties of sequences (Theorem 3.3). Remark If f and g map E into Rk, then (a) remains true, and (b) becomes (b') lim (f · g)(x) = A · B. (Compare Theorem 3.4.) CONTINUOUS FUNCTIONS 4.S Definition Suppose X and Y are metric spaces, E c X, p e E, and f maps E into Y. Then f is said to be continuous at p if for every e > 0 there exists a c5 > 0 such that dr(f(x),f(p)) < e for all points x e E for which dx(x, p) < b. If f is continuous at every point of E, then f is said to be continuous on E. It should be noted that f has to be defined at the point p in order to be continuous at p. (Compare this with the remark following Definition 4.1.) 86 PRINCIPLES OF MATHEMATICAL ANALYSIS If p is an isolated point of E, then our definition implies that every function f which has E as its domain of definition is continuous at p. For, no matter which e > 0 we choose, we can pick b > 0 so that the only point x e E for which dx(x,p) <bis x = p; then dy(f(x),f(p)) = 0 < e. 4.6 Theorem In the situation given in Definition 4.5, assume also that p is a limit point of E. Then f is continuous at p if and only if limx ... pf(x) = f(p). Proof This is clear if we compare Definitions 4.1 and 4.5. We now turn to compositions of functions. A brief statement of the following theorem is that a continuous function of a continuous function is continuous. 4. 7 Theorem Suppose X, Y, Z are metric spaces, E c X, f maps E into Y, g maps the range off, f(E), into Z, and h is the mapping of E into Z defined by h(x) = g(f (x)) (x e E). If f is continuous at a point p e E anti if g is continuous at the point f(p), then h is continuous at p. This function his called the composition or the composite off and g. The , notation h =g 0 f is frequently used in this context. Proof Let e > 0 be given. Since g is continuous at f(p), there exists r, > 0 such that d2(g(y), g(f(p))) < e if dy(y,f(p)) < r, and y ef(E). Since f is continuous at p, there exists b > 0 such that dr(f(x),f(p)) < r, if dx(x, p) <band x e E. It follows that d 2(h(x), h(p)) = d2(g(f(x)), g(f(p))) < e if dx(x, p) <band x e E. Thus his continuous at p. 4.8 Theorem A mapping 1· of a metric space X into a metric space Y is con- tinuous on X if and only if 1- 1 ( V) is open in X for every open set V in Y. (Inverse images are defined in Definition 2.2.) This is a very useful charac- terization of continuity. CONTINUI'l'Y 87 Proof Suppose/is continuous on X and Vis an open set in Y. We have to show that every point of 1- 1(V) is an interior point of 1- 1(V). So, suppose p e X and f (p) e V. Since V is open, there exists e > 0 such that ye V if dr(f(p), y) < e; and since f is continuous at p, there exists b > 0 such that dr(f(x),f(p)) < e if dx(x, p) < b. Thus x ef- 1(V) as soon as dx(x,p) < b. Conversely, suppose f- 1(V) is open in X for every open set Vin Y. Fix p e X and e > 0, let V be the set of ally e Y such that dr(Y,f(p)) < e. Then Vis open; hencef- 1(V) is open; hence there exists b > 0 such that x ef- 1(V)as soon as dx(P, x) < b. But if x e 1- 1(V), then f(x) e V, so that dr(f(x),f(p)) < e. This completes the proof. Corollary A mapping f of a metric space X into a metric space Y is continuous if and only if f- 1 ( C) is closed in X for every closed set C in Y. This follows from the theorem, since a set is closed if and only if its com- plement is open, and sincef- 1(Ec) = [f- 1(E)]c for every E c Y. We now turn to complex-valued and vector-valued functions, and to functions defined on subsets of Rk. 4.9 Theorem Let f and g be complex continuous functions on a metric space X. Thenf + g,fg, andf /g are continuous on X. In the last case, we must of course assume that g(x) \"I:- 0, for all x e X. Proof At isolated points of X there is nothing to prove. At limit points, the statement follows from Theorems 4.4 and 4.6. 4.10 Theorem (7) (a) Let / 1 , ••• , .h be real functions on a metric space X, and let f be the mapping of X into Rk defined by f(x) = (Ji(x), ... ,/4(x)) (x EX); then f is continuous if and only if each of the functions Ji, ... , /2 is continuous. (b) If f and g are continuous mappings of X into Rk, then f + g and f · g are continuous on X. The functions Ji, ... , /2 are called the components off. Note that f + g is a mapping into Rk, whereas f • g is a real function on X. 88 PllINCIPLES OF MATHEMATICAL ANALYSIS Proof Part (a) follows from the inequalities k i 11,(x) - f,(y) I =s; I f(x) - f(y) I = L lfi(x) - fi(y) I 2 ' t= 1 for j = I, ... , k. Part (b) follows from (a) and Theorem 4.9. 4.11 Examples If x 1 , ••• , xk are the coordinates of the point x e Rk, the functions <t,, defined by (8) are continuous on Rk, since the inequality I <Pi(x) - <Pi(Y) I :s; Ix - YI shows that we may take b = e in Definition 4.5. The functions <Pt are sometimes called the coordinate functions. Repeated application of Theorem 4.9 then shows that every monomial (9) x:1~2 • , , x::k where n1 , ••• , nk are nonnegative integers, is continuous on Rk. The same is true of constant multiples of (9), since constants are evidently continuous. It follows that every polynomial P, given by (10) is continuous on Rk. Here the coefficients cni··•nk are complex numbers, n1 , ••• , nk are nonnegative integers, and the sum in (IO) has finitely many terms. Furthermore, every rational function in x1, ... , xk, that is, every quotient of two polynomials of the form (10), is continuous on Rk wherever the denomi- nator is different from zero. From the triangle inequality one sees easily that (11) I Ix I - I YI I =s; Ix - YI (x, Y e Rk). Hence the mapping x ~ Ix I is a continuous real function on Rk. If now f is a continuous mapping from a metric space X into Rk, and if <P is defined on Xby setting <J,(p) = lf(p)I, it follows, by Theorem 4.7, that <J, is a continuous real function on X. 4.12 Remark We defined the notion of continuity for functions defined on a subset E of a metric space X. However, the complement of E in X plays no role whatever in this definition (note that the situation was somewhat different for limits of functions). Accordingly, we lose nothing of interest by discarding the complement of the domain off This means that we may just as well talk only about continuous mappings of one metric space into another, rather than CONTINUITY 89 of mappings of subsets. This simplifies statements and proofs of some theorems. We have already made use of this principle in Theorems 4.8 to 4.10, and will continue to do so in the following section on compactness. CONTINUITY AND COMPACTNESS 4.13 Definition A mapping f of a set E into Rk is said to be bounded if there is a real number M such that I f(x) I =s; M for all x e E. 4.14 Theorem Suppose f is a continuous mapping of a compact metric space X into a metric space Y. Then f(X) is compact. Proof Let {VIZ} be an open cover off(X). Since/is continuous, Theorem 4.8 shows that each of the sets /- 1(VIZ) is open. Since X is compact, there are finitely many indices, say a 1 , ••• , an, such that (12) X c/- 1(VIZ1) u ... u 1- 1(VIZn). (13) Since/(f- 1(£)) c E for every E c Y, (12) implies that /{X) C VIZ1 U ''' U VIZn, This completes the proof. Note: We have used the relation f(f- 1(E)) c E, valid for E c Y. If E c X, then/- 1(/(E)) => E; equality need not hold in either case. We shall now deduce some consequences of Theorem 4.14. 4.15 Theorem If f is a continuous mapping of a compact metric space X into Rk, then f(X) is closed and bounded. Thus, f is bounded. This follows from Theorem 2.41. The result is particularly important when .f is real: 4.16 Theorem Suppose f is a continuous real function on a compact metric space X, and (14) M = sup f(p), m = inf f(p). peX peX Then there exist points p, q e X such thatf(p) = M andf(q) = m. The notation in (14) means that Mis the least upper bound of the set of all numbersj(p), where p ranges over X, and that mis the greatest lower bound of tl1is set of numbers. 90 PllINCIPLES OF MATHEMATICAL ANALYSIS The conclusion may also be stated as follows: There exist points p and q in X such that f(q) ~f(x) ~f(p) for all x e X; that is, f attains its maximum (at p) and its minimum (at q). Proof By Theorem 4.15, f ( X) is a closed and bounded set of real num- bers; hence/ (X) contains M = supf(X) by Theorem 2.28. and m = inff(X), 4.17 Theorem Suppose f is a continuous 1-1 mapping of a compact metric space X onto a metric space Y. Then the inverse mapping 1- 1 defined on Y by (xe X) is a continuous mapping of Y onto X. Proof Applying Theorem 4.8 to .r- 1 in place of/, we see that it suffices to prove that/(V) is an open set in Y for every open set Vin X. Fix such a set V. The complement V c of V is closed in X, hence compact (Theorem 2.35); hence f(Vc) is a compact subset of Y (Theorem 4.14) and so is closed in Y (Theorem 2. 34). Since .f is one-to-one and onto, f ( V) is the complement off ( V c). Hence f ( V) is open. 4.18 Definition Let/be a mapping of a metric space X into a metric space Y. We say that/ is uniformly continuous on X if for every e > 0 there exists{)> 0 such that (15) dy(f(p),f(q)) < B for all p and q in X for which dx(P, q) < b. Let us consider the differences between the concepts of continuity and of uniform continuity. First, uniform continuity is a property of a function on a set, whereas continuity can be defined at a single point. To ask whether a given function is uniformly continuous at a certain point is meaningless. Second, if f is continuous on X, then it is possible to find, for each e > 0 and for each point p of X, a number b > 0 having the property specified in Definition 4.5. This b depends one and on p. If f is, however, uniformly continuous on X, then it is possible, for each e > 0, to find one number {) > 0 which will do for all points p of X. Evidently, every uniformly continuous function is continuous. That the two concepts are equivalent on compact sets follows from the next theorem. CONTINUITY 91 4.19 Theorem Let f be a continuous mapping of a compact metric space X into a metric space Y. Then f is uniformly continuous on X. (16) (17) (18) (19) (20) Proof Let e > 0 be given. Since f is continuous, we can associate to each point p e X a positive number <J,(p) such that q e X, dx(P, q) < <J,(p) implies B dr(f(p), f(q)) < 2· Let J(p) be the set of all q e X for which dx(P, q) < ½<J>(p). Since p e J(p), the collection of all sets J(p) is an open cover of X; and since Xis compact, there is a finite set of points p 1, .•• , Pn in X, such that X C J(p1) U • • • U J(pn). We put b = ½ min [<P(P1), •.. , <P(Pn)]. Then b > 0. (This is one point where the finiteness of the covering, in- herent in the definition of compactness, is essential. The minimum of a finite set of positive numbers is positive, whereas the inf of an infinite set of positive numbers may very well be 0.) Now let q and p be points of X, such that dx(P, q) < b. By (18), there is an integer m, 1 ~ m ~ n, such that p e J (Pm); hence and we also have dx(q, Pm) ~ dx(P, q) + dx(P, Pm) < b + ½</>(Pm) =s; <J>(pm). Finally, (16) shows that therefore dy(f(p),f(q)) =s; dy(f(p),f(Pm)) + dy(f(q),f(Pm)) < B. This completes the proof. An alternative proof is sketched in Exercise 10. We now proceed to show that compactness is essential in the hypotheses of Theorems 4.14, 4.15, 4.16, and 4.19. 4.20 Theorem Let E be a noncompact set in R 1 • Then (a) there exists a continuous function on E which is not bounded,· (b) there exists a continuous and bounded function on E which has no • maxzmum. If, in addition, E is bounded, then 92 PRINCIPLES OF MATHEMATICAL ANALYSIS (21) (22) (23) (c) there exists a continuous function on E which is not uniformly • continuous. Proof Suppose first that E is bounded, so that there exists a limit point x0 of E which is not a point of E. Consider 1 f(x)=-- x-x0 (x e E). This is continuous on E (Theorem 4.9), but evidently unbounded. To see that (21) is not uniformly continuous, let e > 0 and~> 0 be arbitrary, and choose a point x e E such that Ix - x 0 I < ~- Taking t close enough to x 0 , we can then make the difference lf(t) - f(x) I greater than e, although It - xi < ~- Since this is true for every~> O,f is not uniformly continu- ous on E. The function g given by l g(x) = 1 + (x - x0) 2 (xeE) is continuous on E, and is bounded, since O < g(x) < 1. It is clear that sup g(x) = 1, xeE whereas g(x) < l for all x e E. Thus g has no maximum on E. Having proved the theorem for bounded sets E, let us now suppose that E is unbounded. Then f(x) = x establishes (a), whereas x2 h(x) = I 2 +x (xeE) establishes (b), since sup h(x) = 1 xeE and h(x) < 1 for all x e E. Assertion (c) would be false if boundedness were omitted from the hypotheses. For, let E be the set of all integers. Then every function defined on E is uniformly continuous on E. To see this, we need merely take~< 1 in Definition 4.18. We conclude this section by showing that compactness is also essential in Theorem 4.17. CONTINUITY 93 4.21 Example Let X be the half-open interval [O, 2n) on the real line, and let f be the mapping of X onto the circle Y consisting of all points whose distance from the origin is 1, given by (24) f(t) = (cost, sin t) (0 ~ t < 2n). The continuity of the trigonometric functions cosine and sine, as well as their periodicity properties, will be established in Chap. 8. These results show that f is a continuous 1-1 mapping of X onto Y. However, the inverse mapping (which exists, since f is one-to-one and onto) fails to be continuous at the point (1, 0) = f(O). Of course, X is not com- pact in this example. (It may be of interest to observe that r- 1 fails to be continuous in spite of the fact that Y is compact!) CONTINUITY AND CONNECTEDNESS 4.22 Theorem If f is a continuous mapping of a metric space X into a metric space Y, and if E is a connected subset of X, then f(E) is connected. Proof Assume, on the contrary, that/(£)= Au B, where A and Bare nonempty separated subsets of Y. Put G =En f- 1(A), H =En f- 1(B). Then E =Gu H, and neither G nor His empty. Since Ac A (the closure of A), we have G c/- 1(.A); the latter set is closed, since/is continuous; hence G c/- 1(.A). It follows that/(G) c .A. Since f(H) =Band An Bis empty, we conclude that G n His empty. The same argument shows that G n His empty. Thus G and Hare separated. This is impossible if E is connected. 4.23 Theorem Let f be a continuous real function on the interval [a, b ]. If f(a) <f(b) and if c is a number such that f(a) < c <f(b), then there exists a point x e (a, b) such that f(x) = c. A similar result holds, of course, if /(a) > f(b). Roughly speaking, the theorem says that a continuous real function assumes all intermediate values on an interval. Proof By Theorem 2.47, [a, b] is connected; hence Theorem 4.22 shows that f([a, b ]) is a connected subset of R 1 , and the assertion follows if we appeal once more to Theorem 2.47. 4.24 Remark At first glance, it might seem that Theorem 4.23 has a converse. That is, one might think that if for any two points x 1 < x 2 and for any number c between/(x1) and/(x 2) there is a point x in (x 1 , x 2) such that/(x) = c, then/ must be continuous. That this is not so may be concluded from Example 4.27(d). 94 PRINCIPLES OF MATHEMATICAL ANALYSIS DISCONTINUITIES If x is a point in the domain of definition of the function f at which f is not continuous, we say that/is discontinuous at x, or that/ has a discontinuity at x. If f is defined on an interval or on a segment, it is customary to divide discon- tinuities into two types. Before giving this classification, we have to define the right-hand and the left-hand limits offatx, which we denote by/(x+) and/(x-), respectively. 4.25 Definition Let/ be defined on (a, b). Consider any point x such that a ~ x < b. We write f(x+) =q if f(tn) ) q as n ) oo, for all sequences {tn} in (x, b) such that tn ) x. To obtain the definition off (x - ), for a < x ~ b, we restrict ourselves to sequences { tn} in (a, x). It is clear that any point x of (a, b), limf(t) exists if and only if t➔ x f(x+) = f(x-) = lim/(t). t➔ x 4.26 Definition Let f be defined on (a, b). If f is discontinuous at a point x, and if f(x +) and f (x-) exist, then./ is said to have a discontinuity of the first kind, or a simple discontinuity, at x. Otherwise the discontinuity is said to be of the second kind. There are two ways in which a function can have a simple discontinuity: either f(x+) =/:, f(x-) [in which case the value /(x) is immaterial], or f(x +) = f (x - ) =/:- f(x). 4.27 Examples (a) Define l f(x) = 0 (x rational), (x irrational). Then/has a discontinuity of the second kind at every point x. since neither f (x +) nor/ (x-) exists. (b) Define /(x) = X 0 (x rational), (x irrational). CONTINUITY 9S Then f is continuous at x = 0 and has a discontinuity of the second kind at every other point. (c) Define X + 2 ( - 3 < X < - 2), f(x) = -x - 2 (-2 ~ X < 0), X + 2 (0 ~ X < 1). Then f has a simple discontinuity at x = 0 and is continuous at every other point of ( - 3, 1 ). (d) Define . l s1n- f(x) = X (x ¥= 0), 0 (x = 0). Since neither f (0 +) nor f (0-) exists, f has a discontinuity of the second kind at x = 0. We have not yet shown that sin xis a continuous function. If we assume this result for the moment, Theorem 4. 7 implies that f is continuous at every point x ¥= 0. MONOTONIC FUNCTIONS We shall now study those functions which never decrease (or never increase) on a given segment. 4.28 Definition Let f be real on (a, b). Then f is said to be monotonically increasing on (a, b) if a< x < y < b implies f(x) ~f(y). If the last inequality is reversed, we obtain the definition of a monotonically decreasing function. The class of monotonic functions consists of both the increasing and the decreasing functions. 4.29 Theorem Let f be monotonically increasing on (a, b). Then f(x+) and f(x-) exist at every point of x of (a, b). More precisely, (25) (26) sup f(t) =f(x-) ~f(x) ~f(x+) = inf f(t). a<t<x x<t<b F1,rthermore, if a < x < y < b, then f(x+) ~f(y-). Analogous results evidently hold for monotonically decreasing functions. 96 PRINCIPLES OF MATHEMATICAL ANALYSIS (27) (28) (29) (30) Proof By hypothesis, the set ofnumbersf(t), where a< t < x, is bounded above by the number f (x), and therefore has a least upper bound which we shall denote by A. Evidently A 5:.f(x). We have to show that A =f(x-). Let e > 0 be given. It follows from the definition of A as a least upper bound that there exists b > 0 such that a < x - b < x and A - e <f(x - b) 5:. A. Since f is monotonic, we have f (x - b) 5:. f (t) 5:. A (x - b < t < x). Combining (27) and (28), we see that lf(t) - A I < e (x - b < t < x). Hencef(x-) = A. - The second half of (25) is proved in precisely the same way. Next, if a < x < y < b, we see from (25) that .. f(x+) = inf f(t) = inf f(t). x<t<b x<t<y The last equality is obtained by applying (25) to (a, y) in place of (a, b). Similarly, f(y-) = sup f(t) = sup f(t ). a<t<y x<t<y Comparison of (29) and (30) gives (26). Corollary Monotonic functions have no discontinuities of the second kind. This corollary implies that every monotonic function is discontinuous at a countable set of points at most. Instead of appealing to the general theorem whose proof is sketched in Exercise 17, we give here a simple proof which is applicable to monotonic functions. 4.30 Theorem Let f be monotonic on (a, b). Then the set of points of (a, b) at which f is discontinuous is at most countable. Proof Suppose, for the sake of definiteness, that f is increasing, and let E be the set of points at which f is discontinuous. With every point x of E we associate a rational number r(x) such that f(x-) < r(x) <fix+). CONTINUITY 97 Since x1 < x 2 implies f(x 1 +) ~f(x 2 - ), we see that r(x1) ¥= r(x2 ) if X1 :/: X2. We have thus established a 1-1 correspondence between the set E and a subset of the set of rational numbers. The latter, as we know, is count- able. 4.31 Remark It should be noted that the discontinuities of a monotonic function need not be isolated. In fact, given any countable subset E of (a, b), which may even be dense, we can construct a function f, monotonic on (a, b), discontinuous at every point of E, and at no other point of (a, b). To show this, let the points of E be arranged in a sequence {xn}, n = I, 2, 3,.... Let {en} be a sequence of positive numbers such that I:cn converges. Define (31) f(x) = L Cn (a< x < b). Xn<x The summation is to be understood as follows: Sum over those indices n for which Xn < x. If there are no points Xn to the left of x, the sum is empty; following the usual convention, we define it to be zero. Since (31) converges absolutely, the order in which the terms are arranged is immaterial. We leave the verification of the following properties off to the reader: (a) f is monotonically increasing on (a, b); (b) f is discontinuous at every point of E; in fact, f(xn+) - f(xn-) =en• (c) f is continuous at every other point of (a, b). Moreover, it is not hard to see thatf{x-) =f(x) at all points of(a, b). If a function satisfies this condition, we say that f is continuous from the left. If the summation in (31) were taken over all indices n for which xn ~ x, we would havef(x+) = f(x) at every point of (a, b); that is, f would be continuous from the right. Functions of this sort can also be defined by another method; for an example we ref er to Theorem 6.16. INFINITE LIMITS AND LIMITS AT INFINITY To enable us to operate in the extended real number system, we shall now enlarge the scope of Definition 4.1, by reformulating i·t in terms of neighborhoods. For any real number x, we have already defined a neighborhood of x to be any segment (x - b, x + <5). 98 PRINCIPLES OF MATHEMATICAL ANALYSIS 4.32 Definition For any real c, the set of real numbers x such that x > c is called a neighborhood of+ oo and is written (c, + oo ). Similarly, the set ( - oo, c) is a neighborhood of - oo. 4.33 Definition Let f be a real function defined on E c R. We say that f(t) ➔ A as t ➔ x, where A and x are in the extended real number system, if for every neighborhood U of A there is a neighborhood V of x such that V n E is not empty, and such that/(t) e U for all t e V n E, t ¥= x. A moment's consideration will show that this coincides with Definition 4.1 when A and x are real. The analogue of Theorem 4.4 is still true, and the proof offers nothing new. We state it, for the sake of completeness. 4.34 Theorem Let f and g be defined on E c R. Suppose Then f(t) ➔ A, (a) f(t) ) A' implies A' = A. (b) (f + g)(t) ) A + B, (c) (fg)(t) ) AB, (d) (f /g)(t) ) A/B, as t ➔ x. provided the right members of (b), (c), and (d) are defined. Note that oo - oo, 0 · oo, 00/00, A/0 are not defined (see Definition 1.23). EXERCISES 1. Suppose/ is a real function defined on R 1 which satisfies lim [/(x + h)-f(x- h)] =0 for every x e R 1 • Does this imply that f is continuous? 2. If/ is a continuous mapping of a metric space X into a metric space Y, prove that /(E) cf(E) for every set E c X. (E denotes the closure of E.) Show, by an example, that /(E) can be a proper subset of f(E). 3. Let /be a continuous real function on a metric space X. Let Z (/) (the zero set of/) be the set of all p e X at which /(p) = 0. Prove that Z(/) is closed. 4. Let / and g be continuous mappings of a metric space X into a metric space Y, CONTINUITY 99 and let Ebe a dense subset of X. Prove that f(E) is dense in f(X). If g(p) = f(p) for all p e E, prove that g(p) = f(p) for all p e X. (In other words, a continuous mapping is determined by its values on a dense subset of its domain.) 5. If/ is a real continuous function defined on a closed set E c R 1, prove that there exist continuous real functions g on R 1 such that g(x) = f(x) for all x e E. (Such functions g are called continuous extensions off from E to R 1 .) Show that the result becomes false if the word ''closed'' is omitted. Extend the result to vector- valued functions. Hint: Let the graph of g be a straight line on each of the seg- ments which constitute the complement of E (compare Exercise 29, Chap. 2). The result remains true if R 1 is replaced by any metric space, but the proof is not so simple. 6. If f is defined on E, the graph off is the set of points (x, /(x)), for x e E. In partic- ular, if Eis a set of real numbers, and/'is real-valued, the graph of /is a subset of the plane. Suppose E is compact, and prove that / is continuous on E if and only if its graph is compact. 7. If E c X and if f is a function defined on X, the restriction off to E is the function g whose domain of definition is E, such that g(p) =f(p) for p e E. Define/and g on R 2 by: /(0, 0) = g(O, 0) = 0, j'(x, y) = xy 2 /(x 2 + y 4 ), g(x, y) = xy 2 /(x 2 + y 6 ) if (x, y) i= (0, 0). Prove that / is bounded on R 2 , that g is unbounded in every neighborhood of (0, 0), and that f is not continuous at (0, O); nevertheless, the restrictions of both f and g to every straight line in R 2 are continuous! 8. Let/' be a real uniformly continuous function on the bounded set E in R 1 • Prove that f is bounded on E. Show that the conclusion is false if boundedness of E is omitted from the hypothesis. 9. Show that the requirement in the definition of uniform continuity can be rephrased as follows, in terms of diameters of sets: To every e > 0 there exists a 8 > 0 such that diam /(E) < e for all E c X with diam E < 8. 10. Complete the details of the following alternative proof of Theorem 4.19: If f is not uniformly continuous, then for some e > 0 there are sequences {pn}, {qn} in X such that dx(Pn, qn) ► 0 but dy(f(pn),f(qn)) > e. Use Theorem 2.37 to obtain a contra- diction. 11. Suppose f is a uniformly continuous mapping of a metric space X into a metric space Y and prove that {/(xn)} is a Cauchy sequence in Y for every Cauchy se- quence {xn} in X. Use this result to give an alternative proof of the theorem stated in Exercise 13. 12. A uniformly continuous function of a uniformly continuous function is uniformly • continuous. State this more precisely and prove it. 13. Let E be a dense subset of a metric space X, and let/' be a uniformly continuous real function defined on E. Prove that f has a continuous extension from E to X 100 PRINCIPLES OF MATHEMATICAL ANALYSIS (see Exercise S for terminology). (Uniqueness follows from Exercise 4.) Hint: For each p e X and each positive integer n, let Vn(p) be the set of all q e E with d(p, q) < l/n. Use Exercise 9 to show that the intersection of the closures of the sets /(V1(p)), /(V2(p)), ... , consists of a single point, say g(p), of R1. Prove that the function g so defined on X is the desired extension off. Could the range space R 1 be replaced by Rk? By any compact metric space? By any complete metric space? By any metric space? 14. Let I = [O, 1] be the closed unit interval. Suppose/ is a continuous mapping of / into I. Prove that /(x) = x for at least one x e J. 15. Call a mapping of X into Y open if/( V) is an open set in Y whenever Vis an open set in X. Prove that every continuous open mapping of R 1 into R 1 is monotonic. 16. Let [x] denote the largest integer contained in x, that is, [x] is the integer such that x - l < [x]:;;; x; and let (x) = x - [x] denote the fractional part of x. What discontinuities do the functions [x] and (x) have? 17. Let/be a real function defined on (a, b). Prove that the set of points at which/ has a simple discontinuity is at most countable. Hint: I ... et E be the set on which f(x-) <f(x+ ). With each point x of E, associate a triple (p, q, r) of rational numbers such that (a) f(x-) < p <f(x+ ), (b) a< q < t < x implies/(t) <p, (c) x < t < r < b implies/(t) > p. The set of all such triples is countable. Show that each triple is associated with at most one point of E. Deal similarly with the other possible types of simple dis- • • • cont1nu1t1es. 18. Every rational x can be written in the form x = m/n, where n > 0, and m and n are integers without any common divisors. When x = 0, we take n = l. Consider the function f defined on R 1 by 0 f(x) = 1 - n (x irrational), m x=-. n Prove that f is continuous at every irrational point, and that f l1as a simple discon- tinuity at every rational point. 19. Suppose / is a real function with domain R 1 which has the intermediate value property: If /(a)< c <f(b), then/(x) = c for some x between a and b. Suppose also, for every rational r, that the set of all x with/(x) = r is closed. Prove that f is continuous. Hint: If Xn ➔ Xo but f(xn) > r > f(xo) for some r and all n, then f(tn) = r for some In between Xo and x,.; thus tn ➔ Xo. Find a contradiction. (N. J. Fine, Amer. Math. Monthly, vol. 73, 1966, p. 782.) CONTINUITY 101 20. If Eis a nonempty subset of a metric space X, define the distance from x e X to E by PE(x) = inf d(x, z). :reE (a) Prove that PE(x) = 0 if and only if x e E. (b) Prove that PE is a uniformly continuous function on X, by showing that I PE(x) - PE(Y) I =:;: d(x, y) for all x e X, ye X. Hint: pE(x) =:;: d(x, z) =:;: d(x, y) + d(y, z), so that PE(x) =:;: d(x, y) + pE(y). 21. Suppose K and Fare disjoint sets in a metric space X, K is compact, Fis closed. Prove that there exists 8 > 0 such that d(p, q) > 8 if p e K, q e F. Hint: PF is a continuous positive function on K. Show that the conclusion may fail for two disjoint closed sets if neither is compact. 22. Let A and B be disjoint nonempty closed sets in a metric space X, and define p,.(p) f(p) = p,.(p) + P s(p) (p E X). Show that/ is a continuous function on X whose range lies in [O, 1], that/(p) = 0 precisely on A and/(p) = 1 precisely on B. This establishes a converse of Exercise 3: Every closed set A c X is Z(f) for some continuous real / on X. Setting V = J- 1([0, ½)), w = 1- 1((½, 1]), show that V and Ware open and disjoint, and that A c V, B c W. (Thus pairs of disjoint closed sets in a metric space can be covered by pairs of disjoint open sets. This property of metric spaces is called normality.) 23. A real-valued function f defined in (a, b) is said to be convex if f( Ax+ (1 - ,\\)y) =:;: ,\\f(x) + (1 - ,\\)/(y) whenever a < x < b, a < y < b, 0 < ,\\ < 1. Prove that every convex function is continuous. Prove that every increasing convex function of a convex function is convex. (For example, if/ is convex, so is e1 .) If /is convex in (a, b) and if a< s < t < u < b, show that f_(t_) _-_f(_s) f(u) - f(s) < f(u) - f(t) =:;:---_---. t-s u-s u-t 24. Assume that f is a continuous real function defined in (a, b) such that I x + Y =:;: f(x) + f(y) 2 2 for all x, ye (a, b). Prove that/is convex. 102 PRINCIPLES OF MATHEMATICAL ANALYSIS 25. If Ac Rt and B c Rt, define A+ B to be the set of all sums x + y with x e A, yeB. (a) If K is compact and C is closed in Rt, prove that K + C is closed. Hint: Take z ¢ K + C, put F= z- C, the set of all z- y with ye C. Then K and Fare disjoint. Choose 8 as in Exercise 21. Show that the open ball with center z and radius 8 does not intersect K + C. (b) Let oc be an irrational real number. Let C1 be the set of all integers, let C2 be the set of all noc with n E C1, Show that C1 and C2 are closed subsets of R 1 whose sum CJ + C 2 is not closed, by showing that C 1 + C 2 is a countable dense subset of R 1 • 26. Suppose X, Y, Z are metric spaces, and Y is compact. Let f map X into Y, let g be a continuous one-to-one mapping of Y into Z, and put h(x) = g(/'(x)) for XE X. Prove that f is uniformly continuous if h is uniformly continuous. Hint: g- 1 has compact domain g( Y), and f(x) = g- 1(h(x)). Prove also that f is continuous if h is continuous. Show (by modifying Example 4.21, or by finding a different example) that the compactness of Y cannot be omitted from the hypotheses, even when X and Z are compact. DIFFERENTIATION In this chapter we shall (except in the final section) confine our attention to real functions defined on intervals or segments. This is not just a matter of con- venience, since genuine differences appear when we pass from real functions to vector-valued ones. Differentiation of functions defined on Rk will be discussed in Chap. 9. THE DERIVATIVE OF A REAL FUNCTION 5.1 Definition Let/ be defined (and real-valued) on [a, b]. For any x e [a, b] form the quotient (1) and define (2) </>(t) = f(t) - f (x) t-x (a < t < b, t =F x), f'(x) = lim </>(t ), t➔ x 104 PRINCIPLES OF MATHEMATICAL ANALYSIS provided this limit exists in accordance with Definition 4.1. We thus associate with the function f a function f' whose domain is the set of points x at which the limit (2) exists; f' is called the derivative off. If f' is defined at a point x, we say that f is differentiable at x. If f' is defined at every point of a set E c: [a, b], we say that/ is differentiable on E. It is possible to consider right-hand and left-hand limits in (2); this leads to the definition of right-hand and left-hand derivatives. In particular, at the endpoints a and b, the derivative, if it exists, is a right-hand or left-hand deriva- tive, respectively. We shall not, however, discuss one-sided derivatives in any detail. If f is defined on a segment (a, b) and if a< x < b, then f'(x) is defined by (1) and (2), as above. Butf'(a) and/'(b) are not defined in this case. 5.2 Theorem Letf be defined on [a, b]. /ff is differentiable at a point x e [a, b], then f is continuous at x. Proof As t ➔ x, we have, by Theorem 4.4, f(t) - f(x) , f(t) - f (x) = --- • (t - x) > f (x) · 0 = 0. t-x The converse of this theorem is not true. It is easy to construct continuous functions which fail to be differentiable at isolated points. In Chap. 7 we shall even become acquainted with a function which is continuous on the whole line without being differentiable at any point! 5.3 Theorem Suppose f and g are defined on [a, b] and are differentiable at a point x e [a, b]. Then/+ g, fg, and f/g are differentiable at x, and (a) (f + g)'(x) = f'(x) + g'(x); (b) (fg)'(x) = f'(x)g(x) + f(x)g'(x); (c) f '(x) = g(x)f'(x) - g'(x)f(x). g . g2(x) In (c), we assume of course that g(x) :I= 0. Proof (a) is clear, by Theorem 4.4. Leth = fg. Then h(t) - h(x) = f(t )[g(t) - g(x)] + g(x)[f(t) - f(x)]. DIFFERENTIATION 105 If we divide this by t - x and note that f(t) > f(x) as t > x (Theorem 5.2), (b) follows. Next, let h = f/g. Then h(t) - h(x) = 1 g(x)f(t) - f(x) _ f(x) g(t) - g(x) . t - X g(t )g(x) t - X t - X Letting t > x, and applying Theorems 4.4 and 5.2, we obtain (c). 5.4 Examples The derivative of any constant is clearly zero. If/ is defined by f(x) = x, thenf'(x) = 1. Repeated application of (b) and (c) then shows that x 11 is differentiable, and that its derivative is nx11 - 1, for any integer n (if n < 0, we have to restrict ourselves to x :I= 0). Thus every polynomial is differentiable, and so is every rational function, except at the points where the denominator is zero. The following theorem is known as the ''chain rule'' for differentiation. It deals with differentiation of composite functions and is probably the most important theorem about derivatives. We shall meet more general versions of it in Chap. 9. 5.5 Theorem Suppose f is continuous on [a, b],f'(x) exists at some point x E [a, b ], g is defined on an interval I tt-·hich contains the range off, and g is differentiable at the point f (x). If' h(t) = g(f(t)) (a~ t ~ b), then h is differentiable at x, and (3) h'(x) = g'(f(x))f'(x). Proof Let y = f (x). By the definition of the derivative, we have ( 4) f(t) - f(x) = (t - x)[f'(x) + u(t )], (5) (6) g(s) - g(y) = (s - y)[g'(y) + v(s)], where t e [a, b], s e /, and u(t) ➔ 0 as t ➔ x, v(s) > 0 ass > y. Lets =f(t). Using first (5) and then ( 4), we obtain h(t) - h(x) = g(f(t )) - g(f (x)) = [f(t) - f(x)] · [g'(y) + v(s)] = (t - x) · [f'(x) + u(t )] · [g'(y) + v(s)], or, if t :I= x, h(t) - h(x) = [g'(y) + v(s)] · [f'(x) + u(t)]. t-x Letting t > x, we see that s > y, by the continuity· off, so that the right side of (6) tends to g'(y)f'(x), which gives (3). 106 PRINCIPLES OF MATHEMATICAL ANALYSIS 5.6 Examples (7) (8) (9) (10) (11) (a) Let/ be defined by . 1 X Slll- f(x) = X (x :I= 0), 0 (x = 0). Taking for granted that the derivative of sin x is cos x (we shall discuss the trigonometric functions in Chap. 8), we can apply Theorems 5.3 and 5.5 whenever x -::/:, 0, and obtain '( ) . 1 1 1 f X = SID - - -COS - X X X (x -::/:- 0). At x = 0, these theorems do not apply any longer, since 1/x is not defined there, and we appeal directly to the definition: for t :I= 0, f(t) - f(O) . 1 ---- = sin - . t- 0 t As t > 0, this does not tend to any limit, so that f'(O) does not exist. ( b) Let f be defined by 2 • 1 X Slll- f(x) = X (x :I= 0), 0 (x = 0), As above, we obtain f'(x) = 2x sin_!_ - cos_!_ X X (x :I= 0). At x = 0, we appeal to the definition, and obtain f(t) - t(o) . 1 I I 1---- = t SID - ~ t t-0 t (t :I= O); letting t > 0, we see that f'(O) = 0. Thus f is differentiable at all points x, but f' is not a continuous function, since cos (1/x) in (10) does not tend to a limit as x > 0. DIFFERENTIATION 107 MEAN VALUE THEOREMS 5.7 Definition Let/ be a real function defined on a metric space X. We say that/has a local maximum at a point p e X if there exists~ > 0 such thatf(q) ~ f(p) for all q e X with d(p, q) < ~- Local minima are defined likewise. Our next theorem is the basis of many applications of differentiation. 5.8 Theorem Let f be defined on [a, b]; if f has a local maximum at a point x e (a, b), and if f'(x) exists, thenj''(x) = 0. The analogous statement for local minima is of course also true. Proof Choose~ in accordance with Definition 5.7, so that a < x - ~ < x < x + ~ < b. If x - ~ < t < x, then f_(t_)_-_f(_x) ~ O. t-x Letting t > x, we see thatf'(x) ~ 0. If x < t < x + ~, then f(t) -f(x) 0 ----~' t-x which shows that f '(x) ~ 0. Hence f'(x) = 0. 5.9 Theorem If f and g are continuous real functions on [a, b] which are differentiable in (a, b), then there is a point x e (a, b) at a·hich (12) [f(b) - f(a)]g'(x) = [g(b) - g(a)]f'(x). Note that differentiability is not required at the endpoints. Proof Put h(t) = [f(b) - f(a)]g(t) - [g(b) - g(a)]f(t) (a~ t ~ b). Then h is continuous on [a, b], h is differentiable in (a, b), and h(a) = f(b)g(a) - f(a)g(b) = h(b). To prove the theorem, we have to show that h'(x) = 0 for some x e (a, b). If h is constant, this holds for every x e (a, b). If h(t) > h(a) for some t e (a, b), let x be a point on [a, b] at which h attains its maximum 108 PRINCIPLES OF MATHEMATICAL ANALYSIS (Theorem 4.16). By (12), x e (a, b), and Theorem 5.8 shows that h'(x) = 0. If h(t) < h(a) for some t e (a, b), the same argument applies if we choose for x a point on [a, b] where h attains its minimum. This theorem is often called a generalized mean value theorem; the following special case is usually referred to as ''the'' mean value theorem: 5.10 Theorem If f is a real continuous function on [a, b] which is differentiable in (a, b), then there is a point x e (a, b) at which f(b) - f(a) = (b - a)f'(x). Proof Take g(x) = x in Theorem 5.9. 5.11 Theorem Suppose f is dijj'erentiable in (a, b). (a) Jff'(x) ~ Ofor all x e (a, b), then/ is monotonically increasing. (b) Jff'(x) = Ofor all x e (a, b), then/ is constant. (c) If f'(x) ~ 0 for all x e (a, b), then f is monotonically decreasing. Proof All conclusions can be read off from the equation f(x2) - f(x1) = (x2 - X1)f'(x), which is valid, for each pair of numbers x1 , x 2 in (a, b), for some x between x1 and x 2 • THE CONTINUITY OF DERir.ATIVES We have already seen [Example 5.6(b)] that a function/may have a derivative f' which exists at every point, but is discontinuous at some point. However, not every function is a derivative. In particular, derivatives which exist at every point of an interval have one important property in common with functions which are continuous on an interval: Intermediate values are assumed ( compare Theorem 4.23). The precise statement follows. 5.12 Theorem Suppose f is a real differentiable function on [a, b] and suppose f'(a) < l <f'(b). Then there is a point x e (a, b) such that f'(x) = l. A similar result holds of course if f'(a) > f'(b). Proof Put g(t) = f(t) - lt. Then g'(a) < 0, so that g(t1) < g(a) for some t1 e (a, b), and g'(b) > 0, so that g(t2) < g(b) for some t2 e (a, b). Hence g attains its minimum on [a, b] (Theorem 4.16) at some point x such that a < x < b. By Theorem 5.8, g'(x) = 0. Hence f'(x) = l. DIFFERENTIATION 109 Corollary If f is differentiable on [a, b ], then f' cannot /1ave any simple dis- continuities on [a, b ]. But/' may very well have discontinuities of the second kind. L'HOSPITAL'S RULE The following theorem is frequently useful in the evaluation of limits. 5.13 Theorem Suppose/ and g are real and differentiable in (a, b), and g'(x) =I= 0 for all x e (a, b), where - oo ~a< b ~ + oo. Suppose (13) If (14) or if (15) then (16) f'(x) g'(x) -+> A as x > a. f (x) > 0 and g(x) > 0 as x > a, g(x) > + oo as x > a, f_(x_) -+ A as x > a. g(x) The analogous statement is of course also true if x > b, or if g(x) -+ - oo in (15). Let us note that we now use the limit concept in the extended sense of Definition 4.33. (17) (18) (19) Proof We first consider the case in which - oo ~ A < + oo. Choose a real number q such that A < q, and then choose r such that A < r < q. By (13) there is a point c e (a, b) such that a< x < c implies f'(x) g'(x) < r. If a< x < y < c, then Theorem 5.9 shows that there is a point t e (x, y) such that f(x) - f(y) f '(t) ----=-<r. g(x) - g(y) g'(t) Suppose (14) holds. Letting x-+ a in (18), we see that f(y) < < g(y) - r q (a< y < c). 110 PRINCIPLES OF MATHEMATICAL ANALYSIS (20) (21) (22) Next, suppose (15) holds. Keeping y fixed in (18), we can choose a point c1 e (a, y) such that g(x) > g(y) and g(x) > 0 if a< x < c1 . Multi- plying (18) by [g(x) - g(y)]/g(x), we obtain f(x) < r _ rg(y) +f(y) ( ) a< X < C1 . g(x) g(x) g(x) If we let x > a in (20), (15) shows that there is a point c2 e (a, c1) such that f(x) g(x) < q Summing up, (19) and (21) show that for any q, subject only to the condition A < q, there is a point c2 such thatf(x)/g(x) < q if a< x < c2 . In the same manner, if - oo < A ~ + oo, and p is chosen so that p < A, we can find a point c3 such that f(x) p < - (a < X < C3), g(x) and (16) follows from these two statements. DERIVATIVES OF HIGHER ORDER 5.14 Definition If/has a derivative/' on an interval, and if/' is itself differen- tiable, we denote the derivative off' by f '' and call/'' the second derivative off Continuing in this manner, we obtain functions f,f',f'',/( 3 >, · · · ,f(n), each of which is the derivative of the preceding one. J<n> is called the nth deriva- tive, or the derivative of order n, off In order for J<n> (x) to exist at a point x,f<n-l) (t) must exist in a neighbor- hood of x ( or in a one-sided neighborhood, if x is an endpoint of the interval on which f is defined), and J<n - i > must be differentiable at x. Since J<n- i > must exist in a neighborhood of x,J<n- 2> must be differentiable in that neighborhood. TAYLOR'S THEOREM - 5.15 Theorem Suppose f is a real function on [a, b ], n is a positive integer, J<n-l) is continuous on [a, b],f<n>(t) exists for every t e (a, b). Let tx, P be distinct points of [a, b ], and define n-1/(k)(tx) (23) P(t) = L -- (t - tx)k. k=O k! DIFFERENTIATION 111 Then there exists a point x between IX and /3 such that (24) n. For n = 1, this is just the mean value theorem. In general, the theorem shows that f can be approximated by a polynomial of degree n - 1, and that (24) allows us to estimate the error, if we know bounds on lf<n>(x) I• (25) (26) (27) Proof Let M be the number defined by f(/3) = P(/3) + M(/3 - 1X)n and put g(t) =f(t) -P(t) - M(t - 1X)n (a~ t ~ b). We have to show that n !M = f<n>(x) for some x between IX and /3. By (23) and (26), (a< t < b). Hence the proof will be complete if we can show that g<n>(x) = 0 for some x between IX and f3. Since p<k>(IX) = [<k>(IX) fork= 0, ... , n - 1, we have (28) g(IX) = g'(IX) = ''' = g<n-l)(IX) = 0. Our choice of M shows that g(/3) = 0, so that g'(x1) = 0 for some x 1 between IX and /3, by the mean value theorem. Since g 1(1X) = 0, we conclude similarly that g''(x2) = 0 for some x 2 between IX and x1 . After n steps we arrive at the conclusion that g<n>(xn) = 0 for some Xn bet ween IX and Xn _ 1 , that is, between IX and /3. DIFFERENTIATION OF VECTOR-VALUED FUNCTIONS 5.16 Remarks Definition 5.1 applies without any change to complex functions f defined on [a, b], and Theorems 5.2 and 5.3, as well as their proofs, remain valid. If / 1 and/2 are the real and imaginary parts of I, that is, if f(t) = li(t) + if2(t) for a~ t ~ b, where/1(t) and/2(t) are real, then we clearly have (29) f'(x) = f{(x) + ifi(x); also, f is differentiable at x if and only if both / 1 and / 2 are differentiable at x. 112 PRINCIPLES OF MATHEMATICAL ANALYSIS Passing to vector-valued functions in general, i.e., to functions f which map [a, b] into some Rk, we may still apply Definition 5.1 to define f'(x). The term <p(t) in (1) is now, for each t, a point in Rk, and the limit in (2) is taken with respect to the norm of Rk. In other words, f'(x) is that point of Rk (if there is one) for which (30) lim f(t) - f(x) - f'(x) = 0, t➔x t - X and f' is again a function with values in Rk. If / 1 , •.. , fk are the components off, as defined in Theorem 4.10, then (31) f' = (/{, ... ,/;), and f is differentiable at a point x if and only if each of the functions / 1 , ••• , h is differentiable at x. Theorem 5.2 is true in this context as well, and so is Theorem 5.3(a) and {b), if Jg is replaced by the inner product f · g (see Definition 4.3). When we turn to the mean value theorem, however, and to one of its consequences, namely, L'Hospital's rule, the situation changes. The next two examples will show that each of these. results fails to be true for complex-valued functions. 5.17 Example Define, for real x, (32) f(x) = eix = cos x + i sin x. {The last expression may be taken as the definition of the complex exponential eix; see Chap. 8 for a full discussion of these functions.) Then (33) but (34) f(2n) - /(0) = 1 - 1 = 0, f'(x) = ieix, so that 1/'(x) I = 1 for all real x. Thus Theorem 5.10 fails to hold in this case. 5.18 Example On the segment (0, 1), define/(x) = x and (35) g(x) = x + x 2eilx 2 • Since I eit I = 1 for all real t, we see that (36) lim f(x) = 1. x➔O g(x) Next, (37) so that (38) Hence (39) and so (40) g'(x) = 1 + 2 2i i/x 2 x-- e X (0 < X < 1), lu'(x) I ~ 2i 2x-- x 2 -1~--1. X /'(x) 1 X =--~-- g'(x) lu'(x) I 2 - x lim f'(x) = 0. x➔o g'(x) DIFFERENTIATION 113 By (36) and ( 40), L'Hospital's rule fails in this case. Note also that g'(x) ¥: 0 on (0, 1 ), by (38). However, there is a consequence of the mean value theorem which, for purposes of applications, is almost as useful as Theorem 5.10, and which re- mains true for vector-valued functions: From Theorem 5.10 it follows that (41) IJ(b) -f(a) I ~ (b - a) sup 1/'(x) 1- a<x<b 5.19 Theorem Suppose f is a continuous mapping of [a, b] into Rk and f is differentiable in (a, b). Then there exists x E (a, b) such that jf(b) - f(a)I ~ (b - a)lf'(x)I. Proof1 Putz = f(b) - f(a), and define <p( t ) = z • f( t) ( a ~ t ~ b). Then <p is a real-valued continuous function on [a, b] which is differentia- ble in (a, b). The mean value theorem shows therefore that <p(b) - <p(a) = (b - a)<p'(x) = (b ·- a)z · f'(x) for some x E (a, b). On the other hand, <p( b) - <p( a) = z · f( b) - z · f( a) = z · z = I z I 2 • The Schwarz inequality now gives I z I 2 = ( b - a) I z · f' ( x) I ~ ( b - a) I z I I f' ( x) I . Hence lzl ~ (b - a)lf'(x)I, which is the desired conclusion. 1 V. P. Havin translated the second edition of this book into Russian and added this proof to the original one. 114 PRINCIPLES OF MATHEMATICAL ANALYSIS EXERCISES 1. Let/ be defined for all real x, and suppose that lf(x) - f(y) I ~ (x - Y) 2 for all real x and y. Prove that/ is constant. 2. Suppose/'(x) > 0 in (a, b). Prove that/is strictly increasing in (a, b), and let g be its inverse function. Prove that g is differentiable, and that (a< x < b). 3. Suppose g is a real function on R 1, with bounded derivative (say I g' I ~ M). Fix e > 0, and define/(x) = x + eg(x). Prove that/is one-to-one if e is small enough. (A set of admissible values of e can be determined which depends only on M.) 4. If Co+ C1 +···+ Cn-1 + Cn =0, 2 n n+l where Co, ... , Cn are real constants, prove that the equation Co+ Cix + · · · + Cn-ixn-i + Cnxn = 0 has at least one real root between O and 1. 5. Suppose/is defined and differentiable for every x > 0, and/'(x) ► 0 as x ► + oo. Put g(x) =f(x + 1)- /(x). Prove that g(x) ► 0 as x ► + oo. 6. Suppose (a) f is continuous for x ~ 0, (b) f'(x) exists for x > 0, (c) /'(O) = 0, (d) f' is monotonically increasing. Put g(x) =f(x) X and prove that g is monotonically increasing. (x >0) 7. Suppose /'(x), g'(x) exist, g '(x) -=I= 0, and /(x) = g(x) = 0. Prove that lim /(t) =/'(x). r➔x g(t) g'(x) {This holds also for complex functions.) 8. Suppose/' is continuous on [a, b] and e > 0. Prove that there exists 8 > 0 such that f(t) - f(x) _ f'(x) < 8 t-x DIFFERENTJA TION 115 whenever O < It - x I < 8, a :::;: x :::;: b, a :::;: t :::;: b. (This could be expressed by saying that/is uniformly differentiable on [a, b] if/' is continuous on [a, b].) Does this hold for vector-valued functions too? 9. Let f be a continuous real function on R 1, of which it is known that f'(x) exists for all x -=I= 0 and that f'(x) ► 3 as x ► 0. Does it follow that /'(O) exists? 10. Suppose/ and g are complex differentiable functio son (0, 1),/(x) ► 0, g(x) ► 0, f'(x) ► A, g'(x) · ► Bas x ► 0, where A and Bare c mplex numbers, B -=I= 0. Prove that lim/(x) = ~- x➔o g(x) B Compare with Example S.18. Hint: f(x) = f(x) _ A g(x) X • X +A· X. g(x) g(x) Apply Theorem S.13 to the real and imaginary parts of f(x)/x and g(x)/x. 11. Suppose/is defined in a neighborhood of x, and suppose/''(x) exists. Show that l. f(x + h) + f(x - h) - 2/(x) = f''( ) 1m h2 x . 11➔ 0 Show by an example that the limit may exist even if fn(x) does not. Hint: Use Theorem S.13. 12. If f(x) =Ix I 3, compute f'(x), fn(x) for all real x, and show that /< 3 >(0) does not exist. 13. Suppose a and c are real numbers, c > 0, and f is defined on [ - 1, 1] by x• sin (lxl-c) f(x) = 0 Prove the following statements: (a) f is continuous if and only if a > 0. (b) /'(O) exists if and only if a> 1. (c) f' is bounded if and only if a~ 1 + c. (d) f' is continuous if and only if a> 1 + c. (e) fn(O) exists if and only if a> 2 + c. (/) fn is bounded if and only if a ~ 2 + 2c. (g) f n is continuous if and only if a > 2 + 2c. (if X -=/= 0), (if X = 0). 14. Let f be a differentiable real function defined in (a, b). Prove that f is convex if and only if /' is monotonically increasing. Assume next that f''(x) exists for every x e (a, b), and prove that/is convex if and only if /''(x) ~ 0 for all x e (a, b). 15. Suppose a e R 1, /is a twice-differentiable real function on (a, oo ), and Mo, Mi, M2 are the least upper bounds of 1/(x} I, l/'(x) I, lf''(x) I, respectively, on (a, oo ). Prove that Mf:::;: 4Mo M2. 116 PRINCIPLES OF MATHEMATICAL ANALYSIS Hint: If h > 0, Taylor's theorem shows that f'(x) = ;h [f(x + 2h) - /(x)] - h/''(f) for some f e (x, x + 2h). Hence 1/'(x) I s hM2 + : 0 • To show that Mf = 4MoM2 can actually happen, take a= -1, define 2x 2 -1 f(x) = x 2 - 1 x 2 + 1 (-1 < X < 0), (0 S X < oo), and show that Mo= 1, M1 = 4, M2 = 4. Does Mf s 4M o M 2 hold for vector-valued functions too? 16. Suppose f is twice-differentiable on (0, oo ), /'' is bounded on (O, oo ), and /(x) > O as x ► oo. Prove that f'(x) ► 0 as x ► oo. Hint: Let a ► oo in Exercise 15. 17. Suppose f is a real, three times differentiable function on [-1, l], such that /(-1) =0, /(0) =0, /(1) = 1, /'(O) = 0. Prove that/< 3>(x) ~ 3 for some x e (-1, 1). Note that equality holds for !(x 3 + x 2). Hint: Use Theorem 5.15, with oc = 0 and /3 = ± 1, to show that there exist s e (0, 1) and t e (-1, 0) such that /< 3 >(s) + /< 3 >(t) = 6. 18. Suppose f is a real function on [a, b], n is a positive integer, and /<n- 1> exists for every t e [a, b]. Let oc, /3, and P be as in Taylor's theorem (5.15). Define Q(t) = f(t)- f(/3) t- /3 for t e [a, b ], t -=I= {3, differentiate f(t) - f(/3) = (t - /3)Q(t) n - 1 times at t = oc, and derive the following version of Taylor's theorem: Q<n-t>(oc) f(/3) = P(/3) + (n - 1) ! (/3 - oc)n, 19. Suppose I is defined in (-1, 1) and /'(0) exists. Suppose -1 < °'n < /3n < 1, ocn ► 0, and /3n ► 0 as n · ► oo. Define the difference quotients DIFFERENTIATION 117 Prove the following statements: (a) If 1Xn < 0 < fJn, then lim Dn = f'(O). (b) If O < 1Xn < f3n and {{Jn/(fJn - 1Xn)} is bounded, then lim Dn = f'(O). (c) If/' is continuous in (-1, 1), then lim Dn = f'(O). Give an example in which/is differentiable in (-1, 1) (but/' is not contin- uous at 0) and in which IXn , fJn tend to O in such a way that lim Dn exists but is differ- ent from /'(0). 20. Formulate and prove an inequality which follows from Taylor's theorem and which remains valid for vector-valued functions. 21. Let E be a closed subset of Ri. We saw in Exercise 22, Chap. 4, that there is a real continuous function/ on Ri whose zero set is E. Is it possible, for each closed set E, to find such an / which is differentiable on Ri, or one which is n times differentiable, or even one which has derivatives of all orders on Ri? 22. Suppose f is a real function on ( - oo, oo ). Call x a fixed point off if f(x) = x. (a) If /is differentiable and/'(t) cf=. 1 for every real t, prove that/has at most one fixed point. (b) Show that the function/ defined by J(t) = t + (1 + er)-i has no fixed point, although O </'(t) < 1 for all real t. (c) However, if there is a constant A < 1 such that 1/'(t) I ~ A for all real t, prove that a fixed point x of/ exists, and that x = lim Xn, where Xi is an arbitrary real number and Xn+1 =f(Xn) for n = 1, 2, 3, .... (d) Show that the process described in (c) can be visualized by the zig-zag path 23. The function f defined by f(x) = x3 + 1 3 has three fixed points, say IX, {J, y, where -2<1X<-l ' 0 < fJ < 1, 1 < y < 2. For arbitrarily chosen Xi, define {xn} by setting Xn + i = f(xn), (a) If Xi < IX, prove that Xn ► - oo as n ► oo. (b) If IX< Xi< y, prove that Xn ► fJ as n ► oo. (c) If y < Xi, prove that Xn ► + oo as n ► oo. Thus fJ can be located by this method, but IX and y cannot. 118 PRINCIPLES OF MATHEMATICAL ANALYSIS 24. The process described in part (c) of Exercise 22 can of course also be applied to functions that map (O, oo) to (0, oo ). Fix some oc > 1, and put 1 oc f(x) = 2 X +-x' oc + X g(x) = 1 + x· Both f and g have v; as their only fixed point in (O, oo ). Try to explain, on the basis of properties off and g, why the convergence in Exercise 16, Chap. 3, is so much more rapid than it is in Exercise 17. (Compare/' and g ', draw the zig-zags suggested in Exercise 22.) Do the same when O < oc < 1. 25. Suppose f is twice differentiable on [a, b], f(a) < 0, f(b) > 0, f'(x) ~ 8 > 0, and 0 ~f''(x) ~ M for all x E [a, b]. Let g be the unique point in (a, b) at which f(f) = 0. Complete the details in the following outline of Newton's method for com- puting f. (a) Choose X1 E (f, b), and define {xn} by f(xn) Xn+l = Xn - f'(Xn) • Interpret this geometrically, in terms of a tangent to the graph off. (b) Prove that Xn+l < Xn and that lim Xn = g, n-o oo (c) Use Taylor's theorem to show that f''(tn) 2 Xn+l - f = 2/'(Xn) (Xn - f) for some tn E (f, Xn), (d) If A= M/28, deduce that 0 ~ Xn+l - f ~ 1 [A(X1 - f)] 2 n. (Compare with Exercises 16 and 18, Chap. 3.) (e) Show that Newton's method amounts to finding a fixed point of the function g defined by f(x) g(x) = x - f'(x) . How does g '(x) behave for x near f? (/) Put/(x) =x 113 on (-oo, oo) and try Newton's method. What happens? DIFFERENTIATION 119 26. Suppose/ is differentiable on [a, b], f(a) = 0, and there is a real number A such that lf'(x) I s A lf(x) I on [a, b]. Prove that f(x) = 0 for all x E [a, b]. Hint: Fix Xo E [a, b], let Mo= sup! f(x)I, M1 = sup IJ'(x) I for as x s Xo. For any such x, lf(x) I s M1(Xo - a) s A(xo - a)Mo. Hence Mo = 0 if A(xo - a) < 1. That is,/= 0 on [a, Xo], Proceed. 27. Let</> be a real function defined on a rectangle R in the plane, given by as x s b, ex sy < {3. A solution of the initial-value problem y' = cp(x, y), y(a) = c (ex s cs /3) is, by definition, a differentiable function/ on [a, b] such that/(a) = c, ex s/(x) s /3, and f'(x) = cp(x, f(x)) (a<xsb). Prove that such a problem has at most one solution if there is a constant A such that I </>(x, Y2) - cp(x, Y1) I s A I Y2 - Y1 I whenever (x, Y1) ER and (x, Y2) E R. Hint: Apply Exercise 26 to the difference of two solutions. Note that this uniqueness theorem does not hold for the initial-value problem y' = yl/2, y(O) = 0, which has two solutions: f(x) = 0 and/(x) = x 2/4. Find all other solutions. 28. Formulate and prove an analogous uniqueness theorem for systems of differential equations of the form Y.1 = </>1(X, Y1, • • • , Yk), Note that this can be rewritten in the form y' = <l>(x, y), (j = 1, ... , k). y(a) = C where y = (Y1, ... , yk) ranges over a k-cell, <I> is the mapping of a (k + 1)-cell into the Euclidean k-space whose components are the functions c/>1, ... , <pk, and c is the vector (c1, ... , ck), Use Exercise 26, for vector-valued functions. 29. Specialize Exercise 28 by considering the system ' Y1=Y1+1 (j = 1, ... , k - 1 ), k Y~ = f(x) - L 01(x)y1, J=l where/, 01, ... , Ok are continuous real functions on [a, b], and derive a uniqueness theorem for solutions of the equation y<k> + Ok(x)y<k-t> + · · · + 02(x)y' + 01(x)y =f(x), subject to initial conditions y(a) = C1, y'(a) = C2, . . . ' THE RIEMANN-STIELTJES INTEGRAL The present chapter is based on a definition of the Riemann integral which depends very explicitly on the order structure of the real line. Accordingly, we begin by discussing integration of real-valued functions on intervals. Ex- tensions to complex- and vector-valued functions on intervals follow in later sections. Integration over sets other than intervals is discussed in Chaps. 10 and 11. DEFINITION AND EXISTENCE OF THE INTEGRAL 6.1 Definition Let [a, b] be a given interval. By a partition P of [a, b] we mean a finite set of points x 0 , x1 , •.• , Xn, where We write Ax,= x, - x,-1 (i=1, ... ,n). THE RIEMANN·STIELTJES INTEGRAL 121 Now suppose f is a bounded real function defined on [a, b ]. Corresponding to each partition P of [a, b] we put and finally (1) (2) M 1 = supf(x) m, = inff(x) n U(P,f) = L M, Ax,' i= 1 n L(P,f) = L m 1 dx 1 , i= 1 -b (X,-1 S XS X1), (Xi-1 S XS X1), f dx = inf U(P,f), a b f dx = sup L(P,f), _a where the inf and the sup are taken over all partitions P of [a, b]. The left members of (1) and (2) are called the upper and lower Riemann integrals off over [a, b], respectively. , If the upper and lower integrals are equal, we say that f is Riemann- integrable on [a, b], we write f E f!A (that, is, f!A denotes the set of Riemann- integrable functions), and we denote the common value of (1) and (2) by b (3) fdx, a or by b (4) f(x) dx. a This is the Riemann integral off over [a, b]. Since f is bounded, there exist two numbers, m and M, such that msf(x)sM (as x s b). Hence, for every P, m(b - a) s L(P,f) s U(P,f) s M(b - a), so that the numbers L(P,f) and U(P,f) form a bounded set. This shows that the upper and lower integrals are defined for every bounded function f The question of their equality, and hence the question of the integrability off, is a more delicate one. Instead of investigating it separately for the Riemann integral, we shall immediately consider a more general situation. 122 PRINCIPLES OF MATHEMATICAL ANALYSIS 6.2 Definition Let ~ be a monotonically increasing function on [a, b] (since ~(a) and ~(b) are finite, it follows that~ is bounded on [a, b]). Corresponding to each partition P of [a, b ], we write Li~t = ~(X1) - ~(X1-1), It is clear that a~,~ 0. For any real function f which is bounded on [a, b] we put n u(P,f, ~) = I M1 a~,, I= 1 n L(P,f, ~) = L m, a~i' i= 1 where M 1 , m 1 have the same meaning as in Definition 6.1, and we define -b (5) f d~ = inf U(P,f, ~), a b (6) f d~ = sup L(P,f, ~), _a the inf and sup again being taken over all partitions. If the left members of (5) and (6) are equal, we denote their common value by b (7) fd~ a or sometimes by (8) a This is the Riemann-Stieltjes integral ( or simply the Stieltjes integral) of /with respect to~, over [a, b]. If (7) exists, i.e., if (5) and (6) are equal, we say that f is integrable with respect to ~, in the Riemann sense, and write f e Bl(~). By taking ~(x) = x, the Riemann integral is seen to be a special case of the Riemann-Stieltjes integral. Let us mention explicitly, however, that in the general case ~ need not even be continuous. A few words should be said about the notation. We prefer (7) to (8), since the letter x which appears in (8) adds nothing to the content of (7). It is im- material which letter we use to represent the so-called ''variable of integration.\" For instance, (8) is the same as a THE IUEMANN•STIELTJES INTEGRAL 123 The integral depends on f, ix, a and b, but not on the variable of integration, which may as well be omitted. The role played by the variable of integration is quite analogous to that of the index of summation: The two symbols mean the same thing~ since each means c1 + c2 + · · · +en. Of course, no harm is done by inserting the variable of integration, and in many cases it is actually convenient to do so. We shall now investigate the existence of the integral (7). Without saying so every time,fwill be assumed real and bounded, and ix monotonically increas- ing on [a, b]; and, when there can be no misunderstanding, we shall write in b place of . a 6.3 Definition We say that the partition P* is a refinenzent of P if P* =:, P ( that is, if every point of P is a point of P *). Given two partitions, P 1 and P 2 , we say that P* is their common refinement if P* = P1 u P2 . 6.4 Theorem If P* is a refinement of P, then (9) and (10) L(P,f, ix)~ L(P*,f, ix) U(P*,f, ix)~ U(P,f, ix). Proof To prove (9), suppose first that P* contains just one point more than P. Let this extra point be x•, and suppose xi-l < x• < x1, where xi-l and x, are two consecutive points of P. Put w1 = inff(x) W2 = inff(x) (xi-i ~ x ~ x*), (x• ~ x ~ x 1). Clearly w1 ~ mi and w2 ~ mi, where, as before, mi= inff(x) Hence L(P*,f, ix) - L(P,f, ix) = w1[ix(x*) - ix(xi_ 1)] + w2 [oc(xi) - ix{x*)] - mi[ix(xi) - ix(x,_ 1)] = (w1 - m1)[oc(x*) - ix(x,_ 1)] + (w2 - mi)[ix(x1) - ix(x*)] ~ 0. If P• contains k points more than P, we repeat this reasoning k times, and arrive at (9). The proof of (10) is analogous. 124 PRINCIPLES OF MATHEMATICAL ANALYSIS b -b 6.S Theorem f da. ~ f da.. (11) (12) _a a Proof Let P* be the common refinement of two partitions P 1 and P 2 • By Theorem 6.4, L(P1,f, a.)~ L(P*,f. a.)~ U(P*,f, a.)~ U(P2 ,f, a.). Hence If P 2 is fixed and the sup is taken over all P 1 , (11) gives f da. ~ U(P2 ,f, a.). - The theorem follows by taking the inf over all P2 in (12). 6.6 Theorem f e af(a.) on [a, b] if and only if for every 8 > 0 there exists a partition P such that (13) (14) (15) U(P,f, a.) - L(P,f, a.) < 8. Proof For every P we have - L(P,f, a.)~ f da. ~ f da. ~ U(P,f, a.). - Thus (13) implies - 0 ~ f da. - f da. < 8. - Hence, if (13) can be satisfied for every 8 > 0, we have -f da. = f da., - that is, f e af(a.). Conversely, suppose f e af(a.), and let e > 0 be given. Then there exist partitions P 1 and P2 such that THE RIEMANN·STIELTJES INTEGRAL 12S We choose P to be the common refinement of P 1 and P2 • Then Theorem 6.4, together with (14) and (15), shows that B U(P,f, oc) ~ U(P2 ,f, oc) < f doc + 2 < L(P1,f, oc) + e ~ L(P,f, oc) + e, so that (13) holds for this partition P. Theorem 6.6 furnishes a convenient criterion for integrability. Before we apply it, we state some closely related facts. 6.7 Theorem (a) I/(13) holds for some P and some e, then (13) holds (with the same e) for every refinement of P. (b) If (13) holds for P = {x0 , ••• , xn} and if si, ti are arbitrary points in [xi-i, xi], then n L lf(si)-f(ti)I Lioci<e. i= 1 (c) If fe al(oc) and the hypotheses of(b) hold, then n b L f(t i) Lioci - f doc < e. i= 1 a Proof Theorem 6.4 implies (a). Under the assumptions made in (b), both/(si) andf(ti) lie in [mi, Mi], so that f(si) - f(t,)I ~ M, - mi. Thus n I lf(s,) - f(t ,) I Lioci ~ U(P,f, oc) - L(P,f, oc), i= 1 which proves (b). The obvious inequalities L(P,f, oc) ~ Lf(ti) Lioci ~ U(P,f,oc) and L(P,f, oc) ~ J f doc~ U(P,f, oc) prove (c). 6.8 Theorem If f is continuous on [a, b] thenfe al(oc) on [a, b]. (16) Proof Let e > 0 be given. Choose 17 > 0 so that [oc(b) - oc(a)]17 < e. Since f is uniformly continuous on [a, b] (Theorem 4.19), there exists a J > 0 such that lf(x) - f(t)I < 11 126 PRINCIPLES OF MATHEMATICAL ANALYSIS ifxe[a,b], te[a,b],and Ix-ti <b. If P is any partition of [a, b] such that Axi < b for all i, then {16) implies that (17) (i-1, ... ,n) and the ref ore n U(P,f, oc) - L(P,f, oc) = L (Mi - mi) ll.oc, i= 1 n ~ 'IL ll.oci = 17[oc(b) - oc(a)] < e. i= 1 By Theorem 6.6, f e rJt(oc). 6.9 Theorem If f is monotonic on [a, b ], and if oc is continuous on [a, b ], then f e fJt(oc). (We still assume, of course, that oc is monotonic.) Proof Let e > 0 be given. For any positive integer n, choose a partition such that ll.oci = oc(b) - oc(a) n (i = 1, ... , n). This is possible since oc is continuous {Theorem 4.23). We suppose that/is monotonically increasing (the proof is analogous in the other case). Then (i = 1, ... , n), so that oc(b) - oc(a) n U(P,f, oc) - L(P,f, oc) = --- L [f(x,) - f(xi-1)] n i= 1 = oc(b) - oc(a). [f(b) - /(a)] < e n if n is taken large enough. By Theorem 6.6,f e fJt(oc). 6.10 Theorem Suppose f is bounded on [a, b], f has only finitely many points of discontinuity on [a, b ], and oc is continuous at every point at which f is discon- tinuous. Then f e rJt(oc). Proof Let e > 0 be given. Put M = sup ]/(x) J , let E be the set of points at which f is discontinuous. Since E is finite and oc is continuous at every point of E, we can cover E by finitely many disjoint intervals [u1 , v1] c [a, b] such that the sum of the corresponding differences oc(v1) - oc(u1) is less than e. Furthermore, we can place these intervals in such a way that every point of E ri (a, b) lies in the interior of some [u1 , v1]. THE RIEMANN·STIELTJES INTEGRAL 127 Remove the segments (ui, vi) from [a, b]. The remaining set K is compact. Hence f is uniformly continuous on K, and there exists ~ > 0 such that lf(s) -f(t)I < e ifs e K, t e K, Is - ti < ~- Now form a partition P = {x0 , x 1 , ••• , xn} of [a, b], as follows: Each ui occurs in P. Each vi occurs in P. No point of any segment (ui, vi) occurs in P. If xi-i is not one of the ui, then fl.xi<~- Note that Mi - mi~ 2M for every i, and that Mi - mi~ e unless xi-i is one of the ui. Hence, as in the proof of Theorem 6.8, U(P,f, oc) - L(P,f, oc) ~ [oc(b) - a(a)]e + 2Me. Since e is arbitrary, Theorem 6.6 shows that/ e af(oc). Note: If f and oc have a common point of discontinuity, then/ need not be in al( a). Exercise 3 shows this. 6.11 Theorem Suppose f e af(a) on [a, b], m ~f ~ M, </> is continuous on [m, M], and h(x) = </>(f(x)) on [a, b]. Then he af(a) on [a, b]. (18) (19) Proof Choose e > 0. Since </> is uniformly continuous on [m, M], there exists ~ > 0 such that ~ < e and I q,(s) - </>(t) I < e if Is - t I ~ ~ and s, t E [m, M]. Since/ e af(a), there is a partition P = {x 0 , x 1 , ... , xn} of [a, b] such that U(P,f, a) - L(P,f, a) < ~ 2 • Let M,, mi have the same meaning as in Definition 6.1, and let Mt, mt be the analogous numbers for h. Divide the numbers 1, ... , n into two classes: i e A if Mi - mi<~, i e B if Mi - mi~~- For i e A, our choice of~ shows that Mi* - mt'~ e. For i e B, Mi* - mt'~ 2K, where K = sup I </>(t)I, m ~ t ~ M. By (18), we have ~ L fl.ai ~ L (Mi - mi) fl.oci < ~ 2 ieB ieB so that I, eB fl.ai < ~- It follows that U(P, h, a)- L(P, h, a)= I (M:' - mi) fl.oci + L (Mt - mi) fl.oci ieA ieB ~ e[a(b) - a(a)] + 2K~ < e[oc(b) - a(a) + 2K]. Since e was arbitrary, Theorem 6.6 implies that he af(a). Remark: This theorem suggests the question: Just what functions are Riemann-integrable? The answer is given by Theorem l l .33(b). 128 PRINCIPLES OF MATHEMATICAL ANALYSIS PROPERTIES OF THE INTEGRAL 6.12 Theorem (a) If f 1 e af(oc) andf2 E af(oc) on [a, b], then fi + f2 E af(oc), cf e af(oc) for every constant c, and b b (f1 + f 2 ) da = f 1 doc + f 2 doc, a a a b b cf doc = c f doc. a a (b) /f fi(x) ~f2(x) on [a, b], then a a (c) If f e af(oc) on [a, b] and if a< c < b, then f e Bt'(oc) on [a, c] and on [c, b], and C b b f doc + f doc = f doc. a c a (d) Iffe al(oc) on [a, b] and if )f(x)I ~Mon [a, b], then b f doc ~ M[oc(b) - oc(a)]. a b b b f d(oc1 + oc2) = f doc1 + f doc2 ; a a a zf fe al(oc) and c is a positive constant, thenfe al(coc) and b b f d(coc) = c f doc. a a Proof If f = fi + f 2 and P is any partition of [a, b ], we have (20) L(P,f1 , oc) + L(P,f2 , oc) S L(P,f, oc) ~ U(P,f, oc) S U(P,fi, oc) + U(P,f2 , oc). If f 1 e af(oc) and f 2 e af(oc), let e > 0 be given. There are partitions P1 (j = 1, 2) such that U(P1 ,Jj, oc) -L(P1 ,Jj, oc) < e. (21) 6.13 THE RIEMANN-STIELTJES INTEGRAL 129 These inequalities persist if P1 and P 2 are replaced by their common refinement P. Then (20) implies U(P,f, rt) - L(P,f, rt) < 2e, which proves that/ e af(rt). With this same P we have (j = 1, 2); hence (20) implies J f dr:1. ~ U(P,f, rt) < J ./i drt + J / 2 drt + 2e. Since e was arbitrary, we conclude that J / drt ~ J /1 drt + J /2 dr:1.. If we replace / 1 and / 2 in (21) by -/1 and -/2 , the inequality is reversed, and the equality is proved. The proofs of the other assertions of Theorem 6.12 are so similar that we omit the details. In part (c) the point is that (by passing to refine- ments) we may restrict ourselves to partitions which contain the point c, in approximating J f dr:1.. Theorem lf.f e af(r:1.) and g e af(rt) on [a, b], then (a) fg E af(r:1.); (b) 1/1 e af(r:1.) and a a Proof Ifwetakeq,(t) = t 2 , Theorem6.11 showsthat/2 eaf(r:1.)if/eaf(Q:). The identity 4fg = (f + g)2 - (f - g)2 completes the proof of (a). If we take </>(t) = It I, Theorem 6.11 shows similarly that 1/1 e af(r:1.). Choose c = ± 1, so that c JI drt ~ 0. Then I J f dr:1. I = c J f dr:1. = J cf dr:1. ~ • J l/1 dr:1., since cf~ If) . 6.14 Definition The unit step function I is defined by 0 I(x) = 1 (x ~ 0), (x > 0). 130 PRINCIPLES OF MATHEMATICAL ANALYSIS 6.15 Theorem If a < s < b, f is bounded on [a, b ], f is continuous at s, and oc(x) = I(x - s), then b f doc =f(s). a Proof Consider partitions P = {x0 , x 1 , x 2 , x 3}, where x 0 = a, and x1 = s < x 2 < x 3 = b. Then Since f is continuous at s, we see that M 2 and m2 converge to f(s) as X2 ► S. 6.16 Theorem Suppose en~ 0 for 1, 2, 3, ... , I:cn converges, {sn} is a sequence of distinct points in (a, b), and ! 00 (22) oc(x) = L en l(x - Sn). n= 1 Let f be continuous on [a, b]. Then (23) (24) (25) b oo f doc = L Cnf(sn). a n= 1 Proof The comparison test shows that the series (22) converges for every x. Its sum oc(x) is evidently monotonic, and oc(a) = 0, oc(b) = I:cn. (This is the type of function that occurred in Remark 4.31.) Let e > 0 be given, and choose N so that 00 Len< 8. N+l Put N 00 oc1(x) = L cnl(x - Sn), n= 1 oc2(x) = L Cnl(x - Sn). N+l By Theorems 6.12 and 6.15, a (26) THE RIEMANN·STIELTJES INTEGRAL 131 where M = sup lf(x) I - Since /'J. = !'J.1 + !'J.2 , it follows from (24) and (25) that b N f d!'J. - L Cnf(sn) ~ Me. a i= 1 If we let N ➔ oo, we obtain (23). 6.17 Theorem Assume !'J. increases monotonically and a' e f!A on [a, b]. Let .f be a bounded real function on [a, b ]. (27) Then f e r!A(!'J.) if and only if f!'J. 1 e f!A. In that case b b f d!'J. = f(x)a'(x) dx. a a Proof Let e > 0 be given and apply Theorem 6.6 to /'J. 1 : There is a par- tition P = {x0 , ••• , x,1} of [a, b] such that (28) U(P, !'J.1) - L(P, !'J.1) < e. (29) (30) (31) The mean value theorem furnishes points tie [xi-i, xi] such that Lia i = /'J. 1 ( t 1) Lix i for i = 1, ... , n. If si e [xi-i, x 1], then n L I !'J.1 (s i) - !'J.1(t 1) I Lix1 < e, i= 1 by (28) and Theorem 6.7(b). Put M = supj/(x)j. Since n n L f(si) Li!'J.i = L f(si)!'J.'(ti) Lixi i=l i=l it follows from (29) that n n L f(si) Li!'J.i - L f(si)!'J.'(si) Lixi ~ Me. i=l i=l In particular, n L f(s1) Li!'J.i ~ U(P,f!'J. 1) + Me, i= 1 for all choices of si e [x 1_ 1 , x 1], so that U(P,f, !'J.) ~ U(P,f!'J. 1 ) + Me. The same argument leads from (30) to U(P,f!'J. 1) ~ U(P,f, !'J.) + Me. Thus I U(P,f, !'J.) - U(P,f!'J. 1 ) I ~ Me. 132 PRINCIPLES OF MATHEMATICAL ANALYSIS (32) Now note that (28) remains true if Pis replaced by any refinement. Hence (31) also remains true. We conclude that -b -b f dr,. - f(x)r,.'(x) dx ~ Me. a a But e is arbitrary. Hence -b -b f drx = f(x)r,.'(x) dx, a a for any bounded f The equality of the lower integrals follows from (30) in exactly the same way. The theoren1 follows. 6.18 Remark The two preceding theorems illustrate the generality and flexibility which are inherent in the Stieltjes process of integration. If rx is a pure step function [this is the name often given to functions of the form (22)], the integral reduces to a finite or infinite series. If rx has an integrable derivative, the integral reduces to an ordinary Riemann integral. This makes it possible in many cases to study series and integrals simultaneously, rather than separately. To illustrate this point, consider a physical example. The moment of inertia of a straight wire of unit length, about an axis through an endpoint, at right angles to the wire, is (33) 1 x 2 dm 0 where m(x) is the mass contained in the interval [O, x]. If the wire is regarded as having a continuous density p, that is, if m'(x) = p(x), then (33) turns into (34) 1 x 2 p(x) dx. 0 On the other hand, if the wire is composed of masses mi concentrated at points xi, (33) becomes (35) L xf mi. i Thus (33) contains (34) and (35) as special cases, but it contains much more; for instance, the case in which m is continuous but not everywhere differentiable. 6.19 Theorem (change of variable) Suppose <pis a strictly increasing continuous function that maps an interval [A, B] onto [a, b]. Suppose rx is monotonically increasing on [a, b] and/ e Bt(rx) on [a, b]. Define P and g on [A, B] by (36) p(y) = rx( <p(y)), g(y) = f(<p(y)). THE RIEMANN-STIELTJES INTEGRAL 133 Then g e rJt(P) and (37) B b g dp = I drx. A a (38) (39) Proof To each partition P = {x0 , ••• , xn} of [a, b] corresponds a partition Q = {y0 , ••• , Yn} of [A, B], so that xi = <p(yi). All partitions of [A, B] are obtained in this way. Since the values taken by/ on [xi-i, xi] are exactly the same as those taken by g on [y i- i, y ij, we see that U(Q, g, P) = U(P,f, rx), L(Q, g, P) = L(P,f, rx). Since/ e fJt(rx), P can be chosen so that both U(P,f, rx) and L(P,f, rx) are close to J / drx. Hence (38), combined with Theorem 6.6, shows that g e rJt(P) and that (37) holds. This completes the proof. Let us note the following special case: Take rx(x) = x. Then P = <p. Assume <p' e fJt on [A, B]. If Theorem 6.17 is applied to the left side of (3 7), we obtain b B f(x) dx = f(<p(y))<p'(y) dy. a A INTEGRATION AND DIFFERENTIATION We still confine ourselves to real functions in this section. We shall show that integration and differentiation are, in a certain sense, inverse operations. 6.20 Theorem Let f e fJt on [a, b]. For a ~ x ~ b, put X F(x) = f(t) dt. a Then F is continuous on [a, b ],· furthermore, if f is continuous at a point x 0 of [a, b ], then F is differentiable at x 0 , and F'(xo) = f(xo), Proof Since/ e fJt, f is bounded. Suppose 1/(t)I ~ M for a~ t ~ b. If a ~ x < y ~ b, then y I F(y) - F(x) I = f(t) dt ~ M(y - x), X by Theorem 6.12(c) and (d). Given e > 0, we see that IF(y)-F(x)I <e, 134 PRINCIPLES OF MATHEMATICAL ANALYSIS provided that I y - x I < e/ M. This proves continuity (and, in fact, uniform continuity) of F. Now suppose/ is continuous at x 0 • Given e > 0, choose l, > 0 such that lf(t) - f(xo)I < e if It - x 0 I < l,, and a =:; t =s;; b. Hence, if x 0 - l, < s =s;; x 0 =s;; t < x 0 + l, we have, by Theorem 6.12(d), and a =:; s < t =:; b, F(t) - F(s) _ f(xo) = t-s It follows that F'(x 0 ) = f(x 0 ). 1 t t - s s [f(u) - f(xo)] du < e. 6.21 The fundamental theorem of calculus If f e fJt on [a, b] and if the1·e is a differentiable function Fon [a, b] such that F' = f, then b f(x) dx = F(b) - F(a). a Proof Let e > 0 be given. Choose a partition P = {x 0 , ••• , xn} of [a, b] so that U(P,f) -L(P,f) < e. The mean value theorem furnishes points tie [xi-i, xi] such that for i = 1, ... , n. Thus n L f(ti) axi = F(b) - F(a). i= 1 It now follows from Theorem 6.7(c) that b F(b) - F(a) - f(x) dx <e. a Since this holds for every e > 0, the proof is complete. 6.22 Theorem (integration by parts) Suppose F and G are differentiable f unc- tions on [a, b], F' = f e fA, and G' = g e fJt. Then b b F(x)g(x) dx = F(b)G(b) - F(a)G(a) - f(x)G(x) dx. a a Proof Put H(x) = F(x)G(x) and apply Theorem 6.21 to Hand its deriv- ative. Note that H' e fJt, by Theorem 6.13. THE RIEMANN·STIELTJES INTEGRAL 135 INTEGRATION OF VECTOR-VALUED FUNCTIONS 6.23 Definition Let Ji, ... , h. be real functions on [ a, b ], and let f = (Ii, ... , h.) be the corresponding mapping of [a, b] into Rk. If ex increases monotonically on [a, b], to say that f e Bt(ex) means thatjj e Bl(ex) for j = 1, ... , k. If this is the case, we define a a a In other words, Jr dex is the point in Rk whosejth coordinate is Jjj dex. It is clear that parts (a), (c), and (e) of Theorem 6.12 are valid for these vector-valued integrals; we simply apply the earlier results to each coordinate. The same is true of Theorems 6.17, 6.20, and 6.21. To illustrate, we state the analogue of Theorem 6.21. 6.24 Theorem /ff and F map [a, b] into Rk, if f e 9l on [a, b ], and ifF' = f, then b f(t) dt = F(b) - F(a). a The analogue of Theorem 6.13(b) offers some new features, however, at least in its proof. 6.25 Theorem If f maps [a, b] into Rk and if f e 9l( ex) for some monotonically increasing function ex on [a, b ], then I fl e Bt(ex), and b b (40) f dex ~ If I dex. a a Proof If f 1 , ••• , fk are the components off, then (41) lfl =(ff+ ''' + fk2)112• (42) By Theorem 6.11, each of the functionsft2 belongs to Bt(ex); hence so does their sum. Since x 2 is a continuous function of x, Theorem 4.17 shows that the square-root function is continuous on [O, M], for every real M. Ifwe apply Theorem 6.11 once more, (41) shows that lfl e9l(ex). To prove (40), put y = (y1 , .•• , Yk), where y1 = Jfj dex. Then we have y = Jf dex, and By the Schwarz inequality, LY1fJt) ~ IYI lf(t)I (a~ t ~b); 136 PRINCIPLES OF MATHEMATICAL ANALYSIS hence Theorem 6.12(b) implies (43) IYl 2 :s;; IYI lfl drx. If y = 0, ( 40) is trivial. If y #: 0, division of ( 43) by I y I gives ( 40). RECTIFIABLE CURVES We conclude this chapter with a topic of geometric interest which provides an application of some of the preceding theory. The case k = 2 (i.e., the case of plane curves) is of considerable importance in the study of analytic functions of a complex variable. 6.26 Definition A continuous mapping y of an interval [a, b] into Rk is called a curve in Rk. To emphasize the parameter interval [a, b], we may also say that y is a curve on [a, b]. If y is one-to-one, y is called an arc. If y(a) = y(b), y is said to be a closed curve. It should be noted that we define a curve to be a mapping, not a point set. Of course, with each curve y in Rk there is associated a subset of Rk, namely the range of y, but different curves may have the same range. We associate to each partition P = {x0 , ••• , xn} of [a, b] and to each curve yon [a, b] the number n A(P, y) = L I y(xt) - y(xt-1) I, i= 1 The ith term in this sum is the distance (in Rk) between the points y(xi_ 1) and y(xt), Hence A(P, y) is the length of a polygonal path with vertices at y(x0 ), y(x1), ••• , y(xn), in this order. As our partition becomes finer and finer, this polygon approaches the range of y more and more closely. This makes it seem reasonable to define the length of y as A(y) = sup A(P, y), where the supremum is taken over all partitions of [a, b]. If A(y) < oo, we say that y is rectifiable. In certain cases, A( y) is given by a Riemann integral. We shall _prove this for continuously differentiable curves, i.e., for curves y whose derivative y' is • continuous. THE RIEMANN·STIELTJES INTEGRAL 137 6.27 Theorem If y' is continuous on [a, b], then y is rectifiable, and b A(y) = I y'(t) I dt. a Proof If a~ Xt-i < x 1 ~ b, then y'(t) dt Xt- 1 Hence b A(P, y) ~ I y'(t) I dt a for every partition P of [a, b ]. Consequently, b A(y)~ ly'(t)ldt. a Xt I y'(t) I dt. Xt- 1 To prove the opposite inequality, let e > 0 be given. Since y' is uniformly continuous on [a, b ], there exists {J > 0 such that I y'(s) - y'(t) I < e if Is - ti < b. Let P = {x0 , ••• , xn} be a partition of [a, b ], with 6.x 1 < {J for all i. If x 1_ 1 ~ t ~ x 1 , it follows that I y'(t)I ~ I y'(xi)I + e. Hence Xt x1-1 XI -- [y'(t) + y'(x 1) - y'(t)] dt + e 6.xi Xt- 1 y'(t) dt + [y'(xt) - y'(t)] dt + e 6.x1 X/- I Xt- 1 ~ I y(xi) - y(xi-i)I + 2e 6.xi. If we add these inequalities, we obtain b I y'(t) I dt ~ A(P, y) + 2e(b - a) a ~ A(y) + 2e(b - a). Since e was arbitrary, b I y'(t) I dt ~ A(y). a This completes the proof. 138 PRINCIPLES OF MATHEMATICAL ANALYSIS EXERCISES 1. Suppose ex increases on [a, b], as Xo s b, ex is continuous at Xo, f(xo) = 1, and f(x) = 0 if x -=I= xo. Prove that f e Bi(oc) and that J f doc= 0. b 2. Suppose /-:?. 0, f is continuous on [a, b ], and /(x} dx = 0. Prove that f(x) = 0 II for all x e [a, b]. (Compare this with Exercise 1.) 3. Define three functions /31, /32, /33 as follows: /3J(x) = 0 if x < 0, /3J(x) = 1 if x > O for j = 1, 2, 3; and /31(0) = 0, /32(0) =1, /33(0) = ½. Let/be a bounded function on [-1,1]. (a) Prove that f e Bi(/31) if and only if.f(O+) = /(0) and that then f d/31 = /(0). (b) State and prove a similar result for /32. (c) Prove that/e ~(/33) if and only if/ is continuous at 0. (d) If/ is continuous at O prove that f d/31 = f d/32 = f d/33 = f(O). 4. If /(x) = 0 for all irrational x,f(x) = 1 for all rational x, prove that/¢~ on[a, b] for any a< b. S. Suppose f is a bounded real function on [a, b], and / 2 e Bl on [a, b]. Does it follow that f e Bl? Does the answer change if we assume that f 3 e ~? 6. Let P be the Cantor set constructed in Sec. 2.44. Let f be a bounded real function on [O, 1] which is continuous at every point outside P. Prove that f e ~ on [O, 1 ]. Hint: P can be covered by finitely many segments whose total length can be made as small as desired. Proceed as in Theorem 6.10. 7. Suppose f is a real function on (0, 1] and f e ~ on [c, 1] for every c > 0. Define 1 1 f(x} dx = Jim /(x) dx 0 C➔ O c if this limit exists (and is finite). (a) If f e ~ on [O, 1], show that this definition of the integral agrees with the old one. (b) Construct a function/ such that the above limit exists, although it fails to exist with I /I in place off 8. Suppose/ e ~ on [a, b] for every b > a where a is fixed. Define oo b f(x) dx = lim /(x) dx II b➔ OO II if this limit exists (and is finite). In that case, we say that the integral on the left converges. If it also converges after f has been replaced by I/I, it is said to con- verge absolutely. THE RIEMANN-STIELTJES INTEGRAL 139 Assume that f (x) 2 0 and that f decreases monotonically on [l, oo ). Prove that 00 f(x) dx 1 converges if and only if 00 Lf<n> n•1 converges. (This is the so-called ''integral test'' for convergence of series.) 9. Show that integration by parts can sometimes be applied to the ''improper'' integrals defined in Exercises 7 and 8. (State appropriate hypotheses, formulate a theorem, and prove it.) For instance show that 00 cos x 00 sin x o 1+xdx= o (1+x) 2 dx. Show that one of these integrals converges absolutely, but that the other does not. 10. Let p and q be positive real numbers such that Prove the following statements. (a) If u ~ 0 and v ~ 0, then ! +! = 1. p q uP vq UV s.-+ , p q Equality holds if and only if uP = vq. (b) If/ e Bl(rx), g e fA(rx),/~ 0, g ~ 0, and b b f P drx = 1 = gq drx, a a then b fgdrxs.1, a (c) If f and g are complex functions in Bi(rx), ther1 b b 1/p b fgdrx I / I P drx I g I q drx a a a 1/q • This is Holder's inequality. When p = q = 2 it is usually called the Schwarz inequality. (Note that Theorem 1.35 is a very special case of this.) (d) Show that Holder's inequality is also true for the '' improper'' integrals de- scribed in Exercises 7 and 8. 140 PRINCIPLES OF MATHEMATICAL ANALYSIS 11. Let oc be a fixed increasing function on [a, b]. For u e Bl(oc), define 1/2 llull2 = • II Suppose/, g, he Bi(oc), and prove the triangle inequality ll/-hll2s ll/-ull2+ llg-hll2 as a consequence of the Schwarz inequality, as in the proof of Theorem 1.37. 12. With the notations of Exercise 11, suppose f e Bi(oc) and e > 0. Prove that there exists a continuous function g on [a, b] such that 11/ - g 112 < e. Hint: Let P = {xo, ... , Xn} be a suitable partition of [a, b], define ifX1-1StSX1, 13. Define x+1 f(x) = sin (t 2 ) dt. X (a) Prove that 1/(x)I < 1/x if x > 0. Hint: Put t 2 = u and integrate by parts, to show that/(x) is equal to cos (x 2 ) 2x Replace cos u by -1. (b) Prove that - cos [(x + 1) 2 ] 2(x + 1) (x+ 1>2 COS U - x2 4u3t2 du. 2xf(x) = cos (x 2) - cos [(x + 1)2 ] + r(x) where I r(x) I < c/x and c is a constant. (c) Find the upper and lower limits of xf(x), as x ► oo. 00 (d) Does sin (t 2 ) dt converge? 0 14. Deal similarly with x+1 f(x) = sin (et) dt. X Show that and that exf(x) = cos (ex)- e- 1 cos (ex+ 1) + r(x), where lr(x)I < ce-x, for some constant C. THE RIEMANN·STIELTJES INTEGRAL 141 15. Suppose/is a real, continuously differentiable function on [a, b],f(a) =fCb) = 0, and \" f 2Cx) dx = 1. II Prove that \" xfCx)f'Cx) dx = - ½ II and that \" \" [/'Cx)] 2 dx · x 2f 2Cx) dx > !. II II 16. For 1 < s < oo, define 00 1 ,cs)= L --; . n=t n (This is Riemann's zeta function, of great importance in the study of the distri- bution of prime numbers.) Prove that Ca) ,cs)= s \"° [x] i r+1 dx and that S 00 X - [X] Cb) ,cs)= l - s s+t dx, S- 1 X where [x] denotes the greatest integer s x. Prove that the integral in Cb) converges for all s > 0. Hint: To prove Ca), compute the difference between the integral over [1, N] and the Nth partial sum of the series that defines ,cs). 17. Suppose oc increases monotonically on [a, b], g is continuous, and uCx) = G'Cx) for a s x s b. Prove that \" \" ocCx)gCx) dx = GCb)ocCb) - GCa)ocCa) - G doc. II II Hint: Take g real, without loss of generality. Given P = {xo, xi, ... , Xn}, choose t, e Cx, _ 1, x,) so that gCt,) ~x, = GCx,) - GCx, _ 1), Show that n n L ocCx,)gCt,) ~x, = GCb)ocCb)- GCa)ocCa)- L GCx1-1) ~oc,. 1•1 1=1 18. Let ')'1, ')'2, ')'3 be curves in the complex plane, defined on [O, 21r] by y1Ct) = ett, y 2Ct) = e2tt, y 3Ct) = e2nlt sin (l/t) 0 Show that these three curves have the same range, that ')'1 and ')'2 are rectifiable, that the length of ')'1 is 21r, that the length of ')'2 is 41r, and that ')'3 is not rectifiable. 142 PRINCIPLES OF MATHEMATICAL ANALYSIS 19. Let Yi be a curve in Rk, defined on [a, b]; let ¢, be a continuous 1-1 mapping of [c, d] onto [a, b], such that ¢,(c) = a; and define Y2(s) = Yi(</>(s)). Prove that Y2 is an arc, a closed curve, or a rectifiable curve if and only if the same is true of y 1 • Prove that Y2 and Yi have the same length. SEQUENCES AND SERIES OF FUNCTIONS In the present chapter we confine our attention to complex-valued functions (including the real-valued ones, of course), although many of the theorems and proofs which follow extend without difficulty to vector-valued functions, and even to mappings into general metric spaces. We choose to stay within this simple framework in order to focus attention on the most important aspects of the problems that arise when limit processes are interchanged. DISCUSSION OF MAIN PROBLEM 7.1 Definition Suppose {f,.}, n = 1, 2, 3, ... , is a sequence of functions defined on a set E, and suppose that the sequence of numbers {f,.(x)} converges for every x e E. We can then define a function/ by (1) f(x) = limf,.(x) (x EE). n ➔ oo 144 PRINCIPLES OF MATHEMATICAL ANALYSIS Under these circumstances we say that {J,.} converges on E and that/ is the limit, or the limit function, of {J,.}. Sometimes we shall use a more descriptive terminology and shall say that '' {J,.} converges to/ pointwise on E'' if (I) holds. Similarly, if IJ,.(x) converges for every x e E, and if we define 00 (2) f(x) = Lfn(x) (x e E), n=l the function f is called the sum of the series I.J,. . The main problem which arises is to determine whether important properties of functions are preserved under the limit operations (I) and (2). For instance, if the functionsJ,. are continuous, or differentiable, or integrable, is the same true of the limit function? What are the relations between/~ and/', say, or between the integrals of J,. and that of/? To say that/ is continuous at a limit point x means lim/(t) = f(x). t➔ x Hence, to ask whether the limit of a sequence of continuous functions is con- tinuous is the same as to ask whether (3) lim limJ,.(t) = lim limJ,.(t), i.e., whether the order in which limit processes are carried out is immaterial. On the left side of (3), we first let n • oo, then t • x; on the right side, t-, x first, then n • oo. We shall now show by means of several examples that limit processes cannot in general be interchanged without affecting the result. Afterward, we shall prove that under certain conditions the order in which limit operations are carried out is immaterial. Our first example, and the simplest one, concerns a ''double sequence.'' 7.2 Example Form= 1, 2, 3, ... , n = 1, 2, 3, ... , let m Then, for every fixed n, so that (4) s =--· m,n + m n lim Sm,n = 1, ffl➔ 00 lim lim Sm,n = 1. n ➔ oo m ➔ oo SEQUENCES AND SERIES OF FUNCTIONS 145 On the other hand, for every fixed m, so that (5) 7.3 Example Let lim Sn,,n = 0, n ➔ oo lim lim Sm,n = 0. m ➔ oo n ➔ oo x2 fn(x) = (1 + x2)n (xreal; n = 0, 1, 2, ... ), and consider (6) Since.fn(O) = 0, we have/(0) = 0. For x :/= 0, the last series in (6) is a convergent geometric series with sum 1 + x 2 (Theorem 3.26). Hence (7) 0 f(x) = 1 + x2 (x = 0), (x :/= 0), so that a convergent series of continuous functions may have a discontinuous sum. 7.4 Example For m = 1, 2, 3, ... , put fm(x) = lim (cos m!nx)2n. n ➔ oo When m !xis an integer,fm(x) = 1. For all other values of x,fm(x) = 0. Now let f(x) = lim fm(x). m ➔ oo For irrational x, fm(x) = 0 for every m; hence f(x) = 0. For rational x, say x = p/q, where p and q are integers, we see that m !x is an integer if m ~ q, so that/(x) = 1. Hence (8) lim (x irrational), (x rational). We have thus obtained an everywhere discontinuous limit function, which is not Riemann-integrable (Exercise 4, Chap. 6). 146 PRINCIPLES OF MATHEMATICAL ANALYSIS 7.S Example Let • (9) and sin nx (xreal, n = 1, 2, 3, ... ), f(x) = limf,.(x) = 0. n ➔ oo Then.f'(x) = 0, and f ~(x) = J; cos nx, so that [f~} does not converge to f'. For instance, f~(O) = Jn > + oo as n > oo, whereas/'(O) = 0. 7.6 Example Let (10) (0 ~ x ~ l, n = I, 2, 3, ... ). For O < x ~ 1, we have lim/,,(x) = 0, by Theorem 3.20(d). Since/n(O) = 0, we see that (11) lim/,,(x) = 0 (0 ~ x ~ 1). A simple calculation shows that 1 1 x(l - x 2)n dx = --· o 2n + 2 Thus, in spite of (11), 1 n2 fn(x) dx = 2 2 > + oo o n+ as n > oo. If, in (10), we replace n2 by n, (11) still holds, but we now have 1 n 1 f,.(x) dx = lim 2 2 = - 2 , 0 n➔ oo n + lim n ➔ oo whereas 1 Iimfn(X) dx = 0. 0 n➔ oo SEQUENCES AND SERIES OF FUNCltONS 147 Thus the limit of the integral need not be equal to the integral of the limit, even if both are finite. After these examples, which show what can go wrong if limit processes are interchanged carelessly, we now define a new mode of convergence, stronger than pointwise convergence as defined in Definition 7.1, which will enable us to arrive at positive results. UNIFORM CONVERGENCE 7.7 Definition We say that a sequence of functions {f,.}, n = I, 2, 3, ... , converges uniformly on E to a function f if for every e > 0 there is an integer N such that n ~ N implies (12) lfn(x) - f(x) I ~ e for all x e E. It is clear that every uniformly convergent sequence is pointwise con- vergent. Quite explicitly, the difference between the two concepts is this: If {f,.} converges pointwise on E, then there exists a function f such that, for every e > 0, and for every x e E, there is an integer N, depending one and on x, such that (12) holds if n ~ N; if {f,.} converges uniformly on E, it is possible, for each e > 0, to find one integer N which will do for all x e E. We say that the series 'f.f,.(x) converges uniformly on E if the sequence { s\"} of partial sums defined by n L ft(x) = sn(x) i= 1 converges uniformly on E. The Cauchy criterion for uniform convergence is as follows. 7.8 Theorem The sequence of functions {f,.}, defined on E, converges uniformly on E if and only if for every e > 0 there exists an in;teger N such that m ~ N, n ~ N, x e E implies (13) 11,,(x) - fm(x) I ~ e. Proof Suppose {f,.} converges uniformly on E, and let / be the limit function. Then there is an integer N such that n ~ N, x e E implies e lfn(x) - f(x) I ~ 2 , so that lfn(x) - fm(x) I ~ lfn(x) - f (x) I + lf(x) - fm(x) I ~ e if n ~ N, m ~ N, x e E. 148 PRINCIPLES OF MATHEMATICAL ANALYSIS (14) Conversely, suppose the Cauchy condition holds. By Theorem 3.11, the sequence {f,.(x)} converges, for every x, to a limit which we may call f(x). Thus the sequence {f,.} converges on E, to f. We have to prove that the convergence is uniform. Let e > 0 be given, and choose N such that (13) holds. Fix n, and let m • oo in (13). Since fm(x) • f(x) as m • oo, this gives lfn(x) - f(x) I :S: e for every n ~ N and every x e E, which completes the proof. The following criterion is sometimes useful. 7.9 Theorem Suppose limf,.(x) = f (x) (x EE). n ➔ oo Put Mn = sup lfn(x) - f (x) I, xeE Then fn ➔ f uniformly on E if and only if Mn • 0 as n • oo. Since this is an immediate consequence of Definition 7.7, we omit the details of the proof. For series, there is a very convenient test for uniform convergence, due to Weierstrass. 7.10 Theorem Suppose{f,.} is a sequence of functions defined on E, and suppose lfn(x) I :S: Mn (x e E, n = 1, 2, 3, ... ). Then 'I:.fn converges uniformly on E if !.Mn converges. Note that the converse is not asserted (and is, in fact, not true). Proof If !.Mn converges, then, for arbitrary e > 0, m m Lfi(x) :S: L M 1 S: e (x EE), t=n t=n provided m and n are large enough. Uniform convergence now follows from Theorem 7 .8. SEQUENCES AND SERIES OF FUNCTIONS 149 UNIFORM CONVERGENCE AND CONTINUITY 7.11 Theorem Suppose In • f uniformly on a set E in a metric space. Let x be a limit point of E, and suppose that (15) limf,.(t) = An (n = 1, 2, 3, ... ). Then {An} converges, and (16) Iimf(t) = lim An. (17) (18) t➔ x n ➔ oo In other words, the conclusion is that lim limf,.(t) = lim limf,.(t). t➔ x n ➔ oo n ➔ oo t➔ x Proof Let e > 0 be given. By the uniform convergence of {f,.}, there exists N such that n ~ N, m ~ N, t e E imply lfn(t) - fm(t) I ~ e. Letting t • x in (18), we obtain IAn - Am I~ B for n ~ N, m ~ N, so that {An} is a Cauchy sequence and therefore converges, say to A. Next, (19) lf(t) - A I ~ lf(t) - fn(t) I + lfn(t) -An I + IAn - A I- (20) (21) (22) We first choose n such that e If (t) - fn(t) I ~ 3 for all t e E (this is possible by the uniform convergence), and such that Then, for this n, we choose a neighborhood V of x such that e lfn(t) - An I ~ 3 if t e V n E, t 'I= x. Substituting the inequalities (20) to (22) into (19), we see that lf(t) - A I ~ e, provided t e V n E, t-:/=x. This is equivalent to (16). 150 PRINCIPLES OF MATHEMATICAL ANALYSIS 7.12 Theorem If {J,.} is a sequence of continuous functions on E, and if f,. ➔ f uniformly on E, then f is continuous on E. This very important result is an immediate corollary of Theorem 7.11. The converse is not true; that is, a sequence of continuous functions may converge to a continuous function, although the convergence is not uniform. Example 7.6 is of this kind (to see this, apply Theorem 7.9). But there is a case in which we can assert the converse. 7.13 Theorem Suppose K is compact, and (a) {f,.} is a sequence of continuous functions on K, (b) {f,.} converges pointwise to a continuous function f on K, (c) f,.(x) '?:.fn+ 1(x)for all x EK, n = 1, 2, 3, .... Then f,. ➔ f uniformly on K. Proof Put gn = fn - f Then gn is continuous, gn • 0 pointwise, and gn '?:. gn+t· We have to prove that gn ➔ O uniformly on K. Let e > 0 be given. Let Kn be the set of all x EK with gn(x) '?:. s. Since gn is continuous, Kn is closed (Theorem 4.8), hence compact (Theorem 2.35). Since gn '?:. gn+t, we have Kn::::, Kn+t· Fix x EK. Since gn(x) • 0, we see that x ¢ Kn if n is sufficiently large. Thus x ¢ n Kn . In other words, n Kn is empty. Hence KN is empty for some N (Theorem 2.36). It follows that O ~ gn(x) < e for all x E Kand for all n '?:. N. This proves the theorem. Let us note that compactness is really needed here. For instance, if I f,.(x) = nx + 1 (0 < x < 1; n = 1, 2, 3, ... ) thenf,.(x) , 0 monotonically in (0, 1), but the convergence is not uniform. 7.14 Definition If Xis a metric space, ~(X) will denote the set of all complex- valued, continuous, bounded functions with domain X. [Note that boundedness is redundant if X is compact (Theorem 4.15). Thus ~(X) consists of all complex continuous functions on X if Xis compact.] We associate with each/ E ~(X) its supremum norm llfll = sup lf(x) 1- x ex Since f is assumed to be bounded, llfll < oo. It is obvious that 11/11 = 0 only if f(x) = 0 for every x e X, that is, only if f = 0. If h =f + g, then lh(x) I :s: lf(x) I + lg(x) I :s: 11!11 + llgll for all x e X; hence 11/ + g II :s: 11!11 + Ilg 11- SEQUENCES AND SERIES OF FUNCTIONS 151 If we define the distance between/e~(X) and g e~(X) to be 11/-gll, it follows that Axioms 2.15 for a metric are satisfied. We have thus made ~(X) into a metric space. Theorem 7 .9 can be rephrased as follows: A sequence {f,.} converges to f with respect to the metric of ~(X) if and only if f,. ➔ f uniformly on X. Accordingly, closed subsets of ~(X) are sometimes called uniformly closed, the closure of a set d c ~(X) is called its uniform closure, and so on. 7.15 Theorem The above metric makes ~(X) into a complete metric space. Proof Let {f,.} be a Cauchy sequence in ~(X). This means that to each e > 0 corresponds an N such that 11/n - Im II < e if n ~ N and m ~ N. It follows (by Theorem 7.8) that there is a function f with domain X to which {f,.} converges uniformly. By Theorem 7.12, f is continuous. Moreover, f is bounded, since there is an n such that lf(x) - f,.(x) I < 1 for all x e X, and f,. is bounded. Thus f e ~(X), and since f,. ➔ f uniformly on X, we have 11/-f,.II ,Oasn ,oo. UNIFORM CONVERGENCE AND INTEGRATION 7.16 Theorem Let IX be monotonically increasing on [a, b]. Suppose f,. e at(cx) on [a, b ], for n = 1, 2, 3, ... , and suppose f,. • f uniformly on [a, b ]. Then f e at(cx) on [a, b ], and b b (23) f dcx = lim fn dcx. a n ➔ oo a (The existence of the limit is part of the conclusion.) Proof It suffices to prove this for real f,. . Put (24) en = sup lfn(x) - f (x) I, (25) the supremum being taken over a :::;; x :::;; b. Then fn - en =:;;f =:;;f,. + en, so that the upper and lower integrals off (see Definition 6.2) satisfy a - Hence - - 152 PRINCIPLES OF MATHEMATICAL ANALYSIS (26) Since Bn ► 0 as n ► oo (Theorem 7.9), the upper and lower integrals off are equal. Thus/ e Bl(C<). Another application of (25) now yields b b f dC< - fn dC< ~ Bn[C<(b) - C<(a)]. a a This implies (23). Corollary If fn e Bl( C<) on [ a, b] and if 00 f(x) = L f,,(x) (a~ x ~ b), n=l the series converging uniformly on [a, b ], then b oo b f dC< = L In dC<. a n= 1 a In other words, the series may be integrated term by term. UNIFORM CONVERGENCE AND DIFFERENTIATION We have already seen, in Example 7.5, that uniform convergence of {In} implies nothing about the sequence {f~}. Thus stronger hypotheses are required for the assertion that J; ► f' if In ► f. 7.17 Theorem Suppose {f,,} is a sequence of functions, differentiable on [a, b] and such that {.fn(x0)} converges for some point x 0 on [a, b]. If {J:} converges uniformly on [a, b ], then {In} converges uniformly on [a, b ], to a function f, and (27) f'(x) = lim/;(x) (a~ x ~ b). n-+ oo Proof Lets> 0 be given. Choose N such that n ~ N, m ~ N, implies (28) and (29) B lf~(t) - J:i(t) I < 2 (b (a~ t ~ b). (30) (31) (32) (33) SEQUENCES AND SERIES OF FUNCTIONS 153 Ifwe apply the mean value theorem 5.19 tothefunctionfn-fm, (29) shows that Ix - t le e l.fn(x) - fm(x) - fn(t) + fm(t) I S: 2 (b _ a) S: 2 for any x and t on [a, b], if n :2!': N, m :2!': N. The inequality l.fn(x) - fm(x) I S: l.fn(x) - fm(x) - .fn(xo) + fm(Xo) I + lfn(Xo) - fm(Xo) I implies, by (28) and (30), that l.fn(x) - fm(x) I < e (a S: x S: b, n :2!': N, m :2!': N), so that {.fn} converges uniformly on [a, b ]. Let f(x) =lim.fn(x) (as; x s; b). n ➔ oo Let us now fix a point x on [a, b] and define </Jn(t) = .fn(t) - .fn(x), t- X <p(t) = f(t) - f(x) t- X for a s; t ~ b, t :/= x. Then lim </Jn(t) = J:(x) (n = 1, 2, 3, ... ). The first inequality in (30) shows that 8 I </Jn(t) - </Jm(t) I S: 2 (b _ a) (n :2!': N, m :2!': N), so that { </Jn} converges uniformly, for t :/= x. Since {fn} converges to f, we conclude from (31) that lim </Jn(t) = <p(t) n ➔ oo uniformly for a s; t s; b, t :/= x. If we now apply Theorem 7.11 to { </Jn}, (32) and (33) show that lim <p(t) = limf:(x); t➔ x n ➔ oo and this is (27), by the definition of <p(t). Remark: If the continuity of the functions J: is assumed in addition to the above hypotheses, then a much shorter proof of (27) can be based on Theorem 7 .16 and the fundamental theorem of calculus. 154 PRINCIPLES OF MATHEMATICAL ANALYSIS 7.18 Theorem There exists a real continuous function on the real line which is nowhere differentiable. (34) (35) (36) (37) Proof Define <p(x) = Ix I ( -1 S: XS: 1) and extend the definition of <p(x) to all real x by requiring that <p(x + 2) = <p(x). Then, for all s and t, l'P(s) - <p(t) I s: Is - t 1. In particular, <p is continuous on R1• Define 00 f(x) = L (¾)n<p(4nx). n=O Since O 5:: <p s; 1, Theorem 7.10 shows that the series (37) converges uniformly on R1 • By Theorem 7 .12, f is continuous on R1 • Now fix a real number x and a positive integer m. Put (38) '5m = ± ½• 4-m (39) where the sign is so chosen that no integer lies between 4mx and 4m(x + '5111). This can be done, since 4m l'5m I = ½. Define <p(4n(x + '5m)) - <p(4nx) Yn = · '5111 When n > m, then 4n<5,n is an even integer, so that Yn = 0. (36) implies that IYn I 5:: 4n, Since IYm I = 4m, we conclude that f(x + '5m) - f(x) = ½(3m + 1). When O 5:: n 5:: m, As m ➔ oo, '5m ➔ 0. It follows that/ is not differentiable at x. EQUICONTINUOUS FAMILIES OF FUNCTIONS In Theorem 3.6 we saw that every bounded sequence of complex numbers contains a convergent subsequence, and the question arises whether something similar is true for sequences of functions. To make the question more precise, we shall define two kinds of boundedness. SEQUENCES AND SERIES OF FUNCl'IONS 155 7.19 Definition Let {.fn} be a sequence of functions defined on a set E. We say that{.fn} is pointwise bounded on E if the sequence{.fn(x)} is bounded for every x e E, that is, if there exists a finite-valued function <I> defined on E such that l.fn(x) I < </>(x) (x e E, n = 1, 2, 3, ... ). We say that {.fn} is uniformly bounded on E if there exists a number M such that l.fn(x) I < M (x e E, n = 1, 2, 3, ... ). Now if {In} is pointwise bounded on E and E1 is a countable subset of E, it is always possible to find a subsequence {Ink} such that {.fnk(x)} converges for every x e E1 • This can be done by the diagonal process which is used in the proof of Theorem 7.23. However, even if {.fn} is a uniformly bounded sequence of continuous functions on a compact set E, there need not exist a subseG:ience which con- verges pointwise on E. In the following example, this would be quite trouble- some to prove with the equipment which we have at hand so far, but the proof is quite simple if we appeal to a theorem from Chap. 11. 7.20 Example Let .fn(x) = sin nx (0 S: X S: 21t, n = 1, 2, 3, . , .) . Suppose there exis-ts a sequence {nk} such that {sin nkx} converges, for every x e [O, 21t]. In that case we must have lim (sin nkx - sin nk+ 1x) = 0 (0 S: X S: 21t); k ➔ oo hence (40) Iim (sin nkx - sin nk+ 1x) 2 = 0 (0 S: X S: 21t), k ➔ oo By Lebesgue's theorem concerning integration of boundedly convergent sequences (Theorem 11.32), (40) implies 2n (41) lim (sin nkx - sin nk+ 1x) 2 dx = 0. k➔ OO 0 But a simple calculation shows that 2n (sin nkx - sin nk+ 1x) 2 dx = 21t, 0 which contradicts (41). 156 PRINCIPLES OF MATHEMATICAL ANALYSIS Another question is whether every convergent sequence contains a uniformly convergent subsequence. Our next example will show that this need not be so, even if the sequence is uniformly bounded on a compact set. (Example 7.6 shows that a sequence of bounded functions may converge without being uniformly bounded; but it is trivial to see that uniform conver- gence of a sequence of bounded functions implies uniform boundedness.) 7.21 Example Let x2 fn(x) = x2 + (1 - nx)2 (0 :::;; x:::;; 1, n = 1, 2, 3, ... ). Then l.fn(x) I :::;; 1, so that {.fn} is uniformly bounded on [O, 1]. Also lim/n(x) = 0 (0 :::;; x :::;; 1), n ➔ oo but 1 .fn - = 1 (n = 1, 2, 3, ... ), n so that no subsequence can converge uniformly on [O, l]. The concept which is needed in this connection is that of equicontinuity; it is given in the following definition. 7.22 Definition A family !F of complex functions f defined on a set E in a metric space X is said to be equicontinuous on E if for every e > 0 there exists a <> > 0 such that 1/(x) - I (y) I < e whenever d(x, y) < <>, x e E, ye E, and/e !F. Here d denotes the metric of X. It is clear that every member of an equicontinuous family is uniformly continuous. The sequence of Example 7.21 is not equicontinuous. Theorems 7.24 and 7.25 will show that there is a very close relation between equicontinuity, on the one hand, and unifor1n convergence of sequences of continuous functions, on the other. But first we describe a selection process which has nothing to do with continuity. 7.23 Theorem If {.fn} is a pointwise bounded sequence of complex Junctions on a countable set E, then {.fn} has a subsequence {.fnk} such that {.fnk(x)} converges for every x e E. SEQUENCES AND SERIES OF FUNCTIONS 157 Proof Let {xi}, i = 1, 2, 3, ... , be the points of E, arranged in a sequence. Since {/n(x1)} is bounded, there exists a subsequence, which we shall denote by {Ii ,k}, such that {.fi ,k( x 1)} converges as k ➔ oo. Let us now consider sequences S 1, S 2 , S 3 , ... , which we represent by the array S1: /1,1 /i,2 /1,3 /1,4 · · · S2: /2,1 /2,2 /2,3 /2,4 · · · S3: /3,1 /3,2 /3,3 /3,4 · · · • • • • • • • • • • • • • • • • • • and which have the following properties: (a) Sn is a subsequence of Sn_ 1, for n = 2, 3, 4, .... (b) {.fn,k(xn)} converges, as k ► oo (the boundedness of {.fn(xn)} makes it possible to choose Sn in this way); (c) The order in which the functions appear is the same in each se- quence; i.e., if one function precedes another in S1, t'iey are in the same relation in every Sn , until one or the other is deleted. Hence, when going from one row in the above array to the next below, functions may move to the left but never to the right. We now go down the diagonal of the array; i.e., we consider the sequence S· \" f f \" · · · • 11,1 2,2 3,3 J4,4 · By (c), the sequence S (except possibly its first n - 1 terms) is a sub- sequence of Sn, for n = 1, 2, 3, . . . . Hence (b) implies that {.fn,n(xi)} converges, as n ► oo, for every xi e E. 7.24 Theorem If K is a compact metric space, if In e ~(K)for n = 1, 2, 3, ... , and if {In} converges uniformly on K, then {.fn} is equicontinuous on K. Proof Let s > 0 be given. Since {In} converges uniformly, there is an integer N such that (42) lfn - fNI < B (n > N). (43) (See Definition 7.14.) Since continuous functions are uniformly con- tinuous on compact sets, there is a b > 0 such that lfi(x) - fi(Y) < B if 1 ~ i ~ N and d(x, y) < b. If n > N and d(x, y) < b, it follows that l.fn(x) - fn(Y) I ~ l.fn(x) - fN(x) I + l[N(x) - fN(Y) I + l[N(Y) - fn(y) I < 3s. In conjunction with (43), this proves the theorem. 158 PRINCIPLES OF MATHEMATICAL ANALYSIS 7.25 Theorem If K is compact, if f,. e <l(K) for n = I, 2, 3, ... , and if {f,.} is pointwise bounded and equicontinuous on K, then (44) (45) (46) (a) {f,.} is uniformly bounded on K, (b) {f,.} contains a uniformly convergent subsequence. Proof (a) Lets> 0 be given and choose {J > 0, in accordance with Definition 7 .22, so that Jf,.(x) - f,.(y) I < s for all n, provided that d(x, y) < D. Since K is compact, there are finitely many points Pi, ... , p, in K such that to every x e K corresponds at least one p 1 with d(x, p 1) < D. Since{f,.} is pointwise bounded, there exist M, < oo such that lf,,(p 1) I < Mi for all n. If M = max (Mi, ... , M,), then 11,,(x)I < M + s for every x e K. This proves (a). (b) Let Ebe a countable dense subset of K. (For the existence of such a set E, see Exercise 25, Chap. 2.) Theorem 7.23 shows that {f,.} has a subsequence {.fn,} such that {f,.,(x)} converges for every x e E. Put In, = g 1 , to simplify the notation. We shall prove that {g 1} converges uniformly on K. Let s > 0, and pick {J > 0 as in the beginning of this proof. Let V(x, {J) be the set of ally e K with d(x, y) < <J. Since Eis dense in K, and K is compact, there are finitely many points Xi, ••• , Xm in E such that Kc V(xi, <J) u · · · u V(xm, <J). Since {g i(x)} converges for every x e E, there is an integer N such that whenever i :2!': N, j :2!': N, 1 :::;; s :::;; m. If x e K, (45) shows that x e V(xs, {J) for some s, so that lg,(x) - g1(xs) I < B for every i. If i :2!': N andj :2!': N, it follows from (46) that lg,(x) - gJ(x) I :5: lgi(x) - g,(xs) I + lg,(xs) - g1(xs) I+ lg1(xs) - gJ(x) I < 3s. This completes the proof. SEQUENCES AND SERIES OF FUNCTIONS 159 THE STONE-WEIERSTRASS THEOREM 7.26 Theorem If f is a continuous complex function on [a, b ], there exists a sequence of polynomials P n such that lim Pn(x) = f(x) n ➔ oo uniformly on [a, b ]. If f is real, the Pn may be taken real. This is the form in which the theorem was originally discovered by Weierstrass. (47) (48) (49) Proof We may assume, without loss of generality, that [a, b] = [O, 1]. We may also assume that /(0) = /(1) = 0. For if the theorem is proved for this case, consider g(x) = f(x) - /(0) - x[/(1) - /(0)] (0 ~ X ~ 1). Here g(O) = g(l) = 0, and if g can be obtained as the limit of a uniformly convergent sequence of polynomials, it is clear that the same is true for f, since f - g is a polynomial. Furthermore, we define/(x) to be zero for x outside [O, 1]. Then/ is uniformly continuous on the whole line. We put where cn is chosen so that 1 Qn(x) dx = 1 -1 (n = 1, 2, 3, ... ), ( n = 1, 2, 3, ... ) . We need some information about the order of magnitude of cn . Since 1 1 (1 - x2)n dx = 2 (1 - x2)n dx '?:. 2 -1 0 '?:.2 it follows from (48) that 1/../n (1 - nx2 ) dx 0 160 PRINCIPLES OF MATHEMATICAL ANALYSIS (50) (51) The inequality (1 - x 2 )n ~ 1 - nx2 which we used above is easily shown to be true by considering the function (1 - x 2)n - 1 + nx2 which is zero at x = 0 and whose derivative is positive in (0, 1). For any b > 0, (49) implies Qn(X) ~ J-;, (1 - b2)n (b ~ Ix I ~ 1), so that Qn ► 0 uniformly in b ~ Ix I ~ 1. Now set 1 Pn(x) = f(x + t)Qn(t) dt (0 ~ X ~ 1). -1 Our assumptions about/ show, by a simple change of variable, that 1-x 1 Pn(X) = f(x + t)Qn(t) dt = f(t)Qn(t - x) dt, -x 0 and the last integral is clearly a polynomial in x. Thus { Pn} is a sequence of polynomials, which are real if/ is real. Givens> 0, we choose b > 0 such that IY - x I < b implies B lf(y) - f(x) I < 2· Let M = sup 1/(x) I, Using (48), (50), and the fact that Qn(x) ~ 0, we see that for O ~ x ~ 1, 1 IPn(x) - f(x) I = [/(x + t) - f(x)]Qn(t) dt -1 1 lf(x + t) - f (x) Qn(t) dt -1 -IJ B lJ 1 ~ 2M -1 Qn(t) dt + 2 -IJ Qn(t) dt + 2M lJ Qn(t) dt for all large enough n, which proves the theorem. It is instructive to sketch the graphs of Qn for a few values of n; also, note that we needed uniform continuity off to deduce uniform convergence of {Pn}. SEQUENCES AND SERIES OF FUNCTIONS 161 In the proof of Theorem 7 .32 we shall not need the full strength of Theorem 7.26, but only the following special case, which we state as a corollary. 7.27 Corollary For every interval [- a, a] there is a sequence of real poly- nomials P n such that P n(O) = 0 and such that lim Pn(x) = Ix I n ➔ oo uniformly on [ - a, a]. Proof By Theorem 7.26, there exists a sequence {P:} of real polynomials which converges to Ix I uniformly on [ - a, a]. In particular, P:(o) ► 0 as n ► oo. The polynomials Pn(x) = P:(x) - P:(O) (n = I, 2, 3, ... ) have desired properties. We shall now isolate those properties of the polynomials which make the Weierstrass theorem possible. 7.28 Definition A family .91 of complex functions defined on a set Eis said to be an algebra if (i) f + g e .91, (ii) fg e .91, and (iii) cf e .91 for all/ e .91, g e .91 and for all complex constants c, that is, if .91 is closed under addition, multi- plication, and scalar multiplication. We shall also have to consider algebras of real functions; in this case, (iii) is of course only required to hold for all real c. If .91 has the property that f e .91 whenever f,, e .91 (n = 1, 2, 3, ... ) and fn ➔ f uniformly on E, then .91 is said to be uniformly closed. Let PJ be the set of all functions which are limits of uniformly convergent sequences of members of .91. Then PA is called the uniform closure of .91. (See Definition 7.14.) For example, the set of all polynomials is an algebra, and the Weierstrass theorem may be stated by saying that the set of continuous functions on [a, b] is the uniform closure of the set of polynomials on [a, b ]. 7.29 Theorem Let PA be the uniform closure of an algebra .91 of bounded functions. Then PA i~ a uniformly closed algebra. Proof If f e PJ and g e PA, there exist uniformly convergent sequences {f,,}, {gn} such thatfn ► /, gn ► g andfn e .91, gn e .91. Since we are dealing with bounded functions, it is easy to show that fn + gn ➔ f + g, fngn ➔ fg, cf,, ► cf, where c is any constant, the convergence being uniform in each case. Hence/+ g e PA,fg e PA, and cf e PA, so that PA is an algebra. By Theorem 2.27, PJ is (uniformly) closed. 162 PRINCIPLES OF MATHEMATICAL ANALYSIS 7.30 Definition Let .91 be a family of functions on a set E. Then .91 is said to separate points on E if to every pair of distinct points x1 , x2 e E there corre- sponds a function/ e .91 such thatf(x1) ::/:-f(x 2). If to each x e E there corresponds a function g e .91 such that g(x) ::/:- 0, we say that .91 vanishes at no point of E. The algebra of all polynomials in one variable clearly has these properties on R1 • An example of an algebra which does not separate points is the set of all even polynomials, say on [ - 1, 1 ], since f ( - x) = f (x) for every even function f The following theorem will illustrate these concepts further. 7.31 Theorem Suppose .91 is an algebra of functions on a set E, .91 separates points on E, and .91 vanishes at no point of E. Suppose x1, x 2 are distinct points of E, and c1 , c2 are constants (real if .91 is a real algebra). Then .91 contains a function f such that Proof The assumptions show that .91 contains functions g, h, and k such that Put has the desired properties. We now have all the material needed for Stone's generalization of the Weierstrass theorem. 7.32 Theorem Let .91 be an algebra of real continuous functions on a compact set K. If .91 separates points on K and if .91 vanishes at no point of K, then the uniform closure di of .91 consists of all real continuous functions on K. We shall divide the proof into four steps. STEP 1 If f e di, then Ill e di. Proof Let (52) a = sup lf(x) I (xeK) (53) SEQUENCES AND SERIES OF FUNCTIONS 163 and let e > O be given. By Corollary 7.27 there exist real numbers Ci, ••• 'Cn such that n L c,y' - IY I < 8 (-a :S:y :S:a). I= 1 Since di is an algebra, the function n u = L c,f' I= 1 is a member of di. By (52) and (53), we have lu(x) - lf(x) 11 < e (x e K). Since di is uniformly closed, this shows that 1/1 e di. STEP 2 If f e di and g e di, then max (f, g) e di and min (f, g) e di. By max (f, g) we mean the function h defined by h(x) = f(x) g(x) if f (x) ~ g(x), if/ (x) < g(x), and min (f, g) is defined likewise. Proof Step 2 follows from step 1 and the identities f + u lf-g I max (f, g) = 2 + 2 , By iteration, the result can of course be extended to any finite set of functions: If Ii, ... ,In e di, then max (Ii, ... ,In) e di, and min (Ii, ... ,In) e di. STEP 3 Given a real function f, continuous on K, a point x e K, and e > 0, there exists a/unction Ux e di such that Ux(x) =f(x) and (54) (55) Ux(t) > f(t) - e (t E .((). Proof Since .91 c di and d satisfies the hypotheses of Theorem 7.31 so does di. Hence, for every y e K, we can find a function h., e di such that h.,(x) = f (x), h.,(y) = f (y). 164 PlllNCIPLES OF MATHEMATICAL ANALYSIS (56) (57) By the continuity of h, there exists an open set J, , containing y, such that h,(t) > f(t) - B (t eJ,). Since K is compact, there is a finite set of points Yi, ... , Yn such that Put Ux = max (h., 1 , ••• , h.,\"). By step 2, g e di, and the relations (55) to (57) show that Ux has the other X required properties. STEP 4 Given a real function!, continuous on K, and B > 0, there exists a function h e di such that (58) lh(x) - f(x) I < B (x EK), Since di is uniformly closed, this statement is equivalent to the conclusion of the theorem. (59) (60) (61) (62) Proof Let us consider the functions Ux, for each x e K, constructed in step 3. By the continuity of Ux, there exist open sets Vx containing x, such that Ux(t) <f(t) + B Since K is compact, there exists a finite set of points xi, ... , x,n such that Put h = min (Ux1 , , , , , Uxm). By step 2, h e di, and (54) implies h(t) > f(t)- B whereas (59) and (60) imply h(t) < f(t) + e Finally, (58) follows from (61) and (62). (t EK), (t e K). SEQUENCES AND SERIES OF FUNCTIONS 165 Theorem 7.32 does not hold for complex algebras. A counterexample is given in Exercise 21. However, the conclusion of the theorem does hold, even for complex algebras, if an extra condition is imposed on d, namely, that d be self-adjoint. This means that for every fed its complex conjugate J must also belong to d; J is defined by J(x) = f (x). 7.33 Theorem Suppose d is a self-adjoint algebra of complex continuous .functions on a compact set K, d separates points on K, and d vanishes at no point of K. Then the uniform closure f!4 of d consists of all complex lOntinuous functions on K. In other words, dis dense CC(K). Proof Let d R be the set of all real functions on K which belong to d. If f e d and f = u + iv, with u, v real, then 2u = f + J, and since d is self-adjoint, we see that u e d R. If x 1 =I= x 2 , there exists fed such that f(x 1) = 1,f(x 2 ) = O; hence O = u(x2 ) =I= u(x1) = I, which shows that d R separates points on K. If x e K, then g(x) =I= 0 for some g e d, and there is a complex number ;. such that lg(x) > O; if f = ).g,f = u + iv, it follows that u(x) > 0; hence d R vanishes at no point of K. Thus d R satisfies the hypotheses of Theorem 7 .32. It follows that every real continuous function on K lies in the uniform closure of d R , hence lies in f!4. If f is a complex continuous function on K, f = u + iv, then u e f!4, v e f!4, hence f e f!4. This completes the proof. EXERCISES 1. Prove that every uniformly convergent sequence of bounded functions is uni- formly bounded. 2. If {In} and {gn} converge uniformly on a set E, prove that {In + Un} converges uniformly on E. If, in addition, {In} and {gn} are sequences of bounded functions, prove that {f,,g\"} converges uniformly on E. 3. Construct sequences {/,,}, {gn} which converge u11iformly on some set E, but such that {fngn} does not converge uniformly on E (of course, {fngn} must converge on E). 4. Consider 00 1 f(x) = L 1 + 2 • n= 1 n X For what values of x does the series converge absolutely? On what intervals does it converge uniformly? On what intervals does it fail to converge uniformly? Is I continuous wherever the series converges? Is I bounded? 166 PRINCIPLES OF MATHEMATICAL ANALYSIS s. Let f,,(x) = 0 • 2 7T Sin - X 0 1 X < 1 , n+ 1 1 n+l ~x~~' 1 - <x . n Show that {f,,} converges to a continuous function, but not uniformly. Use the series I: fn to show that absolute convergence, even for all x, does not imply uni- f or1n convergence. 6. Prove that the series converges uni'for1nly in every bounded interval, but does not converge absolutely for any value of x. 7. For n = 1, 2, 3, ... , x real, put X fn(x) = 1 + nx2. Show that {In} converges uniformly to a function/, and that the equation f'(x) = Iimf~(x) ft➔ 0() is correct if x ¥= 0, but false if x = 0. 8. If 0 I(x) = l (x ~0), (x > 0), if {xn} is a sequence of distinct points of (a, b), and if I: I en I converges, prove that the series 0() f(x) = L Cn l(x - x,.) n•1 (a~x~b) converges uniformly, and that f is continuous for every x ¥= Xn • 9. Let {In} be a sequence of continuous functions which converges uniformly to a function f on a set E. Prove that lim fn(xn) = f(x) n ➔ oo for every sequence of points Xn e E such that Xn ► x, and x e E. Is the converse of this true? SEQUENCES AND SERIES OF FUNCTIONS 167 10. Letting (x) denote the fractional part of the real number x (see Exercise 16, Chap. 4, for the definition), consider the function f(x) = f (n~) n•l n (x real). Find all discontinuities of f, and show that they form a countable dense set. Show that f is nevertheless Riemann-integrable on every bounded interval. 11. Suppose {f,.}, {gn} are defined on E, and (a) ~In has uniformly bounded partial sums; (b) Un ► 0 uniformly on E; (c) U1(x) ~U2(x) ~g3(x) ~ · · · for every x e E. Prove that ~ J,,gn converges uniformly on E. Hint: Compare with Theorem 3.42. 12. Suppose g andf,.(n = 1, 2, 3, ... ) are defined on (0, oo ), are Riemann-integrable on [t, T] whenever O < t < T < oo, If,, I -::;;, g, f,, ➔ f uniformly on every compact sub- set of (0, oo ), and Prove that 0() lim n ➔ ao 0 0() g(x) dx < oo. 0 0() f,,(x) dx = f(x) dx. 0 (See Exercises 7 and 8 of Chap. 6 for the relevant definitions.) This is a rather weak form of Lebesgue's dominated convergence theorem (Theorem 11.32). Even in the context of the Riemann integral, uniform conver- gence can be replaced by pointwise convergence if it is assumed that .f e g,f. (See the articles by F. Cunningham in Math. Mag., vol. 40, 1967, pp. 179-186, and by H. Kestelman in Amer. Math. Monthly, vol. 77, 1970, pp. 182-187.) 13. Assume that {f,.} is a sequence of monotonically increasing functions on R 1 with 0 s.f,,(x) s. 1 for all x and all n. (a) Prove that there is a function/ and a sequence {nk} such that f(x) = lim f,.k(x) k➔ ao for every x e R 1 • (The existence of such a pointwise convergent subsequence is usually called Belly's selection theorem.) (b) If, moreover, f is continuous, prove that f,,\" ➔ f uniformly on compact sets. Hint: (i) Some subsequence {f,, 1} converges at all rational points r, say, to /'(r ). (ii) Define f(x), for any x e R 1 , to be sup f(r ), the sup being taken over all r s. x. (iii) Show that /n1(x) ► /(x) at every x at which / is continuous. (This is where monotonicity is strongly used.) (iv) A subsequence of {f,.1} converges at every point of discontinuity of f since there are at most countably many such points. This proves (a). To prove (b), modify your proof of (iii) appropriately. 168 PRINCIPLES OF MATHEMATICAL ANALYSIS 14. Let I be a continuous real function on R 1 with the following properties: 0 s. l(t) s 1,l(t + 2) = /(t) for every t, and 0 f(t) = l Put <l>(t) = (x(t), y(t)), where 0() x(t) = L 2-n1(32n-1t), n•l (0 s. ts. t) (! s. ts. 1). 0() y(t) = L 2-nl(3 2nt). n=l Prove that <I> is continuous and that <I> maps / = [O, 1] onto the unit square / 2 c: R 2 • If fact, show that <I> maps the Cantor set onto / 2 • Hint: Each (xo, Yo) e / 2 has the form 0() Xo = L 2-na2n-1, n=l where each a, is O or 1. If 0() 0() Yo= L 2-na2n n=t to= l: 3- 1 - 1(2a,) I= 1 show that/(3\"to) =a\", and hence that x(to) = Xo, y(to) =Yo. (This simple example of a so-called '' space-filling curve'' is due to I. J. Schoenberg, Bull. A.M.S., vol. 44, 1938, pp. 519.) 15. Suppose/'is a real continuous function on R 1,ln(t) =l(nt) for n =1, 2, 3, ... , and {/~} is equicontinuous on [O, 1]. What conclusion can you draw about I? 16. Suppose {In} is an equicontinuous sequence of functions on a compact set K, and {In} converges pointwise on K. Prove that {f,.} converges uniformly on K. 17. Define the notions of uniform convergence and equicontinuity for mappings into any metric space. Show that Theorems 7.9 and 7.12 are valid for mappings into any metric space, that Theorems 7.8 and 7.11 are valid for mappings into any complete metric space, and that Theorems 7.10, 7.16, 7.17, 7.24, and 7.25 hold for vector-valued functions, that is, for mappings into any R\". 18. Let {In} be a uniformly bounded sequence of functions which are Riemann-inte- grable on [a, b ], and put X Fn(X) = fn(t) dt (as x s. b). a Prove that there exists a subsequence {Fn\"} which converges uniformly on [a, b]. 19. Let K be a compact metric space, let S be a subset of <t'(K). Prove that Sis compact (with respect to the metric defined in Section 7.14) if and only if S is uniformly closed, pointwise bounded, and equicontinuous. (If S is not equicontinuous, then S contains a sequence which has no equicontinuous subsequence, hence has no subsequence that converges uniformly on K.) SEQUENCES AND SERIES OF FUNCTIONS 169 20. If f is continuous on [O, 1] and if 1 f(x)x\" dx = 0 (n = 0, 1, 2, ... ), 0 prove that /(x) = 0 on [O, 1]. Hint: The integral of the product off with any 1 polynomial is zero. Use the Weierstrass theorem to show that O / 2(x) dx = 0. 21. Let K be the unit circle in the complex plane (i.e., the set of all z with I z I = 1 ), and let d be the algebra of all functions of the form N f(e 19) = L Cne1 \" 9 (0 real). n=O Then d separates points on Kand d vanishes at no point of K, but nevertheless there are continuous functions on K which are not in the uniform closure of d. Hint: For every/ e d lit f(e 19)e 19 d0 = 0, 0 and this is also true for every/ in the closure of d. 22. Assume/e al(~) on [a, b], and prove that there are polynomials Pn such that b lim n ➔ oo 0 (Compare with Exercise 12, Chap. 6.) 23. Put Po= 0, and define, for n = 0, 1, 2, ... , x 2 -P;(x) Pn+i(x) =Pn(X) + 2 . Prove that lim Pn(x) = lxl, n ➔ ao uniformly on [-1, 1]. (This makes it possible to prove the Stone-Weierstrass theorem without first proving Theorem 7.26.) Hint: Use the identity lxl+Pn(X) lxl -Pn+i(x) = [!xi -Pn(x)] 1- 2 to prove that O s.Pn(x) s.Pn+i(x) s. !xi if !xi s.1, and that IX I n 2 IX I - Pn(X) S. IX I 1 - 2 < n + l if Ix I s. 1. 170 PRINCIPLES OF MATHEMATICAL ANALYSIS 24. Let X be a metric space, with metric d. Fix a point a e X. Assign to each p e X the function JP defined by fp(x) = d(x, p) - d(x, a) (x e X). Prove that I /,,(x) Is. d(a,p) for all x e X, and that therefore JP e ~(X). Prove that 11111 - hll = d(p, q) for all p, q e X. If <I>(p) = f,, it follows that <I> is an isometry (a distance-preserving mapping) of X onto <P(X) c: ~(X). Let Y be the closure of <P(X) in ~(X). Show that Y is complete. Conclusion: X is isometric to a dense subset of a complete metric space Y. (Exercise 24, Chap. 3 contains a different proof of this.) 25. Suppose <p is a continuous bounded real function in the strip defined by 0 s x s 1, - oo < y < oo. Prove that the initial-value problem y' = <p(x, y), y(O) = C has a solution. (Note that the hypotheses of this existence theorem are less stringent than those of the corresponding uniqueness theorem; see Exercise 27, Chap. 5.) Hint: Fix n. For i = 0, ... , n, put x, = i/n. Let In be a continuous function on [O, 1] such that fn(O) = c, J~(t) = <p(x,, fn(x,)) if Xt < t < Xt + 1, and put L\\n(t) = f~(t)- <p(t,fn(t)), except at the points x,, where L\\n(t) = 0. Then X fn(X) = C + [<p(t,[n(t)) + L\\n(t)] dt. 0 Choose M < oo so that I <p I s M. Verify the following assertions. (a) If~ I s. M, I L\\n I s. 2M, L\\\" E rJf, and I In I s. I c I + M = M1, say, on [O, l], for all n. (b) {f,.} is equicontinuous on [O, 1], since I/~ I s. M. (c) Some {In\"} converges to some/, uniformly on [O, 1]. (d) Since <p is uniformly continuous on the rectangle Os. x s. 1, !YI s. M1, <p(t,fnk(t))-➔ <p(t,f(t)) uniformly on [O, 1]. (e) L\\n(t) ➔ 0 uniformly on [0, 1], since An(t) = <p(x,, fn(x,)) - <p(t, f,.(t)) SEQUENCES AND SERIES OF FUNCTIONS 171 (/) Hence X /(x) = c + <p(t,f(t)) dt. 0 This f is a solution of the given problem. 26. Prove an analogous existence theorem for the initial-value problem y' = cl»(x, y), y(O) = c, where now c e Rk, ye Rk, and «z, is a continuous bounded mapping of the part of Rk+i defined by O ~ x ~ 1, ye R\" into R\". (Compare Exercise 28, Chap. 5.) Hint: Use the vector-valued version of Theorem 7.25. SOME SPECIAL FUNCTIONS POWER SERIES In this section we shall derive some properties of functions which are represented by power series, i.e., functions of the form 00 (I) f(x) = L CnXn n=O or, more generally, 00 (2) f(x) = L cn(X - a)n. n=O These are called analytic functions. We shall restrict ourselves to real values of x. Instead of circles of con- vergence (see Theorem 3.39) we shall therefore encounter intervals of conver- gence. If (1) converges for all x in (-R, R), for some R > 0 (R may be + oo), we say that/is expanded in a power series about the point x = 0. Similarly, if (2) converges for J x - a I < R, f is said to be expanded in a power series about the point x = a. As a matter of convenience, we shall often take a= 0 without any loss of generality. SOME SPECIAL FUNCTIONS 173 8.1 Theorem Suppose the series (3) converges for Ix I < R, and define 00 (4) f(x) = I CnXn (IX I < R). n=O Then (3) converges uniformly on [ - R + 8, R - 8 ], no matter which 8 > 0 is chosen. The function f is continuous and differentiable in ( - R, R), and (5) 00 f'(x) = I ncnxn-l (lxl<R). n=l Proof Let 8 > 0 be given. For Ix I ~ R - 8, we have I C nXn I ~ I C n( R - 8 )n I ; and since :f.cn(R -8) n converges absolutely ( every power series converges absolutely in the interior of its interval of convergence, by the root test), Theorem 7.10 shows the uniform convergence of (3) on [-R + 8, R - 8]. Since jn ➔ I as n ➔ oo, we have lim sup jnl cnl = lim sup 11 cnl, n-+ oo n-+ oo so that the series (4) and (5) have the same interval of convergence. Since (5) is a power series, it converges uniformly in [ -R + 8, R - 8], for every 8 > 0, and we can apply Theorem 7.17 (for series in- stead of sequences). It follows that (5) holds if Ix I ~ R - 8. But, given any x such that Ix I < R, we can find an 8 > 0 such that Ix I < R - 8. This shows that (5) holds for Ix I < R. Continuity off follows from the existence off' (Theorem 5.2). Corollary Under the hypotheses of Theorem 8.1, f has derivatives of all orders in ( - R, R), which are given by 00 (6) f<k>(x) = I n(n - I)··· (n - k + I)cnxn-k. n=k In particular, (7) (k = 0, I, 2, ... ). (Here f<0> means f, and f<k> is the kth derivative off, for k = I, 2, 3, ... ). 174 PRINCIPLES OF MATHEMATICAL ANALYSIS Proof Equation (6) follows if we apply Theorem 8.1 successively to f, f', f\", . . . . Putting x = 0 in (6), we obtain (7). Formula (7) is very interesting. It shows, on the one hand, that the coefficients of the power series development off are determined by the values off and of its derivatives at a single point. On the other hand, if the coefficients are given, the values of the derivatives off at the center of the interval of con- vergence can be read off immediately from the power series. Note, however, that although a function f may have derivatives of all orders, the series Icn x\", where en is computed by (7), need not converge to f(x) for any x #= 0. In this case, f cannot be expanded in a power series about x = 0. For if we had/(x) = Ianx\", we should have n !an = 1<n>(o); hence an = cn . An example of this situation is given in Exercise I. If the series (3) converges at an endpoint, say at x = R, then/is continuous not only in ( - R, R), but also at x = R. This follows from Abel's theorem (for simplicity of notation, we take R = I): 8.2 Theorem Suppose Icn converges. Put 00 f(x) = L CnXn (-I <x< I). n=O Then 00 (8) limf(x) = L Cn, x-+1 n=O Proof Let Sn= Co+ ... + Cn, S-1 = 0. Then m m m-1 L CnXn = L (sn - Sn-1)x\" = (I - x) L SnXn + Sm~• n=O n=O n=O For I xi < I, we let m ➔ co and obtain 00 (9) f(x) = (I - x) L snx\". n=O Suppose s = lim sn. Let e > 0 be given. Choose N so that n > N implies SOME SPECIAL FUNCTIONS 175 Then, since 00 (I - x) L xn = I (IX I < I), n=O we obtain from (9) if x > I - o, for some suitably chosen o > 0. This implies (8). As an application, let us prove Theorem 3.51, which asserts: lf\"i:,an, \"i:,bn, \"i:,cn, converge to A, B, C, and if en = a0 bn + · · · + an b0 , then C = AB. We let 00 00 00 f(x) = L an xn, g(x) = L bnxn, h(x) = L Cn Xn, n=O n=O n=O for O ::5: x ::5: I. For x < 1, these series converge absolutely and hence may be multiplied according to Definition 3.48; when the multiplication is carried out, we see that (10) f(x) · g(x) = h(x) (0 ::5: x < I). By Theorem 8.2, (11) f(x) > A, g(x) ➔ B, h(x) ➔ C as x , I. Equations (10) and (II) imply AB = C. We now require a theorem concerning an inversion in the order of sum- mation. (See Exercises 2 and 3.) 8.3 Theorem Given a double sequence {a,j}, i = 1, 2, 3, ... , j = I, 2, 3, ... , suppose that (12) (i=l,2,3, ... ) and r.b, converges. Then (13) Proof We could establish (13) by a direct procedure similar to (although more involved than) the one used in Theorem 3.55. However, the following method seems more interesting. 176 PRINCIPLES OF MATHEMATICAL ANALYSIS (14) (15) (16) Let Ebe a countable set, consisting of the points x 0 , x1 , x 2 , ••• , and suppose Xn ► x 0 as n ► oo. Define 00 fi(xo) = L aii (i = 1, 2, 3, ... ), j=1 n fi(xn) = L aii (i, n = I, 2, 3, ... ), j=1 00 g(x) = L fi(x) (x e E). i= 1 Now, (14) and (15), together with (12), show that each Ji is con- tinuous at x 0 • Since lf;(x) I:::; b; for x e E, (16) converges uniformly, so that g is continuous at x 0 (Theorem 7.11). It follows that 00 00 00 L L aii = L /;(xo) = g(xo) = lim g(xn) i=lj=l i=l n-+oo oo oo n = lim L f;(xn) = lim L L a;i n-+ooi=l n-+oo i=l j=l n oo 0000 = lim \" \" a .. = '°' \" a .. L.,. L.,. IJ L.,. L.,. IJ ' n-+ooj=li=l j=li=l 8.4 Theorem Suppose 00 f(x) = L en xn, n=O the series converging in Ix I < R. If -R < a < R, then f can be expanded in a power series about the point x = a which converges in Ix - a I < R - I a I , and oo J<n>(a) f (x) = L -- (x - a)n n=O n ! (17) (Ix - a I < R - I a I). This is an extension of Theorem 5.15 and is also known as Taylor's theorem. Proof We have 00 f(x) = L cn[(x - a) + a]n n=O 00 n n = Len L m n=O m=O OC) OC) n I I -- m m=O n=m (18) (19) SOME SPECIAL FUNCTIONS 177 This is the desired expansion about the point x = a. To prove its validity, we have to justify the change which was made in the order of summation. Theorem 8.3 shows that this is permissible if converges. But (18) is the same as 00 L I Cn I · (IX - a I + I a I )n, n=O and (19) converges if Ix - a I + I a I < R. Finally, the form of the coefficients in (17) follows from (7). It should be noted that (17) may actually converge in a larger interval than the one given by Ix - a I < R - I a I . If two power series converge to the same function in ( - R, R), (7) shows that the two series must be identical, i.e., they must have the same coefficients. It is interesting that the same conclusion can be deduced from much weaker hypotheses: 8.5 Theorem Suppose the series I:an xn and I:bn xn converge in the segment S = (-R, R). Let Ebe the set of all x e Sat which 00 00 (20) Lan~= L bn~· n=O n=O If E has a limit point in S, then an= bnfor n = 0, 1, 2, .... Hence (20) holds for all x e S. (21) Proof Put Cn = an - bn and 00 f(x) =Len~ (x ES). n=O Then f(x) = 0 on E. Let A be the set of all limit points of E in S, and let B consist of all other points of S. It is clear from the definition of ''limit point'' that B is open. Suppose we can prove that A is open. Then A and Bare disjoint open sets. Hence they are separated (Definition 2.45). Since S = A u B, and Sis connected, one of A and B must be empty. By hypothesis, A is not empty. Hence B is empty, and A = S. Since f is continuous in S, A c E. Thus E = S, and (7) shows that en = 0 for n = 0, 1, 2, ... , which is the desired conclusion. 178 PRINCIPLES OF MATHEMATICAL ANALYSIS (22) (23) (24) Thus we have to prove that A is open. If x 0 e A, Theorem 8.4 shows that 00 f(x) = L dn(X - Xo)n ( I x - Xo I < R - I Xo I ). n=O We claim that dn = 0 for all n. Otherwise, let k be the smallest non- negative integer such that dk #= 0. Then f (x) = (x - x0)kg(x) ( / x - Xo I < R - I Xo I), where 00 g(x) = L dk+m(X - Xo)m. m=O Since g is continuous at x 0 and g(xo) = dk #= 0, there exists a o > 0 such that g(x) #= 0 if Ix - x0 I < o. It follows from (23) that f(x) #= 0 if O < l x - x 0 l < o. But this contradicts the fact that x 0 is a limit point of E. Thus dn = 0 for all n, so that/(x) = 0 for all x for which (22) holds, i.e., in a neighborhood of x 0 • This shows that A is open, and completes the proof. THE EXPONENTIAL AND LOGARITHMIC FUNCTIONS We define (25) oo Zn E(z) = L 1 n=O n. The ratio test shows that this series converges for every complex z. Applying Theorem 3.50 on multiplication of absolutely convergent series, we obtain oo Zn oo Wm oo n ZkWn-k E(z)E(w) = L - L - = L L -- n=o n! m=O m! n=O k=O k!(n - k)! - f 1 f n k n -k - ~ (z + w )n - L, - L, z w - L, ---, n=O n! k=O k n=O n! which gives us the important addition formula (26) (27) E(z + w) = E(z)E(w) One consequence is that (z, w complex). E(z)E( - z) = E(z - z) = E(O) = 1 (z complex). SOME SPECIAL FUNCTIONS 179 This shows that E(z) #= 0 for all z. By (25), E(x) > 0 if x > 0; hence (27) shows that E(x) > 0 for all real x. By (25), E(x) ► + oo as x ► + oo; hence (27) shows that E(x) ➔ 0 as x ➔ - oo along the real axis. By (25), 0 < x < y implies that E(x) < E(y); by (27), it follows that E( - y) < E( - x); hence E is strictly in- creasing on the whole real axis. The addition formula also shows that (28) lim E(z + h) - E(z) = E(z) lim E(h) - I = E(z); h=O h h=O h the last equality follows directly from (25). Iteration of (26) gives (29) Let us take z1 = · · · =Zn= I. Since E(l) = e, where e is the number defined in Definition 3.30, we obtain (30) E(n) = en (n = I, 2, 3, ... ). If p = n/m, where n, m are positive integers, then (31) so that (32) [E(p)]m = E(mp) = E(n) = en, E(p) = eP (p > 0, p rational). It follows from (27) that E(-p) = e-p if p is positive and rational. Thus (32) holds for all rational p. In Exercise 6, Chap. 1, we suggested the definition (33) where the sup is taken over all rational p such that p < y, for any real y, and x > I. If we thus define, for any real x, (34) (p < x, p rational), the continuity and monotonicity properties of E, together with (32), show that (35) E(x) = ex for all real x. Equation (35) explains why E is called the exponential function. The notation exp (x) is often used in place of ex, expecially when x is a complicated expression. Actually one may very well use (35) instead of (34) as the definition of ex; (35) is a much more convenient starting point for the investigation of the properties of ex. We shall see presently that (33) may also be replaced by a more convenient definition [see (43)]. 180 PRINCIPLES OF MATHEMATICAL ANALYSIS We now revert to the customary notation, ex, in place of E(x), and sum- marize what we have proved so far. 8.6 Theorem Let ex be defined on R 1 by (35) and (25). Then (a) ex is continuous and differentiable for all x,· (b) (ex)' = ex; (c) ex is a strictly increasing function of x, and ex> O; (d) ex+y = eXeY; ( e) ex > + oo as x > + oo, ex > 0 as x > - oo ; (f) limx ... + 00xne- x = 0, for every n. Proof We have already proved (a) to (e); (25) shows that for x > 0, so that Xn+l X e > (n + I)! n-x (n+l)! xe <---, X and (f) follows. Part (f) shows that ex tends to + oo ''faster'' than any power of x, as x > + oo. Since E is strictly increasing and differentiable on R 1 , it has an inverse function L which is also strictly increasing and differentiable and whose domain is E(R 1 ), that is, the set of all positive numbers. L is defined by (36) or, equivalently, by (37) E(L(y)) = y L(E(x)) = x (y > 0), (x real). Dift\"erentiating (37), we get (compare Theorem 5.5) L'(E(x)) · E(x) = 1. Writing y = E(x), this gives us '( 1 Ly)=- y (38) (y > 0). Taking x = 0 in (37), we see that L(l) = 0. Hence (38) implies (39) L(y)= Ydx -. 1 X SOME SPECIAL FUNCTIONS 181 Quite frequently, (39) is taken as the starting-point of the theory of the logarithm and the exponential function. Writing u = E(x), v = E(y), (26) gives L(uv) = L(E(x) • E(y)) = L(E(x + y)) = x + y, so that (40) L(uv) = L(u) + L(v) (u > 0, V > 0). This shows that L has the familiar property which makes logarithms useful tools for computation. The customary notation for L(x) is of course log x. As to the behavior of log x as x ► + oo and as x ► 0, Theorem 8.6(e) shows that (41) log x ► + oo log x ► -oo It is easily seen that as x ► + oo, as x ► 0. xn = E(nL(x)) if x > 0 and n is an integer. Similarly, if m is a positive integer, we have (42) 1 x 11m = E - L(x) , m since each term of (42), when raised to the mth power, yields the corresponding term of (36). Combining (41) and (42), we obtain (43) x« = E(<XL(x)) = e«logx for any rational <X. We now define x«, for any real <X and any x > 0, by (43). The continuity and monotonicity of E and L show that this definition leads to the same result as the previously suggested one. The facts stated in Exercise 6 of Chap. 1, are trivial consequences of ( 43). (44) If we differentiate {43), we obtain, by Theorem 5.5, (X (x«)' = E(<XL(x)) · - = <Xx«- 1 • X Note that we have previously used (44) only for integral values of <X, in which case (44) follows easily from Theorem 5.3(b). To prove (44) directly from the definition of the derivative, if x« is defined by (33) and <X is irrational, is quite troublesome. The well-known integration formula for x« follows from (44) if <X =t:- -1, and from (38) if <X = -1. We wish to demonstrate one more property of log x, namely, (45) lim x-« 1og x = 0 x-+ + oo 182 PRINCIPLES OF MATHEMATICAL ANALYSIS for every tx > 0. That is, log x > + oo ''slower'' than any positive power of x, as x > + oo. For if O < e < tx, and x > 1, then X X - X - ex log X = X - ex f - 1 dt < X - ex te - 1 dt 1 1 Xe - 1 Xe-ex = x-cx. -- < --, 8 8 and ( 45) follows. We could also have used Theorem 8.6(/) to derive ( 45). THE TRIGONOMETRIC FUNCTIONS Let us define (46) 1 C(x) = 2 [E(ix) + E( - ix)], 1 S(x) = 2i [E(ix) - E(-ix)]. We shall show that C(x) and S(x) coincide with the functions cos x and sin x, whose definition is usually based on geometric considerations. By (25), E(z) = E(z). Hence (46) shows that C(x) and S(x) are real for real x. Also, (47) E(ix) = C(x) + iS(x). Thus C(x) and S(x) are the real and imaginary parts, respectively, of E(ix), if x is real. By (27), so that (48) I E(ix) 12 = E(ix)E(ix) = E(ix)E( -ix) = 1, \\E(ix)I = 1 (x real). From ( 46) we can read off that C(O) = 1, S(O) = 0, and (28) shows that (49) C'(x) = -S(x), S'(x) = C(x). We assert that there exist positive numbers x such that C(x) = 0. For suppose this is not so. Since C(O) = 1, it then follows that C(x) > 0 for all x > 0, hence S'(x) > 0, by (49), hence Sis strictly increasing; and since S(O) = 0, we have S(x) > 0 if x > 0. Hence if O < x < y, we have (50) y S(x)(y - x) < S(t) dt = C(x) - C(y) s; 2. I .I X The last inequality follows from (48) and (47). Since S(x) > 0, (50) cannot be true for large y, and we have a contradiction. SOME SPECIAL FUNCTIONS 183 Let x 0 be the smallest positive number such that C(x0 ) = 0. This exists, since the set of zeros of a continuous function is closed, and C(O) '#- 0. We define the number 7t by (51) 7t = 2x0 • Then C(1t/2) = 0, and (48) shows that S(1t/2) = ± 1. Since C(x) > 0 in (0, 1t/2), S is increasing in (0, 1t/2); hence S(1t/2) = 1. Thus • E 11:l 2 • = ,, and the addition formula gives (52) hence E(1r:i) = -1, E(21r:i) = 1; (53) E(z + 211:i) = E(z) (z complex). 8.7 Theorem (a) The function Eis periodic, with period 211:i. (b) The functions C and Sare periodic, with period 21t. (c) If O < t < 211:, then E(it) #:- 1. (d) If z is a complex number ¾'ith I z I = 1, there is a unique t in [O, 21t) such that E(it) = z. Proof By (53), (a) holds; and (b) follows from (a) and (46). Suppose O < t < 11:/2 and E(it) = x + iy, with x, y real. Our preceding work shows that O < x < 1, 0 < y < 1. Note that E(4it) = (x + iy)4 = x4 - 6x2y 2 + y 4 + 4ixy(x2 - y 2). If E(4it) is real, it follows that x2 - y 2 = O; since x2 + y 2 = 1, by (48), we have x 2 = y 2 = ½, hence E(4it) = -1. This proves (c). If O :S: t1 < t 2 < 21t, then E(it2)[E(it1)]- 1 = E(it2 - it1) #:- 1, by (c). This establishes the uniqueness assertion in (d). To prove the existence assertion in (d), fix z so that I z I = 1. Write z = x + iy, with x and y real. Suppose first that x :2:: 0 and y :2:: 0. On [O, 1t/2], C decreases from 1 to 0. Hence C(t) = x for some t e [O, 1t/2]. Since C2 + S 2 = 1 and S :2:: O on [O, 1t/2], it follows that z = E(it ). If x < 0 and y :2:: 0, the preceding conditions are satisfied by - iz. Hence -iz = E(it) for some t e [O, 1t/2], and since i = E(ni/2), we obtain z = E(i(t + 1t/2)). Finally, if y < 0, the preceding two cases show that 184 PRINCIPLES OF MATHEMATICAL ANALYSIS - z = E(it) for some t e (0, tr). Hence z = - E(it) = E(i(t + tr)). This proves (d), and hence the theorem. It follows from (d) and ( 48) that the curve y defined by (54) y(t) = E(it) (0 s t S 2tr) is a simple closed curve whose range is the unit circle in the plane. Since y'(t) = iE(it), the length of y is 2n I y'(t) I dt = 2tr, 0 by Theorem 6.27. This is of course the expected result for the circumference of a circle of radius 1. It shows that tr, defined by (51), has the usual geometric significance. In the same way we see that the point y(t) describes a circular arc of length t0 as t increases from O to t0 • Consideration of the triangle whose vertices are z1 = 0, z2 = y(t0 ), z3 = C(t 0 ) shows that C(t) and S(t) are indeed identical with cos t and sin t, if the latter are defined in the usual way as ratios of the sides of a right triangle. It should be stressed that we derived the basic properties of the trigono- metric functions from (46) and (25), without any appeal to the geometric notion of angle. There are other nongeometric approaches to these functions. The papers by W. F. Eberlein (Amer. Math. Monthly, vol. 74, 1967, pp. 1223-1225) and by G. B. Robison (Math. Mag., vol. 41, 1968, pp. 66-70) deal with these topics. THE ALGEBRAIC COMPLETENESS OF THE COMPLEX FIELD We are now in a position to give a simple proof of the fact that the complex field is algebraically complete, that is to say, that every nonconstant polynomial with complex coefficients has a complex root. 8.8 Theorem Suppose a0 , ••• , an are complex numbers, n ~ 1, an =I=- 0, n P(z) = L ak zk. 0 Then P(z) = 0 for some complex number z. Proof Without loss of generality, assume an= 1. Put (55) µ = inf I P(z) I (z complex) If lzl = R, then (56) IP(z)I ~ Rn[l - lan-1 IR- 1 - · · · - laolR-n]. SOME SPECIAL FUNCTIONS 185 The right side of (56) tends to oo as R > oo. Hence there exists R0 such that I P(z) I > µ if I z I > R0 • Since IP I is continuous on the closed disc with center at O and radius R 0 , Theorem 4.16 shows that I P(z0) I = µ for some z0 • We claim thatµ= 0. If not, put Q(z) = P(z + z0)/P(z0). Then Q is a nonconstant poly- nomial, Q(O) = 1, and I Q(z) I :2:: 1 for all z. There is a smallest integer k, 1 :s; k :s; n, such that (57) Q(z) = 1 + bkzk + · · · + bnzn, bk =I- 0. By Theorem 8.7(d) there is a real 0 such that (58) e1k8bk = - I bk I• If r > 0 and rklbkl < 1, (58) implies 11 + bk rkeik8 I = 1 - rk I bk I , so that I Q(rei8)1 ~ 1 - rk{lbkl - rlbk+1 I - · · · - ,n-klbnl}, For sufficiently small r, the expression in braces is positive; hence I Q(rei8) I < 1, a contradiction. Thus µ = 0, that is, P(z0) = 0. Exercise 27 contains a more general result. FOURIER SERIES 8.9 Definition A trigonometric polynomial is a finite sum of the form N (59) f(x) = a0 + I (an cos nx + bn sin nx) (x real), n=l where a0 , ••• , aN, b1 , ... , bN are complex numbers. On account of the identities ( 46), (59) can also be written in the form (60) N f (x) = L en einx -N (x real), which is more convenient for most purposes. It is clear that every trigonometric polynomial is periodic, with peribd 2n. If n is a nonzero integer, e1nx is the derivative of einx/in, which also has period 2n. Hence (61) 1 n 1 e'nx dx = 2n -n 0 (if n = 0), (if n = ±I, ± 2, ... ). 186 PRINCIPLES OF MATHEMATICAL ANALYSIS Let us multiply (60) by e- imx, where m is an integer; if we integrate the product, (61) shows that (62) 1 ff C - f(x)e- imx dx m = 2tr -n for Im I ~ N. If Im I > N, the integral in (62) is 0. The following observation can be read off from (60) and (62): The - trigonometric polynomial f, given by (60), is real if and only if c _n = Cn for n = 0, ... , N. In agreement with (60), we define a trigonometric series to be a series of the form (63) (x real); the Nth partial sum of (63) is defined to be the right side of (60). If f is an integrable function on [ - tr, tr], the numbers cm defined by (62) for all integers m are called the Fourier coefficients off, and the series (63) formed with these coefficients is called the Fourier series off. The natural question which now arises is whether the Fourier series off converges to f, or, more generally, whether f is determined by its Fourier series. That is to say, if we know the Fourier coefficients of a function, can we find the function, and if so, how? The study of such series, and, in particular, the problem of representing a given function by a trigonometric series, originated in physical problems such as the theory of oscillations and the theory of heat conduction (Fourier's ''Theorie analytique de la chaleur'' was published in 1822). The many difficu,t and delicate problems which arose during this study caused a thorough revision and reformulation of the whole theory of functions of a real variable. Among many prominent names, those of Riemann, Cantor, and Lebesgue are intimately connected with this field, which nowadays, with all its generalizations and rami- fications, may well be said to occupy a central position in the whole of analysis. We shall be content to derive some basic theorems which are easily accessible by the methods developed in the preceding chapters. For more thorough investigations, the Lebesgue integral is a natural and indispensable tool. We shall first study more general systems of functions which share a property analogous to (61). 8.10 Definition Let {</>n} (n = 1, 2, 3, ... ) be a sequence of complex functions on [a, b ], such that b (64) </>n(X)</>m(X) dx = 0 (n =I- m). a SOME SPECIAL FUNCTIONS 187 Then {</>n} is said to be an orthogonal system of functions on [a, b]. If, in addition, b (65) I </>n(x)l 2 dx = 1 a for all n, { </>n} is said to be orthonormal. For example, the functions (21r)-te 1 nx form an orthonormal system on [ - n, n]. So do the real functions 1 cos x sin x cos 2x sin 2x • • • J21r' J; ' ✓ 1t ' J; ' J; ' . If { </>n} is orthonormal on [a, b] and if b (66) Cn = f(t )</Jn(t) dt (n = 1, 2, 3, ... ), a we call cn the nth Fourier coefficient off relative to {</>n}. We write (67) and call this series the Fourier series off (relative to { </>n} ). Note that the symbol ~ used in (67) implies nothing about the conver- gence of the series; it merely says that the coefficients are given by (66). The following theorems show that the partial sums of the Fourier series off have a certain minimum property. We shall assume here and in the rest of this chapter that/ e ~, although this hypothesis can be weakened. 8.11 Theorem Let { </>n} be orthonormal on [a, b ]. Let n (68) Sn(X) = L Cm </>m(X) m=l be the nth partial sum of the Fourier series of./, and suppose (69) Then (70) n tn(x) = L Ym </>m(x). m=l b b If - Sn 1 2 dx s; If - tn 1 2 dx, a a and equality holds if and only if (71) (m=l, ... ,n). That is to say, among all functions tn, Sn gives the best possible mean squ\".re approximation to f. 188 PRINCIPLES OF MATHEMATICAL ANALYSIS (72) Proof Let J denote the integral over [a, b ], l: the sum from 1 to n. Then fin = f L Ym'Pm = L Cm Ym by the definition of {cm}, since { </>m} is orthonormal, and so lfl 2 - fin - ftn + I tn I 2 If 1 2 - L Cm Ym - L Cm Ym + L Ym Ym = If 1 2 - L I Cm 1 2 + L I Ym - Cm 1 2 , -- which is evidently minimized if and only if Ym = cm • Putting Ym = cm in this calculation, we obtain b n b lsn(x)l 2 dx = L lcml 2 ~ lf(x)l 2 dx, a 1 a since J If - tn I 2 :2: 0. 8.12 Theorem If {</>n} is orthonormal on [a, b], and if then (73) In particular, (74) 00 f(x) ,_ L en </>n(X), n=l oo b L I en 1 2 ~ 1/(x) 1 2 dx. n= 1 a lim en= 0. n ➔ oo Proof Letting n > oo in (72), we obtain (73), the so-called ''Bessel inequality.\" 8.13 Trigonometric series From now on we shall deal only with the trigono- metric system. We shall consider functions f that have period 2n and that are Riemann-integrable on [ - re, re] (and hence on every bounded interval). The Fourier series off is then the series (63) whose coefficients en are given by the integrals (62), and (75) N sN(x) = sN(f; x) = L en e1 \"x -N SOME SPECIAL FUNCTIONS 189 is the Nth partial sum of the Fourier series off The inequality (72) now takes the form (76) In order to obtain an expression for sN that is more manageable than (75) we introduce the Dirichlet kernel (77) D ( ) _ ~ inx _ sin (N + ½)x Nx - L. e - . n= -N sin (x/2) The first of these equalities is the definition of DN(x). The second follows if both sides of the identity (eix _ l)DN(x) = ei(N+1)x _ e-iNx are multiplied by e- ix/l. By (62) and (75), we have N 1 n: (f ) '°' - f(t)e- int dt einx SN ; X = ~N 2n -n: I 11: N = - f(t) L ein(x- t) dt, 2n -n: -N so that (78) n: I n -n: f(t)DN(x - t) dt = 2n -n:f(x - t)DN(t) dt. The periodicity of all functions involved shows that it is immaterial over which interval we integrate, as long as its length is 2rr. This shows that the two integrals in (78) are equal. We shall prove just one theorem about the pointwise convergence of Fourier series. 8.14 Theorem If, for some x, there are constants b > 0 and M < oo such that (79) for all t e ( - b, b), then (80) Proof D~fine (81) lf(x + t)- f(x)I ~ Ml ti lim sN(f; x) = f (x). N ➔ oo ( ) f(x - t) - f(x) gt=----- sin (t/2) 190 PRINCIPLES OF MATHEMATICAL ANALYSIS for O < I t I ~ re, and put g(O) = 0. By the definition (77), 1 n: 2 DN(x) dx = 1. TC -n: Hence (78) shows that 1 · n: 1 sN(f; x) - f(x) = 2 g(t) sin N + - 2 t dt TC -n: 1 n: t 1 n: = 2 g(t) cos - sin Nt dt + TC -n: 2 2rc -n: By (79) and (81), g(t) cos (t/2) and g(t) sin (t/2) are bounded. The last two integrals thus tend to O as N > oo, by (74). This proves (80). Corollary If f(x) = 0 for all x in some segment J, then lim sN(f; x) = 0 for every x e J. Here is another formulation of this corollary: If f (t) = g(t) for all t in some neighborhood of x, then s N(f; X) - s N(g; x) = s N(f - g ; x) > 0 as N ➔ oo. This is usually called the localization theorem. It shows that the behavior of the sequence {sN(f; x)}, as far as convergence is concerned, depends only on the values off in some (arbitrarily small) neighborhood of x. Two Fourier series may thus have the same behavior in one interval, but may behave in entirely different ways in some other interval. We have here a very striking contrast between Fourier series and power series (Theorem 8.5). We conclude with two other approximation theorems. 8.15 Theorem If f is continuous (with period 2n) and if e > 0, then there is a trigonometric polynomial P such that IP(x) - f(x) I < e for all real x. Proof If we identify x and x + 2rc, we may regard the 2n-periodic func- tions on R 1 as functions on the unit circle T, by means of the mapping x ➔ eix. The trigonometric polynomials, i.e., the functions of the form (60), form a self-adjoint algebra d, which separates points on T, and which vanishes at no point of T. Since Tis compact, Theorem 7.33 tells us that d is dense in ~(T). This is exactly what the theorem asserts. A more precise form of this theorem appears in Exercise 15. SOME SPECIAL FUNCTIONS 191 8.16 Parseval's theorem Suppose f and g are Riemann-integrable functions with period 2n, and (82) Then (83) (84) (85) (86) (87) 00 00 f (x) ,_ L Cn einx, g(x) ,_ L Yn einx. -oo -oo lim 1 n lf(x) - sN(f; x) I 2 dx = 0, N➔oo 2tr -n 1 n oo f (x)g(x) dx = L Cn Yn, 2n -n -oo Proof Let us use the notation l n 112 llhll2= 2n -nlh(x)l 2 dx • Let 8 > 0 be given. Since f e ~ and f(n) = /( - n), the construction described in Exercise 12 of Chap. 6 yields a continuous 2n-periodic func- tion h with II/ - hll2 < 8. By Theorem 8.15, there is a trigonometric polynomial P such that I h(x) - P(x) / < 8 for all x. Hence llh - PII 2 < 8. If P has degree N 0 , Theorem 8.11 shows that (88) I h - sN(h)ll2 ~ llh - Pl 2 < 8 for all N ~ N 0 • By (72), with h - fin place off, (89) lsN(h) - sN(/)112 = llsN(h - /)112 ~ llh - /ll2 < 8. Now the triangle inequality (Exercise 11, Chap. 6), combined with (87), (88), and (89), shows that (90) llf- sN(f)ll2 < 38 (N ~ No), This proves (83). Next, (91) 1 n N 1 n N sN(f)g dx = L en 2 einx g(x) dx = L en Yn, 7r -n -N 1t -n -N and the Schwarz inequality shows that (92) Jg - sN(f)g ~ If- sN(f)lul ~ I/- sNl 2 lgl 2 1/2 , 192 PRINCIPLES OF MATHEMATICAL ANALYSIS which tends to 0, as N ➔ oo, by (83). Comparison of (91) and (92) gives (84). Finally, (85) is the special case g = f of (84). A more general version of Theorem 8.16 appears in Chap. 11. THE GAMMA FUNCTION This function is closely related to factorials and crops up in many unexpected places in analysis. Its origin, history, and development are very well described in an interesting article by P. J. Davis (Amer. Math. Monthly, vol. 66, 1959, pp. 849-869). Artin's book (cited in the Bibliography) is another good elemen- tary introduction. Our presentation will be very condensed, with only a few comments after each theorem. This section may thus be regarded as a large exercise, and as an opportunity to apply some of the material that has been presented so far. 8.17 Definition For O < x < oo, 00 (93) r(x) = tx-ie-t dt. 0 The integral converges for these x. (When x < 1, both O and oo have to be looked at.) 8.18 Theorem (a) The functional equation I'(x + 1) = xr(x) holds if O < x < oo. (b) I'(n + 1) = n!for n = I, 2, 3, .... (c) log r is convex on (0, oo ). Proof An integration by parts proves (a). Since r(l) = 1, (a) implies (b), by induction. If 1 < p < oo and (1/p) + (1/q) = 1, apply Holder's inequality (Exercise 10, Chap. 6) to (93), and obtain This is equivalent to (c). It is a rather surprising fact, discovered by Bohr and Mollerup, that these three properties characterize r completely. SOME SPECIAL FUNCTIONS 193 8.19 Theorem If f is a positive function on (0, oo) such that (a) f(x + 1) = xf(x), (b) /(1) = 1, (c) log/ is convex, then f(x) = I'(x). Proof Since r satisfies (a), (b), and (c), it is enough to prove that/(x) is uniquely determined by (a), (b), (c), for all x > 0. By (a), it is enough to do this for x e (0, 1 ). Put <p = logf Then (94) <p(x + 1) = <p(x) + log x (0 < x < oo ), (95) <p(l) = 0, and <pis convex. Suppose O < x < 1, and n is a positive integer. By (94), <p(n + 1) = log(n !). Consider the difference quotients of <p on the intervals [n, n + 1], [n + 1, n + 1 + x], [n + 1, n + 2]. Since <p is convex 1 <p(n + 1 + x) - <p(n + 1) 1 ( l) og n S -------- S og n + . X Repeated application of (94) gives <p(n + 1 + x) = <p(x) + log [x(x + 1) · · · (x + n)]. Thus 0 S <p(x) - log n!nx l J S x log x( x + 1) · · · ( x + n) 1 1 + - . n The last expression tends to Oas n ➔ oo. Hence <p(x) is determined, and the proof is complete. As a by-product we obtain the relation . n !nx r(x) = l1m ------ n➔oo x(x + 1) · · · (x + n) at least when O < x < 1 ; from this one can deduce that (95) holds for all x > 0, since r(x + 1) = x r(x). 8.20 Theorem If x > 0 and y > 0, then (96) i tx-1(1 - t)y-1 dt = I'(x)r(y). O r(x + y) This integral is the so-called beta function B(x, y). 194 PRINCIPLES OF MATHEMATICAL ANALYSIS (97) Proof Note that B(l, y) = 1/y, that log B(x, y) is a convex function of x, for each fixed y, by Holder's inequality, as in Theorem 8.18, and that X B(x + 1, y) = --B(x, y). x+y To prove (97), perform an integration by parts on 1 f X B(x + 1, y) = -- (1 - t)x+y-l dt. 0 1 - t These three properties of B(x, y) show, for each y, that Theorem 8.19 applies to the function f defined by r(x+y) f(x) = r(y) B(x, y). Hence f(x) = r(x). 8.21 Some consequences The substitution t = sin2 0 turns (96) into (98) 2 n/ 2 (sin 0)2x-i (cos 0)2y-i d0 = r(x)r(y). O r(x+ y) The special case x = y = ½ gives (99) r(t) = Jrc. The substitution t = s2 turns (93) into 00 (100) r(x) = 2 s 2x-i e-s 2 ds (0 < X < 00). 0 The special case x = ½ gives (101) By (99), the identity (102) 00 - e-s 2 ds = J n. -oo follows directly from Theorem 8.19. 8.22 Stirling's formula This provides a simple approximate expression for r(x + 1) when xis large (hence for n! when n is large). The formula is (103) lim r(x+ l) = 1. x➔oo (x/e)x J2nx SOME SPECIAL FUNCTIONS 19S Here is a proof. Put t = x(l + u) in (93). This gives 00 (104) r(x + 1) = xx+ 1 e-x [(1 + u)e-u]x du. -1 Determine h(u) so that h(O) = 1 and (105) (1 + u)e-u = exp u2 - 2 h(u) if -1 < u < oo, u ¥= 0. Then (106) 2 h(u) = 2 [u - log (1 + u)]. u It follows that h is continuous, and that h(u) decreases monotonically from oo to O as u increases from - 1 to oo. The substitution u = s J2/x turns (104) into (107) 1/Jx(s) ds -oo where ( - x/2 < s < oo ), (s ~ -J x/2). Note the following facts about 1/1 x(s): (a) For every s, 1/Jx(s) ➔ e-s 2 as x ➔ oo. (b) The convergence in (a) is uniform on [ -A, A], for every A < oo. (c) Whens< 0, then O < 1/Jx(s) < e-s 2 • (d) Whens> 0 and x > 1, then O < 1/Jx(s) < i/11(s). (e) So 1/11 (s) ds < 00. The convergence theorem stated in Exercise 12 of Chap. 7 can therefore be applied to the integral (107), and shows that this integral converges to J n as x ) oo, by (101). This proves (103). A more detailed version of this proof may be found in R. C. Buck's ''Advanced Calculus,\" pp. 216-218. For two other, entirely different, proofs, see W. Feller's article in Amer. Math. Monthly, vol. 74, 1967, pp. 1223-1225 (with a correction in vol. 75, 1968, p. 518) and pp. 20-24 of Artin's book. Exercise 20 gives a simpler proof of a less precise result. 196 PRINCIPLES OF MATHEMATICAL ANALYSIS EXERCISES 1. Define e-1/xZ f(x) = 0 (x =I= 0), (x = 0). Prove that f has derivatives of all orders at x = 0, and that J<n>(O) = 0 for n = 1, 2, 3, .... 2. Let a,J be the number in the ith row andjth column of the array -1 0 0 0 • • • ½ -1 0 0 • • • ¼ ½ -1 0 • • • ¼ i ½ -1 ••• • • • • • • • • • • • • • • • • • • • • • • • • • • so that Prove that 3. Prove that 0 OtJ = -1 2)-I LL Otj = -2, ' J (i <j), (i = j), (i > j). LL Otj = 0. J ' if a,J ~ 0 for all i andj (the case + oo = + oo may occur). 4. Prove the following limit relations: bx-1 (a) lim -- = log b x ➔ O X (b) lim log (l + x) = 1. x➔ O X (c) lim (1 + x) 11x = e. x ➔ O (d) lim n ➔ 00 X n 1+- n -eX - . (b > 0). 5. Find the following limits ( ) 1 . e - (1 + x) 1 tx a 1m-----. x➔ O X (b) lim n [n 11n - 1]. n➔ oo logn ( ) I . tan x - x C 1m ( )' x➔O X 1 - COS X • (d) lim x - sin x . x➔ O tan X - X 6. Suppose /(x)/(y) = f(x + y) for all real x and y. SOME SPECIAL FUNCTIONS 197 (a) Assuming that/ is differentiable and not zero, prove that f(x) = ecx where c is a constant. (b) Prove the same thing, assuming only that/ is continuous. 7T 7. If O < x < 2 , prove that 2 sin x 1 -<--< . 7T X 8. For n = 0, 1, 2, ... , and x real, prove that I sin nx I ::S:.: n I sin x I . Note that this inequality may be false for other values of n. For instance, I sin ½Tr I > ½ I sin TT I . 9. {a) Put sN = 1 + (½) + · · · + (1/N). Prove that lim (sN - log N) N ➔ OO exists. {The limit, often denoted by y, is called Euler's constant. Its numerical value is 0.5772 .... It is not known whether y is rational or not.) (b) Roughly how large must m be so that N = tom satisfies sN > 100? 10. Prove that L 1/p diverges; the sum extends over all primes. (This shows that the primes form a fairly substantial subset of the positive integers.) 198 PRINCIPLES OF MATHEMATICAL ANALYSIS Hint: Given N, let Pi, ••• , P1c be those primes that divide at least one in- teger -5:,N. Then N 1 /c 1 1 L - -5:. D 1+ + + ... pj n•1 n •1 PJ /c 1 1-=TT J•1 PJ /c 2 -5:. exp L - . J•• PJ The last inequality holds because if O -5:, X -5:, t, -1 (There are many proofs of this result. See, for instance, the article by I. Niven in Amer. Math. Monthly, vol. 78, 1971, pp. 272-273, and the one by R. Bellman in Amer. Math. Monthly, vol. SO, 1943, pp. 318-319.) 11. Suppose f e fJt on (0, A] for all A < oo, and/ (x) > 1 as x > + oo. Prove that 00 lim t e-•xf(x) dx = 1 (t > 0). t➔ O 0 12. Suppose O < 8 < 1r, f(x) = 1 if Ix I -5:. 8, f(x) = 0 if 8 < Ix I -5:. 1r, and f(x + 21r) = /(x) for all x. (a) Compute the Fourier coefficients off. ( b) Conclude that f sin (n8) = 1r - 8 n•1 n 2 (c) Deduce from Parseval's theorem that (0 <8 <1r). 00 sin 2 (n8) '\" - 8 L __.;.~=-. (d) Let 8 > 0 and prove that n•1 n28 2 00 sin x 0 X 2 7T dx=-. 2 (e) Put 8 = 1r/2 in (c). What do you get? 13. Put /(x) = x if O -s;;, x < 21r, and apply Parseval's theorem to conclude that 00 1 7r2 L -=-. n•1 n2 6 SO?.IE SPECIAL FUNCTIONS 199 14. If /(x) = {1r - Ix I )2 on [-1r, 1r], prove that 11\"2 00 4 f(x) = 3 + L 2 cos nx n•1 n and deduce that (A recent article by E. L. Stark contains many references to series of the form L n-', wheres is a positive integer. See Math. Mag., vol. 47, 1974, pp. 197-202.) 15. With Dn as defined in (77), put Prove that and that (a) KN ~o, 1 N KN(X) = N l L Dn(x). + n•O 1 1 - cos (N + l)x KN(x) = N + 1 . 1 -cosx 1 2 (c) KN(x) ~ N + 1 · 1 - cos 8 If sN = sN(f; x) is the Nth partial sum of the Fourier series off, consider the arithmetic means • Prove that 1 ff aN(f; x) = 2 11\" -ff f(x - t)KN(t) dt, and hence prove Fejer's theorem: If fis continuous, with period 21r, then aN(f; x) > f(x) uniformly on [-1r, 1r]. Hint: Use properties (a), (b), (c) to proceed as in Theorem 7.26. 16. Prove a pointwise version of Fejer's theorem: If I e 9t and f(x + ), f(x - ) exist for some x, then lim aN(f; x) = ½[f(x +) + /(x-)]. N ➔ oo 200 PRINCIPLES OF MATHEMATICAL ANALYSIS 17. Assume f is bounded and monotonic on [-'TT', 'TT'), with Fourier coefficients Cn, as given by (62). {a) Use Exercise 17 of Chap. 6 to prove that {ncn} is a bounded sequence. (b) Combine (a) with Exercise 16 and with Exercise 14(e) of Chap. 3, to conclude that lim s11(f; x) = ½[f(x+) + f(x- )] N ➔ «> for every x. ( c) Assume only that f e al on [ - 71', 71'] and that / is monotonic in some segment (oc, f3)c [-'TT', 'TT']. Prove that the conclusion of (b) holds for every x e (oc, /3). (This is an application of the localization theorem.) 18. Define f(x) = x 3 - sin 2 x tan x g(x) = 2x 2 - sin 2 x - x tan x. Find out, for each of these two functions, whether it is positive or negative for all x e (0, 71'/2), or whether it changes sign. Prove your answer. 19. Suppose f is a continuous function on R 1 , f(x + 271') = /(x), and oc/71' is irrational. Prove that 1 N 1 ff !~ N \"~ 1 f(x + noc) = 2 71' -ff /(t) dt for every x. Hint: Do it first for /(x) = e'\"x. 20. The following simple computation yields a good approximation to Stirling's formula. For m = 1, 2, 3, ... , define f(x) = (m + 1 - x) log m + (x - m) log ( m + 1) if m ~ x ~ m + 1, and define X g(x) = - - 1 + log m m if m- ½ ~x < m + ½. Draw the graphs of /and g. Note that/(x) ~ log x ~g(x) if x ~ 1 and that n n f(x) dx = log (n!)- ½ log n > -i + g(x) dx. 1 1 Integrate log x over (1, n]. Conclude that t < log (n !) - (n + ½) log n + n < 1 for n = 2, 3, 4, .... (Note: log V271' ~ 0.918 .... ) Thus ,,a n ! e < (n/e)\"v n < e. SOME SPECIAL FUNCTIONS 201 21. Let 1 Ln = I Dn(t}I dt 2'7T -n (n = 1, 2, 3, ... ). Prove that there exists a constant C > 0 such that Ln > Clogn or, more precisely, that the sequence (n = 1, 2, 3, ... ), is bounded. 4 Ln - 2 log n '7T 22. If rx is real and -1 < x < 1, prove Newton's binomial theorem 00 rx( rx - 1 ) · · · ( rx - n + 1) (1 + x) 11 = 1 + L ......;..._..;__~ __ _;_ x\". n=- 1 n! Hint: Denote the right side by /(x). Prove that the series converges. Prove that (1 + x)/'(x) = rxf(x) and solve this differential equation. Show also that if -1 < x < 1 and rx > 0. (1 - x)- 11 = f: I'(n + rx) x\" n•O n! I'(rx) 23. Let y be a continuously differentiable closed curve in the complex plane, with parameter interval [a, b], and assume that y(t) # 0 for every t e [a, b]. Define the index of y to be 1 Ind (y) = 2 . '7Tl Prove that Ind (y) is always an integer. b y'(f) ( ) dt. 11 'Y t Hint: There exists rp on [a, b] with rp' = y'/y, rp(a) = 0. Hence y exp(-rp) is constant. Since y(a) = y(b) it follows that exp rp(b) = exp rp(a) = 1. Note that rp(b) = 2'7Ti Ind (y). Compute Ind (y) when y(t) = e1\"t, a= 0, b = 2'7T. Explain why Ind (y) is often called the winding number of y around 0. 24. Let y be as in Exercise 23, and assume in addition that the range of y does not intersect the negative real axis. Prove that Ind (y) = 0. Hint: For O :5: c < oo, Ind (y + c) is a continuous integer-valued function of c. Also, Ind (y + c) > 0 asc >OO. 202 PRINCIPLES OF MATHEMATICAL ANALYSIS 25. Suppose Y1 and Y2 are curves as in Exercise 23, and I Y1(t) - Y2(t) I < I Y1(t) I (as, ts, b). Prove that Ind (y1) = Ind (y2), Hint: Put y = y2IY1, Then I I - YI < 1, hence Ind (y) = 0, by Exercise 24. Also, y' I Y2 -- - • Y Y2 Y1 26. Let y be a closed curve in the complex plane (not necessarily differentiable) with parameter interval [O, 21r], such that y(t) # 0 for every t e [O, 21r]. Choose 8 > 0 so that I y(t) I > 8 for all t e [O, 21r]. If P1 and P2 are trigo- nometric polynomials such that IP1(t) - y(t) I < 8/4 for all t e [O, 21r] (their exis- tence is assured by Theorem 8.15), prove that Ind (P1) = Ind (P2) by applying Exercise 25. Define this common value to be Ind (y). Prove that the statements of Exercises 24 and 25 hold without any differenti- ability assumption. • 27. Let f be a continuous complex function defined in the complex plane. Suppose there is a positive integer n and a complex number c # 0 such that lim z-nJ(z) = c. ,., ➔ 00 Prove that f(z) = 0 for at least one complex number z. Note that this is a generalization of Theorem 8.8. Hint: Assume f(z) # 0 for all z, define y,(t) = f(rett) for Os, r < oo, 0 s, ts, 21r, and prove the following statements about the curves y,: (a) Ind (yo)= 0. (b) Ind (y,) = n for all sufficiently large r. (c) Ind (y,) is a continuous function of r, on [O, oo ). [In (b) and (c), use the last part of Exercise 26.] Show that (a), (b), and (c) are contradictory, since n > 0. 28. Let D be the closed unit disc in the complex plane. (Thus z e D if and only if I z I s, 1.) Let g be a continuous mapping of D into the unit circle T. (Thus, lu(z)I = 1 for every z e D.) Prove that g(z) = - z for at least one z e T. Hint: For Os, rs, 1, 0 s, ts, 21r, put y,(t) = g(re 11), and put ip(t) = e- 11y 1(t). If g(z) # -z for every z e T, then ip(t) # -1 for every t e [O, 21r ]. Hence Ind (ip) = 0, by Exercises 24 and 26. It follows that Ind (y1) = 1. But Ind (yo)= 0. Derive a contradiction, as in Exercise 27. SOME SPECIAL FUNCTIONS 203 29. Prove that every continuous mapping f of D into D has a fixed point in D. (This is the 2-dimensional case of Brouwer's fixed-point theorem.) Hint: Assume /(z) # z for every z e D. Associate to each z e D the point g(z) e T which lies on the ray that starts at /(z) and passes through z. Then g maps D into T, g(z) = z if z e T, and g is continuous, because g(z) = z - s(z)[f(z) - z], where s(z) is the unique nonnegative root of a certain quadratic equation whose coefficients are continuous functions off and z. Apply Exercise 28. 30. Use Stirling's formula to prove that for every real constant c. lim I'(x + c) = 1 ,¥➔ 00 xcI'(x) 31. In the proof of Theorem 7 .26 it was shown that 1 4 (1 - x 2 )n dx ~ _ -1 3v'n for n = 1, 2, 3, .... Use Theorem 8.20 and Exercise 30 to show the more precise result 1 lim v' n n ➔ CIC -1 FUNCTIONS OF SEVERAL VARIABLES LINEAR TRANSFORMATIONS We begin this chapter with a discussion of sets of vectors in euclidean n-space Rn. The algebraic facts presented here extend without change to finite-dimensional vector spaces over any field of scalars. However, for our purposes it is quite sufficient to stay within the familiar framework provided by the euclidean spaces. 9.1 Definitions (a) A nonempty set X c Rn is a vector space if x +ye X and ex e X for all x e X, y e X, and for all scalars c. (b) If x 1, ••. , xk E Rn and c1, ••. , ck are scalars, the vector is called a linear combination of x 1 , •.. , xk . If S c Rn and if E is the set of all linear combinations of elements of S, we say that S spans E, or that E is the span of S. Observe that every span is a vector space. FUNCTIONS OF SEVERAL VARIABLES 205 (c) A set consisting of vectors x 1, ... , xk (we shall use the notation {x 1, .•. , xk} for such a set) is said to be independent if the relation c1x1 + · · · + ckxk = 0 implies that c1 = · · · = ck = 0. Otherwise {x 1, ... , xk} is said to be dependent. Observe that no independent set contains the null vector. (d) If a vector space X contains an independent set of r vectors but con- tains no independent set of r + 1 vectors, we say that X has dimension r, and write: dim X = r. The set consisting of O alone is a vector space; its dimension is 0. (e) An independent subset of a vector space X which spans Xis called a basis of X. Observe that if B = {x 1, ... , x,} is a basis of X, then every x e X has a unique representation of the form x = r.cixi. Such a representation exists since B spans X, and it is unique since B is independent. The numbers c1 , ... , c, are called the coordinates of x with respect to the basis B. The most familiar example of a basis is the set {e 1, ... , en}, where ei is the vector in Rn whosejth coordinate is 1 and whose other coordinates are all 0. If x e R 11, x = (x 1 , ••• , xn), then x = r.xiei. We shall call {e1, ... ' en} the standard basis of Rn. 9.2 Theorem Let r be a positive integer. If a vector space X is spanned by a set of r vectors, then dim X ~ r. Proof If this is false, there is a vector space X which contains an inde- pendent set Q = {y 1 , ••. , Yr+ 1} and which is spanned by a set S0 consisting of r vectors. Suppose O ~ i < r, and suppose a set Si has been constructed which spans X and which consists of all y i with 1 ~ j ~ i plus a certain collection of r - i members of S0 , say x 1 , ... , x,_ i. (In other words, Si is obtained from S0 by replacing i of its elements by members of Q, without altering the span.) Since Si spans X, Yi+l is in the span of Si; hence there are scalars a 1, ... , ai+ 1, b1, ... , b,-i, with ai+ 1 = 1, such that i+l r-i L a i y i + L bk xk = 0. j=l k=l If all bk's were 0, the independence of Q would force all ai's to be 0, a contradiction. It follows that some xk e Si is a linear combination of the other members of Ti =Siu {Yi+ 1}. Remove this xk from Ti and call the remaining set Si+ 1 . Then Si+ 1 spans the same set as Ti, namely X, so that Si+ 1 has the properties postulated for Si with i + I in place of i. 206 PRINCIPLES OF MATHEMATICAL ANALYSIS Starting with S0 , we thus construct sets S 1 , ••• , S,. The last of these consists of y 1 , ••• , y,, and our construction shows that it spans X. But Q is independent; hence y, + 1 is not in the span of S,. This contra- diction establishes the theorem. Corollary dim Rn = n. Proof Since {e 1, ... , en} spans Rn, the theorem shows that dim Rn:$; n. Since { e 1, ... , en} is independent, dim Rn ~ n. 9.3 Theorem Suppose Xis a vector space, and dim X = n. (a) A set E of n vectors in X spans X if and only if Eis independent. (b) X has a basis, and every basis consists of n vectors. (c) If I~ r ~ n and {y1 , ••• , y,} is an independent set in X, then X has a basis containing {y 1 , ... , y,}. Proof Suppose E = {x 1, ... , Xn}. Since dim X = n, the set {x 1, ... , xn, y} is dependent, for every y e X. If E is independent, it follows that y is in the span of E; hence E spans X. Conversely, if Eis dependent, one of its members can be removed without changing the span of E. Hence E cannot span X, by Theorem 9.2. This proves (a). Since dim X = n, X contains an independent set of n vectors, and (a) shows that every such set is a basis of X; (b) now follows from 9. l(d) and 9.2. To prove (c), let {x 1, ... , xn} be a basis of X. The set S = {y 1, · • • , Yr, X1, • • • , Xn} spans X and is dependent, since it contains more than n vectors. The argument used in the proof of Theorem 9.2 shows that one of the xi's is a linear combination of the other members of S. If we remove this xi from S, the remaining set still spans X. This process can be repeated r times and leads to a basis of X which contains {y1, ... , y,}, by (a). 9.4 Definitions A mapping A of a vector space X into a vector space Y is said to be a linear transformation if A(cx) = cAx for all x, x 1, x2 e X and all scalars c. Note that one often writes Ax instead of A(x) if A is linear. Observe that AO = 0 if A is linear. Observe also that a linear transforma- tion A of X into Y is completely determined by its action on any basis: If FUNCTIONS OF SEVERAL VARIABLES 207 {x 1, ... , xn} is a basis of X, then every x e X has a unique representation of the form n X = ~ C·X· ~ ' ,, i= 1 and the linearity of A allows us to compute Ax from the vectors Ax 1 , .•• , Axn and the coordinates c1 , •.. , en by the formula n Ax= L ci Axi. i= 1 Linear transformations of X into X are often called linear operators on X. If A is a linear operator on X which (i) is one-to-one and (ii) maps X onto X, we say that A is invertible. In this case we can define an operator A- 1 on X by requiring that A- 1(Ax) = x for all x e X. It is trivial to verify that we then also have A(A- 1x) = x, for all x e X, and that A- 1 is linear. An important fact about linear operators on finite-dimensional vector spaces is that each of the above conditions (i) and (ii) implies the other: 9.5 Theorem A linear operator A on a finite-dimensional vector space X is one-to-one if and only if the range of A is all of X. Proof Let {x 1, ... , xn} be a basis of X. The linearity of A shows that its range Bf(A) is the span of the set Q = {Ax 1 , ••• , Axn}. We therefore infer from Theorem 9.3(a) that Bf(A) = X if and only if Q is independent. We have to prove that this happens if and only if A is one-to-one. Suppose A is one-to-one and r.ci Axi = 0. Then A(l:.cixi) = 0, hence r.cixi = 0, hence c1 = · · · = en = 0, and we conclude that Q is independent. Conversely, suppose Q is independent and A(l:.cixi) = 0. Then r.c i Axi = 0, hence c 1 = · · · = en = 0, and we conclude: Ax = 0 only if x = 0. If now Ax = Ay, then A(x - y) = Ax - Ay = 0, so that x - y = 0, and this says that A is one-to-one. 9.6 Definitions (a) Let L(X, Y) be the set of all linear transformations of the vector space X into the vector space Y. Instead of L(X, X), we shall simply write L(X). If A 1, A 2 e L(X, Y) and if c1 , c2 are scalars, define c1A 1 + c2 A 2 by (c1A 1 + c2 A 2)x = c1A 1x + c2 A 2x (x e X). It is then clear that c1A 1 + c2 A 2 e L(X, Y). (b) If X, Y, Z are vector spaces, and if A e L(X, Y) and Be L(Y, Z), we define their product BA to be the composition of A and B: (BA)x = B(Ax) (x e X). Then BA e L( X, Z). 208 PRINCIPLES OF MATHEMATICAL ANALYSIS Note that BA need not be the same as AB, even if X = Y = Z. (c) For A e L(Rn, Rm), define the norm IIAII of A to be the sup of all numbers I Ax I, where x ranges over all vectors in Rn with Ix I :$; 1. Observe that the inequality I Ax I :$; I A I I x I holds for all x e Rn. Also, if 2 is such that I Ax I ::;; 2 Ix I for all x e Rn, then IIAII :$; l. 9.7 Theorem (a) If A E L(Rn, Rm), then IIA II < oo and A is a uniformly continuous mapping of Rn into Rm. (b) If A, Be L(Rn, Rm) and c is a scalar, then IIA + Bl ::;; IIA I + !Bl , I cA I = I c I I A I . With the distance between A and B defined as IIA - Bl, L(Rn, Rm) is a metric space. (c) If A E L(Rn, Rm) and BE L(Rm, Rk), then I BA I ::;; I B I II A II. Proof (a) Let {e1 , ... , en} be the standard basis in Rn and suppose x = l:ciei, !xi::;; 1, so that I cil :$; 1 for i = 1, ... , n. Then IAxl = LciAei :s;I lcil IAeil :$;L IAeil so that n II A II :$; L I Aei I < oo. i= 1 Since I Ax - Ay I ::;; II A I Ix - y I if x, y e Rn, we see that A is uniformly • continuous. (b) The inequality in (b) follows from l(A + B)xl = !Ax+ Bx!::;; IAxl +!Bx!:$; (I All+ I Bl) Ix!. The second part of (b) is proved in the same manner. If A, B, CE L(Rn, Rm), we have the triangle inequality !IA - CII = ll(A - B) + (B - C)ll :$; IIA - BIi + IIB - CII, FUNCTIONS OF SEVERAL VARIABLES 209 and it is easily verified that II A - BIi has the other properties of a metric (Definition 2.15). (c) Finally, (c) follows from l(BA)x/ = IB(Ax)/ ~ IIBII IAxl ~ [[BIi [[All /xi. Since we now have metrics in the spaces L(Rn, Rm), the concepts of open set, continuity, etc., make sense for these spaces. Our next theorem utilizes these concepts. 9.8 Theorem Let Q be the set of all invertible linear operators on Rn. (a) If A e Q, Be L(Rn), and (1) (2) II B - A II · II A - 1 II < 1, then BE n. (b) n is an open subset of L(Rn), and the mapping A ➔ A- 1 is continuous on n. (This mapping is also obviously a 1 - 1 mapping of n onto n, which is its own inverse.) Proof (a) Put IIA- 1 11 =1/a, put IB-AII =/3. Then/J<a. For every xeRn, a Ix I = a I A - l Ax I ~ a II A - 1 11 • I Ax I = I Ax I ~ I (A - B)x I + I Bx I ~ /31 x I + I Bx I, so that ( a - /3) I x I ~ I Bx I Since a - f3 > 0, (I) shows that Bx-# 0 if x #- 0. Hence Bis 1 - 1. By Theorem 9.5, Ben. This holds for all B with IIB-- All< a. Thus - we have (a) and the fact that n is open. (b) Next, replace x by B- 1y in (1). The resulting inequality (a - /J)IB- 1yj ~ IBB- 1yl = IYI shows that IIB- 1 11 ~ (a - /3)- 1• The identity B- 1 -A- 1 = B- 1(A - B)A- 1, combined with Theorem 9.7(c), implies therefore that IIB-l -A- 1 11 ~ IIB- 1 11 IIA - Bii llA- 1 I~ /3 rx(rx - {J) • This establishes the continuity assertion made in (b), since f3 ➔ 0 as B ➔ A. 210 PRINCIPLES OF MATHEMATICAL ANALYSIS 9.9 Matrices Suppose {x1, •.• , xn} and {y1 , ••• , Ym} are bases of vector spaces X and Y, respectively. Then every A e L(X, Y) determines a set of numbers a,1 such that m (3) Ax1 = L a11 y, i= 1 (1 -5.j -5. n). It is convenient to visualize these numbers in a rectangular array of m rows and n columns, called an m by n matrix: [A]= 011 012 • • • 01n a21 022 ''' a2n I • I I I I I I I I I I I I I I I I I Observe that the coordinates a,1 of the vector Ax1 (with respect to the basis {y1 , ... , Ym}) appear in the jth column of [A]. The vectors Axi are therefore sometimes called the column vectors of [A]. With this terminology, the range of A is spanned by the column vectors of [A]. (4) Ifx =Ic1 x1 , the linearity of A, combined with (3), shows tl1at m Ax=I i= 1 n LaiJci Yi• J= 1 Thus the coordinates of Ax are r.1 a 11 c1 • Note that in (3) the summation ranges over the first subscript of a 11 , but that we sum over the second subscript when computing coordinates. Suppose next that an m by n matrix is given, with real entries aii . If A is then defined by (4), it is clear that A e L(X, Y) and that [A] is the given matrix. Thus there is a natural 1-1 correspondence between L(X, Y) and the set of all real m by n matrices. We emphasize, though, that [A] depends not only on A but also on the choice of bases in X and Y. The same A may give rise to many different matrices if we change bases, and vice versa. We shall not pursue this observation any further, since we shall usually work with fixed bases. (Some remarks on this may be found in Sec. 9.37.) If Z is a third vector space, with basis {z 1, ... , zp}, if A is given by (3), and if then A e L(X, Y), Be L(Y, Z), BA e L(X, Z), and since B(Ax1) =BL a,1y 1 = L a,1By, i i FUNCTIONS OF SEVERAL VARIABLES .211 the independence of {z1, •.. , zp} implies that (5) (1 S k Sp, 1 Sj Sn). This shows how to compute the p by n matrix [BA] from [B] and [A]. If we define the product [B][A] to be [BA], then (5) describes the usual rule of matrix multiplication. Finally, suppose {x 1, ••• , xn} and {y1, .•• , Ym} are standard bases of Rn and Rm, and A is given by (4). The Schwarz inequality shows that IAxl 2 = L L aiJcJ 2 SL L afi · L c; = L a51xl 2 , i j i j j i, j Thus (6) If we apply (6) to B - A in place of A, where A, Be L(Rn, Rm), we see that if the matrix elements ail are continuous functions of a parameter, then the same is true of A. More precisely: If Sis a metric space, if a11 , ••. , amn are real continuous functions on S, and if, for each p e S, AP is the linear transformation of Rn into Rm whose matrix has entries ai1(p), then the mapping p ➔ AP is a continuous mapping of S into L(Rn, Rm). DIFFERENTIATION 9.10 Preliminaries In order to arrive at a definition of the derivative of a function whose domain is Rn ( or an open subset of Rn), let us take another look at the familiar case n = 1, and let us see how to interpret the derivative in that case in a way which will naturally extend to n > 1. If f is a real function with domain (a, b) c R1 and if x e (a, b), then f'(x) is usually defined to be the real number (7) 1 . f(x + h) - f(x) 1m h , h➔ O provided, of course, that this limit exists. Thus (8) f(x + h) - f(x) = f'(x)h + r(h) where the ''remainder'' r(h) is small, in the sense that (9) 1· r(h)_o 1m h - . h ➔ O 212 PRINCIPLES OF MATHEMATICAL ANALYSIS Note that (8) expresses the difference f(x + h) - f(x) as the sum of the linear function that takes h to f'(x)h, plus a small remainder. We can therefore regard the derivative of/ at x, not as a real number, but as the linear operator on R 1 that takes h to f'(x)h. [Observe that every real number ct gives rise to a linear operator on R 1 ; the operator in question is simply multiplication by et. Conversely, every linear function that carries R 1 to R 1 is multiplication by some real number. It is this natural 1-1 correspondence between R 1 and L(R1) which motivates the pre- ceding statements.] Let us next consider a function f that maps (a, b) c R 1 into Rm. In that case, f'(x) was defined to be that vector ye Rm (if there is one) for which (10) lim f(x + h) - f (x) _ y = O. h➔O h We can again rewrite this in the form (11) f(x + h) - f(x) = hy + r(h), where r(h)/h ➔ 0 as h ➔ 0. The main term on the right side of (11) is again a linear function of h. Every y e Rm induces a linear transformation of R 1 into Rm, by associating to each he R 1 the vector hy e Rm. This identification of Rm with L(R1 , Rm) allows us to regard f'(x) as a member of L(R1, Rm). Thus, iff is a differentiable mapping of (a, b) c R 1 into Rm, and if x e (a, b), then f'(x) is the linear transformation of R 1 into Rm that satisfies (12) or, equivalently, (13) 1 . f (x + h) - f (x) - f'(x)h _ 0 1m h - , h➔ O 1 . lf(x + h) - f(x) - f'(x)hl _ 0 h~ lhl - . We are now ready for the case n > 1. 9.11 Definition Suppose Eis an open set in Rn, f maps E into Rm, and x e E. If there exists a linear transformation A of Rn into Rm such that (14) 1 . lf(x+h)-f(x)-Ahl _ 0 h 1 :::, I h I - ' then we say that f is differentiable at x, and we write (15) f'(x) = A. If f is differentiable at every x e E, we say that f is differentiable in E. FUNCTIONS OF SEVERAL VARIABLES 213 It is of course understood in (14) that he Rn. If I h I is small enough, then x +he E, since Eis open. Thus f(x + h) is defined, f (x + h) e Rm, and since A e L(Rn, Rm), Ah e Rm. Thus f (x + h) - f (x) - Ah e Rm. The norm in the numerator of (14) is that of Rm. In the denominator we have the Rn-norm of h. There is an obvious uniqueness problem which has to be settled before we go any further. 9.12 Theorem Suppose E and fare as in Definition 9.11, x e E, and (14) holds with A =Ai and with A =A 2 • Then Ai =A 2 • (16) Proof If B = A 1 - A 2 , the inequality IBhl ~ lf(x + h) - f(x) - A 1hl + lf(x + h) - f(x) -A 2 hl shows that I Bh I/ I h I ➔ 0 as h > 0. For fixed h #: 0, it follows that I B(th) I th I -+> 0 as t > 0. The linearity of B shows that the left side of (16) is independent of t. Thus Bh = 0 for every he Rn. Hence B = 0. 9.13 Remarks (17) (18) (a) The relation (14) can be rewritten in the form f(x + h) - f(x) = f'(x)h + r(h) where the remainder r(h) satisfies lim I r(h) I = 0. b➔O I h I We may interpret (17), as in Sec. 9.10, by saying that for fixed x and small h, the left side of (17) is approximately equal to f'(x)h, that is, to the value of a linear transformation applied to h. (b) Suppose f and E are as in Definition 9.11, and f is differentiable in E. For every x e E, f'(x) is then a function, namely, a linear transformation of Rn into Rm. But f' is also a function: f' maps E into L(Rn, Rm). (c) A glance at (17) shows that f is continuous at any point at which f is differentiable. (d) The derivative defined by (14) or (17) is often called the differential off at x, or the total derivative off at x, to distinguish it from the partial derivatives that will occur later. 214 PRINCIPLES OF MATHEMATICAL ANALYSIS 9.14 Example We have defined derivatives of functions carrying Rn to Rm to be linear transformations of Rn into Rm. What is the derivative of such a linear transformation? The answer is very simple. If A e L(Rn, Rm) and ifx e Rn, then (19) A'(x) = A. Note that x appears on the left side of (19), but not on the right. Both sides of (19) are members of L(Rn, Rm), whereas Axe Rm. The proof of (19) is a triviality, since (20) A(x + h) - Ax = Ah, by the linearity of A. With f(x) = Ax, the numerator in (14) is thus O for every he Rn. In (17), r(h) = 0. We now extend the chain rule (Theorem 5.5) to the present situation. 9.15 Theorem Suppose Eis an open set in Rn, f maps E into Rm, f is differentiable at x 0 e E, g maps an open set containing f(E) into Rk, and g is differentiable at f(x 0). Then the mapping F of E into Rk defined by F(x) = g(f (x)) is differentiable at x0 , and (21) F'(x0 ) = g'(f (x0))f'(x0). On the right side of (21), we have the product of two linear transforma- tions, as defined in Sec. 9.6. (22) (23) Proof Put Yo = f (x0), A = f '(x0), B = g'(y0), and define u(h) = f (x0 + h) - f(x0 ) - Ah, v(k) = g(y0 + k) - g(y0 ) - Bk, for all he Rn and k e Rm for which f(x 0 + h) and g(y0 + k) are defined. Then I u(h) I = e(h) I h I, lv(k)I = 17(k)lkl, where e(h) ➔ 0 as h • 0 and 17(k) • 0 as k • 0. Given h, put k = f(x 0 + h) - f(x 0). Then I k I = I Ah + u(h) I ~ [ 11 A 11 + e(h)] I h I, and F(x0 + h) - F(x0 ) - BAh = g(y O + k) - g(y 0) - BAh = B(k - Ah) + v(k) = Bu(h) + v(k). FUNCTIONS OF SEVERAL VARIABLES 215 Let h ➔ 0. Then e(h) ➔ 0. Also, k ➔ 0, by (23), so that 17(k) ➔ 0. It fc>llows that F'(x0 ) = BA, which is what (21) asserts. 9.16 Partial derivatives We again consider a function f that maps an open set E c Rn into Rm. Let {e1, ... , en} and {u1 , ... , um} be the standard bases of Rn and Rm. The components off are the real functions / 1 , ••• , fm defined by m (24) f(x) = L .fi(x)u1 (x E £), i= 1 or, equivalently, by fi(x) = f (x) · u1, 1 s; is; m. For x e E, 1 s; is; m, 1 S:j s; n, we define (25) (D1.fi)(x) = lim .fi(x + te1) - .fi(x)' t➔O t provided the limit exists. Writing .fi(x1 , ••• , xn) in place of fi(x), we see that D 1.fi is the derivative of Ji with respect to x 1, keeping the other variables fixed. The notation (26) o.fi OX1 is therefore often used in place of D 1./i, and D 1./i is called a partial derivative. In many cases where the existence of a derivative is sufficient when dealing with functions of one variable, continuity or at least boundedness of the partial derivatives is needed for functions of several variables. For example, the functions/ and g described in Exercise 7, Chap. 4, are not continuous, although their partial derivatives exist at every point of R 2 • Even for continuous functions. the existence of all partial derivatives does not imply differentiability in the sense of Definition 9 .11 ; see Exercises 6 and 14, and Theorem 9 .21. However, if f is known to be differentiable at a point x, then its partial derivatives exist at x, and they determine the linear transformation f'(x) completely: 9.17 Theorem Suppose f maps an open set E c Rn into Rm, andf is differentiable at a point x e E. Then the partial derivatives (D1.fi)(x) exist, and m (27) f'(x)e1 = L (D1ft)(x)u 1 i= 1 (1 s;js;n). 216 PRINCIPLES OF MATHEMATICAL ANALYSIS Here, as in Sec. 9.16, {e 1, ... , en} and {u1 , ••• , um} are the standard bases of Rn and Rm. (28) (29) Proof Fix j. Since f is differentiable at x, f (x + te1) - f (x) = f'(x)(te1) + r(te1) where I r(te1) l/t ➔ 0 as t ➔ 0. The linearity off '(x) shows therefore that 1 . f (x + te1) - f (x) f '( ) 1m --~--- = x e1 . t➔ O t If we now represent f in terms of its components, as in (24), then (28) becomes 1 . ~ ft(x + te1) - ft(x) f '( ) 1m '-' ui = x e1 . t➔O i= 1 t It follows that each quotient in this sum has a limit, as t , 0 (see Theorem 4.10), so that each (D1/;)(x) exists, and then (27) follows from (29). Here are some consequences of Theorem 9 .17 : Let [f'(x)] be the matrix that represents f '(x) with respect to our standard bases, as in Sec. 9.9. Then f '(x)e1 is the jth column vector of [f'(x)], and (27) shows therefore that the number (D1/t)(x) occupies the spot in the ith row and jth column of [f'(x)]. Thus [f '(x)] = e e • • e e I e I I I e e e I I e e I I I ■ ■ I e I (D1fm)(x) · · · (Dnfm)(x) If h = '1:.h1e1 is any vector in Rn, then (27) implies that m n (30) f'(x)h = L L (D1ft)(x)h1 u1• I= 1 J= 1 • 9.18 Example Let y be a differentiable mapping of the segment (a, b) c R1 into an open set E c Rn, in other words, y is a differentiable curve in E. Let I be a real-valued differentiable function with domain E. Thus/ is a differentiable mapping of E into R1 • Define (31) g(t) = f(y(t)) (a< t < b). The chain rule asserts then that (32) g'(t) = f'(y(t))y'(t) (a< t < b). FUNCitoNS OF SEVERAL VARIABLES 217 Since y'(t) e L(R1 , Rn) and f'(y(t)) e L(Rn, R 1), (32) defines g'(t) as a linear operator on R 1 • This agrees with the fact that g maps (a, b) into R 1• However, g'(t) can also be regarded as a real number. (This was discussed in Sec. 9.10.) This number can be computed in terms of the partial derivatives of/ and the derivatives of the components of y, as we shall now see. With respect to the standard basis {e 1 , ... , en} of Rn, [y'(t)] is the n by 1 matrix (a ''column matrix'') which has y~ (t) in the ith row, where y1 , ••• , \"In are the components of y. For every x e E, [/'(x)] is the 1 by n matrix(a ''row matrix'') which has (D1/)(x) in thejth column. Hence [g'(t)] is the 1 by 1 matrix whose only entry is the real number n (33) g'(t) = L (Dif)(y(t))y; (t). i= 1 This is a frequently encountered special case of the chain rule. It can be rephrased in the following manner. Associate with each x e E a vector, the so-called ''grarlient'' off at x, defined by n (34) (V/)(x) = L (D 1/)(x)e;. i= 1 Since n (35) y'(t) = L 1, (t)e;, ,= 1 (33) can be written in the form (36) g'(t) = (Vf)(y(t)) · y'(t), the scalar product of the vectors (V/)(y(t)) and y'(t). Let us now fix an x e E, let u e Rn be a unit vector ( that is, I u I = 1 ), and specialize y so that (37) y(t) = X + tu ( - 00 < t < 00 ). Then y'(t) = u for every t. Hence (36) shows that (38) g'(O) = (V/)(x) · u. On the other hand, (37) shows that g(t) - g(O) = /(x + tu) - /(x). Hence (38) gives (39) lim /(x + tu) - /(x) = (V/) (x) · u. t➔ O t 218 PRINCIPLES OF MATHEMATICAL ANALYSIS The limit in (39) is usually called the directional derivative off at x, in the direction of the unit vector u, and may be denoted by (Duf)(x). If f and x are fixed, but u varies, then (39) shows that (Duf)(x) attains its maximum when u is a positive scalar multiple of (Vf)(x). [The case (Vf)(x) = 0 should be excluded here.] If u = l:.u1 e,, then (39) shows that (Duf)(x) can be expressed in terms of the partial derivatives off at x by the formula n (40) (Duf)(x) = L (Dif)(x)ui. i= 1 Some of these ideas will play a role in the following theorem. 9.19 Theorem Suppose f maps a convex open set E c Rn into Rm, f is differen- tiable in E, and there is a real number M such that llf '(x)II ~ M for every x e E. Then lf(b) - f(a)I ~ Mjb - al for all a e E, b e E. Proof Fix a e E, b e E. Define y(t) = (1 - t)a + tb for all t e R1 such that y(t) e E. Since Eis convex, y(t) e E if O ~ t ~ I. Put g(t) = f (y(t)). Then g'(t) = f '(y(t))y'(t) = f '(y(t))(b - a), so that lg'(t)I ~ llf'(y(t))ll lb - al~ Mlb - al for all t e [O, 1 ]. By Theorem 5.19, lg(l) - g(O)I ~ Mlb - al. But g(O) = f(a) and g(l) = f (b). This completes the proof. Corollary If, in addition, f'(x) = 0 for all x e E, then f is constant. Proof To prove this, note that the hypotheses of the theorem hold now with M =0. FUNCTIONS OF SEVERAL VARIABLES 219 9.20 Definition A differentiable mapping f of an open set E c Rn into Rm is said to be continuously differentiable in E if f' is a continuous mapping of E into L(Rn, Rm). More explicitly, it is required that to every x e E and to every e > 0 corresponds a /j > 0 such that !If '(y) - r '(x)II < e if y e E and I x - Y I < l>. If this is so, we also say that f is a CC'-mapping, or that f e CC'(E). 9.21 Theorem Suppose f maps an open set E c Rn into Rm. Then f e CC'(E) if and only if the partial derivatives D Jh exist and are continuous on E for 1 ~ i ~ m, 1 ~j ~ n. (41) Proof Assume first that f e CC'(E). By (27), (DJft)(x) = (f'(x)eJ) · u, for all i, .i, and for all x e E. Hence (DJfi)(y) - (DJft)(x) = {[f'(y) - f'(x)]eJ} · u, and since I ui I = I e JI = I, it follows that I (DJft)(y) - (DJft)(x) I ~ I [f'(y) - f '(x)]eJ I ~ llf'(y) - f'(x)II. Hence D Jh is continuous. For the converse, it suffices to consider the case m = 1. (Why?) Fix x e E and e > 0. Since E is open, there is an open ball S c E, with center at x and radius r, and the continuity of the functions DJf shows that r can be chosen so that B I (DJ/)(y) - (DJ/)(x) I < - n (y ES, 1 ~j ~ n). Suppose h = I.hJeJ, lhl < r, put v0 = 0, and vk = h1e 1 + · · · + hkek, for 1 ~ k ~ n . Then n (42) /(x + h) -/(x) = L [f(x + vJ) - /(x + VJ- 1)]. J= 1 Since I vk I < r for 1 ~ k ~ n and since S is convex, the segments with end points x + vJ-l and x + vJ lie in S. Since VJ= vJ-l + hJeJ, the mean value theorem (5.10) shows that thejth summand in (42) is equal to hJ(DJf)(x + vJ-l + 0JhJeJ) 220 PRINCIPLES OF MATHEMATICAL ANALYSIS for some 01 e (0, 1), and this differs from h1(D1f)(x) by less than I h1 I e/n, using (41). By (42), it follows that for all h such that I h I < r. This says that f is differentiable at x and that f'(x) is the linear function which assigns the number '1:.h1(D1f)(x) to the vector h = '1:.h1e1 . The matrix [f'(x)] consists of the row (D 1/)(x), ... , (Dnf)(x); and since D1f, ... , Dnf are continuous functions on E, the concluding remarks of Sec. 9.9 show that/ e fC'(E). THE CONTRACTION PRINCIPLE We now interrupt our discussion of differentiation to insert a fixed point theorem that is valid in arbitrary complete metric spaces. It will be used in the proof of the inverse function theorem. 9.22 Definition Let X be a metric space, with metric d. If <p maps X into X and if there is a number c < 1 such that (43) d(<p(x), <p(y)) :$; c d(x, y) for all x, y e X, then <p is said to be a contraction of X into X. 9.23 Theorem If X is a complete metric space, and if <p is a contraction of X into X, then there exists one and only one x e X such that <p(x) = x. In other words, <p has a unique fixed point. The uniqueness is a triviality, for if <p(x) = x and <p(y) = y, then (43) gives d(x, y) :$; c d(x, y), which can only happen when d(x, y) = 0. The existence of a fixed point of <p is the essential part of the theorem. The proof actually furnishes a constructive method for locating the fixed point. (44) (45) Proof Pick x 0 e X arbitrarily, and define {xn} recursively, by setting (n = 0, 1, 2, ... ). Choose c < 1 so that (43) holds. For n ~ 1 we then have d(Xn+ 1, Xn) = d(<p(Xn), <p(Xn- 1)) ~ C d(xn, Xn- 1), Hence induction gives (n=0,1,2, ... ). FUNCTIONS OF SEVERAL VARIABLES 221 If n < m, it follows that m d(xn, Xm) ~ L d(xi, Xi-1) i=n+ 1 ~(en+ cn+l + ''' + cm-l) d(x1, Xo) ~ [(1 - c)- 1 d(x 1, x 0)]cn. Thus {xn} is a Cauchy sequence. Since Xis complete, lim Xn = x for some XE X. Since <p is a contraction, <p is continuous (in fact, uniformly con- tinuous) on X. Hence <p(x) = lim <p(Xn) = lim Xn+ 1 = X. n ➔ oo n ➔ oo THE INVERSE FUNCTION THEOREM The inverse function theorem states, roughly speaking, that a continuously differentiable mapping f is invertible in a neighborhood of any point x at which the linear transformation f'(x) is invertible: 9.24 Theorem Si,ppose f is a <fl'-mapping of an open set E c Rn into Rn, f'(a) is invertible for some a e E, and b = f(a). Then (a) there exist open sets U and Vin Rn such that a e U, be V, f is one-to- one on U, and f(U) = V; (b) if g is the inverse off [which exists, by (a)], defined in V by g(f(x)) = X (x e U), then g e <fl'(V). Writing the equation y = f(x) in component form, we arrive at the follow- ing interpretation of the conclusion of the theorem: The system of n equations (1 ~ i ~ n) can be solved for x 1 , .•• , xn in terms of y 1 , ••• , Yn, if we restrict x and y to small enough neighborhoods of a and b; the solutions are unique and continuously differentiable. (46) Proof (a) Put f'(a) = A, and choose A so that 2l11A- 1 11 = 1. 222 PRINCIPLES OF MATHEMATICAL ANALYSIS (47) Since f' is continuous at a, there is an open ball Uc E, with center at a, such that llf'(x) - A 11 < J. (x e U). We associate to each ye Rn a function q,, defined by (48) q,(x) = x + A- 1{y - f(x)) (x e E). (49) (50) Note that f(x) = y if and only if xis a.fixed point of q,. Since q,'(x) = / - A- 1f'(x) = A- 1(A - f'(x)), (46) and (47) imply that llq,'(x)I < ½ (x e U). Hence by Theorem 9.19. It follows that q, has at most one fixed point in U, so that f (x) = y for at most one x e U. Thus f is 1 - 1 in U. Next, put V = f(U), and pick Yoe V. Then Yo = f(x 0) for some x0 e U. Let B be an open ball with center at x 0 and radius r > 0, so small that its closure .B lies in U. We will show that ye Vwhenever I y - Yo I < J.r. This proves, of course, that V is open. Fix y, I y - Yo I < J.r. With q, as in (48), r lq,(xo) - Xol = IA- 1(Y-Yo)I < IIA- 1 1 J.r = 2- If x e .B, it therefore follows from (50) that I q,(x) - Xo I :::; I q,(x) - q,(xo) I + I q,(xo) - Xo I • 1 r < 2 I x - Xo I + 2 :::; r; hence q,(x) e B. Note that (50) holds if x 1 e B, x 2 e B. Thus q, is a contraction of B into .B. Being a closed subset of Rn, B is complete. Theorem 9.23 implies therefore that q, has a fixed point x e B. For this x, f(x) = y. Thus ye f(B) c f(U) = V. This proves part (a) of the theorem. (b) Pick ye V, y + k e V. Then there exist x e U, x +he U, so that y = f (x), y + k = f (x + h). With q, as in (48), q,(x + h) - q,(x) = h + A- 1[f(x) - f(x + h)] = h - A- 1k. By (50), lb -A- 1kl:::; ½lhl. Hence IA- 1kl ~ ½lhl, and (51) !hi:::; 2IIA- 1 II lkl =2- 1 lkl, FUNCTIONS OF SEVERAL VARIABLES 223 By (46), (47), and Theorem 9.8, f'(x) has an inverse, say T. Since g(y + k) - g(y) - Tk = h - Tk = -T[f(x + h) - f(x) - f'(x)h], (51) implies lg(y + k) - g(y) - Tkl IIT I lf(x + h) - f(x) - f'(x)hl lkl ~ A . lhl . Ask ➔ 0, (51) shows that h ➔ 0. The right side of the last inequality thus tends to 0. Hence the same is true of the left. We have thus proved that g'(y) = T. But Twas chosen to be the inverse off'(x) = f'(g(y)). Thus (52) g'(y) = {f '(g(y))}- 1 (ye V). Finally, note that g is a continuous mapping of V onto U (since g is differentiable), that f' is a continuous mapping of U into the set n of all invertible elements of L(Rn), and that inversion is a continuous mapping of n onto n, by Theorem 9.8. If we combine these facts with (52), we see that g e <67'( V). This completes the proof. Remark. The full force of the assumption that f e <67'(E) was only used in the last paragraph of the preceding proof. Everything else, down to Eq. (52), was derived from the existence off '(x) for x e E, the invertibility of f'(a), and the continuity off' at just the point a. In this connection, we refer to the article by A. Nijenhuis in Amer. Math. Monthly, vol. 81, 1974, pp. 969-980. The following is an immediate consequence of part (a) of the inverse function theorem. 9.25 Theorem /ff is a <67'-mapping of an open set E c Rn into Rn and if f'(x) is invertible for every x e E, then f ( W) is an open subset of Rn for every open set WcE. In other words, f is an open mapping of E into Rn. The hypotheses made in this theorem ensure that each point x e E has a neighborhood in which f is 1-1. This may be expressed by saying that f is locally one-to-one in E. But f need not be 1-1 in E under these circumstances. ?or an example, see Exercise 17. THE IMPLICIT FUNCTION THEOREM If f is a continuously differentiable real function in the plane, then the equation f(x, y) = 0 can be solved for y in terms of x in a neighborhood of any point 224 PRINCIPLES OF MATHEMATICAL ANALYSIS (a, b) at whichf(a, b) = 0 and of/oy-:/: 0. Likewise, one can solve for x in terms of y near (a, b) if of/ox-:/: 0 at (a, b). For a simple example which illustrates the need for assuming of/oy-:/: 0, consider f(x, y) = x 2 + y 2 - 1. The preceding very informal statement is the simplest case (the case m = n = 1 of Theorem 9.28) of the so-called ''implicit function theorem.\" Its proof makes strong use of the fact that continuously differentiable transformations behave locally very much like their derivatives. Accordingly, we first prove Theorem 9.27, the linear version of Theorem 9.28. 9.26 Notation If x = (x1 , ... , Xn) e Rn and y = (y 1 , .•. , Ym) e Rm, let us write (x, y) for the point ( or vector) In what follows, the first entry in (x, y) or in a similar symbol will always be a vector in Rn, the second will be a vector in Rm. Every A e L(Rn+m, Rn) can be split into two linear transformations Ax and Ay , defined by (53) Ax h = A(h, 0), for any he Rn, k e Rm. Then Axe L(Rn), Aye L(Rm, Rn), and (54) A(h, k) = Ax h + Ay k. The linear version of the implicit function theorem is now almost obvious. 9.27 Theorem If A e L(Rn+m, Rn) and if Ax is invertible, then there corresponds to every k e Rm a unique h e Rn such that A(h, k) = 0. This h can be computed from k by the formula (55) h = -(Ax)- 1Ayk. Proof By (54), A(h, k) = 0 if and only if Axh + Ayk = 0, which is the same as (55) when Ax is invertible. The conclusion of Theorem 9.27 is, in other words, that the equation A(h, k) = 0 can be solved (uniquely) for h if k is given, and that the solution h is a linear function of k. Those who have some acquaintance with linear algebra will recognize this as a very familiar statement about systems of linear equations. 9.28 Theorem Let f be a rc' -niapping of an open set E c Rn+m into Rn, such that f(a, b) = 0 for some point (a, b) e E. Put A = f'(a, b) and assume that Ax is invertible. FUNCTIONS OF SEVERAL VARIABLES 225 Then there exist open sets Uc Rn+m and W c Rm, with (a, b) e U and b e W, having the f of lowing property: (56) (57) and (58) To every y e W corresponds a unique x such that (x, y) EU and f (x, y) = 0. If this xis defined to be g(y), then g is a ~'-mapping of W into Rn, g(b) = a, f (g(y), y) = 0 (y E W), The function g is ''implicitly'' defined by (57). Hence the name of the theorem. The equation f(x, y) = 0 can be written as a system of n equations in n + m variables: (59) • • • • • • • • • • • • • • • • • • • • • • • • • • • • • fn(x1, ... ' Xn, Y1, ... ' Ym) = 0. The assumption that Ax is invertible means that the n by n matrix D1f1 · · · D,,f1 I I I I I • • I I I I I I I I I D f, ... 1 n evaluated at (a, b) defines an invertible linear operator in Rn; in other words, its column vectors should be independent, or, equivalently, its determinant should be =FO, (See Theorem 9.36.) If, furthermore, (59) holds when x = a and y = b, then the conclusion of the theorem is that (59) can be solved for x 1, .•• , xn in terms of y1, ... , Ym, for every y near b, and that these solutions are continu- ously differentiable functions of y. (60) Proof Define F by F(x, y) = (f(x, y), y) ((x, y) EE). Then F is a ~'-mapping of E into Rn+m. We claim that F'(a, b) is an invertible element of L(Rn+m): Since f (a, b) = 0, we have f (a + h, b + k) = A(h, k) + r(h, k), where r is the remainder that occurs in the definition of f'(a, b). Since F(a + h, b + k) - F(a, b) = (f (a+ h, b + k), k) = (A(h, k), k) + (r(h, k), 0) 226 PRINCIPLES OF MATHEMATICAL ANALYSIS (61) (62) it follows that F'(a, b) is the linear operator on Rn+m that maps (h, k) to (A(h, k), k). If this image vector is 0, then A(h, k) = 0 and k = 0, hence A(h, 0) = 0, and Theorem 9.27 implies that h = 0. It follows that F'(a, b) is 1-1; hence it is invertible (Theorem 9.5). The inverse function theorem can therefore be applied to F. It shows that there exist open sets U and Vin Rn+m, with (a, b) e U, (0, b) e V, such that F is a 1-1 mapping of U onto V. We let W be the set of all ye Rm such that (0, y) e V. Note that be W. It is clear that W is open since V is open. lfy e W, then (0, y) = F(x, y) for some (x, y) e U. By (60), f(x, y) = 0 for this x. Suppose, with the same y, that (x', y) e U and f(x', y) = 0. Then F(x', y) = (f(x', y), y) = (f(x, y), y) = F(x, y). Since F is 1-1 in U, it follows that x' = x. This proves the first part of the theorem. For the second part, define g(y), for y e W, so that (g(y), y) e U and (57) holds. Then F(g(y), y) = (0, y) (y E W). If G is the mapping of V onto U that inverts F, then G e ~', by the inverse function theorem, and (61) gives (g(y), y) = G(O, y) (y E W). Since Ge~', (62) shows that g e ~'. Finally, to compute g'(b), put (g(y), y) = <l>(y). Then (63) <l>'(y)k = (g'(y)k, k) (ye W, k e Rm). (64) (65) By (57), f (<l>(y)) = 0 in W. The chain rule shows therefore that f '(<l>(y))<l>'(y) = 0. When y = b, then <l>(y) = (a, b), and f '(<l>(y)) = A. Thus A<l>'(b) = 0. It now follows from (64), (63), and (54), that Axg'(b)k + A,k = A(g'(b)k, k) = A<l>'(b)k = 0 for every k e Rm. Thus Axg'(b) +A,= 0. FUNCTIONS OF SEVERAL VARIABLES 227 This is equivalent to (58), and completes the proof. Note. In terms of the components off and g, (65) becomes n L (D1ft)(a, b)(DkgJ)(b) = -(Dn+kft)(a, b) J= 1 or n I - -- J= 1 where 1 ~ i ~ n, 1 ~ k ~ m. For each k, this is a system of n linear equations in which the derivatives ogi/oyk (1 ~j ~ n) are the unknowns. 9.29 Example Take n = 2, m = 3, and consider the mapping f = (/1, / 2) of R 5 into R 2 given by f1(X1, X2, Y1, Y2, y3) = 2exi + X2 Y1 - 4y2 + 3 f2(X1, X2' Y1, Y2' y3) = X2 cos X1 - 6x1 + 2y1 - YJ. If a = (0, 1) and b = (3, 2, 7), then f(a, b) = 0. With respect to the standard bases, the matrix of the transformation A = f '(a, b) is Hence [A]= 2 -6 2 -6 3 1 ' 3 1 1 2 -4 0 1 [A,]= 2 0 -1 . -4 0 0 -1 . We see that the column vectors of [Ax] are independent. Hence Ax is invertible and the implicit function theorem asserts the existence of a rc' -mapping g, defined in a neighborhood of (3, 2, 7), such that g(3, 2, 7) = (0, 1) and f (g(y), y) = 0. We can use (58) to compute g'(3, 2, 7): Since (58) gives 1 1 [g'(3, 2, 7)] = - 20 6 -3 1 2 2 -4 0 1 -3 6 2 0 -1 -- ¼ -½ t -~ t *. 228 PRINCIPLES OF MATHEMATICAL ANALYSIS In terms of partial derivatives, the conclusion is that D1U2 = -½ at the point (3, 2, 7). THE RANK THEOREM D2U1 = t D2U2 =f D g - - 3 3 1 - 20 D3g2 = 1 1 0 Although this theorem is not as important as the inverse function theorem or the implicit function theorem, we include it as another interesting illustration of the general principle that the local behavior of a continuously differentiable mapping F near a point x is similar to that of the linear transformation F'(x). Before stating it, we need a few more facts about linear transformations. 9.30 Definitions Suppose X and Y are vector spaces, and A E L( X, Y), as in Definition 9.6. The null space of A, %(A), is the set of all x E X at which Ax = 0. It is clear that .;V(A) is a vector space in X. Likewise, the range of A, al(A), is a vector space in Y. The rank of A is defined to be the dimension of al(A). For example, the invertible elements of L(Rn) are precisely those whose rank is n. This follows from Theorem 9.5. If A E L(X, Y) and A has rank 0, then Ax = 0 for all x e A, hence.;V(A) = X. In this connection, see Exe1·cise 25. 9.31 Projections Let X be a vector space. An operator PE L(X) is said to be a projection in X if P2 = P. More explicitly, the requirement is that P(Px) = Px for every x E X. In other words, P fixes every vector in its range al(P). Here are some elementary properties of projections: (a) If Pis a projection in X, then every x E X has a unique representation of the form where x 1 e al(P), x 2 e .;V(P). To obtain the representation, put x 1 = Px, x 2 = x - x 1• Then Px2 = Px - Px 1 = Px - P 2x = 0. As regards the uniqueness, apply P to the equation x = x 1 + x2 • Since x 1 E al(P), Px 1 = x 1 ; since Px2 = 0, it follows that x 1 = Px. (b) If Xis a.finite-dimensional vector space and if X1 is a vector space in X, then there is a projection Pin X with fJt(P) = X1 . FUNCTIONS OF SEVERAL VARIABLES 229 If X1 contains only 0, this is trivial: put Px = 0 for all x e X. Assume dim X 1 = k > 0. By Theorem 9.3, X has then a basis {u1, ... , un} such that {u1, ... , uk} is a basis of X1. Define P(c1U1 + ... + cnun) = C1U1 + •. • + ckuk for arbitrary scalars c1, •.. , cn. Then Px = x for every x e X 1 , and X 1 = 9l(P). Note that {uk+ 1, ... , un} is a basis of .;V(P). Note also that there are infinitely many projections in X, with range X1 , if O < dim X1 < dim X. 9.32 Theorem Suppose m, n, r are nonnegative integers, m ~ r, n ~ r, F is a <C' -mapping of an open set E c Rn into Rm, and F'(x) has rank r for every x e E. Fix a e E, put A = F'(a), let Y1 be the range of A, and let P be a projection in Rm whose range is Y1 . Let Y2 be the null space of P. Then there are open sets U and V in Rn, with a e U, U c E, and there is a 1-1 <C' -mapping H of V onto U ( whose inverse is also of class <C') such that (66) F(H(x)) = Ax + q,(Ax) (x e V) where q, is a <C' -mapping of the open set A(V) c Y1 into Y2 • After the proof we shall give a more geometric description of the informa- tion that (66) contains. (67) (68) (69) Proof If r = 0, Theorem 9.19 shows that F(x) is constant in a neighbor- hood U of a, and (66) holds trivially, with V = U, H(x) = x, q,(O) = F(a). From now on we assume r > 0. Since dim Y1 = r, Y1 has a basis {y 1 , ... , Yr}. Choose zi e Rn so that Azi = Yi (1 ~ i ~ r), and define a linear mapping S of Y1 into Rn by setting S(cy +···+cy)=cz +···+cz 11 rr 11 rr for all scalars c 1 , .•. , cr. Then ASyi = Azi = Yi for I ~ i ~ r. Thus ASy =y Define a mapping G of E into Rn by setting G(x) = x + SP[F(x) - Ax] (x EE). Since F'(a) = A, differentiation of (69) shows that G'(a) = I, the identity operator on Rn. By the inverse function theorem, there are open sets U and V in Rn, with a e U, such that G is a 1-1 mapping of U onto V whose inverse His also of class~'. Moreover, by shrinking U and V, if necessary, we can arrange it so that Vis convex and H'(x) is invertible for every x e V. 230 PRINCIPLES OF MATHEMATICAL ANALYSIS (70) (71) (72) (73) (74) (75) Note that ASPA = A, since PA = A and (68) holds. Therefore (69) • gives AG(x) = PF(x) (x e E). In particular, (70) holds for x e U. If we replace x by H(x), we obtain PF(H(x)) = Ax (x e V). Define 1/J(x) = F(H(x)) - Ax (x e V). Since PA = A, (71) implies that PI/J(x) = 0 for all x e V. Thus 1/J is a fl' -mapping of V into Y2 • Since Vis open, it is clear that A(V) is an open subset of its range al(A) = Y1• To complete the proof, i.e., to go from (72) to (66), we have to show that there is a <67'-mapping q, of A(V) into Y2 which satisfies q,(Ax) = 1/J(x) (x e V). As a step toward (73), we will first prove that I/J(x1) = I/J(x2) if x 1 e V, x2 e V, Ax1 = Ax2 • Put <l>(x) = F(H(x)), for x e V. Since H'(x) has rank n for every x e V, and F'(x) has rank r for every x e U, it follows that rank <l>'(x) = rank F'(H(x))H'(x) = r (x e V). Fix x e V. Let M be the range of <l>'(x). Then Mc Rm, dim M = r. By (71), (76) P<l>'(x) = A. (77) (78) Thus P maps M onto al(A) = Y1 • Since M and Y1 have the same di- mension, it follows that P (restricted to M) is 1-1. Suppose now that Ah= 0. Then P<l>'(x)h = 0, by (76). But <l>'(x)h e M, and Pis 1-1 on M. Hence ct>'(x)h = 0. A look at (72) shows now that we have proved the following: If x e V and Ah = 0, then 1/J'(x)h = 0. We can now prove (74). Suppose x 1 e V, x2 e V, Ax 1 = Ax2 . Put h = x 2 - x 1 and define g(t) = I/J(x1 + th) (0 :$; t :$; 1). The convexity of V shows that x 1 + th e V for these t. Hence g'(t) = l/l'(x1 + th)h = 0 (0 :$; t :$; 1), (79) FUNCTIONS OF SEVERAL VARIABLES 231 so that g(l) = g(O). But g(l) = I/J(x2) and g(O) = I/J(x1). This proves (74). By (74), 1/J(x) depends only on Ax, for x e V. Hence (73) defines q, unambiguously in A(V). It only remains to be proved that q, e rc'. Fix Yoe A(V), fix x 0 e V so that Ax0 =Yo. Since Vis open, Yo has a neighborhood W in Y1 such that the vector x = X 0 + S(y - Yo) lies in V for all ye W. By (68), Ax = Ax0 + Y - Yo = Y • Thus (73) and (79) give (80) q,(y) = I/J(x0 - Sy0 + Sy) (y E W). This formula shows that q, e rc' in W, hence in A(V), since Yo was chosen arbitrarily in A(V). The proof is now complete. Here is what the theorem tells us about the geometry of the mapping F. If ye F(U) then y = F(H(x)) for some x e V, and (66) shows that Py = Ax. Therefore (81) y =Py+ q,(Py) (ye F(U)). This shows that y is determined by its projection Py, and that P, restricted to F(U), is a 1-1 mapping of F(U) onto A(V). Thus F(U) is an ''r-dimensional surface'' with precisely one point ''over'' each point of A(V). We may also regard F( V) as the graph of q,. If <l>(x) = F(H(x)), as in the proof, then (66) shows that the level sets of <I> (these are the sets on which <l> attains a given value) are precisely the level sets of A in V. These are ''flat'' since they are intersections with V of translates of the vector space %(A). Note that dim %(A) = n - r (Exercise 25). The level sets of F in U are the images under H of the flat level sets of <l> in V. They are thus ''(n - r )-dimensional surfaces'' in U. DETERMINANTS Determinants are numbers associated to square matrices, and hence to the operators represented by such matrices. They are O if and only if the corre- sponding operator fails to be invertible. They can therefore be used to decide whether the hypotheses of some of the preceding theorems are satisfied. They will play an even more important role in Chap. 10. 232 PRINCIPLES OF MATHEMATICAL ANALYSIS 9.33 Definition If (j1 , .•• ,jn) is an ordered n-tuple of integers, define (82) s(j1, ... , in) = fl sgn (jq - jp), p<q where sgn x = 1 if x > 0, sgn x = -1 if x < 0, sgn x = 0 if x = 0. Then s(j1, ... ,jn) = 1, -1, or 0, and it changes sign if any two of the j's are inter- changed. Let [A] be the matrix of a linear operator A on Rn, relative to the standard basis {e1, ... , en}, with entries a(i,j) in the ith row and jth column. The deter- minant of [A] is defined to be the number (83) The sum in (83) extends over all ordered n-tuples of integers (j1 , ... ,jn) with 1 5.j, 5: n. The column vectors xi of [A] are n (84) xi = I a(i,j)ei (1 5.j 5: n). i= 1 It will be convenient to think of det [A] as a function of the column vectors of [A]. If we write det (x 1 , ... , xn) = det [A], det is now a real function on the set of all ordered n-tuples of vectors in Rn. 9.34 Theorem (a) If I is the identity operator on Rn, then det [I] = det ( e 1, •.. , en) = 1. (b) det is a linear function of each of the column vectors xi, if the others are held fixed. (c) If [A] 1 is obtained from [A] by interchanging two columns, then det [A] 1 = -det [A]. (d) If [A] has two equal columns, then det [A]= 0. Proof If A = I, then a(i, i) = 1 and a(i,j) = 0 for i \"I: j. Hence det [I] = s( 1, 2, ... , n) = 1, which proves (a). By (82), s(j1 , ••• , jn) = 0 if any two of the.i's are equal. Each of the remaining n ! products in (83) contains exactly one factor from each column. This proves (b). Part (c) is an immediate consequence of the fact that s(j 1 , •.• , in) changes sign if any two of the j's are inter- changed, and ( d) is a corollary of ( c ). FUNCTIONS OF SEVERAL VARIABLES 233 9.35 Theorem If [A] and [B] are n by n matrices, then det ([Bj[A]) = det [B] det [A]. (85) (86) (87) Proof If x 1, ... , xn are the columns of [A], define ~s(X1, ... , Xn) = ~s[A] = det ([B][A]). The columns of [B][A] are the vectors Bx1, ... , Bxn. Thus ~s(X1, ... , Xn) = det (Bx1, ... , Bxn). By (86) and Theorem 9.34, ~ 8 also has properties 9.34 (b) to (d). By (b) and (84), ~ 8 [A] = ~B I a(i, l)e;, x2 , ... , Xn = I a(i, 1) ~ 8 (e;, x2 , ... , Xn). • • ' ' Repeating this process with x 2 , ••• , xn , we obtain ~ 8 [A] = I a(i1 , 1)a(i2 , 2) · · · a(in, n) ~ 8 (e; 1 , ••• , e;\"), the sum being extended over all ordered n-tuples (i1, ... , in) with 1 ~ ir ~ n. By (c) and (d), (88) ~B(e; 1 , • • •, e;n) = t(i1, •••,in) ~B(e1, •••,en), where t = 1, 0, or -1, and since [B][/] = [B], (85) shows that (89) ~ 8(e 1, ... , en) = det [B]. Substituting (89) and (88) into (87), we obtain det ([B][A]) = { I a(i1 , 1) · · · a(in, n)t(i 1 , ••• , in)} det [B], for all n by n matrices [A] and [B]. Taking B = I, we see that the above sum in braces is det [A]. This proves the theorem. 9.36 Theorem A linear operator A on Rn is invertible if and only if det [A] \"# 0. Proof If A is invertible, Theorem 9.35 shows that det [A] det [A- 1] = det [AA- 1] = det [/] = 1, so that det [A] \"# 0. If A is not invertible, the columns x 1, ... , xn of [A] are dependent (Theorem 9.5); hence there is one, say, xk, such that (9~ xk+I0~=0 J¢k for certain scalars cJ. By 9.34 (b) and (d), xk can be replaced by xk + cJ xJ without altering the determinant, if j \"I: k. Repeating, we see that xk can 234 PRINCIPLES OF MATHEMATICAL ANALYSIS be replaced by the left side of (90), i.e., by 0, without altering the deter- minant. But a matrix which has O for one column has determinant 0. Hence det [A] = 0. 9.37 Remark Suppose {e1, ••• , en} and {u1, ... , un} are bases in R\". Every linear operator A on R\" determines matrices [A] and [A]u, with entries aii and o:1i, given by Ae- = \"a- 1 e-J L.,. I 1, I If u1 = Be1 = 'f.b 11 e1 , then Au1 is equal to L r:t.ki Bek = L r:t.kJ L b1k ei = L L bik r:t.kJ ei, k k i i k and also to Thus I.bik o:ki = 'f.a1k bkJ, or (91) [B][A]u = [A][B]. Since B is invertible, det [B] \"# 0. Hence (91), combined with Theorem 9.35, shows that (92) det [A Ju = det [A]. The determinant of the matrix of a linear operator does therefore not depend on the basis which is used to construct the matrix. It is thus meaningful to speak of the determinant of a linear operator, without having any basis in mind. 9.38 Jacobians If f maps an open set E c R\" into R\", and if f is differen~ tiable at a point x e E, the determinant of the linear operator f'(x) is called the Jacobian off at x. In symbols, (93) We shall also use the notation (94) J1(x) = det f'(x). o(y1, · · ·, Yn) O(X1, ... , Xn) for J1(x), if (Y1, ... , Yn) = f (x1, ... , Xn). In terms of Jacobians, the crucial hypothesis in the inverse function theorem is that J1(a) \"# 0 (compare Theorem 9.36). If the implicit function theorem is stated in terms of the functions (59), the assumption made there on A amounts to FUNCTIONS OF SEVERAL VARIABLES 235 DERIVATIVES OF HIGHER ORDER 9.39 Definition Suppose f is a real function defined in an open set E c R\", with partial derivatives D 1/, ••• , Dnf If the functions D1f are themselves differentiable, then the second-order partial derivatives off are defined by (i,j=l, ... ,n). If all these functions Di1f are continuous in E, we say that/is of class ct'' in E, or that/ e ct\"(E). A mapping f of E into Rm is said to be of class ct\" if each component off is of class ct\". It can happen that Di1f \"I: D1if at some point, although both derivatives exist (see Exercise 27). However, we shall see below that D11f= D11/whenever these derivatives are continuous. For simplicity (and without loss of generality) we state our next two theorems for real functions of two variables. The first one is a mean value theorem. 9.40 Theorem Suppose f is de.fined in an open set E c R2 , and D 1f and D 21 f exist at every point of E. Suppose Q c E is a closed rectangle with sides parallel to the coordinate axes, having (a, b) and (a +h, b + k) as opposite vertices (h \"I: 0, k \"I: 0). Put (95) fl.(/, Q) = f(a + h, b + k) - f(a + h, b) - f(a, b + k) + f(a, b). Then there is a point (x, y) in the interior of Q such that fl.(/, Q) = hk(D21 f)(x, y). Note the analogy between (95) and Theorem 5.10; the area of Q is hk. Proof Put u(t) = f(t, b + k) - f(t, b). Two applications of Theorem 5.10 show that there is an x between a and a + h, and that there is a y between b and b + k, such that fl.(f, Q) = u(a + h) - u(a) = hu'(x) = h[(D 1f)(x, b + k) - (D 1f)(x, b)] = hk(D21[)(x, y). 9.41 Theorem Suppose f is de.fined in an open set E c R 2 , suppose that D 1f, D21/, and D 2 f exist at every point of E, and D 21 f is continuous at some point (a, b) e E. 236 PRINCIPLES OF MATHEMATICAL ANALYSIS Then D12/ exists at (a, b) and (96) (D12f)(a, b) = (D21f)(a, b). Corollary D21/= D 12/iffe <t''(E). (97) Proof Put A = (D 21f)(a, b). Choose e > 0. If Q is a rectangle as in Theorem 9.40, and if hand k are sufficiently small, we have I A - (D21f)(x, y) I < e for all (x, y) e Q. Thus ll(f, Q) - A < hk 6' by (95). Fix h, and let k ➔ 0. Since D2 f exists in E, the last inequality implies that 1 (D 2 f)(a + h, b) - (D 2/)(a, b) h - A ~ e. Since e was arbitrary, and since (97) holds for all sufficiently small h =/:- 0, it follows that (D 12/)(a, b) = A. This gives (96). DIFFERENTIATION OF INTEGRALS Suppose <p is a function of two variables which can be integrated with respect to one and which can be differentiated with respect to the other. Under what conditions will the result be the same if these two limit processes are carried out in the opposite order? To state the question more precisely: Under what conditions on <p can one prove that the equation (98) d b b O<p d <p(x, t) dx = 0 (x, t) dx t a a t is true? (A counter example is furnished by Exercise 28.) It will be convenient to use the notation (99) <pt(x) = <p(X, t). Thus <pt is, for each t, a function of one variable . • 9.42 Theorem Suppose (a) <p(x, t) is de.fined/or a~ x Sb, c ~ t S d; (b) ix is an increasing function on [a, b]; (100) (101) FUNCTIONS OF SEVERAL VARIABLES 237 (c) <pt e &l(c,:) for every t e [c, d]; ( d) c < s < d, and to every B > 0 corresponds a b > 0 such that I (D 2 <p)(x, t) - (D 2 <p)(x, s) I < B Jor all x e [a, b] and/or all t e (s - b, s + b). De.fine b f(t) = <p(x, t) dc,:(x) a Then (D2 <p)s e &l(c,:),/'(s) exists, and b (c ~ t ~ d). /'(s) = (D 2 <p)(x, s) dc,:(x). a Note that (c) simply asserts the existence of the integrals (100) for all t e [c, d]. Note also that (d) certainly holds whenever D 2 <pis continuous on the rectangle on which <p is defined. (102) (103) Proof Consider the difference quotients '''( ) _ <p(x, t) - <p(x, s) .,, x,t ------ t-s for O < It - sl < b. By Theorem 5.10 there corresponds to each (x, t) a number u between s and t such that 1/J(x, t) = (D 2 <p)(x, u). Hence (d) implies that 1/J(x, t) - (D 2 <p)(x, s)I < B Note that f(t) - f(s) t - s -- (a~ x ~ b, 0 < it - J'I < b). b 1/J(x, t) da(x). a By (102), 1/Jt ➔ (D 2 <p)s, uniformly on [a, b], as t ➔ s. Since each 1/Jt e &l(a), the desired conclusion follows from (103) and Theorem 7.16. 9.43 Example One can of course prove analogues of Theorem 9.42 with (- oo, oo) in place of [a, b]. Instead of doing this, let us simply look at an example. Define (104) /(t) = e-xi cos (xt) dx -Cl) 238 PRINCIPLES OF MATHEMATICAL ANALYSIS and (105) g(t) = - 00 xe-x 2 sin (xt) dx, -oo for - oo < t < oo. Both integrals exist (they converge absolutely) since the absolute values of the integrands are at most exp ( - x 2 ) and Ix I exp ( -x 2 ), respectively. Note that g is obtained from/by differentiating the integrand with respect to t. We claim that/ is differentiable and that (106) f'(t) = g(t) ( - 00 < t < 00 ). To prove this, let us first examine the difference quotients of the cosine: if /J > 0, then COS (ix + /J) - COS (X • 1 «+P . . (107) fJ + sin ix = p « (sin ix - sin t) dt. Since I sin ix - sin t I s;; It - ix I, the right side of (107) is at most /J/2 in absolute value; the case fJ < 0 is handled similarly. Thus (108) cos c ix + /3) - cos ix • I n I /J + Sill IX :$;; p for all /J (if the left side is interpreted to be O when /J = 0). Now fix t, and fix h ¥- 0. Apply (108) with ix = xt, fJ = xh; it follows from (104) and (105) that that (109) -Cl) When h-+ 0, we thus obtain (106). Let us go a step further: An integration by parts, applied to (104), shows /( ) 2 00 _ 2 sin (xt) d t = xe x -- x. -oo t Thus tf(t) = - 2g(t), and (106) implies now that f satisfies the differential equation (110) 2/'(t) + tf(t) = 0. If we solve this differential equation and use the fact that /(0) = J n (see Sec. 8.21), we find that (111) t2 f(t) = J; exp - 4 . The integral (104) is thus explicitly determined. ' ' FUNCTIONS OF SEVERAL VARIABLES 239 EXERCISES 1. If Sis a nonempty subset of a vector space X, prove (as asserted in Sec. 9.1) that the span of S is a vector space. 2. Prove (as asserted in Sec. 9.6) that BA is linear if A and Bare linear transformations. Prove also that A - 1 is linear and invertible. 3. Assume A E L(X, Y) and Ax= 0 only when x = 0. Prove that A is then 1-1. 4. Prove (as asserted in Sec. 9.30) that null spaces and ranges of linear transforma- tions are vector spaces. S. Prove that to every A E L(R\", R 1) corresponds a unique y ER\" such that Ax= x •y. Prove also that IIA 11 = I y I. Hint: Under certain conditions, equality holds in the Schwarz inequality. 6. If/ (0, 0) = 0 and xy f(x, Y) = x2 + y2 if (x, y) ::/== (0, 0), prove that (D1/)(x, y) and (D2f)(x, y) exist at every point of R 2, although/ is not continuous at (0, 0). 7. Suppose that/ is a real-valued function defined in an open set E c R\", and that the partial derivatives D 1 /, ••• , Dnf are bounded in E. Prove that/ is continuous in E. Hint: Proceed as in the proof of Theorem 9.21. 8. Suppose that/ is a differentiable real function in an open set E c R\", and that/ has a local maximum at a point x E £. Prove that /'(x) = 0. 9. If f is a differentiable mapping of a connected open set E c R\" into Rm, and if f'(x) = 0 for every x E £, prove that f is constant in E. 10. If/ is a real function defined in a convex open set E c R\", such that (D1/)(x) = 0 for every x E £, prove that /(x) depends only on x2, ... , Xn. Show that the convexity of E can be replaced by a weaker condition, but that some condition is required. For example, if n = 2 and E is shaped like a horseshoe, the statement may be false. 11. If I and g are differentiable real functions in R\", prove that v'(/g) =fv'g + g v'f and that v'(l //) = - 1- 2v' f wherever/::/== 0. 12. Fix two real numbers a and b, 0 <a< b. Define a mapping f = (/1,/2 ,/3) of R 2 into R 3 by .fi(s, t) = (b + a cos s) cost l2(s, t) = (b + a cos s) sin t f3(s, t) = a sins. 240 PRINCIPLES OF MATHEMATICAL ANALYSIS Describe the range Koff. (It is a certain compact subset of R 3 .) (a) Show that there are exactly 4 points p EK such that Find these points. (b) Determine the set of all q EK such that (c) Show that one of the points p found in part (a) corresponds to a local maxi- mum of / 1 , one corresponds to a local minimum, and that the other two are neither (they are so-called ''saddle points''). Which of the points q found in part (b) correspond to maxima or minima? (d) Let ,\\ be an irrational real number, and define g(t) = f(t, ,\\t). Prove that g is a 1-1 mapping of R 1 onto a dense subset of K. Prove that I g'(t) l 2 = a 2 + ,\\ 2(b + a cos t) 2 • 13. Suppose f is a differentiable mapping of R 1 into R 3 such that I f(t) I= 1 for every t. Prove that f'(t) · f(t) = 0. Interpret this result geometrically. 14. Define /(0, 0) = 0 and x3 f(x, Y) = 2 + 2 X y if (x, y) ::/== (0, 0). - (a) Prove that D1/'and D2J are bounded functions in R 2. (Hence/ is continuous.) (b) Let u be any unit vector in R 2 • Show that the directional derivative (Duf)(O, 0) exists, and that its absolute value is at most 1. (c) Let y be a differentiable mapping of R 1 into R 2 (in other words, y is a differ- entiable curve in R 2 ), with y(O) = (0, 0) and I y'(O) I> 0. Put g(t) = /(y(t)) and prove that g is differentiable for every t E R 1 • If y E <€', prove that g E <€'. (d) In spite of this, prove that/ is not differentiable at (0, 0). Hint: Formula (40) fails. 15. Define/ (0, 0) = 0, and put 4 6 2 /( ) - 2 2 2 2 X y X, Y - X + Y - X Y - (x4 + y2)2 if (x, y) ::/== (0, 0). (a) Prove, for all (x, y) E R 2 , that 4x4y2 :::;; (x4 + y2)2. Conclude that/ is continuous. FUNCTIONS OF SEVERAL VARIABLES 241 (b) For O ~ 0 ~ 27T, - oo < t < oo, define ga(t) = f(t cos 0, t sin 0). Show that ua(O) = 0, g;(O) = 0, g;(O) = 2. Each ga has therefore a strict local minimum at t = 0. In other words, the restriction of/ to each line through (0, 0) has a strict local minimum at (0, 0). (c) Show that (0, 0) is nevertheless not a local minimum for/, since/(x, x 2 ) = -x 4 • 16. Show that the continuity of f' at the point a is needed in the inverse function theorem, even in the case n = 1 : If 1 f(t)=t+2t 2 sin - t for t ::/== 0, and /(0) = 0, then /'(O) = 1, /' is bounded in (-1, 1), but J is not one-to-one in any neighborhood of 0. 17. Let f = (/1,/2) be the mapping of R 2 into R 2 given by l1(X, y) = ex cos Y, (a) What is the range of/? (b) Show that the Jacobian of J is not zero at any point of R 2 • Thus every point of R 2 has a neighborhood in which/ is one-to-one. Nevertheless,/ is not one-to- one on R 2 • (c) Put a = (0, 77/3), b = /(a), let g be the continuous inverse of f, defined in a neighborhood of b, such that g(b) = a. Find an explicit formula for g, compute f'(a) and g'(b), and verify the formula (52). (d) What are the images tinder f of lines parallel to the coordinate axes? 18. Answer analogous questions for the mapping defined by u = x2 -y2, V = 2xy. 19. Show that the system of equations 3x + y - z + u2 = 0 x-y+2z+u=0 2x + 2y - 3z + 2u = 0 can be solved for x, y, u in terms of z; for x, z, u in terms of y; for y, z, u in terms of x; but not for x, y, z in terms of u. 20. Take n = m = 1 in the implicit function theorem, and interpret the theorem (as well as its proof) graphically. 21. Define /in R 2 by f(x, y) = 2x 3 - 3x 2 + 2y 3 + 3y 2 • (a) Find the four points in R 2 at which the gradient of/ is zero. Show that/ has exactly one local maximum and one local minimum in R 2 • 242 PRINCIPLES OF MATHEMATICAL ANALYSIS (b) Let S be the set of all (x, y) e R2 at which f(x, y) = 0. Find those points of S that have no neighborhoods in which the equation f(x, y) = 0 can be solved for yin terms of x (or for x in terms of y). Describe Sas precisely as you can. 22. Give a similar discussion for f(x, y) = 2x 3 + 6xy 2 - 3x2 + 3y2 • 23. Define/in R 3 by Show that /(0, 1, -1) = 0, (D1f) (0, 1, -1) :f 0, and that there exists therefore a differentiable function gin some neighborhood of (1,-1) in R2, such that g(l, -1) = 0 and Find (D1o)(l, -1) and (D2g)(l, -1). 24. For (x, y) =f (0, 0), define f = (/i,/2) by x2-y2 !1 (x, y) = x2 + y2' Compute the rank of f'(x, y), and find the range off. 25. Suppose A e L(R\", Rm), let r be the rank of A. (a) Define S as in the proof of Theorem 9.32. Show that SA is a projection in R\" whose null space is .;V(A) and whose range is Bf(S). Hint: By (68), SASA = SA. (b) Use (a) to show that dim .;V(A) + dim 9t(A) = n. 26. Show that the existence (and even the continuity) of D12/ does not imply the existence of D1f. For example, let/(x, y) = g(x), whereg is nowhere differentiable. 27. Put/(0, 0) = 0, and f (x ) = xy(x2 - y2) , Y x2 + y2 if (x, y) =f (0, 0). Prove that (a) f, D1/, D2f are continuous in R2; (b) D12/and D21/exist at every point of R2, and are continuous except at (0, O); (c) (D12/)(0, 0) = 1, and (D21/)(0, 0) = -1. 28. For t ~ 0, put X cp(x, t) = -x + 2v1 0 and put cp(x, t) = -cp(x, It I) if t < 0. (0 :5: x :5:'Vt) < v, :s: x :s: 2 v, > (otherwise), FUNCTIONS OF SEVERAL VARIABLES 243 Show that cp is continuous on R2, and for all x. Define 1 f(t) = cp(x, t) dx. -1 Show that f(t) = t if It I<¼. Hence 1 f'(O) -=I (D2cp)(x, 0) dx. -1 29. Let Ebe an open set in R\". The classes~'(£) and ~H(E) are defined in the text. By induction, ~<k>(E) can be defined as follows, for all positive integers k: To say that/ e ~<k>(E) means that the partial derivatives D1/, ... , Dnfbelong to ~<\"- 1>(£). Assume f e ~<k>(E)~ and show (by repeated application of Theorem 9.41) that the kth-order derivative D1112 ... ,kl= D11D12 ... D,\"f is unchanged if the subscripts i1, ... , ik are permuted. For instance, if n ~ 3, then D1213/ = D3112/ for every f e ~<4 >, 30. Let f e ~<m>(£), where E is an open subset of R\". Fix a e E, and suppose x e R\" is so close to O that the points p(t) =a+ tx lie in E whenever O ~ t =:;;; 1. Define h(t) = f(p(t)) for all t e R1 for which p(t) e E. (a) For 1 ::;;: k =:;;; m, show (by repeated application of the chain rule) that h<\">(t) = I: (D11 ... ,k/)(p(t)) X11 ... x,\". The sum extends over all ordered k-tuples (i1, ... , ik) in which each i1 is one of the integers 1, ... , n. (b) By Taylor's theorem (5.15), m-1 h(k)(Q) h<m>(t) h(l) = L k' + ' k•O , m, for some t e (0, 1). Use this to prove Taylor's theorem inn variables by showing that the formula 244 PRINCIPLES OF MATHEMATICAL ANALYSIS m-1 1 /(a+ x) = :E k' L (D,1 .•. 11<.f)(a)x,1 • • • x,1<. + r(x) k.•0 • represents /(a + x) as the sum of its so-called ''Taylor polynomial of degree m - 1,'' plus a remainder that satisfies 1 . r(x) _ 0 iml I - . x-+O X m- l Each of the inner sums extends over all ordered k-tuples (i1, ... , i1<.), as in part (a); as usual, the zero-order derivative off is simply f, so that the constant term of the Taylor polynomial off at a is /(a). (c) Exercise 29 shows that repetition occurs in the Taylor polynomial as written in part (b). For instance, D113 occurs three times, as D113, D131, D311, The sum of the corresponding three terms can be written in the form 3(Df D3/)(a)xf X3. Prove (by calcuJating how often each derivative occurs) that the Taylor polynomial in (b) can be written in the form ~(D~1 ···D!n/)(a) 51 Sn \"-' I I X1 '''Xn• S ••• s 1 • n • Here the summation extends over all ordered n-tuples (s1, ... , sn) such that each s, is a nonnegative integer, and s1 + · · · + sn ::::;; m - 1 . 31. Suppose f e ~< 3 > in some neighborhood of a point a e R 2 , the gradient off is 0 at a, but not all second-order derivatives of/ are O at a. Show how one can then determine from the Taylor polynomial off at a ( of degree 2) whether f has a local maximum, or a local minimum, or neither, at the point a. Extend this to Rn in place of R 2 • INTEGRATION OF DIFFERENTIAL FORMS Integration can be studied on many levels. In Chap. 6, the theory was developed for reasonably well-behaved functions on subintervals of the real line. ln Chap. 11 we shall encounter a very highly developed theory of integration that can be applied to much larger classes of functions, whose domains are more or less arbitrary sets, not necessarily subsets of Rn. The present chapter is devoted to those aspects of integration theory that are closely related to the geometry of euclidean spaces, such as the change of variables formula, line integrals, and the machinery of differential forms that is used in the statement and proof of then-dimensional analogue of the fundamental theorem of calculus, namely Stokes' theorem. INTEGRATION 10.1 Definition Suppose Jk is a k-cell in Rk, consisting of all X = (x1, ... , Xk) such that (1) a-< X· < b- ' - I - I (i = 1, ... , k), 246 PRINCIPLES OF MATHEMATICAL ANALYSIS Ji is the j-cell in Ri defined by the first j inequalities (1), and f is a real con- tinuous function on Jk. Putf =/2, and define/2_ 1 on Jk-l by bk h-1(X1, • • •, xk-1) = h(X1, • •., xk-1, xk) dxk. Ok The uniform continuity of /2 on Jk shows that h-i is continuous on Jk- 1 • Hence we can repeat this process and obtain functions Jj, continuous on 11, such thatiJ_ 1 is the integral ofiJ, with respect to xi, over [aj, b1]. After k steps we arrive at a number Jo, which we call the integral off over Jk; we write it in the form (2) f(x) dx or f. Jk Jk A priori, this definition of the integral depends on the order in which the k integrations are carried out. However, this dependence is only apparent. To prove this, let us introduce the temporary notation L(f) for the integral (2) and L'(f) for the result obtained by carrying out the k integrations in some other order. 10.2 Theorem For every f E ~(Jk), L(f) = L'(f). Proof If h(x) = h1 (x 1) • • • hk(xk), where hi E ~([ai, bi]), then k b1 L(h) = TT hi(xi) dxi = L'(h). i= 1 a1 • lf st/ is tl1e set of all finite sums of such functions h, it follows that L(g) = L'(g) for all g E SIi. Also, SIi is an algebra of functions on Jk to which the Stone-Weierstrass theorem applies. k Put V = TT (bi - ai). ]f fe ~(Jk) and e > 0, there exists g e d such 1 that f - g\\ < e/ V, where If is defined as max lf(x) I (x E Jk). Then IL(f-g)I < e, IL'(f-g)I < e, and since L(f) - L'(f) = L(f - g) + L'(g - f), we conclude that I L(f) - L'(f) I < 2e. In this connection, Exercise 2 is relevant. 10.3 Definition The support of a (real or complex) function f on Rk is the closure of the set of all points x E Rk at which f(x) -:/: 0. If f is a continuous INTEGRATION OF DIFFERENTIAL FORMS 247 function with compact support, let Jk be any k-cell which contains the support off, and define (3) I= f. Rf< Jk The integral so defined is evidently independent of the choice of Jk, provided only that Jk contains the support off. It is now tempting to extend the definition of the integral over Rk to functions which are limits (in some sense) of continuous functions with compact support. We do not want to discuss the conditions under which this can be done; the proper setting for this question is the Lebesgue integral. We shall merely describe one very simple example which will be used in the proof of Stokes' theorem. 10.4 Example Let Qk be the k-simplex which consists of all points x = (x1, ••• , xk) in Rk for which x 1 + · · · + xk:::;; I and x, ~ 0 foi i = I, ... , k. If k = 3, for example, Qk is a tetrahedron, with vertices at 0, e1, e2 , e 3 . If/ e <c(Qk), extend f to a function on Jk by setting /(x) = 0 off Qk, and define (4) I= f. Qk Jk Here Jk is the ''unit cube'' defined by 0 :::;; x, :::;; I ( I :::;; i :::;; k ). Since f may be discontinuous on [k, the existence of the integral on the right of ( 4) needs proof. We also wish to show that this integral is independent of the order in which the k single integrations are carried out. To do this, suppose O < D < 1, put (5) and define (6) Then Fe <c(/k). I (t :::;; 1 - b) () (I - t) <pt = b (l - b < t:::;; l) 0 (l < t), F(x) = cp(x1 + · · · + xk)f(x) Put y = (x1, •.• , xk_ 1), x = (y, xk). For each ye [k- 1, the set of all xk such that F(y, xk) -:/: /(y; xk) is either empty or is a segment whose length does not exceed b. Since O :::;; <p :::;; 1, it follows that (7) 248 PRINCIPLES OF MATHEMATICAL ANALYSIS where If I has the same meaning as in the proof of Theorem 10.2, and Fk-i, h-i are as in Definition 10.1. As~--+ 0, (7) exhibits/2_ 1 as a uniform limit of a sequence of continuous functions. Thus fk- i e ~(/k- l ), and the further integrations present no problem. This proves the existence of the integral (4). Moreover, (7) shows that (8) F(x) dx - /(x) dx I :::; ~ If I. Jk Jk Note that (8) is true, regardless of the order in which the k single integrations are carried out. Since Fe ~(/k), JF is unaffected by any change in this order. Hence (8) shows that the same is true of Jf This completes the proof. Our next goal is the change of variables formula stated in Theorem 10.9. To facilitate its proof, we first discuss so-called primitive mappings, and parti- tions of unity. Primitive mappings will enable us to get a clearer picture of the local action of a ~' -mapping with invertible derivative, and partitions of unity are a very useful device that makes it possible to use local information in a global setting. PRIMITIVE MAPPINGS 10.5 Definition If G maps an open set E c Rn into Rn, and if there is an integer m and a real function g with domain E such that (9) G(x) = L xi ei + g(x)em (x E £), i:il=m then we call G primitive. A primitive mapping is thus one that changes at most one coordinate. Note that (9) can also be written in the form (10) G(x) = X + [g(x) - xmlem. If g is differentiable at some point a e £, so is G. The matrix [ocii] of the operator G'(a) has (11) (D1g)(a), ... , (Dm g)(a), ... , (Dn g)(a) as its mth row. For j-:/: m, we have °'Ji= 1 and °'iJ = 0 if i-:/: j. The Jacobian of G at a is thus given by (12) JG(a) = det[G'(a)] = (Dm g)(a), and we see (by Theorem 9.36) that G'(a) is invertible if and only if (Dm g)(a)-:/: 0. INTEGRATION OF DIFFERENTIAL FORMS 249 10.6 Definition A linear operator B on Rn that interchanges some pair of members of the standard basis and leaves the others fixed will be called a flip. For example, the flip B on R4 that interchanges e2 and e4 has the form (13) B(x1 el+ X2 e2 + X3 e3 + X4e4) = X1 el+ X2 e4 + X3 e3 + X4e2 or, equivalently, (14) B(x1 el+ X2 e2 + X3 e3 + X4e4) = X1 el+ X4e2 + X3 e3 + X2 e4. Hence B can also be thought of as interchanging two of the coordinates, rather than two basis vectors. In the proof that follows, we shall use the projections P0 , ••• , Pn in Rn, defined by PO x = 0 and (15) for 1 :::;; m :::;; n. Thus Pm is the projection whose range and null space are spanned by {e 1 , •.• , em} and {em+i, ... , en}, respectively. 10.7 Theorem Suppose Fis a <i'-mapping of an open set E c Rn into Rn, 0 EE, F(O) = 0, and F'(O) is invertible. Then there is a neighborhood of O in Rn in which a representation (16) F(x) = B · · · B G o • • • o G (x) 1 n-1 n 1 is valid. In (16), eac/1 G i is a primitive CC' -mapping in some neighborhood of O; Gi(O) = 0, G~(O) is invertible, and each Bi is either a flip or the identity operator. Briefly, (16) represents F locally as a composition of primitive mappings and flips. (17) (18) (19) Proof Put F = F 1 • Assume 1 :::;; m :::;; n - 1, and make the following induction hypothesis (which evidently holds form = 1): Vm is a neighborhood of 0, Fm E CC'(Vm) ,Fm(O) = 0, F;,,(O) is invertible, and Pm-lFm(x) = pm-1 X By (17), we have n Fm(x) = Pm_ 1X + L oci(x)ei, wher·e °'m, ... , °'n are real CC'-functions in Vm. Hence n F;,,(O)em = L (Dm c.<1)(0)ei. i=m 250 PRINCIPLES OF MATHEMATICAL ANALYSIS (20) (21) (22) (23) (24) Since F~(O) is invertible, the left side of (19) is not 0, and therefore there is a k such that m :::;; k:::;; n and (Dm ak)(O) -:/: 0. Let Bm be the flip that interchanges m and this k (if k = m, Bm is the identity) and defi11e Then Gm e ~'(Vm), Gm is primitive, and G~(O) is invertible, since (Dm ak)(O) -:/: 0. The inverse function theorem shows therefore that there is an open set um, with O e Um c Vm, such that Gm is a 1-1 mapping of um onto a neighborhood Vm+ 1 of 0, in which G,; 1 is continuously differentiable. Define Fm+l by Then Fm+i e ~'(Vm+ 1), Fm+1(0) = 0, and F~+ 1(0) is invertible (by the chain rule). Also, for x e Um, so that PmFm+ 1(Gm(x)) =PmBmFm(x) = Pm[Pm_1X + ak(x)em + · · ·] =Pm-1X + ak(x)em =PmGm(X) Our induction hypothesis holds therefore with m + 1 in place of m. [In (22), we first used (21), then (18) and the definition of Bm, then the definition of Pm, and finally (20).] Since Bm Bm = I, (21 ), with y = Gm(x), is equivalent to If we apply this with m = 1, ... , n - 1, we successively obtain F=F 1 =B 1F2 °G1 = B1B2 F 3 o G2 o G1 = ... = B1 • • • Bn-1Fn o Gn-1 o • • • o G1 in some neighborhood of 0. By (17), F n is primitive. This completes the proof. INTEGRATION OF DIFFERENTIAL FORMS 251 PARTITIONS OF UNITY 10.8 Theorem Suppose K is a compact subset of Rn, and {Vix} is an open cover of K. Then there exist functions 1/11, ••• , I/ls e <i(Rn) such that (a) 0 =:;I/Ii=:; 1 for 1 ~ i =:; s; (b) each 1/1 i has its support in some Vix, and (c) 1/11(x) + · · · + 1/Js(x) = 1 for every x e K. Because of (c), {I/Ji} is called a partition of unity, and (b) is sometimes expressed by saying that { 1/1 i} is subordinate to the cover { Vix}. Corollary If f e <i(Rn) and the support off lies in K, then s (25) I= I I/Iii• i= 1 Each 1/1 if has its support in some V « • The point of (25) is that it furnishes a representation off as a sum of continuous functions 1/1 if with ''small'' supports. (26) (27) (28) (29) (30) Proof Associate with each x e Kan index a(x) so that x e V«(x). Thetl there are open balls B(x) and W(x), centered at x, with B(x) c W(x) c W(x) c Vix(x). Since K is compact, there are points x 1 , ..• , xs in K such that K c B(x 1) u · · · u B(xs). By (26), there are functions <p1 , ••• , <ps e <i(Rn), such that <p,(x) = 1 on B(xi), <pi(x) = 0 outside W(xi), and O =:; <p,(x) =:; 1 on Rn. Define 1/11 = <p1 and for i = 1, ... , s - 1. Properties (a) and (b) are clear. The relation 1/11 + ... +1/11 = 1 - (1 - ({)1) ••• (1 - <p,) is trivial for i = 1. If (29) holds for some i < s, addition of (28) and (29) yields (29) with i + 1 in place of i. It follows that s s I 1/1 i<x) = 1 - TT [1 - <p1(x)l 1=1 i=l lf x e K, then x e B(x,) for some i, hence <pi(x) = 1, and the product in (30) is 0. This proves (c). 252 PRINCIPLES OF MATHEMATICAL ANALYSIS CHANGE OF VARIABLES We can now describe the effect of a change of variables on a multiple integral. For simplicity, we confine ourselves here to continuous functions with compact support, although this is too restrictive for many applications. This is illustrated by Exercises 9 to 13. 10.9 Theorem Suppose Tis a 1-1 ({J'-mapping of an open set E c Rk into Rk such that J T(x) :;f Of or all x e E. If f is a continuous function on Rk whose support is compact and lies in T(E), then (31) f(y) dy = f(T(x))IJT(x)I dx. Rk Rk We recall that JT is the Jacobian of T. The assumption JT(x) :;f O implies, by the inverse function theorem, that r - 1 is continuous on T (E), and this ensures that the integrand on the right of (31) has compact support in E (Theorem 4.14). The appearance of the absolute value of JT(x) in (31) may call for a com- ment. Take the case k = 1, and suppose Tis a 1-1 ({J'-m2pping of R 1 onto R 1 • Then JT(x) = T'(x); and if Tis increasing, we have (32) f(y) dy = f(T(x))T'(x) dx, R1 R1 by Theorems 6.19 and 6.17, for all continuous/with compact support. But if T decreases, then T'(x) < O; and if f is positive in the interior of its support, the left side of (32) is positive and the right side is negative. A correct equation is obtained if T' is replaced by I T' I in (32). The point is that the integrals we are now considering are integrals of functions over subsets of Rk, and we associate no direction or orientation with these subsets. We shall adopt a different point of view when we come to inte- gration of differential forms over surfaces. Proof It follows from the remarks just made that (31) is true if Tis a primitive ({J'-mapping (see Definition 10.5), and Theorem 10.2 shows that (31) is true if Tis a linear mapping which merely interchanges two coordinates. If the theorem is true for transformationsP, Q, and if S(x) = P(Q(x)), then f (z) dz = f(P(y)) I J p(y) I dy = f(P(Q(x)))IJp(Q(x))I IJa(x)I dx = f(S(x)) I Js(x) I dx, INTEGRATION OF DIFFERENTIAL FORMS 253 • since J p(Q(x))Ja(x) = det P'(Q(x)) det Q'(x) = det P'(Q(x))Q'(x) = det S'(x) = J5(x), by the multiplication theorem for determinants and the chain.rule. Thus the theorem is also true for S. Each point a EE has a neighborhood Uc E in which (33) T(x) = T(a) + B1 • • • Bk_ 1Gk O Gk-t O • • • 0 G1(x-a), where Gi and Bi are as in Theorem 10.7. Setting V = T(U), it follows that (31) holds if the support off lies in V. Thus: Each pointy E T(E) lies in an open set Vy c T(E) such that (31) holds for all continuous functions whose support lies in Vy. Now let/be a continuous function with compact support Kc T(E). Since { Vy} covers K, the Corollary to Theor~m 10.8 shc,vs that f = 'f.1/1 if, where each 1/J i is continuous, and each 1/J i has its support in some Vy• Thus (31) holds for each 1/Jif, and hence also for their sumf DIFFERENTIAL FORMS We shall now develop some of the machinery that is needed for the n-dimen- sional version of the fundamental theorem of calculus which is usually called Stokes' t/1eorem. The original form of Stokes' theorem arose in applications of vector analysis to electromagnetism and was stated in terms of the curl of a vector field. Green's theorem and the divergence theorem are other special cases. These topics are briefly discussed at the end of the chapter. It is a curious feature of Stokes' theorem that the only thing that is difficult about it is the elaborate structure of definitions that are needed for its statement. These definitions concern differential forms, their derivatives, boundaries, and orientation. Once these concepts are understood, the statement of the theorem is very brief and succinct, and its proof presents little difficulty. Up to now we have considered derivatives of functions of several variables only for functions defined in open sets. This was done to avoid difficulties that can occur at boundary points. It will now be convenient, however, to discuss differentiable functions on compact sets. We the ref ore adopt the following convention: To say that f is a <c'-mapping (or a <c''-mapping) of a compact set D c Rk into Rn means that there is a <c'-mapping (or a <c''-mapping) g of an open set W c Rk into Rn such that D c W and such that g(x) = f(x) for all x e D. 254 PRINCIPLES OF MATHEMATICAL ANALYSIS 10.10 Definition Suppose E is an open set in Rn. A k-surface in E is a ({J' - mapping <I> from a compact set D c Rk into E. D is called the parameter domain of <I>. Points of D will be denoted by u = (u1, ••• , uk). We shall confine ourselves to the simple situation in which D is either a k-cell or the k-simplex Qk described in Example 10.4. The reason for this is that we shall have to integrate over D, and we have not yet discussed integration over more complicated subsets of Rk. It will be seen that this restriction on D (which will be tacitly made from now on) entails no significant loss of generality in the resulting theory of differential forms. We stress that k-surfaces in E are defined to be mappings into E, not subsets of E. This agrees with our earlier definition of curves (Definition 6.26). In fact, I-surfaces are precisely the same as continuously differentiable curves. 10.11 Definition Suppose Eis an open set in Rn. A differential form of order k ~ 1 in E (briefly, a k-form in E) is a function w, symbolically represented by the sum (34) (the indices i1 , .•. , ik range independently from 1 to n), which assigns to each k-surface <I> in Ea number w(<I>) = Jcp w, according to the rule cp D U l, ... , Uk where D is the parameter domain of <I>. The functions a; 1 ••• ik are assumed to be real and continuous in E. If </>1 , ... , <Pn are the components of <I>, the Jacobian in (35) is the one determined by the mapping (u 1, •.. , uk) ► (</>i 1(u), ... , </>;k(u)). Note that the right side of (35) is an integral over D, as defined in Defini- tion 10.1 (or Example 10.4) and that (35) is the definition of the symbol J<J> w. A k-form w is said to be of class ({J' or ~'' if the functions ai 1 ••• ik in (34) are all of class ~' or ~''. A 0-form in E is defined to be a continuous function in E. 10.12 Examples (a) Let y be a I-surface (a curve of class ~') in R 3 , with parameter domain [O, 1 ]. Write (x, y, z) in place of (x1 , x 2 , x 3 ), and put w = x dy + ydx. (36) INTEGRATION OF DIFFERENTIAL FORMS 255 Then 1 w = [y1(t)y~(t) +Y2(t)y;(t)] dt = Y1(l)y2(l) - Y1(0)y2(0). y 0 Note that in this example J Y w depends only on the initial point y(O) and on the end point y(l) of y. In particular, JY w = 0 for every closed curve y. (As we shall see later, this is true for every I-form w which is exact.) Integrals of I-forms are often called line integrals. (b) Fix a> 0, b > 0, and define y(t) = (a cost, b sin t) (0 ~ t ~ 2n), so that y is a closed curve in R 2 • (Its range is an ellipse.) Then 21t x dy = ab cos2 t dt = nab, y 0 whereas 21t y dx = - ab sin2 t dt = -nab. y 0 Note that JY x dy is the area of the region bounded by y. This is a special case of Green's theorem. ( c) Let D be the 3-cell defined by 0 ~ r ~ I, 0 ~ 0 ~ n, 0 ~ <p ~ 2n. Define cl>(r, 0, cp) = (x, y, z), where Then Hence x = r sin 0 cos <p y = r sin 0 sin <p z = r cos 0. o(x, y, z) 2 • J'1>(r, 0, <p) = o(r, 0, <p) = r Sill 0. dx Ady A dz= '1> 4n J(J) = -· D 3 Note that cl> maps D onto the closed unit ball of R 3 , that the mapping is 1-1 in the interior of D (but certain boundary points are identified by cl>), and that the integral (36) is equal to the volume of cl>(D). 256 PRINCIPLES OF MATHEMATICAL ANALYSIS 10.13 Elementary properties Let w, w1 , w2 be k-forms in E. We write w1 = w2 if and only if w1(<1>) = w2 (<1>) for every k-surface <I> in E. In particular, w = 0 means that w(<I>) = 0 for every k-surface <I> in E. If c is a real number, then cw is the k-form defined by (37) CW= C W, cp cp and w = w1 + w2 means that for every k-surface <I> in E. As a special case of (37), note that -w is defined so that (39) (-w) = - dw. cp cp Consider a k-form (40) w = a(x) dx. A • · · A dx . 11 lk and let w be the k-form obtained by interchanging some pair of subscripts in ( 40). If (35) and (39) are combined with the fact that a determinant changes sign if two of its rows are interchanged, we see that (41) (42) --W= -W. As a special case of this, note that the anticommutative relation dx- A dx. = -dx- A dx. I J J I holds for all i and j. In particular, (43) dx, A dx. = 0 I I (i= 1, ... , n). More generally, let us return to (40), and assume that i, = is for some r :I: s. If these two subscripts are interchanged, then w = w, hence w = 0, by (41). In other words, if w is given by (40), then w = 0 unless the subscripts i1 , ••• , ik are all distinct. If w is as in (34), the summands with repeated subscripts can therefore be omitted without changing w. It follows that O is the only k-form in any open subset of Rn, if k > 11. The anticommutativity expressed by ( 42) is the reason for the inordinate amount of attention that has to be paid to minus signs when studying differenti[tl forms. INTEGRATION OF DIFFERENTIAL FORMS 257 10.14 Basic k-forms If i1 , ••• , ik are integers such that 1 ~ i1 < i 2 < · · · < ik ~ n, and if/ is the ordered k-tuple {i1, ••• , ik}, then we call / an increasing k-index, and we use the brief notation (44) These forms dx1 are the so-called basic k-forms in Rn. It is not hard to verify that there are precisely n!/k!(n - k)! basic k-forms in Rn; we shall make no use of this, however. Much more important is the fact that every k-form can be represented in terms of basic k-forms. To see this, note that every k-tuple{j1 , ••• ,jk} of distinct integers can be converted to an increasing k-index J by a finite number of inter- changes of pairs; each of these amounts to a multiplication by -1, as we saw in Sec. 10.13; hence (45) where e(j1, ... ,jk) is 1 or -1, depending on the number of interchanges that are needed. In fact, it is easy to see that (46) wheres is as in Definition 9.33. For example, dx 1 A dx 5 A dx 3 A dx 2 = -dx 1 A dx 2 A dx 3 A dx 5 and dx 4 A dx 2 A dx 3 = dx 2 A dx 3 A dx 4 • If every k-tuple in (34) is converted to an increasing k-index, then we obtain the so-called standard presentation of w: (47) w = L b1(x) dx1 . I The summation in (47) extends over all increasing k-indices I. [Of course, every increasing k-index arises from many (from k!, to be precise) k-tuples. Each b 1 in (47) may thus be a sum of several of the coefficients that occur in (34).] For example, x 1 dx 2 A dx 1 - x 2 dx 3 A dx 2 + x 3 dx 2 A dx 3 + dx 1 A dx 2 is a 2-form in R 3 whose standard presentation is (I - x 1 ) dx 1 A dx 2 + (x 2 + x 3) dx 2 A dx 3 • The following uniqueness theorem is one of the main reasons for the introduction of the standard presentation of a k-form. 258 PRINCIPLES OF MATHEMATICAL ANALYSIS 10.lS Theorem Suppose (48) ro = L b1(x) dx1 I is the standard presentation of a k-form ro in an open set E c Rn. If ro = 0 in E, then b1(x) = 0 for every increasing k-index I and for every x E E. Note that the analogous statement would be false for sums such as (34), since, for example, (49) (50) dx 1 A dx 2 + dx 2 A dx 1 = 0. Proof Assume, to reach a contradiction, that b J(v) > 0 for some v e E and for some increasing k-index J = {j1, ••• ,jk}. Since bJ is continuous, there exists h > 0 such that b J(x) > 0 for all x E Rn whose coordinates satisfy Ix, - v, I ~ h. Let D be the k-cell in Rk such that u e D if and only if I url ~ h for r = 1, ... , k. Define k <l>(u) = V + L ureir (u ED). r= 1 Then <I> is a k-surface in E, with parameter domain D, and b J(<l>(u)) > 0 for every u e D. We claim that ro = bJ(<l>(u)) du. cp D Since the right side of (50) is positive, it follows that ro(<I>) #- 0. Hence (50) gives our contradiction. To prove (50), apply (35) to the presentation (48). More specifically, compute the Jacobians that occur in (35). By (49), o(xi1' ... ' Xjk) = 1. O(U1, , , , , Uk) For any other increasing k-index / :;f J, the Jacobian is 0, since it is the determinant of a matrix with at least one row of zeros. 10.16 Products of basic k-forms Suppose (51) / = {i1, ... 'ip}, J = {j1, ... ,jq} where 1 ~ i1 < · · · < iP ~ n and 1 ~j1 < · · · <jq ~ n. The product of the cor- responding basic forms dx1 and dxJ in Rn is a (p + q)-form in Rn, denoted by the symbol dx1 A dxJ, and defined by (52) dx1 A dxJ = dx, 1 A • • • A dx,p A dxi 1 A • • • A dxiq. INTEGRATION OF DIFFERENTIAL FORMS 259 If I and J have an element in common, then the discussion in Sec. 10.13 shows that dx1 A dx1 = 0. If I and J have no element in common, let us write [/, J] for the increasing (p + q)-index which is obtained by arranging the members of I u Jin increasing order. Then dxc1, 11 is a basic (p + q)-form. We claim that (53) dx1 /\\ dxJ = (-1) 11 dxc1, 11 where a is the number of differences jt - i, that are negative. (The number of positive differences is thus pq - a.) To prove (53), perform the following operations on the numbers (54) • • • • 11, • •• , z,;J1, ... ,Jq• Move i, to the right, step by step, until its right neighbor is larger than ;,. The number of steps is the number of subscripts t such that i 1 <j,. (Note that 0 steps are a distinct possibility.) Then do the same for i,_ 1, ••• , i1 • The total number of steps taken is ex. The final arrangement reached is [/, J]. Each step, when applied to the right side of (52), multiplies dx1 A dxJ by -1. Hence (53) holds. Note that the right side of (53) is the standard presentation of dx1 A dx1 • Next, let K = (k1 , ••• , k,) be an increasing ,-index in {1, ... , n}. We shall use (53) to prove that (55) (dx1 A dx1 ) A dxx = dx1 A (dx1 A dxx), If any two of the sets/, J, K have an element in common, then each side of (55) is 0, hence they are equal. So let us assume that /, J, K are pairwise disjoint. Let [/, J, K] denote the increasing (p + q + r )-index obtained from their union. Associate p with the ordered pair (J, K) and y with the ordered pair(/, K) in the way that a was associated with (/, J) in (53). The left side of (55) is then (-1) 11 dxc1, JJ A dxx = (-1) 11 ( - I)P+y dxc1, 1 , KJ by two applications of (53), and the right side of (55) is (- I)P dx1 A dxcJ, Kl= ( - l)P( - l) 11 +y dxc1, 1 , KJ. Hence ( 55) is correct. 10.17 Multiplication Suppose OJ and l are p- and q-forms, respectively, in some open set E c Rn, with standard presentations (56) l = L cJ(x) dx1 J where / and J range over all increasing p-indices and over all increasing q-indices taken from the set {l, ... , n}. 260 PRINCIPLES OF MATHEMATICAL ANALYSIS Their product, denoted by the symbol w A l, is defined to be (57) w A l = L b1(x)c1(x) dx1 A dx1 • 1,J In this sum,/ and J range independently over their possible values, and dx1 A dx1 is as in Sec. 10.16. Thus w A l is a (p + q)-form in E. It is quite easy to see (we leave the details as an exercise) that the distribu- tive laws and w A (l 1 + l 2 ) = (w A l 1) + (w A l 2 ) hold, with respect to the addition defined in Sec. 10.13. If these distributive laws are combined with (55), we obtain the associative law (58) (w A l) A a= w A (,1. A a) for arbitrary forms w, l, a in E. In this discussion it was tacitly assumed that p ~ l and q ~ 1. The product of a 0-formfwith the p-form w given by (56) is simply defined to be the p-form fw = wf = Lf(x)br(x) dx 1• I It is customary to writefw, rather than/ Aw, when/is a 0-form. 10.18 Differentiation We shall now define a differentiation operator d which associates a (k + 1)-form dw to each k-form w of class CC' in some open set Ee Rn. A 0-form of class ({J' in Eis just a real function f e ({J'(E), and we define n (59) df = L (D,f)(x) dx,. i= 1 If w = Ib 1(x) dx 1 is the standard presentation of a k-form w, and b 1 e ({J'(E) for each increasing k-index I, then we define (60) dw = L (db 1) A dx 1 . I 10.19 Example Suppose Eis open in Rn, f e ({J'(E), and y is a continuously differentiable curve in E, with domain [O, l]. By (59) and (35), l n (61) df = L (D,f)(y(t ))y,(t) dt. y O ,_ 1 INTEGRATION OF DIFFERENTIAL FORMS 261 By the chain rule, the last integrand is (f O y)'(t). Hence (62) df = f(y(l)) - f(y(O)), y and we see that J Y df is the same for all y with the same initial point and the same end point, as in (a) of Example 10.12. Comparison with Example 10.12(b) shows therefore that the 1-form x dy is not the derivative of any 0-formf This could also be deduced from part (b) of the following theorem, since d(x dy) = dx A dy # 0. 10.20 Theorem (63) (64) (a) If w and A are k- and m-forms, respectively, of class ({J' in E, then d(w A A)= (dw) A A+ ( - l)k w A dA.. (b) If w is of class~'' in E, then d 2w = 0. Here d 2w means, of course, d(dw). Proof Because of (57) and (60), (a) follows if (63) is proved for the special case w =f dx 1 , where f, g e ({J'(E), dx 1 is a basic k-form, and dxJ is a basic m-form. [If k or m or both are 0, simply omit dx 1 or dxJ in (64); the proof that follows is unaffected by this.] Then w A A = fg dx 1 A dx J. Let us assume that I and J have no element in common. [In the other case each of the three terms in (63) is O.] Then, using (53), d(w A A)= d(fg dx1 A dxJ) =( - l)a. d(fg dxc 1, JJ). By (59), d(fg) = f dg + g df Hence (60) gives d(w A A)= (- l)a. (f dg + g df) A dxc 1, Jl = (gdf + f dg) A dx 1 A dxJ. Since dg is a 1-form and dx 1 is a k-form, we have dg A dx 1 = (-l)kdx 1 A dg, 262 PRINCIPLES OF MATHEMATICAL ANALYSIS by ( 42). Hence d(w A A) = (df A dx 1) A (g dx1) + ( -1)1(/ dx 1) A (dg A dx1) = (dw) Al+(- l)kw A dl, which proves (a). Note that the associative law (58) was used freely. Let us prove ( b) first for a 0-f orm f e CC'' : n d 2f = d L (D1f)(x) dx1 J=l n = L d(D1f) A dx1 J= 1 n = L (D 11f)(x) dx 1 A dx1 • i, }= 1 Since D11f = D11f (Theorem 9.41) and dx 1 A dxJ = -dx 1 A dxi, we see that d 2f = 0. If ro = f dx 1 , as in (64), then dw = (df) A dx 1 • By (60), d(dx 1) = 0. Hence ( 63) shows that 10.21 Change of variables Suppose E is an open set in R\", Tis a CC' -mapping of E into an open set V c R\"', and ro is a k-form in V, whose standard presenta- tion is (65) (We use y for points of V, x for points of E.) Let t 1 , ••• , tm be the components of T: If Y = (Y1, · · ·, Ym) = T(x) then y 1 = t 1(x). As in (59), n (66) dt 1 = L (D1 t 1)(x) dx1 (1 5. i 5. m). J= 1 Thus each dt 1 is a I-form in E. The mapping T transforms w into a k-form wT in E, whose definition is (67) wT = Lb i(T(x)) dt1, A • • • A dt 1\". I In each summand of (67), I= {i1, ... , ik} is an increasing k-index. Our next theorem shows that addition, multiplication, and differentiation off orms are defined in such a way that they commute with changes of variables. INTEGRATION OF DIFFERENTIAL FORMS 263 10.22 Theorem With E and T as in Sec. 10.21, let wand A be k- and m-forms in V, respectively. Then (a) (w + A)T = wT + AT if k = m; (b) (w A A)T = wT A AT; (c) d(wT) = (dw)T if w is of class CC' and Tis of class CC''. Proof Part (a) follows immediately from the definitions. Part (b) is almost as obvious, once we realize that (68) (dyi1 A ••• A dyi,.)T = dti1 A .•. A dti,. (69) (70) regardless of whether {i1 , ••• , ir} is increasing or not; (68) holds because the same number of minus signs are needed on each side of (68) to produce increasing rearrangements. We turn to the proof of (c). If f is a 0-form of class ri' in V, then fT(x) = f(T(x)), df = L (Dif)(y) dyi. i By the chain rule, it follows that d(fT) = L (DifT)(x) dxi • J = LL (Dif)(T(x))(Di ti)(x) dxi J i = L (Dif)(T(x)) dti • J = (df)T- If dy 1 = dyi 1 A · · · A dyik, then (dy 1)T = dti 1 A · · · A dtik, and Theorem 10.20 shows that d((dy 1)T) = 0. (This is where the assumption Te CC'' is used.) Assume now that w = f dy 1 • Then WT= fT(x) (dy r)T and the preceding calculations lead to d(wT) = d(fT) A (dy 1)T = (df)T A (dy 1)T = ((df) A dy r)T = (dw)T. The first equality holds by (63) and (70), the second by (69), the third by pa.rt (b), and the last by the definition of dw. The general case of (c) follows from the special case just proved, if we apply (a). This completes the proof. 264 PRINCIPLES OF MATHEMATICAL ANALYSIS Our next objective is Theorem 10.25. This will follow directly from two other important transformation properties of differential forms, which we state first. 10.23 Theorem Suppose T is a CC' -mapping of an open set E c Rn into an open set V c R\"', S is a CC' -mapping of V into an open set W c RP, and w is a k-form in W, so that Ws is a k-form in V and both (ros)T and WsT are k-forms in E, where ST is defined by (ST)(x) = S(T (x)). Then (71) (ros)T = WsT. Proof If ro and J. are forms in W, Theorem 10.22 shows that ((ro A J.)s)T = (ros A As)T = (ros)T A (J.s)T and (ro A A)sT = WsT A AsT. Thus if (71) holds for ro and for J., it follows that (71) also holds for ro Al. Since every form can be built up from 0-forms and I-forms by addition and multiplication, and since (71) is trivial for 0-forms, it is enough to prove (71) in the case ro = dzq, q = 1, ... , p. (We denote the points of E, V, W by x, y, z, respectively.) Let t1 , •.• , tm be the components of T, let s1 , ... , sP be the compo- nents of S, and let r1 , ••. , r P be the components of ST. If ro = dzq, then Ws = dsq = L (D1sq)(y) dy1, • J so that the chain rule implies (ros)T = L (D1sq)(T(x)) dt1 J = L (D1sq)(T(x)) L (Di t1)(x) dx, J i = L (Dirq)(x) dxi = drq = WsT. i 10.24 Theorem Suppose w is a k-form in an open set E c Rn, <I> is a k-surface in E, with parameter domain D c Rk, and Ll is the k-surface in Rk, with parameter domain D, defined by Ll(u) = u(u e D). Then CO = W111. II> I!,. Proof We need only consider the case ro = a(x) dxi 1 A · · · A dx,k. (72) INTEGRATION OF DIFFERENTIAL FORMS 265 If </>1 , ••• , <Pn are the components of <I>, then ro111 = a(<l>(u)) d<f, 11 A • • • A d<f,ik. The theorem will follow if we can show that d<f,i 1 A • • • A d<f, 1k = J(u) du1 A • • • A duk, where since (72) implies w = a(<l>(u))J(u) du Ill D -- a(<l>(u))J(u) du1 A • • · A duk = w 111 • A A Let [A] be the k by k matrix with entries (p,q= I, ... ,k). Then d</>ip = L a.(p, q) duq q so that d</>, 1 A • • • A d<f, 1k = L a.(I, q1) • • • a.(k, qk) duq 1 A • • • A duqk. In this last sum, q1, ••• , qk range independently over 1, ... , k. The anti- commutative relation ( 42) implies that duq 1 A • • • A duqk = s(q1 , ••• , qk) du1 A • • • A duk, wheres is as in Definition 9.33; applying this definition, we see that d<f,i 1 A • • • A d</>,k = det [A] du1 A • • • A duk ; and since J(u) = det [A], (72) is proved. The final result of this section combines the two preceding theorems. 10.25 Theorem Suppose T is a CC' -mapping of an open set E c Rn into an open set V c Rm, <I> is a k-surface in E, and w is a k-form in V. Then 266 PRINCIPLES OF MATHEMATICAL ANALYSIS Proof Let D be the parameter domain of <I> (hence also of T<I>) and define Ll as in Theorem I 0.24. Then (J) = (J)T(I) = (wT)(I) = WT• T(I) 6 6 (I) The first of these equalities is Theorem 10.24, applied to T<I> in place of <I>. The second follows from Theorem 10.23. The third is Theorem 10.24, with roT in place of ro. SIMPLEXES AND CHAINS 10.26 Affine simplexes A mapping f that carries a vector space X into a vector space Y is said to be affine if f - f(O) is linear. In other words, the require- ment is that (73) f(x) = f(O) + Ax for some A e L(X, Y). An affine mapping of Rk into Rn is thus determined if we know f(O) and f(ei) for I :::;; i:::;; k; as usual, {e1, ... , ek} is the standard basis of Rk. We define the standard simplex Qk to be the set of all u e Rk of the form (74) k u = '°' oc-e-Li I I i= 1 such that °'i ~ 0 for i = I, ... , k and I:oci:::;; 1. Assume now that Po, p1 , ••• , Pk are points of Rn. The oriented affine k-simplex (75) <1 = [Po, P1, • • •, Pk] is defined to be the k-surf ace in Rn with parameter domain Qk which is given by the affine mapping k (76) <1(oc1e1 + · · · + °'k ek) = Po + L oci(P1 - Po), Note that <1 is characterized by (77) and that (78) <1(0) =Po, <1(u) =Po+ Au 1= 1 (for I :::;; i :::;; k), where A e L(Rk, Rn) and Ae 1 = p 1 - Po for 1 :::;; i :::;; k. INTEGRATION OF DIFFERENTIAL FORMS 267 We call <1 oriented to emphasize that the ordering of the vertices p0 , •.. , Pk is taken into account. If (79) where {i0 , i1 , .•. , ik} is a permutation of the ordered set {O, 1, ... , k}, we adopt the notation (80) wheres is the function defined in Definition 9.33. Thus ii= ±<1, depending on whether s = I or s = - I. Strictly speaking, having adopted (75) and (76) as the definition of <1, we should not write ii= <1 unless i0 = 0, ... , ik = k, even if s(i0 , ••• , ik) = I; what we have here is an equivalence relation, not an equality. However, for our purposes the notation is justified by Theorem 10.27. If ii= 8<1 (using the above convention) and if 8 = 1, we say that ii and <1 have the same orientation; if 8 = -1, ii and <1 are said to have opposite orienta- tions. Note that we have not defined what we mean by the ''orientation of a simplex.'' What we have defined is a relation between pairs of simplexes having the same set of vertices, the relation being that of ''having the same orientation.'' There is, however, one situation where the orientation of a simplex can be defined in a natural way. This happens when n = k and when the vectors Pi - Po (1 ~ i ~ k) are independent. In that case, the linear transformation A that appears in (78) is invertible, and its determinant (which is the same as the Jacobian of <1) is not 0. Then <1 is said to be positively (or negatively) oriented if det A is positive (or negative). In particular, the simplex [O, e1, ... , ek] in Rk, given by the identity mapping, has positive orientation. So far we have assumed that k ~ 1. An oriented 0-simplex is defined to be a point with a sign attached. We write <1 = +p 0 or <1 = - Po. If <1 = 8p 0 ( 8 = ± 1) and if f is a 0-f orm (i.e., a real function), we define f = 8/(Po), (I 10.27 Theorem If <1 is an oriented rectilinear k-simplex in an open set E c: Rn and if ii = 8<1 then (81) w=8 w (I for every k-form w in E. Proof For k = 0, (81) follows from the preceding definition. So we assume k ~ 1 and assume that u is given by (75). 268 PRINCIPLES OF MATHEMATICAL ANALYSIS Suppose 1 ~ j ~ k, and suppose a is obtained from <1 by inter- changing Po and p1 . Then e = -1, and a(u) = p1 + Bu (u e Qk), where B is the linear mapping of Rk into Rn defined by Be1 = Po - p1 , Bei = Pi - p1 if i =I=}. If we write Aei = xi (1 ~ i ~ k), where A is given by (78), the column vectors of B (that is, the vectors Bei) are If we subtract the jth column from each of the others, none of the deter- minants in (35) are affected, and we obtain columns x 1, ... , x1_ 1, -x 1 , x1+ 1 , ... , xk. These differ from those of A only in the sign of the }th column. Hence (81) holds for this case. Suppose next that O < i <j ~ k and that a is obtained from <1 by interchanging Pi and p1 . Then a(u) =Po+ Cu, where C has the same columns as A, except that the ith and jth columns have been inter- changed. This again implies that (81) holds, since e = -1. The general case follows, since every permutation of {O, 1, ... , k} is a composition of the special cases we have just dealt with. 10.28 Affine chains An affine k-chain r in an open set E c: Rn is a collection of finitely many oriented affine k-simplexes <11 , ••• , <1 r in E. These need not be distinct; a simplex may thus occur in r with a certain multiplicity. If r is as above, and if w is a k-form in E, we define r (82) W= L w. r i=l 111 We may view a k-surface <I> in E as a function whose domain is the collec- tion of all k-forms in E and which assigns the number J111 w to w. Since real- valued functions can be added (as in Definition 4.3), this suggests the use of the notation (83) r = 0'1 + . • • + O'r or, more compactly, (84) to state the fact that (82) holds for every k-form w in E. To avoid misunderstanding, we point out explicitly that the notations introduced by (83) and (80) have to be handled with care. The point is that every oriented affine k-simplex a in Rn is a function in two ways, with different domains and different ranges, and that therefore two entirely different operations INTEGRATION OF DIFFERENTIAL FORMS 269 of addition are possible. Originally, a was defined as an Rn-valued function with domain Qk; accordingly, a 1 + a2 could be interpreted to be the function <1 that assigns the vector <11(u) + <12(u) to every u e Qk; note that <1 is then again an oriented affine k-simplex in Rn! This is not what is meant by (83). For example, if <12 = -<11 as in (80) (that is to say, if <11 and <12 have the same set of vertices but are oppositely oriented) and if r = u1 + <12 , then Jr w = 0 for all w, and we may express this by writing r = 0 or <11 + <12 = 0. This does not mean that <11(u) + <12(u) is the null vector of Rn. 10.29 Boundaries For k ~ 1, the boundary of the oriented affine k-simplex <1 = [Po, P1, ···,Pk] is defined to be the affine (k - 1)-chain k (85) 0<1 = L (- l)i[Po, • • •, Pj-1, Pi+t, •••,Pk]. j=O For example, if <1 = [p0 , p1, p2 ], then 0<1 = [P1, P2l - [Po, P2l + [Po, P1l = [Po, P1l + [P1, P2l + [P2, Pol, which coincides with the usual notion of the oriented boundary of a triangle. For 1 sj s k, observe that the simplex <1i = [p0 , ... , Pi- 1 , Pi+ 1, ... , Pk] which occurs in (85) has Qk- l as its parameter domain and that it is defined by (86) <1i(u)=p0 +Bu (ueQk- 1), where Bis the linear mapping from Rk-l to Rn determined by Bei = Pi - Po (if 1 s i sj- 1), Bei = Pi+1 - Po (if J s is k - 1). The simplex <10 = [P1, P2, ··,,Pk], which also occurs in (85), is given by the mapping <1o(u) = P1 + Bu, where Bei = Pi+l - p1 for 1 sis k - I. 10.30 Differentiable simplexes and chains Let T be a ~''-mapping of an open set E c Rn into an open set V c Rm; T need not be one-to-one. If <1 is an oriented affine k-simplex in E, then the composite mapping <I> = T O <1 (which we shall sometimes write in the simpler form T<1) is a k-surface in V, with parameter domain Qk. We call <I> an oriented k-simplex of class~''. 270 PRINCIPLES OF MATHEMATICAL ANALYSIS A finite collection q, of oriented k-simplexes <1>1 , ... , <l>r of class ri'' in V is called a k-chain of class ri'' in V. If w is a k-form in V, we define r (87) w=I: w 'I' i= 1 q,; and use the corresponding notation q, = l:<I> i • If r = l:ai is an affine chain and if <l>i = T O ai, we also write q, = T O r, or (88) The boundary o<I> of the oriented k-simplex <I> = T O a is defined to be the (k - 1) chain (89) a<1> = T(o<1). In justification of (89), observe that if T is affine, then <I> = To <1 is an oriented affine k-simplex, in which case (89) is not a matter of definition, but is seen to be a consequence of (85). Thus (89) generalizes this special case. It is immediate that o<I> is of class ri'' if this is true of <I>. Finally, we define the boundary aq, ot· the k-chain q, = l:<I> i to be the (k - 1) chain (90) aq, = I: a<1>i. 10.31 Positively oriented boundaries So far we have associated boundaries to chains, not to subsets of Rn. This notion of boundary is exactly the one that is most suitable for the statement and proof of Stokes' theorem. However, in applications, especially in R 2 or R 3 , it is customary and convenient to talk about ''oriented boundaries'' of certain sets as well. We shall now describe this briefly. Let Qn be the standard simplex in Rn, let <10 be the identity mapping with domain Qn. As we saw in Sec. 10.26, <10 may be regarded as a positively oriented n-simplex in Rn. Its boundary 0<10 is an affine (n - 1)-chain. This chain is called the positively oriented boundary of the set Qn. For example, the positively oriented boundary of Q 3 is [e1, e2 , e3 ] - [O, e2 , e3 ] + [O, e1 , e3 ] - [O, e1 , e2 ]. Now let T be a 1-1 mappi11g of Qn into Rn, of class ri'', whose Jacobian is positive (at least in the interior of Qn). Let E = T(Qn). By the inverse function theorem, E is the closure of an open subset of Rn. We define the positively oriented boundary of the set E to be the (n - 1 )-chain ar = T(o<10), and we may denote this (n - 1)-chain by oE. INTEGRATION OF DIFFERENTIAL FORMS 271 An obvious question occurs here: If E = T1(Q\") = T 2(Q\"), and if both T1 and T2 have positive Jacobians, is it true that oT1 = oT2 ? That is to say, does the equality hold for every (n - 1)-form w? The answer is yes, but we shall omit the proof. (To see an example, compare the end of this section with Exercise 17.) One can go further. Let .Q = E 1 u · · · u Er, where Ei = Ti(Q\"), each Ti has the properties that Thad above, and the interiors of the sets Ei are pairwise disjoint. Then the (n - 1)-chain oT1 + · · · + oTr = o!l is called the positively oriented boundary of n. For example, the unit square 12 in R 2 is the union of e11(Q 2) and e12(Q 2 ), where Both e11 and e12 have Jacobian 1 > 0. Since we have oe11 = [e1 , e2 ] - [0, e2 ] + [O, e1 ], oe12 = [e2 , e1 ] - [e 1 + e2 , e1] + [e1 + e 2 , e2 ]; The sum of these two boundaries is o/ 2 = [O, e1 ] + [e1, e1 + e2] + [e1 + e2, e2] + [e2, O], the positively oriented boundary of 12 • Note that [e1 , e2 ] canceled [e2 , e1 ]. If <I> is a 2-surface in Rm, with parameter domain / 2, then <I> (regarded as a function on 2-forms) is the same as the 2-chain <I> o 0'1 + <I> o 0'2. Thus o<I> = o(<I> 0 C11) + 8(<1> 0 0'2) = <l>(8e11) + <l>(oe12 ) = <1>(81 2). In other words, if the parameter domain of <I> is the square 12 , we need not refer back to the simplex Q2 , but can obtain o<I> directly from o/2 • Other examples may be found in Exercises 17 to 19. 272 PRINCIPLES OF MATHEMATICAL ANALYSIS 10.32 Example For O ~ u ~ n, 0 ~ v ~ 2n, define ~(u, v) = (sin u cos v, sin u sin v, cos u). Then ~ is a 2-surface in R 3 , whose parameter domain is a rectangle D c R 2 , and whose range is tl1e unit sphere in R 3 • I ts boundary is where a~ = ~(oD) = 1'1 + Y2 + '}'3 + '}'4 '}'1 (u) = ~(u, 0) = (sin u, 0, cos u), '}' 2(v) = ~(n, v) = (0, 0, -1), y3(u) = ~(n - u, 2n) = (sin u, 0, -cos u), y4(v) = ~(O, 2n - v) = (O, 0, 1), • with [O, n] and [O, 2n] as parameter intervals for u and v, respectively. Since y2 and y4 are constant, their derivatives are 0, hence the integral of any I-form over y2 or y4 is 0. [See Example l.12(a).] Since y3(u) = y1(n - u), direct application of (35) shows that W=- W )I 3 )I I for every I-form w. Thus Jar w = 0, and we conclude that a~= 0. (In geographic terminology, 8~ starts at the north pole N, runs to the south pole S along a meridia11, pauses at S, returns to N along the same meridian, and finally pauses at N. The two passages along the meridian are in opposite directions. The corresponding two line integrals the ref ore cancel each other. In Exercise 32 there is also one curve which occurs twice in the boundary, but without cancellation.) STOKES' THEOREM 10.33 Theorem If 'P is a k-chain of class ~ 11 in an open set V c Rm and if w is a (k - 1 )-form of class ~' in V, then (91) dw= w. 'I' o'l' The case k = m = I is nothing but the fundamental theorem of calculus (with an additional differentiability assumption). The case k = m = 2 is Green's theorem, and k = m = 3 gives the so-called ''divergence theorem'' of Gauss. The case k = 2, m = 3 is the one originally discovered by Stokes. (Spivak's INTEGRATION OF DIFFERENTIAL FORMS 273 book describes some of the historical background.) These special cases will be discussed further at the end of the present chapter. (92) (93) (94) (95) (96) Proof It is enough to prove that dOJ = OJ for every oriented k-simplex <I> of class ~'' in V. For if (92) is proved and if 'P = l:<1>1, then (87) and (89) imply (91). Fix such a <I> and put u = [O, e1 , ... , ek]. Thus u is the oriented affine k-simplex with parameter domain Qk which is defined by the identity mapping. Since <I> is also defined on Qk (see Definition 10.30) and <I> e ~'', there is an open set E c Rk which contains Qk, and there is a ~''-mapping T of E into V such that <I>= T O u. By Theorems 10.25 and 10.22(c), the left side of (92) is equal to Ta t1 t1 Another application of Theorem 10.25 shows, by (89), that the right side of (92) is OJ = OJ = OJT . o(Ta) T(oa) oa Since OJT is a (k - 1)-form in E, we see that in order to prove (92) we merely have to show that d).. = ;,_ t1 0(1 for the special simplex (93) and for every (k - 1 )-form ).. of class ~' in E. If k = I, the definition of an oriented 0-simplex shows that (94) merely asserts that 1 f'(u) du= f(l) - /(0) 0 for every continuously differentiable function f on [O, 1 ], which is true by the fundamental theorem of calculus. From now on we assume that k > I, fix an integer r (1 ~ r ~ k), and choose/ e ~'(£). It is then enough to prove (94) for the case /4=/(x)dx 1 /\\ •·• /\\ dx,_ 1 I\\ dx,+ 1 I\\··· I\\ dxk since every (k - 1)-form is a sum of these special ones, for r = I, ... , k. 274 PRINCIPLES OF MATHEMATICAL ANALYSIS (97) (98) (99) (100) (101) (102) By (85), the boundary of the simplex (93) is where k 8u=[e 1, ••• ,ek]+ I(-1) 1 -rt i= 1 for i = 1, ... , k. Put Note that -r0 is obtained from [e1 , ... , ek] by r - 1 successive interchanges of e, and its left neighbors. Thus k 8u=(-1)'- 1to+ I(-1) 1-ri. i= 1 Each -r I has Qk- 1 as parameter domain. If x = -r0(u) and u e Qk-i, then ui xi= l-(u 1 +···+uk-1) (1 :5.} < r), (j = r), ui-1 (r <} :5. k). If 1 :5. i :5. k, u e Qk- J, and x = -r 1(u), then ui X· = 0 J (1 :$.} < i), u = i), (i <} :5. k). For O ~ i ~ k, let J 1 be the Jacobian of the mapping induced by -r1• When i = 0 and when i = r, (98) and (99) show that (100) is the identity mapping. Thus J0 = 1, J, = 1. For other i, the fact that xi = 0 in (99) shows that J1 has a row of zeros, hence J1 = 0. Thus (i ¥= 0, i ¥= r), by (35) and (96). Consequently, (97) gives l = ( - 1 )' - 1 l + ( - 1 )' l 0(1 ~o ~r = ( - l)r-1 [/( -r0(u)) - /(-r,(u))] du. (103) INTEGRATION OF DIFFERENTIAL FORMS 275 On the other hand, so that d). = (D,f)(x)dx, I\\ dx 1 I\\ · · • I\\ dx,_ 1 I\\ dx,+ 1 I\\ · · • I\\ dxk = ( -1)'- 1(D,f)(x) dx 1 I\\ • · • I\\ dxk d). = ( -1)'- 1 (D,f)(x) dx. a Qk We evaluate (103) by first integrating with respect to x,, over the interval [O, 1 - (x1 + · · · + x,_ 1 + x,+ 1 + · · · + xk)], put (x1, •.. , x,_ 1, x,+ 1, ••• , xk) = (u1, •.• , uk_ 1), and see with the aid of (98) that the integral over Qk in (103) is equal to the integral over Qk- i in (102). Thus (94) holds, and the proof is complete. CLOSED FORMS AND EXACT FORMS 10.34 Definition Let w beak-form in an open set E c Rn. If there is a (k - 1)- f orm ). in E such that w = d)., then w is said to be exact in E. If w is of class ~, and dw = 0, then w is said to be closed. Theorem 10.20(b) shows that every exact form of class ~, is closed. In certain sets E, for example in convex ones, the converse is true; this is the content of Theorem 10.39 (usually known as Poincare's lemma) and Theorem 10.40. However, Examples 10.36 and 10.37 will exhibit closed forms that are not exact. 10.35 Remarks (104) (105) (a) Whether a given k-form w is or is not closed can be verified by simply differentiating the coefficients in the standard presentation of w. For example, a I-form n w = Lfi(x) dxi, i= 1 with fie~'(£) for some open set E c Rn, is closed if and only if the equations hold for all i, j in {I, ... , n} and for all x e E. 276 PRINCIPLES OF MATHEMATICAL ANALYSIS Note that (105) is a ''pointwise'' condition,; it does not involve any global properties that depend on the shape of E. On the other hand, to show that ro is exact in E, one has to prove the existence of a form l, defined in E, such that dl = ro. This amounts to solving a system of partial differential equations, not just locally, but in all of E. For example, to show that (104) is exact in a set E, one has to find a function (or 0-form) g e ct'(E) such that (106) (D 1g)(x) = f 1(x) (x e E, 1 ~ i ~ n). (107) (108) (109) Of course, (105) is a necessary condition for the solvability of (106). (b) Let robe an exact k-form in E. Then there is a (k - 1)-form A in E with dl = ro, and Stokes' theorem asserts that ro = dl = l 'I' 'I' for every k-chain 'P of class ct'' in E. If 'P1 and 'P2 are such chains, and if they have the same boundaries, it follows that In particular, the integral of an exact k-f orm in E is O over every k-chain in E whose boundary is 0. As an important special case of this, note that integrals of exact I-forms in E are O over closed (differentiable) curves in E. (c) Let ro be a closed k-form in E. Then dro = 0, and Stokes' theorem asserts that ro = dro = 0 'I' for every (k + 1)-chain 'P of class ct'' in E. In other words, integrals of closed k-forms in E are O over k-chains that are boundaries of (k + 1 )-chains in E. (d) Let 'P be a (k + 1)-chain in E and let A be a (k - 1)-form in E, both of class ct''. Since d 2 A= 0, two applications of Stokes' theorem show that oo'I' o'I' 'I' We conclude that 82'P = 0. In other words, the boundary of a boundary is 0. See Exercise 16 for a more direct proof of this. 10.36 Example I-form (110) INTEGRATION OF DIFFERENTIAL FORMS 277 Let E = R 2 - {O}, the plane with the origin removed. The x dy-y dx 11 = x2 + y2 is closed in R2 - {O}. This is easily verified by differentiation. Fix r > 0, and define (111) y(t) = (r cos t, r sin t) (0 ~ t ~ 2n). Then y is a curve (an ''oriented I-simplex'') in R2 - {O}. Since y(O) = y(2n), we have (112) ay = o. Direct computation shows that (113) 17 = 2n =I= 0. y The discussion in Remarks 10.35(b) and (c) shows that we can draw two conclusions from (113): First, 17 is not exact in R 2 - {O}, for otherwise (112) would force the integral (113) to be 0. Secondly, y is not the boundary of any 2-chain in R2 - {O} ( of class ~''), for otherwise the fact that 17 is closed would force the integral (113) to be 0. 10.37 Example Let E = R 3 - {O}, 3-space with the origin removed. Define (114) C = x dy \" dz + y dz I\\ dx + z dx I\\ dy (x2 + y2 + z2)3'2 where we have written (x, y, z) in place of (x1, x 2 , x 3). Differentiation shows that dC = 0, so that C is a closed 2-form in R 3 - {O}. Let :I: be the 2-chain in R3 - {O} that was constructed in Example 10.32; recall that :I: is a parametrization of the unit sphere in R 3 • Using the rectangle D of Example 10.32 as parameter domain, it is easy to compute that (115) C = sin u du dv = 4n =I= 0. D As in the preceding example, we can now conclude that C is not exact in R 3 - {O} (since o:I: = 0, as was shown in Example 10.32) and that the sphere :I: is not the boundary of any 3-chain in R 3 - {O} ( of class ~''), although 81: = O. The following result will be used in the proof of Theorem 10.39. 278 PRINCIPLES OF MATHEMATICAL ANALYSIS 10.38 Theorem Suppose Eis a convex open set in Rn,f e ~'(E),p is an integer, 1 5: p 5: n, and (116) (p <j 5: n, XE£). Then there exists an Fe ~'(£) such that (117) (DpF)(x) =/(x), (DiF)(x) = 0 (p < j 5: n, X E £). Proof Write x = (x', xp, x''), where X 1 = (X1, ... , Xp-1), X 11 = (Xp+t, ... , Xn). (When p = 1, x' is absent; when p = n, x'' is absent.) Let V be the set of all (x', xp) e RP such that (x', xP, x'') e £ for some x''. Being a projection of E, Vis a convex open set in RP. Since Eis convex and (116) holds, f (x) does not depend on x''. Hence there is a function <p, with domain V, such that /(x) = <p(x', xp) for all x e £. If p = 1, V is a segment in R 1 (possibly unbounded). Pick c e V and define x1 F(x) = <p(t) dt (XE£). C If p > 1, let V be the set of all x' e Rp-t such that (x', xp) e V for some x P. Then V is a convex open set in RP- 1, and there is a function oc e ~'(U) such that (x', oc(x')) e V for every x' e V; in other words, the graph of oc lies in V (Exercise 29). Define Xp F(x) = <p(x', t) dt (XE£). ix(x') In either case, F satisfies (117). (Note: Recall the usual convention that f! means - f: if b < a.) 10.39 Theorem If E c Rn is convex and open, if k ~ 1, if w is a k-form of class~' in E, and if dw = 0, then there is a (k - 1)-form A in E such that w = d).. (118) Briefly, closed forms are exact in convex sets. Proof For p = 1, ... , n, let YP denote the set of all k-forms w, of class ~' in £, whose standard presentation w = Ifr<_x) dx 1 I does not involve dx p+ 1 , ••• , dxn. In other words, I c {l, ... , p} if/ /._x) #- 0 for some x e £. (119) (120) (121) (122) (123) INTEGRATION OF DIFFERENTIAL FORMS 279 We shall proceed by induction on p. Assume first that roe Y1 • Then ro =/(x) dx 1 • Since dro = 0, (D1f)(x) = 0 for 1 <j Sn, x e E. By Theorem 10.38 there is an Fe <I'(£) such that D 1F=/and D1F= 0 for 1 <jS n. Thus dF = (D1F)(x) dx 1 = /(x) dx 1 = ro. Now we take p > 1 and make the following induction hypothesis: E'very closed k-form that belongs to Yp-l is exact in E. Choose roe YP so that dro = 0. By (118), n L L (D1f I)(x) dx1 A dx I= dw = 0. I J= 1 Consider a fixed j, with p <j s n. Each / that occurs in (118) lies in {l, ... , p}. If 11, / 2 are two of these k-indices, and if / 1 ::/= 12 , then the (k + !)-indices (/1,j), (/2 ,j) are distinct. Thus there is no cancellation, and we conclude from (119) that every coefficient in (118) satisfies (xeE,p <jSn). We now gather those terms in (118) that contain dxP and rewrite ro in the form ro = oc + Lf I(x) dx 10 A dxP, Io where ex e Yp-t, each / 0 is an increasing (k - 1)-index in {l, ... , p - l}, and / = (/0 , p). By (120), Theorem 10.38 furnishes functions F 1 e <i'(E) such that (p <j Sn). Put and define y = ro - ( - l)k- t dp. Since pis a (k - 1)-form, it follows that p Y = ro - I I (D1 F1)(x) dx 10 A dx1 lo J= 1 p-1 = oc - I I (D1F1)(x) dx 10 A dx1 , Io J= 1 which is clearly in Yp-l• Since dro = 0 and d 2P = 0, we have dy = 0. Our induction hypothesis shows the ref ore that y = dµ for some (k - 1)-form µ in E. If A.=µ+ (-I)k-tp, we conclude that ro = dA.. By induction, this completes the proof. 280 PRINCIPLES OF MATHEMATICAL ANALYSIS 10.40 Theorem Fix k, 1 ~ k ~ n. Let E c Rn be an open set in which every closed k-form is exact. Let T be a 1-1 CC''-mapping of E onto an open set V c Rn whose inverse S is also of class CC''. Then every closed k-form in Vis exact in V. Note that every convex open set E satisfies the present hypothesis, by Theorem 10.39. The relation between E and V may be expressed by saying that they are CC''-equivalent. Thus every closedform is exact in any set which is CC''-equivalent to a convex open set. - Proof Let ro be a k-form in V, witp dro = 0. By Theorem 10.22(c), roT is a k-form in E for which d(roT) = 0. Hence roT = d). for some (k - 1)-form ). in E. By Theorem 10.23, and another application of Theorem 10.22(c), ro = (roT)s = (d).)s = d().s). Since As is a (k - 1)-form in V, ro is exact in V. 10.41 Remark In applications, cells (see Definition 2.17) are often more con- venient parameter domains than simplexes. If our whole development had been based on cells rather than simplexes, the computation that occurs in the proof of Stokes' theorem would be even simpler. (It is done that way in Spivak's book.) The reason for preferring simplexes is that the definition of the boundary of an oriented simplex seems easier and more natural than is the case for a cell. (See Exercise 19.) Also, the partitioning of sets into simplexes (called ''tri~ngu- lation'') plays an important role in topology, and there are strong connections between certain aspects of topology, on the one hand, and differential forms, on the other. These are hinted at in Sec. 10.35. The book by Singer anq Thorpe contains a good introduction to this topic. Since every cell can be triangulated, we may regard it as a chain. For dimension 2, this was done in Example 10.32; for dimension 3, see Exercise 18. Poincare's lemma (Theorem 10.39) can be proved in several ways. See, for example, page 94 in Spivak's book, or page 280 in Fleming's. Two simple proofs for certain special cases are indicated in Exercises 24 and 27. VECTOR ANALYSIS We conclude this chapter with a few applications of the preceding material to theorems concerning vector analysis in R 3 • These are special cases of theorems about differential forms, but are usually stated in different terminology. We are thus faced with the job of translating from one language to another. INTEGRATION OF DIFFERENTIAL FORMS 281 10.42 Vector fields Let F = F1 e1 + F2 e2 + F 3 e3 be a continuous mapping of an open set E c R3 into R3 • Since F associates a vector to each point of E, F is sometimes called a vector field, especially in physics. With every such F is associated a I-form (124) and a 2-form (125) ro, = F1 dy\" dz+ F2 dz\" dx + F 3 dx I\\ dy. Here, and in the rest of this chapter, we use the customary notation (x, y, z) in place of (x1, x 2 , x 3). It is clear, conversely, that every I-form A in Eis l, for some vector field Fin E, and that every 2-form ro is ro, for some F. In R3 , the study of I-forms and 2-forms is thus coextensive with the study of vector fields. If u e ~'(£) is a real function, then its gradient Vu= (D1u)e1 + (D 2 u)e2 + (D 3 u)e3 is an example of a vector field in E. Suppose now that Fis a vector field in E, of class ~ 1 • Its curl V x Fis the vector field defined in E by V x F = (D 2F3 - D 3 F 2)e1 + (D 3 F1 - D1F 3)e2 + (D 1F2 - D 2 F1)e3 and its divergence is the real function V · F defined in E by V · F = D 1F1 + D2 F2 + D 3 F3 • These quantities have various physical interpretations. We refer to the book by 0. D. Kellogg for more details. Here are some relations between gradients, curls, and divergences. 10.43 Theorem Suppose E is an open set in R3, u e ~''(£), and G is a vector field in E, of class C11• (a) Jf F = Vu, then V x F = 0. (b) If F = V x G, then V · F = 0. Furthermore, if E is ~''-equivalent to a convex set, then (a) and (b) have converses, in which we assume that F is a vector field in E, of class ~': (a 1 ) If V x F = 0, then F = Vu for some u e ~ 11(£). (b 1 ) /fV · F = 0, then F = V x Gfor some vector field Gin E, of class ~ 11 Proof If we compare the definitions of Vu, V x F, and V · F with the differential forms A, and ro, given by (124) and (125), we obtain the following four statements: 282 PRINCIPLES OF MATHEMATICAL ANALYSIS F=Vu if and only if ;., = du. VxF=O if and only if dJ., = 0. F=VxG if and only if m, =dlc, V · F=O if and only if dm, = 0. Now if F = Vu, then Ji.,= du, hence dJ., = d 2u = 0 (Theorem 10.20), which means that V x F = 0. Thus (a) is proved. As regards (a'), the hypothesis amounts to saying that dJ., = 0 in E. By Theorem 10.40, Ji.,= du for some 0-form u. Hence F = Vu. The proofs of (b) and (b') follow exactly the same pattern. 10.44 Volume elements The k-form dx1 A • • • A dxk is called the volume element in Rk. It is often denoted by dV (or by dVk if it seems desirable to indicate the dimension explicitly), and the notation (126) f (x) dx1 A • • • A dxk = f dV ~ ~ is used when <I> is a positively oriented k-surface in Rk and f is a continuous function on the range of <I>. The reason for using this terminology is very simple: If D is a parameter domain in Rk, and if <I> is a 1-1 <G' -mapping of D into Rk, with positive Jacobian J~, then the left side of (126) is f(<l>(u))J~(u) du= f(x) dx, D ~(D) by (35) and Theorem 10.9. In particular, when/= 1, (126) defines the volume of <I>. We already saw a special case of this in (36). The usual notation for dV2 is dA. 10.45 Green's theorem Suppose Eis an open set in R 2, a e <t'(E), Pe <t'(E), and Q is a closed subset of E, with positively oriented boundary oO, as described in Sec. 10.31. Then (127) (a dx + P dy) = Dn ap orx -- dA. n ox oy (128) INTEGRATION OF DIFFERENTIAL FORMS 283 Proof Put A= a dx + p dy. Then dA. = (D 2 a) dy A dx + (D 1P) dx Ady = (D1P - D2a) dA, and (127) is the same as A= dA., on n which is true by Theorem 10.33. With a(x, y) = -y and P(x, y) = x, (127) becomes ½ (x dy - y dx) = A(O), on the area of 0. With a= 0, P = x, a similar formula is obtained. Example 10.12(b) con- tains a special case of this. 10.46 Area elements in R3 Let <I> be a 2-surface in R 3, of class <G', with pa- rameter domain D c: R2 • Associate with each point (u, v) e D the vector (129) o(y, z) o(z, x) o(x, y) N(u, v) = o(u, v) e1 + o(u, v) e2 + o(u, v) e3. The Jacobians in (129) correspond to the equation (130) (x, y, z) = <l>(u, v). If f is a continuous function on <l>(D), the area integral off over <I> is defined to be (131) f dA = f(<l>(u, v)) I N(u, v) I du dv. 11) D In particular, when/= 1 we obtain the area of <I>, namely, (132) A(<l>) = I N(u, v)I du dv. D The following discussion will show that (131) and its special case (132) are reasonable definitions. It will also describe the geometric features of the vector N. Write <I>= <p1e1 + <p2 e2 + <p3 e3 , fix a point p0 = (u0 , v0 ) e D, put N = N(p0), put (133) a,= (Di <p,)(po), P, = (D 2 <p1)(p0 ) (i = 1, 2, 3) 284 PRINCIPLES OF MATHEMATICAL ANALYSIS and let Te L(R2 , R3) be the linear transformation given by 3 (134) T(u, v) = L (cxi u + Pi v)e1 • i= i Note that T = <I>' (p0), in accordance with Definition 9 .11. Let us now assume that the rank of Tis 2. (If it is 1 or 0, then N = 0, and the tangent plane mentioned below degenerates to a line or to a point.) The range of the affine mapping (u, v) > <l>(p0) + T(u, v) is then a plane Il, called the tangent plane to <I> at p0 . [One would like to call Il the tangent plane at <l>(p0), rather than at p0 ; if <I> is not one-to-one, this runs into difficulties.] If we use (133) in (129), we obtain (135) N = (cx2 P3 - OC3 P2)ei + (oc3 Pi - cx1P3)e2 + (oc1P2 - CX2 Pi)e3, and (134) shows that (136) 3 Tei = L ociei, i= 1 3 Te2 = L Piei • i= i A straightforward computation now leads to (137) Hence N is perpendicular to II. It is therefore called the normal to <I> at p0 . A second property of N, also verified by a direct computation based on (135) and (136), is that the determinant of the linear transformation of R3 that takes { ei, e2 , e3} to {Te1, Te 2 , N} is I N 12 > 0 (Exercise 30). The 3-simplex (138) • is thus positively oriented. The third property of N that we shall use is a consequence of the first two: The above-mentioned determinant, whose value is IN j 2, is the volume of the parallelepiped with edges [O, Tei], [O, Te2 ], [O, N]. By (137), [O, N] is perpen- dicular to the other two edges. The area of the parallelogram with vertices (139) is the ref ore I N j • This parallelogram is the image under T of the unit square in R2. If E is any rectangle in R2 , it follows (by the linearity of T) that the area of the parallelogram T(E) is (140) A(T(E)) = IN I A(E) = I N(u0 , v0 ) I du dv. E INTEGRATION OF DIFFERENTIAL FORMS 285 We conclude that(l32)is correct when <I> is affine. To justify the definition (132) in the general case, divide D into small rectangles, pick a point (u 0 , v0 ) in each, and replace <I> in each rectangle by the corresponding tangent plane. The sum of the areas of the resulting parallelograms, obtained via (140), is then an approximation to A(<I>). Finally, one can justify (131) from (132) by approxi- mating f by step functions. 10.47 Example Let O <a< b be fixed. Let K be the 3-cell determined by 0 ~ t ~ a, The equations (141) 0 ~ u ~ 2n, 0 ~ V ~ 2n. X = t COS U y = (b + t sin u) cos v z = (b + t sin u) sin v describe a mapping q, of R 3 into R 3 which is 1-1 in the interior of K, such that \\J:'(K) is a solid torus. Its Jacobian is o(x, y, z) . Jq, = o( ) = t(b + t sin u) t, U, V which is positive on K, except on the face t = 0. If we integrate Jq, over K, we obtain as the volume of our solid torus. Now consider the 2-chain <I>= o\\J:1. (See Exercise 19.) q, maps the faces u = 0 and u = 2n of K onto the same cylindrical strip, but with opposite orienta- tions. q, maps the faces v = 0 and v = 2n onto the same circular disc, but with opposite orientations. q, maps the face t = 0 onto a circle, which contributes 0 to the 2-chain o\\J:1. (The relevant Jacobians are 0.) Thus <I> is simply the 2-surface obtained by setting t = a in (141), with parameter domain D the square defined by O ~ u ~ 2n, 0 ~ v ~ 2n. According to (129) and (141), the normal to <I> at (u, v) E D is thus the vector N(u, v) = a(b + a sin u)n(u, v) where n(u, v) = (cos u)e1 + (sin u cos v)e2 + (sin u sin v)e3 • 286 PRINCIPLES OF MATHEMATICAL ANALYSIS Since ln(u, v)I = 1, we have IN(u, v)I = a(b + a sin u), and if we integrate this over D, (131) gives A(<l>) = 4n 2ab as the surface area of our torus. If we think of N = N(u, v) as a directed line segment, pointing from <l>(u, v) to <l>(u, v) + N(u, v), then N points outward, that is to say, away from \\J:'(K). This is so because Jq, > 0 when t = a. For example, take u = v = n/2, t = a. This gives the largest value of z on \\J:'(K), and N = a(b + a)e3 points ''upward'' for this choice of (u, v). 10.48 Integrals of 1-forms in R 3 Let y be a ~' -curve in an open set E c R 3 , with parameter interval [O, 1 ], let F be a vector field in E, as in Sec. I 0.42, and define Ji., by (124). The integral of Ji., over y can be rewritten in a certain way which we now describe. For any u e [O, l], y'(u) = y{(u)e 1 + y~(u)e2 + y3(u)e3 is called the tangent vector to y at u. We define t = t(u) to be the unit vector in the direction of y'(u). Thus y'(u) = I y'(u) I t(u). [If y'(u) = 0 for some u, put t(u) = e1 ; any other choice would do just as well.] By (35), 1 Fi(y(u))y;(u) du 0 1 (142) -- F(y(u)) · y'(u) du 0 1 -- F(y(u)) · t(u) I y'(u) I du. 0 Theorem 6.27 makes it reasonable to call I y'(u) I du the element of arc length along y. A customary notation for it is ds, and (142) is rewritten in the form (143) 'I 'I Since tis a unit tangent vector to y, F ·tis called the tangential component of F along y. INTEGRATION OF DIFFERENTIAL FORMS 287 The right side of (143) should be regarded as just an abbreviation for the last integral in (142). Tl1e point is that F is defined on the range of y, butt is defined on [O, 1]; thus F • t has to be properly interpreted. Of course, when y is one-to-one, then t(u) can be replaced by t(y(u)), and this difficulty disappears. 10.49 Integrals of 2-forms in R 3 Let <I> be a 2-surface in an open set E c: R 3 , of class ~', with parameter domain D c: R 2 • Let F be a vector field in E, and define wF by (125). As in the preceding section, we shall obtain a different representation of the integral of wF over <I>. By (35) and (129), wF = (F1 dy A dz + F2 dz A dx + F 3 dx A dy) cJ) cJ) -- (F1 o <I>) o(y, z) + (F 2 o <I>) o(z, x) + (F 3 o <I>) o(x, y) du dv D o(U, V) o(u, v) O(U, V) -- F(<I>(u, v)) · N(u, v) du dv. D Now let n = n(u, v) be the unit vector in the direction of N(u, v). [If N(u, v) = 0 for some (u, v) E D, take n(u, v) = e1.] Then N = IN In, and there- fore the last integral becomes F(<I>(u, v)) · n(u, v) I N(u, v) I du dv. D By ( 131 ), we can finally write this in the form (144) With regard to the meaning of F · n, the remark made at the end of Sec. 10.48 applies here as well. We can now state the original form of Stokes' theorem. 10.50 Stokes' formula If Fis a vector field of class~' in an open set E c: R 3 , and if <I> is a 2-surface of class ~,, in E, then (145) (146) (V x F) • n dA = (F · t) ds. cJ> ocJ> Proof Put H = V x F. Then, as in the proof of Theorem 10.43, we have We= d).F. 288 PRINCIPLES OF MATHEMATICAL ANALYSIS Hence (V x F) • n dA = (H · n) dA = w8 ~ ~ ~ -- (F · t) ds. 0~ Here we used the definition of H, then (144) with H in place of F, then (146), then-the main step-Theorem 10.33, and finally (143), extended in the obvious way from curves to I-chains. 10.51 The divergence theorem If F is a vector field of class <c' in an open set E c: R 3 , and if n is a closed subset of E with positively oriented boundary o!l (as described in Sec. 10.31) then (147) (V • F) dV = (F · n) dA. n an Proof By (125), dw, = (V · F) dx A dy A dz = (V · F) dV. Hence .. (V · F) dV = dw, = w, = (F · n) dA, n n an an by Theorem 10.33, applied to the 2-form w,, and (144). EXERCISES 1. Let H be a compact convex set in Rk, with nonempty interior. Let f E CC(H), put f(x) = 0 in the complement of H, and define f Hf as in Definition 10.3. Prove that f n f is independent of the order in which the k integrations are carried out. Hint: Approximate f by functions that are continuous on Rk and whose supports are in H, as was done in Example 10.4. 2. For i = 1, 2, 3, ... , let cp, E CC(R1 ) have support in (2-', 21 - 1 ), such that f cp, = 1. Put 00 f(x,y)='E [cp,(x)- <p1+1(x)]cp,(y) I= 1 Then f has compact support in R 2 , f is continuous except at (0, O), and dy f(x, y) dx = 0 but dx f(x, y) dy = 1. Observe that/ is unbounded in every neighborhood of (0, 0). INTEGRATION OF DIFFERENTIAL FORMS 289 3. (a) If Fis as in Theorem 10.7, put A= F'(O), F1(x) = A- 1F(x). Then F1(0) = /. Show that F1(x) = Gn O Gn-1 0 ''' 0 G1(X) in some neighborhood of 0, for certain primitive mappings G1, ... , Gn. This gives another version of Theorem 10.7: F(x) = F'(O)Gn o Gn -1 o • • • o G1 (x). (b) Prove that the mapping (x, y) > (y, x) of R 2 onto R 2 is not the composition of any two primitive mappings, in any neighborhood of the origin. (This shows that the flips B, cannot be omitted from the statement of Theorem 10.7.) 4. For (x, y) e R 2 , define F(x, y) = (ex cosy - 1, ex sin y). Prove that F = G2 o G1, where G1(x, y) = (ex cosy - 1, y) G2(u, v) = (u, (1 + u) tan v) are primitive in some neighborhood of (0, 0). Compute the Jacobians of G1, G2, Fat (0, 0). Define H2(x, y) = (x, ex sin y) and find H1(u, v) = (h(u, v), v) so that F = H1 o H2 is some neighborhood of (0, 0). S. Formulate and prove an analogue of Theorem 10.8, in which K is a compact subset of an arbitrary metric space. (Replace the functions cp, that occur in the proof of Theorem 10.8 by functions of the type constructed in Exercise 22 of Chap. 4.) 6. Strengthen the conclusion of Theorem 10.8 by showing that the functions if,, can be made differentiable, and even infinitely differentiable. (Use Exercise 1 of Chap. 8 in the construction of the auxiliary functions cp, .) 7. (a) Show that the simplex Qk is the smallest convex subset of Rk that contains O,e1,,,.,ek. (b) Show that affine mappings take convex sets to convex sets. 8. Let H be the parallelogram in R 2 whose vertices are (1, 1), (3, 2), (4, 5), (2, 4). Find the affine map T which sends (0, 0) to (1, 1), (1, 0) to (3, 2), (0, 1) to (2, 4). Show that Jr= 5. Use T to convert the integral ex= ex->1 dx dy H to an integral over 12 and thus compute ex. 290 PRINCIPLES OF MATHEMATICAL ANALYSIS 9. Define (x, y) = T(r, 0) on the rectangle 0 ~r ~a, by the equations X = r COS 0, y = r sin 0. Show that T maps this rectangle onto the closed disc D with center at (0, 0) and radius a, that Tis one-to-one in the interior of the rectangle, and that Jr(r, 0) = r. If f e fl(D), prove the formula for integration in polar coordinates: II 2ff f(x, y) dx dy = f(T(r, 0))r dr d0. D O O Hint: Let Do be the interior of D, minus the interval from (0, 0) to (0, a). As it stands, Theorem 10.9 applies to continuous functions/ whose support lies in Do. To remove this restriction, proceed as in Example 10.4. 10. Let a ➔ oo in Exercise 9 and prove that co 2111 f(x, y) dx dy = f(T(r, 0})r dr d0, .R2 0 0 for continuous functions f that decrease sufficiently rapidly as Ix I + I y I ► oo. (Find a more precise formulation.) Apply this to f(x, y) = exp (-x 2 - y 2 ) to derive formula (101) of Chap. 8. 11. Define (u, v) = T(s, t) on the strip 0 <s < oo, O<t<l by setting u = s - st, v = st. Show that Tis a 1-1 mapping of the strip onto the positive quadrant Qin R 2 • Show that Jr(s, t) = s. For x > 0, y > 0, integrate over Q, use Theorem 10.9 to convert the integral to one over the strip, and derive formula (96) of Chap. 8 in this way. (For this application, Theorem 10.9 has to be extended so as to cover certain improper integrals. Provide this extension.) 12. Let Jk be the set of all u = (u1, ... , uk) e Rk with O ~ u1 ~ l for all i; let Q\" be the set of all x = (x1, ... , xk) e Rk with x, ~ 0, I:x, ~ 1. (Jk is the unit cube; Qk is the standard simplex in Rk.) Define x = T(u) by Xi= U1 X2 = (1 - U1)U2 • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • Xk = (l - U1) ••• (1 - Uk-1)Uk. INTEORATlON OF DIFFERENTIAL FORMS 291 Show that Show that T maps I\" onto Q\", that Tis 1-1 in the interior of I\", and that its inverse Sis defined in the interior of Q\" by u1 = Xi and X1 u,=------- l-x1-···-x1-1 for i = 2, ... , k. Show that Jr(U) = (} - U1)\"- 1(l - U2)\"- 2 ''' (} - Ut-1), and Js(X) = [(l - X1)(l - Xi - X2) • •' (1 - Xi - • • • - Xt-1)]- 1. 13. Let r1, ••• , '\" be nonnegative integers, and prove that r ' ... r ' , 1 '\" d 1 • \". Xi ···x\" x=------- Qk (k + r1 + · · · + r1r.) ! Hint: Use Exercise 12, Theorems 10.9 and 8.20. Note that the special case r1 = · • · = '\" = 0 shows that the volume of Q\" is 1/k !. 14. Prove formula (46). 15. If w and ,\\ are k- and m-forms, respectively, prove that w I\\,\\ =(-l)\"m,\\ /\\ w. 16. If k z 2 and u = [Po, Pi, ... , Pt] is an oriented affine k-simplex, prove that 0 2 u = 0, directly from the definition of the boundary operator o. Deduce from this that o 2'Y = O for every chain 'Y. Hint: For orientation, do it first fork= 2, k = 3. In general, if i <i, let u,1 be the (k - 2)-simplex obtained by deleting p, and p1 from u. Show that each u,1 occurs twice in o 2 u, with opposite sign. 17. Put J 2 = T1 + T2, where T1 = [O, e1, e1 + e2], Explain why it is reasonable to call J 2 the positively oriented unit square in R 2 • Show that 0J 2 is the sum of 4 oriented affine I-simplexes. Find these. What is 0(7'1 - 7'2)? 18. Consider the oriented affine 3-simplex in R 3 • Show that u1 (regarded as a linear transformation) has determinant 1. Thus u1 is positively oriented. 292 PRINCIPLES OF MATHEMATICAL ANALYSIS Let CJ 2 , ••• , CJ 6 be five other oriented 3-simplexes, obtained as follows: There are five permutations (i1, i2, i3) of (1, 2, 3), distinct from (1, 2, 3). Associate with each (i1, i2, i3) the simplex wheres is the sign that occurs in the definition of the determinant. (This is how -r2 was obtained from T1 in Exercise 17.) Show that CJ2, ••• , CJ6 are positively oriented. Put J 3 = CJ1 + · · · + CJ6. Then J 3 may be called the positively oriented unit cube in R 3 • Show that 8J 3 is the sum of 12 oriented affine 2-simplexes. (These 12 tri- angles cover the surface of the unit cube / 3,) Show that x = (xi, X2, X3) is in the range of CJ1 if and only if O ~ X3 ~ X2 :::;:;; X 1 :::::;: 1 , Show that the ranges of CJ1, ••• , CJ6 have disjoint interiors, and that their unic,n covers / 3 • (Compare with Exercise 13; note that 3 ! = 6.) 19. Let J 2 and J 3 be as in Exercise 17 and 18. Define Boi(u, v) = (0, u, v), Bo2(u, v) = (u, 0, v), Bo3(U, v) = (u, v, 0), These are affine, and map R 2 into R 3 • B11(u, v) = (1, u, v), B12(u, v) = (u, 1, v), B13(u, v) = (u, v, 1). Put f3,1 = B,1(J2), for r = 0, 1, i = 1, 2, 3. Each f3,1 is an affine-oriented 2-chain. (See Sec. 10.30.) Verify that 3 0J 3 = I: (-1)1(/301 - /311), I= 1 in agreement with Exercise 18. 20. State conditions under which the formula I dw = fw - (df) I\\ w • a• • is valid, and show that it generalizes the formula for integration by parts. Hint: d(fw) = (df) I\\ w + I dw. 21. As in Example 10.36, consider the 1-form xdy-ydx 1J = Xl + yl in R 2 - {O}. (a) Carry out the computation that leads to formula (113), and prove that d71 = 0. (b) Let y(t) = (r cost, r sin t), for some r > 0, and let r be a <tfn-curve in R 2 - {O}, INTEGRATION OF DIFFERENTIAL FORMS 293 with parameter interval [O, 21r], with r(O) = I'(21r), such that the intervals [y(t), I'(t)] do not contain O for any t e [O, 21r]. Prove that TJ = 21r. r Hint: For Os;: t:::;; 21r, 0:::;; u:::;; 1, define tl>(t, u) = (1 - u) I'(t) + uy(t). Then tI> is a 2-surface in R 2 - {O} whose parameter domain is the indicated rect- angle. Because of cancellations (as in Example 10.32), ett> = r - y. Use Stokes' theorem to deduce that because dTJ = 0. (c) Take r(t) = (a cost, b sin t) where a> 0, b > 0 are fixed. Use part (b) to show that (d) Show that 2n ab 0 2 2 b2 • 2 dt = 21r. a cos t + sin t y TJ = d arc tan- x in any convex open set in which x =I= 0, and that X TJ = d - arc tan - y in any convex open set in which y =I= 0. Explain why this justifies the notation TJ = d0, in spite of the fact that TJ is not exact in R 2 - {0}. (e) Show that (b) can be derived from (d). (/) If r is any closed <c' -curve in R 2 - {0}, prove that 1 TJ = Ind(r). 27T r (See Exercise 23 of Chap. 8 for the definition of the index of a curve.) 294 PRINCIPLES OF MATHEMATICAL ANALYSIS 22. As in Example 10.37, define { in R 3 - {0} by { = x dy I\\ dz + y dz I\\ dx + z dx I\\ dy rl where r = (x 2 + y 2 + z2 ) 112 , let D be the rectangle given by O:::;: u ~ 1r, 0 s v ~ 21r, and let ~ be the 2-surface in R 3 , with parameter domain D, given by • • • x = sin u cos v, y = sin u sin v, z = cos u. (a) Prove that d{ = 0 in R 3 - {O}. (b) Let S denote the restriction of~ to a parameter domain E c D. Prove that { = sin u du dv = A(S), $ E where A denotes area, as in Sec. 10.43. Note that this contains (115) as a special case. (c) Suppose g, hi, h2, h3, are <tf''-functions on [O, 1], g > 0. Let (x, y, z) = tl>(s, t) define a 2-surface tt>, with parameter domain / 2 , by x = g(t)hi(s), Prove that directly from (35). • Note the shape of the range of tI>: For fixed s, tl>(s, t) runs over an interval on a line through 0. The range of tI> thus lies in a ''cone'' with vertex at the origin. (d) Let Ebe a closed rectangle in D, with edges parallel to those of D. Suppose / E <tf\"(D),/> 0. Let n be the 2-surface with parameter domain E, defined by O(u, v) = f(u, v) ~ (u, v). Define Sas in (b) and prove that (Since S is the ''radial projection'' of n into the unit sphere, this result makes it reasonable to call J n{ the ''solid angle'' subtended by the range of .0 at the origin.) Hint: Consider the 3-surface 'Y given by 'Y(t, u, v) = [1 - t + tf(u, v)] ~ (u, v), where (u, v) EE, 0 st s 1. For fixed v, the mapping (t, u) > 'Y(t, u, v) is a 2-sur- INTEGRATION OF DIFFERENTIAL FORMS 295 face tI> to which {c) can be applied to show that J ~, = 0. The same thing holds when u is fixed. By (a) and Stokes' theorem, (e) Put ,\\ = - (z/r)11, where xdy-ydx 'TJ = x2 + y2 , as in Exercise 21. Then,\\ is a 1-form in the open set V c R 3 in which x 2 + y 2 > 0. Show that , is exact in V by showing that '= d,\\. {/) Derive (d) from (e), without using (c). Hint: To begin with, assume O < u < 1T on E. By (e), and ,\\, n s ~s Show that the two integrals of,\\ are equal, by using part (d) of Exercise 21, and by noting that z/r is the same at ~(u, v) as at O(u, v). {g) Is , exact in the complement of every line through the origin? 23. Fix n. Define rk = (xf + · · · + x~) 112 for 1 s ks n, let Ek be the set of all x E Rn at which rk > 0, and let wk be the (k - 1)-form defined in Ek by k wk = (rk) - k L ( -1 )1 - 1 x, dx 1 /\\ • • • /\\ dx, - 1 /\\ dx, + 1 /\\ • • • /\\ dxk . I= 1 Note that w2 = 'T/, W3 = ,, in the terminology of Exercises 21 and 22. Note also that E1 C E2 C • • • C En= R\" - {0}. (a) Prove that dwk = 0 in Ek. (b) Fork= 2, ... , n, prove that wk is exact in Ek_ 1, by showing that wk= d(fkwk-1) = (d/k) /\\ Wk-1, where /k(x) = (- l)k gk(xk/rk) and and t (1 - s2)<k- J>12 ds -1 Hint: fk satisfies the differential equations X '(v'/k)(X) = 0 (-1 <t< 1). 296 PRINCIPLES OF MATHEMATICAL ANALYSIS (c) Is Wn exact in En? (d) Note that (b) is a generalization of part (e) of Exercise 22. Try to extend some of the other assertions of Exercises 21 and 22 to wn, for arbitrary n. 24. Let w =~a,(x) dx, be a 1-form of class re'' in a convex open set E c R\". Assume dw = 0 and prove that w is exact in E, by completing the following outline: Fix p E £. Define /(x)= w (XE£). [P,X] Apply Stokes' theorem to affine-oriented 2-simplexes [p, x, y] in E. Deduce that n 1 /(y) - /(x) = L (y, - X1) a,((1 - t)x + ty) dt I= 1 0 for x EE, y E £. Hence (D,/)(x) = a,(x). 25. Assume that w is a 1-form in an open set E c R\" such that w=O for every closed curve yin E, of class CC'. Prove tl1at w is exact in E, by imitating part of the argument sketched in Exercise 24. 26. Assume w is a 1-form in R 3 - {0}, of class CC' and dw =0. Prove that w is exact in R 3 - {0}. Hint: Every closed continuously differentiable curve in R 3 - {O} is the boundary of a 2-surface in R 3 - {0}. Apply Stokes' theorem and Exercise 25. 27. Let Ebe an open 3-cell in R 3 , with edges parallel to the coordinate axes. Suppose (a, b, c) E E,f, E CC'(£) for i = 1, 2, 3, w =/1 dy /\\dz+ /2 dz/\\ dx + /3 dx /\\ dy, and assume that dw = 0 in E. Define where % 1 gi(x, y, z) = f2(x, y, s) ds - f3(X, t, c) dt C b % U2(x, y, z) = - /1(x, y, s) ds, C for (x, y, z) E £. Prove that d'A =win E. Evaluate these integrals when w = , and thus find the form A that occurs in part (e) of Exercise 22. INTEGRATION OF DIFFERENTIAL FORMS 297 28. Fix b > a > 0, define tl>(r, 0) = (r cos 0, r sin 0) for a:::;; r:::;; b, 0:::;: 0:::;; 21r. (The range of <I> is an annulus in R 2 .) Put w = x 3 dy, and compute both dw and w to verify that they are equal. 29. Prove the existence of a function IX with the properties needed in the proof of Theorem 10.38, and prove that the resulting function F is of class CC'. (Both assertions become trivial if E is an open cell or an open ball, since IX can then be taken to be a constant. Refer to Theorem 9.42.) 30. If N is the vector given by (135), prove that IX1 /31 IX.2/33 - IX3/32 det IX2 /32 1X3/31 - 1X1/33 = IN I 2 • IX3 /33 IX1/32 - IX2/31 Also, verify Eq. (137). 31. Let E c: R 3 be open, suppose g E ~''(£), h E CC''(£), and consider the vector field F =g \"v h. (a) Prove that v' · F = g v' 2h + (v'g) · (\"vh) where v' 2h = v' · (v'h) = \"£,8 2h/oxf is the so-called ''Laplacian'' of h. (b) If n is a closed subset of E with positively oriented boundary en (as in Theorem 10.51), prove that [g \"v 2h + (v'g) · (v'h)]dV = n oh g 0 dA \"\" n where (as is customary) we have written oh/on in place of (\"vh) · n. (Thus oh/on is the directional derivative of h in the direction of the outward normal to en, the so-called normal derivative of h.) Interchange g and h, subtract the resulting formula from the first one, to obtain n oh -hdg d'\" g on on .tt. \"\" These two formulas are usually called Green's identities. (c) Assume that h is harmonic in E; this means that v' 2h = 0. Take g = 1 and con- clude that oh 0 dA = 0. \"\" n 298 PRINCIPLES OF MATHEMATICAL ANALYSIS Take g = h, and conclude that h = O inn if h = 0 on 80. (d) Show that Green's identities are also valid in R 2 • 32. Fix S, 0 < S < 1. Let D be the set of all (0, t) E R 2 such that O :S: 0 :S: 1r, -8 :S: t :S: S. Let <I> be the 2-surface in R 3 , with parameter domain D, given by x = (1 - t sin 0) cos 20 y = (1 - t sin 0) sin 20 z = t cos 0 where (x, y, z) = '1>(0, t). Note that <l>(1r, t) = '1>(0, - t), and that <I> is one-to-one on the rest of D. The range M = <l>(D) of '1> is known as a Mobius band. It is the simplest example of a nonorientable surface. Prove the various assertions made in the following description: Put Pi= (0, -S), P2 = (1r, -S), p3 = (1r, S), p4 = (O, S), Ps = P1, Put y, =[Pi, p, +1], i = 1, ... , 4, and put r, = <I> o y,. Then 8<1> = r 1 + r 2 + r 3 + r 4 • Put a= (1, 0, -S), b = (1, 0, S). Then and 8'1> can be described as follows. r1 spirals up from a to b; its projection into the (x, y)-plane has winding number + 1 around the origin. (See Exercise 23, Chap. 8.) r2 = [b, a]. r 3 spirals up from a to b; its projection into the (x, y) plane has winding number -1 around the origin. r4 = [b, a]. Thus 8<1> = I'1 + r3 + 2I'2. If we go from a to b along r1 and continue along the ''edge'' of M until we return to a, the curve traced out is which may also be represented on the parameter interval [O, 21r] by the equations x = (1 + S sin 0) cos 20 y = (1 + S sin 0) sin 20 z= -Scos 0. It should be emphasized that r i=- 8<1>: Let TJ be the 1-form discussed in Exercises 21 and 22. Since dTJ = 0, Stokes' theorem shows that TJ = 0. INTEGRATION OF DIFFERENTIAL FORMS 299 But although r is the ''geometric'' boundary of M, we have TJ = 41r. r In order to avoid this possible source of confusion, Stokes' formula (Theorem 10.50) is frequently stated only for orientable surfaces tl>. THE LEBESGUE THEORY It is the purpose of this chapter to present the fundamental concepts of the Lebesgue theory of measure and integration and to prove some of the crucial theorems in a rather general setting, without obscuring the main lines of the development by a mass of comparatively trivial detail. Therefore proofs are only sketched in some cases, and some of the easier propositions are stated without proof. However, the reader who has become familiar with the tech- niques used in the preceding chapters will certainly find no difficulty in supply- ing the missing steps. The theory of the Lebesgue integral can be developed in several distinct ways. Only one of these methods will be discussed her~. For alternative procedures we refer to the more specialized treatises on integration listed in the Bibliography. SET FUNCTIONS If A and B are any two sets, we write A - B for the set of all elements x such that x e A, x ¢ B. The notation A - B does not imply that B c A. We denote the empty set by 0, and say that A and B are disjoint if A n B = 0. THE LEBESGUE THEORY 301 11.1 Definition A family f7t of sets is called a ring if A e f7t and Be f7t implies (1) (2) Au BE f7i, A - Be f7t. Since A n B = A - (A - B), we also have A n B e f7t if f7t is a ring. A ring f7t is called a <1-ring if whenever An E f7t (n = I, 2, 3, ... ). Since 00 00 • n An = Ai - LJ (A 1 - An), n=l n=l we also have if PA is a a-ring. 11.2 Definition We say that </> is a set function defined on PA if</> assigns to every A e f7t a number </>(A) of the extended real number system. </> is additive if A n B = 0 implies (3) </>(A u B) = </>(A) + </>(B), and </> is countably additive if Ai n Ai = 0 (i '# }) implies 00 00 (4) <P U An = L </>(An). n= 1 n= 1 We shall always assume that the range of</> does not contain both + oo and - oo; for if it did, the right side of (3) could become meaningless. Also, we exclude set functions whose only value is + oo or - oo. It is interesting to note that the left side of ( 4) is independent of the order in which the An's are arranged. Hence the rearrangement theorem shows that the right side of (4) converges absolutely if it converges at all; if it does not converge, the partial sums tend to + oo, or to - oo. (5) (6) If </> is additive, the following properties are easily verified: </>(O) = 0. </>(A1 u · · · uAn) = </>(A1) + · · · + </>(An) if Ai n Ai= 0 whenever i-::/; J. 302 PRINCIPLES OF MATHEMATICAL ANALYSIS (7) q,(A1 u A2) + </>(A1 n A2) = </>(A1) + q,(A2), If q,(A) ~ 0 for all A, and A 1 c A 2 , then (8) </>(A1) ;$; </>(A2), Because of (8), nonnegative additive set functions are often called monotonic. (9) </>(A - B) = </>(A) - q,(B) if B c A, and I (q,B)I < + oo. 11.3 Theorem Suppose q> is countably additive on a ring Bl. Suppose An e Bl (n = 1, 2, 3, ... ), A 1 c A 2 c A 3 c ···,A e Bl, and Then, as n ~ oo, Proof Put B1 = A 1 , and Bn=An-An-1 (n = 2, 3, ... ). Then Bi nBi = 0 for i \"#),An= B1 u · · · u Bn, and A= UBn. Hence n q>(An) = L </>(Bi) i= 1 and 00 </>(A) = I </>(Bi). i= 1 CONSTRUCTION OF THE LEBESGUE MEASURE 11.4 Definition Let RP denote p-dimensional euclidean space. By an interval in RP we mean the set of points x = (x1 , ••• , xp) such that (10) a-<x-<b- ' - I - I (i = 1, ... , p), or the set of points which is characterized by (10) with any or all of the ~ signs replaced by <. The possibility that ai = b, for any value of i is not ruled out; in particular, the empty set is included among the intervals. THE LEBESGUE THEORY 303 If A is the union of a finite number of intervals, A is said to be an elemen- tary set. If / is an interval, we define no matter whether equality is included or excluded in any of the inequalities (10). (11) If A = 11 u · · · u In, and if these intervals are pairwise disjoint, we set mCA) = mCI1) + · · · + mCin). We let <ff denote the family of all elementary subsets of RP. At this point, the following properties should be verified: Cl2) 8 is a ring, but not a a-ring. (13) If A e 8, then A is the union of a finite number of disjoint intervals. (14) If A e 8, m(A) is well defined by (11); that is, if two different decompo- sitions of A into disjoint intervals are used, each gives rise to the same value of mCA). (15) m is additive on 8. Note that if p = 1, 2, 3, then m is length, area, and volume, respectively. 11.S Definition A nonnegative additive set function </> defined on 8 is said to be regular if the following is true: To every A e 8 and to every e > 0 there exist sets Fe 8, Ge 8 such that Fis closed, G is open, F c A c G, and (16) </J(G) - e ~ </>(A) ~ </>CF) + e. 11.6 Examples (a) The set function m is regular. If A is an interval, it is trivial that the requirements of Definition 11.5 are satisfied. The general case follows from (13). (b) Take RP = R1 , and let ~ be a monotonically increasing f unc- tion, defined for all real x. Put µC[a, b)) = ~(b-) - ~ca-), µ([a, b]) = ~(b+) - ~ca-), µ((a, b]) = ~Cb+)- ~(a+), µ((a, b)) =~Cb-) - ~(a+). Here [a, b) is the set a ~ x < b, etc. Because of the possible discon- tinuities of ~, these cases have to be distinguished. If µ is defined for 304 PRINCIPLES OF MATHEMATICAL ANALYSIS elementary sets as in (11), µ is regu1ar on I. The proof is just like that of (a). Our next objective is to show that every regular set function on <ff can be extended to a countably additive set function on a a-ring which contains 8. 11.7 Definition Let µ be additive, regular, nonnegative, and finite on 8. Consider countable coverings of any set E c RP by open elementary sets An: 00 EC LJ An. n= 1 Define (17) 00 µ*(E) = inf L µ(An), n= 1 the inf being taken over all countable coverings of E by open elementary sets. µ*(E) is called the outer measz,re of E, corresponding to µ. It is clear that µ*(E) ~ 0 for all E and that (18) µ*(E1) :5: µ*(E2) if E1 C E2, 11.8 Theorem (a) For every A e ~, µ*(A) = µ(A). 00 (b) I_f E = LJ En, then 1 00 (19) µ*(E) :5: L µ*(En). n=l Note that (a) asserts thatµ* is an extension ofµ from I to the family of all subsets of RP. The property (19) is called subadditivity. (20) Proof Choose A e 8 and e > 0. The regularity ofµ shows that A is contained in an open elementary set G such that µ(G) ~ µ(A) + e. Since µ*(A) ~ µ(G) and since e was arbitrary, we have µ*(A) ~ µ(A). The definition of µ* shows that there is a sequence {An} of open elementary sets whose union contains A, such that 00 L µ(An) ~ µ*(A) + B. n=l (21) THE LEBESGUE THEORY 305 The regularity of µ shows that A contains a closed elementary set F such that µ(F) ~ µ(A) - e; and since Fis compact, we have F C A1 U ''' U AN for some N. Hence N µ(A)~ µ(F) + B ~ µ(A 1 U · · · U AN) + B ~ L µ(An) + B ~ µ*(A) + 2e. 1 In conjunction with (20), this proves (a). Next, suppose E = UEn, and assume that µ*(En) < + oo for all n. Given e > 0, there are coverings {Ank}, k = I, 2, 3, ... , of En by open elementary sets such that CX) L µ(Ank) ~ µ*(En) + 2-nB. k=l Then 00 00 00 µ*(E)~ L L µ(Ank)~ L µ*(En)+ B, n= 1 k= 1 n= 1 and (19) follows. In the excluded case, i.e., if µ*(En)=+ oo for some n, (19) is of course trivial. 11.9 Definition For any A c RP, B c RP, we define (22) (23) S(A, B) = (A - B) u (B - A), d(A, B) = µ*(S(A, B)). We write An ➔ A if Jim d(A, An) = 0. If there is a sequence {An} of elementary sets such that An ➔ A, we say that A is .finitely µ-measurable and write A e 9.llp(µ). If A is the union of a countable collection of finitely µ-measurable sets, we say that A is µ-measurable and write A e 9.ll(µ). S(A, B) is the so-called ''symmetric difference'' of A and B. We shall see that d(A, B) is essentially a distance function. The following theorem will enable us to obtain the desired extension ofµ. 11.10 Theorem 9.ll(µ) is a u-ring, and µ* is countably additive on 9.Jl(µ). Before we turn to the proof of this theorem, we develop some of the properties of S(A, B) and d(A, B). We have 306 PRINCIPLES OF MATHEMATICAL ANALYSIS (24) (25) S(A, B) = S(B, A), S(A, A)= 0. S(A, B) c S(A, C) u S(C, B). S(A 1 u A 2 , B1 u B2 ) (26) S(A 1 n A 2 , B1 n B 2 ) c S(A 1 , B1) u S(A 2 , B 2 ). S(A 1 - A 2 , B1 - B2) (24) is clear, and (25) follows from (A - B) c (A - C) u ( C - B), (B - A) c ( C - A) u (B - C). The first formula of (26) is obtained from (A1 u A 2 ) - (B1 u B2 ) c (A1 - B1) u (A 2 - B2 ). Next, writing Ee for the complement of E, we have S(A 1 n A 2 , B1 n B 2 ) = S(A1 u A2, Bf u B~) c S(Ai, Bf) u S(A2, B~) = S(A 1, B1) u S(A 2 , B2 ); and the last formula of (26) is obtained if we note that A 1 - A 2 = A 1 n A2. By (23), (19), and (18), these properties of S(A, B) imply (27) d(A, B) = d(B, A), d(A, A) = 0, (28) d(A, B) =:; d(A, C) + d(C, B), d(A 1 u A 2 , B1 u B2 ) (29) d(A 1 n A 2 , B1 n B2 ) ::5: d(A 1 , B1) + d(A 2 , B2 ). d(A 1 - A 2 , B1 - B2 ) The relations (27) and (28) show that d(A, B) satisfies the requirements of Definition 2.15, except that d(A, B) = 0 does not imply A= B. For instance, if µ = m, A is countable, and B is empty, we have d(A, B) = m*(A) = O; to see this, cover the nth point of A by an interval In such that m(Jn) < 2-nB. But if we define two sets A and B to be equivalent, provided d(A, B) = 0, we divide the subsets of RP into equivalence classes, and d(A, B) makes the set of these equivalence classes into a metric space. 9J11,(µ) is then obtained as the closure of 8. This interpretation is not essential for the proof, but it explains the underlying idea. (30) We need one more property of d(A, B), namely, I µ*(A) - µ*(B) I ~ d(A, B), THE LEBESGUE THEORY 307 if at least one of µ*(A), µ*(B) is finite. For suppose O ~ µ*(B) ~ µ*(A). Then (28) shows that d(A,O) ~ d(A, B) + d(B, 0), that is, µ*(A) ~ d(A, B) + µ*(B). Since µ*(B) is finite, it follows that (31) (32) (33) (34) (35) (36) µ*(A) - µ*(B) ~ d(A, B). Proof of Theorem 11.10 Suppose A e 9.llF(µ), Be 9.JIF(µ). Choose {An}, {Bn} such that An E 8. Bn E 8, An ➔ A, Bn ► B. Then (29) and (30) show that An u B,1 ➔ A u B, Ann Bn ➔ An B, An - Bn ► A - B, µ*(An) ➔ µ*(A), and µ*(A) < + oo since d(An, A) ➔ 0. By (31) and (33), 9.llf(µ) is a ring. By (7), µ(An) + µ(Bn) = µ(An U Bn) + µ(An n Bn). Letting n ➔ oo, we obtain, by (34) and Theorem 1 l .8(a), µ*(A) + µ*(B) = µ*(A u B) + µ*(A n B). If A n B = 0, then µ*(A n B) = 0. It follows that µ* is additive on 9.Jl\".(µ). Now let A e 9.ll(µ). Then A can be represented as the union of a countable collection of disjoint sets of 9.llp(µ). For if A = LJ A~ with A~ e rolF(µ), write A1 = A{, and A = (A I u ... u A') - (A I u ... u A I ) n 1 n n n-1 (n = 2, 3, 4, ... ). Then 00 A= LJAn n= 1 is the required representation. By (19) 00 µ*(A) ~ L µ*(An). n= 1 308 PRINCIPLES OF MATHEMATICAL ANALYSIS On the other hand, A=> A1 u · · · u An; and by the additivity of µ* on 9Jl1,(µ) we obtain (37) µ*(A) ~ µ*(A1 u ... u An) = µ*(A1) + ... + µ*(An). (38) Equations (36) and (37) imply 00 µ*(A) = L µ*(An)• n=1 Suppose µ*(A) is finite. Put Bn = A1 u · · · u An. Then (38) shows that 00 00 d(A, Bn) = µ*( LJ A,)= L µ*(A,) ➔ 0 i=n+ 1 i=n+ 1 as n ➔ oo. Hence Bn ➔ A; and since Bn e 9)1\",(µ), it is easily seen that A E 9Jlp(µ). We have thus shown that A e 9Jlp(µ) if A e 9Jl(µ) and µ*(A) < + oo. It is now clear thatµ* is countably additive on 9Jl(µ). For if where {An} is a sequence of disjoint sets of 9.ll(µ), we have shown that (38) holds if µ*(An)< + oo for ever)' n, and in the other case (38) is trivial. Finally, we have to show that 9Jl(µ) is a a-ring. If An e 9.ll(µ), n = 1, 2, 3, ... , it is clear that LJ An e 9.ll(µ) (Theorem 2.12). Suppose A e 9.ll(µ), B e 9Jl(µ), and 00 B = LJ Bn, n=l where An, Bn E 9Jlp(µ). Then the identity 00 An n B = LJ (An n Bi) i= 1 shows that An n B e 911(µ); and since µ*(An n B) :S: µ*(An) < + oo, An n B e 9.llp(µ). Hence An - B e 9Jlp(µ), and A - B e 9Jl(µ) A - B = LJ:':-1 (An - B). • since We now replace µ*(A) by µ(A) if A e 9Jl(µ). Thusµ, originally only de- fined on 8, is extended to a countably additive set function on the a-ring 9Jl(µ). This extended set function is called a measure. The special case µ = m is called the Lebesgue measure on RP. THE LEBESGUE THEORY 309 11.11 Remarks (39) (40) (a) If A is open, then A e 9.ll(µ). For every open set in RP is the union of a countable collection of open intervals. To see this, it is sufficient to construct a countable base whose members are open intervals. By taking complements, it follows that every closed set is in 9Jl(µ). (b) If A e 9.ll(µ) and e > 0, there exist sets F and G such that Fe Ac G, Fis closed, G is open, and µ(G -A)< e, µ(A - F) < B. The first inequality holds sinceµ* was defined by means of coverings by open elementary sets. The second inequality then follows by taking complements. (c) We say that E is a Borel set if E can be obtained by a countable number of operations, starting from open sets, each operation consisting in taking unions, intersections, or complements. The collection PJ of all Borel sets in RP is a u-ring; in fact, it is the smallest u-ring which contains all open sets. By Remark (a), Ee 9Jl(µ) if Ee PJ. (d) If A e 9.ll(µ), there exist Borel sets F and G such that F c A c G, and µ( G - A) = µ(A - F) = 0. This follows from (b) if we take e = I/n and let n ► oo. Since A = Fu (A - F), we see that every A e 9Jl(µ) is the union of a Borel set and a set of measure zero. The Borel sets are µ-measurable for everyµ. But the sets of measure zero [that is, the sets E for which µ*(E) = O] may be different for different µ's. (e) For everyµ, the sets of measure zero form a u-ring. (/) In case of the Lebesgue measure, every countable set has measure zero. But there are uncountable (in fact, perfect) sets of measure zero. The Cantor set may be taken as an example : Using the notation of Sec. 2.44, it is easily seen that (n=l,2,3, ... ); and since P = n En, P c En for every n, so that m(P) = 0. 310 PRINCIPLES OF MATHEMATICAL ANALYSIS MEASURE SPACES 11.12 Definition Suppose X is a set, not necessarily a subset of a euclidean space, or indeed of any metric space. X is said to be a measure space if there exists a a-ring 9Jl of subsets of X (which are called measurable sets) and a non- negative countably additive set function µ (which is called a measure), defined on 9.ll. If, in addition, Xe rol, then Xis said to be a measurable space. For instance, we can take X = RP, 9Jl the collection of all Lebesgue- measurable subsets of RP, andµ Lebesgue measure. Or, let X be the set of all positive integers, 9.ll the collection of all subsets of X, and µ(E) the number of elements of E. Another example is provided by probability theory, where events may be considered as sets, and the probability of the occurrence of events is an additive (or countably additive) set function. In the following sections we shall always deal with measurable spaces. It should be emphasized that the integration theory which we shall soon discuss would not become simpler in any respect if we sacrificed the generality we have now attained and restricted ourselves to Lebesgue measure, say, on an interval of the real line. In fact, the essential features of the theory are brought out with much greater clarity in the more general situation, where it is seen that everything depends only on the countable additivity ofµ on a a-ring. It will be convenient to introduce the notation (41) {xlP} for the set of all elements x which have the property P. MEASURABLE FUNCTIONS 11.13 Definition Let f be a function defined on the measurable space <X, with values in the extended real number system. The function/is said to be measur- able if the set (42) {xlf(x) > a} is meas1irable for every real a. • 11.14 Example If X = RP and 9Jl = 9Jl (µ) as defined in Definition 11.9, every continuous f is measurable, since then ( 42) is an open set. THE LEBESGUE THEORY 311 11.15 Theorem Each of the following four conditions implies the other three: (43) {xlf(x) > a} is measurable for every real a. (44) {xlf(x) ~ a} is measurable for every real a. (45) {xlf(x) < a} is measurable for every real a. (46) {xlf(x) ~ a} is measurable for every real a. Proof The relations oo I {xlf(x) ~a}= n xlf(x) > a - - , n= 1 n {xlf(x) <a}= X - {xlf(x) ~ a}, oo I {xlf(x) ~a}= n xlf(x) <a+ - , n=l n {xlf(x) >a}= X - {xlf(x) ~ a} show successively that (43) implies (44), (44) implies (45), (45) implies (46), and (46) implies (43). Hence any of these conditions may be used instead of ( 42) to define measurability. 11.16 Theorem If f is measurable, then Ill is measurable. Proof {x I lf(x) I < a} = {x lf(x) < a} ('\\ {x lf(x) > - a}. 11.17 Theorem Let{/:} be a sequence of measurable functions. For x e X, put g(x) = supf,.(x) (n = 1, 2, 3, ... ), h(x) = lim sup f,,(x). n ➔ oo Then g and hare measurable. The same is of course true of the inf and lim inf. Proof 00 {xlg(x) >a}= U {xlf,,(x) > a}, n=l h(x) = inf 9m(x), wheregm(x) = supf,.(x) (n ~ m). 312 PRINCIPLES OF MATHEMATICAL ANALYSIS Corollaries (47) (a) If f and g are measurable, then max(/, g) and min(/, g) are measurable. If 1+ = max (f, 0), 1- = - min(/, 0), it follows, in particular, that f + and r- are measurable. (b) The limit of a convergent sequence of measurable functions is measurable. 11.18 Theorem Let f and g be measurable real-valued functions de.fined on X, let F be real and continuous on R2 , and put h(x) = F(f (x), g(x)) Then h is measurable. In particular, f + g and.fg are measurable. Proof Let (x e X). Ga= {(u, v) I F(u, v) > a}. Then Ga is an open subset of R 2 , and we can write where {Jn} is a sequence of open intervals: In= {(u, v)!an < U < bn, Cn < V < dn}. Since {xi an <f(x) < bn} = {xlf(x) > an} n {xlf(x) < bn} is measurable, it follows that the set {x I (f(x), g(x)) E In}= {x I an <f(x) < bn} n {x I Cn < g(x) < dn} is measurable. Hence the same is true of {x I h(x) >a}= {x I (f(x), g(x)) e Ga} CX) = U {x I (f (x), g(x)) e In}. n=l Summing up, we may say that all ordinary operations of analysis, includ- ing limit operations, when applied to measurable functions, lead to measurable functions; in other words, all functions that are ordinarily met with are measur- able. That this is, however, only a rough statement is shown by the following example (based on Lebesgue measure, on the real line): If h(x) = f(g(x)), where THE LEBESGUE THEORY 313 f is measurable and g is continuous, then h is not necessarily measurable. (For the details, we refer to McShane, page 241.) The reader may have noticed that measure has not been mentioned in our discussion of measurable functions. In fact, the class of measurable func- tions on X depends only on the u-ring 9Jl (using the notation of Definition 11.12). For instance, we may speak of Borel-measurable functions on RP, that is, of function ff or which {xlf(x) > a} is always a Borel set, withot1t reference to any particular measure. SIMPLE FUNCTIONS 11.19 Definition Let s be a real-valued function defined on X. If the range of s is finite, we say that s is a simple function. Let E c X, and put (48) (x e E), (x ¢ E). K8 is called the characteristic function of E. Suppose the range of s consists of the distinct numbers c1 , ••. , en. Let E, = {xls(x) = c,} (i = 1, ... , n). Then (49) that is, every simple function is a finite linear combination of characteristic functions. It is clear thats is measurable if and only if the sets E1 , ••• , En are measurable. It is of interest that every function can be approximated by simple functions: 11.20 Theorem Let f be a real function on X. There exists a sequence {sn} of simple functions such that sn(x) ➔J(x) as n ➔ oo,for every x e X. If f is measur- able, {sn} may be chosen to be a sequence of measurable functions. If f ~ 0, {sn} may be chosen to be a monotonically increasing sequence. Proof If f ~ 0, define i - I i X 2n ~f(x) < 2n , Fn = {xlf(x) ~ n} 314 PRINCIPLES OF MATHEMATICAL ANALYSIS (50) for n = 1, 2, 3, ... , i = 1, 2, ... , n2n. Put n2n i - 1 Sn= L 2n KEn1 + nKFn• i= 1 In the general case, let/= 1+ - 1-, and apply the preceding construction to/+ and to/-. It may be noted that the sequence {sn} given by (50) converges uniformly to .f if f is bounded. INTEGRATION We shall define integration on a measurable space X, in which rot is the a-ring of measurable sets, and µ is the measure. The reader who wishes to visualize a more concrete situation may think of X as the real line, or an interval, and of µ as the Lebesgue measure m. 11.21 DefinitioD Suppose n (51) s(x) = L c, KE,(x) (x e X, c, > 0) I= 1 is measurable, and suppose Ee rot. We define (52) (53) n IE(s) = L c,µ(E n E1). i= 1 If /is measurable and nonnegative, we define f dµ = sup IE(s), E where the sup is taken over all measurable simple functions s such that O:::;; s :::;;f The left member of (53) is called the Lebesgue integral off, with respect to the measureµ, over the set E. It should be noted that the integral may have the value + oo. It is easily verified that (54) s dµ = IE(s) E for every nonnegative simple measurable functions. 11.22 Definition Let/ be measurable, and consider the two integrals (55) 1+ dµ, 1- dµ, E E where/+ and/- are defined as in (47). THE LEBESGUE THEORY 315 If at least one of the integrals (55) is finite, we define (56) If both integrals in (55) are finite, then (56) is finite, and we say that f is integrable (or summable) on E in the Lebesgue sense, with respect toµ; we write / e !l'(µ) on E. Ifµ = m, the usual notation is:/ e !l' on E. This terminology may be a little confusing: If (56) is + oo or - oo, then the integral of/ over E is defined, although/ is not integrable in the above sense of the word; .f is integrable on E only if its integral over E is finite. We shall be mainly interested in integrable functions, although in some cases it is desirable to deal with the more general situation. 11.23 Remarks The following properties are evident: • ~ (a) If/ is measurable and bounded on E, and if µ(E) < + oo, then / e !l'(µ) on E. (b) If a sf(x) Sb for x e E, and µ(E) < + oo, then aµ(E) s f dµ s bµ(E). E (c) If/ and g e !l'(µ) on E, and if f(x) S g(x) for x e E, then fdµ s gdµ. E E (d) If/ e !l'(µ) on E, the11 cf e !l'(µ) on E, for every finite constant c, and cf dµ = c f dµ. E E (e) If Jt(E) = 0, and/is measurable, then fdµ =0. E (/) If f e !l'(µ) on E, A e rot, and A c E, then/ e !l'(µ) on A. 11.24 Theorem (a) Suppose f is measurable and nonnegative on X. For A e IDl, define (57) </>(A) = f dµ. A 316 PRINCIPLES OF MATHEMATICAL ANALYSIS (58) (59) (60) Then </> is countably additive on IDl. (b) The same conclusion holds if I e !l'(µ) on X. Proof It is clear that (b) follows from (a) if we write I= 1+ - 1- and apply (a) to I+ and to 1-. To prove (a), we have to show that CX) </>(A) = L </>(An) n=l if An e IDl (n = 1, 2, 3, ... ), A, n A1 = 0 for i '# }, and A = Ui' An. If I is a characteristic function, then the countable additivity of </> is precisely the same as the countable additivity ofµ, since KE dµ = µ(A n E). A If I is simple, then I is of the form (51), and the conclusion again holds. In the general case, we have, for every measurable simple functions such that o s s sf, CX) CX) sdµ= L S dµ S L </>(An). A n=l An n= 1 Therefore, by (53), CX) </>(A) S L </>(An)• n= 1 Now if </>(An) = + oo for some n, (58) is trivial, since q,(A) ~ </>(An). Suppose </>(An) < + oo for every n. Given B > 0, we can choose a measurable function s such that 0 s s sf, and such that Hence </>(A1 u A 2 ) ~ s dµ = s dµ + s dµ ~ </>(A1_) + </>(A2 ) - 2e, Ai u A2 Ai A2 so that THE LEBESGUE THEORY 317 It follows that we have, for every n, (61) <J,(A1 U . • • U An) :2: <J,(A1) + • • • + q,(An). Since A => A1 u · · · u An, (61) implies CX) (62) q,(A) ~ L q,(An), n=l and (58) follows from (59) and (62). Corollary If A e 9.ll, Be 9.ll, B c A, and µ(A - B) = 0, then ' /dµ = fdµ. A B Since A =Bu (A - B), this follows from Remark l 1.23(e). 11.25 Remarks The preceding corollary shows that sets of i11easure zero are negligible in integration. Let us write/~ g on E if the set {xlf(x) # g(x)} n E has measure zero. Then/~/;/~ g implies g ~ /; and/~ g, g ~ h implies/~ h. That is, the relation ~ is an equivalence relation. If f ~ g on E, we clearly have /dµ = g dµ, ,t ,t provided the integrals exist, for every measurable subset A of E. If a property P holds for every x e E - A, and if µ(A) = 0, it is customary to say that P holds for almost all x e E, or that P holds almost everywhere on E. (This concept of ''almost everywhere'' depends of course on the particular measure under consideration. In the literature, unless something is said to the contrary, it usually refers to Lebesgue measure.) ' If/ e !l'(µ) on E, it is clear that/(x) must be finite almost everywhere on E. In most cases we the ref ore do not lose any generality if we assume the given functions to be finite-valued from the outset. 11.26 Theorem If f e !l'(µ) on E, then If I e !l'(µ) on E, and (63) fdµ [fl dµ. E E 318 PRINCIPLES OF MATHEMATICAL ANALYSIS Proof Write E = A u B, where / (x) ~ 0 on A and f(x) < 0 on B. By Theorem 11.24, Ill dµ = Ill dµ + Ill dµ = 1+ dµ + 1- dµ < + oo, E A B A B so that If I e !l'(µ). Since/~ If I and -/ ~ If I, we see that Idµ~ Ill dµ, - Idµ s Ill dµ, E E E E and (63) follows. Since the integrability of/ implies that of If I, the Lebesgue integral is often called an absolutely convergent integral. It is of course possible to define nonabsolutely convergent integrals, and in the treatment of some problems it is essential to do so. But these integrals lack some of the most useful properties of the Lebesgue integral and play a somewhat less important role in analysis. 11.27 Theorem Suppose f is nieasurable on E, Ill s g, and g e !l'(µ) on E. Then f e !l'(µ) on E. Proof We have/+ S g and/- ~ g. 11.28 Lebesgue's monotone convergence theorem Suppose Ee IDl. Let {fn} be a sequence of measurable functions such that (64) (65) 0 S/1(x) ~/2(x) s · · · Let f be defined by (x e E). fn(X)--+J(x) (x eE) .:is n --+ oo. Then (66) f,, dµ--+ Idµ (n --+ oo ). E E Proof By (64) it is clear that, as n--+ oo, (67) Indµ--+ o: E for some o:; and since Jf,, s J/, we have (68) o: S f dµ. E (69) (70) (71) (72) THE LEBESGUE THEORY 319 Choose c such that O < c < 1, and let s be a simple measurable function such that O ~ s ~f Put En= {xlfn(x) ~ cs(x)} (n = 1, 2, 3, ... ). By (64), E 1 c E 2 c £ 3 c · · · ; and by (65), For every n, • f,. dµ ~ f,. dµ ~ C s dµ. E En En We let n-+ oo in (70). Since the integral is a countably additive set function (Theorem 11.24), (69) shows that we may apply Theorem 11.3 to the last integral in (70), and we obtain (X ~ C s dµ. E Letting c -+ 1, we see that o: ~ s dµ, E and (53) implies o: ~ f dµ. E The theorem follows from (67), (68), and (72). 11.29 Theorem Suppose f = / 1 + / 2 , where /; e !l'(µ) on E (i = 1, 2). Then / e !l'(µ) on E, and (73) f dµ = Ji dµ + /2 dµ. E E E Proof First, suppose Ii ~ 0, / 2 ~ 0. If Ji and / 2 are simple, (73) follows trivially from (52) and (54). Otherwise, choose monotonically increasing sequences {s~}, {s:} of nonnegative measurable simple functions which converge to / 1,/2 • Theorem 11.20 shows that this is possible. Put Sn = s~ + s;. Then and (73) follows if we let n -+ oo and appeal to Theorem 11.28. 320 PRINCIPLES OF MATHEMATICAL ANALYSIS (74) (75) Next, suppose f 1 ~ 0, f 2 ~ 0. Put A = {x lf(x) ~ O}, B = {xlf(x) < O}. Then/,/i, and -f2 are nonnegative on A. Hence Similarly, -/,/i, and -f2 are nonnegative on B, so that (-f2 ) dµ = Ji dµ + (-f)dµ, B B B or Ii dµ = f dµ - f 2 dµ, B B B and (73) follows if we add (74) and (75). In the general case, E can be decomposed into four sets Ei on each ofwhich.fi(x) andf2(x) are of constant sign. The two cases we have proved so far imply (i = 1, 2, 3, 4), and (73) follows by adding these four equations. We are now in a position to reformulate Theorem 11.28 for series. 11.30 Theorem Suppose E e IDl. If {fn} is a sequence of nonnegative measurable functions and (76) then CX) f (x) = L f,,(x) (x e E), n=l CX) fdµ = L fndµ. E n= 1 E Proof The partial sums of (76) form a monotonically increasing sequence . . 11.31 Fatou's theorem Suppose Ee IDl. If {f,,} is a sequence of nonnegative measurable functions and f(x) = lim inffn(x) (x e E), then (77) f dµ :::;; lim inf In dµ. E n➔ oo E (78) (79) (80) (81) THE LEBESGUE THEORY 321 Strict inequality may hold in (77). An example is given in Exercise 5. Proof For n = 1, 2, 3, ... and x e E, put Un(x) = inf f,(x) Then Un is measurable on E, and (i ~ n). 0 :=:;; U1 (x) :=:;; U2(x) :=:;; • • ·, Un(x) :=:;;f,,(x), Un(x) -+ f(x) By (78), (80), and Theorem 11.28, (n-+ oo ). Un dµ-+ f dµ, E E so that (77) follows from (79) and (81 ). • 11.32 Lebesgue's dominated convergence theorem Suppose Ee IDl. Let {fn} be a sequence of measurable functions such that (82) f,,(x) -+ f (x) (x eE) as n -+ oo. If there exists a function u e !l'(µ) on E, such that (83) then (84) IJ,,(x) I S u(x) (n = 1, 2, 3, ... , x e E), lim fn dµ = f dµ. n ➔ oo E E Because of (83), {fn} is said to be dominated by u, and we talk about dominated convergence. By Remark 11.25, the conclusion is the same if (82) holds almost everywhere on E. (85) Proof First, (83) and Theorem 11.27 imply that fn e !l'(µ) and f e !l'(µ) on E. Since f,, + u ~ 0, Fatou's theorem shows that (f + u) dµ S lim inf (f,, + u) dµ, E n➔ oo E or f dµ :=:;; lim inf fn dµ. E n➔ oo E 322 PRINCIPLES OF MATHEMATICAL ANALYSIS (86) Since g - fn ~ 0, we see similarly that (g - f) dµ ~ lim inf (g - f,,) dµ, E n➔ oo E so that - f dµ ~ lim inf - f,, dµ , E n➔ oo E which is the same as f dµ ~ lim sup f dµ. E n➔ oo E The existence of the limit in (84) and the equality asserted by (84) now follow from (85) and (86). Corollary If µ(E) < + oo, {/,,} is uniformly bounded on E, andf,,(x) ➔ f(x) on E, then (84) holds. A uniformly bounded convergent sequence is often said to be boundedly convergent. COMPARISON WITH THE RIEMANN INTEGRAL Our next theorem will show that every function which is Riemann-integrable on an interval is also Lebesgue-integrable, and that Riemann-integrable func- tions are subject to rather stringent continuity conditions. Quite apart from the fact that the Lebesgue theory therefore enables us to integrate a much larger class of functions, its greatest advantage lies perhaps in the ease with which many limit operations can be handled; from this point of view, Lebesgue's convergence theorems may well be regarded as the core of the Lebesgue theory. One of the difficulties which is encountered in the Riemann theory is that limits of Riemann-integrable functions (or even continuous functions) may fail to be Riemann-integrable. This difficulty is now almost eliminated, since limits of measurable functions are always measurable. Let the measure space X be the interval [a, b] of the real line, withµ= m (the Lebesgue measure), and ID? the family of Lebesgue-measurable subsets of [a, b ]. Instead of fdm X it is customary to use the familiar notation b fdx a THE LEBESGUE THEORY 323 for the Lebesgue integral off over [a, b ]. To distinguish Riemann integrals from Lebesgue integrals, we shall now denote the former by b fdx. a 11.33 Theorem (87) (88) (89) (90) (91) (92) (a) If f e rJ1t or, [a, b ], then f e !t' orz [a, b ], and b b f dx = rJ1t f dx. a a (b) Suppose/ is bounded on [a, b]. Then/ e rJ1t on [a, b] if and only if f is continuous almost everywhere on [a, b]. Proof Suppose f is bounded. By Definition 6.1 and Theorem 6.4 there is a sequence {Pk} of partitions of [a, b], such that Pk+l is a refinement of Pk, such that the distance between adjacent points of Pk is less than 1/k, and such that - lim U(Pk ,f) = rJ1t f dx. k➔ oo (In this proof, all integrals are taken over [a, b].) If Pk= {x0 , x1 , ••• , Xn}, with x 0 = a, Xn = b, define put Uk(x) =Mi and L\"(x) = mi for x,_1 < x ~ xi, 1 ~ i ~ n, using the notation introduced in Definition 6.1. Then L(Pk ,f) = Lk dx, U(Pk ,f) = Uk dx, and for all x e [a, b], since Pk+t refines Pk. By (90), there exist L(x) = lim Lk(x), U(x) = lim Uk(x). k ➔ oo k-+ oo Observe that L and U are bounded measurable functions on [a, b ], that L(x) ~f(x) ~ U(x) (a~ x ~ b), 324 PRINCIPLES OF MATHEMATICAL ANALYSIS (93) (94) (95) and that - L dx = f1Jl f dx, U dx = fJlt f dx, - by (88), (90), and the monotone convergence theorem. So far, nothing has been assumed about/ except that/is a bounded real function on [a, b ]. To complete the proof, note that./ e fJlt if and only if its upper and lower Riemann integrals are equal, hence if and only if Ldx = Udx; since L ~ U, (94) happens if and only if L(x) = U(x) for almost all x e [a, b] (Exercise 1 ). In that case, (92) implies that L(x) = f(x) = U(x) almost everywhere on [a, b ], so that f is measurable, and (87) follows from (93) and (95). Furthermore, if x belongs to no Pk, it is quite easy to see that U(x) = L(x) if and only if/is continuous at x. Since the union of the sets Pk is count- able, its measure is 0, and we conclude that/ is continuous almost every- where on [a, b] if and only if L(x) = U(x) almost everywhere, hence (as we saw above) if and only if f e fJlt. This completes the proof. The familiar connection between integration and differentiation is to a large degree carried over into the Lebesgue theory. If f e !t' on [a, b], and X (96) F(x) = f dt (a~ x ~ b), a then F'(x) =f(x) almost everywhere on [a, b]. Conversely, if Fis differentiable at every point of [a, b] (''almost every- where'' is not good enough here!) and if F' e !t' on [a, b ], then X F(x) - F(a) = F'(t) (a~ x 5. b). a For the proofs of these two theorems, we refer the reader to any of the works on integration cited in the Bibliography. THE LEBESGUE THEORY 325 INTEGRATION OF COMPLEX FUNCTIONS Suppose f is a complex-valued function defined on a measure space X, and f = u + iv, where u and v are real. We say that f is measurable if and only if both u and v are measurable. It is easy to verify that sums and products of complex measurable functions are again measurable. Since Ill = (u2 + v2)112, Theorem 11.18 shows that lfl is measurable for every complex measurable f Suppose µ is a measure on X, E is a measurable subset of X, and/ is a complex function on X. We say that/ e !t'(µ) on E provided that/ is measurable and (97) Ill dµ < +oo, E and we define f dµ = u dµ + i V dµ E E E if (97) holds. Since I u I ~ If I, Iv I ~ If I, and If I ~ I u I + Iv I, it is clear that (97) holds if and only if u e !t'(µ) and v e .ft'(µ) on E. Theorems ll.23(a), (d), (e), (/), ll.24(b), 11.26, 11.27, 11.29, and 11.32 can now be extended to Lebesgue integrals of complex functions. The proofs are qt1ite straightforward. That of Theorem 11.26 is the only one that offers anything of interest: If f e !t'(µ) on E, there is a complex number c, I cl = 1, such that c f dµ ~ 0. E Put g =cf= u + iv, u and v real. Then f dµ = C f dµ = g dµ = u dµ ~ If I dµ. E E E E E The third of the above equalities holds since the preceding ones show that Jg dµ is real. FUNCTIONS OF CLASS !£ 2 As an application of the Lebesgue theory, we shall now extend the Parseval theorem (which we proved only for Riemann-integrable functions in Chap. 8) and prove the Riesz-Fischer theorem for orthonormal sets of functions. 326 PRINCIPLES OF MATHEMATICAL ANALYSIS 11.34 Definition Let X be a measurable space. We say that a complex function f e !t'2(µ) on X if f is measurable and if If I 2 dµ < + 00. X If µ is Lebesgue measure, we say f e !t' 2 • For f e !t' 2(µ) (we shall omit the phrase ''on X'' from now on) we define 1/2 11/ II = I/I 2 dµ X and call 11/11 the !t'2(µ) norm off 11.35 Theorem Suppose f e !t' 2(µ) and g e !t' 2(µ). Then Jg e !t'(µ), and (98) 1/u I dµ ~ 11/11 llull- x This is the Schwarz inequality, which we have already encountered for series and for Riemann integrals. It follows from the inequality o =:; (Ill + llul)2 dµ = 11/11 2 + 2i 1/ul dµ + i 2 11u11 2 , X X which holds for every real l. 11.36 Theorem If f e !t' 2(µ) and g e !t' 2(µ), then f + g e !t' 2(µ), and II!+ ull =:; 11/11 + llull- Proof The Schwarz inequality shows that llf+ull 2 = 1!1 2 + fu+ Ju+ lul 2 ~ II! 11 2 + 211/11 llull + llull 2 = (11/11 + llull) 2 • 11.37 Remark If we define the distance between two functions f and g in !t'2(µ) to be II! - g II, we see that the conditions of Definition 2.15 are satisfied, except for the fact that II! - ull = 0 does not imply that f(x) = g(x) for all x, but only for almost all x. Thus, if we identify functions which differ only on a set of measure zero, !t'2(µ) is a metric space. We now consider !t'2 on an interval of the real line, with respect to Lebesgue measure. 11.38 Theorem The continuous functions form a dense subset of !t'2 on [a, b ]. THE LEBESGUE THEORY 327 • More explicitly, this means that for any f e 2 2 on [a, b], and any a> 0, there is a function o, continuous on [a, b ], such that b 1/2 Ill - oil = If - ol 2 dx < a. a Proof We shall say that./ is approximated in 2 2 by a sequence {on} if 11/'-onll ➔ Oas n • oo. Put and Let A be a closed subset of [a, b], and KA its characteristic function. t(x) = inf Ix - YI 1 On(x) = 1 + nt(x) (ye A) (n = 1, 2, 3, ... ).~·, Then Un is continuous on [a, b], On(x) = 1 on A, and Un(x) • 0 on B, where B = [a, b] - A. Hence 1/2 by Theorem 11.32. Thus characteristic functions of closed sets can be approximated in !t' 2 by continuous functions. By (39) the same is true for the characteristic function of any measurable set, and hence also for simple measurable functions. If f ~ 0 and f e 2 2 , let {sn} be a monotonically increasing sequence of simple nonnegative measurable functions such that sn(x) • f (x). Since If - sn 1 2 ~/ 2, Theorem 11.32 shows that 11/' - sn I ➔ 0. The general case follows. 11.39 Definition We say that a sequence of complex functions { <l>n} is an orthonormal set of functions on a measurable space X if (n-:/= m), (n = m). In particular, we must have <l>n e 2 2(µ). If f e 2 2(µ) and if (n=l,2,3, ... ), we write as in Definition 8.10. 328 PRINCIPLES OF MATHEMATICAL ANALYSIS The definition of a trigonometric Fourier series is extended in the same way to !t' 2 (or even to !t') on [-n, n]. Theorems 8.11 and 8.12 (the Bessel inequality) hold for any/ e !t' 2(µ). The proofs are the same, word for word. We can now prove the Parseval theorem. 11.40 Theorem Suppose (99) - 00 where f e !t' 2 on [ - n, n]. Let sn be the nth partial sum of (99). Then (100) (101) lim II/ - snll = 0, n ➔ oo Proof Let e > 0 be given. By Theorem 11.38, there is a continuous function g such that e II/ - ull < - · 2 Moreover, it is easy to see that we can arrange it so that g(n) = g( - n). Then g can be extended to a periodic continuous function. By Theorem 8.16, there is a trigonometric polynomial T, of degree N, say, such that e I g - TII < 2 · Hence, by Theorem 8.11 (extended to !t'2), n ~ N implies llsn - /II ~ IIT- /II < e, and (100) follows. Equation (101) is deduced from (100) as in the proof of Theorem 8.16. Corollary Jf.f e 2 2 on [-n, n], and if f(x)e-inx dx = 0 (n = 0, ±1, ±2, ... ), -n then llfll = 0. Thus if two functions in 2 2 have the same Fourier series, they differ at most on a set of measure zero. THE LEBESGUE THEORY 329 11.41 Definition Let f and fn e !t'2(µ) (n = 1, 2, 3, ... ). We say that {f,.} converges to fin !t'2(µ) if llf,. - fl ➔ 0. We say that {In} is a Cauchy sequence in !t'2(µ) if for every e > 0 there is an integer N such that n ~ N, m ~ N implies llf,. - fmll ~ e. 11.42 Theorem If {f,.} is a Cauchy sequence in !t'2(µ), tlien there exiJ·ts a .function f e !t'2(µ) such that {f,.} converges to.fin !t'2(µ). (102) (103) (104) This says, in other words, that !t' 2(µ) is a complete metric space. Proof Since {In} is a Cauchy sequence, we ~an find a sequence {nk}, k = 1, 2, 3, ... , such that (k = I, 2, 3, ... ). Choose a function g e .fi'2(µ). By the Schwarz inequality, Hence 00 I jg(/~k - lnk+l)I dµ ~ I ul. k= 1 X By Theorem 11.30, we may interchange the summation and integration in (102). It follows that 00 jg(x)I I llnk(x) - fnk+ 1(x)I < + 00 k=l almost everywhere on X. Therefore 00 L lfnk+1(x) -.fnk(x)I < + oo k=l almost everywhere on X. For if the series in (104) were divergent on a set E of positive measure, we could take g(x) to be nonzero on a subset of E of positive measure, thus obtaining a contradiction to (103). Since the kth partial sum of the series which converges almost everywhere on X, is Ink+ 1Cx) - fn1(x), 330 PRINCIPLES OF MATHEMATICAL ANALYSIS (105) we see that the equation f(x) = lim f,,k(x) k ➔ oo defines f(x) for almost all x e X, and it does not matter how we define f (x) at the remaining points of X. We shall now show that this function f has the desired properties. Let e > 0 be given, and choose N as indicated in Definition 11.41. If nk > N, Fatou's theorem shows that II/ - /,,kll ~ lim inf ll/,, 1 - /,,kll ~ e. i➔ oo Thus f - f,,k e fi' 2(µ), and since f = (f - f,,k) + f,,k, we see that f e !t'2(µ). Also, since e is arbitrary, lim II/ - /,,kll = 0. k ➔ oo Finally, the inequality shows that {f,,} converges to fin fi' 2(µ); for if we take n and nk large enough, each of the two terms on the right of (105) can be made arbi- trarily small. 11.43 The Riesz-Fischer theorem Let {<Pn} be orthonormal on X. Suppose I. I cn I 2 converges, and put sn = c1 </>1 + · · · + Cn<Pn. Then there exists a function / e fi' 2(µ) such that {sn} converges to fin !t'2(µ), and such that Proof For n > m, llsn - smll 2 = lcm+1 l 2 + · · · + lcnl 2 , so that {sn} is a Cauchy sequence in !t'2(µ). By Theorem 11.42, there is a function f e !t'2(µ) such that lim II/ - snll = 0. n ➔ oo Now, for n > k, THE LEBESGUE THEORY 331 so that fipk dJl - Ck ~ If- snll · ll<Pkll + II/- snll• X Letting n ➔ oo, we see that ( k = 1, 2, 3, ... ), and the proof is complete. 11.44 Definition An orthonormal set { <Pn} is said to be complete if, for / e !t'2(µ), the equations f<Pn dµ = 0 (n = 1, 2, 3, ... ) X imply that II! 11 = O. In the Corollary to Theorem 11.40 we deduced the completeness of the trigonometric system from the Parseval equation (101). Conversely, the Parseval equation holds for every complete orthonormal set: 11.45 Theorem Let {<Pn} be a complete orthonormal set. If f e !t'2(µ) and if (106) then (107) (108) (109) 00 If 12 dµ = I I Cn 12 • X n=l Proof By the Bessel inequality, 1: I cn I 2 converges. Putting Sn = Ci <Pt + ' ' ' + Cn<Pn, the Riesz-Fischer theorem shows that there is a function g e !t'2(µ) such that and such that Ilg - snll ➔ 0. Hence llsnll ➔ llull, Since llsnll 2 = lc1l 2 + ... + lcnl 2 , we have 332 PRINCIPLES OF MATHEMATICAL ANALYSIS Now (106), (108), and the completeness of {</>n} show that II/ - ull = 0, so that (109) implies (107). Combining Theorems 11.43 and 11.45, we arrive at the very interesting conclusion that every complete orthonormal set induces a 1-1 correspondence between the functions f e !i'2(µ) (identifying those which are equal almost everywhere) on the one hand and the sequences {en} for which l: I en 1 2 converges, on the other. The representation together with the Parseval equation, shows that !i'2(µ) may be regarded as an infinite-dimensional euclidean space (the so-called ''Hilbert space''), in which the point f has coordinates en, and the functions <Pn are the coordinate vectors. EXERCISES 1. If/~ 0 and JE/dµ. = 0, prove that/(x) = 0 almost everywhere on E. Hint: Let En be the subset of Eon which/(x) > 1/n. Write A = UEn. Then µ.(A)= 0 if and only if µ.(En)= 0 for every n. 2. If J,. / dµ. = 0 for every measurable subset A of a measurable set E, then/(x) = 0 almost everywhere on E. 3. If {f,.} is a sequence of measurable functions, prove that the set of points x at which {fn(x)} converges is measurable. 4. If/ e ft'(µ.) on E and g is bounded and measurable on E, then fg e ft'(µ.) on E. 5. Put Show that but [Compare with (77).] 0 g(x) = 1 l21c(x) = g(x) /21c+1(X) = g(l - x) lim inf f,.(x) = 0 n ➔ OO 1 (O::;;;x::;;;½), (½ < X::;;; 1), (0 ::;;; X ::;;; 1 ), (0 ::;;; X ::;;; 1). (O ::;;; x ::;;; 1 ), fn(X) dx = ½. 0 6. Let 1 - f,.(x) = n 0 Then f,.(x) > 0 uniformly on Rt, but 00 (Ix I =::;;; n), (lxl >n). THE LEBESGUE THEORY 333 f,. dx = 2 (n = 1, 2, 3, ... ). -oo (We write J~00 in place of JR1,) Thus uniform convergence does not imply domi- nated convergence in the sense of Theorem 11.32. However, on sets of finite measure, uniformly convergent sequences of bounded functions do satisfy Theo- rem 11.32. 7. Find a necessary and sufficient condition that f E ~(o:) on [a, b]. Hint: Consider Example l 1.6(b) and Theorem 11.33. 8. If /E ~ on [a, b] and if F(x) = f: f(t) dt, prove that F'(x) =f(x) almost every- where on [a, b ]. 9. Prove that the function F given by (96) is continuous on [a, b]. 10. If µ.(X) < +oo and/E !i' 2(µ.) on X, provethat/E .P(µ.) on X. If this is false. For instance, if µ.(X) = + oo, 1 /(x)=l+lxl' then/E !i' 2 on Rt, but/¢ .Pon Rt. 11. If f, g E .P(µ.) on X, define the distance between/ and g by X I/'- g dµ.. Prove that .P(µ.) is a complete metric space. 12. Suppose (a) lf(x,y)I <1 ifO=::;;;x<l,O<y<l, (b) for fixed x,f(x, y) is a continuous function of y, (c) for fixed y,f(x, y) is a continuous function of x. Put t g(x) = f(x, y) dy 0 (0 < X < 1). Is g continuous? 13. Consider the functions f,.(x) = sin nx (n = 1, 2, 3, ... , -1T =::;;; X =::;;; 1r) 334 PRINCIPLES OF MATHEMATICAL ANALYSIS as points of !i' 2 • Prove that the set of these points is closed and bounded, but not compact. 14. Prove that a complex function f is measurable if and only if 1- 1(V) is measurable for every open set Vin the plane. 1S. Let fJl be the ring of all elementary subsets of (0, 1]. If O <a:::;; b:::;; 1, define <p([a, b]) = <p([a, b)) = <p ( (a, b]) = <p((a, b)) = b - a, but define <p((O, b)) = <p((O, b]) = 1 + b if O < b :::;; 1. Show that this gives an additive set function <p on fJl, which is not regular and which cannot be extended to a countably additive set function on a • a-ring. 16. Suppose {n1c} is an increasing sequence of positive integers and Eis the set of all x E ( -1T, 1T) at which {sin n1cx} converges. Prove that m(E) = 0. Hint: For every A cE, and 2 (sin n1cx) 2 dx = (1 - cos 2n1cx) dx > m(A) A. A. ask > oo. 17. Suppose E c (-1T, 1T), m(E) > 0, S > 0. Use the Bessel inequality to prove that there are at most finitely many integers n such that sin nx ;;::::: S for all x E E. 18. Suppose/E .IR2(µ,),g E .!R2(µ,). Prove that if and only if there is a constant c such that g(x) = cf(x) almost everywhere. (Compare Theorem 11.35.) BIBLIOGRAPHY ARTIN, E.: ''The Gamma Function,\" Holt, Rinehart and Winston, Inc., New York, 1964. BOAS, R. P.: ''A Primer of Real Functions,\" Carus Mathematical Monograph No. I 3, John Wiley & Sons, Inc., New York, 1960. BUCK, R. c. (ed.): ''Studies in Modern Analysis,\" Prentice-Hall, Inc., Englewood Cliffs, N .J ., I 962. ---: ''Advanced Calculus,\" 2d ed., McGraw-Hill Book Company, New York, 1965. BURKILL, J. c.: ''The Lebesgue Integral,\" Cambridge University Press, New York, 1951. DIEUDONNE, J.: ''Foundations of Modern Analysis,\" Academic Press, Inc., New York, 1960. FLEMING, w. H.: ''Functions of Several Variables,\" Addison-Wesley Publishing Com- pany, Inc., Reading, Mass., 1965. GRAVES, L. M.: ''The Theory of Functions of Real Variables,\" 2d ed., McGraw-Hill Book Company, New York, 1956. BALMOS, P. R.: ''Measure Theory,\" D. Van Nostrand Company, Inc., Princeton, N.J., 1950. 336 PRI?-lCIPLES OF MATHEMATICAL ANALYSIS ---: ''Finite-dimensional Vector Spaces,\" 2d ed., D. Van Nostrand Company, Inc., Princeton, N.J., 1958. HARDY, G. H.: ''Pure Mathematics,\" 9th ed., Cambridge University Press, New York, 1947. --- and ROGOSINSKI, w.: ''Fourier Series,\" 2d ed., Cambridge University Press, New York, 1950. BERSTEIN, 1. N.: ''Topics in Algebra,'' Blaisdell Publishing Company, New York, 1964. HEWITT, E., and STROMBERG, K.: ''Real and Abstract Analysis,\" Springer Publishing Co., Inc., New York, 1965. KELLOGG, o. D.: ''Foundations of Potential Theory,\" Frederick Ungar Publishing Co., New York, 1940. KNOPP, K.: ''Theory and Application of Infinite Series,\" Blackie & Son, Ltd., Glasgow, 1928. LANDAU, E.G. H.: ''Foundations of Analysis,\" Chelsea Publishing Company, New York, 1951. MCSHANE, E. J.: ''Integration,\" Princeton University Press, Princeton, N.J., 1944. NIVEN, 1. M.: ''Irrational Numbers,'' Carus Mathematical Monograph No. 11, John Wiley & Sons, Inc., New York, 1956. ROYDEN, H. L.: ''Real Analysis,\" The Macmillan Company, New York, 1963. RUDIN, w.: ''Real and Complex Analysis,\" 2d ed., McGraw-Hill Book Company, New York, 1974. SIMMONS, G. F.: ''Topology and Modern Analysis,\" McGraw-Hill Book Company, New York, 1963. SINGER, I. M., and THORPE, J. A.: ''Lecture Notes on Elementary Topology and Geom- etry,\" Scott, Foresman and Company, Glenview, Ill., 1967. SMITH, K. T.: ''Primer of Modern Analysis,\" Bogden and Quigley, Tarrytown-on- Hudson, N.Y., 1971. SPIVAK, M.: ''Calculus on Manifolds,\" W. A. Benjamin, Inc., New York, 1965. THURSTON, H. A.: ''The Number System,\" Blackie & Son, Ltd., London-Glasgow, 1956. LIST OF SPECIAL SYMBOLS The symbols listed below are followed by a brief statement of their meaning and by the number of the page on which they are defined. e belongs to . . . . . . . . . . . . . . . . . . . . 3 ¢ does not belong to . . . . . . . . . . . . . 3 c, => inclusion signs . . . . . . . . . . . . 3 Q rational field . . . . . . . . . . . . . . . . 3 <, <, >, ~ inequality signs. . . . 3 sup least upper bound. . . . . . . . . . . . 4 inf greatest lower bound . . . . . . . . . 4 R real field . . . . . . . . . . . . . . . . . . . . . 8 + oo, - oo, ooinfinities ........ 11, 27 z complex conjugate ............. 14 Re(z) realpart .................. 14 Im (z) imaginary part ............ 14 I z I absolute value ............... 14 L summation sign ............ 15, 59 R\" euclidean k-space ............. 16 0 null vector .................... 16 x · y inner product .............. 16 I x I norm of vector x ............ 16 {xn} sequence .................... 26 U, u union .................... 27 n, (\") intersection ............... 27 (a, b) segment ................... 31 [a, b] interval ................... 31 Ee complement of E ............. 32 £' limit points of E .............. 35 E closure of E .................. 35 lim limit . ....................... 47 -► converges to .............. 47, 98 lim sup upper limit .............. 56 lim inf lower limit ............... 56 g O f composition ................ 86 f(x+) right-hand limit ........... 94 J(x-) left-hand limit ............ 94 /',f'(x) derivatives ........ 103,112 U(P, /), U(P, J, oc), L(P, /), L(P, J, oc) Riemann sums ........... 121, 122 338 PRINCIPLES OF MATHEMATICAL ANALYSIS ~, ~(or.) classes of Riemann (Stieltjes) integrable functions ....... 121, 122 <G(X) space of continuous functions ..................... 1 SO II II norm ........... 140, 150, 326 exp exponential function ........ 179 DN Dirichlet kernel ............. 189 I'(x) gamma function ........... 192 { e1, ... , en} standard basis ....... 205 L(X), L(X, Y) spaces of linear transformations ................ 207 [A] matrix ..................... 210 D 1/ partial derivative ........... 215 'v f gradient .................... 217 <G', <G'' classes of differentiable functions ................ 219, 23 5 det [A] determinant ............. 232 J,(x) Jacobian ................. 234 o(yi, ... 'Yn) J b' 234 ~( ) aco 1an ......... . u X 1, ••• , Xn Jk k-cell ....................... 245 Q\" k-sim plex .................. 24 7 dx, basic k-f orm ............... 257 A multiplication symbol ........ 254 d differentiation operator ........ 260 wr transform of w ............. 262 o boundary operator ............ 269 'v x F curl . . . . . . . . . . . . . . . . . . . . 281 'v · F divergence . . . . . . . . . . . . . . . 281 <ff ring of elementary sets ........ 303 m Lebesgue measure ....... 303, 308 µ. measure ................ 303, 308 IDlF, IDl families of measurable sets 305 {x IP} set with property P ........ 310 f + ,/- positive (negative) part off ......................... 312 KE characteristic function ....... 313 ft', fl'(µ.), !R 2 , !i' 2(µ.) classes of Lebesgue-integrable functions ................ 315, 326 Abel, N. H., 75, 174 Absolute convergence, 71 of integral, 138 Absolute value, 14 Addition (see Sum) Addition formula, 178 Additivity, 30 I Affine chain, 268 Affine mapping, 266 Affine simplex, 266 Algebra, 161 self-adjoint, 165 uniformly closed, 161 Algebraic numbers, 43 Almost everywhere, 317 Alternating series, 71 Analytic function, 172 Anticommutative law, 256 Arc, 136 Area element, 283 Arithmetic means, 80, 199 Artin, E., 192, 195 Associative law, 5, 28, 259 Axioms, 5 Baire's theorem, 46, 82 Ball, 31 Base, 45 Basic form, 257 Basis, 205 Bellman, R., 198 Bessel inequality, 188, 328 Beta function, 193 Binomial series, 20 I Bohr-Mollerup theorem, 193 Bore)-mf;asurable function, 3 13 Borel set, 309 Boundary, 269 Bounded convergence, 322 Bounded function, 89 Bounded sequence, 48 Bounded set, 32 Brouwer's theorem, 203 Buck, R.C., 195 Cantor, G., 21, 30, 186 Cantor set, 41, 81, 138, 168, 309 Cardinal number, 25 Cauchy criterion, 54, 59, 147 Cauchy sequence, 21, 5 2, 8 2, 3 29 Cauchy's condensation test, 61 Cell, 31 '€\"-equivalence, 280 Chain, 268 affine, 268 differentiable, 270 Chain rule, 105, 214 Change of variables, 132, 252, 262 Characteristic function, 313 Circle of convergence, 69 Closed curve, 136 Closed form, 275 Closed set, 32 Closure, 35 uniform, 151, 161 Collection, 27 Column matrix, 217 Column vector, 210 Common refinement, 123 Commutative law, 5. 28 Compact metric space, 36 Compact set, 36 INDEX Comparison test, 60 Complement, 32 Complete metric space, 54, 82, 151, 329 Complete orthonormal set, 331 Completion, 82 Complex field, 12, 184 Complex number, 12 Complex plane, 17 Component of a function, 87, 215 Composition, 86, 105, 127, 207 Condensation point, 45 Conjugate, 14 Connected set, 42 Constant function, 85 Continuity, 85 uniform, 90 Continuous functions, space of, 150 Continuous mapping, 85 Continuously differentiable curve, 136 Continuously differentiable map- ping, 219 Contraction, 220 Convergence, 47 absolute, 71 bounded, 322 dominated, 3 21 of integral, 138 pointwise, 144 radius of, 69, 79 of sequences, 47 of series, 59 uniform. 147 Convex function, 101 Convex set. 3 I 340 INDEX Coordinate function, 88 Coordinates, 16, 20.5 Countable additivity, 30 I Countable base, 4.5 Countable set, 2.5 Cover, 36 Cunningham, F., 167 Curl, 281 Curve, 136 closed, 136 continuously differentiable, 136 rectifiable, 136 space-filling, 168 Cut, 17 Davis, P.J., 192 Decimals, 11 Dedekind, R., 21 Dense subset, 9, 32 Dependent set, 20.5 Derivative, I 04 directional, 218 of a form, 260 of higher order, 110 of an integral, 133, 236, 324 integration of, 134, 324 partial, 21.5 of power series, 17 3 total, 213 of a transformation, 214 of a vector-valued function, 112 Determinant, 232 of an operator, 234 product of, 233 Diagonal process, 30, 1.57 Diameter, .52 Differentiable function, I 04, 212 Differential, 2 I 3 Differential equation, 119, 170 Differential form (see Form) Differentiation (see Derivative) Dimension, 20.5 Directional derivative, 218 Dirichlet's kernel, 189 Discontinuities, 94 Disjoint sets, 27 Distance, 30 Distributive law, 6, 20, 28 Divergence, 281 Divergence theorem, 2.53, 272, 288 Divergent sequence, 47 Divergent series, .59 Domain, 24 Dominated convergence theorem, 1.5.5, 167, 321 Double sequence, 144 e, 63 Eberlein, W. F., 184 Elementary set, 303 Empty set, 3 Equicontinuity, I .56 Equivalence relation, 2.5 Euclidean space, 16, 30 Euler's constant, 197 Exact form, 27 .5 Existence theorem, 170 Exponential function, 178 Extended real number system, 11 Extension, 99 Family, 27 Fatou's theorem, 320 Fejer's kernel, 199 Fejer's theorem, 199 Field axioms, .5 Fine, N. J., 100 Finite set, 2.5 Fixed point, 117 theorems, 117, 203, 220 Fleming, W. H., 280 Flip, 249 Form, 2.54 basic, 2.57 of class 'C' !C\", 2.54 closed, 27.5 derivative of, 260 exact, 27.5 product of, 2.58, 260 sum of, 2.56 Fourier, J. B., 186 Fourier coefficients, 186, 187 Fourier series, 186, 187, 328 Function, 24 absolute value, 88 analytic, 172 Borel-measurable, 313 bounded, 89 characteristic, 313 component of, 87 constant, 8.5 continuous, 8.5 from left, 97 from right, 97 continuously differentiable, 219 convex, 10 I decreasing, 9.5 differentiable, I 04, 212 exponential, 178 harmonic, 297 increasing, 9 .5 inverse, 90 Lebesgue-integrable, 31.5 limit, 144 linear, 206 logarithmic, 180 measurable, 3 I 0 monotonic, 9.5 nowhere differentiable continu- ous, 1.54 one-to-one, 2.5 orthogonal, 187 periodic, 183 product of. 8.5 rational, 88 Riemann-integrable, 121 Function: simple, 313 sum of, 8.5 summable, 31.5 trigonometric, 182 uniformly continuous, 90 uniformly differentiable, 11.5 vector-valued, 8.5 Fundamental theorem of calculus, 134, 324 Gamma function, 192 Geometric series, 61 Gradient, 217, 281 Graph, 99 Greatest lower bound, 4 Green's identities, 297 Green's theorem, 2.53, 2.5.5, 272, 282 Half-open interval, 31 Harmonic function, 297 Havin, V.P., 113 Heine-Borel theorem, 39 Helly's selection theorem, 167 Herstein, I. N ., 6.5 Hewitt, E., 21 Higher-order derivative, 110 Hilbert space, 332 Holder's inequality, 139 i, 13 Identity operator, 232 Image, 24 Imaginary part, 14 Implicit function theorem, 224 Improper integral, 139 Increasing index, 2.57 Increasing sequence, .5.5 Independent set, 20.5 Index of a curve, 20 I Infimum, 4 Infinite series, .59 Infinite set, 2.5 Infinity, 11 Initial-value problem, 119, 170 Inner product, 16 Integrable functions, spaces of, 31.5,326 Integral: countable additivity of, 316 differentiation of, 133, 236, 324 Lebesgue, 3 14 lower, 121, 122 Riemann, 121 Stieltjes, 122 upper, 121, 122 Integral test, 139 Integration: of derivative, 134, 324 by parts, 134, 139, 141 Interior. 43 Interior point, 32 Intermediate value, 93, 100, 108 Intersection, 27 Interval, 31, 302 Into, 24 Inverse function, 90 Inverse function theorem, 221 Inverse image, 24 Inverse of linear operator, 207 Inverse mapping, 90 Invertible transformation, 207 Irrational number, 1, 10, 65 Isolated point, 32 Isometry, 82, 170 Isomorphism, 21 Jacobian, 234 Kellogg, 0. D., 281 Kestelman, H., 167 Knopp, K .. 21, 63 Landau, E.G. H., 21 Laplacian, 297 Least upper bound, 4 property, 4, 18 Lebesgue, H.\\L., 186 Lebesgue-integrable function, 315 Lebesgue integral, 314 Lebesgue measure, 308 Lebesgue's theorem, 155, 167, 318,321 Left-hand limit, 94 Leibnitz, G. W., 71 Length, 136 L'Hospital's rule, 109, 113 Limit, 47, 83, 144 left-hand, 94 lower, 56 pointwise, 144 right-hand, 94 subsequential, 51 upper, 56 Limit function, 144 Limit point, 32 Line, 17 Line integral, 255 Linear combination, 204 Linear function, 206 Linear mapping, 206 Linear operator, 207 Linear transformation, 206 Local maximum, 107 Localization theorem, 190 Locally one-to-one mapping, 223 Logarithm, 22, 180 Logarithmic function, 180 Lower bound, 3 Lower integral, 121, 122 Lower limit, 56 McShanc. E. J ., 3 I 3 Mapping, 24 affine, 266 continuous, 85 continuously differentiable, 219 linear, 206 open, 100, 223 primitive, 248 uniformly continuous, 90 (See also Function) Matrix, 210 product, 211 Maximum, 90 Mean square approximation, 187 Mean value theorem, 108, 235 Measurable function, 310 Measurable set, 305, 310 Measurable space, 310 Measure, 308 outer, 304 Measure space, 310 Measure zero, set of, 309, 317 Mertens, F., 74 Metric space, 30 Minimum, 90 Mobius band. 298 Monotone convergence theorem, 318 Monotonic function, 95, 302 Monotonic sequence. 55 Multiplication (see Product) Negative number, 7 Negative orientation, 267 Neighborhood, 32 Newton's method, 118 Nijenhuis, A., 223 Niven, I .. 65, 198 Nonnegative number, 60 Norm, 16, 140, 150, 326 of operator, 208 Nor111al derivative, 297 Normal space, 101 Normal vector, 284 Nowhere differentiable function, 154 Null space, 228 Nutt vector, 16 Number: algebraic, 43 cardinal, 25 complex, 12 decimal, 11 finite, 12 irrational, 1, 10, 65 negative, 7 nonnegative, 60 positive, 7, 8 rational, I real, 8 One-to-one correspondence. 25 Onto, 24 Open cover, 36 INDEX 341 Open mapping, 100, 223 Open set, 32 Order, 3, 17 lexicographic, 22 Ordered field, 7, 20 k-tuple, 16 pair, 12 set, 3, I 8, 22 Oriented simplex, 266 Origin, 16 Orthogonal set of functions, 187 Orthonormal set, 187, 327, 331 Outer measure, 304 Parameter domain, 254 Parameter interval, 136 Parseval's theorem, 191, 198, 328, 331 Partial derivative, 215 Partial sum, 59, 186 Partition, 120 of unity, 251 Perfect set, 32 Periodic function, 183, 190 7T, 183 Plane, 17 Poincare's lemma, 27 5, 280 Pointwise bounded sequence, 155 Pointwise convergence, 144 Polynomial, 88 trigonometric, 185 Positive orientation, 267 Power series, 69,172 Primes, 197 Primitive mapping, 248 Product, 5 Cauchy, 73 of complex numbers, 12 of determinants, 233 of field elements, 5 of forms, 258, 260 of functions, 85 inner, 16 of matrices, 211 of real numbers, 19, 20 scalar, 16 of series, 7 3 of transformations, 207 Projection, 228 Proper subset, 3 Radius, 31, 32 of convergence, 69, 79 Range, 24, 207 Rank, 228 Rank theorem, 229 Ratio test, 66 Rational function, 88 Rational number, I Real field, 8 Real line, 17 Real number, 8 Reitl part. 14 342 INDEX Rearrangement, 7 5 Rectifiable curve, 136 Refinement, 123 Reflexive property, 25 Regular set function, 303 Relatively open set, 35 Remainder, 211, 244 Restriction, 99 Riemann, B., 76, 186 Riemann integral, 121 Riemann-Stieltjes integral, 122 Riesz-Fischer theorem, 330 Right-hand limit, 94 Ring, 30 I Robison, G. B., 184 Root, IO Root test, 65 Row matrix, 217 Saddle point, 240 Scalar product, 16 Schoenberg. I. J ., 168 Schwarz inequality, 15, 139, 326 Segment, 31 Self-adjoint algebra, 165 Separable space, 45 Separated sets, 42 Separation of points, 162 Sequence, 26 bounded, 48 Cauchy, 52, 82,329 convergent, 47 divergent, 47 double, 144 of functions, 143 increasing, 55 monotonic, 55 pointwise bounded, 155 pointwise convergent, 144 uniformly bounded, 15 5 uniformly convergent, 157 Series, 59 absolutely convergent, 71 alternating, 71 convergent, 59 divergent, 59 geometric, 61 nonabsolutely convergent, 72 power, 69, I 72 product of, 73 trigonometric, 186 uniformly convergent, 157 Set, 3 at most countable, 25 Borel, 309 bounded, 32 bounded above, 3 Cantor, 41, 81, 138, 168, 309 closed, 32 compact, 36 complete orthonormal, 331 connected, 42 convex, 31 countable, 25 Set, dense, 9, 32 elementary, 303 empty, 3 finite, 25 independent, 205 infinite, 25 measurable, 305, 310 nonempty, 3 open, 32 ordered, 3 perfect, 3 2, 41 relatively open, 35 uncountable, 25, 30, 41 Set function, 30 I u-ring, 30 I Simple discontinuity, 94 Simple function, 313 Simplex, 247 affine, 266 differentiable, 269 oriented, 266 Singer, I. M., 280 Solid angle, 294 Space: compact metric, 36 complete metric, 54 connected, 42 of continuous functions, 150 euclidean, 16 Hilbert, 332 of integrable functions, 315, 326 measurable. 310 measure, 310 metric, 30 normal, IOI separable, 45 Span, 204 Sphere, 272, 277, 294 Spivak, M., 272, 280 Square root, 2, 81, 118 Standard basis, 205 Standard presentation, 257 Standard simplex, 266 Stark, E. L .. 199 Step function, 129 Stieltjes integral, 122 Stirling's formula, 194, 200 Stokes' theorem, 253, 272, 287 Stone-Weierstrass theorem, 162, 190,246 Stromberg, K., 21 Subadditivity, 304 Subcover, 36 Subfield, 8, 13 Subsequence, 51 Subsequential limit, 51 Subset, 3 dense, 9, 32 proper, 3 Sum, 5 of complex numbers, 12 of field elements, 5 of forms, 256 ot· functions, 85 Sum, of linear transformations, 207 of oriented simplexes, 268 of real numbers, 18 of series, 59 of vectors, 16 Summation by parts, 70 Support, 246 Supremum, 4 Supremum norm, 150 Surface, 254 Symmetric difference, 305 Tangent plane, 284 Tangent vector, 286 Tangential component, 286 Taylor polynomial, 244 Taylor's theorem, I I 0, 116, 176, 24. Thorpe, J. A., 280 Thurston, H. A., 21 Torus, 239-240, 285 Total derivative, 213 Transforqiation (see Function; Mapping) Transitivity, 25 Triangle inequality, 14, 16, 30, 140 Trigonometric functions, 182 Trigonometric polynomial, 185 Trigonometric series, 186 Uncountable set, 25, 30, 41 Uniform boundedness, 155 Uniform closure, 151 Uniform continuity, 90 Uniform convergence, 147 Uniformly closed algebra, 161 Uniformly continuous mapping, 90 Union, 27 Uniqueness theorem, 119, 258 Unit cube, 247 Unit vector, 2 I 7 Upper bound, 3 Upper integral, 121, I 22 Upper limit, 56 Value, 24 Variable of integration, 122 Vector, 16 Vector field, 281 Vector space, 16, 204 Vector-valued function, 85 derivative of, 112 Volume, 255, 282 Weierstrass test, 148 Weierstrass theorem, 40, 159 Winding number, 20 I Zero set, 98, 117 Zeta function. 14 l","libVersion":"0.3.1","langs":""}
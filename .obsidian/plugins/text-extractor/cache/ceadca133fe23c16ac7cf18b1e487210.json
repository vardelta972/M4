{"path":"iCloudDrive/bks/Number Theory/ivan_niven_herbert_s-_zuckerman_hugh_l-_montgoman-introduction-to-the-theory-of-numbers.pdf","text":"An Introduction to the Theory of Numbers FIFTH EDITION Ivan Niven University of Oregon Herbert S. Zuckerman University of Washington Hugh L. Montgomery University of Michigan John Wiley & Sons, Inc. New York • Chichester • Brisbane • Toronto • Singapore Acquisitions Editor: Bob Macek Designer: Laura Nicholls Copyediting Supervisor: Gilda Stahl Production Manager: Katherine Rubin Production Supervisor: Micheline FJ\"P..derick Manufacturing Manager: Denis C1arke Marketing Manager: Susan Elbe Recognizing the importance of preserving what has been written, it is a policy of John Wiley & Sons, Inc. to have books of enduring value published in the United States printed on acid-free paper, and we exert our best efforts to that end. Copyright© 1960, 1966, 1972, 1980, 1991 by John Wiley & Sons, Inc. All rights reserved. Published simultaneously in Canada. Reproduction or translation of any part of this work beyond that permitted by Sections 107 and 108 of the 1976 United States Copyright Act without the permission of the copyright owner is unlawful. Requests for permission or further information should be addressed to the Permissions Department, John Wiley & Sons. Library of Congress ColtJioging ln Publlclllion Do/JJ: Niven, Ivan Morton, 1915- An introduction to the theory of numbers 1 Ivan Niven, Herbert S. Zuckerman, Hugh L Montgomery.-Sth ed. p. em. lndudes bibliographical references (p. ). lndudes index. ISBN 0-471-62546-9 I. Number theory. L Ill. Title. QA24l.NS6 1991 I. Zuckerman, Herbert S. II. Montgomery, Hugh Sl2'.7--dc20 Printed in the United States of America 10 9 8 7 6 5 4 3 Prinled and bound by Courier Ccmpaniea, Inc. 90-13013 CIP Preface This text is intended for use in a first course in number theory, at the upper undergraduate or beginning graduate level. To make the book appropriate for a wide audience, we have included large collections of problems of varying difficulty. Some effort has been devoted to make the first chapters less demanding. In general, the chapters become gradually more challenging. Similarly, sections within a given chapter are progres­ sively more difficult, and the material within a given section likewise. At each juncture the instructor must decide how deeply to pursue a particular topic before moving ahead to a new subject. It is assumed that the reader has a command of material covered in standard courses on linear algebra and on advanced calculus, although in the early chapters these prerequi­ sites are only slightly used. A modest course requiring only freshman mathematics could be constructed by covering Sections 1.1, 1.2, 1.3 (Theo­ rem 1.19 is optional), 1.4 through Theorem 1.21, 2.1, 2.2, 2.3, 2.4 through Example 9, 2.5, 2.6 through Example 12, 2.7 (the material following Corollary 2.30 is optional), 2.8 through Corollary 2.38, 4.1, 4.2, 4.3, 5.1, 5.3, 5.4, 6.1, 6.2. In any case the instructor should obtain from the publisher a copy of the Instructor's Manual, which provides further suggestions con­ cerning selection of material, as well as solutions to all starred problems. The Instructor's Manual also describes computational experiments, and provides information concerning associated software that is available for use with this book. New in this edition are accounts of the binomial theorem (Section 1.4), public-key cryptography (Section 2.4), the singular situation in Hansel's lemma (Section 2.6), simultaneous systems of linear Diophantine equations (Section 5.2), rational points on curves (Section 5.6), elliptic curves (Section 5.7), description of Faltings' theorem (Section 5.9), the geometry of numbers (Section 6.4), Mertens' estimates of prime number sums (in Section 8. 1), Dirichlet series (Section 8.2), and asymptotic esti­ mates of arithmetic functions (Section 8.3). Many other parts of the books have also been extensively revised, and many new starred problems have v vi Preface been introduced. We address a number of calculational issues, most notably in Section 1.2 (Euclidean algorithm), Section 2.3 (the Chinese remainder theorem), Section 2.4 (pseudoprime tests and Pollard rho factorization), Section 2.9 (Shanks' RESSOL algorithm), Section 3.6 (sums of two squares), Section 4.4 (linear recurrences and Lucas pseudoprimes), Section 5.8 (Lenstra's elliptic curve method of factorization), and Section 7.9 (the continued fraction of a quadratic irrational). In the Appendixes we have provided some important material that all too often is lost in the cracks of the undergraduate curriculum. Number theory is a broad subject with many strong connections with other branches of mathematics. Our desire is to present a balanced view of the area. Each subspecialty possesses a personality uniquely its own, which we have sought to portray accurately. Although much may be learned by exploring the extent to which advanced theorems may be proved using only elementary techniques, we believe that many such arguments fail to convey the spirit of current research, and thus are of less value to the beginner who wants to develop a feel for the subject. In an effort to optimize the instructional value of the text, we sometimes avoid the shortest known proof of a result in favor of a longer proof that offers greater insights. While revising the book we sought advice from many friends and colleagues, and we would most especially like to thank G. E. Andrews, A. 0. L. Atkin, P. T. Bateman, E. Berkove, P. Blass, A. Bremner, J. D. Brillhart, J. W. S. Cassels, T. Cochrane, R. K. Guy, H. W. Lenstra Jr., D. J. Lewis, D. G. Maim, D. W. Masser, J. E. McLaughlin, A. M. Odlyzko, C. Pomerance, K. A. Ross, L. Schoenfeld, J. L. Selfridge, R. C. Vaughan, S. S. Wagstaff Jr., H. J. Rickert, C. Williams, K. S. Williams, and M. C. Wunderlich for their valuable suggestions. We hope that readers will contact us with further comments and suggestions. Ivan Niven Hugh L. Montgomery Contents 1 2 3 Notation Divisibllity 1.1 lntroduction 1 1.2 Divisibility 4 1.3 Primes 20 1.4 The Bionomial Theorem 35 Notes on Chapter 1 44 Congruences 2.1 Congruences 47 2.2 Solutions of Congruences 60 2.3 The Chinese Remainder Theorem 64 2.4 Techniques of Numerical Calculation 74 2.5 Public-Key Cryptography 84 2.6 Prime Power Moduli 86 2.7 Prime Modulus 91 2.8 Primitive Roots and Power Residues 97 2.9 Congruences of Degree Two, Prime Modulus 110 2.10 Number Theory from an Algebraic Viewpoint 115 2.11 Groups, Rings, and Fields 121 Notes on Chapter 2 128 Quadratic Reciprocity and Quadratic Forms 3.1 Quadratic Residues 131 3.2 Quadratic Reciprocity 137 3.3 The Jacobi Symbol 142 3.4 Binary Quadratic Forms ISO xi 1 47 131 vii 3.5 Equivalence and Reduction of Binary Quadratic Forms ISS 3.6 Sums of Two Squares 163 3.7 Positive Definite Binary Quadratic Forms 170 Notes on Chapter 3 176 4 Some Functions of Number Theory 4.1 Greatest Integer Function 180 4.2 Arithmetic Functions 188 4.3 The Mobius Inversion Formula 193 4.4 Recurrence Functions 197 4.5 Combinatorial Number Theory 206 Notes on Chapter 4 211 5 Some Diophantine Equations 5.1 The Equation ax + by = c 212 5.2 Simultaneous Linear Equations 219 5.3 Pythagorean Triangles 231 5.4 Assorted Examples 234 5.5 Ternary Quadratic Forms 240 5.6 Rational Points on Curves 249 5. 7 Elliptic Curves 261 5.8 Factorization Using Elliptic Curves 281 5.9 Curves of Genus Greater Than 1 288 Notes on Chapter 5 289 6 Farey Fractions and Irrational Numbers 6.1 Farey Sequences 297 6.2 Rational Approximations 301 6.3 Irrational Numbers 307 6.4 The Geometry of Numbers 312 Notes on Chapter 6 322 7 Simple Continued Fractions 7.1 The Euclidean Algorithm 32S 7.2 Uniqueness 327 7.3 Infinite Continued Fractions 329 7.4 Irrational Numbers 334 7.5 Approximations to Irrational Numbers 336 180 212 297 325 7.6 Best Possible Approximations 341 7.7 Periodic Continued Fractions 344 7.8 Pell's Equation 351 7.9 Numerical Computation 358 Notes on Chapter 7 359 8 Primes and Multiplicative Number Theory 8.1 Elementary Prime Number Estimates 360 8.2 Dirichlet Series 374 8.3 Estimates of Arithmetic Functions 389 8.4 Primes in Arithmetic Progressions 401 Notes on Chapter 8 406 9 Algebraic Numbers 9.1 Polynomials 410 9.2 Algebraic Numbers 414 9.3 Algebraic Number Fields 419 9.4 Algebraic ln!cgers 424 9.5 Quadratic Fields 425 9.6 Units in Quadratic Fields 428 9.7 Primes in Quadratic Fields 429 9.8 Unique Factorization 431 9.9 Primes in Quadratic Fields Having the Unique Factorization Property 433 9.10 The Equation x3 + y 3 = z3 441 Notes on Chapter 9 445 10 The Partition Function 10.1 Partitions 446 10.2 Ferrers Graphs 448 10.3 Formal Power Series, Generating Functions, and Euler's Identity 452 10.4 Euler's Formula; Bounds on p(n) 457 10.5 Jacobi's Formula 463 10.6 A Divisibility Property 467 Notes on Chapter 10 471 11 The Density of Sequences of Integers 11.1 Asymptotic Density 473 11.2 Schnirelmann Density and the a{3 Theorem 476 Notes on Chapter 11 481 360 409 446 472 Appendices A.l The Fundamental Theorem of Algebra 482 A.2 Symmetric Functions 484 A.3 A Special Value of the Riemann Zeta Function 490 A.4 Linear Recurrences 493 General References Hints Answers Index Contents 482 500 503 512 522 Notation Items are listed in order of appearance. 7L Q IR alb a,f'b akllb [x] (b, c) gcd( b, c) (bl, bz, '' '' bn) [a1, a2, ••• , an] N(a) 'IT( X) f(x) - g(x) MP d\\� n E JY (%) dU� dn� tif(x) a= b (mod m) a \"if; b (mod m) The set of integers, 4 The set of rational numbers, 4 The set of real numbers, 4 a divides b, 4 a does not divide b, 4 akib but ak+l ,f'b, 4 Integer part, 6, 134, 180 The greatest common divisor of b and c, 7 (Alternatively, depending on the context, a point in the plane, or an open interval) The greatest common divisor of b and c, 7 The greatest common divisor of the b;, 7 The least common multiple of the a;. 16 Norm of a, 22, 427 Number of primes p � x, 26 Asymptotic equivalence, 28 (Alternatively, depending on the context, an equivalence relation, 128, 157) Fermat number, 33 (Alternatively, Fibonacci number, 199) Mersenne prime, 33 Subtraction of sets, 34 n is an element of the set JY, 34 Binomial coefficient, 35 Union of sets, 41 Intersection of sets, 41 k th forward difference, 42 a congruent to b modulo m, 48 a not congruent to b modulo m, 48 xi xii cf>(n) ii det (A) card (.W ) /1 X /2 X !Rz (x} spsp(a) :::: - (�) (�) d r f- g H(d) h(d) R(n) r(n) P(n) N(n) w (f) I R,<n) r,<n) Hr(n) GL(n, F) SL(n, R) d(n) u(n) uk(n) w(n) il(n) A(n) ... X ._/,; Notation Euler's totient function, 50 Congruential inverse of a, 52 Determinant of square matrix A, 59 Number of elements in the set .W, 64 Cartesian product of sets, 68 Set of pairs (x, y) of real numbers, 68 Fractional part, (x} = x - [x ], 75 Strong pseudoprime base a, 78 Approximately equal, 85 Isomorphic, as with groups, 118 Legendre symbol, 132 Jacobi symbol, 142 Discriminant of a quadratic form, 150 The modular group, 157 Equivalence of quadratic forms, 157 The class number, 161 The number of primitive classes, 163 Number of representations of n as a sum of two squares, 163 Number of representations of n as a sum of two relatively prime squares, 163 Restricted representations of n as a sum of two squares, 163 Number of solutions of x 2 == - 1 (mod n), 163 Number of automorphs of a quadratic form, 173 The identity matrix, 173 Number of representations by a quadratic form, 174 Number of proper representations of n by a quadratic form, 174 Generalization of N(n), 174 General linear group, 177 Special linear group, 177 Number of positive divisors, 188 Sum of the positive divisors, 188 Sum of the k th powers of the positive divisors, 188 Number of distinct prime factors, 188 Total number of primes dividing n, counting multiplicity, 188 Liouville's lambda function, 192 Notation Ln Un(a, b), V,(a, b) Cl, C2, C3 Rl, R2, R3 Mt �(�) AB IP'z(�) E,(�) ECM (a0, a1,. • ·, ai) ----:-- (bo, b1,. • ·, bi, a0, a1,. • ·, an_1) A(n) 1/J(x) it(x) f(x) = O(g(x)) ((s) 'Y Q[x] Z[x] Q(�) modulo G(x) p(n) Pm(n), P0(n), pd(n), q•(n), q0(n) .s:&'-::J� � SI(.W) S(.s:&') d(.s:&') .s:&'+� Ul, Uz, • • •' Un D(J) Mobius mu function, 193 Fibonacci number, 199 xiii (Alternatively, depending on the context, a Fermat number, 33) Lucas number, 199 Lucas functions, 201 Column operations on matrices, 217 Row operations on matrices, 221 Transpose of a matrix, 229 Curve, 249 Point on a curve, determined by the points A and B, 256 Projective plane, 259 Group of points on an elliptic curve, 270 Elliptic curve method of factoring, 281 Continued fraction, 326 Periodic continued fraction, 345 von Mangoldt lambda function, 361 Sum of A(n) over n ,;; x, 361 Sum of log p over primes p ,;; x, 361 f is of the order of g, 365 Riemann zeta function, 375 Euler's constant, 392 Set of polynomials in x with rational coefficients, 410 Set of polynomials in x with integral coefficients, 410 Algebraic number field, 419 Polynomial congruences, 420 Partition function, 446 Restricted partition functions, 446 Same as � c .W, � is a subset of .W, 472 Complement of .W, 472 Asymptotic density of .W, 473 Natural density of .W, 473 Schnirelmann density of .W, 476 Sum of two sets, 477 Elementary symmetric polynomials, 485 Discriminant of a polynomial J, 487 CHAPTER I Divisibility 1.1 INTRODUCTION The theory of numbers is concerned with properties of the natural num­ bers 1, 2, 3, 4, · · · , also called the positive integers. These numbers, together with the negative integers and zero, form the set of integers. Properties of these numbers have been studied from earliest times. For example, an integer is divisible by 3 if and only if the sum of its digits is divisible by 3, as in the number 852 with sum of digits 8 + 5 + 2 = 15. The equation x 2 + y 2 = z 2 has infinitely many solutions in positive integers, such as 32 + 42 = 5 2, whereas x3 + y3 = z 3 and x4 + y 4 = z 4 have none. There are infinitely many prime numbers, where a prime is a natural number such as 31 that cannot be factored into two smaller natural numbers. Thus, 33 is not a prime, because 33 = 3 · 11. The fact that the sequence of primes, 2, 3, 5, 7, 11, 13, 17,- · · , is end­ less was known to Euclid, who lived about 350 B.c. Also known to Euclid was the result that .fi is an i\"ational number, that is, a number that cannot be expressed as the quotient a jb of two integers. The numbers 2/7, 13/5, -14/9, and 99/ 100 are examples of rational numbers. The integers are themselves rational numbers because, for example, 7 can be written in the form 7/ 1. Another example of an irrational number is 7T, the ratio of the circumference to the diameter of any circle. The rational number 22/7 is a good approximation to 7T, close but not precise. The fact that 7T is irrational means that there is no fraction a jb that is exactly equal to 7T, with a and b integers. In addition to known results, number theory abounds with unsolved problems. Some background is needed just to state these problems in many cases. But there are a few unsolved problems that can be understood with essentially no prior knowledge. Perhaps the most famous of these is the conjecture known as Fermat's last theorem, which is not really a theorem at all because it has not yet been proved. Pierre de Fermat (1601-1665) stated that he had a truly wondrous proof that the equation xn + yn = zn has no solutions in positive integers x, y, z for any exponent n > 2. Fermat added that the margin of the book was too small to hold the 1 2 Divisibility proof. Whether Fermat really had a proof is not known, but it now seems unlikely, as the question has eluded mathematicians since his time. Results in number theory often have their sources in empirical obser­ vations. We might notice, for example, that every natural number up to 1000 can be expressed as a sum of four squares of natural numbers, as illustrated by We might then feel confident enough to make the conjecture that every natural number is expressible as a sum of four squares. This turns out to be correct; it is presented as Theorem 6.2& in Chapter 6. The first proof of this result was given by J. L. Lagrange (1736- 1813). We say that the four square theorem is best possible, because not every positive integer is expressible as a sum of three squares of integers, 7 for example. Of course, a conjecture made on the basis of a few examples may turn out to be incorrect. For example, the expression n2 - n + 41 is a prime number for n = 1, 2, 3, · · ·, 40 because it is easy to verify that 41, 43, 47, 53,· · ·, 1601 are indeed prime numbers. But it would be hasty to conjecture that n2 - n + 41 is a prime for every natural number n, because for n = 41 the value is 412• We say that the case n = 41 is a counterexample to the conjecture. Leonhard Euler (1707- 1783) conjectured that no nth power is a sum of fewer than n nth powers (the Swiss name Euler is pronounced \"Oiler\"). For n = 3, this would assert that no cube is the sum of two smaller cubes. This is true; it is proved in Theorem 9.35. However, a counterexample to Euler's conjecture was provided in 1968 by L. J. Lander and Thomas Parkin. As the result of a detailed computer search, they found that 1445 = 275 + 845 + 1105 + 1355. In 1987, N. J. Elkies used the arithmetic of elliptic curves to discover that 206156734 = 26824404 + 153656394 + 187967604' and a subsequent computer search located the least counterexample to Euler's conjecture for fourth powers. The Goldbach conjecture asserts that every even integer greater than 2 is the sum of two primes, as in the examples 4 = 2 + 2, 6 = 3 + 3, 20 = 7 + 13, 50= 3 + 47, 100 = 29 + 71. Stated by Christian Goldbach in 1742, verified up to 100,000 at least, this conjecture has evaded all attempts at proof. 1.1 Introduction 3 Because it is relatively easy to make conjectures in number theory, the person whose name gets attached to a problem has often made a lesser contribution than the one who later solves it. For example, John Wilson (1741 -1793) stated that every prime pis a divisor of (p - 1)! + 1, and this result has henceforth been known as Wilson's theorem, although the first proof was given by Lagrange. However, empirical observations are important in the discovery of general results and in testing conjectures. They are also useful in under­ standing theorems. In studying a book on number theory, you are well advised to construct numerical examples of your own devising, especially if a concept or a theorem is not well understood at first. Although our interest centers on integers and rational numbers, not all proofs are given within this framework. For example, the proof that 1r is irrational makes use of the system of real numbers. The proof that x3 + y3 = z3 has no solution in positive integers is carried out in the setting of complex numbers. Number theory is not only a systematic mathematical study but also a popular diversion, especially in its elementary form. It is part of what is called recreational mathematics, including numerical curiosities and the solving of puzzles. This aspect of number theory is not emphasized in this book, unless the questions are related to general propositions. Neverthe­ less, a systematic study of the theory is certainly helpful to anyone looking at problems in recreational mathematics. The theory of numbers is closely tied to the other areas of mathemat­ ics, most especially to abstract algebra, but also to linear algebra, combina­ torics, analysis, geometry, and even topology. Consequently, proofs in the theory of numbers rely on many different ideas and methods. Of these, there are two basic principles to which we draw especial attention. The first is that any set of positive integers has a smallest element if it contains any members at all. In other words, if a set ../ of positive integers is not empty, then it contains an integer s such that for any member a of ../, the relation s �a holds. The second principle, mathematical induction , is a logical consequence of the first. 1 It can be stated as follows: If a set ../ of positive integers contains the integer 1, and contains n + 1 whenever it contains n, then ../ consists of all the positive integers. It also may be well to point out that a simple statement which asserts that there is an integer with some particular property may be easy to prove, by simply citing an example. For example, it is easy to demonstrate the proposition, \"There is a positive number that is not the sum of three squares,\" by noting that 7 is such a number. On the other hand, a 1Compare G. Birkhoff and S. Macl..ane, A Survey of Modem Algebra, 4th ed., Macmillan (New York), 1977, 10--13. 4 Divisibility statement which asserts that all numbers possess a certain property cannot be proved in this manner. The assertion, \"Every prime number of the form 4n + 1 is a sum of two squares,\" is substantially more difficult to establish (see Lemma 2.13 in Section 2.1). Finally, it is presumed that you are familiar with the usual formulation of mathematical propositions. In particular, if A and B are two assertions, the following statements are logically equivalent-they are just different ways of saying the same thing. A implies B. If A is true, then B is true. In order that A be true it is necessary that B be true. B is a necessary condition for A. A is a sufficient condition of B. If A implies B and B implies A, then one can say that B is a necessary and sufficient cOndition for A to hold. In general, we shall use letters of the roman alphabet, a, b, c, · · · , m, n,- · ·, x, y, z, to designate integers unless otherwise specified. We let 7L denote the set {- 2, - 1, 0, 1, 2, · · · } of all integers, iQ the set of all rational numbers, IR the set of all real numbers, and C the set of all complex numbers. 1.2 DIVISIBILITY Divisors, multiples, and prime and composite numbers are concepts that have been known and studied at least since the time of Euclid, about 350 e.c. The fundamental ideas are developed in this and the next section. Definition 1.1 An integer b is divisible by an integer a, not zero, if there is an integer x such that b = ax, and we write a lb. In case b is not divisible by a, we write a% b. Other language for the divisibility property a lb is that a divides b, that a is a divisor of b, and that b is a multiple of a. If alb and 0 < a < b, then a is called a proper divisor of b. It is understood that we never use 0 as the left member of the pair of integers in a lb. On the other hand, not only may 0 occur as the right member of the pair, but also in such instances we always have divisibility. Thus a I 0 for every integer a not zero. The notation a K IIb is sometimes used to indicate that a Kib but aK+I_.rb. 1.2 Divisibility Theorem 1.1 (1) a I b implies a I be for any integer c; (2) alb and b l c imply a lc; (3) alb and al e imply al (bx + cy) for any integers x and y; (4) al b and bla imply a = ±b; (5) al b, a > 0, b > 0, imply a � b; (6) if m.;, 0, alb implies and is implied by ma lmb. 5 Proof The proofs of these results follow at once from the definition of divisibility. Property 3 admits an obvious extension to any finite set, thus: Property 2 can be extended similarly. To give a sample proof, consider item 3. Since alb and a lc are given, this implies that there are integers r and s such that b = ar and c = as. Hence, bx + cy can be written as a(rx + sy ), and this proves that a is a divisor of bx + cy. The next result is a formal statement of the outcome when any integer b is divided by any positive integer. For example, if 25 is divided by 7, the quotient is 3 and the remainder is 4. These numbers are related by the equality 25 = 7 · 3 + 4. Now we formulate this in the general case. Theorem 1.2 The division algorithm. Given any integers a and b, with a > 0, there exist unique integers q and r such that b = qa + r, 0 � r <a. If a%b, then r satisfies the stronger inequalities 0 < r <a. Proof Consider the arithmetic progression · ·· ,b - 3a ,b - 2a, b - a, b ,b + a, b + 2a , b + 3a , · · · extending indefinitely in both directions. In this sequence, select the smallest non-negative member and denote it by r. Thus by definition r satisfies the inequalities of the theorem. But also r, being in the sequence, is of the form b - qa, and thus q is defined in terms of r. To prove the uniqueness of q and r, suppose there is another pair q1 and r1 satisfying the same conditions. First we prove that r1 = r. For if not, we may presume that r < r1 so that 0 < r1 - r <a, and then we see 6 Divisibility that r1 - r = a(q - q1) and so a l(r1 - r), a contradiction to Theorem 1.1, part 5. Hence r = r1, and also q = q1• We have stated the theorem with the assumption a > 0. However, this hypothesis is not necessary, and we may formulate the theorem without it: given any integers a and b, with a -:/= 0, there exist integers q and r such that b = qa + r, 0 � r < Ia I. Theorem 1.2 is called the division algorithm. An algorithm is a mathe­ matical procedure or method to obtain a result. We have stated Theorem 1.2 in the form \"there exist integers q and r, \" and this wording suggests that we have a so-called existence theorem rather than an algorithm. However, it may be observed that the proof does give a method for obtaining the integers q and r, because the infinite arithmetic progression · · · , b -a, b, b + a , ··· need be examined only in part to yield the smallest positive member r. In actual practice the quotient q and the remainder r are obtained by the arithmetic division of a into b. Remark on Ca/culalic,n Given integers a and b, the values of q and r can be obtained in two steps by u�e of a hand-held calculator. As a simple example, if b = 963 and a ,:\"'148; the calculator gives the answer 2.25 if 428 is divided into 963. From this we know that the quotient q = 2. To get the remainder, we multiply 428 by 2, and subtract the result from 963 to obtain r = 107. In case b = 964 and a = 428 the calculator gives 2.2523364 as the answer when 428 is divided into 964. This answer is approximate, not exact; the exact answer is an infinite decimal. Nevertheless, the value of q is apparent, because q is the largest integer not exceeding 964/428; in this case q = 2. In symbols we write q = [964/428). (In general, if x is a real number then [x) denotes the largest integer not exceeding x. That is, [x) is the unique integer such that [x) � x < [x) + 1. Further proper­ ties of the function [ x J are discussed in Section 4.1.) The value of r can then also be determined, as r = b - qa = 964 - 2 · 428 = 108. Because the value of q was obtained by rounding down a decimal that the calculator may not have determined to sufficient precision, there may be a question as to whether the calculated value of q is correct. Assuming that the calculator performs integer arithmetic accurately, the proposed value of q is confirmed by checking that the proposed remainder b - qa = 108 lies in the interval 0 � r < a = 428. In case r alone is of interest, it would be tempting to note that 428 times 0.2523364 is 107.99997, and then round to the nearest integer. The method we have described, though longer, is more reliable, as it depends only on integer arithmetic. 1. 2 Divisibility 7 Definition 1.2 The integer a is a common divisor of band c in case alb and a I c. Since there is only a finite number of divisors of any nonzero integer, there is only a finite number of common divisors of b and c, except in the case b = c = 0. If at least one of b and c is not 0, the greatest among their common divisors is called the greatest common divisor of b and c and is denoted by (b, c). Similarly, we denote the greatest common divisor g of the integers b1, b2, . • ·, bn , not all zero, by (b1, b2, . • ·, bn). Thus the greatest common divisor (b, c) is defined for every pair of integers b, c except b = 0, c = 0, and we note that (b, c) � 1. Theorem 1.3 If g is the greatest common divisor of b and c, then there exist integers x0 and Yo such that g = (b, c) = bx0 + cy0• Another way to state this very fundamental result is that the greatest common divisor (abbreviated g.c.d.) of two integers b and c is expressible as a linear combination of b and c with integral multipliers x0 and y0• This assertion holds not just for two integers but for any finite collection, as we shall see in Theorem 1.5. Proof Consider the linear combinations bx + cy, where x and y range over all integers. This set of integers {bx + cy} includes positive and negative values, and also 0 by the choice x = y = 0. Choose x0 and Yo so that bx0 + cy0 is the least positive integer I in the set; thus I = bx0 + cy0• Next we prove that lib and /I c. We establish the first of these, and the second follows by analogy. We give an indirect proof that lib, that is, we assume 1% b and obtain a contradiction. From 1% b it follows that there exist integers q and r, by Theorem 1.2, such that b = lq + r with 0 < r < /. Hence we have r = b - lq = b - q(bx0 + cy0) = b(l - qx0) + c( -qy0), and thus r is in the set {bx + cy}. This contradicts the fact that I is the least positive integer in the set {bx + cy}. Now since g is the greatest common divisor of b and c, we may write b = gB, c = gC, and I = bx0 + cy0 = g(Bx0 + Cy0). Thus gil, and so by part 5 of Theorem 1.1, we conclude that g �I. Now g <I is impossible, since g is the greatest common divisor, so g = I = bx0 + cy0• Theorem 1.4 The greatest common divisor g of b and c can be characterized in the following two ways: (1) It is the least positive value of bx + cy where x and y range over all integers; (2) it is the positive common divisor of b and c that is divisible by every common divisor. 8 Divisibility Proof Part 1 follows from the proof of Theorem 1.3. To prove part 2, we observe that if d is any common divisor of b and c, then d lg by part 3 of Theorem 1.1. Moreover, there cannot be two distinct integers with prop­ erty 2, because of Theorem 1.1, part 4. If an integer d is expressible in the form d = bx + cy, then d is not necessarily the g.c.d. (b, c). However, it does follow from such an equation that (b, c) is a divisor of d. In particular, if bx + cy = 1 for some integers x and y, then (b, c) = 1. Theorem 1.5 Given any integers bp b2, . • ·, bn not all zero, with greatest common divisor g, there exist integers x 1, x 2, • • • , x n such that n g= ( b1 , b2 , .·· ,bn )= L,bjxj. j=l Furthermore, g is the least positive value of the linear form f.j_ 1bjyi where the yi range over all integers; also g is the positive common divisor of b1, b2 , . • ·, bn that is divi:;ible by every common divisor . Proof This result is a straightforward generalization of the preceding two theorems, and the proof is analogous without any complications arising in the passage from two integers to n integers. Theorem 1.6 For any positive integer m, (ma, mb ) = m( a ,b). Proof By Theorem 1.4 we have ( ma , mb ) = least positive value of max + mby = m · {least positive value of ax + by} = m( a, b) . Theorem 1.7 If dla and dlb and d > 0, then (�·�) = � (a, b ) . If (a, b) = g, then 1. 2 Divisibility 9 Proof The second assertion is the special case of the first obtained by using the greatest common divisor g of a and b in the role of d. The first assertion in turn is a direct consequence of Theorem 1.6 obtained by replacing m, a, b in that theorem by d, ajd, bjd respectively. Theorem 1.8 If (a, m) = (b, m) = 1, then (ab, m) = 1. Proof By Theorem 1.3 there exist integers x0, y0, x 1, y 1 such that 1 = ax0 + my0 = bx1 + my1• Thus we may write (ax0Xbx1) = (1 - my0) (1 - my1) = 1 - my2 where y2 is defined by the equation y2 = Yo+ Y1 - my0y1. From the equation abx0x1 + my2 = 1 we note, by part 3 of Theorem 1.1, that any common divisor of ab and m is a divisor of 1, and hence (ab, m) = 1. Definition 1.3 We say that a and b are relatively prime in case (a, b) = 1, and that a1, a2, · · · , an are relatively prime in case (a1, a2, · · · , an) = 1. We say that a1, a2 ,- ·· ,an are relatively prime in pairs in case (a;, a) = 1 for all i = 1, 2, - · · , n and j = 1, 2, - · · , n with i * j. The fact that (a, b) = 1 is sometimes expressed by saying that a and b are coprime, or by saying that a is prime to b. Theorem 1.9 For any integer x, (a, b) = (b, a) = (a, - b)= (a, b + ax). Proof Denote (a, b) by d and (a, b +ax) by g. It is clear that (b, a) = (a, - b) = d. By Theorem 1 .3, we know that there exist integers x0 and y0 such that d = ax0 + by0. Then we can write It follows that the greatest common divisor of a and b + ax is a divisor of d, that is, gld. Now we can also prove that dig by the following argument. Since dla and dlb, we see that dl(b + ax) by Theorem 1.1, part 3. And from Theorem 1.4, part 2, we know that every common divisor of a and b + ax is a divisor of their g.c.d., that is, a divisor of g. Hence, dig. From dig and gld, we conclude that d = ±g by Theorem 1. 1, part 4. However, d and g are ooth positive by definition, so d = g. 10 Theorem 1.10 If c lab and (b, c) = 1, then cIa. Divisibility Proof By Theorem 1.6, (ab, ac) = a(b, c) = a. By hypothesis clab and clearly c lac, so cIa by Theorem 1.4, part 2. Given two integers b and c, how can the greatest common divisor g be found? Definition 1.2 gives no answer to this question. The investiga­ tion of the set of integers {bx + cy} to find a smallest positive element is not practical for large values of b and c. If b and c are small, values of g, x0, and y0 such that g = bx0 + cy0, can be found by inspection. For example, if b = 10 and c = 6, it is obvious that g = 2, and one pair of values for x0, y0 is 2, - 3. But if b and c are large, inspection is not adequate except in rather obvious cases such as (963, 963) = 963 and (1000, 600) = 200. However, Theorem 1.9 can be used to calculate g effectively and also to get values of x0 and y0. (The reason we want values of x0 and y0 is to find integral solutions of linear equations. These turn up in many simple problems in number theory.) We now discuss an example to show how Theorem 1.9 can be used to calculate the greatest common divisor. Consider the case b = 963, c = 657. If we divide c into b, we get a quotient q = 1, and remainder r = 306. Thus b = cq + r, or r = b - cq, in particular 306 = 963 - 1 · 657. Now (b, c) = (b - cq, c) by replacing a and x by c and -q in Theorem 1.9, so we see that (963 , 657) = (963 - 1 . 657, 657) = (306, 657) . The integer 963 has been replaced by the smaller integer 306, and this suggests that the procedure be repeated. So we divide 306 into 657 to get a quotient 2 and a remainder 45, and (306, 657) = (306, 657 - 2 . 306) = (306, 45) . Next 45 is divided into 306 with quotient 6 and remainder 36, then 36 is divided into 45 with quotient 1 and remainder 9. We conclude that (963, 657) = (306,657) = (306, 45) = (36, 45) = (36, 9) . Thus (963, 657) = 9, and we can express 9 as a linear combination of 963 and 657 by sequentially writing each remainder as a linear combination of 1.2 Divisibility the two original numbers: 306 = %3 - 657; 45 = 657 - 2 . 306 = 657 - 2 . (%3 - 657) = 3 . 657 - 2 . 963 ; 36 = 306 - 6 . 45 = ( 963 - 657) - 6 . ( 3 . 657 - 2 . 963) = 13 . 963 - 19 . 657; 9 = 45 - 36 = 3 . 657 - 2 . 963 - ( 13 . 963 - 19 . 657) = 22 . 657 - 15 . 963 . 11 In terms of Theorem 1 .3, where g = (b, c) = bx0 + cy0, beginning with b = 963 and c = 657 we have used a procedure called the Euclidean algorithm to find g = 9, x0 = -15, y0 = 22. Of course, these values for x0 and y0 are not unique: -15 + 657k and 22 - 963k will do where k is any integer. To find the greatest common divisor (b, c) of any two integers b and c, we now generalize what is done in the special case above. The process will also give integers x0 and y0 satisfying the equation bx0 + cy0 = (b, c). The case c = 0 is special: (b, 0) = lb l. For c '* 0, we observe that (b, c) = (b, -c) by Theorem 1 .9, and hence, we may presume that c is positive. Theorem 1.11 The Euclidean algorithm. Given integers b and c > 0, we make a repeated application of the division algorithm, Theorem 1.2, to obtain a series of equations b = cq1 + rp c = rtq2 + r2 , rt = r2q3 + r3 , rj-t = rjqj+ t· 0 < r1 < c, 0 < r2 < rt > 0 < r3 < r2 , The greatest common divisor (b, c) of b and c is rj, the last nonzero remainder in the division process. Values of x0 and Yo in (b, c) = bx0 + cy0 can be obtained by writing each r; as a linear combination of b and c. Proof The chain of equations is obtained by dividing c into b, r1 into c, r 2 into r 1> · · , rj into rj _ 1. The process stops when the division is exact, that is, when the remainder is zero. Thus in our application of Theorem 1.2 we have written the inequalities for the remainder without an equality sign. Thus, for example, 0 < r1 < c in place of 0 � r1 < c, because if r1 12 Divisibility were equal to zero, the chain would stop at the first equation b = cqi> in which case the greatest common divisor of b and c would be c. We now prove that ri is the greatest common divisor g of b and c. By Theorem 1.9, we observe that Continuing by mathematical induction, we get (b, c) = (ri _ t> r) = (ri, 0) =-� 'j· To see that 'i is a linear combination of b and c, we argue by induction that each r; is a linear combination of b and c. Clearly, r1 is such a linear combination, and likewise r2• In general, r; is a linear combination of r; _ 1 and r; _ 2• By the inductive hypothesis we may suppose that these latter two numbers are linear combinations of b and c, and it follows that r; is also a linear combination of b and c. Example 1 Find the greatest common divisor of 42823 and 6409. Solution We apply the Euclidean algorithm, using a calculator. We divide c into b, where b = 42823 and c = 6409, following the notation of Theorem 1.11. The quotient q1 and remainder r1 are q1 = 6 and r1 = 4369, with the details of this division as follows. Assuming the use of the simplest kind of hand-held calculator with only the four basic operations + , - , X , + , when 6409 is divided into 42823 the calculator gives 6.6816976, or some version of this with perhaps fewer decimal places. So we know that the quotient is 6. To get the remainder, we multiply 6 by 6409 to get 38454, and we subtract this from 42823 to get the remainder 4369. Continuing, if we divide 4369 into 6409 we get a quotient q2 = 1 and remainder r2 = 2040. Dividing 2040 into 4369 gives q3 = 2 and r3 = 289. Dividing 289 into 2040 gives q4 = 7 and r4 = 17. Since 17 is an exact divisor of 289, the solution is that the g.c.d. is 17. This can be put in tabular form as follows: 42823 = 6 . 6409 + 4369 6409 = 1 . 4369 + 2040 4369 = 2 . 2040 + 289 2040 = 7 . 289 + 17 289 = 17 . 17 {42823, 6409) = {6409, 4369) = ( 4369, 2040) = {2040, 289) = {289, 17) = 17 1. 2 Divisibility Example 2 Find integers x and y to satisfy 42823x + 6409y = 17. Solution We find integers X; and Y; such that 42823x; + 6409y; = r;. 13 Here it is natural to consider i = 1, 2, · · ·, but to initiate the process we also consider i = 0 and i = -1. We put r _ 1 = 42823, and write 42823 . 1 + 6409 . 0 = 42823 . Similarly, we put r0 = 6409, and write 42823 . 0 + 6409 . 1 = 6409. We multiply the second of these equations by q1 = 6, and subtract the result from the first equation, to obtain 42823 . 1 + 6409 . ( -6) = 4369. We multiply this equation by q2 = 1, and subtract it from the preceding equation to find that 42823 . ( -1) + 6409 . 7 = 2040. We multiply this by q3 = 2, and subtract the result from the preceding equation to find that 42823 . 3 + 6409 . ( -20) = 289. Next we multiply this by q4 = 7, and subtract the result from the preced­ ing equation to find that 42823 . ( -22) + 6409 . 147 = 17. On dividing 17 into 289, we find that q5 = 17 and that 289 = 17 · 17. Thus r4 is the last positive remainder, so that g = 17, and we may take x = -22, y = 147. These values of x and y are not the only ones possible. In Section 5.1, an analysis of all solutions of a linear equation is given. 14 Divisibility Remark on Calculation. We note that X; is determined from X;_1 and x;_2 by the same formula that r1 is determined from r;_1 and r;_2• That is, and similarly Y; = Y;-2 - Q;Y;-t· The only distinction between the three sequences r;, X;, and Y; is that they start from different initial conditions: r -I = b, r0 = c, x_t = 1, x0 = 0, and Y-t = 0, Yo = 1. Just as polynomial division may be effected symbolically, omitting the powers of the variable, we may generate the Q;, r;, X;, Y; in a compact table. In the numerical example just considered, this would take the following form: qi+l r; X; Y; -1 42823 1 0 0 6 6409 0 1 1 1 4369 1 -6 2 2 2040 - 1 7 3 7 289 3 - 20 4 17 17 -22 147 5 0 When implemented on a computer, it is unnecessary to record the entire table. Each row is generated solely from the two preceding rows, so it suffices to keep only the two latest rows. In the numerical cases we have considered it has been the case that b > c. Although it is natural to start in this way, it is by no means necessary. If b < c, then q1 = 0 and r1 = b, which has the effect of interchanging b and c. Example 3 Find g = (b, c) where b = 5033464705 and c = 3137640337, and determine x and y such that bx + cy = g. 1. 2 Divisibility 15 Solution We calculate: 5033464705 1 0 1 3137640337 0 1 1 1895824368 1 -1 1 1241815969 -1 2 1 654008399 2 -3 1 587807570 -3 5 8 66200829 5 -8 1 58200938 -43 69 7 7999891 48 -77 3 2201701 -379 608 1 1394788 1185 -1901 1 806913 - 1564 2509 1 587875 2749 -4410 2 219038 -4313 6919 1 149799 11375 -18248 2 69239 -15688 25167 6 11321 4275 1 -68582 8 13 13 -272194 436659 1 817 2220303 -3561854 1 496 -2492497 3998513 1 321 4712800 -7560367 1 175 -7205297 11558880 1 146 11918097 - 191 19247 5 29 - 19123394 30678127 29 1 107535067 - 172509882 Thus g = 1, and we may take x = 107535067, y = - 172509882. The exact number of iterations j of the Euclidean algorithm required to calculate (b, c) depends in an intricate manner on b and c, but it is easy to establish a rough bound for j as follows: If r; is small compared with r;_1 , say r; � r;_1j2, then substantial progress has been made at this step. Otherwise r;_1j2 < r; < r;_1, in which case qi+l = 1, and r;+1 = r;_1 - r; < r; _ 1/2 . Thus we see that r; + 1 < r; _ 1/2 in either case. From this it can be deduced that j < 3log c. (Here, and throughout this book, we employ the natural logarithm, to the base e. Some writers denote this function In x.) With more care we could improve on the constant 3 (see Problem 10 in Section 4.4), but it is nevertheless the case that j is comparable to log c 16 Divisibility for most pairs b, c. Since the logarithm increases very slowly, the practical consequence is that one can calculate the g.c.d. quickly, even when b and c are very large. Definition 1.4 The integers a 1, a2, • · ·,an , all different from zero, have a common multiple b if a; lb for i = 1, 2, · · ·, n . (Note that common multiples do exist; for example the product a1a2 • • · an is one.) The least of the positive common multiples is called the least common multiple, and it is denoted by [ap a2 , .. . , an ]. Theorem 1.12 If b is any common multiple of a1, a2 , ··· , an , then [ap a2, . ·· ,an ] lb. This is the same as saying that ifh denotes [a 1, a2 ,- ·· ,an ], then 0, ± h, ± 2h, ± 3h, · · · comprise all the common multiples of a p a2, - ·· , an. Proof Let m be any common multiple and divide m by h. By Theorem 1.2 there is a quotient q and a remainder r such that m = qh + r, 0 � r < h. We must prove that r = 0. If r =F 0 we argue as follows. For each i = 1, 2, - · · , n we know that a; lh and a;lm, so that a; ir. Thus r is a positive common multiple of a t> a2 ,- · · ,an contrary to the fact that h is the least of all the positive common multiples. Theorem 1.13 lf m > 0, [rna, mb] = m[a, b]. Also [a, b] ·(a, b) = lab I . Proof Let H = [rna, mb ], and h = [a, b]. Then mh is a multiple of rna and mb, so that mh � H. Also, H is a multiple of both rna and mb, so H jm is a multiple of a and b. Thus, H jm � h, from which it follows that mh = H, and this establishes the first part of the theorem. It will suffice to prove the second part for positive integers a and b, since [a, - b] = [a, b]. We begin with the special case where (a, b) = 1. Now [a, b] is a multiple of a, say rna. Then blma and (a, b) = 1, so by Theorem 1.10 we conclude that blm. Hence b � m, ba � rna. But ba , being a positive common multiple of b and a, cannot be less than the least common multiple, so ba =rna = [a, b]. Turning to the general case where (a, b) = g > 1, we have (ajg, bjg) = 1 by Theorem 1.7. Applying !he result of the preceding paragraph, we obtain [�·�H�· �) = ��· Multiplying by g 2 and using Theorem 1.6 as well as the first part of the present theorem, we get [a, b](a, b) = ab. 1.2 Divisibility 17 PROBLEMS 1. By using the Euclidean algorithm, find the greatest common divisor (g.c.d.) of (a) 7469 and 2464; (c) 2947 and 3997; (b) 2689 and 4001; (d) 1109 and 4999. 2. Find the greatest common divisor g of the numbers 1819 and 3587, and then find integers x and y to satisfy 1819x + 3587y =g. 3. Find values of x and y to satisfy (a) 423x + 198y = 9; (b) 71x - SOy = 1; (c) 43x + 64y = 1; (d) 93x - 81y = 3; (e) 6x + lOy + 15z = 1. 4. Find the least common multiple O.c.m.) of (a) 482 and 1687, (b) 60 and 61. 5. How many integers between 100 and 1000 are divisible by 7? 6. Prove that the product of three consecutive integers is divisible by 6; of four consecutive integers by 24. 7. Exhibit three integers that are relatively prime but not relatively prime in pairs. 8. Two integers are said to be of the same parity if they are both even or both odd; if one is even and the other odd, they are said to be of opposite parity, or of different parity. Given any two integers, prove that their sum and their difference are of the same parity. 9. Show that if ac lbc then al b. 10. Given alb and cld, prove that aclbd. 11. Prove that 4%(n2 + 2) for any integer n. 12. Given that (a, 4) = 2 and (b, 4) = 2, prove that (a + b, 4) = 4. 13. Prove that n2 - n is divisible by 2 for every integer n; that n3 - n is divisible by 6; that n5 - n is divisible by 30. 14. Prove that if n is odd, n2 - 1 is divisible by 8. 15. Prove that if x and y are odd, then x 2 + y 2 is even but not divisible by 4. 16. Prove that if a and b are positive integers satisfying (a, b) = [a, b] then a= b. 17. Evaluate (n, n + 1) and [n, n + 1] where n is a positive integer. 18 Divisibility 18. Find the values of (a, b) and [a, b] if a and b are positive integers such that a lb. 19. Prove that any set of integers that are relatively prime in pairs are relatively prime. 20. Given integers a and b, a number n is said to be of the form ak + b if there is an integer k such that ak + b = n. Thus the numbers of the form 3k + 1 are · · · - 8, - 5, - 2, 1, 4, 7, 10, · · · . Prove that every integer is of the form 3k or of the form 3k + 1 or of the form 3k + 2. 21. Prove that if an integer is of the form 6k + 5, then it is necessarily of the form 3k - 1, but not conversely. 22. Prove that the square of any integer of the form 5k + 1 is of the same form. 23. Prove that the square of any integer is of the form 3k or 3k + 1 but not of the form 3k + 2. 24. Prove that no integers x, y exist satisfying x + y = 100 and (x, y) =3. 25. Prove that there are infinitely many pairs of integers x, y satisfying x + y = 100 and (x, y) = 5. 26. Let s and g > 0 be given integers. Prove that integers x and y exist satisfying x + y = s and (x, y) = g if and only if gl s . 27. Find positive integers a and b satisfying the equations (a, b) = 10 and [a, b] = 100 simultaneously. Find all solutions. 28. Find all triples of positive integers a, b, c satisfying (a, b, c) = 10 and [a, b, c) = 100 simultaneously. 29. Let g and I be given positive integers. Prove that integers x and y exist satisfying (x, y) = g and [x, y] = I if and only if gil. 30. Let b and g > 0 be given integers. Prove that the equations (x, y) = g and xy = b can be solved simultaneously if and only if g2 lb. 31. Let n ;;;. 2 and k be any positive integers. Prove that (n - 01 (nk - 1). 32. Let n ;;;. 2 and k be any positive integers. Prove that (n - 02 1 (nk - 1) if and only if (n - Olk. (H)t 33. Prove that (a, b) = (a, b, a + b), and more generally that (a, b) = (a, b, ax + by) for all integers x, y. 34. Prove that (a, a + k)lk for all integers a, k not both zero. 35. Prove that (a, a + 2) = 1 or 2 for every integer a. t The designation (H) ind icates that a Hint is provided at the end of the book. 1. 2 Divisibility 19 36. Prove that (a, b, c) = ((a, b), c). 37. Prove that (a�> a 2 , . • · , an ) = ((a 1, a 2 > · · , an _1), an ). 38. Extend Theorems 1.6, 1. 7, and 1.8 to sets of more than two integers. 39. Suppose that the method used in the proof of Theorem 1.11 is employed to find x and y so that bx + cy = g. Thus bx; + cy; = r;. Show that (- 1h; � Oand (- l)iy; � Ofor i = -1 ,0, 1, 2, . · · , j + 1. Deduce that lxi+ 1 1 = lx;_11 + Q;+ 11x; l and IY;+ 11 = IY; - 11 + Q;+ 1 IY; I for i = 0, 1, . · · , j. 40. With the X; and Y; determined as in Problem 39, show that X; _1 y; - X; Y;-1 = ( -1); for i = 0, 1, 2, - · · , j + 1. Deduce that (x;, y) = 1 for i = - 1, 0, 1, - · · , j + 1. (H) 41. In the foregoing notation, if g = (b, c), show that lxj+ ll = cjg and IYj+ ll = bjg. (H) 42. In the foregoing notation, show that lx j l � cj(2g), with equality if and only if qi+ 1 = 2 and xj-l = 0. Show similarly that lyil � bj(2g). 43. Prove that a l bc if and only if (a� b) jc. 44. Prove that every positive integer is uniquely expressible in the form 2 jo + 2h + 2h + • • • + 2 jm where m � 0 and 0 � j0 < i1 <j2 < · · · < im · 45. Prove that any positive integer a can be uniquely expressed in the form where each bj = 0, 1, or - 1. *46. Prove that there are no positive integers a, b, n > 1 such that (an - bn ) l (a n + b n ). *47. If a and b > 2 are any positive integers, prove that 2a + 1 is not divisible by 2 b - 1. *48. The integers 1, 3, 6, 1 0, · · ·, n(n + l)j2, · · · are called the triangular numbers because they are the numbers of dots needed to make successive triangular arrays of dots. For example, the number 10 can be perceived as the number of acrobats in a human triangle, 4 in a row at the bottom, 3 at the next level, then 2, then 1 at the top. The square numbers are 1, 4, 9, · · · , n2, · • · . The pentagonal numbers, 1, 5, 12, 22, - · ·, (3n2 - n)j2, - · · , can be seen in a geometric array in the following way. Start with n equally spaced dots PI> P2 , • • · , Pn on a straight line in a plane, with distance 1 between consecutive dots. Using P1 P2 as a base side, draw a regular pentagon in the 20 Divisibility plane. Similarly, draw n - 2 additional regular pentagons on the base sides P1 P 3 , P1 P4, . • · , P1 Pn , all pentagons lying on the same side of the line P1 Pn . Mark dots at each vertex and at unit intervals along the sides of these pentagons. Prove that the total number of dots in the array is (3n2 - n)j2. In general, if regular k-gons are constructed on the sides P1 P2 , P1 P 3 , ··· , P1 Pn , with dots marked again at unit intervals, prove that the total number of dots is 1 + kn(n - 0/2 - (n - 1)2• This is the nth k-gonal number. *49. Prove that if m > n then a2\" + 1 is a divisor of a2m - 1. Show that if a, m, n are positive with m '* n, then (a 2m + 1 a2\" + 1) = { 1 !f a �s even ' 2 If a IS odd . •so. Show that if (a, b) = 1 then (a + b, a2 - ab + b2) = 1 or 3. *51. Show that if (a, b) = 1 and p is an odd prime, then ( aP + bP ) a + b, a + b = 1 or p. *52. Suppose that 2 n + 1 = xy, where x and y are integers > 1 and n > 0. Show that 2° l(x - 1) if and only if 2° l(y - 1). *53. Show that (n! + 1, (n + 1)! + 1) = 1. ••54. Let a and b be positive integers such that (1 + ab) i (a2 + b2). Show that the integer (a2 + b2)j(l + ab) must be a perfect square. 1.3 PRIMES Definition 1.5 An integer p > 1 is called a prime number, or a prime, in case there is no divisor d of p satisfying 1 < d < p. If an integer a > 1 is not a prime, it is called a composite number. Thus, for example, 2, 3, 5, and 7 are primes, whereas 4, 6, 8, and 9 are composite. Theorem 1.14 Every integer n greater than 1 can be expressed as a product of primes (with perhaps only one factor). Proof If the integer n is a prime, then the integer itself stands as a \"product\" with a single factor. Otherwise n can be factored into, say, • *Problems marked with a double asterisk are much more difficult. 1.3 Primes 21 n1n2, where 1 < n1 < n and 1 < n 2 < n. If n1 is a prime, let it stand; otherwise it will factor into, say, n3n4 where 1 < n3 < n 1 and 1 < n4 < n 1 ; similarly for n2 . This process of writing each composite number that arises as a product of factors must terminate because the factors are smaller than the composite number itself, and yet each factor is an integer greater than 1. Thus we can write n as a product of primes, and since the prime factors are not necessarily distinct, the result can be written in the form where PI > p2, . • ·, Pr are distinct primes and a 1 , a 2 , . • ·, a r are positive. This ·representation of n as a product of primes is called the canonical factoring of n into prime powers. It turns out that the representation is unique in the sense that, for fixed n, any other representation is merely a reordering or permutation of the factors. Although it may appear obvious that the factoring of an integer into a product of primes is unique, nevertheless, it requires proof. Historically, mathematicians took the unique factorization theorem for granted, but the great mathematician Gauss stated the result and proved it in a systematic way. It is proved later in the chapter as Theorem 1. 16. The importance of this result is suggested by one of the names given to it, the fundamental theorem of arithmetic. This unique factorization property is needed to establish much of what comes later in the book. There are mathematical systems, notably in algebraic number theory, which is discussed in Chapter 9, where unique factoriza­ tion fails to hold, and the absence of this property causes considerable difficulty in a systematic analysis of the subject. To demonstrate that unique factorization need not hold in a mathematical system, we digress from the main theme for a moment to present two examples in which factorization is not unique. The first example is easy; the second is much harder to follow, so it might well be omitted on a first reading of this book. First consider the class G> of positive even integers, so that the elements of G> are 2, 4, 6, 8, 10, · · · . Note that G> is a multiplicative system, the product of any two elements in G> being again in G>. Now let us confine our attention to G> in the sense that the only \"numbers\" we know are members of G>. Then 8 = 2 · 4 is \"composite,\" whereas 10 is a \"prime\" since 10 is not the product of two or more \"numbers.\" The \"primes\" are 2, 6, 10, 14, · · ·, the \"composite numbers\" are 4, 8, 12, · · · . Now the \"num­ ber\" 60 has two factorings into \"primes,\" namely 60 = 2 · 30 = 6 · 10, and so factorization is not unique. A somewhat less artificial, but also rather more complicated, example is obtained by considering the class -G' of numbers a + b.;-=6 where a and b range over all integers. We say that this system -G' is closed under 1. 3 Primes 23 place, if we had a factoring 5 = (x1 + y1/=6\"\"Xx2 + y2/=6\"\") into com­ plex numbers, we could take norms to get which contradicts (1.2). Thus, 5 is a prime in -G', and a similar argument establishes that 2 is a prime. We are now in a position to show that not all numbers of -G' factor uniquely into primes. Consider the number 10 and its two factorings: 10 = 2 . 5 = (2 + /=6\"\" ) (2 - 1=6\"\" ) . The first product 2 · 5 has factors that are prime in -G', as we have seen. Thus we can conclude that there is not unique factorization of the number 10 in -G'. Note that this conclusion does not depend on our knowing that 2 + 1=6\"\" and 2 - 1=6\"\" are primes; they actually are, but it is unimpor­ tant in our discussion. This example may also seem artificial, but it is, in fact, taken from an important topic, algebraic number theory, discussed in Chapter 9. We now return to the discussion of unique factorization in the ordinary integers 0, ± 1, ± 2, · · · . It will be convenient to have the following result. Theorem 1.15 /fplab, p being a prime, then pia or plb. More generally, if pla 1a2 • • • an, then p divides at least one factor a; of the product. Proof If p)' a, then (a, p) = 1 and so by Theorem 1.10, plb. We may regard this as the first step of a proof of the general statement by mathematical induction. So we assume that the proposition holds when­ ever p divides a product with fewer than n factors. Now if pla1a2 • • • an , that is, p la 1c where c = a2a3 • • • an, then pia, or pic. If pic we apply the induction hypothesis to conclude that pia; for some subscript i from 2 to n. Theorem 1.16 The fundamental theorem of arithmetic, or the unique factor­ ization theorem. The factoring of any integer n > 1 into primes is unique apart from the order of the prime factors. First Proof Suppose that there is an integer n with two different factor­ ings. Dividing out any primes common to the two representations, we would have an equality of the form (1 .3 ) 24 Divisibility where the factors P; and qj are primes, not necessarily all distinct, but where no prime on the left side occurs on the right side. But this is impossible because p1 lq1q2 • · • qs, so by Theorem 1.15, p 1 is a divisor of at least one of the qj. That is, p1 must be identical with at least one of the qj. Second Proof Suppose that the theorem is false and let n be the smallest positive integer having more than one representation as the product of primes, say ( 1 .4) It is clear that r and s are greater than 1. Now the primes p1, p2, · • ·, p, have no members in common with q1, q2 , . · · , qs because if, for example, p1 were a common prime, then we could divide it out of both sides of (1.4) to get two distinct factorings of njp 1 • But this would contradict our assumption that all integers smaller than n are uniquely factorable. Next, there is no loss of generality in presuming that p1 < Qp and we define the positive integer N as It is clear that N < n, so that N is uniquely factorable into primes. But Pur<q1 - p1), so (1.5) gives us two factorings of N, one involving p1 and the other not, and thus we have a contradiction. In the application of the fundamental theorem we frequently write any integer a � 1 in the form a= n pa(p) p where a(p) is a non-negative integer, and it is understood that a(p) = 0 for all sufficiently large primes p. If a = 1 then a( p) = 0 for all primes p, and the product may be considered to be empty. For brevity we sometimes write a = npa, with the tacit understanding that the exponents a depend on p and, of course on a. If a= n pa(p)' p (1 .6) and ab = c, then a(p) + f3(p) = y(p) for all p, by the fundamental theorem. Here al e, and we note that a(p) � y(p) for all p. If, conversely, a(p) � y(p) for all p, then we may define an integer b = np�<P> with 1.3 Primes 25 f3(p) = y(p) - a( p). Then ab = c, which is to say that ale. Thus we see that the divisibility relation a lc is equivalent to the family of inequalities a( p) � y( p ). As a consequence, the greatest common divisor and the least common multiple can be written as ( a, b) = 0 Pmin (a(p), /:l(p)) ' p [a, b ] = 0 Pmax (a(p), /:I(P)) . ( 1.7) p For example, if a = 108 and b = 225, then The first part of Theorem 1.13, like many similar identities, follows easily from the fundamental theorem in conjunction with (1.7). Since min (a, f3) + max (a, f3) =a+ f3 for any real numbers a, f3, the relations (1.7) also provide a means of establishing the second part of Theorem 1.13. On the other hand, for calculational purposes the identifies (1.7) should only be used when the factorizations of a and b are already known, as in general the task of factoring a and b will involve much more computation than is required if one determines (a, b) by the Euclidean algorithm. We call a a square (or alternatively a perfect square) if it can be written in the form n2• By the fundamental theorem we see that a is a square if and only if all the exponents a( p) in (1.6) are even. We say that a is square-free if 1 is the largest square dividing a. Thus a is square-free if and only if the exponents a( p) take only the values 0 and 1. Finally, we observe that if p is prime, then the assertion pk lla is equivalent to k = a( p). Theorem 1.17 Euclid. The number of primes is infinite. That is, there is no end to the sequence of primes 2, 3 ,5,7, 11, 13, ... . Proof Suppose that p i > p2,- • ·, p, are the first r primes. Then form the number Note that n is not divisible by p 1 or p2 or · · · or Pr- Hence any prime divisor p of n is a prime distinct from P I > p2 , . • ·, p,. Since n is either a prime or has a prime factor p, this implies that there is a prime distinct from P I > p2, - • ·, p,. Thus we see that for any finite r, the number of primes is not exactly r. Hence the number of primes is infinite. 26 Divisibility Students often note that the first few of the numbers n here are primes. However, 1 + 2 · 3 · 5 · 7 · 11 · 13 = 59 · 509. Theorem 1.18 There are arbitrarily large gaps in the series of primes. Stated otherwise, given any positive integer k, there exist k consecutive composite integers. Proof Consider the integers ( k + 1) ! + 2, ( k + 1) ! + 3,- .. , ( k + 1) ! + k, ( k + 1) ! + k + 1. Every one of these is composite because j divides (k + 1)! + j if 2 � j � k+ l . The primes are spaced rather irregularly, as the last theorem suggests. If we denote the number of primes that do not exceed x by ?T(x), we may ask about the nature of this function. Because of the irregular occurrence of the primes, we cannot expect a simple formula for ?T(x), but we may seek to estimate its rate of growth. The proof of Theorem 1.17 can be used to derive a lower bound for ?T(x), but the estimate obtained, ?T(x) > clog log x, is very weak. We now derive an inequality that is more suggestive of the true state of affairs. Theorem 1.19 For every real number y � 2, 1 E - > log log y - 1. p <;y p Here it is understood that the sum is over all primes p � y. From this it follows that the infinite series E1jp diverges, which provides a second proof of Theorem 1.17. Proof Let y be given, y � 2, and let JY denote the set of all those positive integers n that are composed entirely of primes p not exceeding y. Since there are only finitely many primes p � y, and since the terms of an absolutely convergent infinite series may be arbitrarily rearranged, we see that n 1 + - + -z + -3 + ··· = E -. ( 1 1 1 ) 1 p <;y p p p n E.A/n { 1.8) 1.3 Primes 27 If n is a positive integer � y then n E .ff, and thus the sum above includes the sum En ., y1/n. Let ./Y denote the largest integer not exceed­ ing y. By the integral test, N 1 JN+l dx L - ;;;, - = log ( N + 1) > log y. n - l n I X Thus the right side of (1.8) is > log y. On the other hand, the sum on the left side of (1.8) is a geometric series, whose value is (1 - 1jp )-1, so we see that ( 1 ) - I n 1 - - >log y. p .;;y p We assume for the moment that the inequality (1 .9) holds for all real numbers v in the interval 0 � v � 1/2. Taking v = 1jp, we deduce that n exp ( 2_ + �) >log y. p .;; y p p Since n exp (a;) = exp (Ea;), and since the logarithm function is monoton­ ically increasing, we may take logarithms of both sides and deduce that 1 1 L - + L 2 > log log y. p .;;y p p .;;y p By the comparison test we see that the second sum is 00 1 < E 2· n �2 n and by the integral test this is oodx < f 2 =1 . 1 X This gives the stated inequality, but it remains to prove (1.9). We need to 28 Divisibility show that f(v) � 1 for 0 � v � 1/2, where f(v) = (1 - v) exp (v + v 2). Since f(O) = 1, it suffices to show that f(v) is increasing for 0 � v � 1/2. To this end it is enough to observe that f'(v ) = v(1 - 2v ) exp (v + v 2) � 0. Thus we have (1.9), and the proof is complete. With more work it can be shown that the difference 1 E -- log log y p,;,y p is a bounded function of y, for y � 2. Deeper still lies the Prime Number Theorem , which asserts that lim 1r(x) = 1. x .... oo xjlog x We say that f(x) is asymptotic to g(x), or write f(x) - g(x), if limx .... \"' f(x)jg(x) = 1. Thus the prime number theorem may be ex­ pressed by writing 1T(x) - xjlog x. This is one of the most important results of analytic number theory. We do not prove it in this book, but in Section 8.1 we establish a weaker estimate in this direction. PROBLEMS 1. With a and b as in (1.6) what conditions on the exponents must be satisfied if (a, b) = 1 ? 2. What is the largest number of consecutive square-free positive inte­ gers? What is the largest number of consecutive cube-free positive integers, where a is cube-free if it is divisible by the cube of no integer greater than 1? 3. In any positive integer, such as 8347, the last digit is called the units digit, the next the tens digit, the next the hundreds digit, and so forth. In the example 8347, the units digit is 7, the tens digit is 4, the hundreds digit is 3, and the thousands digit is 8. Prove that a number is divisible by 2 if and only if its units digit is divisible by 2; that a number is divisible by 4 if and only if the integer formed by its tens digit and its units digit is divisible by 4; that a number is divisible by 8 if and only if the integer formed by its last three digits is divisible by 8. 1.3 Primes 29 4. Prove that an integer is divisible by 3 if and only if the sum of its digits is divisible by 3. Prove that an integer is divisible by 9 if and only if the sum of its digits is divisible by 9. 5. Prove that an integer is divisible by 11 if and only if the difference between the sum of the digits in the odd places and the sum of the digits in the even places is divisible by 11. 6. Show that every positive integer n has a unique expression of the form n = 2'm, r � 0, m a positive odd integer. 7. Show that every positive integer n can be written uniquely in the form n = ab, where a is square-free and b is a square. Show that b is then the largest square dividing n. 8. A test for divisibility by 7. Starting with any positive integer n, subtract double the units digit from the integer obtained from n by removing the units digit, giving a smaller integer r. For example, if n = 41283 with units digit 3, we subtract 6 from 4128 to get r = 4122. The problem is to prove that if either n or r is divisible by 7, so is the other. This gives a test for divisibility by 7 by repeating the process. From 41283 we pass to 4122, then to 408 by subtracting 4 from 412, and then to 24 by subtracting 16 from 40. Since 24 is not divisible by 7, neither is 41283. (H) 9. Prove that any prime of the form 3k + 1 is of the form 6k + 1. 10. Prove that any positive integer of the form 3k + 2 has a prime factor of the same form; similarly for each of the forms 4k + 3 and 6k + 5. 11. If x and y are odd, prove that x 2 + y 2 cannot be a perfect square. 12. If x and y are prime to 3, prove that x2 + y 2 cannot be a perfect square. 13. If (a, b) = p, a prime, what are the possible values of (a2, b)? Of (a3, b)? Of (a2, b3)? 14. Evaluate (ab, p4) and (a + b, p4) given that (a, p 2) = p and (b, p3) = p 2 where p is a prime. 15. If a and b are represented by (1.6), what conditions must be satisfied by the exponents if a is to be a cube? For a2 lb2? 16. Find an integer n such that n/2 is a square, n/3 is a cube, and n/5 is a fifth power. 17. Twin primes are those differing by 2. Show that 5 is the only prime belonging to two such pairs. Show also that there is a one-to-one correspondence between twin primes and numbers n such that n2 - 1 has just four positive divisors. 18. Prove that (a2, b2) = c2 if (a, b) = c. 30 Divisibility 19. Let a and b be positive integers such that (a, b) = 1 and ab is a perfect square. Prove that a and b are perfect squares. Prove that the result generalizes to kth powers. 20. Given (a, b, c){a, b, c] = abc, prove that (a, b) = (b, c) = (a, c) = 1. 21. Prove that [a, b,c](ab, bc, ca) = label. 22. Determine whether the following assertions are true or false. If true, prove the result, and if false, give a counterexample. (1) If (a, b) = (a, c) then [a, b] = [a, c]. (2) If (a, b) = (a, c) then (a2, b2) = (a 2, c 2). (3) If (a, b) = (a, c) then (a, b) = (a, b, c). (4) If p is a prime and pia and p l(a2 + b2) then plb. (5) If p is a prime and pla7 then pia. (6) If a3 1 c3 then a I c. (7) If a3 lc2 then al e. (8) If a 2 1c3 then a I c. (9) If p is a prime and pl (a2 + b2) and p l (b2 + c 2) then pl (a2 - c 2). (10) If p is a prime and p l(a2 + b2) and p l(b2 + c 2) then pl (a2 + c2). (11) If (a, b) = 1 then (a2, ab, b2) = 1. (12) [a2, ab, b2] = [a2, b2]. (13) If bl (a2 + 1) then bl(a4 + 1). (14) If bl(a2 - 1) then bl (a4 - 1). (15) (a, b, c) = ((a, b), (a, c)). 23. Given integers a, b, c, d, m, n, u, v satisfying ad - be = ± 1, u = am + bn, v =em + dn , prove that (m, n) = (u, v). 24. Prove that if n is composite, it must have a prime factor p � ..fn. (Note that a straightforward implication of this problem is that if we want to test whether an integer n is a prime, it suffices to check whether it is divisible by any of the primes � ..fn. For example, if n = 1999, we check divisibility by the primes 2, 3, 5, · · · , 43. This is easy to do with a hand calculator. It turns out that 1999 is divisible by none of these primes, so it is itself a prime.) 25. Obtain a complete list of the primes between 1 and n, with n = 200 for convenience, by the following method, known as the sieve of Eratosthenes. By the proper multiples of k we mean all positive multiples of k except k itself. Write all numbers from 2 to 200. Cross out all proper multiples of 2, then of 3, then of 5. At each stage the next larger remaining number is a prime. Thus 7 is now the next remaining iarger than 5. Cross out the proper multiples of 7. The next remaining number larger than 7 is 1 1. Continuing, we cross out 1 .3 Primes 31 the proper multiples of 11 and then of 13. Now we observe that the next remaining number greater than 13 exceeds v'200 , and hence by the previous problem all the numbers remaining in our list are prime. 26. Prove that there are infinitely many primes of the form 4n + 3; of the form 6n + 5. (H) Remark The last problem can be stated thus: each of the arithmetic progressions 3, 7, 11, 15, 19, - · · , and 5, 11, 17, 23, 29, · · · contains an infinitude of primes. One of the famous theorems of number theory (the proof of which lies deeper than the methods of this book), due to Dirichlet, is that the arithmetic progression a, a + b, a + 2b, a + 3b, · · · contains infinitely many primes if the integers a and b > 0 are relatively prime, that is if (a, b) = 1. 27. Show that n I (n - 1)! for all composite n > 4. 28. Suppose that n > 1. Show that the sum of the positive integers not exceeding n divides the product of the positive integers not exceed­ ing n if and only if n + 1 is composite. 29. Suppose that m and n are integers > 1, and that (log m)j(log n) is rational, say equal to ajb with (a, b) = 1. Show that there must be an integer c such that m = c 0 , n = c b . 30. Prove that n2 - 81n + 1681 is a prime for n = 1, 2, 3, · · · , 80, but not for n = 81. (Note that this problem shows that a sequence of propo­ sitions can be valid for many beginning cases, and then fail.) 31. Prove that no polynomial f(x ) of degree > 1 with integral coeffi­ cients can represent a prime for every positive integer x. (H) Remark Let f(x) be a nonconstant polynomial with integral coef­ ficients. If there is an integer d > 1 such that dlf(n) for all integers n, then there exist at most finitely many integers n such that f(n) is prime. (For example, if f(x) = x2 + x + 2, then 21/(n) for all n, and f(n) is prime only for n = -1, 0.) Similarly, if there exist noncon­ stant polynomials g(x) and h(x) with integral coefficients such that f(x) = g(x)h(x) for all x, then f(n) is prime for at most finitely many integers n, since g(n) will be a proper divisor of f(n) when In I is large. (For example, if f(x ) = x2 + 8x + 15, then n + 3 is a proper divisor of f(n) except when n = -2, -4, or - 6.) It is conjectured that if neither of these two situations applies to f(x ), then there exist infinitely many integers n such that f(n) is prime. If f is of degree 1, then this is precisely the theorem of Dirichlet concerning primes in arithmetic progressions, alluded to earlier, but 32 Divisibility the conjecture has not been proved for any polynomial of degree greater than 1. In particular, it has not been proved that there exist infinitely many integers n such that n2 + 1 is prime. 32. Show that n4 + 4 is composite for all n > 1. 33. Show that n4 + n2 + 1 is composite if n > 1. *34. Show that if m4 + 4\" is prime, then m is odd and n is even, except when m = n = 1. *35. Show that there exist non-negative integers x and y such that x 2 - y2 = n if and only if n is odd or is a multiple of 4. Show that there is exactly one such representation of n if and only if n = 1, 4, an odd prime, or four times a prime. *36. Consider the set ../ of integers 1, 2, · · · , n. Let 2k be the integer in ../ that is the highest power of 2. Prove that 2k is not a divisor of any other integer in ../. Hence, prove that E'j� 11/j is not an integer if n>l. *37. Prove that in any block of consecutive positive integers there is a unique integer divisible by a higher power of 2 than any of the others. Then use this, or any other method, to prove that there is no integer among the 2\" + 1 numbers 1 + -­- k+n where all possible combinations of plus and minus signs are allowed, and where n and k are any positive integers. (Note that this result is a sweeping generalization of the preceding problem.) *38. Consider the set .:T of integers 1, 3, 5, · · · , 2n - 1. Let 3' be the integer in .:T that is the highest power of 3. Prove that 3' is not a divisor of any other integer in .:T. Hence, prove that E'j� 11/(2j - 1) is not an integer if n > 1. *39. Prove that 111 1 1 1 1 1 1-- +--- + ... + -- - -- = -- + -- + ... + -- 2 3 4 1999 2000 1001 1002 2000 where the signs are alternating on the left side of the equation but are all alike on the right side. (This is an example of a problem where it is easier to prove a general result than a special case.) *40. Say that a positive integer n is a sum of consecutive integers if there exist positive integers m and k such that n = m + (m + 1) + · · · 1 . 3 Primes 33 + (m + k ). Prove that n is so expressible if and only if it is not a power of 2. *41. Prove that an odd integer n > 1 is a prime if and only if it is not expressible as a sum of three or more consecutive positive integers. 42. If 2\" + 1 is an odd prime for some integer n, prove that n is a power of 2. (H) 43. The numbers Fn = 22 \" + 1 in the preceding problem are called the Fermat numbers, after Pierre Fermat who thought they might all be primes. Show that F5 is composite by verifying that (It is not hard to show that Fn is prime for n = 0, 1, · · · , 4; these are the only n for which Fn is known to be prime. It is now known that Fn is composite for n = 5, 6, · · · , 21. It is conjectured that only finitely many Fermat numbers are prime.) 44. If 2\" - 1 is a prime for some integer n, prove that n is itself a prime. (Numbers of the form 2 P - 1, where p is a prime, are called the Mersenne numbers MP because the Frenchman Father Marin Mersenne (1588-1648) stated the MP is a prime for p = 2, 3, 5, 7, 13, 17, 19, 31, 67, 127,257, but is composite for all other primes p < 257. It took some 300 years before the details of this assertion could be checked completely, with the following outcome: MP is not a prime for p = 67 and p = 257, and MP is a prime for p = 61, p = 89, and p = 107. Thus, there are 12 primes p < 257 such that MP is a prime. It is now known that MP is a prime in the following additional cases, p = 521, 607, 1279, 2203, 2281, 3217, 4253, 4423, 9689, 9941, 11213, 19937, 21701, 23209, 44497, 86243, 110503, 132049, 216091. The Mersenne prime M216091 is the largest specific number that is known to be prime. It is conjectured that infinitely many of the Mersenne numbers are prime.) *45. Let positive integers g and I be given with gil. Prove that the number of pairs of positive integers x, y satisfying (x, y) = g and [ x, y] = I is 2 k, where k is the number of distinct prime factors of ljg. (Count x 1, y1 and x2, y2 as different pairs if x1 '* x2 or y1 '* y2.) *46. Let k ;;;. 3 be a fixed integer. Find all sets a1 , a2, · · · , ak of positive integers such that the sum of any triplet is divisible by each member of the triplet. *47. Prove that 2 + ...;-:::--6 and 2 - ...;-:::--6 are primes in the class � of numbers a + b...;-:::--6 . 34 Divisibility *48. Prove that there are infinitely many primes by considering the se­ quence 221 + 1, 2 22 + 1, 223 + 1, 224 + 1, ··· . (H) *49. If g is a divisor of each of ab, cd, and ac + bd, prove that it is also a divisor of ac and bd, where a, b, c, d are integers. *SO. Show that *51. Show that 24 is the largest integer divisible by all integers less than its square root. (H) *52. (For readers familiar with the rudiments of point-set topology.) We topologize the integers as follows: a set ,A/ of integers is open if for every n E ,A/ there is an arithmetic progression .N such that n E .N � .A/. (An arithmetic progression is a set of the form {dk + r: k E Z} with d *' 0.) Prove that arbitrary unions of open sets are open, and that finite intersections of open sets are open, so that these open sets define a topology in the usual sense. (From a more advanced per­ spective, this is known as a profinite topology.) As is usual in topology, we call a set ,A/ closed if its complement Z \\,A/ is open. Let .N be an arithmetic progression. Prove that the complement of .N is a union of arithmetic progressions. Deduce that .N is both open and closed. Let � denote the union over all prime numbers p of the arithmetic progressions {np: n E Z}, and let 'Y denote the complement of �. In symbols, �= Up p.Z and 'Y= Z\\ �. Show that 'Y = { -1, 1}. Show that if there were only finitely many prime numbers then the set � would be closed. From the observation that 'Y is not an open set, conclude that there exist infinitely many prime numbers. *53. Let 7T(x) denote the number of primes not exceeding x. Show that 7T( X ) x E 1/p = -- + 1 7T ( u) ju2 du . p .;;.x X 2 Using Theorem 1.19, deduce that . 7T ( X ) hm sup ;;<!: 1 . x ___ ..,, x flog x 36 Divisibility number of these subsets. Then there are k!(n - k)!X permutations 17\", and equating this to n! we find that X = ( � ) . n ! We now see that the quotient ( k ) is an integer, because it k! n- ! represents the number of ways of doing something. In this way, combina­ torial interpretations can be useful in number theory. We now use Theo­ rem 1.20 to derive the following result, which we shall need in Section 2.6. Theorem 1.21 The product of any k consecutive integers is divisible by k!. Proof Write the product as n(n - 1) · · · (n - k + 1). If n � k, then we write this in the form ( � )k!, and note that ( � ) is an integer, by Theorem 1.20. If 0 � n < k, then one of the factors of our product is 0, so the product vanishes, and is therefore a multiple of k! in this case also. Finally, if n < 0, we note that the product may be written ( k( ( k( -n +k- 1 ) -1) -n) -n + 1) · · · ( -n + k- 1) = ( -1) k k! . Note that in this case the upper member -n + k - 1 is at least k, so that by Theorem 1.20 the binomial coefficient is an integer. In the formula for the binomial coefficients we note a symmetry: (� ) = (n� k). (1 .10) This is also evident from the combinatorial interpretation, since the subsets of Sit' containing k elements are in one-to-one correspondence with the complementary subsets ./\\ Sit'= {i E ./: i ft Sit'} containing n - k elements. Theorem 1.22 The binomial theorem. For any integer n � 1 and any real numbers x and y, n (x + y ) \" = L (� ) xkyn -k. k =O (1 .11 ) Proof We consider first the product n 0 (x; + Y; ) . i= l 1. 4 The Binomial Theorem On multiplying this out, we obtain 2\" monomial terms of the form 0 x;0 Y; i E N i<I=N 37 where N is any subset of {1, 2, · · · , n}. For each fixed k, 0 � k � n, we consider the monomial terms obtained from those subsets N of {1, 2, · · · , n} having exactly k elements. We set X; = x and Y; = y for all i and note that such a monomial has value xkyn-k for the subsets in question. Since there are ( �) such subsets, we see that the contribution of such subsets is (��kyn-k, which gives (1.11). The binomial theorem can also be proved analytically by appealing to the following simple result. n Lemma 1.23 Let P( z) = E a k z k be a polynomial with real coefficients. k=O Then a, = p<r>(O)jr! for 0 � r � n, where p<r>(O) is the rth derivative of P(z) at z = 0. Proof By differentiating repeatedly, we see that n p<r>(z) = E k ( k- 1 ) · · · ( k- r + 1) akzk-r. k=r On setting z = 0 we see that p<r>(o) = r!a,, as desired. If we take P(z) = (1 + z)\", then p<r>(z) = n( n - 1) · · · ( n- r + 1)( 1 + z)\"-', so that p<r>(O) = n(n - 1) · · · (n - r + 1), and hence by the Lemma, a, = n(n - 1) · · · (n - r + l)jr! = ( � ) . That is, ( 1 +z)\" = E (�)zk. k-0 (1.12) This is a form of the binomial theorem. We can recover (1.11) by taking z = xjy, and then multiplying both sides by y\". This gives the identity when y -,;= 0. The case y = 0 of (1.11) is obvious. In our first (combina­ torial) proof of this theorem, the binomial coefficients arose in the context of Theorem 1.20, but in our second (analytic) proof, they occurred in the 38 Divisibility form described in Definition 1.6. Thus the two proofs of Theorem 1.22 may be combined to provide a second proof of Theorem 1.20. As a matter of logic, we require only one proof of each theorem, but additional proofs often provide new insights, and the various proofs may generalize in different directions. In the present case, the first proof can be used whenever x and y are members of a commutative ring, whereas the second proof can be used to derive a more general form of the binomial theorem, which asserts that ( 1.13) for lz I < 1. Here a is an arbitrary real or complex number. This is consistent with (1.12) if a is a non-negative integer. As a function of a, the quantity ( �) is a polynomial of degree k with rational coefficients. By Theorem 1.2t we see that this polynomial takes integral values whenever a is an integer. A polynomial with this property is called integer-valued. The series (1.13) is the Taylor series of the function on the left. To demonstrate that it converges to the desired value, one may use the integral form of the remainder, which states that if f(z) is a function for which J<K+I>(z) is continuous, then where We take f(z) = (1 + z)a, so that J<k>(z) = a( a -1) ··· ( a- k + 1)(1 +z)a-k. Hence From the hypothesis lzl < 1 it follows that 11 + tzl � 1 - ltzl � 1 - t. 1.4 The Binomial Theorem Hence 1 1 + tz i -K � (1 - t) -K, and we see that say. Here the integral is independent of K, and -- = � lz l TK+I l (a -K- 1) z l TK K + 1 39 as K � oo. Taking r so that lz l < r < 1, we deduce that TK+I � rTK for all large K, say K � L. By induction it follows that TK � c,. K for K � L, where C = TLfrL. Thus TK � 0 as K � oo, and we conclude that RK(z) � 0 as K � oo. Thus (1.13) holds when lzl < 1. The binomial coefficients arise in many identities, both in analysis and in combinatorics. One of the simplest of these is the recursion ( 1 .14) used in many ways, for example, to construct Pascal's triangle. We define this triangle below, but first we give three short proofs of identity (1.14). Since all members vanish if k > n, and since the identity is clear when k = -1, we may assume that 0 � k � n. First, we may simply use the formula of Definition 1.6, and then simplify the expressions. Second, we can interpret the identity combinatorially. To this end, observe that if SJ! contains k + 1 elements of ../= {1, 2, · · · , n + 1}, then one can consider two cases: either n + 1 E J:J!, or n + 1 � SJ!. In the first case, SJ! is determined by choosing k of the numbers 1, 2, · · ·, n; there are { �) ways of doing this. In the second case, SJ! is determined by choosing k + 1 numbers from among 1, 2, · · · , n, which gives { k � 1 ) subsets of this type. This again gives the identity, by Theorem 1.20. Third, we note that the right side is the coefficient of z k + 1 in (1 + z )n + 1• But this polynomial may be written (1 +z)( 1 +z ( = ( 1 +z ) n +z( 1 + z( = E (�) zk + E (�)zk+l. k-0 k� O In this last expression, the coefficient of zk+ 1 is { k � 1 ) + { � ) . From Lemma 1.23 we see that the coefficient of zk+ 1 is uniquely defined. Thus we again have (1.14). 40 Divisibility Pascal's triangle is the infinite array of numbers 1 1 1 1 2 1 1 3 3 1 1 4 6 4 1 1 5 10 10 5 1 1 6 15 20 15 6 1 where, for example, the last row exhibited gives the binomial coefficients in the expansion of (x + y)6• The identity (1.14) can be used to generate as many further rows as we please. Apart from the 1 's at the ends of each row, the numbers can be obtained by adding the two integers on the preceding row, one just to the left and one just to the right. For example the next row is 1, 1 + 6, 6 + 15, 15 + 20, and so on, or 1, 7, 21, 35, 35, 21, 7, 1. The nth row has n entries, namely the coefficients in the binomial expansion of (x + y )\" -• . PROBLEMS 1. Use the binomial theorem to show that t(� ) =2\". k-0 Can you give a combinatorial proof of this? 2. Show that if n ;;;-- 1 then E ( -1)k{ � ) = 0. k= O 3. (a) By comparing the coefficient of z k in the polynomial identity m +n L (m; n )zk = ( 1 + z) m +n = ( 1 + z) m( 1 + z ) \" k= O show that 1.4 The Binomial Theorem 41 (b) Let � and Y be disjoint sets containing m and n elements, respectively, and put ../= � u Y. Show that the number of subsets N of ../ that contain k elements and that also have the property that N n � contains i elements is { 7 ) { k � i) . Inter­ pret this identity combinatorially. (c) Show that for n � 0, n 2 L { � ) = { 2 n n ) . k-0 4. (a) Suppose that ../ contains 2n elements, and that ../ is parti­ tioned into n disjoint subsets each one containing exactly two elements of ../. Show that this can be done in precisely (2n) ! (2n - 1)(2n - 3) · · · 5 · 3 · 1 = --2 nn ! ways. (b) Show that (n + 1Xn + 2) · · · (2 n) is divisible by 2 n, but not by 2n + l. 5. Show that if a and b are positive integers, then a!bb! i(ab)! . (H) 6. Let f(x) and g(x) be n-times differentiable functions. Show that the nth derivative of f(x)g(x) is n L ( � )J(k)( X) g< n -k)( X) , k-0 7. Show that { -\\- 1 ) = ( -l)k{ a t k ) for k � 0. Deduce that if lzl < 1 then 1 = ;. {a + k) zk ( (1- zt+I k'\":o k . 1 .15) 8. Give three proofs that M E (m +k ) = (k + M+ 1 ) m-O k k + 1 ' (a) With k fixed, induct on M, using Theorem 1.20. (b) Let ../= {1, 2, · · · , k + M + 1}. Count the number of subsets N of ../ containing k + 1 elements, with the maximum one being k+ m+l. (c) Compute the coefficient of zM in the identity 1 1 (1 + z + z2 + .. · ) · -----,� (1 _ z)k+I (1 _ z)k+Z · 42 Divisibility 9. Let f(x) be a function of a real variable, and let !l.f be the function !l.f(x) = f(x + 1) - f(x). For k > 1, put !l.kf = !::i.(t::,.k-lf). The func­ tion t::,.kf(x) is called the kth forward difference of f. Show that k t::,.kf(x) = L ( -1)i(�)f(x + k - j) . j - 0 1 *10. Let ../ be a set of n elements. Count the number of ordered pairs (N', �) of subsets such that 0 � N� � � ../. Let c(j, k) denote the number of such ordered pairs for which N contains j elements and � contains k elements. Show that (1 + y + xy)\" = L c( j, k)xiyk. O<,j<,k<. n What does this give if x = y = 1? *11. Show that ( Z) is a polynomial in x of degree k and leading coefficient 1/k!. Let P(x) be an arbitrary polynomial with real coefficients and degree at most n. Show that there exist real numbers ck such that (1.16) for all x, and that such ck are uniquely determined. *12. Show that { x ; 1 ) - ( Z) = ( k :_ 1 ) when k is a positive integer and x is a real number. Show that if P(x) is given by (1.16), then !l.P(x) = E ck(k :_ 1 ). k= l Note the similarity to the formula for the derivative of a polynomial. Show that if P(x) is a polynomial with real coefficients and of degree n, then !l.P is a polynomial of degree n - 1. *13. Show that if x is a real number and k is a non-negative integer, then M L (x � m ) = (x ��7 1 ) -(k :t ). m= O Show that if P(x) is a polynomial written in the form (1.16), then M L P(x + m) = Q(x + M + 1) - Q(x), m=O 1.4 The Binomial Theorem 43 where Q(x) = E ck( k � 1 ). k=O Note the similarity to the formula for the integral of a polynomial and that Q(x) is a polynomial of degree n + 1. *14. Suppose that P(x) is a polynomial written in the form (1.16). Show that if the ck are integers, then P(x) is an integer-valued polynomial. *15. Suppose that P(x) is a polynomial written in the form (1.16). Show that if P(O), P(l), · · · , P(n) are integers then the ck are integers and P(x) is integer-valued. *16. Show that if f(x) is a polynomial of degree n with real coefficients, which takes integral values on a certain set of n + 1 consecutive integers, then f(x) is integer-valued. *17. Show that if f(x) is an integer-valued polynomial of degree n, then n!f(x) is a polynomial with integral coefficients. *18. Suppose that f(x) is an integer-valued polynomial of degree n and that g = g.c.d. (/(0), f(l), · · · , f(n)). Show that g lf(k) for all inte­ gers k. *19. Show that if m and n are non-negative integers then E ( - 1)k{m + 1 )(m + n - k) = { 1 �f n = 0, k=O k m 0 1f n > 0. *20. Show that if m and n are integers with 0 � m < n, then *21. Show that if n is a positive integer then n ( -1)k+l n 1 kf:l k ( � ) = kf:l k . *22. Show that if m and n are integers, 0 � m < n, then *23. (a) Show that (b) Show that E ( k + n )2 -k = 2 n+ t . k- 0 k E ( k + n )2 -k = 2\". k- 0 k 44 Divisibility *24. Show that *25. Show that *26. Show that NOTES ON CHAYfER 1 For \"most\" pairs b, c, the Euclidean algorithm requires approximately 12 log 2 I A . �: I . f h. . . b J o · '1T 2 og c steps. precise 10rmu atwn o t 1s 1s gtven y . txon, \"The number of steps in the Euclidean algorithm,\" J. Number Theory, 2 (1970), 414-422. When seeking to write (b, c) as a linear combination of b and c, an alternative method is obtained by solving up from the bottom. In Example 2 this would be done by writing 17 = 2040 - 7 . 289 = 2040 - 7 . (4369 - 2 . 2040) = ( -7) . 4369 + 15 . 2040 = ( -7) . 4369 + 15 . (6409 - 1 . 4369) = 15 . 6409 - 22 . 4369 = 15 . 6409 - 22 . (42823 - 6 . 6409) = ( -22) . 42823 + 147 . 6409. In general, we set sj +l = 0, sj = 1 and determine the numbers sj _ 1 , sj _2 ,· ·· ,s0 successively by the relation s; _1 = -q;s; +s;+ 1. Put t; = s; + 1r;_ 1 + s;r;. Since it follows that the value of t; is independent of i. As tj = rj = g.c.d.(b, c), we conclude that t0 = bs1 + cs0 = g.c.d.( b, c). The advantage of this method is we need construct only the one sequence {s;} , whereas in our former method we constructed two sequences, {u) and {v;} . The disadvan- Notes on Chapter 1 45 tage of this new method is that all the Q; must be saved, as the s; are computed in reverse order. Thus if memory is limited (as on a pro­ grammable pocket calculator), the former method is preferable, whereas on larger machines it is faster to follow the method above. However, this new method is advantageous only in situations in which both the coeffi­ cients of b and of c are desired. In most of the applications that arise later (e.g., Theorems 2.9, 2.17, 2.18), only the coefficient of b is needed. It can be noted that the second proof of Theorem 1.16 does not depend on Theorem 1.15 or indeed on any previous theorem. Thus the logical arrangement of this chapter could be altered considerably by putting Theorems 1.14 and 1.16 in an early position, and then using the formulas for (b, c) and [b, c) in (1.7) to prove such results as Theorems 1.6, 1.7, 1.8, 1.10, and 1.15. Many special cases of the Dirichlet theorem, that is, that there are infinitely many primes in the arithmetic progression a, a + b, a + 2 b, · · · if a and b are relatively prime integers, are given throughout the book. The cases a = 3, b = 4 and a = 5, b = 6 (or, what is the same thing, a = 2, b = 3) are given in Problem 26 of Section 1.3; a = 1, b = 4 in Problem 38 of Section 2.1; a = 1 in Problem 36 in Section 2.8; a = 1, 3, 5, 7, b = 8 in Problem 20 of Section 3.1; a = 1, 2, b = 3 in Problem 13 of Section 3.2. In Section 8.4 we develop a different method that can be used to prove the theorem in general. The full details are found in Chapter 7 of Apostol or Section 4 of Davenport (1980). (Books referred to briefly by the author's surnames are listed in the General References on page 500.) The prime number theorem, stated at the end of Section 1.3, was first proved in 1896, independently by Jacques Hadamard and C. J. de Ia Vallee Poussin. They used the theory of functions of a complex variable to derive the theorem from properties of the Riemann zeta function ((s). The account in Sections 8 through 18 of Davenport (1980) follows the original method quite closely. A shorter proof, which still uses the theory of a complex variable but which requires less information concerning the zeta function, is given in Chapter 13 of Apostol. In 1949, Atle Selberg gave an elementary proof of an identity involving prime numbers, which led him and Pal Erdos to give elementary (though complicated) proofs of the prime number theorem. A readable account of the elementary proof of the prime number theorem has been given by N. Levinson, \"A motivated account of an elementary proof of the prime number theorem,\" Amer. Math. Monthly, 76 (1969), 225-245. Because it dates back to antiquity, the most famous result in this chapter is Euclid's proof in Theorem 1.17 that there are infinitely many primes. The argument given is essentially the same as that by Euclid in the third century s.c. Many variations on this argument can be given, such as the simple observation that for any positive integer n, the number n! + 1 46 Divisibility must have a prime factor exceeding n. Other proofs of Euclid's theo­ rem are outlined in Problems 48 and 52 of Section 1.3. Euler argued that E1/p = co because no - 1/p)- 1 = no + 1/p + 1fp 2 + · · · ) = E1/n = co. Our proof of Theorem 1.19 presents Euler's reasoning in a more precise (and rigorous) form. Except when a is a non-negative integer, the series in (1.13) diverges when lzl > 1. We do not address the more subtle question of whether the identity (1.13) holds when lz l = 1. Further material concerning binomial coefficients is found in Chapter 1 §2 of P6lya and Szego. The \"q-binomial theorem\" of Gauss is introduced in Chapter 1 §5 of the same book. CHAPTER 2 Congruences 2. 1 CONGRUENCES It is apparent from Chapter 1 that divisibility is a fundamental concept of number theory, one that sets it apart from many other branches of mathematics. In this chapter we continue the study of divisibility, but from a slightly different point of view. A congruence is nothing more than a statement about divisibility. However, it is more than just a convenient notation. It often makes it easier to discover proofs, and we shall see that congruences can suggest new problems that will lead us to new and interesting topics. The theory of congruences was introduced by Carl Friedrich Gauss (1777-1855), one of the greatest mathematicians of all time. Gauss con­ tributed to the theory of numbers in many outstanding ways, including the basic ideas of this chapter and the next. Although Pierre de Fermat (1601-1665) had earlier studied number theory in a somewhat systematic way, Gauss was the first to develop the subject as a branch of mathematics rather than just a scattered collection of interesting problems. In his book Disquisitiones Arithmeticae, written at age 24, Gauss introduced the theory of congruences, which gained ready acceptance as a fundamental tool for the study of number theory. Some fundamental ideas of congruences are included in this first section. The theorems of Fermat and Euler are especially noteworthy, providing powerful techniques for analyzing the multiplicative aspects of congruences. These two pioneers in number theory worked in widely contrasting ways. Mathematics was an avocation for Fermat, who was a lawyer by profession. He communicated his mathematical ideas by corre­ spondence with other mathematicians, giving very few details of the proofs of his assertions. (One of his claims is known as Fermat's \"last theorem,\" although it is not a theorem at all as yet, having never been proved. This situation is discussed in Section 5.4.) Leonard Euler (1707 -1783), on the other hand, wrote prolifically in almost all the known branches of mathe­ matics of his time. For example, although Fermat undoubtedly was able to 47 48 Congruences prove the result attributed to him as Theorem 2.7 below, Euler in 1736 was the first to publish a proof. Years later, in 1760, Euler stated and proved his generalization of Fermat's result, which is given as Theorem 2.8 here. Definition 2.1 If an integer m, not zero, divides the difference a - b, we say that a is congruent to b modulo m and write a = b (mod m). If a - b is not divisible by m, we say that a is not congruent to b modulo m, and in this case we write a ;I; b (mod m). Since a - b is divisible by m if and only if a - b is divisible by -m, we can generally confine our attention to a positive modulus. Indeed, we shall assume throughout the present chapter that the modulus m is a positive integer. Congruences have many properties in common with equalities. Some properties that follow easily from the definition are listed in the following theorem. Theorem 2.1 Let a, b, c, d denote integers. Then: (1) a = b (mod m), b =a (mod m), and a - b = O(mod m) are equivalent statements. (2) If a = b (mod m) and b = c (mod m), then a = c (mod m). (3) /fa = b(mod m) and c = d(mod m), then a+ c = b + d(mod m). (4) If a = b (mod m) and c = d (mod m), then ac = bd (mod m). (5) If a = b (mod m) and dim, d > 0, then a = b (mod d). (6) If a = b (mod m) then ac = be (mod me) for c > 0. Theorem 2.2 Let f denote a polynomial with integral coefficients. If a = b (mod m) then f(a) = f(b) (mod m). Proof We can suppose f(x) = cnx\" + cn - lxn - l + .. . +co where the C; are integers. Since a = b (mod m) we can apply Theorem 2. 1, part 4, repeatedly to find a2 = b2, a3 = b3, - ·· ,a\" = b\" (mod m), and then c.aj = c.bj (mod m) and finally c a\" + c an - t + · · · +c = c b\" + 1 1 • n n - l 0 n cn _1b\" - 1 + · · · +c0 (mod m), by Theorem 2.1 part 3. You are, of course, well aware of the property of real numbers that if ax = ay and a \"* 0 then x = y. More care must be used in dividing a congruence through by a. 2. 1 Congruences Theorem 2.3 (1) ax = ay (mod m) if and only if x = Y (mod (a �m) ) · (2) If ax = ay (mod m) and (a, m) = 1, then x = y (mod m). (3) x = y (mod m) for i = 1, 2, · · ·, r if and only if x = y (mod [m1 , m2, • • ·, m,)). 49 Proof (1) If ax = ay (mod m) then ay -ax = mz for some integer z. Hence we have and thus a m ( ) ( y- x ) = ( ) z , a, m a, m m , _ _ a_( y _ x ) (a, m) ( a , m) · But (aj(a, m), mj(a , m)) = 1 by Theorem 1.7 and therefore (mj(a, m)}l(y - x) by Theorem 1.10. That is, x =y ( mod (a�m) ) · Conversely, if x = y (mod mj(a, m)), we multiply by a to get ax = ay (mod amj(a , m)) by use of Theorem 2.1, part 6. But (a, m) is a divisor of a, so we can write ax = ay (mod m) by Theorem 2.1, part 5. For example, 15x = 15y (mod 10) is equivalent to x = y (mod 2), which amounts to saying that x and y have the same parity. (2) This is a special case of part 1. It is listed separately because we shall use it very often. (3) If x =y (mod m) for i= 1, 2, · ·· ,r, then m ; l ( y -x) for i= 1, 2, · · ·, r. That is, y - x is a common multiple of m 1, m2 , • • · , m,, and therefore (see Theorem 1.12) [m 1, m2 , • • ·, m,] l(y - x). This implies x = y (mod [m 1, m2, • • ·, m,]). If x = y (mod [m 1 , m2, • • · , m, )) then x = y (mod m) by Theorem 2.1 part 5, since m; l[m 1, m2 , • • ·, m,]. In dealing with integers modulo m, we are essentially performing the ordinary operations of arithmetic but are disregarding multiples of m. In a sense we are not distinguishing between a and a + mx, where x is any integer. Given any integer a, let q and r be the quotient and remainder on 50 Congruences division by m; thus a = qm + r by Theorem 1.2. Now a = r (mod m) and, since r satisfies the inequalities 0 � r < m, we see that every integer is congruent modulo m to one of the values 0, 1, 2, · · ·, m - 1. Also it is clear that no two of these m integers are congruent modulo m. These m values constitute a complete residue system modulo m, and we now give a general definition of this term. Definition 2.2 If x = y (mod m) then y is called a residue of x modulo m. A set x 1, x2 , • • ·, xm is called a complete residue system modulo m if for every integer y there is one and only one xi such that y = xi (mod m). It is obvious that there are infinitely many complete residue systems modulo m, the set 1, 2, · · · , m - 1, m being another example. A set of m integers forms a complete residue system modulo m if and only if no two integers in the set are congruent modulo m. For fixed integers a and m > 0, the set of all integers x satisfying x = a (mod m) is the arithmetic progression ··· ,a - 3m , a - 2m , a- m, a ,a + m, a +2m , a+ 3m ,· ·· . This set is called a residue class, or congruence class, modulo m. There are m distinct residue classes modulo m , obtained for example by taking successively a = 1, 2, 3, · · ·, m. Theorem 2.4 If b = c (mod m), then (b, m) = (c, m). Proof We have c = b + mx for some integer x. To see that (b, m) = (b + mx, m), take a = m in Theorem 1.9. Definition 2.3 A reduced residue system modulo m is a set of integers r; such that (r;, m) = 1, r; ;;; ri (mod m) if i \"* j, and such that every x prime to m is congruent modulo m to some member r; of the set. In view of Theorem 2.4 it is clear that a reduced residue system modulo m can be obtained by deleting from a complete residue system modulo m those members that are not relatively prime to m. Further­ more, all reduced residue systems modulo m will contain the same number of members, a number that is denoted by cf>(m). This function is called Euler's cf>-function, sometimes the totient. By applying this definition of cf>(m) to the complete residue system 1, 2, · · ·, m mentioned in the paragraph following Definition 2.2, we can get what amounts to an alternative definition of cf>(m), as given in the following theorem. 2. 1 Congruences 51 Theorem 2.5 The number lf>(m) is the number of positive integers less than or equal to m that are relatively prime to m. Euler's function lf>(m) is of considerable interest. We shall consider it further in Sections 2.3, 4.2, 8.2, and 8.3. Theorem 2.6 Let (a, m) = 1. Let r1, r2, • • ·, rn be a complete, or a re­ duced, residue system modulo m. Then ar 1, ar 2, • • ·, ar n is a complete, or a reduced, residue system , respectively, modulo m. For example, since 1, 2, 3, 4 is a reduced residue system modulo 5, so also is 2, 4, 6, 8. Since 1, 3, 7, 9 is a reduced residue system modulo 10, so is 3, 9, 21, 27. Proof If (r;, m) = 1, then (ar;, m) = 1 by Theorem 1.8. There are the same number of arp ar2 , . • ·, arn as of r1, r2, · • ·, r \"' Therefore we need only show that ar; '¢ arj (mod m) if i =1:- j. But Theo­ rem 2.3, part 2, shows that ar; = arj (mod m) implies r; = rj (mod m) and hence i = j. Theorem 2.7 Fermat's theorem . Let p denote a prime. If p)' a then ap - l = l(mod p). For every integer a, aP =a (mod p). We shall postpone the proof of this theorem and shall obtain it as a corollary to Theorem 2.8. Theorem 2.8 Euler's generalization of Fermat's theorem. If (a, m) = 1, then a<P<m> = 1 (mod m) . Proof Let r1, r2 , . • ·, r<P<m> be a reduced residue system modulo m. Then by Theorem 2.6, ar 1, ar 2 , • • ·, ar <P<m> is also a reduced residue system modulo m. Hence, corresponding to each r; there is one and only one arj such that r; = arj (mod m). Furthermore, different r; will have different corresponding arj. This means that the numbers arp ar2 , . • ·, ar<P<m> are just the residues modulo m of r1, r2, . • ·, r<P<m>• but not necessarily in the same order. Multiplying and using Theorem 2.1, part 4, we obtain ,P( m) ,P(m) n (arj) = n r; ( mod m ) , j =l i= l 52 and hence <f>(m) <f>(m) a<f>(m) n r. = n rj (mod m) . j= l J j= l Congruences Now (rj, m) = 1, so we can use Theorem 2.3, part 2, to cancel the rj and we obtain a<f><m> = 1 (mod m). Proof of Theorem 2. 7 If p% a, then (a, p) = 1 and a<I><P> = 1 (mod p ). To find <f>(p), we refer to Theorem 2.5. All the integers 1, 2, · · · , p - 1, p with the exception of p are relatively prime to p. Thus we have <f>(p) = p - 1, and the first part of Fermat's theorem follows. The second part is now obvious. Theorem 2.9 If (a, m) = 1 then there is an x such that ax= 1 (mod m). Any two such x are congruent (mod m). If (a, m) > 1 then there is no such x. Proof If (a, m) = 1, then there exist x and y such th;it ax + my = 1. That is, ax = 1 (mod m). Conversely, if ax = 1 (mod m), then there is a y such that ax + my = 1, so that (a, m) = 1. Thus if ax1 = ax2 = 1 (mod m), then (a, m) = 1, and it follows from part 2 of Theorem 2.3 that x1 = x2 (mod m). The relation ax = 1 (mod m) asserts that the residue class x is the multiplicative inverse of the residue class a. To avoid confusion with the rational number a- 1 = 1ja, we denote this residue class by ii. The value of ii is quickly found by employing the Euclidean algorithm, as described in Section 1.2. The existence of ii is also evident from Theorem 2.6, for if (a, m) = 1, then the numbers a, 2a, ... , rna form a complete system of residues, which is to say that one of them is = 1 (mod m). In addition, the existence of ii can also be inferred from Theorem 2.8, by taking ii = a<f>(m) - t. Lemma 2.10 Let p be a prime number. Then x2 = 1 (mod p) if and only if x = ± l(mod p). In Section 2.7 we establish a more general result (Theorem 2.26) from which the foregoing is easily derived, but we give a direct proof now, since this observation has many useful applications. Proof This quadratic congruence may be expressed as x2 - 1 = O(mod p). That is, (x - 1Xx + 1) = O(mod p), which is to say that 2. 1 Congruences 55 K < {ii < K + 1. We consider pairs (u, v) of integers for which 0 � u � K and 0 � v � K. Since u and v each take on K + 1 values, we have ( K + 1)2 pairs. Since K + 1 > {ii, the number of pairs is > p. If we consider f(u, v)(mod p), we have more numbers under consideration than we have residue classes to put them in, so there must be some residue class that contains the number f(u, v) for two different pairs (u, v ). (This is known as the pigeonhole principle, which we discuss in greater detail in Section 4.5.) Suppose, for example, that (u1, v1) and (u2, v2) are distinct pairs with coordinates in the interval [0, K], for which f(up v1) = f(u2, v2)(mod p). That is, u1 + xv1 = u2 + xv2 (mod p), which gives (u1 - u2) = -x(v1 - v2)(mod p). Take a = u1 - u2 and b = v1 - v2• Then a = -xb (mod p), and on squaring both sides we see that a2 = ( -xb)2 = x2b2 = -b2 (mod p) since x2 = -1 (mod p). That is, a2 + b2 = O(mod p), which is to say that pl(a2 + b2). Since the ordered pair (u1, v1) is distinct from the pair (u2, v2), it foliows that not both a and b vanish, so that a2 + b2 > 0. On the other hand, u1 � K and u2 � 0, so that a = u1 - u2 � K. Similarly, we may show that a � - K, and in the same manner that - K � b � K. But K < {ii, so this gives Ia I < {ii and lbl < {ii . On squaring these inequalities we find that a2 < p and b2 < p, which gives a2 + b2 < 2p. Thus altogether we have shown that 0 < a2 + b2 < 2p and that pl(a2 + b2). But the only multiple of p in the interval (0, 2p) is p, so we conclude that a2 + b2 = p. We now establish a similar result in the converse direction. Lemma 2.14 Let q be a prime factor of a2 + b2• If q = 3 (mod 4) then q Ia and qlb. Proof We prove the contrapositive, that is, that if q does not divide both a and b then q ¢. 3 (mod 4). By interchanging a and b, if necessary, we may suppose that (a, q) = 1. Let ii be chosen so that aa = 1 (mod q). We multiply both sides of the congruence a2 = -b2 (mod q) by 0.2 to see that 1 = (aa)2 = -(ba)2 (mod q ). Thus if x = ba then x is a solution of the congruence x2 = -1 (mod q ), and by Theorem 2.12 it follows that q = 2 or q = 1(mod 4). Theorem 2.15 Fermat. Write the canonical factorization of n in the form n = 2a n pf3 n qY. p \"' 1(4) q :'!3(4) Then n can be expressed as a sum of two squares of integers if and only if all the exponents y are even. 56 Congruences Proof We note that the identity holds for any real numbers. In particular, it follows that if m and n are both sums of two squares then mn is also a sum of two squares. The prime number 2 = 12 + 12 is a sum of two squares, and every prime number p = 1 (mod 4) is a sum of two squares. If q is a prime number, q = 3 (mod 4), then q2 = q2 + 02 is a sum of two squares. Hence any number that may be expressed as a product of 2's, p's, and q2's is a sum of two squares. Conversely, suppose that n is a sum of two squares, say n = a2 + b2• If q is a prime number, q = 3 (mod 4), for which y > 0, then qln, and by Lemma 2.14 it follows that qla and ql b, which implies that q2ln. That is, y � 2, and we may write njq2 = (ajq)2 + (bjq)2• By applying this same argument to n 1 q 2 we discover that if y > 2 then y � 4 and that q2 la and q2lb. Since this process must terminate, we conclude that y must be even, and additionally that qY12ia and qY12ib. This theorem of Fermat is the first of many similar such theorems. The object of constructing a coherent theory of quadratic forms was the primary influence on research in number theory for several centuries. The first step in the theory is to generalize Theorem 2. 12. This is accomplished in the law of quadratic reciprocity, which we study in the initial sections of Chapter 3. With this tool in hand, we develop some of the fundamentals concerning quadratic forms in the latter part of Chapter 3. In Section 3.6 we apply the general theory to sums of two squares, to give not only a second proof of Theorem 2. 15, but also some further results. PROBLEMS 1. List all integers x in the range 1 � x � 100 that satisfy x = 7(mod 17). 2. Exhibit a complete residue system modulo 17 composed entirely of multiples of 3. 3. Exhibit a reduced residue system for the modulus 12; for 30. 4. If an integer x is even, observe that it must satisfy the congruence x = 0 (mod 2). If an integer y is odd, what congruence does it satisfy? What congruence does an integer z of the form 6k + 1 satisfy? 5. Write a single congruence that is equivalent to the pair of congru­ ences x = l (mod 4), x = 2 (mod 3). 6. Prove that if p is a prime and a2 = b2 (mod p), then pl(a +b ) or pl (a - b). 2. 1 Congruences 57 7. Show that if f(x) is a polynomial with integral coefficients and if f(a) = k (mod m), then f(a + tm) = k (mod m) for every integer t. 8. Prove that any number that is a square must have one of the following for its units digit: 0, 1, 4, 5, 6, 9. 9. Prove that any fourth power must have one of 0, 1, 5, 6 for its units digit. 10. Evaluate <fJ(m) for m = 1, 2, 3, · · ·, 12. 11. Find the least positive integer x such that 13 1 (x 2 + 0. 12. Prove that 19 is not a divisor of 4n2 + 4 for any integer n. 13. Exhibit a reduced residue system modulo 7 composed entirely of powers of 3. 14. Show that 7l(32n + l + 2n +2) for all n. 15. Find integers ai> · · ·, a5 such that every integer x satisfies at least one of the congruences x = a 1 (mod 2), x = a2 (mod 3), x = a3 (mod 4), x = a4 (mod 6), x = a5 (mod 12). 16. Illustrate the proof of Theorem 2.11 for p = 11 and p = 13 by actually determining the pairs of associated integers. 17. Show that 61 !+ 1 = 63! + 1 = O(mod 70. 18. Show that if p = 3 (mod 4), then ( P � 1 ) ! = ± 1 (mod p). 19. Prove that n6 - 1 is divisible by 7 if (n, 7) = 1. 20. Prove that n1 - n is divisible by 42, for any integer n. 21. Prove that n12 - 1 is divisible by 7 if (n, 7) = 1. 22. Prove that n6k - 1 is divisible by 7 if (n, 7) = 1, k being any positive integer. 23. Prove that n13 - n is divisible by 2, 3, 5, 7 and 13 for any integer n. 24. Prove that n12 - a 12 is divisible by 13 if n and a are prime to 13. 25. Prove that n12 - a12 is divisible by 91 if n and a are prime to 91. 26. Show that the product of three consecutive integers is divisible by 504 if the middle one is a cube. 27. Prove that kn5 + -}n3 + fsn is an integer for every integer n. 28. What is the last digit in the ordinary decimal representation of 3400? (H) 29. What is the last digit in the ordinary decimal representation of 2400? 30. What are the last two digits in the ordinary decimal representation of 34oo? (H) 31. Show that -(m - 0/2, - (m - 3)/2, - · ·,(m - 3)/2, (m - 0/2 is a complete residue system modulo m if m is odd, and that - (m - 2)/2, -(m - 4)/2, · · ·, (m - 2)/2, m/2 is a complete residue system modulo m if m is even. 58 Congruences 32. Show that 2, 4, 6, · · ·, 2m is a complete residue system modulo m if m is odd. 33. Show that 12, 2 2, • • • , m 2 is not a complete residue system modulo m if m > 2. 34. Show that an integer m > 1 is a prime if and only if m divides (m - 1)! + 1. 35. If n is composite, prove that (n - 1)! + 1 is not a power of n. 36. If p is a prime, prove that (p - 1)! + 1 is a power of p if and only if p = 2, 3, or 5. (H) 37. Show that there exist infinitely many n such that n! + 1 is divisible by at least two distinct primes. 38. Prove that there are infinitely many primes of the form 4n + 1. (H) 39. If a and b are real numbers such that a2 = b2, it is well known that a = b or a = - b. Give an example to show that if a2 = b 2 (mod m2) for integers a, b and m � 2, it does not necessarily follow that a = b (mod m) or a = -b (mod m). 40. For m odd, prove that the sum of the elements of any complete residue system modulo m is congruent to zero modulo m; prove the analogous result for any reduced residue system for m > 2. 41. Find all sets of positive integers a, b, c satisfying all three congru­ ences a = b (mod c), b = c (mod a), c =a (mod b). (H) 42. Find all triples a, b, c of nonzero integers such that a = b (mod I c I), b = c(mod lal), c = a(mod lb l). 43. If p is an odd prime, prove that: 12 • 32 ·52 •• • (p - 2) 2 = ( -1 )(p + D/2 (mod p) and 2 2 • 42 • 62 • • • ( p - 1) 2 = ( -1) (p + D/2 (mod p) . •44. Show that if p is prime then ( P � 1 ) = ( -l)k (mod p) for 0 � k � p- l . •45. Show that if p is prime then ( � ) = 0 (mod p) for 1 � k � p - 1. •46. For any prime p, if aP = bP (mod p), prove that aP = b P (mod p2). 47. If r1, r2 ,- · · ,rp -! is any reduced residue system modulo a prime p, prove that p - ! n rj = - 1 (mod p) . j = l 2.1 Congruences 59 •48. If r1,r2, . ·· ,rP and rf, r:Z, . ·· ,r; are any two complete residue sys­ tems modulo a prime p > 2, prove that the set r1r), r2r:Z, . · · , rPr; cannot be a complete residue system modulo p. *49. If p is any prime other than 2 or 5, prove that p divides infinitely many of the integers 9, 99, 999, 9999, · · · . If p is any prime other than 2 or 5, prove that p divides infinitely many of the integers 1, 11, 11 1,1 111, ... . *50. Given a positive integer n, prove that there is a positive integer m that to base ten contains only the digits 0 and 1 such that nl m. Prove that the same holds for digits 0 and 2, or 0 and 3, · · · , or 0 and 9, but for no other pair of digits. 51. Prove that (p - 1)! = p - l (mod 1 + 2 + · · · + (p - 1)) if p is a prime. *52. Show that if p is prime then pl((p - 2)! - 1), but that if p > 5 then (p - 2)! - 1 is not a power of p. (H) 53. Show that there are infinitely many n such that n! - 1 is divisible by at least two distinct primes. 54. (a) Noting the factoring 341 = 11 · 31, verify that 25 = l(mod 31) and hence that 2341 = 2 (mod 341), but that 3341 \"¢= 3 (mod 341). (b) Using the factoring 561 = 3 · 11 · 17, prove that a561 = a (mod 561) holds for every integer a. Remarks A composite integer m such that am - 1 = 1 (mod m) is called a pseudoprime to the base a. There are infinitely many pseudo­ primes to the base 2 (see Problem 19 in Section 2.4), 341 and 561 being the smallest two. A composite integer m that is a pseudoprime to base a whenever (a, m) = 1 is called a Carmichael number, the smallest being 561. All Carmichael numbers < 1013 are known. It is not known that there are infinitely many, but it is conjectured that for any E > 0 there is an x0(c ) such that if x > x0(E ), then the number of Carmichael numbers not exceeding x is > x 1 - < . *55. Let A = [a;) and B = [b;) be two n X n matrices with integral entries. Show that if a;i = bii (mod m) for all i, j, then det (A) = det (B) (mod m). Show that r 4771 6573 det 9712 8154 2158 1452 8056 2574 2701 7602 8404 7312 4612 6007 5995 3275 2265 4321 2147 2327 91631 3639 7196 \"* 0 . 7465 8882 (H) *56. Let p be a prime number, and suppose that x is an integer such that x 2 = - 2 (mod p ). By considering the numbers u + xu for various 60 Congruences pairs (u, v ), show that at least one of the equations a2 + 2b2 = p, a2 + 2b2 = 2p has a solution. 57. Show that (a + b�Xc + d�) = (ac - 2bd) + (be + ad)�. Thus or otherwise show that (a2 + 2b2Xc2 + 2d2) = (ac - 2bd)2 + 2(bc + ad)2• 58. Show that if p is an odd prime and a2 + 2b2 = 2p , then a is even and b is odd. Deduce that (2b)2 + 2a2 = 4p, and hence that b2 + 2(aj2)2 = p. 59. Let p be a prime factor of a2 + 2b2. Show that if p does not divide both a and b then the congruence x 2 = - 2 (mod p) has a solution. 60. Combine the results of the foregoing problems to show that a prime number p can be expressed in the form a2 + 2b2 if and only if the congruence x 2 = - 2 (mod p) is solvable. (In Chapter 3 we show that this congruence is solvable if and only if p = 2 or p = 1 or 3 (mod 8).) 2.2 SOLUTIONS OF CONGRUENCES In analogy with the solution of algebraic equations it is natural to consider the problem of solving a congruence. In the rest of this chapter we shall let f(x) denote a polynomial with integral coefficients, and we shall write f(x) = anxn + an - ixn - i + . .. + ao. If u is an integer such that f(u) = 0 (mod m), then we say that u is a solution of the congruence f(x) = 0 (mod m). Whether or not an integer is a solution of a congruence depends on the modulus m as well as on the polynomial f(x). If the integer u is a solution of f(x) = 0 (mod m), and if v = u (mod m), Theo­ rem 2.2 shows that v is also a solution. Because of this we shall say that x = u (mod m) is a solution of f(x) = 0 (mod m), meaning that every integer congruent to u modulo m satisfies f(x) = O(mod m). For example, the congruence x 2 - x + 4 = O(mod 10) has the solu­ tion x = 3 and also the solution x = 8. It also has the solutions x = 13, x = 18, and all other numbers obtained from 3 and 8 by adding and subtracting 10 as often as we wish. In counting the number of solutions of a congruence, we restrict attention to a complete residue system belonging to the modulus. In the example x2 - x + 4 = 0 (mod 10), we say that there are two solutions because x = 3 and x = 8 are the only numbers among 0, 1, 2, · · · , 9 that are solutions. The two solutions can be written in equation form, x = 3 and x = 8, or in congruence form, x = 3 (mod 10) and x = 8 (mod 10). As a second example, the congruence x2 - 7x + 2 = 0 (mod 10) has exactly four solutions x = 3, 4, 8, 9. The reason for counting the number of solutions in this way is that if f(x) = 0 (mod m) has a solution x = a, then it follows that all integers x satisfying x = a (mod m) 2. 2 Solutions of Congruences 61 are automatically solutions, so this entire congruence class is counted as a single solution. Definition 2.4 Let r 1, r 2, · • • , r m denote a complete residue system modulo m. The number of solutions of f(x) = 0 (mod m) is the number of the r; such that f(r) = 0 (mod m). It is clear from Theorem 2.2 that the number of solutions is indepen­ dent of the choice of the complete residue system. Furthermore, the number of solutions cannot exceed the modulus m. If m is small it is a simple matter to just compute f(r) for each of the r; and thus to determine the number of solutions. In the foregoing example the congru­ ence has just two solutions. Some other examples are x2 + 1 = 0 (mod 7) has no solution , x2 + 1 = 0 (mod S) has two solutions, x2 - 1 = 0 (mod 8) has four solutions . Definition 2.5 Let f(x) = anxn + an _ 1x n - l + · · · + a0. If an '1= O(mod m) the degree of the congruence f(x) = O(mod m) is n. If an = 0 (mod m ), let j be the largest integer such that a j '1= 0 (mod m ); then the degree of the congruence is j. If there is no such integer j, that is, if all the coefficients of f(x) are multiples of m, no degree is assigned to the congru­ ence. It should be noted that the degree of the congruence f(x) = 0 (mod m) is not the same thing as the degree of the polynomial f(x). The degree of the congruence depends on the modulus; the degree of the polynomial does not. Thus if g(x) = 6x3 + 3x2 + 1, then g(x) = 0 (mod 5) is of degree 3, and g(x) = O(mod 2) is of degree 2, whereas g(x) is of degree 3. Theorem 2.16 If dim, d > 0, and if u is a solution of f(x) = O(mod m), then u is a solution of f(x) = 0 (mod d). Proof This follows directly from Theorem 2. 1, part 5. There is a distinction made in the theory of algebraic equations that has an analogue for congruences. A conditional equation, such as x2 - Sx + 6 = 0, is true for only certain values of x, namely x = 2 and x = 3. An identity or identical equation, such as (x - 2)2 = x2 - 4x + 4, holds for all real numbers x, or for all complex numbers for that matter. 62 Congruences Similarly, we say that f(x) = 0 (mod m) is an identical congruence if it holds for all integers x. If f(x) is a polynomial all of whose coefficients are divisible by m, then f(x) = 0 (mod m) is an identical congruence. A different type of identical congruence is illustrated by xP = x (mod p), true for all integers x by Fermat's theorem. Before considering congruences of higher degree, we first describe the solutions in the linear case. Theorem 2.17 Let a, b, and m > 0 be given integers, and put g = (a, m). The congruence ax= b (mod m) has a solution if and only if glb. If this conditwn is met, then the solutwns form an arithmetic progression with common difference mjg, giving g solutwns (mod m). Proof The question is whether there exist integers x and y such that ax + my = b. Since g divides the left side, for such integers to exist we must have glb. Suppose that this condition is met, and write a = ga, b = gf3, m = g�J-. Then by the first part of Theorem 2.3, the desired congruence holds if and only if ax = f3 (mod IJ-). Here (a, IJ-) = 1 by Theorem 1.7, so by Theorem 2.9 there is a unique number a (mod IJ-) such that a a = 1 (mod IJ-). On multiplying through by a, we find that x = aax = af3 (mod IJ-). Thus the set of integers x for which ax = b (mod m) is precisely the arithmetic progression of numbers of the form af3 + k�J-. If we allow k to take on the values 0, 1, ... , g - 1, we obtain g values of x that are distinct (mod m). All other values of x are congruent (mod m) to one of these, so we have precisely g solutions. Since a can be located by an application of the Euclidean algorithm, the solutions are easily found. PROBLEMS 1. If f(x) = 0 (mod p) has exactly j solutions with p a prime, and g(x) = O(mod p) has no solution, prove that f(x)g(x) = O(mod p) has exactly j solutions. 2. Denoting the number of solutions of f(x) = k (mod m) by N(k), prove that I:k'- t N(k) = m. 3. If a polynomial congruence f(x) = O(mod m) has m solutions, prove that any integer whatsoever is a solution. 4. The fact that the product of any three consecutive integers is divisible by 3 leads to the identical congruence x(x + 1Xx + 2) = 0 (mod 3). Generalize this, and write an identical congruence modulo m. 2. 2 Solutions of Congruences 5. Find all solutions of the congruences (a) 20x = 4(mod30); (e) 64x = 83 (mod 105): (b) 20x = 30(mod 4); (f) 589x = 209 (mod 817); (c) 353x = 254 (mod 400); (g) 49x = 5000 (mod 999). (d) 57x = 87 (mod 105); 63 6. How many solutions are there to each of the following congruences: (a) 15x = 25 (mod 35); (b) 15x = 24 (mod 35); (c) 15x = O(mod 35)? 7. If a is selected at random from 1, 2, 3, · · · , 14, and b is selected at random from 1, 2, 3, · · ·, 15, what is the probability that ax = b (mod 15) has at least one solution? Exactly one solution? 8. Show that if p is an odd prime then the congruence x2 = 1 (mod pa) has only the two solutions x = 1, x = -1 (mod pa). 9. Show that the congruence x2 = 1 (mod 2a) has one solution when a = 1, two solutions when a = 2, and precisely the four solutions 1 ,2a - I - 1,2a - I + 1 , - 1 when a� 3. 10. Show that if p is an odd prime then the number of solutions (ordered pairs) of the congruence x2 - y2 =a (mod p) is p - 1 unless a = 0 (mod p ), in which case the number of solutions is 2 p - 1. (H) 11. Suppose (a, m) = 1, and let x 1 denote a solution of ax= 1 (mod m). For s = 1, 2,- ·· , let X5 = 1ja - O;aX1 - ax 1 )5• Prove that X5 is an integer and that it is a solution of ax = 1 (mod m5). *12. Suppose that (a, m) = 1. If a = ± 1, the solution of ax = 1 (mod m5) is obviously x = a (mod m5). If a = ± 2, then m is odd and x = tO - m5)ta (mod m5) is the solution of ax = 1 (mod m5). For all other a use Problem 11 to show that the solution of ax = 1 (mod m5) is x = k (mod m5) where k is the nearest integer to -(l;aX1 - ax 1)5• 13. Solve 3x = 1 (mod 125) by Problem 12, taking x 1 = 2. *14. Show that (�a ) = O(mod p) for 0 < k < pa. (H) *15. Show that ( pa ; 1 ) = ( - l)k (mod p) for 0 � k � pa - 1. (H) *16. Show that if r is a non-negative integer then all coefficients of the polynomial (1 + x)2' - (1 + x2') are even. Write a positive integer n in binary, n = .L, 2'. Show that all coefficients of the polynomial r E.'JP (1 + x )\" - n (1 + x2') are ev:en. Write k = E 25 in binary. Show r E.'JP s E ./ that { Z) is odd if and only if J\"s;;; �. Conclude that if n is given, 64 Congruences then ( �) is odd for precisely 2w<n> values of k, where w(n), called the binary weight of n, is the number of 1's in the binary expansion of n. In symbols, w(n) = card (9£'). Note This is a special case of a result of E. Lucas, proved in 1891. See N. J. Fine, \"Binomial coefficients modulo a prime,\" Amer. Math. Monthly, 54 (1947), 589-592. *17. Let the numbers C; be defined by the power series identity ( 1 + x + · · · +xP - 1 )/( 1 - x) p- l = 1 + c1 x + c2 x2 + · · · Show that c; = O(mod p) for all i � 1. 2.3 THE CHINESE REMAINDER THEOREM We now consider the important problem of solving simultaneous congru­ ences. The simplest case of this is to find those x (if there are any) that satisfy the simultaneous congruences (2.1) This is the subject of the next result, called the Chinese Remainder Theorem because the method was known in China in the first century A.D. Theorem 2.18 The Chinese Remainder Theorem. Let m 1, m2 ,- • · , m, de­ note r positive integers that are relatively prime in pairs, and let a 1, a 1 , · · · , a, denote any r integers. Then the congruences (2.1) have common solutions. If x0 is one such solution, then an integer x satisfies the congruences (2.1) if and only if x is of the form x = x0 + km for some integer k. Here m = m 1m2 • • • m,. Using the terminology introduced in the previous section, the last assertion of the Theorem would be expressed by saying that the solution x is unique modulo m 1m2 • • • m,. Proof Writing m = m1m2 • • • m,, we see that m/mj is an integer and that (mjmj, m) = 1. Hence by Theorem 2.9 for each j there is an integer 2. 3 The Chinese Remairuler Theorem 65 bj such that (mjmj)bj = l(mod mj). Clearly (m/m)bj = O(mod m) if i * j. Put We consider this number modulo m;, and find that m x0 = -b;a; = a; (mod m;) . m; Thus x0 is a solution of the system (2.1). ( 2.2) If x0 and x 1 are two solutions of the system (2.1), then x0 = x1 (mod m) for i = 1, 2, - · · , r, and hence x0 = x 1 (mod m) by part 3 of Theorem 2.3. This completes the proof. Example 1 Find the least positive integer x such that x = 5 (mod 7), x = 7 (mod 11), and x = 3 (mod 13). Solution We follow the proof of the theorem, taking a 1 = 5, a 2 = 7, a3 = 3, m 1 = 7, m 2 = 11, m 3 = 13, and m = 7 · 11 · 13 = 1001. Now (m2 m3, m 1 ) = 1, and indeed by the Euclidean algorithm we find that ( -2) · m 2m 3 +\"1 · m 1 = 1, so we may take b 1 = -2. Similarly, we find that 4 · m 1 m 3 + (- 33) · m 2 = 1, so we take b2 = 4. By the Euclidean algorithm a third time we find that ( -1) · m1m 2 + 6 · m3 = 1, so we may take b3 = - 1. Then by (2.2) we see that 11 · 13 · (- 2) · 5 + 7 · 13 · 4 · 7 + 7 · 11 · ( -1) · 3 = 887 is a solution. Since this solution is unique modulo m , this is the only solution among the numbers 1, 2, · · · , 1001. Thus 887 is the least positive solution. In the Chinese Remainder Theorem, the hypothesis that the moduli mj should be pairwise relatively prime is absolutely essential. When this hypothesis fails, the existence of a solution x of the simultaneous system (2.1) is no longer guaranteed, and when such an x does exist, we see from Part 3 of Theorem 2.3 that it is unique modulo [m 1 , m 2 ,- • · , m,], not modulo m. In case there is no solution of (2.1), we call the system inconsistent. In the following two examples we explore some of the possibil­ ities that arise when the m j are allowed to have common factors. An extension of the Chinese Remainder Theorem to the case of unrestricted mj is laid out in Problems 19-23. Example 2 Show that there is no x for which both x = 29 (mod 52) and x = 19 (mod 72). 66 Congruences Solution Since 52 = 4 · 13, we see by Part 3 of Theorem 2.3 that the first congruence is equivalent to the simultaneous congruences x = 29 (mod 4) and x = 29 (mod 13), which reduces to x = 1 (mod 4) and x = 3 (mod 13). Similarly, 72 = 8 · 9, and the second congruence given is equivalent to the simultaneous congruences x = 19 (mod 8) and x = 19 (mod 9). These re­ duce to x = 3 (mod 8) and x = 1 (mod 9). By the Chinese Remainder Theorem we know that the constraints (mod 13) and (mod 9) are indepen­ dent of those (mod 8). The given congruences are inconsistent because there is no x for which both x = 1 (mod 4) and x = 3 (mod 8). Once an inconsistency has been identified, a brief proof can be constructed: The first congruence implies that x = 1 (mod 4) while the second congruence implies that x = 3 (mod 4). Example 3 Determine whether the system x = 3 (mod 10), x = 8 (mod 15), x = 5 (mod 84) has a solution, and find them all, if any exist. First Solution We factor each modulus into prime powers. By Part 3 of Theorem 2.3, we see that the first congruence of the system is equivalent to the two simultaneous congruences x = 3 (mod 2), x = 3 (mod 5). Simi­ larly, the second congruence of the system is equivalent to the two conditions x = 8 (mod 3), x = 8 (mod 5), while the third congruence is equivalent to the three congruences x = 5 (mod 4), x = 5 (mod 3), x = 5 (mod 7). The new system of seven simultaneous congruences is equiva­ lent to the ones given, but now all moduli are prime powers. We consider the powers of 2 first. The two conditions are x = 3 (mod 2) and x = 1 (mod 4). These two are consistent, but the second one implies the first, so that the first one may be dropped. The conditions modulo 3 are x = 8 (mod 3) and x = 5 (mod 3). These are equivalent, and may be ex­ pressed as x = 2 (mod 3). Third, the conditions modulo 5 are x = 3 (mod 5), x = 8 (mod 5). These are equivalent, so we drop the second of them. Finally, we have the condition x = 5 (mod 7). Hence our system of seven congruences is equivalent to the four conditions x = 1 (mod 4), x = 2 (mod 3), x = 3 (mod 5), and x = 5 (mod 7). Here the moduli are relatively prime in pairs, so we may apply the formula (2.2) used in the proof of the Chinese Remainder Theorem. Proceeding as in the solution of Example 1, we find that x satisfies the given congruences if and only if x = 173 (mod 420). The procedure we employed here provides useful insights concerning the way that conditions modulo powers of the same prime must mesh, but when the numbers involved are large, it requires a large amount of computation (because the moduli must be factored). A superior method is provided by the iterative use of Theorem 2.17. This avoids the need to 2. 3 The Chinese Remairuler Theorem 67 factor the moduli, and requires only r - 1 applications of the Euclidean algorithm. Second Solution The x that satisfy the third of the given congruences are precisely those x of the form 5 + 84u where u is an integer. On substitut­ ing this into the second congruence, we see that the requirement is that 5 + 84u = 8 (mod 15). That is, 84u = 3 (mod 15). By the Euclidean algorithm we find that (84, 15) = 3, and indeed we find that 2 · 84 + ( - 11) · 15 = 3. By Theorem 2.17 we deduce that u is a solution of the congruence if and only if u = 2 (mod 5). That is, u is of the form u = 2 + Sv, and hence x satisfies both the second and the third of the given congruences if and only if x is of the form 5 + 84(2 + 5v) = 173 + 420 v. The first congruence now requires that 173 + 420 v = 3 (mod 10). That is, 420 v = -170 (mod 10). By the Euclidean algorithm we find that (420, 10) = 10. Since 10 1170, we deduce that this congruence holds for all v. That is, in this example, any x that satisfies the second and third of the given congruences also satisfies the first. The set of solutions consists of those x of the form 173 + 420 v. That is, x = 173 (mod 420). This procedure can be applied to general systems of the sort (2. 1). In case the system is inconsistent, the inconsistency is revealed by a failure of the condition gl b in Theorem 2. 17. Alternatively, if it happens that the moduli are pairwise relatively prime, then g = 1 in each application of Theorem 2.17, and we obtain a second Oess symmetric) proof of the Chinese Remainder Theorem. Returning to Theorem 2. 18, we take a fixed set of positive integers m 1 , m 2 , • • ·, m,, relatively prime in pairs, with product m. But instead of considering just one set of equations (2. 1), we consider all possible systems of this type. Thus a 1 may be any integer in a complete residue system modulo m 1 , a 2 any integer in a complete residue system modulo m 2 , and so on. To be specific, let us consider a 1 to be any integer among 1, 2, · · · , m 1 , and a2 any integer among 1, 2, · · · , m 2 , · • ·, and a, any integer among 1, 2, · · ·, m,. The number of such r-tuples (ap a2 , · • ·, a,) is m 1 m 2 • • · m, = m. By the Chinese Remainder Theorem, each r-tuple determines precisely one residue class x modulo m. Moreover, distinct r-tuples determine different residue classes. To see this, suppose that (a 1 , a 2 , . ·· ,a,) '*- (a;, a2, · · · , a;). Then a; '*- a; for some i, and we see that no integer x satisfies both the congruences x = a; (mod m;) and x = a; (mod m). Thus we have a one-to-one correspondence between the r-tuples (a 1 , a2 , • · ·, a,) and a complete residue system modulo m, such as the integers 1, 2, · · · , m . It is perhaps not surprising that two sets, each having 68 Congruences m elements, can be put into one-to-one correspondence. However, this correspondence is particularly natural, and we shall draw some important consequences from it. For any positive integer n let -G\"(n) denote the complete residue system -G\"(n) = {1, 2, · · · , n}. The r-tuples we have considered are precisely the members of the Cartesian product (or direct product) of the sets -G\"(m 1), -G\"(m2), • · · , -G\"(m,). In symbols, this Cartesian product is denoted -G\"(m 1) X -G\"(m2) X · · · X -G\"(m,). For example, if IR denotes the set of real numbers, then IR X IR, abbreviated IR2, describes the ordinary Eu­ clidean plane with the usual rectangular coordinates belonging to any point (x, y ). In this notation, we may express the one-to-one correspon­ dence in question by writing Example 4 Exhibit the foregoing one-to-one correspondence explicitly, when m 1 = 7, m2 = 9, m = 63. Solution Consider the following matrix with 7 rows and 9 columns. At the intersection of the ith row and jth column we place the element cij• where c;j = i (mod 7) and c;j = j (mod 9). According to Theorem 2.18 we can select the element c;j from the complete residue system -G\"(63) = {1, 2, · · · , 63}. Thus the element 40, for example, is at the intersection of the fifth row and the fourth column, because 40 = 5 (mod 7) and 40 = 4 (mod 9). Note that the element 41 is at the intersection of the sixth row and fifth column, since 41 = 6 (mod 7) and 41 = 5 (mod 9). Thus the element c + 1 in the matrix is just southeast from the element c, allowing for periodicity when c is in the last row or column. For example, 42 is in the last row, so 43 turns up in the first row, one column later. Similarly, 45 is in the last column, so 46 turns up in the first column, one row lower. This gives us an easy way to construct the matrix: just write 1 in the c 11 position and proceed downward and to the right with 2, 3, and so on. 1 29 57 22 50 15 43 8 36 37 2 30 58 23 5 1 16 44 9 10 38 3 31 59 24 52 17 45 46 11 39 4 32 60 25 53 18 19 47 12 40 5 33 61 26 54 55 20 48 13 41 6 34 62 27 28 56 21 49 14 42 7 35 63 Here the correspondence between the pair {i, j) and the entry cu provides a solution to the problem. 2. 3 The Chinese Remainder Theorem 69 In the matrix, the entry c;j is entered in boldface if (c;j• 63) = 1. We note that these entries are precisely those for which i is one of the numbers {1, 2, · · · , 6}, and j is one of the numbers {1, 2, 4, 5, 7, 8}. That is, (c;j• 63) = 1 if and only if (i, 7) = 1 and (j, 9) = 1. Since there are exactly 6 such i, and for each such i there are precisely 6 such j, we deduce that tf>(63) = 36 = tf>(7)tf>(9). We now show that this holds in general, and we derive a formula for tf>(m) in terms of the prime factorization of m. Theorem 2.19 If m 1 and m2 denote two positive, relatively prime integers, then tf>(m 1�) = tf>(m 1)tf>(m2). Moreover, if m has the canonical factoriza­ tion m = ll P a , then tf>(m) = n (pa - pa- t ) = m n (1 - 1 /p). pl m pl m If m = 1, then the products are empty, and by convention an empty product has value 1. Thus the formula gives tf>(l) = 1 in this case, which is correct. Proof Put m = m 1m2 , and suppose that (x, m) = 1. By reducing x modulo m 1 we see that there is a unique a 1 E �(m 1 ) for which x = a 1 (mod m 1). Here, as before, �(m 1) is the complete system of residues tf(m 1) = {1, 2, · · ·, m 1}. Similarly, there is a unique a2 E �(m2) for which x = a2 (mod m 2). Since (x, m 1 ) = 1, it follows by Theorem 2.4 that (a 1, m 1) = 1. Similarly (a2, m 2) = 1. For any positive integer n, let 9P(n) be the system of reduced residues formed of those numbers a E tf(n) for which (a, n) = 1. That is, 9P(n) = {a E �(n): (a, n) = 1}. Thus we see that any x E 9P(m) gives rise to a pair (a1, a2) with a; E 9P(m) for i = 1, 2. Suppose, conversely, that we start with such a pair. By the Chinese Remainder Theorem (Theorem 2.18) there exists a unique x E tf(m) such that x =a; (mod m) for i = 1, 2. Since (a 1, m 1) = 1 and x = a 1 (mod m 1 ), it follows by Theorem 2.4 that (x, m 1) = 1. Similarly we find that (x, m2) = 1, and hence (x, m) = 1. That is, x E 9P(m). In this way we see that the Chinese Remainder Theorem enables us to establish a one-to-one correspondence between the reduced residue classes modulo m and pairs of reduced residue classes modulo m 1 and m 2, provided that (m 1, m2) = 1. Since a1 E 9P(m 1) can take any one of tf>(m 1) values, and az E 9P(m2) can take any one of tf>(m2) values, there are tf>(m1 )tf>(m 2) pairs, so that tf>(m) = tf>(m 1)tf>(m 2). We have now established the first identity of the theorem. If m = Opa is the canonical factorization of m, then by repeated use of this identity we see that tf>(m) = Ot/>(pa). To complete the proof it remains to deter­ mine the value of tf>( pa). If a is one of the pa numbers 1, 2, · · · , pa, then (a, pa) = 1 unless a is one of the pa- t numbers p, 2p, · · · , pa - t · p. On subtracting, we deduce that the number of reduced residue classes modulo pa is pa - pa- t = pa(l - 1jp). This gives the stated formulae. 70 Congruences We shall derive further properties of Euler's <P-function in Sections 4.2, 4.3, and an additional proof of the formula for </J(n) will be given in Section 4.5, by means of the inclusion-exclusion principle of combinatorial mathematics. Let f(x) denote a polynomial with integral coefficients, and let N(m) denote the number of solutions of the congruence f(x) = 0 (mod m) as counted in Definition 2.4. We suppose that m = m1m2, where (m 1, m 2) = 1. By employing the same line of reasoning as in the foregoing proof, we show that the roots of the congruence f(x) = 0 (mod m) are in one-to-one correspondence with pairs (a1, a2) in which a1 runs over all roots of the congruence f(x) = 0 (mod m1) and a2 runs over all roots of the congru­ ence f(x) = O(mod m2). In this way we are able to relate N(m) to N(m1) and N(m2). Theorem 2.20 Let f(x) be a fixed polynomial with integral coefficients, and for any positive integer m let N(m) denote the number of solutions of the congruence f(x) = O (mod m). If m = m1m2 where (m1, m2) = 1, then N(m) = N(m 1)N(m2). If m = Opa is the canonical factorization of m, then N(m) = ON(pa). The possibility that one or more of the N( pa) may be 0 is not excluded in this formula. Indeed, from Theorem 2.16 we see that if dim and N(d) = 0, then N(m) = 0. One immediate consequence of this is that the congruence f(x) = 0 (mod m) has solutions if and only if it has solutions (mod pa) for each prime-power pa exactly dividing m. Proof Suppose that x E �(m), where �(m) is the complete residue system �(m) = {1, 2, - · · ,m}. If f(x) = O(mod m) and m = m1m2, then by Theorem 2.16 it follows that f(x) = O(mod m1 ). Let a1 be the unique member of �(m 1) = {1, 2, ... , m 1} for which x = a1 (mod m1 ). By Theo­ rem 2.2 it follows that f(a 1) = O(mod m1 ). Similarly, there is a unique a2 E �(m2) such that x = a2 (mod m2), and f(a2) = 0 (mod m2). Thus for each solution of the congruence modulo m we construct a pair (ap a2) in which a; is a solution of the congruence modulo m;, for i = 1, 2. Thus far we have not used the hypothesis that m 1 and m2 are relatively prime. It is in the converse direction that this latter hypothesis becomes vital. Suppose now that m = m1m2, where (m 1, m2) = 1, and that for i = 1 and 2, numbers a; E �(m;) are chosen so that f(a) = O (mod m). By the Chinese Remainder Theorem (Theorem 2.18), there is a unique x E �(m) such that x = a; (mod m) for i = 1, 2. By Theorem 2.2 we see that this x is a solution of the congruence f(x) = O(mod m), for i= 1, 2. Then by Part 3 of Theorem 2.3 we conclude that f(x) = 0 (mod m). We have now 2.3 The Chinese Remainder Theorem 71 established a one-to-one correspondence between the solutions x of the congruence modulo m and pairs (a\" a2) of solutions modulo m1 and m2, resp�ctively. Since a1 runs over N(m 1) values, and a2 runs over N(m2) values, there are N(m1)N(m2) such pairs, and we have the first assertion of the theorem. The second assertion follows by repeated application of the first part. Example 5 Let f(x) = x2 + x + 7. Find all roots of the congruence f(x) = 0 (mod 15). Solution Trying the values x = 0, ± 1, ± 2, we find that f(x) = 0 (mod 5) has no solution. Since 5 1 15, it follows that there is no solution (mod 15). Example 6 Let f(x) be as in Example 5. Find all roots of f(x) = O (mod 189), given that 189 = 33 · 7, that the roots (mod 27) are 4, 13, and 22, and that the roots (mod 7) are 0 and 6. Solution In a situation of this kind it is more efficient to proceed as we did in the solution of Example 1, rather than employ the method adopted in the second solution of Example 3. By the Euclidean algorithm and (2.2), we find that x = a 1 (mod 27) and x = a2 (mod 7) if and only if x = 28a 1 - 27a2 (mod 189). We let a 1 take on the three values 4, 13, and 22, while a2 takes on the values 0 and 6. Thus we obtain the six solutions x = 13, 49, 76, 112, 139, 175 (mod 189). We have now reduced the problem of locating the roots of a polyno­ mial congruence modulo m to the case in which the modulus is a prime power. In Section 2.6 we reduce this further, to the case of a prime modulus, and finally in Section 2. 7 we consider some of the special properties of congruences modulo a prime number p. PROBLEMS 1. Find the smallest positive integer (except x = 1) that satisfies the following congruences simultaneously: x = 1 (mod 3), x = 1 (mod 5), x = 1 (mod 7). 2. Find all integers that satisfy simultaneously: x = 2 (mod 3), x = 3 (mod 5), x = 5 (mod 2). 3. Solve the set of congruences: x = 1 (mod 4), x = 0 (mod 3), x = 5 (mod 7). 72 Congruences 4. Find all integers that give the remainders 1, 2, 3 when divided by 3, 4, 5, respectively. S. Solve Example 2 using the technique that was applied to Example 4. 6. Solve Example 1 by the method used in the second solution of Example 3. 7. Determine whether the congruences 5x = 1 (mod 6), 4x = 13 (mod 15) have a common solution, and find them if they exist. 8. Find the smallest positive integer giving remainders 1, 2, 3, 4, and 5 when divided by 3, 5, 7, 9, and 11, respectively. 9. For what values of n is tf>(n) odd? 10. Find the number of positive integers \" 3600 that are prime to 3600. 11. Find the number of positive integers \" 3600 that have a factor greater than 1 in common with 3600. 12. Find the number of positive integers \" 7200 that are prime to 3600. 13. Find the number of positive integers \" 25200 that are prime to 3600. (Obsetve that 25200 = 7 x 3600.) 14. Solve the congruences: x3 + 2x - 3 = O( mod 9) ; x3 + 2x - 3 = O( mod 5) ; x3 + 2x - 3 = 0 (mod 45) . 15. Solve the congruence x3 + 4x + 8 = 0 (mod 15). 16. Solve the congruence x3 - 9x2 + 23x - 15 = 0 (mod 503) by obsetv­ ing that 503 is a prime and that the polynomial factors into (x - 1) (x - 3Xx - 5). 17. Solve the congruence x3 - 9x2 + 23x - 15 = O(mod 143). 18. Given any positive integer k, prove that there are k consecutive integers each divisible by a square > 1 . 19. Let m 1, m2, . • ·, m, be relatively prime in pairs. Assuming that each of the congruences b;x =a ; (mod m), i = 1, 2, · · · , r , is solvable, prove that the congruences have a simultaneous solution. 20. Let m 1 and m2 be arbitrary positive integers, and let a1 and a 2 be arbitrary integers. Show that there is a simultaneous solution of the congruences x = a 1 (mod m 1), x = a2 (mod m2), if and only if a 1 == a2 (mod g), where g = (m t> m2). Show that if this condition is met, then the solution is unique modulo [m 1, m2]. *21. Let p be a prime number, and suppose that mj = pa; in (2.1), where 1 \" a 1 \" a2 \" • • • \" a , . Show that the system has a simultaneous solution if and only if a; = a, (mod pa,) for i = 1, 2, . · · , r. 2. 3 The Chinese Remainder Theorem 73 •22. Let the m1 be as in the preceding problem. Show that the system (2.1) has a simultaneous solution if and only if a; = a1 (mod pa;) for all pairs of indices i, j for which 1 � i < j � r . *23. Let the mj be arbitrary positive integers in (2.1). Show that there is a simultaneous solution of this system if and only if a; = a1 (mod (m ; , m)) for all pairs of the indices i, j for which 1 � i <j � r. *24. Suppose that m�> m2, • • · , m, are pairwise relatively prime positive integers. For each j, let -G'(m1) denote a complete system of residues modulo m1. Show that the numbers c1 + c2m1 + c3m1m2 + · · · + c,m 1m2 · • • m,_ 1, c1 E -G'(m), form a complete system of residues modulo m = m1m2 • • • m,. 25. If m and k are positive integers, prove that the number of positive integers � mk that are prime to m is kcf>(m). 26. Show that cf>(nm) = ncf>(m) if every prime that divides n also divides m. 27. If P denotes the product of the primes common to m and n, prove that cf>(mn) = Pcf>(m)cf>(n)jcf>(P). Hence if (m, n) > 1, prove cf>(mn) > cf>(m)cf>(n). 28. If cf>(m) = cf>(mn) and n > 1, prove that n = 2 and m is odd. 29. Characterize the set of positive integers n satisfying cf>(2n) = cf>(n). 30. Characterize the set of positive integers satisfying cf>(2n) > cf>(n). 31. Prove that there are infinitely many integers n so that 3% cf>(n). 32. Find all solutions x of cf>( x) = 24. 33. Find the smallest positive integer n so that cf>( x) = n has no solution; exactly two solutions; exactly three solutions; exactly four solutions. (It has been conjectured that there is no integer n such that cf>( x) = n has exactly one solution, but this is an unsolved problem.) 34. Prove that there is no solution of the equation cf>( x) = 14 and that 14 is the least positive even integer with this property. Apart from 14, what is the next smallest positive even integer n such that cf>( x) = n has no solution? 35. If n has k distinct odd prime factors, prove that 2k lcf>(n). 36. What are the last two digits, that is, the tens and units digits, of 2 1000? of 3 1000? (H) *37. Let a 1 = 3, a;+ 1 = 3a;. Describe this sequence (mod 100). *38. Let ( a, b) = 1 and c > 0. Prove that there is an integer x such that (a + bx, c) = 1. 39. Prove that for a fixed integer n the equation cf>( x) = n has only a finite number of solutions. 74 Congruences 40. Prove that for n � 2 the sum of all positive integers less than n and prime to n is ncf>(n)j2. •41. Define f(n) as the sum of the positive integers less than n and prime to n. Prove that f(m) = f(n) implies that m = n. •42. Find all positive integers n such that cf>(n) ln. •43. If din and 0 < d < n, prove that n - cf>(n) > d - cf>(d). •44. Prove the following generalization of Euler's theorem: am = am -<f>(m) (mod m) for any integer a. •45. Find the number of solutions of x 2 = x (mod m) for any positive integer m. •46. Let 1/J(n) denote the number of integers a, 1 � a � n, for which both (a, n) = 1 and (a + 1, n) = 1. Show that 1/J(n) = n 0 (1 - 2/p). For pin what values of n is 1/J(n) = 0? •47. Let f(x) be a polynomial with integral coefficients, let N(m) denote the number of solutions of the congruence f(x) = 0 (mod m), and let cf>/m) denote the number of integers a, 1 �a � m, such that (f(a), m) = 1. Show that if (m, n) = 1 then cf>/mn) = cf>/m)cf>/n). Show that if a> 1 then cf>/ pa) = pa - tcf>/p). Show that cf>/ p) = p - N( p). Conclude that for any positive integer n, cf>/n) = n 0 (1 - N( p)jp). Show that for an appropriate choice of f(x), this pi n reduces to Theorem 2.19. 2.4 TECHNIQUES OF NUMERICAL CALCULATION When investigating properties of integers, it is often instructive to examine a few examples. The underlying patterns may be more evident if one extends the numerical data by the use of a programmable calculator or electronic computer. For example, after considering a long list of those odd primes p for which the congruence x 2 = 2 (mod p) has a solution, one might arrive at the conjecture that it is precisely those primes that are congruent to ± 1 modulo 8. (This is true, and forms an important part of quadratic reciprocity, proved in Section 3.2.) By extending the range of the calculation, one may provide further evidence in favor of a conjecture. Computers are also useful in constructing proofs. For example, one might formulate an argument to show that there is a particular number n0 such that if n > n0, then n is not divisible by all numbers less than {ii (recall Problem 50 in Section 1.3). Then by direct calculation one might show that this is also true if n lies in the interval 24 < n � n0, in order to conclude 2. 4 Techniques of Numerical Calculation 75 that 24 is the largest number divisible by all numbers less than its square root. In this example, it is not hard to show that one may take n0 = 210, and hence one might check the intermediate range by hand, but in other cases of this kind the n0 may be very large, making a computer essential. We assume that our calculators and computers perform integer arith­ metic accurately, as long as the integers involved have at most d digits. We refer to d as the word length. This assumption applies not only to addition, subtraction, and multiplication, but also to division, provided that the resulting quotient is also an integer. That is, if alb, the computer will accurately find b 1 a, with no round-off error. We also assume that our computer has a facility for determining the integral part [x] of a real number. Thus in the division algorithm, b = qa + r, the computer will accurately find q = [ b I a ]. Use of the fractional part (x} = x - [ x] should be avoided, since in general the decimal (or binary) expansion of (x} will not terminate, with the result that the computer will provide only an approximation to this function. In particular, as we indicated earlier, the remainder in the division algorithm should be calculated as r = b - a[b/a], not as r = a(b/a}. We have noted that the Euclidean algorithm does not require many steps. Indeed, when it is applied to very large numbers, the main con­ straint is the time involved in performing accurate multiple-precision arithmetic. The Euclidean algorithm provides a very efficient means of locating the solutions of linear congruences, and also of finding the root in the Chinese remainder theorem. Since the Euclidean algorithm has so many applications, it is worth spending some effort to optimize it. One way of improving the Euclidean algorithm is to form qi+ l by rounding to the nearest integer, rather than rounding down. The resulting r; is generally smaller, although it may be negative. This modified form of the Euclidean algorithm requires fewer iterations to determine (b, c), but the order of magnitude is still usually log c when b > c. Example 3 of Section 1.2 required 24 iterations, but with the modified algorithm only 15 would be needed. (Warning : The integral part function conveniently provided on most machines rounds toward 0. That is, when asked for the integer part of a decimal (or binary) number ±akak- t · · · a0.b 1b2 • • • b,, the ma­ chine will return ±akak-l · · · a0• This is [x] when xis non-negative, but it is -[ -x ] when x is negative. For example, [ -3.14159] = -4, but the machine will round toward 0, giving an answer - 3. To avoid this trap, ensure that a number is non-negative before asking a machine to give you the integer part. Alternatively, one could employ a conditional instruction, \"Put y = int (x). If y > x, then replace y by y - 1.\" This has the effect of setting y = [ x ].) In performing congruence arithmetic, we observe that if 0 \"' a < m and 0 \"' b < m then either a + b is already reduced or else m \"' a + b < 2. 4 Techniques of Numerical Calculation 77 When implemented, it would be a mistake to first list the binary digits of k, then form a list of the numbers dj, and finally multiply the appropriate dj together, as we have done above. Instead, one should perform these three tasks concurrently, as follows: 1. Set x = 1. (Here x is the product being formed.) 2. While k > 0, repeat the following steps: (a) Set e = k - 2[kj2]. (Thus e = 0 or 1, according as k is even or odd.) (b) If e = 1 then replace x by ax, and reduce this (mod m). (If e = 0 then x is not altered.) (c) Replace a by a2, and reduce this (mod m). (d) Replace k by (k - e)j2. (i.e., drop the unit digit in the binary expansion, and shift the remaining digits one place to the right.) When this is completed, we see that x = ak (mod m). Our ability to evaluate ak (mod m) quickly can be applied to provide an easy means of establishing that a given number is composite. Example 8 Show that 1763 is composite. Solution By Fermat's congruence, if p is an odd prime number then 2P- I = l(mod p). In other words, if n is an odd number for which 2n - I ¥; 1 (mod n), then n is composite. We calculate that 21762 = 742 (mod 1763), and deduce that 1763 is composite. Alternatively, we might search for a divisor of 1763, but the use we have made here of Fermat's congruence provides a quicker means of establishing composite­ ness when n is large, provided, of course that the test succeeds. Since the empirical evidence is that the test detects most composite numbers, if 2 n - 1 = 1 (mod n) then we call n a probable prime to the base 2. A composite probable prime is called a pseudoprime. That such numbers exist is seen in the following example. Example 9 Show that 1387 is composite. Solution We may calculate that 21386 = 1 (mod 1387). Thus 1387 is a probable prime to the base 2. To demonstrate that it is composite, we may try a different base, but a more efficient procedure is provided by applying Lemma 2. 10. We have a number x = 2693 with the property that x2 = 1 (mod 1387). Since 2693 = 512 ¥; ± 1 (mod 1387), we conclude that 1387 is composite. 78 Congruences When used systematically, this technique yields the strong pseudoprime test. If we wish to show that an odd number m is composite, we divide m - 1 by 2 repeatedly, in order to write m - 1 = 2jd, with d odd. We form ad (mod m), and by repeatedly squaring and reducing, we construct the numbers If the last number here is ¢. 1 (mod m), then m is composite. If this last member is = 1 (mod m), then m is a probable prime to the base a, but if the entry immediately preceding the first 1 is ¢. - 1 (mod m), then we may still conclude (by Lemma 2.10) that m is composite. When this test is inconclusive, we call m a strong probable prime. An odd, composite, strong probable prime is called a strong pseudoprime to the base a, abbreviated spsp (a). Such numbers exist, but numerical evidence suggests that they are much rarer than pseudoprimes. In our remarks following Problem 54 in Section 2.1, we noted the existence of numbers m, called Carmichael numbers, which are pseudoprime to every base a that is relatively prime to m. Such a phenomenon does not persist with strong pseudoprimes, as it can be shown that if m is odd and composite then m is a spsp (a) for at most mj4 values of a (mod m). For most m, the number of such a is much smaller. Expressed as an algorithm, the strong pseudoprime test for m takes the following shape: 1. Find j and d with dodd, so that m - 1 = 2jd. 2. Compute ad (mod m). If ad = ± 1 (mod m), then m is a strong probable prime; stop. 3. Square ad to compute a2d (mod m). If a2d = 1 (mod m), then m is composite; stop. If a2d = -1, then m is a strong probable prime; stop. 4. Repeat step 3 with a2d replaced by a4d, a8d, · · ·, a2i-'d. 5. If the procedure has not already terminated, then m is composite. Let X= 25 · 109• Integers in the interval [1, X] have been examined in detail, and it has been found that the number of prime numbers in this interval is 'IT( X) = 1,091,987,405, that the number of odd pseudoprimes in this interval is 21,853, and that the number of Carmichael numbers in this interval is 2163. On the other hand, in this interval there are 4842 numbers of the class spsp (2), 184 that are both spsp (2) and spsp (3), 13 that are spsp (a) for a = 2, 3, 5, only 1 that is spsp (a) for a = 2, 3, 5, 7, and none that is spsp (a) for a= 2, 3, 5, 7, 11. The strong pseudoprime test provides a very efficient means for proving that an odd integer m is composite. With further information one 2. 4 Techniques of Numerical Calculation 79 can sometimes use it to demonstrate that a number is prime. If m is a strong probable prime base 2, and if m < 2047, then m is prime. Here 2047 is the least spsp (2). If m is larger, apply the test to the base 3. If m is again found to be a strong probable prime, then m is prime provided that m < 1,373,653. This latter number is the least integer that is both spsp (2) and spsp (3). If m is larger, then apply the test to the base 5. If m is yet again found to be a strong probable prime, then m is prime provided that m < 25,326,001. This is the least number that is simultaneously spsp (a) for a = 2, 3, and 5. If m is still larger, then apply the test to the base 7. If m is once more found to be a probable prime, then m is prime provided that m <X= 25 · 109 and that m ¢. 3,215,031,751. This last number is the only number <X that is spsp (a) for a = 2, 3, 5, and 7. It is not known in general how many applications of the strong test suffice to ensure that a number m is prime. but it is conjectured that if m is a strong probable prime for all bases a in the range 1 < a \" 2 (log m)2 then m is prime. Suppose that m is a large composite number. By the strong pseudo­ prime test we may establish that m is composite without exhibiting a proper divisor of m. In general, finding the factorization of m involves much more calculation. If p denotes the least prime factor of m, then we locate the p�er divisor p after p trial divisions. Since p may be nearly as large as vm , this may require up to Vm operations. We now describe a method which usually locates the smallest prime factor p in just a little more than {P steps. As in many such factoring algorithms, our estimate for the running time is not proved, but is instead based on heuristics, probabilistic models, and experience. For our present purposes, the rele­ vant probabilistic result is expressed in the following lemma. Lemma 2.21 Suppose that 1 \"k \"n, and that the numbers u 1, u2,- • ·, uk are independently chosen from the set {1, 2, · · ·, n}. Then the probability that the numbers u k are distinct is Proof Consider a sequence u 1, • • ·, uk in which each u; is one of the numbers 1, 2, · · · , n. Since each u; is one of n numbers, there are nk such sequences. From among these, we count those for which the u; are distinct. We see that u1 can be any one of n numbers. If u2 is to be distinct from u 1, then u2 is one of n - 1 numbers. If u3 is to be distinct from both u 1 and u2, then u3 is one of n - 2 numbers, and so on. Hence the total number of such sequences is n(n - 1) · · · (n - k + 1). We divide this by nk to obtain the stated probability. 80 Congruences As an application, we note that if n = 365 and k = 23, then the probability in question is less than 1 ;2. That is, if 23 people are chosen at random, then the probability of two of them having the same birthday is greater than 1/2. It may seem counterintuitive that such a small number of people suffices, but it can be shown that the product is approximately exp (- e j(2n)). (A derivation of a precise estimate of this sort is outlined in Problem 22 at the end of this section.) Hence the u; are likely to be distinct if k is small compared with .;n , but unlikely to be distinct if k is large compared with .;n. Suppose that m is a large composite number whose smallest prime divisor is p. If we choose k integers u 1, u 2, · · ·, uk \"at random,\" with k large compared to {ii but small compared to ..;m, then it is likely that the u; will be distinct (mod m), but not distinct (mod p). That is, there probably are integers i, j, with 1 \"i < j \"k such that 1 < (u; - uj, m) < m. Each pair (i, j) is easily tested by the Euclidean algorithm, but the task of inspecting all ( �) pairs is painfully long. To shorten our work, we adopt the following scheme: We generate the u; by a recursion of the form ui+ t = f(u) where f(u) is a polynomial with integral coefficients. The precise choice of f(u) is unimportant, except that it should be easy to compute, and it should give rise to a sequence of numbers that \"looks random.\" Here some experimentation is called for, but it has been found that f(u) = u 2 + 1 works well. (In general, polynomials of first degree do not.) The advantage of generating the u; in this way is that if u; = u/mod d), then ui + t =f(u) =f(u) = uj + 1 (mod d), so the sequence u; becomes periodic (mod d) with period j- i. In other words, if we put r = j- i, then us = u, (mod d) whenever s = t(mod r), s � i, and t � i. In particular, if we let s be the least multiple of r that is � i, and we take t = 2s, then us = u 2.(mod d). That is, among the numbers u 2s - us we expect to find one for which 1 < (u 2s - us, m ) < m, with s of size roughly comparable to {ii . Example 10 Use this method to locate a proper divisor of the number m = 36,287. Solution We take u0 = 1, ui+ t = uf + l(mod m ), 0 \"u;+ t < m. Then the numbers u;, i = 1, 2, ... , 14 are 2, 5, 26, 677, 22886, 2439, 33941, 24380, 3341, 22173, 25652, 26685, 29425, 22806. We find that (u 2s - us, m ) = 1 for s = 1, 2, · · · , 6, but that (u 14 - u7, m ) � 131. That is, 131 is a divisor of m. In this example, it turns out that 131 is the smallest prime divisor of m, because the division of 36,287 by 131 gives the other prime factor, 277. 2. 4 Techniques of Numerical Calculation 81 If we reduce the u; (mod 131), we obtain the numbers 2, 5, 26, 22, 92, 81, 12, 14, 66, 34, 109, 92, 81, 12. Hence u 12 = U s (mod 131), and the se­ quence has period 7 from U s on. We might diagram this as follows: 81 � 12 � / 14 92 ) I' 66 22 109\"\"11E'-- 34 � 1 26 t 5 ·1 2 This method was proposed by J. M. Pollard in 1975. Since the pattern above resembles the Greek letter p (\"rho\"), this approach is known as the Pollard rho method. It should be applied only to numbers m that are already known to be composite (e.g., by the strong pseudoprime test), for if m is prime then the method will run for roughly .;m cycles, without proving anything. Since the method may be expected to disclose the smallest prime factor p of m in roughly ..fii cycles, this method is faster than trial division for large composite m. Note that there is no guarantee that the divisor found will be the smallest prime factor of m. The divisor located may be some other prime factor, it may be composite, and it may even be m itself. In the latter eventuality, one may start over with a new value of u0, or with a new function f(u), say f(u) = u 2 + c with some new value for c. (The two values c = 0, c = - 2 should be avoided.) As of this writing, the most efficient factoring strategies are expected to locate a proper divisor of a composite number m in no more than exp (c(log m)112(log log m)112) bit operations. (Here c is some positive constant.) In Section 5.8 we use elliptic curves to find proper divisors this quickly. If e is a given positive number, then the function of m above is < me for all sufficiently large m. Nevertheless, it remains the case that we can perform congruence arithmetic, compositeness tests, and so forth for much larger m than we can factor. 2. 4 Techniques of Numerical Calculation 83 13. Let f(u) be a given function. Suppose that a sequence u; of real numbers is generated iteratively by putting u; + 1 = f(u). Suppose also that u1, u2, • ·, u17 are distinct, but that u 18 = u 11• What is the least value of s such that U zs =us? 14. Use the Pollard rho method to locate proper divisors of the following numbers: (a) 8,131; (b) 7,913; (c) 7,807; (d) 16,019; (e) 10,277; (f) 199,934,971. 15. Show that if (a, m) = 1 and m has a prime factor p such that (p - l) I Q, then (aQ- 1, m) > 1. 16. The Pollardp - 1 method. Let dn = (2n! _ 1, m). Explain why dn ldn + l for n = 1, 2, · · · . Show that dn > 1 if m has a prime factor p such that (p - Oln !. Apply this approach to find a proper divisor of 403. What is the least n that yields a factor? What is the least n for which dn = 403? *17. Find a proper divisor of m = 387058387 by evaluating d100, in the notation of the preceding problem. *18. Apply the Pollard p - 1 method to the number 1891. Explain what difficulties are encountered and how they might be overcome. *19. Let k be a positive integer such that 2k- I = 1 (mod k), and put m = 2k - 1. Observe that d = (m - 0/2 is odd. Show that 2d = 1 (mod m). Show also that if k is composite then m is composite. Deduce that if k is a pseudoprime base 2 then m is a spsp (2). Conclude that there exist infinitely many numbers of the class spsp (2). *20. Let k be a positive integer such that 6k + 1 = p1, 12k + 1 = p2, and 18k + 1 = p3 are all prime numbers, and put m = p 1 p2 p3• Show that (p; - l) l(m - 1) for i = 1, 2, 3. Deduce that if (a, p) = 1 then am - I = 1 (mod p), i = 1, 2, 3. Conclude that if (a, m) = 1 then am - I = 1 (mod m), that is, that m is a Carmichael number. (It is conjectured that there are infinitely many k for which the numbers P; are all prime; the first three are k = 1, 6, 35.) *21. Let X be a large positive integer. Suppose that m � Xj2, and that 0 �a < m, 0 � b < m. Explain why the number c determined by the following algorithm satisfies 0 � c < m, and c = ab (mod m). Verify that in executing the algorithm, all numbers encountered lie in the interval [0, X). 1. Set k = b, c = 0, g = [Xjm ]. 2. As long as a > 0, perform the following operations: (a) Set r = a - g[ajg]. (b) Choose s so that s = kr (mod m) and 0 � s < m. 84 (c) Replace c by c + s. (d) If c � m, replace c by c - m. (e) Replace k by gk - m[ gkjm ]. (f) Replace a by (a - r)jg. *22. Show that the product in Lemma 2.21 is smaller than Congruences exp ( - � + }:__ ) . but larger than exp ( - � - k3 ) . (H) 2n 2n 2n 3n2 2.5 PUBLIC-KEY CRYPTOGRAPHY We now apply our knowledge of congruence arithmetic to construct a method of encrypting messages. The mathematical principle we use is formulated in the following lemma. Lemma 2.22 Suppose that m is a positive integer and that (a, m) = 1. If k and k are positive integers such that kk = 1 (mod <f>(m)), then akTc = a(mod m). Proof Write kk = 1 + r<f>(m), where r is a non-negative integer. Then by Euler's congruence akk = a · a\"f><m> = a( a<t><m>) ' = a · 1' = a (mod m) . If (a, m) = 1 and k is a positive integer, then (ak, m) = 1. Thus if n = <f>(m) and r1, r2, • • · , rn is a system of reduced residues (mod m), then the numbers rf, r�, · · · , r: are also reduced residues. These k th powers may not all be distinct (mod m), as we see by considering the special case k = <f>(m). On the other hand, from Lemma 2.22 we can deduce that these kth powers are distinct (mod m) provided that (k, <f>(m)) = 1. For, sup­ pose that r;k = rf (mod m) a�d (k, <f>(m)) : 1. By Theorem 2.9 we may determine a positive integer k such that kk = 1 (mod <f>(m)), and then it follows from the lemma that This implies that i = j. (From our further analysis in Section 2.8 it will become apparent that the converse also holds: the numbers rf, r�, · · · , r: are distinct (mod m) only if (k, <f>(m)) = 1.) Suppose that (k, <f>(m)) = 1. Since the numbers rf, r�, · · · , r: are distinct (mod m), they form a system of reduced residues (mod m). That is, the map a �--+ ak permutes the 2.5 Public-Key Cryptography 85 reduced residues (mod m) if (k, tf>(m)) = 1. The significance of the lemma is that the further map b >-+ b\" is the inverse permutation. To apply these observations to cryptography, we take two distinct large primes, p 1, p2, say each one with about 100 digits, and multiply them to form a composite modulus m = p1 p2 of about 200 digits. Since we know the prime factorization of m, from Theorem 2. 19 we see that tf>(m) = ( p1 - 1Xp2 - 1). Here tf>(m) is somewhat smaller than m. We choose a big number, k, from the interval 0 < k < tf>(m), and check by the Euclidean algorithm that (k, tf>(m)) = 1. If a proposed k does not have this property, we try another, until we obtain one for which this holds. We make the numbers m and k publicly available, but keep p1, p2, and tf>(m) secret. Suppose now that some associate of ours wants to send us a message, say \"Gauss was a genius!\" The associate first converts the characters of the message to numbers in some standard way, say by employing the three digit American Standard Code for Information Inter­ change (ASCII) used on many computers. Then \"G\" becomes 071, \"a\" becomes 097, · · ·, and \"!\" becomes 033. Concatenate these codes to form a number a = 0710971 171151 15 1261 190971151260971261031011 101051 171 15033 . Since a has only 56 digits, we see that 0 < a < m. If the message were longer, it could be divided into a number of blocks. Our associate could send us the number a, and then we could reconstruct the original characters, but suppose that the message contains some sensitive material that would make it desirable to ensure the privacy of the transmission. In that case, our associate would use the numbers k and m that we have provided. Being acquainted with the ideas discussed in the preceding section, our associate quickly finds the unique number b, 0 � b < m, such that b = ak (mod m), and sends this b to us. We use the Euclidean algorithm to find a positive number k such that kk = 1 (mod tf>(m)), and then we find the unique number c such that 0 � c < m, c = blc (mod m). From Lemma 2.22 we deduce that a = c. In theory it might happen that (a, m) > 1, in which case the lemma does not apply, but the chances of this are remote ( :::::: 1/P; :::::: 10 - HJO). On this unlikely event, one could still appeal to Problem 4 at the end of this section.) Suppose that some inquisitive third party gains access to the numbers m, k, and b, and seeks to recover the number a. In principle, all that need be done is to factor m, which yields tf>(m), and hence k, just as we have done. In practice, however, the task of locating the factors of m is prohibitively long. Using the best algorithms known and fastest computers, it would take centuries to factor our 200 digit modulus m. Of course, we hope that faster factoring algorithms may yet be discovered, but here one can only speculate. 86 Congruences PROBLEMS 1. Suppose that b = a67 (mod 91), and that (a, 91) = 1. Find a positive number k such that b\"k = a (mod 91). If b = 53, what is a (mod 91)? 2. Suppose that m = pq, and 4> = (p - 1Xq - 1) where p and q are real numbers. Find a formula for p and q, in terms of m and t/>. Supposing that m = 39,247,771 is the product of two distinct primes, deduce the factors of m from the information that tf>(m) = 39,233,944. 3. Show that if dim, then tf>(d) l t/>(m). *4. Suppose that m is square-free, and that k and k are positive integers such that kk = 1 (mod tf>(m)). Show that ak\"k = a (mod m) for all inte­ gers a. (H) *5. Suppose that m is a positive integer that is not square-free. Show that there exist integers a 1 and a2 such that a 1 ¢. a2 (mod m), but a} = a� (mod m) for all integers k > 1. 2.6 PRIME POWER MODULI The problem of solving a congruence was reduced in Section 2.3 to the case of a prime-power modulus. To solve a polynomial congruence f(x) = 0 (mod pk), we start with a solution modulo p, then move on to modulo p2, then to p3, and by iteration to pk. Suppose that x =a is a solution of f(x) = 0 (mod pj) and we want to use it to get a solution modulo pj + 1• The idea is to try to get a solution x = a + tpj, where t is to be determined, by use of Taylor's expansion f( a + tpj) = f( a) + tpjf'(a) + t2p2jf\"( a)j2 ! + · · · +tnpnjf(n>(a)jn! (2.3) where n is the presumed degree of the polynomial f(x). All derivatives beyond the nth are identically zero. Now with respect to the modulus pj+ 1, equation (2.3) gives (2.4) as the following argument shows. What we want to establish is that the coefficients of t2,t3, · · · tn in equation (2.3) are divisible by pj+ I and so can be omitted in (2.4). This is almost obvious because the powers of p in those terms are p2j, p3j, · · · , pnj. But this is not quite immediate because of the denominators 2!, 3!, - · ·, n! in these terms. The explanation is that 2. 6 Prime Power Moduli 87 t<k>(a)jk! is an integer for each value of k, 2 � k � n. To see this, let ex ' be a representative term from f(x). The corresponding term in j<k>(a) is cr(r - l)(r - 2) · · · (r - k + l)a'-k. According to Theorem 1.21, the product of k consecutive integers is divisible by k!, and the argument is complete. Thus, we have proved that the coefficients of t 2, t 3, · · · in (2.3) are divisible by pj + 1. The congruence (2.4) reveals how t should be chosen if x = a + tp1 is to be a solution of f(x) = 0 (mod pj + 1 ). We want t to be a solution of f( a) + tpjf'( a) = 0 (mod pj+ 1 ) . Since j(x) = O(mod pj) is presumed to have the solution x = a, we see that pj can be removed as a factor to give f( a) if'( a) = --. (mod p) pl (2.5) which is a linear congruence in t. This congruence may have no solution, one solution, or p solutions. If f'( a) ;f; 0 (mod p ), then this congruence has exactly one solution, and we obtain Theorem 2.23 Hensel's lemma. Suppose that f(x) is a polynomial with integral coefficients. If f(a) = O (mod pj) and f'(a) ;f; O(mod p), then there is a unique t (mod p) such that j(a + tpj) = 0 (mod pj + 1 ). If f(a) = 0 (mod pj), j(b) = 0 (mod pk), j < k, and a = b (mod pj), then we say that b lies above a, or a lifts to b. If f(a) = 0 (mod pj), then the root a is called nonsingular if f'(a) ;f; O(mod p); otherwise it is singular. By Hensel's lemma we see that a nonsingular root a (mod p) lifts to a unique root a2 (mod p2). Since a2 =a (mod p), it follows (by Theo­ rem 2.2) that f'(a 2) = f'(a) ;f; O(mod p). By a second application of Hensel's lemma we may lift a 2 to form a root a3 of f(x) modulo p3, and so on. In general we find that a nonsingular root a modulo p lifts to a unique root aj modulo pj for j = 2, 3, · · · . By (2.5) we see that this sequence is generated by means of the recursion (2.6) where f'( a) is an integer chosen so that f'(a)f'( a) = l(mod p). This is 88 Congruences entirely analogous to Newton's method for locating the root of a differen­ tiable function. Example 11 Solve x2 + x + 47 = 0 (mod 73). Solution First we note that x = 1 (mod 7) and x = 5 (mod 7) are the only solutions of x2 + x + 47 (mod 7). Since f'( x) = 2 x + 1, we see that f'(l) = 3 ¢. O(mod 7) and f'(5) = 1 1 ¢. O (mod 7), so these roots are non­ singular. Taking f'( 1) = 5, we see by (2.6) that the root a = 1 (mod 7) lifts to a 2 = 1 - 49 · 5. Since a2 is considered (mod 72 ), we may take instead a 2 = 1. Then a 3 = 1 - 49 · 5 = 99 (mod 73). Similarly, we take f'(5) = 2, and see by (2.6) that the root 5 (mod 7) lifts to 5 - 77 · 2 = -149 = 47 (mod 72 ), and that 47 (mod 72 ) lifts to 47 - /(47) · 2 = 47 - 2303 · 2 = -4559 = 243 (mod 73). Thus we conclude that 99 and 243 are the desired roots, and that there are no others. We now tum to the more difficult problem of lifting singular roots. Suppose that f(a) = O(mod pi) and that f'(a) = O (mod p). From the Taylor expansion (2.3) we see that f(a + tp l) = f(a) (mod pi+ 1 ) for all integers t. Thus if f(a) = O(mod pi+ I ) then f(a + tpi) = O(mod pi+ I ), so that the single root a (mod pj) lifts to p roots (mod pj + 1 ). But if f(a) ¢. 0 (mod pi+ 1), then none of the p residue classes a + tpi is a solution (mod pi+ 1 ), and then there are no roots (mod p1 + 1) lying above a(mod pi). Example 12 Solve x 2 + x + 7 (mod 81). Solution Starting with x 2 + x + 7 (mod 3), we note that x = 1 is the only solution. Here f'(l) = 3 = 0 (mod 3), and f(l) = 0 (mod 9), so that we have the roots x = 1, x = 4, and x = 7 (mod 9). Now f(l) ¢. 0 (mod 27), and hence there is no root x (mod 27) for which x = 1 (mod 9). As f(4) = 0 (mod 27), we obtain three roots, 4, 13, and 22 (mod 27), which are :!!!! 4 (mod 9). On the other hand, f(7) ¢. 0 (mod 27), so there is no root (mod 27) that is = 7 (mod 9). We are now in a position to determine which, if any, of the roots 4, 13, 22 (mod 27) can be lifted to roots (mod 81). We find that f(4) = 27 ¢. 0 (mod 81), f{13) = 189 = 27 ¢. 0 (mod 81), and that f(22) = 5 13 = 27 ¢. O (mod 81), from which we deduce that the con­ gruence has no solution (mod 81). In this example, we see that a singular solution a (mod p) may lift to some higher powers of p, but not necessarily to arbitrarily high powers of p. We now show that if the power of p dividing f( a) is sufficiently large compared with the power of p in f'(a), then the solution can be lifted without limit. 2. 6 Prime Power Moduli 89 Theorem 2.24 Let f(x) be a polynomial with integral coefficients. Suppose that f(a) = 0 (mod p'), that pTIIf'(a), and that j ;;;?; 2T + 1. If b = a (mod pj-T) then f(b) = f(a) (mod p') and pTIIf'(b). Moreover, there is a unique t(mod p) such that f(a + tpi-T) = O(mod pj+ 1 ). In this situation, a collection of pT solutions (mod pi) give rise to pT solutions (mod pi+ 1 ), while the power of p dividing f' remains constant. Since the hypotheses of the theorem apply with a replaced by a + tpi-T and (mod p') replaced by (mod pi + I ) but with T unchanged, the lifting may be repeated and continues indefinitely. Proof By Taylor's expansion (2.3), we see that Here the modulus is divisible by pi+ 1 , since 2j - 2T = j + (j - 2T) ;;;?; j + 1. Hence Since both terms on the right side are divisible by pi, the left side is also. Moreover, on dividing through by pi we find that f(a + tpj-T) f( a) f'( a) ___..:.._-�. -- = --. + t -- (mod p ) , p' p' PT and the coefficient of t is relatively prime to p, so that there is a unique t (mod p) for which the right side is divisible by p. This establishes the final assertion of the theorem. To complete the proof, we note that f'(x) is a polynomial with integral coefficients, so that for any integer t. But j- T ;;;?; T + 1, so this congruence holds (mod pT+ 1). Since pT exactly divides f'(a) (in symbols, pT IIf'(a)), we conclude that PTIIf'(a + tpi-T). Example 13 Discuss the solutions of x2 + x + 223 = 0 (mod 3i). Solution Since 223 = 7 (mod 27), the solutions (mod 27) are the same as in Example 12. For this new polynomial, we find that f(4) = O (mod81), and thus we have three solutions 4, 31, 58 (mod 81). Similarly f(13) = 0 (mod 81), giving three solutions 13, 40, 67 (mod 81). Moreover, f(22) = 90 Table 1 Solutions of x 2 + x + 223 = O(mod 3j). 13 40 67 � 13 1 1 Congruences VfVfVf 729 243 \\V\\V \\V 22 49 76 81 � 27 22 9 3 0 (mod 81), yielding the solutions 22, 49, 76 (mod 81). Thus we find that the congruence has exactly nine solutions (mod 81). In fact we note that f(4) = O(mod 35), 32 ll f(4), so by Theorem 2.20 the solution 4(mod 243) is one of nine solutions of the form 4 + 27t (mod 243). We may further verify that there is precisely one value of t (mod 3), namely t = 2, for which f(4 + 27t) = 0 (mod 36). This gives nine solutions of the form 58 + 81t (mod 36 ). Similarly, f(22) = O(mod 35), 3 2 llf(22), so that 22 (mod 243) is one of nine solutions of the form 22 + 27t (mod 243). Moreover, we can verify that there is precisely one value of t (mod 3), namely t = 0, for which 22 + 27t is a solution (mod 36 ). That is, we have nine solutions (mod 36 ) of the form 22 + 81t. On the other hand, ['(13) = 0 (mod 27), so that f(l3 + 27t) = f{13) (mod 36 ). As 34 11[(13), we find that none of the three solutions 13 + 27t (mod 81) lifts to a solution (mod 243). In conclu­ sion, we have found that for each j � 5 there are precisely 18 solutions (mod 3j), of which 12 do not lift to 3j + 1 , while each of the remaining six lifts to three solutions (mod 3j + 1 ). These results are depicted in Table 1. Suppose that f(a) = O(mod p), and that f'(a) = O(mod p). We wish to know whether a can be lifted to solutions modulo arbitrarily high powers of p. The situation is resolved if we can reach a point at which Theorem 2.24 applies, that is, j � 2 T + 1. However, there is nothing in our discussion thus far to preclude the possibility that the power of p in f' might steadily increase with that in f, so that Theorem 2.24 might never take effect. In Appendix A.2 we define the discriminant D(f) of the polynomial, and show that the critical inequality j � 2T + 1 holds when­ ever j is larger than the power of p in D(f). 2. 7 Prime Modulus 91 PROBLEMS 1. Solve the congruence x 2 + x + 7 = 0 (mod 27) by using the method of completing the square from elementary algebra, thus 4x 2 + 4x + 28 = (2x + 1)2 + 27. Solve this congruence (mod 81) by the same method. 2. Solve x5 + x4 + 1 = 0 (mod 34 ). 3. Solve x 3 + x + 57 = O(mod 53). 4. Solve x2 + Sx + 24 = 0 (mod 36). 5. Solve x3 + 10x 2 +x + 3 = O (mod 3 3). 6. Solve x 3 + x 2 - 4 = 0 (mod 7 3). 7. Solve x3 + x 2 - 5 = O(mod 73). 8. Apply the theory of this section to solve 1000x = 1 (mod 1013), using a calculator. 9. Suppose that f(a) = O(mod p') and that f'(a) t= O (mod p). Let rraJ be an integer chosen so that f'(a)J'[(.i) = 1 (mod p 2j), and put b =a - f(a)J'[(.i). Show that f(b) = O(mod p 2j). 10. Let p be an odd prime, and suppose that a t= 0 (mod p). Show that if the congruence x 2 = a (mod pj) has a solution when j = 1, then it has a solution for all j. *11. Let f(x) be a polynomial with integral coefficients in the n vari­ ables xI > x 2 , . • · , x\"\" Suppose that f(a) = 0 (mod p) where a = a (a 1, a2 , · · · , an ), and that -f(a) t= O(mod p) for at least one i. OX; . Show that the congruence f(x) = 0 (mod p') has a solution for every j. 2. 7 PRIME MODULUS We have now reduced the problem of solving f(x) = O(mod m ) to its last stage, congruences with prime moduli. Although we have no general method for solving such congruences, there are some interesting facts concerning the solutions. A natural question about polynomial congru­ ences of the type f(x) = 0 (mod m) is whether there is any analogue to the well-known theorem in algebra that a polynomial equation of degree n whose coefficients are complex numbers has exactly n roots or solutions, allowing for multiple roots. For congruences the situation is more compli­ cated. In the first place, for any modulus m > 1, there are polynomial congruences having no solutions. An example of this is given by xP - x + 1 = 0 (mod m), where p is any prime factor of m. This congruence has no solutions because xP - x + 1 = O(mod p) has none, by Fermat's theorem. 92 Congruences Moreover, we have already seen that a congruence can have more solutions than its degree, for example, x2 - 7x + 2 = 0 (mod 10) with four solutions x = 3, 4, 8, 9, and also x2 + x + 7 = 0 (mod 27) with three solu­ tions x = 4, 13, 22. But if the modulus is a prime, a congruence cannot have more solutions than its degree. This is proved in Theorem 2.26 later in the section. It is important here to note carefully the meaning of \"degree of congruence,\" given in Definition 2.5 in Section 2.2. Such a polynomial as 5x3 + x2 - x has degree 3, but the congruence 5x3 + x2 - x = 0 (mod 5) has degree 2. Consider the congruence 5x2 + lOx + 15 = 0 (mod 5), having five so­ lutions x = 0, 1, 2, 3, and 4. At first glance, this might appear to be a counterexample to Theorem 2.26. However, by Definition 2.5, this congru­ ence is assigned no degree, so that Theorem 2.26 does not apply. With this background, we proceed to prove some fundamental results. As before, we write f(x) = an x\" + an _ 1x\" - 1 + · · · + a0, and we assume that pis a prime not dividing an , so that the congruence f(x) = O(mod p) has degree n. In Theorem 2.25, we divide such a polynomial f(x) of degree n ;;;?:- p by xP - x to get a quotient and a remainder, both polyno­ mials. This is a limited use of the division algorithm for polynomials, which is discussed more fully in Theorem 9.1 . By \"limited use,\" we mean that the only idea involved is the division of one polynomial into another, as in elementary algebra. The uniqueness of the quotient and the remainder are not needed. Theorem 2.25 If the degree n of f(x) = 0 (mod p) is greater than or equal to p, then either every integer is a solution off( x) = 0 (mod p) or there is a polynomial g(x) having integral coefficients, with leading coefficient l, such that g(x) = 0 (mod p) is of degree less than p and the solutions of g(x) = O (mod p) are precisely those off(x) = O(mod p). Proof Dividing f(x) by xP - x, we get a quotient q(x) and a remainder r(x) such that f(x) = (xP - x)q(x) + r(x). Here q(x) and r(x) are polynomials with integral coefficients, and r(x) is either zero or a polyno­ mial of degree less than p. Since every integer is a solution of xP = x (mod p) by Fermat's theorem, we see that the solutions of f(x) = O(mod p) are the same as those of r(x) = O(mod p). If r(x) = 0 or if every coefficient of r(x) is divisible by p, then every integer is a solution of f(x) = O(mod p). On the other hand, if at least one coefficient of r(x) is not divisible by p, then the congruence r(x) = O(mod p) has a degree, and that degree is less than p. The polynomial g(x) in the theorem can be obtained from r(x) by getting leading coefficient 1, as follows. We may discard all terms 2. 7 Prime Modulus 93 in r( x) whose coefficients are divisible by p, since the congruence proper­ ties modulo p are unaltered. Then let bxm be the term of highest degree in r(x), with (b, p) = 1. Choose b so that bb = l(mod p), and note that (b, p) = 1 also. Then the congruence br( x) = 0 (mod p) has the same solutions as r( x) = 0 (mod p ), and so has the same solutions as f( x) = 0 (mod p ). Define g( x) to be br( x) with its leading coefficient bb replaced by 1, that is, g( x) = br( x) - ( bb - l ) x m . Theorem 2.26 The congruence f( x) = 0 (mod p) of degree n has at most n solutions. Proof The proof is by induction on the degree of f( x) = O(mod p). If n = 0, the polynomial f( x) is just a0 with a0 ¥= O(mod p), and hence the congruence has no solution. If n = 1, the congruence has exactly one solution by Theorem 2.17. Assuming the truth of the theorem for all congruences of degree < n, suppose that there are more than n solutions of the congruence f( x) = O(mod p) of degree n. Let the leading term of f( x) be a n x n and let up u 2 , . · ·, u n , un +I be solutions of the congruence, with u; ¥= u/mod p) for i * j. We define g( x) by the equation g( x) = f( x) - an( x - u 1 )( x - u 2) · • • ( x - u n ) , noting the cancellation of an x n on the right. Note that g( x) = O(mod p) has at least n solutions, namely Up u 2 , . · ·, u n . We consider two cases, first where every coefficient of g( x) is divisible by p, and second where at least one coefficient is not divisible by p. (The first case includes the situation where g( x) is identically zero.) We show that both cases lead to a contradiction. In the first case, every integer is a solution of g( x) = O(mod p), and since f( un +I ) = O(mod p) by assumption, it follows that x = u n + 1 is a solution of an( x - u 1 )( x - u 2) · • • ( x - un ) = O (mod p) . This contradicts Theorem 1.15. In the second case, we note that the congruence g( x) = 0 (mod p) has a degree, and that degree is less than n. By the induction hypothesis, this congruence has fewer than n solutions. This contradicts the earlier obser­ vation that this congruence has at least n solutions. Thus the proof is complete. We have already noted, using the example 5x 2 + lOx + 15 = 0 (mod 5), that the conclusion of Theorem 2.26 need not hold if the 94 Congruences assumption is just that the polynomial f(x) has degree n. The following corollary describes the situation. Corollary 2.27 If bnx\" + bn _ 1 x\" - I + · · · + b0 s 0 (mod p) has more than n solutions, then all the coefficients bj are divisible by p. The reason for this is that if some coefficient is not divisible by p, then the polynomial congruence has a degree, and that degree is at most n. Theorem 2.26 implies that the congruence has at most n solutions, and this is a contradiction. Theorem 2.28 If F(x) is a function that maps residue classes (mod p) to residue classes (mod p), then there is a polynomial f(x) with integral coeffi­ cients and degree at most p- 1 such that F(x) = f(x) (mod p) for all residue classes x (mod p ). Proof By Fermat's congruence we see that 1 _ ( x _ a) P _ 1 = { 1 (mod p) O {mod p ) p if x = a (mod p) , otherwise . Hence the polynomial f(x) = E F(iX1 - (x - i)P- 1 ) has the desired properties. Theorem 2.29 The congruence f(x) = 0 (mod p) of degree n, with leading coefficient an = 1, has n solutions if and only if f(x) is a factor of xP - x modulo p, that is, if and only ifxP - x = f(x)q(x) + ps(x), where q(x) and s(x) have integral coefficients, q(x) has degree p - n and leading coefficient 1, and where either s(x) is a polynomial of degree less than n or s(x) is zero. Proof First assume that f(x) = O(mod p) has n solutions. Then n � p, by Definition 2.4 of Section 2.2. Dividing xP - x by f(x), we get a quotient q(x) and a remainder r(x) satisfying xP - x = f(x)q(x) + r(x), where r(x) is either identically zero or a polynomial of degree less than n. This equation implies, by application of Fermat's theorem to xP - x, that every solution of f(x) = 0 (mod p) is a solution of r(x) = 0 (mod p ). Thus, r(x) = O(mod p) has at least n solutions, and by Corollary 2.27, it follows that every coefficient in r(x) is divisible by p, so r(x) = ps(x) as in the theorem. Conversely, assume that xP - x = f(x)q(x) + ps(x), as in the state­ ment of the theorem. By Fermat's theorem, the congruence f(x)q(x) = 2. 7 Prime Modulus 95 0 (mod p) has p solutions. This congruence has leading term x P. The leading term of f(x) is xn by hypothesis, and hence the leading term of q(x) is xp-n. By Theorem 2.26, the congruences f(x) = O(mod p) and q(x) = 0 (mod p) have at most n solutions and p - n solutions, respec­ tively. But every one of the p solutions of f(x)q(x) = O(mod p) is a solution of at least one of the congruences f(x) = 0 (mod p) and q(x) = 0 (mod p ). It follows that these two congruences have exactly n solutions and p - n solutions, respectively. The restriction an = 1 in this theorem is needed so that we may divide xP - x by f(x) and obtain a polynomial q(x) with integral coefficients. However, it is not much of a restriction. We can always find an integer an such that anan = 1 (mod p). Put g(x) = anf(x) - (anan - l)xn. Then g(x) = O(mod p) has the same solutions as f(x) = O(mod p), and g(x) has leading coefficient 1. As an example, we see that x5 - 5x3 + 4x = 0 (mod 5) has five solu­ tions, and x5 - x = (x5 - 5x3 + 4x) + (5x3 - 5x). As a second example, we cite x3 - x = 0 (mod 5) with three solutions, and x5 - x = (x3 - x) (x2 + 1). Theorem 2.29 has many important applications. We now con­ sider one that will be crucial to our discussion of primitive roots in Section 2.8. Corollary 2.30 If dl(p - 1), then xd = 1 (mod p) has d solutions. Proof Choose e so that de = p- 1. Since (y - 1X1 + y + · · · + ye - 1 ) = y e - 1, on taking y = xd we see that x(xd - 1X1 + xd + · · · + xd<e- 1>) = xP _ x. A further application of Theorem 2.29 arises by considering the polynomial f( x ) = ( x- 1)( x- 2) . . · ( x- p + 1). For convenience we assume that p > 2. On expanding, we find that where Oj· is the sum of all products of j distinct members of the set {1, 2, · · ·, p - 1}. In the two extreme cases we have u1 = 1 + 2 + · · · + (p - 1) = p(p - 0/2, and uP_ 1 = 1 · 2 · · · · · (p - 1) = (p- 1)! . The polynomial f(x) has degree p - 1 and has the p - 1 roots 1, 2, - · · , P - 1 (mod p). Consequently the polynomial xf(x) has degree p and has p roots. By applying Theorem 2.29 to this latter polynomial, we see that 96 Congruences there are polynomials q(x) and s(x) such that xP - x = xf(x)q(x) + ps(x). Since q(x) has degree p - p = 0 and leading coefficient 1, we see that q(x) = 1. That is, xP - x = xf(x) + ps(x), which is to say that the coeffi­ cients of x P - x are congruent (mod p) to those of xf(x). On comparing the coefficients of x, we deduce that up- I = (p - 1)! = -1 (mod p), which provides a second proof of Wilson's congruence. On comparing the remaining coefficients, we deduce that ui = 0 (mod p) for 1 :::;;; j :::;;; p - 2. To these useful observations we may add one further remark: if p ;?; 5 then (2.8) This is Wolstenholme 's congruence. To prove it, we note that f( p) = (p- 1Xp - 2) · · · (p - p + 1) = (p - 1)! . On taking x = p in (2.7), we have ( p-1) '=p p- ! _upP - 2 +· · ·+ u p2 - u p+ a: · I p- 3 p- 2 p - ! • We have already observed that up- I = (p - 1)! . On subtracting this amount from both sides and dividing through by p, we deduce that All terms except the last two contain visible factors of p2• Thus uP_ 3p = uP _ 2 (mod p2). This gives the desired result, since uP_ 3 = O(mod p). PROBLEMS 1. Reduce the following congruences to equivalent congruences of degree :::;;; 6: (a) x 11 + x8 + 5 = O(mod 7); (b) x20 + x 13 + x7 + x = 2(mod 7); (c) x 15- x 10 + 4x - 3 = O(mod 7). 2. Prove that 2 x3 + 5x2 + 6x + 1 = 0 (mod 7) has three solutions by use of Theorem 2.29. 3. Prove that x 14 + 12x2 = 0 (mod 13) has 13 solutions and so it is an identical congruence. 4. Prove that if f(x) = 0 (mod p) has j solutions x =a , , x = a2, . · ·, x = ai (mod p), there is a polynomial q(x) such that f(x) = (x - a 1 ) (x - a 2) · • • ( x - a)q(x) (mod p). (H) 2. 7 Prime Modulus 97 5. With the assumptions and notation of the preceding problem, prove that if the degree of f(x) is j, then q(x) is a constant and can be taken as the leading coefficient of f(x). 6. Let m be composite. Prove that Theorem 2.26 is false if \"mod p\" is replaced by \"mod m.\" 7. Show that if the prime number p in Theorem 2.28 is replaced by a composite number m then the statement becomes false. 8. Explain why the proof of Wolstenholme's congruence fails when p = 3. 9. For p = 5, compute the values of the numbers u\" u2 , u3 , u4 in (2.7). 10. Write 1/1 + 1/2 + · · · + 1j(p - 1) = ajb with (a, b) = 1. Show that p 2 la if p � 5. *11. Let p be a prime, p � 5, and suppose that the numbers OJ are as in (2.7). Show that up -Z = pu P _ 3 (mod p 3). *12. Show that if p � 5 and m is a positive integer then = 1 (mod p 3). *13. Show that if p � 5 then (mp)! = m !p!m (mod pm + 3). ( mp - 1 ) p-1 *14. Suppose that p is an odd prime, and write 1/ 1 - 1/2 + 1/3 - · · · - 1j(p - 1) = aj(p - 1)!. Show that a = (2 - 2 P)j p (mod p). 2.8 PRIMITIVE ROOTS AND POWER RESIDUES Definition 2.6 Let m denote a positive integer and a any integer such that (a, m) = 1. Let h be the smallest positive integer such that ah = 1 (mod m). We say that the order of a modulo m ish, or that a belongs to the exponent h modulo m. The terminology \"a belongs to the exponent h\" is the classical language of number theory. This language is being replaced more and more in the current literature by \"the order of a is h,\" a usage that is standard in group theory. (In Sections 2.10 and 2.11 we shall explore the relationships between the ideas of number theory and those of group theory.) Suppose that a has order h (mod m). If k is a positive multiple of h, say k = qh, then ak = aqh = (ah)q = 1q = 1 (mod m). Conversely, if k is a positive integer such that ak = 1 (mod m), then we apply the division algorithm to obtain integers q and r such that k = qh + r, q � 0, and 0 � r <h. Thus 1 = ak = aqh +r = (ah)qar = 1qar =a' (mod m). But 0 � 98 Congruences r < h and h is the least positive power of a that is congruent to 1 modulo m, so it follows that r = 0. Thus h divides k, and we have proved the following lemma. Lemma 2.31 If a has order h (mod m), then the positive integers k such that ak = 1 (mod m) are precisely those for which h lk. Corollary 2.32 If (a, m) = 1, then the order of a modulo m divides l/J(m). Proof Each reduced residue class a modulo m has finite order, for by Euler's congruence a<l><m> = 1 (mod m). Moreover, if a has order h then by taking k = l/J(m) in the lemma we deduce that h ll/J(m). Lemma 2.33 If a has order h modulo m, then ak has order hj(h, k) modulo m. Since hj(h, k) = 1 if and only if hlk, we see that Lemma 2.33 contains Lemma 2.31 as a special case. Proof According to Lemma 2.31, (ak)j = 1 (mod m) if and only if hlkj. But hlkj if and only if {hj(h, k)} l {k/(h, k)}j. As the divisor is relatively prime to the first factor of the dividend, this relation holds if and only if {hj(h, k)} lj. Therefore the least positive integer j such that (ak)j = 1 (mod m) is j = hj(h, k). If a has order h and b has order k, both modulo m , then (ab)hk = (ah)k(bk)h = 1 (mod m), and from Lemma 2.31 we deduce that the order of ab is a divisor of hk. If h and k are relatively prime, then we can say more. Lemma 2.34 If a has order h (mod m), b has order k (mod m), and if (h, k) = 1, then ab has order hk (mod m). Proof Let r denote the order of ab (mod m). We have shown that rihk. To complete the proof it suffices to show that hklr. We note that b'h = (ahYb'h = (abYh = 1 (mod m). Thus klrh by Lemma 2.31. As (h, k) = 1, it follows that klr. By a similar argument we see that hlr. Using again the hypothesis (h, k) = 1, we conclude that hk lr. We have already seen that the order of a modulo m is a divisor of l/J(m). For certain values of m, there are integers a such that the order of a is equal to l/J(m). These cases are of considerable importance, so a special label is used. 2. 8 Primitive Roots and Power Residues 99 Definition 2.7 If g belongs to the exponent c/J(m) modulo m, then g is called a primitive root modulo m. (In algebraic language, this definition can be stated: If the order of g modulo m is c/J(m), then the multiplicative group of reduced residues modulo m is a cyclic group generated by the element g. Readers not too familiar with group theory can find a more detailed explanation of this in Section 2. 10.) In view of Lemma 2.31, the number a is a solution of the congruence xk = 1 (mod m) if and only if the order of a (mod m) divides k. In one special case, namely the situation of Corollary 2.30, we have determined the number of solutions of this congruence. That is, if p is prime and k l(p - 1), then there are precisely k residue classes a (mod p) such that the order of a modulo p is a divisor of k. If k happens to be a prime power, we can then determine the exact number of residues a (mod p) of order k. Lemma 2.35 Let p and q be primes, and suppose that qa l (p - 1), where a � 1. Then there are precisely q a - q a - I residue classes a (mod p) of order qa. Proof The divisors of qa are the numbers qfl with {3 = 0, 1, · · · , a . Of these, qa is the only one that is not a divisor of q a - 1• There are qa residues (mod p) of order dividing q a, and among these there are q a - l residues of order dividing qa - 1• On subtracting we see that there are precisely qa - qa - l residues a of order qa (mod p). Theorem 2.36 If p is a prime then there exist c/J( p - 1) primitive roots modulo p. Proof We first establish the existence of at least one primitive root. Let p - 1 = pf•pi_2 • • • pti be the canonical factorization of p - 1. By Lemma 2.35 we may choose numbers a; (mod p) so that a; has order pfi, i = 1, 2, · · · , j. The numbers pfi are pairwise relatively prime, so by repeated use of Lemma 2.34 we see that g = a1a2 · · • aj has order pf•pi_2 • • • pti = P - 1. That is, g is a primitive root (mod p). To complete the proof, we determine the exact number of primitive roots (mod p ). Let g be a primitive root (mod p ). Then the numbers g, g2,g3, - · · , gP - I form a system of reduced residues (mod p). By Lemma 2.33 we see that gk has order (p - 1)/(k, p - 1). Thus gk is a primitive root if and only if (k, p - 1) = 1. By definition of Euler's phi function, there are exactly c/J(p - 1) such values of k in the interval 1 .,.;; k .,.;; p - 1. 100 Congruences Remark on Calculation Suppose that we wish to show that a has order h (mod m), where a, h, and m are given. By using the repeated squaring device discussed in Section 2.4, we may quickly verify that ah = 1 (mod m). If h is small, then we simply examine a, a 2, · · ·, ah - t (mod m), but if h is large (e.g., h = cfJ(m)), then the amount of calculation here would be prohibitively long. Instead, we note by Lemma 2.3 1 that the order of a must be a divisor of h. If the order of a is a proper divisor of h then the order of a divides hjp for some prime factor p of h. That is, the order of a (mod m) is h if and only if the following two conditions are satisfied: (i) ah = 1 (mod m), and (ii) for each prime factor p of h, ah!P ¢ 1 (mod m). In case m is prime, we may take h = m - 1 in this criterion to determine whether a is a primitive root. To locate a primitive root we simply try a == 2, a = 3, · · · , and in general a primitive root is quickly found. For example, to show that 2 is a primitive root (mod 101), we note that 2 and 5 are the primes dividing 100. Then we calculate that 250 = -1 ¢ 1 (mod 101), and that 220 = 95 ¢ 1 (mod 101). The techniques discussed in Section 2.4 allow us to prove very quickly that a given number m is composite, but they are not so useful in establishing primality. Suppose that a given number p is a strong pseudo­ prime to several bases, and is therefore expected to be prime. To show that p is prime it suffices to exhibit a number a of order p - 1 (mod p ), for then c/J(p) � p - 1, and hence p must be prime. Here the hard part is to factor p - 1. (If the desired primitive root is elusive, then p is probably composite.) This approach is developed further in Problems 38 and 39 at the end of this Section. Up to 109 or so one may construct primes by sieving. Larger primes (such as those used in public-key cryptography) can be constructed as follows: Multiply several small primes together, add 1 to this product, and call the result p. This number has no greater chance of being prime than a randomly chosen number of the same size, and indeed it is likely that a pseudoprime test will reveal that p is composite (in which case we try again with a new product of small primes). However, if p passes several such tests, then one may proceed as above to show that p is prime, since the factorization of p - 1 is known in advance. Definition 2.8 If (a, p) = 1 and x\" =a (mod p) has a solution , then a is called an nth power residue modulo p. If (g, m) = 1 then the sequence g, g2, ··· (mod m) is periodic. If g is a primitive root (mod m) then the least period of this sequence is c/J(m), and we see that g, g2,- · · , g<f><m> form a system of reduced residues (mod m). Thus g; = gj (mod m) if and only if i = j (mod c/J(m)). By ex­ pressing numbers as powers of g, we may convert a multiplicative copgru- 2. 8 Primitive Roots and Power Residues 101 ence (mod m) to an additive congruence (mod c/J(m)), just as we apply logarithms to real numbers. In this way we determine whether a is an nth power residue (mod p ). Theorem 2.37 If p is a prime and (a, p) = 1, then the congruence x\" = a (mod p) has (n, p - 1) solutions or no solution according as a<P - l)/(n, p - I) = 1(mod p) or not. Proof Let g be a primitive root (mod p ), and .:boose i so that gi = a (mod p). If there is an x such that x\" =a (mod p) then (x, p) = 1, so that x = gu (mod p) for some u. Thus the proposed congruence is gnu = gi (mod p ), which is equivalent to nu = i (mod p - 1). Put k = (n, p - 1). By Theorem 2.17, this has k solutions if kli, and no solution if k%i. If kli, then i(p - l}jk = O(mod p- 1), so that a<p - l)/k = gi<p - l)fk = (gP - l)ifk = 1 (mod p). On the other hand, if k%i then i( p - 1)/k ;f. 0 (mod p - 1), and hence a<p - I)/k = gi<p- l)/k ;f. 1 (mod p). Example 14 Show that the congruence x5 = 6 (mod 101) has 5 solutions. Solution It suffices to verify that 620 = 1 (mod 101). This is easily accom­ plished using the technique discussed in Section 2.4. Note that we do not need to find a primitive root g, or to find i such that g; = 6 (mod 101). The mere fact that 620 = 1 (mod 101) assures us that 5 li. (With more work one may prove that g = 2 is a primitive root (mod 101), and that 270 = 6 (mod 101). Hence the five solutions are x = 2 14 + 20i (mod 101) where j = 0, 1, 2, 3, 4. That is, x = 22, 70, 85, 96, 30 (mod 101).) Corollary 2.38 Euler 's criterion. If p is an odd prime and (a, p) = 1, then x2 = a (mod p) has two solutions or no solution according as a<p- l)/2 = 1 or = -l(mod p). Proof Put b = a<P -I)/2. Thus b2 = a p- l = 1 (mod p) by Fermat's con­ gruence. From Lemma 2. 10 it follows that b = ± 1 (mod p ). If b = -1 (mod p) then the congruence x2 =a (mod p) has no solution, by Theorem 2.37. If b = 1 (mod p) then the congruence has exactly two solutions, by Theorem 2.37. By taking a = -1 in Euler's criterion we obtain a second proof of Theorem 2.12. In the next section we give an algorithm for solving the congruence x2 =a (mod p). In Sections 3.1 and 3.2 a quite different approach of Gauss is developed, which offers an alternative to Euler's 102 Congruences criterion for determining whether a given number a is a quadratic residue (mod p). We have seen that primitive roots provide a valuable tool for analyzing certain congruences (mod p). We now investigate the extent to which this can be generalized to other moduli. Theorem 2.39 lfp is a prime then there exist t/J(t/J( p2)) = (p - 1)cjJ( p - 1) primitive roots modulo p2• Proof We show that if g is a primitive root (mod p) then g + tp is a primitive root (mod p 2) for exactly p - 1 values of t (mod p). Let h denote the order of g + tp (mod p 2). (Thus h may depend on t.) Since (g + tp)h = 1 (mod p2), it follows that (g + tp)h = 1 (mod p), which in turn implies that gh = 1 (mod p), and hence that (p - Olh. On the other hand, by Corollary 2.32 we know that hlc/J(p2) = p(p - 1). Thus h = p - 1 or h = p(p - 1). In the latter case g + tp is a primitive root (mod p2), and in the former case it is not. We prove that the former case arises for only one of the p possible values of t. Let f(x) = xp- t - 1. In the former case, g + tp is a solution of the congruence f(x) = O(mod p2) lying above g (mod p). Since f'(g) = (p - l)gP -2 ¢ 0 (mod p), we know from Hensel's lemma (Theorem 2.23) that g (mod p) lifts to a unique solution g + tp (mod p2). For all other values of t (mod p ), the number g + tp is a primitive root (mod p 2). Since each of the t/J(p - 1) primitive roots (mod p) give rise to exactly p - 1 primitive roots (mod p2), we have now shown that there exist at least (p - l)cjJ(p - 1) primitive roots (mod p2). To show that there are no other primitive roots (mod p2), it suffices to argue as in the preceding proof. Let g denote a primitive root (mod p2), so that the numbers g, g2, · • ·, gP<p - t) form a system of reduced residues (mod p2). By Lemma 2.33, we know that gk is a primitive root if and only if (k, p( p - 1)) = 1. By the definition of Euler's phi function, there are precisely t/J( p(p - 1)) such values of k among the numbers 1, 2, · · ·, p(p - 1). Since ( p, p - 1) = 1, we deduce from Theorem 2.19 that t/J( p(p - 1)) = cjJ(p)t/J(p - 1) = (p - 1)c/J(p - 1). Theorem 2.40 If p is an odd prime and g is a primitive root modulo p2, then g is a primitive root modulo pa for a = 3, 4, 5, · · · . Proof Suppose that g is a primitive root (mod p 2), and that h is the order of g (mod pa) where a > 2. From the congruence gh = 1 (mod pa) we deduce that gh = 1 (mod p 2), and hence that c/J(p2)lh. By Corollary 2.32 we also know that hit/J(pa). Thus h = pf3(p - 1) for some {3 among 2.8 Primitive Roots and Power Residues 103 {3 = 1, 2, · · ·, or a - 1. To prove that {3 = a - 1, it suffices to show that (2.9) We use induction to show that this holds for all a � 2. By hypothesis, the order of g (mod p 2) is cfJ( p2 ) = p(p - 1). Hence g p -t ¢ 1 (mod p2 ), and we have (2.9) when a= 2. By Fermat's congruence g p - t = 1 (mod p), so we may write g P - l = 1 + b1 p with p%b l \" By the binomial theorem, Since p > 2 by hypothesis, { � ) = p( p - 1) /2 = 0 (mod p ), and hence the above is = 1 + b 1 p2 (mod p3). This gives (2.9) when a = 3. Thus we may write g P< P - l ) = 1 + b2p2 with p%b2• We raise both sides of this to the pth power and repeat this procedure to find that g P 2( p - t ) = 1 + b2p 3 (mod p4), which gives (2.9) for a = 4. Continuing in this way, we conclude that (2.9) holds for all a � 2, and the proof is complete. The prime p = 2 must be excluded, for g = 3 is a primitive root (mod 4), but not (mod 8). Indeed it is easy to verify that a2 = 1 (mod 8) for any odd number a. As cfJ(8) = 4, it follows that there is no primitive root (mod 8). Suppose that a is odd. Since 8l (a2 - 1) and 2l(a2 + 1), it follows that 16 l(a2 - 1Xa2 + 1) = a4 - 1. That is, a4 = l(mod 16). On repeating this argument we see that a8 = 1 (mod 32), and in general that a2a -2 = l(mod 2a) for a � 3. Since tfJ(2a) = 2a - t , we conclude that if a � 3 then a<1><2a)/2 = 1 (mod 2 a) ( 2.10) for all odd a, and hence that there is no primitive root (mod 2a) for a= 3, 4, 5, · · · . Suppose that p is an odd prime and that g is a primitive root (mod pa). We may suppose that g is odd, for if g is even then we have only to replace g by g + pa, which is odd. The numbers g, g2, • · ·, g <I>< Pa ) form a reduced residue system (mod pa). Since these numbers are odd, they also form a reduced residue system (mod 2pa). Thus g is a primitive root (mod 2pa). We have established that a primitive root exists modulo m when m = 1, 2, 4, pa, or 2pa, (p an odd prime), but that there is no primitive root (mod 2a) for a � 3. Suppose now that m is not a prime power or twice a prime power. Then m can be expressed as a product, m = m 1m2 104 Congruences with (m 1, m 2) = 1, m 1 > 2, m 2 > 2. Let e = l.c.m. (cf.>(m 1 ), cf.>(m 2 )). If (a, m) = 1 then (a, m1) = 1, so that a<l><m , ) = 1 (mod m1), and hence ae = 1 (mod m 1). Similarly ae = 1 (mod m 2 ), and hence ae = 1 (mod m). Since 2lcf.>(n) for all n > 2, we see that 2l (cf.>(m 1 ), cf.>(m 2)), so that by Theorem 1.13, e= Thus there is no primitive root in this case. We have now determined precisely which m possess primitive roots. Theorem 2.41 There exists a primitive root modulo m if and only if m = 1, 2, 4, pa, or 2pa, where pis an odd prime. Theorem 2.37 (and its proof) generalizes to any modulus m possessing a primitive root. Corollary 2.42 Suppose that m = 1, 2, 4, pa, or 2pa, where pis an odd prime. If (a, m) = 1 then the congruence x \" = a (mod m) has (n, cf.>(m)) solutions or no solution , according as a<f><m )/(n ,</>(m )) = 1 (mod m) ( 2 .11) or not. For the general composite m possessing no primitive root, we factor m and apply the above to the prime powers dividing m. Example 15 Determine the number of solutions of the congruence x 4 = 61 (mod 117). Solution We note that 117 = 32 • 13. As cf.>(9) /(4, cf.>(9)) = 6/(4, 6) = 3 and 613 = (- 2)3 = 1 (mod 9), we deduce that the congruence x 4 = 61 (mod 9) has (4, cf.>(9)) = 2 solutions. Similarly cf.>(13)j(4, cf.>(13)) = 3 and 613 = ( -4)3 = 1 (mod 13), so the congruence x 4 = 61 (mod 13) has (4, cf.>(13)) = 4 solutions. Thus by Theorem 2.20, the number of solutions modulo 117 is 2 · 4 = 8. This method fails in case the modulus is divisible by 8, as Corollary 2.42 does not apply to the higher powers of 2. In order to establish an analogue of Corollary 2.42 for the higher powers of 2, we first show that 5 is nearly a primitive root (mod 2a). 2. 8 Primitive Roots and Power Residues 105 Theorem 2.43 Suppose that a � 3. The order of 5 (mod 2a) is 2a - 2• The numbers ± 5, ±5 2,± 53,- ·· ,± 5 2a-2 form a system of reduced residues (mod 2a). If a is odd, then there exist i and j such that a = ( - 1)i5j (mod 2a). The values of i and j are uniquely determined (mod 2) and (mod 2a- 2), respectively. Proof We first show that 2aiK5 2a-2 - 1) for a � 2. This is clear for a = 2. If a = 1 (mod 4) then 2 1Ka + 1), and hence the power of 2 dividing a2 - 1 = (a - 1Xa + 1) is exactly one more than the power of 2 dividing a - 1. Taking a = 5, we deduce that 23 IK5 2 - 1). Taking a =52, we then deduce that 24 IK54 - 1), and so on. Now let h denote the order of 5(mod 2a). Since hi<P(2a) and <fJ(2a) = 2a- 1, we know that h = 21J for some {3. But the least {3 for which 5 2/l = 1 (mod 2a) is {3 = a - 2. Thus 5 has order 2a - 2 (mod 2a), so that the numbers 5, 5 2, 53, • •• ' 5 2a-2 are mutu­ ally incongruent (mod 2a). Of the 2a- l integers in a reduced residue system (mod 2a), half are = l(mod 4), and half are = 3(mod 4). The numbers 5j are all = 1 (mod 4). Since the powers of 5 lie in 2a- 2 distinct residue classes (mod 2a), and since 2a- 2 of the integers (mod 2a) are = l(mod 4), for any a = l(mod 4) there is a j such that a = 5j (mod 2a). For any integer a = 3 (mod 4), we observe that - a = l(mod 4), and hence that - a = 5j (mod 2a) for some j. Corollary 2.44 Suppose that a � 3 and that a is odd. If n is odd, then the congruence x \" = a (mod 2a) has exactly one solution. If n is even , then choose {3 so that (n, 2a - 2) = 21J. The congruence x \" = a (mod 2a) has 2fj + I solutions or no solution according as a = 1 (mod 2 fJ + 2 ) or not. Proof Since a is odd, we may choose i and j so that a = ( -1);5j (mod 2a). As any x for which x \" =a (mod 2a) is necessarily odd, we may suppose that X = ( -l)u5 v (mod 2a). The desired congruence then takes the form ( -l)\"u5nv = ( -1);5j (mod 2a). By Theorem 2.43, this is equivalent to the pair of congruences nu = i(mod 2), nv =j (mod 2a - 2). If n is odd, then by Theorem 2.17 there exists exactly one u (mod 2) for which the first congruence holds, and exactly one v (mod 2a - 2 ) for which the second congruence holds, and hence there exists precisely one solution x in this case. Suppose now that n is even. We apply Theorem 2.17 two more times. If i = 0 (mod 2) then the congruence nu = i (mod 2) has two solutions. Otherwise it has none. If j = 0 (mod 2fJ) then the congruence nv = j (mod 2a - 2 ) has exactly 2fJ solutions. Otherwise it has none. Thus the congruence x \" = a(mod 2a) has 2fJ + l solutions or no solution, according as a = 5j (mod 2a), j = 0 (mod 2fJ), or not. From Theorem 2.43 we know 106 Congruences that 5 has order 2/3 (mod 2/3+2). Thus by Lemma 2.31, 5j = 1 (mod 213+2) if and only if 2/3 lj. Since 213+21 2a, the condition on a is precisely that a = l(mod 2/3 +2). PROBLEMS 1. Find a primitive root of the prime 3; the prime 5; the prime 7; the prime 11; the prime 13. 2. Find a primitive root of 23. 3. How many primitive roots does the prime 13 have? 4. To what exponents do each of 1, 2, 3, 4, 5, 6 belong modulo 7? To what exponents do they belong modulo 11? 5. Let p be an odd prime. Prove that a belongs to the exponent 2 modulo p if and only if a = - 1 (mod p ). 6. If a belongs to the exponent h modulo m, prove that no two of a, a2,a3, • • ·, ah are congruent modulo m. 7. If p is an odd prime, how many solutions are there to xP- I = 1 (mod p); to x p - l = 2(mod p)? 8. Use Theorem 2.37 to determine how many solutions each of the following congruences has: (a) x12 = 16 (mod 17) (b) x48 = 9(mod 17) (c) x20 = 13 (mod 17) (d) x 11 = 9(mod 17). 9. Show that 38 = - 1 (mod 17). Explain why this implies that 3 is a primitive root of 17. 10. Show that the powers of 3 (mod 17) are 3, 9, 10, 13, 5, 15, 11, 16, 14, 8, 7, 4, 12, 2, 6, 1. Use this information to find the solutions of the congruences in Problem 8. 11. Using the data in the preceding problem, decide which of the congruences x2 = 1, x2 = 2, x2 = 3, · · · , x2 = 16 (mod 17), have solu­ tions. 12. Prove that if p is a prime, (a, p) = 1 and (n, p- 1) = 1, then x\" = a (mod p) has exactly one solution. 13. Show that the numbers 1\\ 2k, . · ·, (p - 1)k form a reduced residue system (mod p) if and only if (k, p- 1) = 1. 14. Suppose that a has order h (mod p), and that aa = 1 (mod p). Show that a also has order h. Suppose that g is a primitive root (mod p ), and that a = g ; (mod p ), 0 � i < p - 1. Show that a = gp - l -i (mod p). 15. Prove that if a belongs to the exponent h modulo a prime p, and if h is even, then ah 12 = -1 (mod p). 2. 8 Primitive Roots and Power Residues 107 16. Let m and n be positive integers. Show that (2m - 1, 2n + 1) = 1 if m is odd. 17. Show that if ak + 1 is prime and a > 1 then k is a power of 2. Show that if p l (a2 \" + 1) then p = 2 or p = l(mod 2n + l ). (H) 18. Show that if g and g ' are primitive roots modulo an odd prime p, then gg ' is not a primitive root of p. 19. Show that if ah = 1 (mod p) then aPh = 1 (mod p2). Show that if g is a primitive root (mod p 2) then it is a primitive root (mod p). 20. Of the 101 integers in a complete residue system (mod 1012 ) that are = 2(mod 101), which one is not a primitive root (mod 1012)? 21. Let g be a primitive root of the odd prime p. Show that - g is a primitive root, or not, according as p = 1 (mod 4) or p = 3 (mod 4 ). 22. Let g be a primitive root (mod p). Show that (p - 1)! = g · g 2 · ... · gP - 1 =gP<p - l)/2 (mod p). Use this to give another proof of Wilson's congruence (Theorem 2.11). *23. Prove that if a belongs to the exponent 3 modulo a prime p, then 1 +a + a2 = O(mod p), and 1 +a belongs to the exponent 6. *24. Let a and n > 1 be any integers such that an - I = 1 (mod n) but ad ¥= 1 (mod n) for every proper divisor d of n - 1. Prove that n is a prime. *25. Show that the number of reduced residues a (mod m) such that am- I =: 1 (mod m) iS exactly n (p - 1, m- 1). p l m *26. (Recall that m is a Carmichael number if am - I = l(mod m) for all reduced residues a (mod m).) Show that m is a Carmichael number if and only if m is square-free and ( p - 1) 1(m - 1) for all primes p dividing m . Deduce that 2821 = 7 · 13 · 31 is a Carmichael number. *27. Show that m is a Carmichael number if and only if am = a (mod m) for all integers a. *28. Show that the following are equivalent statements concerning the positive integer n: (i) n is square-free and (p - Oln for all primes p dividing n; (ii) If j and k are positive integers such that j = k (mod n), then aj = ak ( mod n ) for all integers a. (The numbers 1, 2, 6, 42, 1806 have this property, but there are no others. See J. Dyer-Bennet, \"A theorem on partitions of the set of positive integers,\" Amer. Math. Monthly , 47 (1940), 152- 154.) *29. Show that the sequence 11, 2 2, 33, · · · , considered (mod p) is periodic with least period p( p - 1). 108 Congruences *30. Suppose that (lOa, q) = 1, and that k is the order of 10 (mod q ). Show that the decimal expansion of the rational number a I q is per�odic with least period k. *31. Show that the decimal expansion of 1/p has period p - 1 if and only if 10 is a primitive root of p. (It is conjectured that if g is not a square, and if g =t= -1 , then there are infinitely many primes of which g is a primitive root.) *32. Let r 1, r2 , · · ·, rn be a reduced residue system modulo m (n = </J(m)). Show that the numbers r� , rf, · · ·, r; form a reduced residue system (mod m) if and only if (k, </J(m)) = 1. (H) 33. Let k and a be positive integers, with a ;;;?; 2. Show that ki</J(ak - 1). (H) 34. Show that if pi</J(m) and p)'m then there is at least one prime factor q of m such that q = 1 (mod p ). 35. Let p be a given prime number. Prove that there exist infinitely many prime numbers q = 1 (mod p ). (H) 36. Primes = 1 (mod m). For any positive integer m, prove that the arithmetic progression 1 + m, 1 +2m, 1 +3m, ··· ( 2.12) contains infinitely many primes. An elementary proof of this is outlined in parts (i) to (vii) below. (The argument follows that of I. Niven and B. Powell, \"Primes in certain arithmetic progressions,\" Amer. Math. Monthly , 83 (1976), 467-469, as simplified by R. W. Johnson.) (i) Prove that it suffices to show that for every positive integer m, the arithmetic progression (2. 12) contains at least one prime. Note also that we may suppose that m ;;;?; 3. We now show that for any integer m ;;;?; 3, the number mm - 1 has at least one prime divisor = 1 modulo m. We suppose that m ;;;?; 3 and that mm - 1 has no prime divisor = 1 (mod m), and derive a contradiction. (ii) Let q be any prime divisor of mm - 1, so that q ¥= 1 (mod m). Let h denote the order of m (mod q ), so that mh = 1 (mod q ), and moreover md = 1 (mod m) if and only if h ld, by Lemma 2.31. Verify that hI (q - 1) and h lm. Prove that h < m, so that m = he with c > 1. Suggestion : From h = m deduce that m I (q - 1). (iii) Let q' be the highest power of q dividing mm - 1; thus q'll (mm - 1). Prove that q'll (mh - 1), and that q'll (md - 1) for every integer d such that h ld and d lm. Suggestion: Verify that it suffices to prove the property for mh - 1, since each of mh - 1, 2. 8 Primitive Roots and Power Residues 109 md - 1, and mm - 1 is a divisor of the next one. Since m = he, we have mm - 1 = ( m h - 1)F(m) where F( m) = m hc- h + mh c- 2h + mh c- 3h + ... +mh + 1. Then F(m) = 1 + 1 + 1 + · · · + 1 = c(mod q). Also ql(mm -1) implies q%m and q%c. These properties of q hold for any prime divisor of mm - 1. Of course different prime factors may give different values of h , c, and r, because these depend on q. To finish the proof we need one additional concept. Consider the set of integers of the form mjs, where s is any square-free divisor of m, excluding s = 1. We partition this set into two disjoint subsets !T and 1/ according as the number of primes dividing s is odd or even. Put Q = ( n (md - 1))( n (md - 1))-·. d e.'T d eP (iv) Let q be the prime factor of mm - 1 under consideration, and let md - 1 be a factor that occurs in one of the two products displayed. Use (ii) to show that ql(md - 1) if and only if s ic. (v) Let k denote the number of distinct primes dividing c. Show that the number of dE !T for which ql(md - 1) is { �) + { �) + { �) · · ·, and that this sum is zk - l . Similarly show that the number of dE 1/ for which ql(md - 1) is {�) + {�) +· · · , and that this is zk- l - 1. Use (iii) to show that q'IIQ for each prime divisor q of mm - 1. Deduce that Q = mm - 1. (vi) Show that if b is a positive integer and m � 3 then m b - 1 ¥= ±Hmod mb + l). (vii) Prove that the equation Q = mm - 1 is impossible, by writing the equatiOn in the form ( mm - nnd E p(md - 1) = nd E g-(md - 1), and evaluating both sides (mod mb + 1) where b is the least integer of the type d that appears in the definition of Q. *37. Show that if n > 1 then n%(2n - 1). (H) *38. Let m be given, suppose that q is a prime number, qa ll ( m - 1), a > 0, and that there is a number a such that am - l = 1 (mod m) but (a<m- l)fq - 1, m) = 1. Show that p = 1 (mod qa) for all prime fac­ tors p of m. 110 Congruences •39. Let m be given, and let s be a product of prime powers qa each having the property described in the preceding problem. Show that if s > m112 then m is prime. 2.9 CONGRUENCES OF DEGREE TWO, PRIME MODULUS If f(x) = O(mod p) is of degree 2, then f(x) = ax 2 + bx + c, and a is relatively prime to p. We shall suppose p > 2 since the case p = 2 offers no difficulties. Then pis odd, and 4af(x) = (2ax + b )2 + 4ac - b2• Hence u is a solution of f(x) = O(mod p) if and only if 2au + b = v (mod p), where v is a solution of v 2 = b2 - 4ac (mod p). Furthermore, since (2a, p) = 1, for each solution v there is one, and only one, u modulo p such that 2au + b = v (mod p). Clearly different v modulo p yield dif­ ferent u modulo p. Thus the problem of solving the congruence of degree 2 is reduced to that of solving a congruence of the form x2 =a (mod p). Following some preliminary observations on this congruence, we turn to an algorithm, called RESSOL, for finding its solutions. If a = 0 (mod p ), then this has the sole solution x = 0 (mod p ). If a '/= 0 (mod p ), then the congruence x 2 = a (mod p) may have no solution, but if x is a solution then -x is also a solution. Since p is odd, x '/= -x (mod p ), and thus the congruence has two distinct solutions in this case. It cannot have more than two, by Corollary 2.27. If p is a small prime then the solutions of the congruence x2 = a (mod p) may be found by simply trying x = 0, x = 1, - · ·, x = (p - 0/2 until one is found. Since this involves \"\" p multiplications, for large p it is desirable to have a more efficient procedure. If p = 2 then it suffices to take x = a . Thus we may suppose that p > 2. By Euler's criterion we may suppose that a<P- 1>12 = 1 (mod p), for otherwise the congruence has no solution. Suppose first that p = 3 (mod 4). In this case we can verify that x = ±a<P+ 1>14 are the solutions, for ( ±a<P+ 1)/4 )2 = a<P+ 1)/2 = a . a<P- 1)/2 = a (mod P) . Note that it is not necessary to verify in advance that a<P- 1>12 = 1 (mod p). It suffices to calculate x = a<P+ 1>14 (mod p ). If x2 = a (mod p ), then the solutions are ±x. Otherwise x2 = -a (mod p), and we can conclude that a is a quadratic nonresidue. Thus x = ±a<P+ 1>14 are the solutions, if the congruence has a solution. This takes care of roughly half the primes. As 2. 9 Congruences of Degree Two, Prime Modulus 1 11 always with large exponents, the value of a<p + l>l4 (mod p) is determined using the repeated squaring device discussed in Section 2.4. Hence the number of congruential multiplications required is only of the order of magnitude log p. Suppose now that p = 1 (mod 4). We have already considered the special case x2 = -1 (mod p), and in proving Theorem 2.12 we gave a formula for the solutions, namely x = ±((p - 0/2)! . However, this for­ mula is useless for large p, as it involves == p multiplications. On the other hand, if a quadratic nonresidue z is known then we may take x = ±z<P- l)/4 (mod p), since then x2 = z<p- l)/2 = - 1 (mod p) by Euler's criterion. Thus in this special case it suffices to find a quadratic non­ residue. We can try small numbers in turn, or use a random number generator to provide \"random\" residue classes. In either case, since half the reduced residues are quadratic nonresidues, we may expect that the average number of trials is 2. (Here our interest is not in a deterministic algorithm of proven efficiency, but rather a calculational procedure that is quick in practice.) We now develop these ideas to find the roots of the congruence x2 =a (mod p) for arbitrary a and p. We begin with a few general observations. Let a and b be relatively prime to m, and suppose that a and b both have order h (mod m). Then (ab )h = 1 (mod m), and hence the order of ab is a divisor of h. In general nothing more can be said. It may be that b is the inverse of a, so that ab = 1 (mod m), in which case the order of ab is 1. On the other hand, the order of ab may be as large as h. (Consider 3(mod 11), 5(mod 11), and 3 · 5 = 4(mod 11). All three of these numbers have order 5.) Nevertheless there is one particular situation in which a little more can be established. Theorem 2.45 If a and b are relatively prime to a prime number p, and if a and b both have order 2 i (mod p) with j > 0, then ab has order 2 i' (mod p) for some j' < j. Proof Since a has order 2i (mod p), it follows that 2il(p - 1), and thus p > 2. Put x = a2j- 1• Then x ¥= 1 (mod p) but x2 = a2i = 1 (mod p). Thus by Lemma 2.10 it follows that x = -1 (mod p). Similarly, b2j- l = - 1 (mod p ), and it follows that From this and Lemma 2.31 we deduce that the order of ab is a divisor of 2i - l, that is, the order of ab is 2i' for some j' <j. 112 Congruences Neither Theorem 2.45 nor its proof involves primitive roots, but some further insight can be obtained by interpreting the situation in terms of powers of a given primitive root g. Write a = ga (mod p), where 0 .,;;; a < p - 1. By Lemma 2.33, the order of ga is (p - l)j(p - 1, a). Write p- 1 = m2k with m odd. The hypothesis that a has order 2j is thus equivalent to the relation (p - 1, a) = m2k -j. That is, a= a1 m2k -j with a1 odd. Similarly, b = gf3 (mod p) with {3 = {31 m2k-j, {31 odd. But then ab = ga +f3 (mod p), and a + {3 = (a1 + {31)m2k -j. Since a1 and {31 are both odd, it follows that a1 + {31 is even. Choose i so that (a1 + {31, 2j) = 2 ... Since j > 0 by hypothesis, it follows that i > 0. Moreover, the order of ab is 2 j-,., so we have j' = j - i < j. With these tools in hand, we describe the algorithm RESSOL (for RESidue SOLver), which locates x such that x 2 = a (mod p ). We begin by determining the power of 2 in p - 1. Thus we find k and m with m odd, so that p - 1 = 2km. We are supposing that p > 2, so that k > 0. Set r = a<m + 1>12 (mod p) and n = am (mod p ). We note that r2 = an (mod p) . (2.13) If n = 1 (mod p ), then it suffices to take x = ± r (mod p ). If n ¢ 1 (mod p), then we find a quadratic nonresidue z, and put c = z m (mod p). We note that Thus the order of c is a divisor of 2k. Moreover, since z is a quadratic nonresidue. Thus the order of c is exactly 2k. Similarly, so that the order of n divides 2k. By repeatedly squaring n we determine the exact order of n, say 2k'. Since we see that a is a quadratic residue (mod p) if and only if n2k -l = 1 (mod p) , 2.9 Congruences of Degree Two, Prime Modulus 113 which in turn is equivalent to the inequality k' < k. It is worth checking that this inequality holds, for otherwise k' = k, a is a quadratic non­ residue and the proposed congruence has no solution. At this point of the algorithm, we begin a loop. Set b = c 2k -k• - l (mod p). We put r' = br (mod p), c' = b 2 (mod p), n' = c'n (mod p). By multiplying both sides of (2.13) by b 2 we find that r'2 = an' (mod p ). (2.14) The point of this construction is that c' has order exactly 2k'. Since n -¥= 1 (mod p) in the present case, it follows that k' > 0. Thus by Theorem 2.45, the order of n' = c'n is 2k\" where k\" < k'. (We determine the value of k\" by repeated squaring.) If k\" = 0, then n' = 1 (mod p ), and we see from (2. 14) that it suffices to take x = ± r' (mod p ). If n' \"¥= l(mod p ), then k\" > 1, and the situation is the same as when the loop began, except that the numbers c (of order 2k) and n (of order 2k ') with 0 < k' < k have been replaced by c' (of order 2k ') and n' (of order 2k\") with 0 < k\" < k', while r has been replaced by r' and (2.13) has been replaced by (2.14). Since k\" < k', some progress has been made. By executing this loop repeatedly, we eventually arrive at a set of these variables for which n = 1 (mod p ), and then x = ± r (mod p) is the desired solution. As a numerical example of this algorithm, suppose we wish to find the roots of the congruence x2 = 43 (mod 97). Thus p = 97, and p- 1 = 25 • 3. By using the method described in Section 2.4, we find that r = 43<3 + l)/2 = 6 (mod 97), and that n = 433 = 64 (mod 97). Thus the congru­ ence (2.13) is 62 = 43 · 64 (mod 97). Since n -¥= l(mod 97), we must find a quadratic nonresidue. We note that (p - 0/2 = 48, and calculate that 248 = 1 (mod 97). Thus 2 is a quadratic residue, by Euler's criterion. Similarly 3 is a quadratic residue, but 5 is a quadratic nonresidue. We set z = 5, c = 53 = 28 (mod 97). Thus c has order 25 (mod 97). By repeatedly squaring, we discover that n has order 23 (mod 97). That is, k' = 3, and we now begin the loop. Since k - k' - 1 = 1, we set b = c 2 = 8 (mod 97), and c' = b2 = 64 (mod 97). On multiplying both sides of (2.13) by b 2 we obtain the congruence (2. 14) with r' = 8 · 6 = 48 (mod 97) and n' = 64 · 64 = 22 (mod 97). That is, 482 = 43 · 22 (mod 97). By repeated squaring, we discover that 22 has order 2 2 (mod 97), so we take k\" = 2, and we are ready to begin the loop over. With the new values of the parameters, we now have k- k' - 1 = 0, so we set b = c = 64 (mod 97), c' = 642 = 22 (mod 97), and obtain the congruence 65 2 = (64 · 48)2 = 43 · (22 · 22)2 = 43 · 96 (mod 97). That is, r' = 65, n' = 96 (mod 97). Here 96 has order 2, so that k\" = 1. Since n' -¥= 1 (mod 97), we must execute the loop a third time. As k- k' - 1 = 0, we set b = c = 22 (mod 97), c' = b 2 = 96 (mod 97), and we obtain the congruence 72 2 = (22 · 65)2 = 43 · (96 · 114 Congruences 96) = 43 (mod 97). Thus the solutions are x = ± 72 (mod 97). This exam­ ple of the algorithm is unusually long because p - 1 is divisible by a high power of 2. To gain further insight into this algorithm, let g be a primitive root (mod p). Then z = gn (mod p) for some n, and hence c = z m = gmn (mod p). But n is odd since z is a quadratic nonresidue, and thus (mn, p - 1) = m. Consequently by Lemma 2.33 the order of c is 2k. In general, the order of g 1 is a power of 2 if and only if mI t. There are precisely 2k such residue classes, namely gm, g 2m, g 3m, · · ·, g 2km. On the other hand, the 2k residue classes c, c2, c3, • • · , c2k are distinct, and each one has order a power of 2, so this latter sequence is simply a permutation of the former one. Thus the order of a residue class is a power of 2 if and only if it is a power of c. But n =am (mod p) has order that is a power of 2, and hence there is a non-negative integer u such that n = cu (mod p). A number c1 is a quadratic residue or nonresidue accord­ ing as t is even or odd. Hence if a is a quadratic residue, then u is even, and the solutions sought are x = ±cuf2 (mod p). Thus it suffices to determine the value of u (mod 2k). As it stands, the algorithm does not do this, but it can be slightly modified to yield u. (See Problem 5 below.) If n � 1 (mod p), then u � O(mod 2k). Suppose that 0 < u < 2k. If the order of n is 2k' then 2k- k'lu but 2k- k' + t )'u. Thus we obtain some information concerning the binary expansion of u. Repeated iterations of the loop (suitably modified) determine further coefficients in the binary expansion of u, and eventually u is determined. Alternatively, the value of u could be determined by calculating the successive powers of c until n is encountered, but that might require as many as 2k multiplications. The algorithm given is much faster, as the loop is executed at most k times. PROBLEMS 1. Reduce the following congruences to the form x 2 = a (mod p ): (a) 4x2 + 2x + 1 = O(mod 5); (b) 3x2 -x + 5 = O(mod 7); (c) 2x 2 + 7x - 10 = O(mod 11); (d) x 2 + x- 1 = O(mod 13). 2. Suppose that f(x) = ax 2 + bx + c, and that D = b2 - 4ac. Show that if p is an odd prime, p )'a, p iD, then f(x) = O(mod p) has exactly one solution. Show that if pis an odd prime, p)' a , p)' D, then the congruence f(x) = O(mod p) has either 0 or 2 solutions, and that if x is a solution then f'(x) � O(mod p). *3. Let f(x) = ax2 + bx + c, and let p be an odd prime that does not divide all the coefficients a, b, c. Show that the congruence f(x) = 0 (mod p2) has either 0, 1, 2, or p solutions. 2. 10 Number Theory from an Algebraic Viewpoint 115 4. With the aid of a pocket calculator, use RESSOL to find the solutions of the following congruences: (a) x2 = 10 (mod 13); (b) x2 = 5 (mod 19); (c) x2 = 3(mod 11); (d) x2 = 7(mod29). •s. Suppose that pis an odd prime, p- 1 = m2k with m odd. Let z be a quadratic nonresidue of p, and put c = z m (mod p). Suppose that n ;f= 1 (mod p), and that the order of n is a power of 2, say 2k'. Let u be chosen, 0 < u < 2\\ so that cu = n (mod p). Put n' = ne2k-k' (mod p) where cc = 1 (mod p). Show that the order of n' is 2k\" for some k\" < k'. If k\" > 0, put n\" = n'c2k-k\" (mod p). Continue in this manner. Show that 2k -k ' + 2k -k\" + · · · is the binary expansion of u. 6. Suppose that the reduced residue classes a and b (mod p) both have order Y. Here j > 0 and p is prime. Show that of the two residue classes ab and ab2, one of them has order 3j and the other has order 3j' for some j' < j. 7. Suppose that (a, p) = 1 and that p is a prime such that p = 2 (mod 3). Show that the congruence x3 = a (mod p) has the unique solution x = a<2p- l)/3 (mod p ). •s. Suppose that p - 1 = m3k with k > 0 and 3%m. Show that if (n, p) = 1 then the order of n is a power of 3 if and only if the congruence xm = n (mod p) has a solution. If m = 2 (mod 3) then put r = a<m + l)/3, n = am (mod p). If m = 1 (mod 3), put r = a<2m + l)/3, n = a2m (mod p). Show that in either case, r3 =an (mod p), and that the order of n is a power of 3, say 3k '. Choose z so that z<P- l)/3 ;f= 1 (mod p ), and set c = z m (mod p ). Show that c has order exactly 3k, and that there is an integer u, 0 � u < 3k, such that n = cu (mod p). Show that one of the numbers nc3k -k•, nc2 · 3k-k• has order 3k ', and that the order of the other one is a smaller power of 3, say 3k \". Let n' denote this number with smaller order. Determine r' so that r'3 = an' (mod p). Continuing in this manner, construct an algorithm for computing the solutions of the congruence x3 =a (mod p). 2.10 NUMBER THEORY FROM AN ALGEBRAIC VIEWPOINT In this section and the next we consider congruences from the perspective of modern algebra. The theory of numbers provides a rich source of examples of the structures of abstract algebra. We shall treat briefly three of these structures: groups, rings, and fields. 116 Congruences Before giving the technical definition of a group, let us explain some of the language used. Operations such as addition and multiplication are called binary operations because two elements are added, or multiplied, to produce a third element. The subtraction of pairs of elements, a - b, is likewise a binary operation. So also is exponentiation, ab, in which the element a is raised to the bth power. Now, a group consists of a set of elements together with a binary operation on those elements, such that certain properties hold. The number theoretic groups with which we deal will have integers or sets of integers as elements, and the operation will be either addition or multiplication. However, a general group can have elements of any sort and any kind of binary operation, just as long as it satisfies the conditions that we shall impose shortly. We begin with a general binary operation denoted by EB, and we presume that this binary operation is single-valued. This means that for each pair a, b of elements, a EB b has a unique value or is not defined. A set of elements is said to be closed with respect to an operation EB, or closed under the operation, if a EB b is defined and is an element of the set for every pair of elements a, b of the set. For example, the natural numbers 1, 2, 3, · · · are closed under addition but are not closed under subtraction. An element e is said to be an identity element of a set with respect to the operation EB if the property aEB e= eEBa=a holds for every element a in the set. In case the elements of the set are numbers, then e is the zero element, e = 0, if EB is ordinary addition, whereas e is the unity element, e = 1, if EB is ordinary multiplication. Assuming the existence of an identity element e, an element a is said to have an inverse, written a - 1, if the property a ea - 1 =a - 1 ea = e holds. If the elements are numbers and EB is ordinary addition, we usually write a + b for a EB b and - a for the inverse a - 1 because the additive inverse is the negative of the number a. On the other hand, if the operation EB is ordinary multiplication, we write a · b for a EB b. In this case the notation a - 1 is the customary one in elementary algebra for the multiplicative inverse. Here, and throughout this section, the word \"num­ ber\" means any sort of number, integral, rational, real, or complex. Definition 2.9 A group G is a set of elements a, b, c, · · · together with a single-valued binary operation EB such that (1) the set is closed under the operation; (2) the associative law holds, namely, a EB ( b EB c) = ( a EB b) EB c for all elements a , b, c in G ; 2. 10 Number Theory from an Algebraic Viewpoint 117 (3) the set has a unique identity element, e; (4) each element in G has a unique inverse in G. A group G is called abelian or commutative if a e b = b e a for every pair of elements a, b, in G. A finite group is one with a finite number of elements; otherwise it is an infinite group. If a group is finite, the number of its elements is called the order of the group. Properties 1, 2, 3, and 4 are not the minimum possible postulates for a group. For example, in postulate 4 we could have required merely that each element a have a left inverse, that is an inverse a' such that a' e a = e, and then we could prove the other half of postulate 4 as a consequence. However, to avoid too lengthy a discussion of group theory, we leave such refinements to the books on algebra. The set of all integers 0, ± 1, ± 2 · · · is a group under addition; in fact it is an abelian group. But the integers are not a group under multiplication because of the absence of inverses for all elements except ±1 . Another example of a group is obtained by considering congruences modulo m. In case m = 6, to give a concrete example, we are familiar with such simple congruences as 3 + 4 = 1 (mod 6) , 5 + 5 = 4(mod 6) . We get \"the additive group modulo 6\" by taking a complete residue system, say 0, 1, 2, 3, 4, 5 and replacing congruence modulo 6 by equality: 3 + 4 = 1, 5 + 5 = 4. The complete addition table for this system is: ED 0 1 2 3 4 5 0 0 1 2 3 4 5 1 1 2 3 4 5 0 2 2 3 4 5 0 1 3 3 4 5 0 1 2 4 4 5 0 1 2 3 5 5 0 1 2 3 4 Of course, any complete residue system modulo 6 would do just as well; thus 1, 2, 3, 4, 5, 6, or 7, - 2, 17, 30, 8, 3, could serve as the elements, pro- 118 Congruences vided we perform additions modulo 6. If we were to use the system 7, - 2, 17, 30, 8, 3, the addition table would look quite different. However, the two groups are essentially the same; we have just renamed the elements: 0 is now called 30, 1 is 7, and so on. We say that the two groups are isomorphic, and we do not consider isomorphic groups as being different. Thus we speak of \"the\" additive group modulo 6, not \"an\" additive group modulo 6. Definition 2.10 Two groups, G with operation e and G' with operation 0 , are said to be isomorphic if there is a one-to-one co\"espondence between the elements of G and those of G', such that if a in G co\"esponds to a' in G', and b in G co\"esponds to b' in G', then a e b in G co\"esponds to a' 0 b' in G'. In symbols, G � G'. Another way of thinking of the additive group modulo 6 is in terms of the so-called residue classes. Put two integers a and b into the same residue class modulo 6 if a = b (mod 6), and the result is to separate all integers into six residue classes: C0 : • • · , -18,- 12, -6, 0, 6, 12, 18, · · · C1 : · · · , -17, -1 1, -5, 1, 7, 13, 19, · · · C2 : · • • , -16, - 10, -4,2, 8, 14, 20, · · · C3 : · · • , - 15, -9, - 3, 3, 9, 15, 21, · · · C4 : • • • ,- 14, -8,-2,4, 10, 16, 22, · · · C5 : . . . ,- 13 , -7, -1 ,5, 11, 17, 23, .. . If any element in class C2 is added to any element in class C3 , the sum is an element in class C5 , so it is reasonable to write C2 + C3 = C5 • Similarly we observe that C3 + C4 = c .. C5 + C3 = C2 , etc., and so we could make up an addition table for these classes. But the addition table so con­ structed would be simply a repetition of the addition table of the elements 0, 1, 2, 3, 4, 5 modulo 6. Thus the six classes C0 , C1 , C2 , C3, C4 , C5 form a group under this addition that is isomorphic to the additive group modulo 6. This residue class formulation of the apditive group modulo 6 has the advantage that such a peculiar equation as 5 + 5 = 4 (in which the symbols have a different meaning than in elementary arithmetic) is re­ placed by the more reasonable form C5 + C5 = C4 • 2.10 Number Theory from an Algebraic Viewpoint 119 Theorem 2.46 Any complete residue system modulo m forms a group under addition modulo m. Two complete residue systems modulo m constitute isomorphic groups under addition , and so we speak of \"the\" additive group modulo m. Proof Let us begin with the complete residue system 0, 1, 2, · · · , m - 1 modulo m. This system is closed under addition modulo m, and the associative property of addition is inherited from the corresponding prop­ erty for all integers, that is a + (b + c) = (a + b) + c implies a + (b + c) = (a +b)+ c (mod m). The identity element is 0, and it is unique. Finally, the additive inverse of 0 is 0, and the additive inverse of any other element a is m - a. These inverses are unique. Passing from the system 0, 1, · · · , m - 1 to any complete residue system r0, r1, · · , r m- I• we observe that all the above observations hold with a replaced by r0, a = 0, 1, · · · , m - 1, so that we have essentially the same group with new notation. PROBLEMS 1. Which of the following are groups? (a) the even integers under addition; (b) the odd integers under addition; (c) the integers under subtraction; (d) the even integers under multiplication; (e) all integers that are multiples of 7, under addition; (f) all rational numbers under addition (recall that a rational num­ ber is one of the form ajb where a and b are integers, with b -=F 0); (g) the same set as in (f), but under multiplication; (h) the set as in (f) with the zero element deleted, under multiplica­ tion; (i) all rational numbers ajb having b = 1 or b = 2, under addition; (j) all rational numbers ajb having b = 1, b = 2, or b = 3, under addition. 2. Let G have as elements the four pairs (1, 1), (1, - 1), ( -1 , 1), ( -1,- 1), and let (a, b) e (c, d) = (ac, bd). Prove that G is a group. 3. Using the complete residue system 7, - 2, 17, 30, 8, 3, write out the addition table for the additive group modulo 6. Rewrite this table replacing 7 by 1, 30 by 0, and so on. Verify that this table gives the same values for a e b as the one in the text. 120 Congruences 4. Prove that the set of elements e, a, b, c with the following table for the binary operation, ED e a b c e e a b c a a e c b b b c a e c c b e a is a group. Prove that this group is isomorphic to the additive group modulo 4. 5. Prove that the set of elements e, u, v, w, with the following table for the binary operation, ED e u v w e e u v w u u e w v v v w e u w w v u e is a group. Prove that this group is not isomorphic to the additive group modulo 4, but that it is isomorphic to the group described in Problem 2. 6. Prove that the set of elements 1, 2, 3, 4, under the operation of multiplication modulo 5, is a group that is isomorphic to the group in Problem 4. 7. Prove that the set of complex numbers + 1, - 1, + i, - i, where i 2 = -1, is a group under multiplication and that it is isomorphic to the group in Problem 4. 8. Prove that the isomorphism property is transitive, that is, if a group G 1 is isomorphic to G2 , and if G2 is isomorphic to G3, then G 1 is isomorphic to G3. 9. Prove that the elements 1, 3, 5, 7 under multiplication modulo 8 form a group that is isomorphic to the group in Problem 5. •to. Prove that there are essentially only two groups of order 4, that is that any group of order 4 is isomorphic to one of the groups in Problems 4 and 5. 2.1 1 Groups, Rings, and Fields 121 11. For any positive integer m > 1, separate all integers into classes C0 , C1, . · ·,Cm - l • putting integers r and s into the same class if r = s (mod m), thus C0 : · ·· , - 2m ,- m,O,m ,2m, · · · C1 : ··· ,-2m + 1, - m + 1, 1, m + 1, 2m + 1, · · · etc . Prove that if any two integers, one from class Ca and one from class Cb, are added, the sum is always an integer in a unique class, namely, either ca +b or ca +b -m according as a + b < m or a + b � m. Define the sum Ca + Cb = Ca +b or Ca + Cb = Ca +b -m accordingly, and prove that these classes form a group under this addition. Prove that this group is isomorphic to the additive group modulo m. 2.1 1 GROUPS, RINGS, AND FIELDS Theorem 2.47 Let m > 1 be a positive integer. Any reduced residue system modulo m is a group under multiplication modulo m. The group is of order </J(m). Any two such groups are isomorphic, so we speak of the multiplicative group modulo m, denoted by Rm . Proof Let us consider any reduced residue system r1 , r2 , • • ·, rn where n = <!J(m). This set is closed under multiplication modulo m by Theorem 1.8. The associative property of multiplication is inherited from the corre­ sponding property for integers, because a(bc) = (ab)c implies that a(bc) = (ab)c (mod m). The reduced residue system contains one element, say ri, such that ri = 1 (mod m), and this is clearly the unique identity element of the group. Finally, for each r;, the congruence xr; = ri (mod m) has a solution by Theorem 2. 17, and this solution is unique within the reduced residue system r1 , r2, • • · , rn. Two different reduced residue sys­ tems modulo m are congruent, element by element, modulo m, and so we have an isomorphism between the two groups. Notation We have been using the symbol e for the binary operation of the group, and we have found that in particular groups e may represent addition or multiplication or some other operation. In dealing with general groups it is convenient to drop the symbol e, just as the dot representing ordinary multiplication is usually omitted in algebra. We will write ab for a e b, abc for a e (b e c) = (a e b) e c, a 2 for a e a, a3 for a e (a e a), and so forth. Also, abed can be written for (a e b e c) e d = 122 Congruences (a e b) e (c e d) and so forth, as can be seen by applying induction to the associative law. We shall even use the word multiplication for the operation e, but it must be remembered that we do not necessarily mean the ordinary multiplication of arithmetic. In fact, we are dealing with general groups so that a need not be a number, just an abstract element of a group. It is convenient to write a0 for e, a - 2 for (a - 1 )2, a - 3 for (a - 1)3, and so on. It is not difficult to show that am . an = am +n and (am)n = amn are valid under this definition, for all integers m and n. Theorem 2.48 In any group G, ab = ac implies b = c, and likewise ba = ca implies b = c. If a is any element of a finite group G with identity element e, then there is a unique smallest positive integer r such that a' = e. Proof The first part of the theorem is established by multiplying ab = ac on the left by a - 1, thus a - 1(ab) = a- 1(ac), (a - 1a)b = (a - 1a)c, eb = ec, b = c. To prove the second part, consider the series of elements obtained by repeated multiplication by a, Since the group is finite, and since the members of this series are elements of the group, there must occur a repetition of the form as = a1 with, say, s < t. But this equation can be written in the form ase = asar -s, whence ar-s = e. Thus there is some positive integer, t - s, such that ar -s = e and the smallest positive exponent with this property is the value of r in the theorem. Definition 2.1 1 Let G be any group, finite or infinite, and a an element of G. If as = e for some positive integer s, then a is said to be of finite order. If a is of finite order, the order of a is the smallest positive integer r such that a' = e. If there is no positive integer s such that as = e, then a is said to be of infinite order. A group G is said to be cyclic if it contains an element a such that the powers of a comprise the whole group; such an element a is said to generate the group and is called a generator. Consider the multiplicative group Rm of reduced residues (mod m) in Theorem 2.47. For which positive integers m is this a cyclic group? This question is equivalent to asking for the values of m for which a primitive root (mod m) exists, because a primitive root (mod m) can serve as a generator of a cyclic group, and if there is no primitive root, there is no 2. 1 1 Groups, Rings, and Fields 123 generator. Hence by Theorem 2.41 we conclude that Rm is cyclic if and only if m = 1, 2, 4, pa or 2pa, where p is an odd prime. Theorem 2.48 shows that all the elements of a finite group are of finite order. Every group, finite or infinite, contains at least the single element e that is of finite order. There are infinite groups consisting entirely of elements of finite order. If a cyclic group is finite, and has generator a, then the group consists of e, a, a2, a3, - · ·, a' - 1, where r is the order of the element a. All other powers of a are superfluous because they merely repeat these. Theorem 2.49 The order of an element of a finite group G is a divisor of the order of the group. If the order of the group is denoted by n, then an = e for every element a in the group. Proof Let the element a have order r. It is readily seen that ( A) are r distinct elements of G. If these r elements do not exhaust the group, there is some other element, say b2• Then we can prove that ( B ) are r distinct elements, all different from the r elements of A. For in the first place if b2a5 = b2at, then a• = at by Theorem 2.48. And on the other hand, if b2a5 =at, then b2 = at-s, so that b2 would be among the powers of a. If G is not exhausted by the sets A and B, then there is another element b3 that gives rise to r new elements all different from the elements in A and B, by a similar argument. This process of obtaining new elements b2, b3, · · · must terminate since G is finite. So if the last batch of new elements is, say then the order of the group G is kr, and the first part of the theorem is proved. To prove the second part, we observe that n = kr and a' = e by Theorem 2.48, whence an =e. 124 Congruences It can be noted that Theorem 2.49 implies the theorems of Fermat and Euler, where the set of integers relatively prime to the modulus m is taken as the group. In making this implication, you will see the necessity of translating the language and notation of group theory into that of number theory. In the same way we note that the language of Definition 2.7, that \"a belongs to the exponent h modulo m,\" is translated into group theoretic language as \"the element a of the multiplicative group modulo m has order h.\" Also the \"primitive root modulo m\" of Definition 2.8 is called a \"generator\" of the multiplicative group modulo m in group theory. Let G and H be two groups. We may define a multiplication on the ordered pairs (g, h) by setting (g1, h1) • (g2, h2) = (g1 g2, h1h2) where it is assumed that the gi and h; lie in G and H, respectively. The ordered pairs, equipped with multiplication in this way, form a group G ® H, called the direct product of G and H. We may similarly form the direct product G ® H ® J of three groups by considering the ordered triples (g, h, j). It is a general theorem of group theory (which we do not prove here) that any finite abelian group is isomorphic to a direct product of cyclic groups. In the case of the multiplicative group Rm of reduced residues (mod m), we can explicitly determine this decomposition. Let m = Pi1P'? · · · P:' be the c�.nonical factorization of m. By the Chinese Remainder Theorem we see that After Definition 2.1 1 we noted that if p is an odd prime then R Pa is cyclic. It is easy to see that two cyclic groups are isomorphic if and only if they have the same order. Thus we speak of \"the\" cyclic group of order n, and denote it by Cn. In this notation, we would write RPa � C<t><Pa> for an odd prime p. For the prime 2 we have R2 � C1 , R4 � C2, and by Theorem 2.43 we see that R2a � C2 ® C2a-z for a ;;;. 3. The ideas we used to prove Theorem 2.41 can be used to show, more generally, that a direct product G1 ® G2 ® · · · ® G, of several groups is cyclic if and only if each G; is cyclic and the orders of the G; are pairwise relatively prime. Definition 2.12 A ring is a set of at least two elements with two binary operations, e and 0, such that it is a commutative group under e , is closed under 0, and such that 0 is associative and distributive with respect to e . The identity element with respect to e is called the zero of the ring. If all the elements of a ring, other than the zero, fonn a commutative group under 0, then it is called a field. 2. 11 Groups, Rings, and Fields 125 It is customary to call e addition and 0 multiplication and to write a + b for a e b, ab for a 0 b. The conditions on 0 for a ring are then a(bc) = (ab)c, a(b + c) = ab + ac, (b + c)a = ba +ca. In general, the elements a, b, c, · · · are not necessarily numbers, and the operations of addition and multiplication need not be the ordinary ones of arithmetic. However, the only rings and fields that will be considered here will have numbers for elements, and the operations will be either ordinary addition and multiplication or addition and multiplication modulo m. Theorem 2.50 The set Zm of elements 0, 1, 2, · · ·, m - 1, with addition and multiplication defined modulo m, is a ring for any integer m > 1. Such a ring is a field if and only if m is a prime. Proof We have already seen in Theorem 2.46 that any complete residue system modulo m is a group under addition modulo m. This group is commutative, and the associative and distributive properties of multiplica­ tion modulo m are inherited from the corresponding properties for ordinary multiplication. Therefore Zm is a ring. Next, by Theorem 2.47 any reduced residue system modulo m is a group under multiplication modulo m. If m is a prime p, the reduced residue system of ZP is 1, 2, · · ·, p - 1, that is, all the elements of ZP other than 0. Since 0 is the zero of the ring, ZP is a field. On the other hand if m is not a prime, then m is of the form ab with 1 < a .,;;; b < m. Then the elements of Zm other than 0 do not form a group under multiplication modulo m because there is no inverse for the element a, no solution of ax = 1 (mod m). Thus Zm is not a field. Some questions can be settled very readily by using the fields ZP. For example, consider the following problem: prove that for any prime p > 3 the sum 1 + 2 (p - 1) if written as a rational number a /b has the property that pia. In the field ZP the term 1/j2 in the SUm is r 2 or x2 where X is the least positive integer such that xj = 1 (mod p). Hence in ZP the problem can be put in the form, prove that the sum 1- 2 + 2 - 2 + .. . +(p - n- 2 is the zero element of the field. But the inverses of 1, 2, 3, · · ·, p - 1 are just the same elements again in some order, so we can write 126 Congruences For this final sum there is a well-known formula for the sum of the squares of the natural numbers giving p( p - 1X2p - l)j6. But this is zero in ZP, because of the factor p, except in the cases p = 2 and p = 3 where division by 6 is meaningless. PROBLEMS 1. Prove that the multiplicative group modulo 9 is isomorphic to the additive group modulo 6. 2. Prove that the additive group modulo m is cyclic with 1 as generator. Prove that any one of cf>(m) elements could serve as generator. 3. Prove that any two cyclic groups of order m are isomorphic. 4. Prove that the group of all integers under addition is an infinite cyclic group. 5. If a is an element of order r of a group G, prove that ak = e if and only if rlk. 6. What is the smallest positive integer m such that the multiplicative group modulo m is not cyclic? 7. A subgroup S of a group G is a subset of elements of G that form a group under the same binary operation. If G is finite, prove that the order of a subgroup S is a divisor of the order of G. 8. Prove Theorem 2.49, for the case in which the group is commutative, in a manner analogous to the proof of Theorem 2.8. 9. Prove Theorem 2.8 by the method used in the proof of Theorem 2.49. 10. Let G consist of all possible sequences (a1, a2, a3, • • • ) with each a; = 1 or - 1. Let (a1 , a 2 , a 3, • • • ) e (b 1, b2 , b3, • • • ) = (a1b1, a2b2, a3b3, • • • ). Show that G is an infinite group all of whose elements are of finite order. •n. Let G consist of a, b, c, d, e, f and let e be defined by the following table. ED e a b c d f e e a b c d f a a e d f b c b b f e d c a c c d f e a b d d c a b f e f f b c a e d 2.1 1 Groups, Rings, and Fields Show that G is a noncommutative group. 127 12. Prove that the multiplicative group modulo p is cyclic if p is a prime. 13. Exhibit the addition and multiplication tables for the elements of the field of residues modulo 7. 14. Prove that the set of all integers under ordinary addition and multi­ plication is a ring but not a field. 15. Prove that the set of all even integers under ordinary addition and multiplication is a ring. 16. Prove that the set 0, 3, 6, 9 is a ring under addition and multiplication modulo 12. 17. Prove that in any field aO = Oa = 0 for every element a . *18. Let a be a divisor of m, say m = aq with 1 < a < m. Prove that the set of elements 0, a, 2a, 3a, · · ·, (q - l)a , with addition and multipli­ cation modulo m, forms a ring. Under what circumstances is it a field? 19. Prove that the set of all rational numbers forms a field. 20. An integral domain is a ring with the following additional properties: (i) there is a unique identity element with respect to multiplication; (ii) multiplication is commutative; (iii) if ab = ac and a * 0, then b = c. Prove that any field is an integral domain. Which of the following are integral domains? (a) the set of all integers; (b) the set Zm of Theorem 2.50. 21. Let m be a positive integer and consider the set of all the divisors of m. For numbers in this set define two operations 0 and e by a 0 b = (a, b), a e b = [a, b ], g. c. d. and l.c.m. Prove that 0 and e are associative and commutative. Prove the distributive law a 0 (b e c) = (a 0 b) e (a 0c) and its dual a e (b 0c) =(a e b)0(a e c). Show that a 0 a = a e a = a. Also prove 1 0a = 1 and 1 e a = a, so that 1 behaves like an ordinary zero, and m 0 a = a, and m e a = m. Define a relation @ as a@b if a 0 b = a . Prove a@a, that @ is transitive, and that a@b if and only if a e b = b. Prove that if m is not divisible by any square other than 1, then corresponding to each divisor a there is a divisor a' such that a 0 a' = 1, a e a' = m. (These algebras with square-free m are examples of Boolean algebras.) 22. Prove that for any prime p > 2 the sum 1 1 1 -+- + .. ·+ ----=- 13 23 (p -1 ) 3 if written as a rational number ajb, has the property that p i a. (H) 128 Congruences •23. Let vn denote the vector space of dimension n over the field z p of integers modulo p. Show that if W is a subspace of Vn of dimension m, then card (W) = pm. Show that the number of n X n matrices A with entries considered (mod p) for which det (A) � 0 (mod p) is exactly (pn - 1X pn - PXPn - p2) .. . ( pn - pn - l ). (H) NOTES ON CHAPTER 2 §2.1 It was noted in this section that (i) a = a (mod m ), (ii) a = b (mod m) if and only if b =a (mod m), and (iii) a = b (mod m ) and b = c (mod m) imply a = c (mod m). Thus the congruence relation has the (i) reflexive property, (ii) the symmetric property, and (iii) the transitive property, and so the congruence relation is a so-called equivalence relation . Although the classification of integers by the remainder on division by a fixed modulus goes back at least as far as the ancient Greeks, it was Gauss who introduced the congruence notation. §2.3 It is often observed of mathematics that there are far more theorems than ideas. The idea used in the proof of Theorem 2. 18 is found in many other contexts. For example, Lagrange constructed a polynomial of degree at most n that passes through the n + 1 points (x0, y0), (x1 , y1), • • ·, (xn , Yn) by first constructing the polynomials lj( x ) = ( x- x0 )(x - x1 ) · · • ( x - xj _ 1 )(x - xj + t ) · · · ( x - xn ) ' (xj - x0 ) (xj - x 1 ) • · · (xj - xj _ 1 )( xj - xj + t ) · · · (xj - xn ) which have the property that lj(x) = 1, lj(x;) = 0 for i * j. Here we are assuming that the xj are distinct. Then n P ( x) = E Yjlj( x ) j � O is a polynomial with the desired properties. (This polynomial P( x) is unique. To see this, suppose that Q( x) is another such polynomial. Then the polynomial R(x ) = P( x) - Q( x) has degree at most n and vanishes at the n + 1 points xj. But a polynomial that has more zeros than its degree must vanish identically. Thus P( x) and Q( x) are identical.) The less symmetric procedure applied in Example 4 is similarly analogous to the Hermite formula for polynomial interpolation, by which a polynomial is written in the form n j -1 P( X ) = L cj n ( X - x;) . j � I ;� I Notes on Chapter 2 129 (When j = 1 there is no i within the prescribed range, and the resulting empty product is taken to have value 1.) We see that P(x 1) = c., P(x2) = c1 + c2(x2 - x 1), P(x3) = c1 + c2(x3 - x 1) + c3(x3 - x1Xx3 - x2), and so on. Thus we may take c1 so that P(x 1) has the desired value. Having chosen c1, we may take c2 so that P(x2) has the desired value, and so on. This may be compared with Problem 24 at the end of the section. §2.4 Readers interested in the numerical aspects of number theory may wish to consult the text by Rosen listed in the General References at the end of this book. Number-theoretic algorithms are discussed by D. H. Lehmer, \"Computer Technology Applied to the Theory of Numbers,\" pages 117-151 in the book edited by LeVeque; in Chapter 4 of Volume 2 of Knuth; and in the book edited by Lenstra and Tijdeman. Many of the algorithms that we have discussed can be made more efficient in various ways. For example, when factoring by trial division, one may restrict the trial divisors to prime values. Before 1970, trial division was essentially the fastest factoring method known. Since then, improved algorithms have been invented that allow us to factor much larger numbers than we could formerly. Some of these algorithms involve quite sophisticated mathematics, as in the case of the elliptic curve method of Hendrik Lenstra, which we discuss in Section 5.8. The fastest general-purpose factoring algorithm known today is the quadratic sieve, proposed by Carl Pomerance in 1982. Using it, te Riele factored a 92-digit number in 1988. Using the same amount of time on the same machine, but with trial division instead of the quadratic sieve, one would expect to be able to factor numbers only up to 29 digits. Twenty years earlier, the IBM 360/91 was the fastest computer. If one substituted this earlier machine for the NEC SX/2 that te Riele used, then in the same time one might factor a 25 digit number by trial division and a 73 digit number by the quadratic sieve. Thus we see that the new algorithms have had a much greater impact on factoring than the improvements in the hardware. Further discussion of factoring techniques may be found in the lecture notes of Carl Pomerance and in the book by Hans Riesel, both listed in the General References, and also in the survey article \"How to factor a number,\" by R. K. Guy, in Proc. Fifth Manitoba Conf. Numer. Math., Utilitas, Winnipeg (1975), 49-89. §2.5 The permutation used here is known as a trapdoor function because of the difficulty of computing the inverse permutation. The particular method discussed is known as the RSA method, after Rivest, Shamir, and Adleman, who proposed the method in 1978. §2.6 In our appeal to Taylor's theorem we have again made a small use of analysis. A more extensive use of analysis is found in Section 8.2, where we investigate arithmetic functions by means of Dirichlet series. Analysis of a somewhat different variety is used in proofs of irrationality or 130 Congruences transcendence. A simple example of this is found in our proof that 7T is irrational, in Section 6.3. The study of congruences (mod pk) leads naturally to the theory of p-adic numbers. Solutions of a congruence that lift to arbitrarily high powers of p correspond to the p-adic roots of the equation. The sequence of solutions of the congruence generated by letting n run to infinity form a sequence of approximations to the p-adic root in much the same way that truncations of the decimal expansion of a real number form approxima­ tions to the real number being expanded. An attractive introduction to p-adic numbers is found in Chapter 1 of the text by Borevich and Shafarevich. §2.7 Let f(x) be a fixed polynomial with integral coefficients. The number N( p) of solutions of the congruence f(x) = O(mod p) fluctuates as p varies, but it can be shown that if f is irreducible then Ep .;.x N(p) ­ xjlog x as x --. oo. This is derived from the prime ideal theorem, which is a generalization of the prime number theorem to algebraic number fields. The discussion of the polynomial f(x) in (2.7) can be generalized to composite moduli. This generalization, which is by no means obvious, was discovered by Bauer in 1902. Accounts of Bauer's congruence are found in §§8.5 -8.8 of the book by Hardy and Wright, and in articles by Gupta and Wylie, J. London Math. Soc., 14 (1939). §2.8 In 1769, Lambert stated without proof that every prime number has a primitive root. Euler introduced the term primitive root, but his proof of their existence is flawed by gaps and obscurities. Our account, based on Lagrange's result Corollary 2.29, is similar to the method proposed by Legendre in 1785. For further discussion of methods of proving primality, see the article \" Primality testing\" in Lenstra and Tijdeman, H. C. Williams, \"Primality testing on a computer,\" Ars Combinatoria 5 (1978), 127-185, or Chapter 4 of Riesel. The original account of Atkin's method of proving primality is found in the paper of A. 0. L. Atkin and F. Morain, \"Elliptic curves and primality proving,\" Math. Comp., to appear. The method is briefly de­ scribed in A. K. Lenstra and H. W. Lenstra, Jr., \"Algorithms in number theory\" in Handbook of Theoretical Computer Science (ed. J. van Leeuwen), North-Holland, to appear. §2.9 The algorithm RESSOL was invented and named by Dan Shanks, \"Five number-theoretic algorithms,\" (Proc. Second Manitoba Con­ ference on Numerical Mathematics (1972), 51 -70). A similar algorithm for determining u so that n = cu (mod p ), had been given in 1891 by Tonelli. D. H. Lehmer (\"Computer technology applied to the theory of numbers,\" Studies in Number Theory, (W. J. LeVeque, ed.), Math. Assoc. Amer. (1969), 117-151) has given a different algorithm for finding solutions of quadratic congruences. CHAPTER 3 Quadratic Reciprocity and Quadratic Forms The purpose of this chapter is to continue the discussion of congruences by means of a remarkable result of Gauss known as the quadratic reciprocity law. In the preceding chapter, the problem of solving such a congruence as x 2 =a (mod m) was reduced to the case of a prime modulus p. The question remains as to whether x 2 = a (mod p) does or does not have a solution. This question can be narrowed to the case x 2 = q (mod p), where q is also a prime. The quadratic reciprocity law states that if p and q are distinct odd primes, the two congruences x 2 = p (mod q) and x 2 = q (mod p) are either both solvable or both not solvable, unless p and q are both of the form 4k + 3, in which case one of the congruences is solvable and the other is not. This result might appear at first glance to be of very limited use because of the conditional nature of the statement; it is not crisply decisive. However, the result provides a reduction process that enables us to determine very quickly whether x 2 = q (mod p) is or is not solvable for any specified primes p and q. As an example of the remarkable power of the quadratic reciprocity law, consider the question whether x 2 = 5 (mod 103) has any solutions. Since 5 is not of the form 4k + 3, the result asserts that x 2 = 5 (mod 103) and x 2 = 103 (mod 5) are both solvable or both not. But x 2 = 103 (mod 5) boils down to x 2 = 3 (mod 5), which has no solutions. Hence x 2 = 5 (mod 103) has no solutions. 3.1 QUADRATIC RESIDUES Definition 3.1 For all a such that (a, m) = 1, a is called a quadratic residue modulo m if the congruence x 2 = a (mod m) has a solution . If it has no solution , then a is called a quadratic nonresidue modulo m. 131 3. 1 Quadratic Residues 133 To each j satisfying 1 <:,. j < p, choose j', 1 <:,. j' < p, so that jj' = a (mod p). We pair j with j'. We note that j ¥; j' (mod p), since the congruence x 2 = a(mod p) has no solution. The combined contribution of j and j' to (p - 1)! is Ji' =a (mod p). Since there are (p - 1)/2 pairs j, j', it follows that a<P- 1>12 = (p - 1)! (mod p ), and then Wilson's congru­ ence gives Part 1. The last part of the theorem, which follows immediately from the first part, expresses again the information provided in Theorem 2.12. Theorem 3.2 Lemma of Gauss. For any odd prime p let (a, p) = 1. Consider the integers a, 2a, 3a, · · ·, {( p - 1)/2}a and their least positive p residues modulo p. If n denotes the number of these residues that exceed 2, then ( �) = ( - 1)\". Proof Let r1, r2, - • ·, rn denote the residues that exceed p /2, and let s1, s2, • • ·, sk denote the remaining residues. The r; and s; are all distinct, and none is zero. Furthermore, n + k = (p - 1)/2. Now 0 < p- r; < p j2, i = 1, 2, · · · , n, and the numbers p - r; are distinct. Also no p - r; is an sj for if p- r; = sj then r; = pa, sj = ua (mod p) for some p, u, 1 <:,. p <:,. (p - 1) ;2, 1 <:,. u <:,. (p - 1) ;2, and p - pa = ua (mod p ). Since (a, p) = 1 this implies a(p + u) = 0, p + u = 0 (mod p ), which is impos­ sible. Thus p - r1, p - r2,- · · , p - rn, s 1, s2, - • ·, sk are all distinct, are all at least 1 and less than pj2, and they are n + k = (p - 0/2 in number. That is, they are just the integers 1, 2, · · ·, (p - 1) /2 in some order. Multiplying them together we have and then n P - 1 ( -1) r r · .. r s s .. · s = 1 · 2 .. · -- (mod p) 1 2 n1 2 k 2 ' n p-1 p - 1 ( - 1) a · 2a · 3a · · · - 2-a = 1 · 2 . . · - 2- (mod p) . We can cancel the factors 2, 3, - · ·,(p - 1)/2 to obtain (- 1)\"a<P- 1l/2 = 134 Quadratic Reciprocity and Quadratic Forms 1 (mod p) which gives us ( - l)n = a< P - 1>12 = ( ; ) (mod p) by Theorem 3.1, part 1. Definition 3.3 For real x, the symbol [x] denotes the greatest integer less than or equal to x. This is also called the integral part of x, and x- [x] is called the fractional part. Such an integer as [1000/23] is the quotient when 1000 is divided by 23 and is also the number of positive multiples of 23 less than 1000. On a hand calculator, its value, 43, is immediately obtained by dividing 1000 by 23 and taking the integer part of the answer only. Here are further examples: [15 /2] = 7, [ -15 /2] = -8, [ -15] = -15. Theorem 3.3 If p is an odd prime and (a, 2 p) = 1, then ( a ) (p - 1)/2[ ja ] -P = ( - 1 f where t = L - ; also j - 1 p Proof We use the same notation as in the proof of Theorem 3.2. The r; and s; are just the least positive remainders obtained on dividing the integers ja by p, j = 1, 2, - · ·, (p - 1) /2. The quotient in this division is easily seen to be q = [jajp]. Then for (a, p) = 1, whether a is odd or even, we have and ( p- 1)/2 (p- 1)/2 [ ja ] n k I: ja = I: P - + I: rj + I: sj j= 1 j= 1 p j= 1 j= 1 (p- 1)/2 n k n k L j = L ( p - rj ) + L sj = np - L rj + L sj j= 1 j= 1 j= 1 j= 1 j= 1 and hence by subtraction, But (a - 1 ) I: i = P I: - - n + 2 I: rj . (p- 1)/2 ( (p- 1)/2 [ ja ] ) n j= 1 j - 1 p j= 1 (p - 1)/2 p2 - 1 I: i = 8 j= 1 3.1 Quadratic Residues 135 so we have If a is odd, this implies n = <PE12 [ ja ] (mod 2). If a = 2 it implies j=l p n = (p2 - 1) /8 (mod 2) since [2j jp] = 0 for 1 <:.. j <:.. (p - 1) /2. Our the­ orem now follows by Theorem 3.2. Although Theorem 3.2 and the first part of Theorem 3.3 are of considerable importance in theoretical considerations, they are too cum­ bersome to use for calculations unless p is very small. However, Theorems 3.1 and the other parts of 3.3 are useful in numerical cases. The second part of Theorem 3.3 involves ( -l)<P2-I)/B, and this can be easily computed if p is reduced modulo 8. For example, if p = 59 then p = 3 (mod 8) and ( -1)<P2-l)/B = ( -1)<32-1>18• Finally, we point out that the problem of numerical evaluation of ( � ) , apart from the cases a = ± 1, ± 2, is treated in the next section. PROBLEMS 1. Find [3 /2], [- 3 /2], [ '7T ], [ -7], and [x] for 0 <:.. x < 1. 2. With reference to the notation of Theorem 1 .2 prove that q = [ b I a]. 3. Prove that 3 is a quadratic residue of 13, but a quadratic nonresidue of 7. 4. Find the values of ( �) in each of the 12 cases, a = -1 , 2, - 2, 3 and p = 11, 13, 17. 5. Prove that the quadratic residues of 11 are 1, 3, 4, 5, 9, and list all solutions of each of the ten congruences x 2 = a (mod 11) and x 2 = a(mod 112)where a= 1, 3,4,5,9. 6. (a) List the quadratic residues of each of the primes 7, 13, 17, 29, 37. (b) For any positive integer n, define F(n) to be the minimum value of ln 2 - 17xl, where x runs over all integers. Prove that F(n) is either 0 or a power of 2. 7. Which of the following congruences have solutions? How many? (a) x 2 = 2 (mod 61) (b) x 2 = 2(mod 59) (c) x 2 = -2(mod 61) (d) x 2 = -2 (mod 59) 136 Quadratic Reciprocity and Quadratic Forms (e) x2 = 2(mod 122) (f) x 2 = 2(mod 118) {g) x 2 = -2 {mod 122) {h) x 2 = -2 {mod 118). 8. How many solutions are there to each of the congruences? (a) x2 = -l {mod 60 (b) x 2 = -l {mod 59) (c) x 2 = -l (mod 365) (d) x 2 = -l {mod 3599) {e) x2 = -1 (mod 122) (f) x 2 = -1 (mod 244) 9. Let p be a prime, and let (a, p) = (b, p) = 1. Prove that if x 2 = a (mod p) and x 2 = b (mod p) are not solvable, then x 2 = ab (mod p) is solvable. 10. Prove that if p is an odd prime then x 2 = 2(mod p) has solutions if and only if p = 1 or 7 (mod 8). 11. Let g be a primitive root of an odd prime p. Prove that the quadratic residues modulo p are congruent to g2, g\\ g6, - · · , gP - l and that the nonresidues are congruent to g, g3, g5, · · · , gP- 2. Thus there are equally many residues and nonresidues for an odd prime. 12. Denote quadratic residues by r, nonresidues by n. Prove that r1r2 and n 1n 2 are residues and that m is a nonresidue for any odd prime p. Give a numerical example to show that the product of two nonresidues is not necessarily a quadratic residue modulo 12. 13. Prove that if r is a quadratic residue modulo m > 2, then r.P<m>l2 = 1 (mod m). (H) 14. Prove that the quadratic residues modulo p are congruent to 12, 22, 32, · · · , {(p - 0/2}2, where p is an odd prime. Hence prove that if p > 3, the sum of the quadratic residues is divisible by p. (H) 15. Show that if p is a prime of the form 4k + 1 then the sum of the quadratic residues (mod p) in the interval [1, p) is p( p - 0/4. *16. Show that if a is a quadratic residue modulo m, and ab = 1 (mod m), then b is also a quadratic residue. Then prove that the product of the quadratic residues modulo p is congruent to + 1 or - 1 according as the prime p is of the form 4k + 3 or 4k + 1. *17. Prove that if p is a prime having the form 4k + 3, and if m is the number of quadratic residues less than p j2, then 1 · 3 · 5 · · · (p - 2) = (- Om +k+ l (mod p), and 2 · 4 · 6 ··· (p - 1) = ( - om +k (mod p). (H) *18. For any prime p and any integer a such that (a, p) = 1, say that a is a cubic residue of p if x 3 = a (mod p) has at least one solution. Prove that if p is of the form 3k + 2, then all integers in a reduced residue system modulo p are cubic residues, whereas if p is of the form 3k + 1, only one-third of the members of a reduced residue system are cubic residues. 3. 2 Quadratic Reciprocity 137 *19. For all primes p prove that x8 = 16 (mod p) is solvable. (H) *20. Let p be an odd prime. Prove that if there is an integer x such that pl(x2 + 1) then p = 1 (mod 4) ; P l(x2 - 2) then p = 1 or 7 (mod 8) ; pl(x2 + 2) then p = 1 or 3 (modS); Pl(x4 + 1) then p = 1 (mod 8). Show that there are infinitely many primes of each of the forms Bn + 1, Bn + 3, Bn + 5, Bn + 7. (H) *21. Let p be an odd prime. Prove that every primitive root of p is a quadratic nonresidue. Prove that every quadratic nonresidue is a primitive root if and only if p is of the form 2 2\" + 1 where n is a non-negative integer, that is, if and only if p = 3 or p is a Fermat number. *22. Show that if p and q are primes, p = 2q + 1, and 0 < m < (p + 1)112, then m is a primitive root (mod p) if and only if it is a quadratic nonresidue (mod p ). *23. Show that if p is an odd prime and (a, p) = 1, then x2 =a (mod pa) has exactly 1 + (;) solutions. *24. Suppose that m is an odd number. Show that if (a, p) = 1 then the number of solutions of the congruence x2 = a (mod m) is Q ( 1 + (;)) . Show that this holds for all integers a if m is an odd square-free number. 3.2 QUADRATIC RECIPROCITY Theorem 3.4 The Gaussian reciprocity law. If p and q are distinct odd primes, then ( � )( �) = ( - 1){(p- l)j2){(q- l)j2). Another way to state this is: If p and q are distinct odd primes of the form 4k + 3, then one of the congruences x2 = p(mod q) and x2 = q (mod p) is solvable and the other is not; but if at least one of the primes is of the form 4k + 1, then both congruences are solvable or both are not. 3. 2 Quadratic Reciprocity 139 ( - 42 ) Hence 61 = 1. This computation demonstrates a number of different sorts of steps; it was chosen for this purpose and is not the shortest possible. A shorter way is ( -42 ) = ( 19 ) = ( 61 ) . 1 = ( �) = 1 61 61 19 19 . One could also obtain the value of 61 by use of Theorem 3.2 or ( - 42 ) the first part of Theorem 3.3, but the computation would be considerably longer. There is another kind of problem that is of some importance. As an example, let us find all odd primes p such that 3 is a quadratic residue modulo p. We have (;) = ( � ) ( -1 )(p- l)f2, m �{(�J � � if p = 1 (mod 3) h-) = - 1 if p = 2 (mod 3) , and ( -1 )(p - l)j2 = { 1 if p = 1 (mod 4) -1 if p = 3 (mod 4) . Thus {;) = 1 if and only if p = 1 (mod 3), p = 1 (mod 4), or p = 2(mod 3), p = 3(mod 4); that is p = 1 or ll (mod 12). Just as we determined which primes have 3 as a quadratic residue, so for any odd prime p we can analyze which primes have p as a quadratic residue. This is done in effect in the following result. Theorem 3.5 Let p be an odd prime. For any odd prime q > p let r be determined as follows. First if p is of the form 4n + 1, define r as the least positive remainder when q is divided by p; thus q = kp + r, 0 < r < p. Next if P is of the form 4n + 3, there is a unique r defined by the relations q = 4kp ± r, 0 < r < 4p, r = 1(mod 4). Then in both cases ( � )= (� ) · 148 Quadratic Reciprocity and Quadratic Forms 6. For any prime p of the form 4k + 3, prove that x 2 + (p + D/4 = 0 (mod p) is not solvable. 7. For which primes p do there exist integers x and y with ( x, p) = 1, (y, p) = 1, such that x 2 + y 2 = O(mod p)? 8. For which prime powers pa do there exist integers x and y with ( x , p) = 1, (y, p) = 1, such that x 2 + y 2 = O(mod p0)? 9. For which positive integers n do there exist integers x and y with ( x, n) = 1, (y, n) = 1, such that x 2 + y 2 = O (mod n)? 10. Let k be odd. Prove that x 2 = k (mod 2) has exactly one solution. Furthermore, x 2 = k (mod 2 2) is solvable if and only if k = 1 (mod 4), in which case there are two solutions. 11. Let a be odd, and suppose that a � 3. Prove that x 2 = a (mod 2a) has 4 solutions or no solution, according as a = 1 (mod 8) or not. Show that if x0 is one solution, then the other three are -x0 , x0 ± 2a - 1. {H) 12. Consider the congruence x 2 = a (mod pa) with p a prime, a � 1, a = pf3b, (b, p) = 1 . Prove that if {3 � a then the congruence is solvable, and that if {3 < a then the congruence is solvable if and only if {3 is even and x 2 = b (mod pa-f3) is solvable. *13. Let the integers 1, 2, · · · , p - 1 modulo p, p an odd prime, be divided into two nonempty sets ../1 and ../2 so that the product of two elements in the same set is in ../1, whereas the product of an element of ../1 and an element of ../2 is in ../2. Prove that ../1 consists of the quadratic residues, ../2 of the nonresidues, modulo p. (H) *14. Suppose that p is a prime, p = 1 (mod 4), and that a2 + b2 = p with a odd and positive. Show that ( ;) = 1. *15. Suppose that pis a prime, p � 7. Show that (;) = ( n ; 1 ) = 1 for at least one number n in the set {1, 2, · · · , 9}. {H) *16. Prove that if (a , p) = 1 and p is an odd prime, then E ( an + b ) = O. n - 1 P *17. Let p be an odd prime, and put s(a , p) = E (n(n + a) )· Show n = 1 p p that s(O, p) = p - 1. Show that :[ s(a, p) = 0. Show that if a� 1 150 Quadratic Reciprocity and Quadratic Forms a d2 1 = -1 for some j, 0 � j < k). Show that if m = 65 then 8 E elf' and 18 e elf', but that 8 · 18 = 14 e= elf'. (Thus elf' is not a group for this m.) *25. Let m be an odd positive integer, and let .:# and elf' be defined as in Problems 21 and 24. Show that elf'� .:#. 3.4 BINARY QUADRATIC FORMS A monomial ax�• x�2 · · • x!\" in n variables with coefficient a * 0 is said to have degree k 1 + k2 + · · · + k n . The degree of a polynomial in n variables is the maximum of the degrees of the monomial terms in the · polynomial. A polynomial in several variables is called a fonn, or is said to be homogeneous if all its monomial terms have the same degree. A form of degree 2 is called a quadratic form. Thus the general quadratic form is a sum of the shape n n E E a ijx ixj . i- 1 j- 1 A form in two variables is called binary. The remainder of this chapter is devoted to the study of binary quadratic forms f( x, y ) = ax2 + bxy + cy2 with integral coefficients. Such forms have many striking number-theoretic properties. In Theorem 2.15 we found that the numbers n represented by the quadratic form x2 + y2 can be characterized in terms of the prime factors of n. Using quadratic reciprocity, we now investigate the extent to which Theorem 2.15 can be generalized to other quadratic forms. The discriminant of a binary quadratic form is the quantity d = b2 - 4ac. If d is a perfect square (possibly 0), then f(x, y) can be expressed as a product of two linear forms with integral coefficients, as in the cases xy, or x2 - y2 = (x - yXx + y) or 10x2 - 27xy + 18y2 = (2x - 3yX5x - 6 y ), with discriminants 1, 4, 9, respectively. Conversely, if d is not a perfect square (or 0) then f(x, y) cannot be written as a product of two linear forms with integral coefficients, nor even with rational coefficients. (The proofs of these results are left to the reader in Problems 7-9 at the end of this section.) As the theory develops, we often find it necessary to distinguish between square and nonsquare discriminants. Theorem 3.10 Let f(x, y) = ax2 + bxy + cy2 be a binary quadratic fonn with integral coefficients and discriminant d. If d * 0 and d is not a perfect 3. 4 Binary Quadratic Forms 151 square, then a * 0, c * 0, and the only solution of the equation f(x, y) = 0 in integers is given by x = y = 0. Proof We may presume that a * 0 and c * 0, for if a = 0 or c = 0 then ac = 0 and d = b2 - 4ac = b2, a perfect square. Suppose that x0 and y0 are integers such that f(x0, y0) = 0. If Y o = 0 then ax& = 0, and hence x0 = 0 because a * 0. If x0 = 0, a parallel argument gives y0 = 0. Conse­ quently we take x0 * 0 and y0 * 0. By completing the square we see that 4af( x, y) = (2ax + by )2 - dy2 (3 .3) and hence (2ax0 + by0)2 = dyJ since f(x0, y0) = 0. But dyJ * 0, and it follows by unique factorization that d is a perfect square. The proof is now complete. Definition 3.5 A form f(x, y) is called indefinite if it takes on both positive and negative values. The form is called positive semidefinite (or negative semidefinite) if f(x, y) � 0 (or f(x, y) � 0) for all integers x, y. A semidefi­ nite form is called definite if in addition the only integers x, y for which f(x, y) = 0 are x = 0, y = 0. The form f(x, y) = x2 - 2y 2 is indefinite, since f(l, 0) = 1 and f(O, 1) = -2. The form f(x, y) = x 2 - 2xy + y2 = (x - y)Z is positive semidefinite, but not definite, because f(l, 1) = 0. Finally, x2 + y2 is an example of a positive definite form. We now show that we may determine whether a quadratic form is definite or indefinite by evaluating its discrimi­ nant. Theorem 3.11 Let f(x, y) = ax 2 + bxy + cy2 be a binary quadratic form with integral coefficients and discriminant d. If d > 0 then f(x, y) is indefi­ nite. If d = 0 then f(x, y) is semidefinite but not definite. If d < 0 then a and c have the same sign and f(x, y) is either positive definite or negative definite according as a > 0 or a < 0. Clearly if f is positive definite then -f is negative definite, and conversely. Hence we ignore the negative definite forms, as their proper­ ties follow from those of the positive definite forms. Proof Suppose that d > 0. We note that f(l, 0) = a, and that f(b, - 2a) = -ad. These numbers are of opposite sign unless a = 0. Similarly, f(O, 1) = c and f( - 2c, b) = -cd. These numbers are of opposite sign unless c = 0. It remains to consider the possibility that a = c = 0. Then 152 Quadratic Reciprocity and Quadratic Fonns d = b2 > 0, so that b * 0. In this case f(1, 1) = b and f(l, - 1) = -b, so that f takes values of both signs. Now suppose that d = 0. Consider the possibility that a * 0. Then from (3.3) we see that the nonzero values of f are all of the same sign as a, so f(x, y) is semidefinite. Moreover, f(b, - 2a) = -ad = 0. Since a * 0 in the case under consideration, it follows that f is not definite. Suppose now that a = 0. Then d = b2, and hence b = 0 since d = 0. Thus in this case, f( x, y) == cy 2• Here the nonzero values all have the same sign as c, but f(1, 0) = 0, so the form is not definite. Finally, suppose that d < 0. From (3.3) and Theorem 3.10 we see that 4af(x, y) is positive for all pairs of integers x, y except 0, 0. Thus f is definite. Since f(1, 0) = a and f(O, 1) = c, we deduce in particular that a and c have the same sign, positive for positive definite forms and negative for negative definite forms. (An alternative way to see that a and c have the same sign when d < 0 is provided by noting that 4ac = b2 - d � - d > 0, so that ac > 0.) This completes the proof. We now determine which numbers d arise as discriminants of binary quadratic forms. Theorem 3.12 Let d be a given integer. There exists at least one binary quadratic form with integral coefficients and discriminant d, if and only if d = 0 or 1 (mod 4). Proof Since b2 = 0 or 1 (mod 4) for any integer b, it follows that the discriminant d = b2 - 4ac = 0 or 1 (mod 4). For the converse, suppose first that d = O(mod 4). Then the form x2 - (d/4)y2 has discriminant d. ( d- 1 ) Similarly, if d = 1 (mod 4) then the form x2 + xy - - 4 - y2 has dis- criminant d, and the proof is complete. We say that a quadratic form f(x, y) represents an integer n if there exist integers x0 and y0 such that f(x0, y0) = n. Such a representation is called proper if g.c.d.(x 0, y0) = 1; otherwise it is improper. If f(x0, y0) = n and g.c .d.(x 0 , y0) = g, then g 2 ln, g.c.d.(x0/g, y0jg) = 1, and f(x0jg, y0jg) = njg 2. Thus the representations of n by f(x, y) may be found by determining the proper representations of njg 2 for those integers g such that g 2 ln. Our object in the remainder of this chapter is to describe those integers n represented, or properly represented, by a particular quadratic form. This aim is only partly achieved, but we can determine whether n is represented by some quadratic form of a prescribed discriminant, as follows. 3. 4 Binary Quadratic Forms 153 Theorem 3.13 Let n and d be given integers with n * 0. There exists a binary quadratic form of discriminant d that represents n properly if and only if the congruence x2 = d(mod 4ln l) has a solution. Proof Suppose that b is a solution of the congruence, with b2 - d = 4nc, say. Then the form f(x, y) = nx2 + bxy + cy 2 has integral coefficients and discriminant d. Moreover, f(l, 0) = n is a proper representation of n. Conversely, suppose we have a proper representation f(x0, y0) of n by a form f(x, y) = ax2 + bxy + cy 2 = n with discriminant b2 - 4ac = d. Since g.c.d.(x0, y0) = 1, we can choose integers m1 , m2 such that m1 m2 = 4 l nl, g.c.d.(m 1, y0) = 1 and g.c.d.(m 2 , x0) = 1. For example, take m1 to be the product of those prime-power factors pa of 4n for which plx0, and then put m2 = 4lnl/m 1 • From equation (3.3) we see that 4an = (2 ax0 + by0)2 - dy5, and hence (2 ax0 + by0)2 = dy5 (mod m1 ). As (y0, m 1 ) = 1, there is an integer Y o such that y0y0 = 1 (mod m1 ), and we find that the congruence u2 = d (mod m 1 ) has a solution, namely u = u 1 = (2 ax 0 + by0)y0• We interchange a and c, and also x and y, to see that the parallel congruence u2 = d (mod m2) also has a solution, say u = u2• Then by the Chinese remainder theorem we find an integer w such that w = u 1 (mod m 1 ) and w = u2 (mod m2). Thus w 2 = u� = d (mod m1 ), and similarly w2 = u� = d (mod m2), from which we get w2 = d (mod m 1m2). But this last modulus is 4lnl, so the theorem is proved. Corollary 3.14 Suppose that d = 0 or 1 (mod 4). If pis an odd prime, then there is a binary quadratic form of discriminant d that represents p, if and only if ( *) = 1. Proof Any representation of p must be proper. Hence if p is repre­ sented, then it is properly represented, and thus (by the theorem) d must � a square modulo 4p, so that ( *) = 1. Conversely, if ( *) = 1, then d IS a square modulo p. By hypothesis, d is a square modulo 4. Since p is odd, it follows by the Chinese remainder theorem that d is a square modulo 4p, and hence (by the theorem) p is properly represented by some form of discriminant d, thus completing the proof. Let d be given. By quadratic reciprocity we know that the odd primes P for which ( * ) = 1 are precisely the primes lying in certain residue classes modulo 4 1 d 1. In this way, quadratic reciprocity plays a role in 3. 5 Equivalence and Reduction of Binary Quadratic Forms 155 7. Let a, b, and c be integers with a * 0. Show that if one root of the equation au2 + bu + c = 0 is rational then the other one is, and that b2 - 4ac is a perfect square, possibly 0. Show also that if b2 - 4ac is a perfect square, possibly 0, then the roots of the equation au2 + bu + c = 0 are rational. 8. Show that the discriminant of the quadratic form (h 1x + k1 yXh2x + k2 y) is the square of the determinant I�: �:I· Deduce that if hp h2, k 1, and k2 are all integers then the discriminant is a perfect square, possibly 0. 9. Let f(x, y) = ax2 + bxy + cy 2 be a quadratic form with integral co­ efficients whose discriminant d is a perfect square, possibly 0. Show that there are integers h1 , h2, k1, and k2 such that f(x, y) = (h1 x + k1 yXh2x + k2 y). (H) 10. Let f(x, y) = ax2 + bxy + cy2 be a quadratic form with integral co­ efficients. Show that there exist integers x0, y0, not both 0, such that f(x0, y0) = 0, if and only if the discriminant d of f(x, y) is a perfect square, possibly 0. 3.5 EQUIVALENCE AND REDUCTION OF BINARY QUADRATIC FORMS Let f(x, y) = x 2 + y 2 and g(x, y) = x 2 + 2xy + 2y 2. A quick calculation gives g(x, y) = f(x + y, y) and f(x, y) = g(x- y, y), which implies that these forms represent exactly the same numbers. More precisely, the first identity implies that any number represented by g, such as 34 = g(2, 3), is also represented by f, since f(2 + 3, 3) = g(2, 3) = 34. Conversely, the second identity implies that any number represented by f is represented by g. For purposes of determining which numbers are represented, these forms may therefore be considered to be equivalent. Here we have used the simple fact that the coordinates of the point (x, y) are integers if and only if the coordinates of the point (x + y, y) are integers. A point whose coordinates are integers is called a lattice point. We now determine which linear changes of variable take lattice points to themselves in a one-to-one manner. Theorem 3.15 and put Let M = [ m u m21 : 12 ] be a 2 X 2 matrix with real entries, 22 (3.4) 156 Quadratic Reciprocity and Quadratic Fonns That is, u = m 11 x + m 12 y, v = m 21x + m 22 y. Then the following two asser­ tions are equivalent : (i) the linear transformation (3.4) defines a permutation of lattice points (i.e., lattice points are mapped to themselves in a one-to-one and onto manner); (ii) the matrix M has integral coefficients and det (M) = ± 1. This is analogous to the theorem of linear algebra which asserts that (3.4) defines a permutation of IR2 if and only if det (M) * 0. Proof We first demonstrate that (ii) implies (i). It is clear that if M has integral coefficients then (u, v) is a lattice point whenever (x, y) is a lattice point. For brevity, put a= det (M) = m 11 m 22 - m 12m 21. As a* 0, the inverse matrix M- 1 exists, and Thus if (ii) holds then M- 1 also has integral coefficients, and then the inverse map from lattice points (u, v) to lattice points (x, y) is given by matrix multiplication, Hence the map is one-to-one and onto (i.e., a permutation). Suppose now that (i) holds. Taking the lattice point (x, y) = (1, 0), we find that (3.4) gives (u, v) = (m 11 , m 21 ). Since this must be a lattice point, it follows that m 11 and m 21 must be integers. Taking (x, y) = (0, 1), we find similarly that m 12 and m 22 are integers. It remains to show that det (M) = ± 1. To this end, consider the lattice point (u, v) = (1, 0). From (i) we know that the map (3.4) is onto. Hence there is a lattice point (x 1, y 1 ) such that Similarly, there is a lattice point ( x2, y2 ) such that 3. 5 Equivalence and Reduction of Binary Quadratic Fonns These two relations may be expressed as a single matrix identit\"j, We now recall matrices then [� from linear 0] =M[ xl 1 Y 1 algebra that X2] Y2 . if M and det (MN) = det (M ) det (N). N are two 157 (3.5) nX n (3.6) (In the present section we require only the case n = 2, which may be verified by checking that (m 11n 11 + m 12n21 )(m21 n 12 + m 22 n22 ) - <m21 n 11 + m 22n 21 Xm un 12 + m 12n 22 ) = (m um 22 - m 21m 1 2Xn un 22 - n 21n 12 ) is a valid algebraic identity.) Applying this to (3.5), we find that 1 = det (MXx 1 y 2 - x2 y 1 ). Here both factors are integers because the matrices on the right side in (3.5) have integral coefficients. Thus det ( M)I 1, that is, det (M) = ± 1, and the proof is complete. Although Theorem 3.15 allows matrices M with det (M) = - 1, we now restrict our attention to matrices with det (M) = + 1, as it has been found to lead to a more fruitful theory. We explain this in greater detail in the Notes at the end of this chapter. Suppose that M and N are 2 X 2 matrices with integral coefficients. Then the matrix MN is also 2 X 2, and has integral coefficients. From (3.6) we see that if det (M) = det (N) = 1 then det (MN) = 1. Moreover, M- 1 has integral coefficients, and det (M- 1 ) = 1. Thus the set of 2 X 2 matrices with integral coefficients and determinant 1 form a group. Definition 3.6 The group of 2 X 2 matrices with integral elements and determinant 1 is denoted by r, and is called the modular group. The modular group is noncommutative. For example, if M = [ 0 -1 �] and N= U � ]. then MN= [ 1 -1 �] but NM = [ O -1 n. Definition 3.7 The- quadratic forms f(x, y) = ax 2 + bxy + y 2 and g(x, y) = Ax2 + Bxy + Cy 2 are equivalent, and we write f- g, if there is an M = [mii] E f such that g(x, y) = f(m 11x + m 12y, m21x + m 22 y ). In this case we say that M takes f to g. 158 Quadratic Reciprocity and Quadratic Forms In this situation, we may calculate the coefficients of g in terms of those of f and of M. The effect of this change of variables is made clearer by making systematic use of matrix multiplication. Let = [ a �b] = [ A �B] F 1 , G 1 , -b c -B C 2 2 X = [�] . Then X'FX = [f(x, y)]. Here the matrix on the right is a 1 X 1 matrix, and X' = [x y] is the transpose of X. Similarly X' GX = [g(x, y )]. Our definition of g states that we obtain g by evaluating f with X replaced by MX. That is, (MX)'F(MX) = [g(x, y)]. Since (MX)' = X'M', this may be written X'(M'FM)X = [g(x, y)]. The coefficient matrix G of the quadratic form g is uniquely determined by the coefficients of g, so we may conclude that (3 .8) Indeed, if the matrix multiplications on the left are performed, we dis­ cover that this matrix identity is simply a more compact reformulation of the identities (3.7). We now show that the notion of equivalence in Definition 3.7 is an equivalence relation in the usual sense that it is reflexive, symmetric, and transitive. Theorem 3.16 Let f, g, and h be birulry quadratic fonns. Then (1) f- f, (2) iff- g, then g- f, (3) iff - g and g - h, then f- h. Proof We have seen that f- g if and only if there is an M E r such that (3.8) holds. Take M =I, the identity matrix. Since IE f and I'FI = F, we conclude that f- f. Suppose that f- g. Then we have (3.8) for some M E r. By multiplying this on the left by (M- 1 )', and on the right by M- 1, 3.5 Equivalence and Reduction of Binary Quadratic Forms 159 we deduce that F = (M- 1 )1GM- 1 • But f is a group, so M- 1 E f, and hence g - f. Suppose finally that f- g and g -h. Then G = M- 1FM and H = N- 1 GN for some matrices M and N in r. On substituting the first of these identities in the second, we find that H = N- 1( M- 1 FM )N = (MN)- 1F(MN). Since MN E r, we have established that f- h. Since the relation - is an equivalence relation, it serves to partition the set of binary quadratic forms into equivalence classes. We now relate this concept to the representability of integers. Theorem 3.17 Let f and g be equivalent binary quadratic forms. For any given integer n, the representations of n by f are in one-to-one co\"espondence with the representations of n by g. Also, the proper representations of n by f are in one-to-one co\"espondence with the proper representations of n by g. Moreover, the discriminants off and g are equal. Proof The first assertion is immediate from Theorem 3.15 and Definition 3.7. To prove the second assertion, we establish that in this one-to-one correspondence, g.c.d.(x, y) = g.c.d.(u, v) whenever X and U are nonzero 1 lattice points. Let r = g.c.d.(x, y) and s = g.c.d.(u, v ). Since -X is a r lattice point, it follows from Theorem 3.15 that � U = M( �X) is a lattice point. That is, rls. As it may similarly be shown that sir, we conclude that r = s. Let d and D denote the discriminants of f and g, respectively. We note that det(F) = -d/4, det (G) = -Dj4. Then from (3.8) and (3.6) we deduce that -D/4 = det (G ) = det (M 'FM ) = det (M' ) det ( F )det( M) = det ( F) = -dj4. Alternatively, one could establish that d = D by a direct (but less trans­ parent) calculation based on the identities (3.7). As an aid to determining whether two forms are equivalent, we now identify a special class of forms that we call reduced and show how to find a reduced form that is equivalent to any given form. Definition 3.8 Let f be a binary quadratic form whose discriminant d is not a perfect square. We call f reduced if -lal <b� la l < l e i 160 Quadratic Reciprocity and Quadratic Forms or if O� b� la l =l e l. If the discriminant of f is a square, possibly 0, then we proceed differently; see Problems 7 and 12 at the end of this section. We now describe two simple transformations that may be used to reduce a given form f. Since the discriminant of f is not a perfect square, we know from Theorem 3.10 that a* 0 and that c * 0. If lei < Ia I, or if Ia I= le i and -l al � b < 0, then take M = [ -� 6] in (3.3). Thus we see that f is equivalent to the form g(x, y) = cx 2 - bxy + ay 2• Alterna­ tively, if b fails to lie in the interval ( - Ia I, Ia 11 then we take M = [ 6 7] in (3.8). By (3.7) we see that A = a, B = 2am + b, and C = f(m, 1) = am2 + bm + c. We take m to be the unique integer for which -Ia I < B � I a I. The resulting form may not be reduced, since it may be that ICI < lA 1. In this case we would apply the first sort of transformation. By alternating between these two transformations, one is eventually led to a reduced form. To see that the process cannot continue indefinitely, note that the absolute value of the coefficient of x2 is a weakly decreasing sequence, and that this quantity is strictly decreased by the first transfor­ mation, unless I a I = I c I, in which case the first transformation produces a reduced form. Thus we have proved the following important result. Theorem 3.18 Let d be a given integer, which is not a perfect square. Each equivalence class of binary quadratic forms of discriminant d contains at least one reduced fonn. In Section 3. 7 we will show that if d < 0, then the reduced form in a given equivalence class is unique. For d > 0 this is not generally true, but the uniqueness may be recovered by adopting a more elaborate definition of what constitutes a reduced form. Example 1 Find a reduced form equivalent to the form 133x2 + 108.xy + 22y2• Solution By performing the first transformation, we see that the given form is equivalent to 22x2 - 108.xy + 133y2• By performing the second transformation with m = 2, we find that this form is equivalent to 22x2 - 20xy + 5y2. By performing the first transformation, we see that this form is equivalent to 5x2 + 20xy + 22y2• By performing the second transforma­ tion with m = - 2, we find that this is equivalent to 5x2 + 2y2. By the first transformation, this is equivalent to 2x2 + 5y2, which is reduced. One may verify that all these quadratic forms have discriminant - 40. 3. 5 Equivalence and Reduction of Binary Quadratic Fonns 161 Theorem 3.19 Let f be a reduced binary quadratic form whose discriminant 1 d is not a perfect square. If f is indefinite, then 0 < Ia I � 2/d. If f is positive definite then 0 <a � v- d/3 . In either case, the number of reduced forms of a given nonsquare discriminant dis finite. Proof If a and c are of the same sign then d = b 2 - 4ac = b2 - 4lacl ..;;; a2 - 4lacl � a2 - 4a2 < 0. Thus if d > 0 then a and c have opposite signs, and d = b2 - 4ac = b2 + 4lacl � 4lac l � 4a2• This gives the bound for Ia I in this case. If d < 0 then a > 0 and c > 0, and hence d = b2 - 4ac � a2 - 4ac � a2 - 4a2 = -3a2• This gives the bound for a in this case. In either case, a and b can take only a finite number of values. Once a and b are selected, there exists at most one integer c for which b2 - 4ac =d. Definition 3.9 If d is not a perfect square then the number of equivalence classes of binary quadratic forms of discriminant dis called the class number of d, denoted H(d). Let f be a binary quadratic form whose discriminant d is not a perfect square. In case H(d) = 1, we may combine Theorem 3.13 and Theorem 3. 17 to determine quite precisely which numbers are repre­ sentable by f. Example 2 Show that an odd prime p can be written in the form p = x2 - 2y 2 if and only if p = ± 1 (mod 8). Solution We note that the quadratic form f(x, y) = x2 - 2y2 has dis­ criminant d = 8, which is not a perfect square. We first determine all reduced forms of this discriminant. From Theorem 3.19 we have Ia I � fi, so that a = ± 1. From Definition 3.8 we deduce that b = 0 or 1. But b and d always have the same parity, so we must have b = 0. Thus we find that there are Rrecisely two reduced forms of discriminant 8, namely f and -f. Let M = u ::::�] .We observe that det (M) = 1, so that M E f. Taking this Min (3.7), we find that f- -f. Thus H(8) = 1. By Corollary 3. 14 it follows that p is represented by f if and only ( �) = 1, and we obtain the stated result by quadratic reciprocity. It is conjectured that there are infinitely many positive (nonsquare) integers d for which H(d) = 1. It is known that for d < 0 there are only nine: d = -3, - 4, - 7, - 8, - 11, - 19, - 43, - 67, - 163. 162 Quadratic Reciprocity and Quadratic Forms PROBLEMS 1. Find a reduced form that is equivalent to the form 7x2 + 25xy + 23y 2• 2. Let G be a group. The set C = {c E G: cg = gc for all g E G} is called the center of G. Prove that C is a subgroup of G. Prove that the center of the modular group r consists of the two elements I, - I. (H) 3. Let x and y be integers. Show that there exist integers u and v such that [ � n E f if and only if (X, y) = 1. 4. Show that a binary quadratic form f properly represents an integer n if and only if there is a form equivalent to f in which the coefficient of x 2 is n. Use this and (3.3) to give a second proof of Theorem 3.13. 5. Show that x2 + 5y 2 and 2x2 + 2xy + 3y 2 are the only reduced quadratic forms of discriminant - 20. Show that the first of these forms does not represent 2, but that the second one does. Deduce that these forms are inequivalent, and hence that H( - 20) = 2. Show that an odd prime p is represented by at least one of these forms if and only if p = 1, 3, 7, or 9(mod 20). 6. Let f( x , y) = ax 2 + bxy + cy 2 and g(x, y) = f( -x , y) = ax 2 - bxy + cy 2. These forms represent precisely the same num­ bers, but they are not necessarily equivalent (because the determi­ nant of the transformation has determinant -1). Show that x 2 + xy + 2 y 2 is equivalent to x 2 - xy + 2 y 2, but that 3x 2 + xy + 4y 2 and 3x 2 - xy + 4 y 2 are not equivalent. 7. Let f(x, y) be a quadratic form whose discriminant d is a positive perfect square. Show that f is equivalent to a form ax2 + bxy + cy2 for which c = 0 and 0 � a < lb 1. Deduce that there are only finitely many equivalence classes of forms of this discriminant. (H) 8. Let f(x, y) = 44x2 - 97xy + 35y2• Show that f is equivalent to the form g(x, y) = x(47x - 57y). Show that n is represented by f if and only if n can be written in the form n = ab where b = 47a (mod 57). Find the least positive integer n represented by f. 9. Show that if a number n is represented by a quadratic form f of discriminant d, then 4an is a square modulo ldi . (H) 10. Use the preceding problem to show that if p is represented by the form x2 + 5y2 then ( �) = 1, and that if p is a prime represented by the form 2x2 + 2xy + 3y2 then ( �) = - 1. By combining this infor­ mation with the result of Problem 4, conclude that an odd prime p is represented by the form x2 + 5y2 if and only if p = 1 or 9(mod 20), and that an odd prime pis represented by the form 2x2 + 2xy + 3y2 if and only if p = 3 or 7 (mod 20). 3. 6 Sums of Two Squares 163 11. Suppose that ax 2 + bxy + cy 2 - A.x 2 + Bxy + Cy 2• Show that g.c.d.(a, b, c) = g.c.d.(A, B, C). 12. Let f(x, y) = ax 2 + bxy + cy 2 be a positive semidefinite quadratic form of discriminant 0. Put g = g.c.d.(a , b, c). Show that f is equiva­ lent to the form gx 2• 13. A binary quadratic form ax 2 + bxy + cy 2 is called primitive if g.c.d.(a, b, c) = 1. Prove that if ax 2 + bxy + cy 2 is a form of discrim­ inant d and r = g.c.d.(a, b, c) then (a jr )x 2 + (bjr )xy + (cjr )y 2 is a primitive form of discriminant djr2• If dis not a perfect square, let h(d) denote the number of classes of primitive forms with discrimi­ nant d. Prove that H(d) = I: h(djr 2 ) where the sum is over all positive integers r such that r 2 ld. *14. Show that if f is a primitive form and k is a nonzero integer, then there exists an integer n properly represented by f with the property that (n, k) = 1. *15. Suppose that d = 0 or 1 (mod 4) and that d is not a perfect square. Then d is called a fundamental discriminant (or reduced discrimi­ nant) if all binary quadratic forms of discriminant d are primitive. Show that if d = 1 (mod 4) then d is a fundamental discriminant if and only if d is square-free. Show that if d = 0 (mod 4) then d is a fundamental discriminant if and only if d 14 is square-free and d/4 = 2 or 3 (mod 4). *16. Let a1 , a 2, • • · an be given integers. Show that there is an n X n matrix with integral elements and determinant 1 whose first row is a\" a2, · · · ,an, if and only if g.c.d.(a\" a 2,· · · , an) = 1. 3.6 SUMS OF TWO SQUARES In Theorem 2.15 we characterized those integers n that are represented by the quadratic form x 2 + y 2• We now apply the general results obtained in the preceding two sections to give a second proof of this theorem, and we also determine the number of such representations, counted in various ways. For convenient reference, we list four functions that appear repeat­ edly throughout the section: R(n): the number of ordered pairs (x, y) of integers such that x 2 + y 2 = n; r(n): the number of ordered pairs (x, y) of integers such that g.c.d.(x, y) = 1 and x 2 + y 2 = n, that is, the number of proper representations of n; P(n): the number of proper representations of n by the form x 2 + y 2 for which x > 0 and y ;;;. 0; N(n): the number of solutions of the congruence s2 = -1 (mod n). 164 Quadratic Reciprocity arul Quadratic Forms The form x2 + y2 has discriminant d = - 4. Our first task is to construct a list of all reduced quadratic forms of this discriminant. We ignore negative definite forms and restrict our attention to positive forms. As 0 <a � J4!3 by Theorem 3.19, we conclude that a = 1, and hence from Definition 3.7 that b = 0 or 1. But b = 1 is impossible since b2 - 4ac = -4, and hence b = 0 and c = 1. Thus x2 + y2 is the only positive definite reduced form of discriminant -4. Then by Theorem 3.18 we deduce that all positive definite forms of discriminant - 4 are equiva­ lent, that is, H( - 4) = 1. From Theorems 3.13 and 3.17 we find that a positive integer n is properly represented by the form x2 + y2 if and only if -4 is a square modulo 4n. We observe that -4 is a square modulo 8, but not modulo 16. Thus n may be divisible by 2, but not by 4. If p is an odd prime of the form 4k + 1, then by Theorem 2.12 we know that -4 is a square (mod p). That is, if f(x) = x2 + 4, then f(x) == O(mod p) has a solution x0. Since f'(x0) = 2 x0 ¥; O(mod p), we deduce by Hensel's lemma (Theorem 2.23) that this solution lifts to a unique solution (mod p2), and thence to (mod p3), and so on. Thus we see that n may be divisible by arbitrary powers of primes of the form 4k + 1. On the other hand, if p is a prime dividing n of the form 4k + 3, then (by Theorem 2.12) - 4 is not a square (mod p) and hence (by Theorem 2. 16) -4 is not a square (mod 4n). Thus we have proved the following theorem. Theorem 3.20 A positive integer n is properly representable as a sum of two squares if and only if the prime factors of n are all of the form 4k + 1, except for the prime 2, which may occur to at most the first power. Having described those numbers that are properly represented as a sum of two squares, we may deduce which numbers are represented, properly or otherwise. Suppose that n is positive and that n = x2 + y 2 is an arbitrary representation of n as a sum of two squares. Put g = g.c.d.(x, y ). Then g 2 ln, and we may write n = g 2m. Since (xjg, y jg) = 1, we see that m = (xjg )2 + (y jg )2 is a proper representation of m. Here g may have some prime factors of the form 4k + 3, but of course they divide n to an even power. The power of 2 dividing n may be arbitrary, for suppose that 2alln. If a is even then we take m to be odd, 2al2 llg, while if a is odd then we can arrange that 2 11m, 2(a- I)/2 II g. Thus we have a second proof of Theorem 2. 15. Let R(n) denote the number of representations of n as a sum of two squares. That is, R(n) is the number of ordered pairs (x, y) of integers for which x 2 + y 2 = n. Let r(n) be the number of such ordered pairs for which g.c.d.(x, y) = 1. That is, r(n) is the number of proper representa- 3. 6 Sums of Two Squares 165 tions of n as a sum of two squares. We have determined those n for which R(n) > 0, and also those for which r(n) > 0. By exercising a little more care, we determine formulae for these functions. Theorem 3.21 Suppose that n > 0, and let N(n) denote the number of solutions of the congruence s2 = -1 (mod n). Then r(n) = 4N(n), and · R(n) = E r(njd2) where the sum is extended over all those positive d for which d2 ln. Proof Consider any solution of x2 + y 2 = n, where n > 0. Of the four points (x, y ), ( -y, x ), ( -x, - y ), (y, - x), exactly one of them has positive first coordinate and non-negative second coordinate. Let P(n) denote the number of proper representations x 2 + y 2 = n for which x > 0 and y � 0. Then r(n) = 4P(n), and we now prove that P(n) = N(n). Suppose th'at n is a given positive integer. We shall exhibit a one-to-one correspon­ dence between representations x 2 + y 2 = n with x > 0, y � 0, g.c.d.(x, y) = 1, and solutions s of the congruence s2 = -1 (mod n). This is accomplished in three steps. First we define a function from the appropriate pairs (x, y) to the appropriate residue classes s (mod n). Second, we show that this function is one-to-one. Third, we prove that the function is onto. To define the function, suppose that x and y are integers such that x 2 + y 2 = n, x > 0, y � 0, and that g.c.d.(x, y) = 1. Then g.c.d.(x, n) = 1, so there exists a unique s (mod n) such that xs = y (mod n). More precisely, if i is chosen so that xX = 1 (mod n), then s = iy (mod n). Since x 2 = -y 2 (mod n), on multiplying both sides by i2 we deduce that s2 = -1 (mod n). We now show that our function from the representations counted by P(n) to the residue classes counted by N(n) is one-to-one. To this end, suppose that for i = 1, 2 we have n = x,1 + y?, X; > 0, Y; � 0, g.c.d. (x;, y;) = 1, and X;S; = Y;(mod n). We show that if s1 = s2 (mod n) then x 1 = x2 and y 1 = y2• Suppose that s1 = s2 (mod n). As x 1 y2s1 = y 1 y2 = x2 y 1 s2 (mod n), it follows that x1 y2 = x2 y1 (mod n), since g.c.d.(s;, n) = 1. But 0 < x,1 � n, so that 0 < X; � Vn, and similarly 0 � Y; < Vn. From these inequalities we deduce that 0 � x 1 y2 < n, and similarly that 0 � x2 y 1 < n. As these two numbers are congruent modulo n and both lie in the interval [0, n), we conclude that x 1 y2 = x 2 y 1• Thus x 1 lx2 y 1. But g.c.d.(x t > y 1) = 1, so it follows that x1 lx2. Similarly x2 lx 1. As the X; are positive, we deduce that x1 = x2 , and hence that y 1 = y2. This completes the proof that our function is one-to-one. To complete the proof that P(n) = N(n), we now show that our function is onto. That is, for each s such that s2 = -1 (mod n), there is a representation x2 + y2 = n for which x > 0, y � 0, (x, y) = 1, and � = 3. 6 Sums of Two Squares 169 + ky2 has discriminant -4, and f(l, 0) = p is a proper representation of p. We now reduce this form, keeping track of the change in x and y as we go. For brevity we let S = [ _ � �] and T = [ � n. By taking M = S or M = Tm = [ � 7], as appropriate, we eventually locate a reduced form equivalent to f. But we know that there is only one reduced form of discriminant -4, namely x2 + y2, and the desired representation is achieved. a b c X y Operation 398417 448298 126106 1 0 s 126106 -448298 3984 17 0 1 T 2 126106 56126 6245 -2 s 6245 -56126 126 106 -1 -2 T 4 6245 -6166 1522 7 -2 s 1522 6166 6245 2 7 r- 2 1522 78 1 16 7 s 1 -78 1522 -7 16 T 39 1 0 1 -631 16 The entry in the last column indicates the operation that will be applied to produce the next row. Thus we conclude that 398417 = ( ± 631)2 + ( ± 16)2. PROBLEMS 1. Find four consecutive positive integers, each with the property that r(n) = 0. 2. What is the maximum value of R(n) for positive n � 1000? 3. What is the maximum value of r(n) for positive n � 10000? 4. Use the method of Example 3 to find integers x and y such that x2 + y 2 = 89753, given that this number is prime. 5. Suppose that n is not a perfect square. Show that the number of ordered pairs (x, y) of positive integers for which x2 + y2 = n is R(n)j4. Show that if n is a perfect square then the number of such representations of n is R(n)j4 - 1. 6. Suppose that n > 1. Show that the number of ordered pairs (x, y) of relatively prime positive integers for which x2 + y2 = n is r(n)j4. 170 Quadratic Reciprocity and Quadratic Forms 7. Suppose that n is neither a perfect square nor twice a perfect square. Show that the number of ordered pairs (x, y) of integers for which 0 <x <y and x2 + y2 = n is R(n)/8. 8. Prove that if a positive integer n can be expressed as a sum of the squares of two rational numbers then it can be expressed as a sum of the squares of two integers. 9. Suppose that n is a positive integer that can be expressed as a sum of two relatively prime squares. Show that every positive divisor of n must also have this property. 10. Suppose that a matrix M with integral elements and determinant - 1 takes a form f(x, y) = ax2 + bxy + cy 2 to x2 + y2. Prove that f and x2 + y2 are equivalent by showing that there is another matrix M\" with integral elements and determinant + 1, that also takes f to x2 + y2. 11. Show that if n is a sum of three squares then n ¥;. 7 (mod 8). Show by example that there exist positive integers m and n, both of which are sums of three squares, but whose product mn is not a sum of three squares. 12. Show that if x2 + y 2 + z 2 = n and 4ln, then x, y, and z are even. Deduce that if n is of the form 4m(8k + 7) then n is not the sum of three squares. (Gauss proved that all other positive integers n can be expressed as sums of three squares. ) 3.7 POSITIVE DEFINITE BINARY QUADRATIC FORMS In the further theory of quadratic forms, many differences of detail arise between definite and indefinite forms. As indefinite quadratic forms pre­ sent greater complications, we now confine our attention to positive definite quadratic forms f(x, y) = ax2 + bxy + cy2. We have shown that any such form is equivalent to a reduced form, that is, one for which - a < b � a < c or 0 � b � a =c. We now show that this reduced form is unique. That is, distinct reduced forms are inequivalent, so that the class number H(d) is precisely the number of reduced forms of discriminant d, when d < 0. (For d > 0 two reduced forms may be equivalent, as we saw in Example 2. To develop a corresponding theory for indefinite forms, one must allow for solutions of the equation x2 - dy2 = ± 4. This is a special case of Pell's equation, which we discuss in Section 7.8 as an application of continued fractions.) Lemma 3.24 Let f( x, y) = ax 2 + bxy + cy 2 be a reduced positive definite form. If for some pair of integers x and y we have g.c.d.( x, y) = 1 and f(x, y) � c, then f(x, y) = a or c, and the point (x, y) is one of the six 3. 7 Positive Definite Binary Quadratic Forms 171 points ±0, 0), ± (0, 1), ± (1, - 1). Moreover, the number of proper repre­ sentations of a by f is 2 if a < c, 4 if O� b< a= c , and 6 if a= b =c . Proof Suppose that g.c.d.(x, y) ,;, 1. If y = 0 then x = ± 1, and we note that f( ±1,0) =a. Now suppose that y = ±1. If lx l � 2 then l2ax + by l � l2axl - lbyl � 4a - lb l (by the triangle inequality) � 3a ( since lbl � a) . Then by (3.3) we deduce that 4af(x, y ) = (2ax + by )2 - dy 2 = 9a2 - d = 9a2 + 4ac - b2 > a2 - b2 + 4ac � 4ac (since a > 0) ( since lbl ,;;; a) . Thus f(x, ± 1) > c if lx l � 2. Now suppose that ly l � 2. Then by (3.3) we see that 4af(x, y) = (2ax + by )2 - dy 2 � -dy 2 � -4d = l6ac - 4b2 >Sac - 4b2 � 4ac ( since ac > 0) ( since 0 < a � c) (since I b I ,;;; a) . 172 Quadratic Reciprocity and Quadratic Forms Thus f(x, y) > c if ly I � 2. The only points remaining are ± 0, 0), ± (0, 1), ±0, - 1), and ± 0, 1). As b > -a, we find that fO, 1) =a + b + c > c, so that the proper representations of a and of c are obtained by consider­ ing the first three pairs of points. The last assertion of the lemma now follows on obsetving that f0,0) =a, f(O, 1) = c, and fO, - 1) =a - b + c. Theorem 3.25 Let f(x, y) = ax2 + bxy + cy 2 and g(x, y) = Ax2 + Bxy + Cy 2 be reduced positive definite quadratic forms. Iff - g then f = g. Proof Suppose that f- g. By Lemma 3.24, the least positive number properly represented by f is a, and that by g is A. By Theorem 3.17 it follows that a =A. We consider first the case a <c. Then by Lemma 3.24 there are precisely 2 proper representations of a by f. By Theorem 3.17 it follows that there are precisely 2 proper representations of a by g, and from Lemma 3.24 we deduce that C > a. Thus by Lemma 3.24 we see that c is the least number greater than a that is properly represented by f, and Cis the least such for g. By Theorem 3.17 it follows that c = C . To show that b = B, we consider the matrices ME r that might take f to g. Since det (M) = m11m22 - m21 m 12 = 1, we know that g.c.d.(m w m21) = 1. Thus by (3.7a), f(mw m21 ) =a is a proper representation of a. By Lemma 3.24 it follows that the first column of M is ± [ � ] . We see similarly that (m12, m22) = 1, so that by (3.7c), f(m12, m22) = c is a proper representation of c. Hence by Theorem 3.24, the second column of M is ± [ �] or ± [ - � ] . Thus we see that the only candidates for M are ± I and ± [� -n. However, in the latter event (3.7b) would give B = - 2a + b, which is impossible since b and B must both lie in the intetval (- a, a]. This leaves only ±I, and we see that if M = ±I then f= g. We now consider the case a= c. From Lemma 3.24 we see that a has at least 4 proper representations by f. From Theorem 3.17 it follows that the same is true of g, and then by Lemma 3.24 we deduce that C =a =c. Thus by Definition 3.8, 0 � b � a = c and 0 � B �A = C = a. As b2 - 4ac = B2 - 4AC, it follows that b = B, and hence that f =g. In the case a < c considered, we not only proved that f = g, but also established that the only matrices M E r that take f to itself are ± I. We now extend this. Definition 3.10 Let f be a positive definite binary quadratic form. A matrix ME r is called an automorph of f if M takes f to itself, that is, if 3. 7 Positive Definite Binary Quadratic Forms 173 f(mu x + m 12 y, m21 x + m22 y) = f(x, y). The number of automorphs of f is denoted by w(f). For example, the matrix [ - � and of course the identity matrix form. -�] is an automorph of x2 + xy + y2, I = [ � �] is an automorph of every Theorem 3.26 Let f and g be equivalent positive definite binary quadratic forms. Then w(f) = w(g ), there are exactly w(f) matrices M E r that take f to g, and there are exactly w(f) matrices M E r that take g to f. Moreover, the only values of w(f) are 2, 4, and 6. Iff is reduced then w ( f) = 4 if a = c and b = 0, w ( f) = 6 if a = b = c, and w( f) = 2 otherwise . Proof Let A 1 , A 2, ··· , A , be distinct automorphs of f, and let M be a matrix that takes f to g. Then A 1 M, A 2 M, · · ·, A,M are distinct members of r that take f to g. Conversely, if M1 , M2, · · · , M s are distinct members of f that take f to g, then M 1 Mi \\ M 2 Mi \\ · · · , M s Mi 1 are distinct automorphs of f. Hence the automorphs of f are in one-to-one correspon­ dence with the matrices M that take f to g. If M takes f to g, then M- 1 takes g to f, and these matrices M- 1 are in one-to-one correspondence with the automorphs of g. Thus the automorphs of f are in one-to-one correspondence with those of g, and consequently w(f) = w(g) if either number is finite. But the number is always finite, because any form is equivalent to a reduced form, and in the next paragraph we show that any reduced form has 2, 4, or 6 automorphs. Suppose that f is reduced. In the course of proving Theorem 3.25, we showed that w(f) = 2 if a < c, and we saw that f(m11, m21 ) =a and f(m 12, m22) = c are proper representations of a and c. Suppose now that 0 � b � a = c and that M leaves f invariant (i.e., M takes f to itself). Then by Lemma 3.24 the columns of M lie in the set { ± [ �] , ± [ � ] , ± [ _ � ] } . Of the 36 such matrices, we need consider only those with determinant 1, and thus we have the six pairs ±M1 , [ 1 -1 ] [ 1 0] ±Mz, ... ' ± M6 where Ml = I, Mz = 0 1 ' M3 = -1 1 ' [0 -1 ] [0 - 1 ] [ 1 1 ] 0 M4 = 1 0 , M5 = 1 1 , and M6 = _ 1 0 . We note that 1f any one of the four matrices ±M ± 1 is an automorph, then all four are. 174 Quadratic Reciprocity and Quadratic Forms Here M1 is always an automorph. By (3.7b) we see that M2 takes f to g with B = b - 2a * b, so that M2 is never an automorph. As M3 = M:;_ 1, we deduce that M3 is likewise never an automorph. As M4 takes f to cx2 - bxy + ay 2, M4 is an automorph if and only if b = 0 and a =c. Since M5 takes f to cx2 + (2c - b)xy +(a - b + c)y2, we see that M5 is an automorph if and only if a= b =c. Finally, M6 = M5 1 , so that M6 is an automorph if and only if a = b = c. This gives the stated result. We now employ our understanding of automorphs to generalize Theorem 3.21 (which was concerned with the particular form x2 + y2) to arbitrary positive definite binary quadratic forms f of discriminant d < 0. Extending the notation of the preceding section, we let R/n) denote the number of representations of n by f. Similarly, we let r/n) denote the number of these representations that are proper. Finally, let H/n) denote the number of integers h, 0 � h < 2n, such that h2 = d (mod 4n), say h2 = d + 4nk, with the further property that the form nx2 + hxy + ky2 is equivalent to f. Theorem 3.27 Let f be a posmve definite binary quadratic form with discriminant d < 0. Then for any positive integer n, r/n) = w(f)H/n), and R/n) = Em2lnr/nfm2 ). It may be shown that if a nonzero number n is represented by an indefinite quadratic form whose discriminant is not a perfect square, then n has infinitely many such representations. To construct an analogous theory for indefinite forms one must allow for solutions of Pell's equation x2 - dy 2 = ±4. Proof Let �(n) denote the set of those forms g(x, y) = nx2 + hxy + ky2 that are equivalent to f, and for which 0 � h < 2n. From Theorem 3.17 we know that such a form must have the same discriminant as f, so that h2 - 4nk = d. Thus there are precisely H/n) members of the set �(n). If g E �(n), then g is equivalent to f, which is to say that there is a matrix M E r that takes f to g. By Theorem 3.26 it follows that there are precisely w(f) such matrices. Consequently, there are exactly w(f)H/n) matrices ME r that take f to a member of �(n). We now exhibit a one-to-one correspondence between these matrices M and the proper representations of n. Suppose that M is of the sort described. Then by (3.7a) we see that f(m11, m21 ) = n. As det (M) = m 11m22 - m21 m12 = 1, we see that (m 11, m21) = 1, and thus the representation is proper. Conversely, suppose that f(x, y) = n is a proper representation of n. To recover the matrix M, we take m11 = x, m21 = y. It remains to show that m 12 and m21 are 3. 7 Positive Definite Binary Quadratic Forms 175 uniquely determined. Let u and v be chosen so that xu - yu = l. In order that det (M) = 1, we must have m21 = u + tx, m22 = v + ty for some integer t. For M of this form we see by (3.7b) that h = 2 ax( u + t.x) + bx( v + ty) + by( y + t.x) + 2cy( v + ty) = ( 2 axu + bxv + byu + 2cyv ) + 2nt . Thus there is a unique t for which 0 � h < 2n. This gives a unique matrix M with the desired properties. The first of the asserted identities is thus established. To establish the second identity, suppose that x and y are integers such that f( x, y) = n, and put m = g.c.d.( x, y ). Then m2 ln , and indeed f( xjm, y jm) = njm 2 is a proper representation of njm2, since g.c.d.(xjm, y jm) = 1. Conversely, if m2 1n and u and v are relatively prime integers such that f(u, v) = njm2, then f( mu, mv ) = n and g.c. d. (mu, mv ) = m. Continuing our quest to generalize Theorem 3.21, we now let N/n) denote the number of integers h for which h2 = d (mod 4n) and 0 � h < 2n. Since h is a solution of the congruence u 2 = d (mod 4n) if and only if h + 2n is a solution, it follows that N/n) is precisely one-half the total number of solutions of the congruence u 2 = d (mod 4n). Assuming that n is a positive integer, the value of N/n) may be determined by applying the tools of Chapter 2, particularly Theorems 2.20 and 2.23. Let !F denote the set of all reduced positive definite binary quadratic forms of discriminant d. If h2 = d (mod 4n), say h2 = d + 4nk, and 0 � h < 2n, then there is a unique form f E !F for which nx2 + hxy + ky 2 E .§[(n). Hence E H1( n) =NAn) . JE .'F For many discriminants d it happens that w(f) is the same for all f E :F. In that case we let w denote the common value. (In this connection, recall Problem 15 in Section 3.5, and see Problem 6 below. ) For such d we may multiply both sides by w and appeal to Theorem 3.27 to see that E r1( n) = wNA n) . JE .'j' In this manner we may determine the total number of proper representa­ tions of n by reduced forms of discriminant d, but unfortunately it is not always so easy to describe the individual numbers r/n). Notes on Chapter 3 177 the simpler method discovered by Lagrange in 1773. In 1738 Euler observed that whether the congruence x 2 =a (mod p) has a solution or not is determined by the residue class of p (mod 41 a 1). In 1783, Euler gave a faulty proof of an assertion equivalent to the quadratic reciprocity law. (In retrospect, one can see that even much earlier, Euler was just a short step away from having a complete proof of quadratic reciprocity.) In 1785, Legendre introduced his symbol, stated the general case of quadratic reciprocity without using his symbol, introduced the word \"reciprocity,\" and gave an incomplete proof of the law. (In 1859, Kummer noted that the gap in Legendre's proof is easily filled by appealing to Dirichlet's theorem of 1837 concerning primes in arithmetic progressions.) In ignorance of the earlier work of others, Gauss discovered the quadratic reciprocity law just before his eighteenth birthday. After a year of strenuous effort, Gauss found the first proof, in 1795, at the age of nineteen. This was published in 1801. Gauss discovered \"Gauss's lemma\" (Theorem 3.2) in 1808. Our proof of quadratic reciprocity (Theorem 3.3) follows Gauss's third proof of the theorem, which is considered to have been Gauss's favorite. Eventually Gauss gave eight proofs of quadratic reciprocity, in the hope of finding one that would generalize to give a proof of the quartic reciprocity law that he had empirically discovered. For an instructive algebraic interpretation of Gauss's lemma, see W. C. Waterhouse, \"A tiny note on Gauss's Lemma,\" J. Number Theory, 30 (1988), 105- 107. Theorem 3.5 is a variation of a result by P. Hagis, \"A note concerning the law of quadratic reciprocity,\" Amer. Math. Monthly, 77 (1970), 397. §3.3 In more advanced work, it is useful to extend the Legendre symbol beyond the Jacobi symbol, to the Kronecker symbol. Let n2(p) denote the least positive quadratic nonresidue of p. Using the inequality (3.2) in a clever way, David Burgess showed that for every e > 0 there is a p0(e) such that nz(p) < pc +e for p > p0( e), where c = 1/(4/e ) = 0. 1516 ... . � az +b ) §3.5 A function f(z) is called a modular function if -- = f(z) cz + d for every [ � �] E r. The study of modular functions, modular forms, and the more general automorphic functions is an active area of research in advanced number theory. If F is a field, then the n X n matrices with entries in F and nonzero determinant form a group, known as the general Linear group of order n over F, and denoted GL(n, F). If R is a commuta­ tive ring with identity, then the n X n matrices with coefficients in R and determinant 1 form a group, known as the special Linear group of order n over R, denoted SL(n, R). In this notation, the modular group r is SL(2, Z). 178 Quadratic Reciprocity and Quadratic Forms Two forms ax2 + bxy + cy 2 and Ax2 + Bxy + Cy2 of discriminant d lie in the same genus if aA is a square modulo l d l. This defines a new equivalence relation on the forms of discriminant d. Using the observation made in Problem 9, it may be shown that if two forms are equivalent (in the sense of Definition 3.7) then they lie in the same genus. Thus each genus is the union of one or more equivalence classes of forms. The consideration of these genera allows one to refine Corollary 3. 14: If p is represented by some form of discriminant d, one may use quadratic reciprocity to determine in which genus this form must lie. An example of this is found in Problem 10, which concerns d = -20. In this case it is found that there is only one equivalence class in each genus, and hence we are able to specify precisely which primes are represented by which forms. However, the discriminant d = - 20 is one of only finitely many discrimi­ nants of this sort: If d is large and negative, then each genus contains a large number of equivalence classes of forms. The problem of finding all negative discriminants d for which h(d) = 1 has a long and interesting history, which is recounted in the survey article of D. Goldfeld, \"Gauss's class number problem for imaginary quadratic fields,\" Bull. Amer. Math. Soc. 13 (1985), 23-37. §3.6 Following Fermat, much attention was paid to the problem of giving an explicit formula for the numbers x and y for which x2 + y2 = p, when p is a prime of the form 4n + 1. This was first achieved in 1808 by Legendre, using continued fractions. In 1825 Gauss gave a different construction: Since x and y are of opposite parity, we may assume that x is odd. By replacing x by -x if necessary, we may suppose that x = l(mod 4). Then x is the unique number for which lxl < pj2 and 2x = {2nn ) (mod p) where p = 4n + 1. More recently, Jacobsthal discov­ ered that one may express x and y as sums involving the Legendre symbol, 1 p- I ( k(k2 - r ) ) x= - E 2 k=l p ' 1 p-' ( k(k2 -n) ) Y = - E 2 k= l p where r denotes any quadratic residue of p, and n is any quadratic nonresidue of p. The method of Example 3, though it does not yield an explicit formula for x and y, nevertheless is computationally much more efficient. A similar calculational technique, but using continued fractions instead of the theory of quadratic forms, is found in Problem 6 of Section 7.3. §3.7 Theorem 3.25 may be proved by considering the action of the modular group f on the upper half-plane J/'= {z E C: J-- (z) > 0}. A nice account of this is found in Chapter 1 of LeVeque's Topics. Notes on Chapter 3 179 It was noted by Gauss that the theory of quadratic forms may be used to provide a method of factoring numbers. An elegant account of this approach has been given by D. H. and E. Lehmer, \"A new factorization technique using quadratic forms,\" Math. Comp. 28 (1974), 625-635. In Chapter 1, our treatment of sums of two squares depended on the identity ( x2 + y 2 )( u2 + v 2 ) = ( xu - yv )2 + ( xu + yu)2 which reflects a familiar property of complex numbers, namely that if z = x + iy and w = u + iv, then lzl lwl = lzwl. This is the first instance of a type of identity known as a composition formula. Such formulae exist for forms of other discriminants. For example, the reduced quadratic forms of discriminant -20 are f0(x, y) = x2 + 5y 2 and f1(x, y) = 2x2 + 2.xy + 3y2• By Theorems 3.18 and 3.25 it follows that H( - 20) = 2. Moreover, it is easy to verify that [0( x , y )f0(u, v ) = f0( xu - 5yv , xu + yu) , f0( x, y)f1( u, v ) = f1( xu - yu - 3yv , xu + 2yu + yv ), [1(x, y)f1( u, v ) = f0(2xu +xu + yu - 2yv, xu + yu + yv ) . Using these formulae, we see that fo and /1 form a group in which fo is the identity. More generally, Gauss proved that if d is not a perfect square then there exist composition formulae relating the various equivalence classes of primitive binary quadratic forms of discriminant d. These formulae cause the equivalence classes of the primitive forms of discrimi­ nant d to form an abelian group. Subsequently it was discovered that this corresponds to the ideal class structure in a quadratic field of discriminant d. If in Definition 3.7 we had allowed matrices of determinant -1 then some of our equivalence classes would have been joined, the composition formulae would have become muddled, and the group structure destroyed. For more extensive treatments of the theory of quadratic forms, one should consult the books of Cassels, Jones, and O'Meara. CHAPTER 4 Some Functions of Number Theory 4.1 GREATEST INTEGER FUNCTION The function [x] was introduced in Section 1.2, and again in Definition 3.3 in Section 3.1. It is defined for all real x and it assumes integral values only. Indeed, [x] is the unique integer such that [x] � x < [x] + 1. For brevity it is useful to put {x} = x - [x]. This is known as the fractional part of x. Many of the basic properties of the function [x] are included in the following theorem. Theorem 4.1 Let x and y be real numbers. Then we have (1) [x] � x < [x] + 1, x- 1 < [x] � x, 0 � x - [x] < 1 . (2) [x] = E1 .,;.;x 1 if x � 0. (3) [x + m] = [x] + m if m is an integer. ( 4) [ X] + [ y] � [ X + y] � [X ] + [ y] + 1. (5) [ x] + [ _ x] = { 0 if x is an integer , - 1 otherwise . (6) [ [:] ] = [:] if m is a positive integer. (7) - [ -x] is the Least integer � x. (8) [x + t1 is the nearest integer to x. If two integers are equally near to x, it is the Larger of the two. (9) - [-x + t] is the nearest integer to x. If two integers are equally near to x, it is the smaller of the two. (JO) If n and a are positive integers, [nja] is the number of integers among 1, 2, 3, - · ·, n that are divisible by a . Proof The first part of (1) is just the definition of [x] in algebraic form. The two other parts are rearrangements of the first part. 1 80 4. 1 Greatest Integer Function 181 In (2) the sum is vacuous if x < 1. We adopt the standard convention that a vacuous sum is zero. Then, for x ;;;. 0, the sum counts the number of positive integers i that are less than or equal to x. This number is evidently just [ x]. Part (3) is obvious from the definition of [x]. To prove (4) we write x = n + 11, y = m + JL, where n and m are integers and 0 � 11 < 1, 0 � JL < 1. Then [ x ] + [y] = n + m � [ n + 11 + m + JL] = [ x + y] = n + m + [11 + JL ] � n + m + 1 = [x] + [y] + 1. Again writing x = n + 11, we also have -x = n - 1 + 1 - 11 , 0 < 1 - 11 � 1. Then [ x] + [ -x ] = n + [ -n - 1 + 1- 11 ] and we have (5). = n - n - 1 + [ 1 - 11 ] = { 0 -1 if II = 0 if II > 0 To prove (6) we write x = n + 11, n = qm + r, 0 � 11 < 1, 0 � r � m- 1, and have since 0 � r + 11 < m. Then (6) follows because Replacing x by -x in (1) we get -x - 1 < [ -x] � -x and hence x � -[ -x] < x + 1, which proves (7). To prove (8) we let n be the nearest integer to x, taking the larger one if two are equally distant. Then n = x + 8, - t < lJ � i, and [x + t1 = n + [- lJ + ! ] = n, since 0 � - lJ + ! < 1. The proof of (9) is similar to that of (8). To prove part (10) we note that if a, 2a, 3a, · · ·, ja are all the positive integers � n that are divisible by a, then we must prove that [nja] = j. But we see that (j + l)a exceeds n, so ja � n < (j + 1) a, j � nja < j + 1, [nja ] = j. 182 Some Functions of Number Theory Theorem 4.2 de Polignac's formula. Let p denote a prime. Then the Largest exponent e such that pe In ! is e= L i · \"\" [ n ] i=i p Proof If pi > n, then [njpi] = 0. Therefore the sum terminates; it is not really an infinite series. The theorem is easily proved by mathematical induction. It is true for 1!. Assume it is true for (n - 1)! and let j denote the largest integer such that pi ln. Since n ! = n · (n - 1)!, we must prove that I:[njpi] - I:[(n - l)jpi] = j. But and hence [ ;i] - [ n ;; 1 ] = { � if P;ln if pi)'n E [ ;i] - E [ n ;i 1 ] = j. The preceding proof is short, but it is rather artificial. A different proof can be based on a simple, but interesting, observation. If a1, a2, • ·· , an are non-negative integers let f(l) denote the number of them that are greater than or equal to 1, f(2) the number greater than or equal to 2, and so on. Then a1 + a2 + · · · +an = f(l) + f(2) + f(3) + · · · since a; contributes 1 to each of the numbers f(l), f(2), · · ·, f(a;). For 1 � j � n, let ai be the largest integer such that pailj. Then we see that e = a1 + a2 + · · · +an. Also f(l) counts the number of integers � n that are divisible by p, f(2) the number divisible by p2, and so on. Hence f(k) counts the integers pk, 2pk, 3pk, - · · , [njpk]pk, so that f(k) = [njpk]. Thus we see that Formula (6) of Theorem 4.1 shortens the work of computing e in Theorem 4.2. For example, if we wish to find the highest power of 7 that 4. 1 Greatest Integer Function 183 divides 1000! we compute [ 1000/7] = 142, [ 142/7] = 20, [20/7] = 2, [2/7] = 0. Adding we find that 7 164 11000!, 7 165 ,( 1000!. The applications of Theorem 4.2 are not restricted to numerical problems. As an example, let us prove that n! is an integer if a; ;;;.. 0, a 1 + a2 + · · · +a, = n. To do this we merely have to show that every prime divides the numerator to at least as high a power as it divides the denominator. Using Theorem 4.2 we need only prove But repeated use of Theorem 4. 1, part 4, gives us Summing this over i we have our desired result. An alternative way of proving this is that the fraction claimed to be an integer is precisely the number of ways of separating a set of n (distinct) objects into a first set containing a 1 objects, a second set with a2 objects,· · · , an rth set containing a, objects. Indeed, the reasoning used to derive Theorem 1.22 can be generalized to yield the multinomial theorem, in which it is seen that the quotient in question is the coefficient of xj•x22 • • • x�' when (x1 + x2 + · · · +x,)n is expanded. Similarly, one (ab) ! may use Theorem 4.2 to prove that b is an integer, although it may ( a! ) b! be simpler to invoke the combinatorial interpretation suggested in Prob­ lem 5 in Section 1.4. The advantage offered by Theorem 4.2 is that it supplies a systematic approach that can be used when a combinatorial interpretation is not readily available. The Day of the Week from the Date The problem is to verify a given formula for calculating the day of the week for any given date. Any date, such as January 1, 2001, defines four integers N, M, C, Y as follows. Let 184 Some Functions of Number Theory N be the number of the day in the month, so that N = 1 in the example. Let M be the number of the month counting from March, so that M = 1 for March, M = 2 for April, -·· , M = 10 for December, M = 11 for January, and M = 12 for February. (This peculiar convention arises be­ cause the extra leap year day is added at the end of February.) Let C denote the hundreds in the year and Y the rest, so that C = 20 and Y = 01 for 2001 . If d denotes the day of the week, where d = 0 for Sunday, d = 1 for Monday, · · ·, d = 6 for Saturday, then d = N + [2.6M - 0.2] + Y + [Y/4] + [C/4] - 2C - ( 1 + L)[Mjl l] (mod 7) where L = 1 for a leap year and L = 0 for a nonleap year. For example, in the case of January 1, 2001, we have L = 0, so d = 1 + [28 .4] + 1 + [ 1/4] [20/4] - 40 - [11/11] = 1 ( mod 7) , and hence the first day of 2001 falls on a Monday. This formula holds for any date after 1582, following the adoption of the Gregorian calendar at that time. The leap years are those divisible by 4, except the years divisible by 100, which are leap years only if divisible by 400. For example, 1984, 2000, 2004, 2400 are leap years, but 1900, 1901, 2100, 2401 are not. Verify the correctness of the formula by establishing (i) that if it is correct for any date, then it is also correct for the date of the next succeeding day and also the immediately preceding day, and (ii) that it is correct for one particular day selected from the current calendar. PROBLEMS 1. What is the highest power of 2 dividing 533!? The highest power of 3? The highest power of 6? The highest power of 12? The highest power of 70? 2. If 100! were written out in the ordinary decimal notation without the factorial sign, how many zeros would there be in a row at the right end? 3. For what real numbers x is it true that (a) [x] + [x] = [2x ]? (b) [x + 3] = 3 + [x]? (c) [x + 3] = 3 + x? 4.1 Greatest Integer Function (d) [x + tl + [x - tl = [2x]? (e) [9x] = 9? 185 4. Given that [x + y] = [x] + [y] and [ -x - y] = [ -x] + [ -y], prove that x or y is an integer. 5. Find formulas for the highest exponent e of the prime p such that pe divides (a) the product 2 · 4 · 6 · · · (2n) of the first n even numbers; (b) the product of the first n odd numbers. 6. For any real number x prove that [x] + [x + tl = [2x]. 7. For any positive real numbers x and y prove that [ x] · [ y] � [ xy]. 8. For any positive real numbers x and y prove that [x -y ] � [x] - [y] � [x -y ] + 1. *9. Prove that (2n)!j(n!)2 is even if n is a positive integer. 10. Let m be any real number not zero or a positive integer. Prove that an x exists so that the equation of Theorem 4.1, part 6, is false. 11. If p and q are distinct primes, prove that the divisors of p2q 3 coincide with the terms of (1 + p + p2X1 + q + q2 + q 3) when the latter is multiplied out. 12. For any integers a and m ;;;. 2, prove that a - m[ajm] is the least non-negative residue of a modulo m. Write a similar expression for the least positive residue of a modulo m. *13. If a and b are positive integers such that (a, b) = 1, and p is a real number such that ap and bp are integers, prove that p is an integer. Hence prove that p = n!j(a!b!) is an integer if (a, b) = 1 and a + b = n + 1 . Generalize this to prove that n! p= -----a, !a2 ! ... a, ! is an integer if (a\" a20 ·· · ,a,) = 1 and a1 + a2 + · · · +a, = n + 1. [Note that the first part of this problem implies that the binomial coefficient ( ';: ) is divisible by m if (m, a) = 1. This follows by writing n = m - 1, so that (a, b) = 1 is equivalent to (a, m) = 1 .] *14. Consider an integer n ;;;. 1 and the integers i, 1 � i � n. For each k = 0, 1, 2, · · · find the number of i's that are divisible by 2k but not by 2 k+ 1 • Thus prove \"' [ n 1 ] L, j+ - =n j= l 2 2 186 Some Functions of Number Theory and hence that we get the correct value for the sum n /2 + n I 4 + n /8 + · · · if we replace each term by its nearest integer, using the larger one if two exist. *15. If n is any positive integer and g any real number, prove that [g) + [ g + �] + .. . + [ g + n : 1] = [ ng). 16. Prove that [2a] + [2�] ;;;. [a] + [�] + [a + �] holds for every pair of real numbers, but that [3a] + [3�] ;;;. [a] + [�] + [2a + 2�] does not. *17. For every positive integer n, prove that n!(n - 1)! is a divisor of (2n - 2)!. *18. If (m, n) = 1, prove that n E 1 [ mx ] = ( m - 1 )( n - 1) . x =l n 2 *19. If m ;;;. 1, prove that [(l + ,13)2m+ I ] is divisible by 2m+l but not by 2m+ 2. *20. Let 0 be real, and 0 < 0 < l. Define Prove that if [nO ] = [ (n - 1) 0] otherwise . g + g + ··· + g lim I 2 n = 0 . n-+ OO n *21 . Let n be an odd positive integer. If n factors into the product of 4 two integers, n = uv, with u > v and u - v � v64n ' prove that the roots of x2 - 2[Vn + 1]x + n = 0 are integers. (H) *22. Let a be a positive irrational number. Prove that the two sequences, [ 1 +a) , [2 + 2a) ,· · · , [ n + na] , - · · , and [ 1 + a - 1 ], [2 + 2a - 1 ], - • · , [n + na - 1 ], • • • together contain every positive integer exactly once. Prove that this is false if a is rational. *23. Let ./ be the set of integers given by [ax] and [�x] for x = 1, 2, · · · . Prove that ./ consists of every positive integer, each appearing exactly once, if and only if a and � are positive irrational 1 1 numbers such that - + - = l. a � 4.1 Greatest Integer Function 187 *24. For positive real numbers a, {3, 'Y define f(a, {3, 'Y) as the sum of all positive terms of the series (If there are no positive terms, define f(a, (3, 'Y) = O.) Prove that f(a, {3, 'Y) = f({3, a, 'Y ). (H) *25. For any positive integers a, b, n, prove that if n is a divisor of a\" - b\", then n is a divisor of (a\" - b\")j(a -b). (H) *26. Let d be the greatest common divisor of the coefficients of (x + y )\" except the first and last, where n is any positive integer > 1. Prove that d = p if n is a power of a prime p, and that d = 1 otherwise. *27. Let j and k be positive integers. Prove that ((j + k ) a] + [(j + k ) f3] ;;;. ( ja ] + ( jf3 ] + [ ka + k{3 ] for all real numbers a and {3 if and only if j = k. (This is a generalization of Problem 16.) (H) *28. Prove that of the two equations r rn + vn+I] = r rn + vn+Z] , [rn + �n + 1 ] = [rn + �n + z] the first holds for every positive integer n, but the second does not. *29. Evaluate the integral Jd!JJJ[x + y + z] dxdydz where the square brackets denote the greatest integer function. Generalize to n-dimensions, with an n-fold integral. 30. Show that (2a)!(2b)! j(a!b!(a + b)!) is an integer. 31. Let the positive integer m be written in the base d, so that m = L.;a;d; with 0 � a; < d for all i. Prove that a; = [mjdi- l] ­ d[mjdi]. 32. Write n in base p , and let S(n) denote the sum of the digits in this representation. Show that pe lln! where e = (n - S(n))j( p - 1). 33. Let the positive integers m and n be written in base d, say m = L.;a;d; and n = L.;b;d;. Show that when m and n are added, that there is a carry in the ith place (the place corresponding to di) if and only if {m/di+ l} + {n/di+ l} ;;;. 1. *34. Let a and b be positive integers with a + b = n. Show that the power of p dividing ( � ) is exactly the number of carries when a and b are added base p. 188 Some Functions of Number Theory *35. Suppose that a = ap + a0 and that 0 � a0 < p. Show that a!j(a!pa) = ( -l)aa0! (mod p). Suppose also that b = {3p + b0 with 0 � b0 < p. Show that ( a � b) = ( a : f3 )( ao :0 bo) (mod p). Deduce that if a = 'L;a;P; and b = 'L;b; P; in base p, then ( a � b ) = I! ( a; � b;) ( mod p) . *36. Show that the least common multiple of the numbers ( � ) . ( � ) . · · · , ( �) is l.c.m.(l, 2, - · · , n + 1) j(n + 1). **37. Show that if x is a real number and n is a positive integer, then L.k= 1[kx]/k � [nx]. 4.2 ARITHMETIC FUNCTIONS Functions such as cf>(n) of Theorem 2.5 that are defined for all positive integers n are called arithmetic functions, or number theoretic functions, or numerical functions. Specifically, an arithmetic function f is one whose domain is the positive integers and whose range is a subset of the complex numbers. Definition 4.1 For positive integers n we make the following definitions. d(n) is the number of positive divisors of n. u(n) is the sum of the positive divisors of n. uk(n) is the sum of ihe kth powers of the positive divisors of n. w(n) is the number of distinct primes dividing n . .O(n) is the number of primes dividing n, counting multiplicity. For example, d(l2) = 6, u(12) = 28, u2(12) = 210, w(12) = 2, and .0(12) = 3. These are all arithmetic functions. The value of k can be any real number, positive, negative, or zero. Complex values of k are useful in more advanced investigations. The divisor function d(n) is a special case, since d(n) = u0(n). Similarly, u(n) = u1(n). It is convenient to use the symbols L.d1nf(d) and nd1nf(d) for the sum and product of f(d) over all positive divisors d of n. Thus we write d( n) = L, 1, u( n) = L,d, din din 4.2 Arithmetic Functions 189 and similarly w( n) = L, 1, O( n) = L, a= L, 1 . p in In the formulae for O(n), the first sum is extended over all prime powers pa that exactly divide n, while the second sum is over all prime powers pf3 dividing n. Theorem 4.3 For each positive integer n, d(n) = 0 (a + 1). Palin In this notation, a = a(p) depends on the prime being considered, and on n. Those primes p not dividing n may be ignored, since a = 0 for such primes, and the factor contributed by such p is 1. If n = 1 then this is the case for all p, and we see that this formula gives d(l) = 1. Proof Let n = Opa be the canonical factorization of n. A positive integer d = Opf3 divides n if and only if 0 � {3(p) � a(p) for all prime numbers p. Since {3( p) may take on any one of the values 0, 1, · · · , a(p), there are a(p) + 1 possible values for {3(p), and hence the number of diviSOrS iS n Palin( a + 1). From Theorem 4.3 it follows that if (m, n) = 1 then d(mn) = d(m)d(n). Definition 4.2 lff(n) is an arithmetic function not identically zero such that f(mn) = f(m)f(n) for every pair of positive integers m. n satisfying (m, n) = 1, then f(n) is said to be multiplicative. lff(mn) = f(m)f(n) whether m and n are relatively prime or not, then f(n) is said to be totally multiplicative or completely multiplicative. If f is a multiplicative function, f(n) = f(n)f(l) for every positive integer n, and since there is an n for which f(n) * 0, we see that f(l) = 1. From the definition of a multiplicative function f it follows by mathe­ matical induction that if mi> m2, • • · , m, are positive integers are relatively prime in pairs, then In particular, this result would hold if the integers m1 , m2, • • ·, m, are prime powers of distinct primes. Since every positive integer > 1 can be factored into a product of prime powers of distinct primes, it follows that 190 Some Functions of Number Theory if f is a multiplicative function and we know the value of f(pa) for every prime p and every positive integer a, then the value of f(n) for every positive integer n can be readily determined by multiplication. For exam­ ple, /(3600) = f(24)f(32)f(5 2). Similarly, if g is a totally multiplicative function and we know the value of g(p) for every prime p, then the value of g(n) for every positive integer n can be readily determined. For example g(3600) = g(2)4g(3)2g(5)2• These basic properties can be stated in another way. First, if f and g are multiplicative functions such that f(pa) = g(pa) for all primes p and all positive integers a, then f(n) = g(n) for all positive integers n, so that f =g. Second, if f and g are totally multiplicative functions such that f(p) = g( p) for all primes p, then f = g. Theorem 4.4 Let f(n) be a multiplicative function and let F(n) = Ed1nf(d). Then F(n) is multiplicative. Proof Suppose that m = m 1m2 with (m i> m2) = 1. If dim, then we set d1 = (d, m 1) and d2 = (d, m2). Thus d = d1d2, d1 im 1, and d2 lm2. Con­ versely, if a pair d1, d2 of divisors of m 1 and m2 are given, then d = d1d2 is a divisor of m, and d1 = (d, m 1), d2 = (d, m2). Thus we have estab­ lished a one-to-one correspondence between the positive divisors d of m and pairs d1 , d2 of positive divisors of m 1 and m2• Hence F( m) = '[ J(d) = L, L, f( d1d2) di m d1 l m 1 d2 lm 2 for any arithmetic function f. Since (d1 , d2) = 1, it follows from the hypothesis that f is multiplicative that the right side is L, L, f(di )f(d2 ) = ( L, f(d1) )( L, f( d2)) = F( m 1 ) F(m2). d11 m 1 d2 lm 2 d11 m 1 d2 l m 2 We could have used this theorem and Definition 4.1 to prove that d(n) is multiplicative. Since d(n) = Ed1n1 is of the form Edlnf(d), and since the function f(n) = 1 is multiplicative, Theorem 4.4 applies, and we see that d(n) is multiplicative. Then Theorem 4.3 would have been easy to prove. If p is a prime, then d( pa) =a + 1, since pa has the a + 1 positive divisors 1, p, p2, • • ·, pa and no more. Then, since d(n) is multi­ plicative, 4.2 Arithmetic Functions 191 This exemplifies a useful method for handling certain arithmetic functions. We shall use it to find a formula for u(n) in the following theorem. However, it should be pointed out that u(n) can also be found quite simply in the same manner as we first obtained the formula for d(n). ( pa + l _ 1 ) Theorem 4.5 For every positive integer n, u(n) = 0 Palin p- 1 . In case n = 1, a = 0 for all primes p, so that each factor in the product is 1, and the formula gives u(l) = 1. Proof By definition u(n) = Ed1nd, so we can apply Theorem 4.4 with f(n) = n, F(n) = u(n). Thus u(n) is multiplicative and u(n) = Ou(pa). But the positive divisors of pa are just 1, p, p2, • • ·, pa whose sum is (pa + I _ l)j(p _ 1). Theorem 4.6 For every positive integer n, L, </J(d) = n. din Proof Let F(n) denote the sum on the left side of the proposed identity. From Theorem 2. 19 we see that </J(n) is multiplicative. Thus F(n) is multiplicative, by Theorem 4.4. Since the right side, n, is also a multiplica­ tive function, to establish that F(n) = n for all n it suffices to prove that F(pa) = pa for all prime powers pa. From Theorem 2.15 we see that if {3 > 0 then </J(p13) = pf3 - pf3 - •. Thus a a F(pa) = L, </J(d) = L, <!J(pf3) = 1 + L, pf3 - pf3 - t = pa. �� (3 - 0 {3 - 1 Theorem 4.6 can be proved combinatorially, as follows. Let n be given, and put ../= {1, 2, · · ·, n}. For each divisor d of n, let � be the subset of those members k e ._/ for which (k, n) =d. Clearly each member of ../ lies in exactly one of the subsets �- (In such a situation we say that the subsets partition the set.) We note that k e � if and only if k is of the form k = jd where (j, njd) = 1 and 1 � j � njd. Thus by Theorem 2.5 we deduce that � contains precisely </J(njd) numbers. Since ._/ contains exactly n numbers, it is now evident that n = Ed1n<P(njd). This is an alternative formulation of the stated identity. PROBLEMS 1. Find the smallest integer x for which </J(x) = 6. 2. Find the smallest integer x for which d(x) = 6. 192 Some Functions of Number Theory 3. Find the smallest positive integer n so that u( x) = n has no solu­ tions; exactly one solution; exactly two solutions; exactly three solu­ tions. 4. Find the smallest positive integer m for which there is another positive integer n #- m such that u(m) = u(n). 5. Prove that Odin d = nd<n>l2• 6. Prove that Edln d = Edln njd, and more generally that Edln f(d) = Edln f(n /d). 7. Prove that u -k(n) = n -kuk(n). 8. Find a formula for uk(n). 9. If f(n) and g(n) are multiplicative functions, and g(n) #- 0 for every n, show that the functions F(n) = f(n)g(n) and G(n) = f(n)jg(n) are also multiplicative. 10. Give an example to show that if f(n) is totally multiplicative, F(n) need not also be totally multiplicative, where F(n) is defined as [.din f(d). 11. Prove that the number of positive irreducible fractions � 1 with denominator � n is q,(l) + 4>(2) + <f>(3) + · · · + <f>(n). 12. Prove that the number of divisors of n is odd if and only if n is a perfect square. If the integer k � 1, prove that uk(n) is odd if and only if n is a square or double a square. 13. Given any positive integer n > 1, prove that there are infinitely many integers x satisfying d( x) = n. 14. Given any positive integer n, prove that there is only a finite number of integers x satisfying u( x) = n. 15. Prove that if (a, b)> 1 then uk(ab) < uk(a)uk(b) and d(ab) < d(a)d(b). 16. We say (following Euclid) that m is a perfect number if u(m) = 2m, that is, if m is the sum of all its positive divisors other than itself. If zn - 1 is a prime p, prove that zn - tp is a perfect number. Use this result to find three perfect numbers. 17. Prove that an integer q is a prime if and only if u(q) = q + 1. 18. Show that if u(q) = q + k where klq and k < q, then k = 1 . 19. Prove that every even perfect number has the form given in Problem 16. (H) 20. For any positive integer let .\\(n) = ( -1)0<n>. This is Liouville's lambda function. Prove that .\\(n) is totally multiplicative, and that L A(d) = {� din if n is a perfect square otherwise . 4.3 The Mobius Inversion Formula 193 *21. For any positive integer n prove that </J(n) + u(n) ;;;. 2n, with equal­ ity if and only if n = 1 or n is a prime. *22. (a) If m</J(m) = n<jJ(n) for positive integers m and n, prove that m = n. (b) Given an example to show that this result does not hold if <P is replaced by u. (H) *23. Show that the sum of the odd divisors of n is - I:dln ( - l)n fdd, and that this is u(n) - 2u(n/2) where u(a) is defined to be 0 if a is not an integer. *24. Show that I:dln d(d)3 = O::d,n d(d))2 for all positive integers n. *25. Show that for all positive integers n, n L, (a - 1, n) = d( n)<P(n) . a= I (a, n) = l 4.3 THE MOBIUS INVERSION FORMULA Definition 4.3 For positive integers n put iJ-(n) = ( -l)w<n> if n is square free, and set iJ-(n) = 0 otherwise. Then iJ-(n) is the Mobius mu function. Theorem 4.7 The function iJ-(n) is multiplicative and if n = 1 if n>l . Proof It is clear from the definition that �J-(n) is multiplicative. If F(n) = I:dln iJ-(d), then F(n) is multiplicative by Theorem 4.4. Clearly F(l) = �J-0) = 1. If n > 1, then a > 0 for some prime p, and in this case F(pa) = I:� =o 1J-(pf3) = 1 + ( -1) = 0, and we have the desired result. An alternative formulation of this proof is obtained by considering those square-free divisors d of n with exactly k prime factors. There are ( w�n) ) such divisors, each one contributing �J-(d) = ( -l)k. Thus by the binomial theorem, the sum in question is 194 Some Functions of Number Theory Theorem 4.8 Mobius inversion formula. If F(n) = Edin f(d) for every positive integer n, then f(n) = Edin �J-(d)F(njd). Proof We see that 'f. IL(d) F(n/d) = 'f. IL( d) E f( k) din din ki(njd) = E IL(d) f(k) dkin where the last sum is to be taken over all ordered pairs (d, k) such that dk ln. This last formulation suggests that we can reverse the roles of d and k to write the sum in the form 'Ef( k) E IL(d) kin di(njk) and this is f(n) by Theorem 4.7. Theorem 4.9 If f(n) = Ed!niL(d)F(njd) for every positive integer n, then F(n) = Edinf(d). Proof First we write 'Ef( d) = E 'E IL(k ) F( d/k). din din kid As k runs through the divisors of d, so does djk, and hence this sum can be written as E 'f. IL(d/k) F( k) . din kid In this double sum, F(k) appears for every possible divisor k of n. For each fixed divisor k of n, we collect all the terms involving F(k). The coefficient is the set of aii �J-(djk), where djk is a divisor of njk or, more simply, the set of all �J-(r), where r is a divisor of njk. It follows that the last sum can be rewritten as E E IL( r) F( k) . kin ri(njk) By Theorem 4.7, we see that the coefficient of F(k) here is zero unless njk = 1, so the entire sum reduces to F(n). 4. 3 The Mobius Inversion Formula 195 It should be noted that Theorem 4.8 and its converse, Theorem 4.9, do not require that f(n) or F(n) be multiplicative. On inserting the identity of Theorem 4.6 in the inversion formula of Theorem 4.8, we find that <P( n ) = n L J.L(d)jd. (4.1 ) din Here the summand is multiplicative, so that by Theory 4.4 we see once more that <fJ(n) is multiplicative. Indeed, if n is a prime power, say n = p a, then a L J.L( d) jd = L J.L( P13)jp13 = 1- 1jp . dlpa f3 � 0 This, with (4.1), gives again the formula for q,(n) in Theorem 2.15. PROBLEMS 1. Find a positive integer n such that J.L(n) + J.L(n + 1) + J.L(n + 2) = 3. 2. Prove that J.L(n)J.L(n + l)J.L(n + 2)J.L(n + 3) = 0 if n is a positive integer. 3. Evaluate r:;� 1 J.L(j!). 4. Prove Theorem 4.9 by defining G(n) as Edln f(d), then apply­ ing Theorem 4.8 to write f(n) = Edln J.L(d)G(njd). Thus Ed!n J.L(d)G(njd) = Ed[n J.L(d)F(njd). Use this to show that F(l) = G(l), F(2) = G(2), F(3) = G(3), and so on. 5. Prove that for every positive integer n. Ed1n 1J.L(d)l = 2w<n>. 6. If F(n) = Edln f(d) for every positive integer n, prove that f(n) = Ed!n J.L(njd)F(d). 7. Prove that for every positive integer n, Ed!n J.L(d)d(d) = ( - l)w<n>. Similarly, evaluate Ed!n J.L(d)O'(d). 8. If n is any even integer, prove that Ed!n J.L(d)<fJ(d) = 0. 9. By use of the algebraic identity (x + 1)2 - x 2 = 2x + 1, establish that (n + 1)2 - 12 = E� _ 1{(x + 1)2 -x 2} = E� � 1(2x + 1) and so derive the result I:�� 1 x = n(n + 1) /2. 10. By use of the algebraic identity (x + 1)3 - x3 = 3x 2 - 3x + 1 estab­ lish that (n + 1)3 - 13 = E� � 1{(x + 1)3 - x3} = E�� 1(3x 2 + 3x + 1), and so derive the result E� � 1x 2 = n(n + 1X2n + 0/6. (The results of this and the preceding problem can be established by other methods, mathematical induction, for example.) 4.4 Recurrence Functions 197 *22. For each positive integer n let 9'(n) denote the set of those positive integers m such that 1/J(m) = n. Show that for every positive integer n, L, iJ-(m) = 0. m E .'T(n) *23. Suppose that f(n) is an arithmetic function whose values are all nonzero, and put F(n) = nd1nf(d). Show that f( n ) = n dln F( n/d) JL<d> for all positive integers n. n *24. Show that 0 a = n<t><n>nd1n(d!jdd)JL<nfd>. a= I (a,n) = l 25. We call a complex number { an nth root of unity if {n = 1. Show that {is an nth root of unity if and only if {is one of the n numbers e2\"'iafn where a = 1, 2, · · ·, n. We call { a primitive nth root of unity if n is the least positive integer such that {n = 1. Show that among the nth roots of unity, { = e2\"'ia/n is a primitive nth root if and only if (a, n) = 1. *26. Let <l>n(x) denote the polynomial with leading coefficient 1 and degree 1/J(n) whose roots are the 1/J(n) different primitive nth roots of unity. Prove that nd1n<l>/x) = x n - 1 for all real or complex numbers X. Deduce that <l>n(x) = ndln(x d - l)JL(njd). Show that the coeffi­ cients of <l>n(x) are integers. This is the cyclotomic polynomial of order n. 27. Let F(n) - E: = 1e2\"'ia/n. Show that F(l) = 1, and that F(n) = 0 for all n > 1. (H) n *28. Show that for each positive integer n, L, e2\"'iafn = iJ-(n). a=l (a, n) = I *29. Let p be prime, and let <I>P _ 1(x) denote the cyclotomic polynomial of order p - 1. Show that g is a solution of the congruence <I>P _1(x) = 0 (mod p) if and only if g is a primitive root (mod p ). Slow also that the sum of all the primitive roots (mod p) is = iJ-( p - 1) (mod p ). 4.4 RECURRENCE FUNCTIONS We say that the arithmetic function f(n) satisfies a linear recu\"ence (or recursion) if f(n) = af(n - 1) + bf(n - 2) for n = 2, 3, · · · . Here a and b are fixed numbers, which may be real or even complex. For brevity we write un for f(n). In this notation the recurrence under consideration is (4 .2) 198 Some Functions of Number Theory Our investigation follows the method used to analyze solutions of the differential equation y\" = ay' + by with constant coefficients, though the details are simpler in the present situation. Let A be a root of the polynomial Q(z) = z2 - az - b. Here A may be complex, even if a and b are real. We note that A2 = a A + b, and on multiplying both sides by A n - 2 we see that A n = aA n - l + bA n - 2 for all integers n ;;.. 2. That is, the sequence u n = A n satisfies the recurrence (4.2). If Q(z) has two distinct roots, say A and !J-, then we obtain two different solutions A n and IL n of (4.2). Suppose that u n and vn are two solutions of (4.2), and put wn = aun + f3vn where a and f3 are fixed real or complex numbers. Then for n ;;.. 2, and thus wn is also a solution of (4.2). Hence we see that any linear combination of solutions of (4.2) is again a solution of (4.2). (Consequently the set of solutions forms a vector space in the abstract sense.) In particular, the sequence (4.3) is a solution of (4.2), for any values of the constants a and {3. Next we consider the initial conditions of our sequence un. Suppose we are given two real or complex numbers x0 and x 1• We note that there is precisely one sequence un such that u 0 = x0, u 1 = x1, and which has the property that (4.2) holds for all integers n ;;.. 2. If the numbers a and {3 in (4.3) can be chosen so that (4.4) then the sequence vn given in (4.3) satisfies the initial conditions v0 = x0, v1 = x1, and also (4.2), and hence un = vn for all n. The equations (4.4) constitute two simultaneous linear equations in the two variables a and {3. The determinant of the coefficient matrix is IL - A * 0, and thus the equations (4.4) have a unique solution, for any given values of x0 and x 1 • In the language of linear algebra, our argument thus far can be expressed succinctly as follows: We observe that the set of solutions of (4.2) form a vector space. If A is a root of the polynomial Q(z), then the 4.4 Recurrence Functions 199 sequence An is a solution. Since a solution is uniquely determined by the values of u0 and up the space of solutions has dimension 2. If A and IL are distinct roots of Q(z), then An and ILn are linearly independent members of the space, and hence they form a basis. Whether we use this terminol­ ogy or not, we have proved the following theorem. Theorem 4.10 Let a, b, x0, and x1 be given real or complex numbers, with b * 0. Suppose that the polynomial Q(z) = z 2 - az - b has two distinct roots, say A and IJ-, and let un be the unique sequence for which u0 = x0, u1 = x 1 and for which (4.2) holds for all n � 2. Take a and {3 so that the equations (4.4) are satisfied. Then ( 4.5) for n = 0, 1, 2, · · · . Conversely, if we begin with a sequence of the form (4.5), then by taking a = A + IL and b = -AIJ-, we find that A and IL are roots of the polynomial Q(z) = z 2 - az - b, and hence the sequence (4.5) satisfies (4.2) for this choice of a and b. That is, any sequence of the form (4.5) satisfies a linear recurrence. By excluding the case b = 0 we have ensured that A * 0 and IL * 0. Thus there is no difficulty in interpreting (4.5) when n = 0. If b = 0, then (4.2) defines a geometric progression, and it may be proved by induction that un = u 1an - l for all n � 2. The theory thus far is entirely analytic, but a contact is made with number theory when we consider sequences un satisfying a linear recur­ rence, with un taking only integer values. For example, the Fibonacci numbers F0, Fp · · · are defined by the relations F0 = 0, F1 = 1, and Fn = Fn _ 1 + Fn _ 2 for n � 2. Thus the first few Fibonacci numbers are 0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144. Taking a = b = 1, we find that Q(z) has distinct real roots A = (1 + .fS)/2 and IL = (1 - .fS)/2. The equa­ tions (4.4) have the single solution a= 1;.[5, {3 = -1 ;.[5, so we deduce that F = -1 (1 +.f5 )n _ _ 1 (1 - .fS )n n .[5 2 .[5 2 ( 4.6) for n = 0, 1, 2, · · · . In this example, -1 < IL < 0, and the term f31Ln tends to 0 rapidly as n tends to infinity. Thus aAn is very near an integer for large n. Indeed, Fn is the integer nearest aAn for all non-negative integers n, and we see that aAn is slightly larger than Fn if n is even, and that aAn is slightly smaller than Fn if n is odd. The Lucas numbers Ln are determined by the relations L 1 = 1, L2 = 3, and Ln = Ln - l + Ln _ 2 for n > 2. (The French name Lucas is 200 Some Functions of Number Theory pronounced \"Lu · kah\"'.) By Theorem 4.10 we deduce that ( 4.7) for n = 1, 2, 3, · · · . We note that the Fn and Ln satisfy the same recur­ rence, but with different initial conditions. As another example, we consider the sequence 0, 1, 3, 8, 21, · · · , for which u0 = 0, u 1 = 1, a = 3, and b = -1. Then A = (3 + .fS)/2 and IL = (3 - .fS)/2, and by solving the equations (4.4) we deduce that U = _1 ( 3 + .f5 )n __ 1 ( 3- .f5 )n n {5 2 .f5 2 for n = 0, 1, 2, · · · . Here 0 < IL < 1 so that 0 < f31Ln < 1 for all non­ negative n. Hence in this case we may express un using the greatest integer notation, = [-1 ( 3 + .f5 )n] Un {5 2 . Suppose that a sequence un is generated by the recurrence (4.2). We have developed a method by which we may find a formula for un, but this method fails if the polynomial Q(z) = z2 - az - b has a double root A instead of two distinct roots A and IL · In the case of a double root, the polynomial Q(z) factors as Q(z) = (z - A)2, and on expanding we find that a = 2A and b = -A2• That is, a2 + 4b = 0 in this case. Conversely, if a2 + 4b = 0, then by the formula for the roots of a quadratic polynomial we see that Q(z) has a double root. We now extend our method to deal with this situation. Theorem 4.1 1 Let a, b, x0, and x1 be given real or complex numbers, with a2 + 4b = 0 and b * 0. Suppose that A is a root of the polynomial Q(z) = z2 - az - b, and let un be the unique sequence for which u0 = x0, u, = x1 and for which (4.2) holds for all n � 2. Take a and {3 so that Then fcor n = 0 1 2 · · · , , , (4.8) (4 .9) 4. 4 Recurrence Functions 201 Proof The hypothesis b .;:. 0 ensures that A .;:. 0, and hence the system (4.8) of linear equations has a unique solution, for any given values of u0 and u1 • We know that the sequence An satisfies the linear recurrence (4.2). The hypothesis a2 + 4b = 0 implies that A = aj2. We multiply both sides of this by 2An - J to see that 2An = aAn - l. On the otherhand, we know that A2 = aA +b. We multiply both sides of this by (n - 2)An - 2 and add the resulting identity to the preceding equation, to find that nAn = a(n - l)An -J + b(n - 2)An - 2 for all integers n � 2. That is, the sequence nAn is also a solution of (4.2). A linear combination of solutions of (4.2) is again a solution of (4.2), and thus the expression in (4.9) is a solution of (4.2) for any choice of a and {3. To ensure that this expression gives the desired sequence, it suffices to choose a and {3 so that u0 = x0 and u1 = x1 • That is, we take a and {3 so that the equations (4.8) hold. Remark on Calculation Suppose that the numbers a, b, x0, and x1 in Theorem 4.10 are all integers, and let D = a2 + 4b denote the discrimi­ nant of the quadratic polynomial Q(z ). Thus D .;:. 0, since the roots A and IL are assumed to be distinct. By using (4.2) and mathematical induction, we see that un is an integer for all non-negative n. In case D is a perfect square, the value of un may be determined quickly from (4.5), but otherwise A and IL are irrational, and (4.5) is not conducive to calculating exact values. We may use (4.2) instead, but this is slow (involving = n arithmetic operations) if n is large. We now develop a method by which un may be quickly determined, using only integer arithmetic. Let a and b be fixed integers. Among the sequences satisfying (4.2), two are especially notable. We denote them by Un and V,.. They are determined by (4.2) and the initial conditions ( 4.10) By Theorem 4.10 it follows that Un = (An - 1Ln ) j{i5 , Vn =An + ILn ( 4.11) for n = 0, 1, 2, · · · . Alternatively, we could take (4.11) to be the definition and show that the sequences so defined satisfy (4.2) and (4.10). These are the Lucas functions, named for the French mathematician who investi­ gated their properties in the late nineteenth century. We assume that the values of a and b are fixed, but whenever their values are at issue we write Un(a, b), Vn(a, b). Note that Fn = Un(l, 1), and that Ln = V,.(l, 1). From (4.11) it follows that An = ( Vn + Un{i5)j2, ILn = ( Vn - Un{i5)j2. ( 4.12) 204 Some Functions of Number Theory one sample result. Suppose that a and b are given real or complex numbers and that the sequence un satisfies (4.2) for all n � 2. If there are at least five different positive integers n for which un = 0, then there is an arithmetic progression .W such that un = 0 for all positive integers n e .W. At a more advanced level, the equation (4.2) is called a linear recu\"ence of order 2. In Appendix A.4 we use power series generating functions to develop the analytic theory of linear recurrences of order k. (The use of power series in this context is analogous to the use of the Laplace transform in the study of linear differential equations.) PROBLEMS 1. Find a formula for un if un = 2un-l - un-2> U o = 0, ul = 1. Also if u0 = 1 and u 1 = 1. 2. Prove that any two consecutive terms of the Fibonacci sequence are relatively prime. 3. Prove that the Fibonacci numbers satisfy the inequalities (1 +vfs )n-l (1 +vfs )n 2 < Fn+l < 2 if n > 1. 4. Prove that for n � 2, Fn = { n � 1 ) + { n � 2 ) + { n ; 3 ) + { n ; 4) + . . . + (; � i ) where the sum of the binomial coefficients on the right terminates with the largest j such that 2j � n + 1. (H) 5. Prove that F1 + F2 + F3 + · · · +Fn = Fn+2 - 1. 6. Prove that Fn+ 1Fn-l - Fn2 = ( -l)n. 7. Prove that Fm+n = Fm_1Fn + FmFn+l for any positive integers m and n. Then prove that Fm1Fn if min. (H) 8. By induction on n, prove that Ln = Fn-l + Fn+l for all positive n. Then use (4.6) to give a second proof of (4.7). 9. Let u0 and u 1 be given, and for n � 2 put un = (un-l + un_2)/2. Show that lim n -.. .. un exists, and that it is a certain weighted average of u0 and u 1• 10. If the Euclidean algorithm is applied to the positive integers b and c, b � c, then rj = (b, c) for some j, and rj+l = 0. Put E(b, c) = j + 1, so that E(b, c) is the number of divisions performed in executing the algorithm. Show that E( Fn+2 , Fn+l) = n for all positive integers n. 206 Some Functions of Number Theory *22. Let p be a prime number. Show that FP = ( �) (mod p ). Show that FP + 1 = 1 (mod p) if p = ± 1 (mod 5), and that FP + 1 = 0 (mod p) if p = ± 2 (mod 5). Show that FP _ 1 = 0 (mod p) if p = ± 1 (mod 5), and that Fe _ 1 = 1 (mod p) if p = ± 2 (mod 5). Conclude that if p = ± 1 (mod 5 J then p - 1 is a period of Fn (mod p ). (This is not necessarily the least period.) Conclude also that if p = ± 2 (mod 5) then 2p + 2 is a period of Fn (mod p). *23. Find the most general sequence of real or complex numbers un such that for n � 2 (a) un = 5un _1 - 6un _2 , or (b) un = 5un _1 - 6un _ 2 + 1, or (c) un = 5un - l - 6un _ 2 + n. *24. Let f(n) be the sum of the first n terms of the sequence 0, 1, 1, 2, 2, 3, 3, 4, 4, · · · . Construct a table for f(n). Prove that f(n) = [n2 /41. For integers x and y with x > y, prove that .xy = f( x + y) - f( x - y ). Thus the process of multiplication can be replaced by an addition, a subtraction, looking up two numbers in the table, and subtracting them. *25. Show that [(1 + v'J)2n] + 1 and [(1 + v'J)2n + 1 ] are both divisible by 2n+ I. Are they divisible by any higher power of 2? *26. Show that if p is an odd prime then [(2 + vfs)P] = 2 p+ I (mod 20p). *27. Let the sequence un be determined by the relations u 1 = 0, u2 = 2, u3 = 3, and un + l = un - I + un _ 2 for n � 3. Prove that if p is prime then p iuP. (The least composite number with this property is 271,441 = 5212.) *28. Show that v2n + I = vnvn + I - a( - b )n. Explain how this formula and the duplication formula (4. 13) can be used to compute the triple (V2n> v2n + I> ( - b)2n), if the triple (V,., vn + I• ( -b)n) is known. Simi­ larly, explain how the triple (V2n + 1 ,V2n + 2,( -b)2n+ I) can be com­ puted in terms of the triple ( vn' vn + I' (- b )n ). Explain how this triple can be determined for general n by using these two operations. (This method is not very much more efficient than the method described in the text, but it involves less work in the special case b = - 1. By constructing congruential analogues of the identities in Problem 18 one may see that for purposes of constructing Lucas pseudoprime tests this does not involve any loss of generality.) 4.5 COMBINATORIAL NUMBER THEORY Combinatorial mathematics is the study of the arrangements of objects, according to prescribed rules, to count the number of possible arrange­ ments or patterns, to determine whether a pattern of a specified kind exists, and to find methods of constructing arrangements of a given type. 4.5 Combinatorial Number Theory 207 In this section, we treat a few elementary combinatorial problems of number theory, especially those that can be solved by the use of two simple ideas. First, if n sets contain n + 1 or more distinct elements in all, at least one of the sets contains two or more elements. This is sometimes familiarly called the pigeonhole principle, the idea being that if one places n + 1 letters in n slots (called \"pigeonholes\") then there is a pigeonhole containing more than one letter. The second idea is the one-to-one correspondence procedure, used to pair off elements in a finite set or between two sets to determine the number of elements or to prove the existence of an element of a specified kind. Arguments of this sort were already used in the earlier parts of this book, such as in Theorem 2.6, where it was proved that the map x - ax permits residue classes (mod m) if (a, m) = 1, and in Fermat's theorem (Lemma 2.13) concerning p = a2 + b2. The proofs of these theorems reveal that while the two basic arguments outlined in the preceding paragraph are very easy to comprehend, their application to specific problems is another matter. The difficulty lies in determining the set or sets to which these basic arguments should be applied to yield fruitful conclusions. Here are a few illustrations of standard methods. Example 1 Given any m + 1 integers, prove that two can be selected whose difference is divisible by m. Since there are m residue classes modulo m, two of the integers must be in the same class, and so m is a divisor of their difference. In this and most other problems in this section, the statement is the best possible of its kind. In Example 1, we could not replace the opening phrase by \"Given any m integers,\" because the integers 1, 2, 3, · · ·, m do not have the property that two can be selected whose difference is divisible by m. Example 2 Given any m integers a\" a2, • • · , a m , prove that a nonempty subset of these can be selected whose sum is a multiple of m. Solution Consider the m + 1 integers consisting of zero and the sums of special subsets of the integers. By Example 1, two of these m + 1 integers have a difference that is a multiple of m, and the problem is solved. Example 3 Let ./ be a set of k integers. If m > 1 and 2k > m + 1, prove that there are two distinct nonempty subsets of ./, the sums of 208 Some Functions of Number Theory whose elements are congruent modulo m. Prove that the conclusion is false if 2 k = m + 1. Solution The set ../, containing k elements, has 2k subsets in all, but only 2k - 1 nonempty subsets. For each of these nonempty subsets, consider the sum of the elements, so that there are 2k - 1 of these sums. Since 2k - 1 > m, two of these sums are in the same residue class modulo m, and so are congruent (mod m). In case 2k = m + 1, define ../ as the set {1, 2, 4, 8, · · ·, 2k - 1}, with k elements each of a power of 2. It is not difficult to see that the sums of the nonempty subsets of ../ are precisely the natural numbers 1, 2, 3, · · ·, 2k - 1, each occurring once. One way to see this is to observe that the elements of ../, when written to base 2, can be expressed in the form 1, 10, 100, 1000, · · · , 10k - 1. The sums of the non empty subsets are then all the integers, in base 2, 1, 10, 11, 100, 101, 111,· ··,1 11 . .. 1 11 where the last integer here contains k digits 1 in a row. Example 4 If ../ is any set of n + 1 integers selected from 1, 2, 3, · · ·, 2n, prove that there are two relatively prime integers in ../. Solution The set ../ must contain one of the pairs of consecutive integers 1, 2 or 3, 4 or 5, 6 or · · · or 2n - 1, 2n. Example 5 Find the number of integers in the set ../= {1, 2, 3, · · · , 6300} that are divisible by neither 3 nor 4; also the number divisible by none of 3, 4, or 5. Solution Of the 6300 integers in ../, exactly 2100 are divisible by 3, and 1575 are divisible by 4. The subtraction 6300 - 2100 - 1575 does not give the correct answer to the first part of the problem, because the sets removed by subtraction are not disjoint. Those integers divisible by 12 have been removed twice. There are 525 such integers, so the answer to the first part of the problem is 6300 - 2100 - 1575 + 525 = 3150. Turning to the second part of the problem, we begin by removing from the set ../ those integers divisible by 3, in number 2100, those divisible by 4, in number 1575, and those divisible by 5, in number 1260. So we see that 6300 - 2100 - 1575 - 1260 4. 5 Combinatorial Number Theory 209 is a start toward the answer. However, integers divisible by both 3 and 4 have been removed twice; likewise, those divisible by both 3 and 5 and those divisible by both 4 and 5. Hence, we add back in 6300/12 or 525 of the first type, 6300/ 15 or 420 of the second type, and 6300/20 or 315 of the third type to give 6300 - 2100 - 1575 - 1260 + 525 + 420 + 315 . This is still not the final answer, because one more adjustment must be made, for the integers 50, 120, 180, · · · that are divisible by 3, 4, and 5. Such integers are counted once in each term of the expression above, and so the net count for each such integer is 1. There are 6300/60 or 105 such integers, so if we subtract this number we get the correct answer, 6300 - 2100 - 1575 - 1260 + 525 + 420 + 315 - 105 = 2520 . The Inclusion-Exclusion Principle Example 5 illustrates a basic combinato­ rial argument as follows: Consider a collection of N objects of which N(a) have a certain property a, N(f3) have property {3, and N( 'Y) have property 'Y· Similarly, let N(a, {3) be the number having both properties a and {3, and N(a, {3, y) be the number having properties a, {3, and 'Y· Then the number of objects in the collection having none of the properties a, {3, 'Y is N- N(a) - N(/3 )- N( y) + N( a, /3 ) + N( a, y ) + N( f3, y )- N( a, {3 , y ) ( 4.15) This is the inclusion-exclusion principle in the case of three properties. The proof of (4.15) can be given along the same lines as in Example 5: First, that an object having exactly one of the properties, say {3, is counted once by N and once by N(f3) for a net count of 1 - 1 or 0; that an object having exactly two of the properties has a net count of 1 - 1 - 1 + 1, again 0; next, that an object with all three properties has a net count of 1 - 1 - 1 - 1 + 1 + 1 + 1 - 1, again 0. On the other hand, an object having none of the properties is counted by N once in (4. 15), and so a net count of 1. The extension of (4.15) to a collection of N objects having (variously) k properties is very natural. Where ( 4.15) has three terms of the type N(a), the general formula has k such terms; where (4. 15) has three terms of the type N(a, /3), the general formula has k(k - l)j2 such terms; and so on. It may be noted that the inclusion-exclusion principle can be used to give an entirely different proof of the formula for the evaluation of the Euler function cf>(n), as set forth in Theorem 2. 15. Because that result has been proved in full detail already, we make the argument in the case of an 210 Some Functions of Number Theory integer n having exactly three distinct prime factors, say p, q, and r. The problem is to determine the number of integers in the set ./= {1, 2, 3, · · · , n} having no prime factor in common with n. Let an integer in the set ./ have property a if it is divisible by p, property {3 if it is divisible by q and property y if it is divisible by r. A direct application of (4. 15) gives n- njp - njq - njr + njpq + njpr + njqr - njpqr = n( 1 - 1jp) ( 1 - 1jq )( 1- 1/r) as the number of integers in the set ./ divisible by none of p, q, or r. PROBLEMS 1. Given any m integers none of which is a multiple of m , prove that two can be selected whose difference is a multiple of m. *2. If ./ is any set of n + 1 integers selected from 1, 2, 3, · · ·, 2n + 1, prove that ./ contains two relatively prime integers. Prove that the result does not hold if ./ contains only n integers. *3. For any positive integers k and m > 1, let ./ be a set of k integers none of which is a multiple of m. If k > m/2, prove that there are two integers in ./ whose sum or whose difference is divisible by m . *4. Let the integers 1, 2, · · · , n be placed in any order around the circumference of a circle. For any k < n, prove that there are k integers in a consecutive block on the circumference having sum at least (kn + k)/2. •s. Given any integers a, b, c and any prime p not a divisor of ab, prove that ax2 + by2 = c (mod p) is solvable. *6. Let k and n be integers satisfying n > k > 1. Let ./ be any set of k integers selected from 1, 2, 3, · · · , n. If 2k > kn, prove that there exist two distinct nonempty subsets of ./ having equal sums of elements. *7. Let n and k be positive integers with n > k and (n, k) = 1. Prove that if k distinct integers are selected at random from 1, 2, · · · , n, the probability that their sum is divisible by n is 1/n. *8. Say that a set ./ of positive integers has property M if no element of ./is a multiple of another. (a) Prove that there exists a subset ./of {1, 2, 3, · · · , 2n} containing n elements with property M but that no subset of n + 1 elements has property M. (b) Prove the same results for subsets ./ of {1, 2, 3, · · · , 2n - 1}. (c) How many elements are there in the largest subset ./ of {1, 3, 5, 7, · · · , 2n - 1} having prop­ erty M ? Notes on Chapter 4 211 9. Prove that among any ten consecutive positive integers at least one is relatively prime to the product of the others. [Remark: if \"ten\" is replaced by \"n\", the result is true for every positive integer n � 16, but false for n > 16. This is not easy to prove; cf. R. J. Evans, \"On blocks of n consecutive integers,\" Amer. Math. Monthly, 76 (1969), 48.] *10. Let a1 , a 2, . · · ,an be any sequence of positive integers. Let k be the total number of distinct prime factors of the product of the integers. If n � 2k, prove that there is a consecutive block of integers in the sequence whose product is a perfect square. *11. For every positive integer n, construct a minimal set ../ of integers having the property that every residue class modulo n occurs at least once among the sums of the elements of the nonempty subsets of ../. For example, if n = 6, ../= {1, 3, 5) will do because every residue class modulo 6 appears among 1, 3, 5, 1 + 3, 3 + 5, 1 + 5, 1 + 3 + 5. *12. Let n and k be positive integers such that 1 � k � (n2 + n)j2. Prove that there is a subset of the set {1, 2, 3, · · · , n) whose sum is k. *13. For any integer k > 1, prove that there is exactly one power of 2 having exactly k digits with leading digit 1, when written in standard fashion to base 10. For example 2 4 = 16, 27 = 128. Prove also that there is exactly one power of 5 having exactly k digits with leading digit not equal to 1. *14. For any positive integer n, prove that 5n has leading digit 1 if and only if 2n + 1 has leading digit 1. Hence, prove that the \"probability\" that a power of 2 has leading digit 1 is log 2/log 10 and that this is also the \"probability\" that a power of 5 has leading digit 1. By \"probability,\" we mean the limit as n tends to infinity of the probability that an arbitrarily selected integer from 2, 2 2, 23, • • ·, 2n has leading digit 1, and similarly for powers of 5. 15. Let n be a positive integer having exactly three distinct prime factors p, q and r. Find a formula for the number of positive integers � n that are divisible by none of pq, pr, or qr. NOTES ON CHAPTER 4 §4.4 The book by N. J. A. Sloane listed in the General References is very useful in trying to identify or classify a given sequence of integers of an unknown source. The analytic theory of linear recurrences is developed further in Appendix A.4. CHAPTER 5 Some Diophantine Equations We often encounter situations in which we wish to find solutions of an equation with integral values of the variables, or perhaps rational values. Sometimes we seek solutions in non-negative integers. In any of these cases we refer to the equation as a Diophantine equation, after the Greek mathematician Diophantus who studied this topic in the third century A.D. We restrict our attention to equations involving polynomials in one or more variables. There is no universal method for determining whether a Diophantine equation has a solution, or for finding them all if solutions exist. However, we are quite successful in dealing with polynomials of low degree, or in a small number of variables. In addition to the material in this chapter, an introductory discussion of ax + by = c is given in Section 1.2, the equation x2 + y 2 = n is discussed in Sections 2.1 and 3.6, the equation x2 + y2 + z 2 + w2 = n is treated in Section 6.4, Pell's equation, x2 - dy2 = N, is treated in Chapter 7, by means of continued fractions, and further equations are investigated in Chapter 9, using the arithmetic of quadratic number fields. 5.1 THE EQUATION ax + by = c Any linear equation in two variables having integral coefficients can be put in the form ax+by=c (5.1) where a, b, c are given integers. We consider the problem of identifying all solutions of this equation in which x and y are integers. If a = b = c = 0, then every pair (x, y) of integers is a solution of (5.1), whereas if a = b = 0 and c * 0, then (5.1) has no solution. Now suppose that at least one of a 212 5. 1 The Equation ax + by = c 213 and b is nonzero, and let g = g.c .d.(a , b). If g,(c then (5.1) has no solution, by part (3) of Theorem 1.1. On the other hand, by Theorem 1.3 there exist integers x0, Y o such that ax0 + by0 = g, and hence if g lc then the pair (cx0jg, cy0jg) is an integral solution of (5.1). We may find x0 and y0 by employing the Euclidean algorithm, as discussed in Section 1.2. Once a single solution is known, say ax 1 + by 1 = c, others are given by taking x = x1 + kbjg, y = y1 - kajg. Here k is an arbitrary integer. Thus (5.1) has infinitely many integral solutions if it has one. We now show that (5.1) has no integral solutions beyond the ones we have already found. For suppose that the pairs (x\" y1), (x, y) are integral solutions of (5.1). By subtracting, we find that a(x - x1 ) + b(y - y1) = 0. We divide through by g and rearrange, to see that ( ajg )( x -x1 ) = ( b/g )( y 1 - y). That is, ajg divides the product (bjgXy 1 - y). But (ajg, bjg) = 1 by Theorem 1.7, so by Theorem 1.10 it follows that ajg divides y 1 - y. That is, kajg = y 1 - y for some integer k. On substituting this in the equation displayed above, we find that x- x1 = kbjg. Thus we have proved the following theorem. Theorem 5.1 Let a, b and c be integers with not both a and b equal to 0, and let g = g.c.d.(a, b). If g A' c then the equation (5.1) has no solution in integers. If glc then this equation has infinitely many solutions. If the pair ( x 1, y 1) is one integral solution, then all others are of the form x = x 1 + kbjg, y = y 1 - kajg where k is an integer. The equation (5.1) under consideration is equivalent to the congru­ ence ax = c (mod b), whose solutions are described by Theorem 2. 17. Indeed Theorem 5.1 is merely a reformulation of this prior theorem. Viewed geometrically, the equation (5.1) determines a line in the Euclidean plane. If we hold a and b fixed, and consider different values of c, we obtain a family of mutually parallel lines. Each lattice point in the plane lies on exactly one such line. From Theorem 5.1 we see that the lattice points on such a line (if there are any) form an arithmetic progres­ sion and that the common difference between one lattice point on the line and the next is determined by the vector (bjg, - ajg), which is indepen­ dent of c. If a and b are positive then the line has negative slope, and if in addition c is positive then the line has positive intercepts with the axes. In such a situation, it is interesting to consider the possible existence of solutions of (5.1) in positive integers. From Theorem 5.1 we see that x > 0 if and only if k > -gx1jb, and that y > 0 if and only if k < gy1ja. Thus the solutions of (5.1) in positive integers are given by those integers k in 214 Some Diophantine Equations the open interval I= ( -gx 1jb, gy1ja). Using the fact that the point (x1, y1) lies on the line (5.1), we find that the length of I is gcj(ab). Thus if glc and P denotes the number of solutions of (5.1) in positive integers then IP - gcj(ab) l � 1. In particular, it follows that if glc and c > abjg then P > 0. Here the hypothesis can not be weakened, for if c = ab jg then the solutions of (5.1) are the points ((k + Objg, - kajg), and we see that there is no integral value of k for which both coordinates are positive. Similarly, the solutions of (5. 1) in non-negative integers corre­ spond to integers k lying in the closed interval J = [ -gx1, gy1ja], so that the total number N of solutions satisfies IN - gc j(ab ) I � 1 if glc. If it is desired to have exact formulae for the numbers P and N defined above, instead of mere approximations, we employ the greatest integer function discussed in Section 4.1. We assume that glc and that an integral solution (x1, y1) of (5.1) is known. The least value of k for which x1 + kbjg is positive is [ -gx 1/b] + 1, while the greatest value of k for which y 1 - kajg is positive is -[ -gy1ja] - 1. Thus P = ( -[ -gy1ja] - 1) - ([ -gx1jb] + 1) + 1 = -[ -gy1ja] - [ -gx1jb] - 1. In terms of the fractional part function {x} = x- [x], we deduce that P = gcj(ab) + { -gy1ja} + { -gx1jb} - 1. The methods of Section 1.2 can be used to find integers x0 and y0 such that ax0 + by0 = g, and hence an initial solution x1, y1 of (5.1) may be constructed, if glc. In the following numerical examples we tailor those ideas to the present situation. Example 1 Find all solutions of 999x - 49y = 5000. Solution By the division algorithm we observe that 999 = 20 · 49 + 19. This suggests writing the equation in the form 19x - 49( y - 20x) = 5000. Putting x' = x, y' = - 20x + y, we find that the original equation is expressed by the condition 19x' - 49y' = 5000. This is simpler because the coefficients are smaller. Since 49 = 2 · 19 + 11, we write this equation as 19(x' - 2y') - 1 1y' = 5000. That is, 19x\" - 11y\" = 5000 where x\" = x' - 2y' and y\" = y'. Since 19 = 2 · 11 - 3, we write the equation as - 3x\" - 11( - 2x\" + y\") = 5000. That is, - 3xC3> - 11yC3> = 5000 where xC3> = x\" and yC3> = - 2x\" + y\". As 11 = 4 · 3 - 1, we write the equation as - 3(xC3> + 4 yC3>) + yC3> = 5000. That is, - 3xC4> + yC4> = 5000 where xC4> = xC3> + 4 yC3> and yC4> = yC3>. Making the further change of variables xC5> = xC4>, yC5> = - 3xC4> + yC4>, we see that the original equation is equiva­ lent to the equation yC5> = 5000. Here the value of yC5> is a fixed integer, and xC5> is an arbitrary integer. Since pairs of integers (x, y) are in one-to-one correspondence with pairs of integers (xC5>, yC5>), it follows that the original equation has infinitely many solutions in integers. To express x and y explicitly in terms of xC5> and yC5>, we first determine x and y in 5.1 The Equation ax + by = c 215 terms of x' and y', then in terms of x\" and y\", and so on. These transformations can be developed at the same time that the original equation is being simplified. We start by writing 999x - 49y = 5000, X =x, y =y . Then we rewrite these equations in the form That is, We rewrite this as That is, We rewrite this as 19x - 49( -20x + y) = 5000, x =x, 20x + ( - 20x + y) = y. 19x' - 49y' = 5000, x' =x, 20x' + y' = y. 19( x' - 2y') - lly' = 5000, x' - 2y' + 2y' = x, 20( x' - 2y') + 41y' = y. 19x\" - lly\" = 5000, x\" + 2y\" =x , 20x\" + 41y\" = y. - 3x\" - 11( -2x\" + y\") = 5000, 5x\" + 2( - 2x\" + y\") = x , 102x\" + 41( - 2x\" + y\") = y. (5 .2) (5.3) (5.4) 216 That is, . We rewrite this as That is, We rewrite this as Some Diophantine Equations - 3x<3> - lly<3> = 5000, 5x<3> + 2y<3> = x, 102x<3> + 41 y<3> = y. - 3( x<3> + 4y<3>) + y<3} = 5000, 5( x<3> + 4 y<3>) - 18 y<3> = x, 102( x<3> + 4 y<3>) - 367y<3> = y. - 3x<4> + y<4> = 5000, 5x<4)- 18y{4} = X , 102x<4> - 367y<4> = y. ( -3x<4> + y<4>) = 5000, -49x<4> - 18( -3x<4> + y<4>) = x, (5.5) (5.6) - 999x<4> - 367( - 3x<4> + y<4>) = y. That is, ! y<S} = 5000, -49x<5> - 18y<5> = x, - 999x<5> - 367y<5> = y. (5.7) Inserting this value of y<5>, and writing k in place of x<5>, we conclude that the solutions of the proposed equation are given by taking X = - 49k - 90000, y = - 999k - 1835000. 5. 1 The Equation ax + by = c 217 This parameterization of the solutions is not unique. For example, we could set k = -1837 - m, in which case the equations above would become x = 49m + 13, y = 999m + 163. We note that the coefficients in (5.3) are derived from those in (5.2) by subtracting 20 times the second column from the first column. Similarly, the coefficients in (5.4) are obtained from those in (5.3) by adding twice the first column to the second. In (5.4) we add twice the second column to the first to obtain (5.5). In (5.5) we add -4 times the first column to the second column to obtain (5.6), and in (5.6) we add 3 times the second column to the first to obtain (5.7). In general, we may add a multiple of one of the first two columns to the other. In addition we may permute the first two columns or multiply all elements of one of these columns by - 1. Thus we may alter the coefficients by means of the following three column operations: (Cl) Add an integral multiple m of one of the first two columns to the other; (C2) Exchange the first two columns; (C3) Multiply all elements of one of the first two columns by -1. These are similar to the elementary column operations of linear algebra, but in linear algebra the multiple in (Cl) may be any real number, and in (C3) one may use any nonzero constant in place of -1. In numerical calculations it suffices to manipulate the coefficients according to rules (Cl), (C2), and (C3). When applying operation (Cl), we are free to take m to be any integer we please, but in practice we choose m so as to reduce the size of a particular coefficient. In particular, we are not confined to the simplest form of the division algorithm-instead we may round to the nearest integer, as we did in passing from (5.4) to (5.5), even though it introduces a negative remainder. It is not necessary to write out the full set of equations at each stage, as we did in solving Example 1. We now exhibit the method in this more concise format. Example 2 Find all integers x and y such that 147x + 258 y = 369. 218 Some Diophantine Equations Solution We write 147 258 369 147 111 369 36 1 11 369 1 0 -+ 1 -1 -+ 2 -1 0 0 -1 36 3 369 0 3 369 -+ 2 -7 -+ 86 -7 -1 4 -49 4 Let the variables that are implicit in this last array be called u and v. Since 3v = 369, we deduce that v = 123, and that the full set of solutions is given by taking x = 86u - 861, y = - 49u + 492. The variables u and v were obtained from the original variables x and y by a homogeneous change of coordinates. We may reduce the size of the constant term in our answer by introducing an inhomogeneous change of variables. For' exam­ ple, if we put u = t + 10, then we find that x = 86t - 1, y = - 49t + 2. PROBLEMS 1. Prove that all solutions of 3x + Sy = 1 can be written in the form x = 2 + St, y = -1 - 3t; also in the form x = 2 - St, y = - 1 + 3t; also in the form x = -3 + St, y = 2 :-- 3t. Prove that x =a + bt, y = c + dt, with t arbitrary, is a form of the general solution if and only if x = a, y = c is a solution and either b = 5, d = - 3 or b = -5, d = 3. 2. Find all solutions of lOx - 7y = 17. 3. Using a calculator, find all solutions of (a) 903x + 731y = 2107; (b) 903x + 731y = 1106; (c) 101x + 99y = 437. 4. Find all solutions in positive integers: (a) Sx + 3y = 52; (b) 15x + 7y = 111; (c) 40x + 63y = 521; (d) 123x + 57y = 531; (e) 12x + SOy = 1; (f) 12x + 510y = 274; (g) 97x + 98y = 1000. 5. Prove that 101 x + 37y = 3819 has a positive solution in integers. 6. Given that (a, b) = 1 and that a and b are of opposite sign, prove that ax + by = c has infinitely many positive solutions for any value of c. 5. 2 Simultaneous Unear Equations 219 7. Let a, b, c be positive integers. Prove that there is no solution of ax + by = c in positive integers if a + b > c. 8. If ax + by = c is solvable, prove that it has a solution x0, y0 with O� x0 < lb l. 9. Prove that ax + by = a + c is solvable if and only if ax + by = c is solvable. 10. Prove that ax + by = c is solvable if and only if (a, b) = (a, b, c). 11. Given that ax +by = c has two solutions, (x0, y0) and (x1, y 1) with x1 = 1 + x0, and given that (a, b) = 1, prove that b = ± 1 . 12. A positive integer is called powerful if p2 la whenever pIa. Show that a is powerful if and only if a can be expressed in the form a = b2c3 where b and c are positive integers. 13. Let a, b, c be positive integers such that glc, where g = g.c.d.(a, b), and let N denote the number of solutions of (5. 1) in non-negative integers. Show that N = (y 1 gja] + (x 1 gjb] + 1 = gcj(ab) + 1 - {y 1 gja} - {x1 gjb}. 14. Let a, b, c be positive integers. Assuming that glc and that cgj(ab) is an integer, prove that N = 1 + cgj(ab), and that P = - 1 + cgj(ab). 15. Let a, b, c be positive integers. Assuming that glc but that cgj(ab) is not an integer, prove that P = (cgj(ab)] or P = (cgj(ab)] + 1, and that N = (cgj(ab)] or N = (cgj(ab)] + 1. Assuming further that al e, show that N = (cgj(ab)] + 1 and that P = (cgj(ab)]. (H) *16. Let a and b be positive integers with g.c.d.(a, b) = 1. Let ._/denote the set of all integers that may be expressed in the form ax + by where x and y are non-negative integers. Show that c = ab - a - b is not a member of ._/, but that every integer larger than c is a member of J'. * 17. Find necessary and sufficient conditions that have at least one simultaneous solution in integers x, y, z, assuming that the coefficients are integers with b1 * b2• 5.2 SIMULTANEOUS LINEAR EQUATIONS Let a1, a2, ·· ·, an be integers, not all 0, and suppose we wish to find all solutions in integers of the equation 5.2 Simultaneous Unear Equations 221 coefficients, we shall restrict m to be an integer. Similarly, the equation A = B is equivalent to cA = cB provided that c * 0. Again, since our interest is in equations with integral coefficients, we restrict c to the values c = ± 1. Finally, we may rearrange a collection of equations without altering their significance. Hence we have at our disposal three row operations which we may apply to a system of equations: (Rl) Add an integral multiple m of one equation to another; (R2) Exchange two equations; (RJ) Multiply both sides of an equation by - 1 . By applying these operations in conjunction with the column opera­ tions considered in the preceding section, we may determine the integral solutions of a system of linear equations. Example 4 Find all solutions in integers of the simultaneous equations 20x + 44y + 50z = 10, 17x + l3y + 11z = 19. Solution Among the coefficients of x, y, and z, the coefficient 11 is smallest. Using operation (Cl) and the division algorithm (rounding to the nearest integer), reduce the coefficients of x and y in the second row (mod 11): 20 44 50 10 17 B 11 19 1 0 0 -+ 0 1 0 0 0 1 -80 -6 50 10 - 5 2 11 19 1 0 0 0 1 0 -2 -1 1 The coefficient of least absolute value is now in the second row and second column. We use operation (Cl) to reduce the other coefficients in the second row (mod 2): -98 -6 80 10 1 2 1 19 -+ 1 0 0 3 1 - 5 - 5 -1 6 There are now two coefficients of minimal absolute value. We use the one in the first column as our pivot and use operation (Cl) to reduce the other 222 Some Diophantine Equations coefficients in the second row: -98 190 1 0 1 -2 3 -5 -5 9 178 10 0 19 -1 -8 11 The coefficient of least nonzero absolute value is unchanged, so we switch to operation (Rl) to reduce the coefficient -98 (mod 1), and then we use (R2) to interchange the two rows: 0 190 178 1872 1 0 0 19 1 0 0 19 0 190 178 1872 -+ 1 -2 -1 -+ 1 -2 -1 3 -5 -8 3 -5 -8 -5 9 11 -5 9 11 We now ignore the first row and first column. Among the remaining coefficients, the one of least nonzero absolute value is 178. We use operation (Cl) to reduce 190 (mod 178), obtaining a remainder 12. Then we use ( Cl) to reduce 178 (mod 12), obtaining a remainder -2: 1 0 0 19 1 0 0 19 0 12 178 1872 0 12 -2 1872 -+ 1 -1 -1 -+ 1 -1 14 3 3 -8 3 3 - 53 -5 -2 11 -5 -2 41 Next we use (C2) to reduce 12 (mod 2). Then we use (C2) to interchange the second and third columns, and finally use (C3) to replace -2 by 2: 1 0 0 19 1 0 0 19 0 0 -2 1872 0 2 0 1872 -+ 1 83 14 -+ 1 -14 83 3 -3 15 -53 3 53 -315 -5 244 41 -5 -41 244 Let the variables in our new set of equations be called t, u, and v. The two original equations have been replaced by the two new equations 1 · t = 19 and 2 · u = 1872. This fixes the values of t and u. Since 1119 and 211872, these values are integers: t = 19, u = 936. With these values for t and u, the bottom three rows above give the equations x= t- 14u + 83 v = 83 v - 13085 , y = 3t + 53u - 315 v = -315 v + 49665 , z = - 5t - 41u + 244v = 244v - 38471 . 5.2 Simultaneous Unear Equations 223 By making the further change of variable w = v - 158 we may adjust the constant terms, so that x = 83w + 29, y = - 315w - 105 , z = 244w + 81 . As integral solutions of the given equations are in one-to-one correspon­ dence with integral values of w, we have achieved our goal. To demonstrate that this procedure will succeed in general, we de­ scribe the strategy more precisely. Suppose we wish to parameterize all integral solutions of a family of m linear equations in n variables, (5.10) We assume that the aii and the b; are integers, with not all aii = 0. Our object is to find an equivalent family of m equations in n equivalent variables that is diagonal, in the sense that the new coefficients aii vanish whenever i * j. Let A =[a;) be the m X n matrix of given coefficients, let X= [x) denote the n X 1 matrix (or column vector) of variables, and let B = [b;] be the m X 1 matrix (or column vector) of given constant terms. Then the given equations may be expressed as the single matrix equation AX= B. If we let V = [v;) be the n X n matrix that expresses our original variables in terms of our new variables Y = [ yi ], then W = X. Initially, V = I, the identity matrix. We describe a reduction step that transforms A into a matrix A' = [aji] with the property that aj1 � 0, aji = 0 for j > 1, and aiJ = 0 for i > 1. By repeated use of this reduction step, A is eventually transformed into a diagonal matrix whose diagonal entries are non-negative. As we perform row and column operations on A, we obtain a sequence of coefficient matrices. Let p. denote the minimal absolute value of non-zero elements of the current coefficient matrix. Locating an element of absolute value p., say in position (i0, j0), we use operation (Cl) or operation (Rl) to reduce the other coefficients in row i0 or column j0 • This gives rise to a new coefficient matrix with a strictly smaller value of p., unless all the other coefficients in row i0 and column 224 Some Diophantine Equations j0 are 0. Since JL can take on only positive integral values, this latter situation must eventually arise. Then we use operations (R2) and (C2) to move the coefficient from location (i0, j0) to (1, 1). If the coefficient is negative, we use (C3) to reverse the sign. Whenever we apply a column operation to the coefficient matrix A, we also apply the same column operation to V, and whenever we apply a row operation to A, we apply the same row operation to B. The reduction procedure will terminate prematurely if in the submatrix that remains to be treated all elements are 0. Thus we obtain a diagonal matrix with positive entries in the first r rows, and O's elsewhere. In developing standard linear algebra over IR it is found that the rank of a matrix is invariant under row or column opera­ tions. Since the row and column operations we are using here are a proper subset of those used in linear algebra over IR, the rank is invariant in the present situation, as well. As the rank of a diagonal matrix is simply equal to the number of nonzero elements, we see that the number r is the rank of the matrix A given originally. Caution At all stages of the reduction process, the column operations must involve only columns 1 through n. Similarly, the row operations must involve only rows 1 through m. In summary, the change of variables VY = X has the property that n-tuples X of integers are in one-to-one correspondence with n-tuples Y of integers. The m conditions (5.10) on the variables xj are equivalent to the m conditions ( 1 � j� r) , bj = 0 ( r < j � m) . (5.11) (5. 12) Here the dj are the diagonal entries of the new coefficient matrix, and the bj are the new constant terms. In order that integral solutions should exist, it is necessary and sufficient that (5.12) holds, and that ( 1� j� r) . (5.13) If (5.12) holds but (5.13) fails for some j � r, then there exist rational solutions but no integral solution. If (5 .12) fails for some j > r then the original equations are inconsistent, and then (5.10) has no solution in real variables. If (5.1 1) and (5.12) hold and r = n, then the integral solution is unique (and indeed this is the unique real solution). If (5.12) and (5.13) hold but r < n then there are infinitely many integral solutions, parame­ terized by the free integral variables Yr+ I > Yr+Z• · · · , Yn· 5.2 Simultaneous Unear Equations 225 As we experienced in Example 4, the coefficients encountered during the reduction process may be much larger than the coefficients originally given. (It is not known precisely how much larger, but it is believed that they may be very much larger. It is interesting to consider how the reduction process might be modified in order to minimize this phe­ nomenon.) However, this problem does not arise when the method is applied to systems of simultaneous congruences (mod q) instead of simul­ taneous equations, for then coefficients may be reduced (mod q) during the reduction process. Here q may be any integer > 1, but it is imperative that each congruence involves the same modulus q. Example 5 Find all solutions of the simultaneous congruences 3x + 3z = 1 (mod S) , 4x -y + z =3 (mod 5 ). Solution We construct an array of coefficients as before. Using operation ( Cl), we add the third column to both columns 1 and 2. 3 4 1 0 0 0 3 1 -1 1 3 0 0 1 0 0 1 -+ 1 3 0 0 1 0 0 1 1 1 3 1 1 3 0 0 1 Using (Rl), we multiply the second row by 2 and add the result to the first row. Then we interchange the first and third columns and the first and second rows. 1 3 0 2 1 0 0 3 0 0 1 3 0 3 1 2 -+ 1 0 0 -+ 0 0 1 0 1 0 0 1 0 1 1 1 1 1 1 Next we multiply the third column by 2 and add the result to the second column, and then interchange the second and third columns. 1 0 0 3 1 0 0 3 0 0 1 2 0 1 0 2 -+ 0 2 1 -+ 0 1 2 0 1 0 0 0 1 1 3 1 1 1 3 Thus we arrive at a new system of congruences, in variables t, u, v , say. We 226 Some Diophantine Equations see that t = 3 (mod S), u = 2 (mod S), while v can take any value (mod S). Thus the given system has five solutions, given by x = u + 2 v = 2 v + 2 (mod S) , y = v = v z = t + u + 3v = 3v (mod S) , (mod S) . In general, the system of simultaneous congruences a 11x1 + a 12x2 + · · · +a1nxn = b 1 (mod q ) , a2lxl + a22x2 + . . . +a2nxn = b2 (mod q ) ' has a solution (mod q) if and only if g.c.d. ( dj, q )l bj bj = 0 (mod q) ( 1 �j � r) , ( r< j� m). (S .14) (S. 1S ) (S .16) Note that these conditions may hold while (S.12) fails. In such a case the congruences (S. 14) have a simultaneous solution even though the equations (S.10) have no real solution. On the other hand, if (S .lO) has a real solution then (S.12) holds. If we take q to be a multiple of all of the dj then the conditions (S.1S) are equivalent to (S.13). This gives the following important result. Theorem 5.2 If the system of linear equations (S.10) has a real solution, and if the system of congruences (S.14) has a solution for every modulus q, then the equations (S.10) have an integral solution. We have actually proved more, since we can determine a particular q that suffices. (For a more precise characterization of this q in terms of the original coefficients, see Problem 11 at the end of this section.) The converse of the theorem is obvious, for if a system of equations (even nonlinear equations) has an integral solution then this solution is both a real solution and also a congruential solution for any q. We speak of the congruential and real solutions as \"local,\" while an integral solution is \"global.\" In this parlance, Theorem S.2 may be expressed by saying that the equations (S.10) have a global solution if they are everywhere locally solvable. 5.2 Simultaneous Unear Equations 227 While our main aims in this Section have been achieved, further insights may be gained by making greater use of linear algebra. Suppose that a particular row operation, applied to the m X n matrix A, gives the matrix A'. Let R denote the matrix obtained by applying this same row operation to the m X m identity matrix lm . Then A' = R A . We call such a matrix R an elementary row matrix. Note that the elementary row matrices here form a proper subset of the elementary row matrices defined in standard linear algebra over IR, since we have restricted the row operations that are allowed. Similarly, if a particular column operation takes A to A\" and In to C, then A\" = AC, and we call C an elementary column matrix. Thus the sequence of row and column operations that we have performed in our reduction process may be expressed by matrix multiplication, Rg Rg- t · · · R2R 1 AC1C2 • • • Ch - tCh = D, (5 .17) where D is an m X n diagonal matrix. (Note that a diagonal matrix is not necessarily square.) The matrix V that allows us to express the original variables X in terms of our new variables Y is constructed by applying the same column operations to the identity matrix. That is, (5 .18) Similarly, the new constant terms B' obtained at the end of the reduction process are created by applying the row operations to the original set B of constant terms, so that (5 .19) It is useful to characterize those matrices that may be written as products of our elementary row or column matrices. Definition 5.1 A square matrix U with integral elements is called unimodu­ lar if det (U) = ± 1. Theorem 5.3 Let U be an m X m matrix with integral elements. Then the following are equivalent : (i) U is unimodular; (ii) The inverse matrix u- l exists and has integral elements; (iii) U may be expressed as a product of elementary row matrices. U = RgRg- t · · · R2 R 1 ; (ill) U may be expressed as a product of elementary column matrices, u = c1C2 • • • ch - lch . 228 Some Diophantine Equations If U and V are m X m unimodular matrices, then so also is UV, in view of (3.6). Moreover, u- t is unimodular, by (ii) above. Thus the collection of all m X m unimodular matrices forms a group. Proof We first show that (i) implies (ii). From the definition of the adjoint matrix uadj it is evident that if u has integral elements then so does uadj. Since u- t = uadi jdet (U), it follows that u- t has integral elements if det (U) = ± 1. We next show that (ii) implies (i). Since uu- t = /, it follows by (3.6) that det (U) det (U- 1) = det (/) = 1. But det (U) is an integer if U has integral elements, so from (ii) we deduce that both det (U) and det (U- 1) are integers. That is, det (U) divides 1. As the only divisors of 1 are ± 1, it follows that U is unimodular. Next we show that (iii) implies (i). It is easy to verify that an elementary row matrix is unimodular. From (3.6) it is evident that the product of two unimodular matrices is again unimodular. Thus if U = Rg Rg- t · · · R 2R 1 , then U is unimodular. To show that (i) implies (iii), we first show that if A is an m X n matrix with integral elements then there exist elementary row matrices such that (5 .20) where T is an upper-triangular m X n matrix with integral elements. We proceed as in Gaussian elimination in elementary linear algebra, except that we restrict ourselves to the row operations (Rl), (R2), and (R3). We apply these row operations to A as follows. In the first column containing nonzero elements, say the first column, we apply the division algorithm and (Rl) until only one element in this column is nonzero. By means of (R2) we may place this nonzero entry in the first row. By (R3) we may arrange that this element is positive. We now repeat this process on the columns to the right of the one just considered, but we ignore the first row. Thus the second column operated on may have two nonzero elements, in the first and second rows. Continuing in this manner, we arrive at an upper triangular matrix T. That is, T = RgRg- t · · · R 2R 1 A for suitable elementary row matrices R;. Hence A = R) 1R2 2 • • • R;� 1R; 1 T. Since the inverse of an elementary row matrix is again an elementary row matrix, we have now expressed A in the desired form (5.20). To complete the proof that (i) implies (iii), we take A = U in (5.20). Applying (3.6), we deduce that det (T) = ± 1. But since T is upper-trian­ gular, det (T) is the product of its diagonal elements. As these diagonal elements are non-negative integers, it follows that each diagonal element is 1. With this established, we may now apply the row operation (Rl) to T to clear all entries above the diagonal, leaving us with the identity matrix 5.2 Simultaneous Linear Equations 229 Im . That is, T is the product of elementary row matrices, and hence by (5.20), so also is U. The equivalence of (i) and (iv) may be established similarly. Alterna­ tively, we observe that R is an elementary row matrix if and only if R1 is an elementary column matrix. (Here R1 denotes the transpose of R.) If U is unimodular then U1 is unimodular, and by (iii) we deduce that U1 = RgRg_ 1 • • • R2 R1 for suitable elementary row matrices R;. Hence U = R�R� · · · R�_ 1 R�, a product of column matrices. We call two m X n matrices A and A' equivalent, and write A - A', if there exists an m X m unimodular matrix U and an n X n unimodular matrix V such that A' = UAV. This is an equivalence relation in the usual sense. With this machinery in hand, we may express (5.17) more compactly by saying that any matrix A is equivalent to a diagonal matrix, say UA V =D. Then A= u- 1DV- 1• Writing (5. 10) in the form AX= B, we deduce that u- 1DV- 1X = B. On putting Y = v- 1X, UB = B', we are led immediately to the conclusion that (5.10) is equivalent to DY = B', which is precisely the content of (5.11) and (5.12). Owing to ambiguities in our reduction process, the diagonal matrix D that we have found to be equivalent to A is not uniquely defined. Moreover, two different diagonal matrices may be equivalent, as we see from the example However, it is known that among the diagonal matrices equivalent to a given matrix A there is a unique one whose nonzero elements st > s2, • • ·, s, are positive and satisfy the divisibility relations stls2,s2 is3, .. ·, s,_ 1 is,. This diagonal matrix S is the Smith nonnal fonn of A, named for the nineteenth-century English mathematician H. J. S. Smith. The numbers s;, 1 � i � r, are called the invariant factors of A. A proof that every m X n matrix A is equivalent to a unique matrix S in Smith normal form is outlined in Problems 4-9. PROBLEMS 1. Find all solutions in integers of the system of equations x 1 + x2 + 4x3 + 2x4 = 5, - 3x 1 - x2 - 6x4 = 3, - x 1 - x2 + 2x3 - 2x4 = 1. 230 Some Diophantine Equations 2. For what integers a, b, and c does the system of equations x1 + 2x2 + 3x3 + 4x4 =a , x1 + 4x2 + 9x3 + 16x4 = b, x1 + 8x2 + 27x3 + 64x4 = c have a solution in integers? What are the solutions if a = b = c = 1? 3. Suppose that the system of congruences (5.14) has a solution. Show that if q is prime then the number of solutions is a power of q. *4. Let a and b be positive inte1ers, and put g = g.c.d. (a, b), h = l.c.m. (a, b). Show that (� �] - l� �]· *5. Using the preceding problem, or otherwise, show that if D is a diagonal matrix with integral elements then there is a diagonal matrix S in Smith normal form such that D - S. Deduce that every m X n matrix A with integral elements is equivalent to a matrix S in Smith normal form. *6. Let A be an m X n matrix with integral elements, and let r denote the rank of A. For 1 � k � r, let dk(A) be the greatest common divisor of the determinants of all k X k minors of A. The numbers dk(A) are called the detenninantal divisors of A. Let R be an elementary unimodular row matrix, and put A' = RA. Show that A and A' have the same determinantal divisors. *7. Use the preceding problem to show that if A and B are equivalent matrices then they have the same determinantal divisors. *8. Let S be a matrix in Smith normal form whose positive diagonal elements are S p s2, • • ·, s,. Show that d1(S) = s1, d2(S) = s1s2, • • ·, d,(S) = s1s2 • • • s,. For convenience, put d0(S) = 1. De­ duce that sk = dk(S)fdk_ ,(S) for 1 � k � r. *9. Let S and S' be two m X n matrices in Smith normal form. Using the preceding problems, show that if S - S' then S = S'. Conclude that the Smith normal form of an m X n matrix A is unique. *10. Show that if two m X n matrices A and A' have the same rank and the same determinantal divisors then A -A'. *11. Suppose that the system of equations (5.10) has real solutions, and that the system of congruences (5.14) has a solution when q = d,(A)/d,_ 1(A). Show that the equations (5.10) have an integral solution. Show also that this is the least integer q for which this conclusion may be drawn. *12. Let A be an n X n matrix with integral elements and nonzero determinant. Then the elements of A - 1 are rational numbers. Show that the least common denominator of these elements is dn( A )fdn - l( A ). 5.3 Pythagorean Triangles 231 5.3 PYTHAGOREAN TRIANGLES We wish to solve the equation x 2 + y 2 = z 2 in positive integers. The two most familiar solutions are 3, 4, 5 and 5, 12, 13. We refer to such a triple of positive integers as a Pythagorean triple or a Pythagorean triangle, since in geometric terms x and y are the legs of a right triangle with hypotenuse z. In view of the algebraic identity (5.21 ) we may obtain an infinity of Pythagorean triangles by taking y = 2rs, (5.22) where r and s take integral values with r > s > 0. More remarkably, we show that all Pythagorean triangles arise in this way. Since the equation under consideration is homogeneous, if x, y, z is a Pythagorean triple then so also is kx, ky, kz, for any positive integer k. For example, the Pythagorean triangle 3, 4, 5 gives 6, 8, 10 and also 60, 80, 100. Thus any given Pythagorean triangle gives rise to an infinite family of similar triangles. To initiate our analysis, we identify in this family the smallest triangle. Suppose that x, y, and z are given positive integers for which x 2 + y 2 = z 2• Let d be a common divisor of x and y. Then d 2 lx 2 and d 2 ly 2, and hence d 2 l(x 2 + y 2), that is, d 2 lz 2. By unique factorization, it follows that d lz. Indeed, by further arguments of this sort, we discover that any common factor of two of the numbers x, y, z must divide the third. That is, (x, y) = (y , z) = (z, x) = (x, y, z) . Let g denote this common value, and put x 1 =xjg, y 1 = yjg, z1 =zjg. Then x 1 , y 1 , z1 is a Pythagorean triple with (x 1 , y 1 ) = 1. We call such a triple primitive, since it is not a multiple of a smaller triple. Thus we see that all Pythagorean triangles similar to the given triangle x, y, z are multiples of x 1 , y 1, z1 • We now consider the problem of finding all primitive Pythagorean triples. We note that x and y cannot both be even. They cannot both be odd either, for if they were we would have x 2 = 1 (mod 4), y 2 = 1 (mod 4), and therefore z 2 = 2 (mod 4), which is impossible. Since x and y enter the equation symmetrically, we can now restrict our attention to primitive 232 Some Diophantine Equations solutions for which y is even, x and z odd. The equation x2 + y2 = z2, being additive, does not seem to offer a line of attack. However, the equation may be expressed in multiplicative form, (z - xXz + x) = y2• Since the canonical factorization of a perfect square is of a special shape (all the exponents are even), we are now in a position to say something intelligent concerning the prime factorization of z - x and of z + x. The key idea here is very simple, but due to its enormous importance in Diophantine analysis, we give it special prominence in the following lemma. Lemma 5.4 If u and v are relatively prime positive integers whose product uv is a perfect square, then u and v are both perfect squares. Proof Let p be a prime that divides u, and let a be the exact power of p in u. (In symbols, pa llu.) Since u and v are relatively prime, p does not divide v, and hence palluv. But uv is a perfect square, so a must be even. Since this holds for all primes p dividing u, it follows that u is a perfect square. Similarly, v must be a perfect square. If x, y, z is a primitive Pythagorean triple with x, z odd, and y even, then z - x and z + x are both even. Accordingly, we divide by 4 and write our equation as Z + X Z - X _ ( y )2 _ 2 ___ 2_ - 2 . Any common divisor of the two factors on the left divides both their sum, z, and their difference, x. Since (x, z) = 1, it follows that the two factors on the left have no common factor. Then by Lemma 5.4 we deduce that (z + x )j2 = r2, (z - x )j2 = s2 and y 12 = rs for some positive integers r, s. We also see that (r, s) = 1, and that r > s. Also, since z is odd, r and s are of opposite parity (one is even, the other odd). On solving for x, y, and z in terms of r and s, we obtain the equations (5.22) already noted. Thus we have the following result. Theorem 5.5 The positive primitive solutions of x2 + y 2 = z2 with y even are x = r2 - s2, y = 2rs, z = r2 + s2, where rand s are arbitrary integers of opposite parity with r > s > 0 and (r, s) = 1. The method we have devised here provides a model for attacking many other Diophantine equations. In fact, the approach is so successful that one may go to great lengths in order to make it applicable. For example, the equation x 2 + 2 = y3 does not factor in the field of rational 5. 3 Pythagorean Triangles 233 numbers, but we observe that x 2 + 2 = (x + F'iXx - F'f). In Sec­ tion 9.9 we use the arithmetic of the algebraic integers in the field Q(F'f) to treat this equation. In Section 9.10 a similar method is applied to the equation x 3 + y 3 = z3• PROBLEMS 1. Find all primitive Pythagorean triples for which 0 < z < 30. 2. Prove that if x, y, z is a Pythagorean triple then at least one of x, y is divisible by 3, and that at least one of x, y, z is divisible by 5. 3. Find all Pythagorean triples whose terms form (a) an arithmetic progression, (b) a geometric progression. 4. Let u and v be positive integers whose product uv is a perfect square, and let g = (u, v). Show that there exist positive integers r, s such that u = gr 2 and v = gs2• 5. Let u and v be relatively prime positive integers such that 2uv is a perfect square. Show that either (a ) u = 2r2, v = s2 or (b) u = r2, v = 2s2, for suitable positive integers r, s. 6. Describe those relatively prime positive integers u and v such that 6uv is a perfect square. 7. For which integers n are there solutions to the equation x 2 - y 2 = n? 8. If n is any integer � 3, show that there is a Pythagorean triple with n as one of its members. 9. Prove that every integer n can be expressed in the form n = x 2 + y 2 _ z 2. 10. Prove that x 2 + y 2 = z 4 has infinitely many solutions with (x, y, z) = 1 . 11. Using Theorem 5.5, determine all solutions of the equation x 2 + y 2 = 2z 2• (H) 12. Show that if x = ±(r 2 - 5s2), v = 2rs, z = r 2 + 5s2 then x 2 + 5y 2 = z 2. This equation has the solution x = 2, y = 3, z = 7. Show that this solution is not given by any rational values of r, s. 13. Show that all solutions of x 2 + 2 y 2 = z 2 in positive integers with (x, y, z) = 1 are given by x = l r 2 - 2s 2 1 , y = 2rs, z = r 2 + 2s2 where r and s are arbitrary positive integers such that r is odd and (r, s) = 1. (H) 14. Let x, y, z be positive integers such that (x, y) = 1 and x2 + 5y 2 = z 2. Show that if x is odd and y is even then there exist integers r and 5.4 Assorted Examples 235 nontrivial solution, then we may set g = g.c.d. (x 1 , x2 , . • · , xn ), and divide the equation by gd to obtain a primitive solution, one for which the variables are relatively prime. In general we cannot guarantee that such variables will be pairwise relatively prime. If the homogeneous equation (5.23) has a nontrivial solution in integers, then it has a nontrivial real solution. Moreover, a primitive solution of (5.23) is, for any positive integer m, a solution of the congruence P(x 1 , x2 , . • ·, xn ) == 0 (mod m) with the property that g.c.d. (x P x2 , . • · , xn , m) = 1. In view of the Chinese Remainder Theorem, it is enough to consider congruences (mod pj). Thus as a prelude to solving a Diophantine equation, we first ask whether the congruence (5 .24) has a solution for every prime-power pj. If P is homogeneous we require that not all the variables be divisible by p. Theorem 5.7 The eqUiltion x 3 + 2y3 + 4z 3 = 9w3 has no nontrivial solu­ tion. Proof We show that the congruence x3 + 2y 3 + 4z 3 = 9w3 (mod 27) has no solution for which g.c.d. (x, y, z, w, 3) = 1. We note that for any integer a, a3 = 0 or ±Hmod 9). Thus x 3 + 2y3 + 4z3 = O(mod 9) implies that x = y = z = O(mod 3). But then x 3 + 2y3 + 4z 3 = O (mod 27), so that 3lw3 • Hence 3l w. This contradicts the assumption that g.c.d.( x, y, z, w, 3) =1 . As we remarked in Section 5.2, we refer to real solutions and congru­ ential solutions as local, while a solution in integers is called global. In Section 5.2 we established that a system of linear equations is globally solvable if it is everywhere locally solvable. From the work of Hasse and Minkowski it is also known that a single quadratic form, in any number of variables, has a nontrivial solution in integers provided that it has nontriv­ ial solutions everywhere locally. An interesting special case of this is the subject of the next section. Unfortunately, this \"Hasse-Minkowski princi­ ple\" does not hold in general. A counterexample is provided in Problem 11 at the end of this section. A second counterexample, involving a quadratic polynomial in two variables, is indicated in Problem 13 of Section 7.8. In addition, it is known that the equation 3x3 + 4y3 + 5z 3 = 0 has no nontrivial solution in integers, but that it has nontrivial solutions everywhere locally. We now consider a further equation, which can be shown to be solvable everywhere locally, which nevertheless can be treated by congruential considerations. 236 Some Diophantine Equations Theorem 5.8 The equation y 2 = x 3 + 7 has no solution in integers. Proof If x is even then the equation is impossible as a congruence (mod 4). Thus in any solution, x must be odd, and hence y must be even. It then follows that x = 1 (mod 4). Since the left side of the equation is non-negative, we deduce that x � - 1. We rewrite the equation in the form y2 + 1 = ( x + 2)( x2 - 2x + 4) . Here the left side is odd, and by Lemma 2.14 we know that every prime factor of the left side is = 1 (mod 4 ) . Hence every positive divisor of the left side is = l(mod 4). On the other hand, the right side has the positive divisor x + 2 = 3 (mod 4). Thus these two expressions cannot be equal. In the argument just completed, we discover an inconsistency (mod q) for some prime q = 3 (mod 4), which divides x + 2. This q is not fixed, but is instead a function of the hypothetical solution x, y. Some Diophantine equations can be treated by considering the order of magnitude of the quantities rather than by congruences. Let f(z) be an irreducible polynomial of degree d > 2, with integral coefficients, and put P(x, y) =f(xjy)yd. For example, if f(z) = z 3 - 2, then P(x, y) =x3 - 2y3• The coefficients of P(x, y) are the same as those of f(z), but P(x, y) is homogeneous. We note that . k \"+k l crjy\" l = lcl lxl' ly l � lcl ( max( lx l , ly l )) ' . By applying this to the various monomial terms of P(x, y) we deduce that IP( x, Y) l � H( P ) ( max( lxl , ly l )) d (5.25) where H(P) is the sum of the absolute values of the coefficients of P(x, y ), called the height of P. For most points (x, y) in the plane, the right side is of the same order of magnitude as the left. However, if the ratio xjy is near a real root of f(z), then IP(x, y)l is smaller, sometimes much smaller. However, it is known that the left side cannot be too much smaller if x and y are integers. More precisely, if d > 2 and e > 0, then there exists a constant C (depending both on P(x, y) and on e) such that I P( x ,y ) l > ( max(lx l , ly l )) d- 2-• (5 .26) provided that max( lx l , ly l ) �C. Consequently, if g(x, y) is a polynomial 5.4 Assorted Examples 237 of degree < d - 2 then the Diophantine equation P ( x, y ) = g ( x, y ) has at most finitely many integral solutions, because the left side has much greater absolute value than the right side, whenever the lattice point (x, y) is far from the origin. In particular, for any given integer c the equation x3 - 2y 3 = c has at most finitely many integral solutions. The inequality (5.26) is quite deep, but we may nevertheless apply elementary inequalities to certain special types of Diophantine equations. Theorem 5.9 The Diophantine equation x 4 + x 3 + x 2 + x + 1 = y 2 has the integral solutions ( -1, 1), (0, 1), (3, 11), and no others. Proof Put f(x) = 4x 4 + 4x 3 + 4x 2 + 4x + 4. Since f(x) = (2x 2 + x)2 + 3(x + 2/3)2 + 8/3, it follows that f(x) > (2x 2 + x)2 for all real x. On the other hand, f(x) = (2x 2 + x + 1)2 - (x + 1Xx - 3). Here the last term is positive except for those real numbers x in the interval I = [ - 1, 3]. That is, f(x) < (2x 2 + x + 1)2 provided that x fl. I. Thus we see that if x is an integer, x fl. I, then f(x ) lies between two consecutive perfect squares, namely (2x 2 + x)2 and (2x 2 + x + 1)2. Hence f(x) cannot be a perfect square, except possibly for those integers x E I, which we examine individually. Theorem 5.10 The equation (5 .27) has no solution in positive integers. This is one of Fermat's most famous results. From it we see at once that the equation x 4 + y 4 = z4 has no solution in positive integers. Fermat asserted, more generally, that if n is an integer, n > 2, then the equation (5.28) has no solution in positive integers. This proposition, though still a conjecture for many values of n, is known as Fennat's Last theorem or Fennat's big theorem, as contrasted with Fermat's little theorem (Theorem 2.7). In Section 9.10 we treat the case n = 3 using simple ideas in algebraic number theory. 238 Some Diophantine Equations Proof The secret is that one should not consider the given equation in isolation, but rather in tandem with a second equation, (5 .29) We show that if the given equation (5.27) has a solution in positive integers, then so does this second equation, and conversely if (5.29) has a solution in positive integers then so does (5.27). On closer examination we discover that if we start with a solution of (5.27), use it to construct a solution of (5.29), and then use that solution to construct a solution of (5.27), then we do not obtain the original solution of (5.27) that we started with. Instead, the new solution is smaller, in the sense that z is smaller. This allows us to derive a contradiction, since we may assume that our initial solution is minimal. This is Fermat's method of descent. Let x, y, z be arbitrary positive integers that satisfy (5.27). Set g = g.c.d.(x, y). Since g 4 divides the left side of (5.27), it follows that g 2 lz. Putting x 1 = xjg, y 1 = y jg, z 1 = zjg 2, we see that x 1, y 1, z 1 are positive integers that satisfy (5.27) and that have the further property that x 1 and y 1 are relatively prime. Thus x �, y �, z 1 is a primitive Pythagorean triple. By interchanging x 1 and y 1, if necessary, we may arrange that x 1 is odd and y 1 is even. Hence by Theorem 5.5 there exist relatively prime positive integers r, s such that y � = 2rs, (5 .30) (5.31) (5.32) Here r and s are of opposite parity, and to determine which one is odd, we observe from (5.30) that s, x 1, r is a primitive Pythagorean triple. Hence r is odd and s is even. In view of (5.31 ), we may apply Lemma 5.4 with u = r and v = 2s. Thus there exist positive integers b and c such that r = c 2, s = 2b 2 • Taking a = x 1, we see from (5.30) that a, b, c is a solution of (5.29) in positive integers. Moreover, using (5.32) we see that (5 .33) Now suppose that a, b, c are positive integers that satisfy (5.29). Put h = g.c.d.(b, c ). Then h4 la2, and hence h2 1 a. Putting a 1 = ajh2, b 1 = bjh , c 1 = cjh, we find that a 1, bp c 1 are positive integers satisfying (5.29), which have the further property that b 1 and c 1 are relatively prime. Thus a .. 2b�, cf constitute a primitive Pythagorean triple. Hence by Theorem 5.4 Assorted Examples 239 5.5 there exist positive relatively prime integers r', s' of opposite parity such that (5.34) b� = r's', (5 .35) (5.36) Then by (5.35) and Lemma 5.4 we see that there exist positive integers x ' and y' such that r' = x'2, s' = y'2• Setting z' = c1, we conclude by (5.36) that x', y ', z' is a solution of (5.27) in positive integers. Here z' � c, and hence by (5.33) we see that z' < z. Thus the set of values of z arising in solutions of (5.27) has no least element. Since every nonempty set of positive integers contains a least element, it follows that the set of such z is empty; that is, equation (5.27) has no solution in positive integers. PROBLEMS 1. Show that the equation x2 + y 2 = 9z + 3 has no integral solution. 2. Show that the equation x 2 + 2y 2 = 8z + 5 has no integral solution. 3. Show that the equation (x 2 + y 2)2 - 2(3x 2 - 5y 2f = z 2 has no inte­ gral solution. (H) 4. Show that if x, y, z are integers such that x 2 + y 2 + z 2 = 2xyz, then x = y = z = 0. (H) 5. Show that the equation x 2 + y 2 = 3(u 2 + v 2) has no nontrivial inte­ gral solution. 6. Show that if x 3 + 2y 3 + 4z 3 = 6xyz (mod 7) then x = y = z = 0 (mod 7). Deduce that the equation x 3 + 2y 3 + 4z 3 = 6xyz has no nontrivial integral solutions. 7. Let f(x, y, z) = x 3 + 2y 3 + 4z 3 - 6xyz. Show that the equation f(r, s, t) + 7f(u, v, w) + 49f(x, y, z) = 0 has no nontrivial integral solution. 8. Let f(x) = f(x t> x2, x3) = xt +xi + x1 - x�x� - x�x� - x�x� - x 1 x 2 x 3(x 1 + x 2 + x 3). Show that f(x) = l(mod 4) unless all three variables are even. Deduce that if f(x) + f(y) + f(z) = 4{f(u) + f(v) + f(w)) for integral values of the variables, then all 18 variables are 0. 9. Show that the equation x 3 + 2y 3 = 7(u3 + 2v 3) has no nontrivial integral solution. 240 Some Diophantine Equations 10. Find all integral solutions of the equation x4 + 2x3 + 2x2 + 2x + 5 = y 2. 11. Let F(x) = (x2 - 17Xx2 - 19Xx 2 - 323). Show that for every inte­ ger m, the congruence F(x) = O(mod m) has a solution. Note that the equation F(x) = 0 has no integral solution, nor indeed any rational solution. 12. Show that the equation x2 = y3 + 23 has no solution in integers. (H) 13. Show that Fermat's equation (5.28) has no solution in positive inte­ gers x, y, z if n is a positive integer, n = 0 (mod 4). *14. Construct a descent argument that relates the two equations x4 + 4y4 = z2, a4 + b2 = c4• Deduce that neither of these equations has a solution in positive integers. 15. Show that there exist no positive integers m and n such that m2 + n2 and m2 - n2 are both perfect squares. *16. Consider a right triangle the lengths of whose sides are integers. Prove that the area cannot be a perfect square. 17. The preceding problem was asked by Fermat in the following alterna­ tive form: If the lengths of the sides of a right triangle are rational numbers, then the area of the triangle cannot be the square of a rational number. Derive this from the former version. 5.5 TERNARY QUADRATIC FORMS The general ternary quadratic form is a polynomial f(x, y, z) of the sort f( x, y, z) = ax2 + by2 + cz2 + dxy + eyz + fzx. In this section we develop a procedure for determining whether the Diophantine equation f(x, y, z) = 0 has a nontrivial solution. In the next section we show how all solutions of this equation may be found, once a single solution has been identified. A triple (x, y, z) of numbers for which f(x, y, z) = 0 is called a zero of the form. The solution (0, 0, 0) is the trivial zero. If we have a solution in rational numbers, not all zero, then we can construct a primitive solution in integers by multiplying each coordinate by the least common denomina­ tor of the three. For example, (3 j5, 4j5, 1) is a zero of the form x 2 + y 2 - z 2, and hence (3, 4, 5) is a primitive integral solution. Suppose now 5.5 Ternary Quadratic Forms that A = [ a;) is a 3 X 3 matrix with rational elements, and put g ( x, y, z ) 241 =f(allx + a 12 y + a13z , a21x + a22 y + a23z ,a31x + a32 y + a33 z). Here g(x, y, z) is another ternary quadratic form, whose coefficients are determined in terms of the a;i and the coefficients of f(x, y, z ). We assume that the coefficients of f(x, y, z) are rational, so it follows that the coefficients of g(x, y, z) are also rational. If the triple (x0, y0, z0) is a nontrivial rational zero of g, then on inserting these values in the equation we obtain a rational zero of f. To ensure that this zero is nontrivial, we suppose that A is nonsingular. That is, det (A) -:1= 0. Let B = [b;) denote the inverse of A, B = A - l, so that f( x ,y ,z ) = g ( b1 1x + b 12 y + b 13z, b21x + b22 Y + b23 z, b31x + b32y + b33 z). Thus for our present purposes we may regard g as equivalent to f, since g has a nontrivial rational zero if and only if f does. This is an equivalence relation in the usual sense. The linear transformation (5.37) maps �3 to �3 in a one-to-one and onto manner, with the origin (0, 0, 0) mapped to itself. Since the elements of A and A - 1 are rational, this transformation takes 03 to 03 in the same way. Moreover, if two points have proportional coordinates, say (x0, y0, z0) and (ax0, ay0, az0), with a -:1= 0, then their images (x0, y0, z0) and (ax0, ay0, az0) are proportional. By making linear changes of variables, we may pass from the given quadratic form f to a new form g of simpler appearance. For example, by completing the square, we may eliminate the coefficients of xy, of yz, and of zx, so that our form is diagonal. By multiplying by a nonzero rational number, if necessary, we may assume that our new coefficients of x 2, y 2, and z 2 are integers with no common factor. That is, through a sequence of changes of variables we reach an equation of the form (5.38) with g.c.d.(a, b, c) = 1. If a = 0 then this equation has nontrivial solutions if and only if - b jc is the square of a rational number. Thus we may 242 Some Diophantine Equations confine our attention to the case in which a, b, and c are nonzero. We may write a = a's2 with a' square-free, and thus ax 2 = a'(.s:xf = a'x'2, say. By making transformations of this kind, we may assume that a, b, and c are square-free. Suppose that pi a and plb. Since a, b, c are relatively prime, it follows that p% c, and hence that plz. Writing z = pz', we discover that ax 2 + by 2 + cz2 = p((ajp)x 2 + (bjp)y 2 + pcz'2). Here we have passed from a set of coefficients a, b, c of which two are divisible by p, to a new set of coefficients, ajp, bjp, cp, only one of which is divisible by p. By making further transformations of this sort, we eventually obtain nonzero square-free coefficients that are pairwise relatively prime. That is, abc is a square-free integer. This situation is very elegantly addressed by the following fundamental theorem of Legendre. Theorem 5.11 Let a, b, c be nonzero integers such that the product abc is square-free. Necessary and sufficient conditions that ax 2 + by 2 + cz 2 = 0 have a solution in integers x, y, z, not all zero, are that a, b, c do not have the same sign, and that -be, - ac, - ab are quadratic residues modulo a, b, c, respectively. Before giving the proof of this result we establish two lemmas. Lemma 5.12 Let A, J.L, v be positive real numbers with product AJ.Lv =man integer. Then any congruence ax + f3y + yz = 0 (mod m) has a solution x, y, z, not all zero, such that lx l �A, IY I � J.L, lzl � v. Proof Let x range over the values 0, 1, · · ·, [A], y over 0, 1, · · · , [J.L], and z over 0, 1, - · · , [v ]. This gives us (1 + [A]X1 + [J.L]X1 + [v]) different triples x, y, z. Now (1 + [A]X1 + [J.L]X1 + [v]) > AJ.Lv = m by Theorem 4.1, part 1, and hence there must be some two triples Xp Yt > z1 and x2, y2, z2 such that ax1 + f3y 1 + yz1 = ax2 + f3y2 + yz2 (mod m). Then we have a(x 1 - x2) + f3(y1 - y2) + y(z1 - z2) = O(mod m), lx 1 - x2 1 � [A] � A, IYt - Y2 l � J.L, lzt - z2 1 � v. Lemma 5.13 Suppose that ax2 + by2 + cz2 factors into linear factors mod­ ulo m and also modulo n; that is If (m, n) = 1 then ax2 + by2 + cz2 factors into linear factors modulo mn. 5. 5 Ternary Quadratic Forms 243 Proof Using Theorem 2.18, we can choose a, {3, y, a', {3', y' to satisfy Then the congruence ax2 + by2 + cz2 = ( ax + f3Y + yz )( a'x + f3'y + y'z) holds modulo m and modulo n, and hence it holds modulo mn. Proof of Theorem 5. 11 If ax2 + by2 + cz2 = 0 has a solution x0, y0, z0 not all zero, then a, b, c are not of the same sign. Dividing x0, y0, z0 by (x0, y0, z0) we have a solution x1, y1, z1 with (x t> y 1, z1 ) = 1. Next we prove that (c, x 1) = 1. If this were not so there would be a prime p dividing both c and x 1• Then p% b since pIc and abc is square-free. Therefore plby� and p%b, hence ply�, P IY t> and then p2 l(ax� +by�) so that p2 lczr But c is square-free so plz 1• We have concluded that p is a factor of x 1, Y t> and z1 contrary to (x t> y 1, z1 ) = 1. Consequently, we have (c, x 1 ) = 1. Let u be chosen to satisfy ux1 = 1 (mod c). Then the equation axf + by� + cz� = 0 implies ax� + by � = O(mod c), and multiplying this by u 2b we get u 2b2y� = -ab (mod c). Thus we have established that -ab is a quadratic residue modulo c. A similar proof shows that -be and -ac are quadratic residues modulo a and b respectively. Conversely, let us assume that -be, - ac, - ab are quadratic residues modulo a, b, c respectively. Note that this property does not change if a, b, c are replaced by their negatives. Since a, b, c are not of the same sign, we can change the signs of all of them, if necessary, in order to have one positive and two of them negative. Then, perhaps with a change of notation, we can arrange it so that a is positive and b and c are negative. Define r as a solution of r2 = -ab (mod c), and a1 as a solution of aa 1 = 1 (mod c). These solutions exist because of our assumptions on a, b, c. Then we can write = a 1( ax - ry)( ax + ry) = ( x - a1ry)( ax + ry) (mod c) , ax2 + by 2 + cz2 = ( x- a1ry )( ax + ry) (mod c ) . Thus ax2 + by2 + cz2 is the product of two linear factors modulo c, and 244 Some Diophantine Equations similarly modulo a and modulo b. Applying Lemma 5.13 twice, we conclude that ax2 + by2 + cz2 can be written as the product of two linear factors modulo abc. That is, there exist numbers a, {3, y, a', {3', y' such that ax2 + by2 + cz2 =( ax + f3y + yz )( a'x + f3'y + y'z) (mod abc) . (5 .39) Now we apply Lemma 5.12 to the congruence ax + {3y + yz = 0 (mod abc ) (5.40) using A = ..fbc, f.L = v'faCT . v = /labT. Thus we get a solution x1, y , z1 of the congruence (5.40) with lx1 1 � ..fbc , IY 1 1 � v'faCT . lz1 1 � M. But abc is s;uare-free, so ..fbc is an integer only if it is 1, and similarly for v'faCT and I ab I . Therefore we have x� � be with equality possible only if b = c = -1 ly1 1 � v'faCT , y� � -ac with equality possible only if a = 1, c = - 1 lz1 1 � v'fabT, zf � -ab with equality possible only if a = 1, b = -1 . Hence, since a is positive and b and c are negative, we have, unless b = c = -1, 2 + b 2 2 2 b ax1 y1 + cz1 � ax 1 <a c and axf+byf +czf �byf +cz� >b(- ac ) +c( -ab ) = -2abc . Leaving aside the special case when b = c = - 1, we have -2abc < axf + byf + czf <abc . Now xt> y 1, z1 is a solution of (5.40) and so also, because of (5.39), a solution of ax2 + by2 + cz2 = 0 (mod abc ) . 5. 5 Ternary Quadratic Forms 245 Thus the above inequalities imply that or In the first case we have our solution of ax2 + by2 + cz2 = 0. In the second case we readily verify that x2, y2, z2, defined by x2 = -by1 + x1z1, y2 = ax1 + y1z1, z2 = z� + ab, form a solution. In case x2 = y2 = z2 = 0 then z� + ab = 0, z� = -ab and z1 = ± 1 because ab, like abc, is square-free. Then a = 1, b = 1, and x = 1, y = -1, z = 0 is a solution. Finally we must dispose of the special case b = c = -1. The condi­ tions on a, b, c now imply that -1 is a quadratic residue modulo a; in other words, that N(a) of Theorem 3.21 is positive. By Theorem 3.21 this implies that r(a) is positive and hence that the equation y2 + z2 = a has a solution y1, z1• Then x = 1, y = y., z = z1 is a solution of ax2 + by2 + cz 2 = 0 since b = c = - 1. Example 6 Determine whether the Diophantine equation x2 + 3y2 + 5z2 + 7xy + 9yz + 11zx = 0 has a nontrivial integral solution. Solution The given form is ( 7 11 )2 37 2 101 2 41 X+ zY + Tz - 4y - 4z - 4yz = g(x', y', z') 7 11 where x' = x + -y + -z y' = y z' = z. Thus 2 2 ' ' 4g(x, y, z) = 4x2 - 37y2 - 101z2 - 41yz Here ( 41 )2 13267 = 4x2 - 37 y + -z - --z2 = h(x\" y\" z\"). 74 148 ' ' 148h(x, y, z) = 592x2 - 5476y2 - 13267z2 = 37(4x)2 - (74y)2 - 13267z2,- so we apply Theorem 5.11 to the form 37x2 - y2 - 13267z2. As 37 and ( 37 ) ( -13267 ) ( 490879 ) 13267 are prime,. and 13267 = 37 = 1 = 1, we con- clude that the given equation has a nontrivial solution. 5. 5 Ternary Quadratic Forms 247 This simple result will be useful in Section 6.4, in the proof of Lagrange's theorem concerning representations of n as a sum of four squares. Proof If p divides one of the coefficients, say pI a, then it suffices to take x = 1, y = z = 0. Suppose that p% abc. If p = 2 then it suffices to take x = y = 1, z = 0, so we may suppose that p > 2. We put x = 1. Let ../= {a + by 2 : y = 0, 1, · ·· ,( p - 1)/2}, and let !T= {- cz 2: z = 0, 1, - · ·,(p - 1)/2}. If a+ by � = a+ by� (mod p), then by Lemma 2. 10 we see that y 1 = ± y 2 (mod p ). If such y 1 and y 2 are members of the set 0, 1, - · ·,( p - 1)/2, then it follows that y1 = y2• Hence the (p + 1)/2 members of ../ lie in distinct residue classes (mod p). Similarly, the (p + 1)/2 members of !T lie in distinct residue classes (mod p). Since the total number of residue classes is larger than p, by the pigeonhole principle it follows that there is a member of ../ that is congruent to a member of :7. That is, a + by 2 + cz 2 = 0 (mod p) for some choice of y and z. If pis odd, p%abc, then a nontrivial solution of (5.41) lifts to higher powers of p, by Hensel's lemma. Powers of 2 are another matter. Suppose first that abc is odd. The congruence ax 2 + by 2 + cz 2 = 0 (mod 4) has no solution with g.c.d.(x, y, z, 2) = 1 if a = b = c (mod 4). In Theorem 5. 11 we find conditions under which the equation has a nontrivial integral solution. These conditions therefore imply that the coefficients do not all lie in the same residue class (mod 4). To demonstrate this more directly, ( -be ) one may note that the hypotheses imply that P = 1 for all prime divisors p of a, and similarly for the prime divisors of b and of c. On multiplying these relations together, we deduce that n- n- n- =1 ( - be ) ( - ca ) ( - ab ) pi a P p l b P pi c P By multiplying all three coefficients by -1, andjor permuting them, we may suppose that a > 0, b > 0, and c < 0. Then by quadratic reciprocity the above equation reduces to b- 1 c+ l c+ l a-1 a-1 b- 1 c+ l -·- + -·- + -·- + - ( - 1) 2 2 2 2 2 2 2 = 1. It may be seen that this amounts to the assertion that not all of a, b, c lie in the same residue class (mod 4). Once one has a nontrivial solution 248 Some Diophantine Equations (mod 4), the solution may be lifted to higher powers of 2. The case in which one of the coefficients is even is a little more complicated, as there are several cases to consider. We omit the details, but remark that the conditions stated in Theorem 5.1 1 may be shown in a similar manner to imply that the sum of the two odd coefficients is not = 4 (mod 8). This is precisely the condition needed to ensure the existence of a nontrivial solution of the congruence (mod 8), and then such a solution may be lifted to higher powers of 2. PROBLEMS 1. Use Theorem 5.11 to show that the equation 2x 2 + 5y 2 - 7z 2 = 0 has a nontrivial integral solution. 2. What is the least positive square-free integer c such that (c, 105) = 1, and such that the equation -7x 2 + 15y2 + cz2 = 0 has a nontrivial integral solution? 3. Determine whether the equation 3x2 + 5y2 + 7z2 + 9xy + 11yz + 13zx = 0 has a nontrivial integral solution. 4. Determine whether the equation 5x2 + 7y2 + 9z2 + 11xy + 13yz + 15zx = 0 has a nontrivial integral solution. 5. Determine whether the equation x2 + 3y2 + 5z 2 + 2xy + 4yz + 6zx = 0 has a nontrivial integral solution. 6. Show that in the proof of Theorem 5.11 we have established more than the theorem stated, that the following stronger result is implied. Let a, b, c be nonzero integers not of the same sign such that the product abc is square-free. Then the following three conditions are equivalent. (a) ax2 + by2 + cz2 = 0 has a solution x, y, z not all zero; (b) ax2 + by2 + cz2 factors into linear factors modulo abc; (c) -be, - ac, - ab are quadratic residues modulo a, b, c, respec­ tively. 7. Suppose that a, b, and c are given integers, and let N(p) denote the number of solutions of the congruence (5.41), including the trivial solution. Show that if p divides all the coefficients then N(p) = p3, that if it divides exactly two of the coefficients then N(p) = p2, and 250 Some Diophantine Equations Figure 5.1. The ellipse x2 + 5y 2 = 1. By taking the line through (1, 0) with slope 1 , we obtain the second rational point (2/3, - 1/3). and we enjoy some limited success with cubic curves, but curves of degree 4 or larger generally do not surrender to such a simple attack. Before establishing general results, we demonstrate how the method works in practice. Example 8 Find all rational points on the ellipse x2 + 5y2 = 1 . Solution We observe that the point (1, 0) is a rational point on this curve. If (x1 , y1 ) is a second rational point on this curve, then the slope m of the line joining these two points is a rational number, for m = y1 / (x1 - 1). Conversely, suppose that m is a rational number, as in Figure 5.1. The line through (1, 0) with slope m has the equation y = m(x - 1). To find the other intersection of this line with the ellipse, we replace y by m(x - 1) in the formula for the ellipse. This gives us a quadratic in x, with one known root, x = 1, so we may factor the quadratic to find the other root. 0 = x2 + 5y2 - 1 = x2 + 5( m( x - 1)) 2 - 1 = (x - 1)((5m2 + 1)x - (5m2 - 1) ). Thus the second intersection of the line with the ellipse is at a point whose x-coordinate is x1 = (5m2 - l)j(5m2 + 1). To find the y-coordinate of this point, we use the equation of the line y1 = m(x1 - 1). Mter simplify­ ing, we find that y 1 = - 2mj(5m2 + 1). Since m is assumed to be a 5. 6 Rational Points on Curves 251 rational number, it follows that both x1 and y1 are rational. Hence we see that the equations m = y 1j( x1 - 1) , x1 = (5m2 - 1)/(5m2 + 1) , y1 = -2mj(5m2 + 1) (5 .42) determine a one-to-one correspondence between rational numbers m and rational points (x1 , y1 ) on the ellipse x2 + 5y2 = 1, apart from the point (1, 0) that we started with. The rational number m may be expressed as the quotient of two integers, m = r js, and hence we may write x1 = (5r2 - s2)j(Sr2 + s2), y1 = -2rsj(Sr2 + s2). As a consequence, if a triple (X, Y, Z) of integers is given for which X2 + 5Y 2 = Z 2, then the point (X/Z, Y /Z) lies on our ellipse, and hence there exist integers r and s such that the triple (5r2 - s2, - 2rs, 5r2 + s2) is proportional to the triple (X, Y, Z). We do not necessarily obtain all primitive triples in this way. (Recall Problem 12 at the end of Section 5.3.) Our new method is much more flexible than that used in Section 5.3, but it has the disadvantage of giving less precise information. In Example 8, our line intersected the ellipse at two points, except for the vertical line (m = oo), which is tangent to the ellipse. More generally, let f(x, y) be a polynomial of degree d with real coefficients, and let ax+ by + c = 0 be the equation of a line L. Here not both a and b are zero. By interchanging x and y, if necessary, we may assume that b '* 0 (i.e., the line is not \"vertical\"). Then by a further change of notation, we may write the equation determining the line in the form y = mx + r. The x-coordinates of the points of intersection of L with the curve �(IR) are the roots of the polynomial p( x) = f( x, mx + r) , (5.43) which is of degree at most d. By the fundamental theorem of algebra (discussed in Appendix A.1), we know that the number of complex roots of a polynomial, counting multiplicity, is exactly the degree of the polyno­ mial. Thus p(x) can have at most d distinct real roots, unless p(x) vanishes identically. In the latter case every point of the line is also on the curve �(IR), and we say that L is a component of �(IR). We can actually prove a little more, namely that the polynomial y - mx - r is a factor of the polynomial f( x, y ). To see why this is so, let u = y - mx - r, so that f(x, y) = f(x, u + mx + r). By multiplying out powers of u + mx + r, we see that this new expression is a polynomial in x and u. Each power of u is multiplied by a linear combination of powers of x. That is, f( x, u + mx + r) = f0(x ) + f1(x)u + /2( x)u 2 + · · · +fA x ) ud 252 Some Diophantine Equations where f1(x) is a polynomial in x of degree at most d - i. Reverting to our original variables, we see that we have shown that any polynomial f(x, y) may be written in the form d f( x , y) = Ef1(x)( y-mx-r) 1 • i�O From the definition of the polynomial p(x) in (5.43), we see that p(x) = f0(x). Thus if p(x) vanishes identically, then f(x, y) = (y - mx ­ r)k(x, y), where k(x, y) = \"f.1 > 0f1(xX y - mx- r)1 - 1• We note, moreover, that the coefficients of the ft(x) are determined by m, r, and the coeffi­ cients of f(x, y ), using only multiplication and addition. Thus, in particu­ lar, if m, r and the coefficients of f(x, y) are all real, then the coefficients of k(x, y) are real, while if m, r and the coefficients of f(x, y) are rational, then the coefficients of k(x, y) are rational. Thus we have proved the following useful result. Theorem 5.15 Let f(x, y) be a polynomial with real coefficients and degree d. Let m and r be real numbers, and let L denote the set of points (x, y) for which y = mx + r. If the curoe �(IR) and the line L have strictly more than d distinct points in common, then L k �(IR), and there is a polynomial k(x, y) with real coefficients such that f( x, y) = (y - mx- r)k( x, y) . Ifm, r, and the coefficients off(x, y) are all rational, then the coefficients of k(x, y) are also rational. This may be refined by considering possible multiple roots of p(x). Since the argument hinges on proving that p(x) is identically 0, the conclusion of the theorem may be drawn whenever the total number of roots of p(x ), counting multiplicity, is known to be strictly greater than d. If (x0, y0) lies on the intersection of �(IR) and L, then p(x) has a zero at x = x0• The multiplicity of this zero is called the intersection multiplicity of � with L. In general we expect that x0 is a simple zero of p(x), that is, the intersection multiplicity is 1, but it is important to understand the circumstances in which it is larger. In Example 8 it was of critical importance that the second root of p(x) is distinct from the first, since the approach fails if p(x) has a double root at x0. To be precise, let us write Since f(O, 0) = a00, the origin lies on the curve if and only if a00 = 0. The further coefficients are related to the partial derivatives of f. If we 5. 6 Rational Points on Curves 253 differentiate i times with respect to x, j times with respect to y, and then set x = y = 0, we find that (a a );(a a )jt(x,y)l = i!j!a;j · x Y <� m This is a two-variable analogue of Taylor's coefficient formula. For brevity, let �;)0, 0) denote this partial derivative. In terms of these quantities, we find that Here we have sorted monomial terms xiyi according to their degree and have put all terms of degree i + j = n in the inner sum. By translating variables, we may expand f(x, y) in powers of x -x0 and y -y0, so that in general For a given point P = (x0, y0) in the Euclidean plane IR2, let M be the largest integer so that �;)x0, y0) = 0 whenever i + j < M. Then M is called the multiplicity of the point P on �(IR). Thus �(IR) is precisely the set of points in the plane for which M is positive. A point P of �(IR) is a simple point if M = 1, and we say that the curve is smooth at P. We recall from calculus that the gradient of the function f(x, y) is the vector (� 1, 0, �o. t ). This vector points in the direction in which f increases most rapidly. A tangent to the level curve f(x, y) = 0 is therefore perpendicular to the gradient. Hence the vector ( - �0• 1 , � 1• 0) is an example of a tangent vector, provided that at least one of these coordinates is nonzero. Thus the tangent vector is well-defined at a simple point of the curve, and the implicit function theorem may be used to show that there is a neighbor­ hood of P that contains a unique branch of the curve. A point P of the curve �(IR) for which M > 1 is called a singular point. If all points of a curve are simple, including any points at infinity that may lie on the curve, then the curve is called nonsingular or smooth . (The idea of points at infinity is clarified in our remarks on projective coordinates at the end of this section.) A point of the curve for which M = 2 is a double point, M = 3 a triple point, and so on. 254 Some Diophantine Equations We now relate the multiplicity M of a point on a curve to the intersection multiplicity of a line L passing through a point (x0, y0) of the curve. Using the formula (5.44), we may express the polynomial p(x) more explicitly. Substituting y = y0 + m(x - x0), we find that Here the inner sum is a polynomial in m, say qn(m), of degree at most n. Hence the above may be written more briefly as From this formula we see that the intersection multiplicity is the least value of n for which qn(m) '* 0. In view of the definition of M, if n < M then all coefficients of qn(u) are 0, and hence qn(m) = 0 for all m. On the other hand, at least one coefficient of qM(u) is nonzero, so that in general qM(m) '* 0. Indeed, there can be at most M values of m for which qM(m) = 0. That is, the intersection multiplicity of L with �(IR) is at least M for any line through the point (x0, y0), but is greater than M for at most M such lines. The case M = 1 (i.e., a simple point) is of particular interest. Since q1(u) = �0• 1u + � 1• 0, we see that q1(m) = 0 if and only if m = - � 1. 0/ �0• 1. But this is the slope of the tangent line to the curve, so we conclude that a line passing through a simple point of the curve has intersection multiplicity 1 unless it is the tangent line, in which case the intersection multiplicity is 2 or greater. Generally it is not greater. If the tangent line at a simple point (x0, y0) has intersection multiplicity 3 or more, then the point is called an inflection point, or flex. We assume that not all coefficients of the polynomial f(x, y) vanish, for otherwise �(IR) consists of the entire plane, and the degree of f is undefined. If d is the degree of f, then at least one coefficient of the polynomial qiu) is nonzero, and hence M � d at any point of the curve. An algebraic curve may consist solely of an isolated point of multiplicity d, as happens with the curve given by f(x, y) = x2 + y2. If our curve has one point (x0, y0) of multiplicity d, and some other point (x1 , y1) distinct from the first point, then the line through these two points intersects the curve at least d times at the first point, and at least once at the second. Since the sum of the intersection multiplicities is greater than d, the polynomial p(x) has more roots than its degree, and must therefore vanish identically. Thus the line in question is a subset of the curve, and by Theorem 5.15, the linear polynomial defining the line is a factor of f(x, y ) . Since this 5. 6 Rational Points on Curves 255 argument can be applied to any point (x1, y1 ) of the curve other than (x0, y0), we deduce that the curve consists entirely of at most d lines passing through (x0, y0). In particular, a conic with a double point that is not isolated is either the union of two distinct lines, f(x, y) = (a1 x + b1 y + c1Xa2x + b2 y + c2), or is a single, doubled line, f(x, y) =(ax+ by + cf. Similarly, a cubic curve may have a triple point, in which cas�. it consists of at most three lines through the point. If a cubic has two distinct singular points, then the line joining them intersects the cubic with multiplicity at least 2 at each point, and therefore the line lies in the cubic and the cubic polynomial has a linear factor. We are now in a position to demonstrate that the method of Example 8 applies to any nonsingular conic. Let f(x, y) be a quadratic polynomial with rational coefficients, and suppose that the curve �(IR) contains a rational point (x0, y0). Let m0 denote the slope of the tangent line to � through (x0, y0). Thus m0 is a rational number. If m is rational, m '* m0, then the line L through (x0, y0) with slope m has intersection multiplicity 1. With p(x ) defined by (5.43), we see that the coefficient of x2 in p(x ) is f(l, m ). If f(l, y) vanishes identically, then the line x = 1 lies in the conic, which is contrary to our supposition that the conic is nonsingular. Since f(l, y) is of degree 2 at most, there may exist one or two rational values of m, say m1 and m2, for which f(l, m ) = 0. For such m, p(x ) is linear, and x = x0 is its only root. For all rational m distinct from m0, m1, m 2, the polynomial p(x) has rational coordinates, is of degree 2, and has a simple root at the rational number x0. It must therefore have a second rational root, x1• Since y1 = m(x1 - x0 ), the point (x1, y1 ) is a new rational point on the curve, and the method succeeds. If p(x ) = anxn + an - lxn - l + . . . is a polynomial, then the sum of the roots of this polynomial is -an _ 1fan . (The reader unfamiliar with this should consult the Appendixes A. l and A.2.) That is, if r1, · · · , rn denote the roots, then (5 .45) In general, the roots may be complex, but we see from this identity that if the coefficients of p(x ) are rational, and if all but one of the roots is rational, then the last root must also be rational. We have already found this useful when n = 2, but we now apply this principle with n = 3. Suppose that f(x, y) is a cubic polynomial with rational coefficients, and suppose that (x0, y0) is a double' point of the curve �(IR). It is known that (x0, y0) must be a rational point. (We do not prove this, but note Problems 7 and 8 at the end of this section.) Assuming that it is a rational point, we observe that a line through (x0, y0) with rational slope m has 256 Some Diophantine Equations intersection multiplicity 2 with the curve, apart from at most two excep­ tional values of m, say m1 and m 2• Thus p(x) has three roots, two of which are x0• The third root must therefore be rational, and we are again able to parameterize the rational points on the curve by means of rational values of m. Example 9 Find all rational points on the curve y2 = x3 - 3x + 2. Solution Put f(x, y) = y2 - x3 + 3x - 2. To determine whether the curve -f/.1 has any singular points, we note that a f = - 3x2 + 3, which ax vanishes if and only if x = ± 1. Similarly, at = 2y, which vanishes if and ay only if y = 0. The point ( - 1, 0) does not lie on the curve, but the point azf (1, 0) is a singular point on the curve. Since -2 (1, 0) = - 6, this point is a ax double point. Setting p(x) = f(x, m(x - 1)), we find by direct calculation that As x0 = 1 is a double root of this polynomial, we deduce from (5.45) that the third root is x1 = m2 - 2. Hence y1 = m(x1 - 1) = m3 - 3m. That is, the equations x = m2 - 2, y m= y = m3 - 3m, X- 1 determine a one-to-one correspondence between rational points (x, y) on the curve and rational numbers m, as depicted in Figure 5.2. Most cubic curves do not have a double point. We now consider the possible existence of rational points on such a nonsingular cubic curve �­ We observe that if A = (x0, y0) and B = (x1, y1 ) are rational points on � then the line L through these points has rational slope. If L is a component of � then � is the union of a line and a conic, in which case we have no trouble parameterizing the rational points of �- Thus we assume that � contains no line, so that L intersects � at a unique third point of �. which we denote AB. In view of (5.45), the point AB is also a rational point. If A -:/= B, then the line L is called a chord of the curve, 5. 6 Rational Points on Curves 257 Figure 5.2. The cubic curve y 2 = x3 - 3x + 2 with double point (1, 0). The line through (1, 0) with slope 1 gives the further point ( -1 , - 2). whereas if A = B, then L is tangent to the curve. By means of this chord-and-tangent method we may construct new rational points from a few known ones. In some cases we obtain only a finite configuration of points, and indeed such a curve may contain only finitely many rational points. In other instances we may use this method to construct infinitely many rational points on the curve, although in general we have no way of knowing whether we have generated all the rational points. In the next section we mention some advanced tools by which one may determine whether a given finite collection of rational points on a nonsingular cubic curve generates infinitely many other rational points, but in many specific cases one may resolve the issue by detailed elementary reasoning. We turn to an example of this type. Theorem 5.16 The cubic curve x3 + y3 = 9 contains infinitely many ratio­ nal points. Proof We define three sequences Xn, Yn , Zn of integers by means of the initial conditions X0 = 2, Y0 = 1, Z0 = 1 and the recurrences 258 Some Diophantine Equations for n � 0. By induction one may show that x; + Yn3 = 9Z� for all n � 0. Here the basis of the induction is easily verified, and the inductive step is completed by appealing to the recurrences and the inductive hypothesis. Taken out of context, these formulae might seem quite remarkable, but in fact ( Xn + t!Zn + t• Yn + t!Zn + t) is the third point of intersection of the tangent to the curve x 3 + y 3 = 9 at the point (Xn!Zn , Yn/Zn ). Since each member of the sequence xn divides the next, it follows that all the xn are even. By an easy induction we see that the Yn and Zn are all odd. It follows that x; + 2Yn3 = 2 (mod 4) for all n. Thus the power of 2 in Xn + 1 is precisely one more than the power of 2 in Xn , so that 2 n + 1 11Xn . We have not established that the fractions Xn!Zn are in lowest terms, but we see in any case that no two of these rational numbers may be equal. Hence we have constructed infinitely many distinct points on the curve. We conclude this section with a few remarks concerning the proper­ ties of algebraic curves. Let f(x, y) have degree d, and g(x, y) have degree e. If �(IR) and -G'/IR) have more than de distinct points in common, then they have a common component. More generally, Bezout's theorem asserts that if -G'/C) and -G'/C) have no common component then they have exactly de points in common, provided that multiple intersec­ tions are counted correctly. If f(x, y) and g(x, y) are polynomials, then we say that g divides f, and write glf, if there is a polynomial h(x, y) such that we have a polynomial identity f(x, y) = g(x, y )h(x, y ). It is not hard to show that if such a polynomial exists, then its coefficients lie in the same field as the field containing the coefficients of f and g. A polynomial with coefficients in a certain field is called irreducible over that field if it cannot be written as a product of two polynomials of lower degree, with coefficients in the same field. This is analogous to the definition of a prime number. Al­ though we make no use of the fact, it is nevertheless reassuring to know that the factorization of a polynomial, in any number of variables, and over any given field, is unique, apart from multiplication by constant factors. If f(x, y) and g(x, y) have real coefficients and g lf, then -G'/IR) � -G'/IR). In Theorem 5.15 we find a converse of this when g is linear, but the converse is false if the degree of g is larger. For example, if g(x, y) = (x - 1)2 + y 2 and f(x, y) = x + y - 1, then -G'/IR) = {(1, 0)} � �(IR), but g% f. The explanation here is that the field IR of real numbers is not large enough. (In technical language, the field should be algebraically closed.) In the larger field C of complex numbers, it is true that -G'/C) � �(C) = glf. Suppose that f(x, y) is a polynomial with rational coefficients that is irreducible among such polynomials. It may happen that f(x, y) can be factored using polynomials with complex coefficients, but it is known that 5. 6 Rational Points on Curves 259 in such a case the curve �(IR) contains at most finitely many points, which may be explicitly determined. We do not prove this in general, but the special case f(x, y) = x2 - 2y2 is suggestive. This polynomial is irre­ ducible among polynomials with rational coefficients, but may be written as (x - fi y Xx + fi y ), using complex numbers. (In this case real num­ bers are enough.) The curve �(IR) is the union of two lines of irrational slope, and the only rational point on these lines is the point (0, 0), at their intersection. If f(x, y) is irreducible over the field C of complex numbers, then we call f absolutely i\"educible, and we call the curve �(C) i\"educible. Thus we see that for purposes of locating rational points on algebraic curves it is enough to consider absolutely irreducible polynomials. The curves we have considered are called affine and may have \"points at infinity.\" Suppose that f(x, y) is a polynomial of degree d. Put F(X, Y, Z) = f(XjZ, Y /Z)Zd. Then F( X, Y, Z) is a homogeneous poly­ nomial of degree d. Consequently, F(aX, aY, aZ) = adF( X, Y, Z) for any values of a, X, Y, Z. In particular, if a * 0 then F(X, Y, Z) = 0 if and only if F(aX, aY, aZ) = 0. On IR3 \\ {(0, 0, 0)} we define an equiva­ lence relation by saying that two points are equivalent if their coordinates are proportional. That is, there is a nonzero real number a such that aX1 = X2, aY1 = Y2, aZ1 = Z2• Thus the equivalence classes consist of lines in IR3 passing through the origin, with the origin removed. Such an equivalence class is a point of the projective plane IPiiR). To emphasize that it is the proportion of the coefficients that is significant, we write projective coordinates in the form X : Y : Z. Our customary xy affine coordinates are embedded in the projective plane by the correspondence (x, y) - x: y: 1, but 1Jl>2(1R) includes points of the form X: Y: 0, with not both X= 0 and Y = 0. These are the \"points at infinity.\" For example, the familiar hyperbola x2 - y2 = 1 becomes X 2 - Y 2 = Z 2 in the projec­ tive plane. This equation has the solutions 1 : 1 : 0 and 1 : - 1 : 0, which do not correspond to any finite point in affine xy coordinates. One advantage of projective coordinates is that the linear change of variables (5.37) is very natural and can be used to put a given equation into a simpler form. The problem of finding the singularities of a curve is also easier in projective coordinates. For example, the curve y = x 3 + 1 has no singularity in the affine .xy-plane, but if we compute partial derivatives of the homogeneous polynomial YZ2 = X3 + Z3 we discover a double point at 0: 1: 0. In affine xz-coordinates, this curve is determined by the equation z2 = x3 + z3, and the double point at (0, 0) is apparent. A projective line through the point 0: 1: 0 is a line of the form X= mZ. In the original .xy-coordinates, this is the vertical line x = m. So once again we have a cubic with a double point, whose rational points are parameterized by lines through the double point, though in this case the final result was obvious at the outset. 260 Some Diophantine Equations PROBLEMS 1. Find a parameterization of the rational points on the hyperbola x2 - 2 y2 = 1, starting from the point (1 , 0). 2. Find a parameterization of the rational points on the hyperbola x2 - 2 y2 = 1, starting from the point (3, 2). 3. Apply the analysis in the text to the hyperbola x2 - y 2 = 1 with (x0, y0) = (1, 0), and thus find the slope m0 of the tangent line, and the slopes m 1 and m 2 that give no second intersection. 4. Let f(x, y) be a polynomial of degree d with real coefficients, and set p(t) = f(2tj(l + t2), (1 - t2)j(l + t2)X 1 + t2)d. Show that p(t) is a polynomial of degree at most 2d. Deduce that if \"lf/IR) has more than 2d distinct points in common with the circle x2 + y2 = 1 then this circle is a subset of �(IR). 5. Show that the curve y2 = x3 + 2x2 has a double point. Find all rational points on this curve. 6. Show that the curve y2 = x3 - 3x - 2 has an isolated double point. Use this double point to parameterize all rational points on the curve. 7. Let p(x) = ax3 + bx2 + ex + d where a, b, c, d are real numbers, not all 0. Show that if the curve y2 = p(x) has a double point, then it must be of the form (r, 0) where r is a double root of p( x). 8. Let p(x) = ax3 + bx2 + ex + d where a, b, c, d are rational num­ bers, not all 0. Show that if r is a double root of p(x), then r is rational. 9. The cubic curve x3 + y3 = 1 contains the two rational points (0, 1) and (1, 0). Explain why the chord-and-tangent method does not yield any further points on this curve. 10. Show that the cubic curve y2 = 4x3 + x2 - 2x + 1 is nonsingular. Note that this curve contains the four rational points (0, ± 1), (1, ± 2). Apply the chord-and-tangent method to these points and note the results. 11. Let the triple (Xn, Yn, Zn) of integers be defined as in the proof of Theorem 5. 16. Show that for n = 1 this is (20, - 17, 7), and that for n = 2 this is (- 36520, 188479, 90391). Show also that X3 is a 21-digit number and that X4 is an 85-digit number. 12. Let the triple (Xn , Yn, Zn) of integers be defined as in the proof of Theorem 5.16. Show that the power of 7 dividing Zn tends to infinity with n. 5. 7 Elliptic Curoes 261 13. Let the triple (Xn, Yn , Zn) of integers be defined as in the proof of Theorem 5.16, and let Hn = max(IXn l, IYn l). Show that Hn + l 1 4 �� ;;.. zHn . Deduce that Hn ;;.. 10 for n ;;.. 2. 14. Apply the tangent method to the curve x3 + y3 = 7, and thus con­ struct a recurrence that gives a new solution of the equation X3 + Y 3 = 7Z3 from a known one. Starting from the triple (2, - 1, 1), show that this generates infinitely many distinct rational points on the curve x 3 + y 3 = 7. *15. Let the triple (Xn , Yn , Zn) of integers be defined as in the proof of Theorem 5.16. Show that infinitely many of the rational points (Xn!Zn, Yn/Zn) lie in the first quadrant. 5.7 ELLIPTIC CURVES If the cubic polynomial f(x, y) has rational coefficients, we may use the chord-and-tangent method to produce new rational points on the curve �(IR) from a few known ones. As we saw in the preceding section, this sometimes, but not always, produces infinitely many rational points on the curve. We now restrict our attention to those cubic curves such that if A and B are two points of �(IR), then the line L through A and B intersects the curve at a uniquely defined third point, which we call AB. It is understood that if A = B then the line L is tangent to the curve at this point. Since one or more of the three points A, B, AB may lie at infinity, we consider the curve to be a projective curve in the real projective plane lr2(1R). In order to ensure that AB is uniquely defined, two types of cubic curves must be excluded. In the first place, if there is a line L lying within �(IR), then AB is not uniquely defined when A and B lie on L. In this case, by Theorem 5.15 the polynomial f(x, y) has a linear factor. In the second place, if A is a singular point of �(IR) then any line through A is tangent to �(IR), and hence AA is not uniquely defined. This prompts the following definition. Definition 5.2 Let f(x, y) be a cubic polynomial with real coefficients. Then �(IR) is an elliptic curve over the field of real numbers if the polynomial f(x, y) is irreducible over !R, and if the curve has no singular point in the real projective plane lr2(1R). We define elliptic curves over other fields similarly. We note that if f(x, y) has rational coefficients and if �(IR) is an elliptic curve over IR, 262 Some Diophantine Equations then -G[(Q) is an elliptic curve over Q. Similarly, if f(x, y) has real coefficients and -G[(C) is an elliptic curve over C, then -Gf-OR) is an elliptic curve over IR. Elliptic curves are precisely those cubic curves for which the binary operation AB is well-defined for all pairs of points of the curve. In general the three points A, B, AB are distinct, but they may coincide, as follows: 1. A = B. In this case L is the tangent to the curve through A. If A is an inflection point of the curve then AA = A, but otherwise AA =I= A. 2. A =1= B but AB = A. This case arises if the line joining A and B is tangent to the curve at A. 3. A =1= B but AB = B. This case arises if the line joining A and B is tangent to the curve at B. We note that in any case AB = BA, (5.46) and that A(AB) = B . (5 .47) When verifying that a particular polynomial f(x, y) defines an elliptic curv'e, the task of showing that f is irreducible may be tedious. By means of the following result we see that it is enough to demonstrate that -G[(C) is nonsingular in IP'z(C). Theorem 5.17 Let f(x, y) be a cubic polynomial with complex coefficients (which may in fact all be rational or rea/). If -G[(O is nonsingular then f(x, y) is irreducible over C. If f(x, y) is of the special shape f(x, y) = y2 - q(x) where q(x) is a cubic polynomial, then -G[(C) is nonsingular if and only if q(x) has no repeated root. Proof We show that if f(x, y) is reducible then -G[(C) has a singular point. Since f is of degree 3, if f is reducible then it can be written as a product of a linear polynomial times a quadratic polynomial. By inter­ changing x and y, if necessary, and multiplying through by a suitable nonzero constant, we find that f(x, y) may be written in the form f(x, y) = (y - mx - r)q(x, y) where m and rare complex numbers and q(x, y) is a quadratic polynomial with complex coefficients. We pass to projective coordinates, writing F(X, Y, Z) = f(ZjZ, Y jZ)Z\\ L(X, Y, Z) = Y ­ mX - rZ, Q(X, Y, Z) = q(XjZ, Y jZ)Z 2, so that F(X, Y, Z) = L(X, Y, Z)Q(X, Y, Z). Set P(X, Z) = Q(X, mX + rZ, Z). Then P(X, Z) is a quadratic form in two variables. Any such form is either identically 0, 5. 7 Elliptic Curoes 263 or else factors over C as the product of two linear forms. In either case there exist complex numbers X0, Z0, not both 0, such that Q(X0, Z0) = 0. Set Y0 = mX0 + rZ0• Then L(X0, Y0, Z0) = Q(X0, Y0, Z0) = 0. Since aF aQ aL ax ( X, Y, Z) = L( X, Y, Z) ax ( X, Y, Z ) + Q( X, Y, Z) ax ( X, Y, Z), aF we deduce that ax (X0, Y0, Z0) = 0. We argue similarly with the other partial derivatives and conclude that the point X0 : Y0 : Z0 is a singularity of the projective curve F(X, Y, Z) = 0. If Z0 -:1= 0, then the affine curve -Gj-(C) has a singularity at (X0/Z0, Y0/Z0); but if Z0 = 0, then -Gj-(C) has a singularity at the point at infinity X0 : Y0 : 0. To prove the second assertion, we use projective coordinates and write F(X, Y, Z) = Y 2Z - aX3 - bX2Z- cXZ2 - dZ3• Then we see that aF ax aF - 3aX 2 - 2bXZ - cZ2 , - = zyz aY ' aF 2 2 2 - = Y - bX - 2cXZ - 3dZ . az Suppose that X0 : Y0 : Z0 is a point of the complex projective plane IP'2(C) such that all three of these expressions vanish. First consider the possibil­ ity that Z0 = 0. Then from the first of the above relations we deduce that -3aXl = 0. But q(x) is a cubic polynomial by hypothesis, and hence a -:/= 0. Thus X0 = 0. Then from the vanishing of the third expression we deduce that Y0 = 0. But 0: 0 : 0 is not a member of the projective plane, so we conclude that F has no singularity at a point for which Z = 0. Next consider the case Z0 -:1= 0. From the vanishing of the second expression displa J ;d above, we deduce that Y0 = 0. Then the identities F(X0, 0, Z0) = ax (X0, 0, Z0) = 0 are equivalent to the identities q(X0/Z0) = q'(X0/Z0) = 0, which is equivalent to the assertion that q(x) has a repeated root at X0/Z0• This completes the proof. Example 10 Show that the equation 2x(x2 - 1) = y( y2 - 1) defines an elliptic curve -Gj-(0). Figure 5.3. Addition of A = ( - 3, 2) and B = ( -1 , 4) on the elliptic curve y 2 = x 3 - 7x + 10, using 0 = (1, 2) as the zero element. Here AB = (5, 10) and A+ B = (- 2 , - 4). Proof Let L denote the line passing through A and 0, which therefore contains the third point AO, as in Figure 5.4(a). To find A + 0 we consider the line passing through AO and 0. This is the same line L. The third point O(AO) on this line is the original point A, and thus A = A + 0. This argument may be expressed more compactly by noting that the proposed identity O(AO) = 0 follows immediately from the general identities (5.46) and (5.47). Using the definition of the sum of two points, the proposed identity A + B = B + A reads O(AB) = O(BA). This is immediate from (5.46). (a ) (b ) Figure 5.4. The curve y 2 = 4x 3 - 4x + 1, with A = ( - 1, 1), 0 = (1, 1). (a) AO = (2 , - 5), O(AO) = A. (b) 00 = (1, 1), B = A(OO) = (0, 1), AB = 00, A + B = O(AB) = O(OO) = 0. 266 Some Diophantine Equations To construct a point B such that A+ B = 0, let L1 denote the tangent line to \"lf/IR) at 0, as in Figure 5.4(b). The further intersection of this line with �(IR) is called 00. Let L2 denote the line through A and 00, which intersects �(IR) at a third point, A(OO). This is the point B. Then AB is the point 00, and O(AB) is the point 0, so that A + B = 0, as desired. In algebraic terms, we have A+ B = O(AB), by definition. Substituting B = A(OO), it follows that A + B = O(A(A{OO))), and by (5.47) this is O{OO). By a second application of (5.47), this is 0. Conversely, if A + B = 0, then O(AB) = 0, which implies that 00 = O(O(AB)) = AB, by (5.47). By (5.47) once more, we find that A(OO) = A(AB) = B. Thus B is unique, and the proof is complete. To prove that the addition of points on an elliptic curve is associative, we first prove the following subsidiary result. Lemma 5.19 Let f(x, y) and g(x, y) be cubic polynomials with real coeffi­ cients, and suppose that P 1, P 2 , · · · , P 9 are nine distinct points in the plane IR 2 that are common to the two curoes �(IR), \"!fg(IR). Suppose further that the points P1 , P2, P3 lie on a line L, but that L is not contained in �(IR). Then there is a quadratic polynomial q(x, y) such that the six remaining points P4 , P5, · · ·, P9 a// lie on the conic \"!fq(IR). To put this in perspective, note that the general quadratic polynomial q(x, y) in two variables has six coefficients. The condition that q(x1, y1) = 0 represents a homogeneous linear constraint on these six coefficients. Thus if we choose five distinct points in the plane, the five conditions q(x;, y;), 1 .;;;; i .;;;; 5, give five linear equations in the six unknown coefficients. By a basic theorem of linear algebra, a system of m homogeneous equations in n variables has a nontrivial solution provided that n > m. Thus there is a conic passing through any five given points. However, it is known that if six points in the plane are given \"in general position,\" then there is no conic that contains them all. Hence Lemma 5.19 asserts that the six points P4 , P5, · · ·, P9 are special in some sense. Proof Since L is not a subset of �(IR), we see by Theorem 5.15 that L and �(IR) can have at most three distinct points in common. Since three common points are given, the line L and the cubic �(IR) can have no further common points. In symbols, L n �(IR) = {P1 , P2 , P3}. Let P0 = (x0, y0) be a point on L that is distinct from P1 , P2 , and P3 . Then f(x0, y0) =1:- 0, and we set a = -g(x0, y0)/f(x0, y0). Let h(x, Y) = af(x, y) + g(x, y ). Any point common to �(IR) and \"!fg(IR) will also lie on \"!fh(IR). Hence the nine given points P1 , P2, · · ·, P9 all lie on \"!fh(IR). More­ over, from the choice of a we deduce that P0 lies on \"!fh(IR). Since the 5. 7 Elliptic Curoes P6 = O(AB) Figure S.S. The elliptic curve 2x(x2 - 1) = y( y 2 - 1), with 0 = (0, 0), A = ( -1, - 1), B = ( -1 , 1), C = (1, 1). 267 cubic -t'h(IR) has the four distinct points P0, P1 , P2, P3 in common with L, it follows by Theorem 5.15 that L � -t'h(IR). Not only that, but if ax + by + c = 0 defines the line L, then there is a quadratic polynomial q(x, y) such that h(x, y) =(ax+ by + c)q(x, y). Hence -t'h(IR) = L u �(IR). Each of the six points P4, P5, · · ·, P9 lies on -t'h(IR), but none of them lie on L. Hence they all lie on the conic �(IR), and the proof is complete. Lemma 5.20 Let 0 be an arbitrary point of an elliptic curve �(IR), possibly a point at infinity. Then (A + B) + C =A + (B + C) for any three points A, B, C of �(IR). Proof Take P1 = B, P2 = BC, P3 = C, P4 = AB, P5 = 0, P6 = O(AB), P7 = A, P8 = O(BC), P9 = (O(AB))C. We consider first the case in which these nine points are distinct, as depicted in Figure 5.5. Our object is to show that the points P7, P8, P9 are collinear, that is, that A(O(BC)) = (O(AB))C. From this it follows immediately that O(A(O(BC))) = O((O(AB))C), which is the desired identity. Let L1 denote the line determined by the two points P1 and P7. From the definition of P4 we see that P4 also lies on L1. Similarly, let L2 be the line passing through P2 and P5, and note that P8 lies on L2• Next let L3 denote the line passing through P3 and P6, and note that P9 lies on L3• For i = 1, 2, 3 let l;(x, y) = 0 be a linear equation defining the line L;. and put g(x, y) = 11(x,y)l2(x, y)/3(x, y). We now apply Lemma 5.19 to these nine points, which lie on the two cubic curves �(IR) and �(IR). We 268 Some Diophantine Equations note that the line L determined by P1 and P3 also passes through P2 , so that Lemma 5.19 applies. Thus the points P4 , P5 ,- • ·, P9 all lie on a conic, say �(IR). Let L' denote the line passing through P4 and P5, and note that P6 also lies on this line. Since L' has three distinct points in common with the conic �(IR), it follows by Theorem 5.15 that L' � -6\"iiR), and moreover that q(x, y) factors into a product of linear functions. That is, �(IR) is the union of two lines, L' and L\", say. Each of the remaining points P7, P8, P9 lies on L' u L\". Suppose that one of them, say P7, were to lie on L'. Then the line L' would have the four distinct points P4 , P5, P6 , P7 in common with -6j-(IR), which is contrary to the hypothesis that -6j-(IR) is an elliptic curve. Thus none of P7, P8, P9 lies on L', and hence they must all lie on L\". That is, P7, P8, and P9 are collinear, which is what we set out to prove. We have proved that (A + B) + C =A+ (B +C) whenever the nine points P; are distinct. We now argue by continuity that this identity still holds even if some of the Pi coincide. Let 0', A', B', C' be allowed to vary on the elliptic curve -6\"/IR), with 0' near 0, A' near A, and so on. We observe that A'B' is a continuous function of A' and B'. Hence O'(A'(O'(B'C'))) and O'(C'(O'(A'B'))) are continuous functions of 0', A', B', C'. We note that if B' is fixed and A' varies, the function A'B' never takes the same value twice. That is, the function A'B' of A' with B' fixed is a one-to-one function of A'. We let the Pi be as before, but with 0 replaced by 0', A by N, etc. Thus the Pi are functions of the four independent variables 0', A', B', C'. The original points Pi are recovered by taking 0' = 0, A' =A, B' = B, C' = C. We start with these values, and vary 0' a small amount in such a way that the four points P; that depend on 0' (i.e., P5, P6 , P8 , P9) are distinct from those points that do not. If we move 0' far enough from 0 (always along the curve -6j-(IR)), two points Pi which were initially distinct might move together and become coincident. However, this problem does not arise if we keep all the variables 0', N, B', C' sufficiently close to their initial values. Once we have replaced 0 by an appropriate 0' near 0, we allow N to move away from A, to a nearby value chosen so that the Pi that depend on A' (i.e., P4 , P6, P7, P9) are distinct from the Pi that do not depend on A'. Again, by choosing such an A' sufficiently close to A, we ensure that no new coincidences are introduced among the Pi. Continuing in this manner, we move B to a point B' and C to a point C'. Each Pi depends on a certain subset of the variables O',A', B',C', and we note that these subsets are distinct for distinct i. Thus when we replace 0 by 0', A by A', B by B', and C by C', the points Pi move to nearby locations which are all distinct. Thus the argument already given applies to the new Pi , which allows us to deduce that O'(A'(O'(B'C'))) = O'(C'(O'(A'B'))). By continuity, the left side is as close as we like to A + (B + C), while the right side is as close as we like to (A + B) + C. Since the distance between A + (B + C) and (A + B) + C is arbitrarily small, they must be equal, and the proof is complete. 5. 7 Elliptic Curves 269 Theorem 5.21 Let �(!R) be an elliptic curoe over the field of real numbers, and let 0 be a point on this curoe. Define the sum of two points A and B of �(IR) to be A + B = O(AB). Then the points of �(!R) fonn an abelian group with 0 as the identity. If the coefficients of f(x, y) are rational numbers, then the subset �( Q) of rational points on �(!R) fonn a subgroup if and only if 0 is a rational point. Proof That �(IR) satisfies the axioms of an abelian group has been established in Lemma 5.18 and 5.20. Suppose that the coefficients of f(x, y) are rational. In order that �(Q) should be a subgroup, it is necessary that the zero element 0 should lie in this subset. That is, 0 must be a rational point. Suppose, conversely, that 0 is a rational point. We observe that AB is a rational point whenever A and B are rational points on the curve. Hence A + B = O(AB) and -A = A(OO) are rational points if A, B e �(Q). Since �(Q) is closed under addition and negation, it follows that �(Q) is a subgroup of �(IR). We obtain an infinitude of different addition laws on an elliptic curve �(IR) by making different choices of the zero element 0. This may be distracting, but in fact these addition laws are all closely related. The elliptic curve is an example of what is called a homogeneous space. A more familiar example of such a space is provided by a line L in the plane. We may add two points A and B on this line, but we need a point of reference 0 on the line, from which to make measurements. Once 0 has been chosen, we define A + B to be the point on the line that lies to the right (or left) of A by the same distance that B lies to the right (or left) of 0. If we translate the configuration of points along the line, we replace 0 by 0', A by A', and so on, but the situation is not changed in any significant way. We now show that any two of our addition laws are related by a similar translation. Theorem 5.22 Let 0 and 0' denote two points on an elliptic curoe �(!R). For points A and B on this curoe, let A+ B denote the addition defined using 0 as the zero element, and let A e B denote the addition defined using 0'. Then A e B = A + B - 0' for any two points A and B on the curoe. Proof We show that 0' + (A e B) = A + B. Here A e B = O'(AB), and hence 0' + (A e B) = O(O'(O'(AB))). By (5.47) this is O(AB) = A + B. Let G denote the group ( �(IR), + ), with 0 as the identity, and let H denote the group ( �(IR), e ) with 0' as identity. We define a map cp: G � H by the formula cp(A) = A + 0'. We note that cp(A + B) = A + B + 0' = (A + 0') + (B + 0') - 0' ':\"\" cp(A) + cp(B) - 0' = cp(A) e cp(B). Thus cp defines a group homomorphism from G to H. We also note that cp is 270 Svme Diophantine Equations one-to-one and onto. Hence G and H are isomorphic groups, G :;;; H. Since the group ( -Gj(IR), +) is uniquely determined up to isomorphism, we let E/IR) represent the group of points on -Gj(IR), without regard to any particular choice of 0. If the coefficients of fare rational, and if -Gj(O) is nonempty, then we may take 0 to be a point of -Gj(O), and thus the set -Gj(O) forms a group E/0) that is likewise uniquely determined up to isomorphism. We note that E/0) is a subgroup of E/IR). It is instructive to interpret collinearity of points on an elliptic curve as an additive relationship. Theorem 5.23 Let A, B, and C be three distinct points on an elliptic curoe -Gj(IR). Then these three points are collinear if and only if A+ B + C = 00. Proof We note first that by two applications of (5.47), A+ (B + AB) = O(A(O(BC))) = O(A(O(B(AB)))) = O(A(OA)) = 00. But if C is collinear with A and B, then C = AB, and hence A + B + C = 00. Suppose, conversely, that this identity holds. The point C with this property must be unique, and since AB is such a point, it follows that C = AB, which implies that C is collinear with A and B. We recall that a point A of an elliptic curve -Gj(IR) is an inflection point if and only if AA = A. Thus if we choose the point 0 to be an inflection point, then we can characterize addition by saying that three points are collinear if and only if they sum to 0. On the other hand, it is also important to us that -Gj(O) be a subgroup of -Gj(IR), and for this purpose we require 0 to be a rational point. Unfortunately, there exist elliptic curves that possess rational points but no rational inflection point (see Problem 8 at the end of this section for an example), but if the curve has a rational inflection point it is very convenient to take 0 to be such a point. We return to the curve x3 + y3 = 9, which we considered in Theorem 5.16. This curve has inflection points at (0, 3213), (3213, 0), and at the point at infinity, 1: - 1: 0. Since this latter point is a rational point, we take 0 to be this point at infinity. We note that the curve has a symmetry about the line x = y. Let A = (x0 , y0) be a point on this curve, and put B = ( y0 , x0). The line through these two points has slope - 1 and has no further intersection with the curve in the affine plane. Instead, its third intersec­ tion with the curve is at the point 1 : - 1 : 0 at infinity. Since A, B and 0 are collinear, it follows by Theorem 5.23 that A+ B + 0 = 00 = 0. That is, B = -A. In proving Theorem 5.16 we applied the tangent process to the point P0 = (2, 1), to construct the point P0P0. Now P0 + P0 = O(P0P0) is the third point on the curve that passes through P0P0 and 0, and hence this third intersection is at - P0P0. That is, 2P0 = - P0P0, which is to say P0 P0 = (- 2)P0. This is the point P1 we constructed. Repeating this, we 5. 7 Elliptic Curoes 271 constructed the point P2 = (- 2)P1 = 4P0. In general, Pk = (- 2)k P0 . In proving Theorem 5.16 we used only tangents, and we now see that we generated only a small subset of the rational points generated by P0. If we construct the chord through P0 and nP0, the third point of intersection of the chord with the curve is at the point - (n + 1)P0. To obtain (n + 1)P0 from this point we simply interchange coordinates. For example, the chord through P 0 = (2, 1) and 2P 0 = (- 17/7, 20 j7) intersects the curve at the third point (- 271 /438, 919/438), and thus 3P0 = (919/438, - 271 /438). It is easy to construct elliptic curves that contain no rational point. For example, the equation X3 + 2Y 3 = 7Z 3 has no nontrivial solution in integers because the congruence x 3 + 2y 3 = 7z 3 (mod 49) has no solution for which g.c.d.(x, y, z, 7) = 1. Hence the elliptic curve x3 + 2y 3 = 7 contains no rational point. We now consider an example in which we can show that �(Q) consists of precisely four points. The example is carefully selected to take advantage of Theorem 5. 10. Theorem 5.24 The only rational solutions of the equation y 2 = x3 - 4x are (2, 0), (0, 0), (- 2, 0), and the point 0: 1 : 0 at infinity. In this example, the point 0 : 1 : 0 at infinity is an inflection point of the curve, so it is natural to take 0 to be this point. Call the remaining points A, B, C. Then A + B + C = 0. The tangent lines through these three points are vertical, which is to say that 2A = 2B = 2C = 0. Thus we see that each of these four points can be written in precisely one way in the form rnA + nB with m = 0 or 1, n = 0 or 1, and the group E/0) is isomorphic to c2 Ell c2 . Proof We note that the point (0, 0) is a point on this curve. If P = (x0, y0) is a rational point on this curve, then the slope m of the line from (0, 0) to P has rational slope, m = y0jx0. Suppose, conversely, that we start with a line L with rational slope m through the point (0, 0). This line intersects the curve at two other points, and we wish to determine those rational values of m for which these further intersections are at rational points. The x-coordinates of the three points of intersection are the roots of a cubic equation with rational coefficients, but since one of these x-coordi­ nates is 0, it follows that the other two x-coordinates are the roots of a quadratic equation with rational coefficients. In the case at hand, we have f(x, y) = x3 - y 2 - 4x, and the x-coordinates in question are the roots of the equation f(x, mx) = 0. That is, x3 - m2x2 - 4x = 0. After removing the factor x, we see that the x-coordinates of the two remaining points of intersection are the roots of the quadratic x2 - m2x - 4 = 0. But the roots of a quadratic polynomial with rational coefficients are rational if and only if the discriminant of the polynomial is the square of a rational 272 Some Diophantine Equations number. That is, the roots of this equation are either both rational or both irrational, and they are rational if and only if there is a rational number n such that m4 + 16 = n2. We rewrite this as (m/2)4 + 1 = (n/4)2. Thus we wish to determine the rational points on the quartic curve u4 + 1 = v 2. Equivalently, in projective coordinates we wish to find all solutions of the equation U4 + W4 = V 2 W 2. Here we may assume that U, V, and Ware relatively prime integers. From Theorem 5.10 we deduce that the solutions are (0, ± 1, 0), (0, ± 1, ± 1). Here the first triple represents a point at infinity, which does not correspond to rational values of u and v. Thus it follows that the only rational points on the curve u4 + 1 = v 2 are (0, ± 1). This gives m = 0, n = ± 4 as the only rational solutions of the equation m4 + 16 = n2, and hence the only line L from (0, 0) that intersects the curve at rational points is the line of slope m = 0. The other two points of intersection are therefore (- 2, 0) and (2, 0). When the foregoing approach is analyzed, a marvelous phenomenon emerges. Put g(u, v) = u4 + 1 - v 2, and let fP(X, y) = (u, v) be a map from pairs (x, y) of real numbers to pairs of real numbers (u, v) given by the equations y u= - 2x ' v = 4x 2 1 -x. 2 Here points of the form (0, y) must be excluded from the domain, in view of the poles that these rational functions have at x = 0. Solving for x and y in terms of u and v, we find that x = 2u2 - 2v, y = 4u3 - 4uv . These equations define the inverse map it(u, v) = (x, y) from pairs of real numbers (u, v) to pairs of real numbers (x, y ). By elementary algebra we may verify that -4xg( yj( 2x) ,y 2j(2x) 2 -x/2) =f( x ,y ) , and that f(2u 2 - 2v, 4u3 - 4uv ) = - 8( u2 - v)g( u, v ) . Thus if (x, y) E -G[(IR), x ,;. 0, then fP(X, y) E �(IR), and conversely if (u, v) E �(IR) then it(u, v) E -G[(IR). That is, fP: -G[(IR) � �(IR) and it: �(IR) � -G[(IR). Moreover, these maps, when restricted to these curves, are inverse to each other, so that the composite map it o fP is the identity 5. 7 Elliptic Curoes 273 map on -Gj-(IR), and q; o {} is the identity map on �(IR). This is an instance of birational equivalence of two curves. Since the rational functions em­ ployed here have rational coefficients, we say, more precisely, that -Gj-(IR) and �(IR) are Q-birationally equivalent. This equivalence establishes a one-to-one correspondence between the points of -Gj-(IR) and those of �(IR), apart from those points that must be excluded due to poles of the rational functions involved. Since the polynomials f(x, y) and g(u, v) have rational coefficients as well, we find that we have also established a one-to-one correspondence between the rational points -Gj-(0) and the rational points �(Q). By means of this correspondence, we discover that Theorem 5. 10 and Theorem 5.24 are equivalent. The use of Q-birational equivalence is essential to the further study of rational points on algebraic curves. It is known that if q(x) is a polynomial of degree 4 with rational coefficients and distinct roots, then the curve y 2 = q(x) is Q-birationally equivalent to an elliptic curve. Moreover, if f(x, y) has rational coefficients, if the equation f(x, y) = 0 determines an elliptic curve, and if this elliptic curve -Gj-(IR) contains at least one rational point, then this elliptic curve is Q-birationally equivalent to an elliptic curve in Weierstrass nonnal fonn: (5 .48) One may determine whether the roots of a polynomial q(x) are distinct by calculating the discriminant of the polynomial. (This is discussed in Ap­ pendix A.2.) If q(x) is a quadratic polynomial this is simply the familiar quantity b 2 - 4ac, but for polynomials of higher degree the discriminant is more complicated. However, for a cubic polynomial in the special shape x3 -Ax - B, the discriminant is the quantity (5 .49) Thus by Theorem 5. 17 we see that (5.48) defines an elliptic curve if and only if D \"4= 0. If D > 0 then the polynomial x3 - Ax - B has three distinct real roots, and the elliptic curve -Gj-<IR) has two connected compo­ nents, one a closed oval and the other extending to the point 0 : 1 : 0 at infinity. An example of this type is depicted in Figure 5.4. If D < 0, then the polynomial x3 -Ax - B has only one real root, and the elliptic curve -Gj-(IR) has one connected component, as seen in Figure 5.3. We now derive explicit formulae for the coefficients of P1 + P2 on an elliptic curve, in terms of the coefficients of P1 and P2 and the defining equation of the curve. To provide greater flexibility, we do not restrict ourselves to curves of the form (5.48), but instead consider the more 274 Some Diophantine Equations general equation y2 = x3 + ax2 + bx + c. {5.50) In order that this should define an elliptic curve, it is necessary and sufficient that D \"4= 0 where {5.51) is the discriminant of the cubic polynomial in x, discussed in Appendix A.2. Any elliptic curve of the form (5.50) contains the point at infinity 0 : 1 : 0, which is a point of inflection of the curve. Thus it is traditional to take 0 to be this point, so that three points on the curve sum to 0 if and only if they are collinear. Let P1 = (x1, y1) and P2 = (x2, y2) be two points on this curve, and put P3 = P1 + P2 = (x3, y3). We assume for the mo­ ment that x1 * x2. Let m denote the slope of the line through these points, m = (y2 - y1 )j(x2 - x1 ). This line intersects the curve at the third point P1P2 = - P3 = (x3, - y3). Setting y = y1 + m(x - x1) in (5.50), we find that x1, x2, and x3 are the roots of the equation Hence by (5.45) we see that the sum of the three roots is m2 - a, so that x3 = m2 - a - x1 - x2, and y3 = -y1 - m(x3 - x1 ). If x1 = x2, then ei­ ther y2 = -y1, in which case P2 = - P1 and P1 + P2 = 0, or else y2 = y1 , in which case P1 = P2. To find the coordinates of P3 = 2P1 , let m denote the slope of the tangent line to the curve through P1, m = (3xt + 2ax1 + b)j(2y1). If y1 = 0, then this line is vertical, and 2P1 = 0, but otherwise we obtain a finite value for m. Proceeding as before, we find that x3 = m2 - a - 2x1, y3 = -y1 - m(x3 - x1 ). In summary, we have shown that if x1 \"4= x2, then the coordinates of P1 + P2 are {5.52) 5. 7 Elliptic Curves and that if y1 -:�< 0, then the coordinates of 2P1 are x3 = 2 -a - 2x1 , y l 275 ( 3xf + 2ax1 + b ) 2 (5.53) Using these formulae, it is a simple matter to calculate the coordinates of the sum of two points. For example, we find that the first 10 multiples of the point (1, 2) on the curve x3 - 7x + 10 = y 2 depicted in Figure 5.4 are as follows. We give the coordinates both as decimals and as fractions. n xn Yn xn Yn 1 1.00000 2.00000 1/1 2/1 2 -1.00000 -4.00000 -1/1 -4/1 3 9.00000 -26.00000 9/ 1 -26/1 4 2.25000 2.37500 9/4 19/8 5 -3. 16000 -0.75200 -79/25 -94/125 6 2.59763 -3.05690 439/ 169 -6716/2197 7 6.42112 15. 15917 4681/729 298378/19683 8 -1.5289 1 4. 13865 -883 1/5776 1816769/438976 9 1.24409 -1 .79358 364121/292681 - 2839961021158340421 10 239.30450 3701.68885 13215591/55225 48040055236/ 12977875 In these values we note that the denominator of xn is a perfect square, say w;, and that the denominator of Yn is w:. We now show that this holds for any rational point on this curve. Theorem 5.25 Let -Gj-(�) be an elliptic curoe detennined by an equation of the fonn (5.50) with integral coefficients. Let (x1, y1 ) be a rational point on this curoe, not at infinity. Then there exist integers u, v, w such that x 1 = u jw 2, Y1 = vjw 3, and g.c.d.(u, w) = g.c.d.( v, w) = 1. Proof Let Z be the least common denominator of the rational numbers X1, Y 1, SO that X1 = XjZ, y1 = Y /Z with Z > 0, g.c.d.(X, Y, Z) = 1. Substituting into (5.50), we find that Y 2Z = X 3 + aX 2Z + bXZ 2 + cZ 3 . Put w = g.c.d.( X, Z). Then w3 divides the right side, and hence w3 1 Y 2Z. But g.c.d.(w, Y) = 1, since g.c.d.( X, Y, Z) = 1. Therefore w 3 1 Z, say 276 Some Diophantine Equations Z = tw3, X= uw. We substitute these new variables in the equation displayed above, and divide both sides by w 3, to find that Here t occurs in all terms but one, so we conclude that tlu3. But g.c.d. (Xjw, Zjw) = 1, which implies that g.c.d. (u, tw) = 1. Thus t = ± 1. But Z > 0 and w > 0, so t > 0, and hence t = 1. Setting v = Y, we have x1 = ujw 2, y1 = vjw3 with g.c.d. (u, w) = 1. To see that g.c.d. (v, w) = 1, we note that {5 .54) so that any common divisor of v and w would also have to divide u3. This completes the proof. By manipulating the formulae (5.52) it may be shown that if P1 = (u 1 jw[, v1 jw i) and P2 = (u 2jw�, v2/wD are two points of the curve (5.50) with u 1jw[ * u 2jw� then we may write P1 + P2 = P3 in the form P3 = (u 3/wi, v3/wD where (5.55) Similarly, from (5.53) we find that we may write 2P1 = (u3/wi, v3fwV with ( 5 .56) In these formulae, the numbers u3, v3, w3 may have common factors, even if g.c.d.(u 1, w1 ) = g.c.d.(u 2, w2) = 1. 5. 7 Elliptic Curves 277 We conclude this section with a description of some further properties of the group E / Q) of rational points on an elliptic curve. First we introduce some notation taken from the theory of infinite abelian groups. An abelian group G is said to be finitely generated if there exists a finite collection g1, g2, · · ·, gk of elements of G such that every element of G can be written in the form n1 g1 + n2g2 + · · · +nkgk, where the n; are integers. If two elements g, g' of infinite order differ by an element of finite order, say h = g' - g has finite order, then we say that g' is a twisted copy of g. The elements h of finite order which produce these twistings form a subgroup H, called the torsion group of G. In symbols, H = tors (G). If G is finitely generated, then tors (G) is necessarily a finite group. Moreover, it can be shown that if G is a finitely generated abelian group then there exist members g1, g2, · · ·, g, of G such that every element of G is uniquely of the form h + n1 g1 + n2g2 + · · · +n,g,. The elements g; are not uniquely determined, but in any such presentation of the group the number r is the same. This r is called the rank of the group. All this is relevant because of the following fundamental result. Mordellts Theorem Suppose that the cubic polynomial f(x, y) has rational coefficients, and that the equation f(x, y) = 0 defines an elliptic curoe �(!R). Then the group E/0) of rational points on �(!R) is finitely generated. In elementary language, this says that on any elliptic curve that contains a rational point, there exists a finite collection of rational points such that all other rational points can be generated by using the chord­ and-tangent method. In Theorem 5.16 we proved that the elliptic curve x3 + y3 = 9 has positive rank, while in Theorem 5.24 we showed that the curve y 2 = x3 - 4x has rank 0. It is known that the rank of an elliptic curve can be as large as 14, and it is guessed that it can be arbitrarily large. While the rank and generators g; are known for many particular elliptic curves, we lack a procedure for finding these quantities in general. On the other hand, we have an effective technique for finding all points of finite order (called torsion points) on an elliptic curve. The Lutz-Nagell Theorem Let �(!R) be an elliptic curoe given by an equation of the fonn (5.50) with integral coefficients. If (x0, y0) is a rational point of finite order on �(!R), then x0 and Yo are integers. Moreover, either Yo = 0 or y� divides the discriminant D given in (5.5 1). By applying this theorem we can construct a finite list of integral points on the curve that must include all points of finite order. By examining the multiples of such points, we quickly discover which have finite order, and which not. An elliptic curve may contain other integral 278 Some Diophantine Equations points, for which y� does not divide D, but from a general theorem of Siegel it follows that the number of such points is at most finite. A precise description of groups that can occur as tors (E/0)) is provided by: Mazur's Theorem Let f(x, y) be a nonsingular cubic polynomial with rational coefficients. Then the group tors (E/0)) of points on �(0) offinite order is isomorphic to one of the following groups: en with n = 1, 2, ... , 10, or n = 12, or C n e C 2 with n = 2, 4, 6 or 8. It is known that each of these groups occurs as the torsion group of E/0) for some elliptic curve �(0) defined over the rational numbers. From this theorem we see that an elliptic curve can have at most 16 torsion points. Moreover, we see from the foregoing that a rational point P is a torsion point if and only if at least one of the points 7P, 8P, 9P, lOP, 12P is 0. PROBLEMS 1. Let f(x, y) = y2 - p(x), where p(x) is a cubic polynomial with no repeated root. Take the point 0 on �(IR) to be the point 0: 1 : 0 at infinity. Show that 2A = 0 if and only if A is of the form A= (r, O), where r is a root of p(x). 2. Let �(IR) be an elliptic curve for which 0 is an inflection point. Show that 3A = 0 if and only if A is an inflection point. Deduce that if A and B are inflection points then AB is also an inflection point. 3. Show that the general polynomial of degree d in two variables has ( d ; 2) coefficients. Deduce that if ( d ; 2) - 1 points in the plane are given, then there exists a curve of degree d that passes through them. 4. Show that if ( d ; 2) - 1 rational points are given in the plane, then there exists a polynomial f(x, y) of degree at most d, with integral coefficients, not all 0, such that the given points all lie on the curve �(0). 5. For what values of c is the curve cx(x2 - 1) = y( y2 - 1) not an elliptic curve? 6. Show that the projective curve X3 + Y3 + Z3 = dXYZ is nonsingu­ lar if and only if d3 \"* 27. Show that if d = 3, then this curve is the union of a line and a conic. Show that if d3 \"* 27, then the points 5. 7 Elliptic Curoes 279 1 : - l : 0, 0: 1 : - 1, - 1 : 0: 1 are inflection points, and that the curve has no other inflection points. 7. Let A and B be distinct points on an elliptic curve �(IR), and suppose that the line through A and B is tangent to �(IR) at B. Show that A+ 2B = 00. 8. Let f(x, y ) = x3 + 2y 3 - 3. Show that �(Q) is nonempty. Show also that �(IR) has three inflection points (including one at infinity), but no inflection point with rational coordinates. 9. Use the method employed to prove Theorem 5.24 to relate the elliptic curve y 2 = x3 + x to equation (5.29), and thus find all ratio­ nal points on this elliptic curve. 10. Find all rational points on the elliptic curve y 2 = x3 - x. (H) ll. Find all rational points on the elliptic curve y 2 = x3 + 4x. (H) 12. Suppose that the elliptic curve �(IR) is given by (5.50), and that the coefficients a, b, c are integers. Let P1 = (u1 ;w;, v1jwi) be a ratio­ nal point on this curve, and write 2P = (u3/wi, v3jwj) with g.c.d.(u1 , w1 ) = 1. Show that if b is odd and u 1 is odd, then u 3 is odd, and the power of 2 in w3 is greater than the power of 2 in w 1. Deduce that the points 2k P1 are all distinct, and hence that P1 has infinite order. In particular, show that the point (1, 3) on the curve y 2 = x 3 + 6x 2 + 2x has infinite order. 13. Show that the formula for u3 in (5.56) can be rewritten as u3 = (ut - bwif - 4c(2 u1 + aw t)w�. Deduce that if the equation (5.50) has integral coefficients, and if P is a rational point on �(IR), then the x-coordinate of 2P is the square of a rational number if c = 0. 14. Let P1 = (x1, y1 ) be a point with integral coordinates on the elliptic curve (5.50), where a, b, c are integers. Show that if 2P1 also has integral coordinates then (2y 1 ) 1(3xt + 2ax 1 + b). 15. Show that 27( x3 -Ax + BXx3 -Ax -B ) - (3x 2 - 4A X3x2 - A)2 = 4A3 - 27B 2. Deduce that if an elliptic curve is given by (5.48), with A and B integers, and if P1 = (x1, y1 ) and 2P1 are points with integral coordinates, 2P1 '* 0, then Y ti(4A3 - 27B 2). 16. Suppose that the equation y 2 = x3 + ax 2 + bx determines an elliptic curve. Suppose also that a and b are integers. Explain why b '* 0. Show that if (u1;w;, v1 jwf) is a rational point on this curve, with g.c.d. (u 1, w1 ) = 1, then there exist integers d and s such that d > 0, dlb, and u1 = ±ds2. In the particular case of the curve y 2 = x3 + 6x 2 + 2x, show by congruences (mod 4) that the case u 1 = -s 2 yields no solution, and by congruences (mod 8) show that the case u 1 = - 2s2 also gives no solution. Deduce that this elliptic curve contains no rational point (x1 , y 1 ) with x1 < 0. 280 Some Diophantine Equations *17. Let f(x, y) = y 2 - x3 - 6x2 - 4x, g(u, v) = v2 - u3 + 12u2 - 20u. Let cp take pairs (x, y) to pairs (u, v) by means of the formulae u =y 2jx 2, v = y - 4yjx 2. Show that if P E -G[(IR) then cp(P) E �(IR). Let if take pairs (u, v) to pairs (x, y) by the formulae x = v 2j(4u 2 ), y = (1 - 20ju 2)vj8. Show that if Q E �(IR) then iJ(Q) E -G[(IR). Take P = ( -1, 1). Show that P E -G[(IR), that cp(P) = (1, - 3) E �(IR), and that if o cp(P) = (9 j4, 57 j8) = 2P. Show, more generally, that if P E -G[(IR) then if o cp(P) = 2P. 18. For what values of the constants a and b does the curve axy = (x + 1) (y + 1)(x + y + b ) (5 .57) contain a line? This curve has three points at infinity. What are they? *19. Let b, x0, x1 be given real numbers. Generate a sequence of numbers xn by means of the recursion xn + l = (xn + b)fxn - l for n � 1 . Choose a so that the point (x0, x 1 ) lies on the curve (5.57). Show that all further points (xn, xn + l) lie on the same curve. Show that if x0 > 0, x1 > 0 and b = 1, then the sequence xn has period 5. Show that if x0, x1, and b are positive then the sequence xn is bounded. *20. Let -G[<IR) be defined by (5.50) where a, b, c are real numbers, and suppose that the polynomial on the right side of (5.50) has only one real root (so that the curve -G[(IR) lies in one connected component). Show that if P E -G[(IR) has infinite order, then the points nP are dense on -G[(IR). *21. Let -G[(IR) be defined by (5.50) where a, b, c are real numbers, and suppose that the polynomial on the right side of (5.50) has three real roots r1 < r2 < r3. Let tf0 be the connected component of points (x, y) E -G[(IR) for which x � r3, including the point at infinity, and let tf1 denote the connected component of points for which r1 � x � r2. Let P and Q be arbitrary points of -G[(IR). Show that P + Q lies on tf0, or tf1, according as P and Q lie on the same, or different, components. (That is, tf0 is a subgroup of index 2 in tf/IR).) *22. Let -G[(IR) be defined as in the preceding problem. Show that if P is a point of infinite order, P E -G\"0, then the points nP form a dense subset of tf0. Show that if P is of infinite order, P E tf1, then the points nP are dense on -G[<IR). *23. Suppose that we have an elliptic curve as described in Problem 20. We construct a function P(t) from IR to -G[(IR) as follows. The function P(t) is to have period 1. Put P(O) = 0. Put P(l j2) = P1 = (r, 0) where r is chosen so that (r, 0) E -G[(IR). Of the two points P of -G[(IR) for which 2P = P1 , let P2 = (x2 , y2) be the one for which y2 < 0. Put P0 /4) = P2 • Similarly put P(1j8) = P3 = (x3, y3) where y3 < 0 and 2P3 = P2 , and so on. For k odd, put P(kj2•) = kP • . Thus 5. 8 Factorization Using Elliptic Curves 281 P(t) is defined on a dense subset of R Extend this to all of IR by continuity. Show that P(t1 + t2) = P(t1) + P(t2) for arbitrary real numbers t1, t2. Show that P(t) has finite order in -G[(IR) if and only if t is a rational number. Show also that if g.c.d.(a, b) = 1 then P(ajb) has order b. Conclude that -G[(IR) is isomorphic to the additive group IR/Z of real numbers modulo 1. (This group is called the circle group, and is often denoted by lr.) *24. Let -G[(IR) be an elliptic curve as described in Problem 21. Construct a function from IR to -tf0, as in the preceding problem. Show that -tf0 :: IR/Z, and that -G[(IR) :: IRjZ Ell C2. *25. Let G be a finite subgroup of n points on an elliptic curve -G[(IR) as given by (5.50). (For example, G might be the group tors (E/0)).) Show that if �(IR) has one connected component then G is cyclic, and that if -G[(IR) has two connected components then either G is cyclic or is isomorphic to Cn ;z Ell C2. 5.8 FACTORIZATION USING ELLIPTIC CURVES In this section we draw on the ideas of the two preceding sections to devise a factorization strategy called the Elliptic Curve Method (abbrevia­ ted ECM). When applied to a large composite number, this method can be expected to locate a factor much more rapidly than the methods we discussed in Section 2.4. The ECM is modeled on the Pollard p - 1 method, which we de­ scribe first. Let m denote the number we wish to factor. We let r1, r2, · · · be integers greater than 1, and generate a sequence a1, a2 , · · · by choos­ ing a to be an arbitrary integer > 1, and then setting a1 =a, an + l = a�\"· That is, an = a<'1'2 ... 'n-t>. Put gn = (an - 1, m). Since (an - 1) i(an + l - 1) for all n, it follows that g1 lg2 lg3 ··· . Our object is to find an n such that 1 < gn < m, for then gn is a proper divisor of m. In practice we do not calculate the exact value of an , but only the residue class in which an falls modulo m. As ap - l = 1 (mod p) by Fermat's congruence, it follows that if p is a prime factor of m for which (p- l) lr1r2 · · · rn - l• then an = 1 (mod p), and hence plgn. The simplest useful choice of the numbers rn is to take rn = n. A somewhat more efficient choice, but also more complicated, is obtained as follows. Let q1 < q2 < · · · be the sequence of all positive prime powers, and for each n let rn be the prime of which qn is a power. Thus the initial qn's are 2, 3, 4, 5, 7, 9, 11, 13, 16, 17, and the corresponding rn 's are 2, 3, 2, 5, 7, 3, 11, 13, 2, 17. With this determination of the rn 's, we see that the product r1r2 · · · rn is the least common multiple of the numbers q1, q2, · · · , qn , which in turn is equal to the least common multiple of all the positive integers not exceeding qn . 282 Some Diophantine Equations In general, the running time of the Pollard p - 1 method is expected to be comparable to the minimum over plm of the maximum prime divisor of p - 1. This is faster than the Pollard rho method for a substantial fraction of m, but on average it is barely faster than trial division. Some choices of a will lead to a proper divisor faster than others, but the ones that yield a substantial savings are comparatively rare and are unlikely to be found by random trials. Thus in practice we simply take a = 2. The numbers gn are calculated by the Euclidean algorithm, but since the gn form an increasing sequence, it is not necessary to evaluate gn for every n. Hence some time may be saved by computing gn for only one n out of 100, say. The strategy of the Pollard p - 1 method is to find the identity in the multiplicative group of reduced residue classes (mod p) by raising a given number to a highly composite power. Here p is a prime divisor of m, and as the value of p is unknown, the calculation is executed modulo m. The method is quick if there is a prime plm such that the order of the group, p - 1, is composed entirely of small primes. We now construct, for each prime p, a large family of additive groups, in which the group addition is calculated using congruence arithmetic (mod p ). Since the order of any member g of a finite group G divides the order of the group (recall Theorem 2.49), it follows that r1r2 · · · rng is the identity of the group if the order of the group divides r1r2 · · · rn- Working modulo m, we calculate a highly composite multiple of some initial element, in order to find the identity in the group. Since this identity is related to the residue class O(mod p), this reveals the value of p, and a proper divisor of m is located. These groups are of various orders, and we expect that some of them will yield a factorization of m very quickly. We use the same highly composite number r1r2 · · · rn as before, but now we limit the size of n. If we are unsuccessful with one group, we start afresh with a different group and continue switching from group to group until a factor is found. The groups we need are provided by considering elliptic curves modulo p. If f(x, y) is a polynomial with integral coefficients, then the affine curve �(l.P) is the collection of pairs (x, y) of integers with 0 � x < p, 0 � y < p, for which f(x, y) = O(mod p). Thus a line (mod p) is the collection of pairs (x, y) satisfying a congruence ax + by + c = O(mod p), where p does not divide both a and b. By using Theorem 2.26 we may establish an analogue of Theorem 5 .15, and thus show that if a curve �(l.P) of degree d (mod p) has more than d points in common with a line y = mx + r (mod p), then there exist polynomials k(x, y) and q(x, y) with integral coefficients such that f( x, y) = ( y- mx - r) k( x, y) + pq(x, y) . Although the set �(Z P) is finite, we may nevertheless define the multiplic- 5. 8 Factorization Using Elliptic Curves 283 ity M of a point (x0, y0) on this curve to be the largest integer M such that whenever i + j < M. Continuing in this manner, we may similarly define the intersection multiplicity at (x0, y0) of a line y = y0 + m(x - x0)(mod p) with a curve f( x, y) = O(mod p) to be the largest integer i such that f(x, Y o + m(x - x0)) = (x - x0)ik(x) + pq( x). Such a line is tangent if i > 1. As an analogue of (5.45), we note that if p( x) = an xn + an _ 1 x n - 1 + · · · is a polynomial with integral coefficients, if p )'an , and if x 1, x 2, · · · , x n _ 1 are solutions of the congruence p( x ) = 0 (mod p ), then this congruence has an nth solution xn given by the relation (5 .58) where a nan = 1 (mod p). The xj may be repeated, provided that the factor (x - x) is correspondingly repeated in the factorization of p(x) (mod p). If f(x, y) is a polynomial with integral coefficients, of degree 3 (mod p ), if f( x, y) is irreducible (mod p), and if the projective curve -G[Cl.P) has no singular point, then we call this curve an elliptic curve modulo p. If A and B are any two points of such a curve, we may construct the unique line (mod p) passing through A and B, and then by (5.58) find the unique third point AB of intersection of the line with the curve. If 0 is a further point on the curve, we may define A + B = O(AB), as in the preceding section. The points -G[(l.P) form a group under this addition, and as with -G[(IR) the hard part of the proof is to verify the associative law. The first part of the proof of Lemma 5.20 carries over to the present situation, but some further work is required to complete the proof. We omit this argument, and take for granted that the points -G[(l. P) form a group, as our only object is to construct a calculational procedure by which a computer might locate a proper divisor of a large composite integer. Any polynomial of the form y 2 - x3 + k + B is irreducible (mod p), and by calculating partial derivatives we see that the curve y 2 = x3 - k - B (mod p) is nonsingular provided that the polynomial x3 - k- B has no repeated root (mod p ). Suppose that r is a repeated root of this polynomial. Then by (5.58) the third root is = - 2r (mod p ). Hence the coefficients of the polynomial (x - r)2( x + 2r) are congruent (mod p) to the coefficients of the given polynomial. Thus A = 3r 2, B = - 2r 3 (mod p ), so that 4A3 - 27B 2 = 108r6 - 108r6 = 0 (mod p ). We conclude that the curve y 2 = x3 - k- B (mod p) (5 .59) 284 Some Diophantine Equations is an elliptic curve (mod p) provided that 4A3 - 27B 2 � O{ mod p) . {5.60) A projective curve given by (5.59) contains the point 0: 1 : 0 at infinity, which is an inflection point, and we take this point to be 0. The derivation of the formulae for adding two points runs as in the preceding section, and corresponding to (5.55), (5.56), we find that if P1 = (x1, y1 ) and P2 = (x2, y2) are two points of the curve with x1 � x2 (mod p), then P3 = (x3, y3) = P1 + P2 is given by (5.61) where x2 - x1 is chosen so that (x2 - x1 Xx2 - x1) = 1 (mod p). If x1 = x2 (mod p), then y1 = ±y2 (mod p). lf y 2 = -y 1 (mod p), then P2 = -P1 , and P1 + P2 = 0. If y2 = y 1 (mod p ), then P2 = P1, and we find that 2P1 = P3 = (x3, y3) is given by the congruences x3 = (3xl -A )2(\"2\"Y;)2 - 2x1{ modp ) , {5 .62) Y3 = -y 1 - (3xl -A )(\"2\"Y;)(x3 -x1 )( mod p) where \"2\"Y; is an integer chosen so that 2y 1(\"2\"Y.) = 1 (mod p). Example 11 Find the multiples of the point P1 = (3, 2) on the curve y 2 = x3 - 2x - 3 (mod 7). Solution From (5.62) we find that x3 = (3 · 32 - 2)2(2\"\"-:z)2 - 2 · 3 = 42 • 22 + 1 = 2(mod 7), and hence that y3 = -2 - 4 · 2(2 - 3) = 6 (mod 7). One may verify independently that the point P3 = (2, 6) lies on the elliptic curve. We apply (5.61) similarly to see that 3P1 = (4, 2), 4P1 = (0, 5), 5P1 = (5, 0), 6P1 = (0, 2), 7P1 = (4, 5), 8P1 = (2, 1), 9P1 = ( x3 - 2x - 3 ) (3, 5), 10P1 = 0. By evaluating the Legendre symbol 7 for x = 0, 1, 2, - · ·, 6, we discover that �Cl.7) consists of precisely these 10 points. Hence in this case E/l.P) is a cyclic group of order 10. For each x, the congruence (5.59) is satisfied by at most two values of y (mod p). Hence the total number of solutions of (5.59) lies between 0 and 2p. The projective curve �(l.P) contains precisely one point at 5. 8 Factorization Using Elliptic Curves 285 infinity, namely 0: 1: 0, so that the group E/7LP) has order between 1 and 2p + 1. One would expect that the right side of (5.59) is a quadratic residue (mod p) for roughly half the residues x, so that the order of E/7LP) should be close to p. Indeed, it is known that (5 .63) We now apply these groups to factor a composite number m. We calculate multiples of a point P0 that lies on an elliptic curve. More precisely, we compute P1 = r1P0,P2 = r2P1,P3 = r3P2> · ·, PN = rN PN- l where the numbers rn are the same as in the Pollard p - 1 method, and N is a parameter at our disposal. Since the prime divisors of m are unknown, we use congruences modulo m. To calculate the multiple of a point we repeatedly double, in the manner of the repeated squaring technique used in Section 2.4 to com­ pute powers. For example, to compute 101P, we double 6 times to compute 2P, 4P, 8P, 16P, 32P, 64P, and then we perform three additions to compute P + 4P + 32P + 64P = 101P. Since we intend to perform many such doublings and additions, it is important that these basic manipula­ tions be performed as quickly as possible. Unfortunately, the formulae (5.61) and (5.62) involve inverting a residue class. Even by the Euclidean algorithm, this involves a number of additional manipulations. To avoid this extra burden, we instead use congruential analogues of the formulae (5.55) and (5.56), which involve only addition and multiplication of residue classes. Example 12 Use the ECM to factor the number m = 1938796243. As with the methods of Pollard, if we apply the ECM to a prime number, then calculations are performed for a very long time, with no definitive outcome. Thus one should only apply these methods to numbers that are already known to be composite. In the present case it is easy to verify that 2m - I = 1334858860 1: l(mod m), so that m must be compos­ ite. Before trying more sophisticated techniques, one should also use trial division to remove any small prime factors, say those not exceeding 10000. In the present case, the trial divisions fail to disclose any factor, so we know that the composite number m is composed entirely of primes larger than 10000. Solution We use the curves y 2 = x3 - Ax + A (mod p ), A = 1, 2, 3, · · ·, and take our initial point to be (1, 1). Condition (5.60) fails if 4A = 27 (mod p ), but since we have already determined that m has no prime divisor less than 10000, it follows that g.c.d. (4A - 27, m) = 1 for 1 � A � 286 Some Diophantine Equations 2500. For a given value of A , we use (5.55) and (5.56) as congruences (mod m) and compute triples (un , vn , wn ), which determine the points Pn, where P0 is given by the triple (1, 1, 1) and Pn = rnPn - t· We take N = 16. Since q16 = 29, this amounts to considering those prime powers not exceeding 30. After the triple (u 16 , v16, w16) determining P16 is calculated, we evaluate g.c.d.(w16 , m). For A = 1, 2, - · · , 6 we discover that these numbers are relatively prime, but when we take A = 7, we find that g.c.d.(w16 , m) = 37409. Hence m = 37409 · 51827. Since we have already verified that m has no prime divisor less than 10000, it follows that these two factors are prime numbers. The desired factorization has been achieved, but a few further re­ marks are in order. By calculating multiples of the point P0 = (1, 1) on the curve y 2 = x3 - 7x + 7 (mod 37409), we may verify that (24 · 33 · 52 · 7 · 1 1 · 13 · 17 · 19 · 23 · 29)P0 = 0. By calculating various multiples of P0 we may determine that its order is exactly 2 · 3 2 · 5 · 11 · 19. By a more lengthy calculation based on Problem 6 at the end of this section, we may also show that IE/ZP) I = 37620 = 2 2 · 32 · 5 · 11 · 19. Thus the order of P0 divides the order of the group, as it must by Theorem 2.49. When using the formulae (5.55) and (5.56) modulo p, we appeal to (5.55) if u 1v� � u 2v f (mod p), and otherwise use (5.56). When using these formulae to factor a number m , we proceed with congruences modulo m, and use (5.55) if u1v� � u 2vf (mod m). In the course of such calculations we may encounter a situation in which u 1v� - u 2vf is divisible by p, but not by m. In such a case, we use (5.55) whereas the corresponding calculation (mod p) would use (5.56) instead. Consequently, further calcu­ lations (mod m ) no longer correspond to the calculation of multiples of P0 (mod p). No harm is done, however, for we see from (5.55) that the resulting number w3 is divisible by p. From the formulae for w3 in (5.55) and (5.56) we see that all subsequent w's will be divisible by p. Thus the prime p is disclosed when we calculate g.c.d. (wN, m), even though the triple (uN , vN , wN ) may not correspond to the point PN (mod p). One may experiment with various choices of the parameter N, to determine which value minimizes the total mount of calculation. Suppose we wish to find a rime factor p of m, and let f(u) be the function f(u) = exp ( (log u )(log log u) /2 ). Heuristic arguments indicate that in the limit one should construct multiples of P0 corresponding to prime­ powers qn not exceeding f( p), and that the number of different values of A that will be treated before finding p may be expected to be comparable to f( p), on average. Thus it is expected that the total number of arith­ metic manipulations needed to find p b this method is roughly of the order of magnitude of f( p)2 = exp ( 2( log p)( log log p) ). Since the least prime factor of a composite number m is .,;;;; Vm, it follows that one 288 Some Diophantine Equations group of points on the elliptic curve �(Z P ) has order 5.9 CURVES OF GENUS GREATER THAN 1 Let f(x, y) be a polynomial of degree d whose coefficients may be rational, real, or complex. We speak of the set �(C) as a projective curve, though topologically it is a closed oriented surface. As such, it has a topological genus, which is a non-negative integer g. It turns out that this genus is of fundamental importance in classifying curves. We do not give a precise definition of the genus of a curve, but we state a few useful rules by which it may be calculated in elementary terms. We suppose that f(x, y) is irreducible over C, so that �(C) is an irreducible curve. If �(C) is nonsingular, then its genus is g = (d - 1Xd - 2)/2. Thus a conic has genus 0, and an elliptic curve has genus 1. It may be shown that an irreducible curve of degree d can have at most (d - 1Xd - 2)/2 singular points. A double point (x0, y0) of �(C) is called ordinary if the quadratic form has distinct roots. At such a double point, the curve crosses itself nontan­ gentially. If f(x, y) is irreducible and the only singular points of �(C) are ordinary double points, of which there are N, then g = (d - 1Xd - 2) /2 -N. Some care must be exercised in applying these rules to calculate the genus. For example, the quartic curve y 2 = x4 + 1 has no singularity in affine space, but it has a double point at 0: 1 : 0. Moreover, this double point is not an ordinary double point. In our discussion following the proof of Theorem 5.24, we found that this quartic is birationally equivalent to the elliptic curve y2 = x3 - 4x. It is known that the genus is invariant under birational transformation, although, as we see in this example, the degree is not. Hence the curve y2 = x4 + 1 has genus 1. More generally, it is known that any irreducible planar curve is C-birationally equivalent to a planar curve whose only singular points are ordinary double points. In addition, if p(x) is of degree d and has distinct roots, then the curve y 2 = p(x) has genus g = [(d - 1)/2]. Suppose now that f(x, y) is an irreducible polynomial with rational coefficients. It is known that if �(C) has genus 0 and if the curve contains Notes on Chapter 5 289 at least one rational point (i.e., �(Q) is nonempty), then �(C) is Q-bira­ tionally equivalent to a line. Our treatment of conics and of singular cubics are special cases of this. If �(C) has genus 1 and if �(Q) is nonempty, then the curve is 0-birationally equivalent to an elliptic curve. In 1923, Mordell conjectured that a curve of genus greater than 1 can possess at most finitely many rational points. This conjecture, known as the Mordell Conjecture, was proved in 1983. Faltings' Theorem Let f(x, y) be a polynomial with rational coefficients that is irreducible over the field of complex numbers. If the curve �(C) has genus g > 1, then the set �(Q) of rational points on the curve is at most finite. To see how this might be applied to Diophantine equations, we note that integral solutions of the equation xn + yn = zn with z * 0 and g.c.d. (x, y, z) = 1 are in one-to-one correspondence with rational points on the curve xn + yn = 1, the so-called Fermat curve. Indeed, in projective coordinates this curve is given by the equation xn + yn = zn. Taking partial derivatives with respect to X, Y, and Z, we find that all partials vanish only at the origin. Since the origin is not a member of projective space, we conclude that this curve is nonsingular. Hence its genus is (n - 1Xn - 2)/2. Thus Faltings' Theorem implies that for each n > 3, the equation xn + yn = zn has at most finitely many primitive integral solutions. Faltings' Theorem does not provide a specific finite upper bound for the number of rational points on the curve, though efforts are being made to strengthen Faltings' theorem in this manner. A more distant goal would be to find an explicit function of the coefficients of f(x, y) that provides an upper bound for the numerators and denominators of the coordinates of the rational points on the curve. Such a bound would have the effect of reducing the problem of finding all rational points to a finite calculation, for any given curve of genus greater than 1. NOTES ON CHAFfER 5 §5.1 Catalan conjectured that 8 and 9 are the only positive consecu­ tive perfect powers. That is, the only integral solutions of the equation xm - yn = 1 with x > 0, y > 0, m > 1, n > 1 is 32 - 2 3 = 1. Since m and n are variables, this provides a natural example of a Diophantine equation that involves an expression that is not a polynomial. Catalan's conjecture is not fully resolved, but in 1974 Robert Tijdeman applied deep methods of the theory of transcendental numbers to show that there is an effectively 290 Some Diophantine Equations computable constant C such that all consecutive perfect powers are less than C. Thus Catalan's question is resolved, apart from a certain finite calculation, which, however, is too long to perform. §5.2 For further discussion of the equivalence of matrices, additional properties of the Smith canonical form, invariant factors, and determinan­ tal divisors, and for interesting applications of this material, see Chapter 2 of the book by Newman, or Chapter 14 of the book by Hua. §5.3 The analysis of Pythagorean triples was formerly attributed to the Pythagorean school (ca. 500 B.c.), but it now seems that the full details of Theorem 5.5 were known to the Babylonians as early as 1600 B.c. §5.4 The Hasse-Minkowski principle for quadratic forms was first proved by Hasse in 1923. The proof proceeds separately for binary, ternary, and quaternary forms, the last case being the most difficult. An easier method gives the result for all quadratic forms in 5 or more variables. Detailed derivations are provided in Borevich and Shafarevich, in Serre, and in Cassels (1978). A more difficult generalized version is found in O'Meara. It seems that the first proof that the Hasse-Minkowski principle does not hold in general was given in 1942 by H. Reichardt, who showed that the equation x4 - 17 = 2y2 is everywhere locally solvable but has no integral solution. To solve the congruence (5.24), one must first consider the case j = 1. It is known that if P has integral coefficients and is absolutely irreducible (i.e., irreducible over the field C of complex numbers), then there is a function p0(P) of P such that the congruence (5.24) is solvable (mod p) for all primes p > p0(P). Unfortunately, all known proofs of this involve sophisticated techniques of algebraic geometry, although many interesting cases (such as the equation in Theorem 5.8) can be treated by compara­ tively elementary use of exponential sums. For more details on this, see Chapter 2 of the book by Borevich and Shafarevich. The primes p � p0(P) must be considered individually. Once solutions of (5.24) have been found (mod p ), one can usually extend the solutions to the moduli pj by Hensel's lemma, though in some cases one encounters singularities that make this difficult or impossible. In 1884, A. Meyer proved that any quadratic form with integral coefficients in 5 or more variables has a nontrivial zero (mod pj) for all p and all j. Here the number 5 cannot be reduced. Indeed, it is not difficult to find a form of degree d in d2 variables that for some suitable p has no nontrivial zero (mod pd), the example in Problem 7 being typical. In the 1930s, E. Artin conjectured that any form of degree d in at least d2 + 1 variables has a nontrivial zero (mod pj) for every p and every j. In 1944, R. Brauer proved a weak form of this, namely that there is a number n0(d) such that every form of degree d in at least n0(d) variables has a nontrivial zero (mod pj) for every p and every j. In 1951, D. J. Lewis proved Artin's conjecture for Notes on Chapter 5 291 d = 3, but in 1966 Terjanian found a form (see Problem 8) of degree 4 in 18 variables with no nontrivial zero (mod 16). It is now known that n0(d) grows very rapidly with d. Nevertheless, in 1965 Ax and Kochen used tools of mathematical logic to show that for every d there is a set 9d of primes, which may be empty but in any case is at most finite, such that if P is homogeneous of degree d in more than d 2 variables, then (5.24) has a nontrivial solution for all j ;;;. 1, if p $. � · For d > 2 the set 9d of exceptional primes has not been precisely determined. Many particular Diophantine equations have been treated by means of special methods. Such techniques are sometimes exceedingly ingenious, as in the proof of Theorem 5.8, given first by V. A. Lebesgue in 1869. In sharp contrast to the special methods used in proving Theorem 5.8 and 5.9, we note that the powerful inequality (5.26) enables us to treat a wide class of Diophantine equations. The first nontrivial estimate in the direc­ tion of (5.26) was established in 1909 by Axel Thue. The estimate was improved, first by C. L. Siegel, then by Freeman Dyson, and finally K. F. Roth proved (5.26) in 1955. The estimate is best-possible, though the problem of determining explicitly the dependence of C on e and P remains unsolved. The equation in Theorem 5.8 is a special case of Bachet 's equation, x 3 + k = y 2• We treat k = - 1 and k = -2 in Section 9.9, by means of the arithmetic of quadratic number fields. In 1917, Thue used his weak form of (5.26) to show that for any given nonzero integer k, this equation has at most finitely many solutions. Using deep estimates from the theory of transcendental numbers, for each k * 0 one can give a bound for the size of x and y, and hence reduce the problem of finding all solutions to a finite calculation. The proof of Theorem 5.10 offers a good example of Fermat's \"method of infinite descent.\" In this application, the argument raises more ques­ tions than it answers, concerning the nature of the mysterious connection between the two equations (5.27) and (5.29). One may note that our method constructs a rational transformation from the curve x4 + 1 = y 2 to the curve x4 - 4 = y 2 , and a second rational transformation that takes the second curve back to the first. These curves have genus 1, and descent is very effective when applied to such curves, but a full explanation of the reasons for this involves a sophisticated discussion of cohomology and two-coverings of elliptic curves, as in the paper of J. W. S. Cassels, \"Diophantine equations with special reference to elliptic curves,\" J. London Math. Soc., 41 (1966), 193-291. In other situations descent may be used to generate new solutions from a given one, or to show that all solutions are generated from some initial solution. By Theorem 5.10 we see that Fermat's last theorem is settled when 4ln. This much was done by Fermat. All other n have an odd prime 292 Some Diophantine Equations divisor, and thus to settle the problem completely it suffices to show that for each prime p > 2, the equation x P + y P = z P has no solution in positive integers. Euler settled the case p = 3 in 1770, and Dirichlet and Legendre proved the result for p = 5 in 1825, but the greatest contribu­ tions were made by E. E. Kummer in the mid-nineteenth century. To describe Kummer's approach, suppose that p is prime, p > 2, and let { denote a primitive pth root of unity, say { = e21Ti/P. Using this complex number, we see that xP + y P = (x + y)( x + {y) ... ( x + {P- ly) . Kummer used this factorization in the same manner as in the argument in Section 5.3. If these factors have no common divisors, then one would think that each factor must be a pth power, but unique factorization fails in this ring when p is large. Kummer discovered that the unique factoriza­ tion of these numbers is restored if one works in a still larger algebraic number field obtained by adjoining certain further algebraic numbers. Kummer called these numbers \"ideal elements,\" but it was later found that the same effect can be achieved by manipulating certain sets of numbers within the original algebraic number field. Since these sets replace Kummer's ideal elements, they were called \"ideals.\" It can be shown that the ideals in an algebraic number field factor uniquely into prime ideals, even though the integers in the field may not. Kummer developed the arithmetic of integers in algebraic number fields and formu­ lated a criterion, which if satisfied, guarantees that Fermat's equation has no solution. In this way, Kummer was able to settle the problem for many exponents p. Kummer's criterion has since been greatly strengthened. In 1954, D. H. Lehmer, E. Lehmer, and H. S. Vandiver, \"An application of high-speed computing to Fermat's last theorem,\" Proc. Nat. Acad. Sci. USA, 40, (1954), 25-33, 732-735, gave a powerful criterion involving only integer arithmetic, which is not known to fail for any prime p, although it is still not known that the criterion is satisfied for infinitely many primes. J. Tanner and S. Wagstaff, \"New congruences for the Bernoulli numbers,\" Math. Comp. 48 (1987), 341-350, verified that the criterion holds for all p < 150,000, and thus Fermat's last theorem is settled for these exponents. Using somewhat different methods, which go back to work of Sophie Germain in the nineteenth century, together with deep estimates from the analytic theory of prime numbers, in 1985 Adleman, Heath-Brown, and Fouvry proved that there are infinitely many primes p such that the equation xP + y P = zP has no solution for which p divides none of the variables. For a detailed account of the history and mathematics surround­ ing Fermat's last theorem see the books by Paulo Ribenboim listed in the General References, as well as his more recent journal article \"Recent results about Fermat's last theorem,\" Expos. Math., 5 (1987), 75-90. In Notes on Chapter 5 293 1986, G. Frey proposed that Fermat's last theorem might be approached by considering the elliptic curve y 2 = x(x - a PXx - cP). K. Ribet, \" On modular representations of Gal (QjQ) arising from modular forms,\" In­ vent. Math. 100 (1990), 43 1 -476, has confirmed this by showing that if a and c are nonzero rational numbers such that a P + b P = cP for some nonzero rational number b, then the curve violates the Weil-Taniyama conjecture concerning elliptic curves. §5.5 To diagonalize a quadratic form by linear transformations with rational coefficients, one may use the Gram-Schmidt process, as discussed in many texts on linear algebra. The proof of Theorem 5. 11 follows an account devised by L. J. Mordell, \" On the equation ax 2 + by 2 - cz 2 = 0,\" Monats. Math., 55 (1951) 323-327. This proof is quite different from that given by Legendre, but like Legendre's proof, does not use quadratic reciprocity. Indeed, Legendre deduced some special cases of quadratic reciprocity from this result. In 1950, L. Holzer showed that if a, b, c are as described in Theorem 5.11, then not only does a nontrivial inte­ gral solution exist, but there is such a solution for which lx l � v'lbCf, IY I � vTtUf, I z I � vTabf. An elementary proof of Holzer's theorem has been given by L. J. Mordell, \"On the magnitude of integer solutions of the equation ax 2 + by 2 + cz 2 = 0,\" J. Number Theory, 1 (1969), 1-3. Theorem 5.14 is a special case of a theorem of ChevaHey and Warning which asserts that if f(x) is a homogeneous polynomial of degree d in n variables, then the congruence f(x) = 0 (mod p) has a nontrivial solution provided that n > d. An account of this is found in Section 1.1 of Borevich and Shafarevich. §5.6 The use of the tangent line to generate a point on a cubic curve from a given point is found in Diophantus, and this method was used extensively by Bachet and Fermat. However, it seems that the use of a chord to generate a new point from two given points occurs first in a manuscript of Newton. §5.7 The definition of the sum of two points on an elliptic curve was given first by Cauchy in 1835, but the further observation that this defines a group seems to have been made first by Poincare in 1901. Poincare tacitly assumed that the group is finitely generated, and it was only in 1921 that this was proved by Mordell. Andre Weil, in his doctoral thesis of 1928, gave not only a new proof of Mordell's theorem, but extended it to algebraic number fields and generalized it to abelian varieties of higher dimension. It is perhaps not immediately evident why the nonsingular cubic curve is termed \"elliptic.\" To establish the connection, we remark that it is natural to express the arc length of an ellipse as an integral involving the square root of a quartic polynomial. By making a rational change of variables, this may be reduced to an integral involving the square root of a 294 Some Diophantine Equations cubic polynomial. In general, an integral involving the square root of a quartic or cubic polynomial is called an elliptic integral. Such integrals were extensively studied in the eighteenth and nineteenth centuries, and meth­ ods were developed to reduce them to integrals of a few standard forms. An indefinite elliptic integral is not an elementary function, but it can be represented by introducing a new transcendental function, the Weierstrass p-function, which satisfies the differential equation p'2 = p 3 - Ap -B. Consequently, the change of variables x = p(t) gives t(x3 - Ax- B) - t/2 dx = p- 1 ( b ) - p - 1 (a) . a This is analogous to the observation that sin x is a solution of the differential equation y 2 + y'2 = 1, so that the change of variables x = sin t gives J:(l - x 2)- 112 dx = arcsin b - arcsin a. In the same way that we parameterize the unit circle as (cos t, sin t ), we may parameterize the elliptic curve -G{(C) as (p(t), p'(t)). Moreover, it may be shown that if A = (p(t), p'(t)) and B = (p(u), p'(u)), then A + B is given by (p(t + u), p'(t + u)). Thus the addition of points on -G{(C) corresponds to the addition of complex numbers. When approached in this manner, it is immediately evident that this addition of points on an elliptic curve yields a group. A development of the subject along these lines is given in Koblitz (1984). The geometric approach we adopted is easily transferred to elliptic curves over other fields, as arises in Section 5 .8. A different proof of Theorem 5.21, but in the same spirit, is found in Reid. A similar proof, accompanied by a more detailed development of the properties of alge­ braic curves, is found in Husemoller. For a complete account of intersec­ tion theory and Bezout's theorem, see the book of Fulton or of Walker. A charming introduction to elliptic curves, at a somewhat more advanced level, is found in Chahal. The graduate text by Silverman is more demand­ ing. The description of points of finite order on an elliptic curve was given independently by Elizabeth Lutz in 1937 and Trygve Nagell in 1935. The theorem of Siegel, proved in 1929, states that a curve of positive genus contains at most finitely many integral points. Mazur's theorem was first conjectured by Andrew Ogg, and then proved by Barry Mazur in 1977. By combining the results of Problems 12, 16, 21, 22 one obtains an example of an elliptic curve with two real components, with rational points dense on one component but absent from the other component. This example is due to A. Bremner. §5.8 The p - 1 method was proposed by J. M. Pollard, \"Theorems on factorization and primality testing,\" Proc. Camb. Philos. Soc., 76 (1974), 521-528. A corresponding p + 1 method, using Lucas sequences, has been investigated by H. C. Williams, \"A p + 1 method of factoring,\" Notes on Chapter 5 295 Math. Comp., 39 (1982) 225-234. The elliptic curve method of factoriza­ tion was invented by H. W. Lenstra Jr., \"Factoring integers with elliptic curves,\" Annals of Math., 126 (1987), 649-673. D. V. and G. V. Chud­ novsky, \"Sequences of numbers generated by addition in formal groups and new primality and factorization tests,\" Advances in Applied Math., 7 (1986), 385-434 have discussed various formulae that may be used to implement the ECM. Since most machines perform multiplication much more slowly than addition, a rough measure of the time required to evaluate a typical expression is obtained by simply counting the number of multiplications involved. If a point P is given and we use the formulae (5.55) and (5.56) to calculate rP, on average we require about 27 log r multiplications. A more efficient system of formulae, requiring only about 16 log r multiplications, has been found by P. L. Montgomery, \"Speeding the Pollard and elliptic curve methods of factorization,\" Math. Comp., 48 (1987), 243-264, who also describes a number of ways of enhancing the method. A further method, the Quadratic Sieve (abbreviated QS) was invented in 1983 by Carl Pomerance (see his article in the book edited by Lenstra and Tijdeman in the General References). The Quadratic Sieve is also subject to a number of refinements and modifications. Although the description of the OS is more intricate than with ECM, the mathematics involved is more elementary. The running times of the two methods are thought to be roughly the same, but the OS seems to hold an advantage when applied to composite numbers m composed of two large primes, especially on large machines. Much of the calculation performed in executing the OS is single-precision, whereas the operations involved in the ECM are likely to involve multiple-precision arithmetic. In addition, the OS lends itself to parallel processing, even to the extent that several machines, connected only by electronic mail, may share in the task. The disadvantage of the OS is that it is memory-intense, so that it is unsuitable for use on a pocket calculator. On the other hand, the ECM makes very little use of memory and runs very well on small machines. One way to complete the proof of the associativity of addition of points on an elliptic curve (mod p) involves observing that the field 7LP is contained in its algebraic closure T;,. which is an infinite field. One may define what it means for two points of an elliptic curve over \"1;, to be \"close,\" and thus one may complete the proof of associativity by a continuity argument, as in the proof of Lemma 5.20. The reduction of an elliptic curve to Weierstrass normal form cannot always be carried out for elliptic curves (mod p ), but one can reduce the general elliptic curve (mod p) to the shape y 2 + axy +by= x 3 + cx2 + dx + e (mod p ). To finish the reduction, one would want to complete the square, writing the left side as (y + 2ax + Zb)2 + · · · . However, this can be done only if p * 2. As for the right side of the congruence, we would 296 Some Diophantine Equations want to complete the cube, writing (x + 3c)3 + · · · . This can be done, provided that p * 3. Thus one can reduce to Weierstrass form for p > 3, but a more general form is required if one is to capture all elliptic curves modulo 2 or 3. The inequality (5.58) was proved in 1931 by H. Hasse. In 1948, A. Weil proved a similar inequality pertaining to irreducible curves (mod p) of arbitrary degree, and a more complicated generalization to varieties of higher dimension was established in 1973 by P. Deligne. §5.9 The application of techniques of algebraic geometry to Dio­ phantine equations has given rise to a subdiscipline called Diophantine geometry. This area traces its roots to a time just a century ago when the properties of Q-birational equivalence were first investigated by Hilbert, Hurwitz, and Poincare. In a front page story on July 19, 1983, The New York Times announced that the Mordell Conjecture had been settled by the German mathemati­ cian Gerd Faltings. Within a few weeks, Faltings' theorem was hailed as \"The theorem of the century.\" Faltings' paper, \"Endlichkeitssatze fUr abelsche Varietaten Uber Zahlkorpern,\" Invent. Math., 73 (1983), 349-366, is quite technical, but a useful perspective is provided by the account of D. Harris, \"The Mordell conjecture,\" Notices of the AMS, 33 (1986), 443-449. Our formulation of Faltings' theorem is somewhat weakened. In its full strength, it is not restricted to plane curves, and it applies to points whose coordinates lie in any fixed algebraic number field. CHAPTER 6 Farey Fractions and Irrational Numbers A rational number is one that is expressible as the quotient of two integers. Real numbers that are not rational are said to be irrational. In this chapter the Farey fractions are presented; they give a useful classifi­ cation of the rational numbers. Some results on irrational numbers are given in Section 6.3, and this material can be read independently of the first two sections. The discussion of irrational numbers is limited to number theoretic considerations, with no attention given to questions that belong more properly to analysis or the foundations of mathematics. A rational number ajb with g.c.d.(a, b) = 1 is said to be in reduced form, or in lowest terms. 6.1 FAREY SEQUENCES Let us construct a table in the following way. In the first row we write 0/1 and 1/l. For n = 2, 3, · · · we use the rule: Form the nth row by copying the (n - 1)st in order, but insert the fraction (a + a')j(b + b') between the consecutive fractions ajb and a'jb' of the (n - 1)st row if b + b' � n. Thus, since 1 + 1 � 2 we insert (0 + l)j(l + 1) between 0/ 1 and 1/1 and obtain 0/1, 1/2, 1/1, for the second row. The third row is 0/ 1, 1/3, 1/2, 2/3, 1/1. To obtain the fourth row we insert (0 + 0/0 + 3) and (2 + 0/(3 + 0 but not (1 + 0/(3 + 2) and (1 + 2)/(2 + 3). The first 297 298 Farey Fractions and Irrational Numbers five rows of the table are: 0 1 1 1 0 1 1 1 2 1 0 1 1 2 1 1 3 2 3 1 0 1 1 1 2 3 1 1 4 3 2 3 4 1 0 1 1 1 2 1 3 2 3 4 1 - 1 5 4 3 5 2 5 3 4 5 1 Up to this row, at least, the table has a number of interesting properties. All the fractions that appear are in reduced form; all reduced fractions ajb such that 0 � ajb � 1 and b � n appear in the nth row; if ajb and a'jb' are consecutive fractions in the nth row, then a'b- ab' = 1 and b + b' > n. We shall prove all these properties for the entire table. Theorem 6.1 If a/b and a' jb' are consecutive fractions in the nth row, say with a jb to the left of a' jb', then a'b - ab' = 1. Proof It is true for n = 1. Suppose it is true for the (n - 1)st row. Any consecutive fractions in the nth row will be either ajb, a'jb' or ajb, (a + a') j(b + b'), or (a + a') j(b + b'), a' jb' where a jb and a' jb' are consecutive fractions in the (n - 1)st row. But then we have a'b - ab' = 1, (a + a') - a(b + b') = a'b - ab' = 1, a'(b + b') - (a + a')b' = a'b - ab' = 1, and the theorem is proved by mathematical induction. Corollary 6.2 Every a jb in the table is in reduced form, that is, (a, b) = 1. Corollary 6.3 The fractions in each row are listed in order of their size. Theorem 6.4 If ajb and a'jb' are consecutive fractions in any row, then among all rational fractions with values between these two, (a + a')j(b + b') is the unique fraction with smallest denominator. Proof In the first place, the fraction (a + a')j(b + b') will be the first fraction to be inserted between a jb and a' jb' as we continue to further rows of the table. It will first appear in the (b + b')th row. Therefore we 300 Farey Fractions and Irrational Numbers Corollary 6.6 The nth row consists of all reduced rational fractions ajb such that 0 � a I b � 1 and 0 < b � n. The fractions are listed in order of their size. Definition 6.1 The sequence of all reduced fractions with denominators not exceeding n, listed in order of their size, is called the Farey sequence of order n. The nth row of our table gives that part of the Farey sequence of order n that lies between 0 and 1, and so the entire Farey sequence of order n can be obtained from the nth row by adding and subtracting integers. For example, the Farey sequence of order 2 is -3 - 5 - 2 - 3 -1 -1 0 1 1 3 2 5 3 , - 1 - , � , - 1 - , � · - 1 - , � · 1 · 2 · 1 · 2 · 1 · 2 · 1 · This definition of the Farey sequences seems to be the most conve­ nient. However, some authors prefer to restrict the fractions to the interval from 0 to 1; they define the Farey sequences to be just the rows of our table. Any reduced fraction with positive denominator � n is a member of the Farey sequence of order n and can be called a Farey fraction of order n. Note that consecutive fractions a jb and a' jb' in the Farey sequence of order n satisfy the equality of Theorem 6. 1 and also the inequality b + b' > n. PROBLEMS 1. Let a jb and a' jb' be the fractions immediately to the left and the right of the fraction 1/2 in the Farey sequence of order n. Prove that b = b' = 1 + 2[(n - 1) j2], that is, b is the greatest odd integer � n. Also prove that a + a' = b. 2. Prove that the number of Farey fractions a jb of order n satisfying the inequalities 0 � ajb � 1 is 1 + Ej_ 1c/J(j), and that their sum is exactly half this value. 3. Let a jb, a' jb', a\" jb\" be any three consecutive fractions in the Farey sequence of order n. Prove that a'jb' =(a + a\")j(b + b\"). 6.2 Rational Approximations 301 4. Let ajb and a'jb' run through all pairs of adjacent fractions in the Farey sequence of order n > 1. Prove that ( a' a ) 1 min b' - b = n( n - 1) and max ( � - �) = !_ b' b n 5. Consider two rational numbers ajb and cjd such that ad - be = 1, b > 0, d > 0. Define n as max (b, d), and prove that ajb and cjd are adjacent fractions in the Farey sequence of order n. 6. Prove that the two fractions described in the preceding problem are not necessarily adjacent in the Farey sequence of order n + 1. 7. Consider the fractions from 0/ 1 to 1 /1 inclusive in the Farey sequence of order n. Reading from left to right, let the denominators of these fractions be b1,b2 ,· • ·, bk so that b 1 = 1 and bk = 1. Prove that r.j:l<bjbj+ i) - 1 = 1. 8. Show that if n is a positive integer then [.(bb') - I = 1 where the sum is over all pairs (b, b') of integers for which 1 � b � n, 1 � b' � n, g.c.d. (b, b') = 1, and b + b' > n. 9. For each Farey fraction ajb let �(ajb) denote the circle in the plane of radius (2b2) - 1 and center (ajb, (2b2) - 1). These circles, called the Ford circles, lie in the half-plane y ;;?; 0 and are tangent to the x-axis at the point a jb. Show that the interior of a Ford circle contains no point of any other Ford circle, and that two Ford circles �(ajb), �(a'jb') are tangent if and only if ajb and a'jb' are adjacent Farey fractions of some order. 6.2 RATIONAL APPROXIMATIONS Theorem 6.7 If ajb and cjd are Farey fractions of order n such that no other Farey fraction of order n lies between them, then and I a a+ c l 1 1 b- b + d = b( b +d) � b( n + 1) 306 Farey Fractions and Irrational Numbers For integers h, k with k > 0, we then have The expression on the left in (6.3) is not zero because both � and 15 - � are irrational. The expression lh2 - hk - k 2 1 is a non-negative integer. Therefore lh 2 - hk - el ;;;;.. 1 and we have (6.4) Now suppose we have an infinite sequence of rational numbers hj/kj, kj > 0, and a positive real number m such that _!_ _ � <--2 . I h - I 1 kj mkj 1 1 (6.5) Then kj� - k < hj < ki + -- , and this implies that there are only a m j mkj finite number of hj corresponding to each value of kj. Therefore we have kj - oo as j - oo. Also, by (6.4), (6.5), and the triangle inequality we have hence and therefore 6.3 Irrational Numbers 307 PROBLEMS 1. Prove that for every real number x there are infinitely many pairs of integers a, b, with b positive such that lbx - al < ({Sb) - 1• 2. Take g = (1 + {5)j2. Let A > 0 and a > 2 be real numbers. Prove that there are only finitely many rationals h/k satisfying lg - �I < _ 1 . k Aka 3. Suppose h = a, k = b is a solution of the inequality (6.2) for some irrational f Prove that only a finite number of pairs h, k in the set {h = ma, k = mb; m = 1, 2, 3, · · · } satisfy (6.2). 4. Let a > 1 be a real number. Suppose that for some real number {3 there are infinitely many rational numbers hjk such that 1 {3 - h/k l < k-a. Prove that {3 is irrational. 5. Prove that the following are irrational: EJ_,2-31, EJ_ ,2 -j1• 6. If an irrational number 9 lies between two consecutive terms ajb and cjd of the Farey sequence of order n, prove that at least one of the following inequalities holds: 19 - ajb l < 1/2b2 , 1 9- cjdl < 1j2d2• 6.3 IRRATIONAL NUMBERS That fi is irrational can be concluded at once from the unique factoriza­ tion theorem. For if fi could be represented in the form ajb, it would follow that a2 = 2b2• But this is impossible with integers a and b because the highest power of 2 that divides a2 is an even power, whereas the highest power of 2 that divides 2b2 is an odd power, by the unique factorization theorem. A more general argument for deducing irrationality is formulated next. Theorem 6.13 If a polynomial equation with integral coefficients CnXn + Cn - lXn - l + • • · c2x 2 + c1x + C0 = 0, Cn oF 0 (6.6) has a nonzero rational solution a jb where the integers a and b are relatively prime, then ai c0 and b i en. Proof Replacing x by a jb in (6.6) and multiplying by bn - 1, we note that en an jb is an integer, and hence b i en since (a, b) = 1. On the other hand, replacing x by ajb in (6.6) and multiplying by bn ja, we observe that c0bn ja is an integer, so a lc0• 308 Farey Fractions and Irrational Numbers Corollary 6.14 If a polynomial equation (6.6) with en = ± 1 has a nonzero rational solution , that solution is an integer dividing c0• Corollary 6.15 For any integers c and n > 0, the only rational solutions, if any, of x n = c are integers. Thus x n = c has rational solutions if and only if c is the nth power of an integer. It follows at once that such numbers as fi, f3, .f5 are irrational because there are no integral solutions of x2 = 2, x 2 = 3, and x3 = 5. Another application of Theorem 6.13 can be made to certain values of the trigonometric functions, as follows. Theorem 6.16 Let 8 be a rational multiple of 11'; thus, 8 = r'TI' where r is rational. Then cos 8, sin 8, tan 8 are irrational numbers apart from the cases where tan 8 is undefined, and the exceptions cos 8 = 0, ± 1/2, ± 1; sin 8 = 0, ± 1/2, ± 1; tan 8 = 0, ± 1. Proof Let n be any positive integer. First we prove by mathematical induction that there is a polynomial fn(x) of degree n with integral coefficients and leading coefficient 1 such that 2 cos n8 = fn(2 cos 8) holds for all real numbers 8. We note that f1(x) = x, and f2(x) = x2 - 2 because of the well-known identity 2 cos 28 = (2 cos 8)2 - 2. The identity 2 cos ( n + 1) 8 = (2 cos 8) (2 cos n8) - 2 cos ( n - 1) 8 is easily established by elementary trigonometry, and this reveals that fn + 1(x) = xfn(x) - fn _ 1(x) which completes the proof by induction. Next, let the positive integer n be chosen so that nr is also an integer. With 8 = r'TI' it follows that fn(2 cos 8 ) = 2 cos n8 = 2 cos nr'TI' = ± 2 where the plus sign holds if nr is even, the minus sign if odd. Thus 2 cos 8 is a solution of fn(x) = ± 2. Setting aside the cases where cos 8 = 0, we apply Corollary 6.14 to conclude that 2 cos 8, if rational, is a nonzero integer. But -1 � cos 8 � 1, so the only possible values of 2 cos 8, apart from 0, are ± 1 and ± 2. So Theorem 6.16 has been established in the case of cos 8. As to sin 8, if 8 is a rational multiple of 71' so is 71' /2 - 8, and from the identity sin 8 = cos ( 71' /2 - 8) we arrive at the conclusion stated in the theorem. Finally, the identity cos 28 = (1 - tan2 8)/0 + tan2 8) reveals that if tan 8 is rational so is cos 28. In view of what was just proved about the 6. 3 Irrational Numbers 309 cosine function, we need look only at the possibilities cos 29 = 0, ± 1/2, ± 1. When cos 29 = 0 it is readily calculated that tan 9 = ± 1; when cos 29 = + 1, tan 9 = 0; when cos 29 = - 1, tan 9 is undefined; when cos 2 9 = ± 1/2, tan 9 is one of the irrational values ± {3, ± 11 {3. This completes the proof of Theorem 6.16. The logarithm of any positive rational number to a positive rational base is easily classified as rational or irrational. Consider, for example, log6 9. If this were a rational number ajb, where a and b are positive integers, this would imply that 9 = 6a fb or 9b = 6a. The unique factoriza­ tion theorem can be applied to separate the primes 2 and 3 to give 9b = 3a and 1 = 2 a. These equations imply that a = b = 0, and so we conclude that log6 9 is irrational. The basic mathematical constants 7T and e are irrational. A proof of this for e is sufficiently simple that we leave it to the reader in Problems 7 and 8 at the end of this section. For 7T the matter is not quite so easy, so we precede the proof with a lemma. Lemma 6.17 If n is any positive integer, and g(x) any polynomial with integral coefficients, then xng(x) and all its derivatives, evaluated at x = 0, are integers divisible by n!. Proof Any term in g(x) is of the form cxj where c and j are integers with c -=F 0 and j � 0. The corresponding term in xng(x) is cxj+n; if we prove the lemma for this single term, the entire lemma will follow because the derivative of a finite sum is the sum of the derivatives. At x = 0, it is readily seen that cxj +n and all its derivatives are zero, with one exception, namely the (j + n)th derivative. The (j + n)th deriva­ tive is c{(j + n)!}, and since j � 0, this is divisible by n! Theorem 6.18 7T is irrational. Proof Suppose that 7T = ajb, where a and b are positive integers. Define the polynomial where the second form of f(x) stems from the first by simple algebra. The integer n will be specified later. We apply Lemma 6.17 with g(x) in the form (a - bx)n to conclude that xn(a - bx)n and all its derivatives, evaluated at x = 0, are integers divisible by n!. Dividing by n!, we see that f(x) and all its derivatives, evaluated at x = 0, are integers. Denoting the 310 Farey Fractions and Irrational Numbers jth derivative of f(x) by J<i>(x), and writing f(x) = J<0>(x), we can state that J<i>(O) is an integer for every j = 0, 1, 2, 3, · · · . By the second part of (6.7) we find that f( 1r - x) = f(x), and taking derivatives we get -f'(Tr - x) = f'(x),t<2>(Tr - x) = J<2>(x), and in gen­ eral ( -l)jJ<i>(Tr - x) = J<i>(x). Letting x = 0 we obtain the result that JU>( 1r) is an integer for every j = 0, 1, 2, 3, · · · Next the polynomial F(x) is defined by F(x) =f(x) -t<2>(x) +f<4>(x) -f<6>(x) + · ·· +( -1(f<2n>(x). Now if this equation is differentiated twice the result is because J<2n+2>(x) = 0 since f(x) is a polynomial of degree 2n. Adding these equations we get F(x) + F<2>(x) = f(x). Also, by the preceding paragraphs we observe that F(O) and F( 1r) are integers, because they are sums and differences of integers. Now by elementary calculus it is seen that d d.x {F'(x) sin x- F(x) cos x} = F\"(x) sin x + F(x) sin x = f(x) sin x. Thus we are able to integrate f(x) sin x, to get ['t(x) sin xd.x = (F'(x) sin x- F(x) cos x]; = F( 1r ) + F(O). ( 6.8) 0 A contradiction arises from this equation, because whereas F( 1r ) + F(O) is an integer, we demonstrate that the integer n can be chosen sufficiently large in the definition of f(x) in (6. 7) that the integral in (6.8) lies strictly between 0 and 1. From (6.7) we see that from x = 0 to x = Tr, and 6. 3 Irrational Numbers Also f(x) sin x > 0 in the open interval 0 < x < 7T, and hence 1r 7Tnan 0 < J f( x) sin x dx < -- · 7T o n! 311 because the interval of integration is of length 7T. From elementary calculus it is well known that for any constant such as 1ra, the limit of (7Ta)n jn! is zero as n tends to infinity. Hence we can choose n sufficiently large that the integral in (6.8) lies strictly between 0 and 1, and we have obtained the contradiction stated above. It follows that 7T is irrational. PROBLEMS 1. Prove that the irrational numbers are not closed under addition, subtraction, multiplication, or division. 2. Prove that the sum, difference, product, and quotient of two num­ bers, one irrational and the other a nonzero rational, are irrational. 3. Prove that ..fi + {3 is a root of x4 - 10x2 + 1 = 0, and hence establish that it is irrational. 4. (a) For any positive integer h, note that h2 ends in an even number of zeros whereas 10h2 ends in an odd number of zeros in the ordinary base ten notation. Use this to prove that /10 is irrational, by assuming /10 = hjk so that h2 = 10k2• (b) Extend this argument 3 to V'10. (c) Extend the argument to prove that v'n is irrational, where n is a positive integer not a perfect square, by taking n as the base of the number system instead of ten. 5. (i) Verify the details of the following sketch of an argument that ffi is irrational. Suppose that ffi is rational, and among its rational representations let ajb be that one having the smallest positive integer denominator b, where a is also an integer. Prove that another rational representation of ffi is (77b - Ba)j(a - Bb). Prove that a - Bb is a smaller positive integer than b, which is a contradiction. (ii) Generalize this argument to prove that v'n is irrational if n is a positive integer not a perfect square, by assuming n = ajb and then getting another rational representation of n with denominator a - kb where k = [ v'nl, the greatest integer less than v'n. (An interesting aspect of this problem is that it establishes irrationality by use of the idea that every nonempty set of positive integers has a least member, not by use of the unique factorization theorem.) 312 Furey Fractions and Irrational Numbers 6. Let ajb be a positive rational number with a > 0, b > 0, g.c.d. (a, b) = 1. Generalize Corollary 6. 15 by proving that for any integer n > 1 the equation xn = ajb has a rational solution if and only if both a and b are nth powers of integers. (H) 7. Prove that a number a is rational if and only if there exists a positive integer k such that [ka] = ka. Prove that a number a is rational if and only if there exists a positive integer k such that [(k!)a] = (k !)a. 8. Recalling that the mathematical constant e has value Lj_0ljj!, prove that k [( k!) e ] = k! E 1 /j ! < ( k! ) e j - 0 Hence prove that e is irrational. 9. Prove that cos 1 is irrational, where \"1\" is in radian measure. (H) 10. Prove that (log 3) /log 2 is irrational. *11. Prove that no n points with rational coordinates (x, y) can be chosen in the Euclidean plane to form the vertices of a regular polygon with n sides, except in the case n = 4. (H) 6.4 THE GEOMETRY OF NUMBERS In this section we consider sets ../ that lie in real n-dimensional space IRn and find conditions which ensure that ../ contains a point whose coordi­ nates are integers, that is, a point of 1r. If vis a point (or \"vector\") of IRn and c is a real number, then cv denotes the scalar multiple of v. If v and w are two points of IRn, then v + w is the vector sum of v and w. Similarly, if ../� IRn, then we let c../ denote the set ../ dilated by the factor c, that is, c../= {c s E IRn: s E ../}. In the same way, we define v + ../to be the set ../ translated by v, so that v + ../= {v + s E IRn: s E ../}. These defini­ tions apply to arbitrary sets in IRn, but we restrict our attention to those sets ../ for which the volume v(../) is defined by multiple Riemann integrals. Theorem 6.19 Blichfeldt 's principle. Let ../ be a set in IRn with volume v(../) > 1. Then there exist two distinct points s' E ../and s\" E ../such that s' - s\" has integral coordinates. The analogue of this for sets of integers is obvious by the pigeonhole principle: If ../ is a set of more than m integers then there exist two distinct members of ../ that are congruent modulo m. 6.4 The Geometry of Numbers 313 Proof To simplify notation and also to make geometric visualization easier, we suppose that n = 2, though the proof is perfectly general. By considering only those points s E ./ that lie in the disk lsi � R, with R suitably large, we may suppose that ./ is bounded. For each point k = (k1, k2) with integral coordinates we let �(k) be the unit square consisting of those points v = (v1, v2) for which k1 � v 1 < k1 + 1, k2 � v2 < k2 + 1. That is, [v.J = k1, [ v2] = k2. Since each point v in the plane IR12 lies in exactly one such square, these squares form a partitioning of IR12• For each integral point k we let ./(k) denote that part of ./ that lies in �(k). In symbols, ./(k) = ./n �(k). Thus the subsets ./(k) partition ./, and consequently L: v( ./(k) ) = v( ./) . keZ 2 Put S\"(k) = - k + ./(k), so that S\"(k) is a translate of ./(k) and S\"(k) � �(0). Since translation does not disturb the volume of a set, we have v(S\"(k)) = v(./(k)). On inserting this in the identity above and appealing to our hypothesis that v(./) > 1, we deduce that L: v (S\"(k) ) > 1. ke Z 2 Here only finitely many of the sets S\"(k) are nonempty, since ./ is a bounded set. The sets S\"(k) lie in the unit square �(0) whose volume is 1. Since the volumes of these sets sum to more than 1, they cannot all be disjoint. Thus there exist two distinct integral points, say k' and k'' such that S\"(k') and S\"(k\") have a point v in common. Put s' = k' + v, s\" = k'' + v. Then s' e ./(k'), s\" e ./(k''), so that s' and s\" are members of ./, and s' - s\" = k' - k\" is a nonzero integral point. This completes the proof. If v and w are points of IRn, then the line segment joining them consists of the points t v + (1 - t)w, where 0 � t � 1. A set -G' in IRn is said to be convex if for any two points v, w of -G', the line segment joining them is contained in -G'. A set ./ in IRn that has the property that s e ./ if and only if - s e ./ is said to be symmetric about 0. Theorem 6.20 Minkowski's Convex Body Theorem. Let -G' be a convex subset of IRn. If -G' is convex, symmetric about 0, and has volume v( -G') > 2n, then -G' contains a point c whose coordinates are integers, not all of them 0. 314 Farey Fractions and Irrational Numbers Proof Let ../= t -G\". Then v(../) = <t)n v(-G\") > 1. By Blichfeldt's princi­ ple (Theorem 6. 19) there must exist points s' and s\" of ../ such that s' =F s\", s' - s\" E 7l. n. We note that 2s' E -G\", 2s\" E -G\". Since -G\" is symmet­ ric about 0, it follows that - 2s\" E -G\". Since -G\" is convex, the line segment joining 2s' to - 2s\" lies in -G\". In particular, -G\" contains the midpoint of this segment, namely the point s' - s\". This is the point desired, as it has integral coordinates, not all 0. Let A be an n X n matrix with real elements. Then A is nonsingular (i.e., the inverse matrix A - I exists) if and only if det (A) =F 0. For such A, the linear transformation y =A x from �n into itself is both one-to-one and onto. We now consider how Theorem 6.20 is altered if we apply such a linear transformation. If ../ is a set in �n. then we let A../ denote the image of ../ under this linear transformation. That is, A../= {As E �n: s E ../}. In particular, let A= A 7l.n. If det (A) =F 0, then we call the set A a lattice. Members of A are called lattice points. By taking A to be the identity matrix /,we see that /7l.n = 7l. n is itself a lattice, called the lattice of integral points. If A is a nonsingular matrix with columns a1, a2 , · · ·,an , and if x is a column vector with real coordinates xi> x2, · ·, xn , then Ax = x1a1 + x2a2 + · · · +xnan. Here the aj form a basis for �n. so that every point of �n is uniquely of this form. Such a point is a member of A if and only if all the xi are integers. That is, A is the set of all vectors v of the form ( 6.9) where the kj are integers. For each such lattice point v, the set of coordinates k1 , k2, • • ·, kn is unique, and we say that a1, a2, ··· ,a n form a basis for A. Since a linear transformation takes lines to lines, we see that if -G\" is a convex set in �n, then A -G\" is also convex. Similarly, if ../ is a set in �n that is symmetric about 0, then A../ also has this property. Let e1, e 2, ·· ,en denote the columns of I. These elementary unit vectors determine the edges of the unit cube %'(0), whose volume is 1. Under the linear transformation y =A x, the vectors e1, e2 , ·· ,en are mapped to a I> a2, ·· ,an, which determine the edges of the parallelepiped A%'(0) of volume I det (A) 1. This number is called the determinant of A, and is denoted d(A). Suppose that ../ is a set in W with volume v(../). To estimate v(../) we cut �n into small cubes, and sum the volumes of those cubes that lie in ../. Under the linear transformation, each such cube is mapped to a parallelepiped whose volume is the volume of the original cube multiplied by ldet(A)I. Thus we see that v(A../) = v(../)l det (A)I for any set ../ for which volume is defined. We are now in a position to extend Theorem 6.20 to arbitrary lattices. 6.4 The Geometry of Numbers 315 Theorem 6.21 Minkowski's Convex Body Theorem for genera/ lattices. Let A be a nonsingular n x n matrix with real elements, and let A = Azn. If -t' is a set in IR n that is convex, symmetric about 0, and if v( -t') > 2nd( A), then there exists a lattice point x e A such that x * 0 and x e -t'. Proof Let -t'' = A - 1-t'. Then -t'' is convex and symmetric about 0. Since det (A - 1) = 1/det (A), it follows that v(-t'') = v(-t')/ ldet(A) I = v(-t')/d( A) > 2 n. Thus by Theorem 6. 19, there exists a point c e -t'' such that c * 0, c E zn. Put X = Ac. Then X has the desired properties. By introducing a limiting argument we now show that the strict inequality v( -t') > 2nd(A) may be replaced by the weak inequality, pro­ vided that we place further restrictions on the set -t'. Corollary 6.22 Let A be a nonsingular n X n matrix with real elements, and let A = Azn. If -t' is a set in IRn that is closed, bounded, convex, symmetric about 0, and if v( -t') � 2nd(A), then there exists a lattice point x E A such that X * 0 and X E -t'. Proof For k = 1, 2,3, · · · let -t'k = (1 + 1/k)-t'. Then v(-t'k) = (1 + 1 /k )n v(-t') > 2nd(A), so that Theorem 6.21 applies to -t'k. Let xk denote a nonzero member of A that lies in -t'k. Since each point in the sequence {xk} lies in the bounded set 2-t', there must be a nonzero point x0 of A such that xk = x0 for infinitely many k. Since x0 E -t'k for infinitely many k, and since -t' is closed, it follows that x0 E -t'. Theorem 6.23 Let A and B be nons in gular n X n matrices, and put A I = Azn, Az = Bzn. Then Az �A I if and only if B is of the form B = AK, where K has integral elements. Proof Put K = A- 1 B, and suppose that K has integral elements. If x has integral coordinates then so also does Kx. That is, Kzn � ?r, and hence Bzn = (AK)zn = A( Kzn) � Azn. Suppose, conversely, that A 2 � A1• Let a1, a2, ·· , an be the columns of A, and b1, b2, · ·, bn be the columns of B. Choose j, 1 � j � n. Since bi e A2 and A2 � A1, it follows from (6.9) that there exist integers k 1i, k2i, · · · , kni such that bi = klia1 + k2i a 2 + · · · +knian. Let K = [k;)· Then B = AK, and K has integral elements. This completes the proof. Corollary 6.24 Let A and B be nonsingular n X n matrices, and put A I = Azn, Az = Bzn. Then A I = Az if and only if there is a unimodular matrix U such that B =A U. 316 Farey Fractions and Irrational Numbers Proof Put K =A - 1B. Since A2 � A 1, it follows from Theorem 6.23 that K has integral elements. Similarly, the relation A 1 � A2 implies that s- 1A = K- 1 has integral elements. Thus by Theorem 5.3, K is a unimod­ ular matrix. In the situation of Corollary 6.24, we have a lattice with two different bases. However, as det (B) = det (AU) = det ( A) det (U ) = ±det (A), we see that the determinant d(A) is independent of the choice of the basis. At the end of Section 5.2 we observed that a matrix K with integral elements may be written in the form K = UDV, where U and V are unimodular and D is diagonal with non-negative integral elements. This has an interesting application to the situation of Theorem 6.23. We suppose that B = AK, K = UDV, and let F =A U, and G = AUD. Then by two applications of Corollary 6.24 we see that A I = rzn, A2 = czn. Let the columns of F be f I' f 2 . ... ' f n ' and let the diagonal elements of D be the integers d1 , d2, · ·, dn . Then the columns of G = FD are d1f1, d2f2> · ·, dnfn. Moreover, since det (K) * 0 it follows that none of the d; vanish, and hence the d; are positive integers. That is, for any sublattice A 2 of a lattice A 1, there is a basis f1,f2> · ·,fn of A 1 and positive integers d1, d2, • ·, dn such that d1f1, d2f2, · ·, dn fn is a basis for A2• The geometry of numbers has many applications concerning rational approximations to real numbers (called Diophantine approximations), to quadratic forms, and to the theory of algebraic numbers. Although we have established only the first results in an extensive theory, we are already in a position to make some interesting applications. We begin by extending Theorem 6.8 to simultaneous approximation. Theorem 6.25 Let x 1, x 2, · · , x k be arbitrary real numbers, and let n be a positive integer. Then there exist integers a 1, a2, · · ·, ak and an integer b, 0 < b ,.;; n, such that lx; - ajbl < 1j(bn11k) for i = 1, 2, · · · , k. Proof Let -G' be the parallelepiped in �k+ 1 that consists of those points (u0, u1, • · ·, uk) for which (6.10) and (6.11) for 1 ,.;; i ,.;; k. Thus -G' is convex and symmetric about 0. To calculate the volume of -G' we observe that u0 lies in an interval of length 2(n + 1), and 6.4 The Geometry of Numbers 317 that for each given value of u0, the other variables uj lie in intervals of length 2jn11k. Thus the volume of �is k v(�) = 2(n + 1)(2jn11k ) = 2k+ 1 ( n + 1 )/n > 2k+ I . (An alternative method for evaluating this volume is indicated in Problem 10 at the end of this section.) Thus by Theorem 6.20 there exist integers u0,u1,· · ·,uk, not all 0, such that the inequalities (6.10), (6.11) hold. For such integers we note that u0 * 0, for if u0 = 0 then (6.11) gives lu;l < n - Ilk ..,;;; 1, which implies that u; = 0 for i = 1, 2, - · · , k, and then all the u; would be 0. If u0 < 0, then we multiply all the u; by -1. Thus we may assume that u0 > 0. The desired result now follows by taking b = u0, a; = u; for 1 ..,;;; i ..,;;; k. Theorem 6.26 Lagrange. Every positive integer n can be expressed as the sum of four squares, n = x� + x� + x� + x�. where the X; are non-negative integers. Fewer than four squares does not suffice, for if n = 7 (mod 8) then the congruence n = x� + x� + x� (mod 8) has no solution. Proof In view of the algebraic identity ( x� + X�+ X�+ xn ( y� + Yi + Y� + y}) we see that if m and n are sums of four squares then so also is mn. Thus it suffices to show that each prime number p is a sum of four squares. To this end let 0 p 0 0 r s 1 0 where r and s are chosen so that r2 + s2 + 1 = 0 (mod p ). The existence of such integers is assured by Theorem 5.14. Let A= AZ\\ and suppose that x =At is a point of A. Writing t = (t I> t2, t3, t4), x = (x1, x2, x3, x4), 318 Farey Fractions and Irrational Numbers we see that if x E A then = O (mod p ) . We observe that d(A) = p2• Let -If' be the ball in IR4 consisting of those points (x 1, x2, x3, x4) such that x� +xi+ x� + xl < 2p. Thus -If' is con­ vex and symmetric about 0. A ball of radius R in IR4 has volume t'7T2R4• An unimaginative proof of this may be given by using rectangular coordi­ nates to express the volume as an iterated integral, and then evaluating this using standard techniques. An elegant, but less obvious, method of determining the volumes and surface areas of balls iS sketched in Problem 23 at the end of this section. Taking R = {2P, we see that v(-tf') = !-'7T2(2p)2 = 2'7T2p2 > 24p2. Thus by Theorem 6.21 there is a point x = (x1 , x2, x3, x4) such that x -=F 0 and x E -If'. Then 0 < x� + 2 2 2 2 d 2 2 2 2 - 0( d ) d h 2 x2 + x3 + x4 < p, an x 1 + x2 + x3 + x4 = mo p, an ence x1 + xi + x� + xl = p. This completes the proof. In Theorem 6.26, some of the squares used to represent a positive integer n may be 0. In case it is desired to express n as a sum of positive squares, we have the following result. Corollary 6.27 There exist infinitely many positive integers that cannot be written as a sum of four positive perfect squares, but every integer n > 169 is a sum of five positive perfect squares. Proof We first note that we may restrict our attention to representations n = x� + xi + x� + xl for which (6.12) Next we observe that if x� +xi + xj + xl = O(mod 8) then all the X; are even. Hence if 8n = x� +xi + x� + xl then 2n = (x1/2)2 + (x2j2)2 + 6.4 The Geometry of Numbers 319 (x3/2)2 + (x4/2)2• Conversely, if 2n = x� + x� + x� + x�, then 8n = (2x1)2 + (2x2)2 + (2x3)2 + (2x4)2. Thus the representations of 2n and of 8n are in one-to-one correspondence. The only representation of 2 as a sum of four squares subject to (6.12) is 2 = 12 + 12 + 02 + 02. Hence the only representation of 8 as a sum of four squares, subject to (6.12), is 8 = 22 + 22 + 02 + 02• Relating the representations of 8 as a sum of four squares to those of 32, we deduce that the only representation of 32 as a sum of four squares is 32 = 42 + 42 + 02 + 02• Continuing in this manner, we find that the only representation of 22'+ 1 as a sum of four squares, subject to (6.12), is 22'+ 1 = (2')2 + (2')2 + 02 + 02. Hence 22'+ 1 cannot be written as a sum of four positive perfect squares. Suppose now that n > 169. We write n - 169 as a sum of four squares, and suppose that (6.12) holds, so that If the xj are all positive then we write 169 = 132, and then n is the sum of five positive perfect squares. If x1 � x2 � x3 > 0, x4 = 0 then we write 169 = 52 + 122, SO that n = 52 + 122 +X� +X� +X�. If X1 � X2 > 0 but x3 = x4 = 0, then we write 169 = 122 + 42 + 32, so that n = 122 + 42 + 32 + x� + x�. If x1 > 0 but x2 = x3 = x4 = 0 then we write 169 = 102 + 82 + 22 + 12, so that n = 102 + 82 + 22 + 12 + xr In each of these cases, n is represented as a sum of five positive perfect squares. PROBLEMS 1. Construct a set -G' in the plane that is convex, symmetric about 0, and has area 4, but contains no nonzero integral point. 2. Construct a set -G' in the plane that is convex and has infinite area, but contains no integral point. 3. Let Jl? be the set of points (x1, x2) in the plane such that lx: - 2x� l < 1. Sketch Jl?. Show that Jl? is symmetric about 0, that Jl? has infinite area, but that Jl? contains no nonzero integral point. 4. Let x 1 and x2 be arbitrary real numbers, and let n be an arbitrary positive integer. Show that there exist integers a 1, a2, b such that 0 < b � n and (x1 - a 1jb)2 + (x2 - a2jb)2 � 4/(7Tnb2). 5. Let x1 and x2 be arbitrary real numbers, and let n be an arbitrary positive integer. Show that there exist integers a 1, a2, b such that la 1 1 � n, la2 1 � n, and la1x1 + a2x2 + bl < 1/n2, with not both a 1 = 0 and a2 = 0. 320 Farey Fractions and Irrational Numbers 6. Show that if a � O(mod p), p prime, and if n is any positive integer, then there exist integers x and y such that x = ay (mod p ), 0 < x � n, ly l � pjn. 7. A point x of a set � in the plane is called an interior point of � if there is an r > 0 such that � contains all points within a distance r of x. Show that if � is convex and contains no interior point then � is a subset of a line. 8. Show that if � is convex, symmetric about 0, and if � contains an interior point, then 0 is an interior point of �. 9. Show that if � is convex, unbounded, and contains an interior point, then v( �) = + oc. (Thus the hypothesis in Corollary 6.22 that � be bounded is superfluous.) 10. Let � be as in the proof of Theorem 6.25. Construct a (k + 1) X (k + 1) matrix A such that � = A�· where �, is the cube consisting of those points (t0, t1,- · ·, tk) of IR! k + I for which lt;l < 1. Calculate v( �') and det (A), and thus give a second derivation of the value of v(�). 11. Let p be a prime number, p = 1 (mod 4), and choose a so that a 2 = -l (mod p). Put A = AZ2 where A = [ � � ]. Show that if (x, y) is a point of A then x2 + y2 = O(mod p). Show that A con­ tains a nonzero point (x, y) for which x2 + y 2 < 2p. Deduce that p can be represented as a sum of two squares. (This provides an alternative proof of Lemma 2.13.) 12. Let a, b, c be real numbers with a > 0. Put d = b2 - 4ac, and suppose that d < 0. Show that there exist integers x, y, not both 0, 2 such that lax2 + b.xy + cy2 l � - � . 7T' 13. Show that any lattice A in the plane contains a nonzero point (x, y) 4 such that x2 + y 2 � -d(A). 7T' 14. Show that any lattice A in the plane contains a nonzero point (x, y) such that l.xy l � id(A). (H) 15. Let ./ be a set in IR! n with volume v(./). For each x E �(0), let f(x) denote the number of k E zn for which k + X E ./. Show that J f(x) dx = v( ./) . �(0) 16. Let r be a positive integer, and suppose that ./ is a set in IR! n for which v(./) > r. Show that there exist r + 1 distinct points S o, s1, • • · , S, of ./ SUCh that S; - Sj E zn for 0 � i � j � r. 6. 4 The Geometry of Numbers 321 17. Let c = (c1, c2 , ··· , en) be a row vector with integral coordinates, and put g = g.c.d. (c t> c2 , . ·· ,en). Show that there is a unimodular matrix U such that cU = (g, 0, o, . · ·, 0). (H) *18. Say that an integer n has the property Pk if n can be expressed as a sum of k positive squares. For any given m, prove that there exist infinitely many integers having all the properties P1 , P2 , . · ·, Pm . *19. Let b = (b 1, b2 , . · ·, bn) be a row vector with integral coordinates, and g.c.d.(b 1, b2, · · ·, bn ) = 1. Let A = Azn where A has integral elements. Let a 1, a 2 , . • ·, a n denote the columns of A, and put g = g.c.d.(ba 1, ba 2 , . ·· ,ba n). Show that if x E A then glbx, and that there is an x e A such that bx = g. Show that there is a basis f1,f2 , . · ·, fn of A such that b/1 = g, bf; = 0 for i> 1. *20. Let b = (b 1, b2 , · · ·, bn) be a row vector with integral coordinates, and g.c.d.(b 1 , b2 , . · · , bn) = 1. Let A 1 = Azn, where A has integral elements. Let a 1 , a 2 , ··· ,an denote the columns of A, and put g = g.c.d.(ba 1, ba 2 , . ·· ,ba n ). Let m be a positive integer, and put A 2 = {x e A 1 : bx = 0 (mod m)}. Show that A2 is a lattice, and that d(A 2) = d(A 1 )m j(g, m). *21. Suppose that A 2 is a sublattice of A 1 . For x, y e A 1 we say that x = y(mod A 2) if x- y e A 2 . Show that this defines an equivalence relation that partitions A 1 into precisely d(A 2)/d(A 1 ) equivalence classes. *22. Let A be a set in !Rn with the following properties: (i) A is an additive group; (ii) A is not contained in any proper subspace of !Rn; (iii) There is an r > 0 such that x e A, lxl < r implies that x = 0. Show that A is a lattice. *23. Let �n(r) denote a ball of radius r in !Rn. (a) Show that v( �n(r)) = vnrn for some constant vn . (b) For a set ../� zn let la../1 denote the surface area of ../ (i.e., the (n - I)-dimensional content of the boundary). Show that la�n(r) l = snrn-t for some constant sn. (c) d Show that dr v(�n(r)) = la�/r) l. Deduce that sn =nun. (d) Show that (e) For s > 0 put r(s) = {\"'xs-te-xdx. (This is Euler's integral for the gamma function.) Show that if a > -1 /2 then fo \"\" rae-'2 dr (a + 1) { 2 = �r - 2 - . (f) Show that JIR.e-1x1 dx = f0 /2)n. (g) Deduce 322 Farey Fractions and Irrational Numbers that sn = 2f(l /2)n /f<n/2). (h) Use integration by parts to show that if s > 0 then sr(s) = r(s + 1). Show that r(l) = 1. Use induc­ tion to show that r(n) = (n - 1)!. (i) From the known value s2 = 21T, deduce that f(l/2) = fi, and by induction that r( 2m2 + 1 ) = .fi 1 . 3 . ... . (2m - 1) /2m = .fi (2m) !/(22mm!). (j) Show that s2m = 21Tm j(m - 1)!, v2m = 1Tm jm ! for m = 1, 2,3, ... . (k) Show that S2m + l = 22m+ I 1Tmm!j(2 m)!, v2m + l = 22m + t 1Tmm!j(2m + 1)! for m = 1, 2, 3, · · · . NOTES ON CHAPTER 6 §6.2 A second proof of Hurwitz's theorem (Theorem 6.11) is given in the next chapter, using continued fractions (see Theorem 7.17). §6.3 The proof of Theorem 6. 16 follows that of A. E. Maier, \"On the Irrationality of Certain Trigonometrical Numbers,\" Amer. Math. Monthly 72, (1962), 1012. Further results on the topic of this section can be found in the book by Niven listed in the General References. §6.4 The geometry of numbers was initiated and named by Hermann Minkowski (1864- 1909), who published a book on the subject in 1894. Minkowski's fruitful work was cut short by his untimely death. Theorems 6.20 and 6.21 give two formulations of Minkowski's first theorem concern­ ing convex bodies. Blichfeldt's principle, which provides an elegant path to Minkowski's first theorem, was discovered by H. F. Blichfeldt in 1914. Detailed accounts of the subject are found in the books by Cassels and also in the book by Gruber and Lekkerkerker listed in the General References. One may also consult the interesting book of J. Hammer, Unsolved Problems Concerning Lattice Points, Pitman (London), 1977. Theorem 6.25 is due to Dirichlet. By this theorem we see that there is a number b such that each of the numbers bx; is near an integer. More generally, for given real numbers a ; one may ask whether there is an integer b such that each of the numbers bx; + a ; is near an integer. The precise conditions that ensure the existence of such b were determined by Kronecker. For a simple proof of Kronecker's theorem, see Ka-Lam Kueh, \"A note on Kronecker's approximation theorem,\" Amer. Math. Monthly, 93 (1986), 555-556. The first known proof of Theorem 6.26 was given in 1770 by Lagrange, though it had been stated earlier without proof, and Fermat had once claimed to have a proof by descent. Our exposition follows that of H. Davenport, \"The geometry of numbers,\" Math. Gazette 31 (1947), Notes on Chapter 6 323 206-207. In 1828, Jacobi showed that if n is a positive integer then the number of ordered quadruples (x 1 , x2 , x3, x4) of integers for which n = x� + x� + x� + x� is 8 times the sum of those positive divisors d of n for which 4% d. G. Rousseau, \"On a construction for the representation of a positive integer as a sum of four squares,\" L' Enseign. Math. 33 (1987), 301-306, has formulated an efficient calculational procedure that provides an explicit representation of n as a sum of four squares. The method involves extending the continued fraction process to Gaussian integers. The observation that if n = 7 (mod 8) then n is not the sum of three squares can be extended to show that if n is of the form 4a(8k + 7) then n is not a sum of three squares. In 1798, Legendre outlined a proof that all other numbers are sums of three squares, and he supported his arguments with numerical evidence. Legendre later constructed a proof in the man­ ner he had described, but in the meantime Gauss had proved a much more precise formula for the number of primitive representations of n as a sum of three squares, in 1801. From Gauss's formula it is at once evident that n is a sum of three squares if and only if n is not of the form 4a(8k + 7). A short proof of Gauss's three squares theorem is given in the book of Serre, and other proofs are found in the book of Grosswald. Further proofs are discussed by C. Small, \"Sums of three squares and levels of quadratic number fields,\" Amer. Math. Monthly 93 (1986), 276-279. Additional historical details are found in the book of Weil, as well as an elegant proof discovered in 1912 by L. Aubry that if a positive integer n is a sum of three rational squares then it is the sum of three integral squares. In 1770, Edward Waring asserted without proof that every positive integer is a sum of nine cubes, is also a sum of 19 fourth powers, and so on. Thus Waring's problem was first interpreted as the question whether for each positive integer k there is an integer s(k) such that every natural number is a sum of at most s(k) positive kth powers. The answer is yes. This was established first for several special values of k, and in 1909 D. Hilbert solved the problem in general, using a family of complicated algebraic identities. Once Hilbert had shown the existence of s(k), attention then turned to the problem of estimating s(k) and, if possible, of finding the least positive value of s(k), traditionally denoted by g(k). (For example, Theo­ rem 6.26 and the remark following imply that g(2) = 4.) In the 1920s, G. H. Hardy and J. E. Littlewood developed an analytic method, sharp­ ened later by I. M. Vinogradov, which gives asymptotic estimates for the number of representations. A simplified account of Hilbert's proof, and an elementary description of the analytic approach is found in the paper of W. J. Ellison, \"Waring's problem,\" Amer. Math. Monthly (1971), 78, 10-36; see also C. Small, \"Waring's problem,\" Math. Mag. 50 (1977), 324 Farey Fractions and Irrational Numbers 12- 16. The asymptotic analysis involves a number of technical problems, which are fully discussed by R. C. Vaughan in The Hardy-Littlewood Method, Cambridge Tracts 80, Cambridge University Press (Cambridge, UK), 1981. Another fundamental number, G(k ), is defined to be the least positive integer such that every sufficiently large natural number is a sum of at most G(k) positive kth powers. For example, although g(3) = 9, no integers other than 23 and 239 require as many as 9 cubes in their representations, and only a finite number of integers require 8 cubes, so that G(3) � 7. Details about the values of, or bounds on, g(k) and G(k) are given in Ribenboim (1989). CHAPTER 7 Simple Continued Fractions The following example illustrates the power of the theory of this chapter: the smallest solution of x2 - 61 y 2 = 1 in positive integers, which can be used to generate all solutions, has a value of x exceeding 109• This solution is easily calculated in Problem 10 of Section 7.8. Speaking more generally, continued fractions provide another representation of real num­ bers, offering insights that are not revealed by the decimal representation. 7.1 THE EUCLIDEAN ALGORITHM Given any rational fraction u0ju1, in lowest terms so that (u0, u 1) = 1 and u 1 > 0, we apply the Euclidean algorithm as formulated in Theorem 1.11 to get (7.1) The notation has been altered from that of Theorem 1.11 by the replace­ ment of b, c by u0,u 1, of r\"r2 ,·· , ri by u2,u3,·· ,ui+ l• and of q 1 , q2 , • ·, qi+ l by a0, a\" · ·· , ai. The form (7.1) is a little more suitable for our present purposes. If we write �; in place of u Ju; + 1 for all values of i 325 326 Simple Continued Fractions in the range 0 � i � j, then equations (7.1) become 1 �i = a; + -- , �i+ l O � i � j- 1 ; (7.2) If we take the first two of these equations, those for which i = 0 and i = 1, and eliminate �1, we get 1 �o = ao + ---:-1- . a+ -t �2 In this result we replace �2 by its value from (7.2), and then we continue with the replacement of �3, �4, • • · , to get u0 1 - =�o = ao + -­ut at + 1 + ----::1� \" aj- t + ­aj (7.3) This is a continued fraction expansion of �0, or of u0ju 1• The integers a; are called the partial quotients since they are the quotients in the repeated application of the division algorithm in equations (7. 1). We presumed that the rational fraction u0ju 1 had positive denominator up but we cannot make a similar assumption about u0• Hence a0 may be positive, negative, or zero. However, since 0 < u2 < u1, we note that the quotient a 1 is positive, and similarly the subsequent quotients a2, a3, • • · , ai are positive integers. In case j � 1, that is if the set (7.1) contains more than one equation, then ai = ujjui+ t and 0 < ui+ l < ui imply that ai > 1. We shall use the notation ( a0, a1, • · , ai) to designate the continued fraction in (7.3). In general, if x0, x1, • · , xj are any real numbers, all positive except perhaps x0, we shall write 1 + ------:1:- . 7.2 Uniqueness 327 Such a finite continued fraction is said to be simple if all the X; are integers. The following obvious formulas are often useful: The symbol [x0, x1,- ·· ,xi] is often used to represent a continued fraction. We use the notation (x0, x1, - • · , x) to avoid confusion with the least common multiple and the greatest integer. PROBLEMS 1. Expand the rational fractions 17/3, 3/ 17, and 8/1 into finite simple continued fractions. 2. Prove that the set (7.1) consists of exactly one equation if and only if u1 = 1. Under what circumstances is a0 = 0? 3. Convert into rational numbers: (2, 1, 4); ( - 3, 2, 12); (0, 1, 1, 100). 4. Given positive integers b, c, d with c > d, prove that ( a, c) < ( a, d) but ( a , b, c) > ( a, b, d) for any integer a. 5. Let a I > a2 , - · · , an and c be positive real numbers. Prove that holds if n is odd, but is false if n is even. 7.2 UNIQUENESS In the last section we saw that such a fraction as 51 /22 can be expanded into a simple continued fraction, 51 /22 = (2, 3, 7). It can be verified that 51 /22 can also be expressed as (2, 3, 6, 1), but it turns out that these are the only two representations of 51 /22. In general, we note that the simple continued fraction expansion (7.3) has an alternate form, 328 Simple Continued Fractions The following result establishes that these are the only two simple contin­ ued fraction expansions of a fixed rational number. Theorem 7.1 If (a0, a1, . · · ,a)= ( b0, b 1, . • ·, bn ) where these finite con­ tinued fractions are simple, and if ai > 1 and bn > 1, then j = n and a;= b; for i = 0, 1, . · ·, n. Proof We write Y; for the continued fraction (b;, b;+ 1, . • ·, bn ) and ob­ serve that 1 1 Y; = (b;, bi+ l , . · ·,bn ) = b; + ( b. b. . .. b ) = b; + - . (7.5 ) • + I • • + 2 • • n Yi+ l Thus we have Y; > b; and Y; > 1 for i = 1, 2, · · ·, n - 1, and Yn = bn > 1 . Consequently b; = [ Y;] for all values of i in the range 0 :,.;; i :,.;; n. The hypothesis that the continued fractions are equal can be written in the form y0 = �0, where we are using the notation of equation (7.3). Now the definition of �; as u ;/u;+ 1 implies that �i+ 1 > 1 for all values of i � 0, and so a; = [�;] for 0 :,.;; i :,.;; j by equations (7.2). It follows from Yo = �0 that, taking integral parts, b0 = [y0] = [�0] = a0• By equations (7.2) and (7.5) we get This gives us the start of a proof by mathematical induction. We now establish that �; = Y; and a; = b; imply that �i+ l = Yi+ l and ai+ l = bi+ l· To see this, we again use equations (7.2) and (7.5) to write 1 1 -- = �; - a; = Y; - b; = -- , �i+ l Yi+ l It must also follow that the continued fractions have the same length, that is, that j = n. For suppose that, say, j < n. From the preceding argument we have �i = yi, ai = bi. But �i = ai by (7.2) and Yi > bi by (7.5), and so we have a contradiction. If we had assumed j > n, a symmetrical contradiction would have arisen, and thus j must equal n, and the theorem is proved. 7.3 Infinite Continued Fractions 329 Theorem 7.2 Any finite simple continued fraction represents a rational number. Conversely, any rational number can be expressed as a finite simple continued fraction, and in exactly two ways. Proof The first assertion can be established by mathematical induction on the number of terms in the continued fraction, by use of the formula The second assertion follows from the development of u0ju 1 into a finite simple continued fraction in Section 7. 1, together with equation (7.4) and Theorem 7.1. PROBLEM 1. Let a0, a\" · ·· , an and b0, b\" · · ·, bn + 1 be positive integers. State the conditions for 7.3 INFINITE CONTINUED FRACTIONS Let a0, a1, a2, • · • be an infinite sequence of integers, all positive except perhaps a0• We define two sequences of integers {hn} and {kn} inductively as follows: k_ 2 = 1, k_ 1 = O, k; = a;k;_ 1 + k; _ 2 for i ;;;;. 0. {7 .6) We note that k0 = 1, k1 = a1k0 ;;;;. k0, k2 > k1, k3 > k2, etc., so that 1 = k0 � k1 < k2 < k3 < · · · < kn < · · · . Theorem 7.3 For any positive real number x, xhn- 1 + hn- 2 (a0 ,a \" · · ·,an _ 1 ,x ) = -----­ xkn- 1 + kn- 2 Proof If n = 0, the result is to be interpreted as xh _ 1 + h_2 X = -----=- xk _ 1 + k_ 2 7.3 Infinite Continued Fractions 33 1 Again we use equations (7.6) to get h;k;_ 1 - h;_ 1 k; = (a;h;_ 1 + h;_ 2) k i-1 - h; - l(a;k;-1 + k;- 2) = - (h; - t k i- 2 - h;-2 ki-1) = (- l)i - 1. This proves the first result stated in the theorem. We divide by k; _ 1 k; to get the second result, the formula for r; - r; _ 1. Furthermore, the fraction h;/k; is in lowest terms since any factor of h; and k; is also a factor of ( -l)i-1. The other formulas can be derived in much the same way from (7.6), although we do not need induction in this case. First we observe that h0k_ 2 - h_ 2k0 = a0, and that in general h;k;_ 2 - h; _2 k; = (a;h;_ 1 + h;_2) k;_ 2 - h;_ 2(a;k;_ 1 + k;_2 ) = a;(h;_ 1k;_2 - h;_ 2k;_ 1 ) = ( -l)'·a;. The final identity can be obtained by dividing by k;_ 2 k;. Theorem 7.6 The values r n defined in Theorem 7.4 satisfy the infinite chain of inequalities r0 < r2 < r4 < r6 < · · · < r7 < r5 < r3 < r1• Stated in words, the r n with even subscripts fonn an increasing sequence, those with odd subscripts fonn a decreasing sequence, and every r2n is less than every r2i_ 1• Furthennore, limn ._. oo r n exists, and for every j � 0, r 2i < lim n .... oo r n < r 2i + 1. Proof The identities of Theorem 7.5 for r; - r; _ 1 and r; - r;_ 2 imply that r2i < r2i+2, r2i- l > r2i+ l• and r2i < r2i- l because the k; are positive for i � 0 and the a; are positive for i � 1. Thus we have r0 < r2 < r4 < · · · and r1 > r3 > r5 > ·· ·.To prove that r2n < r2i_ 1, we put the previous results together in the form r 2n < r 2n + 2j < r 2n + 2j- I � r 2j- I · The sequence r0, r2, r4, · · • is monotonically increasing and is bounded above by r1, and so has a limit. Analogously, the sequence rp r3, r5, • • • is monotonically decreasing and is bounded below by r 0, and so has a limit. These two limits are equal because, by Theorem 7.5, the difference r; - r;_ 1 tends to zero as i tends to infinity, since the integers k; are increasing with i. Another way of looking at this is to observe that (r0, r1 ), (r2, r3), (r4, r5), • • · is a chain of nested intervals defining a real number, namely lim n-+ oo rn . These theorems suggest the following definition. Definition 7.1 An infinite sequence a0, ap a2, · · · of integers, all positive except perhaps for a0, detennines an infinite simple continued fraction ( a0, ap a2, · · · ). The value of (a0, ap a2, · · · ) is defined to be lim n -+ 00 < ao, ap a2, . .. ' an ). This limit, being the same as limn ._.00 rn, exists by Theorem 7.6. Another way of writing this limit is lim n ._.00 hn/kn. The rational number 332 Simple Continued Fractions (a0, a1, - ·· ,an ) = hn/kn = rn is called the nth convergent to the infinite continued fraction. We say that the infinite continued fraction converges to the value lim n .... ,., rn. In the case of a finite simple continued fraction (a0, a1, .. · , an ) we similarly call the number (a0, a1, - · · ,am) the mth convergent to (a0, a 1, . .. ,an >· Theorem 7.7 The value of any infinite simple continued fraction (a0, a 1, a2, · · · ) is irrational. Proof Writing 8 for ( a0, a1, a2, · ·· ) we observe by Theorem 7.6 that 8 lies between rn and rn+ l• so that 0 < 1 8- rn l < lrn + l - rn l · Multiplying by kn, and making use of the result from Theorem 7.5 that lrn+ I - rn l (knkn+ l )- 1, we have 1 0 < lkn8- hn l < -k - . n + l Now suppose that 8 were rational, say 8 = a jb with integers a and b, b > 0. Then the above inequality would become, upon multiplication by b, The integers kn increase with n, so we could choose n sufficiently large so that b < k n + 1 • Then the integer I k n a - h n b I would lie between o and 1, which is impossible. Suppose we have two different infinite simple continued fractions, ( a0, a1, a2, • • • ) and ( b0, b 1, b2, • • • ). Can these converge to the same value? The answer is no, and we establish this in the next two results. Lemma 7.8 Let 8 = ( a0, a 1, a 2, • • • ) be a simple continued fraction. Then a0 = [8]. Furthennore if 8 1 denotes (ap a2, a3, · · · ) then 8 = a0 + 1/8 1' Proof By Theorem 7.6 we see that r0 < 8 < rp that is a0 < 8 < a0 + 1jal' Now a 1 � 1, so we have a0 < 8 < a0 + 1, and hence a0 = [8]. Also 1 1 = ao + = ao + - . lim (a1 , .. · , an ) 81 n -+oo 7.3 Infinite Continued Fractions 333 Theorem 7.9 Two distinct infinite simple continued fractions converge to different values. Proof Let us suppose that ( a0, a,, a2 , • • · ) = (b0, b,, b2 , • • · ) = 8. Then by Lemma 7.8, [8] = a0 = b0 and Hence (a,, a 2, • • · ) = (b 1 , b2 , • · • ). Repetition of the argument gives a 1 = b 1, and so by mathematical induction an = bn for all n. PROBLEMS 1. Evaluate the infinite continued fraction (1, 1, 1, 1, · · · ). (H) 2. Evaluate the infinite continued fractions (2, 1, 1, 1, 1, · · · ) and (2, 3, 1, 1, 1, 1, · · · ). (H) 3. Evaluate the infinite continued fractions: (a) (2, 2, 2, 2, · · · ); (b ) (1, 2, 1, 2, 1, 2, · · · ); (c) (2, 1, 2, 1, 2, 1 , · · · ); (d) (1, 3, 1, 2, 1, 2, 1, 2, · · · ). 4. For n � 1, prove that kn/kn -t = ( an , an _ ,, .. ,a 2 ,a 1 ). Find and prove a similar continued fraction expansion for hnfhn - t• assuming a0 > 0. 5. Let u0ju 1 be a rational number in lowest terms, and write u0ju 1 = (a0, a ,, ·· , an > · Show that if 0 � i < n, then lr; - u0ju 1 1 � 1j(k;k; + 1 ), with equality if and only if i = n - 1 . 6. Let p be a prime number, p = 1 (mod 4), and suppose that u 2 . = - 1 (mod p ). (A quick method for finding such a u is described in Section 2.9., in the remarks preceding Theorem 2.45.) Write ujp = ( a0, a,, · · , an ), and let i be the largest integer such that k; � {iJ. Show that lh;/k; - ujpl < 1/(k;{iJ), and hence that lh;P - uk; l < {P. Put x = k;, y = h;P - uk;. Show that 0 < x 2 + y 2 < 2p, and that x 2 + y 2 = O(mod p). Deduce that x 2 + y 2 = p. (This method was given in 1848 by Ch. Hermite. An even simpler procedure, which depends on the Euclidean algorithm, is discussed by S. Wagon, \"The Euclidean algorithm strikes again,\" Amer. Math. Monthly, 97 (1990), 125-129.) 334 Simple Continued Fractions 7.4 IRRATIONAL NUMBERS We have shown that any infinite simple continued fraction represents an irrational number. Conversely, if we begin with an irrational number �. or �0, we can expand it into an infinite simple continued fraction. To do this we define a0 = [�0], �1 = 1/(�0- a0), and next a 1 = [� 1 ], �2 = 1/ (� 1 - a 1), and so by an inductive definition 1 �i + l = c. - a . . !.z r (7.7) The a; are integers by definition, and the �; are all irrational since the irrationality of �1 is implied by that of �0, that of �2 by that of � 1, and so on. Furthermore, a; � 1 for i� 1 because a;_ 1 = [�;- 1 ] and the fact that �; _ 1 is irrational implies that Next we use repeated application of (7.7) in the form �; = a ;+ 1/�i+ t to get the chain This suggests, but does not establish, that � is the value of the infinite continued fraction (a0, a 1, a2 , ··· ) determined by the integers a;. To prove this we use Theorem 7.3 to write 7.4 Irrational Numbers with the h; and k; defined as in (7.6). By Theorem 7.5 we get -( hn - lkn - 2 - hn- 2kn - 1 ) kn- l(gnkn - 1 + kn -2 ) ( -1) n - l 335 (7.9) This fraction tends to zero as n tends to infinity because the integers kn are increasing with n, and �n is positive. Hence � - rn _ 1 tends to zero as n tends to infinity and then, by Definition 7. 1, � = lim rn = lim ( ao ,ap ·· · , an ) = ( a0 ,al > a2 , · · · ) . n -+oo n -+oo We summarize the results of the last two sections in the following theorem. Theorem 7.10 Any irrational number � is uniquely expressible, by the procedure that gave equations (7.7), as an infinite simple continued fraction (a0, at> a2, • • • ) . Conversely, any such continued fraction determined by integers a; that are positive for all i > 0 represents an irrational number, �. The finite simple continued fraction ( a0, a,, . · ·, an ) has the rational value hn/kn = rn, and is called the nth convergent to �- Equations (7.6) relate the h; and k; to the a;. For n = 0, 2, 4, · · · these convergents form a monotoni­ cally increasing sequence with � as a limit. Similarly, for n = 1, 3, 5, · · · the convergents form a monotonically decreasing sequence tending to �· The denominators kn of the convergents are an increasing sequence of positive integers for n > 0. Finally, with �; defined by (7.7), we have ( a0, a 1, · · · ) = (ao,a, , . . ·, an - l• �n > and �n = (an,an + l> an +2' . .. ). Proof Only the last equation is new, and it becomes obvious if we apply to �n the process described at the opening of this section. Example 1 Expand /5 as an infinite simple continued fraction. Solution We see that /5 = 2 + ( /5 - 2) = 2 + 1/ ( /5 + 2) and /5 + 2 = 4 + ( /5-2) = 4 + 1/( /5 + 2) . 336 Simple Continued Fractions In view of the repetition of 1 j( /5 + 2), it follows that /5 = (2, 4, 4, 4, . .. ) . PROBLEMS 1. EE>and each of the followin_g_ as infinite simple continued fractions: ..;2 , fi - 1, fi ;2, 13, 11 v'3 . 2. Given that two irrational numbers have identical convergents h0jk0, h 1jkp · · · , up to hnlkn, prove that their continued fraction expansions are identical up to an. 3. Let a, {3, y be irrational numbers satisfying a < {3 < y. If a and y have identical convergents h0jk0, h 1jk t> • • ·, up to hnfkn, prove that {3 also has these same convergents up to hn/kn. 4. Let g be an irrational number with continued fraction expansion (a0, a1, a2, a3, · · · ) . Let bp b2, b3, · · • be any finite or infinite se­ quence of positive integers. Prove that lim ( a0 , a 1 ,a2 , . ·· ,an ,b 1 , b2 ,b3, · ·· )= g. n-+ oo 5. In the notation used in the text, prove that *6. Prove that for n ;;;. 1, 7. Prove that 7.5 APPROXIMATIONS TO IRRATIONAL NUMBERS Continuing to use the notation of the preceding sections, we now show that the convergents hnlkn form a sequence of \"best\" rational approxi­ mations to the irrational number g. Theorem 7.11 We have for any n ;;;. 0, and 7.5 Approximations to Irrational Numbers 337 Proof The second inequality follows from the first by multiplication by kn. By (7.9) and (7.7) we see that Using (7.6), we replace an +tkn + kn - t by kn + t to obtain the first inequal­ ity. Theorem 7.12 The convergents hnlkn are successively closer to g, that is Jn fact the stronger inequality l gkn -hn l < l gkn - t - hn - tl holds. Proof To see that the second inequality is stronger in that it implies the first, We USe k n _ 1 � k n tO Write I hn I 1 1 /:- - = - 1 /:k - hI< - 1 /:k - h I !:> k k !:> n n k !:> n - t n - t n n n Now to prove the stronger inequality we observe that an + 1 > gn by (7.7), and so by (7.6), This inequality and (7.9) imply that We multiply by kn - t and use Theorem 7. 11 to get 1 lgkn - l - hn - t l > -k - > l gkn - hnl • n + l 338 Simple Continued Fractions The convergent hnlkn is the best approximation to g of all the rational fractions with denominator kn or less. The following theorem states this in a different way. Theorem 7.13 If ajb is a rational number with positive denominator such that lg - ajb l < lg - hn/kn l for some n � 1, then b > kn. In fact if l gb - al < l gkn - hn l for some n � 0, then b � kn + l' Proof First we show that the second part of the theorem implies the first. Suppose that the first part is false so that there is an a jb with The product of these inequalities gives I g b - a I < I g k n - h n 1. But the second part of the theorem says that this implies b � k n + 1, so we have a COntradiction, Since k n < k n + 1 for n � 1. To prove the second part of the theorem we proceed again by indirect argument, assuming that l gb- al < lgkn- hn l and b < kn + l' Consider the linear equations in x and y, The determinant of coefficients is ± 1 by Theorem 7.5, and consequently these equations have an integral solution x, y. Moreover, neither x nor y is zero. For if x = 0 then b = yk n + I> which implies that y * 0, in fact that y > 0 and b � kn + t> in contradiction to b < kn + l· If y = 0 then a= xhn, b = xkn, and since lx l � 1, and again we have a contradiction. Next we prove that x and y have opposite signs. First, if y < 0, then xkn = b- ykn + l shows that x > 0. Second, if y > 0, then b < kn + l implies that b < ykn + l and so xkn is negative, whence x < 0. Now it follows from Theorem 7.10 that gkn - hn and gkn + l - hn + l have oppo­ site signs, and hence x(gkn - hn) and y(gkn + l - hn + l ) have the same sign. From the equations defining x and y we get gb - a = x(gkn - hn) + y(gkn + l - hn + 1). Since the two terms on the right have the same sign, the 7. 5 Approximations to Irrational Numbers 339 absolute value of the whole equals the sum of the separate absolute values. Thus l�b- al =ix(gkn - hn ) + y(gkn+ ! - hn + ! ) i =jx(gkn - hn) l +j y (gkn+ ! - hn + ! )j > jx(gkn - hn) I= lx l l�kn - hn l � l�kn - hn l · This is a contradiction, and so the theorem is established. Theorem 7.14 Let � denote any irrational number. If there is a rational number a I b with b � 1 such that 1�- �I < 2:2 then a 1 b equals one of the convergents of the simple continued fraction expansion of f Proof It suffices to prove the result in the case (a, b) = 1. Let the convergents of the simple continued fraction expansion of � be hJkj, and suppose that alb is not a convergent. The inequalities kn � b < kn + l determine an integer n. For this n, the inequality l�b - a I < l�kn - hn I is impossible because of Theorem 7. 13. Therefore we have Using the facts that alb i= hnlkn and that bhn - akn is an integer, we find that 1 - .s:: bk \"\"' n This implies b < kn which is a contradiction. Theorem 7.15 The nth convergent of 11x is the reciprocal of the (n - 1)st convergent of x if x is any real number > 1. 340 Simple Continued Fractions Proof We have x = (a0, a 1, · · · ) and 1jx = (0, a0, a , , · ·· ). If hn/kn and h�jk� are the convergents for x and 1jx, respectively, then h'o = 0, h', = 1, k0 = 1, ko = 1, k; = a o , ho = ao, h� = a 1, k 1 = a 1, k� = a0a 1 + 1, h 1 = a0a 1 + 1, h� = an _ 1h� - l + h� _2 kn - 1 = an - lkn -2 + kn -3 k� = an_ 1k� - l + k� _2 hn - 1 = an - lhn -2 + hn -3· The theorem now follows by mathematical induction. PROBLEMS 1. Prove that the first assertion in Theorem 7.13 holds in case n = 0 if k, > 1. 2. Prove that the first assertion in Theorem 7.13 becomes false if b > kn is replaced by b � kn + t· (H) 3. Say that a rational number a jb with b > 0 is a \"good approximation\" to the irrational number g if lgb - ai min lgy - xi , all x O< y.,;b where, as indicated, the minimum on the right is to be taken over all integers x and all y satisfying 0 < y �b. Prove that every convergent to g is a \"good approximation.\" 4. Prove that every \"good approximation\" to g is a convergent. •s. (a) Prove that if rjs lies between ajb and cjd, where the denomina­ tors of these rational fractions are positive, and if ad - be = ± 1, then s >bands> d. (b) Let g be an irrational with convergents {hn/kn}. Prove that the sequence hn -1 hn -1 + hn hn - 1 + 2hn kn -1 ' kn - 1 + kn ' kn -1 + 2kn ' is increasing if n is odd, decreasing if n is even. If ajb and cjd denote any consecutive pair of this sequence, prove that ad - be = ± 1. The terms of this sequence, except the first and last, are called the secondary convergents; here n runs through all values 1, 2, · · · . (c) Say that a rational number ajb is a \"fair approximation\" to g if lg - ajb l = min lg - xjyl, the minimum being taken over all integers 7. 6 Best Possible Approximations 341 x and y with 0 < y � b. Prove that every good approximation is a fair approximation. Prove that every fair approximation is either a conver­ gent or a secondary convergent to �. (d) Prove that not every secondary convergent is a \"fair approxima­ tion\". Suggestion: Consider � = .fi. (e) Say that an infinite sequence of rational numbers, r1, r2 , r3, • • • with limit � is an \"approximating sequence\" to an irrational number � if I� - rj+ t l <I � - rj l, j = 1 , 2, 3 , · · · , and if the positive denomina­ tors of the rj are increasing with j. Prove that the \"fair approxima­ tions\" to � form an \"approximating sequence.\" (f) Let sn -1 denote the finite sequence of (b) with the first term deleted, so that sn - t has an + l terms, the last term being h n+ tlk n + t · Prove that the infinite sequence of rational numbers obtained by first taking the terms of S0 in order, then the terms of S2, then S4 , then S6, • • · , is also an \"approximating sequence\" to �. Prove also that this sequence is maximal in the sense that if any other rational number < � is introduced into the sequence as a new member, we no longer have an approximating sequence. (g) Establish analogous properties for the sequence obtained by tak­ ing the terms of S _ ,, S,, S3, S5, • · · . 6. Let � be irrational, �= (a0, a,, a2, • • · ) . Verify that and -� = ( - a0 - 1, a2 + 1, a3, a4, • • • ) if a 1 = 1 . 7.6 BEST POSSIBLE APPROXIMATIONS Theorem 7. 11 provides another method of proving Theorem 6.9. For in the statement of Theorem 7. 11 we can replace kn + 1 by the smaller integer kn to get the weaker, but still correct, inequality Moreover the process described in Section 7.4 enables us to determine for any give irrational � as many convergents hnlkn as we please. We can also use continued fractions to get different proofs of Theorems 6. 11 and 6. 12. These results are repeated here because of their considerable importance in the theory and to reveal more about continued fractions. 342 Simple Continued Fractions Lemma 7.16 If xis real, x > 1, and x + x- 1 < 15, then x < 1<15 + 1) and x- 1 > 1<15 - 1). Proof For real x � 1 we note that x + x- 1 increases with x, and x + x- 1 = 15 if x = 1<15 + 1). Theorem 7.17 Hwwitz. Given any irrational number �. there exist infinitely many rational numbers hjk such that I� - �I < dk 2 . (7 .10) Proof We will establish that, of every three consecutive convergents of the simple continued fraction expansion of �. at least one satisfies the inequality. Let qn denote kn/kn - l· We first prove that ( 7.11) if (7.10) is false for both hjk = hj _ 1jkj- l and hjk = hJkj. Suppose (7. 10) is false for these two values of hjk. We have But � lies between hj_ 1jkj- l and hJkj and hence we find, using Theorem 7.5, that Combining these results we get Since the left side is rational we actually have a strict inequality, and (7.11) follows. Now suppose (7.10) is false for hjk = h;/k;, i = n - 1, n, n + 1. We then have (7. 11) for both j =nand j = n + 1. By Lemma 7.16 we see that q; 1 > 1< 15 - 1) and qn + 1 < 1< 15 + 1), and, by (7.6) we find qn + 1 = 7. 6 Best Possible Approximations � 1 + H/5 - 1) = -H/5 + 1) and this is a contradiction. 343 Theorem 7.18 The constant /5 in the preceding theorem is best possible. In other words Theorem 7. 17 does not hold if /5 is replaced by any larger value. Proof It suffices to exhibit an irrational number { for which /5 is the largest possible constant. Consider the irrational { whose continued fraction expansion is (1, 1, 1, · · · ). We see that 1 1 { = 1 + = 1 + - (1 ,1 , .. ·) { ' e = { + 1, 1 { = z-(v's + 1). Using (7.7) we can prove by induction that {; = (/5 + 1)/2 for all i � 0, for if {; = ( /5 + 1) /2 then A simple calculation yields h0 = k0 = k1 = 1, h1 = k2 = 2. Equations (7.6) become h; = h; _ 1 + h;_ 2, k; = k;_ 1 + k;_ 2 , and so by mathematical induction k n = h n - I for n � 1. Hence we have . kn -1 . kn - 1 1 /5 - 1 hm -- = hm -- =-= --- n-+ oo kn n -+ oo hn - l { 2 . ( kn -1 ) !� {n + l + ---;::- /5 + 1 2 If c is any constant exceeding /5, then + kn-1 {n + l + -k-> c n /5-1 2 = /5. 7. 7 Periodic Continued Fractions 345 integers r. Thus a periodic continued fraction can be written in the form (7. 12) where the bar over the a0, a 1, ·· , an - t indicates that this block of integers is repeated indefinitely. For example (l,j) denotes (2, 3, 2, 3, 2, 3, · · · ) and its value is easily computed. Writing 8 for (l,j) we have 1 8=2+ --1 . 3 +- 8 This is a quadratic equation in 8, and we discard the negative root to get the value 8 = (3 + ffl)/3. As a second example consider (4, 1, 2,j) . Calling this g, we have g = ( 4, 1, 8), with 8 as above, and so - 1 8 29 + v'15 g = 4 + (1 + 8 - 1) = 4 + -- = . 8 + 1 7 These two examples illustrate the following result. Theorem 7.19 Any periodic simple continued fraction is a quadratic iiTa­ tional number, and conversely. Proof Let us write g for the periodic continued fraction of (7.12) and 8 for its purely periodic part, Then equation (7.8) gives and this is a quadratic equation in 8. Hence 8 is either a quadratic irrational number or a rational number, but the latter is ruled out by Theorem 7.7. Now g can be written in terms of 8, 346 Simple Continued Fractions where m'jq' and mjq are the last two convergents to (b0, bp· · ·, bj ) · But 8 is of the form (a + /b)jc, and hence � is of similar form because, as with 8, we can rule out the possibility that � is rational. To prove the converse, let us begin with any quadratic irrational �. or �0, of the form � = �0 = (a + /b)jc, with integers a, b, c, b > 0, c * 0. The integer b is not a perfect square since � is irrational. We multiply numerator and denominator by 1 c I to get ac + Vbc2 -ac + {i;2 � o = --c-=-2 -- or �0 = -c2 according as c is positive or negative. Thus we can write � in the form mo + .fd �o = --­ qo where q0 l(d - m�), d, m 0, and q0 are integers, q0 * 0, d not a perfect square. By writing �0 in this form we can get a simple formulation of its continued fraction expansion ( a0, a 1, a2, • · • ). We shall prove that the equations m; + .fd �; = ---­ qi (7.13) define infinite sequences of integers m;, q;, a;, and irrationals �; in such a way that equations (7.7) hold, and hence we will have the continued fraction expansion of �0• In the first place, we start with �0, m0, q0 as determined above, and we let a0 = [�0]. 1f �;. m;, q;, a; are known, then we take mi + I = a;q; - m;, qi + I = (d - m�+ 1)/q;, �i + I = (mi + I + .f(i )jqi + I• ai + I = [�; + d· That is, (7.13) actually does determine sequences �;. m;, q;, a; that are at least real. Now we use mathematical induction to prove that the m; and q; are integers such that q; * 0 and q; l(d - m�). This holds for i = 0. If it is true at the ith stage, we observe that mi + I = a;q; - m; is an integer. Then the equation d- m� --- + 2a;m; - a?q; qi 7. 7 Periodic Continued Fractions 347 establishes that qi+ t is an integer. Moreover, qi +t cannot be zero, since if it were, we would have d = mf+ t• whereas d is not a perfect square. Finally, we have q; = (d - m1+ 1 )jqi + t • so that qi+ tl(d - mf+ 1 ). Next we can verify that -a.q. + m. + IJ l I l g; -a; = ------- qi+ l 1 ld + m; + t gi + t which verifies (7.7) and so we have proved that g0 = (a0, a 1, a2, ··· ), with the a; defined by (7.13). By g; we denote the conjugate of g;, that is, g; = (m; - /d)/q;. Since the conjugate of a quotient equals the quotient of the conjugates, we get the equation by taking conjugates in (7.8). Solving for g� we have As n tends to infinity, both hn - tlkn - t and hn _ 2fkn _ 2 tend to g0, which is different from g�, and hence the fraction in parentheses tends to 1. Thus for sufficiently large n, say n > N where N is fixed, the fraction in parentheses is positive, and g� is negative. But gn is positive for n � 1 and hence gn - g� > 0 and n > N. Applying (7.13) we see that this gives 2/J Jqn > 0 and hence qn > 0 for n > N. It also follows from (7. 13) that for n > N. Since d is a fixed positive integer we conclude that qn and m n + 1 can assume only a fixed number of possible values for n > N. Hence the ordered pairs (mn, qn) can assume only a fixed number of possible pair values for n > N, and so there are distinct integers j and k such that mj = mk and qj = qk. We can suppose we have chosen j and k so that 7. 7 Periodic Continued Fractions 349 To prove the converse, let us assume that � is purely periodic, say � = (a0 , ai , . ·· , an - i), where a0, ai, . · · , an - i are positive integers. Then � > a0 ;;:. 1. Also, by (7.8) we have Thus � satisfies the equation This quadratic equation has two roots, � and its conjugate f. Since � > 1, we need only prove that f(x) has a root between -1 and 0 in order to establish that -1 < f < 0. We shall do this by showing that f( -1) and f(O) have opposite signs. First we obsetve that f(O) = - hn _2 < 0 by (7.6) since a; > 0 for i ;;:. 0. Next we see that for n ;;:. 1 f( - 1) = kn - i - kn - 2 + hn - i- hn - 2 = ( kn - 2 + hn - 2 )(an - i- 1) + kn -3 + hn -3 We now turn to the continued fraction expansion of fJ for a positive integer d not a perfect square. We get at this by considering the closely related irrational number fJ + [/J]. This number satisfies the conditions of Theorem 7.20, and so its continued fraction is purely periodic, We can SUeJ>OSe that we have chosen r to be the smallest integer for which fJ + [v'd ] has an expansion of the form (7.15). Now we note that �; = (a;, ai + i• · · · ) is purely periodic for all values of i, and that �0 = �r = �2, = · · · . Furthermore, �I> �2, • • · , �r- i are all different from �0, since otherwise there would be a shorter period. Thus �; = �0 if and only if i is of the form mr. Now we can start with �0 = fJ + [/J], q0 = 1, m0 = [/J] in (7. 13) because 1l (d - (/J]2). Then, for all j;;:. 0, mjr + fd mo + fJ [ G] G ---=---- = �jr = �o = = vd + vd qjr qo (7.16) 350 Simple Continued Fractions and hence qjr = 1 since the left side is rational and fJ is irrational. Moreover q; = 1 for no other values of the subscript i. For q; = 1 implies �; = m; + fd, but �; has a purely periodic expansion so that, by Theorem 7.20 we have -1 < m; - fJ < 0, fJ - 1 < m; < IJ, and hence m; = [ /J]. Thus �; = �0 and i is a multiple of r. We also establish that q; = - 1 does not hold for any i. For q; = - 1 · implies �; = -m; - fJ by (7.13), and by Theorem 7.20 we would have -m; - fJ > 1 and -1 < -m; + fJ < 0. But this implies fJ < m; < - fJ - 1, which is impossible. Noting that a 0 = [/J + [/J]] = 2[/J], we can now turn to the case � = fJ . Using (7.15) we have fJ = - [/J] + (/J + [/J] ) with a 0 = 2[ /J]. When we apply (7.13) to fJ + [/J], q0 = 1, m0 = [/J] we have a 0 = 2[/J], m1 = [/J], q1 = d- [/JF. But we can also apply (7. 13) to fJ with q0 = 1, m0 = 0, and we find a 0 = [/J], m1 = [/J], q1 = d- [/Jf. The value of a0 is different, but the values of m1, and of q1, are the same in both cases. Since �; = ( m; + /d )/q; we see that further application of (7. 13) yields the same values for the a;, for the m;, and for the q;, in both cases. In other words, the expansions of fJ + [ /J] and fJ differ only in the values of a0 and m0. Stating our results explicitly for the case fJ we have the following theorem. Theorem 7.21 If the positive integer d is not a perfect square, the simple continued fraction expansion of fJ has the form with a 0 = [/J]. Furthermore with �0 = /d, q0 = 1, m 0 = 0, in equations (7. 13), we have q; = 1 if and only if rli, and q; = -1 holds for no subscript i. Here r denotes the length of the shortest period in the expansion of fJ. Example 2 Find the irrational number having continued fraction expan­ sion (8, 1,16) . 7. 8 Pelt's Equation 35 1 Solution Write this as 8 + x - 1, so that x = (r,T6) . Observing that x = ( 1, 16, r,T6) = ( 1, 16, x), we get the equation x = 1 + (16 + x - 1 ) - 1, which is equivalent to the quadratic equation x - 2 + 16x - 1 - 16 = 0. Solving this for x - 1 and discardinj_the negative solution, we get x - 1 = - 8 + v'80. Hence the answer is v'80 . PROBLEMS 1. For what positive integers c does the quadratic irrational ([ v'J] + Vd)jc have a purely periodic expansion? 2. Find the irrational number having continued fraction expansion (9, 9,18) . 3. Expand v'I5 into an infinite simple continued fraction. 7.8 PELL'S EQUATION The equation x 2 - dy2 = N, with given integers d and Nand unknowns x and y, is usually called Pel/'s equation. If d is negative, it can have only a finite number of solutions. If d is a perfect square, say d = a2, the equation reduces to (x - ay Xx + ay) = N and again there is only a finite number of solutions. The most interesting case of the equation arises when d is a positive integer not a perfect square. For this case, simple continued fractions are very useful. Although John Pell contributed very little to the analysis of the equation, it bears his name because of a mistake by Euler. Lagrange was the first to prove that x2 - dy2 = 1 has infinitely many solutions in integers if d is a fixed positive integer, not a perfect square. As we shall see in Section 9.6, the solutions of this equation are very significant in the theory of quadratic fields. Let us now turn to a method of solution. We expand v'd into a continued fraction as in Theorem 7.21, with convergents hnlkn, and with qn defined by equations (7.13) with �0 = v'd, q0 = 1, m0 = 0. Theorem 7.22 If d is a positive integer not a perfect square, then h� - dk� = ( -1)\" - lqn + 1 for all integers n � - 1. 352 Simple Continued Fractions Proof From equations (7.8) and (7.13), we have (mn + l + /J )hn + qn + lhn - 1 (mn + l + /J )kn + qn + lkn - 1 . We simplify this equation and separate it into a rational and a purely irrational part much as we did in (7. 16). Each part must be zero so we get two equations, and we can eliminate m n + 1 from them. The final result is where we used Theorem 7.5 in the last step. Corollary 7.23 Taking r as the length of the period of the expansion of fJ, as in Theorem 7.21 , we have for n ;;:. 0, 2 2 ( ) nr ( ) nr hnr- 1 - dknr- 1 = -1 qnr = -1 · With n even, this gives infinitely many solutions of x 2 - dy 2 = 1 in integers, provided d is positive and not a perfect square. It can be seen that Theorem 7.22 gives us solutions of Pell's equation for certain values of N. In particular, Corollary 7.23 gives infinitely many solutions of x2 - dy2 = 1 by the use of even values nr. Of course if r is even, all values of nr are even. If r is odd, Corollary 7.23 gives infinitely many solutions of x 2 - dy 2 = -1 by the use of odd integers n ;;:. 1. The next theorem shows that every solution of x 2 - dy 2 = ± 1 can be obtained from the continued fraction expansion of fJ . But first we make this simple observation: Apart from such trivial solutions as x = ± 1, y = 0 of x 2 - dy 2 = 1, all solutions of x 2 - dy 2 = N fall into sets of four by all combinations of signs ±x, ± y. Hence it is sufficient to discuss the positive solutions x > 0, y > 0. Theorem 7.24 Let d be a positive integer not a perfect square, and let the convergents to the continued fraction expansion of fJ be hnlkn. Let the integer N satisfy INI < fJ . Then any positive solution x = s, y = t of x2 - dy2 = N with (s, t) = 1 satisfies s = hn, t = kn for some positive integer n. Proof Let E and M be positive integers such that (E, M) = 1 and £2 - pM 2 = u , where {P is irrational and 0 < u < {P. Here p and u 7.8 Pelt's Equation are real numbers, not necessarily integers. Then and hence E u M - VP = M( E + M/P) E VP O < M - ..fP < M( E + M/P) 1 Also 0 < EjM- /P implies Ej(M/P) > 1, and therefore 353 By Theorem 7.14, EjM is a convergent in the continued fraction expan­ sion of /P . If N > 0, we take u = N, p = d, E = s, M = t, and the theorem holds in this case. If N < 0, then t2 - (l jd)s2 = -Njd, and we take u = - Njd, p = 1/d, E = t, M = s. We find that tjs is a convergent in the expansion of 1/ /d. Then Theorem 7.15 shows that sjt is a convergent in the expansion of fd. Theorem 7.25 All positive solutions of x 2 - dy 2 = ± 1 are to be found among x = hn, y = kn, where hnfkn are the convergents of the expansion of fd. If r is the period of the expansion of fd, as in Theorem 7.21, and if r is even, then x 2 - dy 2 = -1 has no solution, and all positive solutions of x2 - dy 2 = 1 are given byx = hnr- 1, y = knr- 1 for n = 1, 2,3, · · · . On the other hand, if r is odd, then x = hnr- 1, y = knr- 1 give all positive solutions of x2 - dy2 = - 1 by use of n = 1, 3, 5, · · ·, and all positive solutions of x2 - dy 2 = 1 by use of n = 2, 4, 6, · · · . Proof This result is a corollary of Theorems 7.21, 7.22, and 7.24. The sequences of pairs (h0, k0), (h1, k 1 ), · · · will include all positive solutions of x 2 - dy 2 = 1. Furthermore, a0 = [{d] > 0, so the sequence h0, h1, h2, • • • is strictly increasing. If we let x 1, y 1 denote the first solution that appears, then for every other solution x, y we shall have x > x1, and hence y > y 1 also. Having found this least positive solution by means of continued fractions, we can find all the remaining positive solutions by a simpler method, as follows 354 Simple Continued Fractions Theorem 7.26 If xi, Y i is the least positive solution of x2 - dy 2 = 1, d being a positive integer not a perfect square, then all positive solutions are given by xn, Yn for n = 1, 2, 3, · · · where xn and Yn are the integers defined by Xn + yJd = (xi + y /d)\". The values of x n and y n are determined by expanding the power and equating the rational �rts, and the purely irrational parts. For example, x3 + y31d =(x i + y i vd )3 so that x3 =xi + 3x i yrd and y3 = 3xry i + Yid. Proof First we establish that xn, Yn is a solution. We have xn - Ynld = (xi - Yild)\", since the conjugate of a product is the product of the conjugates. Hence we can write X� - y';d = (xn - Ynld )(xn + Ynld ) = (xi - Yild )\" (xi + Yild )\" = (xr- Yrd)\" = 1 . Next we show that every positive solution is obtained in this way. Suppose there is a positive solution s, t that is not in the collection {xn, Yn}. Since both xi + y ild and s +tid are greater than 1, there must be some integer m such that (xi + y ild)m < s + tid < (xi + y ild)m + i . We cannot have (xi + y ild)m = s +tid, for this would imply xm + Ymld = s + tid, and hence s = Xm, t = Ym· Now and we can multiply this inequality by (xi - y ild)m to obtain Defining integers a and b by a + bid = (s + tldXxi - y ild)m we have a2 - b2d = ( s2 - t2d)(x r - y rdt = 1 so a, b is a solution of x2 - dy2 = 1 such that 1 <a +bid< xi + Yild . But then 0 < (a + bid)- I, and hence 0 < a - bid < 1 . Now we have a= Ha + bid ) + H a- bid ) > 1 + 0 > 0, bid = H a + bid) - H a - bid) > 1 - 1 = 0, 7.8 Pell's Equation 355 so a, b is a positive solution. Therefore a > x1 , b > y 1, but this contradicts a + bid < x 1 + y 1 fd, and hence our supposition was false. All positive solutions are given by xn , Yn, n = 1, 2, 3, · · · . It may be noted that the definition of xn, Yn can be extended to zero and negative n. They then give nonpositive solutions. In case N * ± 1, certain results can be proved about x 2 - dy 2 = N, but they are not as complete as what we have shown to be true in the case N = 1. For example, if x1, y 1 is the smallest positive solution of x2 - dy2 = 1, and if rJ - dsJ = N, then integers rn , sn can be defined by rn + snfd = (r0 + s0/dXx1 + y 1/d)\", and it is easy to show that rn, sn are solutions of x2 - dy 2 = N. However, there is no assurance that all positive solutions can be obtained in this way starting from a fixed r0, s0• Numerical Examples Although Theorem 7.25 gives an assured procedure for solving x2 - dy2 = ± 1, it may be noted that the equation can be solved by inspection for many small values of d. For example, it is obvious that the least positive solution of x2 - 82y2 = -1 is x = 9, y = 1. How can we get the least positive solution of x 2 - 82y 2 = 1? Looking ahead to Problem 1 at the end of this section, we see that it can be found by equating the rational and irrational parts of giving the least positive solution x = 163, y = 18. For certain values of d, it is possible to see that x2 - dy2 = -1 has no solution in integers. In fact, this is established in Problem 3 of this section for all d = 3 (mod 4). Thus, for example, x 2 - 7y 2 = -1 has no solution. The least positive solution of x2 - 7y2 = 1 is seen by inspection to be x = 8, y = 3. Then, according to Problem 1, all solutions of x 2 - 7y2 = 1 in positive integers can be obtained by equating the rational and irrational parts of for n = 1, 2, 3, · · · . As another example, consider the equation x 2 - 30y 2 = 1, with the rather obvious least positive solution x = 11, y = 2. Now by Theorem 7.25, or Problem 1, if there are any solutions of x 2 - 30y 2 = -1, there must be a least positive solution satisfying x < 11, y < 2. But y = 1 gives 356 Simple Continued Fractions no solution, and hence we conclude that x2 - 30y 2 = - 1 has no solu­ tions. All the preceding examples depend on observing some solution by inspection. Now we turn to a case where inspection yields nothing, except perhaps to persons who are very facile with calculations. Example 3 Find the least positive solution of x2 - 73y 2 = - 1 (if it exists) and of x2 - 73y2 = 1, given that m = (8, 1 , 1,5 ,5 , 1, 1 , 16) . Solution Since the period of this continued fraction expansion is 7, an odd number, we know from Theorem 7.25 that x2 - 73y2 = - 1 has solutions. Moreover, the least positive solution is x = h6, y = k6 from the convergent h6jk6. Using Equations (7.6), we see that the convergents are, starting with h0/k0, 8/1, 9j1 , 17/2, 94/11, 487j57,561/68, 1068/125 . Hence, x = 1068, y = 125 gives the least positive solution of x 2 - 73y2 = -1 . To get the least positive solution of x2 - 73y2 = 1, we use Problem 1 below and so calculate x and y y equating the rational and irrational parts of X + yffl = ( 1068 + 125ffl( The answer is x = 2,281,249, y = 267,000. This easy solution of the problem depends on knowing the continued fraction expansion of m. Although this expansion can be calculated by formula (7.13), we �e a variation of this in Section 7.9 that makes the work easier, using v73 as an actual example. PROBLEMS The symbol d denotes a positive integer, not a perfect square. *1. Assuming that x2 - dy2 = -1 is solvable, let x1, y1 be the smallest positive solution. Prove that x2, y2 defined by x2 = y2/d = (x1 + y,/d)Z is the smallest positive solution of x2 - dy 2 = 1. Also prove that all solutions of x2 - dy2 = -1 are given by xn, Yn• where xn + Ynfd = (x1 + y 1/d)\", with n = 1, 3, 5, 7, - · · , and that all solutions of x2 - dy2 = 1 are given by xn, Yn with n = 2, 4, 6, 8, · · · . 2. Suppose that N is a nonzero integer. Prove that if x 2 - dy 2 = N has one solution, then it has infinitely many. (H) 7. 8 Pell's Equation 357 3. Prove that x 2 - dy 2 = -1 has no solution if d = 3 (mod 4). 4. Let d be a positive integer, not a perfect square. If k is any positive integer, prove that there are infinitely many solutions in integers of x 2 - dy 2 = 1 with kly. *5. Prove that the sum of the first n natural numbers is a perfect square for infinitely many values of n. 6. Prove that n2 + (n + 1)2 is a perfect square for infinitely many values of n. (H) 7. Observe that x 2 - 80y2 = 1 has a solution in positive integers by inspection. Hence, prove that x 2 - 80y 2 = - 1 has no solution in integers. Generalize the argument to prove that for any integer k, x 2 - (e - l)y 2 = -1 has no solutions in integers. 8. Given liB= (4, 4,8), find the least positive solution of x 2 - 18y 2 = -1 (if any) and of x 2 - 18y 2 = 1. 9. Calculator problem. Find the least positive solution of x 2 - 29y 2 = -1 (if any) and of x 2 - 29y 2 = 1, given {i9 = (5, 2, 1, 1,2, 10) . 10. Calculator problem. Find the least positive solution of x 2 - 61y 2 = -1 and also of x 2 - 61 y 2 = 1, given 061 = (7, 1,4,3, 1,2,2, 1, 3,4,1 ,14) . (One value of x in the answer exceeds 109, so the calculation is sizable. The procedure in Example 3 for x 2 - 73y 2 = ± 1 in the text can serve as a model. A calculator with an eight-digit display is adequate, because, for example, to square 1234567 we can use (a + b)2 = a2 + 2ab + b2, with a = 1234000 and b = 567.) 11. Show that if d is divisible by a prime number p, p = 3 (mod 4), then the equation x 2 - dy 2 = - 1 has no solution in integers. 12. Suppose that p = 1 (mod 4). Show that if x 2 - py 2 = 1 then x is odd and y is even. Suppose that x5 - PY5 = 1 with Yo > 0, Yo minimal. Show that g.c.d.(x0 + 1, x0 - 1) = 2. Deduce that one of two cases arises: Case 1. x0 - 1 = 2pu2, x0 + 1 = 2v 2. Case 2. x0 - 1 = 2u2, x0 + 1 = 2pv 2• Show that in Case 1, v 2 - pu2 = 1 with lui < y0, a contradiction to the minimality of y0 . Show that in Case 2, u 2 - pv 2 = -1. Conclude that if p = l(mod 4) then the equation x 2 - py 2 = - 1 has an integral solution. 13. Show that the solution of x 2 - 34y 2 = 1 with y > 0, y minimal, is ( ± 35, 6). By examining y = 1, 2, 3, 4, 5, deduce that the equation x 2 - 34 y 2 = - 1 has no integral solution. Observe that this latter equation has the rational solutions (5/3, 1/3), (3/5, 1/5). Using the first of these rational solutions, show that the l,;Ongruence x 2 - 34 y 2 = -l (mod m) has a solution provided that 3 ,( m. Similarly, use 358 Simple Continued Fractions the second rational solution to show that the congruence has a solution if 5-(m. Use the Chinese Remainder Theorem to show that the congruence has a solution for all positive m. 7.9 NUMERICAL COMPUTATION The numerical computations involved in finding a simple continued frac­ tion can be rather lengthy. In general the algorithm (7.7) must be used. However, if �0 is a quadratic irrational the work can be simplified. It is probably best to use (7. 13) in a slightly altered form. From (7.13) we have d- m� 2 --- - a;q; + 2a;m; qi Starting with �0 = (m0 + /d)jq0, q0 l(d - m�), we obtain, in tum, _ [ m i - l + /d l ai- 1- , qi- 1 The formula qiqi+I = d - m�+ l serves as a good check. Even for large numbers, this procedure is fairly simple to carry out. In order to calculate the continued fraction expansion of /d by this method, d being a positive integer and not a perfect square, we see that m0 = 0 and q0 = 1 in such a case. For .fi3 for example, we see that the sequence of calculations begins as follows. Notes on Chapter 7 359 PROBLEM 1. Continue the calculation started above for m' and verify the contin­ ued fraction expansion given in Example 3 in the preceding section. NOTES ON CHAPTER 7 A completely different approach to continued fractions, specifically with the continued fractions arising naturally out of the approximations rather than the other way about, can be found (for example) in Chapter 1 of Cassels (1957), listed in the General References. The reader interested in statistical questions concerning the usual size of the partial quotients a; and the expected rate of growth of the denominators k; should consult the beautiful little book by Khinchin. CHAPTER 8 Primes and Multiplicative Number Theory In this chapter we study the asyrnptotics connected with the multiplicative structure of the integers. The estimates we derive concern prime numbers or the size of multiplicative functions. From such estimates we gain insights concerning the number and size of the prime factors of a typical integer. 8.I ELEMENTARY PRIME NUMBER ESTIMATES Let 'TT(x) denote the number of primes not exceeding the real number x. In our remarks at the end of Section 1.2 we mentioned the Prime Number Theorem, which asserts that X 'TT(X) - -­ log x (8.1) as x ---.. oo. This was first proved in 1896, independently by J. Hadamard and Ch. de Ia Vallee Poussin. We do not prove this, but instead establish a weaker estimate, namely that there exist positive real numbers a and b such that X X a- 1 - < 'TT(x) < b- 1 - og x og x (8 .2) for all large x. Estimates of this kind were first proved by P. L. Chebyshev in 1852, and we follow his method quite closely. Chebyshev observed that it is fruitful to begin by counting all prime powers p k � x, each with weight log p, and then derive a corresponding estimate for 'TT(x) as a consequence. 360 8. 1 Elementary Prime Number Estimates 361 Definition 8.1 The von Mangoldt function A(n) is the arithmetic function A(n) = log p if n = pk, A(n) = 0 otherwise. We let 1/J(x) = E1 ,. n .-.xA(n), it(x) = Ep .;; x log p, and 'lT(x) = Ep .;; x l . The motivation for considering A(n) lies in the following observation. Theorem 8.1 For every positive integer n, Ed1nA(d) = log n. Proof Write nasa product of primes in the canonical manner, n = f1Pp0, where a = a( p, n). Taking logarithms, we find that log n = EPa log p. But p0lln, and hence pk ln if and only if k is one of the numbers 1, 2, · · ·, a. Thus the sum over p is L: log p = L:A(d). p, k din pkln Since the function log n increases very smoothly, we can estimate the sum of log n quite accurately. Lemma 8.2 Let T(x) = E1 .,. n.,. xlog n. Then for every real number x � 1 there is a real number 8, 181 � 1, such that T( X ) = X log X - X + 8 log ex. Proof Let N = [x]. We first derive a lower bound for T(x). Since the function log u is increasing, it follows that fn \"- 1 log u du � log n. As log 1 = 0, we deduce that N N n N T( x) = L: log n � L: J log u du = J. log u du n- 2 n- 2 n - 1 I Here the first integral is [u log u - u I� = x log x - x + 1 � x log x - x, and the second integral is � log x. Hence T(x) � xlog x - x - log x. To derive a similar upper bound for T(x ) we observe that fn\" + 1 log u du � 362 Primes and Multiplicative Number Theory log n , so that N- 1 N- 1 f n+1 T( x) = log N + E log n � log x + E log u du n-1 n=1 n = log x + J. N log u du � log x + J.x log u du , 1 1 and hence T(x) � x log x- x + 1 + log x. The stated estimate follows on combining these two bounds. By applying the Mobius inversion formula (Theorem 4.8) to the formula of Theorem 8. 1, we see that A( n) = L JL( d) log njd. di n On summing both sides over n � x we find that ,P(x) = E L JL( d) log njd. n <;;x d in Writing n = dm, the iterated sum may be expressed as a double sum over pairs d, m of positive integers for which dm � x. This may be expressed as an iterated sum, by summing first over d � x, and then over m � xjd. Thus the sum above is = L JL( d) E logm = L JL( d) T(x/d). d .;x m .;xfd d.;x Here we have expressed ,P(x) in terms of the sum T(y) whose asymptotic size we know quite accurately, but new problems arise when we insert the approximation provided by Lemma 8.2 into this relation. Not only do we not know how to estimate the main terms, which contain sums involving the Mobius function, but the error term also makes a large contribution. The large values of d are especially troublesome in this regard. On the other hand, if we are given a sequence of real numbers v(d) with v(d) = 0 for d > D, then we could use Lemma 8.2 to estimate the sum E v( d) T( x/d) . (8.3) d.;D 8.1 Elementary Prime Number Estimates Indeed, by Lemma 8.2 this is = x (log x- 1)( E v(d)!d) - x( E v(d)(log d)!d) dcD d cx + o( E lv (d ) l) log ex dcD 363 (8.4) for x ;;:. D, where 8 satisfies 101 � 1. In order to eliminate the first main term we restrict ourselves to choices of the v(d) for which E v(d ) jd = 0. (8.5) dcD Since T(y) is a sum of log n, which in turn is a sum of A(r ), we may write the expression (8.3) in the form E, '\"' x N(r, x )A(r ). Our strategy is to choose the v(d) in such a way that these coefficients N(r, x) are near 1 throughout most of the range, so that this sum is near 1/J(x). It is to be expected that the numbers v(d) will bear some resemblance to JL(d). To find a formula for the N(r, x) we note that the expression (8.3) is D = E v(d ) E logn = E v( d) logn . d=l n'\"'xjd d, n dncx Using Theorem 8. 1, we write log n = E,1nA(r), and choose k so that rk = n. Thus the above is = E v( d) EA( r ) = E v(d ) A( r ). d, n dn .;;x r ln d, r ,k drk .;;x We write this triple sum as an iterated sum, summing first over r � x, then over d � xjr, and finally over k � xj(rd). Thus the above is = E A( r) E v(d ) E 1 = E A( r) E v(d) [x/(rd) ], r .;;x d .;;xjr k .;;xj(rd) r'\"'X d .;; xjr and hence the expression (8.3) equals E,,.xA(r)N(xjr) where N( y ) = E v(d ) [ yjd ] . (8.6) d .;; D To summarize our argument thus far, we have shown that if the numbers 364 Primes and Multiplicative Number Theory v(d) satisfy (8.5) then l:A( r)N( xlr) = -x( I: v( d) ( Iog d) ld) + 8( I: l v( d) l) log ex r�x d�D d�D (8.7) for x ;;;. D, where N(y ) is given by (8.6) and 181 � 1. Writing [yld] = y 1 d - {y I d} in (8.6), and appealing to (8.5), we see that N( y ) = - I: v( d) {yld} . d�D Since the function {y 1 d} has period d, it follows that N( y) has period q where q is the least common multiple of those numbers d for which v(d) =1= 0. (This number q is not necessarily the least period of N(y ).) By selecting suitable values for the numbers v(d) we can derive upper and lower bounds for ljl(x). Theorem 8.3 Put a0 = t log 2 + ! log 3 = 0.780355 · · · , b0 = tao = ! log 2 + � log 3 = 1. 170533 · · ·. If a < a0 and b > b0, then there is a number x0 (depending on a and b) such that ax < ljl(x) < bx whenever x >x0• Proof We take v(l) = 1, v(2) = - 1, v(3) = -2, v(6) = 1, v(d) = 0 oth­ erwise, and verify that (8.5) holds. Moreover, N(y) has period 6, and from (8.6) we see that N(y) = 0 for 0 � y < 1, N(y) = 1 for 1 � y < 3, N(y) = 0 for 3 � y < 5, N(y) = 1 for 5 � y < 6. Since N(y) � 1 for all y, it follows that the left side of (8.7) does not exceed ljl(x). Hence (8.7) gives the lower bound 1/!(x) ;;;. a0x- 5log ex (8.8) for x ;;;. 6. Thus ljl(x) ;;;. ax for all sufficiently large x if a < a0• To derive an upper bound for ljl(x) we note that N( y) ;;;. 0 for all y and that N(y) = 1 for 1 � y < 3. Hence the left side of (8.7) is ;;;. Exf3 <n � x A(n) = ljl(x) - ljl(xl3). That is, ljl( x) - ljl( xl3) � a0x + 5log ex for x ;;;. 6. By direct calculation we verify that this also holds for 1 � x � 6. Let 3K be the largest power of 3 not exceeding x. Replacing x by xl3k and summing over k = 0, 1, · · · , K, we see that K K ljl(x ) = E I/J(xl3k ) - I/J(xl3k + l ) � E (a0xl3k + 5log ex) . k- 0 k-0 8. 1 Elementary Prime Number Estimates 365 As E�1/3k = (1 - 1/3)- 1 = 3/2 and K = [log xjlog 3] < log x, we con­ clude that cf!(x ) <b0x + 5( log ex ) 2 (8.9) for x ;;;. 1. Thus if b > b0 , then cf!(x) < bx for all sufficiently large x, and the proof is complete. Having determined the order of magnitude of cf!(x), we now relate cf!( x) to �(x), and then �(x) to 'lT(x), to establish (8.2). Thus far we have kept close track of the constants that arise in the secondary terms. To focus attention on the salient features of our estimates, and to free ourselves of the need to calculate all constants, we use the \"big-0\" notation. We let O( g(x)) denote a function f(x) with the property that there is an absolute constant C for which 1/(x)l � Cg(x) uniformly in x, and we say, \"f(x) is of order g(x),\" or, \"f(x) is big-oh of g(x).\" For example, since [x] = x - {x} and {x} is a bounded function, we may write [x] = x + 0(1). · Theorem 8.4 For x ;;;. 1, �(x) = cf!(x) + O( x 112). Proof From the definitions of cf!(x) and �(x) we see that �(x) � cf!(x) for all x. To derive an upper bound for the difference cf!(x) - �(x) we note that cf!(x) = E A( n ) = E log p = E E log p = E �(x 11k ). n .;;x pk .;;x k p .;;x llk k Put K = [log xjlog 2]. If k > K then x 11k < 2, and hence �(x 11k ) = 0. Thus we may confine our attention to those k for which k � K. Subtract­ ing �(x) from both sides, we see that by Theorem 8.3. The implicit constant does not depend on k, and the terms are decreasing, so the above is = O(x l/2 + Kx lf3 ) = O(x l/2 + x lf3 log x) = O( x lf2 ). This gives the stated estimate. 366 Primes and Multiplicative Number Theory l?(x ) Theorem 8.5 For x ;;;. 2, '!T(x) = -1 - + O(xj(log x)2). ogx From this we see that the Prime Number Theorem (8.1) is equivalent to the assertion that l?(x) -x (8.10) as x � oo . By Theorem 8.4 this is in turn equivalent to the assertion that .p(x) - x as x � oo . Proof We first show that if x ;;;. 2 then l?(x ) lx - 2 1T ( x) = -- + 1? ( u) u - 1 (log u ) du . log x 2 (8.11) (8.12) To evaluate the integral we write l?(u) as a sum over prime numbers and interchange the order of summation and integration. Thus the integral is lx( E log p) u - 1 ( log u) - 2 du = E (log p)jx u - 1 ( log u) - 2 du 2 p ,;;, u p ,;;,x P = E (log p)( - 1 -- _ 1 _) . p ,;;,x log p log x which gives (8.12). Since 0 � l?(x) � 1/J(x), it follows from Theorem 8.3 that l?(x) = O(x). Hence the integral in (8.12) is O( f{(log u)-2 du). We consider 2 � u � IX and IX � u � x separately. In the first range the integrand is uniformly bounded, and thus the first portion contributes an amount that is 0( /X). In the second range, the integrand is uniformly � 4j(log x)2, and hence the integral over 'the second range is O(xj(log x)2). This completes the proof, but we remark that more precise estimates of this integral can be derived by integrating by parts. Corollary 8.6 Let a0 and b0 be as in Theorem 8.3. If a < a0 and b > b0, then the inequalities (8.2) hold for all large x. 8. 1 Elementary Prime Number Estimates 367 Proof We appeal successively to Theorems 8.5, 8.4, and 8.3 to see that � (x) 2 o/( x ) 2 1T(X) = -1 - + O( xj(Iog X) ) = - 1 - + O ( xj( Iog X) ) og x og x (8.13) This gives the upper bound in (8.2) for all large, x, if b > b0. Similarly, 1T(X) ;;;, a0 - X- + O ( xj( Iog x) 2) , log x which gives the lower bound of (8.2) for all large x. (8.14) Let c be an absolute constant, c > 1. Then log ex = log x + 0(1), and hence 1/log ex= 1jlog x + O(lj(log x)2) for x ;;;, 2. Thus if we apply (8. 14) with x replaced by ex, and combine this with (8. 13), we find that 1r( ex ) - 1T(X) ;;;, ( cao - bo ) -1 X + 0( xf(Iog x) 2) . og x From Theorem 8.3 we recall that b0ja0 = 3j2. If c < 3/2 then the inequality above is useless, for then the right side is negative while the left side is trivially non-negative. On the other hand, if c > 3/2 then the right side is positive, and we deduce that the interval (x, ex] contains at least one prime number, provided that x > x0(c). After determining an admissi­ ble value for x0(c), one may examine smaller x directly, and thus deter­ mine the least acceptable value of x0(c). We perform this calculation when c = 2. Theorem 8.7 Bertrand's Postulate. If xis a real number, x > 1, then there exists at least one prime number in the open interval (x, 2x). Proof Suppose that the interval (x, 2x) contains no prime number. If p is prime then there is at most one value of k for which pk E (x, 2x), since pk+ 1 /Pk = p ;;;, 2. Furthermore, k > 1, since the interval contains no primes. Hence o/(2x) - o/(x ) = E log p � o/( lfX) + log 2x. 368 Primes and Multiplicative Number Theory Here the last term on the right is required because 2x may be a prime number. We use (8.8) to provide a lower bound for .p(2x), and use (8.9) to provide upper bounds for 1/J(x) and .p({iX). Thus we find that (2a0- b0)x - 5 1og 2ex - 5(1og ex) 2 � b0f2X + 5(1og effX) 2 + log 2x. (8.15) Here the left side is comparable to x as x -+ oo, while the right side is comparable to rx. Hence the set of X for which this holds is bounded. In fact, we show that if (8.15) holds then x < 1600. That is, if x;;:. 1600 then 2a0 - b0 ;;:. 5(log2ex)jx + 5(1og ex) 2/x + 5(1og effX )2/x + (log 2x )jx + b0..fi; /X . (8. 16) To this end let f(x) be a function of the form f(x) = (log axb)c jx where a, b, c are positive real constants. Then log f(x) = c log log axb - log x, and by differentiating it follows that f'( x) b f( x) = (bcj(log ax ) - 1 )/x. Thus if axb > ebc, then f(x) > 0 and the above expression is negative, so that f'(x) < 0. In other words, f(x) is decreasing in the interval [x0,oo) where x0 = e c ja 1 fb. Thus in particular the first term on the right side of (8. 16) is decreasing for x ;;:. x1 = 1/2, the second is decreasing for x ;;:. x2 = e, the third is decreasing for x ;;:. x3 = 1/2, and the fourth is decreas­ ing for x ;;:. x4 = ej2. Since the last term on the right side of (8. 16) is decreasing for all positive values of x, we conclude that the right side is decreasing for x ;;:. x2 = 2.71828 · · · . By direct calculation we discover that the right side of (8.16) is less than 3/8 when x = 1600, while the left side is > 3/8. Since the right side is decreasing, it follows that (8. 16) holds for all x ;;:. 1600. We have shown that Bertrand's postulate is true for x ;;:. 1600. To verify it for 1 < x < 1600 we note that the following thirteen numbers are prime: 2, 3, 5, 7, 13, 23, 43, 83, 163, 317, 631, 1259, 2503. As each term of this sequence is less than twice the preceding member, Bertrand's postu­ late is valid for 1 < x < 2503, and the proof is complete. We have determined the order of magnitude of '7T(x), but not the stronger asymptotic relation (8.1). We now consider sums involving primes whose asymptotic size we can determine more precisely. 370 Primes and Multiplicative Number Theory log n E\"' _2 ( ) • Thus the difference between the sum (a) and the sum (b) n n n- 1 is uniformly bounded, and hence the assertion (b) follows from (a). (c) By definition, 1/J(x) = En .; xA(n). On inverting the order of sum­ mation and integration, we find that {.p( u ) ju2 du = { E A(n) u -2 du l l n <;u X ( 1 1 ) = E A(n) j u - 2 du = E A( n) - - - n c;;x n n .;x n X = { E A(n)!n) - 1/J(x ) jx . n .;x By Theorem 8.3, 1/J(x)jx = 0(1). Thus the result follows from (a ). (d) Let L(x) denote the sum in (b). Then [x _ L _ (_ u )� _ [x \"' log p 1 )\" 2 du - Jo £... 2 du . 2 u(log u) 2 p .;u P u( log u ) On inverting the order of summation and integration, we find that this is = E log P { 1 2 du = E log P ( _ 1 _ _ _ 1 _) . p ,;;,x P p u( log u) p ,;;,x P log p log x This is the sum in question minus L(x)jlog x. That is, \"' L(x ) x L( u ) 1... 1/p = -- + J 2 du . P .;x log X 2 u ( log u ) Now let E(x) denote the error term in (b), so that (b) takes the form L(x) = log x + E(x), where E(x) is uniformly bounded. Then the right side above is We set E( x ) x E( u ) = 1 + log log x - log log 2 + -1 - + J 2 du . og x 2 u( log u) \"' E( u ) b = 1 - log log 2 + J 2 du , 2 u(log u) 372 Primes and Multiplicative Number Theory In Theorem 1.18 we established that there exist arbitrarily long intervals containing no prime number. We are now in a position to put this in the following more quantitative form. Corollary 8.10 Let p' denote the least prime exceeding p. Then p' - p p' - p lim sup -- � 1 and lim inf -- � 1. p -<» log p p -<» log p Proof Suppose that 0 < x 1 < x2, and let p 1 denote the least prime exceeding x1, p2 the least prime exceeding x2• We compare the telescop­ ing sum E ( p' - p ) = P2 - P J (8.18) x1 <p <;x2 with the sum E log p = t'}( x2 )- t'}( x 1 ). (8.19) x1 <p .:;x2 Suppose that c is a number such that p' - p � c log p for all primes p in the interval (x1, x2 ]. Then (8.20) By Corollary 8.9 and (8.17), there exist arbitrarily large numbers x2 for which t'}(x2 ) < (1 + e)x2• For such x2 the right side of (8.20) is < c(l + e)x2• By Bertrand's postulate p 1 < 2x 1, so the left side of (8.20) is > x2 - 2x1• Thus if x2 > x 1je, then c > 1 - 3e. That is, there exist arbitrarily large primes p such that p' - p > (1 - 3e) log p. Since e is arbitrarily small, this gives the stated lower bound for the lim sup. Suppose now that c is a number such that p' - p � c log p for all primes p in the interval (x1, x2 ]. Then (8.21) By Corollary 8.9 and (8.17), there exist arbitrarily large numbers x0 for which t'}(x0) > (1 - e)x0. For such an x0 let Po be the largest prime not exceeding x0, and take x2 =Po - 1. Then t'}(x2) = t'}(x0) - log Po > (1 - 2e)x0 > (1 - 2e)x2• We suppose also that x2 > x1je, so that t'}(x1) < 2x1 < 2ex2 • Hence the right side of (8.21) is > c(l - 4e)x2• Since p2 = x2 + 1, the left side of (8.21) is < x2• It follows that c < (1 - 4e)- 1• That is, there exist arbitrarily large primes p such that p' - p < 8. 1 Elementary Prime Number Estimates 373 (1 - 4e)- 1 log p. Since e is arbitrarily small, this gives the stated upper bound for the lim inf. PROBLEMS l. Show that Ed c;; xJ.L(d){xjd] = 1 for all real numbers x � 1. Deduce that I Ed c;; xJ.L(d)jd l ..,.; 1 for all real x � 1. 2. Show that A(n) = - Edlnp.(d) log d for every positive integer n. 3. For 1 ..,.; d ..,.; D let v(d) be real numbers satisfying (8.5), and let q denote the least common multiple of those d for which v(d) * 0. Show that if y is not an integer then N( y) + N(q - y) = -Ed \"' 0v(d) where N( y) is given by (8.6). (H) 4. Show that 2x < n p < (13j4)X for all sufficiently large X. (H) p c;;x 5. Let dn denote the least common multiple of the integers 1, 2, · · · , n. Show that dn = e\"'<n>. Show also that 2n < dn < (13j4)n for all sufficiently large integers n. 6. Show that if n is a positive integer then T(n) = log n!. Show that 22n j(2n) ..,.; ( 2 n n ) ..,.; 22n. Deduce that (2 log 2)n - log 2n ..,.; T(2n) - 2 T{n) ..,.; (2 log 2)n. (H) 7. Set v(l) = 1, v(2) = -2, v(d) = 0 for d > 2. Show that (8.5) is satisfied. Show that N( y) defined by (8.6) has period 2, and that N( y) = 0 for 0..,.; y < 1, N( y) = 1 for 1..,.; y < 2. Use de Polignac's formula (Theorem 4.2) to determine the canonical factorization of ( 2 n n ) into primes. Show that this factorization is equivalent to the identity T(2n) - 2T(n) = E, c;; 2n A( r)N(2njr). Explain why I/J(2n) - 1/J(n) ..,.; T{2n) - 2T{n) ..,.; lf1(2n), and derive a weaker form of Theorem 8.3 with a0 replaced by log 2 = 0.6931 · · · and b0 replaced by 2log 2 = 1.3863 · · · . 8. Prove that n! = m k is impossible in integers k > 1, m > 1, n > 1. (H) 9. Let k and r be integers, k > 1, r > 1. Show that there is a prime number whose representation in base r has exactly k digits. 10. For this problem include 1 as a prime. Prove that every positive integer can be written as a sum of one or more distinct primes. 11. Show that En c;; xlf!(xjn) = T(x) for x � 1, where T{x) is defined as in Lemma 8.2. 12. Let P(x) be a polynomial with integral coefficients and degree not exceeding n, and put /(P) = JJP(x)dx. Show that l(P)dn + l is an 374 Primes and Multiplicative Number Theory integer, where dn is defined as in Problem 5. Show that there is such a polynomial P(x) for which /(P)dn +t = 1. 13. Put Q(x) = x 2(1 - x)2(2x - 1). Show that max IQ(x)l = s -512• In O .;;x .;; l the notation of the preceding problem, show that if P(x) = Q(x )2k then 0 < /(P) < s -sk. Deduce that d1ok+ t � 55k, and hence that .p(lOk + 1) � clOk where c = Oog 5)j2. 14. Chebyshev took v(l) = 1, v(2) = - 1, v(3) = - 1, v(S) = - 1, v(30) = 1, v(d) = 0 otherwise. Show that these v(d) satisfy (8.5). Let N(y) be given by (8.6). Show that N(y) has period 30, that N(y) takes only the values 0, 1, and that N(y) = 1 for 1 � y < 6. Use this to derive a version of Theorem 8.3 with a0 replaced by the larger constant a1 = (7j 15) log 2 + (3/10) log 3 + {lj6) log 5 = 0.9212 · · · , and with b0 replaced by the smaller constant b 1 = 6a 1j5 = 1. 1056 · · · . Deduce that the interval (x, ex) contains a prime number for all large x provided that c > 6j5. 15. Let c be an absolute constant, c > 1. Show that for x � 2, {<.P( cu ) - lf! (u))u- 2 du = ( c -1 )log x + 0( 1) . 2 16. Show that for x � 2, �(x ) = 1r(x )(log x )- {1r(u)judu. 2 *17. Show that np .;; x P < 4x for all real numbers X� 2. *18. Suppose that the Prime Number Theorem (8.1) holds. Deduce that if c > 1 then there is a number x0(c) such that the interval (x, ex) contains a prime number for all x > x0(c). *19. Let Pn denote the nth prime. Show that lim sup Pn/(n log n) � 1, n ->ao and that lim inf Pn/(n log n) � 1. n ->ao *20. Let Pn denote the nth prime number. Show that the Prime Number Theorem (8.1) is equivalent to the assertion that Pn - n log n as n --t oo. 8.2 DIRICHLET SERIES A Dirichlet series is any series of the form E;; =,an/n5• Here s is a real number, so that the series defines a function A(s) of the real variable s, provided that the series converges. The Riemann zeta function is an 8. 2 Dirichlet Series 375 important example of a Dirichlet series. For s > 1 it is defined to be (( s) = L 1/n5• (8.22) n = l Here the summands are monotonically decreasing, so we may use the integral test to determine when this series converges. Since Jr 1ju5 du < oo if and only if s > 1, we see that this series is absolutely convergent for s > 1, but divergent for s � 1. In this section we establish the basic analytic properties of Dirichlet series in a manner analogous to the basic theory of power series. However, our main object is to discover useful relationships among arithmetic functions by manipulating the Dirichlet series they generate. Questions of convergence of Dirichlet series can be subtle, but for our present purposes it is enough to consider absolutely convergent Dirichlet series. We have already shown that the Dirichlet series (8.22) is absolutely convergent if and only if s E (1, oo). This behavior is typical of more general Dirichlet series. Suppose that a is a real number such that (8.23) Since n -s is a monotonically decreasing function of s, it follows by the comparison test that the series E�_ 1ann -s is uniformly and absolutely convergent for a � s < oo. We let ua denote the infimum of those real numbers a for which (8.23) holds. This number is called the abscissa of absolute convergence of the series Eann -s, since the series is absolutely convergent for every s > ua , but not for any s < ua . It may happen that ua = - oo, in which case the series is absolutely convergent for all real s, or it may happen that ua = + oo, which is to say the series is absolutely convergent for no real number s. Examples of these two extreme cases are found in Problems 2 and 3 at the end of this section. We have established the following theorem. Theorem 8.11 For each Dirichlet series A(s) = �= lan/n5 there exists a unique real number ua such that the series A(s) is absolutely convergent for s > ua , but is not absolutely convergent for s < ua . If c > ua , then the series A(s) is uniformly convergent for sin the interval [c, + oo). Corollary 8.12 Let ua be the abscissa of absolute convergence of the Dirichlet series A(s) = E� _ 1anfn5• Then A(s) is a continuous function on the open interval ( ua , + oo ). 376 Primes and Multiplicative Number Theory Proof Each term anfn s is a continuous function of s. Take c > u0 • On the interval [c, + oo) the series A(s) is a uniformly convergent series of continuous functions, and therefore A(s) is continuous on this interval. Since c may be arbitrarily close to u0 , we conclude that A(s) is continuous on the open interval ( u0 , + oo). We now show that the abscissa of absolute convergence is related to the average size of the numbers Ian 1. Theorem 8.13 Let u0 be the abscissa of absolute convergence of the Dirichlet series A(s) = E':: - tanfn s. If cis a non-negative real number such that {8.24) as x --too, then u0 � c. Conversely, if c > max (O, u0 ) then (8.24) holds as X --t oo. Proof Suppose that (8.24) holds and that e > 0. Then L lan ln -c -e � N-e -e L i an I = O( N-c -e(2N ) c ) = O( N-•). N < n�2N N< n �2N We take N = 2k and sum over k. Since Ek2 -k• < oo, it follows that En i an In -c -e < oo. Since e may be arbitrarily small, we conclude that U0 � C. Conversely, if c ;;;. 0 then (xjnY ;;;. 1 for all n � x, and consequently 00 n�x n�x n - 1 If in addition c > u0 then the series on the right converges, and we have (8.24). Let A(s) = Ea mfm s and B(s) = Ebn/n s be two Dirichlet series. Here m and n run from 1 to oo. For brevity we sometimes omit the limits of summation, when they may be inferred from the context. We now consider the product function A(s)B(s). Ignoring questions of conver­ gence for the moment, we see that this product is a double series in which the general term is {8.25) 8. 2 Dirichlet Series 377 Here the base of the exponential is the product mn, so it is natural to group together those terms for which mn has a given value, say mn = r. With this in mind, we set (8.26) This new sequence {c ,} is called the Dirichlet convolution of the two sequences {am} and {bn}. We express this in symbols by writing c = a* b. It is reasonable to expect that A(s)B(s) = C(s), where C(s) is the Dirichlet series C(s) = 'Lc,jr5• We now show that this is indeed the case if the two given series are absolutely convergent. Theorem 8.14 Suppose that sis a real number for which the Dirichlet series 'Lam/m5 and 'Lbn/n5 are both absolutely convergent. Let the numbers c, be defined by (8.26). Then the Dirichlet series C(s) = 'Lc,jr5 is absolutely convergent, and C(s) = A(s)B(s). Here we encounter a special case of the general principle that an absolutely convergent series may be arbitrarily rearranged without disturb­ ing the absolute convergence or altering the value of the sum. Rather than appeal to the general principle, we give a self-contained proof that applies to the present situation. Proof For positive real numbers R let Sc(R) = 'L1 ,.. ,.;,_ Rcrlr5, and simi­ larly let Sa(M) and Sb(N) denote partial sums of A(s) and of B(s). We show first that Sc(R) tends to A(s)B(s) as R -+ oo. In (8.26) we replace d by m and r jd by n, and thus find that Sc(R) may be written in the form SA R ) = L ( am/m5) ( bn/n5) . (8 .27) mn <R Here the sum is over those pairs m, n of positive integers for which mn � R. Let T1 be the sum formed by restricting m and n by the conditions 1 � m � fR, 1 � n � fR; let T2 be the sum over those m, n for which 1 � m � fR < n � x jm; and let T3 be the sum over those m, n for which 1 � n � fR < m � xjn, so that Sc(R) = T1 + T2 + T3• We note that T1 = Sa(/R)Sb(/R), which tends to A(s)B(s) as R-+ oo. On the other hand, L lam lm -s L lbn ln -s. i< m < {R {R <n <x/m 378 Primes and Multiplicative Number Theory We drop the condition n � xjm in the inner sum and, having done this, drop the condition m � Iii in the outer sum. Thus we see that Here the first factor is finite by hypothesis, and the second factor is the tail of an absolutely convergent series, which therefore tends to 0 as R --. oo. Similarly which tends to 0 as R --. oo. We have shown that the series C(s) is convergent and that C(s) = A(s)B(s). To complete the proof we must establish that the series C(s) is absolutely convergent. To this end we apply the triangle inequality in (8.26) to see that l c,l � L lad llb,1d l. dlr Let C, denote the sum on the right. We now apply the result that we have already demonstrated, with am replaced by lam l and bn replaced by lbn l · This allows us to deduce that the series EC,;rs is convergent. Since lc,l � C, for all r, it follows by the comparison test that the series C(s) is absolutely convergent. This completes the proof. In (8.22) we defined ({s) as a sum of positive numbers. Thus it is obvious that ((s) > 0 for all s > 1. We now express 11 ((s) as a Dirichlet series. Theorem 8.15 If s > 1 then 1/((s) = r.;;. _ 1 JL(m)jms. Proof We apply Theorem 8.14 with am = JL(m) and bn = 1 for all n. To show that the series A(s) is absolutely convergent, we note that IJL(m) l � 1 for all m, so that by the comparison test for s > 1. On comparing Theorem 4.7 with (8.26), we deduce that c1 = 1, and that c, = 0 for all r > 1. Thus A(s}((s) = Ec,;rs = 1 for all s > 1. 8. 2 Dirichlet Series 379 For ease of reference we now state without proof a basic tool from the theory of series. For most of a century this was known as the Weierstrass M-test, though today it is more frequently called the principle of dominated convergence. Lemma 8.16 Let a be a real number, and for each positive integer n suppose that Mn(x) is a function defined on the interval [a, oo). Let Mp M2 , • • • be non-negative real numbers. If (i) IMn(x) l � Mn for all real x � a and all n = 1, 2, · · ·, (ii) lim x ... .,, Mn(x) exists for each n = 1, 2, .. · , and (iii) L:� _ 1Mn converges, then lim x- oo L�- l Mn(x) = L� - l limx _ oo Mn(x). Theorem 8.17 If A(s) = L:anfns is a Dirichlet series with abscissa of absolute convergence u0 , ua < oo, and if A(s) = 0 for all large s, then an = 0 for all n. More generally, if B(s) = L:bn/ns and C(s) = L:cn/ns are two Dirich­ let series that are absolutely convergent for all large s, say for s � u1 and for s � u2, respectively, then the Dirichlet series with coefficients an = bn - en is absolutely convergent for s � u where u = max (u1 , u2). Thus Theorem 8.17 assures us that an expansion of a function as a Dirichlet series is unique. This is analogous to the corresponding uniqueness theo­ rem for power series. The existence of a Dirichlet series expansion is quite a different matter. Here the theory of Dirichlet series departs from that of power series. While a power series expansion exists for any function of a wide class known as analytic functions, those functions expressible by Dirichlet series form a comparatively narrow subclass of analytic functions. Nevertheless, Dirichlet series are of great value in studying arithmetic functions. Proof Suppose that an = 0 for n < N, and that c is a real number such that L: l an ln - c < oo. We apply Lemma 8. 16 with Mn(s) = an(Njn)s and Mn = lan i (Njn Y. We note that lim s _ oo an(Njn)s =aN for n = N, and that this limit is 0 for n > N. Hence by Lemma 8.16, Since A(s) = 0 for all large s by hypothesis, it follows that the limit on the left is 0, and hence that aN = 0. Hence an = 0 for all n, and the theorem is proved. 380 Primes and Multiplicative Number Theory Suppose that am = 1 for all m and that bn = 1 for all n in (8.26). Then c, = d(r), A(s) = B(s) = ((s), and by Theorem 8.14 it follows that 00 E d( r) jrs = (( s)2 (8.28) r= I for s > 1. Recalling (4.1), we take am = J.L(m) and bn = n in Theorem 8.14 to see that oo (( s- 1 ) L cf>( r) jrs = --- r= 1 l'( s) for s > 2. Similarly, we find that E u( r ) jrs = (( s- l)(( s) r- 1 for s > 2. On combining these three identities we see that ( 00 ) ( 00 ) (( s - 1 ) L cf>(m)/ms E d(n)/ns = ( ) · (( s)2 m - 1 n - 1 ( s (8.29) ( 8.30) = (( s- l)(( s) = E u( r) jrs. (8.31) r- 1 By a further application of Theorem 8.14 we see that the product of the two Dirichlet series on the left may be expressed as a Dirichlet series C(s) = Ec,rs, which is absolutely convergent for s > 2 and has coeffi­ cients c, = Ed1,cf>(d)d(rjd). Then by Theorem 8.17 we deduce that L cf>( d) d( rjd) = u( r) (8.32) dlr for all positive integers r. This identity may be proved by elementary reasoning, but the analytic approach offers new insights. For example, the hypothesis in the Mobius inversion formula (Theorem 4.8) amounts to the identity (8.33) while the conclusion in Theorem 4.8 similarly asserts that (8.34) 8. 2 Dirichlet Series 381 In Theorem 4.9 it is shown that the second of these identities implies the first. Thus we have new proofs of Theorem 4.8 and Theorem 4.9, but only for functions f and F, which generate Dirichlet series whose abscissae of absolute convergence are less than infinity. To remove this restriction one could truncate the series. That is, let N be a large integer, and put f1(n) = f(n) for n � N, f1(n) = 0 for n > N. If we replace f by f1 in (8.33) then we obtain a new arithemetic function on the right, say F1• Clearly F1(n) = F(n) for all n � N. All three series in (8.33) are absolutely convergent for s > 1. Thus we have (8.34) with f and F replaced by f1 and F1, and by comparing the coefficients on the two sides we deduce that II(n) = EdlnJL(d)F1(njd) for all positive integers n. This gives the conclu­ sion in Theorem 4.8 for all n � N. Since N may be taken arbitrarily large, we now have the conclusion without restriction. This truncation device can be used similarly to derive Theorem 4.9 analytically, without restriction on the sizes of the functions f and F. When employed in this way, the analytic approach not only yields short proofs of elementary identities but also helps one to discover useful relationships. The analytic method becomes more profound in more advanced work, as the asymptotic prop­ erties of an arithmetic function are related to the analytic properties of the associated Dirichlet series. In particular, the Prime Number Theorem may be derived from the deeper analytic properties of the Riemann zeta function. The coefficients of a Dirichlet series need not be multiplicative, but in case the coefficients are multiplicative we may express the Dirichlet series as a product. Theorem 8.18 The Euler product formula. Suppose that f(n) is a multiplica­ tive function, and put F(s) = E�- d(n)jns. If sis a real number for which the series F(s) is absolutely convergent, then F(s) = n (1 + f( p)jps + f( pz )/Pzs + f( p3)/P3s + ... ) . p In case f(n) = 1 for all n, this is the Euler product for the Riemann zeta function, E 1Jns = n ( 1 + 1Jps + 1Jpzs + 1Jp3s + . .. ) , n = l P ( 8.35) which is valid for s > 1. Ignoring questions of convergence for the mo­ ment, we observe that when the product on the right is expanded we obtain a sum of terms of the form 1j( p!1Pz2 • • • P':' )s, where p 1, p2 , • • · , P, are distinct primes. That is, the right side, when expanded, gives a sum 382 Primes and Multiplicative Number Theory Er(n)jns where r(n) is the number of ways of expressing n as a product of prime powers. Since the Dirichlet series coefficients of a function are unique, the identity (8.35) asserts that r(n) = 1 for all n. That is, each positive integer is a product of prime powers in precisely one way. In this sense the important identity (8.35) constitutes an analytic formulation of the fundamental theorem of arithmetic. Proof By the comparison test we see that 00 1 + l f( P ) I /Ps + l f( P2 ) I/P2s + · · · � L i f(n) l /ns < 00 (8.36) n = l for any prime number p. Thus by Theorem 8.14 we find that ( 1 + f(2)/2s + f(4)j4s + · · · )( 1 + f(3) j3s + f(9) /9s + · · · ) = L f( n) jns n E.A/ where Jf/ = {1, 2, 3, 4, 6, 8, 9, 12, · · · } is the set of all positive integers of the form 2a3f:l. Here we have used the fact that f(2a)f(3f:l) = f(2a3f:l). More generally, let y be a positive real number, put f/n) = f(n) if n is composed entirely of primes p � y, and put f/n) = 0 otherwise. Then by repeated applications of Theorem 8.14 we deduce that 00 n ( 1 + f( p ) jps + f( p2 )/P2s + f( p3)/p3s + ... ) = E fy(n) jns. P._ Y n = l Here the sum on the right is a subsum of the series F(s), and it remains to show that this series tends to F(s) as y --t oo. As y increases, the sum includes more of the terms in the series F(s), so it is to be expected that the series would tend to F(s ). To construct a rigorous proof that this is the case, we apply the principle of dominated convergence (Lemma 8.16) with Mn = lf(n)l /ns and Mn(y) = f/n)jns. Since lim y ..... oo f/n) = f(n) for each fixed n, we see by lemma 8.16 that lim E fy(n) jns = E lim fy(n ) jns = F( s) , y �oo n � l n = l y � oo and the proof is complete. Corollary 8.19 Suppose that f(n) is a totally multiplicative function, and put F(s) = E�- d(n)jns. If sis a real number for which the series F(s) is 8. 2 Dirichlet Series 383 absolutely convergent, then F( s) = 0 ( 1- f( p) jps) - 1 • p In particular, ({ s) = 0 { 1- 1/ps) - 1 {8.37) p for s > 1. Proof Since f(n) is totally multiplicative, the series on the left in (8.36) is a geometric series, and we deduce from its convergence that lf(p)l < 1 for all primes p, and that this series converges to 1/(1 - f( p)jp5). Inserting this in Theorem 8. 18, we obtain the stated result. We have noted that a multiplicative function is determined by its values on the prime powers. Since the Euler product involves only these values, this formula provides a quick means of spotting relationships between various Dirichlet series. For example, we consider the case f(n) = f.L(n). Since f.L(p) = -1 for all primes p and f.L( pa) = 0 whenever a > 1, we see at once that the product in Theorem 8. 18 is n/1 - 1jp5) for s > 1. On comparing this with (8.37), we obtain a second proof of Theorem 8.15. The identities (8.28), (8.29), and (8.30) can similarly be derived by comparing Euler products. We consider one more example of this technique. Corollary 8.20 For s > 1, Here the coefficient is 1 if n is square-free, and 0 otherwise. {8.38) Proof The function f(n) = IJL(n) l is multiplicative. Moreover, f( p) = 1 for all p and f( pa) = 0 when a > 1. Thus when s > 1, the product in Theorem 8.18 is n/1 + 1jp5). Using the identity 1 + z = (1 - z2)/ (1 - z), we deduce that this product is n/1 - 1jp25)j(l - 1jp5). By the Euler product formula (8.37) for the zeta function we see that this product is ((s)j((2s). To enlarge our repertoire of useful Dirichlet series, we show that a Dirichlet series may be differentiated term-by-term. 384 Primes and Multiplicative Number Theory Theorem 8.21 Let ua be the abscissa of absolute convergence of the Dirichlet series A(s) = E';; _ 1an/n5• Then u0 is also the abscissa of absolute d convergence of the series B(s) = - E';; _ 1 an0og n)jn5, and ds A(s) = B(s) for s > u0• Proof Let u; denote the abscissa of absolute convergence of B(s). Since log n > 1 for all n > 2, by the comparison test \"' Hence A(s) is absolutely convergent whenever B(s) is absolutely conver­ gent, so that u0 � u; . To establish an inequality in the reverse direction we note that if e > 0 is given then there is a number N = N(e) such that log n < n• for all n � N. Thus by the comparison test \"' n �N n -N Hence B(s) is absolutely convergent whenever A(s - e) is absolutely convergent, so that u; � ua + e. Since e may be arbitrarily small, it follows that u; � u0 • Combining these two inequalities, we conclude that u; = u0 • To prove the second assertion we suppose that s is fixed, s > u0 , and we choose c so that u0 < c < s. If lh I � s - c, then (A(s +h)- A(s))/ h = E':: � 1 Mn(h), where Mn(h) = ann -5(n -h - l)jh. We note that lim h __. 0 Mn(h) = -an(log n)n -s. Thus to complete the proof we have only to confirm that (8 .39) To this end we appeal to the principle of dominated convergence (Lemma 8.16) with lim x ..... \"' replaced by lim h __.0• We take Mn = 1 an 10og n)n -c and note that by the mean value theorem of differential calculus there is a � between h and 0 such that Mn(h) = -an(log n)n -s -€_ Thus IMn(h) l � Mn uniformly for lh l � s- c. As 'LnMn < oo, the principle of dominated convergence applies, so we have (8.39), and the proof is complete. 8.2 Dirichlet Series 385 Corollary 8.22 The following Dirichlet series have abscissa of absolute convergence 1, and for s > 1 converge to the indicated values: -('( s) = E (log n)n -s, n =l oo A(n) log (( s) = E -1 -n -s, n = l og n C(s) - - = E A(n)n -s. (( s) n =l (8.40) (8.41) (8.42) Proof The first identity follows by applying Theorem 8.21 to (8.22). To derive the second formula we take logarithms of both sides of the Euler product identity (8.37). Thus we find that log (( s) = E log (l - p -s) - I . p Using the familiar power series expansion log (l - z)- 1 = 'f:k= 1 z kjk, which is valid for lzl < 1, we deduce that the above is 00 1 = E E -p-ks. p k- 1 k This double series of positive numbers may be rearranged to put the numbers pk in increasing order, without affecting either convergence or its value. Thus we see that we have a Dirichlet series whose coefficients may be written in the form A(n) jlog n. Since these coefficients are all � 1, by comparison with the Dirichlet series (8.22) for the zeta function we deduce that this series is absolutely convergent for s > 1. On the other hand, in Theorem 1.19 and again in Theorem 8.8(d) we have seen that the series E1/p diverges. Thus by the comparison test the series (8.41) diverges when s = 1. The third identity (8.42) follows immediately from (8.41) by Theorem 8.21, so the proof is complete. In view of (8.40) and (8.42), the identity of Theorem 8.1 may be ('( s) expressed analytically as - (( s) · ({s) = -('(s). Our main interest in this section has been to show how Dirichlet series may be used to discover identities among arithmetic functions, and especially how Euler products may be used to establish identities involving multiplicative functions. In more advanced work, the analytic properties of 386 Primes and Multiplicative Number Theory a Dirichlet series Eann -s are used to derive asymptotic estimates for the coefficient sum En -. xa n . As a first step in this direction, we establish some very simple asymptotic estimates. Theorem 8.23 The estimates 1 (( s ) = s _ 1 + 0( 1 ) , 1 C( s) = - 2 + 0( 1) , ( s- 1) ('( s ) 1 (( s) = - s- 1 + 0( 1 ) hold uniformly for s > 1. (8.43) (8 .44) ( 8.45 ) From the first of these estimates we see that log ({s) - oo as s - 1 +. Then by using (8.41) one may deduce that E1/p = oo. In this case we have already proved more by elementary means, but in general one may use information concerning the asymptotic size of a Dirichlet series to give corresponding information regarding its coefficients. Proof Let s be a positive real number. Then u-s is a decreasing function of u, so that (n + n-s � fn n +tu-s du � n -s for n = 1, 2, · · ·. On sum­ ming over n we find that ({s) - 1 � f� u-s du � ((s) for s > 1. Here the integral is 1/(s - 1), so it follows that 1/( s- 1) � (( s) � 1 + 1/(s - 1 ) (8 .46) uniformly for s > 1. Thus we have (8.43). If s > 1, then (log u)u -s is a decreasing function of u for u :;?; e, so that Oog(n + OXn + o-s � fn n + 10og u)u -s du � Oog n)n -s for n = 3, 4, · · · . On summing over n we find that -C( s) - ( log 2)2 -s - ( log 3)3 -s Since J? (log u)u -s du = 0(1), we deduce that 388 Primes and Multiplicative Number Theory 7. Use Dirichlet series to prove that Edlnf.L(d) d(njd) = 1 for all posi­ tive integers n. 8. Use Dirichlet series to prove that Edlnf.L(d)u(njd) = n for all posi­ tive integers n. 9. Use Dirichlet series to prove that Ed1nu(d) = nEdln d(d)jd for all positive integers n. 10. Use Euler products to give an analytic proof of the identity (4.1) at the end of Section 4.3. 11. Let A(n) = (- 1)0<n> be Liouville's lambda function. Use Euler prod­ ucts to show that [.A(n)jns = ({2s)/((s) for s > 1. Let f(n) = Ed1n lf.L(d) IA(n/d). Use Dirichlet series to show that f{l) = 1 a�d that f(n) = 0 for all n > 1. 12. Use Euler products to show that E2 w<n> /ns = ((s )2 I ((2s) for s > 1. Use Dirichlet series to show that Ed1nA(d)2w<n /d) = 1 for all positive integers n. 13. Let k be a given positive integer. Show that E 1/ns = (( s) n (l - 1/ps) = (( s)Edikf.L( d) jds fors > 1. n = l plk (n , k)= l 14. Let k be an integer > 1. We say that a positive integer n is kth power free if 1 is the largest kth power that divides n. Let f(n) = 1 if n is kth power free, and put f(n) = 0 otherwise. Prove that Ef(n)/ns = ({s)/((ks) for s > 1. 15. Let dk(n) denote the number of ordered k-tuples (d., d2, . • ·, dk) of positive integers such that d1 d2 • • • dk = n. Show that d(n) = d2(n). Show that r.�_ 1dk(n)n -s = ((s)k for s > 1 and k = 1, 2, · · ·. 16. Let ./1/ be the set of those positive integers n such that 3% d(n). Show that En E .A'n -s = ({s)/(((2s)((3s)) for s > 1. *17. Let ./1/ denote the set of those positive integers n whose base 10 representation does not contain the digit 9. Find the abscissa of absolute convergence of the Dirichlet series En E .Yn -s. *18. Prove that E d(n)2 ;ns = ((s )4 /((2s) for s > 1. *19. Prove that Edlnf.L(d) d(njd)2 = Edlnf.L(d)2 d(njd) for all positive in­ tegers n. *20. Show that f.L(n)2 * d(n) = f.L(n) * d(n)2 for all positive integers n. *21. Suppose that the Dirichlet series A(s) = Ean/ns is convergent when s = s0• Prove that A(s) is absolutely convergent when s > s0 + 1. *22. Let f(n) be an arithmetic function such that for any e > 0 there exists an n0(e) with the property that n -• < lf(n) l < n• for all 8. 3 Estimates of Arithmetic Functions 389 n > n0(e). (That is, lim n -.oo log lf(n) l /log n = 0.) Show that the two Dirichlet series Ea n/ns and Ef(n)an/ns have the same abscissa of absolute convergence. *23. Show that if s > 1 then ((s) = s �oo[u]u -s - l du. (H) s 00 *24. Show that if s > 1 then ((s) = -- - sj {u}u -s - l du. Show that s - 1 1 this latter integral is absolutely convergent for all s > 0. Let ((s) be defined for 0 < s < 1 by this formula. Show that if 0 < s < 1 then ((s) = -s fooo{u}u -s - l du. Conclude that ((s) < 0 for 0 < s < 1 if the zeta function is defined in this way in this interval. *25. Use Dirichlet series to show that A( n) log n + E A( d) A(n/d) = E JL(d)( log n/d) 2 di n for all positive integers n. din 8.3 ESTIMATES OF ARITHMETIC FUNCTIONS In this section we investigate the size of some important arithmetic functions, both on average and in the extreme. Suppose we wish to determine the asymptotic mean value of the arithmetic function F(n). By the Mobius inversion formula (Theorems 4.7 and 4.8) we know that there is a unique function f(n) such that F( n) = Ef( d). (8.47) di n If f(n) is small on average then we can obtain a useful estimate of the average of F(n) by writing E F( n) = E Ef( d) = E f( d) = E f( d) [xjd ] . n .;;x di n Since [ y] = y + 0(1), this is d, m dm .;;x d .;;x = x E f( d)/d + o( E I f( d) 1)· d .;;x d .;;x (8.48) If the first sum is a partial sum of a convergent series and the second sum is small compared with x, then this simple argument reveals that F(n) has 390 Primes and Multiplicative Number Theory the asymptotic mean value E';' f(d)jd. We consider several applications that fit this description. Theorem 8.24 For x � 2, 6 E cfJ(n) jn = -2 x + O(log x) . n �x 1T Proof Taking F(n) = c/J(n)jn, by (4.1) we see that (8.47) holds with f(d) = J.L(d)jd. Thus the first sum in (8.48) is 1/((2) - Ed > xJ.L(d)jd2• This latter sum has absolute value less than E 1/d2 < j\"' 1ju 2 du = 1/( x- 1) = 0( 1 /x). d >x x - 1 ( 8.49) When inserted in (8.48), this error term contributes an amount that is 0(1). In Appendix A.3 it is shown that ((2) = rr2 /6, which gives the constant in the main term. The second sum in (8.48) is O(Ed .; x1/d) = O( fJlju du) = O(log x), so the proof is complete. In our next application of (8.48), we encounter a situation in which f(d) is usually 0, but occasionally takes large values. Theorem 8.25 Let Q(x) denote the number of square-free integers not exceeding x, that is, Q(x) = Ln .; xiJ.L(n)l. Then Q(x) = -;x + 0(/X). 1T\" Proof From Corollary 8.20 we find that IJ.L(n) l = Ld2inJ.L(d). This may be proved by elementary reasoning by observing that any positive integer n is uniquely of the form n = rs2 where r is square free. Thus n is square free if and only if s = 1, and hence IJ.L(n) l = EdisJ.L(d). Since dis if and only if d2 in, this gives the stated identity. This identity is of the form (8.47) where f(d) = J.L(k) if d = k 2, f(d) = 0 otherwise. Thus (8.48) gives Q( x) = x E J.L ( k )/k 2 + o( E IJ.L (k ) l) · k c;.fX k s;.fX By (8.49) the first sum is 1/((2) + O(lj /X), and the second sum is � IX. To complete the proof it suffices to quote the value ((2) = rr2 /6 from Appendix A.3. In most applications of (8.48), the functions f(n), F(n) are multiplica­ tive, though this is not required. For example, in Section 4.2 we defined 8.3 Estimates of Arithmetic Functions 391 w(n) to be the number of distinct prime factors of n, w(n ) = Ep1nl. This is of the form (8.47) with f(d) = 1 if d is prime, f(d) = 0 otherwise. Here f( d) is not multiplicative, but (8.48) is still useful. Theorem 8.26 For x � 5, I: w(n) = x log log x + bx + O( xjlog x ) n �x where b is the constant in Theorem 8.8(d). Since Es < n._ x log log n = x log log x + O(xjlog x), we say that w(n) has average value log log n . In particular, it follows that lim supn .... .. w(n )j log log n � 1, and that lim infn .... .. w(n)jlog log n � 1. Proof The estimate (8.48) gives I: w(n ) =x I: 1/p + o( I: 1) . n�x p �x p �x By Theorem 8.8(d) the first sum on the right is = log log x + b + O(ljlog x). The second sum on the right is 'lT(x), which is O(xjlog x) by Chebyshev's estimate (Corollary 8.6). We may also estimate the mean of the divisor function d(n) = Ed1n1 using (8.48). Taking f(d) = 1 for all d, we find that I: d(n) =x I: 1/d + o( I: 1) . n._x d ._x d._x The first sum on the right may be approximated by an integral, which gives the approximation I: 11 d = log x + 0 ( 1) , ( 8.50) d._x and hence we see that En .;; x d(n) = x log x + O(x). The leading term here is the same as in Lemma 8.2, so we say that the average size of d(n) is log n. In this case the function f(d) is not very small, and the main term in (8.48) is only slightly larger than the error term. By exercising greater care we shall establish a more precise estimate for the sum of the divisor function, but first we must refine the estimate 392 Primes and Multiplicative Number Theory (8.50). To this end, for n � 2 let 5n = r lju du - ljn . n-l ( 8 .51) Since the function 1/u is decreasing, the integral is less than 1/(n - 1) but greater than 1/n, so that 0 < 5n < lj(n(n - 1)). We note that ( E 1/n) -log N = 1 - E 5n . n-l n-2 Since the 5n are positive, the right side is clearly a decreasing function of the integral variable N. Moreover, since 5n = O(ljn2), the right side converges to a finite limit 00 as N-+ oo. This number y = 0.57721 · · · is called Euler's constant. (It is conjectured that y is irrational, but this has not yet been proved.) Substituting y in the former expression, we see that N E 1/n = log N + y + E 5n n-l n= N + l for all positive integers N. Here the sum on the right is 1 < E n- N+ l n(n - 1) so we conclude that N E -- - - = ljN, 00 ( 1 1 ) n- N +l n - 1 n log N + y < E 1/n < log N + y + 1/N n=l (8.52) for all positive integers N. For our present purposes it is convenient to replace the upper limit N of summation by a real number x. Lemma 8.27 The estimate En.:: xl !n =log x + y + O(ljx) holds uni- formly for x � 1. � Proof We apply (8.52) with N = [x]. Since log N � log x < log (N + 1) < log N + ljN, we have the stated estimate. 8. 3 Estimates of Arithmetic Functions Theorem 8.28 For x ;;> 2, E d(n) = x log x + (2-y - 1) x + 0( IX) . n .;;x 393 In Problems 29-37 at the end of this section we sketch a method of I. M. Vinogradov which shows that the above holds with the error term replaced by O(x 113(log x)2). Proof We write d(n) = E d1n1, and choose k so that dk = n . Thus the left side above may be written as a double sum EL d, k dk .;;x This counts lattice points under the hyperbola uv = x in the first quadrant of the u-v plane. We consider first those pairs d, k for which d � IX. Summing first over d and then over k , we see that such terms contribute an amount E E 1 = E [x/d ] . d .;; .fX k .;;xjd d .;; .fX By symmetry, the terms for which k � IX contribute the same amount. The terms for which both d � IX and k � IX have been counted twice, so their contribution, [ IXF, must be subtracted. Thus we see that E d(n) = 2 E [x/d ] - [ IX) 2• n .;;x d .;; .fX We replace [xjd ] by xjd + 0(1) and note that the sum of these error terms is O(IX). Similarly [IXF =<IX + 0(1))2 = x + O(IX ), so the sum above is -x + o( IX ) + 2x E 1/d, d .;; .fX and the stated estimate now follows from Lemma 8.27. Theorem 8.29 Let q be a positive integer. The number of integers n such that (n, q) = 1 and M + 1 � n � M + N is (cfJ(q)jq)N + 0(2w(ql), uniformly for all integers M and all positive integers N. 394 Primes and Multiplicative Number Theory Proof Let F(n) = 1 if (n, q) = 1, F(n) = 0 otheiWise . Then we have (8.47) with f(d) = J.L(d) for dlq, f(d) = 0 otheiWise. Thus the number in question is M+N E F(n) = n =M+ l M+N M+N E E J.L( d) = E J.L( d) E 1 . n -M+ l din diq d iq n -M+ l din The inner sum on the right is [(M + N)jd] - [Mjd], which is (M + N)jd + 0(1) - Mjd + 0(1) = Njd + 0(1). Inserting this in the above, we obtain the main term NEdiqJ.L(d)jd = Ncf>(q)jq, and the error term O(Ediq i J.L(d)l). This last sum is the number of square-free divisors of q, which is zw<q>. This gives the stated result. From Theorem 8.29 we see that any interval longer than czw<q>qjcf>(q) must contain a number relatively prime to q . To put this in a more useful form, we must determine how large zw(q) is, in terms of more familiar functions of q. Theorem 8.30 For every e > 0 there is an n0(e) such that ifn > n0(e) then w(n) < (1 + eXlog n)jlog log n. This is best possible in the sense that there exist infinitely many n such that w(n) > (1 - eXlog n)jlog log n. At the opposite extreme, we observe that w(n) � 1 for all n > 1, and that w(n) = 1 for infinitely many n (the prime powers). From the upper bound of Theorem 8.30 we see that (I +e) log 2 ( ) log log q zw q < q for all large integers q. Since the exponent on the right tends to 0 as q tends to infinity, it follows in particular that for every 8 > 0 there is a q0(8) such that every interval (x, x + q6) contains a reduced residue (mod q ), provided that q > q0(8). Proof We establish the upper bound for w(n) first. Let e be given, e > 0, and put f(u) = (1 + eXlog u) jlog log u. By a simple application of dif­ ferential calculus we see that f(u) is increasing for u > ee = 15.154 · · · . We call an integer r � 16 record-breaking if w(r) > w(n) for all positive integers n < r. Let .9R be the set of all such record-breaking numbers r. We first prove the desired inequality for r E !JR. We note that w(n) = k if and only if n is divisible by precisely k different primes. The least such n 8. 3 Estimates of Arithmetic Functions 395 is simply the product of the first k primes. That is, a number r is record-breaking if and only if r is of the form r = n P .;; yP for some suitable real number y ;;<!> 5. But then log r = it(y) and w(r) = '7T(y), and hence by Theorem 8.5 we have log r 2 w( r) = - + O( yj( Iog y ) ) . log y Since ay < it(y) < by, by taking logarithms we find that log y = log i}(y) + 0(1). That is, log y = log log r + 0(1). Thus the above gives log r 2 w( r) = + o{{log r) j{log log r) ) . log log r {8.53) From this it follows that there is an r0(e) E !R such that w(r) ,.;; f(r) whenever r E !R, r ;;<!> r0(e). Now suppose that n ;;<!> r0(e ), and let r be the largest member of !R not exceeding n. Then r0(e) ,.;; r ,.;; n and w(n) ,.;; w(r) ,.;; f(r ). Since f is increasing, it follows that f(r) ,.;; f(n), so that w(n) ,.;; f(n). Thus we have the stated upper bound. From (8.53) we see that w(r) > (1 - e Xlog r)j(log log r) for all suf­ ficiently large r E .cR. This suffices to give the lower bound, since the set !R is infinite. Since zw<nl is the number of square-free divisors of n, it follows that zw<nl does not exceed the total number d(n) of divisors of n. This inequality zw<n) ,.;; d(n) is also evident from the formula d(n) = n/a + 1) given in Theorem 4.3. Here a = a(p, n), and n = np\"' is the canonical factorization of n. The simplest upper bound for d(n) is obtained by observing that if din then njd also divides n, and of this pair of divisors at least one is ,.;; /n, so that d(n) < 2/n. We now show that for any given S > 0 we can determine the maximum of d(n)jnh. Let f/a) =(a + l)jpll\"', so that d(n)/nll = nPf/a). We now let a be an integral variable, and for each prime p we find the a for which f/a) is maximal. We note that f/a) ;;<!> f/a - 1) if and only if (a + l)jpha ;;<!> ajpll<a - o, which is equiva­ lent to the inequality 1 + 1/a ;;<!>ph, which in turn is equivalent to a ,.;; 1/( pll - 1). Similarly we find that f/a) ;;<!> f/a + 1) if and only if a ;;<!> 1j( ph - 1) - 1. Thus f/a) is maximal if and only if a lies in the interval ..f= [1/(ph - 1) - 1, 1/(ph - 1)]. Take a0(p) = [1/(ph - 1)]. If 1/ (ph - 1) is not an integer then a0(p) is the unique integer in ..f, and hence f/0) < f/1) < · · · < f/a0) > f/a0 + 1) > · · · . On the other hand, if 1/(ph - 1) is an integer then f/0) < f/1) < · · · < f/a0 - 1) 396 Primes and Multiplicative Number Theory = f/a0) > f/a0 + 1) > · · · . Thus in either case f/a) takes its maxi­ mum value when a = a0. We also observe that if p > 2 1/ll then a0(p) = 0 and f/a0) = 1. Thus we have shown that for any 8 > 0 the inequality d(n) � ellnll holds for all positive integers n, where ell = n fp( ao). (8 .54) p <;; 2 l /B For example, if 8 = 1/2 we find that a0(2) = 2, so that f2(a0) = 3/2, that a0(3) = 1, so that fia0) = 2/ 13, and that a0(p) = 0 for all p > 3. Hence e 112 = 13, and we deduce that d(n) � f3fl for all positive inte­ gers n, with equality if and only if n = 12. By estimating the size of ell when 8 is small, we obtain the following more general bound. Theorem 8.31 For every e > 0 there is an n0(e) such that if n > n0(e) then d(n) < n(l +eXIog 2)/ log log n_ Since d(n) � 2w<n) for all n, from Theorem 8.30 we know that for any e > 0 there exist infinitely many n for which d(n) > n<I-eX Iog 2)/ log log n . Proof We take 8 = (1 + e/2Xlog 2)jlog log n, and show that ell < n<e /2XIog 2)/ log log n for all sufficiently large n. For this purpose it is enough to construct a crude bound for ell . We note that f/a) �a + 1. Since pll > 1 + 8 log p, it follows that 1/(pll - 1) < 1/(8 log p) � 1/(8 log 2). Thus f/a0) � 1 + 1/(8 log 2). Since we may assume that 8 � 1, we conclude that f/a0) < ej8 . Since '7T(2 111l ) � 2 1 /ll, it follows that ell < (ej8)2 118• Expressed as a function of n, we note that 2 1/ll = Oog n )•;o+e /2) = (log nXlog n) -e l<2 +e). Consequently, ell < n\"\" where TJ = (log n ) - e/(2 +e> log( 4log log n ) . Since TJ0og log n) tends to 0 as n --+ oo, it follows that TJ < (e/2Xlog 2)jlog log n for all large n , and the proof is complete. From Theorem 8.26 we see that the average size of w(n) is asymptoti­ cally log log n. We now show that w(n) is quite near log log n for most n. Theorem 8.32 For n > 5, E1 < n .:: x( w(n) - log log n)2 = O(x log log x). Proof We shall prove the following three estimates: L w( n) 2 � x(log log x) 2 + O(x log log x) , (8.55) 1 <n .;;x - 2 L w( n )(log log n ) = -2x(log log x ) 2 + O(x log log x ) , ( 8.56) 1 <n .;;x L (log log n ) 2 = x(loglog x) 2 + O( x log log x) . ( 8.57) l<n�x 8. 3 Estimates of Arithmetic Functions 397 The stated result then follows by adding these three quantities. With a little more work we could show that (8.55) holds with the inequality replaced by equality (see Problem 23 at the end of this section), but the weaker estimate (8.55) is sufficient for our purposes. Letting p and q denote primes, we see from the definition of w(n) that the left side of (8.55) is n .;;x pi n ql n P q n .;;x Pi n , q l n If p = q, then the inner sum on the right is [ x 1 p ], while if p * q, then this sum is [xI pq ]. Thus the above is l: [ xlp ] + L [ xlpq ] . p .;;x p >Fq, pq .;;x Since [u] � u for all real u, we obtain a larger quantity by dropping the square brackets. We also drop the condition p * q, and sum over all pairs p, q of primes for which p � x, q � x. Thus the above is � L xlp + L xlpq = x( L l ip) + x( L lip r. p::t;,x p :s;;.x, q \"!!!;X p:t:;,x p �x and (8.55) follows by appealing to Theorem 8.26. To prove (8.56) we write the sum on the left as log x (log log x) L w( n ) - L w ( n ) log -- . l< n .;;x l< n .;;x log n By Theorem 8.26, the first term above is x(log log x)2 + O(x log log x). To estimate the second sum we consider separately 1 < n � IX and IX < n � x. In the first interval the logarithmic factor is O(log log x), so by Theorem 8.26 the first interval contributes an amount that is O(IXOog log x)2). In the second interval the logarithmic factor is 0(1), so by Theorem 8.26 the second interval contributes an amount that is O(x log log x). On combining these estimates we obtain (8.56). To prove (8.57) we note that the summand is increasing for n ;;;. 3, so that the sum is = f30og log u)2 du + O((log log xf). By integrating by parts, we see that this integral is 2 jx log log u x( log log x) - 3(log log 3) 2 - 2 du . 3 log u Since the integrand here is bounded, the integral from 3 to IX is O(IX ). 398 Primes and Multiplicative Number Theory For .fX � u � x the integrand is O((log log x) ;tog x ), so the integral over this second range is O(x(log log x)jlog x). On combining these estimates we obtain (8.57), and the proof is complete. Corollary 8.33 The inequality lw( n) - log log n I < (log log n )314 (8 .58) holds for all n, 1 < n � x, with the exception of at most O(xj(log log x)112 ) integers n. Proof We mat ignore the n � .fX, since there are at most .fX such n. Suppose that vx < n � x and that (8.58) fails. Then n contributes at least (log log n)312 to the sum in Theorem 8.32. Since (log log n)312 � tOog log x)312 for .fX < n � x, it follows from Theorem 8.32 that there can be at most O(xj(log log x)112) such n. By the same method that we used to prove Theorem 8.32 we can also show that Theorem 8.32 holds with w(n) replaced by fl(n) (or see Problem 24 below). Here fl(n) denotes the total number of prime factors of n, counting multiplicity. That is, if n = np\", then O(n) = Ep a. Since 2w<n> � d(n) � 2 °<n> for all n, by arguing as in the proof of Theorem 8.33 we find that d(n) lies between (log n)O -e) log 2 and (log n)O +e) log 2 for most integers n. Since log 2 = 0.693 · · · , the normal size of d(n) is smaller than the average size, log n, which we estimated in Theorem 8.28. By using more advanced techniques it may be shown that the larger average reflects a relatively sparse sequence of n for which d(n) is disproportionately large. That is, there are roughly xj(log x)2 1og 2 integers n � x for which d(n) is roughly (log n)1 + 2 log 2• PROBLEMS 1. Show that En .;; Ncf>( n)[ Njn ] = N(N + 1)/2 for all positive integers N. 2. Show that En .; )2n - 1)[ xjn] = Em .;; J xjm ]2. 3. Show that En .;; x u(n)jn = (7T 2j6)x + O(log x) for x � 2. 4. Show that En ._ xn(n ) = x log log x + O( x) for x � 5. 5. Let k be a fixed integer, k > 1. Show that the number of k th power-free numbers n � x is xj((k) + O( x 11k ). 6. Let 8n be defined as in (8.50). Show that 8n = fn n_ 1{u}ju2 du. Deduce that -y = 1 - f� {u}ju 2 du . 7. Find the least constant C1 13 such that d(n) � C113n113 for all positive integers n. For which n does equality hold? 8. 3 Estimates of Arithmetic Functions 399 8. Let q be an integer, q > 1. Put ((u )) = {u} - 1/2. Show that the number of integers n, 1 � n � x, for which (n, q) = 1 is xrp(q)jq + E/x), where E/x) = - EdJqf..L(dX( xjd)). Show that IE/x) l � 2w(q) - l . 9. Adopt the notation of the preceding problem, suppose that every prime divisor p of q is = 3 (mod 4), that w(q ) is even, and that q is squarefree. Show that f..L(d)( ( 4 q d )) = - 1/4 for all divisors d of q. Deduce that E/q/4) = 2 w(q) - 2, and that E/3qj4) = -2w(q> - 2• 10. Show that 1 � .O(n) � (log n)/log 2 for every integer n > 1. Show also that there are infinitely many integers for which .O(n) = 1, and infinitely many integers for which .O(n) = (log n) jlog 2. 11. Show that (6/rr 2)n2 < u(n)rp(n) < n2 for all positive integers n. Deduce that En ,;; xn/rp(n ) = O(x), and hence that En ,;; xl!r/J(n) = O(log x ). (H) 12. Use Euler products to show that njrp(n) = EdJn f..L(d)jrp(d). Deduce that En ,;; x nfrp( n) = ex + O(log x) for x ;;:. 2, where c = ((2)((3) 1 ((6). 13. Let D( x) = En ,;; x d(n). Show that En ,;; xd(n )/n = D( x)jx + JtD(u )ju 2 du . Deduce that En ,;; xd(n)jn = 0/2Xlog x)2 + O(log x). 14. Let d/n) be defined as in Problem 15 of the preceding section. Show that d3(n) = Edln d(d). Deduce that En ,;; x d3(n ) = 0/2)x0og x)2 + O(x log x). 15. Let !R be the set of those positive integers r ;;:. 3 such that rp( r) jr < rp(n)jn for every integer n < r. Show that r E !R if and only if r can be written in the form r = nP ,. yP for some real number y ;;:. 3. Show that if r E !R then rp( r)jr = c(log log r)- 1(1 + O(ljlog log r)) where c is the constant in Theorem 8.8(e). Deduce that rp(n) ;;:. cn(log log n) - 1(1 + O(l jlog log n)) for all integers n;;:. 3. 16. Let 1/J( x, y) denote the number of integers n, 1 � n � x, such that all prime factors of n are � y. Let p be a prime number. Show that the number of integers n, 1 � n � x, whose largest prime factor is p, is 1/J(xjp, p). Deduce that 1/J(x, y) = Ep ,;; yi/J(xjp, p). 17. Adopt the notation of the preceding problem. Show that if y ;;:. x then 1/J(x, y) = [x]. Show that if IX� y � x then 1/J(x, y) = [x] ­ Ey < p .;; Axjp ]. Deduce that 1/J(x, x 11\") = (1 - log u)x + O(xjlog x) uniformly for 1 � u � 2. *18. Suppose that F(n) = n Edln f(d) for all n. Show that En ,;; x F(n) = Ed ,;; xdf(d)[ xjd]([ xjd] + 0/2. Show that this latter sum is (lj2)x 2 Ed,. xf(d)jd + O(xEd ,;; xlf(d) l ). *19. Show that En ,;; x r/J(n) = (3jrr 2)x 2 + O(x log x) for x;;:. 2. 400 Primes and Multiplicative Number Theory 20. Let <l>( x) denote the sum considered in the preceding problem. Show that the number of pairs m, n of positive integers for which m � x, n � x, g.c.d. (m , n) = 1 is 2<l>(x) + 1. Deduce that if two integers are chosen at random from the interval [1, x] then the probability that they are relatively prime is approximately 6/Tr 2 if x is large. *21. Show that Ln .;; xu(n) = (Tr 2/12)x 2 + O(x log x) for x;;:. 2. *22. Let f( z) be a polynomial with integral coefficients, and let N/m) denote the number of solutions of the congruence f(x) = O(mod m). Show that the number of integers n, 1 � n � x, such that f(n) = 0 (mod d) is xN/d)jd + O( N/d)). Deduce that if q is a given posi­ tive integer then the number of integers n, 1 � n � x, such that ( f(n), q) = 1 is xnp1q(l - N/ p)jp) + O(np1q(1 + N/ p))). *23. Let f( z) = kz +a . Show that N/ p) = p if pl k and pi a, that N/ p) = 0 if pl k, p,ta, and that N/ p) = 1 if p%k. Deduce that the number of integers n = a (mod k ), 1 � n � x, for which (n , q) = 1 is (xjk)np1q,p-fk(l - 1/p) + 0(2w<q>) if g.c.d. (a, k, q) = 1. *24. Show that the number of ways of writing a positive integer N in the form N =a + b where a > 0, b > 0, (a, q) = (b, q) = 1, is N np1q, p1NO - 1 /p)np1q, p-fN( 1 - 2/p) + o(3w<q>). *25. Let p and q denote prime numbers. Explain why (Ep < rx1/p)2 � Epq .;; x1/( pq ) � (Ep ..; x 1/p)2• Deduce that Lpq ..; x1/(pq) = (log log x )2 + O(log log x ). *26. Show that Ln .;; /O.(n) - w(n)f = Lp* ..;x, k > l(2 k - 3)[ xjp k ] + Ep* ..; x, qi ..; x, k > l, j> l,p,. q[ xj( pkqj)] where p and q denote primes. Deduce that En ,. /fl(n) - w(n)f = O( x), and hence that Ln ..; x(O.(n) - log log nf = O( x log log x). *27. Let c be the constant in Theorem 8.8(e). Show that c = e -y where 'Y is Euler's constant, as follows. First show that L 1/( kp k ) = 0{ 1/log x) p ,k p ..;x, p* >x for x ;;:. 2. By taking logarithms in Theorem 8.8(e), deduce that I: A( n)/(n log n) = log log x - log c + 0{ 1/log x) { 8.59) n ..;x for x ;;:. 2, and hence that L A( n)/( n log n) n ..;x I: 1/n - ( 'Y + log c ) + 0{1 /log 2x ) {8 .60) n ..;log x for x ;;:. 1 . Write this as T1 = T2 + T3 + T4, and for 0 < 8 � 1/2 put 8.4 Primes in Arithmetic Progressions 401 I;{i3) = 8f�1!(x)x-1-6 dx. Show that IM ) = log ((l + 8) = log 1/8 + 0(8). Show that /2(8) = log (l - e-6)-1 = log 1/8 + 0(8 ). Show that Ii8) = -y - log c. Show that Ii8) = 0(8 log 1/8). By com­ paring these estimates as 8 -+ o +, show that /3(8) = 0, and thus derive the proposed identity. *28. Write the relation En .;; Jog xl/n = log log x + 'Y + O(l jlog x) in the form U1 = U2 + U3 + U 4, and for 0 < 8 � 1 /2 put 1;(8) = 8f�lf;(x)x-1-6 dx. Show that Ji8) = log 1/8 + J;Oog u)e -\" du . By comparing estimates as 8-+ o + , show that J;Oog u)e -u du = -y . *29. Let ((u)) be defined as in Problem 8. Show that Ln .;; xl!n = log X + 'Y - ((x))jx - f;'((u))ju 2 du. Show that this integral is O(ljx 2). *30. Write Ln ,.;; x d(n) =X log X + (2-y - Ox + .Mx). Show that a(x) = - 2En ,.. .;-x«xfn)) + 0(1). *31. Show that if (a, q) = 1 and f3 is real, then E� = 1((anjq + f3)) = ((qf3)). *32. Show that if A � 1, lf'(x) - ajql � Ajq 2 for 1 � x � q and (a, q) = 1, then E�=1( f(n)) = O(A). *33. Suppose that Q is an integer, Q � 1, that B � 1, and that 1 jQ3 � ±f\"(x) � BjQ3 for 0 � x � N, where the choice of sign is indepen­ dent of x. Show that numbers a\" q,, N, can be determined, 0 � r � R for some R, so that (i) (a\" q,) = 1; (ii) q, � Q; (iii ) if'(x)- arfq,l � 1j(q,Q) for N, � x � N,+ 1; (iv) N0 = 0, N, = N,_ 1 + q,_ 1 for 1 � r � R, N - Q � NR � N. *34. Show that under the hypotheses of Problem 33, E�_0(( f(n))) = O(B(R + 1) + Q). *35. Show that in the situation of Problem 31 that the number of s for which a5jq5 = a,jq, is O(Q2jq2). Suppose that 1 � q � Q. Show that the number of r for which q, = q is O((Q2jq 2XBNqjQ3 + 1)). Deduce that R = O(BN(log 2Q)/Q + Q2). *36. Suppose that Q is an integer, Q � 1, that B � 1, and that 1/Q3 � ±f\"(x) � BjQ3 for 0 � x � N where the choice of sign is indepen­ dent of x. Show that E';/_ 0(( f(n))) = O(B 2N(log 2Q)/Q + BQ2). *37. Show tht if U � fX then Eu < n .;; w((xjn)) = O(x 113 log x). Let a(x) be as in Problem 28. Show that ,Mx) = O(x 113(log x)2). 8.4 PRIMES IN ARITHMETIC PROGRESSIONS In 1839, Dirichlet established that if (a, q) = 1 then there are infinitely many primes p = a (mod q ). We have already indicated special arguments that give this result for certain special pairs of q and q (notably Problem 402 Primes and Multiplicative Number Theory 36 at the end of Section 2.8), but we now describe the original method of Dirichlet applied to arbitrary pairs of relatively prime integers. To provide a model for the method, we first show that there are infinitely many primes by using properties of the zeta function. Then we extend this to primes in arithmetic progressions modulo 4, and finally we outline the further ideas that are required to extend the argument to general q. By combining the formula (8.41) of Corollary 8.22 with the estimate (8.43) of Theorem 8.23, we find that \"' A(n) 1 E --n -s =log -- + O(s - 1) n -1 log n s - 1 uniformly for 1 < s � 2. We recall that A(n) is nonzero only when n is a prime power, say n = pk. The contribution made by the higher powers of the primes is \"' 1 . \"' L L -p -ks � L L P -ks = L P -2s/(1 - P -s) p k=2 k p k-2 p 1 � E < oo p p( p - 1) uniformly for s ;;;:. 1. Hence 1 L P -s = log -- + 0( 1) p s- 1 (8.61) (8.62) for s > 1. If there were only finitely many primes then the sum on the left would tend to a finite limit as s tends to 1 from above. Since the right side tends to infinity as s tends to 1 from above, we conclude that there are infinitely many primes. In order to show that there are infinitely many primes of the forms 4k + 1 and 4k + 3 we introduce two arithmetic functions x0(n) and x1(n) that allow us to distinguish between these two arithmetic progressions. For even n we set x0(n) = x1(n) = 0, while if n is odd then we put x0{n) = 1 and x1(n) = ( -l)<n - I)/2. Thus x1(n) = 1 if n = l (mod 4) and x1(n) = -1 if n = 3 (mod 4). Consequently, ( xo(n) + x1(n) )/2 = {� (xo(n) - x1(n) )/2 = {� if n = 1 (mod 4) , otherwise ; if n = 3 ( mod 4) , otherwise . (8.63) 8.4 Primes in Arithmetic Progressions 403 The advantage that these functions offer in picking out arithmetic progres­ sions is that the functions x;(n) are totally multiplicative. Let x(n) denote either one of these functions. Since lx(n) l � 1 for all n, the Dirichlet series L(s , x) = L x(n)n -s n � l is absolutely convergent for s > 1. Since x(n) is totally multiplicative, by Corollary 8.19 it follows that L( s , x) = 0(1 - x( P)/ps) - 1 p for s > 1. Taking logarithms, and arguing as in the proof of Corollary 8.22, we deduce that \"' A(n) log L(s , x) = L - 1 -x(n) n -s n �l og n for s > 1. From the estimate (8.61) it follows that L X( P)/P5 = log L( s, x) + 0( 1) p for s > 1. By the identities (8.63) we conclude that and p p ;;;; l(mod 4) p P \"'3 (mod 4) for s > 1. 1 1 1/ps = 2 log L( s, x0) + 2 log L ( s, x1 ) + 0( 1) 1 1 1jps = 2 log L(s, x0) - 2 log L(s, x1 ) + 0( 1) (8 .64) It remains to determine the behavior of log L(s, x 0) and of log L(s, x 1 ) as s tends to 1 from above. If we take x = Xo in (8.64), we find that the sum on the left differs from that in (8.62) only in that the prime 2 is 404 Primes and Multiplicative Number Theory missing. Thus from (8.62) we deduce that for s > 1. 1 log L ( s, x0) = log -- + 0(1) s - 1 As for L(s, x1), we note first the Dirichlet series Ex1(n)n -s is abso­ lutely convergent only for s > 1. We now show that this series is condi­ tionally convergent for 0 < s � 1. To this end, observe that the coefficient sum En ,.. xX 1(n) takes only the values 0 and 1, and hence is uniformly bounded. If s is fixed, s > 0, then the sequence n -s tends to 0 monotoni­ cally. Hence by Dirichlet's test the series Ex 1(n)n -s converges. Indeed, this series is uniformly convergent for s ;;:. l> > 0. Since each term is a continuous function of s, it follows that the sum L( s, x1 ) = Ex1(n)n -s is a continuous function of s for s > 0. In particular, L(s, x1) tends to the finite limit L(l, x1) as s tends to 1. Moreover, by the alternating series test we see that 1 - 1/3 < L(l, x1) < 1. (With more work one may show that LO, x1) = 'lT/4.) Hence LO, x1) > 0, so that log L(s, x1) tends to the finite limit log L(l, x 1) as s tends to 1 from above. As log L(s, x 1) = 0(1) uniformly for s ;;:. 1, on combining our estimates we find that and that p p •l (mod 4) p p =3 (mod 4) 1 1 1jp5 = -log -- + 0(1) 2 s- 1 1 1 1jp5 = -log -- + 0( 1) 2 s- 1 for s > 1. Since the right side tends to infinity as s tends to 1 from above, it follows that the sums on the left contain infinitely many terms. In general, a Dirichlet character modulo q is a function x(n) from l to C with the following properties: (i) If m = n (mod q) then x(m) = x(n); (ii) x(mn) = x(m)x(n) for all integers m and n; (iii ) x(n) = 0 if and only if (n, q) = 1. If x is a Dirichlet character (mod q) then from (ii) it follows xO) = xO · 1) = xO)x(l), which implies that xO) = 0 or 1. In view of (iii), we deduce that xO) = 1. If (n, q) = 1, then n<�><q> = 1 (mod q) by Euler's congruence, and hence by (i) we see x(n<�><q>) = xO) = 1. Then by (ii) it follows that x(n)<f><qJ = 1. That is, if (n, q) = 1 then x(n) is one of the 8.4 Primes in Arithmetic Progressions 405 rp(q )th roots of unity. With more work one may show that there are precisely rp(q) Dirichlet characters (mod q ), and that a linear combination of them may be formed to pick out any given reduced residue class, as was done in (8.63) for the modulus 4. Let x0(n) = 1 when (n, q) = 1, x0(n) = 0 otherwise. This is the principal character (mod q ). The corresponding Dirichlet series L(s, x0) is closely related to the Riemann zeta function, and it is not hard to show that 1 log L ( s, x 0) = log -- + 0 {log log q) s - 1 for s > 1. Let x(n) be a character (mod q), x * Xo · It may be shown that I:� _ 1 x(n ) = 0, from which it follows that coefficient sum Ln .;; xx(n) is uniformly bounded. Thus by Dirichlet's test the series L(s, x) = I:x(n)n -s defines a continuous function for s > 0, x * Xo · The final step of the proof, and the most challenging, is to show that L(l, x) * 0 when x * Xo· PROBLEMS 1. Let x0(n) denote the principal Dirichlet character (mod 3), and put x1(n) = 1 for n = l(mod3), x 1(n) = -1 for n = 2(mod3), x1(n) = 0 for n = 0 (mod 3). Construct an argument similar to that in the text, to show that there exist infinitely many primes of the form 3k + 1, and of the form 3k + 2. 2. Let Q0(x) denote the number of odd square-free numbers not exceed­ ing x, and let Q(x) denote the total number of square-free integers not exceeding x, as in Theorem 8.25. Show that Q0( x) + Q0(xj2) = Q( x). Deduce that Q0( x) = Q(x) - Q(xj2) + Q(xj4) - Q(xj8) + · · · . Conclude that Q0(x) = (4j'7T)x + 0(/X). 3. Let x1(n) denote the nonprincipal character (mod 4) defined in the text. Put S(x) = Ln ._ xX 1(n), and suppose that F(n ) = Ldin f(d). Show that Ln .;; xX1(n)F(n) = Ld .;; xX1(d)f(d)S(xjd). Show that this latter sum is O(I:d .- )f(d) i ). 4. Let x1(n) denote the nonprincipal character (mod 4) defined in the text. Show that Ln .;; xX1(n) i JL(n) l = 0(/X). Deduce that the number of square-free integers of the form 4k + 1 not exceeding x is (2/'lT )x + 0( /X), and that the same is true with 4k + 1 replaced by 4k + 3. 5. Let x(n) denote either one of the Dirichlet characters (mod 4) defined in the text. Show that I:�_ 1 x(n )rp(n)n -s = L(s - 1, x)/L(s, x) for s > 1, and that I:� _ 1 x(n)d(n)n -s = L(s, x)2 for s > 1. 6. Let x0(n) denote the principal Dirichlet character (mod q ). Show that L(s, x0) = ((s)np1q(l - p -s) for s > 1. 406 Primes and Multiplicative Number Theory NOTES ON CHAPTER 8 §8.1 The first proof of (8.2) was given by Chebyshev in 1852. Chebyshev used his estimates to prove Bertrand's postulate, which had been stated by J. L. F. Bertrand in 1845. It is known that for any e > 0 there is a choice of the v(d) in Chebyshev's method that gives (8.2) with 1 - e < a and b < 1 +e. However, the only known proof of this makes use of the Prime Number Theorem, so this does not provide a method of proving the Prime Number Theorem (as far as we know). For an account of this, see H. G. Diamond and P. Erdos, \"On sharp elementary prime number estimates,\" L'Enseignement math., 26 (1980), 313-321. A more general survey of elementary techniques in prime number theory has been given by H. G. Diamond, \"Elementary methods in the study of the distribution of prime numbers,\" Bull. Amer. Math. Soc. 7 (1982), 553-589. Theorem 8.8 was proved in 1874 by F. Mertens. The method of Problem 13 can be improved to obtain a constant larger than (log 5) /2, but E. Aparicio, \"Metodos para el calculo aproxi­ mado de Ia desviacion diofantica uniforme minima a cero en un segmento,\" Rev. Mat. Hisp.-Amer. 38 (1978), 259-270, has shown that one cannot obtain a constant arbitrarily close to 1 using non-negative polynomials P( x). §8.2 At a more advanced level, it is useful to consider Dirichlet series for complex value of s, not just real s. The deeper analytic properties of the zeta function are closely related to the asymptotic distribution of the prime numbers. Indeed, in 1859 G. F. B. Riemann showed that the error term in the prime number theorem may be ex­ pressed as a sum involving the complex numbers p for which (( p ) = 0. Since the Euler product for ((s) is absolutely convergent when .9Re-s > 1, it follows that ((s) * 0 in this half-plane. That is, if p = {3 + i-y and (( p) = 0 then {3 � 1. From Riemann's analysis it becomes evident that to prove the Prime Number Theorem one must show further that there are no zeros for which {3 = 1. It was in this way that Hadamard and de Ia Vallee Poussin proved the Prime Number Theorem in 1896. Riemann conjectured that much more is true, namely that if (( p ) = 0 and {3 > 0 then {3 = 1/2. This is known as the Riemann Hypothesis. Riemann located the first several complex zeros of the zeta function, and confirmed that they do lie exactly on the line .9Re-s = 1/2 in the complex plane. Such calculations have been performed over successively longer ranges, so that it is now known that the first 1,500,000,000 zeros of the zeta function have real part 1/2. It is known that the Riemann Hypothesis is equivalent to a sharp quantitative version of the Prime Number Theorem, namely to the estimate 1/J(x) = x + O( x 112(log x)2). §8.3 Theorem 8.24 was proved by F. Mertens in 1874. It is known that the error term is O((log x)a ) with a < 1, and in the opposite 408 Primes and Multiplicative Number Theory = EP(._/k) should hold for countably infinite families of pairwise disjoint sets, not merely finite collections. To see that this fails, take � = {k}. Then 5(�) = 0 for each k and the ._/k are pairwise disjoint, but 5( u ._/k) = MM = 1 * E 5(._/k). Nevertheless, useful insights may be gained by exploring the extent to which probabilistic predictions reflect reality. For example, let ._/(d) = {n: din}. Then 5(._/(d)) = 1jd. More­ over, ._/(d1) n ._/(d2) = ._/([d1, d2]), so that if (d1, d2) = 1 then 5(._/(d1) n ._/(d2)) = 5(._/(d1)) 5(._/(d2)). We observe that an integer n is square free if and only if there is no prime p such that p2 in. That is, the set of square-free numbers is precisely n P ._/( p2)c. One might therefore anticipate that the density of square-free integers is np (1 - 1/p 2), which is precisely what is established in Theorem 8.25. Since the \"probability\" that pin is 1/p, we might also anticipate that the \"expected\" number of prime divisors of n is approximately Ep .;; n1/p. This is borne out in Theorem 8.26, and Theorem 8.32 is suggested by considering the variance of a random variable. On the other hand, predictions based on probabilis­ tic models are not so reliable when applied to sieving questions. For example, by the sieve of Eratosthenes we know that if q = OP .,. .,txP• then the number of integers n � x such that (n, q) = 1 is rr( x ) - rr(.fX ) + 1. This suggests that perhaps rr( X) is asymptotic to X n p .. .,tx(l - 1 I p ). However, by Theorem 8.8(e) in conjuction with Problem 27 at the end of Section 8.3 we see that the prediction here is that rr( x) - axjlog x where a = 2e - -r = 1. 1229 · · · , in conflict with the Prime Number Theorem. In more advanced work, tools of probability theory may be used to provide information concerning the statistical distribution of arithmetic functions. For example, it is known that for any number c, 0 � c � 1, the set of integers n for which rp(n) � en has an asymptotic distribution, say F(c). Moreover, the function F(c) is continuous, F(O) = 0, F(l) = 1, F(c) is strictly increasing, and F(c) is singular (i.e., F'(c) = 0 for all c outside a set of Lebesgue measure 0). The body of knowledge that has developed in this area over the past 50 years is recounted in P. D. T. A. Elliott, Probabilistic Number Theory, Springer-Verlag (New York), 1979. §8.4 The first proof that if (a, q) = 1 then there exist infinitely many prime numbers p =a (mod q) was given by P. G. Lejeune Dirichlet in 1839. The exposition in Davenport (1980) follows the historical develop­ ment quite closely. Other expositions are found in the books listed in the General References by Apostol, Borevich and Shafarevich, Hua, Landau, LeVeque (1956), and Serre. CHAPTER 9 Algebraic Numbers To illustrate one purpose of this chapter, we take a different approach to the equation x2 + y 2 = z 2 than in Section 5.3. Factoring x2 + y2 into ( x + yi)(x - yi), we can write x2 + y 2 = ( x + yi ) ( x - yi ) = z 2 • If from this we could conclude that x + yi and x - yi are both squares of complex numbers of the same type, we would have . ( ' ) 2 X + yl = r + Sl , . ( ' )2 x- yz= r-sz . Equating the real and the nonreal parts here gives y = 2rs and so z = r2 + s2• These are precisely the equations in Theorem 5.5. The steps in this argument are valid but not quite complete, and they need justification. We shall make the justification and complete the argument in Section 9.9. A similar factoring of x 3 + y3 into three linear factors in complex numbers is used in the last section of the chapter to prove that x3 + y3 = z 3 has no solutions in positive integers. This is another case of Fermat's last theorem, x 4 + y4 = z 4 having been proved impossible in positive integers in Section 5.4. However, the analysis of Diophantine equations is just one purpose of this chapter. Algebraic integers are a natural extension of the ordinary integers and are interesting in their own right. The title of this chapter is a little pretentious, because the algebraic numbers studied here are primar­ ily only quadratic in nature, satisfying simple algebraic equations of degree 2. The plan is to develop some general theory in the first four sections and then take up the special case of the quadratic case, where much more can be said than in the general case. 409 410 Algebraic Numbers 9. 1 POLYNOMIALS Algebraic numbers are the roots of certain types of polynomials, so it is natural to begin our discussion with this topic. Our plan in this chapter is to proceed from the most general results about algebraic numbers to stronger specific results about special classes of algebraic numbers. In this process of proving more and more about less and less, we have selected material of a number theoretic aspect as contrasted with the more \"alge­ braic\" parts of the theory. In other words, we are concerned with such questions as divisibility, uniqueness of factorization, and prime numbers, rather than questions concerning the algebraic structure of the groups, rings, and fields arising in the theory. The polynomials that we shall consider will have rational numbers for coefficients. Such polynomials are called polynomials over Q, where Q denotes the field of rational numbers. This collection of polynomials in one variable x is often denoted by Q[x], just as all polynomials in x with integral coefficients are denoted by Z[x], and the set of all polynomials in x with coefficients in any set of numbers F is denoted by F[x]. That the set of rational numbers forms a field can be verified from the postulates in Section 2. 11. In a polynomial such as the nonnegative integer n is called the degree of the polynomial, and a0 is called the leading coefficient. If a0 = 1, the polynomial is called monic. Since we assign no degree to the zero polynomial, we can assert without exception that the degree of the product of two polynomials is the sum of the degrees of the polynomials. A polynomial f(x) is said to be divisible by a polynomial g(x), not identically zero, if there exists a polynomial q(x) such that f(x) = g(x)q(x) and we write g(x) lf(x) . Also, g(x) is said to be a divisor or factor of f(x). The degree of g(x) here does not exceed that of f(x), unless f(x) is identically zero, written f(x) = 0. This concept of divisibility is not the same as the divisibility that we have considered earlier. In fact 3 1 7 holds if 3 and 7 are thought of as polynomials of degree zero, whereas it is not true that the integer 3 divides the \"integer 7. Theorem 9.1 To any polynomials f(x) and g(x) over Q with g(x) \"¢ 0, there correspond unique polynomials q(x) and r(x) such that f(x) = g(x)q(x) + r(x), where either r(x) = 0 or r(x) is of lower degree than g(x). 9. 1 Polynomials 411 This result is the division algorithm for polynomials with rational coefficients, analogous to the division algorithm for integers in Theorem 1.2. Most of the theorems in this section have analogues in Chapter 1, and the methods used earlier can often be adapted to give proofs here. Although it is stated explicitly in Theorem 9.1 that f(x) and g(x) belong to Q[x], as do q(x) and r(x), this assumption will be taken for granted implicitly in subsequent theorems. Proof In case f(x) = 0 or f(x) has lower degree than g(x), define q(x) = 0 and r(x) = f(x). Otherwise divide g(x) into f(x) to get a quotient q(x) and a remainder r(x). Clearly q(x) and r(x) are polynomi­ als over Q, and either r(x) = 0 or the degree of r(x) is less than the degree of g(x) if the division has been carried to completion. If there were another pair, q1(x) and r1(x), then we would have r( x) - r1( x) = g( x) {q1( x) - q( x)} . Thus g(x) would be a divisor of the polynomial r(x) - r1(x), which, unless identically zero, has lower degree than g(x). Hence r(x) - r1(x) = 0, and it follows that q(x) = q1(x). Theorem 9.2 Any polynomials f(x) and g(x), not both identically zero, have a common divisor h(x) that is a linear combination of f(x) and g(x). Thus h(x) if(x), h(x) lg(x), and h(x) = f( x) F( x) + g(x)G( x) {9.1) for some polynomials F(x) and G(x). Proof From all the polynomials of the form (9. 1) that are not identically zero, choose any one of least degree and designate it by h(x). If h(x) were not a divisor of f(x), Theorem 9. 1 would give us f(x) = h(x)q(x) + r(x) with r(x) ¥= 0 and r(x) of degree lower than h(x). But then r(x) = f(x) - h(x)q(x) = f(x){1 - f(x)q(x)} - g(x){G(x)q(x)}, which is of the form (9. 1) in contradiction with the choice of h(x). Thus h(x) if(x) and similarly h(x) lg(x). Theorem 9.3 To any polynomials f(x) and g(x), not both identically zero, there co\"esponds a unique monic polynomial d(x) having the properties (1) d(x) if(x), d(x)lg(x); (2) d(x) is a linear combination of f(x) and g(x), as in (9. 1); (3) any common divisor off(x) and g(x) is a divisor of d(x), and thus there is no common divisor having higher degree than that of d(x). 412 Algebraic Numbers Proof Define d(x) = c- 1h(x), where c is the leading coefficient of h(x), so that d(x) is monic. Properties (1) and (2) are inherited from h(x) by d(x). Equation (9. 1) implies d(x) = c- 1f(x)F(x) + c- 1g(x)G(x), and this equation shows that if m(x) is a common divisor of f(x) and g(x), then m(x) id(x). Finally, to prove that d(x) is unique, suppose that d(x) and d1(x) both satisfy properties (1), (2), (3). We then have d(x)ld1(x) and d1(x) ld(x), hence d1(x) = q(x)d(x) and d(x) = q1(x)d1(x) for some poly­ nomials q(x) and q1(x). This implies q(x)q1(x) = 1, from which we see that q(x) and q1(x) are of degree zero. Since both d(x) and d1(x) are monic, we have q(x) = 1, d1(x) = d(x). Definition 9.1 The polynomial d(x) is called the greatest common divisor of f(x) and g(x). We write (f(x), g(x)) = d(x). Definition 9.2 A polynomial f(x), not identically zero, is irreducible, or prime, over Q if there is no factoring, f(x) = g(x)h(x), of f(x) into two polynomials g(x) and h(x) of positive degrees over Q. For example x 2 - 2 is irreducible over Q. It has the factoring (x - .fiXx + .fi) over the field of real numbers, but it has no factoring over Q. Theorem 9.4 If an irreducible polynomial p(x) divides a product f(x)g(x), then p(x) divides at least one of the polynomials f(x) and g(x). Proof If f(x) = 0 or g(x) = 0 the result is obvious. If neither is identi­ cally zero, let us assume that p(x)%f(x) and prove that p(x) lg(x). The assumption that p(x)-{'f(x) implies that (p(x), f(x)) = 1, and hence by Theorem 9.3 there exist polynomials F(x) and G(x) such that 1 = p(x)F(x) + f(x)G(x). Multiplying by g(x) we get g( x) = p( x)g( x) F( x) + f( x)g( x)G(x) . Now p(x) is a divisor of the right member of this equation because p(x) if(x)g(x), and hence p(x) lg(x). Theorem 9.5 Any polynomial f(x) over Q of positive degree can be factored into a product f(x) = cp 1(x)pix) · · · p/x) where the Pix) are i\"educible monic polynomials over Q. This factoring is unique apart from order. Proof Clearly f(x) can be factored repeatedly until it becomes a product of irreducible polynomials, and the constant c can be adjusted to make all 9. 1 Polynomials 413 the factors monic. We must prove uniqueness. Let us consider another factoring, f(x) = cq1(x)q2(x) · · · q/x), into irreducible monic polynomi­ als. According to Theorem 9.4, p1(x) divides some Q;(x), and we can reorder the qm(x) to make p1(x)lq1(x). Since p1(x) and q1(x) are irre­ ducible and monic, we have p1(x) = q1(x). A repetition of this argument yields and k = j. Definition 9.3 A polynomial f(x) = a0xn + · · · +an with integral coeffi­ cients aj is said to be primitive if the greatest common divisor of its coefficients is 1. Obviously, here we mean the greatest common divisor of integers as defined in Definition 1.2. Theorem 9.6 The product of two primitive polynomials is primitive. Proof Let a0xn + · · · +an and b0xm + · · · +bm be primitive polynomi­ als and denote their product by c0xn +m + · · · +cn +m· Suppose that this product polynomial is not primitive, so that there is a prime p that divides every coefficient ck . Since a0xn + · · · +an is primitive, at least one of its coefficients is not divisible by p. Let a; denote the first such coefficient and let bj denote the first coefficient of b0xm + · · · +bm, not divisible by p. Then the coefficient of xn +m -i-j in the product polynomial is {9.2) summed over all k such that 0 � k � n, 0 � i + j - k � m. In this sum, any term with k < i is a multiple of p. Any term with k > i that appears in the sum will have the factor bi+j -k with i + j - k < j and will also be a multiple of p. The term a;bj, for k = i, appears in the sum, and we have ci +j = ajbj (mod p). But this is in contradiction with pici +j• p,{' a;, p,{'bj. Theorem 9.7 Gauss's lemma. If a monic polynomial f(x) with integral coefficients factors into two monic polynomials with rational coefficients, say f(x) = g(x)h(x), then g(x) and h(x) have integral coefficients. Proof Let c be the least positive integer such that cg(x) has integral coefficients; if g(x) has integral coefficients take c = 1. Then cg(x) is a primitive polynomial, because if p is a divisor of its coefficients, then p lc because c is the leading coefficient, and (cjp)g(x) would have integral coefficients contrary to the minimal property of c. Similarly let c1 be least positive integer such that c1h(x) has integral coefficients, and hence 414 Algebraic Numbers c1 h(x) is also primitive. Then by Theorem 9.6 the product {cg(x)}{c1h(x)} = cctf(x) is primitive. But since f(x) has integral coefficients, it follows that cc 1 = 1 and c = c 1 = 1. PROBLEMS 1. If f(x) lg(x) and g(x) if(x), prove that there is a rational number c such that g(x) = cf(x). 2. If f(x) lg(x) and g(x)ih(x), prove that f(x)ih(x). 3. If p(x) is irreducible and g(x) lp(x), prove that either g(x) is a constant or g(x) = cp(x) for some rational number c. 4. If p(x) is irreducible, prove that cp(x) is irreducible for any rational c * 0. *5. If a polynomial f(x) with integral coefficients factors into a product g(x)h(x) of two polynomials with coefficients in II), prove that there is a factoring g1(x)h1(x) with integral coefficients. 6. If f(x) and g(x) are primitive polynomials, and if f(x) lg(x) and g(x) if(x), prove that f(x) = ±g(x). 7. Let f(x) and g(x) be polynomials in Z[ x], that is, polynomials with integral coefficients. Suppose that g(m) if(m) for infinitely many posi­ tive integers m. Prove that g(x)if(x) in Q[x], that is, there exists a quotient polynomial q(x) with rational coefficients such that f(x) = g(x)q(x). (Remark : The example g(x) = 2x + 2, f(x) = x2 - 1 with m odd shows that q(x) need not have integral coefficients.) (H) 8. Let f(x) and g(x) be primitive nonconstant polynomials in Z[x] such that the greatest common divisor {f(m), g(m)) > 1 for infinitely many positive integers m. Construct an example to show that such polyno­ mials exist with g.c.d.(f(x), g(x)) = 1 in the polynomial sense. 9. Given any nonconstant polynomial f(x) with integral coefficients, prove that there are infinitely many primes p such that f(x) = 0 (mod p) is solvable. (H) 9.2 ALGEBRAIC NUMBERS Definition 9.4 A complex number � is called an algebraic number if it satisfies some polynomial equation f(x) = 0 where f(x) is a polynomial over Q. Every rational number r is an algebraic number because f(x) can be taken as x - r in this case. 9.2 Algebraic Numbers 415 Any complex number that is not algebraic is said to be transcendental. Perhaps the best known examples of transcendental numbers are the familiar constants -rr and e. At the end of this section, we prove the existence of transcendental numbers by exhibiting one, using a very simple classical example. Theorem 9.8 An algebraic number g satisfies a unique i\"educible monic polynomial equation g(x) = 0 over Q. Furthennore, every polynomial equa­ tion over Q satisfied by g is divisible by g(x). Proof From all polynomial equations over Q satisfied by g, choose one of lowest degree, say G(x) = 0. If the leading coefficient of G(x) is c, define g(x) = c- 1G(x), so that g({) = 0 and g(x) is monic. The polynomial g(x) is irreducible, for if g(x) = h1(x)h2(x), then one at least of h1(g) = 0 and h2({) = 0 would hold, contrary to the fact that G(x) = 0 and g(x) = 0 are polynomial equations over I!) of least degree satisfied by r Next let f(x) = 0 be any polynomial equation over Q have gas a root. Applying Theorem 9.1, we get f(x) = g(x)q(x) + r(x). The remainder r(x) must be identically zero, for otherwise the degree of r(x) would be less than that of g(x), and g would be a root of r(x) since f({) = g({) = 0. Hence g(x) is a divisor of f(x). Finally, to prove that g(x) is unique, suppose that g1(x) is an irreducible monic polynomial such that g .<g) = 0. Then g(x)lg1(x) by the argument above, say g1(x) = g(x)q(x). But the irreducibility of g1(x) then implies that q(x) is a constant, in fact q(x) = 1 since g1(x) and g(x) are monic. Thus we have g1(x) = g( x). Definition 9.5 The minimal equation of an algebraic number g is the equation g(x) = 0 described in Theorem 9.8. The minimal polynomial of g is g(x ). The degree of an algebraic number is the degree of its minimal polynomial. Definition 9.6 An algebraic number g is an algebraic integer if it satisfies some monic polynomial equation f( x) = Xn + bl xn - l + ... +bn = 0 with integral coefficients. (9 .3) Theorem 9.9 Among the rational numbers, the only ones that are algebraic integers are the integers 0, ± 1, ± 2, · · · . Proof Any integer m is an algebraic integer because f(x) can be taken as x- m. On the other hand, if any rational number mjq is an algebraic 416 integer, then we may suppose (m, q) = 1, and we have ( m ) n ( m ) n - l q + bl q + '' ' + bn = 0, Thus q l mn, so that q = ± 1, and mjq is an integer. Algebraic Numbers The work \"integer\" in Definition 9.6 is thus simply a generalization of our previous usage. In algebraic number theory, 0, ± 1, ± 2, · · · are often referred to as \"rational integers\" to distinguish them from the other algebraic integers that are not rational. For example, .fi is an algebraic integer but not a rational integer. Theorem 9.10 The minimal equation of an algebraic integer is monic with integral coefficients. Proof The equation is monic by definition, so we need prove only that the coefficients are integers. Let the algebraic integer g satisfy f(x) = 0 as in (9.3), and let its minimal equation be g(x) = 0, monic and irreducible over Q. By Theorem 9.8, g(x) is a divisor of f(x), say f(x) = g(x)h(x), and the quotient h(x), like f(x) and g(x), is monic and has coefficients in Q. Applying Theorem 9.7, we see that g(x) has integral coefficients. Theorem 9.11 Let n be a positive rational integer and g a complex number. Suppose that the complex numbers (} 1 , (} 2, • • • , (} n , not all zero, satisfy the equations goj = aj, l(Jl + aj, 202 + · · · +aj, n(Jn , j = 1 , 2 , · · · ,n (9.4) where the n2 coefficients aj, i are rational. Then g is an algebraic number. Moreover, if the a j, ; are rational integers, g is an algebraic integer. Proof Equations (9.4) can be thought of as a system of homogeneous linear equations in 0 1 ,02 ,. · · ,0n . Since the 0; are not all zero, the determinant of coefficients must vanish: g- at, I -at , 2 - a2, t g- a2, 2 - a l, n - a2, n = 0. Expansion of this determinant gives an equation C + b 1gn - t + · · · +bn 9.2 Algebraic Numbers 417 = 0, where the b; are polynomials in the aj, k · Thus the b; are rational, and they are rational integers if the a j, k are. Theorem 9.12 If a and f3 are algebraic numbers, so are a + f3 and af3. If a and f3 are algebraic integers, so are a + f3 and a f3. Proof Suppose that a and f3 satisfy 13' + b , /3' - 1 + 0 0 0 + b , = 0 with rational coefficients a; and bi. Let n = mr, and define the complex numbers 81, • • · , (Jn as the numbers 1, /3, a, af3, ar - l atJ ' in any order. Thus 81, . • · , (Jn are the numbers aspr with s = 0, 1, - · · ,. m - 1 and t = 0, 1, · · · , r - 1. Hence for any (Ji, In either case we see that there are rational constants hi. 1, - • · ,hj, n such that a8i = hj, 18 1 + · · · +hi. n(Jn · Similarly there are rational constants kj, , , . . . , kj, n such that f38i = kj,l81 + ... +kj, n(Jn, and hence (a +f3}8i = (h j,l + kj,1 )81 + · · · +(hj, n + kj,n)On. These equations are of the form (9.4), so we conclude that a + f3 is algebraic. Furthermore, if a and f3 are algebraic integers, then the ai, bi, hj, i• kj, i are all rational integers, and a + f3 is an algebraic integer. We also have af38i = a( kj, 1 8 1 + · · · + kj,n(Jn) = ki. 1a8 1 + · · · +kj, n a(Jn from which we find af38i = cj, 1(J1 + · · · +cj, l (Jn where cj,i = ki, 1h1, ; + kj,zhz.; + · · · +kj, n hn, ;· Again we apply Theorem 9.11 to conclude that af3 is algebraic, and that it is an algebraic integer if a and f3 are. This theorem states that the set of algebraic numbers is closed under addition and multiplication, and likewise for the set of algebraic integers. The following result states a little more. Theorem 9.13 The set of all algebraic numbers fonns a field. The set of all algebraic integers fonns a ring. 418 Algebraic Numbers Proof Rings and fields are defined in Definition 2.12. The rational numbers 0 and 1 serve as the zero and unit for the system. Most of the postulates are easily seen to be satisfied if we remember that algebraic numbers are complex numbers, whose properties we are familiar with. The only place where any difficulty arises is in proving the existence of additive and multiplicative inverses. If a * 0 is a solution of then -a and a- 1 are solutions of and respectively. Therefore, if a is an algebraic number, then so are -a and a- 1 • If a is an algebraic integer, then so is -a, but not necessarily a- 1• Therefore the algebraic numbers form a field, the algebraic integers a ring. Example of a Transcendental Number To demonstrate that not all real numbers are algebraic, we prove that the number 00 f3 = E 10 -j!= o.11ooo1ooo · · · j = l is trancendental. (This was one of the numbers used by Liouville in 1851 in the first proof of the existence of transcendental numbers.) Suppose {3 is algebraic, so that it satisfies some equation n f( x) = E cixi = 0 j-0 with integral coefficients. For any x satisfying 0 < x < 1, we have by the triangle inequality J f'( x) J =I . E jcixi - ll < E ljci l = C, J=l where the constant C, defined by the last equation, depends only on the coefficients of f(x). Define {3k = Ej= 110 -i! so that 00 f3 - f3k = E 10 -j! < 2 . 10 -<k + I>!. i-k + l 420 Algebraic Numbers Theorem 9.14 If g is an algebraic number of degree n, then every number in Q(g) can be written uniquely in the form ao + a ,g + ... +an _ ,gn - l where the a; are rational numbers. (9.5) Proof Consider any number f(g)jh(g) of Q(g). If the minimal polyno­ mial of g is g(x), then g(x)%h(x) since h{g) '4= 0. But g(x) is irreducible, so the greatest common polynomial divisor of g(x) and h(x) is 1, so by Theorem 9.3 there exist polynomials G(x) and H(x) such that 1 = g(x)G(x) + h(x)H(x). Replacing x by g and using the fact that g(g) = 0, we get 1 /h(g) = H(g) and f(g)jh(g) = f(g)H(g). Let k(x) = f(x)H(x) so that f(g)jh(g) = k(g). Dividing k(x) by g(x), we get k(x) = g(x)q(x) + r(x), and hence f(g)jh(g) = k(g) = r(g) where r(g) is of the form (9.5). To prove that the form (9.5) is unique, suppose f(g) and rM) are expressions of the form (9.15). If r(x) - r1(x) is not identically zero, then it is a polynomial of degree less than n. Since the minimal polynomial of g has degree n, we have r(g) - r1(0 '4= 0, r(g) '4= r1(g), unless r(x) and r 1( x) are the same polynomial. The field Q(g) can be looked at in a different way, by consideration of congruences modulo the polynomial g(x). That is, in analogy with Defini­ tion 2.1, for any polynomial G(x) of degree at least one we write f1( x) =f2(x) (mod G(x) ) if G(x)l(f1(x) - fz{x)). Ultimately, in order to get back to Q(g) we take the minimal polynomial g(x) of g for G(x). However, the theory of congruences is more general, and we start with the polynomial G(x) over Q irreducible or not. The properties of congruences in Theorem 2. 1 can be extended at once to the polynomial case. For example, part (iii) of the theorem has the analogue: If iJ{x) = f2(x) (mod G(x)) and h 1(x) = h2(x) (mod G(x)), then iJ(x)h 1(x) = f2(x)h2(x) (mod G(x)). By the division algorithm Theorem 9. 1, any polynomial f(x) over Q is mapped by division by G(x) onto a unique polynomial r(x) modulo G(x); f( x) = G(x)q(x) + r( x) , f( x) = r(x) ( mod G(x) ) . Thus the set of polynomials r(x) consisting of 0 and all polynomials over Q of degree less than n constitute a \"complete residue system modulo G(x)\" in the sense of Definition 2.2. Of course the present residue system has infinitely many members, whereas the residue system modulo m contained precisely m elements. 9.3 Algebraic Number Fields 421 Theorem 9.15 Let G(x) be a polynomial over Q of degree n � 1. The totality of polynomials (9.6) with coefficients in Q, and with addition and multiplication modulo G(x), forms a ring. Proof This theorem is the analogue of the first part of Theorem 2.33, and its proof is virtually the same. First we note that the polynomials (9.6) form a group under addition, with identity element 0, the additive inverse of r(x) being -r(x). Next, the polynomials (9.6) are closed under multiplica­ tion modulo G(x), and the associative property of multiplication comes from the corresponding property for polynomials over Q with ordinary multiplication, that is implies Similarly, the distributive property modulo G(x) is inherited from the distributive property of polynomials over Q. Before stating the next theorem, we extend Definition 2.10 to the concept of isomorphism between fields. Two fields F and F' are isomor­ phic if there is a one-to-one correspondence between the elements of F and the elements of F' such that if a and b in F correspond respectively to a' and b' in F', then a + b and ab in F correspond respectively to a' + b' and a'b' in F'. A virtually identical definition is used for the concept of isomorphism between rings. The following result is a direct analogue of the second part of Theorem 2.33. Theorem 9.16 The ring of polynomials modulo G(x) described in Theorem 9. 15 is a field if and only if G(x) is an i\"educible polynomial. If G(x) is the minimal polynomial of the algebraic number g, then this field is isomorphic to Q(g). Proof If the polynomial G(x) is reducible over Q, say G(x) = G1(x)Gix) where G1(x) and G2(x) have degrees between 1 and n - 1, then G1(x) and G2(x) are of the form (9.6). But then G1(x) has no multiplicative 422 Algebraic Numbers inverse modulo G(x) since G 1(x)f( x) = 1 (mod G(x)) implies Hence the ring of polynomials modulo G(x) is not a field. On the other hand, if G(x) is irreducible over Q, then every polyno­ mial r(x) of the form (9.6) has a unique multiplicative inverse r1(x) modulo G(x), of the form (9.6). To show this we note that the greatest common divisor of G(x) and r(x) is 1, and so by Theorem 9.3 there exist polynomials f(x) and h(x) such that 1 = r(x) f( x) + G( x) h(x ). (9.7) Applying Theorem 9.1 to f(x) and G(x) we get f(x) = G( x)q(x) + r1(x) where r1(x) is of the form (9.6). Thus (9.7) can be written 1 = r( x)r1(x ) + G( x) { h(x) + r( x )q( x ) } , r(x)r1(x ) = 1 (mod G( x)) so r1(x) is a multiplicative inverse of r(x) of the form (9.6). This inverse is unique because if r(x)r2(x) = 1 (mod G(x)) then r( x)r1(x) = r( x) ri x) (mod G( x )) ,G(x ) lr( x) { r1(x ) - ri x) } . Since G( x),(r(x) we have G( x)l{r1(x)- ri x)} by Theorem 9.4. But the polynomial r1(x) - r2(x) is either identically zero or is of degree less than n, the degree of G( x). Hence r1(x) - r2(x) = 0, r1(x) = r2(x). Finally, if G(x) is the minimal polynomial g(x) of the algebraic number �. we must show that the field is isomorphic to I!)( g). To each r( x) of the form (9.6) we let correspond the number r(g) of 1!)(0 Theorem 9.14 shows that this correspondence is one-to-one. If then and hence r1(x ) + r2(x) = ri x) (mod G( x) ) r1(x)rix) = r3(x) + q1(x) G( x ) , r1(x) + ri x) = ri x) + q2(x)G(x ), 9.3 Algebraic Number Fields 423 since G(g) = 0. Therefore the correspondence preserves multiplication and addition. The theorem we have just proved is significant in that it makes possible the development of the theory of algebraic numbers from the consideration of polynomials without any reference to the roots of the polynomials. The fundamental theorem of algebra states that every polyno­ mial of positive degree over Q has a root that is a complex number. Therefore the algebraic number fields obtained by means of Theorem 9. 16 are essentially the same-isomorphic to-the fields Q(g) of Theorem 9.14, but one does not need a knowledge of the fundamental theorem of algebra to use the method of Theorem 9.16. The fundamental theorem of algebra implies, and is sometimes stated in the form, that every polynomial f(x) of degree n over Q has n complex roots. If f(x) is irreducible over Q, then the n roots, say g 1, • ·, gn, are called conjugate algebraic numbers, and the conjugates of any one of them are simply all the others. Now Theorem 9.16 does not make any distinction between conjugates, whereas Theorem 9.14 allows for such a distinction. For example, let g(x) be the irreducible polynomial x3 - 2. In Theorem 9.14 we can take g to be any one of the three algebraic numbers that are 3 3 3 solutions of x3 - 2 = 0, namely \\12, w\\12, w2\\fi where w = ( -1 + i.ff)/2 . Thus there are three fields o(T2). (9.8) The first of these consists of real numbers, whereas the other two contain nonreal elements. Therefore, the first is certainly a different field from the others. It is not so apparent, but can be proved, that the last two differ from each other. On the other hand, if we apply Theorem 9.16 to the polynomial x3 - 2, we obtain a single field consisting of all polynomials a0 + a1x + a2x2 over Q modulo x3 - 2. According to Theorem 9.16, this field is isomorphic to each of the fields (9.8). Since isomorphism is a transitive property, the fields (9.8) are isomorphic to each other. They differ in that they contain different elements, but they are essentially the same except for the names of their elements. PROBLEMS 1. Prove that the fields of (9.8), although isomorphic, are distinct. (H) 2. Prove that the field Q{i), where i 2 = -1, is isomorphic to the field of all polynomials a + bx with a and b in Q, taken modulo x2 + 1. 9. 5 Quadratic Fields 425 Proof If a and {3 are integers in such a field F, then a + {3 and a/3 are in F since F is a field. But by Theorems 9.12 and 9. 13, a + {3, af3, and -a are algebraic integers. Thus the integers of F form a ring with 0 and 1 as the identity elements of addition and multiplication. Definition 9.7 In any algebraic number field Fan integer a -:F 0 is said to be a divisor of an integer {3 if there exists an integer 'Y such that {3 = ay. In this case we write a 1{3. Any divisor of the integer 1 is called a unit of F. Nonzero integers a and {3 are called associates if a/{3 is a unit. This definition of associates does not appear to be symmetrical in a and {3, but we shall establish that the property really is symmetric. Theorem 9.19 The reciprocal of a unit is a unit. The units of an algebraic number field form a multiplicative group. Proof If e 1 is a unit, then there exists an integer e2 such that e1 e2 = 1. Hence e2 is also a unit, and it is the reciprocal of e 1. If, similarly, e3 is any unit with reciprocal e4 , then the product e 1e3 is a unit because (e 1e3Xe2e4) = 1. Hence the units of an algebraic number field form a multiplicative group where the identity element is 1, and the inverse of e is the reciprocal of e. If a and {3 are associates, then aj{3 is a unit by definition, and by Theorem 9.19 {3 fa is also a unit. Hence the definition of associates is symmetric: if a and {3 are associates, then so are {3 and a. PROBLEMS l. Prove that the units of the rational number field Q are ± 1, and that integers a and {3 are associates in this field if and only if a = ±{3. 2. For any algebraic number a, define m as the smallest positive rational integer such that ma is an algebraic integer. Prove that if ba is an algebraic integer, where b is a rational integer, then m lb. 3. Let a = a1 + a2i be an algebraic number, where a1 and a2 are real. Does it follow that a1 and a2 are algebraic numbers? If a is an algebraic integer, would a1 and a2 necessarily be algebraic integers? 9.5 QUADRATIC FIELDS A quadratic field is one of the form Q(�) where � is a root of an irreducible quadratic polynomial over Q. By Theorem 9.14 the elements of such a field are the totality of numbers of the form a0 + a 1 �, where a0 426 Algebraic Numbers and a1 are rational numbers. Since g is of the form (a + b/m)jc where a, b, c, m are integers, we see that ( a+ b/m ) 0( 0 = Q c = O(a + b/m) = Q(b/m) = Q(/m ) . Here we have presumed that c '4= 0 and that m is square-free, m '4= 1. On the other hand, if m and n are two different square-free rational integers, neither of which is 1, then Q( /m) '4= Q( ..fn) since 1m is not in Q(..fn). That is, it is impossible to find rational numbers a and b such that 1m= a + b..fn. Theorem 9.20 Every quadratic field is of the fonn Q( /m) where m is a square-free rational integer, positive or negative but not equal to 1. Numbers of the fonn a + b/m with rational integers a and b are integers of Q( /m). These are the only integers of Q( /m) if m = 2 or 3 (mod 4). If m = 1 (mod 4), the numbers (a + bVm)/2, with odd rational integers a and b, are also integers of Q( /m), and there are no further integers. Proof We have already proved the first part of the theorem. All that remains is to identify the algebraic integers. Any number in Q( /m) is of the form a = (a + b/m)jc where a, b, c are rational integers with c > 0. There is no loss in generality in assuming that (a, b, c) = 1 so that a is in its lowest terms. If b = 0, then a is rational and, by Theorem 9.9, is an algebraic integer if and only if it is a rational integer, that is c = 1. If b '4= 0, then a is not rational, and its minimal equation is quadratic, x - x - = x2 - -x + = 0. ( a + b/m ) ( a - b/m ) 2a a2 - b2m c c c c 2 According to Theorem 9.10, a will then be an algebraic integer if and only if this equation is monic with integral coefficients. Thus a is an algebraic integer if and only if (9.9) and this includes the case b = 0, since (a, b, c) = 1. If (a, c) > 1 and ci 2a, then a and c have some common prime factor, say p, and p_{'b since (a, b, c) = 1. Then p2 la2 and p2 lc 2, and if c2 l(a2 - b2m), we would have p2 lb2m, p2 lm, which is impossible since m is square-free. Therefore (9.9) can hold only if (a, c) = 1. If ci2a and c > 2 then (a, c) > 1, so that (9.9) can hold only if c = 1 or c = 2. It is obvious that (9.9) holds for c = 1. For c = 2 condition (9.9) becomes a2 = b2m (mod 4) and we also 9. 5 Quadratic Fields 427 have a odd since (a, c) = 1. Then (9.9) becomes b 2m = a 2 = 1 (mod 4), which requires that b be odd, and then reduces to m = b 2m = 1 (mod 4). To sum up: (9.9) is satisfied if and only if either c = 1 or c = 2, a odd, b odd, m = 1 (mod 4), and this completes the proof. Definition 9.8 The norm N(a) of a number a= (a + b/m)jc in Q(/m) is the product of a and its conjugate, a= (a - b/m)jc, a + b/m a - b/m a 2 - b 2m N( a) = aa = __ c __ ___ c__ c 2 Note that by Theorem 9.20 the number a is an integer in Q(/m) if and only if its conjugate a is an integer, and that if a is a rational number then a= a. Theorem 9.21 The norm of a product equals the product of the norms, N(af3) = N(aN(f3). N(a) = 0 if and only if a = 0. The norm of an integer in Q( /m) is a rational integer. If y is an integer in Q( /m), then N( y) = ± 1 if and only if y is a unit. Proof For a and f3 in Q(/m) it is easy to verify that (af3) = ajj. Then we have N(af3) = af3ai3 = aaf3i3 = N(a)N(f3). If a = 0, then a = 0 and N(a) = 0. Conversely if N(a) = 0, then aa = 0 so that a = 0 or a= 0; but a = 0 implies a = 0. Next, if y is an algebraic integer in Q( /m), it has degree either 1 or 2. If it has degree 1, then y is a rational integer by Theorem 9.9, and N( y) = yy = y 2 so that N( y) is a rational integer. If y is of degree 2, then the minimal equation of y, x 2 - ( y + y)x + yy = 0, has rational integer coefficients, and again N( y) = yy is a rational integer. If N( y) = ± 1 and y is an integer, then yy = ± 1, yl 1, so that y is a unit. To prove the converse, let y be a unit. Then there is an integer e such that ye = 1. This implies N( y )N(e) = N(l) = 1, so that N( y) = ± 1 since N( y) and N(e) are rational integers. Remark The integers of Q(i) are often called Gaussian integers. PROBLEMS 1. If an integer a in 0.(/m) is neither zero nor a unit, prove that IN(a) l > 1. 2. If m = 1 (mod 4), prove that the integers of Q( /m) are all numbers of the form 1 + 1m a+ b 2 where a and b are rational integers. 428 Algebraic Numbers 3. If a is any integer, and e any unit, in O.(Vm), prove that ela. 4. If a and {3 * 0 are integers in O.(Vm), and if a l{3, prove that al/3 and N(a)IN(f3). 5. If a is an algebraic number in O.(Vm) with m < 0, prove that N(a) � 0. Show that this is false if m > 0. 6. Prove that the following assertion is false in Q(i): If N(a) is a rational integer, then a is an algebraic integer. 7. Prove that the assertion of the preceding problem is false in every quadratic field. (H) 9.6 UNITS IN QUADRATIC FIELDS A quadratic field Q( Vm) is called imaginary if m < 0, and it is called real if m > 1. There are striking differences between these two sorts of quadratic fields. We shall see that an imaginary quadratic field has only a finite number of units; in fact for most of these fields ± 1 are the only units. On the other hand, every real quadratic field has infinitely many units. Theorem 9.22 Let m be a negative square-free rational integer. The field Q( Vm) has units ± 1, and these are the only units except in the cases m = -1 and m = - 3. The units for Q{i) are ± 1 and ±i. The units for Q(/=3) are ±1, (1 ± /=3)/2, and (-1 ± /=3)j2. Proof Taking note of Theorem 9.21, we look for all integers a in Q{Vm) such that N(a) = ± 1. According to Theorem 9.20 we can write a in one of the two forms x + yVm and (x + yVm)/2 where x and y are rational integers and where, in the second form, x and y are odd and m = 1 (mod 4). Then N(a) = x 2 - my2 or N(a) = (x2 - my2)/4 respectively. Since m is negative we have x2 - my2 � 0 so there are no a with N(a) = -1. For m < -1 we have x2 - my2 � -my 2 � 2y2 and the only solutions of x2 - my2 = 1 are y = 0, x = ± 1 in this case. For m = - 1, the equation x2 - my2 = 1 has the solutions x = 0, y = ± 1, and x = ± 1, y = 0 and no others. For m = 1 (mod 4), m < -3 there are no solutions of (x2 - my2)j4 = 1 with odd x and y since x2 - my2 � 1 - m > 4. Finally, for m = -3, we see that the solutions of the equation (x2 + 3y2)/4 = 1 with odd x and y are just x = 1, y = ±1, and x = - 1, y = ± 1. These solutions give exactly the units described in the theorem. Theorem 9.23 There are infinitely many units in any real quadratic field. 9. 7 Primes in Quadratic Fields 429 Proof_ The numbers a = x + y.,;m with integers x, y are integers in Q(.,;m) with norms N(a) = x2 - my 2. If x2 - my 2 = 1, then a is a unit. But the equation x2 - my 2 = 1, m > 1, was treated in Theorems 7.25 and 7.26 where it was proved that it has infinitely many solutions. PROBLEM 1. Prove that the units of Q( {i) are ± (1 + {i)n where n ranges over all integers. 9.7 PRIMES IN QUADRATIC FIELDS Definition 9.9 An algebraic integer a, not a unit, in a quadratic field Q(..;m) is called a prime if it is divisible only by its associates and the units of the field. This definition is almost the same as the definition of primes among the rational integers. There is this difference, however. In Q all primes are positive, whereas in Q(..;m) no such property is required. Thus if 7T is a prime and e is a unit in Q(..;m ), then e 7T is an associated prime in Q(..;m). For example, -7r is an associated prime of 7T. Theorem 9.24 If the norm of an integer a in Q(..;m ) is ±p, where pis a rational prime, then a is a prime. Proof Suppose that a = {3y where {3 and y are integers in Q(..;m ). By Theorem 9.21 we have N(a) = N({3)N( y) = ±P· Then since N(f3) and N( y) are rational integers, one of them must be ± 1, so that either {3 or y is a unit and the other an associate of a. Thus a is a prime. Theorem 9.25 Every integer in Q(..;m), not zero or a unit, can be factored into a product of primes. Proof If a is not a prime, it can be factored into a product f3y where neither {3 nor y is a unit. Repeating the procedure, we factor {3 and y if they are not primes. The process of factoring must stop since otherwise we could get a in the form {3 1 {32 • • • f3n with n arbitrarily large, and no factor {3i a unit. But this would imply that n n N( a ) = 0 N(f3j ) , j � l I N( a) l = OI N(f3j ) l � 2n , j � t n arbitrary since IN(f3j) l is an integer > 1. 430 Algebraic Numbers Although we have established that there is factorization into primes, this factorization may not be J nique. In fact, we showed in Section 1.3 that factorization in the field Q( - 6) is not unique. In the next section we prove that factorization is unique in the field Q(i). The general question of the values of m for which Q( Vm) has the unique factorization property is an unsolved problem. There is, however, a close connection between unique factorization and the Euclidean algorithm, as we now show. Just as in the case of the rational field, a unique factorization theorem will have to disregard the order in which the various prime factors appear. But now a new ambiguity arises due to the existence of associated primes. The two factorings where the ej are units with product 1, should be considered as being the same. Definition 9.10 A quadratic field O(Vm) is said to have the unique factorization property if every integer a in Q( Vm), not zero or a unit, can be factored into primes uniquely, apart from the order of the primes and ambiguities between associated primes. Definition 9.11 A quadratic field Q( Vm) is said to be Euclidean if the integers of O(Vm) satisfy a Euclidean algorithm , that is, if a and {3 are integers of Q( Vm) with {3 '* 0, there exist integers 'Y and 8 of Q( Vm) such that a = {3y + 8, IN(8) 1 < IN({3) 1. Theorem 9.26 Every Euclidean quadratic field has the unique factorization property. Proof The proof of this theorem is similar to the procedure used in establishing the fundamental theorem of arithmetic, Theorem 1. 16. First we establish that if a and {3 are any two integers of Q( Vm) having no common factors except units, then there exist integers 'Yo and JLo in O(Vm) such that a,\\0 + f3JLo = 1. Let ../ denote the set of integers of the form a A + f3JL where A and JL range over all integers of Q( Vm). The norm N(aA + f3JL) of any integer in ../ is a rational integer, so we can choose an integer, a,\\1 + f3JL1 = e say, such that IN(e) l is the least positive value taken on by IN( a,\\ + f3JL) 1. Applying the Euclidean algo­ rithm to a and e we get a= ey + 8 , I N( 8 )1 <I N( e)l . 9. 8 Unique Factorization 43 1 Then we have so that 8 is an integer in ./. Now this requires IN(8) 1 = 0 by the definition of 8, and we have 8 = 0 by Theorem 9.21 . Thus a = 8'Y and hence 8l a. Similarly we find 81�, and therefore 8 is a unit. Then 8- 1 is also a unit by Theorem 9.19, and we have, Next we prove that if 1r is a prime in Q( vm) and if 1rl a�, then 1r l a or 1r l�. For if 7T% a, then 7T and a have no common factors except units, and hence there exist integers .\\0 and J.Lo such that 1 = 7T .\\0 + aJ.Lo· Then � = 7T�A0 + a�J.Lo and 1rl� because 1rla�. This can be extended by mathematical induction to prove that if 7TI(a 1 a2 · · · an), then 7T divides at least one factor aj of the product. From this point on the proof is identical with the first proof of Theorem 1. 16, and there is no need to repeat the details. PROBLEMS 1. If 7T is a prime and 8 a unit in Q(vm ), prove that 87T is a prime. 2. Prove that 1 + i is a prime in Q(i). 3. Prove that 11 + 2/6 is a prime in Q(/6). 4. Prove that 3 is a prime in Q(i), but not a prime in Q( /6). 5. Prove that there are infinitely many primes in any quadratic field Q(ym ). 9.8 UNIQUE FACTORIZATION In this section we shall apply Theorem 9.26 to various quadratic fields, namely Q(i), Q(/=2), Q(/=3), O(F7), Q(y'2), Q(/3). We shall show that these fields have the unique factorization property by proving that they are Euclidean fields. There are other Euclidean quadratic fields, but we focus our attention on these few for which the Euclidean algorithm is easily established. Theorem 9.27 The fields Q( vm) for m = - 1, - 2, - 3, - 7, 2, 3, are Euclidean and so have the unique factorization property. 432 Algebraic Numbers Proof Consider any integers a and {3 of Q( Vm) with {3 * 0. Then a/{3 = u + v..fm where u and v are rational numbers, and we choose rational integers x and y that are closest to u and v, that is, so that 0 � lu - xi � -!. 0 � lv - yl � -! . {9.10) If we denote x + y..fm by y and a - {3y by o, then y and o are integers in O(Vm ) and N(O) = N(a - {3y) = N({3)N(aj{3 - y) = N({3)N((u - x) + (v - y)Vm) = N(f3){(u - x)2 - m(v - y)2}, By equations (9.10) we have m 2 2 1 - 4 � ( u - x) - m( v - y) � 4 if m > 0 2 2 1 1 0 � ( u- x) - m( v- y ) � 4 + 4( -m) if m < 0 {9.11) and hence, by (9.11), IN(o)l < IN(f3) 1 if m = 2, 3, - 1, - 2. Therefore Q(..fm) is Euclidean for these values of m. For the case m = - 3 and m = - 7 we must choose y in a different way. With u and v defined as above, we choose a rational integer s as close to 2v as possible and then choose a rational integer r, such that r = s (mod 2), as close to 2u as possible. Then we have l2v - sl � -! and l 2u - rl � 1, and the number y = (r + s..fm)/2 is an integer of O(..fm) by Theorem 9.20, since m = 1 (mod 4) in the cases under discussion. As before, o =a - {3y is an integer in O(..fm) and I N{ o) l � I N{f3) 1{� + 1 1 6 ( -m )} < I N{f3) 1 for m = - 3 and m = - 7. PROBLEMS 1. Prove that Q( Fll) has the unique factorization property. 2. Prove that Q(vfs) has the unique factorization property. 9.9 Primes in Quadratic Fields Having the Unique Factorization Property 433 3. Prove that in Q(i) the quotient y and remainder 8 obtained in the proof of Theorem 9.27 are not necessarily unique. That is, prove that in Q(i) there exist integers a, {3, y, 8, 'Y P 81 such that a= f3y + 8 = f3y 1 + 8 1 , N(8) < N( f3 ) , ')' * 'Y 1 • *4. If a and f3 are integers of Q(i), not both zero, say that y is a greatest common divisor of a and f3 if N( y) is greatest among norms of all common divisors of a and {3. Prove that there are exactly four greatest common divisors of any fixed pair a, {3, and that each of the four is divisible by any common divisor. 9.9 PRIMES IN QUADRATIC FIELDS HAVING THE UNIQUE FACTORIZATION PROPERTY If a field Q( ..;m) has the unique factorization property, we can say much more about the primes of the fields than we did in Section 9.7. Theorem 9.28 Let Q(..;m) have the unique factorization property. Then to any prime 7T in Q( ,;m) there corresponds one and only one rational prime p such that 7T lp. Proof The prime 7T is a divisor of the rational integer N( 7T ), and hence there exist positive rational integers divisible by 7T. Let n be the least of these. Then n is a rational prime. For otherwise n = n 1n2, and we have, by the unique factorization property, 1rln, 7TI(n1n2), 1rln1 or 1rln2, a contradiction since 0 < n1 < n, 0 < n2 < n. Hence n is a rational prime, call it p. And, if 7T were a divisor of another rational prime q, we could find rational integers by Theorem 1.3 such that 1 = px + qy. Since 7T I(px + qy) this implies 7TI 1, which is false, and hence the prime p is unique. Theorem 9.29 Let Q(..;m) have the unique factorization property. Then : (1) Any rational prime p is either a prime 7T of the field or a product 7T 17T 2 of two primes, not necessarily distinct, of Q( ..;m). (2) The totality of primes 7T, 7Tp 7T2 obtained by applying part 1 to all rational primes, together with their associates, constitute the set of all primes of Q( ..;m ). 9.9 Primes in Quadratic Fields Having the Unique Factorization Property 435 rational integers and neither is a multiple of p, for if p divided either one it would divide the other and we would have p2 l4a 2, p 2 l4b2, p2 l(4a2 - 4mb2), p 2 l4p. Therefore (2b, p) = 1, and there is a rational integer w such that 2bw = 1 (mod p), 2 2 ( m ) (2aw ) = m(2bw ) = m (mod p), and we have P = 1. Furthermore, with the notation of the preceding paragraph we prove that 1r and {3 are not associates, but 1r and 13 are, and 1T and {3 are. From p = 1r{3 and N(7r) = a2 - mb2 = ± p we have p p {3 = ; = a + bvm = ± (a - bvm ), j3 = ± (a + bvm ) so 1r and j3 are associates. On the other hand we note that 77' {3 a+ bvm ± -a---b-vm-=m= (2a ) 2 + m(2b ) 2 4p + Babvm 4p and this is not an integer, and so not a unit, because p does not divide Bab. Thus 1r and {3 are not associates. ( 4) If m = 3 (mod 4), then m2 -m m2 - m = 2 = (m + vm)(m - vm) 2 and 2%(m ± vm), so 2 cannot be a prime of Q(vm). Hence 2 is divisible by a prime x + yvm and this prime must have norm ± 2. Therefore x 2 - my 2 = ±2. But this implies that and, similarly x + yvm + ----==-- x- y,;m and therefore (x - yvmXx + yvm)- 1 and its inverse are integers of Q(vm). Hence (x - yvmXx + yvm)- l is a unit, and X- yvm and X + yvm are associates. 436 Algebraic Numbers If m = 1 (mod 4) and if 2 is not a prime in Q( ..fm) then 2 is divisible by a prime t(x + y..fm) having norm ± 2. This would mean that there are rational integers x and y, both even or both odd such that (9. 12) If x and y are even, say x = 2x0, y = 2y0, then (9. 12) would require x5 - my5 = ± 2. But, since m = 1 (mod 4), x5 - my5 is either odd or a multiple of 4. Thus (9.12) can have solutions only with odd x and y. Then x2 = y 2 = 1 (mod 8), and (9.12) implies x2 - my2 = 1 - m = 0, m = 1 (mod S) . It follows that 2 is a prime in Q( Vm) if m = 5 (mod 8). Now if m = 1 (mod 8) we observe that 1- m 1- m 1-..fm - 4 - = 2 - 8 - = -- 2- 1 + ..;m 2 and 2�(1 ± ..fm)/2, so 2 cannot be a prime in Q(..fm). Hence (9. 12) has solutions in odd integers x and y. Now the primes t(x + y..fm) and t(x - y..fm) are not associates in O(Vm ) because their quotient is not a unit. In fact their quotient is x2 + my2 xy..fm ± --- ± -- 8 4 which is not even an integer in Q(..fm). (5) Let p be a rational prime divisor of m. If p = lm l then p = ± ..fm · ..fm and hence p is the associate of the square of a prime in Q( ..fm) by Theorem 9 .24. If p < I m I , we note that m m = p- = ..fm . ..fm. p (9.13) But p is not a divisor of ..fm in Q(..fm) by Theorem 9.20 and hence p is not a prime in Q( ..fm ). Therefore p is divisible by a prime 1r, with N(7r) = ± p , and hence is not a divisor of mjp. But, by (9. 13), 1r is also a divisor of ..fm, 1r 2 is a divisor of m, and hence 1r 2 is a divisor of p. The theorem we have just proved provides a method for determining the primes of a quadratic field having the unique factorization property. For such Q(..fm) we look at all the rational primes p. Those p for which 438 Algebraic Numbers Example 2 m = -3. The field is Q( /=3) and we have 2m = - 6, x2 + 3y 2 = ± 4 · 2 has no solution 32 + 3 . 12 = 4 . 3, 3 + J- 3 2 3- !=3 2 ( m ) = { + 1 if p = 3k + 1, ( p, 6) = 1 p -1 if p = 3k + 2, ( p, 6) = 1 . For each odd p = 3k + 1, choose aP , bP such that a; + 3b; = 4p. The primes in Q( /=3) are 2, (3 + /=3) /2, all odd rational primes p = 3k + 2, all (aP + bP/=3)j2, all (aP - bP/=3)j2, together with all their associates. Here, again, we omit (3 - �)/2 because it can be shown to be an associate of (3 + /=3)/2. We could have included 2 among the p = 3k + 2 by just omitting the word \"odd.\" Example 3 Prove that the field O(v'-'!4) does not have the unique factorization property. By Theorem 9.29, part 5, the integer 2 factors into two primes if this field has the unique factorization property. So it suffices to prove that 2 is a prime. �se that 2 is not a prime in the field, so that 2 = ± (a + bv - 14 X a - bv'-'!4) for some integers a and b. This gives 2 = ± (a2 + 14b2), which is easily shown to be impossible in integers. Applications to Diophantine Equations The problem of finding all solutions of x2 + y2 = z 2 in rational integers was settled in Theorem 5.5. In the introduction to the present chapter, this equation is reexamined by use of the factoring (x + yiXx - yi) = z 2. We now look a little more carefully at the steps used. It is presumed that (x, y, z) = 1, so that primitive solutions are sought. We now prove that there is no prime a in Q(i) that divides both x + yi and x - yi. If there were such a prime divisor, it would divide the sum 2x and the difference 2yi. But (x, y, z) = 1 implies (x, y) = 1 and hence al2. This means that a = 1 + i. It is very easy to prove that 1 + i is a divisor of x + yi if and only if x and y are both even or both odd. But (x, y) = 1, so this leads to the conclusion that x and y are odd, and then z 2 = x 2 + y 2 = 1 + 1 = 2 (mod 4) which is impossible because any square is of the form 4k or the form 4k + 1. 9.9 Primes in Quadratic Fields Having the Unique Factorization Property 439 Thus x + yi and x - yi have no common prime factor in IQ(i), and since their product is z 2, it follows that x + yi is the product of a unit and a perfect square, x + yi = ± ( r + si ) 2 or x + yi = ±i(r + si) 2. It is easy to finish this analysis by equating the real and nonreal parts here. The first equation, for example, implies that y = ±2rs . We do not pursue the details here, because what emerges is just a variation on the solutions found in Theorem 5.5. As a second example, consider the equation Again we seek primitive solutions in rational integers, so that (x, y, z) = 1 . It follows that (x, y) = 1, and since x 2 + y 2 is even, we see that x and y are odd. From this we conclude, as noted above, that x + yi is divisible by 1 + i, say x + yi = (1 + iXu + vi). Equating the real and nonreal parts gives x = u - v, y = u + v. The equation x2 + y 2 = 2z 2 is thereby re­ duced to u2 + v 2 = z 2• Now we are on familiar ground, because this equation is analyzed completely in Theorem 5.5. Hence the solutions of x 2 + y2 = 2z 2 can be obtained from those of u2 + v 2 = z 2 by the use of x = u - v, y = u + v. The details are omitted. For a third example of the application of the theory to Diophantine equations, we prove that the only solutions of in rational integers are x = 3, y = ± 5. First we note that x and y must be odd, since if y is even, then x is even, and the equation is impossible modulo 4. The equation is now studied in the field IQ( V-f), where it can be written as Since x is odd, it is not divisible 2Y..!he prime V-2 , and so V-2 is not a divisor of y + V-2 or y - ...; - 2 . Note that here we are using the unique factorization property of the field iQ( V-f), by Theorem 9.27. What we want to establish from this equation is that y + V-2 and y - V-2 are perfect cubes. Since by Theorem 9.20 neither y + V-2 440 Algebraic Numbers nor y - � is divisible by any rational integer k > 1, it follows that any prime divisor of y + � is of the form r + s�, where r and s are nonzero rational integers. Then r - s� is also a prime, not an associ­ ate of r + sv- � part 3 of Theorem 9.29. Although r - s� is a divisor of y - ...; - 2 , we prove that r + s� is not such a divisor. If it were, then the product (r + s�Xr - s�) would also be a divisor of y- �- But the product is r2 + 2s2, a rational integer > 1, and we have already seen that such a divisor is not possible. Now the prime divisor r + s� of y + � is also a divisor of x, and so (r + s�)3 is a divisor of y + �- Grouping all the prime divisors of y + �, we can write y +�= ( a+ b� )3 for some rational integers a and b, because the units of the field are the perfect cubes ± 1 by Theorem 9.20. Equating the coefficients of � here, we get 1 = b(3a2 - 2b2), the only solutions of which are b = 1, a = ± 1, giving x = 3, y = ±5. The unique factorization property is of central importance in the argument just given. For example, if an analysis similar to that above is applied to y 2 + 47 = x 3 , assuming unique factorization in O.(v- 47 ), the procedure does not turn up all solutions in integers. The reason for this is that O.(V- 47 ) does not have the unique factorization property, as can be seen �y examining 2 as a possible prime in the field, exactly as in the case of 0.( - 14 ) in the preceding example. PROBLEMS 1. In Example 2, where m = - 3, we know from the theory that if p is any prime of the form 3k + 1, then there are integers x and y such that x 2 + 3y 2 = 4p. Let x = 2u - y and establish that any such prime can be expressed in the form u 2 - uy + y 2. 2. The rational prime 13 can be factored in two ways in 0.( V-3), 7+V-3 7-V-3 13 = 2 . 2 = (1 + 2V-\"3 )(1 - 2V-3 ) . Prove that this is not in conflict with the fact that O.(V-3 ) has the unique factorization property. 3. Prove that .f3 - 1 and .f3 + 1 are associates in 0.( /3). 4. Prove that the primes of 0.( /3) are .f3 - 1, .f3, all rational primes p = ± 5 (mod 12), all factors a + b/3 of rational primes p = ± 1 (mod 12), and all associates of these primes. 442 Algebraic Numbers Proof From Lemma 9.30 it follows that � = ± 1 (mod 8). First if �= + 1 (mod 8) then � = 1 + {38 for some integer {3. Then because 84 = 9. Also we note that But 8 is a divisor of {3({3 - 1Xf3 + 1) by Lemma 9.30 and hence e = 1 (mod 84). Second if � = -1 (mod 8) then ( -�) = 1 (mod 8), ( -�)3 = 1 (mod 84) and e = -1 (mod 84). Now e = � (mod 8) because 8 is a divisor of �(� - 1X� + 1), so e + '173 = 0 (mod 8) implies � + '17 = 0 (mod 8). If � = 1 (mod 8) then 17 = -1 (mod 8) and hence e + 17 3 = 1 - 1 = 0 (mod 84). Finally if e - 173 = 0 (mod 8) then e + ( -17)3 = 0 (mod 8) and so e + ( -17)3 = 0 (mod 84). Lemma 9.32 Suppose there are integers a, {3, y of Q( V-=3\") such that a3 + {3 3 + y 3 = 0. If g.c.d. (a, {3, y) = 1 then 8 divides one and only one of a, {3, 'Y · Proof Suppose that 8 divides none of a, {3, y. Then by Lemma 9.31, Considering all possible combinations of signs, we conclude that 84 is a divisor of 3, 1, -1 , or -3. But 84 = 9, and hence we conclude that 8 divides at least one of a, {3, y. Furthermore if 8 divides any two of them, it must divide the third, contrary to hypothesis. Lemma 9.33 Suppose there are nonzero integers a, {3, y of O(V-=3\"), with 8 ,r af3y, and units e I > e2 , and a positive rational integer r such that a3 + e1{33 + ez{ 8'y)3 = 0. Then e 1 = ± 1 and r ;:;<> 2. Proof Since r > 0 we see that a3 + e1{33 = 0 (mod 83). Using Lemma 9.3 1 we see that a 3 + e1{33 = ± 1 + e1( ± 1) = 0 (mod 83). The unit e 1 is one of ±1, ± w, ± w2, so ±1 + e1(±1) is one of 2, 0, - 2, ± (1 ± w ), ± (1 ± w2) with all possible combinations of signs. But 83 divides none of these except 0, because 1 - w and 1 - w2 are associates of 8, 1 + w = 443 - w2 and 1 + w2 = -w are units, and N( ± 2) = 4 whereas N(63) = 27. It follows that ± 1 + t: 1(± 1) = 0, so £ 1 = ± 1. By Lemma 9.31, a3 + t:d33 = 0 (mod 63) implies a3 + t:Jf33 = 0 (mod 64). From this it follows that 64 is a divisor of t:2(6'y)3 and r � 2. Lemma 9.34 There do not exist nonzero integers a, {3, 'Yin Q(-/=3), a unit E, and a rational integer r � 2 such that (9.15) Proof We may presume that g.c.d.(a, {3, 6'y) = 1, and that 6%-y. Fur­ thermore, () does not divide both a and {3, and so, interchanging a and {3 if necessary, we may presume that ()% {3. If there are integers satisfying (9. 15) select a set such that (9.16) is a mtmmum. This can be done because every norm in Q( -/=3) is a nonnegative integer. Note that E in (9. 15) is omitted in (9. 16) because N(t:) = + 1. We now construct a solution of (9.15) with a smaller norm in (9. 16), and this will establish the lemma. Since r � 2, we have a3 + {3 3 = 0 (mod 66). Also ( 9.17) We first prove that if any prime 7T divides any two of a + {3, a + wf3, and a+ w2{3, it must be an associate of 6. First if 7TI(a + {3) and 7TI (a + wf3 ) then 7TI{3(1 - w) and 7Tia(1 - w). But g.c.d.(a, {3) = 1 and 1 · - w is an associate of () by (9. 14). Second if 7TI(a + {3) and 7TI(a + w2{3) then 7Tif3(1 - w2) and 7Tia(l - w2). Again we see that 7TI(l - w2) and so 7TI6 by (9. 14). Third if 7TI(a + wf3) and 7TI(a + w2{3) then 7Tif3(w - w2) and 7Tia(w - w2), and again by (9. 14) we get 7TI6. Furthermore, because of (9.14) and the fact that 6%{3, we notice that the differences between a + {3, a + w{3, and a + w2{3 are divisible by 6, but not by 62. The product of these three is divisible by 66, as in (9. 17). Hence if 6°, () b, ec are the highest powers of () dividing a + {3, a + w{3, and a + w2{3, respectively, then from this argument and (9. 15) we con­ clude that a, b, c are 1, 1, 3r - 2 in some order, and are integers with no common prime factor in Q(-/=3). And (9. 15) can be 444 Algebraic Numbers written as a+ {3 a+ wf3 (9. 18) so each of the factors on the left is an associate of the cube of an integer, say where e1, e2, e3 are units. Also we note that and so (9.20) where e4 = we2 and e5 = w2e3. Thus e4 and e5 are units, and (9.20) is symmetric in the three terms on the left side of the equation. Thus we can assign the values 1, 1, 3r - 2 to a, b, c in any order, say a = 1, b = 1, c = 3r - 2. Substituting these values in (9.20) and dividing by e10 we get (9.21) where e6 and e7 are the units e4je 1 and e5je 1• Since y * 0 we see that A1A 2 A3 * 0 from (9.18) and (9. 19). Also o,t(A 1A 2 A 3) so by Lemma 9.33 we conclude that e6 = ± 1 and r - 1 ;;;;. 2. But (9.21) is of the form (9. 15) because e6A� is either A� or ( -A 2)3. Taking the norm analogous to (9. 16) we have by (9. 19), (9. 18), and a + b + c = 3r, = N( o3r- 3\"Y 3 ) < N( a3{3303'-y3 ) because N(O) = 3 and N(a) ;;;;. 1, N(f3) ;;;;. 1. This complete the proof of Lemma 9.34. Theorem 9.35 There are no nonzero integers a, {3, y in Q( V-3) such that a3 + [3 3 + -y 3 = 0. There are no positive rational integers x, y, z such that x 3 + y 3 = z 3. Notes on Chapter 9 445 Proof The second assertion follows from the first. To prove the first, suppose there are nonzero integers a, {3, y such that a3 + {3 3 + y3 = 0. We may presume that g.c.d.(a, {3, y) = 1. Then by Lemma 9.32, 8 divides exactly one of a, {3, y, say 8 l y. Let 8' be the highest power of 8 dividing y, say y = 8'y 1 where 8%y1• Then by Lemma 9.33 we conclude that r ;;;. 2, and But this contradicts Lemma 9.34. PROBLEMS 1. Suppose there are nonzero integers a, {3, y in Q(/=3) and units e1, e2 , e3 such that e 1a3 + e2{33 + e3y 3 = 0. Since e1a3 can be written - e 1( -a)3 we may presume that e1 = 1, w, or w2. Likewise for e2 and e3• Prove that \"\" e2, e3 are 1, w, w2 in some order. 2. Prove that there are nonzero integers and units as in Problem 1 such that e 1a3 + e2{33 + e3y 3 = 0. NOTES ON CHAPTER 9 It can be noted that after Sections 9.1 to 9.4 on algebraic numbers in general, we turned our attention to quadratic fields. Many of our theorems can be extended to fields of algebraic numbers of higher degree, but of course it is not possible to obtain results as detailed as those for quadratic fields. Our brief survey of algebraic numbers has omitted not only these generalizations but also many other aspects of algebraic number theory that have been investigated. §9.2 A complex number is said to be nonalgebraic or transcendental if it is not algebraic. The basic mathematical constants 1r and e are transcendental numbers; proofs are given in the books by Hardy and Wright, LeVeque, and Niven listed in the General References. §9.8 The only fields O(Vm) with m < 0 having unique factorization are the cases m = -1, - 2, - 3, - 7, - 11, - 19, - 43, - 67, - 163. The history of the problem of finding all such fields is recounted by D. Goldfeld, \"Gauss' class number problem for imaginary quadratic fields,\" Bull. Amer. Math . Soc., 13 (1985), 23-37. For further readings on the subject of this chapter, see the books listed in the General References by Borevich and Shafarevich, Hua, Ireland and Rosen, Pollard and Diamond, Ribenboim, and Robinson. CHAPTER 10 The Partition Function 10. 1 PARTITIONS Definition 10.1 The partition function p(n) is defined as the number of ways that the positive integer n can be written as a sum of positive integers, as in n = a 1 + a2 + · · · + a ,. The summands ai are called the parts of the parti­ tion . Although the parts need not be distinct, two partitions are not considered as different if they differ only in the order of their parts. It is convenient to define p(O) = 1. Fm ��� 5=5= 4+ 1= 3 +2=3+ 1+ 1 =2+2+ 1= 2 + 1 + 1 + 1 = 1 + 1 + 1 + 1 + 1, and p(5) = 7. Similarly, p(l) = 1, p(2) = 2, p(3) = 3, p(4) = 5. We shall also discuss some other partition functions in which the parts must satisfy special restrictions, as follows. Definition 10.2 Pm(n): the number of partitions of n into parts no larger than m. p0(n): the number of partitions of n into odd parts. pd(n): the number of partitions of n into distinct parts. qe(n): the number of partitions of n into an even number of distinct parts. q0(n): the number of partitions of n into an odd number of distinct parts. Since 5 = 2 + 2 + 1 = 2 + 1 + 1 + 1 = 1 + 1 + 1 + 1 + 1 we have p2(5) = 3. Also 5 = 5 = 3 + 1 + 1 = 1 + 1 + 1 + 1 + 1, and 5 = 5 = 4 + 1 = 3 + 2, and 5 = 4 + 1 = 3 + 2, and 5 = 5, so that p0(5) = 3, pd(5) = 3, qe(5) = 2, q0(5) = 1 . 446 10.1 Partitions Theorem 10.1 We have (1) Pm(n) = p(n) if n .::;; m, (2) Pm(n) .::;; p(n) for all n � 0, (3) Pm(n) = Pm - 1(n) + Pm(n - m) if n � m > 1, (4) pd(n) = qe(n) + q0(n). 447 Proof With the possible exception of (3), these are all obvious from the definitions. To prove (3) we note that each partition of n counted by Pm(n) either has or does not have a summand equal to m. The partitions of the second sort are counted by Pm _ 1(n). The partitions of the first sort are obtained by adding a summand m to each partition of n - m into summands less than or equal to m, and hence are Pm(n - m) in number. If n = m, the term Pm(n - m) = 1 counts the single partition n = m. Theorem 10.2 For n � 1 we have pd(n) = p0(n). Proof We establish a one-to-one correspondence between the partitions counted by pd(n) and those counted by p0(n). Let n = a 1 + a2 + · · · +a, be a partition of n into distinct parts. We convert this into a partition of n with odd parts. For any natural number m define f(m) as the last integer in the sequence m, m/2, mj4, mj8, - · · , so that m = 2if(m), where 2 i is the highest power of 2 dividing m. Suppose there are s distinct odd integers among f(a 1 ), f(a2), - · ·,f(a,). Rearrange the subscripts if neces­ sary so that f(a1), f(a2), - • • ,f(a5) are distinct, and f(as+ 1), /(as+ z) , . · ·, f(a,) are duplicates of these. Collecting terms, we can write n = L.f� 1cJ(a), with positive integer coefficients c;. The final step is to write each cJ(a)· in the form f(a) + f(a) + · · · +f(a) with c; terms in the sum. Thus n is expressed as a sum of odd integers, a partition with L.c; parts. Conversely, these steps can be reversed as follows. Start with any partition of n with odd parts, say n = b1 + b2 + · · · +b1• Among these t odd integers, suppose there are s distinct ones, say b 1, b2, · · · , bs by rearranging notation if necessary. Collecting like terms in the partition of n, we get n = e1b1 + e2b2 + · · · +e5b5• Write each coefficient e; as a unique sum of distinct powers of 2, and so write each e;b; as a sum of terms of the type 2 kb; . This gives n as a partition with distinct parts. Thus we have the one-to-one correspondence and the theorem is proved. PROBLEMS 1. With 1 .::;; j .::;; n, prove that the number of partitions of n containing the part 1 at least j times is p(n - j). 448 The Partition Function 2. With 1 � j � n, prove that the number of partitions of n containing j as a part is p(n - j). *3. For every partition 1r of a fixed integer n, define F( 1r ) as the number of occurrences (if any) of 1 as a summand, and define G( 1r ) as the number of distinct summands in the partition. Prove that [.F( 1r) = EG( 1r ), where each sum is taken over all partitions of n. (H) 4. If p(n, 2) denotes the number of partitions of n with parts � 2, prove that p(n, 2) > p(n - 1, 2) for all n � 8, that p(n) = p(n - 1) + p(n, 2) for all n � 1, and that p(n + 1) + p(n - 1) > 2p(n) for all n � 7. 10.2 FERRERS GRAPHS A partition of n can be represented graphically. If n = a 1 + a2 + · · · +a,, we may presume that a1 � a2 � · · · � a, . Then the graph of this parti­ tion is the array of points having a1 points in the top row, a2 in the next row, and so on down to a, in the bottom row. 19 = 6 + 5 + 5 + 2 + 1. If we read the graph vertically instead of horizontally, we obtain a possibly different partition. For example, from 19 = 6 + 5 + 5 + 2 + 1 we get the conjugate partition 19 = 5 + 4 + 3 + 3 + 3 + 1. The conjugate of the conjugate partition is the original partition. Given a partition n =a , + a2 + · · · +a, consisting of r parts with the largest part a\" the conjugate partition of n has a 1 parts with largest part r. Since this correspondence is reversible, we have the following theorem. Theorem 10.3 The number of partitions of n into m parts is the same as the number of partitions of n having largest part m. Similarly , the number of partitions of n into at most m parts is equal to Pm(n), the number of partitions of n into parts less than or equal to m. The next theorem has a more subtle proof by the graphic method. Theorem 10.4 If n � 0, then qe(n) = qo( n) = {0 ( -1) j ifn = (3/ ± i )/2 forsome j = 0, 1 ,2 , · · · otherwise . 10.2 Ferrers Graphs 449 Proof For n = 0 we have j = 0 and qe(O) - q0(0) = 1. We now suppose n � 1 and consider a partition n = a1 + a2 + · · · +a, into distinct parts. In the graph of this partition we let A 1 denote the point farthest to the right in the first row. Since the parts are distinct, there will be no point directly below A 1• If a2 = a1 - 1, there will be a point A2 directly below the point that is immediately to the left of A 1• If a2 < a1 - 1, there will be no such point A2• If a3 = a1 - 2, then a2 = a 1 - 1 and there will be a point A3 directly below the point that is immediately to the left of A2• If a2 = a1 - 1 and a3 < a2 - 1, there will be no point A 3• We continue this process as far as possible, thus obtaining a set of points A 1, A 2, • • ·, As, s � 1, lying on a line through A 1 with slope 1. We also label the points of the bottom row B1, B2,· • · , B, t =a,. Notice that B, and As may be the same point. • • • • • • • A, • • • • • • A2 • • • • • A3 • • • • • B, B2 Now we wish to change the graph into the graph of another partition of n into distinct parts. First, we try taking the points B1, B2, . • · , B, and placing them to the right of A 1, A 2, . ·· , A,; B1 to the right of A\" B2 to the right of A 2, and so on. It is obvious that we cannot do this if t > s or if t = s and B, =As. However we can do it if t < s or if t = s and B, *As, and we obtain a graph of a partition into distinct parts. Second, we try the reverse process, putting A 1, A 2 , . • · , As underneath B1, B2, . • ·, Bs. This will give a proper graph if and only if s < t- 1 or s = t - 1 and B, * As· To refine this description, the transformation just described acts in one of three different ways on a partition 7T of the fixed integer n, say n = e1 + a2 + · · · +a,. If the partition 7T has t < s, or t = s with distinct points As and B, the transformation removes the entire bottom row of the graph, B1, B2, . • ·, B, and extends the first t rows of the graph by one point each. If the partition 7T has s < t - 1, or s = t - 1, again with As * B, the transformation moves the points A 1, A2, . ·· ,As to form an additional bottom row in the graph. The third type of partition 7T has As = B, with s = t or s = t - 1; for partitions 7T of this type, the transfor­ mation leaves 7T unchanged. The three types account for all possible partitions of n with distinct parts. Examples of the three types for n = 22 are 22 = 8 + 7 + 6 + 1, 22 = 9 + 8 + 5, and 22 = 7 + 6 + 5 + 4. The first two partitions 7T are 450 The Partition Function changed into 1r ', namely 22 = 9 + 7 + 6 and 22 = 8 + 7 + 5 + 2, whereas the transformation leaves the partition 7 + 6 + 5 + 4 unchanged. The transformation changes a partition of the first type into one of the second, and vice versa. Moreover, a second application of the transformation brings any partition back to its original form. With the first and second types of partition P, the partition P' also has distinct parts, but has one fewer or one more part than P. Thus, apart from partitions of the third type, we have paired off partitions with an odd number of parts and those with an even number. Now consider the exceptional partitions of the third type, with As = B, and s = t or s = t - 1. Since As and B, are identical points, it follows that s = r, and a 1,a 2, · ·· , a, are consecutive integers, with a 1 largest. Since t = a, in all cases, the partition has the form n = (t + s- 1) + ( t + s- 2) + · · · + ( t + 1) + t. If s = t we have n = (3s2 - s)/2, whereas if s = t - 1, then n = (3s2 + s) ;2. It is not difficult to verify that positive integers of the form (3s2 - s)/2 do not overlap those of the form (3s2 + s)/2. Hence if n = (3s2 ± s)/2 for some natural number s, that is, if n is one of the numbers 1, 2, 5, 7, 12, 15, 22, 26, · · ·, then qe(n) exceeds q0(n) by 1 if s is even, but q0(n) is larger by 1 if s is odd. For all other values of n, there are no partitions of the third type, and qe(n) = q0(n). PROBLEMS 1. Let 7T be the partition n = a1 + a2 + · · · +a,, a1 � a2 � • • • �a, > 0 and let 1r ' be the partition n = b1 + b2 + · · · +bs, b1 � b2 � • • • � bs > 0. Prove that 1r ' is the conjugate of 7T if and only if r = b1 and s = a\" and bj is the number of parts in the partition 7T that are � j for j = 1, 2, · · ·, s. (These conditions are of course equivalent to: r = b1 and s = a1, and bj - bj+ 1 is the number of parts in the partition 7T that are equal to j, for j = 1 , 2, · · ·, s - 1, and bs is the number of parts equal to s, that is, equal to a 1• These results give alternative definitions of the conjugate partition that are independent of the idea of a graph. If the partition 7T is given and we want to construct the conjugate 1r ' , it is quicker to use the first result above than to draw a graph, especially if 7T has 20 or more parts.) 2. Let F(n) denote the number of partitions of n with every part appear­ ing at least twice. Let G(n) denote the number of partitions of n into parts larger than 1 such that no two parts are consecutive integers. Use conjugate partitions to prove that F(n) = G(n). 3. (Notation as in Problem 1.) Prove that the number of partitions 7T of n with a, = 1 and aj - aj+ 1 = 0 or 1 for 1 � j � r - 1 equals pd(n), the number of partitions of n into distinct parts. 10.2 Ferrers Graphs 45 1 4. A partition is said to be self-conjugate if it is identical with its conju­ gate, as in the examples 18 = 5 + 4 + 4 + 4 + 1 and 15 = 6 + 3 + 3 + 1 + 1 + 1. Prove that the number of self-conjugate partitions of n equals the number of partitions of n into distinct odd parts, by using the idea suggested by the accompanying graph of the self-conjugate partition 25 = 6 + 6 + 5 + 3 + 3 + 2 and the natural transformation into 25 = 11 + 9 + 5 taken from the right-angle batches. Prove that this is the same as the number of partitions of n whose parts (except for a special case) are all the consecutive integers from 1 to some j, with all parts appearing an even number of times except j, which appears an odd number of times; the special case is n = 1 + 1 + 1 + · · · + 1 + 1, with n odd. (By the use of Problem 1, it is easy to decide whether a given partition is self-conjugate, or to create self-con­ jugate partitions.) The next two problems outline a proof that T( n ) = [ n2 1 : 6] - [ �] . [ n : 2 ], where T(n) denotes the number of triangles with integral sides and perimeter n, with no two triangles congruent. (Curiously enough, T(n) is not a monotonic increasing function: T(7) = 2, but T(8) = 1, for example.) S. Let P2(n) denote the number of partitions of n into 2 parts, and P3(n) the number into 3 parts. Verify that P2(n) = [n/2]. Next, by Theorem 10.3 we see that P3(n) equals the number of partitions of n with largest part 3. That is, P3(n) equals the number of solutions of 3x + 2y + z = n in integers x > 0, y � 0, and z � 0, since every such solution corre­ sponds to a partition of n with x parts equal to 3, y parts equal to 2, and z parts equal to 1. Now the number of solutions of 2y + z = k � 0 in non-negative integers is 1 + [k/2] or [(k + 2)/2]. Hence we can add the numbers of solutions of 2y + z = n - 3, 2y + z = n - 6, 2y + z = n - 9, · · · to get p3( n) = [ n ; 1 ] + [ n ; 4] + [ n ; 7] + · ·· (positive terms only) . Prove that P3{n) = [ n21: 6] by induction from n to n + 6, that is, prove that [(n + 5)/2] + [(n + 2)/2] = [((n + 6)2 + 6)/12] - [(n2 + 6)/12]. 452 The Partition Function 6. To count the number T(n) of triangles with perimeter n and integral sides, we can start with P3(n), the number of partitions of n into 3 parts, n = a + b + c, a � b � c > 0. But this gives no triangle if b + c �a, that is, if b + c = 2, or 3, or 4, · · ·, or (n/2]. These equations have, respectively, P2(2), P2(3), · · · , P2((nj2]) solutions in positive integers b and c with b � c. By induction or any other method, prove that Pi2) + P2(3) + · · · + P2((nj2]) = (n/4] · ((n + 2)/4] and hence that T(n) = ((n2 + 6)/12] - (n/4] · ((n + 2)/4]. 7. Consider n dots in a row, with a separator between adjacent dots, so n - 1 separators in all. By choosing j - 1 separators to be left in place while the others are removed, and then counting the number of dots between adjacent separators prove that the equation has ( � � : ) solutions in positive integers, where two solutions x i> x2 , - • ·, xj and x;, x2 ,- · ·, xJ are counted as distinct if xk i= xfc for at least one subscript k. (Note that the order of summands is taken into account here, so these are not partitions of n.) 8. By taking j = 1, 2, 3, · · · in the preceding problem, prove that the number of ways of writing n as a sum of positive integers is 2\" -t , where again the order of summands is taken into account. For example, if n = 4 the sums being counted are 1 + 1 + 1 + 1, 1 + 1 + 2, 1 + 2 + 1, 2 + 1 + 1, 1 + 3, 3 + 1, 2 + 2, 4 . 10.3 FORMAL POWER SERIES, GENERATING FUNCTIONS, AND EULER'S IDENTITY In the first two sections, combinatorial methods have been used, including arguments with graphs. In this section formal power series and generating functions are introduced, and in the next and subsequent sections we use analytic methods. The power series we use are of the form a0 + a1x + a2x2 + a3x3 + · · · where a0 i= 0. Such a power series is treated formally if no numerical values are ever substituted for x. Thus x is a dummy variable, and the power series is just a way of writing an infinite sequence of constants a0, a1, a2, a3, • • • • However, it is very convenient to retain the x for easy identification of the general term. Two power series Ea jxj and Ebjxj are said to be equal if aj = bj for all subscripts j. The product of 1003 Formal Power Series 453 these two power series is defined to be With these definitions of equality and multiplication of formal power series, the set of all power series with real coefficients with a0 * 0 (and b0 * 0) forms an abelian group. The associative property is easy to prove; in fact it follows from the associative property for polynomials in x because the coefficient of xn in any product is determined by the terms up to xn so that all terms in higher powers of x can be discarded in all power series in proving that the coefficients of xn are identical. The identity element of the group is 1 or 1 + Ox + Ox2 + Ox 3 + · · · . The inverse of any power series L.ajxj with a0 * 0 is the power series L.bjxj such that holds. The definition of multiplication of power series gives at once an infinite sequence of equations n L ajbn -j = 0, · · · j �O that can be solved serially for b0, b1, b2, o • o • Thus the inverse power series exists, is unique, and can be calculated directly. Finally, the group is abelian because of the symmetry of the definition of multiplication. The inverse of 1 - x is readily calculated to be 1 + x + x2 + x3 + 0 0 • • As in analysis, this is called the power series expansion of (1 - x)- 1• Under suitable circumstances an infinite number of power series can be multiplied. An illustration of this is n (1 + x n ) , n - 1 a product that will be used in what follows. The reason that this infinite product is well defined is that the coefficient of xm for any positive integer 454 The Partition Function m depends on only a finite number of factors, in fact it depends on m ( 1 +x)( 1 +x2 )( 1 +x3) .. . ( 1 +xm ) = n ( 1 +x\" ) n - 1 In general let P1, P2 , P3, • • • be an infinite sequence of power series each with leading term 1. Then the infinite product P1P2P3 • • • is well defined if for every positive integer k the power xk occurs in only a finite number of the power series. For if this condition is satisfied it is clear that the xm term in the product is determined by a finite product P1 P2 P3 • • • P, where r is chosen so that none of the power series P,+ 1, P,+ 2, P,+3, • • • has any term of degree m or lower, except of course the constant term 1 in each series. The function (1 - x\")- 1 has the expansion EJ_0xj\". Taking n = 1, 2, · · · , m and multiplying we find m n ( 1 -x\" ) - 1 = ( 1 +x l · l +x2 · 1 + . .. )(1 +x l · 2 + x2 · 2 + ... ) n = l x ( 1 +x l · 3 +x2 · 3 + . .. ) .. . ( 1 + xl ·m +x2 ·m + 00 00 00 E E · · · E xj, · l +h· 2 + ··· +j· m j 1= 0 h= O jm-0 00 where cj is the number of solutions of j1 • 1 + j2 • 2 + · · · +jm · m = j in nonnegative integers j1 , j2, . • · , jm. That is cj = Pm(j), and we have oo m E Pm(n) x\" = n ( 1 - x\" ) - I . n = O n = l This can be written as m m E p(n)xn + E Pm(n) x\" = n ( 1 - xn ) - I n = O n=m+ l since Pm(k) = p(k) if k � m. Since these equations have only the re­ stricted meaning in formal power series that coefficients of the same power of x are equal, we can let m increase beyond bound to get 00 00 E p( n)xn = n ( 1- x\") - 1 . n=O n= l 10.3 Formal Power Series 455 The function 0��1(1 - x\")-1 is called the generating function for p(n), and it will be used to derive information about the partition function. The generating function for Pm(n) is 0;:' � 1(1 - x\")-1• Similarly the generating function of p0(n) is found to be \"' \"' L: po(n)xn = no- xzn-1) - I n=O n=l and the generating function for pd(n) is \"' Theorem 10.2 is equivalent to 0�=1(1 + x\") = 0�=1(1 - x2\"-1)-1. This formula is now proved directly, giving us a proof of Theorem 10.2 by the use of generating functions. We multiply two factors at a time in the following infinite product to get (1 - x)(1 + x)(1 + x2)(1 + x4)(1 + x8)(1 + x16) · ·· = (1 - x2)(1 + x2)(1 + x4)(1 + x8)(1 + x16) · · · = (1 - x4)(1 + x4)(1 + x8)(1 + x16) · · · = (1 - x8)(1 +x8)(1 + x16) ·· · = · ·· = 1. Similarly we see that (1 - x3)(1 + x3)(1 + x6)(1 + x12){1 + x24) · · · = 1, (1- x5)(1 + x5)(1 + x10)(1 + x20)(1 + x40) · · · = 1, and so forth, where the first factor runs through all odd powers 1 - x7, 1 - x9, 1 - x11, · · · . Multiplying all these we get and n (1 -x2n-l) n (1 +xj) = 1 n=l j=l \"' n (1 + xj) = n ( 1- x2n-l) - I . j�l n-1 456 The Partition Function In a similar way we can multiply out n-: _1(1 - x\") formally to get 00 00 n= l n=O Then Theorem 10.4 implies 00 00 n (1- x\") = 1 + E < -1)j(x<3j2+j)/2 +x<3j2-j)/2) . n=l j= 1 This is known as Euler 's fonnula. Whereas here we have proved it only in the formal sense that the coefficients of the power series are identical, an analytic proof is given in Theorem 10.9 with convergence indicated for suitable values of x. Since a variable is never assigned a numerical value in formal power series, questions of convergence never arise. Theorem 10.5 Euler's identity. For any positive integer n, p( n ) = p( n - 1) + p(n- 2) - p(n - 5) - p( n - 7) + p(n - 12) + p(n -15) - ··· = E ( - 1)j+lp(n - H3i2 +i)) + E ( -1)j+lp(n - H3/ -i)) j where each sum extends over all positive integers j for which the arguments of the partition functions are non-negative. Proof From Euler's formula and the fact that nO - x\")-1 is the gener­ ating function for p(n) we can write or {1 - x - x2 +xs +x7 - xl2 - xis + ... } E p(k)xk = 1. k � O Equating coefficients of x\" on the two sides we get p( n ) - p( n- 1) + p( n- 2) + p( n- 5) + p( n- 7) -p( n -12) -p(n -15) + ··· = 0, and thus the theorem is established. 10.4 Euler's Fonnula; Bounds on p(n) PROBLEMS 1. Show that the infinite product 457 where a;- ai + l is 0 or 1, and ak = 1. Count the number of terms in the expansion that are of degree n. Set x 1 = x2 = x3 = · · · = x to show that (1 + xX1 + x2X1 + x3) • • • is the generating function for p'(n) of Problem 1, Section 10.2. 2. Compute a short table of the values of p(n), from n = 1 to n = 20, by use of Theorem 10.5. (Recall that p(O) = 1.) 3. By writing the inverse of 1 - x as an infinite product (1 + xX1 + x2) (1 + x4X1 + x8) • • • and also as an infinite series, use these generating functions to prove that every positive integer can be expressed uniquely as a sum of distinct powers of 2 (cf. Problem 44, Section 1.2). 10.4 EULER'S FORMULA; BOUNDS ON p(n) We open the section by proving Euler's formula as an equality between two functions, not just in the formal sense. Formal power series arguments have serious limitations, so it is convenient now to use a few rudimentary facts concerning infinite series and limits. A reader familiar with the theory of analytic functions will recognize that our functions are analytic in lx I < 1, and will be able to shorten our proofs. Theorem 10.6 Suppose 0 �X < 1 and let <Pm(x) = n;:'_ ,(l - xn). Then �- oPm(n)xn converges and 00 1 L Pm(n) xn = -;:---( ) · n=O 'I'm X Proof By Theorem 10.3, Pm(n) is equal to the number of partitions of n into at most m summands. This is the same as the number of partitions into exactly m summands if we allow zero summands. Then each sum­ mand is 0 or 1 or 2 or ·· · or n, and we have Pm(n) � (n + l)m. The series �-0(n + l)mxn converges, by the ratio test, and hence so does �-oPm(n)xn, by the comparison test. 458 Now The Partition Function m ( m !jn)k -1 n E xj\" = Echxh n-1 j= O h where the last sum is a finite sum and 0 � ch � Pm(h) for all h = 0, 1, 2, · · · , and c h = Pm(h) if h < m! k. Therefore we have m !k-1 \"' E Pm(h) x h � ( 1- x m ' k ) m cPm(x ) -I � E Pm(h)xh . h= O h-0 As k -+ oo we have m ! k -1 \"' L Pm(h)xh -+ L Pm(h)xh , 'k m (1 - Xm . ) -+ 1 h =O and hence h=O \"' cPm( x )- 1 = L Pm( h)xh . h-0 Theorem 10.7 For 0 � x < 1, limm --+\"' cf>m(x) exists and is different from zero. We let cf>(x) = limm --+\"' c/>m(x) and define 0� _ 1(1 - x\") to be cf>(x). Proof Since cf>m(O) = 1 the result is obvious for x = 0. For x > 0 we apply the mean value theorem to the function log z to obtain a y such that 1 - X n < y < 1 and Therefore log 1 -log ( 1- x\") 1 x\" 1-( 1 -x \") y x\" x\" -log (1 - x\" ) = - , y -log (1 - x\" ) � ---n � -- 1- x 1- x 10.4 Euler's Formula; Bounds on p(n) and hence m -log «f>m(x ) = E -log (1 -x \") n=l m x\" 1 - xm + l 1 �r: -- � ---..,-2 < 2 n - 1 1- x ( 1 -x ) ( 1 -x ) · 459 This shows that -log 4>m(x ), and hence 4>m(x) - I , is bounded for x fixed as m --+ oo. But m 1 4>m( x ) - l = n --n n=l 1- x increases monotonically for x fixed as m --+ oo. Since 4>1(x)- 1 = 1/0 - x) > 0 this shows that limm .... ,., 4>m(x)- 1 exists and is different from zero. Therefore lim m .... ,., 4>m(x) exists and is also different from zero. Theorem 10.8 For 0 � x < 1 the series r:;:_0p(n)x\" converges, and \"' E p( n) x\" = 4>( x ) - I . n=O Proof We have, using Theorem 10.6, m m \"' L p( n) x\" = L Pm(n ) x\" � L Pm(n) x\" = 4>m( x ) - I � «f>(x) - I . n=O n= O For x fixed, E;;'_0p(n)x\" increases as m --+ oo. Therefore E';:_0p(n)x\" = lim m .... ,., E;;'_0p(n)xn exists and is � «f>(x)- 1• But now \"' L p( n) xn � L Pm( n ) xn = 4>m( x ) - I . n=O n=O Letting m --+ oo we have E';: =0p(n)x\" � «f>(x)- 1, and hence E';:_0p(n)xn = «f>(x) - 1• Theorem 10.9 Euler's formula . For 0 � x < 1, we have \"' 4>(x ) = 1 + E ( -1 ) j(x<3j2+j)/2 +x<3j2-j)/2 ). j= l 460 The Partition Function Proof The ratio test shows that Ef= 1x<3i2 ±i>IZ converges; therefore so does the above series. Let q':,(n) be the number of partitions of n into an even number of distinct summands no greater than m, and let q::,(n) be the number of partitions of n into an odd number of distinct summands no greater than m. As in Definition 10.2 we will take q':,(O) = 1, q::,(O) = 0. Then cPm(x ) = (1 - x)( 1- x2 )( 1- x3 ) • • • (1 - xm ) = L ( q':,(n) - q::,( n))xn , n ( 10.1 ) a finite sum. But for n � m we have q':,(n) = qe(n), q::,(n) = q0(n), and we also have q':,(n) + q::,(n) � p(n) for all n. Therefore l cPm( x ) - E (qe( n) - Q0(n )) xnl n=O � L lq!,(n) - q::,(n )lxn � L p( n ) xn . n>m n=m+ I Since r:;;=m + I p(n)xn -+ 0 as m -+ oo, we get r:;;_0(qe(n) - q0(n))xn = cf>(x) by letting m -+ oo . Using Theorem 10.4, we have the present theo­ rem. For convenient reference we now state two needed results on power series. Proofs of these propositions are given in standard books on ad­ vanced calculus or elementary function theory. Lemma 10.10 Let EJ_0aixi and L:Z=obk xk be absolutely convergent for 0 � x < . 1. Then Lh=oCL.J_0aibh _)xh converges and . has the v.alue EJ_0aix'LZ=obk xk for 0 � x < 1. Moreover, if EJ_0aix' = EJ_0bix' for 0 �x < 1, then ai = bi for a/l j = 0, 1, 2, · · ·. The next theorem gives for the sum of divisors functions, u(n), an identity similar to that for p(n) in Theorem 10.5. Theorem 10.11 For n � 1 we have u(n ) - u(n - 1 ) - u( n - 2) + u( n- 5) + u( n- 7) { j+l - u(n - 12) - u(n - 15) + · · · = : -1 ) n where the sum extends as far as the arguments are positive. 3j2 ± j ifn = 2 otherwise , 462 The Partition Function Theorem 10.12 Bounds on p(n). The inequalities 2vn < p( n ) < ec.ft! with c = 7rV2/3 hold for n > 3 (first inequality) and for n � 1 (second inequality ). Proof To prove the first inequality, we define k as the unique positive integer satisfying k 2 > n � (k - 1)2• Consider the 2k partitions of n, where each e; may be 0 or 1, and the integer x (which we show to be positive) is chosen to balance the equation. These are distinct partitions of n because x > k by the following argument: x� n-1- 2-3- \" · -k � ( k - 1 )2 - k ( k + 1) /2 >kif k 2 - 7k + 2 > 0. This holds for k > 6 or n � 36. Thus we have 2 k distinct partitions, and hence for n � 36 we have p(n) � 2 k > 2\"\"· For smaller values of n we argue as follows. We know that p(12) = 77 (from Problem 2 of the preceding section, for example) and so for 12 < n < 36 we have p(n) � p(12) = 77 > 26 > 2\"\"· Finally, the inequal­ ity can be verified readily for the cases 4 < n < 11. To prove the second inequality in the theorem, we need the result E';;= 11/n2 = 1r2j6, which is proved in Appendix A.3. From Theorem 10.8 we have, for 0 < x < 1, 00 00 P( x) = E p(n) xn = n ( 1 - xk ) - I , n= O k= l where the first equation defines P(x). Using the power series expansion 00 1 log (1 - w ) - 1 = L - wm m = l m we see that P(x) can be written in the form exp L - L Xmk = exp L - · m • ( oo 1 oo ) ( oo 1 xm ) m =l m k =l m - l m 1- x We are now in a position to show that for any positive 8 10.5 jacobi's Formula To see this, note that if x = e -6 then 1 1 ----::--- < ­ e m 6 - 1 m8 463 where the last step follows from the inequality e u > 1 + u for any positive real number u. Hence we have ( \"' 1 1 ) ( 1 \"' 1 ) 7T2 P( e - 6 ) < exp E - · - = exp - E -2 = exp - . m =t m m8 8 m - l m 68 From the definition of P(x), we get so that p(n) < exp (n8 + 1r2 /68). We choose 8 = 7T I /6ii to minimize the right side, and thus the theorem is proved. PROBLEMS 1. Compute a short table of the values of u(n), from n = 1 to n = 20, by means of Theorem 10.11. Verify the entries by computing u(n) = Edin d directly. 2. Verify that the first part of the proof of Theorem 10.12 establishes a little more than the theorem claims, namely that 2 fii < pd(n) for n � 36. 10.5 JACOBI'S FORMULA Theorem 10.13 Jacobi's formula. For 0 � x < 1, \"' cf>(x )3 = E ( - 1) j(2j + 1 )xU2+j>l2 • j =O Proof The formula is obvious for x = 0, so we can suppose 0 < x < 1. For 0 < q < 1, 0 < z < 1, we define n n fn( z ) = n {{1 - q2k - lz2 )(1 - q2k -lz -2 )} = E ajz2j k - 1 j= -n ( 10.3) 464 The Partition Function where the aj are polynomials in q. Since fn(lfz) = fn(z) we have a_j = aj, and it is easy to see that an = (- 1) n ql +3 +5 + 000 +(2n - I ) = ( -1) n qn2. ( 10.4) In order to obtain the other aj we replace z by qz in (10.3) and find and hence n fn(qz ) = n {( 1- q2k+ lz2 )(1- q2k-3z- 2 )} k - 1 n + 1 n - 1 = n (1 - q2k- lz 2 ) n (1- q2j- lz- 2 ) k �2 j = O qz 2 (1 - q2n - lz - 2 )fn(qz) = (1 - q2n + lz 2 ){ n (1 - q2k- lz 2 )} k = 2 n Xqz 2 (1 - q - tz - 2 ) n ( 1 - q 2j- lz - 2) j= 1 n n = -( 1- q2n + lz 2 ) n (1 - q2k - lz 2 ) n (1 - q2j - lz - 2 ) k = l j= l If we write the functions fn in terms of the a j• using (10.3), and equate the coefficients of z 2k, we find and then qa q2k- 2 _ q2na q2k = q2n + la _ a k - 1 k k - 1 k This, along with (10.4) allows us to find an _ 1, an _2, · · ·, in turn. In fact, for 0 < j � n we find a 0 = n -J 10.5 jacobi's Formula 465 and hence ( 10.5) This formula is valid for 0 � k � n if we agree to take ljJ0(q2) = 1. Returning to (10.3), we see that fn(z) is a product of 2n factors, one of which is (1 - qz-2), which has the value 0 at z = q112• Therefore taking the derivative and then setting z = q112 we have On the other hand, we also have, from (10.3), n n J;(ql12) = E 2jajqj-t/2 = E 2jajq-1!2(qj _ q-j). j� -n j=l Thus we find n 4>n(q2)2 = (1 - q2\") E jaj(qj - q-j) j� t and hence, by (10.5), Now 2n n n ( 1 - q 2h) n ( 1 - q 2k) � 1, h=n+j+ l k=n-j+ l 466 n oo The Partition Function � E jqj2lqj - q-jl � E jqj2lqj - q-jl . j=m+1 j=m+ 1 We keep m fixed but arbitrary and let n -+ oo. By Theorem 10.7 we have r <P2n(q2)cf>n(q2) n �oo <Pn+j(q2)<Pn-j(q2) Now letting m -+ oo we find </J(q2)3 = f: ( -l)jjqj2(qj- q-j) j=1 00 00 = E ( - l)jjqj2+j + E ( -l)j-'jqj2-j j=l j= 1 where we can make the last step because both series converge. Changing j to j + 1, we write the last series LJ=o( -l)j(j + l)qj2+j and can then add it to the first series to obtain 00 </J(q2)3 E ( -l)j(zj + l)qj2+j. j=O This is our theorem with x replaced by q2. PROBLEM 1. Replace z by q116 in (10.3), multiply by <Pn(q2), and use (10.5) to obtain a proof of Euler's formula. 10.6 A Divisibility Property 10.6 A DIVISIBILITY PROPERTY Theorem 10.14 If p is a prime and 0 � x < 1, then where the a i are integers. Proof For 0 � u < 1 we have the expansion - \"\" .( -p) (-p -1)· ·· ( -p -j +1 ) . ( 1 - u ) P = 1 E ( -1) ' . 1 u' j = I 1 · \"\" (p +j - 1 )! . \"\" . = 1 + \" u' = \" b u' £..... \" 1 ( 1 ) ' £..... ) j=l 1 · P - · j =O say, and therefore say. But p -l = E biui + E ( bi - b1_P)u1 = E c1ui, j=O J=p j=O 467 ( j+ 1)( j+2) · ·· (j +p -1) = { o 1 bj = (p - 1 )! (mod p) if j = 0 (mod p) (mod p ) if j ¢ 0 (mod p) and b0 < b1 < b2 < · · · , so that we have c0 = b0 = 1, c1 > 0, c1 = 0 (mod p) for j > 0. Now, for 0 � x < 1, m 1- xpn n - \" a,(m>xi ( 1 n) P - £..... n-1 - x i=O 10. 6 A Divisibility Property and finally ;. <h> h - <f>( xP ) .t..... ah x - P . h -o <f>( x) 469 Since abo> = c0 = 1 and a�h> = ch = 0 (mod p) for h � 1, the theorem is proved. Theorem 10.15 For 0 �x < 1 we have x<f>(x)4 = L:,_ 1 bmxm where the bm are integers and bm = 0 (mod 5) if m = 0 (mod 5). Proof We can write Theorem 10.9 in the form 00 <f>( x) = E ck xk , k- 0 and Theorem 10.13 as 00 <f>( x) 3 = L dn xn , n -O if k = (3j2 ± j)/2 otherwise , d = { { -1) i{ 2j +1) if n= (i2 + i)/2 n 0 otherwise , and then apply Lemma 10.10 to obtain Then bm = L.J:;:0 1ck dm - t -k can be written as L.ck dn summed over all k � 0, n � 0, such that k + n = m - 1. But dn is 0 unless n = (/ + j) /2, j = 0, 1, 2, · · · , in which case it is ( -l)i(2j + 1). Furthermore we can describe ck by saying that it is 0 unless k = (3i2 + i)j2, i = 0, ± 1, ± 2, · · · , in which case it is ( - 1);. Then we can write summed over all i and j such that j � 0 and (3i2 + i)/2 + (j2 + j)/2 = m- 1. But . ( 3i2 + i / + j) 2{ i + 1) 2 + { 2j + 1) 2 = 8 1 + 2 + - 2 - + 10i2 - 5 470 The Partition Function so that if m = 0 (mod 5), the terms in (10.6) will have to be such that 2(i + 1)2 + (2j + 1)2 = 0 (mod 5). That is (2j + 1)2 = - 2(i + 1)2 (mod 5). However, - 2 is a quadratic nonresidue modulo 5, so this condi­ tion implies 2j + 1 = 0 (mod 5), and hence bm = 0 (mod 5) if m = 0 (mod 5). Theorem 10.16 We have p(Sm + 4) = 0 (mod 5). Proof By Theorems 10.15, 10. 14, and 10.8 we have where the aj and bm are integers and bm = 0 (mod 5) for m = 0 (mod 5). Using Lemma 10.10 we find that [n/5) p( n - 1) = L p( k ) bn-Sk (mod S) k =O and hence p(5m + 4) = 0 (mod 5) since bsm + S -Sk = 0 (mod 5). This theorem is only one of several divisibility properties of the partition function. The methods of this section can be used to prove that p(7n + 5) = 0 (mod 7). With the aid of more extensive analysis, it can be shown that p(Sk n + r) = 0 (mod 5k) if 24r = 1 (mod 5k ), k = 2, 3, 4, · · ·, and there are still other congruences related to powers of 5. There are somewhat similar congruences related to powers of 7, but it is an interest­ ing fact that p(7kn + r) = 0 (mod 7k) if 24r = 1 (mod 7k) is valid for k = 1, 2 but is false for k = 3. There are also divisibility properties related to the number 11 . An identity typical of several connected with the divisibility properties is lxl < 1. Notes on Chapter 10 PROBLEMS 1. Write Euler's formula as 00 cf>( x) = L, ( -1) j x(3P +j)/2 j � - oo 471 Use Jacobi's formula as in Theorem 10. 13, multiply xcf>(x)cf>(x)3 out formally and verify (10.6). 2. Obtain a congruence similar to that in Theorem 10.16 but for the modulus 35, using Theorem 10.16 and p(7n + 5) = 0 (mod 7). NOTES ON CHAPTER 10 For a comprehensive survey of the entire subject of partitions, see the book by Andrews listed in the General References. The proof given of Theorem 10.4, by F. Franklin, has been called by George E. Andrews \"one of the truly remarkable achievements of nine­ teenth-century American mathematics.\" Problem 6 of Section 10.3, giving a formula for the number of incongruent triangles of perimeter n, has been adapted from a short paper by George E. Andrews, \"A note on partitions and triangles with integer sides,\" Amer. Math. Monthly 86 (1979), 477-478. For a fuller discussion of the methods of Section 10.3, including, for example, a proof avoiding all questions of convergence of the basic recurrence formula (Theorem 10.1 1) for the sum of divisors function u(n), see Ivan Niven, \"Formal power series,\" Amer. Math. Monthly 76 (1969), 871-889. Theorem 10.16 is due to S. Ramanujan. For further congruence properties of partitions, see M. I. Knopp, Modular Functions in Analytic Number Theory, Markham, Chicago (1970), Chapters 7 & 8. Consider the question of the number of abelian groups of order q n , where q is a prime and n is positive. The answer is p(n), the number of partitions of n. For a proof, see Herstein, Topics in Algebra, p. 114. A clear expository account of identities has been given by Henry L. Alder, \"Partition identities ... from Euler to the present,\" Amer. Math. Monthly, 76 (1969), 733-746. Some interesting historical aspects of partition theory are discussed by G. E. Andrews in an article \"J. J. Sylvester, Johns Hopkins and Partitions\" in A Century of Mathematics in America, Part I, P. Duren, editor, Amer. Math. Society, Providence, R.I. (1988), pp. 21-40. The bibliography in this paper cites other basic articles on partitions, including several quite accessible expository papers. 11.1 Asymptotic Density 473 11.1 ASYMPTOTIC DENSITY The number of positive integers in a set .N that are less than or equal to x is denoted by A(x). For example, if .N consists of the even integers 2, 4, 6, · · · , then A(l) = 0, A(2) = 1, A(6) = 3, A(7) = 3, A(l5 /2) = 3; in fact A(x) = [x/2] if x � 0. On the other hand, for any set .N= {a;} we have A(a) = j. Definition 11.1 The asymptotic density of a set .N is A( n) 5 1( -N ) = lim inf -- . n -+oo n ( 11.2) In case the sequence A(n)jn has a limit, we say that N has a natural density, 5(-N). Thus · A( n) 5 (-N ) = 5 1(-N ) = lim -- ( 11.3) if A has a natural density. n-+oo n If N is a finite sequence, it is clear that B(.N) = 0. Theorem 11.1 If N is an infinite sequence, then n 5 1(-N) = lim inf -. n-+oo an If 5(-N) exists, then 5(-N) = limn--+ oo nfan . Proof The sequence kjak is a subsequence of A(n)jn and hence I. . f A( n) I' . f k tm tn ---- � tm tn -. n--+ oo n k--+ oo ak If n is any integer � a1 and ak is the smallest integer in .N that exceeds n, then ak - l � n < ak and k A( n) k k- 1 k k- 1 1 -- ---- =-- ---- < - - ---- = -. ak n ak n n n n It follows that k A( n) 1 - < ---- +- ak n n' and so the theorem is proved. I. . f k 1' . f A( n) tm tn - � tm tn ---- k --+oo ak n--+oo n 11.1 Asymptotic Density 475 and n - a are both square-free. Since n = a + (n - a), this is the desired result. PROBLEMS 1. Prove that each of the following sets has a natural density, and find its value: (a) the set of even positive integers; (b) the set of odd positive integers; (c) the positive multiples of 3; (d) the positive integers of the form 4k + 2; (e) all positive integers a satisfying a = b (mod m), where b and m > 1 are fixed; (f) the set of primes; (g) the set {arn} with n = 1, 2, 3, · · · and fixed a ;;:. 1, fixed r > 1; (h) the set of all perfect squares; {i) the set of all positive cubes; (j) the set of all positive powers, that is, all numbers of the form an with a ;;:. 1, n ;;:. 2. 2. If the natural density 5(.W) exists, prove that 5{�) also exists and that 5(.W) + 5{�) = 1. 3. Prove that 5(.W) exists if and only if 5 1(.W) + 51(�) = 1. 4. For any set .W, prove that 5 1(N) + 5 1(�) � 1. 5. Define Ja1,. as the set of all a such that (2n)! � a < (2n + 1)! and let .W be the union of all sets Jaf,., n = 1, 2, 3, · · · . Prove that 5 1(U') + 5 1(�)= 0. 6. Let .W * be the set remaining after a finite number of integers are deleted from a set .W. Prove that 51(.W) = 5 1(U'*), and that 5(.W) exists if and only if 5(.W*) exists. 7. If two sets .W and � are identical beyond a fixed integer n, prove that 5 1(N) = 5 1(�). 8. Given any set N= {a) and any integer b ;;:. 0, define � = {b + a). Prove that 51(N) = 5 1(�). 9. Let .W be the set of all even positive integers, �1 the set of all even positive integers with an even number of digits to base ten, and �2 the set of all odd positive integers with an odd number of digits. Define � = �1 U �2, and prove that 5(.W) and 5(�) exist, but that 5(U'U �) and 5(.Wn �) do not exist. 10. If .Wn � = 0, prove that 5 1(.Wu �) ;;:. 5 1(.W) + 5 1(�). 476 The Density of Sequences of Integers 11. Let ./denote any finite set of positive integers a1 , a2, · · · , am. Prove that the set .N of all positive integers not divisible by any member of ./ has natural density m 1 1 1- E - +E -=--� ; = t a; ; <i [ a; , a i] - L 1 + ... + ( -1 ) m . i<j<k [ a;, ai , ak ] [ a1 , a2 ,. · · , am ] Suggestion : Use the inclusion-exclusion principle of Section 4.5. 12. Let .N be a set of positive integers such that for every integer m, the equation x + y = m has at most one solution not counting order, with x and y in .N. Prove that .N has density zero. Even more, prove that A(n) � 2Vn. 13. Define N= {a) as follows. With a1 = 1, define ak + t as the least positive integer that is different from all the numbers ah + a; - ai, with 1 � h � k, 1 � i � k, 1 � j � k. prove that .N satisfies the 3 inequality of the preceding problem, and that A(n) ;;:. Tn - 1. •14. Let 9 be the set of integers {mk} with m = 1, 2, 3, · · · and k = 2, 3, 4, · · · . Let 91 be the subset with k = 3, 4, · · · . Prove that . P1( n ) hm - ( - ) = 0. n -+oo p n 15. Find the asymptotic density of the set of positive integers having an odd number of digits in base 10 representation. 16. If N= {a t > a2 , a3, ·· ·}is an increasing sequence of positive integers with positive natural density, prove that lim (an - an _1 )/an = 0 as n tends to infinity. 11.2 SCHNIRELMANN DENSITY AND THE af3 THEOREM Definition 11.2 The Schnirelmann density d(.N) of a set .N of non-nega- tive integers is A( n) d( .N) = inf --n ;. t n where A(n) is the number of positive integers � n in the set .N. Comparing this with Definition 11 .1 we immediately see that 0 � d(.N) � 81(A) � 1. Schnirelmann density differs from asymptotic density in that it is sensitive to the first terms in the sequence. Indeed if 1 ft .N 11.2 Schnirelmann Density and the af3 Theorem 477 then d(d) = 0, if 2 � d then d(d) � t whereas it is easy to see that 81(d) is unchanged if the numbers 1 or 2 are removed from or adjoined to d. Also, d(d) = 1 if and only if d contains all the positive integers. Until now we have been considering sets d consisting only of positive integers. However, Definition 11.2 is worded in such a way that d can contain 0, but it should be noted that the number 0 is not counted by A(n). Definition 11.3 Assume that 0 E d and 0 E �. The sum d + � of the sets A and B is the collection of all integers of the form a + b where a E A and bE B. Note that de d+ �. � c d+ �. As an example let us take ./ to be the set of squares 0, 1, 4, 9, · · · and J the set of all non-negative integers. Then by Theorem 6.26 we see that ./+ ./+ ./+ ./= J. The sum d+ � has not been defined unless 0 Ed and 0 E �. We shall assume that 0 is in both d and � in the rest of this chapter. However, the sum could be defined for all d and � as the sum of the sets obtained from d and � by adjoining the number 0 to each. This is equivalent to defining the sum as the collection {a, b, a + b} with a E d, bE �. The result that is proved in the remainder of this section is the af3 theorem of H. B. Mann, which was conjectured about 1931, with proofs attempted subsequently by many mathematicians. The theorem states that if d and � are sets of non-negative integers, each containing 0, and if a, {3, 'Y are the Schnirelmann densities of d, �. d + �. then y � min(l, a + {3). In other words 'Y � a + f3 unless a + f3 > 1, in which case 'Y = 1. Actually we shall prove a somewhat stronger result, Theorem 11.9, from which we shall deduce the af3 theorem. We start by considering any positive integer g and two sets d1 and �1 of non-negative integers not exceeding g. We assume throughout that d1 and �1 are such sets and that 0 belongs to both d1 and �1• Denoting d1 + �1 by -t'1 , we observe that -t'1 may have elements > g even though d1 and �1 do not. We also assume that for some 8, 0 < (J � 1, m = 1 , 2, ·· · , g. { 11.4) Our idea is to first replace d1 and � 1 by two new sets, d2 and �2 , in such a way that (11.4) holds for d2 and �2, that -t'2 = d2 + �2 c -t'1 , and that B2(g) < B1(g). 11 .2 Schnirelmann Density and the af3 Theorem 479 Proof Let z be the least integer such that A1(z) < fJz. Then y � z � 1. Since A1(z) + B1(z) � (Jz we have B1(z) > 0, and hence there is abE �1 such that 0 < b � z �g. If z � a0, we would have z - a0 < b � z � g, and we could apply Lemma 11.5 to get A 1(z) � A1(b) + A1(z - b). Now b E �1 c .w'1, so we have A1(b) = Alb - 1) + 1 � fJ(b - 1) + 1 since b - 1 < z. Also, A1(z - b) � fJ(z -b), and we are led to the contradic­ tion A1(z) � fJ(b - 1) + 1 + fJ(z - b) = fJ(z - 1) + 1 � fJz. Therefore, we have z > a0, and hence y > a0. Lemma 11.7 Let .w'1 and �1 satisfy �1 c .w'1 and B1(g) > 0. Let �, denote the set of all b E �1 such that a0 + b ft. .w'1, and let .w'' denote the set of all integers a0 + b such that b E �, and a0 + b � g. Finally let .w'2 = .w'1 U .w'' and �2 = �1 () �'. Then �2 c �1 and �2(g) < B1(g). Proof Note that 0 E .w'2 and 0 E �2, so that the sum �2 is well defined. If h E �2, then h = a + b, a E Ja1'1 U Jat'', b E �I () �'. If a E Ja1'1, then h =a + b E �1 since a E .w'p b E �1• If a E .w'', then a = a0 + b 1 for some b1 E �', and we have h = a0 + b + b 1• Here a0 +bE .w'1 since otherwise we would have b E �'. Since b 1 E �1, we again have h E �1• Finally B2 (g) < B1(g ), since the definition of a0 ensures that B'(g) > 0. Lemma 11.8 For .w'1, �I' .w'2, �2 as in Lemma 11.7, if .w'1 , �1 satisfy (1 1.4) then A i m) +Bi m) � fJm for m=1 , 2, .. · ,g . (11.6) Proof From the way A', B', A2 , B2 were chosen we have A i m ) = A1( m ) + A'( m ) B2( m ) = B1( m) - B'( m) A'( m) = B'( m - a0) A i m )+ B2( m ) = A 1( m ) + B1( m )- (B'( m )- B'( m - a0) ) for m= 1,2, · ·· ,g. Therefore (11.6) holds for all m for which B'(m) = B'(m - a0). Consider any m � g for which B'(m) > B'(m - a0). Then B1(m) - Blm - a0) � B'(m) - B'(m - a0) > 0, and we let b0 denote the smallest element of B1 such that m - a0 < b0 � m. Therefore A i m)+ Bi m) �A 1( m) + B1( m) - (B1( m )- B1( m - a0)) = A1(m) + B1( m - a0) = A1( m ) + B1( b0 - 1 ) . (11.7) 480 The Density of Sequences of Integers Now m - a0 < b0 � m � g, so we can apply Lemma 11.5 with b = b0 and z = m to get We also have m - b0 < a0 so Lemma 11.6 shows that Thus we can reduce (11. 7) to But b0 E fA1 c N1, so we have A1(b0) = A1(b0 - 1) + 1. Using this and (11.4) we have, A z{ m) + Bz( m ) �A 1( b0- 1) + B1( b0 - 1) + 1 + 8( m - b0) � 8( b0 -1 ) + 1 + 8(m - b0) �em. Theorem 11.9 For any positive integer g let Jlf1 and !A1 denote fixed sets of non-negative integers �g. Let 0 belong to both sets Jlf1 and !A1, and write t\"1 for N1 + fA1• If for some 8 such that 0 < (J � 1, A1(m) + B1( m ) � 8m , m = 1, 2, - · ·, g then C1(g) � 8g. Proof If B1(g) = 0, then fA1 consists of the single integer 0, -G\"1 = Jlf1, and C1(g) = A1(g) = A1(g) + B1(g) � 8g. We prove the theorem for gen­ eral sets by mathematical induction. Suppose k � 1 and that the theorem is true for all Jlf1, fA1 with B1(g) < k. If A1(m) + B1(m) � 8 for m = 1, 2, - · ·,g, and if B1(g) = k, then Lemma 11.4 or Lemmas 11.7 and 11.8 supply us with sets Jlf2, !A2 such that B2(g) < k, -G\"2 c -G\"1, and Aim) + B/m) � (Jm for m = 1, 2, · · · ,g. Therefore, by our induction hypothesis, we have -G\"2(g) � 8g, which implies C1(g) � 8g. Theorem 11.10 The a/3 theorem. Let Jlf and !A be any sets of non-negative integers, each containing 0, and let a, {3, y denote the Schnirelmann densities of N, !A, N + !A respectively. Then y �min (1, a + {3). Proof Let Jlf1 and !A1 consist of the elements of Jlf and !A, respectively, that do not exceed g, an arbitrary positive integer. Then A1(m) �am and B1(m) � {3m form = 1, 2, - · ·, g. If we take 8 = min (l, a + {3), the condi­ tions of Theorem 11.9 are satisfied and we conclude that C1(g) � 8g. Notes on Chapter 11 481 Since C1(g) � (Jg for every positive integer g, we have y � (J = min (1, a + {3). PROBLEMS 1. What is the Schnirelmann density of the set of positive odd integers? The set of positive even integers? The set of positive integers = 1 (mod 3)? The set of positive integers = 1 (mod m)? 2. Prove that the analogue of Theorem 11.1 for Schnirelmann density, namely, d(.saf) = inf njan , is false. 3. Prove that the analogue of Theorem 11.10 for asymptotic density is false. Suggestion: Take .sat as the set of all positive even integers, and consider .sat+ .sat. 4. Prove that if d(.sat) = a, then A(n) � an for every positive integer n. Prove that the analogue of this for asymptotic density is false. 5. Establish that Theorem 11.10 does not imply Theorem 11.9 by consider­ ing the sets .sat= {0, 1, 2, 4, 6, 8, 10, · · · }, � = {0, 2, 4, 6, 8, 10, · · · }. Theorem 11.10 asserts that the density of .sat+ � is � t, whereas Theorem 11.9 says much more. 6. Exhibit two sets .sat and � such that d(.saf) = d(�) = 0, d(.saf + �) =1. 7. For any two sets .sat and � of non-negative integers, write a = d(.saf), f3 = d(�), y = d(.saf + �). Prove that y � a + f3 - af3. 8. Consider a set .sat with positive Schnirelmann density. Prove that for some positive integer n n.saf= (n + 1) .saf= ( n + 2) .saf= · · · = J where J is the set of all non-negative integers, and n.saf = .sat+ .sat + · · · +.sat with n summands. NOTES ON CHAPTER 11 For further reading on the subject of this chapter, see the book by Halberstam and Roth listed in the General References and the following: E. Artin and P. Scherk, \"On the sums of two sets of integers,\" Ann. Math. (2) 44 (1943), 138-142. F. J. Dyson, \"A theorem on the densities of sets of integers,\" J. London Math. Soc. 20 (1945), 8-14. H. B. Mann, \"A proof of the fundamental theorem on the density of sums of sets of positive integers,\" Ann. Math. (2) 43 (1942), 523-527. H. B. Mann, Addition Theorems, Wiley-Interscience (New York), 1965. Appendices We present a number of disconnected topics of algebra and analysis which are useful at various points in the book, and with which the reader might not be familiar. A.l THE FUNDAMENTAL THEOREM OF ALGEBRA A simple proof of this theorem can be given using the argument principle in the theory of analytic functions of a complex variable, but we give here an elementary proof that depends on compactness and on the simplest algebraic properties and inequalities concerning complex numbers. We begin with a basic lemma. Lemma A.l Let P(z) be a polynomial of degree at least one, whose coefficients are complex numbers. If P(z0) * 0, then the point z0 is not a local minimum of IP(z) l. Since the real numbers form a subset of the complex numbers, the coefficients of P(z) may in fact all be real, or even integers. Proof Let n be the degree of P(z), and put Q(z) = P(z0 + z)jP(z0). On expanding the binomials (z0 + z)k, we find that Q(z) is a polynomial of degree n, say We note that c0 = Q(O) = 1. We have to show that IQ{z) l does not have a local minimum at z = 0. Let k be the least positive number for which 482 Al The Fundamental Theorem of Algebra c k * 0, and suppose that the real number r is so small that 483 (A.1 ) This inequality holds for all small r, since the left side tends to 0 with r, while the right side is a positive constant. If lz l = r, then by the triangle inequality and by (A. 1) this is (A.2) Now write ck = Ce2rriO where C > 0 and 0 � (J < 1. If z = re2rri(-O+ 112>/k then ck zk + 1 = -Crk + 1. We assume that r is so small that this quantity is positive. Then the expression (A.2) is Since this is < 1, we conclude that the point z = 0 is not a local minimum of I Q(z)l, and the proof is complete. Theorem A.2 Let P(z) be a polynomial of degree at least one, whose coefficients are complex numbers. Then there is at least one complex number r for which P(r) = 0. A complex number r with this property is referred to as a root or zero of P(z). By dividing the polynomial z - r into P( z), we find that we may write P(z) = (z - r)Q(z) + s, where s is some complex constant. If P(r) = 0, then on substituting z = r in the above we deduce that s = 0. That is, we may write P(z) = (z - r )Q(z ). This process may be repeated, so that we may write where an * 0 is the leading coefficient of P(z), and n is its degree. This representation of P(z) is unique, apart from permutations of the roots r;. Thus we see that a polynomial of degree n > 0 has precisely n roots, provided that repeated roots are counted according to their multiplicity. 484 Appendices Proof Suppose that P(z) is of degree n, and write P(z) explicitly as P( z) =a z n +a z n - t + · · · + a n n - l o · If a0 = 0, then P(O) = 0, and we are finished. Henceforth we assume that a0 * 0. Let m denote the greatest lower bound of the real numbers IP(z) l, where z is allowed to take on any complex value. We show that there is a complex number r for which IP(r )I = m. It then follows from the Lemma that m = 0, and hence P(r) = 0. When lz l is large, the leading term of P(z) dominates all the other terms, so that IP(z)l is large. More precisely, let R be chosen so large that We may write P( z ) = zn ( a +a jz +a jz 2 + · · · + a jzn ) n n - l n - 2 0 · Hence by the triangle inequality, If lz l > R, then this is which by (A.3) is Since m � IP(O) I = la01, we deduce that if lz l > R then IP(z) l > m + la01. That is, if IP(z) l � m + la01, then lz l � R. Consequently, the great­ est lower bound m of all values of IP(z) l is the same as the greatest lower bound of those values of IP(z) l for which lz l � R. But IP(z)l is a continuous function, and the disc lzl � R is closed and bounded, so that by the compactness principle IP(z) l must assume its greatest lower bound m at some point, say IP(r) l = m. By the Lemma it follows that m = 0, so that P(r) = 0. A.2 SYMMETRIC FUNCTIONS A polynomial P(r1 , . • ·, rn) in the variables r1, . • · , rn is called symmetric if all permutations of the variables produce the same polynomial. Among the symmetric polynomials are the elementary symmetric polynomials A2 Symmetric Functions 485 ul> u2, • • · , un, defined as follows: u1 is the sum of all the r1, u2 is the sum of all products r1/;2 with 1 � i1 < i2 � n, and in general uk is the sum of all products r11r12 • • • r1* with 1 � i1 < · · · < ik � n. Thus uk is a sum of (� ) products, and in particular, un = r1 r2 • • • rn - On forming a monic polynomial whose roots are the r1, we find that Indeed, this identity may be used to define the uk . By the fundamental theorem of algebra (Theorem A.2), the general polynomial P( z ) =a zn +a zn - t + · · · + a n n -l 0 can be written in factored form, and on comparing the two expressions we see that (A.4) We now show that all polynomials symmetric in the r1 can be expressed in terms of the uk . Theorem A.3 The fundamental theorem of symmetric polynomials. Let F(r1, • • ·, rn) be a symmetric polynomial in the indeterminates r1, • • ·, rn - Then there is a polynomial P(z 1 ,. • ·, zn) such that F(rl> · · ·, rn) = P(ul> · · ·, un). The coefficients of P can be expressed as linear combinations, with integral coefficients, of the coefficients of F. The degree of Pis equal to the highest power of r1 occurring in F. The assertion concerning the coefficients of P implies that if the coefficients of F lie in a certain ring, then those of P will lie in the same ring. In particular, if the coefficients of F are integers, then the coeffi­ cients of P are also integers. Concerning the degrees of polynomials in several variables, we note that the degree of a monomial czr 1zi2 • •• z:;'n is defined to be m1 + m2 + · · · + mn , and the degree of a polynomial is the maximum of the degrees of the monomial terms with nonzero coeffi­ cients. A homogeneous polynomial (also called a form) is a polynomial all of whose monomial terms are of the same degree. In symbols, the last phrase of Theorem A.3 would be written deg P = deg,1 F. Proof We introduce a lexicographic ordering of monomials as follows: Assuming that a * 0 and b * 0, we say that 486 Appendices if the first nonzero term in the sequence j1 - k1, j2 - k2, j3- k3, • • ·, jn - kn is positive. Note that this ordering is independent of the nonzero coefficients a and b, so that -3zrzizj >- 100 zrzlzj. The leading term of a polynomial F is the monomial term of F that is largest with respect to this ordering, and we say that F >- G if the leading term of F is greater than the leading term of G. This does not totally order polynomials, since two distinct polynomials might have the same leading term, or the same leading term but with different coefficients. The relation >- has the property that if F >- G and G >- H, then F >- H. That is, the relation >­ is a partial ordering. Let a 1 , a2 , • • ·, an be non-negative integers, and consider as a polynomial in r1, • • ·, rn . The leading term of this polynomial is Suppose that c1ri\" 'r22 • • • r;:'\" is the leading term of F. Since F is symmetric, it is clear that m 1 � m2 � • • • � mn. On taking a1 = m 1 - m2, a2 = m2 - m3, ··· ,an = mn, we see that the leading term of is ri\"'r22 • • • r::'\"· Put F1 = F- c1Gl' Since the leading terms cancel, we see that F >- F!' We note also that the coefficients of F1 are linear combinations of the coefficients of F. As F1 is also symmetric, we may repeat this process, obtaining a further symmetric polynomial F2 = F - cp1 - c2G2 where c2 is the coefficient of the leading term of F1• The coefficients of F2 are linear combinations of the coefficients of F1, and hence are linear combinations of the coefficients of F. Continuing in this way, we construct a sequence F >- F1 >- F2 >- · · · . It is necessary to show that this method terminates, that is, that Fk is identically 0 for some k. Suppose that ck rf'r12 • • • r%\" is the leading term of Fk . Since Fk is symmetric, we know that q1 � q2 � • • • � qn. As F >- Fk, we also have m 1 � q1• Hence 0 � q; � m 1 for all i. But there are only (m 1 + l)n such n-tuples (q1, q2, • • ·, qn), so the reduction must terminate in at most this many steps. From this construction we find that each coefficient of P is a linear combination of the coefficients of F. In passing from F to F\" we introduced a monomial of degree m 1 in the variables u1, • • · , un . Since subsequent monomials will have at most this degree, and will not cancel this first monomial term, we observe that deg P = deg,, F. A2 Symmetric Functions 487 Example 1 Express F = L, r? rj in terms of elementary symmetric poly­ i\"') nomials. Solution The leading term of F is r�r2• On taking F1 = F- u1u2 , we find that F1 = -3 L, r;rjrk = -3u3 • i<j<k That is, F = u1u2 - 3u3• Here we are assuming that n � 3. If n = 2, then F = u1u2 . The fundamental theorem of symmetric polynomials (Theorem A.3) has many important applications. One of them is to provide information concerning the discriminant of a polynomial. Definition A.l Let f(z) be a polynomial of degree n with leading coefficient an and roots r1, • • ·, rn. The discriminant off is D( f) = a�n - z 0 ( r; - rj) z. l� i <j� n Clearly D(f) = 0 if and only if f has a repeated root. In the case that f is a quadratic polynomial, f(z) = az2 + bz + c, we know how to write the roots explicitly in terms of a, b, and c, and we find that the expression above reduces to the familiar quantity b2 - 4ac. For polynomials of higher degree it is in general not possible to express the roots in such explicit form in terms of the coefficients. Thus it is useful that the discriminant can still be calculated. Theorem A.4 Let be a polynomial of degree n. There is a homogeneous polynomial F(w0, w1 , · • · , wn) of degree 2n - 2 with integral coefficients such that D(f) = F( a0 , a u· · · , an ) . Moreover, if f(z) = (z - r1)g(z), then D(f) = D(g)g(r1 )2. Thus we see that if the coefficients of f are integers then D(f) is also an integer. By determining this integer we are able to determine whether f has a repeated root. 488 Appendices Proof By the fundamental theorem of symmetric polynomials (Theorem A.3 ), there is a polynomial P with integral coefficients such that the product over i and j in Definition A. 1 is P(u1, u2 , • · · , un). When the product over the roots is expanded, the highest power of r 1 that occurs is r?n -2• Thus deg P = 2n - 2. By (A.4) we see that Here the right side is a form of degree 2n - 2 in the coefficients a;. The last clause of the theorem is a direct consequence of the definition of the discriminant. Remark on Cakulation For polynomials of higher degree it is not an easy matter to derive the form F explicitly. Even for polynomials of degree n = 3 it is a challenging exercise to show that For practical purposes it is often easier to appeal to the determinant formula D(f ) = ( - 1 )<n - 2)(n - 0/2 det ( a ) ;nn - 2 where a = [B(i, j)] is a (2n - 2) X (2n - 2) matrix whose entries are as follows: if 1 � i � n - 1 and i � j � i + n - 1, then B(i, j) = (j + 1 - i)an +i -i - t and B(n - 1 + i, j) = (n + i- j)an +i-i· All other entries are 0. From this formula (whose proof we omit) it is immediate that D(f) is a form of degree 2n - 2, but the other properties of the discriminant are not so evident. We now apply the properties of the discriminant developed above to answer a question that arose in Section 2.6 concerning the problem of lifting a singular solution of a congruence to higher powers of p. Theorem A.S Let f(x) be a polynomial with integral coefficients and suppose that p6 II D(f). If f(a) = 0 (mod pi), p\"llf'(a), and j > B, then j � 2r + 1. From this we see in particular that if p% D(f) and f(a) = (mod p) then f'(a) ¥= O(mod p). In any case, it follows that if j > B then Theorem 2.24 applies. Proof Write f(x) = (x - a)g(x) + pir, where g(x) is a polynomial with integral coefficients and r is an integer. Let c0, c17 • • ·,en denote the A. 2 Symmetric Functions 489 coefficients of f(x). Since D(f) is a polynomial in the c; with integral coefficients, we see that D(f) = D((x - a)g(x)) (mod pj). By Theorem A.4 we know that D((x - a)g(x)) = D(g )g(a)2• As f'(x) = g(x) + (x - a)g'(x), we find that f'(a) = g(a). Hence D(f) = D(g)f'(a)Z (mod pj). The inequality j > 5 is equivalent to the assertion that D(f) ¥= O(mod pj). This implies that f'(a)2 ¥= 0 (mod pj), which is to say that j > 2r. If f(x) has a repeated factor then D(f) = 0 and Theorem AS is of no use. To avoid this difficulty one may first factor f(x) and search for roots (mod pj) of the irreducible factors. PROBLEMS 1. Suppose that f(z) = Ea;Zi = an n(z - r) is a polynomial of degree n with integral coefficients, and that g(z) is a polynomial of degree m with integral coefficients. Show that a;:' n g(r) is an integer. 2. Suppose that f(z) = an(z - r1) • · • (z - rn). Show that f'(r1) = an(r1 - r2)(r1 - r3) · · • (r1 - rn). Deduce that D(f) = ( - l)na�-2f'(r1)f'(r2) • · • f'(rn ). 3. Suppose that f is a polynomial of degree n with real coefficients and distinct roots, and that n = r + 2s, where r is the number of real roots of f, and s is the number of pairs of complex conjugate roots. Show that sgn D(f) = ( -1)5• Deduce that if n = 3 then D(f) > 0 for those polynomials f with three distinct real roots, and D(f) < 0 for those f with one real root and a pair of complex conjugate roots. 4. Let f(x) = a3x3 + a2x2 + a1x + a0. Show that the roots of f lie in geometric progression if and only if a�a0 = a3ai. S. Suppose that f(x) is of degree n, f(O) * 0, and that g(x) = xnf(ljx) is the polynomial obtained by reversing the order of the coefficients of f. Show that D(f) = D(g ). 6. Suppose that f is as in Problem 1, and that g(x) = f(x + a). Show that D(g) = D(f). Express D as a polynomial in a1, a2, ···,an, and show that aD aD aD na -- + (n- l)a -- +· ·· +a - = 0 n \" n-1 , I, • uan-1 uan-2 uao 7. Let polynomials in the variables r1, r2, · · ·, rn be ordered lexicographi­ cally, as in the proof of the fundamental theorem on symmetric polyno­ mials. Note that r1 >- r} for all k. Show that, despite this, any nonempty set of polynomials contains a minimal element. For each polynomial F in these variables, let P(F) be a proposition. Suppose that P(F) is true A.3 A Special Value of the Riemann Zeta Function 491 We complete the proof by establishing the identity (AS). De Moivre's Theorem states that (cos (J + i sin fJ)m = cos mfJ + i sin mfJ. Since cos (J + i sin (J = sin fJ(cot (J + i), we can write cos m(J + i sin m(J = sinm 6( cot (J + i) m , and by the binomial theorem we see that this is = sin m (J {cot m (J + i ( 7 ) cot m - 1 (J - ( ; ) cot m - 2 (J - · · · } . Equating imaginary parts here, and using i3 = -i, i5 = i, and so on, we get sin m(J = sinm (J[(7 ) cotm - ! (J- (�) cotm - 3 (} + (� ) cotm -s (J- ··· ]. We take m = 2N + 1, with N as in (AS), and observe that the expression in square brackets is a polynomial in cot2 6, say F(cot 2 6), so that sin (2N + 1) 6 = sin2N+ I (J · F( cot 2 6) (A.7) where (A.8) If (J is one of the N numbers (J = mr j(2N + 1), n = 1, 2, · · · , N, then sin (2N + 1)6 = 0, but sin (J * 0. Thus from (A. 7) we see that F(cot 2 6) = 0 for each of these N values of 6. That is, the N roots of the equation F(x) = 0 are precisely the N terms in the sum (AS). By taking k = 1 in (A.4) we deduce that E 2 nrr = ( 2N + 1 )/( 2N + 1 ) = N(2N- 1) n=l cot 2N + 1 3 1 3 ' and the proof is complete. PROBLEMS 1. Show that for any positive integer n there is a polynomial G(x) of degree N - 1 such that sin 2N6 = sin2N (J · cot (J · G(cot2 6). Show A4 Linear Recurrences 493 9. Show that limx ..... 0(cosec2 x - x- 2) = 1/3. Use this in the preceding problem to provide a second solution of Problem 3, and hence a second proof of the identity (AS) used to prove Theorem A.6. 10. Show that if M is a positive integer then M- 1 n sin Trm/M = M2 1 -M. m =l A.4 LINEAR RECURRENCES Definition A.2 Let k be a positive integer. We say that the sequence u0, u1, u2, · • • of real or complex numbers satisfies a linear recurrence of order kif there exist real or complex numbers b1, b2, • • · , bk such that (A. 10) for all integers n � k. Linear recurrences of order 2 were discussed in Section 4.4. A sequence may satisfy a linear recurrence of order k and also other recurrences of other orders. For example, the sequence un = ( -l)n satis­ fies the linear recurrence un = -un - t of order 1, but it also satisfies the linear recurrence un = un _ 2 of order 2. Suppose that the sequence u0, u 1 , u2, · · · satisfies the linear recur­ rence (A. 10) for all n � k. Let B = lb, l + lb2 l + · · · + lbk l, and for each non-negative integer n let Mn = max ( lu01 , lu, l, - · · , lun l ). We see by the triangle inequality that if n � k then M n � BM n _ 1 • By induction it follows that if {un} satisfies (A.lO) then there is a constant A such that lun l � ABn for n = 0, 1, 2, · · · . A sequence satisfying a bound of this kind is said to have \"at most exponential growth.\" For such a sequence, the associated power series generating function 00 (A.ll) has positive radius of convergence. More precisely, if lzl � r < 1/B, then the above series is absolutely convergent by comparison with the conver­ gent geometric series r.:_0 ABnrn. 494 Appendices Theorem A.7 Let {un} be a sequence of real or complex numbers. The following two assertions are equivalent: (i) un satisfies a linear recurrence of order k; (ii) the power series (A ll) has positive radius of convergence and f( z) is a rational function, say f(z) = P(z)jQ(z) where P(z) and Q(z) are polynomials with real or complex coefficients, deg ( P) < k, and deg ( Q) .;;;; k. Proof Suppose that (i) holds. More specifically, we suppose that (A lO) holds for all n � k. We have already shown that the power series (A ll) has positive radius of convergence. Let (A.l2) By grouping terms appropriately, we may write Q(z)f(z) as a power series, 00 Q(z )f( z ) = L cnzn . (A.l3) n =O This new power series has positive radius of convergence because f(z) does. By direct calculation we find that c0 = u0, c1 = u1 - b 1u0, and c2 = u2 - b 1u 1 - b2u2. The number of terms required to write en contin­ ues to increase with n until n = k. For n � k we find that the number of terms is constant, and that (A.14) From (AlO) we deduce that en = 0 for all n � k. That is, the power series in (A 13) turns out to be only a polynomial, say P(z), whose degree is strictly less than k. Then f(z) = P(z)jQ(z), and we have {ii), since deg ( Q) .;;;; k. We now suppose that (ii) holds, and derive {i). We write f(z) = P(z)jQ(z). If P(O) = 0 and Q(O) = 0, then we may divide both P and Q by an appropriate power of z so that at least one of P(O) and Q(O) is nonzero. If it were the case that P(O) * 0 and Q(O) = 0 then lf(z)l would tend to oo as z - 0, contrary to our hypothesis that the power series (All) has positive radius of convergence. Thus we see that f(z) may be ex­ pressed as the quotient of two polynomials, f(z) = P(z)jQ(z), with Q(O) * 0. By dividing P(z) and Q(z) by the nonzero constant Q(O), we deduce that f(z) may be written as such a quotient with Q(O) = 1. These two polynomials may not be the ones we started with, but their degrees A4 Linear Recurrences 495 are no larger than they were originally, so that deg (P) < k and deg ( Q) � k. Hence Q(z) may be expressed in the form (A. l2). Then (A. 13) and (A. 14) follow as before. Since Q(z)f(z) = P(z) is a polynomial of degree less than k, it follows that en = 0 for all n � k. Then (A. 14) gives (i) and the proof is complete. In the examples considered in Section 4.4, the solution un of a linear recurrence was written as a linear combination of exponential functions. To do this in general, we express the rational function f(z) in terms of partial fractions. Lemma A.8 Let k be a positive integer, and suppose that f( z) = P( z) 1 Q( z) is a rational function with deg (P) < k and deg (Q) = k, and that when Q(z) is factored it takes the form J Q( z ) =c O( z-rj) mi j =l (A.15) where c * 0, the rj are distinct real or complex numbers, and L.f_ 1mj = k. Then there exist real or complex numbers, aij such that J m; a . . f( z ) = L L '' ; j= l i =l ( z- r) (A.16) Proof We proceed by induction on k. Suppose first that k = 1. If P(z) is identically 0 then the representation is obtained by taking all the aij to be 0. Otherwise deg (P) = 0, which is to say that P(z) is a nonzero constant, say p. Since Q(z) = c( z- r1), we observe that if a11 = pjc then which is (A. l6) in this case. P(z ) a11 -- = -- Q(z ) z - r1 Now suppose that k > 1, and that the representation (A. l6) can be found for polynomials of degree k - 1. Let r be a root of Q(z) and let m denote its multiplicity, so that Q(z) = (z - r)m T(z) with T(r) * 0. Put a = P(r) jT{r ). Then P( z) a P(z ) - aT( z ) Q(z) = (z - r) m + Q(z) (A. l7) In the second term on the right, the numerator vanishes when z = r, and thus it has the factor z - r. That is, the numerator may be written as A4 Linear Recurrences 497 Theorem A.lO Suppose that the sequence u0, up · · · satisfies the linear recurrence (A.lO), and that the polynomial Q(z) in (A.12) has the factoriza- tion J Q( z) = n (1 - Ajztj (A.21 ) j = l where the numbers A 1 , A 2 , . • • , A 1 are distinct and nonzero. Then there exist polynomials Bi(x) with deg (B) < mi such that J un = L Bj(n)A'} (A.22) j- 1 for all non-negative integers n. Conversely, any sequence of the form (A.22) with deg ( B) < mj satisfies the linear recu\"ence (A.10). The possibility that one or more of the polynomials Bi may vanish identically is not excluded. Proof From Theorem A.7 and Lemma A.8 we see that if lz l is sufficiently near 0 then \"' P ( Z ) J m ; {3 f( z ) = L u zn = -- = L L ij i n-O n Q( z) j= l i -1 (1 - Ajz) By taking A = 1 in (A.20), and then repeatedly differentiating both sides, we find that 1 \"' . ---..,. = L ( n + l - 1 ) zn ( 1- z)' n-O i -1 for lz I < 1. Alternatively, this follows from the binomial theorem in the form of identity (1.13). Thus we see that when lz I is sufficiently small, where m · ( ) � (X + i- 1 ) Bj X = i':'/ ij i - 1 (A.23) is a polynomial in x of degree < m;. Then (A.22) follows by the unique­ ness of the power series expansion. 498 Appendices Suppose, conversely, that un is given by the formula (A.22), where deg (B) < m i for j = 1, 2, · · ·, J. Then there exist numbers {3ii for which (A.23) holds, and hence We suppose that Q(z) is defined by (A.21) and deduce that the right side above may be written in the form P(z)jQ( z), with deg (P) < k. Then the stated result follows by Theorem A.7. One may note that our use of power series to analyze linear recur­ rences is analogous to the use of Laplace transforms in the study of solutions of linear differential equations with constant coefficients. PROBLEMS 1. Show that there is an integer n0 such that the sequence un satisfies the linear recurrence (A. lO) for all integers n � n0, if and only if the power series (A ll) is a rational function. 2. Let ./ be a finite set of real or complex numbers. Suppose that un E ./ for each n, and that un satisfies the linear recurrence (A.lO) for all n � n0• Show that un is eventually periodic. That is, there is a positive integer q such that un+q = un for all n � n 1 • 3. Suppose that for each n, un = 0 or un = 1. Let f( z) be the power series (All). Show that f( z) is a rational function if and only if f{l j2) is a rational number. 1 \"' 4. Prove that if lz l < ({5 - 1)/2 then 2 = E Fn z n, where 1 - Z - Z n=O Fn is the nth Fibonacci number, as defined in Section 4.4. S. Let B(z) and C(z) be polynomials with real or complex coefficients that have no common root. Show that there exist polynomials X(z) and Y( z) such that B(z)X(z) + C(z)Y(z) = 1, deg X< deg C, and degY< deg B. 6. Use the result of the preceding problem to give a proof of Lemma A.B. *7. Show that if u0, u 1 , • • • is a sequence of real or complex numbers for 1 q which un = - E un -k for all n � q, then lim n --+00 un exists, and is a q k = l certain weighted average of u0, up · · ·, uq_ 1• A.4 Linear Recurrences 499 •s. Let A1, A2, · · ·, Aq be non-negative real numbers whose sum is 1. Suppose that u0, u 1, • • • is a sequence of real numbers for which q un = E Akun-k when n � q. Show that limn .... \"\" un exists, and has k - 1 the value A1u0 + (A1 + A2 ) u1 + (A 1 + A2 + A3 ) u2 + · · · +uq- l qA 1 + (q - 1)A2 + (q - 2) A3 + · · · + Aq 9. Let r1 , r2, • · ·, rn be given real or complex numbers, and for non­ negative integers k let sk be the symmetric function sk = r� + rf + · · · +r: of the r;. Show that if lz l is sufficiently small, then 1 1 1 GO --- + + · · · + = E sk z k. (A.24) 1- r1 z 1- r2 z 1- rn z k -O •to. Let r1, r2, · · ·, rn be given real or complex numbers, as in the preced­ ing problem. Put P(z) = (1 - r1 zX1 - r2 z) · · · (1 - rn z). Show that P(z) = 1 - u1z + u2 z 2 - • • • +( -l)nun z n, where the uk are the elementary symmetric polynomials of the r;. Show also that r1 P( z ) r2 P( z ) rn P( z ) -P'( z ) = + + .. · + . 1- r1z 1- r2 z 1- rn z Conclude that the left side of (A.24) is n - zP'(z)jP(z). •11. Using the two preceding problems, or otherwise, establish the Newton-Girard identities: If 1 � k � n, then k - 1 k . sk = ( -1 ) uk - E ( - 1 )10jSk-j • j =l n while if k > n, then sk = - E ( -l)jOjSk-j· j- 1 •12. Let k be a fixed positive integer. Show that the elementary symmet­ ric function uk of the integers 1, 2, · · ·, n is a polynomial in n of degree 2k, and with leading coefficient 1j(k!2k). General References G. E. Andrews, The Theory of Partitions, Addison-Wesley (Reading), 1976. T. M. Apostol, Introduction to Analytic Number Theory, Springer-Verlag (New York), 1976. A Baker, Transcendental Number Theory, Cambridge University Press (London), 1975. Z. I. Borevich and I. R. Shafarevich, Number Theory, Academic Press (New York), 1966. J. W. S. Cassels, An Introduction to Diophantine Approximation, Cambridge Tract 45, Cambridge University Press (Cambridge), 1957. J. W. S. Cassels, An Introduction to the Geometry of Numbers, Springer­ Verlag (Berlin), 1971 . J. W. S. Cassels, Rational Quadratic Forms, Academic Press (London), 1978. J. S. Chahal, Topics in Number Theory, Plenum (New York), 1988. H. Davenport, The Higher Arithmetic, 5th ed., Cambridge University Press (Cambridge), 1982. H. Davenport, Multiplicative Number Theory, 2nd ed., Springer-Verlag (New York), 1980. L. E. Dickson, History of the Theory of Numbers, Carnegie Institution of Washington (Washington), 1919; reprinted, New York, Chelsea (New York), 1950. W. Fulton, Algebraic Curves: An Introduction to Algebraic Geometry, Addi­ son-Wesley (Reading), 1989. C. F. Gauss, Disquisitiones Arithmeticae (Discourses on Arithmetic), English ed., Yale University Press (New Haven), 1966. E. Grosswald, Representations of Integers as Sums of Squares, Springer­ Verlag (New York), 1985. 500 General References 501 P. M. Gruber and C. G. Lekkerkerker, Geometry of Numbers, North­ Holland (Amsterdam), 1987. H. Halberstam and K. F. Roth, Sequences, Clarendon Press (Oxford), 1966. G. H. Hardy and E. M. Wright, An Introduction to the Theory of Numbers, 5th ed., Clarendon Press (Oxford), 1979. I. N. Herstein, Topics in Algebra, 2nd ed., Xerox (Lexington), 1975. L. K. Hua, Introduction to Number Theory, Springer-Verlag (Berlin), 1982. D. Husemoller, Elliptic Curves, Springer-Verlag (New York), 1987. K. F. Ireland and M. Rosen, A Classical Introduction to Modem Number Theory, Springer-Verlag (New York), 1982. B. W. Jones, The Arithmetic Theory of Quadratic Forms, Carus Monograph 10, Wiley (New York), 1950. A Y. Khinchin, Continued Fractions, University of Chicago Press (Chicago), 1964. D. E. Knuth, The Art of Computer Programming, Vol. 2: Seminumerical Algorithms, Addison-Wesley (Reading), 1969. N. Koblitz, A Course in Number Theory and Cryptography, Springer-Verlag (New York), 1987. N. Koblitz, Introduction to Elliptic Curves and Modular Forms, Springer­ Verlag (New York), 1984. L. Kuipers and H. Niederreiter, Uniform Distribution of Sequences, Wiley (New York), 1974. E. Landau, Elementary Number Theory, Chelsea (New York), 1958. D. H. Lehmer, Guide to Tables in the Theory of Numbers, Bulletin, National Research Council (Washington), No. 105, 1941. H. W. Lenstra, Jr. and R. Tijdeman (ed.), Computational Methods in Number Theory, Parts I, II, Math. Centre Tracts 154, 155, Amsterdam, 1982. W. J. LeVeque, Fundamentals of Number Theory, Addison-Wesley (Read­ ing), 1977. W. J. LeVeque, ed., Reviews in Number Theory, Vols. 1-6, Arner. Math. Society (Providence), 1974. W. J. LeVeque, ed., Studies in Number Theory, Math. Assoc. of America (Washington), 1969. W. J. LeVeque, Topics in Number Theory, Vol. II, Addison-Wesley (Read­ ing), 1956. L. J. Mordell, Diophantine Equations, Academic Press (New York), 1969. T. Nagell, Introduction to Number Theory, Chelsea (New York), 1981. 502 General References M. Newman, Integral Matrices, Academic Press (New York), 1972. I. Niven, Irrational Numbers, Carus Monograph 11, Wiley (New York), 1956. 0. T. O'Meara, Introduction to Quadratic Forms, Springer-Verlag (Berlin), 1973. 0. Ore, Number Theory and Its History, McGraw-Hill (New York), 1949. H. Pollard and H. Diamond, The Theory of Algebraic Numbers, Carus Monograph 9, Math. Assoc. of America (Washington), 1975. G. P6lya and G. Szego, Problems and Theorems in Analysis, Vol. I, Springer-Verlag (New York), 1972. G. P6lya and G. Szego, Problems and Theorems in Analysis, Vol. II, Springer-Verlag (New York), 1976. C. Pomerance, Lecture Notes on Primality Testing and Factoring, MAA Notes 4, Math. Assoc. of America (Washington), 1984. H. Rademacher, Lectures in Elementary Number Theory, Blaisdell (New York), 1964. M. Reid, Undergraduate Algebraic Geometry, Cambridge University Press (Cambridge), 1988. P. Ribenboim, Algebraic Numbers, Wiley (New York), 1972. P. Ribenboim, The Book of Prime Number Records, 2nd ed., Springer-Verlag (New York), 1989. P. Ribenboim, 13 Lectures on Fermat's Last Theorem, Springer-Verlag (New York), 1979. H. Riesel, Prime Numbers and Computer Methods for Factorization, Birkhauser (Boston), 1985. A Robinson, Numbers and Ideals, Holden-Day (San Francisco), 1965. K. H. Rosen, Elementary Number Theory and Its Applications, Addison­ Wesley (Reading), 1984. J. P. Serre, A Course In Arithmetic, Springer-Verlag (New York), 1973. D. Shanks, Solved and Unsolved Problems in Number Theory, Spartan (Washington), 1962. J. H. Silverman, The Arithmetic of Elliptic Curves, Springer-Verlag (New York), 1986. T. Skolem, Diophantische Gleichungen, Chelsea (New York), 1950. N. J. A Sloane, Handbook of Integer Sequences, Academic Press (New York), 1974. R. J. Walker, Algebraic Curves, Dover (New York), 1962. A Weil, Number Theory, An Approach Through History, Birkhauser (Bos­ ton), 1984. Hints SECTION 1.2 32. nk = ((n - 1) + l)k. 40. Use induction. 41. Use Theorem 1.10. Deal separately with the case in which one of b and c is 0. SECTION 1.3 8. If the units digit of n is j, then n has the form lOk + j, and we see that r = k - 2j. So the problem is to prove that if either lOk + j or k - 2j is divisible by 7, so is the other one. 26. Use a variation of the proof of Theorem 1.17 and recall Problem 10. 31. If f(j) = p, then f(j + kp) - f(j) is a multiple of p for every k, so f(j + kp) has the same property. 42. If k is odd, xk + 1 has a factor x + 1. 48. Use Problem 46 of Section 1.2. 51. Consider the highest power of 2, of 3, of 5, of 7 less than the square root. SECTION 1.4 5. Consider the number of ways of partitioning a set of ab elements into b disjoint subsets each containing a elements. 503 504 Hints SECTION 2.1 28. 34 = 1 (mod 5) by Fermat's theorem, and this with 34 = 1 (mod 2) implies that 34 = 1 (mod 10). Hence 34n = 1 (mod 10) for any n ;;.:: 1. 30. Use Theorem 2.8 to establish that 320 = 1 (mod 25). In addition, 32 = 1 (mod 4), whence 320 = 1 (mod 100). 36. If p > 5, (p - 1)! has factors 2, p - 1 and (p - l)j2, and so (p - 1)! is divisible by (p - 1)2• Then recall Problem 32 in Section 1.2. 38. If there are only finitely many such primes, let P be their product, and consider any prime factor of 4P2 + 1 in the light of Lemma 2.14. 41. If a, b, c is such a set, so also is ka, kb, kc for any positive integer k. Hence it suffices to determine all \"primitive\" sets with the property (a, b, c) = 1. Also there is no loss in generality in assuming that a � b � c. 52. Consider congruences (mod p - 1). 55. Find a small modulus m for which the given determinant is ¢. O(mod m). SECTION 2.2 10. In case a ¢. 0 (mod p ), show that if c ¢. 0 (mod p) is given, then there is a unique solution (x, y) for which x - y = c(mod p). ( a ) ( a _ 1 ) pa 14. Use the identity � = � _ 1 k . ( a _ 1 ) ( a ) ( a _ 1 ) 15. Use the identity P k = � - � _ 1 . SECTION 2.3 36. Use Theorem 2.8 with m = 4 and m = 25. SECTION 2.4 1. Verify that bx + cy = 1 (mod p), i = 1, 2, · · ·, 5, where the P; are 5 distinct five digit primes. Then use Part 3 of Theorem 2.3. 22. Show that 1 - v � e -v for all real numbers v. Derive a corresponding lower bound from inequality (1.9) in Section 1.3. Hints 505 SECTION 2.5 4. Let m 1 = (a, m), m 2 = mjm \" then apply the preceding problem to show that aH = a (mod m;), i = 1, 2. SECTION 2.7 4. Begin by showing that there is a q1(x) such that f(x) = (x - a 1 )q 1(x) (mod p) and that q 1(x) = O(mod p) has solutions x = a 2 , x = a3, • • ·, x = a 1 (mod p ). Then use induction. SECTION 2.8 17. Show that if p > 2 then a belongs to the exponent 2n + t (mod p). 32. Recall Lemma 2.22. 33. Show that k is the order of a modulo m where m = ak - 1. 35. Let q 1, q2, . • ·, q, be a collection of such primes. Take a= pq1q2 q,, k = p in Problem 33, and then apply Problem 34. 37. Note that if p is the least prime divisor of n then (p - 1, n) = 1. SECTION 2. 11 22. Interpret the sum in Z and use the result 13 + 23 + · · · + n3 = P ' n2(n + 1)2 /4. 23. Mter the first k columns of A have been determined, choose the (k + 1)st column so that it lies outside the column space of the first k columns. SECTION 3. 1 13. Use the fact that there is some integer a such that r = a 2 (mod m). 14. The sum of the squares of the first n natural numbers is n(n + 1) ·(2n + 0/6. 17. Denoting the first given product by P, and (2k + 1)! by Q, prove that P = (-l)kQ(mod p) by using 2j = -(p - 2j) (mod p). Similarly, relate Q to the product of the quadratic residues modulo p by replacing any nonresidue n in Q by the quadratic residue - n, and use the preceding problem. Hints 507 SECTION 3.7 2. Consider the form x2 + xy + 4y 2. 6. Find h such that h2 = -23 (mod 4 · 139), and then reduce the form 139x 2 + hxy + ky 2. SECTION 4. 1 21. Use the identity {(u + v)/2}2 - {(u - v )/2}2 = uv to get bounds on the integer (u + v)/2. 24. f(a, {3, y) is related to the number of solutions of ax + {3y � y in positive integer pairs x, y. 25. Denote a - b by c. For any prime p dividing both c and n, if p k is the highest power of p dividing n, prove that p k divides every term in the expansion of {(b + c)n - bn}jc. 27. It suffices to take 0 � a < 1, 0 � {3 < 1, and g.c.d. (j, k) = 1. SECTION 4.2 19. Assume that 2n - tq is a perfect number, where n > 1 and q is odd. Write u(q) = q + k and so deduce from u(2n - 1q) = 2nq that q = k(2n - 1). Thus klq and k < q. 22. For part (a) prove that the largest prime divisor of m is a divisor of n to the same power. SECTION 4.3 11. Separate the integers � n into classes, so that all integers k such that (k, n) = d are in the same class. 14. Use (4.1). 27. F(n) is the sum of the roots of the polynomial xn - 1. Thus one may appeal to the case k = 1 of the identity (A.4) in Appendix A.3. SECTION 4.4 4. Recall (1.15). 7. Let n = mq, and induct on q. 508 Hints SECTION 5. 1 14. For the first part, use Theorem 4. 1. For the second part, note that one may take x1 = cja, y1 = 0. SECTION 5.3 11. Write the equation in the form (x + y)2 + (x - y)2 = (2z)2. 13. Any solution has y even, because y odd implies z2 - x2 = 2 (mod 8), which is impossible. Hence x and z are odd, and the proof of Theorem 5.5 may be used as a model. 14. After replacing x by -x, if necessary, argue as in the proof of Lemma 5.4 that there exist odd integers s and t such that z - x = 5s2, z + x = t 2. Then choose r so that t = s + 2r. SECTION 5.4 3. Remove powers of 2 common to x and y, then argue (mod 16). 4. Consider powers of 2. 12. Write the equation as x2 + 4 = (y + 3Xy 2 - 3y + 9). SECTION 5.5 8. Recall Problem 17 at the end of Section 3.3. SECTION 5.7 10. Recall Problem 14 at the end of Section 5.4, and argue as in the proof of Theorem 5.24. 11. See the preceding hint. SECTION 5.8 1. Treat p = 2, p = 3 by separate arguments. Hints 509 SECTION 6.3 6. If (ajb)11\" is rational, so is b(ajb)11\", which is a root of the equation x\" = ab\" - 1• 9. Use the infinite series of cos x and adapt the ideas of the two preceding problems. 11. If n = 3, the area of such a triangle can be shown to be rational by the use of one standard elementary formula, but irrational by another. For values of n other then 3, 4, or 6, a similar contradiction can be obtained by applying the law of cosines to a triangle formed by two adjacent vertices and the center of the polygon. SECTION 6.4 14. If lx l + ly l � c, then lxy l � c 2 /4. 17. Recall the method developed in Section 5.2. SECTION 7.3 1. By Lemma 7.8, we see that 8 = 1 + 1/8 in this case. This gives a quadratic equation, only one of whose roots is positive. 2. Use the result of the preceding problem along with Lemma 7.8. SECTION 7.5 2. Use g = 1r- 1 and n = 1. SECTION 7.8 2. Use the identity (xi- dy�)(x� - dy�) = (x1x2 - dy1 y2)2 - d(x1 y2 - x2 yi)2. 6. Use Theorem 5.1 and Corollary 7.23. SECTION 8.1 3. Recall Theorem 4.1(3), (5). 4. The product is ett<xl. 6. Expand (1 + 1)2\" using the binomial theorem. 8. Use Bertrand's postulate. 510 SECTION 8.2 4. For the conditional convergence use the alternating series test. 5. Consider the limit as s - +co. 23. The integral is a sum of terms of the form n fn\" + 1 u-s - 1 du. SECTION 8.3 11. For the last assertion, note that E 1/<f>(n) = o((l!U) E n/<f>(n)) = 0( 1). U<n �2 U n�2 U Then put U = xj2k and sum over k. SECTION 9.1 Hints 7. After applying Theorem 9.1 to get polynomials q(x) and r(x) in Q[x], multiply by a suitable positive integer k so that kq(x) and kr(x) have integral coefficients, and use the fact that g(m) > kr(m) for sufficiently large integers m. 9. If there were only finitely many such primes p, let P be their product, define x0 = P\"f(O), and examine f(x0) with n large. SECTION 9.3 1. To prove that Q(w2 W> is different from Q(wW), assume that w2 W is an element of the latter field, that is, assume that there are rational numbers a, b, c such that w2 W = a + bwW + c(wW)2. Prove that no such numbers exist. SECTION 9.5 7. Define a = (x - 2Vm)jy, so that N(a) is certainly an integer if x and y satisfy x2 - y2 = 4m . Choose x = m + 1, y = m - 1 so that a is not an integer if lm - 11 > 4. The cases lm - 11 � 4 can be treated specially. SECTION 9.9 6. Use part (5) of Theorem 9.29. Hints 5ll SECTION 10.1 3. Use Problems 1 and 2 to show that the common value is E'j_ 1 p(n - j). APPENDIX A.3 2. Recall that cot 8 = - cot ( 1r - 8 ), and that cot 1r /2 = 0. 4. Consider the product of the roots of the polynomial F(x) in (A.8). 6. Recall that sin 4> = (e;q, - e-i<f>)j(2i), and use the identity of the preceding problem. 7. Take the derivative of the logarithm of the absolute value of both sides of the identity in the preceding problem. d 8. Recall that du cot u = - cosec2 u . Answers Section 1.2, p. 17 1. (a) 77, (b) 1, (c) 7, (d) 1. 2. g = 17; X = 71, Y = - 36. 3, (a) X = 9, y = - 11, (b) X = 31, y = 44, (c) X = 3, y = -2, (d) X = 7, y = 8, ( e) X = 1, y = 1, Z = -1. 4. (a) 3374, (b) 3360. 5. 128. 7. 6, 10, 15. 17. 1, n(n + 1). 18. a, b. 25. x = lOOn + 5, y = 95 - lOOn, n = 1, 2, 3, · ·· , will do. 27. a = 10, b = 100 is a solution in positive integers. All solutions are given by a = ± 10, b = ± 100; a = ± 20, b = ±50; a = ±50, b = ± 20; a = ± 100, b = ± 10, with all arrangements of signs. There are 16 solutions in all. 28. a = 10, b = 100, c = 10, 20, 50, or 100; a = 20, b = 50, c = 10, 20, 50, or 100; and all permutations of these, 36 answers in all. Section 1.3, p. 28 1. For every prime p, at least one of a(p), f3(p) is 0. 2. 3; 7. 13. p, p 2; p, p 2, p 3; p 2, p 3. 14. p 3, p. 15. 3l a(p) for all p; a(p) ,;;; f3(p) for all p. 16. 2 153 105 6. 22. Counterexamples for false statements are (1) a = 1, b = 2, c = 3. (8) a = 8, c = 4. (10) p = 5, a = 2, b = 1, c = 3. (13) a = 2, b = 5. Section 2.1, p. 56 1. 7, 24, 41, 58, 75, 92. 2. 0, 3, 6, 9, 12, 15, 18, 21, 24, 27, 30, 33, 36, 39, 42, 45, 48. 3. 1, 5, 7, 11 (mod 12); 1, 7, 11, 13, 17, 19, 23, 29 (mod 30). 4. y = 1 (mod 2); z = 1 (mod 6). 512 Answers 5. x = 5 (mod 12). 10. m = 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12. tf>(m) = 1, 1, 2, 2, 4, 2, 6, 4, 6, 4, 10, 4. 11. X = 5. 13. 1, 3, 9, 27, 81, 243. 15. 0, 0, 1, 1, 11. 28. 1. 29. 6. 30. 01. 39. One example is a = 17, b = 8, m = 15. 41. Primitive solutions with a .;;; b .;;; c are a = b = 1, c any positive integer. 42. Solutions such that (a, b, c) = 1, c � lb I � Ia I are a = -b = ± 1, c = 1 or 2; a = -1, b = 2, c = 3; a = b = ± 1 with any c > 0; a = 1, b = 1 - c with any c > 2; a = 2, b = - 2n + 1, c = 2n + 1 with any n > 1. Section 2.2, p. 62 4. x(x + 1Xx + 2) · · · (x + m- 1) = O(mod m). 513 5. (a ) No solution; (b) No solution; (c) x = 318 (mod 400); (d) x = 31, 66, 101 (mod 105); (e) x = 62 (mod 105); (f) x = 17 + 43 t (mod 817) with 0 .;;; t .;;; 18; (g) x = 836 (mod 999). 6. (a) 5; (b) 0; (c) 5. 7. 73 /105; 4j7. 13. x = 42 (mod 125). Section 2.3, p. 71 1. X= 106. 2. 23 + 30j. 3. x = 33 (mod 84). 4. -2 + 60j. 7. No solution. 8. 1732. 9. 1, 2. 10. 960. 11. 2640. 12. 1920. 13. 6720. 14. x = 1, 2, 6 (mod 9); x = 1, 3 (mod 5); x = 1, 6, 11, 28, 33, 38 (mod 45). 15. No solution. 16. x = 1, 3, 5 (mod 503). 17. x = 1, 3, 5, 14, 16, 27, 122, 133, 135 (mod 143). 29. n odd. 514 30. n even. 31. n = 5k, k = 1, 2, · · · will do. 32. 35, 39, 45, 52, 56, 70, 72, 78, 84, 90. 33. 3, 1, 2, 4. 36. 76; 01. 42. n = 1, zi or zi3k with j and k positive. 45. zc where c is the number of distinct primes dividing m. Section 2.4, p. 82 4. 2140 = 67 (mod 561) but 2 280 = 1 (mod 561). 5. 21023 = l(mod 2047). 6. 31023 = 1565 (mod 2047). 10. (33, 341) = 11; (31, 341) = 31. 13. 14. Answers 14. (a) 173; (b) 41; (c) 37; (d) 83; (e) Method fails. Taking u 0 = 3 gives the divisor 43; ( f) 16193. 16. 4; 5. 17. 461333. Section 2.5, p. 86 1. k = 43; a = 53. 2. m = 3989 · 9839. Section 2.6, p. 91 1. x = 1, 4, 7 (mod 27); no solution (mod 81). 2. No solution. 3. x = 4(mod 53). 4. 7, 15, 16, 24 (mod 36). 5. 15 (mod 33). 6. No solution. 7. 23 (mod 73). 8. 308060 (mod 1013). Section 2. 7, p. 96 1. (a) x 5 + x 2 + 5 = O(mod 7); (b) x 2 + 3x - 2 = O(mod 7); (c) x4 - x3 - 4x + 3 = O(mod 7). 9. 10, 35, 50, 24. Section 2.8, p. 106 1. 2, 2, 3, 2, 2. 2. 5. 3. 4. 4. Modulo 7: 1, 3, 6, 3, 6, 2. Modulo 11: 1, 10, 5, 5, 5, 10. Answers 515 7. p- 1. 0. 8. (a) 4; (b) 0; (c) 4; (d) 1. 10. (a) 9, 15, 8, 2; (c) 3, 5, 14, 12; (d) 15. 11. x 2 = 1, x 2 = 2, x 2 = 4, x 2 = 8, x 2 = 9, x 2 = 13, x 2 = 15, x 2 = 16 (mod 17). 20. 2 + 101 t is a primitive root (mod 1012 ) if and only if t ;:j; 83 (mod 101). Section 2.9, p. 114 1. (a ) (x -1)2 = 2(mod5); (b) (x + 1)2 = 4(mod 7); (c) (x -1)2 = 6(modl l); (d) (2x + 1)2 = 5 (mod 13). 4. (a ) x = ± 6 (mod13); ( b) x = ±5 (mod 19); (c) x = ±5 (mod ll); (d) x = ± 6 (mod 29). Section 2.10, p. 119 1. (a ), ( e), (f), (h), (i). 3. 7 -2 17 30 8 3 1 4 5 7 8 17 30 7 3 -2 1 2 5 0 -2 17 8 3 -2 30 7 4 5 2 3 17 30 3 -2 17 7 8 5 0 3 4 30 7 -2 17 30 8 3 0 1 4 5 8 3 30 7 8 -2 17 2 3 0 1 3 -2 7 8 3 17 30 3 4 1 2 Section 2.11, p. 126 6. 8. 13. 0 1 2 3 4 5 6 0 0 1 2 3 4 Ell 0 0 1 2 3 4 5 6 0 0 0 0 0 0 1 1 2 3 4 5 6 0 1 0 1 2 3 4 2 2 3 4 5 6 0 1 2 0 2 4 6 1 3 3 4 5 6 0 1 2 3 0 3 6 2 5 4 4 5 6 0 1 2 3 4 0 4 1 5 2 5 5 6 0 1 2 3 4 5 0 5 3 1 6 6 6 0 1 2 3 4 5 6 0 6 5 4 3 0 2 3 1 3 4 4 0 1 5 1 2 0 2 3 2 4 5 3 5 0 5 6 0 0 5 6 3 5 1 4 6 3 4 2 2 1 20. ( a) is an integral domain; (b) is an integral domain if and only if m is a prime. Answers Section 3.4, p. 154 1. (a) Positive definite, (b) Negative definite, (c) Indefinite, (d) Positive definite, (e) Indefinite, ( f) Positive definite. 2. The perfect squares, including 0. Section 3.5, p. 162 1. x 2 + xy + 5 y2• Section 3.6, p. 169 1. 6, 7, 8, 9. 2. 24. 3. 32. 4. 292 2 + 67 2 = 89753. Section 3.7, p. 176 6. Two representations by each of /1 and / 2 . Section 4.1, p. 184 1. 529, 263, 263, 263, 87. 2. 24. 3. ( a) All x such that {x} < 1/2. (b) All x. (c) All integers. (d) All x such that {x} � 1/2. (e) All x such that 1 .;;; x < 10/9. 5. (a) e = E1 .,1[n jpi] if p is odd, e = n + E1 .,1[nj2i] for p = 2. (b) e = E1 ., 1([2njpi] - [njpi]) if p is odd, e = 0 for p = 2. 12. a - m[(a - 1)/m]. 29. 1. (n - l)j 2. Section 4.2, p. 191 1. 7. 2. 12. 3. 2, 1, 12, 24. 4. 6. p k(a +l) _ 1 8, CTk(n) = np k where n = 0pp a. p - 1 517 10. If f(n) = 1 for all n, then f(n) is totally multiplicative, but then F(n) = d(n) is not. 13. Take x = p \" - 1 where p is any prime. 16. 6, 28, 4%. 22. m = 12, n = 14. Section 4.3, p. 195 1. n = 33 will do. 3. 1. 7. Ed1\" p,(d)u(d) = ( -l)w<n> 0P· pin 518 Answers Section 4.4, p. 204 1. u , = n, u , = 1. 11. u , = 1 + 2 \" -2 - (- 2)\" -2• 23. u , = a 2\" + {B\", (b) u , = a 2\" + J33 \" + 1/2, ( c) u , = a 2\" + J33 \" + tn +7/4. Section 4.5, p. 210 15. n- n j(pq) - n j(qr )- nj( rp) + 2nj(pqr). Section 5.1, p. 218 2. (1 + 7t, - 1 + lOt) for integral t. 3. ( a) (8 + 17t, -7 - 2l t), (b) no solution; (c ) ( -29 + 99 t, 34 - lOlt). 4. ( a) (2, 14), (5, 9), (8, 4); (b) (6, 3); ( c) (2, 7); (d) (2, 5); (e) no solution; (f) no solution; (g) no solution. 5. (14, 65). Section 5.2, p. 229 1. (-2 - 2t, 3, 1, t) will do. 2. All a, b, c such that both a = b = c (mod 2) and a = c (mod 3). (1 - 4t, 6t, -4t, t) will do. Section 5.3, p. 233 1. (3, 4, 5), (4, 3, 5), (5, 12, 13), (12, 5, 13), (15, 8, 17), (8, 15, 17), (21, 20, 29), (20, 21, 29). 3. ( a) (3k, 4k, 5k), (4 k, 3k, 5k ). (b ) None. 6. u = dr 2, v = es 2 where d and e are positive integers such that de = 6. 7. n ¢ 2 (mod 4). Section 5.5, p. 248 2. 13. 3. It has a nontrivial solution. 4. No solution. 5. It has a nontrivial solution. Section 5.6, p. 260 ( 2m2 + 1 2m ) 1' 2m2 - 1 ' 2m2 - 1 · ( 6m2 - 8m + 3 -4 m2 + 6m - 2) 2' 2m2 - 1 ' 2m2 - 1 · 3. m0 = ±co, m1 = 1, m 2 = -1 . 5. ( m2 - 2, m3 - 2m). 6. (m2 + 2, m3 + 3m ). Answers 5 19 10. Tangent through (1, 2) intersects the curve at (0, - 1). Tangent through (0, 1) intersects the curve a third time at (0, 1), that is, (0, 1) is an inflection point. The chord through (0, 1) and (1, 2) intersects the curve at ( -1, 0). The chord joining (0, 1) and (0, - 1) intersects the curve at infinity. Likewise for the chord joining (1, 2) and (1, - 2). 14. Xn +t = Xn(x; + 2Yj), Y,+ 1 = - Y,(2 X; + Y,3), Zn + t = Zn(x; - Y,3). Section 5. 7, p. 278 5. c = 0, c = ± 1. 8, (1, 1) E �(Q). 9. (0, 0). 10. (0, 0), ( ± 1, 0). 11. (0, 0), (2, ± 4). 18. a = 0, b - a + 1. Section 6.1, p. 300 6. a = b = d = 1, c = 0 will do. Section 7.1, p. 327 1. 17/3 = (5, 1, 2), 3/17 = (0, 5, 1, 2), 8/1 = (8). 3. (2, 1, 4) = 14/5, <- 3, 2, 12) = -63/25, (0, 1, 1, 100) = 101/ 201. Section 7.2, p. 329 1. The following conditions are necessary and sufficient. In case a 1 = b1 for 0 .,;; j .,;; n, then n must be even. Otherwise define r as the least value of j such that a1 \"* b1. In case r .,;; n - 1 , then for r even we require ar < b\" but for r odd, ar > br. In case r = n, then for n even we require an < bn, but for n odd we require an > 1 + bn, or an = 1 + bn with bn + t > 1. Section 7 .3, p. 333 1. (1 + /5)/2. 2. (3 + /5)/2, (25 - /5)/10. 3. (a) 1 + /i, (b) (1 + /3)/2, (c) 1 + /3, (d) 3- 13. Section 7 .4, p. 336 if a0 \"* 0, if a0 = 0. 1. fi = (1, 2, 2, 2, ... ), fi - 1 = (0, 2, 2, 2, ... ), fi /2 = (0, 1, 2, 2, 2, ... ), 13 = ( 1, 1 , 2, 1, 2, 1, 2, ... ), 1/ 13 = (0, 1, 1, 2, 1, 2, 1, 2, . .. ) . Section 7 .6, p. 344 1. 1/1, 3/2 will do. 2. 3/1 , 22/7 will do. 520 Answers Section 7.7, p. 351 1. c = 1,2, - . ·, 2[vd]. 2. /83. 3. (3, T;O) . Section 7 .8, p. 356 8. No solution for x 2 - 18y 2 = -1 ; x = 17, y = 4. 9. X = 70, y = 13; X = 9801, Y = 1820. 10. X= 29718, y = 3805; X= 1766319049, Y = 226153980. Section 8.2, p. 387 1. No. If f(n) = g(n) = 1 for all n, then f * g(n) = d(n), which is not totally multiplicative. 17. Oog 9)j(iog 10). Section 9.2, p. 419 1. x - 7, x3 - 3x 2 ;2 + 3xj4 - 1, x4 - 4x3 - 4x 2 + 16x - 8. 3 7, n' 1 + .fi + 13 are algebraic integers. Section 9.4, p. 425 3. Yes; no, for example a = (1 + i/3)/2. Section 9.5, p. 427 6. a = (1 + 7i)/5 will do. 7. The Hint also works in case m = - 2. The other special cases can be handled by such numbers as (1 + 4F3)/7, (9 + 4/i)/7, (27 + /3)/11, (4 + lOv'S)/11. Section 9.9, p. 440 7. y = 0, X= 1. Section 10.3, p. 457 2. n = 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11 , 12. p(n) = 1, 2, 3, 5, 7, 11, 15, 22, 30, 42, 56, 77. n = 13, 14, 15, 16, 17, 18, 19, 20. p(n) = 101, 135, 176, 23 1, 297, 385, 490, 627. Section 10.4, p. 463 1. n = 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11 , 12. u(n) = 1, 3, 4, 7, 6, 12, 8, 15, 13, 18, 12, 28. n = 13, 14, 15, 16, 17, 18, 19, 20. u(n) = 14, 24, 24, 31, 18, 39, 20, 42. Answers Section 10.6, p. 471 2. p(35m + 19) = 0 (mod 35). Section 11.1, p. 475 1. (a) 1/2, (b) 1/2, (c) 1/3, (d) 1/4, (e) 1/m, (f) 0, (g) 0, (h) 0, (i) 0, (j) 0. 15. 1/11. Section 11.2, p. 481 1. 1/2, 0, 1/3, 1/m. 52 1 Index Apparicio, E� 406 Approximations by rationals, 304, 336 best possible, 305, 343 Arithmetic functions, 188 estimates of, 389 Artin, E., 48 1 Artin's conjecture, 290 Associates of integers, 425 Associative law, 11 6 Asymptotic density, 408, 473 Asymptotic equivalence, 28 Atkin, A 0. L., 130 Atkin's method, 130 Aubry, L., 323 Authors' phone numbers, 14 Automorph of a form, 172 Ax, J., 291 Bachet, C., 293 Bachet's equation, 291 Baker, A, 500 Bauer, M., 130 Belonging to an exponent, 97, 124 Bertrand, J. L. F., 406 Bertrand's postulate, 367 Bezout's theorem, 258, 294 Big-0 notation, 365 Binary operation, 11 6 Binary quadratic form, 150 Binomial coefficients, 35 Binomial theorem, 35 Birational equivalence, 273 Birkhoff, G., 3 Blichfeldt, H. F� 322 Blichfeldt's principle, 312 Boolean algebra, 127 Borevich, Z. 1., 130, 290, 293, 408, 500 Bounds on partitions, 462 Brauer, R, 290 Bremner, A, 294 Burgess, D., 177 Calculation, remarks on, 6, 14, 44, 66, 74, 80, 100, 11 2, 168, 201, 214, 281, 355, 358, 488 Calendar problem, 183 Canonical factoring, 21 Carmichael number, 59, 78, 83, 107 Cartesian product of sets, 68 Cassels, J. W. S., 179, 290, 291, 322, 359, 500 Catalan's conjecture, 289 Cauchy, A L., 293 Center of a group, 162 Chahal, J. S., 294, 500 Chebyshev, P. L., 406 Chebyshev's theorem, 360, 366 Chevalley, C., 293 Chinese remainder theorem, 64 Chord-and-tangent method, 257 Chord on a curve, 256 Chudnovsky, D. V. and G. V., 295 Oass number, 161 Closed under an operation, 21, 116 Combinatorial number theory, 206 Common divisor, 6 Common multiple, 16 Commutative group, 11 7 Complement of a set, 472 Completely multiplicative function, 189 Complete residue system, 50 Component of a curve, 25 1 Composite number, 20 Composition formula, 179 Computation, see Calculation Congruence class, 50 Congruence property of partitions, 470 Index Congruences, 47 degree of, 61 of higher degree, 70 identical, 62 inconsistent, 65 lifting solutions of, 88 linear, 62 number of solutions of, 61, 93 , 94 with prime modulus, 91 with prime power moduli, 86 systems of, 64 ax= 1 (mod m), 52 (p - 1)! = 1 (mod p), 53 x2 = - 1 (mod p ), 53, 132, 163 ax= b (mod m), 62 f(x) = 0 (mod Jf'), 86 xd = 1 (mod p), 95 x2 =a (mod p), 101, 1 34 x\" = a (mod p), 101 x\" = a (mod m), 104 x\" = a (mod 2), 105 x3 = a (mod p), 11 5 x 2 = 2 (mod p), 134 x 2 = p (mod q), 137 ax2 + by 2 + cz2 = 0 (mod p2), 246 Conjugate algebraic numbers, 423 Conjugate partitions, 448 Column matrix, 227 Column operations on equations, 217 Continued fractions, 325 convergents of, 332 finite, 327 infinite, 329, 33 1 partial quotients, 326 periodic, 344 purely periodic, 348 secondary convergents of, 340 simple, 327 uniqueness of, 329, 335 Convergents of a continued fraction, 332 Convex set, 313 Coprime, 9 Cryptography, 84 Cubic residue, 136 Curves, general, 249 Curves of genus > 1, 288 Cyclic group, 122 Cyclotomic polynomial, 1 97 Davenport, H., 45, 322, 408, 500 Day of the week, 183 Definite form, 151 Degree of a congruence, 61 of a polynomial, 410 Delange, H., 407 de Ia Vallee Poussin, C. J., 45, 360, 406 Deligne, P., 296 Density of sequences of integers, 472 asymptotic, 408, 473 natural, 408, 473 Schnirelman, 476 de Polignac's formula, 182 Determinant, 59 of a lattice, 314 Determinantal divisor of a matrix, 230 Diamond, H. G., 406, 502 Dickson, L. E., 500 Difference notation, 42 Digits, 28 Diophantine equations, 212 linear systems of, 220 x\" + y\" = z\" ,l ,237, 292 ax+ by = c, 13, 213 x2 + r = p, 54 x 2 + y2 = n, 55 a1x1 + ... + anXn = c, 21 9 x 2 + y2 = z2, 23 1, 409, 438 1 5x2 - 7y2 = 9, 234 x3 + 2y3 + 4z3 = 9w3, 235 r = x3 + k, 236, 29 1, 439, 44 1 x4 + x3 + x 2 + x + 1 = y2, 237 x4 + y4 = z4, x4 + y4 = z2, 237 ax 2 + by2 cz2 = 0, 242 y2 = x3 - 4x, 27 1 y2 = x3 -Ax - B, 273 r = x3 + � + bx + c. 274 xm - y\" = 1, 289 x4 - 17 = 2y, 290 xP - yP = zP, 292 x2 + r + z2 + w2 = n, 317 x2 - dy 2 = N, 351 x2 + r = 2z2, 439 x3 + y3 = z3, 44 1 Diophantine geometry, 296 Diophantus, 293 Direct product, 68, 124 523 Dirichlet, P. G. L., 31 , 45, 292, 322, 407, 408 Dirichlet characters, 404 convolution, 377 series, 374 theorem, 177 Discriminant of a form, 150 of a polynomial, 487 Disquisitiones Arithmeticae, 47 524 Divisibility, 4 of algebraic integers, 425 of polynomials, 410 tests for, 29 Division algorithm, 5 for polynomials, 41 1 Divisor function, 188 Divisors, 4 number of, 188 Dixon, J., 44 Dominated convergence, principle of, 379 Double point, 253 Duren, P., 47 1 Dyer-Bennet, J., 107 Dyson, F. J., 291, 48 1 Elementary column matrix, 227 row matrix, 227 Elementary symmetric polynomials, 484 fundamental theorem of, 485 Elkies, N. J., 2 Elliott, P. D. T. A, 408 Elliptic curve, 261 method of factoring (ECM), 28 1, 295 modulo p, 283 Elliptic integral, 294 Ellison, W. J., 323 Empty set, 472 Equivalence relation, 128, 158 Equivalent forms, 157 matrices, 229 Eratosthenes, sieve of, 30, 408 ErdOs, P., 45, 406 Estimates of arithmetic functions, 389 Euclid, 4, 25, 45, 46 Euclidean algorithm, 11, 44 Euler, L., 3, 47, 130, 176, 177, 292 Euler's conjecture on nth powers, 2 constant, 392 criterion, 101 cp-function, 50, 69 generalization of Fermat's theorem, 51 partition formulae, 456, 459 product formula, 381 Evans, R. J., 21 1 Factorials, the factoring of, 182 Factorization, canonical, 21 methods compared, 295 not unique, 22 of polynomials, 41 1 in quadratic fields, 430 unique, 23 using elliptic curves, 281 Faltings, G., 296 Faltings' theorem, 289 Farey sequence, 297 of order n, 300 Fermat, P., 47, 54, 176, 178, 293, 322 Fermat numbers, 33 Fermat's last theorem, 1, 237, 29 1 \"little\" theorem, 51 Ferrers graphs, 448 Fibonacci numbers, 199 Field, 124 Fine, N. J., 64 Finite continued fractions, 327 Finite group, 117 Finitely generated group, 277 Flex, 254 Form, 150 binary, 150 definite, 151 indefinite, 151 linear, 8 of the, 18 primitive, 163 quadratic, 150 reduced, 159 semidefinite, 151 ternary quadratic, 240 zero of, 240 Formal power series, 452 Fouvry, E., 292 Fractional part of a number, 75, 134, 180 Franklin, F., 47 1 Frey, G., 293 Fulton, W., 294, 500 Functions, 6, 50, 188, 193,446 Fundamental discriminant, 163 Fundamental theorem: of algebra, 423, 483 of arithmetic, 17, 20 of symmetric polynomials, 485 Gauss, C. F., 46, 47, 128, 177, 179, 323, 500 Gaussian integers, 427 Gaussian reciprocity law, 137 Gauss's lemmas, 133, 177, 413 General linear group, 177 Index Index Generating function, 455 Generator of a group, 122 Genus: of a curve, 288 of a form, 178 Geometry of numbers, 312 Germain, S., 292 Girard, A, 54 Global solution, 226, 235 Goldbach conjecture, 2 Goldfeld, D., 178, 445 Graph of a partition, 448 Greatest common divisor, 7, II Greatest integer function, 6, 134, 180 Grosswald, E., 323, 500 Group, 11 6 abelian, 117 additive, 11 8 commutative, 11 7 cyclic, 122 finite, 117 generator of, 122 isomorphic, 11 8 modular, 157 multiplicative, 121 of points on a curve, 264, 269, 270 order of, 117 order of an element, 122 Gruber, P. M., 322, 501 Gupta, H., 130 Guy, R K., l29 Hadamard, J., 45, 360, 406 Hagis, P., 177 Halasz, G., 407 Halberstam, H., 48 1, 501 Hammer, J., 322 Hardy, G. H., 130, 387,407, 501 Hardy-Littlewood method, 323 Harris, D., 296 Hasse, H., 296 Hasse-Minkowski principle, 290 Heath-Brown, D. R, 292, 407 Hensel's lemma, 87 Hermite, C., 333 Hermite interpolation formula, 128 Herstein, I. N., 47 1, 501 Hilbert, D., 296, 323 Holzer, L., 293 Homogeneous polynomial, 150 Homogeneous space, 269 Horner's method, 76 Hua, L. K., 290, 408, 50 1 Hurwitz, A, 296, 342 Hurwitz theorem, 304, 342 HusemOller, D., 294, 501 Identical congruence, 62 Identity element, 116 Identity matrix, 173 Improper representation, 152 Inclusion-exclusion principle, 209 Inconsistent congruences, 65 Induction, 3 Infinite descent, method of, 29 1 Inflection point, 254 Integer, 1 algebraic, 415 canonical factoring of, 21 Gaussian, 427 parity of, 17, 232 powerful, 219 rational, 416 sequences of, 472 square-free, 25, 390, 408, 473 sum of squares of reciprocals, 490 Integer part, 6, 134, 180 Integral domain, 127 Intersection multiplicity, 252 Intersection of sets, 41, 472 Invariant factors, 229 Inverse element, 116 Inversion formula, 194 Ireland, K., 445, 50 1 Irrationality of n, 309 Irrational number, 1, 307 Irreducible curve, 259 Irreducible polynomial, 258, 412 Isomorphic, 11 8, 287, 42 1 Iwaniec, H., 407 Jacobi, C. G. J., 177, 322 Jacobi's partition formula, 463 Jacobi symbol, 142 Jacobsthal, E., 178 Johnson, R W., 108 Jones, B. W., 179, 501 Khinchin, A Y., 359, 501 Knopp, M. I., 47 1 Knuth, D. E., 129, 50 1 Koblitz, N., 294, 50 1 Kochen, S., 29 1 525 Kolmogorov's axioms for probability, 407 Kronecker's theorem, 322 Kronecker symbol, 177 Kubilius, J., 407 Kueh, K.-L., 322 Kuipers, L., 50 1 Kummer, E. E., 177 Kummer's approach to xP +I' = zP, 292 Lagrange, J. L., 2, 4, 130, 177, 322 four squares theorem, 317 interpolation formula, 128 Lambert, J. H., 130 Lame, G., 205 Landau, E., 408, 50 1 Lander, J. L., 2 Lattice point, 155, 314 Least common multiple, 16 Lebesgue, V. A, 29 1 Legendre, A M., 130, 176, 177, 292, 293, 323 Legendre symbol, 132, 178 Lehmer, D. H., 129, 130, 179, 292, 501 Lehmer, E., 292 Lekkerkerker, C. G., 322, 501 Lenstra, A K., 130 Lenstra, H. W. Jr., 129, 130, 295, 501 LeVeque, W. J., 129, 130, 178, 408, 50 1 Levinson, N., 45 Lewis, D. J., 290 Lifting solutions, 88 Linear combination, 7 Linear congruence, 62 Linear Diophantine equations, 213 Linear form, 8 Linear groups, 177 Linear recurrences of order two, 197 of order k, 493 Linear transformation, 156 Liouville's lambda function, 192 Littlewood, J. E., 387 Local solutions, 226, 235 Lucas, E., 64 Lucas functions, 20 1 numbers, 199 probable prime, 203 pseudoprime, 203 Lutz, E., 294 Lutz-Nagell theorem, 277 Mac Lane, S., 3 Maier, A E., 322 Mann, H. 8., 48 1 Mathematical induction, 3 Matrices, equivalent, 229 Matrix, unimodular, 227 Mazur's theorem, 278, 294 Mersenne prime, 33 Mertens, F., 406 Meyer, A, 290 Minkowski, H., 322 convex body theorem, 313, 315 Mobius function 11(n ), 193 MObius inversion formula, 194 Modular function, 177 Modular group, 157 Modulus, 48 Monic polynomial, 410 Montgomery, P. L., 295 Morain, F., 130 Mordell, L. J., 293, 50 1 conjecture, 289 theorem on elliptic curves, 277 Mozzochi, C. J., 407 Multinomial theorem, 183 Multiple, 4 Multiplicative function, 189 Multiplicative group modulo m, 121 Multiplicity of a point, 253 Nagell, T., 294, 501 Natural density, 473 of square-free integers, 390, 408 Natural number, 1 Nearest integer, 180 Newman, M., 290, 502 Newton, 1., 293 Newton-Girard identities, 499 Niederreiter, H., 501 Niven, 1., 108, 322, 47 1 , 502 Nonresidue, quadratic, 131 Non-singular curve, 253 Non-singular root, 87 Norm of a quadratic number, 22, 427 Number, algebraic, 414 composite, 20 conjugate algebraic, 423 Fermat, 33 Fibonacci, 199 irrational, 1 Lucas, 199 Index natural, 1 norm of, 22, 427 pentagonal, 19 perfect, 192 powerful, 219 prime, 20 rational, 1 square, 25, 232 square-free, 25 transcendental, 415, 418 triangular, 19 Number theoretic functions, 188 Numerical functions, 188 Ogg, A, 294 Old pseudoprime, 82 O'Meara, 0. T., 179, 290, 502 Order of a group, 11 7 of an elei;,..;nt, 122 of an element (mod m ), 97 of magnitude of a function, 365 Ore, O., 502 Parity, 17, 232 Parkin, T., 2 Partial quotients, 326 Partition, 446 conjugate, 448 graph of, 448 parts of, 446 self-conjugate, 45 1 Partition function, 446 bounds on, 462 congruence property, 470 Euler's identities, 456, 459 generating function, 455 Jacobi's formula, 463 restricted, 446 Pascal's triangle, 40 Pell's equation, 351 Pentagonal numbers, 19 Perfect number, 1 92 Perfect square, 25, 232 Periodic continued fraction, 344 Pigeonhole principle, 207 Poincare, H., 293, 296 Points A, 8, AB on an elliptic curve, 26 1 , 264 Points at infinity, 259 Pollard, H., 445, 502 Pollard, J. M., 81 , 294 Pollard p -1 method, 83, 281 Pollard rho method, 81 P6lya, G., 46, 502 Polynomials, 410 absolutely irreducible, 259 approximating, 128 congruences. 420 degree of, 41 0 discriminant, 484 factoring of, 41 1 g.c.d. of, 412 integer-valued, 38 irreducible, 412 monic, 41 0 primitive, 413 symmetric, 484 Pomerance, C., 129, 295, 502 Positive definite forms, 170 Positive divisors of n, 188 Powell, 8., 108 Powerful integer, 219 Power residue, 100 Prime number theorem, 28, 45, 360, 366 Prime power moduli, 86 Primes, 20 527 in an arithmetic progression, 31, 45, 108, 401 associated functions, 361 divergence of sum of reciprocals, 26 gaps in the sequence, 26, 372 infinitely many, 25, 34, 46 Mersenne, 33 order of magnitude, 374 in quadratic fields, 429 related sums, 369 theory of, 360 Primitive form, 163 polynomial, 413 Pythagorean triangles, 233 root, 99, 102 roots of unity, 197 solution, 23 1 Probabilistic number theory, 408 Probable prime, 77 Projective plane, 259 Proper divisor, 4 Proper representation, 152 Pseudoprime, 59, 77 Public-key cryptography, 84 Pythagorean triples, 23 1, 409, 438 528 Quadratic field, 425 units in, 428 primes in, 429 Quadratic forms, 150 Quadratic irrational number, 345, 350 Quadratic nonresidue, 131 Quadratic reciprocity law, 132, 145 Quadratic residue, 131 Quadratic sieve, 129, 295 Rademacher. H., 502 Ramanujan. S., 407, 47 1 Rank of a group, 277 Rational number, 1 Rational points on curves, 249 Reciprocals of squares, sum of, 490 Reciprocity law. 137, 1 45 Recreational mathematics, 3 Recurrence relation of order two, 197 of order k. 493 Recursion, 39 Reduced forms. 159 Reduced residue system, 50 Reflexive property. 128 Reichardt, H., 290 Reid, M .• 294, 502 Relatively prime integers, 9 Remarks on calculation, 6, 14, 44, 66, 74, 80, 100, 11 2, 168, 20 1, 214.281, 355, 358, 488 Representation by a form, 152. See also Diophantine equations Residue, 50 class, 50 quadratic, 131 RESSOL, 11 0, 112, 130 Ribenboim, P., 292, 324, 445, 502 Ribet, K., 293 Riemann, G. F. 8., 406 Riemann hypothesis, 406 Riemann zeta function, 374, 386, 490 Riesel, H., 129, 130, 502 Ring, 124 Rivest, R, 129 Robinson. A, 445, 502 Roots of unity, 197 Rosen, K. H., 129, 502 Rosen, M., 445, 501 Roth, K. F., 29 1, 48 1, 501 Rousseau, G., 323 Row matrix, 227 Row operations on equations, 221 RSA method. 129 Scherk, P., 481 Schnirelmann density, 476 Selberg, A, 45 Self-conjugate partition, 45 1 Semidefinite form, 151 Index Serre, J. P., 290, 323, 408, 502 Shafarevich, I. R., 130, 290, 293, 408, 500 Shamir, A, 1 29 Shanks, D., 81, 130, 338, 502 Siegel, C. L., 29 1, 294 Sieve of Eratosthenes, 30, 408 Silverman, J. H� 294, 502 Simple continued fraction, 327 Simple point on a curve, 253 Simultaneous linear equations. 219, 226 Singular point on a curve, 253 Singular root, 87 Skolem, T � 502 Sloane, N. J. A, 21 1, 502 Small, C., 323 Smith normal form, 229 Smooth curve, 253 Special linear group, 177 Square-free integers, 25, 390, 408, 473 Strong probable prime, 78 Strong pseudoprime test, 78 Subgroup, 126 Subtraction of sets, 34 Sum of divisors function, 188, 191 of five squares, 318 of four squares, 2. 31 7 of l /n2, 490 of positive divisors of n, 188 of sequences of integers, 477 of three squares, 170 of two squares, 55, 163 Symmetric polynomials, 484 Symmetric property, 128 Symmetric set in R\". 313 Systems of linear equations, 219, 226 SzegO, G., 502 Tanner, J., 46, 292 te Riele, H. J. J., 129 Terjanian, G., 29 1 Ternary quadratic form, 240 Thue, A, 29 1 Tijdeman, R., 129, 130, 289, 295, 501 Tonelli, A, 130 Index Torsion group, 277 Totally multiplicative function, 189 Totient function, 50 Transcendental number, 41 5, 41 8 Transitive property, 120, 128 Transpose of a matrix, 229 Trap door function, 129 Triangular numbers, 19 Triple point, 253 Turan, P., 407 Twin primes, 29 Union of sets, 41, 472 Unique factorization, 21, 23 example of failure, 22 in quadratic fields, 430 of polynomials, 412 Units in algebraic number fields, 425 in quadratic fields, 428 Vandiver, H. S., 292 van Leeuwen, J., 130 Vaughan, R. C., 324 Vinogradov, I. M., 323, 387 Vinogradov's hypothesis, 147 von Mangoldt function, 361 Wagon, S., 333 Wagstaff, S., 292 Walker, R. J., 294, 502 Waring's problem, 323 Warning, E., 293 Waterhouse, W. C., 177 Weierstrass M-test, 379 normal form, 273 P -function, 294 Wei!, A, 149, 293, 296, 502 Weil-Taniyama conjecture, 293 Williams, H. C., 130, 294 Wilson's theorem, 3, 53 Word length, 75 Wostenholme's congruence, 96 Wright, E. M., 130, 501 Wylie, S., 130 Zeta function, 374, 490 estimates of, 386 529","libVersion":"0.3.1","langs":""}
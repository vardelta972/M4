{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Kimball Martin/NT 2 (To the skies)/Notes (Individual sections)/chap4.pdf","text":"4.1 Reduction theory Let Q(x, y)= ax2 + bxy + cy2 be a binary quadratic form (a, b, c ∈ Z). The discriminant of Q is ∆ = ∆Q = b2 − 4ac. This is a fundamental invariant of the form Q. Exercise 4.1. Show there is a binary quadratic form of discriminant ∆ ∈ Z if and only if ∆ ≡ 0, 1 mod 4.Consequently, any integer ≡ 0, 1 mod 4 is called a discriminant. We say two forms ax2 + bxy + cy2 and Ax2 + Bxy + Cy2 are equivalent if there is an invertible change of variables x ￿ = rx + sy, y￿ = tx + uy, r, s, t, u ∈ Z such that a(x ￿) 2 + bx ￿y￿ + c(y￿) 2 = Ax 2 + Bxy + Cy2. Note that the change of variables being invertible means the matrix ￿rs tu ￿ ∈ GL2(Z). In fact, in terms of matrices, we can write the above change of variables as ￿x￿ y￿ ￿ = ￿rs tu ￿￿ x y ￿ . Going further, observe that ￿xy￿ ￿ ab/2 b/2 c ￿￿ x y ￿ = ax 2 + bxy + cy2, so we can think of the quadratic form ax2 + bxy + cy2 as being the symmetric matrix ￿ ab/2 b/2 c ￿. It is easy to see that two quadratic forms ax2 + bxy + cy2 and Ax2 + Bxy + Cy2 are equivalent if and only if ￿ AB/2 B/2 C ￿ = τ T ￿ ab/2 b/2 c ￿ τ (4.1) for some τ ∈ GL2(Z). Note that the discriminant of ax2 + bxy + cy2 is −4disc ￿ ab/2 b/2 c ￿. Lemma 4.1.1. Two equivalent forms have the same discriminant. Proof. Just take the matrix discriminant of Equation (4.1) and use the fact that any element of GL2(Z) has discriminant ±1. What this means then is that GL2(Z) acts on the space F∆ of binary quadratic forms of dis- criminant ∆ for any ∆. The importance of equivalent forms is in the following. We say Q(x, y) ∈ F∆ represents an integer n if Q(x, y)= n for some x, y ∈ Z. Lemma 4.1.2. Two equivalent forms represent the same integers. 64 Proof. This is obvious from the deﬁnition of equivalence—just make the change of variables! To prove some basic results, it will be helpful to have more reﬁned notions of equivalence and representations of integers. Deﬁnition 4.1.3. We say two forms ax2+bxy+cy2 and Ax2+Bxy+Cy2 are properly equivalent if they satisfy Equation (4.1) for some τ ∈ SL2(Z).In this case we will write ax2 + bxy + cy2 ∼ Ax2 + Bxy + Cy2. Recall SL2(Z) means 2×2 integer matrices of determinant 1,so GL2(Z)=SL2(Z)∪ ￿01 10 ￿ SL2(Z) since GL2(Z) consists of matrices of determinant ±1 In other words the quotient GL2(Z)/SL2(Z) consists of two cosets. We can take ￿10 01 ￿ and ￿01 10 ￿ as a set of representatives for these cosets. Clearly proper equivalence implies equivalence but the converse is not true. In fact, the notion of proper equivalence turns out to give a nicer theory as we will see below.∗ Example 4.1.4. Using the matrix ￿10 0 −1 ￿ we see ax2 + bxy + cy2 is always equivalent to ax2 − bxy + cy2.Sometimes they are properly equivalent (e.g., 2x2 ± 2xy +3y2—see exercise below) and sometimes they are not (e.g., 3x2 ± 2xy +5y2—see exercise below). Exercise 4.2. Determine the discriminants of Q1(x, y)= 2x2 +2xy +3y2, Q2(x, y)=2x2 − 2xy + 3y2, Q3(x, y)= 3x2 +2xy +5y2 and Q4(x, y)= 3x2 − 2xy +5y2.Show Q1 and Q2 are properly equivalent but Q3 and Q4 are not. (If you have trouble, see the theorem below.) Exercise 4.3. Fix a, b, c ∈ Z and let Q1(x, y)= ax2 + bxy + cy2 and Q2(x, y)= cx2 + bxy + ay2. (i) Show Q1 and Q2 are equivalent. (ii) If b =0 show Q1 and Q2 are properly equivalent. (iii) Can you ﬁnd a, b, c so that Q1 and Q2 are equivalent by not properly equivalent? (One often calls this improper equivalence.) There are three types of binary quadratic forms Q(x, y)= ax2 + bxy + cy2 based on the sign of the discriminant ∆ = b2 − 4ac: 1) If ∆ = 0, then Q factors into two linear forms and we say Q is degenerate. Otherwise Q is nondegenerate.If ∆ = b2 − 4ac =0, then Q(x, y)=( √ax + √cy)2 and it is easy to see what numbers Q represents. Hence, one may just consider nondegenerate forms. 2) If ∆ < 0, then Q(x, y) has no real roots. In other words, considering x, y real, the graph of z = Q(x, y) in R3 never crosses the z =0 plane. Hence Q(x, y) takes on either only positive values or negative values (and zero if x = y =0). Accordingly we say, Q is either a positive deﬁnite form (e.g., x2 + y2)or a negative deﬁnite form (e.g., −x2 − y2). Note positive deﬁnite implies a, c > 0 and negative deﬁnite implies a, c < 0. (This is not if and only if: x2 − 100000xy + y2 is not positive deﬁnite.) Since −Q will be positive deﬁnite whenever Q is negative deﬁnite, it suﬃces to study the positive deﬁnite case. ∗For this reason, many authors use the term “equivalence of forms” to mean proper equivalence. If you consult other references, take note of this. 65 3) If ∆ > 0, then Q(x, y) has a real root and Q(x, y) takes on positive and negative values for x, y ∈ Z. In this case, we say Q is an indeﬁnite form. Note whenever a and c have diﬀerent sign (or one is 0), Q must be indeﬁnite. The theory of indeﬁnite forms is similar to the theory of (positive) deﬁnite forms, but there are some technical diﬀerences which make it more complicated. For simplicity, as well as the fact that positive deﬁnite forms tend to be of more interest, we will restrict our study to positive deﬁnite forms, though we will make some comments about what happens for indeﬁnite forms along the way. Hence, from now on, we assume all our forms are positive deﬁnite (in particular have discriminant ∆ < 0) unless otherwise stated. Deﬁnition 4.1.5. Let Q(x, y)= ax2 +bxy +cy2 be a (positive deﬁnite) form. We say Q is reduced if |b| ≤ a ≤ c and b ≥ 0 if a = c or a = |b|. Lagrange introduced the notion of reduced forms, and the point is the following. Theorem 4.1.6. Any (positive deﬁnite) form Q is properly equivalent to a unique reduced form. Proof. First we will show Q is properly equivalent to a reduced form ax2 + bxy + cy2.Suppose |b| is minimal such that there is a form R(x, y)= ax2 + bxy + cy2 with Q ∼ R.If |b| >a, then there exists m ∈ Z such that |2am + b| < |b|. But this implies R￿(x, y)= R(x + my, y)= ax 2 +(2am + b)xy +(am 2 + bm + c)y2 ∼ R(x, y)= ax 2 + bxy + cy2, so R￿ ∼ Q has smaller xy coeﬃcient than ax2 + bxy + cy2, contradicting the choice of R. Hence |b| ≤ a and similarly |b| ≤ c. If necessary, we may replace R(x, y) with R(y, −x)= cx2 − bxy + ay2 to assume |b| ≤ a ≤ c. We also need to show we can take b ≥ 0 if a = c or a = |b|.If a = c, then the xy-coeﬃcient of either R(x, y) or R(y, −x) is nonnegative, so we may assume b ≥ 0.Similarly if b = −a, then R(x + y, y)= ax2 + ax + cy2,so again we may assume b ≥ 0 (in fact b> 0 since a> 0). This shows Q is properly equivalent to some reduced form R(x, y)= ax2 + bxy + cy2. Now we show that this R is unique. Suppose not, so Q ∼ S where S = dx2 + exy + fy2 is also reduced. Interchanging R and S if necessary, we may assume a ≥ d. Recall R ∼ S means we can write S(x, y)= R(rx + sy, tx + uy)= a(rx + sy) 2 + b(rx + sy)(tx + uy)+ c(tx + uy) 2 with r, s, t, u ∈ Z such that ru − st =1. Since S clearly represents d and, we know R ∼ S,weknow R represents d. Thus d = ax 2 0 + bx0y0 + cy2 0 ≥ a(x 2 0 + y2 0)+ bx0y0 ≥ a(x 2 0 + y2 0) − a|x0y0| ≥ a|x0y0| for some x0,y0 ∈ Z. Since d ≤ a we must either have x0y0 =0 or |x0y0| =1. We will ﬁnish the proof in three cases. First suppose y0 =0. Then d = ax2 0 together with d ≤ a means x2 0 =1 and d = a. Then the x2-coeﬃcient of S(x, y) is ar2 + brt + ct2 = R(r, t)= d = a. 66 Observe the minimum nonzero value of a reduced form R(x, y) is obtained precisely when (x, y)= (±1, 0),so we must have r = ±1,t =0.† (Hence the minimum positive value of a reduced form is the x2-coeﬃcient, in this case a.) Further ru − st = ru =1 implies u = r−1. Then the xy-coeﬃcient of S(x, y) is 2ars + bru =2ars + b = b ± 2as = e. Since S is reduced, we have |e| ≤ d = a, but the only was this can happen is if s =0 (which means R = S)or if b = a and s = ±1, which means e = −d, which we have excluded from our deﬁnition of reduced. This shows uniqueness when y0 =0. Next suppose x0 =0. Similar to the above, we see d = c and looking at the x2-coeﬃcient of S(x, y) one can conclude r =0,s = t = ±1 as the second smallest minimum nonzero value of a reduced form R(x, y) is c and is obtained precisely when (x, y)=(0, ±1)‡—see Remark below. This means the xy-coeﬃcient of S(x, y) must be b +2cu. Then |e| = |b +2cu| ≤ a ≤ c means either u =0 (so R = S)or b = a = c and u = −1 in which case S(x, y)= ax2 − axy + ay2, which is not reduced. Finally suppose |x0y0| =1. The above inequalities for d say a ≥ d ≥ a|x0y0| so a = d. The rest follows like the y0 =0 case. Remark. It should be fairly obvious that for a reduced form R(x, y)= ax2 +bxy+cy2 the minimum nonzero value is obtained is a, which happen precisely when (x, y)=(±1, 0) (assuming a<c). It may be less clear that the second smallest nonzero value obtained is c, but both of these assertions follow from the simple exercise that R(x, y) ≥ (a − |b| + c)min(x2,y2). If you want, you can work this out on your own, but I’m not assigning it as homework. The above theorem tells us that if we want to study positive deﬁnite forms, it suﬃces to consider reduced forms. 4.2 The mass formula One of the most important early discoveries about quadratic forms is that they are better studied collectively than individually. Precisely, we make the following Deﬁnition 4.2.1. Let ∆ be a discriminant. The form class group Cl(∆) of discriminant ∆ is the set of proper equivalence classes of forms of discriminant ∆,i.e., Cl(∆) = F∆/ ∼. We will later see how to deﬁne a group structure on this, justifying the name. From the last section, we know we can take a set of representatives for Cl(∆) to be the set of reduced forms of discriminant ∆. Proposition 4.2.2. For any discriminant ∆,thenumber h(∆) := |Cl(∆)| < ∞. Proof. Note h(∆) is the number of reduced forms of discriminant ∆.If ax2 + bxy + cy2 is reduced of discriminant ∆, then |b| ≤ a ≤ c so 4b2 ≤ 4ac = b2 + ∆, i.e., 3b2 ≤ |∆|. In other words, there are only ﬁnitely many choices for b. Each choice for b determines ac, and the product ac determines a ﬁnite number of choices for a and c. †If a = c, the minimum nonzero value of the form is also obtained at (0, ±1),which corresponds to r =0,t = ±1. Though we technically omit this case here, we can actually absorb this situation into our argument for the subsequent x0 =0 case. ‡Again, technically if a = c, this actually gives the minimum nonzero value of the form, but this does not aﬀect our argument. 67 Using the notion of the class group, we can get a formula for the number of representations of n by a quadratic form of discriminant ∆. It will be convenient to consider proper representations. Deﬁnition 4.2.3. We say Q(x, y) ∈ F∆ properly represents n if n = Q(x, y) for some x, y ∈ Z with gcd(x, y)= 1.In this case, the solution (x, y) is called a proper representation of n by Q. Example 4.2.4. Let Q(x, y)= x2 + y2.Then Q represents 4= 22 +02 = Q(2, 0),but it does not properly represent 4 since gcd(2, 0) = 2 and (±2, 0) and (0, ±2) are the only solutions to Q(x, y)= 4. On the other hand even though 25 has an improper representation by Q,namely 25 = 52 +02 = Q(5, 0) and gcd(5, 0) = 5, 25 also has a proper representation by Q: 25 = 32 +42 = Q(3, 4) and gcd(3, 4) = 1.Hence we say Q(x, y) properly represents 25. Lemma 4.2.5. Q(x, y) represents n if and only if Q(x, y) properly represents m for some m|n such that n m is a square. Proof. (⇒) Suppose Q(x, y) represents n.If Q properly represents n, we can just take m = n and we are done. If not, then Q(x, y)= n for some x, y with gcd(x, y)= d> 1. Then Q(x/d, y/d)= Q(x, y)/d2 is a proper representation of m = n/d2. (⇐).Suppose Q(x, y) properly represents m where n = d2m. Then Q(dx, dy)= d2Q(x, y)= d2m = n. In other words, understanding what numbers are properly represented by Q tells us which num- bers are represented by Q, since the latter numbers are just squares times the former numbers. Let rQ(n) (resp. RQ(n)) denote the number of proper representations (resp. number of representations) of Q by n. Theorem 4.2.6. (Dirichlet’s mass formula, ﬁrst version) Let d> 1 be squarefree and set ∆ = −4d.Let Q1,Q2,. .., Qh be a set of representatives for the form class group Cl(∆).Then rQ1(n)+ rQ2(n)+ ·· · + rQh(n)=2 ￿ p|n ￿1+ ￿∆ p ￿￿ where p runs over prime divisors of n> 0 and gcd(n, ∆) = 1. There are many diﬀerent versions of the statement of this result, but the above one is the most applicable to the forms x2 + dy2 (with d squarefree). The proof of the mass formula is quite elementary, and we will omit it now, but John Paul will present a proof of the following version later this semester. Theorem 4.2.7. (Dirichlet’s mass formula, second version) Let ∆ be the discriminant of an imaginary quadratic ﬁeld, Q1,Q2,. .., Qh aset ofrepresentativesfor Cl(∆) and n> 0 such that gcd(n, ∆) = 1.Then RQ1(n)+ RQ2(n)+ ·· · + RQh(n)= w ￿ k|n ￿∆ k ￿, where w is the number of units in the ring of integers of Q( √∆). (Recall ￿∆ 1 ￿ =1 for any ∆.) The ﬁrst version of the mass formula immediately gives 68 Corollary 4.2.8. Suppose ∆ = −4d with d> 1 squarefree. Then n> 0 relatively prime to ∆ is properly represented by some form of discriminant ∆ if and only if ￿∆ p ￿ =1 for all primes p|n. The point is that while it is diﬃcult to study the numbers represented by an individual quadratic form in general, it is relatively easy to understand which numbers are represented by some quadratic form of discriminant ∆, for ﬁxed ∆. However, if the class number h(∆) = 1, then the above formulas are in fact formulas for a speciﬁc rQ(n) (resp. RQ(n)). Example 4.2.9. Consider Q(x, y)= x2 +y2.This has discriminant ∆ = −4,which is the discrimi- nant of the quadratic ﬁeld Q(i).If ax2 +bxy+cy2 is a reduced form of discriminant −4,then 3b2 ≤ 4 (see proof of Proposition 4.2.2), so b =0 or b = ±1.Clearly b = ±1 makes b2 − 4ac =1 − 4ac = −4 unsolvable, so b =0.Then we must have ac =1 so a = c =1 (since we are just working with posi- tive deﬁnite forms). In particular the class number h(−4) = 1,and {Q} is a set of representatives for Cl(∆). Then the second version of Dirichlet’s mass formula reads RQ(n)=4 ￿ k|n ￿∆ k ￿, for n odd. If n = p is prime, then for p ≡ 1 mod 4 we have RQ(p)= 4 ￿￿∆ 1 ￿ + ￿∆ p ￿￿ = 4(1 + 1) = 8 and if p ≡ 3 mod 4 we have RQ(p)= 4 ￿￿∆ 1 ￿ + ￿∆ p ￿￿ = 4(1 − 1) = 0. In other words, x2 + y2 represents an odd prime p if and only if p ≡ 1 mod 4.So Dirichlet’s mass formula gives Fermat’s two square theorem as a special case. Moreover, it tells us two more things about x2 + y2.If p = x2 0 + y2 0 is odd, then x0 ￿= y0 so (±x0, ±y0) and (±y0, ±x0) are also solutions to Q(x, y)= p.This accounts for 8 solutions. Since RQ(p)=8,this means up to sign and interchanging x and y, p = x2 0 + y2 0 is the only way to write p as a sum of 2 squares. Recall Brahmagupta’s composition tells us the product of two numbers of the form x2 + y2 is again of the form x2 + y2.Since 2= 12 +12 and p2 = p2 +02 for any p,we know that n is of the form x2 + y2 if any p|n with p ≡ 3 mod 4 occurs to an even power in the prime factorization of n. In fact, these are the only n represented by x2 + y2,and we can actually prove this for n odd using the mass formula. Indeed, suppose n is odd and not of the above form, i.e., there is a prime p ≡ 3 mod 4 dividing n which occurs to an odd power in the prime factorization of n.Let D1 be the set of divisors k of n such that p occurs to an even power in the prime factorization of k,and let D2 = {pk : k ∈ D1}.Then D1 ∪ D2 are the divisors of n and D1 and D2 are disjoint. So RQ(n)= 4    ￿ k∈D1 ￿∆ k ￿ + ￿ pk∈D2 ￿ ∆ pk ￿   =4 ￿ k∈D1 ￿￿∆ k ￿ + ￿∆ p ￿￿∆ k ￿￿ =0 since ￿∆ p ￿ = −1. 69 Exercise 4.4. Determine the reduced forms of discriminant ∆ for ∆ = −3, −8, −12, −20, −24.In particular, determine h(∆) for these ∆. Exercise 4.5. Use Dirichlet’s mass formula and Brahmagupta’s composition law to determine to which odd numbers are of the form x2 +2y2. Exercise 4.6. Use Dirichlet’s mass formula, Brahmagupta’s composition law and (i) to determine to which numbers prime to 6 are of the form x2 +3y2. 4.3 The form class group The idea behind Gauss’s composition of binary quadratic forms comes from Brahmagupta compo- sition, which says the product of two numbers of the form x2 + dy2 is again of the form x2 + dy2. Precisely, Brahmagupta’s composition law is (x 2 1 + dy2 1)(x 2 2 + dy2 2)=(x1x2 − dy1y2) 2 + d(x1y2 + x2y1) 2 = X 2 + dY 2 where X = x1x2 −dy1y2, Y = x1y2 +x2y1. Gauss’s composition says that if Q1 and Q2 are quadratic forms of discriminant ∆, then there is a form Q3 of the same discriminant such that Q1(x1,y1)Q2(x2,y2)= Q3(X, Y ) where X, Y are some (homogeneous) quadratic expressions in x1,y1,x2 and y2. In other words, the product of a number of represented by Q1 with a number represented by Q2 is represented by Q3. We will write this composition as Q1 ◦ Q2 = Q3 and this will make Cl(∆) into a ﬁnite abelian group. However, the explicit determination of X, Y and the coeﬃcients of Q3 in Gauss’s composition is rather complicated and we will not describe it explicitly. Instead, we will approach Gauss com- position via ideals. But to get a feeling of how this composition can be done without ideal, we will brieﬂy explain Dirichlet’s approach to Gauss composition. Two forms Q1(x, y)= a1x2 + b1xy + c2y2 and Q2(x, y)= a2x2 + b2xy + c2y2 of discriminant ∆ are called united if gcd(a1,a2, b1+b2 2 )=1. If they are united, there exist B, C ∈ Z such that a1x2 + b1xy + c2y2 ∼ a1x2 + Bxy + a2Cy2 and a2x2 + b2xy + c2y2 ∼ a2x2 + Bxy + a1Cy2. Then the Dirichlet composition is deﬁned to be Q1 ◦ Q2 = a1a2x 2 + Bxy + Cy2. To see that this follows our notion of what composition should be, observe (a1x 2 + Bxy + a2Cy2)(a2x 2 + Bxy + a1Cy2)= a1a2X 2 + BXY + CY 2 where X = x1x2 − Cy1y2 and Y = a1x1y2 + a2x2y1 + By1y2. One can check that the latter form has discriminant ∆. Note that Dirichlet composition does not deﬁne composition of any two forms of discriminant ∆ (only united forms), but it is enough to deﬁne a composition (or multiplication) law on the proper equivalences classes Cl(∆). Now we will present the approach to Gauss’s composition via ideals. For simplicity we will work with forms whose discriminant ∆ is the discriminant of a quadratic ﬁeld. We say ∆ is a fundamental discriminant if ∆ = ∆K for some quadratic ﬁeld K. 70 Exercise 4.7. Let ∆ be the discriminant of Q(x, y)= ax2 + bxy + cy2.Show if ∆ is a fundamental discriminant, then Q is primitive,i.e., gcd(a, b, c)= 1. We remark that in working with quadratic forms, one often restricts to primitive forms, since any form is just a multiple of a primitive form. From now on, for the rest of this section we assume ∆ < 0 is a fundamental discriminant. Let K = Q( √∆) be the imaginary quadratic ﬁeld of discriminant ∆. Deﬁnition 4.3.1. Let I be an ideal of OK with ordered Z-basis {α, β}.Then the quadratic form associated to I is QI(x, y)= N (αx + βy)/N (I)= ax 2 + bxy + cy2. Here the ﬁrst norm is the norm of the element αx + βy ∈ OK, and the second is of course the ideal norm. Explicitly we have N (αx + βy)= N (α)x 2 + Tr(αβ)xy + N (β)y2 so a = N (α)/N (I), b = Tr(αβ)/N (I) and c = N (β)/N (I) in the deﬁnition above. Technically, the form QI depends upon the choice of an ordered Z-basis for I, but it is not too diﬃcult to see that a diﬀerent basis will lead to a properly equivalent form. Further QI has discriminant ∆. Example 4.3.2. Let ∆ = −4 so K = Q(i).Consider the ideals I = ￿1,i￿ = Z[i] and J = ￿1+ i, 1 − i￿ =(1 + i) of OK.Then QI(x, y)= N (x + iy)/N (I)= N (x + iy)= x 2 + y2 and QJ (x, y)= N ((1 + i)x +(1 − i)y)/N (J )=(2x 2 + Tr(2i)+2y2)/2= x 2 + y2. So we see diﬀerent (but equivalent) ideals may lead to the same form. Exercise 4.8. Let ∆ = −20 so K = Q( √−5) and consider the ideals I = ￿2, 1+ √−5￿ and J = ￿3, 1+ √−5￿.Compute QI and QJ .Check they have discriminant ∆.Are they properly equivalent? Deﬁnition 4.3.3. Let Q(x, y)= ax2 + bxy + cy2 be a form of discriminant ∆.The ideal of OK associated to Q is IQ =(a, b − √∆ 2 ). Lemma 4.3.4. For any form Q, QIQ = Q.In other words, if we take the ideal IQ =(a, b−√∆ 2 ) associated to Q(x, y)= ax2 + bxy + cy2,then the form N (ax + b−√∆ 2 y)/N (IQ) associated to IQ equals Q. This lemma says the association I ￿→ QI is a right inverse to Q ￿→ IQ. The proof is elementary. However the converse is not true in general. What we can say is the following Lemma 4.3.5. Let I be an ideal of OK and let QI be the associated form. If J = IQI is the ideal associated to QI,then J ∼ I. 71 Then we can deﬁne multiplication of forms QI and QJ associated to ideals by QI ◦ QJ = QIJ . Upon showing the map ClK → Cl(∆) induced by I ￿→ QI is surjective, this deﬁnes a multiplication on the form class group Cl(∆). Precisely, one gets Theorem 4.3.6. We have an isomorphism ClK ￿ Cl(∆) I ￿ QI IQ ￿ Q. Proofs may be found in [Cohn]. The proof are not diﬃcult, but we omit them in the interest of time. Exercise 4.9. Show x2 + −∆ 4 y2 is the identity of Cl(∆) if ∆ ≡ 0 mod 4 and x2 − xy + 1−∆ 4 y2 is the identity of Cl(∆) if ∆ ≡ 1 mod 4. Exercise 4.10. Show Q2(x, y)= ax2 − bxy + cy2 is the inverse of Q1(x, y)= ax2 + bxy + cy2.We know Q1 and Q2 are always equivalent by a transformation of determinant −1,namely (x, y) ￿→ (x, −y).Deduce that Q1 ∼ Q2 if and only if Q1 has order 2 in Cl(∆Q1). Exercise 4.11. We say Q(x, y)= ax2 + bxy + cy2 is ambiguous if a|b.Show if Q is ambiguous, then Q has order 1 or 2 in Cl(∆Q). In fact it can be shown that Q has order ≤ 2 in the form class group if and only if Q ∼ Q￿ for some ambiguous form Q￿. In this case, the reduced form in the proper equivalence class of Q is either ambiguous (so b = a or b =0) or of the form ax2 + bxy + ay2. Exercise 4.12. Determine all reduced forms of discriminant ∆ = −84.Use this to deduce Q( √−21) has class group isomorphic to V4 = C2 × C2. 4.4 Genus theory As in the previous section, let K be an imaginary quadratic ﬁeld of discriminant ∆. Dirichlet’s mass formula tells us which numbers are represented by some form in F∆, but it doesn’t tell us which numbers are represented by a speciﬁc form of discriminant ∆. The problem of distinguishing between forms (or rather equivalence classes of forms) of discriminant ∆ is not at all a simple problem in general, however there is a simple approach which gives a complete solution when the class group is isomorphic to Cr 2 . To motivate genus theory, let’s consider our favorite example. Example 4.4.1. Let ∆ = −20 so K = Q( √−5).The reduced forms of discriminant ∆ are Q1(x, y)= x2 +5y2 and Q2(x, y)= 2x2 +2xy +3y2.Hence ClK ￿ Cl(∆) has order 2,so must be isomorphic to C2.From the exercises in the previous section, Q1 is the identity and Q2 has order 2 in Cl(∆). First let us determine the primes represented by Q1 and Q2. By the mass formula (ﬁrst version) we know RQ1(p)+ RQ2(p)= rQ1(p)+ rQ2(p) = 2(1 + ￿∆ p ￿)= ￿ 4 p ≡ 1, 3, 7, 9 mod 20 0 p ≡ 11, 13, 17, 19 mod 20 72 for p ￿ ∆.(Note for p prime, RQ(p)= rQ(p) for any form Q.) Note that if RQ1(p) > 0 for p ￿ 20, then RQ1(p) ≥ 4 because if (x, y) is a solution to x2 +5y2 = p,then so are (±x, ±y),which gives 4 diﬀerent solutions as long as p ￿=5.In other words, any p ≡ 1, 3, 7, 9 mod 20 is represented either by Q1 or Q2,but not both. However, looking at what numbers relatively prime to 20 are of the form x2 +5y2 mod 20 we see 3 and 7 are not possible. Similarly, simple computations show that 1 and 9 are not of the form 2x2 +2xy +3y2 mod 20.(In fact, it suﬃces to observe x2 +5y2 does not represent 3 mod 4 and 2x2 +2xy +3y2 does not represent 1 mod 4.) Hence we have p is represented by ￿ Q1 ⇐⇒ p =5 or p ≡ 1, 9 mod 20 Q2 ⇐⇒ p =2 or p ≡ 3, 7 mod 20 Now we can ask what integers n> 0 are represented by Q1. By the mass formula (ﬁrst form), we know if Q1 represents n,then n cannot be divisible by any prime p such that ￿∆ p ￿ = −1,i.e., any p ≡ 11, 13, 17, 19 mod 20.Write n = ￿ pei i · ￿ qfj j where each pi is represented by Q1 and each qj is represented by Q2.Gauss’s composition says n is represented by ￿i Q ei 1 · ￿j Q fj 2 (where the multiplication here denotes Gauss composition). In other words, n is represented by Q1 if ￿ fj is even and n is represented by Q2 if ￿ fj is odd. We would like to say the above statement about which n’s are represented by Q1 and which are represented by Q2 is if and only if. Note that Q1 represents 0, 1, 2 mod 4 and 0, 1, 4 mod 5, where as Q2 represents 0, 2, 3 mod 4 and 0, 2, 3 mod 5.The only overlap here are the numbers ≡ 0, 2 mod 4 and ≡ 0 mod 5.Hence Q1 and Q2 cannot represent the same numbers, except possibly for numbers divisible by 10.The case where n is not prime to the discriminant is more subtle, and we will not prove this, but it turns out Q1 and Q2 never represent the same numbers, so the above characterization of numbers represented by Q1 (or Q2)isif andonlyif. Genus theory allow us to generalize the above example to separate (at least partially) represen- tations by diﬀerent forms of discriminant ∆. Deﬁnition 4.4.2. Let Q1,Q2 ∈ F∆.We say Q1 and Q2 are in the same genus if they represent the same values mod ∆.The principal genus is the genus containing the identity of the form class group. It is a theorem that Q1 and Q2 are in the same genus if and only if Q1 and Q2 represent the same values mod m for every m. What is more important for us however, is that forms in diﬀerent genera (the plural of genus) represent disjoint sets of numbers in (Z/∆Z)×. This is the content of the following proposition. Proposition 4.4.3. Regard χ∆ = ￿∆ · ￿ as a real character of (Z/∆Z)×.Let H =ker χ∆.Let Q0 (resp. Q)be in the prinicipalgenus(resp. anygenus)of F∆ and H0 (resp. HQ)denotethe setof values in (Z/∆Z)× represented by Q0 (resp Q). Then H0 is a subgroup of H and HQ is a coset of H0 in H. (Note that H being the kernel of a group homomorphism, is a subgroup of (Z/∆Z)×.) For instance, in the above example, with Q0 = x2 +5y2 and Q =2x2 +2xy +3y2,we have H = {1, 3, 7, 9} ⊆ (Z/20Z)×, H0 = {1, 9} and HQ = {3, 7} =3 {1, 9}. 73 Proof. Let n ∈ (Z/∆Z)×.If n is represented by a form of discriminant ∆,we have n ∈ H =ker χ∆ by Dirichlet’s mass formula. To see that H0 is a subgroup of H, observe it must be closed under multiplication by Gauss composition. To show it is closed under inversion, note by Exercise 4.9, we can assume Q0 = x2 − ∆ 4 y2 or x2 +xy + 1−∆ 4 y2. Using either Brahmagupta or Dirichlet composition, it is straightforward to explicitly check H0 is closed under inverses (and is nonempty—it contains 1). It follows from Gauss composition that HQ must be a translate of H0 in H. Since the cosets of H0 in H are disjoint, the integers n relatively prime to ∆ can only be represented by forms in a single genus of F∆. In particular, if we want to determine which numbers are of the form x2 + dy2 (say relatively prime to ∆ = −4d), we can at least say n are represented by some form in the principal genus. In particular, if, up to equivalence, x2 + dy2 is the only form in the principal genus, we can say exactly which primes are represented by x2 + dy2 by (i) the mass formula and (ii) considerations mod ∆. In this case, we say ∆ has one class per genus (see exercise below). Exercise 4.13. Let Q1,. .., Qh denote representatives for Cl(∆).Using Gauss composition, show the number of Qi in a given genus is the same for each genus. Exercise 4.14. Pick representatives Q1,Q2 for Cl(−24).Determine what values Q1 and Q2 rep- resent mod 24.Using this with Dirichlet’s mass formula, determine all primes represented by Q1 and all primes represented by Q2.In particular, you should get a determination of all primes of the form x2 +6y2. Now of course it’s natural to ask, for which discriminants ∆ do we have one class per genus? It’s clearly true if the class number h(∆) = 1. We know there are only 9 fundamental discriminants ∆ < 0 with class number 1 (Gauss’s class number problem), and this was easy to determine. Conversely, it is still an unsettled problem (also posed by Gauss) for which ∆ have one class per genus. It is conjectured that there are precisely 65 fundamental discriminants (and 101 arbitrary negative discriminants) ∆ < 0 with one class per genus. It is not too diﬃcult to show the following. Theorem 4.4.4. The principal genus of Cl(∆) consists of the subgroup of squares of Cl(∆). Corollary 4.4.5. ∆ has one class per genus if and only if Cl(∆) ￿ Cr 2 for some r ≥ 0. We remark that for a speciﬁc r, we can compute all imaginary quadratic ﬁelds with class group Cr 2 . There shouldn’t be any for large enough r, and this is the most diﬃcult part. In the case of one class per genus, one can always determine the primes of the form x2 + dy2 by simple congruence conditions. However, at least conjecturally, this only happens ﬁnitely many times (for negative ∆). In the rest of the cases, the determination of primes of the form x2 + dy2 is more complicated. Example 4.4.6. Consider Q0 = x2 + 14y2.This has discriminant ∆ = −56 and corresponds to the ﬁeld K = Q( √−14).There are 3 other reduced forms of discriminant −56,given by Q1 =2x2 +7y2, Q2 =3x2 +2xy +5y2 and Q3 =3x2 − 2xy +5y2.It is easy to check the (form) class group Cl(∆) ￿ C4 (see exercise below). One can show p = x2 + 14y2 if and only if (i) ￿−14 p ￿ =1,and (ii) (x2 + 1)2 ≡ 8 mod p has a solution. See [Cox]. We will discuss this brieﬂy in the next chapter. Exercise 4.15. Check that Q2 ◦ Q2 ∼ Q3 ◦ Q3 ∼ Q1.Conclude Cl(−56) ￿ C4. 74","libVersion":"0.3.1","langs":""}
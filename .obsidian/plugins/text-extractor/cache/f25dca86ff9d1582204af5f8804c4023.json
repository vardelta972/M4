{"path":"iCloudDrive/bks/Calculus/Handouts/Taylor_ERROR.pdf","text":"TAYLOR POLYNOMIALS DARYL DEFORD 1. Introduction We have seen in class that Taylor polynomials provide us with a valuable tool for approximating many diﬀerent types of functions. However, in order to really make use of these polynomials we need to understand how closely they actually match the function values we are interested in. This leads us to deﬁne a collection of “remainder functions” Rn(x) = |f (x) − Tn(x)| to measure the diﬀerence between the actual function value f (x) and the Taylor approximation Tn(x). We then hope to be able to control the size of this error term by picking n large enough so that Rn(x) is small on some interval containing our initial value a. This will gives us a guarantee that our approximation is actually useful. Figure 1 shows an example of this for the function e −x sin(x) centered at a = 0. (a) Function Plot (b) Error Plot Figure 1. An example of the error of a Taylor approximation. In plot (a) the original function f is in blue and the Taylor polynomial is plotted in green. The red lines show an error bound of .1 around f . Thus, when the green line is inside the red bounds the approximation given by the Taylor polynomial has error less than .1. Part (b) show the plot of the error function R3(x). From this plot it is easy to see that for values of x between −1 and 1 the Taylor approximation is pretty good but when x > 1.5 the error is much higher. Date: January 13, 2017. 1 2. Taylor’s Inequality The tool that we have to bound this error value is known as Taylor’s inequality. Formally, it says that if |f n+1(x)| ≤ M for all x in the interval [a − d, a + d] then |Rn(x)| ≤ M (n + 1)! |x − a| n+1 (2.1) Practically, what this inequality says is that if we have an interval around a that we are interested in, as long as we can bound the next derivative of f on the interval, we can estimate the size of the error of our Taylor approximation as a function of the order of the Taylor polynomial, n. This inequality looks a little complicated, so let’s talk brieﬂy about each of the individual components. 2.1. Finding M . Perhaps the most mysterious part of the equation is the number M bounding the “next” derivative of f . To get some intuition for why this appears in our inequality, let’s take a look at the actual formula for the Taylor series: Tn(x) = n∑ k=1 f (k)(x−a)k = f (a)+ f ′(a) 1! (x−a)+ f ′′(a) 2! (x−a) 2 + f ′′′(a) 3! (x−a) 3 +· · ·+ f (n)(a) n! (x−a)n When we use a Taylor polynomial approximation we stop this series after a ﬁnite number of terms so for the functions that we care about 1 we can express the remainder term function, Rn(x) in terms of the rest of the terms in the series: Rn(x) = |f (x) − Tn(x)| (2.2) = \f \f∑∞ k=1 f (k)(x − a) k − ∑n k=1 f (k)(x − a) k\f \f (2.3) = \f \f∑∞ k=n+1 f (k)(x − a)k\f \f (2.4) = | f (n+1)(a) (n+1)! (x − a) n+1 + f (n+2)(a) (n+2)! (x − a) n+2 + · · · | (2.5) Observe how closely the terms in Taylor’s inequality (2.1) match the ﬁrst summand in (2.5). What this is saying is that the most important term in estimating Rn(x) comes from f (n+1)(a) (n+1)! (x − a) n+1 which is the ﬁrst term left–over after subtracting Tn from f . Thus, is we can ﬁnd a number M that is larger than f n+1 on our interval we can use it in place of f n+1 in the formula to get a simpler bound that works over the entire interval. Although this explains where M comes from it doesn’t tell us anything about how to actually ﬁnd it. There are three main techniques that we will use. The simplest case is when f is a sin or cos function. In these cases we know that the derivative alternate sin → cos → − sin → − cos → sin → · · · . All of these functions have |f n| ≤ 1 and so when f is composed of sin and cos we can just take M = 1 to bound our derivative no matter what order it is. For other functions we will need a diﬀerent approach from Math 3. We are trying to ﬁnd the maximum value of f n+1 over some interval. This is just a standard optimization problem from calculus, where we take the derivative and set it equal to zero to search for critical points. Be very careful here to also check the endpoints of the interval as many of the functions that we analyze are either strictly increasing or decreasing, so they will not have any critical points on the interval and so the maximum value will occur by plugging in either the left or right endpoint. For example, if f n+1 = −2 x3 + 4 and our interval is [5, 11] then the function is increasing over the entire interval so it takes its maximum at x = 11 where f n+1(11) = −2 113 + 4 ≈ −.001498. Thus we could choose our value for M to be anything larger than | − .001498|. 1who are equal to their Taylor series 2 In order to determine M we need to know the (n + 1)st derivative of our function f as well as the interval. Usually, the function is given to us as part of the problem statement but we may need to determine the interval before choosing a value for M . One exception to this is mentioned above with the sin and cos functions, where we can usually simply take M = 1. 2.2. Choosing d. The second slightly confusing portion of the inequality is the interval: [a−d, a+d]. This is sometimes constrained by our problem but other times we get to make a choice. For example, if we want to approximate the value of a function at a speciﬁc point, we must choose an interval that contains the point but we may want to choose a larger interval to make our function easier to evaluate. Looking at the contribution of the d value in (2.1) we see that the maximum of |x − a| n+1 is dn+1. This allows us to give a single estimate on the error for the entire interval by replacing |x − a| n+1 by dn+1. Let’s look at an example: Assume that we have M = 2, n = 4, and our entire interval is [1, 7] = [4 − 3, 4 + 3]. If we want to estimate the error at a single point (say x = 3) we can: |R4(3)| ≤ 2 5!|4 − 3| 5 = 1 60 On the other hand, if we want a single bound for the entire interval we can say that for any x in [1, 7] the error is bounded by: |R4(x) ≤ 2 5!d5 = 2 5!3 5 = 81 20 Obviously, at the point x = 3 this is a much worse bound but it gives us a single number that works for the entire interval, which is frequently all we really want. 2.3. Choosing n. Many times n is given to us as part of the problem statement but occasionally we are asked to ﬁnd the number of Taylor polynomial terms needed to approximate a particular value. In this case our best bet is usually a little trial–and-error type approach, substituting in some values for n and seeing what they do to the bound. For example, if we want our error bound to be less than .001 on the interval [−2, 2] (so a = 0 and d = 2) with M chosen to be 12, we can make a table of values of 12 (n + 1)! 2 n+1 for diﬀerent choices of n: n Error Bound 2 16 3 8 4 3.2 5 1.067 · · · · · · 9 .0034 10 .0006 Thus, for n ≥ 10 we have |Rn(x)| ≤ M 11!2 11 ≈ .0006 < .001 which is what we wanted. This tells us that we should use the 11th order Taylor polynomial T11 to approximate our function. Frequently, we can estimate the eﬀects of n, particularly when d is small but checking a few small values is usually good enough. 3 3. How to use the error estimate Now that we understand the parts of the inequality a little better it is nice to look at how we might actually use the formula. The thing to keep in mind is that there are three algebraic components (n, d, and the error) to the expression and so if we are given values for two of them we can solve for the third. The simplest case is when we are given n and d and just need to ﬁnd the error over the interval. In this case we have all the components of the right–hand–side of the equation and can simply substitute in to obtain the error, Rn(x), over the given interval. In the other two cases, we are given a particular error value that we want to obtain and need to determine either the number of terms n or the size of the interval d. As mentioned in the previous section, if we are looking for n our ﬁrst approach is generally to make a table of values and continue trying values of n until we get lower than the desired error value. If we are looking for d, then we can rearrange the inequality to choose a d value that satisﬁes: n+1 √ |Rn(x)| · (n + 1)! M ≤ d 4. Examples In this section we examine the three homework exercises from Daily HW #3. Each of these problems provides us with a diﬀerent set of information and asks us to ﬁnd or estimate the remaining components using the Taylor inequality and a little algebra. 4.1. Section 11.11 #15. Problem. Approximate the function f (x) = x 2 3 at the point a = 1 with a third order Taylor polynomial. What is the error associated with this approximation for .8 ≤ x ≤ 1.2? Solution 1. For this problem we are given f = x 2 3 , n = 3, a = 1, and d = .2 and simply need to compute the bound on |Rn(x)|. In order to use the inequality we also need to ﬁnd a value for M so we will start by taking n + 1 = 4 derivatives of our function f : f (x) =x2/3 f (a) = 1 f ′(x) =2 3x− 1 3 f ′(a) = 2 3 f ′′(x) =−2 9 x− 4 3 f ′′(a) = −2 9 f ′′′(x) = 8 27x− 7 3 f ′′′(a) = 8 27 f ′′′′(x) =−56 81 x− 10 3 f ′′′′(a) = −56 81 This gives us that the Taylor polynomial is: T3(x) = 1 + 2 3 (x − 1) − 1 9(x − 1)2 + 4 81(x − 1) 3 To choose a value for M ≥ |f ′′′′(x)| = | −56 81 x− 10 3 | we notice that this is always increasing on this interval and thus the maximum occurs at the left endpoint: .8. This means that we can choose any value for M that is greater than or equal to |f ′′′′(.8)| ≈ 1.4546. Choosing M = 1.5 is a convenient, nearby value that makes our computation a little easier. At this point we have all the pieces we need to get the error from the inequality: |R3(x)| ≤ 1.5 24 (.2) 4 = .0001 4 . This example shows that on this interval even a small value of n is able to match the function quite closely: ] (a) [.8,1.2 ] (b) [0,10 Figure 2. Plots for Problem 1. The ﬁrst plot shows the function and approximation on the interval, while the second shows the plot for a larger interval. Although the match is almost perfect in (a) by the time x is around 4 the value of the approximation is quite far from the actual function. 4.2. Section 11.11 #25. Problem. Use Taylor’s inequality to determine the number of terms necessary to estimate e.1 to within .00001. Solution 2. In this problem, we need to start by determining what function f to use. Since we want to estimate e.1 a natural choice is f (x) = e x. This then changes the problem statement to estimating f (.1). Our next task is to determine a suitable a value. Since we are dealing with ex a nice choice is a = 0 since e0 = 1. This is also a good choice because the value we want to estimate which is .1 is close to zero. Using this reasoning we decide to make our d = .1 so that the interval is [−.1, .1] which is the smallest interval centered at zero that contains our desired x value. Our next step is to determine M on this interval. Luckily, all of the derivatives of ex are the same and even better we know that e x is an increasing function. Thus, any derivative of e x on the interval [−.1, .1] is bounded by e .1 ≈ 1.105 and we can take M to be anything greater than or equal to this value. At this point we have all of the information that we need and have to start trying values of n to get the right–hand–side of Taylor’s inequality to be less than .00001: |Rn(x)| ≤ e .1 (n + 1)! (.1) n+1 < .00001 Substituting in n = 2 gets us ≈ .00018 and moving to n = 3 gives ≈ .0000046 so 3 terms is deﬁnitely enough. In this case we can compute the actual error value at the point: |R3(.1)| = .00000425140898108189 which is only slightly less than the bound we get from Taylor’s inequality. 5 4.3. Section 11.11 #27. Problem. Use Taylor’s inequality to estimate the range of x values where the approximation to sin(x) ≈ x − x3 6 has error less than .01. Solution 3. For this problem we are trying to determine the right value of d to build our interval. We are given f = sin(x) and a Taylor polynomial. In this case, the approximation is both T3 and T4 since sin is an odd function and hence has no even terms in the corresponding Taylor expansion. We will use n = 4 throughout this solution since it gets a better bound but n = 3 would also work. Since all the derivatives of sin are bounded by 1 on any interval we will simply take M = 1 from the beginning. We now have all the information we need to compute the interval length: .01 ≤ 1 5!(d) 5 5√1.2 ≤ d 1.037 ≤ d Taking d = 1.037 gives us the interval [−1.037, 1.037] where our error is guaranteed to be less than .01. Looking at the plot of the approximation and the error conﬁrms our numerical calculations. Note that in plot 3(b) the error line crosses the bound at ≈ ±1.037. (a) Function Plot (b) Error Plot Figure 3. An example of the error of a Taylor approximation for problem 3. In plot (a) the original function f is in blue and the Taylor polynomial is plotted in green. The red lines show an error bound of .1 around f . Thus, when the green line is inside the red bounds the approximation given by the Taylor polynomial has error less than .1. Part (b) show the plot of the error function R3(x). From this plot it is easy to see that for values of x between −1 and 1 the Taylor approximation is pretty good but when |x| > 1.1. Department of Mathematics, Dartmouth College E-mail address: ddeford@math.dartmouth.edu 6","libVersion":"0.3.1","langs":""}
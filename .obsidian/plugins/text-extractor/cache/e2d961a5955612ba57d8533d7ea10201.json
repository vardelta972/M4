{"path":"iCloudDrive/bks/Combinatorics/art solutions.pdf","text":"THE ART AND CRAFT OF PROBLEM SOLVING INSTRUCTOR’S MANUAL Second Edition THE ART AND CRAFT OF PROBLEM SOLVING INSTRUCTOR’S MANUAL Second Edition Paul Zeitz University of San Francisco JOHN WILEY & SONS, INC. Contents Chapter 1 Teaching Problem Solving 1 1.1 Preparation 1 1.2 One Plan for a Problem-Solving Seminar 3 Chapter 2 Chapter-by-Chapter Solutions 8 Appendix A Sample Exams 69 Appendix B An Inspiring Story 73 References 75 v Chapter 1 Teaching Problem Solving I wrote The Art and Craft of Problem Solving (TAACOPS) as a textbook for my problem-solving seminar at the University of San Francisco. My target audience is bright but naive college students who most likely are not attending elite universities. I believe that TAACOPS can be easily adapted to teach problem solving to a wide range of people, from gifted high school students to graduate students in education. TAACOPS was designed to be friendly enough and easy enough to use for beginning teachers of problem solving, that is, math teachers who have always wanted to teach problem solving but have not done so for lack of a proper textbook and the intimi- dating nature of the subject. The brief comments below are meant for these teachers. What follows are merely a few things that I have learned from my own experiences. Obviously, every teacher has a different style, so take what I say with many grains of salt. Unless otherwise stated, all page and example references are from TAACOPS, not this manual. 1.1 Preparation If you have never taught a problem solving class, it can be rather scary. Problems by their nature are not easy to solve and teachers by their nature prefer a high level of omniscience. You will relinquish at least some of your sage status no matter how well your course goes, but doing your homework during the summer will go a long way. (Incidentally, it is best to teach your course in the fall semester if you plan to make use of the Putnam Exam. And it is nice to have a summer to prepare.) You need to become a better problem solver before your course begins. Not a great problem solver, but preferably at least as good as your good students (perhaps not as good as your best ones). The ideas in TAACOPS work just as well with teachers and professors as they do with students, and of course you already have the advantage of knowing lots of mathematics and knowing how to concentrate. You should discover that a modest effort at mastering the strategies and tactics of Chapters 1–4 will dra- matically improve your “solve rate” and your conﬁdence. And please take the advise on p. 20 seriously. The more ideas you appropriate, the better. As you work on problems, start collecting favorite exemplary ones, which may or may not be worked examples in the book (do use the solutions in this manual as 1 2 CHAPTER 1 TEACHING PROBLEM SOLVING well). You want to have a nice store of linked problems so that you can motivate your students. Besides immersing yourself in problems from TAACOPS, you must start assem- bling a small library of problems and related literature. Even though TAACOPS has over seven hundred problems, you will need a few more. Here are the essential ones (incentive: you will need some of these to ﬁnd solutions to some of the problems in TAACOPS).1 Putnam Exams You need the problems and solutions from at least 1980. There are three books [8, 1, 14] which have problems and solutions from 1938– 64, 1964–84, and 1985–2000, respectively. The most recent book is especially good. For exams after 2000 a web search should yield exams and solutions. USAMO and IMO Exams There are two books [10, 15] which respectively cover the periods from 1959–77 and 1978–85. For exams after, order pamphlets from the American Mathematics Competitions (AMC) at http://www.unl. edu/amc. AIME Exams Pamphlets are available starting from 1982 from the American Mathematics Competitions. USSR Exams The mother of all problem books is the USSR Olympiad Prob- lem Book [22], which is now available in a Dover paperback, I believe. It contains many easy-to-moderate problems, some very hard ones, and lots of detailed solutions and discussion of techniques. Math Circles Another Russian import is Mathematical Circles [4], a guide- book for teaching young kids (mostly elementary school to early high school). But the mathematics is deep and fascinating. In many ways, this is a perfect companion book to TAACOPS, for high school and junior high school teachers. Reading TAACOPS should prepare the beginning teacher to utilize Mathemat- ical Circles very effectively to teach younger students. Recreational Problems Several books by Martin Gardner (as a great source of recreational problems). In addition, here are some other good sources of problems which often include useful instructional material. • The Hungarian problem books [16, 17, 18], which contain the oldest olympiad- style contests and much useful elementary material. The most recent book is especially recommended. • For relatively easy problems, the Canadian Olympiad collection [5]. For an un- usally varied set of elementary (but hard) questions, try the Leningrad Olympiad collection [6]. Another ﬁne collection, with great variety (mostly moderate level) is 500 Mathematical Challenges [2]. This book of mostly Canadian prob- lems is notable for its compilation of useful tools (called “The Toolchest”) in an appendix. For a small collection of imaginative college-level problems, try the Wohascum County Problem Book [7]. 1The references are cited at the end of this manual, not the bibliography of TAACOPS. 1.2 ONE PLAN FOR A PROBLEM-SOLVING SEMINAR 3 • The problem sections in the journals mentioned on p. 8 of TAACOPS. • The many essay collections by Ross Honsberger, most having titles like Math- ematical Gems, for example [13]. These are nicely written discussions of fasci- nating problems (great for beginning a class or a course). • Ravi Vakil’s enjoyable A Mathematical Mosaic [24] is excellent for its well- chosen “folklore” topics. If you are worried about course enrollment (perhaps your school has never of- fered such a course before, or offered it only sporadically), you may want to talk up your favorite problems to students as a recruitment tool. I have had lots of success in recruiting students from Linear Algebra or Calculus II courses by coming in with a 5- minute spiel that usually includes some combination of Examples 1.1.3, 1.1.4, 1.3.12, and 1.3.16. It is also a good idea to decide ahead of time what kind of course you want it to be. Do you want to help students do well on the Putnam Exam? Or do you want to get beginners comfortable with concentrating hard and investigating problems? I have found that low expectations are best, for then you may be pleasantly surprised. And I have never had much difﬁculty with a mix of abilities (see the discussion on group work below). 1.2 One Plan for a Problem-Solving Seminar I advocate a seminar-style course, one with limited enrollment (preferably no more than 20) and longer meeting times (for example, 90 minutes twice a week instead of 60 minutes thrice weekly). Problem solving is not something that can be lectured about, at least not all the time. The basic structure of the seminars that I have conducted is not very elaborate: usually we spend the ﬁrst half of class time discussing problems (students working at the board), and I wrap up the discussion with either a canned lecture (rarely) or a variation on a theme presented by the students. For example, suppose a student solved a combinatorial problem in a nice way. I may decide to use this as an entry point to discuss generating functions (something most students have never seen before). Or I will conclude from the low level of rigor of the last proof (all too common!) that we should review some proof-logic techniques, etc. My biggest challenge in the classroom is getting shy students to come to the board and shutting up the ones who hog the board. Of course, that is the main problem with most seminar-style courses. I try to do my homework by selecting the right mix of problems that are interesting, and at just the right level of difﬁculty for the moment. And each year, as I learn more and read more and work on more problems, I get better at improvising. Besides the standard seminar environment, there are a few non-traditional features, described below. Group Work I cannot recommend this highly enough! I spend a fair amount of time agonizing over group assignments, and organize the students into groups of 3 or 4 people. This seems 4 CHAPTER 1 TEACHING PROBLEM SOLVING to be the ideal size; two-person groups are not ﬂuid enough, and larger groups often cannot meet at the same time. My groups are chosen so that they will function well. I don’t worry about making groups of equal “strength,” although this is desirable, but instead try to make sure that the individuals interact harmoniously. The perfect group has • People who enjoy each other’s company (no romances, please). • People with compatible schedules (often the critical property among today’s overworked students). • Fairly homogeneous math skills/ability. • Mostly homogeneous introvert/extrovert mix, unless this offsets a mathematical imbalance. For example, a group of fairly shy people works well, certainly much better than one with several shy people plus one dominant type, unless the dominant person is perceived to be one of the weaker mathematicians. • People who usually, but not exclusively, play distinct roles. For example, it is good to have one student who is great at visualization and one who leans towards computation instead. It is good to have a dreamy creative type, even if she is not that skilled/rigorous, if one of her partners is a less imaginative but better-trained logician. Many successful groups function like sports teams, with starters, who ask the questions, break the rules, and get the investigation going; power players, who come up with the crux move more often than not; and closers, who can carefully critique, improve, and ultimately complete a creative but ﬂoundering argument. The very best groups, I have found, have people who mostly play distinct roles, but who are capable of switching positions as well. The things to avoid in groups are putting too many close friends together, and avoiding imbalanced groups where a brilliant extrovert is together with several shy weaker students. Such groups are not doomed to failure, but may require intervention. Sometimes a ﬂawed group can be ﬁxed by exchanging people between groups. Some- times there is nothing that can be done. But we teachers are used to imperfection. Generally, if 4 out of 5 groups function well, I am thrilled and know that realistically this is a good success rate. See appendix B for a true story about how much a group can do, an experience which inspired me in part to write TAACOPS. Homework Assignments come in many ﬂavors: reading and problems to discuss by next class, individual work, group work (one paper per group), rewrites. Since the students are beginning proof writers (usually), rewrites are critical. I usually assign a grade (A,B,C or No Credit) to each problem, with a symbol like “/R” to indicate “please rewrite it by next week and then I will change the grade.” It makes the recordkeeping difﬁcult but is worth the trouble. I assign semi-ofﬁcial “backburner” problems for students to work on with no deadlines attached. In general, it pays to be very relaxed about deadlines, as long as the students are working hard. I know that my seminar is succeeding when I run into a group working at the blackboard in a deserted classroom late at night, arguing and laughing. Likewise, I am in heaven when I ask about a particular problem 1.2 ONE PLAN FOR A PROBLEM-SOLVING SEMINAR 5 and several students complain that they stayed up all night and didn’t work on their history paper and they still didn’t solve the problem. A typical homework load would be something like 5–10 problems due per class on average, with a good mix of easy (designed secretly to boost conﬁdence), medium, and hard problems. Usually at least half of the homework load at the beginning of the course is group work. This is important for keeping up the conﬁdence level. Gener- ally groups outperform individuals, so the group is bound to solve some impressive problems. The weaker individuals will be proud of their group’s accomplishments, which will help them with their own conﬁdence. Of course it is your job to spot these individuals and nurture them. It is important to start slowly, since it is much easier to build conﬁdence gradually, and this is the bottleneck. It is not unlike sports: if you try to do too much, you risk injury. A few too many super-hard problems can easily crush a neophyte’s ego beyond recovery. A good way to avoid this is by relying on many recreational problems at the beginning. These problems are fun and deeper than they seem. Once you have seduced your students with the handshake problem (1.1.4) or the lightbulb problem (1.3.2) or the rope problem (2.1.19) or the professors problem (2.1.21), they will be willing to go to great mathematical lengths on later problems. On the other hand, there is nothing wrong with sprinking in a few killer problems even from the very ﬁrst day. These “backburner” problems should probably be identiﬁed as such. For example, I often present on the ﬁrst day of the course several problems like 1.3.10, 1.3.12, and 3.3.5, and usually at least 5 to 10 minutes of each class is devoted to progress reports on these problems. Since they are designated as super-hard, some students avoid them, but others are liberated by the lack of expectations. I have experimented with not telling students that a hard problem is hard, with mixed results. Exams Usually 3 to 4 exams are given, all take-home except for the Putnam Exam (see below). After a few weeks of foundational work (studying most of Chapters 2 and part of Chapter 3, with smatterings of other sections), I assign the ﬁrst exam.2 It has a time limit of about a week, and is to be entirely done in groups. The group hands in one paper, and all group members get the same grade. Additionally, on the day the exam is due, we have an oral exam, in which students are randomly chosen to go to the board without notes or help from their group partners. The student may choose any problem that has not yet been discussed, and present a solution in a few minutes. The presentation is judged (I usually invite colleagues from my department for this) Olympics-style (with cards numbered from 1–5), and polite but “hostile” questions are allowed by judges or members of other groups. These questions are designed to probe for misunderstanding, etc. The process is a bit scary, but done with good humor, and is designed so that everyone is obligated to understand as much as possible. An unbalanced group with a dominant member will not do well unless this person can teach his or her comrades. In practice, the highest oral grades go to the most cohesive 2See appendix A for sample exams. 6 CHAPTER 1 TEACHING PROBLEM SOLVING groups, not the groups of the best mathematicians. And of course, the group gets only one oral grade. Almost always, the ﬁrst exam achieves its purpose. Enough of the problems were easy enough so that everyone could feel successful, and enough were sufﬁciently chal- lenging so that each group could develop an almost-military ´elan. Virtually every stu- dent experienced or at least witnessed the epiphany of seemingly sudden inspiration that in reality was fueled by many hours of sweat. At this point, the students have been converted: almost all of them are now active problem solvers, and need now “only” to keep practicing their skills and accumulate new tactics and tools. Exam 2 begins, usually a month-long individualized process. I meet with each student separately to negotiate a collection of problems that they will solve, a mix of Putnam problems plus problems selected from one or two topics. This list of about 15 problems varies immensely from student to student. Some people are ready to tackle hard Putnam problems (say, the two or three hardest of the 12-question exam), while others will be lucky to solve the easiest Putnam problems. That doesn’t matter, as long as the student and I can come to an accurate consensus of what will be the appropriate challenge. Regular class discussion and homework continue while the students work on this exam, and towards the end of this period I usually do the most lecturing that I do during the semester (since the students are too busy doing their own problems to work hard on group assignments or public problems). The second exam is hard for students. They are separated from their now-beloved group members and must deal with their own weaknesses. But again, if I have done my homework, at least some of the problems that each student solved were challenging enough so that they really felt a sense of accomplishment. Needless to say, I am not always successful, but I usually err on the side of making the exam too easy rather than too hard. And for some students (especially teachers or future teachers), I include problem composition assignments along with problem solving questions. The third exam is the Putnam Exam, which is held on the ﬁrst Saturday of De- cember. My students are required to take this exam (or else substitute something so arduous that they always choose the Putnam). I usually agree to retroactively change anyone’s grade to an A+ if they solve 2 or more problems (the results are not available until March). For most students, the Putnam does not affect their grade. But it is a valuable experience, one that we try to carefully prepare for, and we spend most of the rest of the semester discussing the problems in class. I try not to foster much exami- nation mania among my students; my stress throughout the course is that investigation is paramount and time limits are silly. The 6-hour-long Putnam exam consists of 12 problems, which is a huge amount of time pressure, but most of my students prudently work on just a few questions during the exam and then spend much more time after- wards investigating the harder problems. Teachers of younger students (high school, for example) may ﬁnd that the students may enjoy exam competition more and group work less. The most important thing is to promote whatever causes the students to spend lots and lots of time pondering mathematics. The ﬁnal exam is similar to the ﬁrst exam, a group reunion experience, only the problems have more mathematical content. And again, we end with oral presentations and often refreshments. Usually the problems are not super-hard, since the students 1.2 ONE PLAN FOR A PROBLEM-SOLVING SEMINAR 7 have barely recovered from the Putnam. Grading As you can imagine, this is not a fun part of the course for the instructor. The main problem, of course, is that the students’ experiences and achievements are not at all comparable in a quantitative sense. I keep careful records of who got what grade on what problem when (using a spreadsheet program) and compute weighted averages and all that stuff, but in the end, I usually just ask myself, “What did this person get out of the course?” And I grade pretty leniently. Only when a student truly doesn’t try will I grade harshly (C or D). Usually at least half of my students get an A, but I don’t feel guilty, because I know that these people worked like crazy and experienced profound frustration mixed with sporadic triumphs. It is essentially binary, like boot camp: either you overcome adversity, or not. Most students succeed at this course, because most people like to rise to challenges. Chapter 2 Chapter-by-Chapter Solutions What follows are solutions, solutions sketches, or at least substantial hints to many of the problems. We omit solutions to most of the Putnam, AIME, USAMO, and IMO problems, because these exams (and solutions) are widely published and we assume (and strongly encourage!) that you have them on your bookshelf. We also do not include solutions to problems from the Bay Area Mathematical Olympiad, as these are freely available at http://mathcircle.berkeley.edu/BMC6/pages/ BAMO/bamo.html. Also, we do not give solutions to some of the more routine ques- tions that are typically covered in standard texts. References are mentioned, although you may have other favorites. All page and example references are from TAACOPS (2nd edition), but the ref- erences cited use the bibliography at the end of this manual, not the bibliography on pp. 356–9 of TAACOPS. A large number of problems in TAACOPS were drawn from 1995 Olympiad con- tests from many countries. I thank the ofﬁcials from these countries who graciously agreed to let me (and others) disseminate their questions, and am grateful to Titu An- dreescu, Elgin Johnston, and, especially, Kiran Kedlaya for helping me to solve many of them! 1.3 2 Leave one switch on, one off, and turn the third on for a minute and then off. Then check for the three possibilities of light is on, light is off and cold, light is off and warm. 4 Notice that the line from (0, 0) to (12, 16) passes through the center of the circle, which is (6, 8). 5 The maximum value is 73. Draw a picture: the ﬁrst equation is that of a cir- cle with radius 8, and center at (7, 3). The equation 3x + 4y = k deﬁnes a family of parallel lines, all with slope −3/4. The extreme values of k are attained when the line is tangent to the circle. Since the tangent line is perpendicular to the line drawn from the the radius to the point of tangency, it is easy to compute the coordinates of the two points of tangency and then plug into 3x + 4y. 8 ANSWERS TO 2.1 9 11 (Sketch due to Kiran Kedlaya) It sufﬁces to show that cos(cos(x)) > sin(sin(x)) for all x, from which it follows that cos(cos(cos(cos(x)))) > sin(sin(cos(cos(x)))) > sin(sin(sin(sin(x)))), and hence the given equation has no solutions. Useful facts are cos(cos(x)) = sin(π/2 − cos(x)), sin(x)+cos(x) = √ 2 cos(x −π/4), and the monotonicity of sine and cosine (for angles between 0 and π/2). An excellent reference for problems of this kind, and much more, is Geo- metric Etudes in Combinatorial Geometry by Vladimir Boltyanski and Alexan- der Soifer [3]. 20 The idea is that triangular packing (so the centers of three circles are ver- tices of an equilateral triangle) is a more efﬁcient use of space, however, to do this, you waste some space at the beginning of the rectangle. So you need a long rectangle to catch up. 2.1 17 No. Color the vertices of a square black, white, black, white. 18 The ﬁrst set contains only numbers whose numerals are drawn exclusively with curves; the second contains “linear” numerals; the third contains the mixed numerals. 19 Crux idea: cut one of the ropes near the ceiling to make a small loop. 21 First prof writes a random number, shows it to the next prof who then writes the sum of her salary and the ﬁrst number on her piece of paper. This process of writing the running sum is continued until the last prof shows her sum to the ﬁrst prof, who then subtracts her random number. Now the sum (and hence the average) is known. 22 Both have the same fraction. This can be computed easily by algebra, but it can be seen by imagining that the bottles contain not ﬂuid but differently- colored ping-pong balls. Then just remember: mass is conserved! 23 Crux idea: the two slow people must travel together at some point. 24 See problem 6.4.12. 25 Consult any standard reference for the formulas. 26 See the discussion on Eulerian paths in section 4.1. 27 (a) 30 years old. (b) 1 (one book may have all the colored illustrations). (c) 5 times (the outcomes are 0, 1, 2, 3, 4, 5 heads). 10 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS (d) The answer is 5. The original pyramid has 5 faces. Attaching the tetra- hedron adds no new faces! The reason: when the tetrahedron is glued to the pyramid, two of the faces of the tetrahedron are ﬂush with faces of the pyramid! Of the two other faces of the tetrahedron, one is glued to a face of the pyramid (and thus both of these faces now lie inside the new solid), and the other becomes one of the faces of the new solid. The big question is, how to show that the faces are ﬂush? One way is to do rather difﬁcult 3-dimensional vector calculations, with a fair amount of trig. This is a good exercise, and well worth doing. The ingenious way to see it it in a ﬂash is to imagine two pyramids sitting next to each other so their square faces are touching side to side. It is easy to see that the “gap” between them is exactly the size and shape of a regular tetrahedron (draw a pic- ture, or better yet, build some models!). Hence, when you place a regular tetrahedron into this gap, you get a nice prism. In other words, two of the faces of the tetrahedron will be ﬂush with two faces of the pyramid. (e) All n. Just draw parallel strips! 2.2 9 Verify that f 3(x) = x. 10 Tn = n! + 2n. 11 f (n) is the equal to the number of 1’s in the base-2 (binary) representation of n. 12 See the discussion of Euler’s formula (3.4.3, 3.4.40). 13 If f (n) is the number of areas for n lines, the (n + 1)-st line will intersect each of the n lines, producing one new area each time, plus one additional area (the “exit” point. Thus f (n + 1) = f (n) + n + 1. This gives an algortithm, and it is possible to use formulas for arithmetic series (see section 5.3) to get the formula f (n) = (n2 + n + 2)/2. 14 By the same methods as 2.2.13 above, the answer will be essentially dou- ble: n2 − n + 2. 15 For example, 1/8 + 1/56 = 1/7. What’s the pattern? 16 Motivated by the examples 1/2 + 1/3 + 1/6 = 1 and 1/2 + 1/3 + 1/7 + 1/42 = 1, it is easy to guess that the next example is 1/2 + 1/3 + 1/7 + 1/43 + 1/(2·3·7·43) = 1, and now it is easy to generate any solution: let x1 = 2, x2 = 3 and recursively deﬁne xm = x1 · x2 · · · xm−1 + 1 until xn is deﬁned. 17 See 2.3.38. 18 When n is a perfect square. 19 As long as n ≥ 60 = (7 − 1)(11 − 1), we can always do it. 20 The sum stays the same! To prove this, we need to do a rather tricky induction argument (see Section 2.3). 21 (a) n(n + 1)/2 b) n2(n + 1)2/4 c) There is no “simple” formula, but see Example 5.3.2 for ideas (you’ll need the binomial theorem). ANSWERS TO 2.3 11 22 s(n) = 2n−1. 23 Use the fact that (u2)2 + (2u)2 + 22 = (u2 + 2)2. 25 Let us work out the ﬁrst few terms of the product. We get (1 + x3)(1 + 2x9)(1 + 3x27)(1 + 4x81) · · · = = 1 + x3 + 2x9 + 2x12 + 3x27 + 3x30 + 6x36 + 6x39 + 4x81 + · · · . What are the (positive) exponents ki? All integers of the form 3u1 + 3u2 + · · · + 3ur , where the integers u j satisfy 1 ≤ u1 < u2 < · · · < ur. In other words, they will be numbers which, when written in base-3, only contain ones and zeros and end with a zero. In order, the ﬁrst few exponents are (written in base-3) are 10, 100, 110, 1000, 1010, 1100, 1110, 10000, . . . . Of course, these numbers are just the base-2 representations of the sequence 2, 4, 6, 8, . . .. In particular, to ﬁgure out k1996, we just write 2 · 1996 = 3992 in base-2: 3992 = 2048 + 1024 + 512 + 256 + 128 + 16 + 8, so the base-2 representation of 3994 is 111110011000, and k1996 is equal to 111110011000 (base-3). In other words, k1996 = 33 + 34 + 3 7 + 3 8 + 3 9 + 310 + 3 11. 26 Solved in Example 2.4.3. 27 See [9] for a very nice discussion of this and related problems. 28 g(n) = 2r, where r is the number of 1’s in the base-2 representation of n. 32 Let m not be a perfect square. We can write m = n2 + b, where 1 ≤ b ≤ 2n. Since (n + 1/2)2 = n2 + n + 1/4, we see that if b ≤ n, then {√ m} = n, and if b > n, then{ √ m} = n + 1. Hence, in the ﬁrst case, we have f (m) = m + n = n2 + b + n < n2 + 2n + 1. In the second case, we have f (m) = m + n + 1 = n2 + b + n + 1 > n2 + 2n + 1. In neither case will f (m) be a perfect square. We ﬁnish things off by noting that if m = n2, then f (m) = n2 + n, which is not a perfect square. 35 a) No; let n = 41. See also Example 7.5.1. b) The correct formula is t(n) = 1 + (n 2) + (n 4) . For a derivation and further discussion, see the reference cited in the problem. 2.3 21 See page 223. 22 Assume that neither U nor T are closed under multiplication. Then there exist t1,t2 ∈ T and u1, u2 ∈ U such that t1t2 ̸∈ T and and u1u2 ̸∈ U. But then t1t2 ∈ U and u1u2 ∈ T , since if something is not a member of T it must be a member of U and vice-versa (since all of these products are in S, which is 12 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS closed under multiplication). Now consider t1t2u1u2. This is a product of three elements of T , since t1,t2 ∈ T and u1u2 ∈ T . By hypothesis, then, t1t2u1u2 ∈ T . But t1t2u1u2 is also a product of three elements of U, namely t1t2, u1 and u2, and hence must be a member of U by hypothesis. But this is a contradiction: t1t2u1u2 cannot be a member of both T and U, for these two sets are disjoint. So our original assumption that neither T nor U were closed could not be true. We conclude that at least one of these sets is closed. 23 No, it is not possible. WLOG, let there be 3 (which is odd) numbers placed on the circle; call them a, b, c. Now consider the ratios a/b, b/c, c/a. Each is either a prime or the reciprocal of a prime, while the product is equal to 1. The product will then be a fraction, whose numerator (before simplifying) is a prod- uct of primes, and whose denominator is a product of primes. Since there are a total of 3 primes in the numerator and denominator, we have a contradiction: the numerator and denominator will end up with different numbers of primes, and there is no way that the two quantities can be equal (so that the fraction will equal 1). As long as there are an odd number of numbers placed on the circle, it cannot be done. It is easy to do it with an even number, though. 32 Given that xn + 1/xn is an integer, we will show that xn+1 + 1/xn+1 is also an integer. By hypothesis, x + 1/x is an integer, so the product (xn + x−n)(x + x−1) = xn+1 + 2 + x−(n+1). Hence xn+1 + 1/xn+1 is an integer. 40 Crux idea: look at this picture! 2.4 7 After drawing a distance-time graph, it is easy to see that Pat walks for 55 min. 8 Draw a picture with dots arranged in a grid pattern. ANSWERS TO 2.4 13 9 Sunrise was at 4:30 AM. This is a pretty hard problem to do by algebra alone; instead we will draw a time-distance graph and do some geometry. In the graph below, which is not drawn to scale, the horizontal axis measures time starting with sunrise and the vertical axis represents the distance along the road from A to B. The points F, G, and H are respectively noon, 5 PM and 11:15 PM, and the line segments AD and BH represent the time-distance paths of Pat and Dana, respectively, which meet at C. We can determine the time of sunrise once we compute the length AF. B A C F E D G H Triangles ACH and DCB are similar, so BE ED = FH AF . Since ED = 5, FH = 11.25 and BE = AF, we have AF 2 = 45 4 · 5, and AF = 15 2 . 10 The bug should travel along two line segments: ﬁrst from (7, 11) to O = (0, 0), and then from O to (−17, −3). This is a consequence of the following principle: the bug must avoid quandrant II completely, even though a straight line path from (7, 11) to (−17, −3) goes through quadrant II. To see why this is true, let a and b be arbitrary positive numbers, and con- sider a path starting at A = (0, a) and ending at B = (−b, 0). Certainly the quickest route within quadrant II is the line segment AB, and the length of this path is √ a2 + b2. Now consider the alternate route AO followed by OB. This path lies outside quadrant II (since quadrant II does not include the x- or y-axes) and has total length a + b. Compare these two lengths. By the arithmetic-geometric mean inequality, we have a2 + b2 ≥ 2ab, which implies that 2a2 + 2b2 ≥ a2 + 2ab + b2 = (a + b)2. Hence a + b ≤ √ 2√a2 + b2. We conclude that as long as the speed in quadrant II is less than 1√ 2 , then any path from A to B that passes through quadrant II will take more time than the shortest non-quadrant-II path (along the y- and x-axes). Since 1 2 < 1√ 2 , our bug will save time by avoiding quadrant II. 11 During the course of the twelve-hour period from midnight to noon, the hands begin and end lined up, and line up also eleven other times: a bit after 14 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS 1, then after 2, etc. The interval between successive line-up times is always the same (to see why, consider the point of view of an ant that lives on the hour hand), hence these intervals occur every 12/11 hours. So the answer is 1 o’clock plus 1/11 hour, or 1:05:27 and 3/11 sec. 15 Recast the problem with counting dots. You need to characterize the “trapezoidal” numbers. 17 The answer is 8. Observe that the quantity to be minimized is just the square of the distance between the two points (u, √ 2 − u2) and (v, 9/v). This is the distance between an arbitrary point on a the circle x2 + y2 = 2 and a point on the upper half of the hyperbola y = 9/x. Thus we need to ﬁnd the minimum distance between these two curves. It is easy to see (draw a picture) that this attained by picking the point (1, 1) on the circle and the point (3, 3) on the hyperbola. 18 Unfold the cube; shortest distance is a straight line; answer is √5. 19 Let R be the interior of the rectangle with vertices (0, 0), (b, 0), (b, a), (0, a). The line y = ax/b intersects no lattice points in R (it passes through (0, 0) and (b, a), but these points are not included in R, and there are no other lattice points on the line, since a and b have no common divisors). Observe that ⌊ai/b⌋ is just the number of lattice points that lie below this line in R for x = i. Thus the left-hand sum is just the number of lattice points lying below the line in R . By similar reasoning, the right-hand sum is equal to the number of lattice points lying above the line. The common value must equal one-half of the total num- ber of lattice points, which is of course (a − 1)(b − 1). Observe that at least one of a and b must be odd, for otherwise the two numbers would share a common divisor (namely, 2). Consequently (a − 1)(b − 1) is even and can be divided by 2. 20 See Example 8.2.1. The only difference is that now we use the graph of y = √ 1 − x in place of the hyperbola. 21 The answer is √ 104 + 172. Each term √ (2k − 1)2 + a2 k can be interpreted as the length of a vector with horizontal displacement (2k − 1) and vertical displacement ak. If we place these vectors end-to-end, then the sum n ∑ k=1 √ (2k − 1)2 + a2 k is the total length of a possibly jagged path which has a net horizontal displace- ment of 1 + 3 + · · · + (2 · 10 − 1) = 10 2, and net vertical displacement of a1 + a2 + · · · + a10 = 17. If we vary the ai so that the path length is minimized, the path will clearly be a straight line. The length of this line is of course just √ 104 + 172. ANSWERS TO 3.1 15 23 The answer is 1235. Convert the problem into one where you are count- ing lattice points inside triangular and rectangular regions; Problem 2.4.19 is slightly similar. 24 Consider the general problem of n marbles m0, m1, . . . , mn−1 with arbitrary starting locations. Each marble has a “ghost path,” the path it would travel if it did not bounce off its neighbors but instead passed through them. Whenever the marbles bounce, the actual path of a marble coincides with another marble’s ghost path. After one minute has passed, each ghost path has returned to the original positions of each marble. Hence after one minute, the actual locations of the marbles are a permutation of the original positions. Moreover, this per- mutation must be a cyclic permutation, since the marbles cannot pass through one one another. We claim that the permutation takes m0 to md, where d is the “counter- clockwise excess,” i.e. the difference modulo n between the number of coun- terclockwise marbles and the number of clockwise marbles. To see this, let vi(t) be the velocity function for marble mi, where the ve- locities of +1, −1 denote counterclockwise and clockwise motion, respectively. Notice that for any time t, n−1 ∑ i=0 vi(t) = d, since the number of clockwise and the number of counterclockwise marbles never changes (even when marbles collide). There will be ﬁnitely many bounces, and in any time interval between bounces, each velocity function is a constant. Let t1,t2, . . . ,tk be time values inside each interval, and let each each interval have length ℓi. For each marble mi, denote the net counterclockwise distance traveled from t = 0 to t = 1 by si = vi(t1)ℓ1 + vi(t2)ℓ2 + · · · + vi(tk)ℓk. Summing this over all marbles, we get n−1 ∑ i=0 si = d(ℓ1 + ℓ2 + · · · + ℓk) = d · 1 = d. The only cyclic permutation associated with this sum of net distance traveled is the one which takes m0 to md. 3.1 13 The answer is √ 170. Let the path go from (3, 5) to (0, a) to (b, 0) to (8, 2). This path has the same length as the path (draw a picture!) from (−3, 5) to (0, a) to (b, 0) to (8, −2), and this path is clearly minimized when it is a straight line from (−3, 5) to (8, −2). 15 The product of the divisors of n is √ nd(n). 16 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS 16 The answer is 229. Notice that the sum of all the elements of the set S = {1, 2, 3, . . . , 30} is 1 + 2 + 3 + · · · + 30 = 30 · 31/2 = 465. Let A be a subset of S and let Ac denote the complement of A (the elements of S which are not elements of A. The sum of the elements of A plus the sum of the elements of Ac must equal 465. Because 465 = 232 + 233, if the sum of the elements of a A is greater than 232, the sum of the elements of Ac must be less than 232. In other words, there is a one-to-one correspondence between subsets whose element sum is greater than 232 and subsets whose element sum is not (namely, A ↔ Ac). Hence the number of subsets whose element sum is greater than 232 is exactly half of the total number of subsets of S, and the number of subsets of S is 230. 19 There will be an inﬁnite amount of rotation. Consider the situation after the bugs have each rotated 1 degree. They are now, as before, lying at four vertices of a square, with exactly the same situation as at the start, in terms of angular relationships. Except for scale, it would be impossible to tell if this was not the starting conﬁguration. Hence the bugs will rotate yet another degree, and another, and another . . . 20 The ﬁrst player can always win by ﬁrst placing the penny exactly at the center of the table and thereafter “mirroring” his opponents move with respect to the center point. 21 Label the points where the ball bounces C,C1,C2, . . .. Draw line segment BD1 so that BD1 = BC and ∠CBD1 = β . Now reﬂect the path of the billiard ball inside ∠ABC about the axis BC. Let E1 be the reﬂection of C1. For counting purposes, it doesn’t matter whether we look at the real path CC1C2 . . . or the reﬂected path beginning with CE1, so let us pretend that the billiard ball actually begins its path by traveling from C to E1. Once again, draw line segment BD2 with ∠D1BD2 = β and BD2 = BD1. Again, reﬂect the new path of the ball, starting with E1, and let the reﬂection of C2 be E2. Since ∠CE1D1 = ∠C2E1B = ∠BE1E2, the path CE1E2 must be a straight line. Now we keep repeating the process, constructing line segments BD2, BD3, . . . with ∠DiBDi+1 = β and BDi = BDi+1 and reﬂecting the path, until we have a new path which is a the ray −→ CE1. Each bounce Ci of the original path will cor- respond to the intersection point of the ray with BDi. To count the number of intersections, draw a circle with center B and radius AB. The path that con- cerns us is the line segment CE (once the ray leaves the circle, there will be no more bounces in the original path), where ∠BCE = α. To count the num- ber of intersections with the BDi, we need to ﬁnd ∠CBE. Since BE = BC, ∠BEC = ∠BCE, so ∠CBE = 180 − 2α. Hence the number of intersections is equal to ⌊ (180−2α) β ⌋ + 1. 25 The answer is 1600/3. The temperature function is given by T (x, y, z) = (x + y) 2 + (y − z) 2. Now consider two similar functions: U(x, y, z) = T (y, z, x) and V (x, y, z) = T (z, x, y). In other words, U and V are obtained from T by cyclically permuting the vari- ANSWERS TO 3.1 17 ables. The average values of T,U and V taken over the surface of the sphere will be the same because of symmetry. Let us call this average value A. Then the average value of T +U +V will equal 3A. But T (x, y, z) +U(x, y, z) +V (x, y, z) = (x + y) 2 + (y − z) 2 + (y + z) 2 + (z − x) 2 + (z + x) 2 + (x − y) 2 = 4x2 + 4y2 + 4z 2. However, on the surface of the planet, 4x2 + 4y2 + 4z2 = 4 · 202 = 1600, a con- stant! Hence the average value of T +U +V will be 1600 = 3A. 26 Let f (x) := 1/(1 + tan x) √2 and let g(x) := 1/(1 + cot x) √ 2 Since cot x = tan(π/2 − x), the graphs of the two functions from x = 0 to x = π/2 are just mirror images of one another (reﬂected about x = π/4). Hence ∫ π/2 0 f (x)dx = ∫ π/2 0 g(x)dx. On the other hand, cot x = 1/ tan x, and easy algebra yields f (x) + g(x) = 1. Thus ∫ π/2 0 f (x)dx = 1 2 ∫ π/2 0 [ f (x) + g(x)]dx = π/4. 30a Consult the lovely little book Fifty Challenging Problems in Probability with Solutions by Frederick Mosteller [19]. Only 88 pages long, yet it contains many wonderful insights about probability, a topic sadly neglected in TAA- COPS. 30b (Jim Propp) Number the cards 1 through 52 for convenience, with k de- noting the card that was originally the kth from the top. For 1 ≤ k ≤ 52, let Ak denote the number of selections such that the kth card remains kth from the top. For k ≤ 26, Ak is the number of selection in which cards 1 through k all get selected, so that Ak = (52−k 26−k) . By symmetry, Ak = A53−k for 27 ≤ k ≤ 52, so 52 ∑ k=1 Ak = 2 26 ∑ k=1 ( 52 − k 26 − k ) . The second sum equals (52 27) (see the hockey stick identity, Example 6.2.5 on p. 218). Multiplying by 2 and dividing by (52 26) , we get 52/27. 30c Consider a sequence with n distinct integers. The ith number (i = 2, 3, . . . , n) will get swapped if and only if it it was the smallest of the ﬁrst i elements. The probability of this happening is 1/i. Hence the average number of swaps is just 1 2 + 1 3 + · · · + 1 n . 18 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS 3.2 7 Assume that the values are not all equal. Let a > 0 be the smallest value on the board. There must be a square containing a which is adjacent (WLOG) on the east by a square containing the value b which is strictly greater than a. But then a is equal to the average of 4 numbers, none less than a, one of which is strictly greater than a. This is a contradiction. 10 The coin with smallest diameter cannot be tangent to more than 5 others. 12 Certainly when n is even, it is not true: Just imagine a set of pairs of people standing a few inches apart, with each pair quite far from every other pair. Now, if n is odd, ﬁrst eliminate all pairs as in the above case, where two people end up shooting each other. Since n is odd, some dry people remain. Now consider the person whose nearest neighbor is maximal (there may be ties). This person will stay dry, since the only way that he could get shot is if someone else is as close to him as he is to his nearest neighbor. But that contradicts the fact that for each person, the distances to the others are different. 14 We will show that no palindrome can exist by contradiction. Assume that the concatenation of the numbers from 1 to n was the palindrome P := 1234567891011 · · · 4321. Consider the longest run of consecutive zeros in P; note that this exists, since n is surely greater than 10. There may be several runs of consecutive zeros that are all equally long; pick the last (rightmost) one. Observe that immediately to the left of this string is a single digit, and this digit plus the zeros forms one of the numbers from 1 to n. For concreteness, suppose that the longest string of zeros was 0000. Then the rightmost such string obviously consists of the last digits of one of the numbers from 1 to n, not the middle of one, and doesn’t straddle two (for example, if the number was, say, 400005, then the number 400000 would have appeared to the left of it, contradicting the fact that 0000 is longest string of zeros. Likewise, the number that ends with 0000 had to start with a single digit, for if, say, the number was 7310000 then there would have been the number 7000000 to the left of it. So, let us suppose that the rightmost string of 0000 is the last digits of the number 70000. Then, writing the predecessor and successor numbers, these four zeros are embedded in the string 699997000070001 Assume also, that there is at least one other string of 0000 in P. Since P is a palindrome, the ﬁrst 0000 must be embedded in the string 100070000799996. But that makes no sense, since the ﬁrst time 0000 appears is as the last digits of the number 10000. So the only remaining possibility is that there is only one 0000 string, which by necessity is at the exact center of P and is the last four digits of the number 10000. Writing the predecessor and successor, and letting “|” mark the exact midpoint of P, we must have the following string at the center: · · · 9999100|0010001 · · · But this isn’t symmetrical (9 ̸= 0), achieving our contradiction. ANSWERS TO 3.3 19 15 Consider the shortest path joining 1 with n2, where path means a walk along adjacent squares. The worst case scenario is that the path has length n (if 1 and n2 are at opposite diagonal corners). In any event, the members of the path will be at most n distinct numbers between 1 and n2, inclusive. If their successive differences were all less than or equal to n, that means there are n − 1 successive differences which bridge the gap from 1 to n2. Since n2 − 1 = (n − 1)(n + 1), the largest difference must be at least n + 1. 16 See Section 4.1. 18 This is the Eisenstein irreducibility criterion, which is discussed and proved in most modern algebra texts, for example, [12]. 3.3 11 Suppose that there are n people. The possible “acquaintance numbers” range from 0 to n − 1 inclusive. If no one knows zero people, then we can apply pigeonhole on the n − 1 numbers from 1 to n − 1. If at least one person knows zero people, then the maximal acquaintance number is n − 2, so again pigeonhole will work. 16 Partition the square with 50 rectangles of size 0.02. Pigeonhole places three points in one of these rectangles. (Actually, it is not completely trivial to argue that the area of a triangle placed inside a rectangle is at most half the area of the rectangle. Try to ﬁnd an airtight argument!) 18 Consecutive numbers are relatively prime. 19 Let there be n people. Each person is seated a distance d from there correct place, where 0 < d < n is measured counterclockwise. There are n people, but n − 1 different values of d. Hence at least two people share the same distance d. 20 The crux idea: perfect squares are products of numbers raised to even powers, and even powers occur when two numbers with exponents of the same parity are divided. To understand the idea, let us solve this problem for a spe- ciﬁc case: n = 3. Let the n distinct numbers used be a, b, c, and let the sequence we are examining be u1, u2, . . . , uN, where N ≥ 23 = 8. Now deﬁne the successive products pi := u1u2 · · · ui, for i = 1, 2, . . . , N. Each of these N numbers can be written in the form akbℓcm, where k, ℓ, m are nonnegative integers. We are interested only in the parity of the exponents: there are a total of 23 different possibilities for the parities of the elements of an ordered triple (k, ℓ, m). For example, one possiblility is (even, even, odd), another is (odd,odd, even). Now, if one of the pi is of the form (even, even, even), we are done, for this would be a perfect square. Otherwise, we are using at most 23 − 1 different parity possibilities for N ≥ 23 different pi. Hence 20 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS two of these, say pi and p j, have the same parity values for their exponents. For example, suppose both were (odd, odd, even). Then the quotient (divide the larger by the smaller!) will be a perfect square, since when we divide powers, we subtract exponents, so all three exponents will be even! This method clearly generalizes; the hard part is notation, which also obscures the ideas. 21 Deﬁne f (x, y) = x + y√ 2 and let S = { f (a, b)|a, b, integers with 0 ≤ a, b ≤ m}. Because √ 2 is irrational, S has (m + 1)2 distinct elements, the largest of which is m(1 + √ 2). Divide the interval [0, m(1 + √2)] into m2 + 2m subintervals of length (1 + √ 2)/(m + 2). By the pigeonhole principle, there exist two dis- tinct f (a1, b1) > f (a2, b2) in the same subinterval. Without loss of generality, f (a1, b1) > f (a2, b2) > 0. It is easy to check that a = a1 − a2 and b = b1 − b2 ﬁt the bill. 22 Consider the (n + 1)-member sequence 7, 77, 777, . . .. Upon division by n, there are at most n different remainders, so by pigeonhole, at least two of the members of the sequence have the same remainder. Thus their difference is a multiple of n, and contains only the digits 7 and 0. 24 Let td be the total number of games played at the end of the dth day. The members of the sequence t1,t2, . . . ,t56 are distinct and lie in the range from 1 to 88, inclusive. By the same reasoning as in 3.3.22, there are 23 possible remainders upon division by 23, so by pigeonhole, there are at least ⌈56/23⌉ = 3 members of the sequence that have the same remainder, say ta,tb,tc, with a < b < c. Then tb − ta and tc − tb are both multiples of 23, and they cannot both be equal to 46, since that would make tc ≥ 92, greater than the upper limit of 88. Without loss of generality, suppose that tb − ta = 23. Then she played exactly 23 games during days a + 1 through b. 3.4 18 The geeks agree on a code, used only by the last person in line: “white” means “I see an even number of black hats” and “black” means “I see an odd number of black hats.” The last person in line hence has a 50% probability of surviving, but thereafter, each geek knows the parity of the number of black hats, from their own (invisible) hat onward. Since each geek can see the number of black hats ahead of them, they have full information to to deduce their own hat color. Notice that as we move forward along the line, the geeks have to keep track of which hats are which color to keep adjusting the parity. This method will even work if one of the geeks accidentally says the wrong color and is (noisily) killed. 19 The answer is “No.” Place the frogs on a standard coordinate system, on three of the vertices of the square (0, 0), (0, 1), (1, 1), (1, 0). It is easy to check that jumping does not change the parity of the coordinates. ANSWERS TO 3.4 21 20 We argue inductively, inducting on the number of terms, and, as in Exam- ple 2.3.10, we ﬁnd it useful to prove a somewhat stronger statement. For two terms, the sum is 1 n + 1 n + 1 = 2n + 1 n(n + 1) . The numerator of the right-hand side is certainly odd, and the denominator is even. The parity of numerator and denominator will not change even after reducing to lowest terms. We claim that this parity relationship holds for longer sums. Suppose that the sum of t terms is o/e, where o and e are respectively odd and even. Let the t + 1st term be 1/k. Then the sum of the t + 1 terms will be o e + 1 k = ok + e ek . Now, if k is odd, the numerator of the right-hand side will be odd, and the denominator will be even, and we are done. If k is even, then we can write k = 2ak′, e = 2be′, where k′ and e′ are odd. There are three cases: a < b, a > b, a = b. If a < b, then after dividing the numerator and denominator by 2a, we get the fraction ok′ + 2b−ae′ ek′ , and the numerator is odd and the denominator is even. The other two cases are handled in the same way. Essentially, the denominator ek contains too many powers of two and the numerator cannot match it. Notice that this argument ac- tually proves an even stronger statement: Given any ﬁnite sequence of positive integers, (not necessarily consecutive, not neccessarily distinct), as long as two of them have different parity, then the sum of the reciprocals will reduce to a fraction with odd numerator and even denominator. 22 See 7.2.2. 23 It is easy to verify that if (x, y) is a legal point, then y − x will be a multiple of 11. Since 1999 − 3 is not a multiple of 11, the answer is no. 24 Notice that uv + u + v + 1 = (u + 1)(v + 1), so that u, v are replaced with (u + 1)(v + 1) − 1. Therefore, if the sequence contains the values a1, a2, . . . , an, the quantity (a1 + 1)(a2 + 1)(a3 + 1) · · · (an + 1) is invariant! Hence the ﬁnal number will equal 100! − 1, no matter what the choices are. 25 The three quantities b − c a − b , c − a b − c , a − b c − a are all integers by hypotheses, but their product is 1. Hence either two of them are equal to −1, or all three are equal to 1. In the ﬁrst case, if just one of the 22 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS numbers, say the ﬁrst, is equal to −1, we get b − c = b − a which implies that a = c, contradicting the fact that a, b, c are distinct. In the second case, we get 2a = b + c, 2b = a + c, 2c = a + b which means that each number is the average of the other two. This is impos- sible if the numbers are distinct. (For example, suppose that a < c. Then since b is the average of a and c, we get a < b < c. But c is the average of a and b, forcing a < c < b, a contradiction.) 26 It is easy to verify that if the numbers are x, y, z, the quantity x2 + y2 + z2 is invariant. Since 32 + 42 + 122 ̸= 42 + 62 + 122, the answer is no. 27 At ﬁrst, the chocolate bar is in one single piece. At each turn, the chocolate bar is broken into one more piece. When the game is over, the chocolate bar must be reduced to 48 pieces. Thus, no matter how the game is played, the ﬁrst player wins (since the game will end after 47 turns)! In general, the ﬁrst player wins if mn is even; the second player wins if mn is odd. 28 See the generalization below in 3.4.29, which includes this case. 29 We will prove that the minimum number of moves needed is 2n. Without loss of generality, assume that the top-left square of the chessboard is black and that the chessboard ends up entirely black. First, consider the top boundary of the chessboard. As we move from right to left along this line, the number of color changes that we encounter at ﬁrst is 2n − 1. When we are done, this “color change count” will become zero. It is easy to see that any move will either leave the color change count unchanged, or else reduce it by 1 or 2 (since only the boundaries of the selected subregion can affect the color change count; the interior is inverted which doesn’t change the count). Consequently, the minimum number of moves needed to render the top boundary monochrome will be ⌈(2n − 1)/2⌉ = n. Likewise, at least n moves are required to render the left boundary line monochrome. Thus, the minimum number of moves need to make both of these lines monochrome is n + n minus the number of “overlapping” moves, i.e., the number of moves which invert the colors of a rectangle whose upper-left corner is the upper-left corner of the chessboard. We will show that, without loss of generality, the number of overlapping moves is zero. Since the upper-left corner is black, the number of overlapping moves must be even. Note that moves are commutative; the order doesn’t mat- ter. Consider a sequence of moves which renders the chessboard entirely black, which includes two overlapping moves, the inversion of rectangles R and S. The net effect of these two moves is to leave the rectangle R ∩ S unchanged and to invert the colors in the region R△S. R ∩ S includes the upper-left corner, while R△S can always be partitioned into two rectangles, neither of which include the upper-left corner. Thus we conclude that any sequence of moves which includes an even number of overlapping moves can be replaced by a new sequence with an equal number of total moves, but with no overlapping moves. In other words, without loss of generality, we can assume that there are no overlapping moves. Then the minimal number of moves needed is at least n + n = 2n. ANSWERS TO 3.4 23 Finally, 2n moves is sufﬁcient: select every other vertical column of squares, then every other horizontal column. 30 This is yet another application of the Handshake Lemma (see Example 3.4.7 and p. 121). Let d0, d1, d2, . . . , dn be the number of doors in room i, where we include “outside” as room 0 (having as its doors each of the doors in the house that open to the outside). Then by the same reasoning as in 3.4.7, the sum d0 + d1 + d2 + . . . + dn must be even. By hypothesis, d1, d2, . . . , dn are all even, which forces d0 to be even as well. 31 Let us call any set {x1, x2, . . . , x23} of integers “balanced” if it has the property that no matter which of the xi is chosen for the referee, then one can decompose the remaining 22 numbers into two sets of 11 which have equal sums. Clearly if a set is balanced and we multiply or divide each element by the same number, it will still be balanced. Likewise, if a set is balanced and we add or subtract the same number to each element, it will still be balanced. Now, let us suppose we have a balanced set {x1, x2, . . . , x23} of positive integers. Let S be the sum of the 23 elements. If we pick x1 as referee, then we know that S − x1 must be even, since the remaining 22 elements can be partitioned into two sets with equal integer sums. By the same reasoning, S − x2, S − x3, . . . , S − x23 are all even. Therefore, if the set of integers is balanced, then all the elements x1, x2, . . . , x23 are the same parity (i.e., all are even, or all are odd). Now consider our balanced set {x1, x2, . . . , x23} of positive integers. We wish to show that all elements are equal. Let a be the minimum value of the elements. If we deﬁne bi = xi − a for i = 1, 2, . . . , 23, then the new set {b1, b2, . . . , b23} will also be a balanced set of nonnegative integers. Some of the elements will be zero, and perhaps some are not. We would like to prove that they are all zero. Since some of the elements are zero, and zero is even, then all of the elements must be even. Consequently we can form a new set {c1, c2, . . . , c23}, where ci = bi/2 for i = 1, 2, . . . , 23. But this set also has some zero elements, hence all of its elements are even, hence we can divide them all by 2 and get yet another balanced set of nonnegative integers. We can do this forever! The only integer which one can divide by 2 endlessly and still get an even integer as a result is zero. We conclude that the elements of {b1, b2, . . . , b23} are all zero, i.e., the elements of {x1, x2, . . . , x23} are all equal. 32 (Kiran Kedlaya) The boy’s net travel between the ﬁrst and last rides is 1 + · · · + n − 1 = n(n − 1)/2, since each distance must occur exactly once. If n is odd, this number is divisible by n, which means that the boy ends up where he started at his last ride, no matter what he does. So he misses at least one horse. On the other hand, if n is even, the sum is not divisible by n. It is easy to ﬁnd an algorithm which works in this case (try a few examples). 33 This problem is rather tricky unless we start by considering the 2-dimensional case. A bit of playing around convinces us that 5 is the magic number: If 5 lat- tices points are chosen in the plane (all distinct, of course), then one of the line segments joining two of these points will have a lattice point in the interior. The key ideas are parity and pigeonhole. There are only four distinct parity types 24 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS for lattice points: (odd, odd), (odd, even), (even, odd), and (even, even). Hence among any 5 distinct lattice points, two must be of the same parity type, which means that the midpoint of the line segment joining them is a lattice point! The argument adapts easily to 3-dimensions. 34 This is a nice application of parity and the extreme principle. First, reduce everything modulo 2; i.e., replace each odd number by a 1 and each even by a 0. Since 10 is even, we need not worry about anything but parity. The ﬁrst terms of the sequence then are 0,1,0,1,0,1,1,0, etc. We need to know if the subsequence 1,1,1,1,1 can ever appear. If it does, then it must appear for the ﬁrst time. Suppose that 1,1,1,1,1 is such a subsequence. Then 0 must be the term on the left of it (otherwise it wouldn’t be the ﬁrst!). So now we have 0,1,1,1,1,1 to work with. Since the righmost term is 1, and it is the sum (modulo 2) of the 6 previous terms, the term to the left of the 0 must also be 1. By the same reasoning, the term to the left of this 1 must also be 1, etc. It is not hard to deduce that there must, in fact, be 5 1’s to the left of the 0: we now have 1,1,1,1,1,0,1,1,1,1,1. But this contradicts the fact that the subsequence that we started with was the ﬁrst occurrence of 5 consecutive 1’s (we are using the fact that the sequence does not begin with 5 1’s as well). 35 If the value at C were larger than 1, we would no longer have a monovari- ant, because moves in which a checker landed at C would increase the Conway sum. 39 (Sketch due to Kiran Kedlaya) No matter what the starting sequence, even- tually all terms become 0. Use induction on the maximum absolute value of the terms, which does not increase after the transformation. First we show that after 8 steps, all the terms will be even, using the fact that |x2 − x1| ≡ x2 + x1 (mod 2). (So we can drop the absolute value brackets.) At this point, divide each term by 2, then use the inductive hypothesis. 4.1 8 This is the same as 3.3.11. 9 Recast this as a graph in which the people are vertices and every edge be- tween people are drawn, with an edge colored red if the people are friends, and blue if they are strangers. Then we must ﬁnd a monochromatic triangle. Pick an arbitrary vertex v. Since 5 edges emanate from it, at least 3 must be the same color, say red. Now consider the three vertices a, b, c which are adjacent to v, joined by red edges. If just one of the the edges of the triangle abc is red, we are done, for if, say, ab is red, then the triangle vab is monochromatic. But if none of the edges of abc are red, then abc is monochromatic (all blue edges)! 10 This is a simple generalization of the previous problem. 11 There are two cases, v even or v odd. Suppose that v is even. Then we can write v = 2m, where m is an integer. If the graph is not connected, then it contains at least two connected components, one of which has at most m vertices. Consider an arbitrary vertex in this component. By hypothesis, it has ANSWERS TO 4.1 25 at least (v−1)/2 = m−1/2 neighbors. This means that the component contains at least m + 1 vertices, which is greater than m, a contradiction. The other case is similar. 12 Certainly if the number of edges is less than or equal to (n−1 2 ) , the graph need not be connected, since n − 1 of the vertices can form a complete graph, and the remaining vertex will be isolated. We will show that as long as the number of edges e is greater than (n−1 2 ) , the graph will be connected. While this agrees with our intuition, we need to guard against the possibility that we may be able to take e = (n−1 2 ) + 1 edges and divvy them up to form two (or more connected components). This will not happen if the inequality ( a 2 ) + (b 2 ) ≤ ( a + b − 1 2 ) + 1 is true. This can be established easily by factoring, or by the following graph theoretic argument: Consider two complete graphs, with a and b vertices. If we “glue” them together on an edge, we produce a new graph with a + b − 1 vertices. Count edges: the original conﬁguration had (a 2) + (b 2) edges, while the new conﬁguration has at most (a+b−1 2 ) edges. Since we lost an edge when we glued the two graphs together, we conclude that ( a 2 ) + ( b 2 ) ≤ (a + b − 1 2 ) + 1. 13 As with 3.4.30, we use the handshake lemma. Let each room be a ver- tex, and connect two vertices if the corresponding rooms are connected by a door. Include “outside” as a single vertex (of degree 1). Then if we look at the connected component which contains the outside, the sum of the degrees of the vertices will be even, which means that at least one of the vertices in this connected component has odd degree, i.e., its corresponding room contains a TV set. 22 We argue by induction on n. Clearly, it is true for n = 2. We will show that if it works for an arbitrary n, it will work for n + 1. (It is helpful to just visualize the case n = 2.) The (n + 1)-cube consists of two copies of an n-cube, where we join each vertex of one copy to its corresponding sister. Now we will show that a Hamiltonian cycle is possible for the (n + 1)-cube. Start at vertex a in the ﬁrst n-cube. By the inductive hypothesis, there is a Hamiltonian cycle for this n-cube whose last vertex (before returning to a) is b. Likewise, the second cube has a corresponding Hamiltonian path from a′ to b′. Now consider the path that starts at a, traverses all vertices of the ﬁrst copy ending with vertex b, then travels to the corresponding vertex b′ of the second n-cube, then travels backwards along the Hamiltonian path in the second cube from b′ to a′, and then ﬁnally travels back to the ﬁrst cube’s vertex at a. This is a Hamiltonian cycle of the (n + 1)-cube. 25 By the handshake lemma, this is a graph with 9 vertices and 21 edges. We wish to show that there must be a triangle. Pick the vertex with the largest degree. This degree must be at least 5 (since the sum of the 9 degrees is 42). 26 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS Consider this vertex x plus its ﬁve guaranteed neighbors a, b, c, d, e. If there were no triangle among these 6 vertices, then none of the (5 2) = 10 edges can be drawn connecting any of a, b, c, d, e. Let the three remaining vertices be f , g, h. Of the 8 vertices {a, b, c, d, e, f , g, h}, there are (8 2) − (5 2) = 18 “legal” edges available, which consist of the 3·5 = 15 possible edges connecting each element of { f , g, h} to each element of {a, b, c, d, e}, plus the three edges connecting all the elements of { f , g, h}. Since we need to use 16 edges, we are forced to either create the triangle f gh or have a triangle which includes two elements of { f , g, h} with one from {a, b, c, d, e}. A general theorem that handles this problem, and much more, is Turan’s theorem, which gives the minimum number of edges to force an embedded Kr. Pearls in Graph Theory [11] is an excellent starting reference. 26 There are many possibilities; see the article [26] for many of them. Per- haps the simplest is just to let all corners be vertices and join them with edges if the corners are vertices of a rectangle and an integral distance away. Then a parity-based analysis similar to the Tibet problem (4.1.7) will force a connected graph which includes two corners of the big rectangle. 4.2 We strongly encourage you to read at least the ﬁrst chapter of Tristan Needham’s Visual Complex Analysis [20]. 9a This is an immediate consequence of 4.2.8c: zz = |z|2. 9c See the solution to 4.2.20. 9d Combining 4.2.8e (conjugate of a sum/product is sum/product of conju- gate) with the fact that conjugation leaves real numbers unchanged yields the fact that P(z) = P(z) for any polynomial P with real coefﬁcients. 9f Taking magnitudes of both sides, we have |z − 1|10 = |z|10, so |z − 1| = |z| = |z − 0|, which means that z is equidistant from 0 and 1, i.e., Re z = 1/2. 9g The idea is to use the fact that if z/w is real, then arg z = arg w, i.e., the vectors z and w are parallel. This can be seen by means of a picture very similar to the one used in 4.2.20 below. 12 1. and 2. are consequences of the factor theorem and fundamental theorem of algebra (see page 166), while 3. follows from the fact that the n roots of unity can be thought of as vectors emanating from the origin whose endpoints are symmetrically arranged around the circumference of a unit circle. Their sum must be zero (origin), by symmetry. 20 It is almost obvious once a picture is drawn. ANSWERS TO 4.2 27 O A B C P Let A = eit, B = eis. Then C = eit + eis and OACB is a rhombus. Since BA ⊥ OC and ∠AOB = s − t, it is clear that argC = (s + t)/2 and OC = 2 cos 1 2 (t − s). 21 This follows easily using De Moivre’s theorem (4.2.6) from the fact that x = Cis (a), which is obvious once you draw a picture, or by using 4.2.20. 22 The formulas are, respectively, sin 1 2 (n + 1)a sin na 2 csc a 2 and cos 1 2 (n + 1)a sin na 2 csc a 2 . Both can be computed pretty easily (and simultaneously) by summing the geometric series eai + e2ai + · · · + enai, using 4.2.19, and consider- ing real and imaginary parts. Try it! 23 Let P(z) := z5 + z + 1. If we look at the exponents of P modulo 3, they are, respectively, 2, 1, 0. In other words, modulo 3, P resembles u2 + u + 1. This should make you think about roots of unity, speciﬁcally, cube roots of unity. If we substitute in a cube root of unity ζ = Cis (2π/3), we get P(ζ ) = ζ 5 + ζ + 1 = ζ 3ζ 2 + ζ + 1 = ζ 2 + ζ + 1 = 0, by 4.2.12.3. Likewise, P(ζ 2) = 0. Thus ζ and ζ 2 are zeros of P(z), so by the factor theorem, (z − ζ )(z − ζ 2) is a factor. But (z − ζ )(z − ζ 2) = z 2 + z + 1 by 4.2.12.2. Thus z2 + z + 1 is a factor of P(z). Polynomial long division yields the factorization P(z) = (z 2 + z + 1)(z 3 − z 2 + 1). 24 Using the same methods of 4.2.23 above, we deduce that all four complex 5th roots of unity are roots of the polynomial in question; i.e., z4 +z3 +z2 +z+1 is a factor of z6 + z4 + z3 + z2 + 1. By long division, the other factor is z2 − z + 1, whose roots are easily found with the quadratic formula. 25 Let 1, ζ , ζ 2, ζ 3, . . . , ζ n−1, be the nth roots of unity (so ζ = cos 2π n +i sin 2π n ). If we exclude the root 1, the remaining n − 1 complex numbers are the roots of 28 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS (xn − 1)/(x − 1). In other words, 1 + x + x2 + · · · + xn−1 = (x − ζ )(x − ζ 2)(x − ζ 3) · · · (x − ζ n−1). Letting x = 1, we get n = (1 − ζ )(1 − ζ 2)(1 − ζ 3) · · · (1 − ζ n−1). Now take the absolute value of both sides, and use the fact (Problem 4.2.9c) that |1 − (cos θ + i sin θ )| = 2 sin θ 2 . Putting this all together yields n = 2n−1 sin π n sin 2π n sin 3π n · · · sin (n − 1)π n . 26 The vertices of the n-gon are nth roots of unity 1, ζ , ζ 2, ζ 3, . . . , ζ n−1, which are the n zeros of the polynomial xn − 1. Let us only consider the line segments emanating from the root 1. The product of the lengths of these line segments is |1 − ζ ||1 − ζ 2| · · · |1 − ζ n−1| = |(1 − ζ )(1 − ζ 2) · · · (1 − ζ n−1)|. But recall that xn − 1 = (x − 1)(x − ζ )(x − ζ 2) · · · (x − ζ n−1). Divide this by x − 1,and we get xn−1 + xn−2 + · · · + x2 + x + 1 = (x − ζ )(x − ζ 2) · · · (x − ζ n−1). Now substitute x = 1 and we have n = (1 − ζ )(1 − ζ 2) · · · (1 − ζ n−1), in other words, the product of the lengths emanating from 1 equals n. By sym- metry, the product of the lengths emanating from any vertex will equal n. Since there are n vertices, the product will be nn. However, this includes overcounting by a factor of 2, i.e. we have counted the length from vertex a to vertex b twice in our prouduct. To correct for this, we just take the square root. In other words, the correct answer is √nn. 31 Let us argue by contradiction. Suppose such an equilateral triangle ex- isted. Without loss of generality, one vertex is (0, 0). Let the other vertices be the complex numbers a and b, where a = x + iy and b = u + iv, with x, y, u, v integers. Suppose that b, as a vector emanating from the origin, lies 60 degrees counterclockwise from a. Then the condition for the triangle to be equilateral is merely that b = e πi/6a. Thus u + iv = ( √3/2 + i/2)(x + iy). Comparing real and imaginary parts immediately leads to a contradiction, since√ 3 is irrational: we must have x√ 3/2 − y/2 equal to an integer. ANSWERS TO 4.3 29 32 The vectors u := a − b, v := b − c, w := c − a represent the sides of the triangle. We have v = ζ u, w = ζ 2u, where ζ = e2πi/3. Notice that ζ is a cube root of unity, so ζ 2 + ζ + 1 = 0. Consequently, u 2 + v 2 + w 2 = u 2(1 + ζ + ζ 2) = 0. Substituting back for a, b, c yields a2 + b2 + c2 = ab + bc + ca. 38 This problem can be found in [15] (supplementary algebra problem 1). 4.3 Don’t forget to keep a copy of Herbert Wilf’s wonderful generatingfunctionology [27] close at hand. 8 Write each term (n k)2 as (n k)( n n−k) . Then the sum of these terms as k ranges from 0 to n is the xn term of (x + 1)n(x + 1)n. 9 This is a generalization of the above, known as the Vandermonde Convolu- tion Formula (see 6.2.31 also). All that it is saying is, look at the xk term in the product (x + 1)n+m. If we write (x + 1)n+m = (x + 1)n(x + 1)m, then the identity desired follows immediately from the rules for multiplying two polynomials (see also p. 180). 15a This is a straightforward application of the formula for the sum of geo- metric series (Section 5.3). 15c Let ω := e2πi/3 be a 3rd root of unity. Then (1 + 1) n + (1 + ω) n + (1 + ω 2) n = 2 ∑ r=0 n ∑ j=0 ( n j ) ω r j = n ∑ j=0 ( n j ) 2 ∑ r=0 ω r j = 3∑ 3|n ( n j ) . Using pictures or 4.2.19, we can simplify 1 + ω = Cis (π/3) and 1 + ω 2 = Cis (−π/3), so our answer is 1 3 ( (1 + 1) n + (1 + ω) n + (1 + ω 2) n) = 1 3 (2 n + 2 cos(nπ/3)) . 18 The generating function for partitions that have no part which is a multiple of 3 is A(x) = (1 + x + x2 + x3 + · · ·)(1 + x2 + x4 + · · ·) (1 + x4 + x8 + · · ·)(1 + x5 + x10 + · · ·) = ( 1 1 − x ) ( 1 1 − x2 ) ( 1 1 − x4 ) ( 1 1 − x5 ) · · · . 30 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS The generating function for partitions that have no part repeated more than twice is B(x) = (1 + x + x2)(1 + x2 + x4)(1 + x3 + x6)(1 + x4 + x8) · · · = ( 1 − x3 1 − x ) ( 1 − x6 1 − x2 ) ( 1 − x9 1 − x3 ) ( 1 − x12 1 − x4 ) , where we use the formula for the sum of a geometric series (p. 173) or the fac- torization of a difference of two cubes (5.2.7). Study A(x) and B(x) carefully. Notice that when you cancel the numerators and denominators in B(x), the nu- merator becomes 1, and the denominator loses all terms of the form (1 − xr), where r is a multiple of 3. In otherwords, you get A(x). So A(x) = B(x), and consequently their coefﬁcients (and corresponding partition functions) are equal. 19 The answer is 192. 20 Using the geometric series tool, the function is equal to f (x) := 1 + (x + x2 + x3 + x4 + x5 + x6) + (x + x2 + x3 + x4 + x5 + x6) 2 + · · · Examine the term (x + x2 + x3 + x4 + x5 + x6)r. The coefﬁcient of xk will equal the number of ways that k can be represented as a sum of r values, each taken from the set {1, 2, 3, 4, 5, 6}. So our function is the generating function for dice sums: the coefﬁcient of xk of f (x) is the number of ways that k can be represented as a sum of dice. 21 By the same reasoning used in 4.3.20 above, the function f (x) := (x + x2 + x3 + x4 + x5 + x6) 2 = x2 + 2x3 + 3x4 + · · · + 2x11 + x12 is the generating function for rolling two dice: the coefﬁcient of xk is the number of ways that you can get a sum of k by rolling two dice. The probabilities are merely the coefﬁcients divided by 36. So our problem amounts to asking whether there is a non-trivial factoriza- tion of f (x) that is not the square of (x + x2 + x3 + x4 + x5 + x6), which also has the proper behavior: no nonnegative coefﬁcients, coefﬁcients sum to 6. We have x + x2 + x3 + x4 + x5 + x6 = x ( x6 − 1 x − 1 ) = x(x3 − 1)(x3 + 1) x − 1 = x(x2 + x + 1)(x3 + 1) = x(x2 + x + 1)(x + 1)(x2 − x + 1). Thus f (x) = x2(x2 + x + 1) 2(x + 1) 2(x2 − x + 1) 2. Some trial and error (using the useful fact that the sum of the coefﬁcients of a polynomial can be computed by plugging in x = 1) yields the factorization f (x) = [x(x + 1)(x2 + x + 1)][x(x + 1)(x2 + x + 1)(x2 − x + 1) 2]. ANSWERS TO 5.1 31 The ﬁrst factor simpliﬁes to x4 + 2x3 + 2x2 + x, and the second factor is x8 + x6 + x5 + x4 + x3 + x. Thus the two dice are labeled respectively {4, 3, 3, 2, 2, 1} and {8, 6, 5, 4, 3, 1}. 22 Here’s a sketch of a solution for N = 8. Let the checkers be denoted by zeros (white) or ones (black) with an initial sequence a0, a1, . . . , a7. Deﬁne A(x) := a0 + a1x + a2x2 + · · · + a7x7 and consider the doubly inﬁnite generating function f (x) := · · · + A(x) x16 + A(x) x8 + A(x) + A(x)x8 + A(x)x16 + · · · . (If you are worried about convergence issues, you don’t need to make this in- ﬁnite in either direction. We need both positive and negative powers in order to simulate the circular nature of the problem, but we will only focus on the terms with exponents from 0 to 7.) Observe that if we view this as a function with coefﬁcients in base 2 (binary), then the coefﬁcients with exponents 0 to 7 in (1 + x) f (x) are the checker values after one move! This is the crux idea, so make sure you understand it! Hence after 8 moves, we get (1 + x)8 f (x). But in base 2, (1 + x) 8 = 1 + x8, so we have (1 + x8) f (x). But now the exponent 0 to 7 terms are just A(x) + A(x) = 0 in base 2! 5.1 1a Yes; n 7→ n + 1 works. So does n 7→ n + 1999, etc. 1b Yes; one example is n 7→ 2n + 1. 4a There are many other approaches (one idea: use the density concept de- ﬁned in 8.2.12). Here is one method that is easily seen by an example. Let a = 23/99, b = 37/151. We will ﬁnd an irrational number x that lies between them. First, square a and b. We have a2 = 0.0539 . . . and b2 = 0.06004 . . .. Since 104 is a perfect square, the number u := 550/104 = 0.0550 lies between a2 and b2, and moreover, x := √ u = √ 550/102. Since 550 is not a perfect square, x is irrational, and lies between a and b. 4b Let x and y be irrational numbers. Clearly, one can write them as inﬁnite decimals and ﬁnd a ﬁnite (terminating) decimal between them. For example, if x = 5.6708903 . . . and y = 5.670931 . . ., just pick r = 5.67091. 5 Each function can be thought of as an m-tuple of values, where each value has n possibilities. By the basic counting principles of Section 6.1, the number of m-tuples will be nm. 32 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS 10 This problem is deceptively hard, because it requires subtle inequalities plus a number-theory idea. Let a := √ n + √ n + 1. Then a 2 = (√ n + √ n + 1 )2 = 2n + 1 + 2 √n2 + n. Now (n + 1)2 = n2 + 2n + 1 implies that n < √n2 + n < n + 1, which means that 2n < 2√ n2 + n < 2n + 2. But we can reﬁne this further. Observe that ( n + 1 2 )2 = n2 + n + 1 4 , which means that n < √ n2 + n < n + 1 2 and consequently a 2 = 2n + 1 + 2 √ n2 + n < 2n + 1 + 2 ( n + 1 2 ) = 4n + 1 + θ , where 0 < θ < 1. Thus a = √ 4n + 1 + θ , which means that ⌊a⌋ = ⌊√ 4n + 1 ⌋ . But we wish to show that a = ⌊√ 4n + 2 ⌋. Simple number theory ideas (see Section 7.2) show that perfect squares are always of the form 4k or 4k + 1, so√4n + 2 is never an integer, but always shares its integer part with √ 4n + 1. In other words, ⌊√ 4n + 1 ⌋ = ⌊√ 4n + 2 ⌋ , and we are done. 12 (Sketch) Let tk := 1 + 2 + · · · + k. Thus t1 = 1,t2 = 3,t3 = 6,t4 = 10, etc. If an is the nth term of the indicated sequence, then an = r, where tr−1 +1 ≤ n < tr. Using the Gaussian pairing tool, tr = r(r + 1)/2. Thus r(r − 1) ≤ 2n ≤ (r + 1)r. At the boundaries, we will have the two quadratic equations r2 − r + 1 = 2n and r2 + r = 2n. By the quadratic formula, we have −1 + √ 8n + 1 2 ≤ r ≤ 1 + √ 8n − 7 2 . ANSWERS TO 5.2 33 These two boundary points are less than one apart, consequently r = ⌊ 1 + √ 8n − 7 2 ⌋ . 13 This problem appeared in the 1995 Hungarian Olympiad and also the 1968 IMO. There are many ways to solve it. One method is induction. Another is to look at the base-2 representation of n. A third method, due to Kiran Kedlaya, uses the easily veriﬁable identity ⌊x + 1 2 ⌋ = ⌊2x⌋ − ⌊x⌋ which converts the problem into a telescoping sum (see section 5.3). 5.2 25a Factoring, we have (x − y)(x + y) = 20. Since x, y are integers, the only possibilities are (notice that x − y < x + y) x − y = 1, x + y = 20, x − y = 2, x + y = 10, x − y = 4, x + y = 5. Only the second system yields integer values; namely x = 6, y = 4. 25b The left-hand side contains the ﬁrst 3 terms of (x + 3)(y + 5). Conse- quently, the equation can be rewritten as (x + 3)(y + 5) = 215. Now we proceed as in 5.2.25a; the only solution is x = 2, y = 38. 26 Consider the expression S := (a2 + c2 − 1) 2 + (b2 + d2 − 1) 2 + (ab + cd) 2. If we can show that this equals zero, we will be done. Rather than expand blindly, let’s think about what will help us: the given three equations, which can also be written as (a2 + b 2 − 1) 2 = (c 2 + d2 − 1) 2 = (ac + bd) 2 = 0. Now it is easy to check: when expanding the terms of S, we certainly get all the required 4th-degree terms, and we can rearrange the four terms of the form −2a2 to suit our purposes, and likewise get all six terms of the form a2b2. Writing it out in detail almost obscures this analysis! 28 Let S := xy + yz + xz. Using 5.2.10, we have 1 + 2S = (x + y + z) 2 ≥ 0. Thus S ≥ −1/2. This minimum value is attained for any values of x, y, z that satisfy x + y + z = 0 and x2 + y2 + z2 = 1; for example x = 1/ √ 6, y = 1/ √ 6, z = −2/√ 6. 34 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS 30 Messing around with 5.2.10 leads to the following factorization of the left- hand side: n4 + 2n 3 + 2n 2 + 2n + 1 = (n2 + n + 1) 2 − n2 = (n2 + n + 1 − n)(n2 + n + n + 1) = (n2 + 1)(n 2 + 2n + 1) = (n2 + 1)(n + 1) 2. This quantity is equal to the perfect square m2, which forces n2 + 1 to be a perfect square. This can only happen if n = 0: the only solution is n = 0, m = 1. 32 Notice that an n-digit number consisting only of the digit d is equal to d(10n −1)/9; this is easy to see using the formula for the sum of a geometric se- ries (Section 5.3) or just observing that the n-digit number 11 · · · 1 = 99 · · · 9/9. The nth term in the sequence will then be 4 · 10 n ( 10n − 1 9 ) + 8 ( 10n − 1 9 ) + 1 = 4 · 102n + 4 · 10n + 1 9 = ( 2 · 10n + 1 3 )2 . Notice that (2 · 10n + 1)/3 is an integer, since the numerator is a number whose digits sum to 3 (see 7.2.2). 33 n4 − 20n2 + 4 = (n4 − 4n2 + 4) − 16n2 = (n2 − 2)2 − (4n)2 = (n2 − 4n − 2)(n2 + 4n − 2). 34 Use the factorization of x3 + y3 + z3 − 3xyz developed in Example 3.1.12. The only quantity needed that isn’t explicitly given is xy + yz + xz, but this is just [(x + y + z)2 − (x2 + y2 + z2)]/2. The answer is −112. 35 Denote the ﬁrst two expressions in parentheses by A and B, respectively. Then the equation becomes A 3 + B3 = (A + B) 3, which quickly reduces to AB(A + B) = 0, i.e., A = 0 or B = 0 or A + B = 0 are the solutions. This leads to x = ±3/4, ±4/3, ±1. 36 Factoring, we get (x − y)(x2 + xy + y2) = 7 · 103. So either x − y = 1 and x2 + xy + y2 = 721 or x − y = 7 and x2 + xy + y2 = 103. Solving each system yields the two solutions (16, 15) and (9, 2). 37 Cubing a trinomial is too hard! Try isolating x + y, and then the right-hand side becomes (using 5.2.4) ([x + y] + z) 3 = (x + y) 3 + z 3 + 3(x + y)z(x + y + z). Let S := x + y + z, and our equation becomes x3 + y3 + z 3 = (x + y) 3 + z 3 + 3(x + y)zS. Subtracting z3 factoring yields x3 + y3 = (x + y) 3 + 3(x + y)zS. ANSWERS TO 5.3 35 The left-hand side factors (5.2.8) into (x + y)(x2 − xy + y2), hence we can sub- tract the left-hand side from the right-hand side and factor as follows: (x + y){(x + y) 2 + 3zS − (x2 − xy + y 2)} = 0. The expression in the brackets simpliﬁes to 3zS + 3xy = 3(xz + yz + z 2 + xy) = 3(x + z)(y + z). Hence we have 3(x + y)(y + z)(x + z) = 0, so the solutions are all (x, y, z) where at least one pair of the variables are nega- tives of one another; for example, (17, −17, 675), or (48, 201, −201). Notice the nifty factorization (x + y + z) 3 − (x3 + y 3 + z 3) = 3(x + y)(x + z)(y + z). We can deduce this another way using the important deﬁne a function tool (p. 98). Deﬁne the polynomial P(x) := (x + y + z)3 − (x3 + y3 + z3), where y and z are constants. We have P(−y) = P(−z) = 0, which implies by the factor theorem (Section 5.4) that P(x) has the factors (x + y) and (x + z). By symmetry (i.e., deﬁne a polynomial in y instead) we deduce that (y + z) is also a factor. Hence (x + y + z) 3 − (x3 + y 3 + z 3) = K(x + y)(x + z)(y + z), where K is a constant that can be computed by plugging in values such as x = 0. We quickly see that K = −3. 5.3 7 Consider the more general arithmetic-geometric series S = a + (a + d)r + (a + 2d)r2 + · · · + (a + nd)rn. Employing the telescope method again, we compute rS − S = −(a + dr + dr2 + · · · + drn) + (a + nd)rn+1. Most of the above is now just a geometric series, so we have S(r − 1) = −a − dr ( rn − 1 r − 1 ) + (a + nd)rn+1 and S is just this quantity divided by r − 1 (no point in simplifying it, or remem- bering it, for that matter). 9 Experimentation (and analogy from calculus) leads to the guess that the sum is n(n + 1)(n + 2)(n + 3)/4, which is easily veriﬁed with induction. The generalization is clear: for a series whose terms are products of m consecutive numbers, starting with 1 · 2 · 3 · · · m and ending with n(n + 1) · · · (n + m − 1), the sum is n(n + 1) · · · (n + m − 1)(n + m) m + 1 . 36 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS 13 Each term in the sum is k · k! = (k + 1)k! − k! = (k + 1)! − k!. Hence the sum telescopes to (n + 1)! − 1. 14 Likewise, k (k + 1)! = (k + 1) − 1 (k + 1)! = 1 k! − 1 (k + 1)! . The entire sum telescopes to 1 − 1/(n + 1)! 15 Call the product P. Multiply by the catalyst sin θ , employing the formula sin α cos α = sin 2α: sin θ P = 1 2 sin 2θ n ∏ k=1 cos ( 2 kθ ) = 1 4 sin 4θ n ∏ k=2 cos ( 2 kθ ) = 1 8 sin 8θ n ∏ k=3 cos ( 2 kθ ) ... = 1 2n sin (2 nθ ) cos (2 nθ ) = 1 2n+1 sin ( 2 n+1θ ) . Hence P = sin ( 2n+1θ ) 2n+1 sin θ . 19 The problem is easier to work with, believe it or not, if we generalize, replacing 1, 2, . . . , 2n−1 with arbitrary a1, a2, . . . , an. Then (try an example or two) is is easy to conjecture that the sum is 1/(a1a2 · · · an). And this is not hard to prove with induction; the only difﬁculty is notation. Here is an example of how to go from n = 2 to n = 3: For n = 2, the assertion is the easy identity 1 a 1 a + b + 1 b 1 b + a = 1 ab . For n = 3 we want to show that the sum of the six terms of the form 1 a 1 a + b 1 a + b + c , where we permute the order of the three variables, is equal to 1/abc. But this sum factors into 1 a + b + c ( 1 a 1 a + b + 1 b 1 a + b + 1 b 1 b + c + 1 c 1 b + c + 1 a 1 a + c + 1 c 1 a + c ) . The inductive hypothesis simpliﬁes this to 1 a + b + c ( 1 ab + 1 bc + 1 ac ) , ANSWERS TO 5.4 37 which easily simpliﬁes to 1/abc. 20 From the bug’s point of view, after time 0 it walks 1/3 of the band’s length. After time 1 minute, it walks 1/4 of the band’s length, after time 2 minutes, it walks 1/5 of the band’s length, etc. So we want to know whether the sum 1/3 + 1/4 + 1/5 + 1/6 + . . . will exceed 1. It will, since the harmonic series diverges. So the bug will reach the wall (in just a few minutes). 21 The sum converges. Here is a crude estimate: For each positive integer k, there are 9k elements of S that have k digits. Each of these elements is greater than 10k−1 and less than 10k. The sum of the reciprocals of these elements is bounded above by 9k/10k−1. We can evaluate the inﬁnite geometric series ∞ ∑ k=1 9k 10k−1 = 9 1 − 9/10 = 90, so the sum in question is smaller than 90 (much smaller, since our estimate was so crude). Note how the crude estimate made the sums so easy to compute! 24 See chapter 2 of [9] for a nice discussion of this and much more. 5.4 9 Let P(x) := x81 + x49 + x25 + x9 + x. By the division algorithm, we have P(x) = Q(x)(x3 − x) + ax2 + bx + c, where Q(x) is a polynomial and a, b, c are constants to be determined. Since x3 − x = x(x − 1)(x + 1), we can plug in x = 0, 1, −1 into the previous equa- tion, yielding three equations in three unknowns (notice that P(0) = 0, P(1) = 5, P(−1) = −5): 0 = c, 5 = a + b + c, −5 = a − b + c, and we have a = 0, b = 5, c = 0. Hence the remainder is 5x. 12 Let x = √ 2 + √ 5. Squaring yields x2 = 7 + 2 √ 10, so x2 − 7 = 2 √ 10. Squaring again, we get x4 − 14x2 + 49 = 40, so x4 − 14x2 + 9 is the desired polynomial. 13 See Example 7.1.7. 14 Deﬁne q(x) := p(x) − 1999. The zeros of q include 0, 1, so the factor theorem implies that p(x) − 1999 = x(x − 1)r(x), where r(x) is a polynomial with integer coefﬁcients. Let u be an integer zero of p(x). Plugging in x = u, we get −1999 = u(u − 1)r(u). 38 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS But 1999 is prime, so −1999 cannot be a product of several integers, two of which are consecutive! That’s our contradiction; we conclude that p(x) has no integer zeros. 15 We will argue by contradiction. Suppose that p(x) = u(x)v(x). Then one of these factors, say u(x) has degree 999 or less. If p(xi) = ±1 for the 1999 different integers x1, x2, . . . , x1999, this forces u(xi) = ±1 as well. But then for at least 1000 of these xi, we must have u(xi) equaling only one value, say −1. By the identity principle (5.4.7), this forces u(x) to be the constant polynomial −1, contradicting the fact that it is a non-trivial polynomial. 18 (Sketch): By looking at constant and linear polynomials, we conjecture that if the degree of p(x) is n, then we need n + 1 consecutive integer values of x. We can easily prove this by induction. Notice that if p(k) is an integer for all integral k, then p(0), which equals its constant term, must be an integer. If we deﬁne q(x) := p(x + 1) − p(x), then q has degree one less than that of p(x), and we can recover all values of p from those of q, as long as we know p(0). 19 Hint: think about the Eisenstein irreducibility criterion (3.2.18). 21 Let Q(x) := P(x) − 5. Then we have Q(x) = (x − a)(x − b)(x − c)(x − d)R(x), where R(x) is a polynomial with integer coefﬁcients. If P(k) = 8, we must have (k − a)(k − b)(k − c)(k − d)R(k) = 3. There is no way that 3 can be written as a product of 4 (or 5) distinct integers. 23 If a polynomial has real coefﬁcients, its non-real roots come in complex conjugate pairs. Conversely, if a polynomial factors into terms of the form (x − r), where r is real, and pairs of factors of the form (x − z)(x − z), where z is complex, then the polynomial will have real coefﬁcients. With these ideas, we will show how to solve the problem with a simpler example. Let P(x) be a quadratic with real coefﬁcients and complex roots z, z. We will ﬁnd a polyno- mial Q(x) with real coefﬁcients such that the degree of all terms of Q(x)P(x) is a multiple of 3. Consider the polynomial R(x) := (x3 − z 3)(x3 − z 3). By the remarks above, it has real coefﬁcients, and the degree of all terms is a multiple of 3. Furthermore, x3 − z3 x − z = (x − ζ z)(x − ζ 2z), where ζ = Cis (2π/3) is a complex cube root of unity. Notice that ζ 2 = ζ . Consequently, Q(x) := R(x) P(x) = (x − ζ z)(x − ζ 2z)(x − ζ z)(x − ζ 2z) will have real coefﬁcients, since ζ z = ζ 2z, ζ 2z = ζ z. ANSWERS TO 5.5 39 This method certainly generalizes. If we want multiples of 109, we just deﬁne R(x) := (x109 − z109)(x109 − z109), and Q(x) := R(x)/P(x) (Verify that the zeros will pair off into conjugate pairs!) 5.5 13 Since 1999!(2000) = (1999!)!(1999), and 1999! is much larger than 2000, then 1999!(2000) is much much larger than 2000!(1999). 14 The function f (x) := (x + 1)/(10x + 1) is monotonically decreasing, with a limiting value of 1/10 as x approaches +∞. (This can be veriﬁed by looking at the derivative, or using the “?” technique of Example 5.5.9). Consequently, f (101999) < f (101998). 15 10002000 > 2000!. 16 Your instinct should tell you that 19991999 is larger than 20001998, since the former number involves more exponentiation yet its base is virtually the same as the latter number. Upon division, comparing the two numbers boils down to comparing 1999 with (2000/1999)1998. This latter number is not very big, for it is bounded above by e = 2.71828 . . .. This is true because limx→∞(1+ 1/x)x = e, approaching the limit from below. While this may or may not be a familiar idea to you from calculus, here is a sketch of a low-tech way to verify the inequality: use the binomial theorem to evaluate (1 + 1/n)n: We have ( 1 + 1 n )n = 1 + n n + 1 n2 ( n 2 ) + 1 n3 ( n 3 ) + · · · . Since ( n r ) < nr r! , we have 1 nr ( n r ) < 1 r! , and consequently the binomial theorem sum above is less than 1 + 1 + 1 2! + 1 3! + · · · , and this can in turn can be bounded above using a crude estimate with an inﬁnite geometric series: 1 + 1 + 1 2! + 1 3! + · · · < 1 + 1 + 1 2 + 1 4 + 1 8 + · · · = 3. 24 See 5.5.16 above. 40 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS 27 The crux move is to rationalize the numerator. We have √ a + 1 − √ a = (a + 1) − a √a + 1 + √ a = 1 √a + 1 + √ a . This value is very very close, for large a, to 1/2 √ a, so in our case the answer is n = 2000. 28 Use Gaussian pairing and AM-GM. 31 The nasty thing here are the square roots, so let us square the alleged in- equality, leading to a potentially nicer one: 1 4n ≤ 1 2 · 1 2 · 3 4 · 3 4 · · · 2n − 1 2n · 2n − 1 2n ≤ 1 2n . Call the product above P. Now we can employ the massage-telescope tool on P, by altering half of the terms: In one direction, we have P < 1 2 · 2 3 · 3 4 · 4 5 · · · 2n − 1 2n · 2n 2n = 1 2n , and in the other direction (we leave the ﬁrst two terms alone) we have P > 1 2 · 1 2 · 2 3 · 3 4 · 4 5 · 5 6 · · · 2n − 2 2n − 1 · 2n − 1 2n = 1 4n . 33 Consider the equation xa = ax, where a > 1 is ﬁxed. Obviously one so- lution is x = a. However, an examination of the graphs of y = xa and y = ax indicates that there will be a second, larger solution. Taking logarithms (base to be determined later), we get a log x = x log a, or x a = log x log a . The symmetri- cal nature of this equation suggests that we reduce to one variable by setting r = x/a. This yields r = log r + log a log a . If we choose base r for our logarithms, this equation reduces to r log a = 1 + log a, so log a = 1 r − 1 . Thus a = r 1 r−1 . In other words, if a = r 1 r−1 , where r > 1, the two solutions to xa = ax are x = a and x = ra = r · r 1 r−1 = r r r−1 . 34 Recast the problem geometrically. Note that √ a2 + b2 is the length of the vector that starts at the origin ending at the point (a, b). Thus we can interpret the sum √a2 1 + b2 1 + √ a2 2 + b2 2 + · · · + √a2 n + b2 n as the total length of n vectors. If we arrange these vectors end-to-end then this sum is the length of a piecewise linear path. Since the shortest distance between two points is a straight line, the total length is at least as big as the straight-line path from the start (0, 0) to the ﬁnish (a1 + a2 + · · · + an, b1 + b2 + · · · + bn). But this is equal to √ (a1 + a2 + · · · + an)2 + (b1 + b2 + · · · + bn)2. ANSWERS TO 5.5 41 38 Apply Cauchy-Schwarz to the two sequences a1, a2, . . . , an and 1, 1, . . . , 1. We get (a1 · 1 + a2 · 1 + · · · + an · 1) 2 ≤ n ∑ i=1 a 2 i n ∑ i=1 12. This reduces to 1 ≤ n n ∑ i=1 a 2 i . 40 Apply Cauchy-Schwarz to the two sequences √ a, √ b, √ c and 1, 1, 1. 41 Apply Cauchy-Schwarz to the two sequences √ a, √ b and 1/ √ a, 1/√ b, which yields ( √a 1 √ a + √ b 1 √ b )2 ≤ (a + b) ( 1 a + 1 b ) , in other words, 1 a + 1 b ≥ 4 a + b . Now this inequality can be applied twice more: 1 a + 1 b + 4 c ≥ 4 a + b + 4 c ≥ 16 a + b + c , and 1 a + 1 b + 4 c + 16 d ≥ 16 a + b + c + 16 d ≥ 64 a + b + c + d . Incidentally, the key inequality used (worth remembering) is that for posi- tive a1, a2, . . . , an, ( n ∑ i=1 ai ) ( n ∑ i=1 1 ai ) ≥ n 2. 42 Use the relationship between zeros and coefﬁcients (pp. 168–9) and the fact that a sum of squares of real numbers must be nonnegative. 43 Applying Cauchy-Schwarz to the sequences x, y, z and 1, 1, 1 yields the inequality 3(x2 + y 2 + z 2) ≥ x + y + z, which is true for all real x, y, z. Next, apply AM-GM with the hypothesis that xyz = 1 (since x, y, z ≥ 0 , AM-GM can be used) and we get x2 + y2 + z 2 ≥ x + y + z 3 ≥ 3√ xyz = 1. 47 Just apply AM-GM; the product of the n fractions is 1, so their arithmetic mean is at least 1, hence their sum is at least n. 42 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS 48 Study the proof of Chebyshev’s inequality and develop an algorithmic ar- gument: Start with the sum ∑ aibi, and show that any permutation of just two members of b1, b2, . . . , bn will reduce the sum. Since any permutation can be achieved by ﬁnitely many “swaps” of two elements, you are done. 6.1 20a Consider n boys and n girls. Choosing two people from this set of 2n can be broken into the three mutually exclusive cases of either picking only two girls (in (n 2) ways) or only two boys (in (n 2) ways) or picking one boy and one girl (in n2 ways). Notice that the case of picking one girl and one boy is redundant; the order of pick is immaterial. 22a Plug x = 1 into the expansion for (x + 1)n. 22b Plug x = −1 into the expansion for (x + 1)n. 24a See Section 6.2. 24b This is pretty hard, requiring at least an intuitive undestanding of PIE (see pp. 226–229). 25 There are 100 perfect cubes and 1000 perfect squares under a million, hence at most 100 · 1000 = 100000 distinct sums (perhaps less, if there is over- lap. Since there are 900000 numbers left over, the numbers not representable as a sum of a cube and a square are in the majority. 27a 17! 27b Either boys go ﬁrst, or girls. So there are two cases, each with 8!9! arrangements, so the answer is 2 · 8!9!. 27c The arrangement must be girl-boy-. . . -girl, so answer is 8!9! 28a 10! 28b Arrange the kids in some ﬁxed order, such as height. Pick the ﬁrst per- son in the line, pair them up with someone. Then go down the line, pairing up the ﬁrst person in the line with someone chosen from among the unpaired population. The answer is 19 · 17 · 15 · · · 1. Alternatively, take the answer in (c) below, and divide by 10! to ﬁx the overcounting, since honeymoons are indistinguishable in (b). 28c Assign each honeymoon location a letter a, b, c,. . . , j. Line up the 20 people in some order. Now assign the honeymoon letters to the people. This is equivalent to creating a word with 20 letters, consisiting of 2 a’s, 2 b’s, etc. So by the Mississippi formula, the answer is 20!/210. 29 (x1 + x2 + · · · + xn)r consists of the sum of all terms of the form r! a1!a2! · · · an! xa1 1 xa2 2 · · · xan n , where the ai range over all nonnegative values that sum to r. ANSWERS TO 6.2 43 6.2 8 Here is one nice method. There are other solutions. 1. First, Pat and Sal establish a “lexigraphic” (dictionary) order for the cards in a deck. For example, the cards can be ordered A♣, 2♣, . . . , K♣, A♦, . . . , K♦, A♥, . . . , K♥, A♠, . . . , K♠. 2. Within each suit, cards are ordered from 1 to 13. Given two cards of the same suit, place them on a 13-hour clock. Notice that the no matter what the two cards are, one is at most 6 clockwise units away from the other. For example, the clockwise distance between 4♣ and K♣ is 4, since you can travel 4 units clockwise from 13 to get to 4. 3. Next, Pat looks at the ﬁve cards. By the pigeonhole principle, there are at least two cards that are of the same suit. Pat choses one of these and puts it back in the deck and puts the other card on the top of the pile. Pat also computes the clockwise distance from this card to the “hidden” card. For example, suppose the ﬁve cards chosen are 3♣, J♥, 10♦, Q♣, A♠. Pat puts the 3♣ back into the deck and puts the Q♣ on the top of the pile, and notes that the distance from Q♣ to 3♣ is 4 (since Q = 12 and 12 + 4 ≡ 3 (mod 13)). 4. Now all Pat needs to do in encode a number between 1 and 6 with the re- maining three cards in the pile. This can be done by agreeing in advance which of the 3! = 6 lexigraphic permutations refers to which number be- tween 1 and 6. For example, if we order permutations “alphabetically” like so: (a, b, c), (a, c, b), (b, a, c), (b, c, a), (c, a, b), (c, b, a), Then we would encode “4” by placing the bottom three cards in the lex- igraphic order (b, c, a). In our example, the three remaining cards are J♥, 10♦ and A♠ and their lexigraphic order is 10♦ < J♥ < A♠. Hence the (b, c, a) ordering would correspond to J♥, A♠, 10♦. 5. So the ﬁnal ordering (from top to bottom) for our example would be Q♣, J♥, A♠, 10♦. 9 Each person has four possible fates: no treat, only cookie, only ice cream, both treats. Thus there are 48 possible scenarios. But we must exclude the impossible scenarios—no one getting anything, and no one getting both treats. The ﬁrst of these happens in just one way, and the second happens in 38 ways. But notice that the second scenario includes the ﬁrst. So our answer is 48 − 38. 10 The answer is 229. Notice that the sum of all the elements of the set S = {1, 2, 3, . . . , 30} is 1 + 2 + 3 + · · · + 30 = 30 · 31/2 = 465. Let A be a subset of S and let Ac denote the complement of A The sum of the elements of A plus the 44 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS sum of the elements of Ac must equal 465. Because 465 = 232 + 233, if the sum of the elements of a A is greater than 232, the sum of the elements of Ac must be less than 232. In other words, there is a one-to-one correspondence between subsets whose element sum is greater than 232 and subsets whose element sum is not (namely, A ↔ Ac). Hence the number of subsets whose element sum is greater than 232 is exactly half of the total number of subsets of S, and the number of subsets of S is 230. 11 There is a one-to-one correspondence between strictly increasing sequences starting with 1 and ending with 1000 and subsets of the set {2, 3, . . . , 999}. So there are 2998 such sequences. 13 We will combine an encoding idea with an induction argument. Let n be odd, and let A be a subset of an n-element set S. Then |A| and |A| have op- posite parity. Hence there is a one-to-one correspondence between the subsets of S with an odd number of elements and the subsets with an even number of elements. Hence there are an equal number of both kinds. This argument won’t work is n is even, though. But now let us move induc- tively from n to n + 1, where n is still odd. So consider adding a new element x to the set S. The subsets of this new set T := {x} ∪ S fall into two classes: subsets containing x, and subsets which do not. The subsets of T which have an odd number of elements are either subsets of S with an odd number of ele- ments, or subsets of S with an even number of elements with x added in. Thus the number of subsets of T which have an odd number of elements is equal to the number of subsets of S. And of course, the argument is the same for subsets with an even number. 16 Of course we assume that r, w ≥ n. First, place one red and one white ball in all n boxes. We are left with r − n red balls, which can be freely placed in(n+r−n−1 r−n ) = (r−1 n−1) . Likewise, the white balls can be freely placed in (w−1 n−1) ways. The answer is the product (r−1 n−1)(w−1 n−1) . 17 First of all, there are (12 4 ) possible arrangements, which we assume are all equally likely. It is easiest to now compute the complement: how many arrangements do not allow the SUV to park? Let e, c respectively denote an empty space and a compact car. Then we must start by surrounding each empty space with compact cars as follows: ececece. We still have 5 c’s to distribute. The locations where they may be placed are: before the ﬁrst e, after the ﬁnal e, and between consecutive e’s, a total of 5 possible slots. This is just a ball and box problem; there are (5+5−1 5 ) = (9 5) possible ways. So the probability is 1 − (9 5) / (12 4 ) . 19 It is easy come up with the conjecture of 2n−1 which certainly suggests some kind of simple binary coding. Imagine the number n represented by n dots in a row. Beginning with the space between the ﬁrst two dots, either write a plus sign, or not. Do the same with the other spaces between dots. There are n − 1 such spaces, so there are 2n−1 ways of writing the plus signs, and each way corresponds uniquely to an ordered partition of n. 21 In this case, the only distinguishable thing is the ration of biscuits; for ex- ANSWERS TO 6.3 45 ample, “one dog gets all 8 biscuits” is different from “one dog gets 5 biscuits and 3 other dogs get one biscuit apiece.” Hence the answer is the number of unordered partitions of 8, which is 22. See Problem 4.3.17 for a generating- functionological interpretation. 22 As discussed in Problem 6.1.27, each distinct term is of the form 1999! a!b!c! xaybc z, where a, b, c are nonnegative and sum to 1999. Following Example 6.2.7, we have a ball and box problem whose answer is (1999+3−1 1999 ) . 23 This is just like 6.2.7, except now we must ﬁrst place a ball in each box, leaving n − 3 balls to freely distribute among the 3 boxes. 24 This is a modiﬁcation of a 1993 AIME problem. The crux idea: each element is either in the ﬁrst subset, the second, or both. Hence there are 3 choices for each element. And there is overcounting to eliminate. 28 Each intersection point is determined by four points: the endpoints of the two chords which are intersecting. Every different choice of four points yields a different intersection point. So we have a one-to-one correspondence, and the answer is (n 4) . 31 Let’s verify it for the case k = 6, n = 11, m = 107. The formula then states that 6 ∑ j=0 ( 11 j )( 107 6 − j ) = ( 11 0 )( 107 6 ) + ( 11 1 )( 107 5 ) + ( 11 2 )(107 4 ) + · · · + ( 11 6 )( 107 0 ) = ( 118 6 ) . The right-hand side corresponds to the number of ways you can pick a 6-person team chosen from 118 people in a room. Assume that 11 people are men and 107 are women. Then your 6-person teams can be partitioned into the classes: 0 men and 6 women, 1 man and 5 women, 2 men and 4 women, . . ., 6 men and 0 women. Each term in the left-hand side has the form (11 j )( 107 6− j) , which is exactly the number of ways of picking a 6-person team in which j are men and 6 − j are women, chosen from a population of 11 men and 107 women! (See also 4.3.9 for a generatingfunctionological approach.) 6.3 A nice source of mostly easy-to-moderate exercises and problems about PIE can be found in chaper 8 of [23], which also relates this material nicely to generating func- tions (which are implicitly used in the indicator functions argument of pp. 212–214 in TAACOPS). 46 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS 8 Now it is ball and box problem, with 31 boxes and 10 balls. The number of unrestricted orders is then (31+10−1 10 ) . We must subtract from this the number of orders in which all the ﬂavors are different. This means that we choose 10 ﬂavors and place one ball into each of the 10 chosen ﬂavors. The number of ways of doing this is just (31 10) . So our answer is (40 10) − (31 10) . 9 We are undercounting. Suppose the ﬁrst person chosen was b3. Then the second cannot be g3, so we do have 6 choices. Suppose we choose b2. The next choice cannot be g2, but it can be g3 now, so there are actually 6 choices, not 5. The problem is that if we now choose g3, we have fewer choices for the next slot than if we don’t choose g3. So the numbers available are not quite independent of the choices—the multiplication method doesn’t work. 10 See the discusssion of the ϕ function on pp. 259–261. 11 Use complement PIE with the properties “not multiple of 2”, “not multiple of 5.” 12 By Example 6.2.7, the number of non-negative solutions (with no restric- tions) is (17+4−1 17 ) = (20 3 ) . We will subtract from this the complement: the number of solutions where d > 12. This is equal to the number of nonneg- ative solutions to a + b + c + u = 4, where u := d − 13. So our answer is(20 3 ) − (4+4−1 4 ) = (20 3 ) − (7 3) . 13 Let us do an example with n = 8. Suppose we have 8 letters, each ad- dressed to a different address, and we randomly deliver them to the 8 addresses. We wish to compute the number of ways that we can do this so that no one gets the correct letter. First of all, the “things” that we are counting are permutations of the 8 letters. So using the language of complement PIE (6.3.6), N = 8!. Let the sets A j be all permutations in which “letter j went to the right place,” for j = 1, 2, . . . , 8. First, let’s compute |A j|. This is just the number of permutations which “ﬁx” the jth letter, or 7!. (Notice that this does not depend on j.) Now let us compute |Ai ∩A j| for i ̸= j. This is the same as counting all permutations of 8 letters which ﬁx two letters, namely the ith and jth letters. Thus |Ai ∩ A j| = 6!. By the same reasoning, |Ai ∩ A j ∩ Ak| = 5!, etc. Now it is time to count up everything. We have S1 = 8 · 7! = 8!, since there are 8 different A j sets. On the other hand, there are 8choose2 differ- ent sets of the form Ai ∩ A j, corresponding to each choice of i and j. Thus S2 = ( 8 2 )6!. Likewise, S3 = ( 8 3 )5!, etc. When the dust settles, the number of permutations that ﬁx no letters will be 8! − 8 · 7! + ( 8 2 ) · 6! − (8 3 ) · 5! + · · · + 1. ANSWERS TO 6.4 47 Remember that we can always write (n r) as n! r!(n−r)! . When this is done, and we factor out 8!, we ﬁnd that D8 = 8! ( 1 − 1 1! + 1 2! − 1 3! + 1 4! − 1 5! + 1 6! − 1 7! + 1 8! ) . 14 Partition the n! permutations by the exact number of ﬁxed points, i.e., the number of elements which are not not displaced. If there are r ﬁxed points, we ﬁrst choose the elements which will be ﬁxed. We can do this in (n r) ways. Then the remaining n − r elements must have no ﬁxed points, and this can be done in Dn−r ways. 16 Among the kn unrestricted assignments of cones to children, let Ar de- note the set of assignments for which ﬂavor r is not used. By the language of complement PIE, N = kn and the value we seek is N − S1 + S2 − · · · . Now, there are k ways of choosing a ﬂavor that won’t be used, and for each ﬂavor so negatively chosen, there will be (k − 1)n possible assignments. Hence S1 = k(k − 1)n. Likewise, S2 = (k 2 ) |Ai ∩ A j|, and |Ai ∩ A j| = (k − 2)n, etc. 17 Hint: ﬁnd a one-to-one correspondence between permutations without property P to a proper subset of permutations with property P. 6.4 4 Let mn be the number of messages possible with n keystrokes. Clearly m1 = m2 = 1. In general, given n keystrokes, messages either begin with two consecutive letters or a single letter followed by a single space. There are mn−1 of the ﬁrst type and mn−2 of the second. So mn = mn−1 + mn−2: a Fibonacci recurrence. 6 Let sn be the number of such subsets. We have s2 = 3, s3 = 5 (including the empty set). Now let us compute sn+1. The subsets under consideration partition into two classes: those which contain the element n + 1, and those that do not. The second class consists of the sn subsets of {1, 2, . . . , n} which contain no two consecutive elements. The ﬁrst class consists of subsets of {1, 2, . . . , n − 1} which contain no two consecutive elements, each with the element n + 1 appended. There are sn−1 such subsets, so sn+1 = sn + sn−1, yielding yet another Fibonacci recurrence. 12 Fibonacci, of course. 48 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS 13 Let us compute u(n + 1), where the (n + 1)st element is x. Consider the partitions of the (n + 1)-element set including x by focusing on x. This element has to live somewhere; let us partition all partitions according to how many neighbors x has in its partition. If x is alone, there are u(n) possible ways to partition the other elements. If x has one neighbor, there are n choices for this neighbor and then u(n − 1) ways to partition the others. If x has two neighbors, there will be (n 2) choices of neigbors with u(n − 2) ways to partition the rest. In general, we have u(n + 1) = n ∑ r=0 ( n r ) u(n − r), where we use the convention that u(0) = 1 (there is only one way to partition the empty set, after all). 14 This is secretly the same as problem 6.4.9. 15 Let’s verify it for n = 5. Imagine slots numbered 1, 2, 3, 4, 5 into which we want to derange the letters a, b, c, d, e (so a cannot go into slot 1, b cannot go into slot 2, etc.). There are 4 choices for slot 1, namely b, c, d, e. We will show that, for each of these choices, there are D4 + D3 ways of deranging the other 4. Without loss of generality, suppose that we chose c for slot 1. Of the remaining choices, there are two cases: 1. Slot 3 contains a. Now slots 1 and 3 have swapped their proper members, i.e., these two slots form a derangement. We need to derange b, d, e in slots 2, 4, 5, and this can of course be done in D3 ways. 2. Slot 3 doesn’t contain a. Then we need place a, b, d, e in slots 2, 3, 4, 5 so that b, d, e respectively do not land in 2, 4, 5, and a doesn’t land in slot 3. Although the numbering is unorthodox (we normally associate a with 1), this is precisely a derangement of 4 elements. So there are D4 ways. Hence the total number of derangements is 4(D3 + D4). 16a There is a 1-1 correspondence between the legal partitions of 2n + 1 and the legal partitions of 2n: just remove one of the 1’s from the former to get the latter (note that any legal partition of 2n + 1 must have at least one 1). 16b The legal partitions of any number can be broken into two mutually ex- clusive classes: those that contain 1’s, and those that do not. The legal partitions of 2n which do not contain one can be placed into 1-1 correspondence with the legal partitions of n: just divide the terms of the former by 2 to get the lat- ter. Likewise, there is a 1-1 correspondence between the legal partitions of 2n which do contain 1’s and the legal partitions of 2n − 1: just remove one of the 1’s from the former to get the latter. 16c Once (a) and (b) are established, this is a trivial induction (as long as you use strong induction). ANSWERS TO 7.1 49 7.1 An Introduction to the Theory of Numbers, by Niven, Zuckerman, and Montgomery [21] is an excellent reference to have on hand for this section and sections 7.2–7.5. 15 For example, let fn denote the nth Fibonacci number. We have ( fn, fn+1) = ( fn, fn+1 − fn) = ( fn, fn−1) = ( fn−1, fn). This process can be repeated until we get ( fn, fn+1) = ( f1, f2) = 1. 19 Let n be an arbitrary positive integer. Then the n − 1 numbers n! + 2, n! + 3, . . . , n! + n are all composite, being divisible respectively by 2, 3, . . . , n. 20 See 3.4.20. 22 Each zero at the end of a number represents a 10 in the factorization of the number. Hence we need to ﬁnd the greatest k such that 10k|1000!. Since 10 = 2 · 5 and there will always be many more 2’s than 5’s in the factorization, we need only focus on the exponent k of 5 in the PPF of 1000!. Since 1000! = 1 · 2 · 3 · 4 · 5 · · · 1000, we might ﬁrst think that k = 1000/5 = 200, corresponding to the 200 multiples of 5 between 1 and 1000. But some of these multiples are richer in 5’s than others: each multiple of 25, and there are 1000/25 = 40 of them, contribute two 5’s apiece, only one of which was counted. Likewise, there are 1000/125 = 8 multiples of 53 and f l1000/625 = 1 multiple of 54. This adds up to 200 + 40 + 8 + 1 = 249, as desired. This is easy to generalize. Let p be a prime. Then the greatest power of p in the PPF of n! will be ⌊ n p ⌋ + ⌊ n p2 ⌋ + ⌊ n p3 ⌋ + · · · . It doesn’t hurt to make this sum inﬁnite, since eventually, all the terms will be zero. 23 Write (pr k ) = (pr)! k!(pr − k)! , and employ the formula from 7.1.22 to compare the powers of p in the numer- ator and denominator. 24 Let a := fk be the kth Fibonacci number and suppose it is a multiple of n. Let b := fk+1. Then fk+2 = fk+1 + fk = a + b, fk+3 = fk+2 + fk+1 = a + 2b, fk+4 = fk+3 + fk+2 = 2a + 3b, fk+5 = fk+4 + fk+3 = 3a + 5b, 50 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS and so on. It is easy to see that the coefﬁcients of a and b are themselves Fibonacci numbers! Indeed, we have fk+r = fr−1a + frb. Consequently, f2k = fk−1a + fkb = fk−1a + ab = a( fk−1 + b) will be a multiple of n, since it in fact a multiple of fk itself. 31a Consecutive numbers are relatively prime, so their product cannot be a square unless both numbers were squares, but consecutive numbers cannot be perfect squares (besides 0 and 1). 31b We argue by contradiction. Suppose the ﬁrst number is odd. Then the third number is also odd, and relatively prime to the ﬁrst two numbers. So all three numbers are relatively prime in pairs. The product cannot be a perfect square, by the same reasoning used in 7.1.28a. Now, suppose that the ﬁrst number is even. The middle number must be an odd perfect square (since it is relatively prime to the other two). Thus the numbers are a2 − 1, a2, a2 + 1. Since the product of all three is a perfect square, (a2 − 1)(a2 + 1) = a4 − 1 must be a perfect square. But since a4 is also a perfect square, this again implies two consecutive perfect squares, an impossibility. 32 Since (an, a2n) = (n, 2n) = n for any n, we see that n|an, so among other things, an is at least as large as n. Now, suppose that there is an n such that an ̸= n. By the above reasoning, we have an = u = rn for some r > 1. But the hypothesis of the problem yields (an, au) = (n, u) = (n, rn) = n. But an = u and au is a multiple of u, so (an, au) = u > n, a contradiction. 7.2 6 All perfect squares are congruent to either 0 or +1 modulo 3; this follows from simply squaring the only three choices modulo 3: 02 ≡ 0, 12 ≡ 1, 22 ≡ 1. Thus a2 and b2 cannot both be congruent to 1 mod 3, for that would make c2 congruent to 2, which is impossible. The only possiblilites are that one or both of a is congruent to 0, forcing ab to be a multiple of 3. 7 The only cubes modulo 7 turn out to be 0, 1, −1. 9 Again, use mod 7. 10 N = 381654729. 15 No. Let a0 = p, a prime. Then ar = 2r p + 2r − 1. By Fermat’s little theorem, 2p−1 ≡ 1 (mod p), so ap−1 will be a multiple of p. ANSWERS TO 7.3 51 7.3 1 Since 1 ⊥ 1, we have f (1) = f (1 · 1) = f (1) f (1), which means that f (1) equals 0 or 1. The ﬁrst possibility is excluded because the range of f is N. 6 Let d|n, where n = ab with a ⊥ b. By the FTA, we can write d = uv, with u|a and v|b. The trickier part is showing that this is a one-to-one correspondence. It sufﬁces to show that if the u, u′ and v, v′ are respectively divisors of a and b and uv = u′v′, then u = u′, v = v′. This follows by mimicking the ﬁnal steps of the proof of the FTA on p. 247. 14 Suppose ϕ (n) = 14. We can assume without loss of generality that n is odd, for if n is even then n = 2s, where s is odd and ϕ (s) = 14 as well (if n = 2rs then ϕ (n) = ϕ (2r)ϕ (s) which is a multiple of 4, because ϕ (2r) = 2r−1 and ϕ (s) is even). If n is odd, it cannot contain more than one prime in its PPF, since if we write n = ab where a, b > 1 and a ⊥ b, we have ϕ (n) = ϕ (a)ϕ (b) which is a product of two even numbers. The only possibility is the n = pr for some odd prime p. But then ϕ (n) = pr−1(p − 1) = 14, which has no solution (since p = 3 and p = 7 are the only possibilities). 22 F is the indicator function for perfect squares, i.e., F(n) = 1 if n is a perfect square and F(n) = 0 otherwise. 24 Certainly, if n is a prime, then ϕ (n) + σ (n) = (n − 1) + (n + 1) = 2n. To prove the converse, we will show that if n is composite, then ϕ (n) + σ (n) > 2n. Suppose that n is not a prime, but has only one prime divisor p. Then ϕ (n) = n − n/p while σ (n) ≥ n + n/p + 1, so ϕ (n) + σ (n) > 2n. Next, suppose that n has two distinct prime factors, p and q. Then we have ϕ (n) = n − n p − n q + n pq , while σ (n) ≥ n + n p + n q + n pq , and once again ϕ (n) + σ (n) > 2n. The pattern is clear, now: if n is not prime, ϕ (n) will be an alternating sum starting with n, and σ (n) will contain at least all the terms in ϕ (n), but all positive, so when ϕ (n) is added to σ (n), some terms will cancel, but not all, leaving 2n plus some extra stuff. 26 (Sketch) We argue by contradiction. Assume that there exists a function f (n) that is strictly increasing, multiplicative, and where f (n) > n starting at some n = n0. Our strategy is to get some upper bounds on f (n), and then contradict them. We shall use the fact that f (2m) = 2 f (m) for odd m. For any k, we have f (2 k) < f (2k + 2) = 2 f (2 k−1 + 1) < 2 f (2 k−1 + 2) 52 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS = 22 f (2 k−2 + 1) ... < 2k−1 f (3). Thus f (2k)/2k < f (3), which is a constant. Since k is arbitrary, this means that the function essentially grows in a linear way; it cannot get too wildly out of control, since it is strictly increasing. We will get a contradiction once we show that we can ﬁnd an n such that f (n)/n can be made arbitrarily large. But this is easy: suppose that the p1 is the ﬁrst prime for which f (p1) > p1. Then we have f (p1) ≥ p1 + 1, and in fact, f (k) ≥ k + 1 for all k ≥ p1. Since there are inﬁnitely many primes, we can let n = p1 p2 · · · pr, where the pi are successive primes and r is as big as we please. Then f (n) n ≥ ( p1 + 1 p1 ) ( p2 + 1 p2 ) · · · ( pr + 1 pr ) , and this expression diverges as r → ∞ (see Example 9.4.7), achieving the de- sired contradiction. 27 There are many ways to do this. One method is to write 999 = (10 − 1)99 and use the binomial theorem, noting that most of the terms are multiples of 100. Another is to use Euler’s extension of Fermat’s little theorem (Problem 7.3.25). Since ϕ (100) = 40, we have 980 ≡ 1 (mod 100), so the problem is re- duced to ﬁnding 919 modulo 100. Break 100 into relatively prime factors 4 · 25. It is easy to see that 9r ≡ 1 (mod 4) for any r, and Euler’s extension again yields 920 ≡ 1 (mod 25). Thus 920 ≡ 1 (mod 100). So, if 919 ≡ x (mod 100), we have 9x ≡ 1 (mod 100), which is equivalent to the linear diophantine equa- tion 9x − 100y = 1. This can be easily solved by the methods of 7.1.13, yielding x = 89. Certainly the second method is harder, but more instructive, and potentially more useful (we were lucky that 9 = 10 − 1). 28–31 There are many excellent number theory texts, of course, but I am especially fond of the clarity of Vanden Eynden’s approach to the M¨obius in- version formula in [25]. This is a perfect source for the beginner. On a more sophisticated level, section 2.6 of Wilf’s generatingfunctionology has a fasci- nating discussion that is also good supplementary reading for section 9.4 of TAACOPS. 7.4 6 The ﬁrst equation can be solved by the factor tool. It is equivalent to 5n = m2 − 2500 = (m + 50)(m − 50), and the only solution is n = 5 (since there is only one pair of powers of 5 whose difference is 100. The second equation has a similar solution; n = 8. ANSWERS TO 7.4 53 7 Without loss of generality, assume a ≥ b ≥ c. Note that we must have 2 ≤ (1 + 1/c)3. This implies that c ≤ 3. Now we have reduced it to just a few cases that are easy to deal with. • If c = 1, then (1 + 1/a)(1 + 1/b) = 1 which is clearly impossible. • c = 2 leads to (1 + 1/a)(1 + 1/b) = 4/3 which implies that 4/3 ≤ (1 + 1/b)2 which forces b < 7. Since (1 + 1/a) > 1, we must also have b > 3. Plugging in values yields the solutions (7, 6, 2), (9, 5, 2), (15, 4, 2). • c = 3 gives (1 + 1/a)(1 + 1/b) = 3/2. Similar analysis leads to b < 5, b ≥ c = 3. These values yield the solutions (8, 3, 3) and (5, 4, 3). In conclusion, the solutions are all cyclic permutations of (7, 6, 2), (9, 5, 2), (15, 4, 2), (8, 3, 3) and (5, 4, 3). 9 Multiply both sides by x + y and add n2, to get xy − nx − ny + n 2 = n 2, which factors into (x − n)(y − n) = n 2. Let d|n2 and let e := n2/d. Then (x − n)(y − n) = de yields the solution x = d + n, y = e + n. There is a one-to-one correspondence between (positive) divisors of n2 and solutions (negative divisors won’t work; at least one of the divisors would have to be ≤ −n, forcing either x or y to be zero or negative), hence the number of solutions is d(n2). 11 The equation we must solve is abc = a + b + c + 2. Monotonize: assume without loss of generality that a ≤ b ≤ c. Then a + b + c ≤ 3c. Hence, we have abc ≤ 2 + 3c. If c > 2, then 2 + 3c < 4c, which means that ab < 4. So there are just a few cases: 1. c ≤ 2: This leads to the solution (2, 2, 2) only. 2. c > 2 and ab = 1: This implies 1 · c = 1 + 1 + c + 2, an impossibility. 3. c > 2 and ab = 2: This leads to (1, 2, 5). 4. c > 2 and ab = 3: This leads to (1, 3, 3). These are the only solutions (up to permutation). 12 Hint: Show that (x+1)3 < x3 +8x2 −6x+8 < (x+3)3. The only solutions are (0, 9), (9, 11). 13 (Sketch) There are no solutions other than x = y = 1. If y ≥ 2, a modulo 9 analysis yields forces x to be even. Then we can write x = 2m and use the factor tool to analyze 3 y = 72m − 4 = (7 m + 2)(7m − 2). 54 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS 15 See problem 3.4.31. 22 Notice that 8 and 9 ﬁt the bill. Inspired by this, we need only ﬁnd solutions to 8x2 + 1 = 9y2. Substituting u = 2x, v = 3y transforms this into v2 − 2u2 = 1, which was solved above in 7.4.19. 7.5 13 Hint: Let g = GCD(m, n) and write m = ag, n = bg, where a ⊥ b. Then the equation becomes g(ab − a − b + 1) = g(a − 1)(b − 1) = 0. 14 (Sketch due to Kiran Kedlaya) No geometric progression of integers be- tween 1 and 100 can have more than 7 terms. To see this, let m/n be the common ratio, where m ⊥ n, and look at prime factors and inequalities. So 12 progressions, each with at most 7 terms, only can cover 84 or fewer of the numbers from 1 to 100. Alternate solution: Use the fact that there are 25 primes from 1 to 100. How many primes can be in a geometric progression? 17 (Sketch) Parity analysis shows that all three variables are even or else one is even and two are odd, but in this case, modulo 4 analysis produces a contra- diction. Hence all three are even. We can write x = 2a, y = 2b, z = 2c, where a, b, c ∈ Z. Substituting and simplifying yields the new equation a2 + b 2 + c 2 = 4abc, and a similar mod 4 analysis forces a, b, c to all be even. Writing them as a = 2u, b = 2v, c = 2w yields u 2 + v 2 + w 2 = 8uvw. This process can be repeated indeﬁnitely. What this means is that x, y, z can be divided by 2 arbitrarily many times and integers will always result. The only numbers that satisfy this are x = y = z = 0. This method of solution is called inﬁnite descent and was discovered by Fermat. See [21] for an excellent discussion. 19 There are many fun approaches to this problem. One idea is to use the for- mula developed in the solution to 7.1.22 for the highest power of 2 that divides n! and use this to compute the highest power of 2 which divides (n r) . Another idea is to use (strong) induction, starting by writing Pascal’s triangle modulo 2. A third, more sophisticated approach is generatingfunctionological—think about (1 + x)n modulo 2, using the fact that (1 + x) 2 ≡ 1 + x2 (mod 2). 21 If p ̸= 2, then d(8p) = 8. If p = 2, then d(6p) = 6. If p ̸= 3, then d(9p2) = 9. If p = 3, then d(12p2) = 12. 24 See problem 7.3.23. ANSWERS TO 7.5 55 25 Yes. Just pick 1997 relatively prime squares, for example 22, 32, 52, 72, 112, . . .. The Chinese remainder theorem (7.2.16) guarantees that one can ﬁnd x such that x ≡ 0 (mod 22), x ≡ −1 (mod 32), x ≡ −2 (mod 52), . . . . Then µ(x) = µ(x + 1) = µ(x + 2) = · · · = 0. 27 (Sketch) If m is odd, then ϕ (2m) = ϕ (2)ϕ (m) = ϕ (m). Hence the inverse image sets consists of pairs. And note that µ(2m) = −µ(m). 28 Yes, there are inﬁnitely many such rows. For example, ( 203 68 ) = 2( 203 67 ) and ( 203 85 ) = 2 ( 203 83 ). There are inﬁnitely many rows having two adjacent elements in a 1:2 ratio, for 2( n k ) = ( n k + 1 ) reduces to 2(k + 1) = n − k, or n = 3k + 2. So as long as n ≡ 2 (mod 3), there will be two adjacent elements in a 1:2 ratio. Next, we search for “doubles” that are not adjacent. The next easiest case to try is 2( n k ) = ( n k + 2 ) , which reduces to 2(k + 2)(k + 1) = (n − k)(n − k − 1). Substitute u = n − k and v = k + 2; our equation becomes 2(v 2 − v) = u2 − u. Multiplying both sides by 4 and completing the square yields 2(4v2 − 4v + 1) = 4u 2 − 4u + 1 + 1, so substituting x = 2v − 1, y = 2u − 1 reduces the original equation to 2x2 − y 2 = 1. This is a Pell’s equation with inﬁnitely many solutions which can be generated in the standard way (see 7.4.17–7.4.20), or simply observe that (1, 1), (5, 7) are solutions and that if (x, y) is a solution, then (3x + 2y, 4x + 3y) is also a solution. It remains to show that one of these solutions produces an n which is con- gruent to 2 modulo 3. Since n = x+y 2 − 1, we must have x + y ≡ 0 (mod 6). The ﬁrst solution with this property is (5, 7), but this doesn’t work, because it corresponds to n = 5, and the elements of the row are 1, 5, 10, 10, 5, 1, so the 56 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS doubles are not distinct. Generating solutions via (x, y) → (3x + 2y, 4x + 3y) modulo 6, we have the repeating pattern (1, 1), (−1, 1), (−1, −1), (1, −1), (1, 1), . . . , which shows that every other solution (x, y) has the property x +y ≡ 0 (mod 6). Clearly the next solution after (5, 7) with this property will correspond to an n large enough so that the doubles will be distinct. Speciﬁcally, the solution is (169, 239) which corresponds to n = 203, k = 83. There are no rows before n = 203 which have two distinct double pairs. I know of no easy way to see this (I used a computer to check). 31 Trace the “orbit” of the top card, which starts in position 1. It goes to position 2, then 4, etc. Check that after r shufﬂes, it goes to position 2r (mod 95). (Not mod 94!) The minimum number of shufﬂes will be the minimum r such that 2r ≡ 1 (mod 95). By Euler’s theorem, r must divide ϕ (95) = 72. It turns out that 36 is the smallest such exponent. In general, for a 2n-card deck, the minimum number of shufﬂes needed is the order of 2 modulo 2n + 1. 32 (Sketch due to Elgin Johnston) Because m = ϕ (n) and n is odd, we know by Euler’s extension of Fermat’s little theorem that n divides 2m − 1. There are two cases: • n = qr > 3 for some odd prime q. Then m = qk − qk−1 ≥ 4 is even and q divides 2m − 1 = (2m/2 − 1)(2m/2 + 1), so it must also divide one of the factors on the right. Any prime divisor of the other factor meets our requirement. • n has at least two distinct prime factors, then m is a multiple of 4 and q − 1 divides m/2 for each prime factor q of n. Hence q also divides 2m/2 − 1. It follows that no prime factor of n divides 2m/2 + 1, and any of them meet our requirement. 33–35 Vanden Eynden’s book [25] is exceptionally clear on this material. 38 This is a simple consequence of equation (3) on p. 238. 39 This follows from the problem above by taking logs, using the M¨obius inversion formula, and then exponentiating. 40 (Sketch) Call the sum in question f (n). Show that it is a multiplicative function, and then show that for n > 1, ∑ d|n f (d) = 1 + ζ + ζ 2 + · · · + ζ n−1 = 0. Since f (1) = 1, the mystery function f (n) satisﬁes the same equation as µ(n) in 7.3.12. Hence f (n) = µ(n). 41 The ﬁrst n for which Φn(x) has coefﬁcients other than ±1 is 105=3 · 5 · 7. 8.2 26 The diagonal of any quadrilateral dissects it into two triangles, and you already know things about triangles and midpoints. ANSWERS TO 8.3 57 27 Whenever you encounter a right triangle, remember that it inscribes nicely in a circle, with the hypotenuse as diameter. Always associate hypotenuses with diameters! 28g The given point, tangent, and circle center make a right angle. Remem- ber: right angles can be found inscribed in circles! 28k There are two types of tangent lines. The “outside” ones, which intersect on one side of both circles; the “inside” ones, which intersect “between” them. Here is one case: Let the radii be R, r, with R > r. To construct an outside tangent line to both circles, you need to look at a right triangle, with one leg of length R − r whose hypotenuse is the line segment connecting the two centers. 30 Let A, B,C denote the points of tangency between ℓ1 and ω, ω and γ, γ and ℓ2, respectively. Let P, Q denote the centers of ω, γ, respectively. Note that P, B, Q are collinear, and that AP ∥ QC, and that triangles CQB and APB are isosceles. You may want to try an argument by contradiction: “Let A′ denote the intersection of line CB with line AP. If A′ ̸= A, then . . . ” 32 Use the result of Problem 8.2.27 to help with the angle chasing. 33 A fold is a reﬂection across the fold line. Each point P is reﬂected to a point P′ such that the fold line is the perpendicular bisector of PP′. These perpendicular bisector give you lots of angle chasing opportunities. 35 You can easily determine which circle the midpoints must lie on, since you are told that they lie on a circle. To prove that they lie on this particular circle, you need the right penultimate step; use 8.2.13. 8.3 17 Look at the circumcircle of the medial triangle. 19 Compare areas. 21b Extend the sides of the trapezoid upwards to form a triangle. (This is often a good idea when looking at trapezoids.) Now you have several similar triangles to contemplate that are each similar to this new triangle, and you also have two smaller similar triangles inside the trapezoid. Surely this is enough information! 23 Use Problem 8.3.18. 24 Extend AP to intersect BC at D. We’d be done if we could show that BD = DC. Since [ACP] = [ABP], we should look for two altitudes that are equal. This gives us a perpendicular bisector. Now draw the appropriate parallel lines. 28 Draw the angle bisector through A, which intersects BC at D′. Use the angle bisector theorem to prove that D and D′ must be the same point. 30 Use a little algebra. Let k be the ratio of similitude between the two given triangles, so, for example AB/DE = k. Then let r = AX/XB. 32 It’s easier to prove (d) before (c), since (d) implies (c). Just draw the appropriate diameter of the circle and look for an inscribed right triangle. Then you can read off the sine instantly. For (e), try (if C is obtuse) extending BC 58 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS to D so that BDA is a right triangle with right angle at D. Now you have right triangles to read off trig functions with ease, and you can use the pythagorean theorem to get c2. 38 It is easier to look at the ratio CE : EB, which can be found with angle chasing and law of sines. You will need to use calculus, or the result of the previous problem. A very useful corrollary of this is limθ →∞(sin aθ / sin θ ) = a, for any constant a. 40 Draw a line tangent to the escribed circle that is parallel to BC. 42 Midpoints suggest equal areas. You’ll need auxiliary lines. 43 The area between the circle and the chord cutting off the arc is independent of the location of the arc, so you can ignore it, and the problem becomes one of rectangles and triangles. It is equivalent—why?—to showing that twice the area of the triangle with dark outline below is equal to the area of the enclosing rectangle, minus the area of the lower-left rectangle. This can be proven with complex numbers or trig (you will need to know the angle-addition formulas), but it can also be done much more simply. 8.4 7 You’d guess—correctly—that this ratio is constant, which means you have to hunt for similar triangles. Draw appropriate diameters to get right triangles, and look for the crux angle, one that is is inscribed simultaneously in both cir- cles. This angle will be the bridge that allows you to compare angles inscribed in one circle with angles inscribed in the other. 8 Perpendiculars dropped to sides are practically begging you to consider area. Do you know the formula for the area of an equilateral triangle in terms of its side length? If not, work it out now. 9 Use Stewart’s theorem (Problem 8.3.33) and the law of cosines, which you need to prove Stewart’s theorem, as well. 10 Think about the penultimate step for showing an angle to be constant. One such penultimate step would be for this angle to be inscribed in a circle, subtending a chord of constant length. 15 One penultimate step for this equality would be showing that a circle can be inscribed in quadrilateral A′B′C′D′. There are other approaches as well. And please notice that there are other cyclic quadrilaterals in this problem. 16 One way to show that these three points lie on a line is to show that △Y JZ ∼ ZIX. Look for other similar triangles to prove this. ANSWERS TO 8.5 59 18 Make sure that you have studied Example 8.4.2. The answer, by the way, is 1/6. 19 Parallel lines give birth to parallelograms; look for equal areas. 21 Again, study Example 8.4.2 carefully. 25 One way to show that XY is invariant is to show that it is a chord in a circle that subtends a constant angle. Look for a cyclic quadrilateral. 28 The problem asks you to prove an equality involving ratios, so you are naturally led to thinking about similar triangles. Draw a careful diagram, and you will see that it is infested with similar triangles. This is a challenging but fun problem; stick with it! 29 Note that ABCQ is a cyclic quadrilateral. 31 Assume that A, E,C, G are on the same side of PQ. Then it sufﬁces to show that CG is parallel to PQ (why?). You can prove this by ﬁnding similar triangles. Notice that PQAE is a cyclic quadrilateral (why?). As usual, this will allow many similar triangles to surface, some due to the tactic of looking at chords in two circles simultaneously. 32 Consider the case where AB < CD. Then lines DA and CB meet at a point X. A penultimate step for the area equality that we are to prove is that P always lies on the angle bisector of ∠AXB. Look for similar triangles, and don’t forget to involve line EF, since you have ratio information about this line segment. 33 You may want to defer working on this problem until you have read about symmetry and reﬂections in the next section. The 60◦ angle and the perpendic- ulars creates many equal angles and equal sides. . . 34 Angle chase to ﬁnd inscribed right angles. 35 The ratios in the problem suggest looking at similar triangles. Believe it or not, this problem succumbs to simple angle chasing, but you need to be very careful drawing the diagram. Color pencils are helpful to mark equal angles. Dont forget the tangent version of the inscribed angle theorem, and the fact that the measure of an exterior angle of a triangle is the sum of the opposite interior angles. Finally, you may want to compare the ratios AM/BM with EG/EF ﬁrst. 8.5 18 Contemplate the parallelograms in this hexagon. 19 One method is to use vectors and efﬁcient algebra. This is worth trying. Another, more “transformational” idea is the following: Suppose you are given the midpoints A′, B′,C′, D′, E′ of a pentagon ABCDE, such that A′ is the mipoint of AB, B′ is the midpoint of BC, etc. Consider the rotation RA′,π . This takes A to B. Likewise, RB′,π takes B to C. Now consider the composition of rotations RE′,π ◦ RD′,π ◦ RC′,π ◦ RB′,π ◦ RA′,π with the single rotation RA′,π . A translation is lurking about. 60 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS 20 Notice that the height is ﬁxed. If you need more hints, look at Exam- ple 3.1.5. 21 Vectors. 23 To construct M(T ), try to build a triangle by translating the medians by vectors that are parallel to the sides of the original triangle. Vector notatation may be helpful with the other parts of the problem. 25 Make sure that you understand the following: suppose that point X lies on line segment AB, with AX : AB = r. Then ⃗X = ⃗A + r(⃗B −⃗A). For (a), consider the Euler line. For (b), use the fact that the incenter is the intersection of the angle bisectors of the triangle. The method of “weights” (Problem ?? may also be useful. 30 Find rotations that take one of AX, BY,CZ to another. Since rotations pre- serve length, you’re done! 31 Look at Example 8.5.5. 32 By now you probably realize that the penultimate step is a rotation. Sym- metrical “points of interest” (besides the given points) are the midpoints of the sides of the parallelogram, and, of course, the center of the parallelogram. 33 The area of a right triangle is, of course, base times height divided by two. The base and the height do not have to be the two legs of the triangle, though. . . 34 Suppose we successfully inscribe a square in the triangle; let its vertices be DEFG, with D and E on side BC. Then FG ∥ BC, so △AFG ∼ ABC. Now, rather than think of these triangles as merely similar, think of them as also homothetic with center at A. . . 36 The pantograph is nothing more (or less) than a homothety machine; you should have no difﬁculty in ﬁnding the center and scaling controls, etc. 37 There are several solutions, but one of the most straightforward uses vec- tors. Remember that if the dot-product is zero, the vectors are perpendicular. 39 This is really an exercise, not a problem, provided that you know how to ﬁnd the center of rotation for a composition of two rotations. You can also use complex numbers; the algebra is not too hard, although the geometric details are somewhat obscured. 46 Suppose the circle ω has been found. If we invert about P, then ω ′ will be a line, which will be tangent to the images of the two given circles. Notice that we have now converted our conﬁguration from one with three circles (hard) to one with two circles and a line (much easier). 47 This is a hard problem, originally discussed by Apollonius. One ap- proach is to ﬁrst show that there is an inversion which takes two of the cir- cles into concentric circles. Then it is (relatively) easy to construct the de- sired circle; another inversion restores it to its “correct” position. A useful web site to visit that discusses this problem is http://whistleralley.com/ tangents/tangents.htm. ANSWERS TO 9.2 61 48 Invert about E, showing that the image of the four reﬂection points lies on a rectangle. 9.2 8 p must be a rational number of the form k/(k + 1). To see why, suppose that p is such that it is not the case that Arnie must reach a win percentage of exactly p. Let w, g be respectively, the number of wins for Arnie and games played when Arnie’s win ratio exceeds p for the ﬁrst time. Then we have w − 1 g − 1 < p < w g . Clearly, irrational values of p will not lead to contradictions. On the other hand, if p = a/b for relatively prime integers a, b, a little algebra yields a − b < ag − wb < 0. If a − b = −1, then we get a contradiction, since no integer lies properly be- tween −1 and 0. However, if a − b < −1, it is easy to ﬁnd values of g, w that work without contradiction (exercise). 9 The solve for the limit tool leads to the guess that an → ϕ , where ϕ ≈ 1.602 is the positive root of x = 1 + 1/x. There are many ways to prove that this limit is actually attained, and you are encouraged to try other ideas than the following: Examining the ﬁrst few values of an, they appear to oscillate about ϕ : 1, 2, 3 2 , 5 3 , 8 5 , . . . , and 1 < ϕ while 2 > ϕ and 3/2 < ϕ , etc. So it makes sense to look at every other term in the sequence. More precisely, if a := an, then an+2 = (2a + 1)/(a + 1). If a < ϕ , it is straighforward to show that a < (2a + 1)/(a + 1), since this is equivalent to a2 − a − 1 < 0, and the positive root of this quadratic equation is ϕ . Additionally, it is easy to show that if a < ϕ , then (2a + 1)/(a + 1) < ϕ . Putting these together, we conclude that if a < ϕ , then a < (2a + 1)/(a + 1) < ϕ . By similar reasoning, we can show that if a > ϕ , then ϕ < (2a + 1)/(a + 1) < a. This means that the two subsequences a1, a3, a5, . . . and a2, a4, a6, . . . are each bounded and monotonic, and so each converges. The solve for the limit tool yields ϕ in each case [by solving the equation (2x + 1)/(x + 1) = x,] so ϕ must be the limit of the full sequence. We are done, but it is very instructive to try to look at error terms like an −ϕ and try to show that they go to zero, etc. 62 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS 10 We know nothing about the convergence of (bn). For example, let an = 1/n! and bn = n2. Then an/bn → 0 but bn → ∞. On the other hand, if bn = 1/n, now both (an/bn) and (bn) converge to zero. 11 Let a1 = √ 2, and let an+1 = √ 2 + an. Solving for the limit suggests a limit of 2, and it is easy to show that the sequence is bounded and monotonic (as long as a < 2, we have a < √2 + a < 2.) 12 A picture similar to the one on p. 321 shows that an → √ α. 15b This is a trick question, for this subset includes Q! 15d No element in S is close to 0.35. 17 Let S := {⟨α⟩, ⟨2α⟩, ⟨3α⟩, . . .}. We will show that given any x ∈ [0, 1], there is an element of S which is within a distance of 1/10 from x. We will use the pigeonhole principle. Divide [0, 1] into 10 equal subintervals [0, 1/10], [1/10, 2/10], . . . , [9/10, 1]. Now consider the 11 numbers ⟨α⟩, ⟨2α⟩, ⟨3α⟩, . . . , ⟨11α⟩}. Notice that these are 11 distinct numbers, for if two of them were equal, it would force α to be rational. By the pigeonhole principle, two of these numbers must lie within the same subinterval. Without loss of generality, suppose that ⟨5α⟩ and ⟨8α⟩ both lie in the subinterval [4/10, 5/10]. We can write 8α = N + θ and 5α = M + η, where N, M are integers and θ , η ∈ (0, 1/10). Then 3α = (N − M) + (θ − η), which means that ⟨3α⟩ will lie in either (0, 1/10) or (9/10, 1), depending on whether θ > η or θ < η. In any event, we are done. Suppose that ⟨3α⟩ ∈ [9/10, 1]. Then ⟨6α⟩ lies to the left ⟨3α⟩ and less than 1/10 away. Continuing, the sequence ⟨3α⟩, ⟨6α⟩, ⟨9α⟩, . . . will ﬁll the unit inteval with points that are less than 1/10 from each other, which was what was desired. Clearly this method will work with any distance, not just 1/10. 23 Here is a proof by picture, where 10 is replaced by 4. The total shaded area is equal to one-fourth of the desired sum; note that the lower-left 1/4 × 1/4 square will remain unshaded no matter what f is. ANSWERS TO 9.2 63 24 We are given that f (1000) = 999, so f (1000) f ( f (1000)) = 1, which im- plies that 999 f (999) = 1, so f (999) = 1/999. Now, we use the continuity of f : by the intermediate value theorem, there must be a value a ∈ (999, 1000) such that f (a) = 500 (because f (999) < 500 < f (1000)). Now it is easy: we have f (a) f ( f (a)) = 1, which means that 500 f (500) = 1, so f (500) = 1/500. 25 For simplicity, we will replace 1999 by 4. The idea is the same. Now we must show that there is a value x ∈ [0, 3/4] such that f (x) = f (x + 1/4). Deﬁne g(x) := f (x) − f (x + 1/4). We wish to show that there is a value x ∈ [0, 3/4] such that g(x) = 0. We have g(0) = f (0) − f (1/4), g(1/4) = f (1/4) − f (2/4), g(2/4) = f (2/4) − f (3/4), g(3/4) = f (3/4) − f (1). Then g(0) + g(1/4) + g(2/4) + g(3/4) = f (0) − f (1) = 0. Thus either all of these four values of g(x) is zero, and we are done (all we need is one value), or two of these values have opposite sign, in which case we will be done after one application of the IVT. So our solution was a combination of telescoping, the average principle (5.5.12), and the IVT. 30 To keep notation simple, we will assume that the xn are positive and mono- tonically increasing. Pick ε > 0. Then there will be an N such that for all n ≥ N, we have xn −xn−1 < ε. In other words, once n ≥ N, the sequence values increase by less than the increment of ε. Now imagine that n is quite a bit larger than N. We will have xn < xN + (n − N)ε, so xn n < xN n + n − N n ε < xN n + ε. There is an L such that if n ≥ L, then xN/n < ε, and we have xn n < 2ε for n ≥ L. Thus xn/n → 0. 34 Hint: Mimic the ideas used in Example 5.3.4, which showed that the har- monic series diverges. 64 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS 9.3 12 Let f (x) := ax + bx2/2 + cx3/3 + dx4/4 + ex5/5. Then f (0) = 0 and f (1) = a + b/2 + c/3 + d/4 + e/5 = 0. By Rolle’s theorem, f ′(x) = for some value of x. But f ′(x) = a + bx + cx2 + dx3 + ex4. 13b This is the same as problem 9.2.25. Let s(t) denote the position of the car north of Los Angeles at time t minutes. Then s(0) = 0, s(300) = 400. Deﬁne f (t) := s(t + 1) − s(t). We wish to show that there exists a time t such that f (t) = 4/3 (miles per minute, which is equivalent to 80 miles per hour). Since f (0) + f (1) + · · · + f (299) = 400, by the average principle, either all the terms equal 4/3, or some are less than 4/3 and some are greater. In the former case, we are done immediately, and in the latter, we are done after one application of IVT. 17 Plugging in y = 0 into f (x + y) = f (x) f (y), we see that f (0) = 1 unless the function is identically zero. We have f (x + h) − f (x) h = f (x) f (h) − f (x) h = f (x) ( f (h) − 1 h ) . Taking the limit as h → 0, we get f ′(x) = f (x) f ′(0) = 3 f (x). Thus f (x) = e3x. 18 Using the same ideas as 8.3.15, we get f (x) = 3 log x. 31 One way to prove this is with mathematical induction. But an easy way to see why it is true is by thinking about the graph of y = f (x). It is a “hat” which starts at (0, 0), rises with a straight line to ( 1 2 , 1) and then drops down with a straight line to (1, 0). The integral of f from 0 to 1 is just the area of this triangle, which is clearly 1/2. Now, what does the graph of y = f2(x) = f ( f (x)) look like? As x ranges from 0 to 1 2 , f (x) varies linearly from 0 to 1. Thus, as x ranges from 0 to 1 2 , f ( f (x)) will assume the same values that f (x) does when x ranges from 0 to 1. In other words, the graph of f ( f (x)) as x ranges from 0 to 1 2 is another “hat” that goes from (0, 0) to ( 1 4 , 1) to ( 1 2 , 0). Then, as x ranges from 1 2 to 1, f (x) varies linearly from 1 down to 0, causing the graph of f ( f (x)) to again draw a “hat” but in reverse. However, the original hat was symmetrical, so the ﬁnal picture of the graph of f ( f (x)) is just two hats, each with base 1/4 and height 1. Once again, the area is still 1/2. The graph of f3(x) works in a similar way. Informally, we just apply f to the graph of f2. What this means in practice is that any line which goes (left or right) from y = 0 to y = 1 gets transformed into a hat. So in general, the graph of fn(x) will have 2n−1 hats, each with base 1/2n−1 and height 1. The area is always 1/2. 32 The sum in question is equal to 1 n ( 1 + 1 1 + 1 n + 1 1 + 2 n + · · · + 1 2 − 1 n ) . ANSWERS TO 9.3 65 As n → ∞, this is equal to ∫ 2 1 dx x = log 2. 36 f cannot have two ﬁxed points, for then the graph of f intersects the graph of y = x in two points. The line joining these two points has slope 1, and the Mean value theorem implies that there exists a value of x such that f ′(x) = 1, a contradiction. The somewhat challenging part is ﬁnding functions that never have derivative equal to 1. One idea is to use the fact that ex never equals zero, and thus f (x) := x +ex has derivative 1+ex which is always strictly greater than 1. Since f (x) > x, the function has no ﬁxed points. However, we can translate this function vertically so that it intersects the graph of y = x. For example, the function f (x) := x + ex − 1 will have one ﬁxed point, at (0, 0), yet the derivative will still never equal 1. 37 Let the limit be L. Take logarithms, to turn the product into a sum, then reinterpret as a deﬁnite integral: log L = lim n→∞ 1 n n ∑ k=1 log ( 1 + k n ) = ∫ 2 1 log xdx = (x log x − x) ] 2 1 = 2 log 2 − 1. Hence, L = e 2 log 2−1 = 4/e. 39 Assuming that f is differentiable leads to f ′(x) = 0 for all values of x, so f (x) = 0 for all x (since it equals zero for one value). But calculus is not needed, just the triangle inequality. We have | f (x)| = | f (x) − f (0)| = | f (x) − f (2x/3) + f (2x/3) − f (x/3) + f (x/3) − f (0)| ≤ | f (x) − f (2x/3)| + | f (2x/3) − f (x/3)| + | f (x/3) − f (0)| ≤ 3 · (x/3) 2 = x2/3. Notice that there was nothing special about the role played by 3, here. Breaking it down into n sums would yield | f (x)| ≤ x2/n. Since n is arbitrary we can make f (x) arbitrarily small; we conclude that f (x) = 0 for all x. 45 (Sketch) Let ai := xx+1 − xi. If you draw a picture, it is apparent that the sum is an approximation of ∫ 1 0 xdx = 1/2. The error is at its worst (and without loss of generality, positive) if a2, a4, . . . , a2n are all tiny compared with a1, a3, . . . , a2n−1, in which case the error is (slightly less than) a2 1 + a2 3 + · · · + a2 2n−1 2 . 66 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS We will be done if we can prove the following inequality: If b1, b2, . . . , bn are positive numbers such that b1 + b2 + · · · + bn = 1, then b 2 1 + b 2 2 + · · · + b 2 n ≤ max(b1, b2, . . . , bn). This inequality can be veriﬁed by looking at a number of cases. For ex- ample, if n = 3, and we assume that b1 ≤ b2 ≤ b3, then one case is b3 ≥ 1/2. Check that b2 1 + b2 2 is maximized when b1 = 0, b2 = 1 − b3 which means that we must verify (1 − b3)2 + b2 3 ≤ b3. The other case is that 1/3 ≤ b3 < 1/2. Then b2 1 + b2 2 is maximized when b2 = b3, b1 = 1 − 2b3, and now we must verify 2b2 3 + (1 − 2b3)2 < b3. The general case will reduce to a number of inequalities of this kind. It isn’t particularly pretty, but it works. I suspect that there is a more elegant method lurking about. Reader, can you ﬁnd one? 9.4 17 It is easy to prove (by induction, for example) that the sum of the ﬁrst r terms is xu + xu−1 + xu−2 + · · · + x xu + xu−1 + xu−2 + · · · + x + 1 , where u = 2r−1 − 1. As r → ∞, this quotient certainly approaches 1, for any x. 21a The ﬁnite case was Problem 5.3.15. We have PM = sin x 2M sin ( x 2M ) , where PM := M ∏ n=1 cos ( x 2n ) . Let h = x/2M. Then we have PM = h sin x x sin h = ( h sin h ) ( sin x x ) . As M → ∞, h → 0. The result follows from the well known fact that lim h→0 h sin h = 1, which can be proven by several methods (L’hˆopital’s Rule, power series, geom- etry, etc.) ANSWERS TO 9.4 67 23 Notice that 1 4 ( 1 12 + 1 22 + 1 33 + 1 42 + · · · ) = 1 22 + 1 42 + 1 63 + 1 82 + · · · . Consequently, 1 12 + 1 32 + 1 53 + 1 72 + · · · = ζ (2) − 1 4 ζ (2) = 3π 2 4 · 6 = π 2 8 . 24 Using the methods and notation of Example 9.4.7, S = S3S5S7 = 3 2 5 4 7 6 = 105 48 . 25a Actually, no. If the FTA were false, the product might include duplicates, so it would include extra terms. Since the harmonic series diverges, so will a sum of reciprocals of the positive integers that includes duplicates of some integers. And all we need is that the product in question diverges. 27 This is easy to evaluate by changing the order of summation (an Eulerian tactic), so that we can deal with easy geometric series instead of difﬁcult zeta functions: S = ∞ ∑ r=2 ( ∞ ∑ k=2 1 kr ) = ∞ ∑ k=2 ( ∞ ∑ r=2 1 kr ) = ∞ ∑ k=2 ( 1/k2 1 − 1/k ) = ∞ ∑ k=2 1 k2 − k . The last sum is (by now) an easy telescoping exercise: ∞ ∑ k=2 1 k2 − k = 1 2 · 1 + 1 3 · 2 + · · · = ( 1 − 1 2 ) + ( 1 2 − 1 3 ) + · · · = 1. 28 One (self-referential) way to characterize P so as to avoid redundancy (counting 16 twice, for example, once as 24 and again as 42) is to say that P is the set of all ar where r = 2, 3, 4 . . . and a ranges through all non-perfect powers. Using the geometric series tool our sum is ∑ j∈P 1 j − 1 = ∑ j∈P 1/ j 1 − 1/ j = ∑ j∈P ( 1 j + 1 j2 + 1 j3 + · · · ) = ∑ a̸∈P r≥2 ( 1 ar + 1 (a2)r + 1 (a3)r + · · · ) , and this ﬁnal sum is equal to the sum of all terms of the form 1/uv, where u, v ≥ 2, i.e., the “redundant” perfect powers. But this sum was computed in 9.4.27; it is equal to 1. 68 CHAPTER 2 CHAPTER-BY-CHAPTER SOLUTIONS 30 Let pk denote the kth prime. Recall (see p. 237) that if n = p1 p2 · · · pr, then ϕ (n) n = r ∏ k=1 ( 1 − 1 pk ) . But r ∏ k=1 ( 1 − 1 pk ) = ( r ∏ k=1 pk pk − 1 )−1 . We showed earlier (Example 9.4.7) that the divergent harmonic series can be written as the inﬁnite product ∞ ∏ k=1 ( pk pk − 1 ) . This means that if we pick a sufﬁcently large number r, the product ( 2 1 ) ( 3 2 ) ( 5 4 ) ( 7 6 ) · · · ( pr pr − 1 ) can be made arbitrarily large. Hence if we choose nr := p1 p2 · · · pr, then lim k→∞ ϕ (nk) nk = 0. 31 A generalization of Example 9.4.7 is that ∞ ∑ n=1 f (n) nx = ∏ p prime ( 1 + f (p) px + f (p2) p2x + · · · ) for any multiplicative function f (see p. 257). Speciﬁcally, ∞ ∑ n=1 µ(n) nx = ∏ p prime ( 1 − 1 px ) . Taking reciprocals, and using the geometric series tool, we have ( ∞ ∑ n=1 µ(n) nx )−1 = ∏ p prime ( 1 − 1 px )−1 = ∏ p prime (1 + 1 px + 1 p2x + · · · ) = ∞ ∑ n=1 1 nx = ζ (x). Appendix A Sample Exams Here are two sample group exams, one given at near the beginning and the other toward the end of the semester. There is some overlap with problems from TAACOPS. An Early Exam 1 Pat the Magician asks a member of the audience to write a 13-digit number on the blackboard, while Pat is blindfolded. Pat then asks the volunteer to reverse the digits of the number, and to subtract the smaller of the two 13-digit numbers from each other. (If the original number ended in one or more zeros, the reversed number of course will have less than 13 digits.) Then Pat asks the volunteer to circle any one of the digits in the difference, provided the digit is not zero. Then Pat asks the volunteer to say what the uncircled digits were. After hearing all of this, Pat is able to tell the amazed volunteer what the circled digit was (Pat is blindfolded during this entire trick). How does Pat do the trick? Explain why (not just how) the trick works. By the way, there is nothing special about 13. The trick could have been done with a number of any length. 2 A bug is crawling on the coordinate plane from (7, 11) to (−17, −3). The bug travels at constant speed one unit per second everywhere but quadrant II (negative x- and positive y-coordinates), where it travels at 1 2 units per second. What path (with proof) should the bug take to complete her journey in minimal time? 3 Sal the Magician asks you to pick any ﬁve cards from a standard deck. You do so, and then hand them to Sal’s assistant Pat. Then you pick one of the ﬁve cards, and Pat puts it back into the deck, and takes the remaining 4 cards, arranges them in some way. Sal is blindfolded, and does not witness any of this. Then Sal takes off the blindfold, takes the pile of 4 cards, reads the four cards that Pat has arranged, and is able to ﬁnd the ﬁfth card in the deck (even if you shufﬂe the deck after the assistant puts the card in the deck!). Assume that neither Sal nor Pat have supernatural powers, and that the deck of cards is not marked, and that the pile of 4 cards that Pat arranges does not have any funny folding, or weird angles, etc. 4 Seventeen people are at a party. It turns out that for each pair of people present, exactly one of the following statements is always true: “They haven’t met,” “They are good friends,” or “They hate each other.” Prove that there must be a trio (3) of people, all of whom are either mutual strangers, mutual good friends, or mutual enemies. 69 70 APPENDIX A SAMPLE EXAMS 5 A group of airplanes is based on a small island. The tank of each plane holds just enough fuel to take it halfway around the world. Any desired amount of fuel can be transferred from the tank of one plane to the tank of another while the planes are in ﬂight. The only source of fuel is on the island, and we assume that there is no time lost in refueling either in the air or on the ground. What is the smallest number of planes that will ensure the ﬂight of one plane around the world on a great circle, assuming that the planes have the same constant ground speed and rate of fuel consumption and that all planes return safely to the island base? 6 Color the plane in 3 colors. Prove that no matter how the coloring is done, there are two points of the same color 1 unit apart. 7 Color the plane in 2 colors. Prove that no matter how the coloring is done, there exists a rectangle, all of whose vertices are the same color. 8 An “ell” is an L-shaped tile made from three 1 × 1 squares (see picture). For what positive integers a, b is it possible to completely tile an a × b rectangle only using ells? For example, it is clear that you can tile a 2 × 3 rectangle with ells, but (draw a picture) you cannot tile a 3 × 3 with ells. 9 Deﬁne f : [0, 1] → [0, 1] by f (x) = { 2x 0 ≤ x ≤ 1/2, −2x + 2 1/2 < x ≤ 1. Next, deﬁne a sequence fn of functions from [0, 1] to [0, 1] as follows: Let f1(x) = f (x) and let fn(x) = f ( fn−1(x)) for n > 1. Prove that for each n, ∫ 1 0 fn(x)dx = 1/2. 10 For positive integers n, deﬁne Sn to be the minimum value of the sum n ∑ k=1 √(2k − 1)2 + a2 k, as the a1, a2, . . . , an range through all positive values such that a1 + a2 + · · · + an = 17. Find S1999. 11 Let A be any set of 20 distinct integers chosen from the arithmetic progression 1, 4, 7, . . . , 100. Prove that there must be two distinct integers in A whose sum is 104. 12 Let 1997 ∏ n=1 ( 1 + nx3n) = 1 + a1xk1 + a2xk2 + . . . + amxkm, where a1, a2, . . . , am are nonzero and k1 < k2 < . . . < km. Find a1997. A Late Exam 1 A runner runs a 6-mile course in exactly 30 minutes. Prove that there must be a 5- minute time interval during which the runner ran exactly one mile. 2 Show that among any seven distinct positive integers not greater than 126, one can ﬁnd two of them, say x and y, satisfying the inequalities 1 < y x ≤ 2. 71 3 Seventeen chairs are evenly placed around a circular table on which there are name cards for seventeen guests. The guests fail to notice the cards until after they have sat down, and it turns out that no one is sitting at his or her designated seat. Prove that it is possible to rotate the table so that at least two of the guests will be (simultaneously) seated in the correct spot. 4 Let a, b, c be complex numbers satisfying abc = 1 and a + b + c = 1 a + 1 b + 1 c . Show that at least one of a, b, c must equal 1. 5 Let {x} denote the closest integer to the real number x. For example, {3.1} = 3 and {4.7} = 5. Now deﬁne f (n) := n + { √n}. Prove that, for every positive integer m, the sequence m, f (m), f ( f (m)), f ( f ( f (m))), . . . never contains the square of an integer. 6 Evaluate lim n→∞ 1 n4 2n ∏ j=1(n2 + j2) 1/n. 7 Place the integers 1, 2, 3, . . . , n2 (without duplication) in any order onto an n × n chess- board, with one integer per square. Show that there exist two adjacent entries whose difference is at least n + 1. (Adjacent means horizontally or vertically or diagonally adjacent.) 8 Find the maximum value of f (x) = 3 √4 − 3x + √ 16 − 24x + 9x2 − x3 + 3 √ 4 − 3x − √16 − 24x + 9x2 − x3 in the interval 0 ≤ x ≤ 1. Hint: No calculus, please! A delicate touch will work. 9 A great circle is a circle drawn on a sphere that is an “equator;” i.e., its center is also the center of the sphere. There are n great circles on a sphere, no three of which meet at any point. They divide the sphere into how many regions? 10 Let f : R → R be continuous, with f (x) · f ( f (x)) = 1 for all x ∈ R. If f (1000) = 999, ﬁnd f (500). 11 (Russia, 1996) A palindrome is a number or word that is the same when read forward and backward, for example, “176671” and “civic.” Can the number obtained by writing the numbers from 1 to n in order (n > 1) be a palindrome? 12 (E. Johnston) Let S be the set of positive integers which do not have a zero in their base-10 representation; i.e., S = {1, 2, . . . , 9, 11, 12, . . . , 19, 21, . . .}. Does the sum of the reciprocals of the elements of S converge or diverge? 72 APPENDIX A SAMPLE EXAMS 13 Let P = {4, 8, 9, 16, . . .} be the set of perfect powers, i.e., the set of positive integers of the form ab, where a and b are integers greater than 1. Prove that ∑ j∈P 1 j − 1 = 1. 14 Let g(n) be the number of odd terms in the row of Pascal’s Triangle which starts with 1, n . . .. For example, g(6) = 4, since the row 1, 6, 15, 20, 15, 6, 1 contains 4 odd numbers. (a) Conjecture a formula (or an easy way of computing) g(n). Hint: base-2. (b) Prove your formula. Hint: induction is possible, as always. Appendix B An Inspiring Story During the fall semester of 1994, I taught a problem-solving seminar. The twelve students varied greatly in preparation and ability. I divided the class into several small groups, chosen on the basis of personal compatibility rather than mathematical well- roundedness. Thus one group contained two women who were already close friends and very serious, highly skilled math majors. And another group ended up containing my least knowledgeable students. This group consisted of two women, recent college graduates (in psychology and environmental studies) enrolled in the MAT program, and a young man who had just switched his major from history to math. None of the three had studied any math beyond a year or so of calculus and linear algebra. One of the ﬁrst strategic ideas that I shared with the class was the need to look for patterns. This is a good topic for beginners, because it is fun, easy, liberating (one is free to “mess around” and “brainstorm”), and quite productive when combined with mathematical induction. After a few of weeks of rather intensive work on this and other strategies, and after about a week of elementary work in combinatorics, I told the class the cautionary tale of The Five Circles Problem. The problem is the following: Draw a circle, and place n points on the circumfer- ence, where n is a positive integer. Draw lines between each pair of points. What is the maximum number of regions that these lines divide the circle into? To help the class investigate the problem, I drew ﬁve circles on the blackboard, and marked one dot on the ﬁrst circumference, two on the second, etc. Then I joined the dots in each circle, having made sure that no three lines met in a point (to insure that the number of regions would be maximal). Then we counted regions. This is all standard procedure. With any new problem, the ﬁrst thing to do is play around, experiment, look for a pattern. The ﬁrst circle had no lines, hence just one region (the circle itself). The second circle was divided into two regions, and the third had four regions, etc. Here is the sequence of numbers that we discovered: 1, 2, 4, 8, 16. “At this point, I’m sure you all are ready to make a conjecture about the general for- mula,” I said, and sure enough, everyone agreed that the formula was probably 2n−1. (Of course, a few students ﬁrst guessed 2n, but then quickly recanted after plugging in values of n.) One student even ventured an argument for why this formula was true, 73 74 APPENDIX B AN INSPIRING STORY saying that the addition of a new point on the circumference would end up dividing each of the old regions into two regions, thus doubling the number each time. But as soon as she ﬁnished speaking, she said, “Wait, that can’t quite make sense. . . ” We agreed that we saw a pattern, but had no understanding of it, and carefully looked at the next case, n = 6. Instead of 32 regions, there were only 31! The unex- pected 31 persisted after numerous recounts. “The moral of the story,” I said, “is that just ﬁnding a pattern is never enough. You have to let the pattern guide you towards an understanding of the problem. A pattern by itself may just be a mirage, as it seems to be here. In fact, those ﬁrst 5 powers of two are just a coincidence. I challenge you to ﬁnd the real formula, and prove that your formula is correct for all values of n. By the way, this is a pretty hard problem.” I certainly knew that it was a hard problem. I had ﬁrst seen it in high school (the 5 circles problem is part of “folklore”), although I had never worked out the correct formula. Twenty years later, during the IMO training camp, a guest lecturer by the name of Bjorn Poonen discussed this problem, among others. Bjorn derived the for- mula for the number of regions, using a tricky argument that employed fairly esoteric ideas. Yet the formula looked very simple, containing only binomial coefﬁcients. I asked him, “Surely something with such a simple combinatorial formula should have a simple combinatorial derivation. Is there one that you know of?” He replied that he had never found one. When Bjorn Poonen says that he could not do something, everyone pays attention, for he is one of the most talented young problemists in the country. He is only the second person in history to have placed in the top 5 on the Putnam Exam during each of his four years in college, and he composes very original, beautiful problems for a number of math contests and journals. So if someone as gifted and accomplished as Bjorn cannot do it, it must be hard. Nevertheless, by the end of his lecture, one of the IMO team members had come up with a very elementary derivation, a combinatorial argument which used only the most basic ideas of that subject. We were all impressed with his brilliance, for ele- gant, elementary arguments are often the hardest to ﬁnd, especially when you have already seen another way to do a problem. Everyone agreed that it was a virtuoso accomplishment. Naturally, I did not have great expectations that my USF students would have success with this problem. But besides saying that the problem was difﬁcult, I did not discourage them. And sure enough, by the next class, my “weakest” group announced that they had found a solution. One of the MAT students went to the board, and rather tentatively (“I’m sure this is nonsense. . . ”) presented a formula and its derivation. Her argument wasn’t smooth, but it was correct, and was essentially the same brilliant reasoning that the IMO team member discovered! The moral of this story: It is true that the USF students worked in a group and took a few days (working for several hours intensively) while the IMO team member solved the problem alone in 40 minutes. However, the USF students are less talented, and much less experienced. They had the courage to tackle a really hard problem, and the tenacity to stick with it until they solved it. Their very impressive achievement shows that high-level problem-solving skills are “teachable;” that bright but inexperienced people can do just about anything when properly guided and encouraged. References 1. Gerald L. Alexanderson, Leonard F. Klosinski, and Loren C. Larson, editors. The William Lowell Putnam Mathematical Competition. The Mathematical Associa- tion of America, 1985. 2. Edward J. Barbeau, Murray S. Klamkin, and William O. J. Moser. Five Hundred Mathematical Challenges. The Mathematical Association of America, 1995. 3. Vladimir Boltyanski and Alexander Soifer. Geometric Etudes in Combinatorial Geometry. Center for Excellence in Mathematical Education, 1991. 4. Ilia Itenberg Dmitri Fomin, Sergey Genkin. Mathematical Circles (Russian Expe- rience). American Mathematical Society, 1996. 5. Michael Doob, editor. The Canadian Mathematical Olympiad 1969–1993. Cana- dian Mathematical Society, 1993. 6. Dmitry Fomin and Alexey Kirichenko. Leningrad Mathematical Olympiads 1987–1991. MathPro Press, 1991. 7. George T. Gilbert, Mark I. Krusemeyer, and Loren C. Larson. The Wohascum County Problem Book. The Mathematical Association of America, 1993. 8. A. M. Gleason, R. E. Greenwood, and L. M. Kelly, editors. The William Lowell Putnam Mathematical Competition. The Mathematical Association of America, 1980. 9. Ronald L. Graham, Donald E. Knuth, and Oren Patashnik. Concrete Mathematics. Addison-Wesley, 1989. 10. Samuel L. Greitzer. International Mathematical Olympiads 1978-1985. The Mathematical Association of America, 1978. 11. Nora Hartsﬁeld and Gerhard Ringel. Pearls in Graph Theory. Academic Press, revised edition, 1994. 12. I. N. Herstein. Topics in Algebra. Blaisdell, 1964. 13. Ross Honsberger. Mathematical Gems II. The Mathematical Association of America, 1976. 14. Kiran S. Kedlaya, Bjorn Poonen, and Ravi Vakil, editors. The William Lowell Putnam Mathematical Competition. The Mathematical Association of America, 2002. 15. Murray S. Klamkin. International Mathematical Olympiads 1978-1985. The Mathematical Association of America, 1986. 16. Jozsef Kurschak. Hungarian Problem Book I. The Mathematical Association of America, 1963. 17. Jozsef Kurschak. Hungarian Problem Book II. The Mathematical Association of America, 1963. 75 76 REFERENCES 18. Andy Liu, editor. Hungarian Problem Book II. The Mathematical Association of America, 2001. 19. Frederick Mosteller. Fifty Challenging Problems in Probability with Solutions. Dover, 1987. 20. Tristan Needham. Visual Complex Analysis. Oxford University Press, 1997. 21. Ivan Niven, Herbert S. Zuckerman, and Hugh L. Montgomery. An Introduction to the Theory of Numbers. John Wiley & Sons, ﬁfth edition, 1991. 22. D. O. Shklarsky, N. N. Chentzov, and I. M. Yaglom. The USSR Olympiad Problem Book. Freeman, 1962. 23. Alan Tucker. Applied Combinatorics. John Wiley & Sons, third edition, 1995. 24. Ravi Vakil. A Mathematical Mosaic: Patterns and Problem Solving. Brendan Kelly, 1996. 25. Charles Vanden Eynden. Elementary Number Theory. McGraw-Hill, 1987. 26. Stan Wagon. Fourteen proofs of a result about tiling a rectangle. American Math- ematical Monthly, 94:601–617, 1987. 27. Herbert S. Wilf. generatingfunctionology. Academic Press, 1994.","libVersion":"0.3.1","langs":""}
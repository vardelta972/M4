{"path":"iCloudDrive/bks/OlympiadQPs/USAMO PYQ/2023.pdf","text":"USAMO 2023 Solution Notes Evan Chen《陳誼廷》 10 August 2023 This is a compilation of solutions for the 2023 USAMO. Some of the solutions are my own work, but many are from the official solutions provided by the organizers (for which they hold any copyrights), and others were found by users on the Art of Problem Solving forums. These notes will tend to be a bit more advanced and terse than the “official” solutions from the organizers. In particular, if a theorem or technique is not known to beginners but is still considered “standard”, then I often prefer to use this theory anyways, rather than try to work around or conceal it. For example, in geometry problems I typically use directed angles without further comment, rather than awkwardly work around configuration issues. Similarly, sentences like “let R denote the set of real numbers” are typically omitted entirely. Corrections and comments are welcome! Contents 0 Problems 2 1 Solutions to Day 1 3 1.1 USAMO 2023/1, proposed by Holden Mui . . . . . . . . . . . . . . . . . . 3 1.2 USAMO 2023/2, proposed by Carl Schildkraut . . . . . . . . . . . . . . . 7 1.3 USAMO 2023/3, proposed by Holden Mui . . . . . . . . . . . . . . . . . . 8 2 Solutions to Day 2 12 2.1 USAMO 2023/4, proposed by Carl Schildkraut . . . . . . . . . . . . . . . 12 2.2 USAMO 2023/5, proposed by Ankan Bhattacharya . . . . . . . . . . . . . 13 2.3 USAMO 2023/6, proposed by Zack Chroman . . . . . . . . . . . . . . . . 15 1 USAMO 2023 Solution Notes web.evanchen.cc, updated 10 August 2023 §0 Problems 1. In an acute triangle ABC, let M be the midpoint of BC. Let P be the foot of the perpendicular from C to AM . Suppose that the circumcircle of triangle ABP intersects line BC at two distinct points B and Q. Let N be the midpoint of AQ. Prove that N B = N C. 2. Solve over the positive real numbers the functional equation f (xy + f (x)) = xf (y) + 2. 3. Consider an n-by-n board of unit squares for some odd positive integer n. We say that a collection C of identical dominoes is a maximal grid-aligned configuration on the board if C consists of (n2 − 1)/2 dominoes where each domino covers exactly two neighboring squares and the dominoes don’t overlap: C then covers all but one square on the board. We are allowed to slide (but not rotate) a domino on the board to cover the uncovered square, resulting in a new maximal grid- aligned configuration with another square uncovered. Let k(C) be the number of distinct maximal grid-aligned configurations obtainable from C by repeatedly sliding dominoes. Find all possible values of k(C) as a function of n. 4. Positive integers a and N are fixed, and N positive integers are written on a blackboard. Alice and Bob play the following game. On Alice’s turn, she must replace some integer n on the board with n + a, and on Bob’s turn he must replace some even integer n on the board with n/2. Alice goes first and they alternate turns. If on his turn Bob has no valid moves, the game ends. After analyzing the N integers on the board, Bob realizes that, regardless of what moves Alice makes, he will be able to force the game to end eventually. Show that, in fact, for this value of a and these N integers on the board, the game is guaranteed to end regardless of Alice’s or Bob’s moves. 5. Let n ≥ 3 be an integer. We say that an arrangement of the numbers 1, 2, . . . , n2 in an n × n table is row-valid if the numbers in each row can be permuted to form an arithmetic progression, and column-valid if the numbers in each column can be permuted to form an arithmetic progression. For what values of n is it possible to transform any row-valid arrangement into a column-valid arrangement by permuting the numbers in each row? 6. Let ABC be a triangle with incenter I and excenters Ia, Ib, Ic opposite A, B, and C, respectively. Given an arbitrary point D on the circumcircle of △ABC that does not lie on any of the lines IIa, IbIc, or BC, suppose the circumcircles of △DIIa and △DIbIc intersect at two distinct points D and F . If E is the intersection of lines DF and BC, prove that ∠BAD = ∠EAC. 2 USAMO 2023 Solution Notes web.evanchen.cc, updated 10 August 2023 §1 Solutions to Day 1 §1.1 USAMO 2023/1, proposed by Holden Mui Available online at https://aops.com/community/p27349297. Problem statement In an acute triangle ABC, let M be the midpoint of BC. Let P be the foot of the perpendicular from C to AM . Suppose that the circumcircle of triangle ABP intersects line BC at two distinct points B and Q. Let N be the midpoint of AQ. Prove that N B = N C. We show several different approaches. In all solutions, let D denote the foot of the altitude from A. A B CD M P Q N R ¶ Most common synthetic approach The solution hinges on the following claim: Claim — Q coincides with the reflection of D across M . Proof. Note that ∡ADC = ∡AP C = 90◦, so ADP C is cyclic. Then by power of a point (with the lengths directed), M B · M Q = M A · M P = M C · M D. Since M B = M C, the claim follows. It follows that M N ∥ AD, as M and N are respectively the midpoints of AQ and DQ. Thus M N ⊥ BC, and so N lies on the perpendicular bisector of BC, as needed. 3 USAMO 2023 Solution Notes web.evanchen.cc, updated 10 August 2023 Remark (David Lin). One can prove the main claim without power of a point as well, as follows: Let R be the foot from B to AM , so BRCP is a parallelogram. Note that ABDR is cyclic, and hence ∡DRM = ∡DBA = QBA = ∡QP A = ∡QP M. Thus, DR ∥ P Q, so DRQ is also a parallelogram. ¶ Synthetic approach with no additional points at all Claim — △BP C ∼ △AN M (oppositely oriented). Proof. We have △BM P ∼ △AM Q from the given concyclicity of ABP Q. Then BM BP = AM AQ =⇒ 2BM BP = AM AQ/2 =⇒ BC BP = AM AN implying the similarity (since ∡M AQ = ∡BP M ). This similarity gives us the equality of directed angles ∡ (BC, M N ) = −∡ (P C, AM ) = 90◦ as desired. ¶ Synthetic approach using only the point R Again let R be the foot from B to AM , so BRCP is a parallelogram. Claim — ARQC is cyclic; equivalently, △M AQ ∼ △M CR. Proof. M R · M A = M P · M A = M B · M Q = M C · M Q. Note that in △M CR, the M -median is parallel to CP and hence perpendicular to RM . The same should be true in △M AQ by the similarity, so M N ⊥ M Q as needed. ¶ Cartesian coordinates approach with power of a point Suppose we set B = (−1, 0), M = (0, 0), C = (1, 0), and A = (a, b). One may compute: ←−→ AM : 0 = bx − ay ⇐⇒ y = b a x ←→ CP : 0 = a(x − 1) + by ⇐⇒ y = − a b (x − 1) = − a b x + a b . P = ( a2 a2 + b2 , ab a2 + b2 ) Now note that AM = √ a2 + b2, P M = a √a2 + b2 together with power of a point AM · P M = BM · QM to immediately deduce that Q = (a, 0). Hence N = (0, b/2) and we’re done. 4 USAMO 2023 Solution Notes web.evanchen.cc, updated 10 August 2023 ¶ Cartesian coordinates approach without power of a point (outline) After computing A and P as above, one could also directly calculate Perpendicular bisector of AB : y = − a + 1 b x + a2 + b2 − 1 2b Perpendicular bisector of P B : y = − ( 2a b + b a ) x − b 2a Perpendicular bisector of P A : y = − a b x + a + a2 + b2 2b . Circumcenter of △P AB = (− a + 1 2 , 2a2 + 2a + b2 2b ) . This is enough to extract the coordinates of Q = (•, 0), because B = (−1, 0) is given, and the x-coordinate of the circumcenter should be the average of the x-coordinates of B and Q. In other words, Q = (−a, 0). Hence, N = (0, b 2 ), as needed. ¶ Ill-advised barycentric approach (outline) Use reference triangle ABC. The A- median is parametrized by (t : 1 : 1) for t ∈ R. So because of CP ⊥ AM , we are looking for t such that ( t ⃗A + ⃗B + ⃗C t + 2 − ⃗C ) ⊥ ( A − ⃗B + ⃗C 2 ) . This is equivalent to (t ⃗A + ⃗B − (t + 1) ⃗C) ⊥ (2 ⃗A − ⃗B − ⃗C) . By the perpendicularity formula for barycentric coordinates (EGMO 7.16), this is equiva- lent to 0 = a 2t − b 2 · (3t + 2) + c 2 · (2 − t) = (a 2 − 3b 2 − c 2) t − 2(b 2 − c 2) =⇒ t = 2(b2 − c2) a2 − 3b2 − c2 . In other words, P = (2(b 2 − c 2) : a 2 − 3b 2 − c 2 : a 2 − 3b 2 − c 2) . A long calculation gives a2yP zP + b2zP xP + c2xP yP = (a2 − 3b2 − c2)(a2 − b2 + c2)(a2 − 2b2 − 2c2). Together with xP + yP + zP = 2a2 − 4b2 − 4c2, this makes the equation of (ABP ) as 0 = −a2yz − b 2zx − c 2xy + a2 − b2 + c2 2 z(x + y + z). To solve for Q, set x = 0 to get to get a 2yz = a2 − b2 + c2 2 z(y + z) =⇒ y z = a2 − b2 + c2 a2 + b2 − c2 . In other words, Q = (0 : a 2 − b 2 + c 2 : a2 + b 2 − c 2) . Taking the average with A = (1, 0, 0) then gives N = (2a 2 : a2 − b 2 + c 2 : a 2 + b 2 − c 2) . The equation for the perpendicular bisector of BC is given by (see EGMO 7.19) 0 = a 2(z − y) + x(c 2 − b 2) which contains N , as needed. 5 USAMO 2023 Solution Notes web.evanchen.cc, updated 10 August 2023 ¶ Extremely ill-advised complex numbers approaches (outline) Suppose we pick a, b, c as the unit circle, and let m = (b + c)/2. Using the fully general “foot” formula, one can get p = (a − m)c + (a − m)c + am − am 2(a − m) = a2b − a2c − ab2 − 2abc − ac2 + b2c + 3bc2 4bc − 2a(b + c) Meanwhile, an extremely ugly calculation will eventually yield q = bc a + b + c − a 2 so n = a + q 2 = a + b + c + bc a 4 = (a + b)(a + c) 2a . There are a few ways to then verify N B = N C. The simplest seems to be to verify that n − b+c 2 b − c = a − b − c + bc a 4(b − c) = (a − b)(a − c) 2a(b − c) is pure imaginary, which is clear. 6 USAMO 2023 Solution Notes web.evanchen.cc, updated 10 August 2023 §1.2 USAMO 2023/2, proposed by Carl Schildkraut Available online at https://aops.com/community/p27349314. Problem statement Solve over the positive real numbers the functional equation f (xy + f (x)) = xf (y) + 2. The answer is f (x) ≡ x + 1, which is easily verified to be the only linear solution. We show conversely that f is linear. Let P (x, y) be the assertion. Claim — f is weakly increasing. Proof. Assume for contradiction a > b but f (a) < f (b). Choose y such that ay + f (a) = by + f (b), that is y = f (b)−f (a) a−b . Then P (a, y) and P (b, y) gives af (y) + 2 = bf (y) + 2, which is impossible. Claim (Up to an error of 2, f is linear) — We have |f (x) − (Kx + C)| ≤ 2 where K := 2 f (1) and C := f (f (1)) − 2 are constants. Proof. Note P (1, y) gives f (y + f (1)) = f (y) + 2 . Hence, f (nf (1)) = 2(n − 1) + f (f (1)) for n ≥ 1. Combined with weakly increasing, this gives 2 ⌊ x f (1) ⌋ + C ≤ f (x) ≤ 2 ⌈ x f (1) ⌉ + C which implies the result. Rewrite the previous claim to the simpler f (x) = Kx + O(1). Then for any x and y, the above claim gives K (xy + Kx + O(1)) + O(1) = xf (y) + 2 which means that x · (Ky + K2 − f (y)) = O(1). If we fix y and consider large x, we see this can only happen if Ky + K2 − f (y) = 0, i.e. f is linear. 7 USAMO 2023 Solution Notes web.evanchen.cc, updated 10 August 2023 §1.3 USAMO 2023/3, proposed by Holden Mui Available online at https://aops.com/community/p27349464. Problem statement Consider an n-by-n board of unit squares for some odd positive integer n. We say that a collection C of identical dominoes is a maximal grid-aligned configuration on the board if C consists of (n2 − 1)/2 dominoes where each domino covers exactly two neighboring squares and the dominoes don’t overlap: C then covers all but one square on the board. We are allowed to slide (but not rotate) a domino on the board to cover the uncovered square, resulting in a new maximal grid-aligned configuration with another square uncovered. Let k(C) be the number of distinct maximal grid-aligned configurations obtainable from C by repeatedly sliding dominoes. Find all possible values of k(C) as a function of n. The answer is that k(C) ∈ { 1, 2, . . . , ( n − 1 2 )2} ∪ {( n + 1 2 )2} . Index the squares by coordinates (x, y) ∈ {1, 2, . . . , n}2. We say a square is special if it is empty or it has the same parity in both coordinates as the empty square. We now proceed in two cases: ¶ The special squares have both odd coordinates We construct a directed graph G = G(C) whose vertices are special squares as follows: for each domino on a special square s, we draw a directed edge from s to the special square that domino points to. Thus all special squares have an outgoing edge except the empty cell. Claim — Any undirected connected component of G is acyclic unless the cycle contains the empty square inside it. Proof. Consider a cycle of G; we are going to prove that the number of chessboard cells enclosed is always odd. 8 USAMO 2023 Solution Notes web.evanchen.cc, updated 10 August 2023 This can be proven directly by induction, but for theatrical effect, we use Pick’s theorem. Mark the center of every chessboard cell on or inside the cycle to get a lattice. The dominoes of the cycle then enclose a polyominoe which actually consists of 2 × 2 squares, meaning its area is a multiple of 4. Hence B/2 + I − 1 is a multiple of 4, in the notation of Pick’s theorem. As B is twice the number of dominoes, and a parity argument on the special squares shows that number is even, it follows that B is also a multiple of 4 (these correspond to blue and black in the figure above). This means I is odd (the red dots in the figure above), as desired. Let T be the connected component containing the empty cell. By the claim, T is acyclic, so it’s a tree. Now, notice that all the arrows point along T towards the empty cell, and moving a domino corresponds to flipping an arrow. Therefore: Claim — k(C) is exactly the number of vertices of T . Proof. Starting with the underlying tree, the set of possible graphs is described by picking one vertex to be the sink (the empty cell) and then directing all arrows towards it. This implies that k(C) ≤ ( n+1 2 )2 in this case. Equality is achieved if T is a spanning tree of G. One example of a way to achieve this is using the snake configuration below. Remark. In Russia 1997/11.8 it’s shown that as long as the missing square is a corner, we have G = T . The proof is given implicitly from our work here: when the empty cell is in a corner, it cannot be surrounded, ergo the resulting graph has no cycles at all. And since the overall graph has one fewer edge than vertex, it’s a tree. Conversely, suppose T was not a spanning tree, i.e. T ̸= G. Since in this odd-odd case, G has one fewer edge than vertex, if G is not a tree, then it must contain at least one cycle. That cycle encloses every special square of T . In particular, this means that T 9 USAMO 2023 Solution Notes web.evanchen.cc, updated 10 August 2023 can’t contain any special squares from the outermost row or column of the n × n grid. In this situation, we therefore have k(C) ≤ ( n−3 2 )2. ¶ The special squares have both even coordinates We construct the analogous graph G on the same special squares. However, in this case, some of the points may not have outgoing edges, because their domino may “point” outside the grid. As before, the connected component T containing the empty square is a tree, and k(C) is exactly the number of vertices of T . Thus to finish the problem we need to give, for each k ∈ {1, 2, . . . , ( n−1 2 )2}, an example of a configuration where G has exactly k vertices. The construction starts with a “snake” picture for k = ( n−1 2 )2, then decreases k by one by perturbing a suitable set of dominoes. Rather than write out the procedure in words, we show the sequence of nine pictures for n = 7 (where k = 9, 8, . . . , 1); the generalization to larger n is straightforward. 10 USAMO 2023 Solution Notes web.evanchen.cc, updated 10 August 2023 11 USAMO 2023 Solution Notes web.evanchen.cc, updated 10 August 2023 §2 Solutions to Day 2 §2.1 USAMO 2023/4, proposed by Carl Schildkraut Available online at https://aops.com/community/p27349336. Problem statement Positive integers a and N are fixed, and N positive integers are written on a blackboard. Alice and Bob play the following game. On Alice’s turn, she must replace some integer n on the board with n + a, and on Bob’s turn he must replace some even integer n on the board with n/2. Alice goes first and they alternate turns. If on his turn Bob has no valid moves, the game ends. After analyzing the N integers on the board, Bob realizes that, regardless of what moves Alice makes, he will be able to force the game to end eventually. Show that, in fact, for this value of a and these N integers on the board, the game is guaranteed to end regardless of Alice’s or Bob’s moves. For N = 1, there is nothing to prove. We address N ≥ 2 only henceforth. Let S denote the numbers on the board. Claim — When N ≥ 2, if ν2(x) < ν2(a) for all x ∈ S, the game must terminate no matter what either player does. Proof. The ν2 of a number is unchanged by Alice’s move and decreases by one on Bob’s move. The game ends when every ν2 is zero. Hence, in fact the game will always terminate in exactly ∑x∈S ν2(x) moves in this case, regardless of what either player does. Claim — When N ≥ 2, if there exists a number x on the board such that ν2(x) ≥ ν2(a), then Alice can cause the game to go on forever. Proof. Denote by x the first entry of the board (its value changes over time). Then Alice’s strategy is to: • Operate on the first entry if ν2(x) = ν2(a) (the new entry thus has ν2(x+a) > ν2(a)); • Operate on any other entry besides the first one, otherwise. A double induction then shows that • Just before each of Bob’s turns, ν2(x) > ν2(a) always holds; and • After each of Bob’s turns, ν2(x) ≥ ν2(a) always holds. In particular Bob will never run out of legal moves, since halving x is always legal. 12 USAMO 2023 Solution Notes web.evanchen.cc, updated 10 August 2023 §2.2 USAMO 2023/5, proposed by Ankan Bhattacharya Available online at https://aops.com/community/p27349487. Problem statement Let n ≥ 3 be an integer. We say that an arrangement of the numbers 1, 2, . . . , n2 in an n × n table is row-valid if the numbers in each row can be permuted to form an arithmetic progression, and column-valid if the numbers in each column can be permuted to form an arithmetic progression. For what values of n is it possible to transform any row-valid arrangement into a column-valid arrangement by permuting the numbers in each row? Answer: n prime only. ¶ Proof for n prime Suppose n = p. In an arithmetic progression with p terms, it’s easy to see that either every term has a different residue modulo p (if the common difference is not a multiple of p), or all of the residues coincide (when the common difference is a multiple of p). So, look at the multiples of p in a row-valid table; there is either 1 or p per row. As there are p such numbers total, there are two cases: • If all the multiples of p are in the same row, then the common difference in each row is a multiple of p. In fact, it must be exactly p for size reasons. In other words, up to permutation the rows are just the k (mod p) numbers in some order, and this is obviously column-valid because we can now permute such that the kth column contains exactly {(k − 1)p + 1, (k − 1)p + 2, . . . , kp}. • If all the multiples of p are in different rows, then it follows each row contains every residue modulo p exactly once. So we can permute to a column-valid arrangement by ensuring the kth column contains all the k (mod p) numbers. ¶ Counterexample for n composite (due to Anton Trygub) Let p be any prime divisor of n. Construct the table as follows: • Row 1 contains 1 through n. • Rows 2 through p + 1 contain the numbers from p + 1 to np + n partitioned into arithmetic progressions with common difference p. • The rest of the rows contain the remaining numbers in reading order. For example, when p = 2 and n = 10, we get the following table:                 1 2 3 4 5 6 7 8 9 10 11 13 15 17 19 21 23 25 27 29 12 14 16 18 20 22 24 26 28 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100                 13 USAMO 2023 Solution Notes web.evanchen.cc, updated 10 August 2023 We claim this works fine. Assume for contradiction the rows may be permuted to obtain a column-valid arrangement. Then the n columns should be arithmetic progressions whose smallest element is in [1, n] and whose largest element is in [n2 − n + 1, n2]. These two elements must be congruent modulo n − 1, so in particular the column containing 2 must end with n2 − n + 2. Hence in that column, the common difference must in fact be exactly n. And yet n + 2 and 2n + 2 are in the same row, contradiction. 14 USAMO 2023 Solution Notes web.evanchen.cc, updated 10 August 2023 §2.3 USAMO 2023/6, proposed by Zack Chroman Available online at https://aops.com/community/p27349354. Problem statement Let ABC be a triangle with incenter I and excenters Ia, Ib, Ic opposite A, B, and C, respectively. Given an arbitrary point D on the circumcircle of △ABC that does not lie on any of the lines IIa, IbIc, or BC, suppose the circumcircles of △DIIa and △DIbIc intersect at two distinct points D and F . If E is the intersection of lines DF and BC, prove that ∠BAD = ∠EAC. Here are a two approaches. A B C D E I M Ia Ib Ic F ¶ Barycentric coordinates (Carl Schildkraut) With reference triangle △ABC, set D = (r : s : t). Claim — The equations of (DIIa) and (DIbIc) are, respectively, 0 = −a2yz − b 2zx − c 2xy + (x + y + z) · ( bcx − bcr cs − bt (cy − bz) ) 0 = −a2yz − b 2zx − c 2xy + (x + y + z) · ( −bcx + bcr cs + bt (cy + bz)) . Proof. Since D ∈ (ABC), we have a2st + b2tr + c2rs = 0. Now each equation can be verified by direct substitution of three points. By EGMO Lemma 7.24, the radical axis is then given by DF : bcx − bcr cs − bt (cy − bz) = −bcx + bcr cs + bt (cy + bz). 15 USAMO 2023 Solution Notes web.evanchen.cc, updated 10 August 2023 Now the point ( 0 : b2 s : c2 t ) = (0 : b 2t : c 2s) lies on line DF by inspection, and is obviously on line BC, hence it coincides with E. This lies on the isogonal of AD (by EGMO Lemma 7.6), as needed. ¶ Synthetic approach (Anant Mudgal) Focus on just (DIIa). Let P be the second intersection of (DIIa) with (ABC), and let M be the midpoint of minor arc ˜BC. Then by radical axis, lines AM , DP , and BC are concurrent at a point K. Let E′ = P M ∩ BC. A B C D E′ I M Ia K P X Claim — We have ∡BAD = ∡E′AC. Proof. By shooting lemma, AKE′P is cyclic, so ∡KAE′ = ∡KP E′ = ∡DP M = ∡DAM. Claim — The power of point E′ with respect to (DIIa) is 2E′B · E′C. Proof. Construct parallelogram IE′IaX. Since M I 2 = M E′ · M P , we can get ∡XIaI = ∡IaIE′ = ∡M IE′ = ∡M P I = ∡XP I. Hence X lies on (DIIa), and E′X · E′P = 2E′M · E′P = 2E′B · E′C. Repeat the argument on (DIbIc); the same point E′ (because of the first claim) then has power 2E′B · E′C with respect to (DIbIc). Hence E′ lies on the radical axis of (DIIa) and (DIbIc), ergo E′ = E. The first claim then solves the problem. 16","libVersion":"0.3.1","langs":""}
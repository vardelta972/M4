{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/a^n+-1 Solutions - Yufei Zhao - Trinity Training 2011.pdf","text":"Trinity Training 2011 a n ± 1 Yufei Zhao a n ± 1 Solutions Yufei Zhao Trinity College, Cambridge yufei.zhao@gmail.com April 2011 Practice problems: 1. A primitive root mod n is a number g such that the smallest positive integer k for which gk ≡ 1 mod n is ϕ(n). (a) Show that 2 is a primitive root mod 3n for any n ≥ 1. (b) Show that if g is an odd primitive root mod p such that p2 ∤ gp−1 − 1, then g is also a primitive root mod pn and 2pn for any n ≥ 1. Solution. (a) Since ϕ(3n) = 2 · 3n−1, the problem amounts to showing that 3n ∤ 23n−1 − 1 and 3n ∤ 22·3n−2 − 1 (when n ≥ 2). The ﬁrst claim follows from reduction mod 3, and the second claim follows from the exponent lifting trick, as 3 ∥ 22 −1, so that 3n−1 ∥ 22·3n−2 −1. (b) Since ϕ(pn) = ϕ(2pn) = (p − 1)pn−1, it suﬃces to show pn ∤ g(p−1)pn−2 − 1 and pn ∤ gdpn−1 − 1 for any divisor d of p − 1 with d < p − 1. The ﬁrst claim follows from pn−1 ∥ g(p−1)pn−2 − 1 by the exponent lifting trick as p ∥ gp−1 − 1 by assumption, and the second claim follows from the fact that p | gm − 1 if and only if (p − 1) | m as g is a primitive root mod p. 2. (Cyclotomic polynomials) For a positive integer n, deﬁne the polynomial Φn(x) by Φn(x) = ∏ 1≤k≤n gcd(n,k)=1 (x − e 2πik n ). (a) Prove the polynomial identity ∏d|n Φd(x) = xn − 1, where the product is taken over all divisors d of n. (b) Prove that Φn(x) is an integer polynomial. (c) Let m and n be positive integers, and let p be a prime divisor of Φn(m). Prove that either p | n or n | p − 1. (d) (Special case of Dirichlet’s theorem) Prove that for every positive integer n, there are inﬁnitely many primes p with p ≡ 1 (mod n). Solution. (a) The right-hand side polynomial xn − 1 can be factored as ∏n k=1(x − e 2πik n ). For1 ≤ k ≤ n, each factor x − e 2πik n appears exactly once in the left hand side (in Φd(x) for d = n gcd(n,k) ) and all factors in the left hand side are of this form. (b) Use induction on d. We have Φ1(x) = x − 1. Suppose Φd(x) is an integer polynomial for all d < n. Then by (a) Φn(x) is the quotient of two monic integer polynomials, and hence it must also be an integer polynomial. (c) Suppose p ∤ n and n ∤ p − 1. We have p | Φn(m) | mn − 1 by (a). So p ∤ m, and hence p | mp−1 − 1 by Fermat’s little theorem. Thus p | mgcd(p−1,n) − 1. Since n ∤ p − 1, 1 Trinity Training 2011 a n ± 1 Yufei Zhao gcd(p − 1, n) < n. Since p ∤ n, we know p ∤ n gcd(p−1,n) . Suppose pk ∥ mgcd(p−1,n) − 1. By the exponent lifting trick, we have pk ∥ mn − 1. However, from (a) we know that the polynomial Φn(x) is a factor of xn−1 xgcd(p−1,n)−1 . Setting x = m gives us a contradiction, since on one hand we have p | Φn(m) but on the other hand p does not divide mn−1 mgcd(p−1,n)−1 as it is the quotient of two numbers both exactly divisible by pk. (d) It suﬃces to show that for every positive integer n ≥ 2, there is at least one prime p with p ≡ 1 (mod n), since then we can ﬁnd inﬁnitely many such p by ﬁnding primes pk such that pk ≡ 1 (mod kn) for each k ≥ 1. For n ≥ 2, |Φn(n)| > 1. Let p be a prime divisor of Φn(n). Since Φn(n) | nn − 1 by (a), p ∤ n, so n | p − 1 by part (b). This gives us the desired prime. 3. (IMO 2003) Let p be a prime number. Prove that there exists a prime number q such that for every integer n, np − p is not divisible by q. Solution. Let q be a prime divisor of Φp(p) = pp−1 p−1 = pp−1 + pp−2 + · · · + p + 1 with p2 ∤ q − 1 (this must exist since Φp(p) ̸≡ 1 (mod p2)). By problem 2, p | q − 1. If np ≡ p (mod q), then p q−1 p ≡ nq−1 ≡ 1 (mod q). We have q | gcd(p q−1 p −1, pp−1) = p gcd( q−1 p ,p)−1, which equals to p − 1 since p2 ∤ q − 1. However, we cannot simultaneously have q | p − 1 and p | q − 1. Thus np − p is not divisible by q. 4. (a) Prove that Φm(x) and Φn(x) are always relatively prime as polynomials for m ̸= n. (b) Show that if for some integer x, Φm(x) and Φn(x) are not relative prime, then m/n is an integer power of a prime. Solution. (a) The zeros of Φn(x) and Φm(x) are distinct, since the zeros of Φn(x) are precisely the primitive n-th roots of unity. Thus the polynomials are relatively prime. (b) Suppose some prime p divides both Φm(x) and Φn(x). By replacing x by x + p if necessary, we may assume that x > 1. Let us deal with the p = 2 case separately. We claim that if Φm(x) is even then m must be a power of 2. Indeed, otherwise let q be an odd prime divisor of m, and let m = qs, then by the previous problem, Φm(x) divides xm−1 xs−1 = x(q−1)s + x(q−2)s + · · · + xs + 1, which is always odd. The p = 2 case follows. Now assume that p > 2. By the previous problem, p divides xm − 1 and xn − 1, and hence p | xgcd(m,n) − 1. Let pk ∥ xgcd(m,n) − 1. One of m gcd(m,n) and n gcd(m,n) is not divisible by p, and assume that it is the latter. Then by the exponent lifting trick, pk ∥ xn − 1. If gcd(m, n) < n, then Φn(x) divides xn−1 xgcd(m,n)−1 , which is not divisible by p by the above analysis. This contradicts p | Φn(x). Hence gcd(m, n) = n, i.e., n | m. We claim that m n is a power of p. If not, then pick some prime q dividing m n . We have p | Φn(x) | xn − 1 | xm/q − 1. By the exponent lifting trick, the same power of p divides both xm − 1 and xm/q − 1. But Φm(x) divides xm−1 xm/q−1 , which contradicts p | Φm(x). Thus m n is a power of p. 5. Let p1, p2, . . . , pk be distinct primes greater than 3. Let N = 2p1p2···pk + 1. (a) (IMO Shortlist 2002) Show that N has at least 4n divisors. (b) Show that N has at least 22k−1 divisors. (Hint: use cyclotomic polynomials) Solution. (a) Observe that if a and b are coprime odd numbers, then gcd(2a +1, 2b +1) = 3, since their gcd must divide gcd(22a − 1, 22b − 1) = 2gcd(2a,2b) − 1 = 22 − 1 = 3. Since 2ab + 1 is divisible by both 2a + 1 and 2b + 1, it must also be divisible by 1 3 (2a + 1)(2b + 1). 2 Trinity Training 2011 a n ± 1 Yufei Zhao We use induction on k. When k = 1, 2p1 +1 is divisible by 3 and greater than 9, so it must have at least 4 divisors. Let a = p1 · · · pk−1 and b = pk. Suppose that 2a + 1 has at least 4k−1 divisors. Since 2a + 1 is coprime to 1 3 (2b + 1), the number M = 1 3 (2a + 1)(2b + 1) must have at least 2·4k−1 divisors (for each divisor d of 2a+1, we get two divisors d and 1 3 (2b+1)d of M ). Also M | N and N = 2ab + 1 > M 2 (since 2ab + 1 > 2ab > 22(a+b+1) > M 2). So N has at least 4k divisors (for each divisor d of M , we have divisors d and N/d). This completes the induction. (b) It suﬃces to show that N is divisible by at least 2k−1 distinct prime. We have N = 2 p1···pk + 1 = 22p1···pk − 1 2p1···pk − 1 = ∏d|2p1···pk Φd(x) ∏d|p1···pk Φd(x) = ∏ d|p1···pk Φ2d(2). Consider the set of divisors d of p1 · · · pk with an odd number of prime factors. There are 2k−1 such divisors d, and they provide mutually coprime Φd(2) by Problem 4. Take one prime divisor from each such Φd(2) and we get what we want. 6. (IMO 1990) Determine all positive integers n such that 2n + 1 n2 is an integer. Solution. We claim that the only solutions are n = 1, 3. Suppose n /∈ {1, 3}. Let p be the smallest prime divisor of n. Then p | 2n + 1, so p | 22n − 1. By Fermat’s little theorem, we also have p | 2p−1 − 1. Thus p | 2gcd(p−1,2n) − 1. Since p is the smallest prime divisor of n, we must have gcd(p − 1, 2n) = 2. So p | 22 − 1 and hence p = 3. Suppose 3k ∥ n. We have 3 ∥ 22 − 1. So by the exponent lifting trick, 3k+1 ∥ 22n − 1. If n2 | 2n + 1, then 32k | 22n − 1. Thus 2k ≤ k + 1, hence k = 1. Thus 3 ∥ n. Let n = 3m. Suppose m ̸= 1. Let q denote the smallest prime divisor of m. By the same argument as above, we have q | 2gcd(q−1,6m) − 1, and gcd(q − 1, 6m) ∈ {2, 6}, so q divides either 22 − 1 = 3 or 26 − 1 = 63 = 7 · 32. Since 3 ∥ n, q ̸= 3, so q = 7. However, 2n + 1 = (23)m + 1 ≡ 2 (mod 7), so 7 cannot divide 2n + 1, contradiction. This shows that 1 and 3 are the only solutions. 7. (IMO 2000) Does there exist a positive integer N which is divisible by exactly 2000 diﬀerent prime numbers and such that 2N + 1 is divisible by N ? Solution. Yes. We will show by induction that for any m ≥ 1, there exists a positive integer N divisibly by exactly m diﬀerent prime numbers such that N | 2N + 1. When m = 1, choose N = 3. We will use the following variant of the exponent liﬁting trick: if p is an odd prime, a ≥ 2, k, m ≥ 1, ℓ ≥ 0, n odd, pk ∥ a + 1, and pℓ ∥ n, then pk+ℓ ∥ an + 1. This in fact follows from our usual exponent lifting trick, as neither a − 1 nor an − 1 are divisible by p (since a ≡ −1 (mod p) and n is odd), so the claim follows as pk ∥ a2 − 1 implies pk+ℓ ∥ a2n − 1. Now suppose N = pa1 1 · · · pam m satisﬁes N | 2N + 1, where p1, . . . , pm are distinct prime and ai ≥ 1. Suppose pbi i ∥ 2N + 1 for each i. Write this as p b1 1 · · · pbm m ∥ 2N + 1. Then by above variant of the exponent lifting trick, we have pb1+ℓ 1 pb2 2 · · · pbm m ∥ 2N pℓ 1 + 1. For ℓ suﬃciently large, we also have p b1+ℓ 1 pb2 2 · · · pbm m < 2N pℓ 1 + 1, so that 2N pℓ 1 + 1 has some prime divisor pk+1 distinct from p1, . . . pk. Then N pℓ 1pk+1 | 2N pℓ 1pk+1 + 1, and hence we can choose N ′ = N pℓ 1pk+1 to complete the induction. 8. Let N be a positive integer ending in digits 25, and m a positive integer. Prove that for some positive integer n, the rightmost m digits of 5n and N agree in parity (i.e., for 3 Trinity Training 2011 a n ± 1 Yufei Zhao 1 ≤ k ≤ m, the k-th digit from the right in n is odd if and only if the k-th digit from the right in N is odd). Solution. We will prove by induction on m that there exists inﬁnitely many n that works. This is trivial when m = 1, 2. For the inductive step, it suﬃces to prove the following claim: if n ≥ m ≥ 2, then the rightmost m digits of 5n and 5n+2m−2 agree in parity, but the (m + 1)-th digit from the right diﬀer in parity. By the exponent lifting trick, we have 2m ∥ 52m−2 − 1 as 22 ∥ 5 − 1. It follows that 52m−2+n − 5n is divisible by 10m but not 2 · 10m. The claim follows. 9. (Hensel’s lemma) Let f (x) = cnxn + cn−1x n−1 + · · · + c2x2 + c1x + c0 be a polynomial with integer coeﬃcients. Its derivative f ′ is a polynomial deﬁned by f ′(x) = ncnxn−1 + (n − 1)cn−1xn−2 + · · · + 2c2x + c1. Suppose that a ∈ Z satisﬁes p | f (a) and p ∤ f ′(a). Prove that for any integer k, there exists an integer b satisfying pk | f (b) and p | b − a. Solution. We use induction on k to ﬁnd, for each k ≥ 1, an integer bk, satisfying b1 = a and bk+1 ≡ bk (mod pk) and f (bk) ≡ 0 (mod pk). Note that this implies bk ≡ b1 = a (mod p). When k = 1, we can just take b1 = a. Now assume that k > 1 and bk−1 has already been chosen. Set bk+1 = bk + pkr for some integer r to be decided later. We have f (bk+1) = f (bk + p kr) = n∑ j=0 cj(bk + p kr) j ≡ k∑ j=0 cj(b j k + jpkrb j−1 k ) = f (bk) + p krf ′(bk) (mod pk+1), where the modulo equivalence comes from binomial expansion. (This is related to the taylor expansion in calculus: f (x + ϵ) ≈ f (x) + ϵf ′(x).) From the induction hypothesis, we know pk | f (bk). Also bk ≡ a (mod p), so p ∤ f ′(bk), and hence f ′(bk) has an inverse mod p, say t ∈ Z, satisfying f ′(bk)t ≡ 1 (mod p). Then setting r = − f (bk)t pk , we have f (bk+1) ≡ f (bk) − f (bk)rf ′(bk) = f (bk)(1 − rf ′(bk)) ≡ 0 (mod pk+1). since pk | f (bk) and p | 1 − rf ′(bk). This completes the induction step. 4","libVersion":"0.3.1","langs":""}
{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/descent.pdf","text":"PROOFS BY DESCENT KEITH CONRAD As ordinary methods, such as are found in the books, are inadequate to prov- ing such diﬃcult propositions, I discovered at last a most singular method . . . which I called the inﬁnite descent. Fermat, 1659. 1. Introduction The method of descent is a technique developed by Fermat for proving certain equations have no (or few) integral solutions. The idea is to show that if there is an integral solution to an equation then there is another integral solution which is smaller in some way. Repeat- ing this process and comparing the sizes of the successive solutions leads to an inﬁnitely decreasing sequence a1 > a2 > a3 > · · · of positive integers, and that is impossible. Let’s take a look at two examples. Example 1.1 (Euler). We will show the equation x3 + 2y3 + 4z3 = 0 has no solution in integers other than the obvious solution (0, 0, 0). Assume there is a solution (x, y, z) ̸= (0, 0, 0), so at least one of x, y, and z is not 0. The equation tells us x3 is even, so x is even. Write x = 2x′. Then 8x′3 + 2y3 + 4z3 = 0. Dividing by 2 and rearranging terms, we get y3 + 2z3 + 4x′3 = 0. This is just like our original equation, with (x, y, z) replaced by (y, z, x′). Since y is now playing the role previously played by x, the argument used before on x shows y is even. Writing y = 2y′, substituting this in, and removing a common factor of 2, we get z3 + 2x′3 + 4y′3 = 0. Therefore z is even, so z = 2z′. Substituting this in and simplifying, x′3 + 2y′3 + 4z′3 = 0. Thus (x′, y′, z′) ﬁts the original equation and at least one of x′, y′ or z′ is nonzero (corresponding to whichever of x, y, and z is nonzero). Since 0 < max(|x′|, |y′|, |z′|) = (1/2) max(|x|, |y|, |z|), we have produced a smaller integral solution measured by the maximum absolute value, which is a positive integer. This process can be repeated inﬁnitely often, leading to a contradiction. The same proof shows for any prime p that the equation x3 + py3 + p2z3 = 0 has no integral solution other than (0, 0, 0). Indeed, if (x, y, z) ﬁts the equation then p|x3, so p|x and we can proceed exactly as in the special case p = 2. In Section 2 we will give proofs by descent that certain numbers are irrational. In Section 3 we will show the equation a4 + b4 = c4 (a special case of Fermat’s Last Theorem) has no solution in positive integers using descent. In Section 4 we will use descent to show certain equations have no solution in nonconstant rational functions. In a positive direction, descent will be used in Section 5 to show any prime p such that −1 ≡ □ mod p is a sum of two squares. In Section 6 we will argue by descent that for any integer k > 0 other than 1 or 3, the equation x2 + y2 + z2 = kxyz has no integral solutions (x, y, z) besides (0, 0, 0). While descent may appear to be something like “reverse induction,” it is not as widely applicable in the whole of mathematics as induction. Descent is nevertheless quite central to some important developments in number theory. 1 2 KEITH CONRAD 2. Irrationality by descent Here is the usual proof that √2 is irrational, expressed using the idea of descent. Example 2.1. We assume √2 is rational, so √2 = a/b with positive integers a and b. Squaring both sides and clearing the denominator, 2b2 = a2. (This is an equation we want to show is not solvable in positive integers.) Since 2|a2, 2|a. Write a = 2a′ for some positive integer a′, so 2b2 = 4a′2, which is the same as b2 = 2a′2. Thus 2|b2, so 2|b. Write b = 2b′, so 4b′2 = 2a′2, which is the same as 2b′2 = a′2. Since a′ and b′ are positive, we have √2 = a′/b′, so √2 = a b = a′ b′ . Since b = 2b′ and both b and b′ are positive, 0 < b′ < b, so we started with one rational expression for √2 and found another rational expression with a smaller (positive) denomi- nator. Now we can repeat this process and obtain a sequence of rational expressions for √ 2 with decreasing positive denominators. This can’t go on forever, so we have a contradiction. The way this proof usually is written starts with √2 = a/b where the fraction is in lowest terms. Then the fact that a = 2a′ and b = 2b′, as shown in the theorem, is a contradiction since it means the fraction wasn’t in lowest terms. The method of descent bypassed having to put the fraction in lowest terms, obtaining a contradiction in a diﬀerent way. Let’s take a look at another proof by descent that √2 is irrational. We assume √2 is rational. Since 1 < √2 < 2, we can write (2.1) √2 = 1 + m n , where m and n are positive integers with 0 < m/n < 1, so 0 < m < n. Squaring both sides of (2.1) and clearing the denominator, 2n2 = n2 + 2mn + m 2, so m2 = n2 − 2mn = n(n − 2m). Since m2 and n are positive, so is n − 2m, and m n = n − 2m m . This lies between 0 and 1, by the deﬁnition of m/n, so 0 < n − 2m < m. We have reached the descent step: the fractional part m/n of √2 has been written as a fraction (n − 2m)/m with a smaller denominator than before: 0 < m < n. We can repeat this process again and again, eventually reaching a contradiction. This proof by descent that √2 is irrational is not the same as the proof by descent in Example 2.1, since it does not use anything about even and odd numbers. It also generalizes nicely to other square roots. Theorem 2.2. If d ∈ Z+ and d is not a perfect square then √d is irrational. Proof. (Dedekind, 1858) Suppose √d is rational. Since d is not a perfect square, its square root lies between two consecutive integers. Let ℓ be the integer such that ℓ < √d < ℓ + 1. (Note ℓ is uniquely determined by √d.) Write √d = ℓ + m n , PROOFS BY DESCENT 3 where m and n are positive integers with 0 < m/n < 1, so 0 < m < n. Squaring both sides and clearing the denominator, dn2 = n2ℓ2 + 2mnℓ + m 2, so m2 = nq, where q = n(d − ℓ2) − 2mℓ. Since m2 and n are positive, q is positive. Then m/n = q/m, so √d = ℓ + m n = ℓ + q m . Since q/m = m/n, 0 < q/m < 1, so 0 < q < m. The fraction q/m has a smaller (positive) denominator than m/n, so from one representation √ d − ℓ = m/n we get another represen- tation √d − ℓ = q/m with a smaller (positive) denominator. This leads to a contradiction by repeating this process enough times. □ Here is another proof of Theorem 2.2, using descent in Z2 rather than in Z. The argument is taken from [3]. Proof. Set A = ( 0 d 1 0 ). Its characteristic polynomial is det(λI2 − A) = λ2 − d, with an eigenvalue √d and associated eigenvector (√d 1 ). Assuming √d is rational, write √d = a/b with nonzero integers a and b. Any scalar multiple of an eigenvector is an eigenvector, and (√d 1 ) = (a/b 1 ) can be scaled to (a b). This is also an eigenvector of A: A(a b) = (db a ) = √d (a b). Let ℓ be the integer such that ℓ < √d < ℓ + 1. Then (A − ℓI2)( a b ) = √d ( a b ) − ℓ ( a b ) = ( √d − ℓ) ( a b ) , where √d − ℓ lies between 0 and 1. The integral vector (a b) is an eigenvector of the integral matrix A − ℓI2 with eigenvalue between 0 and 1. Since (a b) is an eigenvector of A − ℓI2, it is also an eigenvector of (A − ℓI2)r for any r ≥ 1, with eigenvalue (√d − ℓ)r: (A − ℓI2)r(a b ) = ( √d − ℓ) r( a b ) . On the left side, for any r ≥ 1 we have a vector in Z2 since A has integer entries and a, b, and ℓ are integers. On the right side we have a nonzero vector (since a, b, and √d − ℓ are nonzero) and it is getting arbitrarily small as r grows since | √d − ℓ| < 1. So we have a sequence of nonzero vectors in Z2 with length shrinking to 0 (the descent idea). This is impossible, so we have a contradiction. □ We can extend the same proof to cube roots, using descent in Z3. Theorem 2.3. If d ∈ Z and d is not a perfect cube then 3√d is irrational. Proof. Suppose 3√d = a/b with nonzero integers a and b. Let A =   0 0 d 1 0 0 0 1 0   , v =   a2 ab b2   , so det(λI3 − A) = λ3 − d and Av = (a/b)v = 3√dv. Let ℓ ∈ Z satisfy ℓ < 3√d < ℓ + 1, so (A − ℓI3)v = ( 3√d − ℓ)v. Then (2.2) (A − ℓI3) rv = ( 3√d − ℓ)rv 4 KEITH CONRAD for all r ≥ 1. Since v ∈ Z3 and A has integer entries, the left side of (2.2) is a vector in Z3. Since v ̸= 0 and 0 < 3√d − ℓ < 1, the right side of (2.2) is nonzero and its length is tending to 0 as r grows. Thus, as r → ∞, the nonzero vectors (A − ℓI3)rv are a sequence in Z3 with length shrinking to 0. This is impossible, so 3√d must be irrational. □ Remark 2.4. In a similar way one can deal with higher roots: if d ∈ Z and k ≥ 2 (with d > 0 if k is even) and d is not a kth power in Z then k√d is irrational. Just assume k√d = a/b is rational and use the k × k matrix and vector A = ( 0 d Ik−1 0 ) , v =      ak−1 ak−2b ... bk−1  | | |  . 3. Fermat’s Last Theorem for n = 4 We will use descent to prove the exponent 4 case of Fermat’s Last Theorem: the equation a4 + b4 = c4 has no solution in positive integers. Fermat proved something more general, allowing a square and not just a fourth power on the right side. Theorem 3.1 (Fermat). There is no solution to the equation x4 + y4 = z2 in positive integers. In particular, the equation a4 + b4 = c4 has no solution in positive integers. Proof. We will use the parametrization of primitive Pythagorean triples, so let’s recall that: a primitive solution to a2 + b2 = c2 where a, b, and c are positive integers with b even is a = k2 − ℓ2, b = 2kℓ, c = k2 + ℓ 2, where k > ℓ, (k, ℓ) = 1, and k ̸≡ ℓ mod 2. Assume there is a solution to x4 + y4 = z2 where x, y, and z are positive integers. If p is a common prime factor of x and y then p4|z2, so p2|z. Then we can cancel the common factor of p4 throughout and get a similar equation with smaller positive values of x, y, and z. Doing this enough times, we may suppose that (x, y) = 1. Then (x, z) = 1 and (y, z) = 1 too. We will ﬁnd a second positive integer solution (x′, y′, z′) with (x′, y′) = 1 which is smaller in a suitable sense. Since x4 + y4 = z2 and (x, y) = 1, at least one of x and y is odd. They can’t both be odd, since otherwise z2 ≡ 2 mod 4, which has no solution. Without loss of generality, say x is odd and y is even. Then z is odd. Since (x2)2 + (y2)2 = z2, (x2, y2, z) is a primitive Pythagorean triple with y2 the even term, so by the formula for primitive triples we can write (3.1) x2 = k2 − ℓ2, y2 = 2kℓ, z = k2 + ℓ2, where k > ℓ > 0 and (k, ℓ) = 1 (also k ̸≡ ℓ mod 2, but we don’t need this). The ﬁrst equation in (3.1) says x2 + ℓ2 = k2. Since (k, ℓ) = 1, (x, ℓ, k) is another primitive Pythagorean triple. Since x is odd, using the formula for primitive Pythagorean triples once again tells us (3.2) x = a2 − b 2, ℓ = 2ab, k = a2 + b 2, where a > b > 0 and (a, b) = 1. The second equation in (3.1) now says y2 = 4(a 2 + b 2)ab. PROOFS BY DESCENT 5 Since y is even, ( y 2 )2 = (a2 + b 2)ab. Since (a, b) = 1, the three factors on the right are pairwise relatively prime. They are all positive, so their product being a square means each one is a square: (3.3) a = x′2, b = y′2, a 2 + b 2 = z′2, where x′, y′, and z′ can all be taken as positive. From (a, b) = 1, (x′, y′) = 1. The last equation in (3.3) can be rewrittten as x′4 + y′4 = z′2, so we have another solution to our original equation with (x′, y′) = 1. Now we compare z′ to z. Since 0 < z′ ≤ z′2 = a 2 + b 2 = k ≤ k2 < z, measuring the size of positive integer solutions (x, y, z) by the size of z leads to a contra- diction by descent. □ Remark 3.2. At the end of the proof a simple estimate showed z > z′2. We can also get a formula for z in terms of x′, y′, and z′ which explains this inequality. By (3.1), (3.2), and (3.3), z = k2 + ℓ 2 = (a2 + b 2)2 + (2ab) 2 = z′4 + 4x′4y′4, so in fact z > z′4, not just z > z′2 as we found before. Let’s write x and y in terms of x′, y′, and z′ too. From (3.2) and (3.3), x = a 2 − b 2 = x′4 − y′4 and y2 = 2kℓ = 2(a2 + b2)(2ab) = 4z′2(x′y′)2, so y = 2x′y′z′. This formula for y shows x′, y′, and z′ are all less than y, so 0 < max(x′, y′, z′) < y ≤ max(x, y, z). Using max(x, y, z) rather than z to measure the size of a solution (x, y, z) is another way to get a contradiction for Theorem 3.1 by descent. Our proof of Theorem 3.1 used the parametric formula for primitive Pythagorean triples twice. For a proof which does not explicitly use this parametrization, see [1, pp. 55–56]. If we apply the descent technique for x4 + y4 = z2 to a4 + b4 = c4, with a fourth power on the right side, then the proof breaks down. The reason is that the descent step will not return another solution of a4 + b4 = c4; the smaller c which comes out will only show up as a square, not a 4th power. So the extra generality of dealing with x4 + y4 = z2 is essential for the descent to work as above. Elementary number theory books that discuss Fermat’s Last Theorem for exponent 4 introduce the equation x4 + y4 = z2 out of the blue, like we did, as if it were the most natural thing in the world to look at this equation instead of a4 + b4 = c4. Of course it isn’t. Fermat was actually thinking about x4 + y4 = z2 not in order to solve a4 + b4 = c4 but for an entirely diﬀerent reason, and it was natural to consider the equation for that other problem. See Appendix A for more details. Now we present a number of corollaries to Theorem 3.1, concerning solvability of certain equations in integers or rationals. None of the proofs (which are mostly short) will involve descent. They are presented here simply to show Theorem 3.1 has uses other than Fermat’s Last Theorem for exponent 4. Corollary 3.3. Any rational solution to x4 + y4 = z2 has x or y equal to 0. 6 KEITH CONRAD Proof. Assume x and y are both nonzero. Then z2 > 0, so z ̸= 0 too. Write x = a/d, y = b/d, and z = c/d with a, b, c, d ∈ Z and d > 0. Then a, b, and c are nonzero. Clearing the denominator in x4 + y4 = z2, we have a4 + b4 = (cd)2. Changing signs if necessary, a, b, and cd are positive. Then we have a contradiction with Theorem 3.1. □ Corollary 3.4. The only rational solutions to y2 = x4 + 1 are (0, ±1). Proof. Use Corollary 3.3 to see x = 0. □ Corollary 3.5. The only rational solutions to 2y2 = x4 − 1 are (±1, 0). Proof. Squaring both sides, 4y4 = x8 − 2x4 + 1. Add 4x4 to both sides and divide by 4 to get y4 + x4 = ((x4 + 1)/2)2. Since x ̸= 0 in the original equation, we can divide by x4 to get (y/x)4 + 1 = ((x4 + 1)/2x2)2. By Corollary 3.4, y/x = 0, so y = 0 and therefore x = ±1. □ Corollary 3.6. The integral solutions of x4 − y4 = 2z2 are (x, ±x, 0). Proof. If y = 0 then x = z = 0 since √2 is irrational. If y ̸= 0, then divide by y4 to get (x/y)4 − 1 = 2(z/y2)2. By Corollary 3.5, z/y2 = 0, so z = 0 and therefore y = ±x. □ Corollary 3.7. The only rational solutions to y2 = x3 − 4x are (0, 0), (±2, 0). Proof. There is a bijection between solutions of y2 = x3 − 4x with x ̸= 0 and solutions to v2 = u4 + 1 by (x, y) 7→ ( y 2x , y2 + 8x 4x2 ) , (u, v) 7→ ( 2 v − u2 , 4u v − u2 ) . Since any rational solution to v2 = u4 + 1 has u = 0, any rational solution to y2 = x3 − 4x has y = 0, so x = 0 or x = ±2. □ Corollary 3.8. The only rational solution to y2 = x3 + x is (0, 0). Proof. Writing the equation as y2 = x(x2 + 1), we see x = 0 if and only if y = 0. Assume there is a rational solution other than (0, 0) so x ̸= 0 and y ̸= 0. From the equation, x must be positive. Write x and y in reduced form as x = a/b and y = c/d where b and d are positive. Clearing denominators in (c/d)2 = (a/b)3 + a/b, we get b 3c 2 = d 2(a 3 + ab 2). Therefore d2|b3c2. Since (c, d) = 1, d2|b3. Also b3|d2(a3 + ab2). Since (a, b) = 1, b3 is relatively prime to a3 + ab2, so b3|d2. Thus b3 = d2, so by unique factorization b = t2 and d = t3 for some positive integer t. Then (a, t) = 1 and (c, t) = 1. In the equation y2 = x3 + x with x = a/t2 and y = c/t3, we get c2 = a3 + t4a = a(a2 + t4) after clearing the denominator. Since (a, t) = 1, a and a2 + t4 are relatively prime and positive. Their product is a square, so each factor is a square: a = u 2, a2 + t4 = v2. Thus u4 + t4 = v2. By Theorem 3.1, u or t is 0. Since t ̸= 0, u = 0 so x = 0 and then y = 0. □ Remark 3.9. Conversely, Corollary 3.8 implies Theorem 3.1. If x4 + y4 = z2 in positive integers then multiplying through by x2/y6 gives us (x/y)6 + (x/y)2 = (xz/y3)2, so Y 2 = X 3 + X for X = (x/y)2 and Y = xz/y3. Since X is a nonzero rational number, we have a contradiction with Corollary 3.8. PROOFS BY DESCENT 7 Here is another theorem about fourth powers and squares proved by Fermat using descent. Theorem 3.10 (Fermat). There is no solution to x4 − y4 = z2 in positive integers. Proof. We will argue by descent in a similar style to the proof of Theorem 3.1. In particular, we will use the formula for primitive Pythagorean triples twice. Since now we have z2 +y4 = x4 while in Theorem 3.1 we had x4+y4 = z2, the roles of x2 and z basically get interchanged. For example, we will use descent on x2 (or equivalently, on x) rather than on z as we did in Theorem 3.1. Assume x4 − y4 = z2 with x, y, and z in Z+. There must be a solution with x, y, and z pairwise relatively prime (see the start of the proof of Theorem 3.1; the same argument there applies here), so we suppose this is the case. Since x4 − y4 > 0, x > y. There are two cases to consider: z odd and z even. Case 1: z is odd. Since z2 + y4 = x4 and z is odd, y must be even. (Otherwise z2 + y4 ≡ 1+1 ≡ 2 mod 4, but 2 is not a 4th power modulo 4.) Since (x, y) = 1, (z, y2, x2) is a primitive Pythagorean triple with y2 the even term, so the formula for primitive Pythagorean triples says (3.4) z = k2 − ℓ2, y2 = 2kℓ, x2 = k2 + ℓ2, where k > ℓ > 0, (k, ℓ) = 1, and k ̸≡ ℓ mod 2. The third equation in (3.4) says (k, ℓ, x) is a Pythagorean triple. Since (k, ℓ) = 1, this triple is primitive. One of k or ℓ is odd and the other is even. If k is odd, the formula for primitive Pythagorean triples says (3.5) k = a2 − b 2, ℓ = 2ab, x = a2 + b 2, where a > b > 0, (a, b) = 1, and a ̸≡ b mod 2. If ℓ is odd the formula says (3.6) ℓ = a 2 − b 2, k = 2ab, x = a2 + b 2, where a > b > 0, (a, b) = 1, and a ̸≡ b mod 2. Using whichever of (3.5) or (3.6) is correct (depending on the parity of k and ℓ), the second equation in (3.4) becomes (3.7) y2 = 4(a 2 − b 2)ab. Since y is even, we can divide by 4 (in Z): ( y 2 )2 = (a2 − b 2)ab. Since (a, b) = 1, the three factors on the right are pairwise relatively prime. They are all positive, so their product being a square means each one is a square: (3.8) a = x′2, b = y′2, a 2 − b 2 = z′2, where x′, y′, and z′ can all be taken as positive. From (a, b) = 1, (x′, y′) = 1. The last equation in (3.8) can be rewrittten as x′4 − y′4 = z′2, so we have another solution to our original equation. Moreover, z′2 = a2 − b2 is odd, so our new solution again has an odd square on the right and we are still in Case 1. Now we compare x′ to x: 0 < x ′ ≤ x′2 = a < a 2 + b 2 = x. Since x′ < x, by descent we have a contradiction. Case 2: z is even. (This has no analogue in the proof of Theorem 3.1.) Since y4 + z2 = x4, we have a primitive Pythagorean triple (y2, z, x2) with even z. Thus y2 = m 2 − n2, z = 2mn, x 2 = m 2 + n2, 8 KEITH CONRAD where m and n are positive and (m, n) = 1. Multiplying the ﬁrst and third equations, (xy)2 = m4 − n4, with xy odd. This expresses a square as the diﬀerence of two fourth powers, with the square being odd, so by Case 1 we have a contradiction. □ Remark 3.11. In Case 1 we can solve for x, y, and z in terms of x′, y′, and z′. From (3.5) or (3.6), x = a2 + b2. This becomes, by (3.8), x = x ′4 + y′4. From (3.7) and (3.8), y2 = 4(a2 − b2)ab = 4z′2(x′2y′2) = (2x′y′z′)2, so y = 2x′y′z′. Lastly, by (3.4), (3.5) or (3.6), and (3.8), z = k2 − ℓ 2 = ±((a 2 − b 2) 2 − (2ab)2) = ±(z′4 − 4x′4y′4), so z = |z′4 − 4x′4y′4|. From the formula y = 2x′y′z′ we get 0 < max(x′, y′, z′) < y ≤ max(x, y, z), so using max(x, y, z) rather than x as a measure of the size of a positive integer solution is another way of reaching a contradiction in Case 1 by descent. This parallels Remark 3.2. Theorems 3.1 and 3.10 together lead to the following two results. Corollary 3.12. There is no Pythagorean triple in which two of the terms are squares. Proof. Such a triple would give a solution in positive integers to either x4 + y4 = z2 (the two legs are squares) or x4 = y4 + z2 (a leg and hypotenuse are squares), but such solutions do not exist by Theorems 3.1 and 3.10. □ There are many primitive Pythagorean triples where just one of the terms is a square. See Table 1. a b c 3 4 5 7 24 25 9 40 41 16 63 65 17 144 145 225 272 353 161 240 289 Table 1. Pythagorean triples with a square term Corollary 3.13. The only m ∈ Z+ such that 1 + 2 + 3 + · · · + m is a fourth power is 1. Proof. Since 1 + 2 + 3 + · · · + m = m(m + 1)/2, we are trying to solve m(m + 1)/2 = n4. Clearing the denominator, m(m + 1) = 2n4. Since m and m + 1 are relatively prime, {m, m + 1} = {x 4, 2y4} PROOFS BY DESCENT 9 for some positive integers x and y, which must be relatively prime. Therefore x4 −2y4 = ±1. Rewrite as y4 = (x4 ∓ 1)/2 and square both sides followed by a little algebra to get (3.9) y8 ± x4 = ( x4 ± 1 2 )2 . The right side is an integer since x is odd from x4 = 2y4 ± 1. Equation (3.9) expresses a sum or diﬀerence of positive fourth powers as a perfect square. Using Theorems 3.1 and 3.10, we see this is impossible for a sum, and for a diﬀerence the square must be 0, so x = 1 (since x > 0). Therefore m = 1. □ Now we present consequences of Theorem 3.10 alone, paralleling the consequences of Theorem 3.1. Corollary 3.14. Any rational solution to x4 − y4 = z2 has y or z equal to 0. Proof. Similar to Corollary 3.3. □ Corollary 3.15. The only rational solutions to y2 = x4 − 1 are (±1, 0). Proof. Similar to Corollary 3.4. □ Corollary 3.16. The only rational solutions to 2y2 = x4 + 1 are (±1, ±1). Proof. Squaring both sides, 4y4 = x8 + 2x4 + 1. Subtract 4x4 from both sides and divide by 4 to get y4 − x4 = ((x4 − 1)/2)2. Since x ̸= 0 in the original equation, we can divide by x4 to get (y/x)4 − 1 = ((x4 − 1)/2x2)2. By Corollary 3.15, (x4 − 1)/2x2 = 0, so x = ±1 and therefore y = ±1. □ Corollary 3.17. The integral solutions of x4 + y4 = 2z2 are (x, ±x, ±x2). Proof. If y = 0 then x = z = 0 since √2 is irrational. If y ̸= 0, then divide by y4 to get (x/y)4 + 1 = 2(z/y2)2. By Corollary 3.16, x/y = ±1 and z/y2 = ±1, so y = ±x and z = ±y2 = ±x2. □ Corollary 3.18. The only rational solutions to y2 = x3 + 4x are (0, 0) and (2, ±4). Proof. A bijection between solutions of y2 = x3 + 4x with x ̸= 0 and solutions of v2 = u4 − 1 is given by (x, y) 7→ ( y 2x , y2 − 8x 4x2 ) , (u, v) 7→ ( 2 u2 − v , 4u u2 − v ) . Any rational solution to v2 = u4 − 1 has v = 0, so any rational solution to y2 = x3 + 4x has x = 0 or y2 = 8x. The second case implies x3 = 4x, so x = ±2. Only x = 2 leads to a solution, (x, y) = (2, ±4). □ Corollary 3.19. The only rational solutions to y2 = x3 − x are (0, 0) and (±1, 0). Proof. This stands in relation to x4 − y4 = z2 in the same way that y2 = x3 + x does to x4 + y4 = z2 in Corollary 3.8. Details are left to the reader as an exercise. □ Remark 3.20. In the other direction, Corollary 3.19 implies Theorem 3.10. The argument is like that in Remark 3.9. 10 KEITH CONRAD 4. Equation with no rational function solution There are many rational solutions to x2 + y2 = 1, like (x, y) = (3/5, 4/5) or (5/13, 12/13). These solutions are nearly all described by a single parametric formula: x = 2t/(1 + t2) and y = (1 − t2)/(1 + t2) for some t ∈ Q. Try t = 1/3, 1/4, and 1/5. Algebraically, we have an identity of rational functions ( 2t 1 + t2 )2 + ( 1 − t2 1 + t2 )2 = 1 and specializing t to rational numbers gives rational solutions to x2 + y2 = 1. 1 However, it is not true that rational solutions to other equations can always be ﬁt into a parametric formula using rational functions. For example, the equation y2 = x3 − 2 has inﬁnitely many rational solutions (two of them are (x, y) = (3, 5) and (129/100, 383/1000)), but there are no rational functions f (t) and g(t) in Q(t) such that g(t)2 = f (t)3 − 2 other than constant functions, which “parametrize” only one solution (so really do not provide a parametric formula at all). To prove negative results like this we will use descent on the degree in a hypothetical nonconstant solution. Several times we will need the following lemma. Lemma 4.1. If f (t) and g(t) in C[t] are relatively prime and f g = □ in C[t] then f = □ and g = □ in C[t]. Proof. By unique factoriatization, the multiplicity of any irreducible factor of f g is even. Since f and g are relatively prime, it follows that the multiplicity of any irreducible factor of f is even and likewise for g. Therefore f and g are squares up to a nonzero scaling factor. Every nonzero complex number is the square of a complex number, so f and g are squares. □ This lemma easily extends by induction on the number of terms to a product of any ﬁnite number of polynomials in C[t] which are pairwise relatively prime. Theorem 4.2. For distinct complex numbers r, r′, r′′, any solution to the equation y2 = (x − r)(x − r′)(x − r′′) in rational functions x = f (t) and y = g(t) in C(t) is a constant solution: f (t) and g(t) are in C. The example y2 = x3 − 2 which we discussed above is the special case where r, r′, and r′′ are the three cube roots of 2. Proof. Our argument is adapted from [2, pp. 75–76]. Assume there is a solution in rational functions: x = p1(t)/p2(t) and y = q1(t)/q2(t) where p1(t), p2(t), q1(t), and q2(t) are polynomials in C[t]. Without loss of generality we can assume (p1, p2) = 1 and (q1, q2) = 1 in C[t]. Substituting the formulas for x and y into the equation y2 = (x − r)(x − r′)(x − r′′), we have q2 1 q2 2 = ( p1 p2 − r) ( p1 p2 − r′) ( p1 p2 − r′′) = (p1 − rp2)(p1 − r′p2)(p1 − r′′p2) p3 2 , so after clearing denominators (4.1) p3 2q2 1 = (p1 − rp2)(p1 − r′p2)(p1 − r′′p2)q2 2. 1This method produces all the rational solutions to x 2 + y2 = 1 except for (0, −1), but we will not show that here. PROOFS BY DESCENT 11 Since (p1, p2) = 1, the factors p1 − rp2, p1 − r′p2, and p1 − r′′p2 are relatively prime to p2 (why?). Thus by (4.1), p3 2|q2 2. Since (q1, q2) = 1, q2 2|p3 2, so p3 2 = cq2 2 for some nonzero c ∈ C. Since c is a square in C, p3 2 is a square in C[t]. That implies p2 is a square by unique factorization in C[t]. Write p2 = f 2 2 . Substituting cq2 2 for p3 2 in (4.1) and cancelling q2 2 from both sides, cq2 1 = (p1 − rp2)(p1 − r′p2)(p1 − r′′p2). The factors on the right side are pairwise relatively prime since (p1, p2) = 1 (why?) and the numbers r, r′, and r′′ are distinct, so by an extension of Lemma 4.1 to a product of three terms, p1 − rp2, p1 − r′p2, and p1 − r′′p2 are all squares in C[t]. Since p2 = f 2 2 , p1 − rf 2 2 = □, p1 − r′f 2 2 = □, p1 − r′′f 2 2 = □. Writing the ﬁrst equation as p1 − rf 2 2 = f 2 1 , the second and third equations become (4.2) f 2 1 − (r′ − r)f 2 2 = □, f 2 1 − (r′′ − r)f 2 2 = □. The coeﬃcients r′ − r and r′′ − r are nonzero and distinct. We want to show f1 and f2 are constants. Now we set up our descent statement, based on (4.2): we will show for all distinct a and b in C that relatively prime polynomials g1 and g2 in C[t] which satisfy (4.3) g2 1 − ag2 2 = □, g2 1 − bg2 2 = □ must both be constant. Note (4.2) is a special case of this. Assume for some a and b that there is a solution (g1, g2) to (4.3) where g1 or g2 is not constant. In (4.3), write a = c2 and b = d2 with c and d in C. Since a ̸= b, c ̸= ±d. We can rewrite (4.3) as (4.4) (g1 + cg2)(g1 − cg2) = □, (g1 + dg2)(g1 − dg2) = □. A common factor of g1 + cg2 and g1 − cg2 is a factor of both g1 and g2 (why?), so it is constant since (g1, g2) = 1. Therefore the factors on the left side of the ﬁrst equation in (4.4) are relatively prime, and the product of the factors is a square, so by Lemma 4.1 (4.5) g1 + cg2 = h 2 1, g1 − cg2 = h 2 2, where h1 and h2 are relatively prime. Adding and subtracting the equations in (4.5), g1 = (h2 1 + h2 2)/2 and g2 = (h2 1 − h2 2)/(2c). Since g1 or g2 is not constant, h1 or h2 is not constant. Arguing in a similar way with the second equation in (4.4), (4.6) g1 + dg2 = □, g1 − dg2 = □. Substituting the formulas for g1 and g2 in terms of h1 and h2 into (4.6), 1 2 ( 1 + d c ) h 2 1 + 1 2 (1 − d c ) h2 2 = □, 1 2 (1 − d c ) h 2 1 + 1 2 ( 1 + d c ) h2 2 = □. The numbers 1 ± d/c are nonzero since c ̸= ±d, so we can divide by the coeﬃcient of h2 1: h 2 1 + 1 − d/c 1 + d/c h 2 2 = □, h 2 1 + 1 + d/c 1 − d/c h 2 2 = □. Set a′ = −(1 − d/c)/(1 + d/c) and b′ = −(1 + d/c)/(1 − d/c) = 1/a′. Both a′ and b′ are nonzero, a′ ̸= b′, and (4.7) h 2 1 − a ′h2 2 = □, h 2 1 − b ′h 2 2 = □. 12 KEITH CONRAD From (4.5), 2 deg h1 ≤ max(deg g1, deg g2) and 2 deg h2 ≤ max(deg g1, deg g2). Therefore (4.8) 0 < max(deg h1, deg h2) ≤ 1 2 max(deg g1, deg g2). We can now repeat the argument leading from (4.3) to (4.7) with h1, h2, a′, b′ in place of g1, g2, a, b. Each repetition leads to a new version of (4.8) where the maximum degree in the new solution is positive and smaller than the maximum degree in the previous solution. By descent this leads to a contradiction (positive degrees can’t strictly drop forever), so any solution to (4.3) in relatively prime polynomials g1 and g2 must be a constant solution. What this tells us in (4.2) is that f1 and f2 are both constant, so p1 = f 2 1 + rf 2 2 and p2 = f 2 2 are constant. That makes x = p1/p2 constant, so the equation y2 = (x−r)(x−r′)(x−r′′) implies that y2 = (q1/q2)2 is constant. Therefore the rational function y = q1/q2 is constant. □ Corollary 4.3. Let F (x) be a polynomial with coeﬃcients in C of degree 3 or 4 which has distinct roots. Any solution to the equation y2 = F (x) where x and y are in C(t) has x ∈ C and y ∈ C. Proof. First suppose F (x) has degree 3. In factored form F (x) = c(x − r)(x − r′)(x − r′′) where the roots r, r′, and r′′ are distinct and c ̸= 0. 2 In C, c is a square, so the equation (4.9) y2 = c(x − r)(x − r′)(x − r′′) can be scaled to Y 2 = (x − r)(x − r′)(x − r′′) where Y = y/ √c. If there is a solution to (4.9) where x, y ∈ C(t) then Y ∈ C(t). By Theorem 4.2, x ∈ C and Y ∈ C, so y ∈ C. Next suppose F (x) has degree 4 with distinct roots r, r′, r′′, and r′′′. In factored form F (x) = c(x − r)(x − r′)(x − r′′)(x − r′′′), where c ̸= 0. Suppose we can solve (4.10) y2 = c(x − r)(x − r′)(x − r′′)(x − r′′′) where x, y ∈ C(t). The roots of F are distinct, so without loss of generality x ̸= r′′′. Dividing through (4.10) by (x − r′′′)4, y2 (x − r′′′)4 = c ( x − r x − r′′′ ) ( x − r′ x − r′′′ ) ( x − r′′ x − r′′′ ) = c (1 + r′′′ − r x − r′′′ ) ( 1 + r′′ − r x − r′′′ ) ( 1 + r′ − r x − r′′′ ) . Set X = 1/(x − r′′′) and Y = y/(x − r′′′)2, so X and Y are in C(t). Then Y 2 = c(1 + (r′′′ − r)X)(1 + (r′′′ − r′)X)(1 + (r′′′ − r′′)X), where the right side is cubic in X with distinct roots. By the cubic case we already discussed, X ∈ C and Y ∈ C, so x ∈ C and y ∈ C. □ 2The only diﬀerence between this case and Theorem 4.2 is that we now allow a leading coeﬃcient other than 1. PROOFS BY DESCENT 13 5. Sums of two squares We have used descent so far to prove “negative” theorems, which say certain equations have no (or very few) solutions of a certain type. At ﬁrst, Fermat’s applications of descent all had this ﬂavor. 3 He eventually discovered descent could be used to prove “positive” theorems, such as the following. Theorem 5.1. For a prime p, if −1 ≡ □ mod p then we can write p as a sum of two squares: p = x2 + y2 for some x and y in Z. Proof. Write −1 ≡ s2 mod p. Without loss of generality, 1 ≤ s ≤ p/2, so s2 + 1 = pd with d ∈ Z. Since s2 + 1 ≤ p2/4 + 1 < p2, 0 < d < p. So our hypothesis tells us a certain multiple of p is a sum of two squares and the multiplying factor is less than p. If d = 1 then we are done. If d > 1, we will show that pd′ is a sum of two squares for some integer d′ such that 0 < d′ < d. Then repeating the argument, by descent eventually we must reach d = 1, so p · 1 = p is a sum of two squares. To make our descent step recursive, we don’t work with the speciﬁc equation pd = s2 + 1 but more generally pk = x2 + y2 where 0 < k < p. (For k = d this holds with x = s and y = 1, so such an equation does exist for some choice of k.) If k > 1, we want to produce another equation of this form where k is smaller. Reduce x and y modulo k: x ≡ r mod k and y ≡ r′ mod k, where |r|, |r′| ≤ k/2. Squaring and adding, r2 + r′2 ≡ x2 + y2 ≡ 0 mod k, so r2 + r′2 = kℓ for integer ℓ ≥ 0. Let’s show r or r′ is not 0, so ℓ > 0. If r = 0 and r′ = 0 then k|x and k|y, so k2 divides x2 + y2 = kp, so k|p, but this is not true since 0 < k < p and p is prime. Now let’s bound ℓ from above. From the bounds on |r| and |r′|, kℓ = r2 + r′2 ≤ k2 4 + k2 4 = k2 2 < k2, so 0 < ℓ < k. We will show pℓ is a sum of two squares. Since (pk)(kℓ) = (x2 + y2)(r2 + r′2) = (x2 + y2)(r′2 + r2) = (xr′ − yr) 2 + (xr + yr′) 2. Modulo k, xr′ − yr ≡ xy − yx ≡ 0 and xr + yr′ ≡ r2 + r′2 ≡ 0. Therefore xr′ − yr and xr + yr′ are multiples of k, so we can write pk2ℓ = (ka)2 + (kb)2 for some positive integers a and b. Dividing by k2, pℓ = a2 + b2. This completes our descent step, since 0 < ℓ < k. □ Remark 5.2. Fermat’s own proof by descent of Theorem 5.1 was based on counterexamples: assuming some odd p with −1 ≡ □ mod p is not a sum of two squares, Fermat said he could show there has to be a smaller prime with the same property, and thus by descent we eventually will obtain that 5 is not a sum of two squares, but it is, so we have a contradiction. 3Almost none of Fermat’s proofs are known in detail, but he did include in letters that statements of some propositions that he established with descent. 14 KEITH CONRAD 6. Markoff’s equation The Markoﬀ equation, introduced by Markoﬀ in 1880, is x2 + y2 + z2 = 3xyz. One solution is (1, 1, 1). Markoﬀ’s insight about this equation is that we can bring 3xyz to the left side to let us interpret x as a root of the quadratic polynomial T 2 − (3yz)T + (y2 + z2) = 0. To ﬁnd the second root of this equation (besides x), we bypass the quadratic formula and think about relations between roots and coeﬃcients. Letting the other root be r, our polynomial is (T − x)(T − r) = T 2 − (x + r)T + xr. Therefore x + r = 3yz, so r = 3yz − x. We have obtained from one solution (x, y, z) of Markoﬀ’s equation a second solution: (3yz−x, y, z). Interchanging the roles of x, y, and z, we similarly get the additional solutions (x, 3xz − y, z) and (x, y, 3xy − z). From (1, 1, 1) we can successively generate, for instance, (2, 1, 1), (2, 1, 5), and (2, 29, 5). Markoﬀ proved that all the solutions in positive integers to his equation can be produced in this way from (1, 1, 1). His proof, which uses descent, can be found in [4]. We want to use descent for a diﬀerent purpose, also taken from [4]. We will prove a theorem of Frobenius and Hurwitz which shows the special role of 3 as a coeﬃcient on the right side of Markoﬀ’s equation. Theorem 6.1. For any positive integer k other than 1 or 3, the equation x2+y2+z2 = kxyz has no integral solution except (0, 0, 0). Proof. First we will treat the case k > 3, returning later to k = 2. Suppose a, b, and c satisfy a2 + b2 + c2 = kabc. If any of a, b, or c is 0 then the equation says the sum of the squares of the other two is 0, so a, b, and c are all 0. Thus, assuming (a, b, c) ̸= (0, 0, 0) means a, b, and c are all nonzero. At least one of them is positive (otherwise the right side of the equation is negative). The other two are both positive or both negative, and in the negative case we can change their signs to get a solution where all are positive. So without loss of generality a, b, and c are all positive. The numbers a, b, and c are distinct. To show this, we argue by contradiction. Suppose (without loss of generality) that a = b. Then 2a2 + c2 = ka2c, so a2(kc − 2) = c2. Therefore kc − 2 is a rational square, hence an integral square. Write kc − 2 = d2 with d ≥ 1, so kc = 2 + d2. Therefore 2a2 + c2 = (2 + d2)a2, so c2 = d2a2, so c = da. Now d2 = kc − 2 = k(da) − 2, so 2 = d(ka − d), which means d|2, so d is 1 or 2. In either case we get ka = 3, which contradicts k > 3. Without loss of generality, say a > b > c ≥ 1. The triple (kbc − a, b, c) is also a solution to x2 + y2 + z2 = kxyz, and kbc − a is positive since a(kbc − a) = b2 + c2 and a > 0. Which coordinate in (kbc − a, b, c) is maximal? We know b > c by design. Is kbc − a > b or is b > kbc − a? We answer this by looking at the polynomial f (x) = x2 − (kbc)x + b2 + c2. The roots of f (x) are a and kbc − a, and f (b) = 2b 2 + c 2 − kb2c ≤ 2b 2 + c 2 − kb2 < 3b 2 − kb2 = (3 − k)b 2 < 0. The region where f is negative is between its two roots. Thus b lies between a and kbc − a. Since b < a we must have kbc − a < b, so 0 < max(kbc − a, b, c) = b < a = max(a, b, c), PROOFS BY DESCENT 15 Repeating this construction, by descent we get a contradiction, so the equation a2 +b2 +c2 = kabc has only (0, 0, 0) as an integer solution when k > 3. Now we look at k = 2. Suppose a2 + b2 + c2 = 2abc with integers a, b, and c. Since a2 + b2 + c2 is even, a, b, and c are not all odd. If exactly 1 of them is even then reducing both sides of the equation modulo 4 gives 2 ≡ 0 mod 4, a contradiction. If exactly 2 are even then reducing modulo 2 gives 1 ≡ 0 mod 2, another contradiction. Therefore a, b, and c are all even. Write a = 2a′, b = 2b′, and c = 2c′, so a′2 + b′2 + c′2 = 4a′b′c′. This is the case k = 4, which we have already shown has no integral solution except (0, 0, 0), so (a, b, c) = (2a′, 2b′, 2c′) = (0, 0, 0). □ Why is k = 1 not considered in Theorem 6.1? Looking at the equation x2 + y2 + z2 = xyz modulo 3 shows x, y, and z are all multiples of 3 (check!). Writing x = 3x′, y = 3y′, and z = 3z′ yields x′2 + y′2 + z′2 = 3x′y′z′, so any integral solution to x2 + y2 + z2 = xyz is simply 3 times an integral solution of Markoﬀ’s equation. Appendix A. Areas of Right Triangles We saw in Section 3 that Fermat’s Last Theorem for exponent 4 is a consequence of x4 + y4 = z2 having no solution in positive integers. Here we will explain the background that led Fermat to this equation, which has nothing to do with Fermat’s Last Theorem. Fermat was thinking about the following problems concerning areas of right triangles: (1) Can a right triangle with integer side lengths have the same area as a square with integer side lengths? (2) Can a right triangle with integer side lengths have twice the area of a square with integer side lengths? Algebraically, if (a, b, c) is a Pythagorean triple we are asking if (1/2)ab can be a perfect square or twice a perfect square. The ﬁrst question is connected with x4 − y4 = z2 and the second question is connected with x4 + y4 = z2. This is explained in Table 2. The ﬁrst column shows how to turn a Pythagorean triple (a, b, c) such that (1/2)ab is a perfect square into a positive integer solution of x4 − y4 = z2. In the second column we turn such a solution (x, y, z) into a Pythagorean triple (a, b, c) such that (1/2)ab is a perfect square. In the next two columns we turn Pythagorean triples (a, b, c) with (1/2)ab being twice a perfect square into positive integer solutions of x4 + y4 = z2 and vice versa. Note d in the fourth column is an integer since x or y must be even (otherwise z2 ≡ 2 mod 4, which is impossible) a2 + b2 = c2, x4 − y4 = z2 a2 + b2 = c2, x4 + y4 = z2 1 2 ab = d2 1 2 ab = 2d2 x = c a = z2 x = b a = x2 y = 2d b = 2x2y2 y = 2d b = y2 z = |a2 − b2| c = x4 + y4 z = bc c = z d = xyz d = xy/2 Table 2 The transformations we wrote down in the table from (a, b, c) to (x, y, z) and back again are not inverses to each other, but they at least show the existence of an integral right triangle having a certain kind of area is equivalent to the existence of a positive integer solution to a certain equation. 16 KEITH CONRAD We showed by descent in Theorems 3.1 and 3.10 that x4 ± y4 = z2 has no solution in positive integers, so there are no integral right triangles whose area is a perfect square or twice a perfect square. Appendix B. Another descent with sums of two squares We will prove a theorem by descent where rational solvability of an equation implies integral solvability. Theorem B.1. Let n ∈ Z+. If n is a sum of two rational squares then it is a sum of two integral squares. This is saying: if n = x2 + y2 has a solution in fractions then it also has a solution in integers. Example B.2. We have 193 = (933/101)2 + (1048/101)2 = (83/109)2 + (1512/109)2 and 193 = 72 + 122. Proof. Our descent argument is taken from [5, App. II, Chap. III], and the main idea goes back to L. Aubry (1912). Suppose n = r2 1 + r2 2 with fractions r1 and r2. If r1 and r2 are in Z, we’re done, so we assume at least one of them is not in Z. Write the ri’s with a common denominator: r1 = a1/b and r2 = a2/b, where the a1, a2, and b are in Z and b > 1. We want to write n = r′2 1 + r′2 2 where r′ 1 and r′ 2 are fractions with a common denominator less than b. Repeating this enough times, we will eventually get a common denominator of 1, meaning we have written n as a sum of integral squares. The point (r1, r2) lies on the circle x2+y2 = n. Pick a nearby Z-point in the plane: choose k1 and k2 in Z such that |ri −ki| ≤ 1/2. Since r1 and r2 are not both in Z, (r1, r2) ̸= (k1, k2), so there is a line through these two points. This line meets the circle x2 +y2 = n in the point (r1, r2). We will show this line meets the circle in a second point with rational coordinates having a smaller common denominator than b (a common denominator of the coordinates of the point (r1, r2)). First let’s check the line through (r1, r2) and (k1, k2) meets x2 + y2 = n in a second point. We argue by contradiction. If the line only meets the circle at (r1, r2) then the line is tangent to the circle at (r1, r2), so the three points (r1, r2), (k1, k2), and (0, 0) are the vertices of a right triangle (a tangent line to a point on a circle is always perpendicular to the line connecting the origin to the point of tangency). Then the Pythagorean theorem tells us k2 1 + k2 2 = (r2 1 + r2 2) + ((k1 − r1) 2 + (k2 − r2)2) = n + ((k1 − r1) 2 + (k2 − r2)2). Both k2 1 + k2 2 and n are integers, so (k1 − r1)2 + (k2 − r2)2 is an integer. However, |k1 − r1| and |k2 − r2| are both less than 1/2, so 0 ≤ (k1 − r1)2 + (k2 − r2)2 ≤ (1/2)2 + (1/2)2 = 1/2. Then the only way (k1 − r1)2 + (k2 − r2)2 could be an integer is if it is 0, which forces r1 = k1 and r2 = k2. However, we are supposing r1 and r2 are not both integers, so we have a contradiction. PROOFS BY DESCENT 17 Now let’s look more closely at the algebraic formula for the squared distance between (r1, r2) and (k1, k2). This number, which is positive, equals (r1 − k1)2 + (r2 − k2) 2 = ( a1 b − k1)2 + ( a2 b − k2)2 = ( a1 b )2 + ( a2 b )2 − 2(a1k1 + a2k2) b + k2 1 + k2 2 = n − 2(a1k1 + a2k2) b + k2 1 + k2 2 = n + k2 1 + k2 2 − 2(a1k1 + a2k2) b . We can write this fraction in the form b′/b, where b ′ := b(n + k2 1 + k2 2) − 2(a1k1 + a2k2) ∈ Z and (r1 − k1)2 + (r2 − k2) 2 = b′ b =⇒ (a1 − bk1) 2 + (a2 − bk2) 2 = bb ′. We will show the line through (r1, r2) and (k1, k2) meets x2 + y2 = n in a rational point whose coordinates have b′ as a common denominator. Since (r1 − k1)2 + (r2 − k2)2 ≤ (1/2)2 + (1/2)2 = 1/2, we have 0 < b′/b ≤ 1/2, so 0 < b ′ ≤ b 2 < b. The line through (r1, r2) and (k1, k2) can be described parametrically by (B.1) L(t) = (k1 + (r1 − k1)t, k2 + (r2 − k2)t). This meets x2 + y2 = n at t = 1 (L(1) = (r1, r2)). Where else does it meet the circle? To ﬁnd out, we solve for t in n = (k1 + (r1 − k1)t) 2 + (k2 + (r2 − k2)t)2 = k2 1 + 2k1(r1 − k1)t + (r1 − k1) 2t2 + k2 2 + 2k2(r2 − k2)t + (r2 − k2) 2t2 = k2 1 + k2 2 + 2(k1r1 − k2 1 + k2r2 − k2 2)t + ((r1 − k1) 2 + (r2 − k2)2)t2 = k2 1 + k2 2 + 2(k1r1 + k2r2 − (k2 1 + k2 2))t + ((r1 − k1) 2 + (r2 − k2) 2)t2 = k2 1 + k2 2 + 2(a1k1 + a2k2) − 2b(k2 1 + k2 2) b t + (a1 − bk1)2 + (a2 − bk2)2 b2 t 2. Using the deﬁnition of b′ to rewrite the coeﬃcients of t and t2, we have n = k2 1 + k2 2 + b(n + k2 1 + k2 2) − b′ − 2b(k2 1 + k2 2) b t + b′ b t 2 = k2 1 + k2 2 + ( n − (k2 1 + k2 2) − b′ b ) t + b′ b t2. Bringing all terms to the right side, 0 = b′ b t 2 + ( n − (k2 1 + k2 2) − b′ b ) t + k2 1 + k2 2 − n. 18 KEITH CONRAD This has a root at t = 1 (because L(1) is on the circle, but it can also be seen algebraically), so we know t − 1 is a factor on the right, leading to 0 = (t − 1) ( b′ b t + n − (k2 1 + k2 2)) . Thus the second point of intersection of the line L(t) with the circle x2 + y2 = n is at t = b(k2 1 + k2 2 − n) b′ . Feeding this value of t into (B.1), and writing ri as ai/b, we get the point L ( b(k2 1 + k2 2 − n) b′ ) = (k1 + (a1 − bk1)(k2 1 + k2 2 − n) b′ , k2 + (a2 − bk2)(k2 1 + k2 2 − n) b′ ) , which shows this second point of intersection of the line and circle is a rational point and b′ is a common denominator for its coordinates. We noted earlier that 0 < b′ ≤ b/2 < b, so the common denominator for this new rational point on x2 + y2 = n is smaller than that for (r1, r2), so we are done. □ The proof of Theorem B.1 works for a sum of three squares, using lines and spheres in three dimensions. That is, an integer which is a sum of three rational squares is also a sum of three integral squares. The only change to be made in the proof is the following: now we have |ai/b − ki| ≤ 1/2 for i = 1, 2, 3, and (a1/b − k1)2 + (a2/b − k2)2 + (a3/b − k3)2 ≤ 3/4 instead of 1/2. So the new rational point on the sphere x2 + y2 + z2 = n will have a common denominator b′ ≤ (3/4)b, which is still less than b, which means everything still works in the proof when it is done for sums of three squares. It is a theorem of Lagrange (1770) that every positive integer is a sum of four squares. This is called the four-square theorem and it suggests an analogue of Theorem B.1 for four squares is pointless. But historically it went the other way: Euler (1751) was able to prove every positive integer is a sum of four rational squares and could not ﬁgure out how to use this to prove every positive integer is a sum of four integral squares. After Lagrange’s proof of the four-square theorem, Euler realized how he could make a descent argument work and thereby deduce Lagrange’s integral four-square theorem from his own rational four-square theorem. Theorem B.1 is no longer true if we replace sums of two squares by slightly diﬀerent algebraic expressions. For example, the equation x2 + 82y2 = 2 has no integral solutions, but it has the rational solution (x, y) = (4/7, 1/7). The equation x3 + y3 = 13 has no integral solutions but it has the rational solution (x, y) = (7/3, 2/3). References [1] J. W. S. Cassels, Lectures on Elliptic Curves, Cambridge Univ. Press, Cambridge, 1991. [2] H. Clemens, A Scrapbook of Complex Curve Theory, 2nd ed., Amer. Math. Soc., 2003. [3] D. Kalman, R. Mena, and S. Shahriari, “Variations on an Irrational Theme – Geometry, Dynamics, Algebra,” Math. Mag. 70 (1997), 93–104. [4] M. G. Krein, “Markov’s Diophantine Equation,” pp. 121–126 in Kvant Selecta: Algebra and Analysis, I (S. Tabachnikov, ed.), Amer. Math. Soc., Providence, 1991. [5] A. Weil, Number Theory: An Approach Through History from Hammurapi to Legendre, Birkh¨auser, Boston, 1984.","libVersion":"0.3.1","langs":""}
{"path":"iCloudDrive/bks/OlympiadQPs/Miscellaneous/tjusamo 2007/GeneratingFunctions.pdf","text":"Generating Functions and Algebraic Combinatorics Jacob Steinhardt 1 1 Introduction Algebraic combinatorics can be loosely deﬁned as any problem involving non-trivial algebraic equations that include binomial coeﬃcients, factorials, or some other obviously combinatorial quantity. It may also be an originally purely combinatorial problem that superimposes algebra to aid in solving it, usually in the form of generating functions. 2 Generating Functions We will start with some facts and deﬁnitions, so that when presenting a proof you will know what to call what you are using. Formal Power Series: The formal power series of the sequence {an}∞ n=0 is A(x) = ∞∑ n=0 anx n. Unlike in Calculus, we don’t care at all whether such a series is convergent for a speciﬁc value of x. The most important thing to remember about these series is that, for some two formal power series A(x) and B(x), if A = B, then ai = bi for all non-negative integers i. In addition, the following statements are true, where a statement given in terms of i is understood to hold for all non-negative integers i, unless otherwise speciﬁed. Most are common sense or basic formulas from Precalculus and Calculus. 1. If A + B = C, then ci = ai + bi. 2. If A ∗ B = C, then ci = i∑ n=0 anbi−n. This is called a convolution. 3. If A = B, then their derivatives and integrals are also equal, and any other algebraic operation also preserves equality. 4. A generating function has a multiplicative inverse if its constant term is not zero. 5. If A(x)B(x) = 0, then either A(x) = 0 or B(x) = 0. 6. If A = B, then A(x) = B(x) for all x (even non-real values). Be careful with the converse, though; just because A(x) = B(x) for many (even inﬁnitely many values) of x does not mean that A = B. 7. (Geometric Series) The formal power series of ai = 1 is 1 1−x . 8. (Binomial Theorem) The formal power series of ai = (p i) is (1 + x)p (even for negative and fractional p). 9. The formal power series of ai = 1 i! is ex. In addition, basically all normal algebraic manipulations are still true for generating functions. Now that you know what generating functions are, it would be useful to know what to do with them. Here are a few examples: 1Thanks to Joshua Nichols-Barr and Razvan Gelca, who both wrote MOP lectures on this topic. Actually, a large part of this was stolen from Josh. 1 Example one: Find an explicit formula for the nth Fibonacci number, Fn. Solution: Let ϕ and ¯ϕ be the positive and negative roots of x2 − x − 1 = 0. Let F (x) = F0 + F1x + F2x2 + . . . = 1 + x + 2x2 + . . .. By deﬁnition, Fn = Fn−1 + Fn−2, or Fn − Fn−1 − Fn−2 = 0. Thus, if we multiply F (x)by(1 − x − x2), all terms except the ﬁrst term should telescope, yielding F (x)(1 − x − x2) = 1. Then F (x) = 1 1−x−x2 = 1 (1−ϕx)(1− ¯ϕx) = 1√5 ( ϕ 1−ϕx − ¯ϕ 1− ¯ϕx ) by partial frac- tion decomposition. Then, re-expressing the denominators as power series, we arrive at the following equivalent formulation of F : F (x) = ∞∑ n=0( ϕn+1 − ¯ϕn+1 √5 )x n from which it follows that Fn = ϕn+1− ¯ϕn+1 √5 . Example two: Find an explicit formula for the nth Catalan number, Cn. Solution: Let C(x) = C0 + C1x + C2x2 + . . .. By deﬁnition, Cn = Cn−1C0 + Cn−2C1 + . . ., so that if we deﬁne D(x) = C(x)2 = D0 + D1x + . . ., then Cn = Dn−1. As C0 = 1, we have C(x) = xC(x)2 + 1, from which it follows that C(x) = 1−√1−4x 2x by the quadratic formula. (We can verify that the radical must be subtracted and not added in a number of ways. The easiest is to expand the ﬁrst few terms of both and check to see which one yields positive coeﬃcients). It then follows from the Extended Binomial Theorem that Cn = 2(−4) n( 1 2 n + 1 ) = 1 n + 1 (2n n ) Example three: Find the generating function for π(n), the number of partitions of n. By deﬁnition, the number of partitions of n is the number of sets of positive integers with sum equal to n. For any positive integer k, a partition of n can involve using k 1 time, 2 times, 3 times, etc. Thus, we ﬁnd that the number of paritions of n is equal to the coeﬃcient of xn in the product ∞∏ k=1(1 + x k + x 2k + x 3k + . . .) = ∞∏ k=1( 1 1 − xk ) 3 Simplifying Sums Some problems will ask you to express a sum in closed form. In most cases, the goal is to ﬁnd a suitable polynomial whose expansion is related to the sum in question. Here are a few tips for dealing with sums: 1. You can always switch the order of the summands if you have nested sums. For example, n∑ i=1 m∑ j=1 i∗ j = m∑ j=1 n∑ i=1 i ∗ j. 2. Don’t be afraid to pull constants out of sums, even if they are not always constant. For example, n∑ i=1 m∑ j=1 i ∗ j = n∑ i=1 i ∗ m∑ j=1 j. 2 3. Try to rearrange the sum so that in each term sums of variables are preserved. To give the canonical example, n∑ k=0 (n k )2 is much easier to work with as n∑ k=0 (n k )( n n − k ). Note that here the sums of the tops of the binomial coeﬃcients is always 2n and the sums of the bottoms is always n. Once you have equal sums you can try to ﬁnd a convolution that will help you out. 4. Try pairing terms in the sum together to simplify it, or adding it to itself, perhaps in reverse order. In particular, the sum or diﬀerence of adjacent terms, or functions of adjacent terms, in Pascal’s triangle will usually simplify nicely. 5. Try ﬁnding a relation between consecutive elements in the sum and then multiplying by something to telescope it (see the Fibonacci example). 6. Try multiplying the kth term in the sum by xk, simplifying in terms of x, then evaluating at x = 1. Alternately, if there is already some number raised to the kth power tacked onto each term, you might try replacing it with x, simplifying, then evaluating when x is the number in question. This always works if the sum is ﬁnite, but may not work in general for an inﬁnite sum if you are evaluating at a point outside the interval of convergence. 7. You can indirectly show that two quantities are equal by showing that they have the same ﬁrst term and satisfy the same recurrence relation. Here are a few examples: Example one: Simplify n∑ k=0 (n k ). Method one: This is simply the expansion of (1 + 1)n = 2n. Method two: This is the number of ways of choosing k out of n elements from a set, summed across k, so it is the number of ways of choosing some arbitrary number of elements from a set of size n. We can either choose or not choose each element, yielding two possibilities for each of n elements, so in total there are 2n possibilities. Method three: Use the identity that the sum is equal to 2n as an inductive hypothesis. Then n∑ k=0 (n k ) = 2 + n−1∑ k=1 (n − 1 k ) + (n − 1 k − 1 ) = 2 + 2 ∗ (2 n−1 − 1) = 2n, where the 3rd to last step is Pascal’s identity, and the 2nd to last step uses the inductive hypothesis. Example two: Simplify n∑ k=0 k(n k ). Method one: As (n k) = ( n n−k), k(n k) + (n − k) ( n n−k) = n 2 (n k) + n 2 (n k), from which it immediately follows from the previous example that the sum in question simpliﬁes to n2n−1. Method two: (1 + x)n = n∑ k=0 (n k )x k, so d dx (1 + x)n = n∑ k=0 k(n k )x k−1. Then evaluating d dx (1 + x)n = n(1 + x)n−1 at x = 1 immediately yields the identity. Method three: We can use the following counting argument: rewriting k = (k 1), we have the term (n k)(k 1). We can encode this algebraic quantity into a counting argument, by saying that we choose k out of n elements of a set, then mark one of them as a “special” element. As we sum across k, we can just say we are choosing sum arbitrary number of elements. However, we could reverse the order of 3 this process by choosing the “special” element ﬁrst, then choosing some arbitrary number of remaining elements. There are (n 1) ways of choosing the “special” element, and as there are n − 1 remaining elements, there are 2n−1 ways to choose some number of them. Thus the sum is equivalent to 2n−1. Excercise: Prove the above identity by induction. Example three: Prove that (n+1 k+1) = n∑ m=k (m k ). Method one: Consider choosing k + 1 elements of the set S = {1, 2, . . . , n + 1} in order. Then, supposing that the ﬁrst element chosen is n + 1 − m, there are (m k ) ways to pick the remaining ele- ments. If we sum across m, we have the above sum, but it is also equal to the number of ways of picking k + 1 elements out of S, which is (n+1 k+1). Method two: Using the identity 1 + x ∑n−1 i=0 (1 + x)i = (1 + x)n, and comparing the coeﬃcient of xk in both expansions, the identity immediately follows. Excercise: Prove the above identity by induction. Example four: Simplify n∑ k=0 (n k )2. Method one: If we rewrite (n k)2 = (n k)( n n−k), the sum of the tops of the binomial coeﬃcients is always 2n, and the sum of the bottoms of the coeﬃcients is always n. We now search for an expansion that would lead to this. If we were to place xk after (n k) and xn−k after ( n n−k), we would end up with an overall term of xn, suggesting that the sum consists of parts of the convolution for the coeﬃcient of xn in (1 + x)n(1 + x)n. In fact, it is not hard to see that it consists of all terms in this convolution, so that it is identically the coeﬃcient of xn in (1 + x)n(1 + x)n = (1 + x)2n, from which it becomes obvious that the sum is equal to (2n n ) from the Binomial Theorem. Method two: Rewrite (n k)2 as before and consider the following counting argument: the number of ways to choose some number of elements from {1, 2, . . . , n} and some other number of elmenets from {n + 1, . . . , 2n} such that the total number of elements if n is the same as the number of ways to choose n elements from {1, 2, . . . , 2n}. It then follows that the sum is equal to (2n n ). Example ﬁve: Express the following in closed form: ⌊ k 2 ⌋∑ a=0 (k a )(k − a a )4 k−a We can’t directly preserve any sums. However, there is a sum of 2a in the bottom of the binomial coeﬃcients. We can put a 2a somewhere else, namely in the exponent, by changing the 4 to a 2. Then we move a factor of 2k to the outside, so that the sum becomes 2k ⌊ k 2 ⌋∑ a=0 (k a )(k − a a )2 k−2a Now we start exploring possible expansions that could lead to this. (k a)(k−a a ) is equivalent to the trino- mial coeﬃcient ( k a,a ), indicating that we should have something of the form (a + b + c)k. In addition, the values of the ﬁrst two seem not to matter. Since they are both raised to an equal power (a) in any given term, they should be multiplicative inverses. Finally, the last term should yield the 2k−2a part of 4 the sum, so it should be 2. We are then looking for the coeﬃcient of the constant term in 2k(x + 2 + 1 x )k If we let x = y2, then 2k(y2 + 2 + 1 y2 )k factors to 2k(y + 1 y )2k. The coeﬃcient of the constant term in this expansion is 2k(2k k ), and we are done. Example six: Prove that for every positive integer n, n∑ k=1 1 k(n k) = 1 2n−1 n∑ k=1,kodd (n k) k Let An be the left-hand side, and Bn be the right-hand side. Because both sums are incredibly ugly to work with alone, or in terms of each other, we will deal with An+1 and Bn+1 in terms of An and Bn. For An+1, we have: An+1 = n+1∑ k=1 1 k(n+1 k ) = 1 n + 1 (1 + n∑ k=1 n − k + 1 k(n k) ) Breaking the sum apart, we get 1 n + 1 + n∑ k=1 1 k(n k) − 1 n + 1 n∑ k=1 1 (n k) = n∑ k=1 1 k(n k) − n∑ k=1 1 (k + 1) (n+1 k+1) + 1 n + 1 from which it follows that n+1∑ k=1 1 k(n+1 k ) + n+1∑ k=2 1 (n+1 k ) = n∑ k=1 1 k(n k) + 1 n + 1 or, equivalently, 2( n+1∑ k=1 1 k(n+1 k ) ) = n∑ k=1 1 k(n k) + 2 n + 1 It follows that An+1 = An 2 + 1 n+1 . For Bn+1, we have two cases: n is even and n is odd. If n is odd, then 2nBn+1 − 2n−1Bn = n∑ k=1,kodd (n+1 k ) − (n k) k = n∑ k=1,kodd ( n k−1) k And if n is even, the left-most expressiong becomes n∑ k=1,kodd ( n k−1) k + 1 n + 1 . Now let Sn = ∑n k=1,kodd ( n k−1) k , we will prove by induction that Sn = 2n n+1 if n is odd, and 2n−1 n+1 if n is even. The base cases are easily veriﬁed. The inductive step then immediately follows from the identity (n + 2)Sn+1 − (n + 1)Sn = n+1∑ k=1,kodd (n + 2 k ) − n∑ k=1,kodd (n + 1 k ) = 2 n ± 1 from which it follows that Bn+1 = Bn 2 + 1 n+1 . As An and Bn are equal when n = 1, and they grow in the same manner, they are equal for all values of n, the desired result. Comment: This problem was hard. Even with the idea of showing that they grow in the same manner, which is motivated by the fact that the two sums are too ugly to work with in basically any other way, there is a lot of diﬃcult algebra involved. The algebra behind the left-hand side was 5 motivated by trying to express An+1 in terms of An. We started with the left-hand side because it was the less ugly of the two sums. Then, once we had a recurrence relation for An, our algebra for the right-hand side was aided because we knew what numbers we had to eventually get. We also used the golden rule that adding or subtracting numbers in Pascal’s triangle yields nice results. Finally, we already knew that the sum of odd binomial coeﬃcients would simplify. 4 Problems We will now go through some problems involving generating functions together: 1. (JSteinhardt) Suppose we have a Catalan-like sequence D satisfying dn = n−2∑ i=0 didn−i−2 for n ≥ 2. Suppose |p| < 1 4(a+b) . Find a closed form expression for ∞∑ n=0 dnpn in terms of d0, d1, and p. 2. (MOP 2006) Let f (x) = n∑ k=0 (n k )2(1 + x) 2n−2k(1 − x) 2k. Show that the coeﬃcient of x2m−1 is zero for all positive integers m. 3. (Putnam) How many ways can one number the sides of two dice in such a way that the likelihood of rolling any particular sum is the same as if the dice were numbered in the ordinary fashion? All numberings should be in positive integers, but the two dice might be numbered diﬀerently and we allow numbers to repeat on the same die. 4. (JSteinhardt) Suppose we have another sequence E satisfying e0 = 1+√3 2 and en = n∑ i=0 n−i∑ j=0 eiej for n > 0. Find a closed form expression for en. 5. (JSteinhardt) Express n∑ k=0 (n k )(k a ) in closed form. 6. (MOP 2006) Express (n 0)2 − (n 1)2 + (n 2)2 − . . . + (−1)n(n n )2 in closed form. 7. (MOP 2006) Let l be an even positive integer. Express n∑ k=0 l∑ i=0(−1) i(n k )2(2k i )(2n − 2k l − i ) in closed form. 8. (JSteinhardt) Express n∑ k=0 (2k k ) 2k − 1 (2n−2k n−k ) 2n − 2k − 1 in closed form. 9. (Euler’s Pentagonal Numbers Theorem, via MOP 2006) Let Π(x) be the generating function of the partition sequence, and let f (x) be the generating function deﬁned as f (x) = 1 + ∞∑ k=1(−1) k(x k(3k−1)/2 + x k(3k+1)/2) Prove that Π(x)f (x) = 1. 6","libVersion":"0.3.1","langs":""}
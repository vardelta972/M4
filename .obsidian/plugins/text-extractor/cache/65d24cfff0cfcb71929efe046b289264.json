{"path":"iCloudDrive/bks/OlympiadQPs/USAMO PYQ/2016.pdf","text":"USAMO 2016 Solution Notes Evan Chen《陳誼廷》 10 August 2023 This is a compilation of solutions for the 2016 USAMO. Some of the solutions are my own work, but many are from the official solutions provided by the organizers (for which they hold any copyrights), and others were found by users on the Art of Problem Solving forums. These notes will tend to be a bit more advanced and terse than the “official” solutions from the organizers. In particular, if a theorem or technique is not known to beginners but is still considered “standard”, then I often prefer to use this theory anyways, rather than try to work around or conceal it. For example, in geometry problems I typically use directed angles without further comment, rather than awkwardly work around configuration issues. Similarly, sentences like “let R denote the set of real numbers” are typically omitted entirely. Corrections and comments are welcome! Contents 0 Problems 2 1 Solutions to Day 1 3 1.1 USAMO 2016/1, proposed by Iurie Boreico . . . . . . . . . . . . . . . . . 3 1.2 USAMO 2016/2, proposed by Kiran Kedlaya . . . . . . . . . . . . . . . . 5 1.3 USAMO 2016/3, proposed by Evan Chen, Telv Cohl . . . . . . . . . . . . 6 2 Solutions to Day 2 9 2.1 USAMO 2016/4, proposed by Titu Andreescu . . . . . . . . . . . . . . . . 9 2.2 USAMO 2016/5, proposed by Ivan Borsenco . . . . . . . . . . . . . . . . . 11 2.3 USAMO 2016/6, proposed by Gabriel Carroll . . . . . . . . . . . . . . . . 13 1 USAMO 2016 Solution Notes web.evanchen.cc, updated 10 August 2023 §0 Problems 1. Let X1, X2, . . . , X100 be a sequence of mutually distinct nonempty subsets of a set S. Any two sets Xi and Xi+1 are disjoint and their union is not the whole set S, that is, Xi ∩ Xi+1 = ∅ and Xi ∪ Xi+1 ̸= S, for all i ∈ {1, . . . , 99}. Find the smallest possible number of elements in S. 2. Prove that for any positive integer k, (k2)! · k−1∏ j=0 j! (j + k)! is an integer. 3. Let ABC be an acute triangle and let IB, IC, and O denote its B-excenter, C- excenter, and circumcenter, respectively. Points E and Y are selected on AC such that ∠ABY = ∠CBY and BE ⊥ AC. Similarly, points F and Z are selected on AB such that ∠ACZ = ∠BCZ and CF ⊥ AB. Lines IBF and ICE meet at P . Prove that P O and Y Z are perpendicular. 4. Find all functions f : R → R such that for all real numbers x and y, (f (x) + xy) · f (x − 3y) + (f (y) + xy) · f (3x − y) = (f (x + y)) 2. 5. An equilateral pentagon AM N P Q is inscribed in triangle ABC such that M ∈ AB, Q ∈ AC, and N, P ∈ BC. Let S be the intersection of M N and P Q. Denote by ℓ the angle bisector of ∠M SQ. Prove that OI is parallel to ℓ, where O is the circumcenter of triangle ABC, and I is the incenter of triangle ABC. 6. Integers n and k are given, with n ≥ k ≥ 2. You play the following game against an evil wizard. The wizard has 2n cards; for each i = 1, . . . , n, there are two cards labeled i. Initially, the wizard places all cards face down in a row, in unknown order. You may repeatedly make moves of the following form: you point to any k of the cards. The wizard then turns those cards face up. If any two of the cards match, the game is over and you win. Otherwise, you must look away, while the wizard arbitrarily permutes the k chosen cards and then turns them back face-down. Then, it is your turn again. We say this game is winnable if there exist some positive integer m and some strategy that is guaranteed to win in at most m moves, no matter how the wizard responds. For which values of n and k is the game winnable? 2 USAMO 2016 Solution Notes web.evanchen.cc, updated 10 August 2023 §1 Solutions to Day 1 §1.1 USAMO 2016/1, proposed by Iurie Boreico Available online at https://aops.com/community/p6213589. Problem statement Let X1, X2, . . . , X100 be a sequence of mutually distinct nonempty subsets of a set S. Any two sets Xi and Xi+1 are disjoint and their union is not the whole set S, that is, Xi ∩ Xi+1 = ∅ and Xi ∪ Xi+1 ̸= S, for all i ∈ {1, . . . , 99}. Find the smallest possible number of elements in S. Solution with Danielle Wang: the answer is that |S| ≥ 8. Proof of sufficiency Since we must have 2|S| ≥ 100, we must have |S| ≥ 7. To see that |S| = 8 is the minimum possible size, consider a chain on the set S = {1, 2, . . . , 7} satisfying Xi ∩ Xi+1 = ∅ and Xi ∪ Xi+1 ̸= S. Because of these requirements any subset of size 4 or more can only be neighbored by sets of size 2 or less, of which there are (7 1 ) + (7 2 ) = 28 available. Thus, the chain can contain no more than 29 sets of size 4 or more and no more than 28 sets of size 2 or less. Finally, since there are only(7 3) = 35 sets of size 3 available, the total number of sets in such a chain can be at most 29 + 28 + 35 = 92 < 100. Construction We will provide an inductive construction for a chain of subsets X1, X2, . . . , X2n−1+1 of S = {1, . . . , n} satisfying Xi ∩ Xi+1 = ∅ and Xi ∪ Xi+1 ̸= S for each n ≥ 4. For S = {1, 2, 3, 4}, the following chain of length 23 + 1 = 9 will work: 34 1 23 4 12 3 14 2 13 . Now, given a chain of subsets of {1, 2, . . . , n} the following procedure produces a chain of subsets of {1, 2, . . . , n + 1}: 1. take the original chain, delete any element, and make two copies of this chain, which now has even length; 2. glue the two copies together, joined by ∅ in between; and then 3. insert the element n + 1 into the sets in alternating positions of the chain starting with the first. For example, the first iteration of this construction gives: 345 1 235 4 125 3 145 2 5 34 15 23 45 12 35 14 25 It can be easily checked that if the original chain satisfies the requirements, then so does the new chain, and if the original chain has length 2n−1 + 1, then the new chain has length 2n + 1, as desired. This construction yields a chain of length 129 when S = {1, 2, . . . , 8}. 3 USAMO 2016 Solution Notes web.evanchen.cc, updated 10 August 2023 Remark. Here is the construction for n = 8 in its full glory. 345678 1 235678 4 125678 3 145678 2 5678 34 15678 23 45678 12 35678 14 678 345 1678 235 4678 125 3678 145 2678 5 34678 15 23678 45 12678 35 78 3456 178 2356 478 1256 378 1456 278 56 3478 156 2378 456 1278 356 1478 6 34578 16 23578 46 12578 36 14578 26 578 346 1578 236 4578 126 8 34567 18 23567 48 12567 38 14567 28 567 348 1567 238 4567 128 3567 148 67 3458 167 2358 467 1258 367 1458 267 58 3467 158 2367 458 1267 358 7 34568 17 23568 47 12568 37 14568 27 568 347 1568 237 4568 127 3568 147 68 3457 168 2357 468 1257 368 1457 268 57 3468 157 2368 457 1268 4 USAMO 2016 Solution Notes web.evanchen.cc, updated 10 August 2023 §1.2 USAMO 2016/2, proposed by Kiran Kedlaya Available online at https://aops.com/community/p6213627. Problem statement Prove that for any positive integer k, (k2)! · k−1∏ j=0 j! (j + k)! is an integer. We show the exponent of any given prime p is nonnegative in the expression. Recall that the exponent of p in n! is equal to ∑ i≥1 ⌊n/pi⌋. In light of this, it suffices to show that for any prime power q, we have ⌊ k2 q ⌋ + k−1∑ j=0 ⌊ j q ⌋ ≥ k−1∑ j=0 ⌊ j + k q ⌋ Since both sides are integers, we show ⌊ k2 q ⌋ + k−1∑ j=0 ⌊ j q ⌋ > −1 + k−1∑ j=0 ⌊ j + k q ⌋ . If we denote by {x} the fractional part of x, then ⌊x⌋ = x − {x} so it’s equivalent to { k2 q } + k−1∑ j=0 { j q } < 1 + k−1∑ j=0 { j + k q } . However, the sum of remainders when 0, 1, . . . , k − 1 are taken modulo q is easily seen to be less than the sum of remainders when k, k + 1, . . . , 2k − 1 are taken modulo q. So k−1∑ j=0 { j q } ≤ k−1∑ j=0 { j + k q } follows, and we are done upon noting {k2/q} < 1. 5 USAMO 2016 Solution Notes web.evanchen.cc, updated 10 August 2023 §1.3 USAMO 2016/3, proposed by Evan Chen, Telv Cohl Available online at https://aops.com/community/p6213572. Problem statement Let ABC be an acute triangle and let IB, IC, and O denote its B-excenter, C- excenter, and circumcenter, respectively. Points E and Y are selected on AC such that ∠ABY = ∠CBY and BE ⊥ AC. Similarly, points F and Z are selected on AB such that ∠ACZ = ∠BCZ and CF ⊥ AB. Lines IBF and ICE meet at P . Prove that P O and Y Z are perpendicular. We present two solutions. ¶ First solution Let IA denote the A-excenter and I the incenter. Then let D denote the foot of the altitude from A. Suppose the A-excircle is tangent to BC, AB, AC at A1, B1, C1 and let A2, B2, C2 denote the reflections of IA across these points. Let S denote the circumcenter of △IIBIC. A B C I O E F IA IB IC P D A1 B1 C1 A2 B2 C2 S YZWe begin with the following observation: Claim — Points D, I, A2 are collinear, as are points E, IC, C2 are collinear and points F , IB, B2 are collinear. Proof. This basically follows from the “midpoints of altitudes” lemma. To see D, I, A2 are collinear, recall first that IA1 passes through the midpoint M of AD. 6 USAMO 2016 Solution Notes web.evanchen.cc, updated 10 August 2023 A B C I IA D A1 B1 C1 A2 M Now since AD ∥ IAA2, and M and A1 are the midpoints of AD and IAA2, it follows from the collinearity of A, I, IA that D, I, A2 are collinear as well. The other two claims follow in a dual fashion. For example, using the homothety taking the A to C-excircle, we find that C1IC bisects the altitude BE, and since IC, B, IA are collinear the same argument now gives IC, E, C2 are collinear. The fact that IB, F , B2 are collinear is symmetric. Observe that B2C2 ∥ B1C1 ∥ IBIC. Proceeding similarly on the other sides, we discover △IIBIC and △A2B2C2 are homothetic. Hence P is the center of this homothety (in particular, D, I, P , A2 are collinear). Moreover, P lies on the line joining IA to S, which is the Euler line of △IIBIC, so it passes through the nine-point center of △IIBIC, which is O. Consequently, P , O, IA are collinear as well. To finish, we need only prove that OS ⊥ Y Z. In fact, we claim that Y Z is the radical axis of the circumcircles of △ABC and △IIBIC. Actually, Y is the radical center of these two circumcircles and the circle with diameter IIB (which passes through A and C). Analogously Z is the radical center of the circumcircles and the circle with diameter IIC, and the proof is complete. ¶ Second solution (barycentric, outline, Colin Tang) we are going to use barycentric coordinates to show that the line through O perpendicular to Y Z is concurrent with IBF and ICE. The displacement vector −−→ Y Z is proportional to (a(b − c) : −b(a + c) : c(a + b)), and so by strong perpendicularity criterion and doing a calculation gives the line x(b − c)bc(a + b + c) + y(a + c)ac(a + b − c) + z(a + b)ab(−a + b − c) = 0. On the other hand, line ICE has equation 0 = det   a b −c SC 0 SA x y z   = bSa · x + (−cSC − aSA) · y + (−bSC) · z and similarly for IBF . Consequently, concurrence of these lines is equivalent to det   bSA −cSC − aSA −bSC cSA −cSB −aSA − bSB (b − c)bc(a + b + c) (a + c)ac(a + b − c) (a + b)ab(−a + b − c)   = 0 7 USAMO 2016 Solution Notes web.evanchen.cc, updated 10 August 2023 which is a computation. ¶ Authorship comments I was intrigued by a Taiwan TST problem which implied that, in the configuration above, ∠IBDIC was bisected by DA. This motivated me to draw all three properties above where IA and P were isogonal conjugates with respect to DEF . After playing around with this picture for a long time, I finally noticed that O was on line P IA. (So the original was to show that IBF , ICE, DA2 concurrent). Eventually I finally noticed in the picture that P IA actually passed through the circumcenter of ABC as well. This took me many hours to prove. The final restatement (which follows quickly from P , O, IA collinear) was discovered by Telv Cohl when I showed him the problem. 8 USAMO 2016 Solution Notes web.evanchen.cc, updated 10 August 2023 §2 Solutions to Day 2 §2.1 USAMO 2016/4, proposed by Titu Andreescu Available online at https://aops.com/community/p6220308. Problem statement Find all functions f : R → R such that for all real numbers x and y, (f (x) + xy) · f (x − 3y) + (f (y) + xy) · f (3x − y) = (f (x + y)) 2. We claim that the only two functions satisfying the requirements are f (x) ≡ 0 and f (x) ≡ x2. These work. First, taking x = y = 0 in the given yields f (0) = 0, and then taking x = 0 gives f (y)f (−y) = f (y)2. So also f (−y)2 = f (y)f (−y), from which we conclude f is even. Then taking x = −y gives ∀x ∈ R : f (x) = x2 or f (4x) = 0 (⋆) for all x. Remark. Note that an example of a function satisfying (⋆) is f (x) =  | | x 2 if |x| < 1 log(x42 + 2016cos(x)) if 1 ≤ |x| < 4 0 if |x| ≥ 4. So, yes, we are currently in a world of trouble, still. Now we claim Claim — f (z) = 0 ⇐⇒ f (2z) = 0 (♠). Proof. Let (x, y) = (3t, t) in the given to get (f (t) + 3t 2) f (8t) = f (4t)2. Now if f (4t) ̸= 0 (in particular, t ̸= 0), then f (8t) ̸= 0. Thus we have (♠) in the reverse direction. Then f (4t) ̸= 0 (⋆) =⇒ f (t) = t2 ̸= 0 (♠) =⇒ f (2t) ̸= 0 implies the forwards direction, the last step being the reverse direction (♠). By putting together (⋆) and (♠) we finally get ∀x ∈ R : f (x) = x 2 or f (x) = 0 (♥) We are now ready to approach the main problem. Assume there’s an a ̸= 0 for which f (a) = 0; we show that f ≡ 0. Let b ∈ R be given. Since f is even, we can assume without loss of generality that a, b > 0. Also, note that f (x) ≥ 0 for all x by (♥). By using (♠) we can generate c > b 9 USAMO 2016 Solution Notes web.evanchen.cc, updated 10 August 2023 such that f (c) = 0 by taking c = 2na for a large enough integer n. Now, select x, y > 0 such that x − 3y = b and x + y = c. That is, (x, y) = ( 3c + b 4 , c − b 4 ) . Substitution into the original equation gives 0 = (f (x) + xy) f (b) + (f (y) + xy) f (3x − y) ≥ (f (x) + xy) f (b). But since f (b) ≥ 0, it follows f (b) = 0, as desired. 10 USAMO 2016 Solution Notes web.evanchen.cc, updated 10 August 2023 §2.2 USAMO 2016/5, proposed by Ivan Borsenco Available online at https://aops.com/community/p6220306. Problem statement An equilateral pentagon AM N P Q is inscribed in triangle ABC such that M ∈ AB, Q ∈ AC, and N, P ∈ BC. Let S be the intersection of M N and P Q. Denote by ℓ the angle bisector of ∠M SQ. Prove that OI is parallel to ℓ, where O is the circumcenter of triangle ABC, and I is the incenter of triangle ABC. ¶ First solution (complex) In fact, we only need AM = AQ = N P and M N = QP . We use complex numbers with ABC the unit circle, assuming WLOG that A, B, C are labeled counterclockwise. Let x, y, z be the complex numbers corresponding to the arc midpoints of BC, CA, AB, respectively; thus x + y + z is the incenter of △ABC. Finally, let s > 0 be the side length of AM = AQ = N P . Then, since M A = s and M A ⊥ OZ, it follows that m − a = i · sz. Similarly, p − n = i · sy and a − q = i · sx, so summing these up gives i · s(x + y + z) = (p − q) + (m − n) = (m − n) − (q − p). Since M N = P Q, the argument of (m − n) − (q − p) is along the external angle bisector of the angle formed, which is perpendicular to ℓ. On the other hand, x + y + z is oriented in the same direction as OI, as desired. ¶ Second solution (trig, Danielle Wang) Let δ and ϵ denote ∠M N B and ∠CP Q. Also, assume AM N P Q has side length 1. In what follows, assume AB < AC. First, we note that BN = (c − 1) cos B + cos δ, CP = (b − 1) cos C + cos ϵ, and a = 1 + BN + CP from which it follows that cos δ + cos ϵ = cos B + cos C − 1 Also, by the Law of Sines, we have c−1 sin δ = 1 sin B and similarly on triangle CP Q, and from this we deduce sin ϵ − sin δ = sin B − sin C. The sum-to-product formulas sin ϵ − sin δ = 2 cos ( ϵ + δ 2 ) sin ( ϵ − δ 2 ) cos ϵ − cos δ = 2 cos ( ϵ + δ 2 ) cos ( ϵ − δ 2 ) 11 USAMO 2016 Solution Notes web.evanchen.cc, updated 10 August 2023 give us tan ( ϵ − δ 2 ) = sin ϵ − sin δ cos ϵ − cos δ = sin B − sin C cos B + cos C − 1 . Now note that ℓ makes an angle of 1 2 (π + ϵ − δ) with line BC. Moreover, if line OI intersects line BC with angle ϕ then tan ϕ = r − R cos A 1 2 (b − c) . So in order to prove the result, we only need to check that r − R cos A 1 2 (b − c) = cos B + cos C + 1 sin B − sin C . Using the fact that b = 2R sin B, c = 2R sin C, this reduces to the fact that r/R + 1 = cos A + cos B + cos C, which is the so-called Carnot theorem. 12 USAMO 2016 Solution Notes web.evanchen.cc, updated 10 August 2023 §2.3 USAMO 2016/6, proposed by Gabriel Carroll Available online at https://aops.com/community/p6220302. Problem statement Integers n and k are given, with n ≥ k ≥ 2. You play the following game against an evil wizard. The wizard has 2n cards; for each i = 1, . . . , n, there are two cards labeled i. Initially, the wizard places all cards face down in a row, in unknown order. You may repeatedly make moves of the following form: you point to any k of the cards. The wizard then turns those cards face up. If any two of the cards match, the game is over and you win. Otherwise, you must look away, while the wizard arbitrarily permutes the k chosen cards and then turns them back face-down. Then, it is your turn again. We say this game is winnable if there exist some positive integer m and some strategy that is guaranteed to win in at most m moves, no matter how the wizard responds. For which values of n and k is the game winnable? The game is winnable if and only if k < n. First, suppose 2 ≤ k < n. Query the cards in positions {1, . . . , k}, then {2, . . . , k + 1}, and so on, up to {2n − k + 1, 2n}. Indeed, by taking the difference of the ith and (i + 1)st query, we can deduce the value of the ith card, for 1 ≤ i ≤ 2n − k. (This is possible because the cards are flipped face up before they are re-shuffled, so even if two adjacent queries return the same set, one can still determine the ith card. It is possible to solve the problem even without the flipped information, though.) If k ≤ n, this is more than n cards, so we can find a matching pair. For k = n we remark the following: at each turn after the first, assuming one has not won, there are n cards representing each of the n values exactly once, such that the player has no information about the order of those n cards. We claim that consequently the player cannot guarantee victory. Indeed, let S denote this set of n cards, and S the other n cards. The player will never win by picking only cards in S or S. Also, if the player selects some cards in S and some cards in S, then it is possible that the choice of cards in S is exactly the complement of those selected from S; the strategy cannot prevent this since the player has no information on S. This implies the result. 13","libVersion":"0.3.1","langs":""}
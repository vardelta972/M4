{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Kimball Martin/NT 1 (Intro to NT)/Notes/chap6.pdf","text":"6 The Gaussian integers 6.1 Z[i] and its norm In the last chapter we looked at real quadratic ring Z[ √n] (meaning Z[√n] ⊆ R) to solve Pell’s equation x2 − ny2 = 1 because, over Z[ √n], x2 − ny2 factors as x2 − ny2 = (x + y√n)(x − y√n). Precisely, we deﬁned the conjugate of an element α = x + y√n to be α = x − y√n, and then the norm to bet N : Z[ √n] → Z by N (α) = αα = x2 − ny2. So the solutions to Pell’s equation are precisely the elements of norm 1 in Z[ √n], which we showed form a group under multiplication that is generated by two elements ϵ and −1. Similarly if one wants to study the equation x 2 + ny2 = k it makes sense to look at the imaginary quadratic ring Z[ √−n] (meaning Z[ √−n] ⊆ C and Z[√−n] ̸⊆ R). The imaginary quadratic rings can be treated in the same basic way as the real quadratic rings theoretically, however their ﬂavor is quite diﬀerent. For example x2 + ny2 = 1 has only ﬁnitely many solutions, but x2 − ny2 = 1 has inﬁnitely many (for n nonsquare). For now, we will just treat the simplest case, the Gaussian integers, which were ﬁrst studied in detail by Gauss. This ring is related to questions about Pythagorean triples, and more generally, which numbers are sums of two squares. Deﬁnition 6.1. The Gaussian integers are the ring1 Z[i] = {a + bi : a, b ∈ Z} . For α = a + bi, the conjugate of α is α = a − bi, and the norm is N (α) = |α| 2 = αα = a 2 + b 2. Note that if we draw α as a vector in the complex plane, c = |α| denotes the length of this vector, so the norm of α is just the square of the length of the vector α, i.e., N (α) = c2. Hence the formula for the norm is precisely the Pythagorean theorem: αα = a2 + b 2 = c 2 = N (α). 1As before, I will sometime call a set of numbers a “ring” to stress that it is like Z in some sense. It contains 0, 1 and -1, and you can add, subtract, and multiply as in Z. The formal deﬁnition comes in Chapter 10. 38 The reason we want the norm to be the square of the length, instead of just the length is because c2 is always an integer, but c rarely is, e.g., 12 + 12 = √2 2. With this deﬁnition, the norm is a map from the ring Z[i] into the ring of integers Z, N : Z[i] → Z. (In fact the norm will map into N ∪ {0}, unlike in the case of Z[ √−n].) The fact that it maps into the integers is very important because of the following. Proposition 6.2. N : Z[i] → Z is multiplicative, i.e., N (αβ) = N (α)N (β) for any α, β ∈ Z[i]. Proof. We did this twice already, in Chapters 1 and 5. Check that αβ = α · β by simple multipli- cation. Then N (αβ) = αβαβ = ααββ = N (α)N (β). Hence, through the norm map N : Z[i] → Z, we will be able to relate the multiplicative structure on Z to the multiplicative structure on Z[i] (and hence also the theory of divisibility, primes, etc.). In general, the norm is a fundamental tool in algebraic number theory. Deﬁnition 6.3. Let α ∈ Z[i]. We say α is a unit of Z[i] if N (α) = 1. The units of Z[i] are ±1, ±i. (See exercise below.) Exercise 6.1. Exercises 6.1.1, 6.1.2 (be precise), 6.1.3. 6.2 Divisibility and primes in Z[i] and Z Recall that the notion of divisibility in Z is deﬁned as follows: if a, b ∈ Z, we say b|a if a = bc for some c ∈ Z. (Formally we only deﬁned it for N, but this deﬁnition is the same.) Note that this techincally means (i) any number divides 0, and (ii) if d|n, then (−d)|n. Similarly we say p ∈ Z is prime if (i) p ̸= 0, (ii) p ̸= ±1 and (iii) p has no factors other than ±1 and ±p, i.e., up to ±1, the units of Z. In other words, the primes p in Z are the (non-zero) non-units which only have the trivial factorizations p = 1 · p and p = (−1)(−p). Hence, for us, the primes of Z are . . . , −5, −3, −2, 2, 3, 5, . . . . We deﬁne divisibility in Z[i] the exact same way. Deﬁnition 6.4. Let α, β ∈ Z[i]. We say α divides β, or β|α, if α = βγ for some γ ∈ Z[i]. We say α ̸= 0 is a Gaussian prime, or prime in Z[i], if α is a non-unit such that the only divisors of α are ±1, ±i, ±α and ±iα, i.e., if the only divisiors of α, up to units, are 1 and α. Equivalently, we can say α is prime in Z[i] if (i) α ̸= 0 (ii) α is not a unit (N (α) ̸= 1), and (iii) the only factorzations α = βγ are the trivial ones, i.e., where one of β and γ is a unit (and therefore the other is a unit times α). We can relate divisibility in Z[i] with divisibility in Z via the norm map. 39 Lemma 6.5. If β|α in Z[i], then N (β)|N (α) in Z. Proof. Suppose β|α. Then α = βγ, which implies N (α) = N (β)N (γ) by multiplicativity of the norm. Hence N (β)|N (α). Example. α = 4 + i is a Gaussian prime. Proof. The reason is N (α) = 42 + 12 = 17 which is prime in Z. Hence if β|α, we can write α = βγ, and N (β)N (γ) = N (α) = 17. The norm is always non-negative, so the only possibilities are N (β) = 1, N (γ) = 17 or N (γ) = 1, N (β) = 17. By symmetry, we may assume the former. Then β is a unit (±1 or ±i), so it has an inverse β−1 ∈ Z[i]. Hence γ = β−1α, i.e., a unit times α. In other words, the only divisors of α are the units and the units times α. Exercise 6.2. Let α ∈ Z[i]. Show α is a unit of Z[i] if and only if α is invertible in Z[i], i.e., αβ = 1 for some β ∈ Z[i]. (Hint: use the multiplicative property of the norm.) In fact, this is the general deﬁnition of a unit in a ring: something is a unit means its invertible (in the ring). The units always form a multiplicative group. The units of Z are just ±1. The role of {1, −1, i, −i} in Z[i] is exactly analogous to the role of ±1 in Z. The text deﬁnes α to be a Gaussian prime to be an element of Z[i] such that α is not a product of two elements of smaller norm. The following exercise shows our deﬁnition and the book’s are equivalent. Exercise 6.3. Using the deﬁnition of Gaussian prime we gave in class, show the following is true: Suppose α is a non-zero, non-unit. Then α is a Gaussian prime if and only if β|α implies N (β) = 1 or N (β) = N (α). (Cf. Exercise 6.2.1. Hint: look at the example above.) Conclude that if N (α) is prime in Z, α is a Gaussian prime. Example. α = 2 is not a Gaussian prime. Proof. Note N (α) = 22 = 4, so the only reason it couldn’t be a prime in Z[i] is if it is the product of two elements of norm 2. What are the elements a + bi of norm 2? Well, N (a + bi) = a2 + b2, so there are 4 elements of norm 2: 1 + i, 1 − i, −1 + i, and −1 − i. We observe that 2 = (1 + i)(1 − i) = (−1 + i)(−1 − i). Example. The elements of norm 2: 1 + i, 1 − i, −1 + i and −1 − i are all Gaussian primes. This follows from the previous exercise, because their norm is prime in Z. At this point you might ask if any prime in Z remains prime in Z[i]. The answer, reassuringly, is yes. In fact, in a way that can be made precise, exactly half of the primes are still prime in Z[i]. Exercise 6.4. Show there are no elements in Z[i] whose norm is of the form 4n + 3. Conclude that if p = 4n + 3 is prime in Z, then p is also a Gaussian prime. (Cf. Section 6.3) We will soon see that the primes which do not remain prime in Z[i], are precisely the primes of the form p = x2 + y2, which will turn out to be 2 and all primes of the form 4n + 1. 40 Proposition 6.6. (Existence of prime factorization.) Let α ∈ Z[i] be a non-zero, non-unit. Then α factors into a ﬁnite product of Gaussian primes. The proof is the same as for the ordinary integers. Proof. Here it’s easier to use the book’s deﬁnition of Gaussian prime (though our deﬁnition is the more natural one). Either α = βγ where N (β), N (γ) < N (α) or not. If not, α is a Gaussian prime and we are done. If there is such a factorization, we repeat the process with β and γ. E.g., either β = β′β′′ with N (β′), N (β′′) < N (β) or not. If not, β is a Gaussian prime. If so, we repeat with β′, β′′. Because the norms must get smaller and are always at least 1, this process terminates at some point, leaving us with a prime factorization of α in Z[i]. Exercise 6.5. Factor 17 and 53 in Z[i]. (Exercise 6.2.4.) 6.3 Conjugates Proposition 6.7. Let p ∈ N be prime. Then p is also prime in Z[i] if and only if p is not the sum of two squares. Proof. We will prove the negation of this statement, which is equivalent: p is a sum of two squares if and only if p is not prime in Z[i]. (⇒) Suppose p = a2 + b2. Then p = (a + bi)(a − bi). Since p is not a square, both a and b must be nonzero here, hence a ± bi is not a unit. Thus (a + bi)(a − bi) is a non-trivial factorization of p in Z[i]. (⇐) This is a typical use of the norm map. Suppose p is not prime in Z[i]. Then p = αβ where α, β ∈ Z[i] are both non-units, i.e., neither has norm 1. But then N (α)N (β) = N (p) = p2, so N (α)|p2 but N (α), N (β) ̸= 1 implies N (α) = N (β) = p since p is prime in Z. Writing α = a + bi, N (α) = p means p = a2 + b2. (The exercise below says that in fact β = α.) Exercise 6.6. Suppose p ∈ N is prime in Z but factors as p = αβ where α, β are non-units in Z[i]. Show β = α. In fact, a second look at the proof of (⇐) above gives the following. Corollary 6.8. Suppose p ∈ N is prime and p = a2 + b2. Then α = a + bi and α = a − bi are primes in Z[i]. Proof. We know N (α) = N (α) = p, i.e., their norms are prime in N. This means α and α are prime by Exercise 6.3. 6.4 Division in Z[i] Recall that the way we proved unique factorization in Z was via the prime divisor property (p|ab =⇒ p|a or p|b), which we proved using the Euclidean algorithm. We will show unique factorization in Z[i] in the same way. Proposition 6.9. If α, β ∈ Z[i] are non-zero, then there is a quotient µ ∈ Z[i] and remainder ρ ∈ Z[i] such that α = µβ + ρ where N (ρ) < N (β). 41 Proof. In the complex plane, multiplication by i is just rotation by 90 degrees. Hence the vectors β and iβ are orthogonal. Now the set of µβ where µ ∈ Z[i] is just the set of integer linear combinations of β and iβ, i.e., the square lattice (since β and iβ have the same length |β|) in C generated by β and iβ. Now α lies in one of the squares in the lattice (possibly on a line in the lattice), but the furthest α can be from all 4 corners of a square with side length |β| is |β|/√2 (when α is at the center). Hence α is within distance |β|/ √2 to some (not necessarily unique) corner µβ. Then ρ = µβ − α has length at most |β|/ √2. Since N (ρ) = |ρ|2, we see N (ρ) ≤ |β|2/2 = N (β)/2. As before the remainder ρ is 0 if and only if β|α, however the µ and ρ are no longer uniquely determined. Example. α = 1 + 3i, β = 2 + 2i. Then we can write α = 1 · β + (i − 1) = (i + 1)β + (1 − i). However, what is important for us is the following. Lemma 6.10. Suppose α = µβ + ρ where N (ρ) < N (β). Then ρ = 0 iﬀ β|α. Proof. (⇒) Clearly if ρ = 0, β|α. (⇐) Suppose β|α but ρ ̸= 0, i.e., α = (µ + τ )β for some non-zero τ ∈ Z[i], so ρ = τ β. But then N (β)|N (ρ) =⇒ N (ρ) ≥ N (β), a contradiction. Hence ρ = 0. Deﬁnition 6.11. Suppose δ|α and δ|β. We say δ is a common divisor of α and β. We say δ is a greatest common divisor (gcd) of α and β if it is a common divisor of α and β with maximum possible norm. Note that the gcd is not unique here. For example, ±5, ±5i are all gcd’s of 5 and 10. It is not even clear a priori if the gcd is always unique up to a unit. This will follow from the prime divisor property or unique factorization. Lemma 6.12. Suppose α = µβ + ρ where N (ρ) < N (β). If ρ = 0, β is a gcd for α and β. If not, a gcd for α and ρ is also a gcd for α and β (and vice versa). Proof. The ﬁrst statement is clear from the above lemma, because no divisor of β can have norm larger than N (β). So suppose ρ ̸= 0. Any common divisor of α and β must be a common divisor of α and ρ, and vice versa. This implies that any gcd of α and β will be a gcd of α and ρ, and vice versa. This lemma shows that the following algorithm to determine a gcd for α and β in Z[i] always works. Just as in case of Z, it terminates in a ﬁnite number of steps by decent on the norm of the remainder. Euclidean algorithm for Z[i] 1. Suppose N (α) ≥ N (β). Let (α1, β1) = (α, β). Set i = 1. 2. Write αi = µiβi + ρi where N (ρi) < N (βi). If ρi = 0, then βi is a gcd for α and β. If not, continue. 3. Let αi+1 = βi, βi+1 = ρi. Note that N (αi+1) > N (β)i+1 from Step 2. Increase i by 1 and repeat Step 2 (i.e., repeat Step 2 for αi+1 and βi+1). 42 Exercise 6.7. Use the Euclidean algorithm to determine a gcd for α = 5 and β = 3 + 4i in Z[i]. Just like in Section 2.3, we can run the Euclidean algorithm in reverse to get that some gcd of α and β must be of the form µα + νβ for some µ, ν ∈ Z[i]. Proposition 6.13. (Prime divisor property) Let π be a prime in Z[i]. If π|αβ then π|α or π|β. Proof. Suppose π|αβ, but π ∤ α. We want to show π|β. This is the essentially the same argument we gave for N. Since π ∤ α and π is prime in Z[i], any gcd of π and α must be a unit. (If not, it would have to be a non-trivial divisor of π.) By the above, some unit u (some gcd) is a linear combination of π and α, i.e., u = µπ + να for some µ, ν ∈ Z[i]. Hence uβ = µπβ + ναβ. But π divides both terms on the right, π|uβ, so π|β by the simple exercise below. Exercise 6.8. Let π, β ∈ Z[i] and u be a unit of Z[i]. Show that π|uβ ⇐⇒ π|β. Another simple exercise is the following, which we will use in the proof of unique factorization. Exercise 6.9. Suppose π and π′ are primes of Z[i]. Show π|π′ implies π = uπ′ where u is a unit of Z[i]. Theorem 6.14. (Unique factorization) Let α ̸= 0 be a non-unit in Z[i]. Suppose α = π1 · · · πm and α = π′ 1 · · · π′ n are two factorizations of α into Gaussian primes πi and π′ j. Then m = n, and up to a reordering of the π′ j’s, we have πi = uiπ′ i for each i, where ui is a unit in Z[i]. Proof. The proof again is almost exactly the same as in the case of N. Suppose the theorem is false. Cancelling any common factors, assume π1 · · · πm = π′ 1 · · · π′ n where πi ̸= uπ′ j for any i, j and unit u. Clearly π1|π′ 1 · · · π′ n. Since π1 is prime, by the prime divisor property π1|π′ 1 or π1|(π′ 2 · · · π′ n). Now π1|π′ 1 is impossible since π1 ̸= uπ′ 1 for any unit u. Hence π1|(π′ 2 · · · π′ n). Repeating this argument eventually gives π1|π′ n, a contradiction. Example. Let α = 6i = 2 · 3i. In Z[i], 3 remains prime since it is not a sum of two squares. This means 3i is also a prime in Z[i] since i is just a unit. On the other hand, 2 = (1 + i)(1 − i) and we know 1 ± i are prime in Z[i] because their norms (both 2) are prime in N. Unique factorization says that 6i = (1 + i)(1 − i)(3i) is the only factorization of 6 into primes of Z[i], up to reordering and multiplying each factor by a unit, i.e., we consider 6i = (−3)(i − 1) 2 to be equivalent to the factorzation above since −3 = i · (3i), (i − 1) = i · (1+ i) and (i − 1) = −(1 − i). 43 Exercise 6.10. Let u be a unit in Z[i]. Show π is prime in Z[i] if and only if uπ is prime in Z[i]. We say the primes π and uπ (u a unit) are associated. Hence we say primes π and π′ are nonassociated if they do not diﬀer by units. Just as in the case of Z, unique factorization implies the following. Corollary 6.15. Let π1, . . . , πn be nonassociated primes of Z[i]. Suppose α = πe1 1 · · · πen n and β = πf1 1 · · · πfn n (where ei, fi ≥ 0). Then any gcd of α and β equals a unit times πmin(e1,f1) 1 · · · πmin(en,fn) n . Hence “the” gcd of two elements is unique up to units. Moreover, it satisﬁes the property that if µ and ν are relatively prime (i.e., their gcd is 1) common divisors of α and β, then µν divides “the” gcd of α and β. Example. To see what can go wrong with the gcd when we don’t have unique factorization, consider the example of 6 = 2 · 3 = (1 + √−5)(1 − √−5) ∈ Z[ √−5]. Then what is the gcd of α = 6 and β = 2(1 + √−5)? Both 2 and 1 + √−5 (which themselves are relatively prime) are common divisors, but their product is not a common divisor. In this speciﬁc example, we could say that 1+√−5 should be “the” gcd because it has larger norm, but philosophically 2 should also be a gcd, because no multiple of 2 divides both α and β. Proposition 6.16. The Gaussian primes, up to units, are precisely the following: (i) primes p ∈ N not of the form x2 + y2, (ii) α = a + bi where N (α) is prime in N. Proof. We know that elements of type (i) are prime in Z[i] by Section 6.3, and elements of type (ii) are prime in Z[i] by Exercise 6.3. So we just have to show any prime α of Z[i] is, up to a unit, of type (i) or (ii). Consider N (α) = αα = n. Since α is also prime, αα is the unique prime factorization of n in Z[i]. Either n is prime in N or not. If it is, then α is of type (ii) and we are done. If not, then n has a non-trivial factorization n = ab in N. But since any prime factorization of n in Z[i] has only two elements, a and b must be prime in Z[i], and the factorizations n = αα = ab are the same. Thus uα ∈ equals a or b for some unit u. Moreover uα must be prime in N since it is prime in Z[i]. Hence uα is of type (i) by Section 6.3. Exercise 6.11. Suppose α is prime in Z[i]. Show N (α) = p or N (α) = p2 for some prime p of N. 6.5 Fermat’s two square theorem Now we can apply the theory of Z[i] to the classical problem, which number k are sums of two squares, i.e., for which k is Q(x, y) = x 2 + y2 = k solvable for x, y ∈ Z. Just by calculation, we can check that the numbers 1 ≤ k ≤ 50 which are sums of two squares are 1, 2, 4, 5, 8, 9, 10, 13, 16, 17, 18, 20, 25, 26, 29, 32, 34, 36, 37, 40, 41, 45, 49, 50. Here there is no apparent pattern, except perhaps that, as we have seen before, this sequence avoids the numbers of the form 4n + 3. Now, if I ask you to check which primes 1 ≤ p ≤ 50 are sums of two squares you will see 2, 5, 13, 17, 29, 37, 41 44 so the primes < 50 which are not sums of two squares are precisely 3, 7, 11, 19, 23, 31, 43, 47. Here, if we look at the mod 4 congruence classes we see the patter than p = x2 + y2 if and only if p ̸≡ 3 mod 4. This is the content of Fermat’s two square theorem, and it will answer the more general question about when is n = x2 + y2. Lemma 6.17. (Lagrange) A prime p = 4n + 1 divides m2 + 1 for some m ∈ Z. Proof. By Wilson’s theorem (4n)! ≡ −1 mod p. Note (4n)! ≡ (2n)! × (2n + 1)(2n + 2) · · · 4n ≡ (2n)! × (−2n)(−2n + 1) · · · (−1) mod p. Hence (4n)! ≡ (2n)!(−1) 2n(2n)! ≡ ((2n)!) 2 mod p. Thus p|((2n)!)2 + 1. Theorem 6.18. (Fermat) Let p be prime. Then p = x2 + y2 for some x, y ∈ Z if and only if p = 2 or p ≡ 1 mod 4. Proof. (⇒) Suppose p = x2 + y2. We saw in Section 3.7 that p ̸≡ 3 mod 4. However no prime is 0 mod 4, and 2 is the only prime which is 2 mod 4. (⇐) We know 2 = 12 + 12 so suppose p = 4n + 1 for some n. By Lagrange’s lemma, p|m2 + 1 for some m ∈ Z. If p were a Gaussian prime, then p|m2 + 1 = (m + i)(m − i) would imply p|(m + i) or p|(m − i) in Z[i]. However this is not the case since m p ± i p ̸∈ Z[i]. So p is not a Gaussian prime, i.e., p is the sum of two squares by Section 6.3. Corollary 6.19. Let p be a prime which is not 3 mod 4. Then p = x2 + y2 has exactly 1 solution for x, y ∈ N with x ≥ y. Proof. There is a solution x2 + y2 = p by the theorem. We know that p = (x + yi)(x − yi) is a factorization into primes in Z[i]. (Section 6.3) If we also have p = x′2 +y′2 then p = (x′ +y′i)(x′ −y′i) is also a prime factorization in Z[i]. But since prime factorization is unique, we have x′ + y′i = u(x + yi) or u(x − yi) for some unit u. Suppose the former. If u = ±1 then x′ = ±x and y′ = ±y. If u = ±i then u = ±i, then x′ = ∓y and y′ = ±x. Hence x′ and y′ are up to sign, x and y in some order. The case x′ + y′i = u(x − yi) is similar. So there is only one solution to p = x2 + y2 with x, y > 0, up to interchanging x and y. Corollary 6.20. The primes of Z[i] are precisely units times (i) p where p = 4n + 3 is a prime in N, (ii) α = a + bi where N (α) is either 2 or a prime of N congruent to 1 mod 4. Proof. Combine Proposition 6.16 with Fermat’s two square theorem. Theorem 6.21. A natural number n is a sum of two squares if and only if any prime p|n such that p ≡ 3 mod 4 occurs to an even power in the prime factorization of n. 45 Proof. Clearly n = x2 + y2 if and only if n = N (α) where α = x + yi, i.e., n is a sum of two squares if and only if it is the norm of some element of Z[i]. Let n = ∏ pei i ∏ qfj j be the prime factorization of n in N where each pi ≡ 3 mod 4 and qj ̸≡ 3 mod 4. Each qj = πjπj where πj is some Gaussian prime. Thus n = ∏ pei i ∏ πfj j πfj j is the prime factorization of n in Z[i], where each pi is of type (i) and each πj, πj is of type (ii), in the notation of the above corollary. (⇒) Suppose n = x2 + y2, i.e., n = N (α) for some α ∈ Z[i]. Let α = ∏ rhi i ∏ ϕkj j be the prime factorization of α in Z[i], again where each ri is of type (i) and each ϕj is of type (ii). Then α = ∏ rhi i ∏ ϕkj j = ∏ rhi i ∏ ϕkj j is the prime factorization of α since each ri ∈ N. But then αα = ∏ r2hi i ∏ ϕkj j ϕkj j = n = ∏ pei i ∏ πfj j πfj j Hence up to reordering the primes (assuming all were distinct), we have ei = 2hi is even, which is what we wanted to prove. (⇐) Homework. (This direction is easier and you don’t need to use the unique factorization in Z[i].) This theorem, which was also known to Fermat, along with Corollary 6.19, shows the power of having unique factorization in Z[i]. Now ﬁnish the proof yourself. Exercise 6.12. Suppose n = ∏ p 2ei i ∏ qfj j where each pi, qj are primes of N such that each pi ≡ 3 mod 4 and qj ≡ 1, 2 mod 4. (i) Show each p2ei i and qfj j is the norm of an element in Z[i]. (ii) Deduce n = x2 + y2 for some x, y ∈ Z. In fact, Gauss and Jacobi went further than Fermat’s theorem and proved the following (which Fermat it seems also knew, though perhaps did not have a proof). Theorem 6.22. Let r2(n) denote the number of solutions to x2 + y2 = n. Write n = 2f n1n2 where n1 is a product of primes ≡ 1 mod 4 and n2 is a product of primes ≡ 3 mod 4. Then r2(n) = 0 if n2 is not a perfect square, and r2(n) is 4 times the number of divisors of n1 otherwise. We will not prove this now (although we could using the unique factorization in Z[i]), but one of my goals for next semester is to prove a theorem of Dirichlet which essentially contains this as a special case. Exercise 6.13. Find an n such that n = x2 + y2 in at least two distinct ways (with x, y > 0 and x ≥ y). Write down all solutions (with x, y > 0, x ≥ y). Using this, show there are two elements α, β ∈ Z[i] such that N (α) = N (β) but α and β do not diﬀer by units. 46 6.6 Pythagorean triples Deﬁnition 6.23. Let α, β ∈ Z[i]. If the only common divisors of α and β are units, we say α and β are relatively prime. Lemma 6.24. Suppose (x, y, z) is a primitive Pythagorean triple. Then x + yi and x − yi are relatively prime in Z[i], i.e., they have no common prime divisors in Z[i]. Proof. Suppose instead, x + yi and x − yi have a common prime divisor π ∈ Z[i]. Then π divides their sum 2x and their diﬀerence 2yi. Since x and y have no common prime factors in Z, they have no common prime factors in Z[i]. Thus π must be a prime dividing 2, i.e., π = ±1 + ±i. Then N (π) = ππ = 2|(x + yi)(x − yi) = x2 + y2 = z2. This means z is even, so x2+y2 ≡ 0 mod 4, which implies x and y are both even, a contradiction. Lemma 6.25. Suppose α, β ∈ Z[i] are relatively prime. If αβ = γ2 is a square in Z[i], then uα and u−1β are squares for some unit u of Z[i]. Proof. Note that this is trivial if γ is a unit (and vacuous if γ = 0). So assume αβ is the square of some γ ∈ Z[i], where γ is a non-zero non-unit. Then γ has a prime factorization in Z[i]: γ = ∏ πei i . Thus the prime factorization of αβ is αβ = ∏ π2ei i . Up to a reordering of primes, we have α = u −1π2e1 1 · · · π2ej j β = uπ2ej+1 j+2 · · · π2ek k for some unit u. Exercise 6.14. Give an example of relatively prime α, β in Z[i] such that αβ is a square in Z[i], but α and β are not squares in Z[i]. Recall that (x, y, z) is a primitive Pythagorean triple if x, y, z ∈ N if gcd(x, y) = 1. If (x, y, z) is a primitive Pythagorean triple, then (λx, λy, λz) is also a Pythagorean triple. It is also clear that all Pythagorean triples are multiples of the primitive ones. Hence to determine all Pythagorean triples, it suﬃces to determine the primitive ones, which we now see how to do using Z[i]. Proposition 6.26. (x, y, z) is a primitive Pythagorean triple if and only if x and y are (in some order) u2 − v2 and 2uv for u, v relatively prime in N with u > v and u, v not both odd. In this case, z = u2 + v2. Proof. (⇐) This was Exercise 2.1.5. (⇒) Suppose (x, y, z) is a primitive Pythagorean triple, so x2 + y2 = (x + yi)(x − yi) = z2. By the ﬁrst lemma, x + yi and x − yi are relatively prime, and by the second they are units times 47 squares. In particular x + yi = ±α2 or x + yi = ±iα2 for some α ∈ Z[i]. Since −1 is a square in Z[i], we may absorb the possible minus sign into α and write either x + yi = α2 or x + yi = iα2. Write α = u + vi, and we get in the ﬁrst case x + yi = (u + vi) 2 = u 2 + v2 + 2uvi and x + yi = i(u + vi) 2 = −2uv + (u 2 + v2)i. In the ﬁrst case we have x = u2 + v2, y = 2uv. In the second, we may replace u by −u to write x = 2uv, y = u2 + v2. Then the conditions gcd(u, v) = 1, u > v and u, v not both odd all follow from the facts that gcd(x, y) and x, y > 0 just as in Exercise 2.1.5. The last statement is obvious. Corollary 6.27. Let p ∈ N be prime. Then p occurs as the hypoteneuse of a right-angle triangle with integer length sides if and only if p > 2 is a sum of two squares, i.e., if and only if p ≡ 1 mod 4. Proof. The second equivalence is Fermat’s two square theorem, so it suﬃces to prove the ﬁrst. (⇒) Suppose p is such a hypotenuse. Clearly p ̸= 2. Now x2 + y2 = p2. This implies gcd(x, y) = 1. Hence by the proposition p = u2 + v2 for some u, v. (⇐) Suppose p = u2 + v2 is odd. Then u ̸= v and u and v are not both odd. Furthermore, we may assume u > v. By the proposition (u2 − v2, 2uv, p) is a primitive Pythagorean triple. 6.7 *Primes of the form 4n + 1 I mentioned earlier that precisely half of the primes in Z remain prime in Z[i], and half factor in Z[i]. We saw that the primes in the ﬁrst groups are the primes which are 3 mod 4, and the primes in the second group are 2 and those 1 mod 4. My claim then is that, in a sense which can be made precise, half of the (odd) primes in N are 1 mod 4 and half are 3 mod 4. In this section we will prove that there are inﬁnitely many primes of the form 4n + 1 and, in the exercises, inﬁnitely many primes of the form 4n + 3. Proposition 6.28. Let p be an odd prime. Then x2 ≡ −1 mod p has a solution if and only if p = 4n + 1. Proof. (⇒) Suppose x2 ≡ −1 mod p but p = 4n + 3. Then xp−1 ≡ x4n+2 ≡ (x 2) 2n+1 ≡ (−1) 2n+1 ≡ −1 mod p, which contradicts Fermat’s little theorem. Hence p ≡ 1 mod 4. (⇐) Suppose p = 4n + 1. Then Lagrange’s lemma (Lemma 6.17) says p|m2 + 1 for some m ∈ Z. Hence m2 ≡ −1 mod p. The above proposition is a special case of Gauss’s golden theorem in number theory, quadratic reciprocity. We will treat quadratic reciprocity in Chapter 9, but for now, we will use the above to prove the following. Proposition 6.29. There are inﬁnitely many primes of the form 4n + 1. 48 Proof. The above proposition says an odd prime p is of the form 4n + 1 if and only if p|x2 + 1 for some x ∈ Z. Hence it suﬃces to show that there are inﬁnitely many primes dividing the values of the polynomial f (x) = x2 + 1. Suppose instead only ﬁnitely many primes p1, . . . , pk (including 2) divide the values of f (x). Let g(y) = f (p1 · · · pky) = (p1 · · · pk) 2y2 + 1 The values of g(y) are a subset of the values of f (x) so the only primes which divide values of g(y) are p1, . . . , pk. However g(y) ≡ 1 mod pi for i = 1, 2, . . . , k. Hence g(1) = (p1 · · · pk)2+1 > 1 is not divisible by any prime, a contradiction. Exercise 6.15. Let f (x) be any nonconstant polynomial over Z. Show there are inﬁnitely many primes dividing the values of f (x). (Cf. Exercises 6.7.1—6.7.4.) Exercise 6.16. Show that there are inﬁnitely many primes of the form 4n+3 (Cf. Exercises 6.3.4— 6.3.6. Note that this argument is similar to the 4n + 1 case with the polynomial f (x) = 2x2 + 1. If you like, you may try to use this idea and apply the previous exercise.) The above results are a special case of the following. Theorem 6.30. (Dirichlet’s theorem on arithmetic progressions) Suppose gcd(a, n) = 1. There are inﬁnitely many prime p ≡ a mod n. The proof was surprisingly novel, using an analytic tool that Dirichlet invented called L- functions, which form a central topic in modern number theory. We will not prove this theorem this semester, but will come back to it next semester when we introduce Dirichlet’s L-functions. Now that we know there are inﬁnitely many primes which are 1 mod 4 and 3 mod 4, you might wonder whether there’s something further about my assertion that half of the (odd) primes are 1 mod 4 and half are 3 mod 4. The answer is yes, Dirichlet proved something even more precise than the above theorem. Theorem 6.31. (Dirichlet) The odd primes, with the natural ordering, are equally distributed in the two congruence classes 4Z + 1 and 4Z + 3, i.e., lim n→∞ # {p < n : p ≡ 1 mod 4 prime} # {p < n : p ≡ 3 mod 4 prime} = 1. Dirichlet in fact proved that mod any n, the primes (not dividing n), are equally distributed (in the above sense) among the ϕ(n) congruence classes nZ + a where gcd(a, n) = 1. Nevertheless, Chebyshev noticed an interesting phenomenon, more amazing in light of the equal distribution result of Dirichlet: there appear to be more primes of the latter form. Precisely, if we actually count the primes in each class less than n, “most of the time” we have # {p < n : p ≡ 3 mod 4 prime} > # {p < n : p ≡ 1 mod 4 prime} For example, the ﬁrst time the right hand side is greater is for n = 26861. One might wonder if Chebyshev’s observation just happens to be true for small values of n. In fact for inﬁnitely many n the left hand side is greater, and inﬁnitely many n the right hand side is greater. Nevertheless, 49 Chebyshev was right. In 1994, Rubinstein and Sarnak showed, in an appropriate way of quantifying things, the above inequality holds about 99.59% of the time. Very roughly, one reason why there are more primes in 4Z + 3 is because 4Z + 1 must contain all the odd squares, leaving less room for primes. If you are interested in learning more about this, see the excellent, very readable exposition Prime Number Races by Andrew Granville and Greg Martin (Jan. 2006 American Math Monthly, available online). 6.8 Discussion Again, I think it’s worth reading. 50","libVersion":"0.3.1","langs":""}
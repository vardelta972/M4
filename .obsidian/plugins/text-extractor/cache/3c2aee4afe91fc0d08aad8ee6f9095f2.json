{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Franz/Algebraic NT/ch6.pdf","text":"Chapter 6 Quadratic Reciprocity 6.1 Residue Class Rings We have already seen that the unit group of Z is simply Z × = {−1, +1}, a group of order 2. Let us now determine the unit groups of the rings of residue classes Z/mZ. Observe that a residue class [u]m modulo m is a unit if there exists an integer v such that [uv]m = [1]m, in other words: if uv ≡ 1 mod m for some v ∈ Z. Now we claim Theorem 6.1. We have (Z/mZ) × = {a mod m : gcd(a, m) = 1}. Proof. It is now that the Bezout representation begins to show its full power. If gcd(a, m) = 1, then there exist integers x, y ∈ Z such that ax + my = 1. Reducing this equation modulo m gives ax ≡ 1 mod m, in other words: the residue class a mod m is a unit! Not only that: the extended Euclidean algorithm gives us a method to compute the inverse elements. To prove the converse, assume that a mod m is a unit. Then ac ≡ 1 mod m for some c ∈ Z, so ac = km + 1 for some k ∈ Z. But then ac − km = 1 shows that gcd(a, m) = 1. If m = p is a prime, the unit groups are particularly simple: we have gcd(a, p) = 1 if and only if p ∤ a, hence (Z/pZ) × = {1, 2, . . . , p−1} = Z/pZ\\{0}. But if every element ̸= 0 of a ring has an inverse, then that ring is a ﬁeld, and we have given a second proof of the following Corollary 6.2. If p is a prime, then the residue class ring Z/pZ is a ﬁeld. The ﬁeld Z/pZ is called a ﬁnite ﬁeld because it has ﬁnitely many elements. As we have seen, there are ﬁnite ﬁelds with p elements for every prime p. Later we will see that there exist ﬁnite ﬁelds with m > 1 elements if and only if m is a prime power. 52 The fact that Z/pZ is a ﬁeld means that expressions like 1 7 mod 11 make sense. To compute such ‘fractions’, you can choose one of the following two methods: 1. Change the numerator mod 11 until the division becomes possible: 1 7 ≡ 12 7 ≡ 23 7 ≡ 34 7 ≡ 45 7 ≡ 56 7 = 8 mod 11, and in fact 7 · 8 = 56 ≡ 1 mod 11. This method only works well if p is small. 2. Apply the Euclidean algorithm to the pair (7, 11), and compute a Bezout representation; you will ﬁnd that 1 = 2 · 11 − 3 · 7, and reducing mod 11 gives 1 ≡ (−3) · 7 mod 11, hence the multiplicative inverse of 7 mod 11 is −3 ≡ 8 mod 11. 6.2 Fermat’s Little Theorem Theorem 6.3 (Fermat’s Little Theorem). If p is a prime and a an integer not divisible by p, then a p−1 ≡ 1 mod p. The following proof is due to Leibniz1 and probably the oldest proof known for Fermat’s Little Theorem. It uses binomial coeﬃcients: these are the entries in Pascal’s triangle, and they occur in the binomial theorem (a + b) n = a n + (n 1 )a n−1b + (n 2 )a n−2b2 + . . . + ( n n − 1 )ab n−1 + bn. We will need two properties of (n k): ﬁrst we use the formula (n k) = n! k!(n−k)! (which was how we deﬁned them in Chapter 3), and then we claim Lemma 6.4. If p is a prime, then the numbers (p k), k = 1, 2, . . . , p − 1, are all divisible by p. For example, the ﬁfth row of Pascal’s triangle is 1 5 10 10 5 1. The claim is not true if p is not a prime: the sixth row is 1 6 15 20 15 6 1, and the numbers 15 and 20 are not divisible by 6. Proof. From (p k) = p! k!(p−k)! we see that the numerator is divisible by p while the denominator is not divisible by p unless k = 0 or k = p. Thus we conclude that p | (p k) for 0 < k < p. Now we can give an induction proof of Fermat’s Little Theorem: 1Gottfried Wilhelm von Leibniz, 1646 (Leipzig) – 1716 (Hannover). 53 Proof. We prove the equivalent (!) statement a p ≡ a mod p for all a ∈ Z via induction on a. The claim is clearly trivial for a = 1; assume it has been proved for some a; then (a + 1) p = a p + (p 1 )a p−1 + . . . + ( p p − 1 )a + 1. Since the binomial coeﬃcients are all ≡ 0 mod p by the lemma, we ﬁnd (a + 1) p ≡ a p + 1 mod p, and by the induction assumption, a p ≡ a mod p, so we get (a+1) p ≡ a+1 mod p, and the induction step is established. There is another proof of Fermat’s little theorem that works for any ﬁnite group. To see what’s going on, consider (Z/5Z) × = {[1], [2], [3], [4]}, where [r] denotes the residue class r mod 5. If we multiply each of these classes by 3, we get [1] · [3] = [3], [2] · [3] = [1], [3] · [3] = [4], [4] · [3] = [2]; thus multiplying all prime residue classes mod 5 by 3 yields the same classes again, though in a diﬀerent order. If we multiply these four equations together, we get [1][2][3][4] · [3] 4 = [3][1][4][2] = [1][2][3][4], hence [3] 4 = [1], or, in other words, 34 ≡ 1 mod 5. This can be done in general: Second Proof of Thm. 6.3. Write (Z/pZ) × = {[1], [2], . . . , [p − 1]}; let a be an integer not divisible by p. If we multiply each residue class with [a], we get the p − 1 classes [a], [2a], . . . , [(p − 1)a]: [1] · [a] = [a] [2] · [a] = [2a] ... [p − 1] · [a] = [(p − 1)a] If we can show that the classes on the right hand side are all diﬀerent, then they must be a permutation of the classes [1], . . . , [p − 1] that we started with. Taking this for granted, the products [a] · [2a] · · · [(p − 1)a] = [(p − 1)!][a p−1] and [1] · [2] · · · [p − 1] = [(p − 1)!] must be equal (after all, the factors are just rearranged). But (p − 1)! is coprime to p, so we may cancel this factor, and get [a p−1] = [1], i.e., a p−1 ≡ 1 mod p. It remains to show that the classes [a], [2a], . . . , [(p − 1)a] are all diﬀerent. Assume therefore that [ra] = [sa] for integers 1 ≤ r, s ≤ p − 1; we have to show 54 that r = s. But [ra] = [sa] means that [(r − s)a] = [0], i.e. that p | (r − s)a. Since p ∤ a by assumption, the fact that p is prime implies p | (r − s). But r − s is an integer strictly between −p and p, and the only such integer is 0: thus r = s as claimed. One of the ideas behind this proof can be formalized somewhat: First, mul- tiplication by an integer a not divisible by p gives a map πa : (Z/pZ) × −→ (Z/pZ) ×; thus ϕa[r] = [ar]. We claim that it is injective. This means that if ϕa([r]) = ϕa([s]), then [r] = [s]. In fact, assume that ϕa([r]) = ϕa([s]); then [ar] = [as], and since p ∤ a, we can cancel the factor a and get [r] = [s]. Now it is clear that injective maps between ﬁnite sets of the same cardinality (i.e., with the same number of elements) are necessarily bijective. This proves again that the residue classes [1 · a], [2 · a], . . . , [(p − 1) · a] are just the classes [1], [2], . . . , [p − 1] in some diﬀerent order. 6.3 Quadratic Residues Let b be an integer; an integer a coprime to b is called a quadratic residue modulo b if a ≡ x 2 mod b for some integer x, and a quadratic nonresidue modulo b otherwise. The quadratic residues modulo 7 are 1, 2 ≡ 3 2 and 4, whereas 2, 5 and 6 are quadratic nonresidues modulo 7. We have already proved that −1 is a quadratic residue modulo p for primes p ≡ 1 mod 4, and a quadratic nonresidue for primes p ≡ 3 mod 4. Lemma 6.5. There are exactly p−1 2 quadratic residues modulo an odd prime p, namely the squares of the integers 1, 2, . . . , p−1 2 . Proof. Clearly the residue classes 12, 22, . . . , k2 mod p, where p = 2k + 1, are quadratic residues modulo p. We claim that they are pairwise distinct. In fact, assume that i 2 ≡ j2 mod p for 1 ≤ i, j, ≤ k. Then p | (i 2 − j2) = (i − j)(i + j). Since 2 ≤ i + j ≤ p − 1 we have p ∤ (i + j); since p is prime, this implies p | (i − j). Now −k < i − j < k, and since the only integer in this interval that is divisible by p is 0, we conclude that i = j. Actually what we have shown is that the function f (x) = x 2 is injective as a function of [1, k] −→ Z/pZ. In particular, there are at least k quadratic residues. Actually, there aren’t any others: if a ≡ x 2 mod p, then we can reduce x mod p in such a way that −k ≤ x ≤ k, and replacing x by −x if necessary we see that a ≡ x 2 mod p for some x ∈ [1, k]. Since there are p − 1 nonzero residue classes modulo p and p−1 2 of them are squares, this implies that there exist exactly p − 1 − p−1 2 = p−1 2 quadratic nonresidues modulo p. These can be represented as follows: Lemma 6.6. Let p be an odd prime and n some quadratic nonresidue. Then the k = p−1 2 quadratic nonresidues are given by n · 1 2, n · 2 2, . . . , n · k2. 55 Proof. None of these numbers is a quadratic residue: in fact, n · r2 ≡ s 2 mod p implies that n ≡ (sr−1) 2 mod p is a square, contradicting our assumption. Moreover, these numbers are pairwise distinct: n · r2 ≡ n · s 2 mod p implies r2 ≡ s 2 mod p, which by the proof of the preceding lemma is only possible if r = s. Since there exist exactly k quadratic nonresidues, the list above must be complete. Let us also introduce the following notation: we write ( a p ) = { +1 if a is a quadratic residue modulo p, −1 if a is a quadratic nonresidue modulo p. The symbol ( a p ) is called the quadratic Legendre symbol. Here are its most basic properties: Proposition 6.7. Let p be an odd prime; then 1. a ≡ b mod p implies ( a p ) = ( b p ); 2. the Legendre symbol is multiplicative: ( a p )( b p ) = ( ab p ) for a, b ∈ Z coprime to p. Proof. The ﬁrst property is clear: If a ≡ x 2 mod p and a ≡ b mod p, then b ≡ x 2 mod p and vice versa. As for the second claim, there are several cases. 1. ( a p ) = ( b p ) = +1: then a ≡ r2 mod p and b ≡ s 2 mod p, hence ab ≡ (rs) 2 mod p and therefore ( ab p ) = 1. 2. ( a p ) = +1, ( b p ) = −1: then a ≡ r2 mod p and b ≡ n · s 2 mod p, hence ab ≡ n · (rs) 2 mod p and therefore ( ab p ) = −1. 3. ( a p ) = −1, ( b p ) = +1: same as above. 4. ( a p ) = ( b p ) = −1: then a ≡ nr2 mod p and b ≡ ns 2 mod p, hence ab ≡ (nrs) 2 mod p and therefore ( ab p ) = 1. How can we tell whether a given integer is a quadratic residue or not? The following result does not seem to be very useful at ﬁrst: Proposition 6.8 (Euler’s Criterion). We have a (p−1)/2 ≡ ( a p ) mod p. 56 Proof. The fact that a (p−1)/2 ≡ 1 mod p if a is a quadratic residue follows trivially from Fermat’s Little Theorem. Assume therefore that (a/p) = −1. Then every nonzero residue class can be written uniquely as r2 or ar2 for some 1 ≤ r ≤ p−1 2 . Thus (p − 1)! ≡ ∏ r (ar2)(r2) ≡ a p−1 2 ∏ r [r(p − r)] 2 = a p−1 2 [(p − 1)!] 2 mod p. Since (p − 1)! ≡ −1 mod p by Wilson’s theorem, the claim follows. We now give a second proof of the multiplicativity of the numerator of the Legendre symbol using Euler’s criterion: Proposition 6.9. For integers a, b coprime to p we have ( a p )( b p ) = ( ab p ). Proof. If ( a p ) = +1 or ( b p ) = +1, this actually follows easily from the deﬁnitions. If, however, ( a p ) = ( b p ) = −1, then we have to work harder. The following proof covers all cases: we have ( a p ) ≡ a (p−1)/2 mod p, ( b p ) ≡ b(p−1)/2 mod p, and ( ab p ) ≡ (ab) (p−1)/2 mod p. This implies ( a p )( b p ) ≡ ( ab p ) mod p, hence p divides the diﬀerence ( a p )( b p ) − ( ab p ). But the absolute value of this diﬀerence is ≤ 2, and since the only number in this interval that is divisible by p is 0, the diﬀerence must be 0. Another corollary is the quadratic character of −1: Proposition 6.10. For odd primes p we have ( −1 p ) = (−1) p−1 2 . This is called the ﬁrst supplementary law of quadratic reciprocity. The proof is easy: by Euler’s criterion, we have ( −1 p ) ≡ (−1) (p−1)/2 mod p. Thus ( −1 p ) − (−1) (p−1)/2 is an integer between −2 and +2 that is divisible by p: this implies equality ( −1 p ) = (−1) (p−1)/2. This simple result allows us to prove that there are inﬁnitely many primes of the form 4n + 1. We ﬁrst formulate a little Lemma 6.11. If p > 0 is an odd prime divisor of an integer of the form n2 + 1, then p ≡ 1 mod 4. Proof. From p | n2 + 1 we deduce that n2 ≡ −1 mod p. Thus −1 is a quadratic residue modulo p, hence p ≡ 1 mod 4. Corollary 6.12. There are inﬁnitely many primes of the form 4n + 1. 57 Proof. Assume there are only ﬁnitely many primes of the form 4n + 1, say p1 = 5, p2, . . . , pn. Then N = 4p2 1 · · · p2 n + 1 is of the form 4n + 1 and greater than all the primes pk of this form, hence N must be composite. Now N is odd, hence so is any prime divisor p of N , and since any such p is of the form 4n + 1 by Prop. 6.10, we conclude that p = pk for some index k. But then pk | N and pk | N − 1 = 4p2 1 · · · p2 n, and we get the contradiction that pk | (N − (N − 1)) = 1. Now let us study the behaviour of the prime 2: p 3 5 7 11 13 17 19 23 29 31 (2/p) −1 −1 +1 −1 −1 +1 −1 +1 −1 +1√2 − − ±3 − − ±6 − ±5 − ±8 Thus 2 is a quadratic residue modulo 7, 17, 23, and 31; among the primes in this table, these are exactly the primes of the form p ≡ ±1 mod 8. Thus we conjecture: Proposition 6.13. The prime 2 is a quadratic residue modulo an odd prime p if and only if p ≡ ±1 mod 8. In other words: we have ( 2 p ) = (−1) (p 2−1)/8. The fact that the second claim is equivalent to the ﬁrst is easy to check: Basically, the proof boils down to the following table: a mod 8 1 3 5 7 1 8 (a 2 − 1) mod 2 0 1 1 0 We will prove this conjecture below. Can you use it to prove that there are inﬁnitely many primes of the form p ≡ ±1 mod 8? 6.4 Gauss’s Lemma The main ingredient of the elementary proofs of the quadratic reciprocity law is a lemma that Gauss invented for his third proof. Recall how we proved Fermat’s Little Theorem: we took a complete set of nonzero residue classes {1, 2, . . . , p − 1}, multiplied everything by a, and pulled out the factor a p−1. For quadratic reciprocity, Euler’s criterion suggests that we would like to pull out a factor a (p−1)/2. That’s what made Gauss introduce a halfsystem modulo p: this is any set A = {a1, . . . , am} of representatives for residue classes modulo p = 2m + 1 with the following properties: a) the aj are distinct modulo p, that is: if ai ≡ aj mod p, then i = j; b) every integer is either congruent modulo p to ai or to −ai for some 1 ≤ i ≤ p−1 2 . In other words: a halfsystem A is any set of integers such A ∪ −A is a complete set of nonzero residue classes modulo p. A typical halfsystem modulo p is the set A = {1, 2, . . . , p−1 2 }. 58 Now consider the prime p = 13, choose A = {1, 2, 3, 4, 5, 6}, and look at a = 2. Proceeding as in the proof of Fermat’s Little Theorem, we multiply everything in sight by 2 and ﬁnd 2 · 1 ≡ +2 mod 13, 2 · 2 ≡ +4 mod 13, 2 · 3 ≡ +6 mod 13, 2 · 4 ≡ −5 mod 13, 2 · 5 ≡ −3 mod 13, 2 · 6 ≡ −1 mod 13. Thus three products still lie in A, while three others lie in −A. Thus there is an odd number of sign changes, and 2 is a quadratic nonresidue. What about a = 3? Here we ﬁnd 3 · 1 ≡ +3 mod 13, 3 · 2 ≡ +6 mod 13, 3 · 3 ≡ −4 mod 13, 3 · 4 ≡ −1 mod 13, 3 · 5 ≡ +2 mod 13, 3 · 6 ≡ +5 mod 13. Here the number of sign changes is even (there are two), and 3 is a quadratic residue modulo 13. Gauss realized that this is not an accident: Lemma 6.14 (Gauss’s Lemma). Let p = 2n + 1 be an odd prime, put A = {a1, . . . , an}, and let a be an integer not divisible by p. Write aia ≡ (−1) s(i)at(i) mod p (6.1) for every ai ∈ A, where s(i) ∈ {0, 1} and t(i) ∈ {1, 2, . . . , n}. Then a n ≡ n∏ i=1(−1) s(i) mod p. Thus a is a quadratic residue or nonresidue modulo p according as the num- ber of sign changes is even or odd. The proof is quite simple: Proof. Observe that the at(i) in (6.1) run through A if the ai do, that is: the at(i) are just the ai in a diﬀerent order. In fact, if we had aia ≡ (−1) s(i)at(i) mod p and aka ≡ (−1) s(k)at(k) mod p with at(i) = at(k), then dividing the ﬁrst 59 congruence by the second gives ai/ak ≡ (−1) s(i)−s(k) mod p, that is, we have ai ≡ ±ak mod p for some choice of sign. But this implies ai = ak since 1 ≤ ai, ak ≤ p−1 2 . Now we apply the usual trick: if two sets of integers coincide, then the prod- uct over all elements must be the same. In our case, this means that ∏n i=1 aia ≡∏n i=1(−1) s(i)at(i) mod p. The left hand side equals (a1a) · (a2a) · · · (ana) = a n ∏n i=1 ai, whereas the right hand side is ∏n i=1(−1) s(i) ·∏n i=1 at(i). But we have∏n i=1 at(i) = ∏n i=1 ai by the preceding paragraph. Thus we ﬁnd a n ∏n i=1 ai ≡ ∏n i=1(−1) s(i) ∏n i=1 ai, and since the product over the ai is coprime to p, it may be canceled; this proves the claim. Let’s apply this to give a proof for our conjecture that ( 2 p ) = (−1) (p 2−1)/8. We have to count the number of sign changes when we multiply the “half system” A = {1, 2, . . . , p−1 2 } by 2. 1. Assume ﬁrst that p = 4k + 1, i.e. p−1 2 = 2k. [1] · [2] = [2] [2] · [2] = [4] . . . = . . . [k] · [2] = [2k] [k + 1] · [2] = [2k + 2] = −[2k − 1] . . . = . . . [2k] · [2] = [4k] = −[1] Here 2a ≤ 2k for a < k, that is for a = 1, 2, . . . , k, so there are no sign changes at all for these a. If k < a ≤ 2k, however, then 2k < 2a ≤ p − 1, hence 1 ≤ p − 2a < p − 2k = 2k + 1, which implies that there are sign changes for each a in this interval. Since there are exactly k such a, Gauss’s Lemma says that ( 2 p ) = (−1) k; we only have to check that k ≡ p 2−1 8 mod 2. But this follows from p 2−1 8 = 1 8 (p − 1)(p + 1) = 1 8 · 4k(4k + 2) = k(2k + 1). 2. Now assume that p = 4k − 1; then there are no sign changes whenever 1 ≤ a ≤ k − 1, and there are exactly k sign changes for k ≤ a < 2k, so again we have ( 2 p ) = (−1) k. But now p 2−1 8 = 1 8 (p − 1)(p + 1) = (2k − 1)k shows that k ≡ p 2−1 8 mod 2, and we have proved Proposition 6.15. The prime 2 is a quadratic residue of the odd prime p if and only if p = 8k ± 1; in other words: ( 2 p ) = (−1) (p 2−1)/8. As a corollary, consider the Mersenne numbers Mq, where q is odd and p = 2q + 1 is prime. If q ≡ 3 mod 4, then p ≡ 7 mod 8, hence (2/p) = 1. By Euler’s criterion, this means that 2q = 2(p−1)/2 ≡ 1 mod p, and this in turn shows that p | Mq. Corollary 6.16. If p = 2q + 1 ≡ 7 mod 8 is prime, then p | Mq, the q-th Mersenne number. 60 In particular, 23 | M11 and 83 | M41. Thus some Mersenne numbers can easily be seen to be composite. There are similar (but more complicated) rules for p | Mq when p = 4q + 1; in this case, we have to study 2(p−1)/4 mod p, which leads us to quartic reciprocity. There is a quartic reciprocity law, but this cannot be formulated in Z: Gauss showed in 1832 that one has to enlarge Z to the ring Z[i] = {a + bi : a, b ∈ Z, i 2 = −1} for doing that. 6.5 The Quadratic Reciprocity Law The quadratic reciprocity law connects the quadratic residue character of two distinct primes p and q; at ﬁrst, it seems completely unlikely that whether p is a square modulo q should have something to do with whether q is a square modulo p. Yet we have Theorem 6.17 (The Quadratic Reciprocity Law). For two odd positive primes p and q we have ( p q )( q p ) = (−1) p−1 2 q−1 2 . (As a matter of fact, the reciprocity law also holds in this form if one of p or q is negative; it does not hold if p and q are both negative.) Thus if p ≡ 1 mod 4 or q ≡ 1 mod 4, then p is a quadratic residue modulo q if and only if q is a quadratic residue modulo p; and if p ≡ q ≡ 3 mod 4, then p is a quadratic residue modulo q if and only if q is a quadratic nonresidue modulo p. For example, we have ( 5 13 ) = −1 and ( 13 5 ) = −1; on the other hand, ( 3 7 ) = −1 and ( 7 3 ) = +1. Euler ﬁrst stated a theorem equivalent to the quadratic reciprocity law in 1744; in modern terminology, Euler observed that the quadratic residue charac- ter of p modulo primes of the form 4pn ± s with 0 < s < 4p and (s, 2p) = 1 does not depend on n). Using Legendre’s notation, we can write this in the following form: Theorem 6.18. Let a be a nonzero squarefree positive integer; if p and q are odd primes coprime to 4a, then ( a p ) = ( a q ) whenever p ≡ q mod 4a. This is easily seen to be equivalent to the more familiar version of quadratic reciprocity: assume that Euler’s version holds and consider the case p ≡ q mod 4; we may assume that p > q and then put a = (p − q)/4 > 0. Then ( p q ) = ( p−q q ) = ( a q ) as well as ( q p ) = ( −1 p )( p−q q ) = ( −1 p )( a p ). By assumption we have ( a p ) = ( a q ) since p ≡ q mod 4a, hence ( p q )( q p ) = ( −1 p ), which is the quadratic reciprocity law if p ≡ q mod 4. 61 If p ≡ −q mod 4, we put a = (p + q)/4 instead, and the same reasoning as above (this time we have ( a p ) = ( a −q ) because p ≡ −q mod 4a, and of course ( a −q ) = ( a q ) since a ≡ x 2 mod q if and only if a ≡ x 2 mod −q) implies that ( p q ) = ( q p ). Now assume that Thm. 6.17 holds and let p, q be primes with p ≡ q mod 4a for some odd positive integer a. Then ( a p )( a q ) = (−1) a−1 2 p−1 2 (−1) a−1 2 q−1 2 ( p a )( q a ) = (−1) a−1 2 ( p−1 2 + q−1 2 = 1; here we have used the following facts: 1. q ≡ p mod a implies ( p a )( q a ) = ( p a )( p a ) = 1; 2. p−1 2 + q−1 2 ≡ 0 mod 2 since p ≡ q mod 4. Proof of Theorem 6.18. First observe that the quantity µ in Gauss’s Lemma equals the number of all r in the half system Hp = {1, 2, . . . , p−1 2 } modulo p such that the fractional part of ar is > p 2 ; denoting the fractional part of a real number x by {x} = x − ⌊x⌋, we see that µ is the cardinality of the set P (a) = { r ∈ Hp : { ar p } > 1 2 } . We can write P (a) as the disjoint union of sets Ps(a), where Ps(a) consists of all the r in the halfsystem modulo p satsifying s 2a p < r < s+1 2a p and { ar p } > 1 2 . The inequality s 2a p < r < s+1 2a p is equivalent to s 2 < ar p < s+1 2 , and this shows that the sets Ps(a) with s even are empty, and that the condition { ar p } > 1 2 is automatically satisﬁed if s is odd. Thus we may put Ps(a) = { r ∈ Z : s 2a p < r < s + 1 2a p} and have µ = ∑ 0≤s<a, 2∤s #Ps(a). Similarly, we have ( a q ) = (−1) ν, where ν = ∑ 0≤s<a, 2∤s #Qs(a) and Qs(a) = { r ∈ Z : s 2a q < r < s + 1 2a q} . 62 Now assume that p − q = 4at for some t ∈ N. Then Ps(a) = { r ∈ Z : s 2a p < r < s + 1 2a p} = { r ∈ Z : s 2a (q + 4at) < r < s + 1 2a (q + 4qt) } = { r ∈ Z : s 2a q + 2st < r < s + 1 2a q + 2st + 2t) } = { r′ ∈ Z : s 2a q < r′ < s + 1 2a q + 2t) } , where r′ = r − 2st. The last line shows that #Ps(a) = #Qs(a) + 2t. Thus µ + ν is an even number, and this proves that ( a p ) = ( a q ). 6.6 The Jacobi Symbol The Legendre symbol ( a p ) can be generalized to composite values of p: if b = p1 · · · pr is a product of odd primes, then we put ( a b ) = ( a p1 ) · · · ( a pr ). Thus ( 2 15 ) = ( 2 3 )( 2 5 ) = (−1)(−1) = +1. Note, however, that 2 is not a quadratic residue modulo 15. In fact, we only have Proposition 6.19. If ( a b ) = −1, then a is a quadratic nonresidue modulo b. Proof. If ( a b ) = −1 and b = ∏ p, then ∏( a p ) = −1, and this implies that (f racap) = −1 for at least one prime dividing b. Now a ≡ x 2 mod b implies a ≡ x 2 mod p, hence a is a quadratic nonresidue modulo b. We also can generalize the ﬁrst supplementary law: Proposition 6.20. We have ( −1 a ) = (−1) a−1 2 for all odd integers a > 0. Proof. Write n = p1 · · · pr; then ( −1 n ) = ( −1 p1 ) · · · ( −1 pr ) = (−1) p1−1 2 +...+ pr −1 2 . Thus it remains to show that n − 1 2 ≡ p1 − 1 2 + . . . + pr − 1 2 mod 2. (6.2) 63 This is done by induction. We start with the observation that (a − 1)(b − 1) ≡ 0 mod 4 for odd integers a, b, hence ab−1 ≡ (a−1)+(b−1) mod 4, and dividing by 2 gives ab − 1 2 ≡ a − 1 2 + b − 1 2 mod 2. Now use induction. Now let us treat the reciprocity law similarly. Theorem 6.21 (Reciprocity Law for Jacobi Symbols). If m and n are coprime positive odd integers, then ( m n )( n m ) = (−1) m−1 2 n−1 2 . Moreover, we have the supplementary laws ( −1 n ) = (−1) n−1 2 , ( 2 n ) = (−1) n2−1 8 . Proof. Write m = p1 · · · pr and n = q1 · · · qs; then ( m n )( n m ) = r∏ i=1 s∏ j=1 ( pi qj )( qj pi ) = r∏ i=1 s∏ j=1(−1) (pi−1)(qj −1)/4, and our claim will follow if we can prove that m − 1 2 n − 1 2 ≡ r∑ i=1 s∑ j=1 pi − 1 2 qj − 1 2 mod 4. But this follows by multiplying the two congruences you get by applying (6.2) to m and n. Finally, consider the second supplementary law. Similar to the above, every- thing boils down to showing n2 − 1 8 ≡ p2 1 − 1 8 + . . . + p2 r − 1 8 mod 2. Now clearly 16 | (a 2 − 1)(b2 − 1) (as a matter of fact, even this product is even divisible by 64), hence (ab) 2 − 1 ≡ a 2 − 1 + b2 − 1 mod 16. Now induction does the rest. 64 Exercises 6.1 Use Gauss’s Lemma to prove that ( −2 p ) = +1 or −1 according as p ≡ 1, 3 mod 8 or p ≡ 5, 7 mod 8. 6.2 Show that there are inﬁnitely many primes p ≡ 1 mod 3. 6.3 All primes dividing a number of the form n2 + 1 are congruent to 1 mod 4. 6.4 Show that all odd prime divisors of 9998 = 1000 2 − 2 satisfy p ≡ ±1 mod 8 6.5 Show that y2 = x 3 + 7 has no integer solutions. Hints: (This proof is due to V.A. Lebesgue) 1. Show that x is odd. 2. Write the equation as y2 + 1 = x 3 + 8 and factor the right hand side. 3. Show that the quadratic factor is divisible by some prime p ≡ 3 mod 4 4. Look at the left hand side. 6.6 Generalize the preceding exercise to an inﬁnite family of diophantine equations y2 = x 3 + c. 6.7 (This is a conjecture by Euler) Prove that if p ≡ 1 mod 4 is prime and a = p−1 4 − n − n2, then (q/p) = +1 for every q | a. 6.8 (Euler) If p ≡ 1 mod 4 is prime, then p−1 4 −n(n+1) is a quadratic residue modulo p for every integer n. 6.9 (Euler) If q ≡ 3 mod 4 is prime, then q+1 4 +n(n+1) is a quadratic residue modulo q for every integer n. 6.10 (Bork) If q and p = q + 4 are prime, then (p/q) = 1. 6.11 (Bickmore) Since Sp = 2 2p + 1 is the sum of two squares, so is each of its factors. Verify that, for p = 2m + 1, Sp = ApBp for Ap = 2p − 2 m+1 + 1 and Bp = 2 p + 2 m+1 + 1, and write Ap and Bp as a sum of two squares. Use the quadratic reciprocity law to prove that 5 | Ap ⇐⇒ (2/p) = −1 and 5 | Bp ⇐⇒ (2/p) = +1. 6.12 Show that 2340 ≡ 1 mod 341 (Hint: 341 · 3 = 1023). Also show that 341 is not prime. 65","libVersion":"0.3.1","langs":""}
{"path":"iCloudDrive/bks/Combinatorics/Combinatorics/PIE - Holden Lee, Yoni Miller - OMC.pdf","text":"Lecture 21 — Principle of Inclusion and Exclusion Holden Lee and Yoni Miller 5/6/11 1 Introduction and ﬁrst examples We start oﬀ with an example. Example 1.1: At Sunnydale High School there are • 28 students in algebra class, • 30 students in biology class, and • 8 students in both classes. How many students are in either algebra or biology class? Solution. Let A denote the set of students in algebra class and B denote the set of students in biology class. To ﬁnd the number of students in either class, we ﬁrst add up the students in each class: |A| + |B|. However, this counts the students in both classes twice. Thus we have to subtract them once: −|A ∩ B|. This shows |A ∪ B| = |A| + |B| − |A ∩ B| |A ∪ B| = 28 + 30 − 8 = 50, so there are 50 students in at least one of the two classes. The same reasoning works with three sets. Example 1.2: At Sunnydale High School there are • 55 students in either algebra, biology, or chemistry class • 28 students in algebra class • 30 students in biology class • 24 students in chemistry class • 8 students in both algebra and biology OMC 2011 Principle of Inclusion and Exclusion Lecture 21 • 16 students in both biology and chemistry • 5 students in both algebra and chemistry How many students are in all three classes? Solution. Let A, B, C denote the set of students in algebra, biology, and chemistry class, respectively. Then A ∪ B ∪ C is the set of students in one of the three classes, A ∩ B is the set of students in both algebra and biology, and so forth. To count the number of students in all three classes, i.e. count |A ∪ B ∪ C|, we can ﬁrst add all the number of students in all three classes: |A| + |B| + |C|. However, now we’ve counted the students in two classes too many times. So we subtract out the students who are in each pair of classes: −|A ∩ B| − |B ∩ C| − |A ∩ C|. For students who are in two classes, we’ve counted them twice, then subtracted them once, so they’re counted once. But for students in all three classes, we counted them 3 times, then subtracted them 3 times. Thus we need to add them again: +|A ∩ B ∩ C|. Thus |A ∪ B ∪ C| = |A| + |B| + |C| − |A ∩ B| − |B ∩ C| − |A ∩ C| + |A ∩ B ∩ C| 55 = 28 + 30 + 24 − 8 − 16 − 5 + |A ∩ B ∩ C|. 2 OMC 2011 Principle of Inclusion and Exclusion Lecture 21 Thus |A ∩ B ∩ C| = 2, i.e. there are 2 students in all three classes. The same reasoning works with an arbitrary number of sets; we state the general result in the following theorem. Theorem 1.3 (Principle of Inclusion and Exclusion (PIE)): Let A1, . . . , An be sets. Deﬁne Sk = ∑ 1≤i1<···<ik≤n |Ai1 ∩ · · · ∩ Aik|, i.e. Sk is a sum over all choices of k subsets. For k = 1, it’s simply |A1| + |A2| + |A3| + · · · + |Ak| and for k = n, it represents one sum, |A1 ∩ A2 ∩ A3 ∩ · · · ∩ An|. Then |A1 ∪ · · · ∪ An| = S1 − S2 + S3 + · · · + (−1)n−1Sn. Proof. Consider an element x ∈ A1 ∪ · · · ∪ An. It is counted once on the left hand side, so we need to show that it is counted once on the right hand side as well. Suppose x is in the sets Aj1, . . . , Ajm, but not in the rest of the sets. There are ( m k ) sets {i1, . . . , ik} such that x ∈ Ai1 ∩ · · · ∩ Aik, since {i1, . . . , ik} has to be a subset of {j1, . . . , jm}. Thus x is counted ( m k ) times in the sum ∑ 1≤i1<···<ik≤n |Ai1 ∩ · · · ∩ Aik|, and hence is counted (m 1 ) − (m 2 ) + · · · + (−1) m−1(m m ) on the right hand side. By the Binomial Theorem, 1 − (m 1 ) + (m 2 ) − · · · + (−1) m( m m) = (1 − 1) m, so ( m 1 ) − ( m 2 ) + · · · + (−1) m−1( m m ) = 1, showing x is counted once in the RHS. If x ̸∈ A1 ∪ · · · ∪ An, clearly x is not counted in either the LHS or the RHS. Since each element is counted the same number of times on either side, the theorem follows. Example 1.4: Find the number of positive integers less than or equal to 1000 that are divisible by 7, 10, or 15. Solution. For a positive integer k, let Ak denote the set of integers in {1, 2, . . . , 1000} that are divisible by k. We want to ﬁnd |A7 ∪ A10 ∪ A15|. Note that Ak = ⌊ 1000 k ⌋ where ⌊y⌋ denotes the greatest integer less than or equal to y. Indeed, the multiples of k that are less than 1000 are exactly k, 2k, . . . , ⌊ 1000 k ⌋ k. Note also that Ak ∩ Aℓ = Alcm(k,ℓ) since a number is divisible by both k and ℓ if and only if it is divisible by lcm(k, ℓ). Using PIE, we get |A7 ∪ A10 ∪ A15| = |A7| + |A10| + |A15| − |A7 ∩ A10| − |A7 ∩ A15| − |A10 ∩ A15| + |A7 ∩ A10 ∩ A15| = |A7| + |A10| + |A15| − |A70| − |A105| − |A30| + |A210| = ⌊ 1000 7 ⌋ + ⌊ 1000 10 ⌋ + ⌊ 1000 15 ⌋ − ⌊ 1000 70 ⌋ − ⌊ 1000 105 ⌋ − ⌊ 1000 30 ⌋ + ⌊ 1000 210 ⌋ = 142 + 100 + 83 − 14 − 9 − 33 + 4 = 273. 3 OMC 2011 Principle of Inclusion and Exclusion Lecture 21 Suppose instead we want to ﬁnd the sum of positive integers satisfying the above properties, not the number of positive integers. What do we do? We replace each term |S| in the sum above by ∑ x∈S x, so, rather than contributing 1 to the value S, x contributes the value x to S. This is an example of the following more generalized version of inclusion-exclusion. Theorem 1.5: Let f : A1 ∪ · · · ∪ An → R be a function. Then ∑ x∈A1∪···∪An f (x) = n∑ k=1 ∑ 1≤i1<···<ik≤n(−1)k ∑ x∈Ai1 ∩···∩Aik f (x) = ∑ 1≤i1≤n ∑ x∈Ai1 f (x) − ∑ 1≤i1<i2≤n ∑ x∈Ai1 ∩Ai2 f (x) + · · · + (−1) n−1 ∑ x∈A1∩···∩An f (x). Note that taking f to be identically 1, we get the original statement of PIE. Proof. The proof is the same as above, except now an element x contained in m of the sets contributes f (x) to the left hand side and ((m 1 ) − (m 2 ) + · · · + (−1) m+1( m m)) f (x) to the right hand side. 2 Permutations and surjections Example 2.1: As n people walk into a dinner party, they remove their hats. When they leave, the hats are randomly returned to them, so that all n! matchings between people and hats are equally likely. What is the probability that nobody gets his or her own hat back? Solution. Labeling the people and the hats 1, 2, . . . , n, a matching between people and hats corresponds to a permutation π on 1, 2, . . . , n, where π(i) = j if person i receives per- son j’s hat. So an equivalent formulation is the following: Given a random permutation on {1, 2, . . . , n} (that is, a one-to-one function on {1, 2, . . . , n}), what is the probability that there is no ﬁxed point, i.e. no i such that π(i) = i? Let A be the set of permutations having a ﬁxed point, and D be the set of permutations having no ﬁxed point (these permutations are called derangements). We need to ﬁnd |A|. To use PIE, we want to express A as a union of sets whose sizes are easy to calculate. Note that π having a ﬁxed point means either 1 is a ﬁxed point, or 2 is a ﬁxed point, or 3 is a ﬁxed point, or so on. Hence A = A1 ∪ · · · ∪ An. where Ai is the set of permutations π such that i is a ﬁxed point, i.e. π(i) = i. By PIE, we have |A| = n∑ k=1 ∑ 1≤i1<...<ik≤n (−1) k−1|Ai1 ∩ · · · ∩ Aik|. (1) An element π of Ai1 ∩ · · · ∩ Aik must have π(i1) = i1, . . . , π(ik) = ik, but can permute the other n − k elements in any way. Hence |Ai1 ∩ · · · ∩ Aik| = (n − k)! 4 OMC 2011 Principle of Inclusion and Exclusion Lecture 21 Since there are ( n k) sets of size k, (1) becomes |A| = n∑ k=1(−1) k−1( n k ) (n − k)! = n∑ k=1 (−1) k−1 n! k! |D| = n! − |A| = n∑ k=0 (−1) kn! k! . Thus the desired probability is |D| n! = n∑ k=0 (−1)k k! . Readers familiar with calculus may recognize that truncated series for 1 e appears above: 1 e = 1 − 1 1! + 1 2! − 1 3! + 1 4! − · · · We calculated that |D| = n! ( 1 − 1 1! + 1 2! − · · · (−1) n n! ) . Hence |D| − n! e = n! ∞∑ k=n+1 (−1)k k! ∈ ( − n! (n + 1)! , n! (n + 1)! ) ⊆ ( −1 2 , 1 2 ) . Hence |D| equals n! e rounded to the nearest integer, i.e. |D| = ⌊ n! e + 1 2⌋ and the probability equals p = ⌊ 1 e + 1 2n! ⌋ . In particular, as the number of hats n goes to inﬁnity, the probability that all people get their hats back approaches 1 e . Note: What makes this proof so fascinating, is that it shows us whether it’s ﬁve people who derange their hats or a thousand or billion, it will generally be the same probability. Example 2.2: Suppose m ≥ n. Find the number of surjective functions f : {1, 2, . . . , m} → {1, 2, . . . , n}, i.e. functions f such that f (x) = k has a solution for any k ∈ {1, 2, . . . , n}. Solution. Let S be the set of surjective functions. As in the previous example, we ﬁnd it more convenient to consider the complement of the desired set, then subtract it from the set of all functions. So let A = Sc be the set of non-surjective functions. We can express A as a union A = A1 ∪ · · · ∪ An where Ak is the set of functions f : {1, 2, . . . , m} → {1, 2, . . . , n} whose range does not include k. Then by PIE, |A| = n∑ k=1 ∑ 1≤i1<···<ik≤n (−1) k+1|Ai1 ∩ · · · ∩ Aik|. (2) 5 OMC 2011 Principle of Inclusion and Exclusion Lecture 21 Now |Ai1 ∩ · · · ∩ Aik| consists of all functions that miss the values i1, . . . , ik. This leaves n − k possibilities for each of f (1), . . . , f (m), so there are (n − k)m such functions. Since there are ( n k) subsets of size k, (2) becomes |A| = n∑ k=1(−1)k−1( n k ) (n − k) m. Since there are nm functions from {1, . . . , m} to {1, . . . , n}, we get |S| = nm − n∑ k=1(−1) k−1(n k )(n − k) m = n∑ k=0(−1) k( n k ) (n − k)m. 3 Problems 1. (AHSME 1983/26) The probability that event A occurs is 3 4; the probability that event B occurs is 2 3. Let p be the probability that both A and B occur. Find the smallest interval necessarily containing p. 2. At Sunnydale High School there are • 44 students in either algebra, biology, or chemistry class • 25 students in biology class • 23 students in chemistry class • 13 students in both algebra and biology • 9 students in both biology and chemistry • 10 students in both algebra and chemistry • 6 students in all three classes. How many students are in algebra class? 3. Four couples are sitting in a row. Find the number of arrangements in which no person is sitting next to his or her partner. What if they are sitting in a circle? 4. Find the number of ﬁve-digit combinations from the set {1, 2, 3, 4, 5} in which: (a) Some digit appears at least three times. (b) No digit appears more than twice. 5. Let {p1, . . . , pr} be a set of primes. Show that the number of positive integers less than or equal to n and relatively prime to p1, . . . , pr is equal to x ( 1 − 1 p1 ) · · · ( 1 − 1 pr ) + 2rθ for some −1 < θ < 1. 6. Find the sum of all positive integers less than or equal to 1000 that are not divisible by 7, 10, or 15. 6 OMC 2011 Principle of Inclusion and Exclusion Lecture 21 7. Find the number of solutions to x1 + x2 + x3 + x4 + x5 + x6 = 15 such that each xi is an integer and 0 ≤ xi ≤ 4. 8. Specially marked boxes of ChocoBalls cereal contain one of four puzzle pieces, each with probability 1 4. Once you have all four puzzle pieces, you can mail them in and receive a coupon for more ChocoBalls cereal. (a) If Jim buys n specially marked boxes of ChocoBalls cereal, what is the prob- ability that he gets all four puzzle pieces? (b) What is the expected number of boxes that Jim has to buy to get all four puzzle pieces? 9. Find the number of permutations π of {1, 2, . . . , n} such that π(i + 1) ̸= π(i) + 1 for all 1 ≤ i ≤ n. 10. Let an be the number of permutations π of {1, 2, . . . , 2n} such that π(i+1)−π(i) ̸= n for each 1 ≤ i ≤ 2n − 1. Find an and show that limn→∞ an (2n)! = 1 e . 11. (TST 2004/2) Assume n is a positive integer. Consider sequences a0, a1, . . . , an such that ai ∈ {1, 2, . . . , n} for each i and an = a0. (a) Call such a sequence good if for all i = 1, 2, . . . , n, ai − ai−1 ̸≡ i (mod n). Suppose n is odd. Find the number of good sequences. (b) Call such a sequence great if for all i = 1, 2, . . . , n, ai − ai−1 ̸≡ i, 2i (mod n). Suppose that n is an odd prime. Find the number of great sequences. (Note: We solved this problem using generating functions and complex numbers in lecture 11. Try to do it with PIE this time.) 12. (IMO 1991/3) Let S = {1, 2, 3, . . . , 280}. Find the minimal natural number n such that in any n-element subset of S there are ﬁve numbers that are pairwise relatively prime. 13. (USAMO 1994/5) Let |U |, σ(U ), and π(U ) denote the number of elements, the sum, and the product, respectively, of a ﬁnite set U of positive integers. (If U is the empty set, |U | = 0, σ(U ) = 0, and π(U ) = 1.) Let S be a ﬁnite set of positive integers. As usual, let (n k) denote n! k!(n−k)! . Prove that ∑ U ⊆S(−1) |U |( m − σ(U ) |S| ) = π(S) for all integers m ≥ σ(S). References [1] The Inclusion-Exclusion Principle, 2011. http://www.math.ust.hk/~mabfchen/ Math232/Inclusion-Exclusion.pdf 7","libVersion":"0.3.1","langs":""}
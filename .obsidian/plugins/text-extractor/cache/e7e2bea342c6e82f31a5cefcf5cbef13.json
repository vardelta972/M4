{"path":"iCloudDrive/bks/Calculus/Other Books/1+2 Robert S. Way of analysis.pdf","text":"The Way Robert s. Strichartz of Analysis The Way of Analysis Revised Edition Robert S. Strichartz Cornell University JONES AND BARTLETT PUBLISHERS Sudbury, Massachusetts BOSTON TORONTO LONDON SINGAPORE World Headquarters Jones and Bartlett Publishers 40 Tall Pine Drive Sudbury, MA 01776 1-800-832-0034 978-443-5000 info@jbpub.com www.jbpub.com Jones and Bartlett Publishers CANADA WEST 2100 Bloor St. Suite 6-272 Toronto, ON M65 5A5 CANADA Jones and Bartlett Publishers International Barb House, Barb Mews London W6 7PA UK. Copyright © 2000 by Jones and Bartlett Publishers, Inc. All rights reserved. No part of the material protected by this copyright notice may be reproduced or utilized in any form, electronic or mechanical, including photocopying, recording, or by any infonnation storage and retrieval system, without written permission from the copyright owner. ISBN: 0-7637-1497-6 The quotations in problem 1 in problem set 1.1.3 (page 7) are of proverbial or biblical origin, except for a. from \"Home on the Range,\" by Brewster M. Higley, and g. from Macbeth, by William Shakespeare. Printed in the United States of America 04 03 10 9 8 7 6 5 4 3 Contents Preface 1 Preliminaries 1.1 The Logic of Quantifiers 1. 1. 1 Rules of Quantifiers 1.1.2 Examples . . . . . . 1.1. 3 Exercises .... 1.2 Infinite Sets . . . . . . 1.3 1.2.1 Countable Sets . . . . 1. 2.2 Uncountable Sets . 1.2.3 Exercises ..... Proofs . . . . . . . . . . . 1.3.1 How to Discover Proofs 1.3.2 How to Understand Proofs 1.4 The Rational Number System . 1. 5 The Axiom of Choice* ...... . 2 Construction of the Real Number System 2.1 Cauchy Sequences ... 2. 1.1 Motivation .. 2. 1.2 The Definition 2.1.3 Exercises .... 2.2 The Reals as an Ordered Field 2.2.1 Defining Arithmetic 2.2.2 The Field Axioms 2.2.3 Order . . 2.2.4 Exercises ..... v xiii 1 1 1 4 7 8 8 10 13 13 13 17 18 21 25 25 25 30 37 38 38 41 45 48 · Vl 2. 3 Limits and Completeness .. 2. 3. 1 Proof of Completeness . 2.3.2 Square Roots . . . . 2. 3. 3 Exercises ...... . 2.4 Other Versions and Visions . 2.4. 1 Infinite Decimal Expansions . 2.4. 2 Dedekind Cuts* ..... 2.4. 3 Non-Standard Analysis* . 2.4.4 Constructive Analysis* . 2.4. 5 Exercises 2. 5 Summary ..... ... . Contents 50 50 52 54 56 56 59 63 66 68 69 3 Topology of the Real Line 73 73 73 78 84 86 86 91 98 99 3. 1 The Theory of Limits .. 3. 1.1 Limits, Sups, and Infs 3. 1.2 Limit Points .... . 3. 1. 3 Exercises ..... . 3. 2 Open Sets and Closed Sets 3. 2. 1 Open Sets . 3. 2. 2 Closed Sets 3. 2.3 Exercises 3. 3 Compact Sets . . 3. 3. 1 Exercises 3.4 Summary . . . . 4 Continuous Functions 4. 1 Concepts of Continuity . 4. 1.1 Definitions ... 4. 1. 2 4. 1. 3 4. 1.4 Limits of Functions and Limits of Sequences . Inverse Images of Open Sets . Related Definitions ..... . 106 107 111 111 111 119 121 12 3 4. 1. 5 Exercises . . ...... ... 125 4. 2 Properties of Continuous Functions . 127 4. 2. 1 Basic Properties . . . . . . . . 127 4. 2.2 Continuous Functions on Compact Domains . 13 1 4. 2. 3 Monotone Functions . . . . 134 4. 2.4 Exercises 4. 3 Summary . . . . . . . . . . 138 14 0 Contents 5 Differential Calculus 5.1 Concepts of the Derivative . . . . . . . . . . . . . . 5. 1. 1 Equivalent Definitions .. ... . .. ... . 5. 1.2 Continuity and Continuous Differentiability 5. 1. 3 Exercises ....... . . . . 5. 2 Properties of the Derivative . . . . . . . . . . . . . . 5. 2.1 Local Properties . . . . . . . . . . . . . . . . 5. 2. 2 Intermediate Value and Mean Value Theorems 5. 2. 3 Global Properties . . . 5. 2.4 Exercises ........ .. . 5. 3 The Calculus of Derivatives . . . . . 5. 3. 1 Product and Quotient Rules .. 5. 3.2 The Chain Rule .... . . 5. 3.3 Inverse Function Theorem .. . 5. 3.4 Exercises ........... . 5.4 Higher Derivatives and Taylor's Theorem 5. 5 5.4. 1 Interpretations of the Second Derivative 5.4. 2 5.4. 3 5.4.4 5.4. 5 Taylor's Theorem . . . . .. .. L'Hopital's Rule* . . . . . . . . . Lagrange Remainder Formula * Orders of Zeros* 5.4. 6 Exercises Summary ... 6 Integral Calculus 6. 1 Integrals of Continuous Functions . . . . . . 6. 1. 1 Existence of the Integral . . . . . . . 6. 1. 2 Fundamental Theorems of Calculus . vii 143 14 3 14 3 14 8 15 2 15 3 15 3 . 157 162 163 165 165 168 171 116 171 117 181 185 188 19 0 192 19 5 201 20 1 201 207 6. 1. 3 Useful Integration Formulas . . 212 6. 1.4 Numerical Integration 214 6. 1. 5 Exercises ... .. . ... 217 6. 2 The Riemann Integral . . . . . . 219 6. 2. 1 Definition of the Integral 219 6. 2. 2 Elementary Properties of the Integral 224 6. 2. 3 Functions with a Countable Number of Discon- tinuities* .. 6. 2.4 Exercises .. 6. 3 Improper Integrals* 221 231 23 2 viii 6. 3. 1 Definitions and Examples 6. 3. 2 Exercises 6.4 Summary . . . . . . . . . . . . . Contents 23 2 235 23 6 7 Sequences and Series of Functions 241 241 241 247 7. 1 Complex Numbers .... .. .. . 7. 1.1 Basic Properties of C ... . 7. 1. 2 Complex-Valued Functions 7. 1. 3 Exercises ....... .. . 249 7. 2 Numerical Series and Sequences . . 25 0 7. 2.1 Convergence and Absolute Convergence 25 0 7. 2. 2 Rearrangements ... 25 6 7. 2. 3 Summation by Parts* 260 7. 2.4 Exercises ....... 262 7. 3 Uniform Convergence .. .. 263 7. 3. 1 Uniform Limits and Continuity 263 7. 3. 2 Integration and Differentiation of Limits . 268 7. 3. 3 Unrestricted Convergence* 212 1. 3.4 Exercises . .. . .... .. 214 1.4 Power Series . . . . . . . . . . . . . 276 7.4. 1 The Radius of Convergence 276 7.4. 2 Analytic Continuation . . . 281 7. 4. 3 Analytic Functions on Complex Domains* . . 286 7.4.4 Closure Properties of Analytic Functions* 288 7.4. 5 Exercises ... .. .. . 294 7. 5 Approximation by Polynomials . . . . . . . . . . 29 6 1. 5. 1 Lagrange Interpolation . . . . . . . . . . . 29 6 7. 5.2 Convolutions and Approximate Identities 29 7 7. 5. 3 The Weierstrass Approximation Theorem 301 1. 5.4 Approximating Derivatives 305 7. 5. 5 Exercises .. .. . .... ... . 307 7. 6 Equicontinuity ... .. .. .. . ... . 309 7. 6. 1 The Definition of Equicontinuity 309 7. 6. 2 The Arzela-Ascoli Theorem 312 7. 6. 3 Exercises 7. 7 Summary . . . . . . . . . . . . . . 314 316 8 Transcendental Functions 323 8. 1 The Exponential and Logarithm ........ 32 3 8. 1. 1 Five Equivalent Definitions . . . . . . . 32 3 8. 1. 2 Exponential Glue and Blip Functions . . 329 8. 1. 3 Functions with Prescribed Taylor Expansions* . 33 2 8. 1. 4 Exercises .. ... ... . ... 33 5 8. 2 Trigonometric Functions . . . . . . . . . . . . . . . . . . 337 8. 2. 1 Definition of Sine and Cosine . . . . . . . . . . . 337 8. 2. 2 Relationship Between Sines, Cosines, and Com- plex Exponentials 344 8. 2. 3 Exercises 8. 3 Summary . . . . . . . . . 9 Euclidean Space and Metric Spaces 9. 1 Structures on Euclidean Space .... 9. 1.1 Vector Space and Metric Space 9. 1.2 Norm and Inner Product .... 9.1. 3 The Complex Case .. 9. 1. 4 Exercises ...... . 9. 2 Topology of Metric Spaces . . .' 9. 3 9. 4 9. 2. 1 Open Sets . . . . . . . . ... . 9. 2.2 Limits and Closed Sets . . . 9. 2. 3 Completeness .. 9. 2.4 Compactness . . . . . . 9. 2.5 Exercises .. ..... . Continuous Functions on Metric Spaces 9. 3. 1 Three Equivalent Definitions ... 9. 3.2 Continuous Functions on Compact Domains . 9. 3.3 Connectedness . . . . . . . . . . . . 9. 3.4 The Contractive Mapping Principle .... . 9. 3. 5 The Stone-Weierstrass Theorem* ....... . 9. 3.6 Nowhere Differentiable Functions , and Worse* 9. 3.7 Exercises ..... Summary . . . . . . . . . . . . . . . . . . 349 350 355 35 5 35 5 358 364 366 368 368 373 37 4 377 384 386 386 39 1 39 3 39 7 399 . 40 3 409 41 2 10 Differential Calculus in Euclidean Space 10. 1 The Differential . . . . . : . . . . . . . 10. 1.1 Definition of Differentiability ... . 419 419 . . . 419 x 10. 1. 2 Partial Derivatives . . . . . 10. 1. 3 The Chain Rule ..... . 10.1.4 Differentiation of Integrals . 10. 1. 5 Exercises ......... . 10. 2 Higher Derivatives . . . . . . . . . 10. 2. 1 Equality of Mixed Partials . 10. 2. 2 Local Extrema . . 10.2.3 Taylor Expansions 10. 2.4 Exercises 10. 3 Summary . . . . . . . . . 11 Ordinary Differential Equations 11.1 Existence and Uniqueness 11. 1. 1 Motivation .. .. 11. 1. 2 Picard Iteration .. 11. 1. 3 Linear Equations . 11. 1.4 Local Existence and Uniqueness* . 11. 1. 5 Higher Order Equations * .. .. ... . 11. 1. 6 Exercises .. ........ .. . 11. 2 Other Methods of Solution* ...... . 11.2.1 Difference Equation Approximation 11. 2. 2 Peano Existence Theorem . 11. 2. 3 Power-Series Solutions 11. 2.4 Exercises ..... 11. 3 Vector Fields and Flows* .. 11. 3. 1 Integral Curves .... 11.3.2 Hamiltonian Mechanics 11. 3. 3 First-Order Linear P.D.E.'s 11. 3.4 Exercises ..... . 11.4 Summary . . . . . . . . . . . . . . 12 Fourier Series 12. 1 Origins of Fourier Series . . . . . . . . . . . 12.1.1 Fourier Series Solutions of P.D.E. 's . 12. 1. 2 Spectral Theory . 12. 1. 3 Harmonic Analysis . . 12. 1. 4 Exercises ...... . 12. 2 Convergence of Fourier Series Contents . . . . . . . . . 423 42 8 432 435 437 437 441 44 8 452 454 459 459 459 467 473 476 481 483 485 485 490 494 500 501 501 505 506 507 509 515 515 515 520 525 528 531 Contents xi 12. 2.1 Uniform Convergence for C1 Functions . 53 1 12.2.2 Summability of Fourier Series . . . . . . 537 12. 2. 3 Convergence in the Mean . . . . . . . . 54 3 12. 2.4 Divergence and Gibb's Phenomenon* .. .. 55 0 12. 2. 5 Solution of the Heat Equation* 555 12. 2. 6 Exercises 12. 3 Summary . . . . . . . . . . . . . . . . 13 Implicit Functions, Curves, and Surfaces 13.1 The Implicit Function Theorem ..... . 13. 1.1 Statement of the Theorem . . . . . 13.1.2 The Proof* . 13.1.3 Exercises .. . ...... . 13.2 Curves and Surfaces . . . . . . ... . . . 13.2.1 Motivation and Examples . 13.2.2 Immersions and Embeddings ..... . 13.2.3 Parametric Description of Surfaces . 13. 2.4 Implicit Description of Surfaces .. 13.2.5 Exercises ........ . . 13.3 Maxima and Minima on Surfaces . 13. 3. 1 Lagrange Multipliers .... 13. 3. 2 A Second Derivative Test* . 13. 3. 3 Exercises ..... 13. 4 Arc Length . . . . . . . . . . . . . 13.4. 1 Rectifiable Curves .. . . . 13.4. 2 The Integral Formula for Arc Length .. 13.4. 3 Arc Length Parameterization* 13. 4.4 Exercises 13.5 Summary . . . . . . . . . . . . . . . . 14 The Lebesgue Integral 14.1 The Concept of Measure . 14.1.1 Motivation .... 14.1.2 Properties of Length . 14. 1. 3 Measurable Sets .. . 14.1. 4 Basic Properties of Measures 14.1.5 A Formula for Lebesgue Measure .. 14. 1. 6 Other Examples of Measures ... 559 562 567 567 567 573 580 581 581 585 591 59 7 600 602 60 2 60 5 609 610 610 614 616 617 618 623 62 3 62 3 627 631 63 4 636 639 xii Contents 14. 1.7 Exercises ......... . 14. 2 Proof of Existence of Measures· .. 14. 2. 1 Outer Measures .... 14. 2. 2 Metric Outer Measure 14. 2. 3 Hausdorff Measures· . 14. 2.4 Exercises ... ... . 14. 3 The Integral . . . . . . . . . . 14. 3. 1 Non-negative Measurable Functions 14. 3. 2 The Monotone Convergence Theorem .. .. 14. 3. 3 Integrable Functions ... . 14. 3.4 Almost Everywhere ... . 14. 3. 5 Exercises.. ..... ... 14.4 The Lebesgue Spaces Ll and L2 14.4. 1 Ll as a Banach Space ...... . 14.4. 2 L2 as a Hilbert Space .. 14.4. 3 Fourier Series for L2 Functions 14.4.4 Exercises 14. 5 Summary . . . . . . . . . . . . . . . . . . . . . 15 Multiple Integrals 15. 1 Interchange of Integrals ......... . 15. 1.1 Integrals of Continuous Functions 15. 1.2 Fubini's Theorem . . . . . . . . 15. 1.3 The Monotone Class Lemma* .. . 15. 1.4 Exercises .......... .. . 15. 2 Change of Variable in Multiple Integrals . 15. 2. 1 Determinants and Volume .... . 15. 2.2 The Jacobian Factor* ... . . . . 15. 2. 3 Polar Coordinates ......... . 15. 2.4 Change of Variable for Lebesgue Integrals* 15. 2. 5 Exercises .. ... 15. 3 Summary . . . . . . . . . . . . . . . . . . . . . . . . Index 64 1 64 3 64 3 647 65 0 654 65 5 65 5 660 664 667 668 670 670 673 676 681 682 691 69 1 691 694 70 0 70 3 70 5 70 5 709 714 717 720 722 727 Preface Do not ask permission to understand. Do not wait for the word of authority. Seize reason in your own hand. With your own teeth savor the fruit. Mathematics is more than a collection of theorems, definitions, problems and techniques; it is a way of thought. The same can be said about an individual branch of mathematics, such as analysis. Analysis has its roots in the work of Archimedes and other ancient Greek ge­ ometers, who developed techniques to find areas, volumes, centers of gravity, arc lengths, and tangents to curves. In the seventeenth century these techniques were further developed, culminating in the invention of the calculus of Newton and Leibniz. During the eighteenth centu­ ry the calculus was fashioned into a tool of bold computational power and applied to diverse problems of practical and theoretical interest. At the same time the foundation of analysis-the logical justification for the success of the methods-was left in limbo. This had practical consequences: for example, Euler-the leading mathematician of the eighteenth century-developed all the techniques needed for the study of Fourier series, but he never carried out the project. On the contrary, he argued in print against the possibility of representing functions as Fourier series, when this proposal was put forth by Daniel Bernoulli, and his argument was based on fundamental misconceptions concerning the nature of functions and infinite series. In the nineteenth century, the problem of the foundation of anal­ ysis was faced squarely and resolved. The theory that was developed forms most of the content of this book. We will describe it in its logical xiii · XIV Preface order, starting from the most basic concepts such as sets and numbers and building up to the more involved concepts of limits, continuity, derivative, and integral. The actual historical order of discovery was almost the reverse; much like peeling a cabbage, mathematicians be­ gan with the outermost layers and worked their way inward. Cauchy and Bolzano began the process in the 1820s by developing the theo­ ry of functions without defining the real numbers. The first rigorous definition of the real number system came in the work of Dedekind, Weierstrass, and Heine in the 1860s. Set theory came later in the work of Cantor, Peano, and Frege. The consequences of the nineteenth century foundational work were enormous and are still being felt today. Perhaps the least important consequence was the establishment of a logically valid explanation of the calculus. Nlore important, with the clearing away of the concep­ tual murk, new problems emerged with clarity and were developed into important theories. We will give some illustrations of these new nineteenth century discoveries in our discussions of differential equa­ tions, Fourier series, higher dimensional calculus, and manifolds. Most important of all, however, the nineteenth century foundational work paved the way for the work of the twentieth century. Analysis today is a subject of vast scope and beauty, ranging from the abstract to the concrete, characterized both by the bold computational power of the eighteenth century and the logical subtlety of the nineteenth century. Most of these developments are beyond the scope of this book or at best merely hinted at. Still, it is my hope that the reader, after hav­ ing entered so deeply along the way of analysis, will be encouraged to continue the study. My goal in writing this book is to communicate the mathematical ideas of the subject to the reader. I have tried to be generous with ex­ planations. Perhaps there will be places where I belabor the obvious, nevertheless, I think there is enough truly challenging material here to inspire even the strongest students. On the other hand, there will inevitably be places where each reader will find difficulties in follow­ ing the arguments. When this happens, I suggest that you write your questions in the margins. Later, when you go over the material, you may find that you can answer the question. If not, be sure to ask your instructor or another student; often, it is a minor misunderstanding that causes confusion and can easily be cleared up. Sometimes, the in- Preface xv herent difficulty of the material will demand considerable effort on your part to attain understanding. I hope you will not become frustrated in the process; it is something which all students of mathematics must confront. I believe that what you learn through a process of struggle is more likely to stick with you than what you learn without effort. Understanding mathematics is a complex process. It involves not only following the details of an argument and verifying its correctness, but seeing the overall strategy of the argument, the role played by every hypothesis, and understanding how different theorems and definitions fit together to create the whole. It is a long-term process; in a sense, you cannot appreciate the significance of the first theorem until you have learned the last theorem. So please be sure to review old mate­ rial; you may find the chapter summaries useful for this purpose. The mathematical ideas presented in this book are of fundamental impor­ tance, and you are sure to encounter them again in further studies in both pure and applied mathematics. Learn them well and they will serve you well in the future. It may not be an easy task, but it is a worthy one. To the Instructor This book is designed so that it may be used in several ways, including 1. a one-semester introductory real analysis course, 2. a two-semester real analysis course not including Lebesgue inte­ gration, 3. a two-semester real analysis course including an introduction to Lebesgue integration. There are many optional sections, marked with an asterisk (*), that can be covered or omitted at your discretion. There is some flexibility in the ordering of the later chapters. Thus you can design a course in accordance with your interests and requirements. There are three chapters on applications (Chapter 11, Ordinary Differential Equations; Chapter 12, Fourier Series; and Chapter 13, Implicit Functions, Curves and Surfaces). These topics are often omitted, or treated very briefly, in · XVI Preface a real analysis course because they are covered in other courses. How­ ever, they serve an important purpose in illustrating how the abstract theory may be applied to more concrete situations. I would urge you to try to fit as much of this material as time allows into your course. The chapters may be divided into four groupings: 1. functions of one variable: 1, 2, 3, 4, 5, 6, 7, 8; 2. functions of several variables: 9, 10, 15; 3. applications: 11, 12, 13; 4. Lebesgue integration: 14, 15. Note that Chapter 15, Multiple Integrals, may be used either with or without the Lebesgue integral. The first 10 chapters are designed to be used in the given order (sections marked with an asterisk may be omitted or postponed). If you are not covering the Lebesgue integral, then selections from Chapter 15 (15.1.1, 15. 2.1, and 15. 2. 3) can be covered any time after Chapter 10. The applications, Chapters 11, 12, and 13, can be done in any order. It is advisable to do at least some of Chapter 12, Fourier series, before doing the Lebesgue Integral, Chapter 14. In Chapter 6 (section 6. 1. 3) I have included a preview of some results in integration theory that are covered in detail later in the book-this is the only place I have violated the principle of presenting full proofs of all results in the order they are discussed. I think this is a reasonable compromise, in view of the facts that (a) the students will want to use these results in doing exercises, and (b) to present proofs at this point in the text would require long detours. Here are some concrete suggestions for using this book. 1. One-semester course: do Chapters 1-8 in order, omitting all sec­ tions marked with an asterisk. This will cover the one variable theory. If time remains. at the end, return to omitted sections. 2. Two-semester course ( without Lebesgue integrals) First semester: do chapters 1-7 in order, including most sections marked with an asterisk. Preface xvii Second semester: do Chapters 8-10j then 15.1.1, 15.2.1, 15.2.3, then Chapters 11-13, including some sections marked with an asterisk. 3. Two-semester course (with Lebesgue integrals) First semester: do Chapters 1-7 in order, including most sections marked with an asterisk, but omit 6.2.3. Second semester: do Chapters 8-10j then selections from chapters 11-13; then chapters 14 and 15. This book contains a generous selection of exercises, ranging in difficulty from straightforward to challenging. The most difficult ones are marked with an asterisk. All the main results are presented with complete proofs; indeed the emphasis is on a careful explanation of the ideas behind the proofs. One important goal is to develop the reader's mathematical maturity. For many students, a course in real analysis may be their first encounter with rigorous mathematical reasoning. This can be a daunting experi­ ence but also an inspiring one. I have tried to supply the students with the support they will need to meet the challenge. My recommendation is that students be required to read the mate­ rial before it is discussed in class. (This may be difficult to enforce in practice, but here is one suggestion: have students submit brief written answers to a question based on the reading and also a question they would like to have answered in class.) The ability to read and learn from a mathematical text is a valuable skill for students to develop. This book was written to be read-not deciphered. If I have perhaps coddled the students too much, I'm sure they won't complain about that! The presentation of the material in this book is often informal. A lot of space is given to motivation and a discussion of proof strategies. Not every result is labeled as a theorem, and sometimes the precise statement of the result does not emerge until after the proof has been given. Formulas are not numbered, and theorems are referred to by name and not number. To compensate for the informality of the body of the text, I have included summaries at the end of each chapter (except the first) of all the main results, in standard dry mathematical ... XVlll Preface format. The students should find these chapter summaries handy both for review purposes and for references. I have tried to give some historical perspective on the material pre­ sented, but the basic organization follows logical rather than historical order. I use conventional names for theorems, even if this perpetuates injustices and errors (for example, I believe it is more important to know what the Cauchy-Schwartz inequality is than to decide whether or not Bunyakowsky deserves some/most/all of the credit for it). One important lesson from the historical record is that abstract theorems did not grow up in a vacuum: they were motivated by concrete prob­ lems and proved their worth through a variety of applications. This text gives students ample opportunity to see this interplay in action, especially in Chapters 11, 12, and 13. In order to give the material unity, I have emphasized themes that recur. Also, many results are presented twice, first in a more concrete setting. For example, I develop the topology of the real line first, postponing the general theory of metric spaces to Chapter 9. This is perhaps not the most efficient route, but I think it makes it easier for the students. Whenever possible I give the most algorithmic proof, even if it is sometimes harder (for example, I construct a Fourier series of a continuous function that diverges at a point). I have tried to emphasize techniques that can be used again in other contexts. I construct the real number system by Cauchy completion of the rationals, since Cauchy completion is an important technique. The derivative in one variable is defined by best affine approximation, since the same definition can be used in Rn. Chapter 7, Sequences and Series of Functions, is presented entirely in the context of functions of one variable, even though most of the results extend easily to the multivariable setting, or more generally to functions on metric spaces. A good text should make the job of teaching easier. I hope I have succeeded in providing you with a text that you can easily teach from. I would appreciate receiving any comments or suggestions for improve­ ments from you. Acknowledgments I would like to thank the students at Cornell who learned this mate­ rial from me as I developed the preliminary versions of the text over Preface . XIX the past dozen years. I am grateful for your criticism as well as your encouragement. I needed both, even if I was more gracious about the encouragement (special thanks to Chris Wittemann) . I am also grateful to Graeme Bailey, Dan Barbasch, Eugene Dynkin, Archil Gulisashvili, and Oscar Rothaus, who also taught using this material. I am especially grateful to Mark Barsamian, who went over the text line-by-line from the point of view of the student, and made me change just about everything. He helped me to improve the organization and style of presentation and pointed out possible sources of ambiguity and confusion. I know that the text is much stronger as a result of his criticism, and I feel more confident that I have fulfilled my promise to write a book that students can understand. I am grateful to Carl Hesler, my editor at Jones and Bartlett, who has encouraged me throughout the long process of turning my rough lecture notes into a polished book, and I especially appreciate his con­ fidence in the value of this work for the mathematical community. I would like to thank June Meyermann for her outstanding job preparing the manuscript in �TEX and David Larkin who produced many of the figures using Mathematica. Chapter 1 Preliminaries 1.1 The Logic of Quantifiers 1.1.1 Rules of Quantifiers Logic plays a central role in mathematics. While other considerations­ such as intuition, agreement with empirical evidence, taste, esthetics, wishful thinking, personal ambition-may influence the way mathe­ maticians think and act, there is always a central core of mathematical reasoning that is supposed to be logically sound. But is it? There are really two questions here. The first concerns the structure of the logic itself; the second concerns how it is used. Mathematicians have made a careful study of logic, and the results are rather impressive. The main result, called the completeness theorem for first-order predicate calculus, shows that the logical reasoning we are going to use in this book, if used correctly, is both sound and incapable of being improved (in other words, additional new forms of logical reasoning would not enable us to do more than we already can). The interested reader is referred to any text on mathematical logic for a full discussion, which is beyond the scope of this work. But what about the second question. Do mathematicians make mistakes in logic? Of course they do! Carelessness and wishful think­ ing are the main culprits, and there is little that can be done other than constant vigilance and rechecking of work. At the very least, however, every mathematician and student of mathematics should clearly un­ derstand the rules of logic so that deliberate mistakes are not made. 1 2 Chapter 1 Preliminaries Ignorance of logic is no excuse! Some of the theorems we are going to study in this book were originally stated incorrectly or given incorrect proofs because of misunderstandings concerning the logic of quantifier­ s. So our first responsibility is to make perfectly clear the meaning and use of \"there exists\" and \"for all\" . Of course preliminary to this we need the logic of connectives. Fortunately, this is a straightforward matter, summarized by the following truth table. TRUTH TABLE A B not A A and B Aor B A implies B A if and only if B T T F T T T T T F F F T F F F T T F T T F F F T F F T T We will not employ special symbols such as 1\\ for \"and\" , -+ for \"im­ plies\" , but we will use the usual circumlocutions such as \"if A then B\" for \"A implies B\" . Notice that the use of connectives is purely finitis­ tic; although the individual statements may refer to the infinite, the use of connectives does not introduce any new infinite reference. The statement \"A or B\" means A is true or B is true (or both), whatever A or B may be. Of course a proof of \"A or B\" may not tell us which of the two is true. Notice that the double negative \"not not A\" is iden­ tical to the statement \"A\". The statement \"A implies B\" is logically equivalent to its contrapositive \"not B implies not A\" but is distinct from its converse \"B implies A\". The logic of connectives, also called the propositional calculus, will be assumed as part of the mathematical background of the reader. Quantifiers introduce the infinite, potential or actual, into our finite language. We can write \"2+1 = 1+ 2, 2+2 = 2+ 2, 2+3 = 3+ 2, 2+4 = 4 + 2, ... \" and assume that the three dots are self-explanatory, or we can write \"for all natural numbers x, x + 2 = 2 + x\". In either case, the finite sentence we have written is supposed to convey an infinite amount of information. The infinite enters because the set over which x varies-the natural numbers-is infinite. In this context we can, if we wish, regard this infinite as only potential; any individual will 1.1 The Logic of Quantifiers 3 experience only a finite number of instances of x + 2 = 2 + x. However, in order to understand the way of analysis, we will have to accept the completed infinite. This may create problems, both mathematical and psychological, but it is inescapable. In this book, the quantifiers used will always refer to variables whose domains are clearly specified sets. Thus we may say \"for all sets of sets of integers\", but we will not say \"for all sets\". The \"for all\" is the universal quantifier, and the \"there exists\" is the existential quantifier. The universal quantifier is a grand \"and\", while the existential quan­ tifier is a grand \"or\". The statement \"for all x in U, A( x)\" where U is a prescribed set and A is a statement in which the variable x appears has the meaning that A(x) is true for every value of x in U. If the elements in U could be enumerated Ut, U2, U3, .•. , then \"for all x in U, A(x)\" would mean \"A(uI) and A(U2) and A(U3) and ... \". If the set U is finite, then \"for all x in U, A(x)\" is exactly the finite conjunction. Similarly \"there exists x in U such that A(x)\" means A(x) is true for at least one x in U or \"A(Ul) or A(U2) or ... \" if Ul , U2, .. . enumerates U. To deny a universal statement we need find only one counterexam­ ple, so the negation of \"for all x in U, A (x)\" is the existential statement \"there exists x in U such that not A(x)\". But to negate an existen­ tial statement we must show that every possible instance is false, so the negation of \"there exists x in U such that A( x)\" is the universal \"for all x in U, not A (x)\". This is to be expected if we recall that the negation of a conjunction (and) is the disjunction (or) of the negations, and the negation of a disjunction is the conjunction of the negations (universal and existential quantifiers being grand conjunctions and disjunctions, respectively). To paraphrase: commuting a quantifier with a negation changes the type of quantifier. The real fun comes when there is more than one quantifier in a statement. For example, the commutative law of addition of integers can be stated as follows: for all integers x, for all integers y, x+y = y+x. Clearly the order of the quantifiers is immaterial, and in virtue of this fact we will abbreviate the statement as follows: for all integers x and y, x + y = y + x. Similarly, the order of two or more consecutive existential quantifiers is immaterial, so we say \"there exist integers x and y such that x+y = 2 and x+ 2y = 3\". To paraphrase, quantifiers of like type commute. But the situation is different for multiple quantifiers 4 Chapter 1 Preliminaries of differing type. Consider the statement: everyone has a mother. We can express this via quantifiers as follows: for every person x there exists a person y such that y is the mother of x. If we reverse the order of quantifiers the statement becomes: there exists a person y such that for every person x, y is the mother of x. Clearly this is not the same statement as before; rather it says \"y is the mother of us all\". This is a stronger statement, less likely to be true; in fact, it is false. Since this is a crucial point, it is worth looking into more closely. The statement \"there exists y in U such that for every x in V, A(x, y)\" asserts that one y will make A(x, y) true no matter what x is. The statement \"for every x in V there exists y in U such that A(x, y)\" asserts only that A(x, y) can be made true by choosing y depending on x. It really asserts tl�e existence of a function y = f(x) (in the example above we can call it the mother function) such that A(x, f(x)) is true. For the existential-universal form the function must be constant. To paraphrase: the existential-universal implies the universal-existential but not vice versa; the universal-existential is equivalent to asserting the existence of a function from the domain of the universally quantified variable to the domain of the existentially quantified variable. 1.1.2 Examples To understand the way of analysis we have to deal with sentences that contain many quantified variables; we have to understand what these sentences mean and how to form their negation. This involves only applying the above principles several times; but it can get confusing, especially when a lot of intricate mathematical ideas are involved at the same time. To gain some confidence with the process we will examine some examples where the mathematics is simple. Goldbach's conjecture states: every even natural number greater than 2 is the sum of two primes. This can be written: for every x in the set E of even natural numbers greater than 2, there exists p in the set P of prime natural numbers and there exists q in P such that x = p + q. Since the last two consecutive quantifiers are both existential, we can combine them: for every x in E there exists p and q in P such that x = p + q. To make the dependence of p and q on x clearer we could write them as functions p( x) and q( x) from E to P, and Goldbach's conjecture becomes: there exist functions p(x) and 1.1 The Logic of Quantifiers 5 q(x) from E to P such that x = p(x) + q(x). What is the negation of Goldbach's conjecture? We can calculate it in stages as follows: (not) (for every x in E) (there exist p and q in P) (x = p + q) is equivalent to (there exists x in E) (not) (there exists p and q in P) (x = p+ q) is equivalent to (there exists x in E) (for all p and q in P) (not) (x = p + q). In other words, there exists x in E such that for all p and q in P, x ;i: p + q. The negation of Goldbach's conjec­ ture thus asserts the existence of a counterexample: an even number x (greater than 2) that is not the sum of two primes. Looking back at our computation of this rather simple fact, we see that it was a bit long-winded. Clearly to form the negation of a statement with a string of quantifiers we simply change the type of each quantifier, preserving the order, and negate whatever follows the string of quantifiers. From now on we will do this without further ado. Goldbach's conjecture being rather difficult-no one has succeed­ ed in proving or disproving it-mathematicians have looked at some weaker statements (also without success) in the same vein. For exam­ ple, \"Goldbach's conjecture has at most a finite number of counterex­ amples\". This can be written several ways. We can say, there exists a natural number n such that for all x in E there exist p and q in P such that x < n or x = p + q. This is perhaps a somewhat artificial form in that the p and q whose existence are asserted for x < n are completely arbitrary and irrelevant. However, it has the advantage of placing all the quantifiers first. A second version is: there exists a natural number n such that for all x in E, x > n implies there exist p and q in P such that x = p + q. A third version is: there exists a natural number n such that for all x in En, the set of even numbers greater than n, there exist p and q in P such that x = p + q. What is the negation of the sentence \"Goldbach's conjecture has at most a finite number of counterexamples\"? From the first version we find: for all natural numbers n there exists x in E such that for all p and q in P, x > n and x ;i: p + q-in other words, the existence of counterexamples greater than any prescribed n. (Here we have used the propositional logic equivalence of not (A or B) and not A and not B.) Another weakening of Goldbach's conjecture can be formulated as \"every even number is the sum of at most a fixed number of primes\" . We can write this as follows: there exists a natural number k such 6 Chapter 1 Preliminaries that for every x in E there exist Pl, P2, ... 'Pi in P such that j < k and x = PI + P2 + ... + Pi' The negation of this statement is: for every natural number k there exists x in E such that for all j < k and PI, ... ,Pi in P, x =F Pl + P2 + . . . + Pi' Here is a statement with four consecutive quantifiers: for every natural number n there exists a natural number m such that for every natural number x there exist non-negative integers al, a2, ... ,am such that x = al + a2 + ... + a�. What does it mean? It says that given n, there is a number m depending on n-we might write m(n)-such that every number is the sum of m(n) n-th powers. This statement is known as Waring's problem, and there are some rather difficult proofs of it. Its negation would say: there exists a natural number n such that for every natural number m there exists a natural number x such that for all non-negative numbers ab a2, .. ' ,am, x =F ai + ai + ... + a�. In deciphering complicated strings of quantifiers it is amusing to imagine a game played with the devil. Every time an existential quan­ tifier appears it is your move, and every time a universal quantifier appears it is the devil's move. You make a choice of the quantified variable from the specified set that makes things as good as possible, while the devil does his best to mess you up. If you have a strategy to beat the devil every time, then the statement is true; otherwise, it is false. A direct proof of a quantified statement is one that gives the strat­ egy for beating the devil explicity. However, we will also allow indirect proofs, in which we only prove (by contradiction) that such a strategy must exist. Clearly a direct proof is preferable, if it can be found. There is a minority school of thought, called Intuitionism or Constructivism , that holds that we should not accept indirect proofs. The majority of mathematicians reject this as counterproductive, for the following reason: by allowing indirect proofs, we create a much richer mathe­ matical world, that contains more direct proofs than would have been discovered (presumably) had indirect proofs been rejected outright. In the best of all possible worlds (from the point of view of students), mathematicians would be required to write all quantified sentences with the quantifiers at the beginning of the sentence (in the correct order). Similarly, all impliction sentences (or statements of theorems) would have the hypotheses first and the conclusions second. In this world, they don't do it that way! The English language allows many different 1.1 The Logic of Quantifiers 7 forms of expression for the same ideas, and mathematicians help them­ selves freely. This is bound to cause confusion. As you do the exercises and look back at the examples already discussed, try to develop the insight to recognize hidden quantifiers or transposed word orders. It is a skill that will serve you well in what follows. 1. 1.3 Exercises 1. For each of the following famous sayings, rewrite the statement making all the quantifiers explicit. Then form the negation of the statement. Finally, recast the negation in a form similar to the original saying. a. The skies are not cloudy all day. b. Man cannot live by bread alone. c. The sun never sets on the British Empire. d. To every thing there is a season, and a time for every purpose under heaven. e. The devil makes work for idle hands. f. Sufficient unto the day is the evil thereof. g. All our yesterdays have lighted fools the way to dusty death. 2. For each of the following mathematical statements, rewrite the state­ ment making all the quantifiers explicit. Then form the negation of the statement. Finally recast the negation in a form similar to the original statement . a. Every positive integer has a unique prime factorization. b. The only even prime is 2. c. Multiplication of integers is associative. d. Two points in the plane determine a line. e. The altitudes of a triangle intersect at a point. f. Given a line in the plane and a point not on it, there exists a unique line passing through the given point parallel to the given line. 8 Chapter 1 Preliminaries g. Any partitioning of the integers into a finite number of dis­ joint subsets has the property that one of the subsets contains arbitrarily long arithmetic progressions. h. If there are more letters than mailboxes, at least one mailbox must get more than one letter. 3. Each of the following true statements is in universal-existential form. Write the corresponding statement with the order of quan­ tifiers reversed, and show why it is false. a. Every line segment has a midpoint. b. Every non-zero rational number has a rational reciprocal. c. Every non-empty subset of the positive integers has a smallest element. d. There is no largest prime. 1. 2 Infinite Sets 1.2.1 Countable Sets Set theory, like logic, plays a central role in mathematics today. In contrast to the settled state of logic, however, we are in a state of grievous ignorance about some of the basic properties of sets and are likely to remain so. The reason for this is that our finite minds have difficulty penetrating to the core of the infinite; at best we can play with pebbles on the shore of a vast ocean. Fortunatel y we possess some mighty pebbles that will enable us to enter the way of analysis. Some of the material in the section may be familiar to you, but in any case it is worth reviewing because of its importance. The basis for our intuition of the infinite is the set of natural num­ bers 1,2,3, .... As Galileo observed, this set can be put in one-to-one correspondence with a proper subset, say the even numbers-an obser­ vation that convinced Galileo that he shouldn't toy with the infinite. Cantor was braver, adopting the definition that two sets have the same cardinality if their elements can be put in one-to-one correspondence and facing squarely the fact that infinite sets can have the same cardi­ nality as proper subsets. For finite sets this cannot happen, of course. 1.2 Infinite Sets 9 This leads immediately to the question: do all infinite sets have the same cardinality? A set with the same cardinality as the natural num­ bers is called countable; the one-to-one correspondence with 1, 2, 3, ... amounts to a counting or enumeration of the set. The elements of a countable set can be listed Ul, U2, U3, •.• , although the order of the elements may have nothing to do with any relationships between the elements. The listing is merely a convenient way of displaying the one­ to-one correspondence with the natural numbers. In order to construct a set that is not countable (uncountable) we attempt to build larger sets by the natural processes of set theory. Suppose we have two countable sets, A = (aI, a2, ... ) and B = (bl' �, ... ). Is their union countable? Clearly we can splice the two listings a I, bi , a2, �, . .. to obtain a listing of A U B. This listing may involve duplication, since we have not assumed the sets A and B are disjoint, so it may not be a one-to-one correspondence. However, the problem is easily fixed by tossing out the duplications as they arise. In other words we use the simple lemma: if there is a mapping of the natural numbers onto a set U (not necessarily one-to-one), then U is either finite or countable. In this case Au B cannot be finite since it contains the infinte subset A. A similar argument shows that the union of any finite number of countable sets is countable. What about the union of a countable number of countable sets? Suppose AI, A2, A3, ... are sets and each one is countable. Let us denote the elements of Al by an, aI2, ... , the elements of A2 by a21, a22, .. . , and in general the elements of Ak by akl, ak2, .. .. We can then write all the elements of the union U�I Ak in an infinite matrix as a11 aI2 aI3 a21 a22 a23 a3I a32 a33 The k-th row of this matrix enumerates the set Ak. Of course the matrix may contain duplications, but this can be handled as before. The question of the countability of the union set then boils down to the question: are the elements of the above infinite matrix countable? The answer is obtained by turning your head 45° counterclockwise (or equivalently turning the paper 45° clockwise). The matrix then looks 10 Chapter 1 Preliminaries like all ---+- ---+- a 21 ---+- a 12 ---+- ---+- a 31 ---+- a22 ---+- a 13 ---+- an infinite triangle and can be counted by following the arrows. Thus we cannot construct an uncountable set by the process of unions. Inci­ dentally, the same argument shows that the Cartesian product A x B of two countable sets is also countable (recall that the Cartesian product A x B is the set of all ordered pairs ( a, b) where a varies over A and b varies over B). One can similarly show that any finite Cartesian prod­ uct Al x A2 X ••• x Ak of countable sets is countable, but the same is not true of the Cartesian product of a countable number of countable sets (see exercise set 1. 2. 3, number 5). 1.2.2 Uncountable Sets To escape beyond the countable we need a more powerful set operation, called the power set. If A is any set, then the power set, 2A, is the set of all subsets of A. That is, the elements x of 2A are the subsets of A (in other words, x is a set, all of whose elements are elements of A). The reason behind the notation 2A is that we can \"parametrize\" the subsets of A by attaching a two-element set, say (Yesa, Noa), to each element a of A. A particular subset x of A is then uniquely determined by a choice of one of the two, Yesa if a is in x or N Oa if a is not in x, for each a in A. Alternatively we can think of the choice Yesa or NOa as giving a function from A to the two-element set (Yes, No). It is important to understand that the choice Yesa or NOa is completely arbitrary-we do not assume that it is given by a particular rule that we could describe, even potentially, in our finite language. This is essential because the number of subsets that are potentially describable in any finite language are at most countable and rather limited in many ways (when the set A is the natural numbers then these describable sets are called recursive) . To consider 2A for any infinite set A is thus to admit into mathematics an object well beyond the scope of our full comprehension. This is an order of magnitude greater than the admission of the completed infinite of the natural numbers, because every natural number has a potential name in our finite language. 1.2 Infinite Sets 11 Cantor's proof that 21'1 is uncountable, where N is the set of natural numbers, goes as follows: Suppose 21'1 is countable; then we will obtain a contradiction. Let Ul , U2 , U3, .•• be the supposed enumeration of 21'1 . This means that each Uk is a set of natural numbers, and every set of natural numbers must appear on the list. The contradiction arises from the fact that one can now describe a set v that is not on the list. The set v is the set that contains the number k if and only if Uk does not contain k. Symbolically, v = {k : k is not in Uk} . The set v is unambiguously defined, in fact by a statement in our finite language, but the definition of v depends on the particular enumeration U1 7 U2 , U3, . .. . Now the very construction of v guarantees that it does not appear on the list, because it differs from Uk in the matter of the number k; one contains k and the other doesn't. This contradicts the fact that Ul , U2 , U3 , '\" was supposed to list every subset of N, and thus the impossibility of such an enumeration is demonstrated. Despite the simplicity of Cantor's proof, it contains some subtle points that deserve to be explicated. For example, how come we can't repair the error of having left out the set v simply by inserting it some­ where on the list, say first: v, Ul , U2 , .•. ? Now we have an enumeration that contains v. And yet, doesn't the same argument show that v is not on the list? The key to overcoming these sophistries is to remem­ ber that the definition of v depended on the particular enumeration. Thus the set constructed by the argument from the new enumeration v, U l , U2 , '\" is a different set; call it v'. We could of course add v' to the enumeration, but then the argument would construct still another set. Thus in fact what the proof shows is that given any countable set U1 7 U2 , U3 , ••• of subsets of N, it is possible to construct a subset of N different from all of them. This construction is often called a diagonal­ ization argument, since if we represent the enumeration Ul , U2, U3 , ... by an infinite matrix of Yes's and No's, with a Yes in the j - k place meaning that j is in Uk, then v is obtained by changing all the diagonal entries. This kind of argument is used quite frequently in mathematics. We will also encounter later a different kind of diagonalization argu­ ment that shows how we can pass to a subsequence a countable number of times. The conclusion that 2N is of greater cardinality than N (we say that a set A has greater cardinality than a set B if A cannot be put in one-to-one correspondence with B, but a proper subset of A can be put 12 Chapter 1 Preliminaries in one-to-one correspondence with B) raises the interesting question of whether there are sets of intermediate cardinality. In other words, does there exist a subset A of 2N that is of greater cardinality than N but of lesser cardinality than 2N; or on the contrary, must every infinite subset A of 2N be capable of being put in one-to-one correspondence with either N or 2N , as Cantor's famous Continuum Hypothesis asserts? We now have very convincing evidence, in the work of Kurt Godel and Paul Cohen, that this question will never be answered. Godel showed that the Continuum Hypothesis cannot be disproved, and Cohen showed that it cannot be proved. They constructed different \"models\" of set theory in which all the usual axioms of set theory are valid and the Continuum Hypothesis is in one case true and in another case not true. The usual interpretation of these results is that we do not have enough axioms for set theory to distinguish between these wildly different \"set theories\". But we don't have a clue where to search for new axioms for set theory nor any legitimate way to decide whether or not to accept new axioms. It is possible that some intuitively appealing set-theoretic axiom may yet be discovered that will settle the Continuum Hypothesis, but at present this is just idle speculation. At any rate, we have no right to expect that our finite reasoning can fully illuminate the uncountable infinite. Fortunately, for the analysis we are going to do in this book, these set-theoretic questions will not enter. In fact one might say that the way of analysis consists of using the finite to get at the countably infinite (by constructing arbitrarily large finite segments of countable sets) and then using the countably infinite to get at the uncountably infinite by an appropriate approximation process. The uncountably infinite will remain largely potential, just as in number theory the infinite is largely potential. Also, we will be dealing only with sets that are built up from the natural numbers in a finite number of steps; that is, we may deal with sets of sets of numbers or sets of sets of sets of numbers, and the like, although we will introduce abbreviations that will hide this fact. We will certainly never deal with such linguistic contortions as \"the set of all sets\" , that leads to the famous paradoxes of naive set theory such as \"the set of all sets not containing themselves\". All the set theory we will use is capable of being axiomatized, although we shall not do so. 1.3 Proofs 13 1.2.3 Exercises 1. Prove that every subset of N is either finite or countable. (Hint: use the ordering of N.) Conclude from this that there is no infinite set with cardinality less than that of N. 2. Is the set of all finite subsets of N countable or uncountable? Give a proof of your assertion. 3. Prove that the rational numbers are countable. (Hint: they can be written as the union over kEN of the sets QIe = {±j/k : j E N}.} 4. Show that if a countable subset is removed from an uncountable set, the remainder is still uncountable. 5. Let Al, A2, A3,.\" be countable sets, and let their Cartesian prod­ uct Al x A2 X A3 X •• • be defined to be the set of all sequences (al' a2,' •• ) where ale is an element of Ale' Prove that the Carte­ sian product is uncountable. Show that the same conclusion holds if each of the sets Al, A2, ' . . has at least two elements. 6. Let A be a set for whi ch there exists a function f from A to N with the property that for every natural number k, the subset of A given by the solutions to f(a} = k is finite. Show that A is finite or countable. 7. Generalize the diagonalization argument to show that 2A has greater cardinality than A for every infinite set A. 1.3 Proofs 1.3.1 How to Discover Proofs This book is about proofs. Not only will you read the proofs presented in the text, but in the exercises you will be asked to prove things . What is a proof? How do you go about finding one? How should you write a proof? Presumably, these are questions you have thought about before in the course of your mathematical education. These are not easy questions; and although there is a reasonable consensus 14 Chapter 1 Preliminaries in the mathematical community on the answers, there is still some disagreement on where to put the emphasis. In principle, a proof is a sequence of logical deductions from the hypotheses to the conclusion of the statement being proved. The state­ ment is typically in the form of an implication, say \"P and Q implies R\" . In this case there are two hypotheses, P and Q, and one conclu­ sion, R. All terms involved in the expressions P, Q, and R should be previously defined. The first step in reading (or finding) a proof is to make sure you understand all the hypotheses and the conslusions and remember the definitions of all the terms used. Sometimes, important hypotheses are hidden in the fine print. Read the fine print. The reasoning allowed in a proof involves the accepted principles of logical reasoning and the application of axioms or previously estab­ lished theorems. A common source of error in proofs involves applying a theorem without verifying all the hypotheses of that theorem. This may result in an incorrect proof (if the theorem does not apply) or an incomplete proof (if the theorem does apply but some of the key ideas of the proof are involved in verifying this). Another common source of error involves making extra assumptions, beyond what is given in the statement. Also, if the conclusion of the statement says \"for all x . .. \", it is not correct to prove the statement just for x = 2. When faced with the task of finding a proof for a given statemen­ t, it is a good idea to make a list of what you know (the hypotheses, and sometimes also the definitions of key terms) and what you want to show (the conclusion, sometimes spelled out by supplying definitions of terms). Then search for theorems that connect the two. It is advis­ able to work simultaneously back ward and forward. If your hypotheses contain the hypotheses of a theorem that you know, you may deduce the conclusion of that theorem. This is working forward. Or, you may know a theorem whose conclusion is the conclusion you are trying to show. Then the hypotheses of this theorem become the new target (what you have to show). This is working backward. Often, the fit between the theorem you want to use and the way you want to use it is not perfect. For example, in working forward, the hypotheses of the theorem you want to use may not all be exactly on your list of what you know , but you may be able to deduce them (with a little work) from what you know. In this way you can build a chain of deductions from your hypotheses and a chain of deductions to your conclusion. 1.9 Proofs p---.. S Sand Q ---.. T r:;{ and T ---.. R \\!J R Figure 1.3. 1: 15 If you are lucky, at some point these two chains will meet, as in Figure 1.3.1. Then you can join them to form a single forward chain of deduction from hypotheses to conclusion, the proof you sought. Such a simple strategy may be called \"follow your nose\" . It should work for the simpler problems. Here is a good tip if you get stuck. A good problem will require that all the hypotheses be used in the proof. So if you are wondering what to do next, go down the list of what you know and see if anything hasn't been used yet. Then figure out a way to use it-that is, look for theorems that have it (or a consequence of it) as one hypothesis. If \"follow your nose\" doesn't lead to a proof, you may have to resort to a \"construction\" . This means that you introduce a new object that is not mentioned in either the hypotheses or conclusions of the statement. For example, if the statement concerns two numbers x and y, you might need to consider the average z = 1/2(x + y). This is a simple example, but constructions can be much more elaborate; their discovery requires ingenuity and creativity. There is no set formula for how to go about the process, but you will find that experience is helpful. The goal of the construction is to make more theorems applicable to the problem. You may get a hint that a construction is needed if there is a theorem that seems likely to be relevant but doesn't quite apply to the objects mentioned in the problem. After you have discovered a proof, and checked that it is a valid proof, you will want to write it up. There are two approaches you can take. You can write it in the order in which you discovered it , or you can try to rearrange the order of reasoning to \"polish\" the argument . For example, in Figure 1.3. 1, you might first have observed that \"P 16 Chapter 1 Preliminaries and T imply R\" , then that \"P implies 5\" , and finally that \"5 and Q imply T\". A proof in the order of discovery might read as follows: Proof: We need to show R. But the Purple Peril Theorem says P and T imply Ri and since we already know P, it suffices to show T to complete the proof. But observe that P implies 5 by the definition of grunginess, and Q and 5 imply T by the previous lemma. This completes the proof. QED Or, you could rearrange the deductions to run forward. The result might read like this: Proof: We are assuming P and Q. Then P implies 5 by the defini­ tion of grunginess, and Q and 5 imply T by the previous lemma. Thus we have both P and T, the hypotheses of the Purple Peril Theorem, whose conclusion is R. QED The argument for preferring the rearranged proof is that it is easier to follow. On the other hand, the first proof indicates the reasoning used in the process of discovery and so may make more sense to the reader. A little common sense may help one decide between the two options (or a compromise, that retains some of the original order of discovery but does some pruning and straightening in between). One important issue with which you will have to grapple is the amount of detail you include in the proof. Often there are very simple arguments that can either be omitted altogether or dismissed with a phrase like \"it is obvious that\" . If all these simple arguments were included, the proof might become so long that the reader would \"lose the forest for the trees\" . On the other hand, you don't want to leave out any non-trivial parts of the argument or make a mistake in reason­ ing. The ultimate test of a written proof is whether or not it convinces the reader. This, of course, depends on the reader! For a written as­ signment that is being graded, you had better include enough detail to convince the grader that you know how to supply the missing ar­ guments. For the proofs presented in the text, I have tried to supply enough detail so that you can fill in whatever is omitted. A word about proof by contradiction (also known as indirect proof, 1.3 Proofs 17 reductio ad absurdum, or proof by the contmpositive). It is an accepted logical principle that \"not Q implies not P\" is the same as \"P implies Q\" . SO to prove the statement \"P implies Q\" , it is legitimate to start by assuming Q is false and reach a contradiction. Along the way you may use both the hypothesis P and the assumed not Q in the argument. Often this allows you to successfully find a proof that otherwise might be elusive. However, it is my experience that students tend to abuse proof by contradiction in the following way. The student will assume Q is false, then give an argument that produces Q as a consequence, and find the contradiction between Q and not Q. But in fact, buried in the middle of the student's proof will be a direct proof that P implies Q. Generally speaking, this might be the case with your proof if the contradiction involves Q and not Q. If so, check to see whether you really need not Q in your argument. If you didn't use not Q, then it is preferable to present the proof as a direct proof. Why is the direct proof preferred over the indirect proof? Usually a direct proof is more constructive. If the conclusion is an existential statement, \"there exists x such that ... \", the direct proof may include an algorithm for finding x. This gives more information than simply showing that the non-existence of such an x always leads to a contra­ diction. 1.3.2 How to Understand Proofs One of the goals of this book is to get you to understand the proofs of the theorems presented. There are many levels of understanding, and they will involve considerable effort on your part. On the first level of understanding, you should be able to read through the proof and be convinced that the reasoning is correct. There must be no \"proof by intimidation\" . You have to see all the individual steps of the argument; and this means going through the proof line by line, checking all the details that are presented, and filling in the details that are left out. I have tried to present the proofs clearly, but it will probably happen that some statements are not clear to you on first reading. Put a mark in the text when this happens and be sure to return to these points and clear them up, either by yourself or with the help of someone else. The second level of understanding involves grasping the structure of the proof. What are the main theorems that are used? What construc- 18 Chapter 1 Preliminaries tions are involved? What are the main difficulties, and how are they overcome? You should have in your mind an outline of the proof, with some hints as to how to fill in the details. Without actually having to memorize anything, you should retain enough to be able to reconstruct the proof in your own words without referring to the book. The third level of understanding involves seeing how every hypoth­ esis enters into the proof. You should be able to point out where each hypothesis is used; better still, you should be able to give a counterex­ ample to the theorem without that hypothesis. You should explore the possibilities of weakening the hypotheses or strengthening the conclu­ sion. Is the result still true, or can you find a counterexample? If the proof involves a construction, try to understand why that particular construction was chosen. In short, this level of understanding requires that you take the proof apart and put it back together to see how it ticks (this cliche refers to the distant past when watches actually ticked, and you could actually take them apart). When you have achieved this level of understanding, you should have no difficulty remembering the exact statement of the theorem. There is another level of understanding, although this refers to the theorem as a whole, not just the proof. This level refers to the way the theorem is used and how it can be generalized. Obviously, you cannot achieve this level right away. Working the problems will help give you a feel for what is involved in using a theorem. By the time you reach the end of this book you will have seen how many of the theorems in the beginning of the book are used. As you continue your mathematical education you will see how the themes developed in this book recur and how theorems are used and generalized. By the same token, you should find as you study this book that your understand­ ing of previously learned mathematics is broadened and deepened. In mathematics, truly, nothing should be forgotten. 1.4 The Rational Number System We take the rational number system as our starting point in the con­ struction of the real number system. We could, of course, give a detailed construction of the rational numbers in terms of more primitive notions. However, every mathematical work must start somewhere, with some 1.4 The Rational Number System 19 common notions that are accepted without formal development. It is appropriate, since we are entering upon the way of analysis, that is characterized by infinite processes, that we begin with a system that is essentially finite and yet is as close to our goal as possible-so that we do not excessively weary ourselves with preliminaries. The rational number system serves this purpose admirably. (There are an infinite number of rationals, but we do not require infinite notions to define the algebraic and order structures of the rationals. ) It is assumed that the reader has had ample experience in dealing with the rational number system and feels comfortable with its prop­ erties. We give here a summary of the properties we will be using. A rational number is a number of the form p/q , where p and q are integers and q is not zero. The expressions p / q and p' / q denote the same rational number if and only if pq = p' q. Every rational number has a unique irreducible expression p/q where q is positive and as small as possible. Arithmetic is defined for rational numbers by and p p' pq + p'q q + q' = qq' p p' p . p' q. q' = q . q' . These operations are well defined in that if we replace one of the ex­ pressions in the sum or product by a different expression for the same rational number, then the result will be a different expression for the same rational number (so 1/2 + 1/3 = 5/6 and 2/4 + 1/3 = 10/12 but 5/6 and 10/12 are expressions for the same rational number). This may seem like a trivial point, but it is essential that we observe it. Later, when we define real numbers, we will encounter a similar situation in that there will be many different expressions for the same real number, and when we define operations like addition on real numbers we will al­ so be obliged to verify that the result is independent of that particular expression is chosen. The rational numbers form a field under the operations of addition and multiplication defined above. This means 1. addition and multiplication are each commutative and associative, a+b = b+a, (a+b)+c = a+(b+c), a·b = b·a, (a·b)·c = a·(b·c); 20 Chapter 1 Preliminaries 2. multiplication distributes over addition, a . (b + c) = a . b + a . c; 3. 0 is the additive identity, 0 + a = a, and 1 is the multiplicative identity, 1 . a = aj 4. every rational has a negative, a + (-a) = 0, and every non-zero rational has a reciprocal, a· l/a = 1. The field axioms imply all the usual laws of arithmetic and allow the definition of subtraction and division by a non-zero rational number. The rational numbers also possess an order. A rational is positive if it has the expression p/q with p and q positive. It is negative if it has the expression p/q with p negative and q positive. Every rational is either positive, negative, or zero. In terms of this we define a < b if b - a is positive and a < b if b - a is positive or zero (non-negative) . The order and the arithmetic are connected. The sum and product of positive rational numbers are positive. These properties express the fact that the rational numbers form an ordered field. All the usual properties relating order and arithmetic (such as a > b and c > d imply a + c > b + d) are easily deducible from them. For example, we can define the absolute value lal = a if a > 0 and -a if a < 0 and prove the triangle inequality la+bl < lal + Ibl for rational numbers. This property will be used frequently and generalized broadly (the terminology \"triangle inequality\" comes from a generalization to vectors in the plane, where la + bl is interpreted as the length of the third side of a triangle whose two other sides have length lal and Ibl) . The triangle inequality is also frequently used in transposed form la - bl > lal - Ibl· In addition to the connections with arithmetic, there are some other properties of the ordering of the rational numbers that are noteworthy. One is called the Axiom of Archimedes: for every positive rational number a > 0 there exists an integer n such that a > lin. (Note that the term \"axiom\" is used here for historic reasons onlyj it is not taken as an axiom for the rational numbers but rather is a theorem that can be proven for the rational number system) . The reciprocal version of this is that every positive rational number is less than some integer. This will turn out to be a very crucial property-one that is also possessed by the real number system . 1.5 The Axiom of Choice 21 Another interesting property of the ordering of rational numbers is that between any two distinct rationals there is an infinite number of other rationals. Thus there is no next largest rational. If you have ever studied the concept of well-ordering you will recognize the fact that the ordering of the rationals is not one. The rational number system, with its arithmetic and ordering, form­ s such a simple and elegant mathematical model that it is tempting to want to stay within its comfortable domain. What more could one demand of a number system? Why not do analysis here? To find out , turn to the next chapter. 1.5 The Axiom of Choice· In thinking about infinite sets, we are inclined to adopt forms of reason­ ing that arise from our intuitive ideas about finite sets. This transfer­ ence of ideas from the finite to the infinite is by no means routine and often has consequences that are unforseen. Such an innocent principle as the law of the excluded middle-that a statement must either be true or false-results in the non-constructive nature of mathematics. We can prove ''there exists z such that blah\" by showing that ''for all x not blah\" leads to a contradiction, without offering a clue as to how to find the z whose existence is asserted. With the exception of the Intuitionist and Constructivist schools of thought, most mathemati­ cians accept this sort of non-constructivity routinely, with the feeling that the problem of actually finding the z is a legitimate, but different, mathematical problem. The Axiom of Choice is another principle-obvious for finite sets and transferred to infinite sets by analogy-that leads to non-constructive mathematics. In many ways the use of this axiom leads to a higher de­ gree of non-constructiveness than the use of the law of the excluded middle. (Here I am referring to an intuitive conception of the degree of non-constructiveness rather than a formal mathematical theory.) For this reason, the axiom of choice has received careful scrutiny and per­ haps a bit of notoriety as well. Since we will be using it as a valid method of reasoning, we will take the time here at the beginning to discuss it in detail. If A and B are two sets that are non-empty, we define the Cartesian 22 Chapter 1 Preliminaries product A x B to be the set of ordered pairs (a, b) with a in A and b in B. For finite sets A and B this is a completely straightforward definition, and even for infinite sets A and B it causes little problem. If A is non-empty it must contain at least one element al and if B is non­ empty it must contain at least one element bl, so (al! bd is in A x B. The Cartesian product of two non-empty sets is non-empty. Of course we may not have a constructive procedure for obtaining the element (aI, bd of Ax B, if we lack a constructive method for getting al or bl. But the process of pairing does not add to the non-constructivity. If we can \"construct\" al and bl, then we can \"construct\" (aI, bd. The same ideas can be used to create the Cartesian product Al x A2 x ... x An of n sets for any finite n. This is the set of ordered n­ tuples (aI, a2,\" \" an) where each aj is an element of Aj. Once again, the Cartesian product of non-empty sets is non-empty. We encounter the axiom of choice when we try to extend these ideas to an infinite collection of sets. Suppose AI, A2, ... is a countable collection of sets. The Cartesian product Al x A2 x . . . is defined to be the set of sequences (ab a2,\" ') where each an belongs to An. The countable axiom of choice asserts that if the sets An are all non-empty, then the Cartesian product is also non-empty. The term \"choice\" refers to the fact that any particular element (aI, a2, ... ) of the Cartesian product arises from the \"choice\" of one an from each set An. There are two important points that need to be emphasized here. The first is that it is usually not necessary to invoke this axiom in order to show that the Cartesian product is non-empty. In most par­ ticular cases we know enough about the sets An to produce a sequence (aI, a2,' .. ) by other methods of reasoning. For example, if the An are lines in the plane (being considered as sets of the points on the lines) , we can take a fixed origin in the plane and define an to be the point on the line closest to the origin. We thus use a theorem of Euclidean geometry to produce the element (ab a2,\" .). From the point of view of \"choice\" , we have replaced the infinite simultaneous unspecified choice of the axiom with an infinite simultaneous specified choice. When a specified choice is available, the axiom of choice is unnecessary. The second point is that it is the infinite number of sets involved and not the infinity of cardinality of the sets An that requires the axiom. We might even need to use the axiom if each of the sets An contains only two elements. It might be that each An contains two elements, and 1.5 The Axiom of Choice 23 we might even possess procedures for choosing one of the two elements of An, but the procedures might be so unrelated to each other that we cannot specify a general procedure. Thus the countable axiom of choice, applied to sets of cardinality two, leads to non-constructive existence. Normally the countable axiom of choice is used to justify the inclu­ sion in an argument of the making of a countable number of simulta­ neous choices where we cannot (or are too lazy to) make the choices in a specific way. In such applications we can avoid all mention of the Cartesian product, since it is the individual sequence (aI , a2, ... ) that we need. Such uses are relatively uncontroversial and do not lead to any worse non-contructiveness than the use of the law of the excluded middle. The general axiom of choice refers to an arbitrary-perhaps uncountable-collection A of non-empty sets A and asserts the pos­ sibility of making a choice of one element from each of the sets A (formally, a function f, called a choice function, whose domain is A, and such that f(A) is a point in A for each set A in A). Although the general concept of set as an arbitrary collection of elements would nat­ urally lead us to accept this axiom-if each of the sets A is non-empty, why shouldn't there be a choice function?-it does lead to a level of non-constructivity that is mind-boggling. Here is an example. The general axiom of choice can be used to show that there exists an ultrafilter on the set of natural numbers. Intuitively, an ultrafilter is a collection of the \"big\" sets of numbers. It must possess the property that if A contains B and B is big, then A is big and also that the intersection of any finite number of big sets is also big. These two consistency conditions define the notion of filter. There are many filters; the simplest example is to define the complements of finite sets to be big. The ultra denotes the additional property that every set of numbers must either be big or else its complement must be big. This means for instance that either the even numbers or the odd numbers must be big (not both, for their intersection is empty) . Thus the ultra-filter makes an arbitrary choice-in a consistent manner­ between each set and its complement. Clearly there is no specific way to make such a choice, and it is beyond the imagination how such a choice could be made. The use of the words \"there exists\" in the phrase \"there exists an ultrafilter on the natural numbers\" thus involves a 24 Chapter 1 Preliminaries further step away from the constructive. For this reason, any use of the general axiom of choice deserves special mention and comment. Fortunately we will not need to use this axiom in this work. Chapter 2 Construct ion of the Real Number System 2.1 Cauchy Sequences 2.1.1 Motivation We have an intuitive concept of the real number system; it is the num­ ber system that should be used for measurements of space and time as well as for other quantities such as mass, temperature, and pres­ sure that are thought of as varying continuously rather than discretely. This intuitive real number system has been used by mathematician­ s since at least the period of ancient Greek mathematics, but it was not until the second half of the nineteenth century that a satisfactory formal mathematical system was constructed that could serve in its place. In fact, the whole history of the discovery of the foundation­ s of analysis reads backward-much as one peels a cabbage starting from the outermost leaves and working inward-so mathematicians s­ tarted by giving precise definitions for the most advanced concepts such as derivative and integral (Cauchy and Bolzano, 1820s) in terms of an intuitive real number system, then worked inward to construct the real number system (Weierstrass, Dedekind, Meray, Heine, Cantor, 1860s and 1870s) in terms of an intuitive set theory, and then worked to the core of axiomatic set theory (Peano, Frege, Zermelo, Russell, Whitehead, Frankel, starting in the 1890s and extending well into the twentieth century). Whether or not this is really the core or merely 25 26 Chapter 2 Construction of the Real Number System another inner leaf surrounding a more elementary core is left for the future to answer. The order of eating the cabbage does not have to correspond to the order of peeling, so in this book we will discard the core and start with the inner leaves. We formulate the problem as follows: construct a mathematical sys­tem, by means of precise, unambiguous definitions and theorems proved by purely logical reasoning, accepting as given the logic, set theory, and rational number system discussed in the previous chapter, which has as much as possible in common with the intuitive real number system. This problem is clearly not as well formulated as we might like. It is by no means clear that a solution is possible or that there are not many different solutions; we do not even have a strict standard by which to judge what constitutes a solution. Nevertheless it is an important problem, and we shall study in detail one solution, called the Cauchy completion of the rationals. This solution is equivalent to several oth­ ers, which we will discuss later. Together we can refer to these as the classical real number system. Since there is no completely objective method to evaluate how closely this system conforms to the intuitive concept of real numbers, we must rely on the consensus of the major­ ity of working mathematicians and users of mathematics to ratify the choice of the classical real number system as a worthy and successful solution. As a student of mathematics, you are invited to study this system and become part of the consensus or, if you wish, to oppose the consensus. (There are two other seriously competing number systems, called the constructive real number system (E. Bishop, 1970) and the non-standard real number system (A. Robinson, 1960) . Each has a fol­ lowing of mathematicians who believe that the alternative system is in fact a better solution to the problem as formulated above than the classical real number system. These systems are discussed briefly at the end of the chapter. Neither would make a good basis for a book on this level because both require a thorough understanding of the classical real number system.) Before discussing the construction of the classical real number sys­ tem, we should at least attempt to spell out some of the properties of the intuitive real number system that we expect the formal math­ ematical system to possess. It should certainly contain the rational numbers, and it should have an arithmetic with similar properties. In addition to the arithmetic operations, the rational numbers possess a 2. 1 Cauchy Sequences 27 compatible notion of order that is of great importance, so we want the real number system to have a similar order. We can summarize the above by saying we want the real number system to be an ordered field, that is, a set 1R with two operations, addition (x + y) and multiplication (x · y), an additive unit 0, a multiplicative unit 1, and an order relation (x < y), such that the ordered field axioms described in Section 1.4 are verified. (We will recall these axioms when we prove that the system we construct is in fact an ordered field.) So far we have not discussed any requirements for the real number system that are not already possessed by the rational number sys­ tem. Nevertheless we know that the rational number system is not large enough for even simply geometry, let alone analysis. There are \"numbers\" , such as 0, for which we have intuitive evidence favoring inclusion in the real number system, which are not included in the rational number system. For 0 the evidence is especially striking, consisting of drawing the diagonal of a square whose sides have length one and quoting the Pythagorean theorem. While this \"construction\" of 0 is extremely picturesque, it is somewhat misleading in that it only involves a finite number of steps; if we were to insist that all \"con­ structions\" involve only a finite number of steps we would never be able to follow the way of analysis. Of course there are many other examples of numbers such as 1r, e, 0v'2 for which no finite construction exists; still it is particularly simple to discuss 0 and to learn an important point from the discussion. What do we know about 0? By definition it is the positive solu­ tion to the equation x2 = 2. (You probably remember the proof that no rational number can satisfy this equation: if x = pi q is a ratio­ nal number factor out all powers of two, so x = 2kpl /ql with PI and ql odd and k an arbitrary integer. Then x2 = 22kpIlq� and x2 = 2 lead to 22k-lpI = q�, an even = odd contradiction for k positive or 21-2kq� = p� if k is not positive.) Perhaps you remember an algorithm for computing the decimal expansion of 0. It is somewhat cumber­ some, and in fact there is a simpler and more efficient (you get more accuracy for the same amount of labor) method, which is a lot more fun. Choose a first guess Xl ! and take for the second guess the average 28 Chapter 2 Construction of the Real Number System of the first guess and two divided by the first guess: X2 = ! (Xl + �) . 2 Xl If the first guess were exactly V2, then the second guess would also be V2; but if you guessed too low, then 2/Xl would be greater then V2 and the average would be closer to V2, and similarly if you guessed too high. The process can then be iterated, producing a third guess X3 = 1/2{x2 + 2/X2) and so on. In this way we get a sequence Xl, X2, X3, ... of better and better approximations to V2, and with a little calculus one can show that convergence is quite rapid (we will discuss this example later). It is quite likely that your pocket calculator uses this procedure, or something similar, when it tells you V2 = 1.414 .. . (the calculator stops iterating when the iteration produces no change in the number of decimals retained) . The key point of this discussion is that when we calculate V2 nu­ merically, what we actually obtain is a sequence of approximations to V2, whether it be the successive partial decimals 1, 1.4, 1.41, 1.414 or the successive guesses Xl , X2, X3, . . .. In any particular computation we obtain only a finite number of approximations, but in principle the ap­ proximation could continue indefinitely. The evidence for the existence of V2 as a number is then that we can approximate it by other numbers whose existence we already know (the partial decimals are all rational numbers, and the same is true of the sequence Xl, X2, . .. above, pro­ vided the first guess Xl is a rational number) . The same can be said, . f(\\V2 for example, for 1r, e, v 2 . Thus we want the real numbers to pos- sess a property not shared by the rational numbers, which we will call completeness. For now we can describe this intuitively by the con­ dition that anything that can be approximated arbitrarily closely by real numbers must also be a real number; later we will give the formal counterpart of this statement and prove that the real number system we construct does have this property. In the meantime we will use this intuitive description as a clue to how to proceed. As a counterweight to the intuitive notion of completeness, we want a principle that will keep the real number system from being too large (for example, to exclude imaginary numbers like A). The simplest such principle, called the density of the rational numbers, is that there are rational numbers arbitrarily close to any real number. This means 2. 1 Cauchy Sequences 29 that if we represent the real numbers and rational numbers graphically by points along a line, we will not see any difference. The \"holes\" in the rational number system due to the absence of irrational numbers like J2 are not visible, because of the rational numbers nearby. Having rejected the rational number system because it is too small, let us pause to consider another possible easy way out: infinite dec­ imal expansions. All the numbers we have been talking about have infinite decimal expansions, and we could just as easily think of the computations above of J2 as merely producing more and more digits of this expansion. On a certain level we would not be far from wrong to define the real number system as the set of all infinite decimals ±N. aI , a2, a3, .. . , where N is a nonegative integer, and each aj is a digit from 0 to 9. Of course there is nothing special about the base 10; we could use any other base just as well. Because of the familiarity of infinite decimals, this proposal is quite appealing. However, it has two technical drawbacks. The first is that the decimal expansion is not u­ nique: .999 .. . and 1.000 ... are the same number. This is usually met by the ad hoc requirement that the decimal cannot end in an infinite string of zeroes. The second drawback is that it is somewhat awkward to define addition and multiplication, because long carries could change earlier digits. For example, what is the first digit in the sum .199999999 .. . + .100000000 .. . where the ... here means that we don't know what comes next? Is it a 2 or a 3? We can't say in advance how many more digits we need to compute before we know, despite the fact that we already know that the sum is extremely close to .3. But aside from these technical problems, which can be overcome, there is a more important reason why mathematicians prefer not to describe the real number system in terms of infinite decimal expansions. This reason is that the infinite decimal is only one way of describing real numbers and, although it has its uses, is a somewhat peculiar one (we mentioned two such peculiarities above). It would be pedagogically and psychologically unsound to devote minute attention to the peculiarities of this system of representing numbers, since these peculiarities do not shed any light on the path we intend to follow. Instead we will look 30 Chapter 2 Construction of the Real Number System for a deeper method, one that will cast a shadow forward as well as backward. In the end we will show that all the numbers in our system have infinite decimal expansions, so that we have an equiv<.:.lent system. 2.1.2 The Definition Let us examine more closely the idea of approximating exotic numbers, like V2, by sequences of more prosaic numbers. What is it about the sequence 1, 1.4, 1.41, 1.414, ... that gives us confidence there is some number being approximated? We might say that there is a \"coming together of terms\" , unlike the sequences 1, 2, 3, ... or 1, 2, 1, 2, 1, 2, ... , which do not appear to approximate anything. The key question, which can be proposed first in the intuitive real number system and was first solved by Cauchy in that context , is the following: what condition on a sequence of numbers is necessary and sufficient for the sequence to converge to a limit but does not explicitly involve the limit? Of course if we knew in advance the number x to which the sequence Xl, X2, ' .• of numbers is supposed to converge, we could express the convergence in the typical way: for all natural numbers n, there exists a natural number m (depending on n), such that Ix - xkl < lin for all k > m. In other words, given any prescribed error lin, if we go far enough out in the sequence (beyond m) the terms all differ from X by at most lin. This is the standard definition of limit. Commonly the error lin is denoted € and is allowed to be any positive quantity. But this is merely an equivalent variant since we can always find lin smaller than €. In this book we will use lin rather than € because it simplifies matters. Regardless of which variant we use, it should be recognized that this definition is only precise if we know what \"number\" means. Cauchy's problem was how to get the limit x out of the definition of limit! His solution was to observe on an informal level that if the num­ bers Xk are getting close to x, they must be getting close to each other. To translate this into a precise statement, however, requires some care. Suppose we try the most obvious condition: that consecutive terms get close together. While this is true of convergent sequences, it is also true of the sequence 1, 1�, 2, 2�, 2�, 3, 3i, 3�, 3�, 4, 4t, .. . , which does not converge. It is not sufficient that consecutive terms be close; we need all terms beyond a certain point to be close. This is called the Cauchy criterion: for all natural numbers n there exists a natural number m 12. 1 Cauchy Sequences 31 (depending on n) such that for all j > m and k > m, IXj - xlt l < l/n. In other words, beyond the m-th term in the sequence, all terms differ from one another by at most 1/ n. A sequence that satisfies the Cauchy criterion is called a Cauchy sequence. Clearly any convergent sequence is a Cauchy sequence, because if we go far enough out in the sequence that Xj and XIt differ from the limit x by at most 1/2n, then they will differ from each other by at most 1/2n + 1/2n = l/n. But the def­ inition of Cauchy sequence does not involve the limit, as we wanted, so it is not immediately clear that every Cauchy sequence has a limit . Cauchy claimed to have proved this, but on a rigorous level his proof had to be bogus since he never defined \"number\" . Nevertheless, we should consider carefully an informal proof that the statement \"every Cauchy sequence converges to a real number\" accords with our intuitive concepts, especially the idea of completeness. Informal Proof: Let Xl , X2, X3, ••• be a Cauchy sequence of real num­ bers. We want there to be a real number x that is the limit. What should x be? Suppose we want to determine x to an accuracy of l/n. Then by the Cauchy criterion there exists m (depending on n) such that all terms beyond the m-th differ from each other by at most l/n. If we plot all the numbers XIt for k > m(n) on a line, they will lie in a segment of width at most l/n and the limit presumably must also lie in that segment , as shown in Figure 2.1.1. ... lin Figure 2.1.1: N ow we examine what happens when we increase n, say to n'. Then there exists m' , beyond which the terms all differ from one another by at most l/n'; in other words, by going farther in the sequence, the 32 Chapter 2 Construction of the Real Number System segment that contains all the terms, and presumably the limit, narrows, as shown in Figure 2.1.2. lin' • lin • Figure 2.1.2: Considering the situation for all values of n, we come to the conclusion that there exists a nested sequence of segments of length lin in which the limit presumably lies. This suggests that the limit x is exactly that number that is in all those segments. If there were no such number, this would suggest a \"hole\" in our number system, something that the idea of completeness is supposed to prevent. In any event we can \"compute\" this number x to any desired accuracy, say lin, by taking any value in the n-th segment (say Xm for m large enough that Xm lies in the n-th segment). Finally the sequence xI, X2, X3, ' •• must converge to this limit since for any error lin, there exists m (depending on n), such that all the terms beyond the m-th and the number x all lie in the m-th segment and so differ by at most lin. We can illustrate this argument neatly in what I will call the \"two­ dimensional picture\" . Draw a graph that plots Xn on the y-axis over the point lin on the x-axis, as in Figure 2. 1.3, drawing straight-line segments in between to make the picture clearer. The limit of the sequence is the point on the y-axis that the graph hits. The Cauchy criterion means that a portion of the graph is boxed in by a sequence of concentric rectangles (two of which are drawn), whose x-coordinates go from 0 to 11m (the condition k > m) and whose y-coordinates lie in a segment of length lin (these are the segments discussed above). The two-dimensional picture lets you \"see\" how the Cauchy criterion forces the graph to hit the y-axis at a precise spot . At present we have no way of making this informal proof precise. Nevertheless it is important because it will motivate our construction 2. 1 Cauchy Sequences 33 --+0�----'--+--�----�--------------�� 1 115 114 113 Figure 2.1.3: of the real number system. Since we already have the rational numbers and we believe that every Cauchy sequence should have a real number as limit, we should certainly add to the rational numbers a real number to be the limit of each Cauchy sequence of rational numbers (a Cauchy sequence of rational numbers does not necessarily have a rational num­ ber as limit, as the sequence 1, 1.4, 1.41, 1.414, . . . approximating the irrational number J2 shows). Suppose we had a number system that contained rational numbers and limits of Cauchy sequences of ratio­ nal numbers; would that be enough? One might first guess \"No\" , since there would then be Cauchy sequences of irrational numbers with which to contend. They would have to have limits, and wouldn't these constitute a new variety of real numbers? Perhaps so, but perhaps not, because more than one Cauchy sequence can have the same limit (compare 1, 1/2, 1/3, 1/4, ... with 0, 0, 0, ... ). It might be that every Cauchy sequence of real numbers Xl ,X2,X3, ••• has the same limit as a Cauchy sequence of rational numbers Yl , Y2, Y3, ... . In fact the follow­ ing informal proof appears convincing: just choose for Yn any rational number that differs from Xn by at most l/n (here we use the intuitive property that there are rational numbers arbitrarily close to any real number) . The error involved in changing from Xn to Yn gets smaller as we go out in the sequence and so shouldn't change the limit. Anoth­ er informal demonstration that we should get every real number as a limit of Cauchy sequences of rational numbers is the infinite decimal expansion; if a real number x has an infinite decimal representation ±N. ala2a3 \"\" then ±N, ±N.al , ±N.ala2, . .. is a Cauchy sequence 34 Chapter 2 Construction of the Real Number System of rational numbers approximating x. We now believe that we can obtain every real number as the limit of a Cauchy sequence of rational numbers (if the number x is rational, then we can take the sequence x, x, x, ... ) and that every Cauchy sequence of rational numbers has a real number as a limit. We are almost ready to make this insight into a definition, but there is one missing ingredient. We need to know when two different sequences have the same limit . Fortunately this is an easy problem to solve. Suppose the sequences Xl , X2, ••• and x� , x�, ... have the same limit x. Then for every error l/n there is a position m in the sequence Xl , X2, ••• beyond which all the ;rk differ from x by at most lin, and similarly there exists a position m' in the sequence x� , x� , . .. beyond which all the x� differ from x by at most lin. If we go beyond the larger of the two, m and m' , then Xk will differ from x� by at most l/n + l/n = 2/n. Clearly it is just a change of notation to arrive at the formulation for every n there exists m (depending on n) such that for all k > m, IXk - x� 1 < l/n. Two Cauchy sequences with this property will be called equivalent (at present this definition can only be formally stated for Cauchy sequences of rational numbers, since we have not defined the meaning of IXk - x�1 < l/n for real numbers Xk and X/ci however, once we have done so, the definition will apply verbatim to sequences of real numbers). We have thus shown, informally, that if two Cauchy sequences have the same limit, then they are equivalent. What about the converse? If two Cauchy sequences Xl , X2, . . . and x� , x2' ''' are equivalent, by how much can their limits X and x' differ? Certainly not by more than l/n + l/n for any n. This implies that the two Cauchy sequences have the same limit, at least if we believe the axiom of Archimedes (every positive number is greater than l/n for some n) . We have seen that the axiom of Archimedes is true for rational numbers, and it is one of the properties we want to keep when we pass from the rationals to the reals. Let us summarize the informal conclusions we have obtained so far: if the real number system is to be an ordered field containing the rational numbers for which completeness, density of the rationals, and the axiom of Archimedes hold, then it should consist of limits of Cauchy sequences of rationals with two such limits being considered equal if and only if the Cauchy sequences are equivalent. The use of the term \"equivalent\" in mathematics requires that the properties of reflexivity (A is equivalent to A), symmetry {A is equiva- 12. 1 Cauchy Sequences 35 lent to B implies B is equivalent to A) , and transitivity (A is equivalent to B and B is equivalent to C implies A is equivalent to C) be satisfied. If these properties hold, then we have a true equivalence relation, and we can divide the set on which the relation is defined into disjoint sub­ sets, called equivalence classes, such that A and B belong to the same equi valence class if and only if A is equivalent to B. In the present case the first two properties are obvious. The transitivity is not hard to show. Lemma 2.1.1 The equivalence of Cauchy sequences of rationals �s transitive. Proof: Let Xl, X2,\" \" YI , Y2, \" \" and Zl , Z2,'\" be Cauchy sequences of rationals such that the X - Y and Y - Z pairs are equivalent. To show the X - Z pair is equivalent we must show that given any error lin, we can find an m (depending on n) such that for all k > m, IXk-Zkl $ lin. But by the X-Y equivalence there exists ml (depending on n) such that for k > ml , IXk - Ykl < 1/2n. Similarly by the Y - Z equivalence there exists m2 (depending on n) such that for all k � m2, IYk - zk l < 1/2n. Thus by taking m to be the larger of ml and m2, for all k > m we have < by the triangle inequality for rationals. QED Notice that this formal proof is a little artificial in the choice of 1/2n as the error in the first two estimates, which leads to the final estimate with an error of lin. Alternatively, we could have started with the estimates IXk - Yk l < lin and IYk - zkl < lin and come up with the conclusion that IXk - zki < 21n for all k > m and then remarked that we can obtain the desired conclusion by a change of variable. Either form of proof is acceptable. Notice that the idea behind this simple proof is that if x is close to Y and y is close to z, then x is close to z. The triangle inequality gives this idea quantitative form, and then it is inserted into the universal-existential-universal form of sentence that defines equivalence. This proof is a simple prototype of many of the proofs we will be seeing and so I have somewhat belabored the point. 36 Chapter 2 Construction of the Real Number System Eventually the steps involved in constructing the formal proof from the idea of the proof, or conversely in extracting the idea of the proof from the formal proof, should become routine (except that ideas of proofs are often quite subtle and difficult). We can now proclaim the formal definition of the real number sys­ tem: Definition 2.1.1 Let C denote the set of all Cauchy sequences Xl, X2, ••• of rational numbers, and let lR denote the set of equivalence classes of elements of C . We call lR the real number system, or the reals, for short, and the elements x of lR (which are equivalence classes of Cauchy se­ quences of rationals) are called real numbers. We will also say that a particular Cauchy sequence in the equivalence class x converges to x or has x as a limit. One should not get too hung up on the formal nature of this defini­ tion. Although we have defined the real number x to be the equivalence class of Cauchy sequences, this is largely a linguistic convention. We could equally well think of the particular Cauchy sequences as specify­ ing the real number, or labelling it, with the different elements of an equivalence class providing different labels for the same number. We could also try to pick out a particular Cauchy sequence from each e­ quivalence class, and in fact we will do this when we discuss the infinite decimal expansions. From the point of view of the mathematics that results, all these approaches are equivalent. Quite frankly, no mature mathematician thinks of an equivalence class of Cauchy sequences of rationals every time the word \"real number\" appears. This definition, or any equivalent one, is merely a device to begin studying the proper­ ties of the real number system; the properties of the system eventually lead to the individual mathematician's mental conception of the real numbers. Since we have as yet no properties in sight, we had best not linger on the linguistic conventions of the definition. We want to think of the reals as an enlargement of the rationals, so we want the rationals to form a subset of the reals. This is not strictly speaking the case in our formal definition, but we have the informal idea that the rational number r should be the limit of the Cauchy sequence r, r, ... , and so we should attempt to identify the rational number r with the real number which is the equivalence class of r, r, . . .. To make �. 1 Cauchy Sequences 37 this identification at this stage requires only that we verify that distinct rationals r ¥= s are identified with distinct reals (r, r, . . . not equivalent to s, s, . . . ) . This verification is simple, since r =1= s implies there exists N with I r-sl > liN by the axiom of Archimedes for rationals, and this prevents r, r, . . . from being equivalent to s, s, . .. . The identification also brings with it a future committment to consistency: whenever a property or operation is defined for the reals that is already defined for the rationals, the two definitions must coincide on the rational subset of the reals. Fortunately, this will never be difficult to verify. 2.1.3 Exercises 1. Show that there is an uncountable number of Cauchy sequences of rational numbers equivalent to any given Cauchy sequence of rational numbers. 2. Show that every real number can be given by a Cauchy sequence of rationals rl , r2, . . . , where none of the rational numbers rl , r2, .. . is an integer. 3. What kinds of real numbers are representable by Cauchy sequences of integers? 4. Suppose Xl , X2, •.• and YI , Y2, ••• are two sequences of rational numbers. Define the shuffled sequence to be Xl , YI , X2, Y2, ••• . Prove that the shuffled sequence is a Cauchy sequence if and only if Xl, X2,' •• and YI , Y2,'\" are equivalent Cauchy sequences. 5. Prove that if a Cauchy sequence Xl , X2, ••• of rationals is modified by changing a finite number of terms, the result is an equivalent Cauchy sequence. 6. Give a proof that any infinite decimal expansion ±N.al, a2 , a3 , ... gives a Cauchy sequence ±N, ±N.a., ±N.aI, a2, . . .. 7. Show that the Cauchy sequence .9, .99, .999, . . . is equivalent to 1, 1, 1, ... . 8. Can a Cauchy sequence of positive rational numbers be equivalent to a Cauchy sequence of negative rational numbers? 38 Chapter 2 Construction of the Real Number System 9. Show that if Xl, X2, ••• is a Cauchy sequence of rational numbers there exists a positive integer N such that Xj � N for all j. 2.2 The Reals as an Ordered Field 2.2.1 Defining Arit hmetic To begin the justification of the definition of the real number system that we have chosen� we want to transfer the basic properties of order and arithmetic from the rationals to the reals. The basic idea for accomplishing this is to work term-by-term on the Cauchy sequences of rationals. This requires a certain amount of detailed checking that everything makes sense and is well defined. Let us consider addition first. What should X + Y mean if x and Y are real numbers? Suppose Xl , X2, ••• is a particular Cauchy sequence of rational numbers in the equivalence class that defines x, and similarly let YI , Y2 , \" . be a Cauchy sequence of rationals that represents y. Recall our intuition that the terms Xk in the first sequence are approximating x. Shouldn't Xk + Yk then approximate :x + y? Surely this is what working term-by-term suggests. But is this a reasonable definition? The sequence X l +YI , x2 + Y2 , ••• is clearly a sequence of rationals, but is it a Cauchy sequence? Presumably it is, but this is the first thing we have to check to determine if the definition makes sense. The second thing we have to check is more subtle but equally important. We chose particular Cauchy sequences XI , X2 , ••• and YI, Y2 , ••• out of the equivalence classes defining X and y. Suppose we chose different ones, i.e., x� , x2 ' ... , equivalent to Xl, X2, ••• d I I • al t t . ld I + I I + I th b an YI ' Y2 , ... eqUlv en 0YI,Y2 , · ·· ,wou X l YI' X2 Y2\" \" en e a Cauchy sequence equivalent to Xl + YI , X2 + Y2 ,\" '? This is certainly necessary if the sum x+y is to be well defined as the equivalance class of Xl + Yb X2 + Y2 ,· .. . To summarize: when defining an operation on real numbers, we need to verify first that the operation preserves Cauchy sequences of rationals and then to verify that it respects equivalence classes. Lemma 2.2.1 a. Let Xl , X2 , ••• and YI , Y2, • .• be Cauchy sequences of rationals. Then Xl + YI , X2 + Y2 ,' .• is also a Cauchy sequence of rationals. 2. 2 The Reals as an Ordered Field 39 b. In addition, let x� , X2, . . . be a Cauchy sequence of rationals e­ quivalent to Xl , X2, ••. , and let Y�, !h\" \" be a Cauchy sequence of rationals equivalent to Yl, Y2, . .. . Then x� + Y�, x2 + Y2' ... is equivalent to Xl + YI , X2 + Y2, .. .. Proof: The argument is very similar to the proof of the transitivity of equivalence given in the last section. For part a, given any error lin, there exists ml such that IXj - xk l < 1/2n for j, k > ml and there exists m2 such that IYi - Yk I < 1/2n for j, k > m2, because Xl , X2, .. . and YI, Y2, . .. are Cauchy sequences. Then by taking m to be the larger of ml and m2, we have for j, k > m. For part b, given any error lin, there exists ml such that IXk-X�1 < 1/2n for k > ml and there exists m2 such that IYk - Y�I < 1/2n for k > m2, because of the equivalence of Xl , X2, ... and xl ' x2\" \" and the equivalence of YI , Y2, ... and �, y�, .. . . If we take m to be the larger of ml and m2, then we have for k > m. QED Definition 2.2.1 The real number X + Y is the equivalence class of the Cauchy sequence Xl +YI , X2 +Y2, .. . , where Xl , X2, . .. represents X and YI , Y2, ..• represents y. By the lemma, Xl + YI , X2 + Y2, ..• is a Cauchy sequence and the equivalence class depends only on X and y and not on the particular Cauchy sequences Xl! x2, ... and Yll Y2, ..• chosen. The story for multiplication is similar. We want to define X· Y as the equivalence class of Xl Yl , X2Y2� ... . Why is this a Cauchy sequence? Look at a typical difference XjYj - XJ..·Yk. We have information about Xj - Xk and Yj - Yk, so we write 40 Chapter 2 Construction of the Real Number System (t his is also the idea behind the formula for t.he derivative of a product). \\Yl' can make .T) - J:k and Yj - Yk small by taking j and k large. but we still have to control the factors Yi and Xk that multiply them. Note that we don't have to make both factors in a product small in order to make the product small; it is enough to make one factor small and the other bounded. Thus we need an upper bound for Y] and Xk , independent of j and k. Lemma 2.2.2 Every Cauchy sequence of rationals is bounded. That is, there exists a natural number N( depending of the sequence X l, X2, ... ) such that for all k, IXk l < N. Proof: By the Cauchy criterion there exists m such that IXj -xkl < 1 for j, k � m. If we choose N larger than IXm l + 1, then IXj l I(xj - xm ) + xm l � IXj - xm l + IXm l < IXm l + I <N for all j > m. If we also take N greater than IXI I , ... , Ixm-d, then we will trivially have Ix j I � N for j < m. This imposes only a finite number of conditions on N, so such a number can be found. QED Lemma 2.2.3 a. Let x I, X2 , . .. and YI , Y2, . .. be Cauchy sequences of rationals. Then XIYb X2Y2, ... is also a Cauchy sequence of rationals. b. In addition, let x'I ' X� , ••• be a Cauchy sequence of rationals e­ quivalent to Xl, X2, . . . , and let Y� , Y2 ' ... be a Cauchy sequence of rationals equivalent to YI , Y2 , . . .. Then x� Y� , x2Y2' ... is equivalent to XI Yl , X2Y2 , ... . Proof: a. Given any error lin, there exists (as before) m such that IXj - xk l � lin and IYj - Yk l < lin for all j, k > m. Also by the previous lemma there exists N such that Ix j I < N and Iy] I < N for j. Note that N is fixed once and for all and does not depend on n. This is crucial, for we have IXj Yj - XkYkl IYj (xj - Xk) + Xk (Yi - Yk) l < IYj Ilxj - xk l + IXkllYj - Ykl 1 I 2N < N· - + N· -=- n n n 12. 12 The Reals as an Ordered Field 41 for all j, k > m. By a change of variable (replacing m by m' determined by 2Nn rather than n) we have IXjYj - XkYk l < lin for all j, k > m' , which proves that XIYl, X2Y2 , ... is a Cauchy sequence. b. Let N be an upper bound for all four Cauchy sequences. Given any error lin, we use the equivalence of Xl, X2, . .. and xl' x�, . .. to find ml such that IXj - xj l < 1/2Nn (guess why this choice!) if j > ml and similarly find m2 such that IYj - yj I < 1/2Nn if j > m2 . Taking for m the larger of m I or m2, we have IXjYj - xjyj l IYj (xj - xj ) + xi (Yj - yj)1 < IYjllXj - xi i + Ixi llYj - yj l 1 1 1 < N · -+ N-= - 2Nn 2Nn n for all j > m, proving the equivalence of Xl Yl , X2Y2, . •. and xl y� , x2Y2' .... QED Definition 2.2.2 The real number X • Y is the equivalence class of the Cauchy sequence XIYI , X2Y2, .. . , where x}, X2, . .. and YI , Y2 , ... respec­ tively represent X and y. 2.2.2 The Field Axioms We have now defined an arithmetic of real numbers. The rational numbers being identified with a subset of the real numbers, we should check that the arithmetics are consistent; that is, if we add the rationals r and 8 as rationals, r + 8, we get the same real number (r + 8, r + 8, ..• ) as we get by adding the real numbers r, r, .. . and s, s, ... . Clearly this is trivially true. Less trivially, we want the arithmetic of the reals to have all the properties of arithmetic of rationals. These properties are exactly the field axioms (and their consequences) . Recall that a set F with two operations X + Y and X • Y defined is called a field if the following axioms hold: i. addition is commutative (x + y = Y + x) and associative ((x + y) + z = x + (y + z)}. ii. there exists an additive identity 0, such that 0 + x = x. iii. every element x has a negative -x, such that -x + x = 0 (this implies that subtraction is always possible, x - Y being x + ( -y)). 42 Chapter 2 Construction of the Real Number System iv. multiplication is commutative and associative. v. there exists a multiplicative unit 1 (distinct from 0) , such that 1· x = x. VI. every element x except 0 has a reciprocal x-I , such that x-I . X = 1 (this implies that division by non-zero numbers is always possible). vii. multiplication distributes over addition, X· (y + z) = x . y + x . z. Theorem 2.2.1 The real numbers form a field. Proof: Clearly the zero is the equivalence class of 0, 0, ... , and the one is the equivalence class of 1, 1, .. .. Almost all the field axioms are trivial to establish and entail little more than quoting the analogous axiom for the rationals. The exception is axiom vi, the existence of reciprocals, so let us go into the details. Intuitively it is clear that we want to define X-I by xII, x; I, ... if x is defined by Xl , X2, .... We meet here a preliminary obstacle in that x j I is not defined if x j = O. Even supposing this is never the case, we will need to verify that xlt, x;-I, ... is a Cauchy sequence. For this we will need to estimate the difference x j 1 - x; 1 , knowing that x j - X k is small. Now we have xj 1 - x;l = xj1x;1 (Xk - Xj), so again we are in the situation of having a product in which one factor is small. We need to show that the other factors are bounded. Thus we need an upper bound for x j 1 or equivalently a positive lower bound for x j. The piece of information that we have at our disposal, and which we have not yet used, is that x is not zero, which means Xl , X2, . . . is not in the equivalence class of zero. This property, which we will be able to identify later as the axiom of Archimedes, we formulate as a separate lemma. Lemma 2.2.4 Let x be any real number different from zero. Then there exists a natural number N such that for every Cauchy sequence Xl, X2, •.. in the equivalence class of x, there exists m such that IXj l > 1/ N for all j > m. The number m of exceptions will depend on the particular Cauchy sequence, but the lower bound l/N will not. Proof: What does x#-O mean in terms of a particular Cauchy sequence Xl! X2, ... in the equivalence class x? We need to form the negation of the statement that XI , X2, . . . is equivalent to 0, 0, ... ; in 2. 2 The Reals as an Ordered Field 43 other words, the negation of the statement: for all n there exists m such that j > m implies IXj I < lin. The negation is: there exists n such that for all m there exists j > m such that IXj l > lin. This is close to what we want but not quite right. We want the estimate IXj l > liN to hold for all j > m, not just for an infinite set of j's (\"for all m there exists j > m\" is equivalent to \"for an infinite set of j's\" ). To get this added information we need to use the fact that Xl, X2, ••• is a Cauchy sequence, a fact we have not yet used and without which the conclusion is false (as in the sequence 0, 1, 0, 1, 0, 1, . .. ) . The Cauchy criterion makes the terms eventually all become close together, so we can't have an infinite number satisfy IXj I > lin without all but a finite number satisfying a slightly weaker estimate, say IXi I > l/2n. To make this precise, we use the Cauchy criterion with error 1/2n: there exists m such that for all j, k > m, IXj - xk l < 1/2n. By then choosing one particular value of j > m such that IXj I > lin, which we know exists by the first step of the proof, we have IXk l = I(:rk - Tj ) + xj l 2: I.Tj l - lxk - xjl 1 1 1 >- - -=­ - n 2n 2n for all k > m. (Note the use of the transposed-triangle inequality la - bl > lal- Ibl·) This establishes the desired estimate with N = 2n for each par­ ticular Cauchy sequence in the equivalence class. However, it is not yet clear that we can find a single value for N that will work for all Cauchy sequences in the equivalence class. To see this we need one more observation: if there exists m such that IXj l > liN for all j > m and if x�, x2' . .. is equivalent to Xl, X2, ••• , then there exists m' such that Ixil > l/2N for all j > m'. This will complete the proof since once we have the lower bound liN for one representative Cauchy se­ quence, we obtain the lower bound l/2N for all Cauchy sequences in the equivalence class. To establish the observation we need only choose m' greater than m such that Ix j - xj I < 1 I 2N for all j > m' (using the equivalence of the sequences), and then IXil - I (xj - Xj) + xj l > IXi l - lxj - xj l 1 1 1 > -- - = - N 2N 2N 44 Chapter 2 Construction of the Real Number System for all j > m'. QED Having completed the proof of the lemma, we return to the proof of the theorem, namely the existence of x- I. Let Xl, X2, . . . be a Cauchy sequence representing x. By the lemma, all but a finite number of terms are non-zero. If we modify all the zero terms, say replace them by ones, we get an equivalent sequence. Assuming this done (without changing notation), we can form the sequence of rationals xI I, x2\" I, .... As before we need to show two things: i) it is a Cauchy sequence, and ii) the equivalence class of xI I, x2\" I, . .. does not depend on the particular choice of Xl , X2 , . ... To prove it is a Cauchy sequence we let N be the natural number given by the lemma. Then for any given error l/n, there exists m such Ix) - xk l < l/N2n for all j, k > m, since Xl , X2, .•. is a Cauchy sequence. If we also choose m large enough so that IXj I � l/N for all j > m as the lemma asserts we can, then for j > m we have Ixj lx; I(Xk - x) ) 1 < Ixj l l lx; ll lxk - x)1 1 1 < .TV · N . N2 = - , n n -1 -1 . C h so Xl 'X2 , ••• IS a auc y sequence. If x� , x2' . .. is any equivalent Cauchy sequence (again assuming that a finite number of terms are modified if necessary so that all x� are non- ) h h t ' - 1 '-1 . . I t -1 - 1 zero , we want to s ow t a Xl 'X2 , •.• IS eqUlva en to Xl ' X2 , . . .. Again we choose N as in the lemma; then given l/n we choose m so that IXj - xj l < l/N2n for all j � m (the equivalence of X I ,X2, . .. and x� , x2 ' ''' ) and also so that IXj I > l/N and Ix� I > 1/1\\1 for all j � m. Then for all j > m we have I - 1 '-1 1 X · - X· 1 ) < We have thus constructed a unique real number x-I for every non­ zero X, and it is clear that x- I . X = 1 by multiplying xI I, x;- l , ... and Xl, X2, ••• directly. QED 2. 2 The Reals as an Ordered Field 45 2.2.3 Order Having established the field axioms for the real number system, we have completed the transference of arithmetic from the rationals to the reals, since all the usual facts of arithmetic are consequences of the field axioms. We turn next to the concept of order. Every rational number is either positive, negative, or zero (only one of the above!); and for two rational numbers r and s, we say r > s, r < 8, or r = 8 according to if r - 8 > 0, r - 8 < 0, or r - 8 = O. For the real numbers we want a similar ordering, and the first step is to decide for each real x whether x > 0, x < 0, or x = O. Clearly it is tempting to say x > 0 if Xj > 0 for all j where Xl , X2,.\" is a Cauchy sequence of rationals representing x. But there are some troubles with this idea, since it depends on the particular choice of Cauchy sequence-a modification of say the first term to Xl = -1 will spoil things without changing the number x. We might then be tempted to try the condition: there exists m such that Xj > 0 for j > m. But there is still a problem here, since the sequence 1, 1/2, 1/3, ... represents zero but still satisfies the condition. Thus while the condition might well be necessary for positivity (in fact it is), it is not sufficient. To understand the difficulty better, let's look at the two-dimensional picture, both for the sequence 1, 1/2, 1/3, ... and for a general sequence representing a point above the x-axis, as shown in Figure 2.2. 1. 113 112 1 1 Figure 2.2. 1: Notice that in the second picture we can slip a rectange under the graph. If the height of this rectangle is liN and the base is the interval [0, 11m], then we are saying Xj > liN for all j > m (we could 46 Chapter 2 Construction of the Real Number System equally well say x j > liN by replacing N by N + I). You should think of this condition as showing that the tail of the sequence is bounded away from zero; this is a stronger condition than merely being positive since it asserts that the separation from zero remains greater than a fixed amount liN for all the terms beyond the m-th (of course for an individual number there will be no distinction between being positive and being bounded away from zero, as we will show in the proof of the axiom of Archimedes). Definition 2.2.3 A real number x is said to be positive if there ex­ ist natural numbers N and m such that Xj > liN for all j > m, where Xl, X2, •.• represents x. The number m depends on the partic­ ular Cauchy sequence, but the number N does not (the proof of the previous lemma shows that once we have verified the condition for one Cauchy sequence, it is valid for all equivalent ones) . A real number x is called negative, X < 0, if -x is positive. Note that if X is rational, these definitions are consistent with the definitions of positivity and negativity for rational numbers, since the rationals satisfy the axiom of Archimedes. Theorem 2.2.2 Each real number is either positive, negative, or zero, but only one of the three. The sum and product of positive numbers are positive. Remarks A field with a notion of positivity with the properties given by this theorem is called an ordered field. Thus the reals are an ordered field. Proof: Zero is not positive, as the Cauchy sequence 0, 0, ... clearly shows. Since -0 = 0, zero is not negative either. Let x be any non-zero number; we need to show that either x or -x is positive, but not both. Let Xl, X2, ••• be a Cauchy sequence representing x. By the previous lemma there exists N and m such that IXj I > liN for all j > m. But the signs of the rational numbers cannot keep changing, because each sign change produces a jump of at least 21N between terms and this would violate the Cauchy criterion. Thus by increasing m if necessary, we have either Xj > liN for all j > m or Xj < -liN for all j > m. In the first case x is positive, in the second case -x is positive, and both can't occur for the same x. Finally the verification that the sum or �. � The Reals as an Ordered Field 47 product of positive numbers is positive is essentially trivial, since the sum or product of the lower bounds will give lower bounds. QED We can use the concept of positive number to define inequalities for real numbers. Thus x > y means x - Y is positive, x > Y means x > Y or x = y, Ixl < Y means Y - x and Y + x are positive, and so on. We define Ixl to be x if x > 0, -x if x < 0, and 101 = o. In verifying inequalities for real numbers it is convenient to be able to pass from inequalities involving the rational approximations; this requires that the inequalities be non-strict « or » but not strict « or ». For example, lin > 0, but the Cauchy sequence 1, 1/2, 1/3, . . . represents the number 0, and we do not have 0 > o. The next lemma gives the positive result. Lemma 2.2.5 Let x and y be real numbers defined by Cauchy se­ quences {Xk} and {Yk} of rational numbers. If Xk < Yk for all k > m, then x < y. Remarks The converse is not true (can you give a counterexample?). Proof: If not, then x > Yi so x - Y is positive. But then by the definition, Xk - Yk > lin for k large and some lin, contradicting Xk < Yk for all k > m. QED Basically all the properties of inequalities for rationals are true for reals. The next two are especially important. Theorem 2.2.3 ('1hangle inequality) Ix + yl < Ixl + lyl for real num­ bers x and y. Proof: Apply the previous lemma to the triangle inequality for ra­ tionals IXk+Ykl < IXkl+IYk l where {Xk} and {Yk } are Cauchy sequences of rationals defining x and y. QED The triangle inequality is frequently used in the form Ix - zl < Ix - yl + Iy - zl, in transposed form Ix - yl > Ixl -lyl, and for the sums of more than two numbers. Theorem 2.2.4 (Axiom of Archimedes) For any positive real number x > 0 there exists a natural number n such that x > 1 In. 48 Chapter 2 Construction of the Real Number System Proof: We have already shown that there exists n such that x j > I In for all j > m, where {x j } is a Cauchy sequence of rationals defining x. By the lemma this implies x > lin. QED This theorem is frequently used in the following form: if Ixl < lin for every natural number n, then x = O. The fact that the real numbers form an ordered field means that all the familiar algebraic identities, such as (x +y)2 = x2 +2xy + y2 , which only involve the operations of arithmetic, are valid for real numbers; and the same is true for inequalities such as x2 + y2 I x2 > 1. The reason for this is that such identities and inequalities are consequences of the ordered field axioms. We will use such \"facts\" freely from now on without special mention. In exercises 8 and 9 you will be asked to derive some of these facts from the axioms of an ordered field, and this will give you some confidence that the ordered field axioms are really sufficient to contain this aspect of elementary algebra. We conclude this section with a precise formulation of the density of the rationals in the reals. This is essentially built into the definition, since the Cauchy sequence of rationals {Xk} defining the real number x consists of rational numbers Xk that are approximating x, and the density of the rationals in the reals simply says that every real can be approximated arbitrarily closely by rationals. Theorem 2.2.5 (Density of Rationals) Given any real number x and error lin, there exists a rational number y such that Ix - yl < lin. Proof: Let {Xk } be any Cauchy sequence of rationals defining x. Given the error lin, there exists m such that IXk -xj I < lin if j, k > m. Choose y = Xm, so that IXk - yl < lin for every k > m. By the lemma we have Ix - yl < lin. QED 2.2.4 Exercises 1. Write out a proof of the commutative and associative laws for addition of real numbers. 2. Show that the real number system is uncountable and, in fact , has the same cardinality as the set of all subsets of the integers. 2. 2 The Reals as an Ordered Field 49 3. If x is a real number, show that there exists a Cauchy sequence of rationals Xl , X2, ..• representing X such that Xn < x for all n. 4. Let x be a real number. Show that there exists a Cauchy sequence of rationals x}, X2 , ..• representing X such that Xn < Xn+l for every n. 5. Prove that there are an infinite number of rational numbers in between any two distinct real numbers. 6. Let X he a positive real number. Prove that there exists a Cauchy sequence of rationals of the special form p2/ q2 , P and q integers, representing x. 7. Prove Ix - yl > Ixl - Iyl for any real numbers x and y. (Hint: use the triangle inequality) . 8. Prove the following identities from the field axioms: a. (x + y)2 = x2 + 2xy + y2. b. (x + a/x)2 - 4a = (x - a/x)2 , x # o. c. ax2 + bx + c = a (x + b/2a)2 + c - b2/4a. d. n � ( n ) k n-k ( n ) n! (x + y) = � k x y where k = k! (n - k)! ' 9. Prove the following inequalities from the ordered field axioms: a. x2 + y2/x2 > 1, x =F O. h. 2xy < x2 + y2. c. x/y > x if x > 0 and 0 < y < 1 . 10. Show that if a real number x can be represented by a Cauchy sequence of positive rationals, then x > 0. What does this tell you about real numbers that can be represented by two equiva­ lent Cauchy sequences of rationals, one consisting of only positive rationals and the other consisting of only negative rationals. 11. Prove that no real number satisfies x2 = -1. 12. Define x3 = x . x2. Prove that if x}, X2, .•• represents x, then 3 3 t 3 X l ' x2\" \" represen s x . 50 Chapter 2 Construction of the Real Number System 2.3 Limit s and Completeness 2. 3.1 Proof of Completeness At this stage in our development of the real number system, we have succeeded-with a lot of hard work-in arriving at about where we started. We have shown that the real number system is an ordered field. But the rational number system was also an ordered field. Now we need to show that we have really plugged up all the holes (such as 0) in the rational number system. This property is called completeness and can be succinctly described by saying that if we repeated the process whereby the reals were constructed from the rationals, starting instead from the reals, then we would not end up with anything new. Our construction of real numbers was based on sequences of ra­ tional numbers. We now want to consider sequences of real numbers Xl ;X2, X3, . . . . Here each Xj is a real number and so, strictly speaking, is a symbol that stands for an equivalence class of Cauchy sequences of rational numbers. Again I must emphasize the desirability of doing a bit of mental gymnastics: think of the real number Xj as a single entity (like a pebble) , and yet be capable at times of recalling the definition as an equivalence class of Cauchy sequences of rationals (the pebble is actually an amalgam of molecules, each of which is composed of atom­ s, each of which is composed of ... ) . We can now apply the Cauchy criterion to this sequence of reals: for every n there exists m such that IXj - xkl < lin if j, k > m. This is a meaningful statement since the inequality IXj - xk l < lin is meaningful for real numbers. A sequence of real numbers that satisfies the Cauchy criterion is called a Cauchy sequence. The intuition involved is the same as for the definition of Cauchy sequences of rationals: the terms of the sequence get closer and closer together as you go out in the sequence. Since not every Cauchy sequence of rational numbers had a limit that was a rational number, we were motivated to invent real numbers to be these limits. We do not have to invent any new numbers to be limits of Cauchy sequences of real numbers. To see this we need first to formalize the idea of limit. When is a real number x the limit of the sequence of real numbers Xl, X2, ••• ? Clearly when the terms Xk in the sequence get closer and closer to x. We can use the order of the reals to define the inequality IXk - xl < lin and, hence, the definition 2. 3 Limits and Completeness 51 of limit: x = limk_oo Xk if for every natural number n there exists a natural number m such that k > m implies IXk - x l < lin. Notice that while the limit of a sequence of real numbers need not always exist, if it exists it is unique. This is because if y were another limit, then we would have if k is large enough; hence, x - y = 0 by the Axiom of Archimedes. We should also verify, for consistency of notation, that if {Xk} is a Cauchy sequence of rationals defining x, then limk_oo Xk = x. Indeed, given the error lIn, we can find m such that j, k > m implies IXj -xk l < lIn, since {Xk } is a Cauchy sequence. But then j > m also implies IXj - xl < lIn, since this follows from IXj - xkl < lIn for all k large, which is what we have for k > m. Thus lim xj = x. Theorem 2.3.1 (Completeness of the Reals) A sequence xl, X2 , ••• of real numbers has a limit if and only if it is a Cauchy sequence. Proof: The fact that the existence of the limit implies the Cauchy criterion is trivial: if m is such that k > m implies Ix - xk l < lIn, then j, k > m implies IXj - xk l < 21n by the triangle inequality. The non-trivial part is the converse. Suppose then that the sequence Xl , X2, ••• satisfies the Cauchy cri­ terion. We need to construct the limit as a real number. This means we have to find a Cauchy sequence of rationals YI , Y2, ... to define Y and then prove limk_oo Xk = y. The idea is that we want to take for Yk a rational number close to Xk , say so close that IXk - Yk l < 11k. This is possible by the density of rationals. Then it is a simple matter to show that {Yk} is a Cauchy sequence. Given an error lin, choose m so that IXj - xkl < 1/2n for j, k > m (this is possible because {Xj } is a Cauchy sequence}. Then IYj - Yk l < IYj - xj l + IXj - xkl + IXk - Yk l 1 1 1 1 2 < -+-+- < -+­ i 2n k - 2n m ' 52 Chapter 2 Construction of the Real Number System which can be made less than lIn if m is chosen greater than 4n (there is no harm in increasing m). Thus {Yk} is a Cauchy sequence of rational numbers and, hence, defines a real number y. It remains to show limk_oo Xk = y. But again this is easy, since 1 Iy - xkl < Iy - Yk l + IYk - xkl < IY - Yk l + k ' Since Yl , Y2 , .•. represents y, we know that we can make IY - Yk I < 1/2n for k > m, and hence IY - xk l < 1/2n + 11k < lIn if m > 2n also. Thus limk_oo Xk = y. QED Next we state a theorem that summarizes the basic properties of limits. Essentially it says that limits preserve the arithmetic and order properties of real numbers. We have actually seen all these statements before in terms of Cauchy sequences of rational numbers. Theorem 2.3.2 a. If limk_oo x k = x and limk_oo Yk = Y, then lim (Zk + Yk) = Z + Y and lim (XkYk ) = xy. k-oo k-oo If in addition Y =F 0, then there exists m such that Yk #- 0 for k > m and limk_oo xklYk = xly. b. If Xk > Yk for all k > m, then x > y. We will not go through the formal proofs of these statements, as they are merely repetitions of arguments already given. Notice that in the case of the quotient, some of the terms xklYk may be undefined if Yk = 0, but since this cannot happen for k > m, it does not really matter. Also part b would not be valid with strict inequalities, since 11k > 0 but limk_oo 11k = O. 2.3.2 Square Roots We can illustrate the abstract ideas that we have been developing in a concrete example by discussing square roots. It was, after all, the square root of 2 that started the whole idea of irrational numbers. We can now show that within the real number system, all positive numbers have square roots. 2. 3 Limits and Completeness 53 Theorem 2.3.3 Let x be any positive real number. Then there exists a unique positive real number y such that y2 = X (we then write y = y'X) . Proof: It is easy to show uniqueness, for if also z2 = x, then y2 _z2 = o. But y2 - z2 = (y - z) (y + z); and since the reals form a field, we must either have y - z = 0 or y + z = o. Since both y and z were assumed positive, we must have y + z > 0, so Y - z = 0 and hence y = z. To prove existence we use a method that we call divide and conquer. This is an idea we will use many times in the pages to come. We start by finding two numbers Yl and ZI such that y = ..jX lies between them. This is easy. If x > 1, then x2 = x + x(x - 1) > x since x(x - 1) > O. From 1 < x < x2 we would expect to have 1 < y < x if y = ..jX. Thus we set Yl = 1 and ZI = x. (Similarly, if 0 < x < 1, we can take Yl = x and ZI = 1, because x2 < x < 1. If x = 1 we can take y = 1 and we are done.) Note that we are not claiming to have proved Yl < Y < ZI (this does not make sense because we have not yet constructed y), but we have proved y� < x < z� , which is intuitively an equivalent statement. Now we divide and conquer. The interval Yl to ZI has midpoint ml = (Yl + zt) /2. We choose the next interval Y2 to Z2 to be either the left (Yl to ml ) or the right interval (ml to ZI), depending on the relative size of m� and x. If m� > x we take Y2 = Yl and Z2 = m}, while if m� < x we take Y2 = ml and Z2 = ZI (if m� = x, then y'X = ml and we're done) . The two possibilities are illustrated in Figure 2.3.1. The point of this choice is that we still have y� < x < z�, • Yl • Yl II Y2 • ml II Y2 • ml II Z2 • • ZI y2 I II Z2 • • Zl y2 I II y2 2 Figure 2.3.1: • • • m2 x Z2 I I II II y2 Z2 2 2 • • • x m2 Z2 I I II Z2 2 but we have divided the distance between Yl and ZI in half when we pass to Y2 and Z2. Now we iterate; in other words, we repeat the process of going from Yl, ZI to f/2, %2 but starting with 1/2, z2 to obtain t/3, Z3 (so 54 Chapter 2 Construction of the Real Number System m2 = (Y2 + z2)/2 and either Y3 = m2 and Z3 = Z2 if m� < x or Y3 = Y2 and Z3 = m2 if x < m�), and then Y4, Z4, and so on. We repeat the process of dividing infinitely often (unless we happen to hit � exactly at one of the midpoints) . In this way we obtain two sequences Yl , Y2, ... increasing and Zl , Z2, •.. decreasing such that a. y� < x < z� for all k, and b. Zk - Yk = (Zl - yd/2k-1• Now we claim that Yb Y2, ... and Zl , Z2 , ... are Cauchy sequences and that they are equivalent. This is easy to see. Given an error lin we take m large enough that (Zl - yd/2m-1 < lin. Then by condition b, o < Zm - Ym < lin, and all Yk and Zk for k > m lie in the interval from Ym to Zm. Thus IYj - Yk l < lin, IZj - zk l < lin, and IYj - zk l < lin for j, k > m. This proves the claim. Let Y be the real number equal to the common limit of these two sequences. Passing to the limit in a yields y2 < X < y2, which implies y2 = x. QED The divide and conquer algorithm is not very efficient, since at each iteration we only cut the error in half. To reduce the error by 10-3 would require 10 iterations. In exercise 6 the reader is invited to give a different proof based on the more efficient algorithm described in section 2.1.1. However, the proof is much trickier. Of course you still cannot take square roots of negative numbers within the real number system; to do this it is necessary to enlarge the system still further to the complex numbers. We will discuss this extension later. For now we will just point out that it is rather dif­ ferent from the extension rationals -+ reals in at least two important ways. The first way is that it is algebraic, not involving infinite process­ es. The second is that the complex number system has a completely separate interpretation and intuitive image, whereas both the real and rational number systems have a common intuitive basis in the idea of magnitude. 2.3.3 Exercises 1. Write out a proof that limk_oo (Xk +Yk) = x + y if limk_oo Xk = x and limk_oo Yk = Y for sequences of real numbers. 2. 9 Limits and Completeness 55 2. Prove that every real number has a unique real cube root. 3. Let Xl, X2,. ' • be a sequence of rea1 numbers such that IXn l < 1/2n, and set Yn = Xl + X2 + ... + Xn. Show that the sequence Yl , Y2 , ... converges. 4. Let ax2 + bx + c be a quadratic polynomial with real coefficients a, b, c and positive discriminant, b2 - 4ac > O. Prove that -b ± ,,1)2 - 4ac 2a are the unique real roots. 5. For every sequence ko, kb k2, ... of non-negative integers, let be the associated sequence of continued fractions. Prove that xo, Xl , X2, ••• is a Cauchy sequence of rationals and that every positive real number arises as a limit. 6. *Suppose X > 1, and define the sequence Yl , Y2, ... by Yl = X and Yk+ l = T(Yk) for T(y) = (y + x/y)/2. a. Show Y - T(y) = (y2 - x)/2y and T(y)2 - X = (y2 - x)2/4y2. b. Show 0 < Y - T(y) < (y2 - x)/2 and 0 < T(y)2 - X < (y2 _ x)2/4 for Y > 1 and y2 > X. c. Show 0 < Yk - Yk+l < (y� - z)/2 and 0 < Y�+l - :r; < (y� - x)2/4. d. Show that Yl , Y2 , ... is a Cauchy sequence and if Y = limk_oo Yk , then y2 = x. e. Show that if IY� - xl < 10-3, then IY�+l - xl < 10-6/4 and IY�+2 - xl < 10-13• 56 Chapter 2 Construction of the Real Number System 7. Prove that a > b > 0 implies Va > ..jb> O. 8. Prove that if limk_oo Xk = x and Xk > 0 for all k, then limk_oo ..;xk = JX. 9. Prove the completeness of the integers (every Cauchy sequence of integers converges to an integer). Why is this result not very interesting? 10. Prove that the irrational numbers are dense in 1R. 2.4 Other Versions and Visions 2.4. 1 Infinite Decimal Expansions We have now completed the basic task of establishing the real num­ ber system. Ahead of us lies the more challenging task of exploring the deeper properties of this system. But before plunging ahead, we should pause to consider some alternate ways we might have proceeded. First we will discuss other versions of the same system: infinite decimal ex­ pansions and Dedekind cuts. Then we will briefly discuss other visions, essentially different mathematical systems that offer a competing view of what the real number system should be. Let's consider infinite decimal expansions. From the decimal expan­ sion we obtain immediately a Cauchy sequence of rationals by truncat­ ing (if J2 = 1.414 ... , then 1, 1.4, 1.41, 1.414, ... is a Cauchy sequence of rationals defining '1'2). In fact we can say that an infinite decimal expansion is a special kind of Cauchy sequence of rationals, one for which Xk = n + �7=1 aj /loi where n is an integer and 0 < aj < 9 (for negative numbers this must be slightly modified). In fact it is trivial to verify that this is a Cauchy sequence since if k > m. A less trivial matter is the question whether every real number (defined by a Cauchy sequence of rationals) has an infinite decimal expansion. The naive approach to solving this problem would be to 120.4 Other Versions and Visions 57 write out the infinite decimal expansion of each rational number Xn in the Cauchy sequence defining x and to hope that these expansions eventually settle down to the expansion for x. Of course the example 1.1, .99, 1.01, .999, 1.001, .999, ... shows that this procedure may not al­ ways work. However, the key observation is that it can only fail for numbers like x = 1, which have two distinct infinite decimal expan­ sions. Such numbers are of the form m/10k; and since we know how to write infinite decimal expansions for them, we can use the naive procedure on all the other numbers. Thus assume x is a real number such that x \"# m/10k for any m or k. For simplicity let us assume x > O. Let Xl, X2, X3, ••• be any Cauchy sequence of rational numbers defining x. Consider the infinite decimal expansions of the rational numbers XI, X2,... . We want to show that eventually they all agree to any number of terms desired. For example, consider the first three terms n . al a2a3' The rational numbers r whose infinite decimal expansions begin this way are those satisfying the inequalities n + al /10 + a2/100 + a3/1000 < r < n + al/10 + a2/100 + a3/10OO + 1/1000 (what happens at the endpoint is a matter of convention). We want to show that eventually all the rational numbers Xk satisfy one such inequality, namely the one satisfied by x. Indeed x must satisfy such an inequality because we have assumed it is not of the form n + al /10 + a2/100 + a3/1000 (in more detail, choose the largest number of the form n.ala2a3 such that n.al a2a3 < x; then we must have x < n.al a2a3 + 1/1000 because x i= n.al a2a3 + 1/1000 and if we had x > n.al a2a3 + 1/1000, then n.al a2a3 would not be the largest) . We claim that the first three terms of the infinite decimal expansions of the rational numbers Xk are all n.ala2a3 for k sufficiently large. To do this we clearly need the following result. Lemma 2.4.1 If y < x < z for any three real numbers and if {Xk} is a Cauchy sequence 0/ rationals defining x, then there exists m such that y < Xk < z for all k > m. Proof: The idea of the proof is represented by Figure 2.4.1 where the brackets [ ] indicate an interval [x - l/n, x + l/n] that lies within the interval (y, z). By the axiom of Archimedes we can always choose the error l/n small enough to achieve this fit (since x - y and z - x 58 Chapter 2 Construction of the Real Number System • [ . ] • y x z Figure 2.4.1: are both positive by assumption, they must both be bounded below by l/n for some n, and these inequalities translate into the above picture) . Since limk_oo Xk = x, there must be an m such that Xk lies within the interval in brackets for all k > m, and hence y < Xk < z. QED Taking y = n.ala2a3 and z = n.ala2a3 +1/1000 in the lemma shows that all the infinite decimal expansions of the Xk beyond a certain point begin with n.ala2a3' In this way we can find any number of terms in the decimal expansion of x, so the infinite decimal expansion of x is defined unambiguously for every real number not of the form n + ��l aj /101 . However, there is one severe shortcoming to this procedure: there is no a priori bound for how far out in the sequence {Xk} you have to go before, say, al is determined. For example, suppose you know that for all j, k > mo , IXi - xkl < 1/100. Does this mean that the decimal expansions of all Xj for j > mo agree up to at? Well, it depends! If one such Xj is 1.427, then all the others must lie between 1.417 and 1.437 and so must begin 1.4. But if one such Xi is 1.4005, then all we can say is that all the others must lie between 1.3905 and 1.4105, so we don't know if the infinite decimal expansion begins 1.3 or 1.4. Futhermore, we cannot say in advance how accurately we need to control the variation in the Xj before we can decide between 1.3 and 1.4. All we know is that if we continue long enough, we will eventually get a decision (this is only true because we have assumed x is not of the form n + ��l aj/loJ ). We have now shown that every real number has an infinite decimal expansion. To complete the identification of the real number system with the system of infinite decimal expansions, we would have to define the arithmetic (addition and multiplication) of infinite decimals and the order relation x > y and show they agree with the arithmetic and order relation already defined for the real number system. This would actually be a rather noxious task, since we have to deal with the possibility of infinite carries. Thus we will have to be content with the 2.4 Other Versions and Visions 59 plausibility of the outcome. We will have no further need for infinite decimal expansions in this work. 2.4. 2 Dedekind Cuts· The other version of the real number system that we should discuss is the Dedekind cut construction. The method of Dedekind can actually be traced back to the work of the Greek mathematician Eudoxes, which is included in Euclid's text. It is based entirely upon the ordering of the rational numbers. The idea is that a real number x creates a division of the rational numbers into two sets: those greater than x and those less than x. If x itself is rational, then we have also to do something with Xj and by convention we can lump it with the big guys. Thus, assuming we have constructed a real number system, we want to associate to each real number x the set Lx of all rational numbers less than x. What kind of set is Lx? Clearly it contains some but not all rational numbers; and if r is in Lx, then every rational number less than r is also in Lx. The convention that x should not belong to Lx if x is rational means that Lx does not contain a largest rational number. It turns out that these properties characterize the sets of rational numbers that are of the form Lx . That is, any subset L of the rational numbers that satisfies: 1. L is not empty; 2. L is not all the rationals; 3. if r is in L and q < r, then q is in L; 4. if r is in L, there exists s in L with s > r must be Lx for some real x. Since we have already constructed the real numbers, we can prove this statement as a theorem. Dedekind's idea, however, was to use this proposition as a definition, and by means of it to construct the real number system. In other words, let us return to our initial position of knowing only the rational number system. It is certainly possible to think of sets of rational numbers L satisfying 1-4. Call such sets Dedekind cuts, and define the Dedekind real number system to be the set of all Dedekind cuts! We can identify the rational number q with the Dedekind cut Lq = {r rational: r < q} and so embed the rational number system. We can also 60 Chapter 2 Construction of the Real Number System define arithmetic and order on Dedekind cuts. For example, Ll + L2 is the cut L consisting of all rationals of the form r1 + r2 where rl is in Ll and r2 is in L2 (multiplication, alas, is more tricky to define, because the product of two negative numbers is positive-it requires a segregation according to sign). Of course such a definition requires a proof that L is actually a cut and that Lql + Lq2 = L(ql +q2) if ql and q2 are rationals so that the sum for rationals agrees with the sum for cuts. The order relation L1 < L2 is the same as containment, L1 C L2. One can then show, with some work, that the Dedekind real number system is a complete ordered field. What we want to see now is that the Dedekind real number system is identical to the real number system that we have constructed. We have already seen how to associate a Dedekind cut Lx to a real number x. The fact that distinct real numbers x i= y give rise to distinct cuts Lx #- Ly is just the observation that there exist rational numbers in between x and y-a fact we observed as a consequence of the axiom of Archimedes. The fact that every Dedekind cut is of the form Lx, which we mentioned but have yet to prove, will show that the correspondence x -t Lx is onto. So let L be a Dedekind cut; that is, a subset of the rational numbers satisfying the properties 1-4. We want to find a real number x such that L = Lx. The idea of the proof is divide and conquer. We know from the first two properties of L that there is at least one rational, call it PI , in L, and at least one rational ql , not in L. Now ql > PI by property 3, and clearly x (if it exists) must lie in between, as shown in Figure 2.4.2. • • • PI x Figure 2.4.2: Consider the midpoint (PI + qt ) /2. If it lies in L, then x (if it exists) must lie between it and ql, as shown in Figure 2.4.3; whereas if it does not lie in L, then x (if it exists) must lie between PI and it, as in Figure 2.4.4. 2.4 Other Versions and Visions 61 • • • • PI (PI + ql )/2 x ql II II P2 q2 Figure 2.4.3: • • • • PI X (PI + q/ )12 ql II II P2 q2 Figure 2.4.4: In the first case let 112 = (PI + ql ) /2 and q2 = ql , and in the second case let P2 = Pl and q2 = (Pl + ql )/2. In other words we replace one of the two points Pl or ql by the midpoint and leave the other alone. In this way we still have 112 in L and q2 not in L, but the gap between PI and ql has been halved. We then repeat the process, dividing the interval P2 , q2 in half and choosing for 1'3, q3 the half such that 1'3 is in L and q3 is not in L. Repeating the process indefinitely we obtain sequences PI ,P2, .. . and ql , C/2, ••• of rationals. It is easy to see that these are Cauchy sequences; and they are equivalent, so define a real number z. It seems plausible that for this z, Lx = L. Let us in fact prove it. Remember that Lx was defined as the cut consisting of all rational numbers less than z. L was the cut with which we started. Suppose q is a rational number in L. Why is q in Lx? Here we have to use property 4. There exists r in L greater than q. Eventually the sequence Pb P2, •.. must exceed r (whatever the initial distance ql - r, the distance qlc - Pic must eventually be smaller-since it is halved at each step-and so Pic > r, as shown in Figure 2.4.5) . • • • • • q r Pic Figure 2.4.5: 62 Chapter 2 Construction of the Real Number System From Pic > r for all large k we obtain x > r and so x > q. This says q is in Lx . Conversely suppose q is in Lx i i.e., q < x. We want to show q is in L. We claim q < Pic for some k, for if not, then q > Pic for all k and hence q > x, contradicting q < x. Thus q < Pic and so q is in L by property 3. This shows L = Lx and so establishes a one-to-one correspondence between the real numbers and the Dedekind cuts. Of course to show that the two number systems are the same we have to verify that the arithmetic operations and ordering relations agree. For example, is the cut L(x+y) associated with the real number x + y the same as the sum Lx + Ly of the cuts associated with the numbers x and y? Remember that L(x+y) = {rationals q < x +y} while Lx + Ly = {rationals q = ql +q2 where ql < x and 112 < y}. Clearly Lx + Ly � L(x+y) because if ql < x and 112 < y, then ql + q2 < X + y. For the reverse inclusion we need to see that if q is a rational number less than x + y, then it can be written q = ql + q2 where ql and q2 are rational numbers with ql < x and q2 < y. But by the axiom of Archimedes x + y - q > l/n for some n , so if we take ql any rational such that x - 1/2n < ql < x, then q2 = q - ql is less than the largest value for q, which is x + y - l/n, minus the small value q} , which is x - 1/2n, as shown in Figure 2.4.6. In other words, by making ql closer to x than q is to x + y, this forces • • Figure 2.4.6: fJ2 = q - ql to be less than y. • • q x +y The argument for products is similar, although more complicated, while the argument for the order relations is extremely simple (can you . ·t?) gIve 1 •• Thus the method of Dedekind cuts gives a third version of the same real number system. Comparing it to the method of Cauchy sequences, we can see some advantages and disadvantages. The main advantage of the Dedekind cut method is that it involves less set theory: we only have to deal with a countable set of rationals and its power set-the. set 12.4 Other Versions and Visions 63 of subsets of the rationals. For the Cauchy sequence method we have to deal with equivalence classes of Cauchy sequences, involving sets of sets of rationals, just to get a single real number. On the other hand, we are going to have to deal with the concept of Cauchy sequences eventually, whereas the concept of a Dedekind cut is not of much significance once the real number system is established. But the most compelling argument in favor of the Cauchy sequence method must look to the future. The construction of the reals from the rationals via Cauchy sequences is a proto-type of a general con­ struction that is used frequently in mathematics. Thus there is an advantage to becoming familiar with this construction in its most con­ crete example. (It is also true that there are some constructions in mathematics that are generalizations of the method of Dedekind cuts, but these are less frequently encountered. Probably, a well-educated mathematician should be familiar with both approaches.) 2.4.3 Non-Standard Analysis· We have constructed the real number system in which the Axiom of Archimedes is valid-there is no positive number less than 1/ n for all n. Another way of saying this is that there are no infinitesmals. Nev­ ertheless, there is a body of informal mathematics that is based on the concept of infinitesmals. We know that many of the mathematicians who contributed to the development of the calculus during the seven­ teenth and eighteenth centuries believed that the true foundations of the subject should be based on infinitesmals; and even after the gen­ eral acceptance of the non-infinitesmal foundations in the nineteenth century, the use of infinitesmals in informal or heuristic arguments per­ sisted. It would seem plausible, then, that there should exist a logically satisfactory foundation for analysis based on infinitesmals. Such a foun­ dation was finally discovered around 1960 by Abraham Robinson, who called it non-standard analysis. The reason it took so long to discover is that it is a rather sophisticated mathematical system, requiring a strong background in mathematical logic and general topology in or­ der to be understood. While I cannot begin to describe this system precisely here, I can give some indication of its general features. We start with the real number system R, and we enlarge it to the non-standard real number system .R, which contains, in addition to real 64 Chapter 2 Construction of the Real Number System numbers, infinitesmal numbers and infinite numbers (the reciprocals of the infinitesmals). The general finite number in *R is the sum of a real number and an infinitesmal. The real number is uniquely determined by the finite non-standard number and is called its standard part. Thus we have the mental picture of the real line enlarged by surrounding each real point by a cloud, or galaxy, of infinitesmally close points. The cloud about the point 0 is the set of infinitesmals, and the reciprocals of this cloud form the infinite non-standard numbers. The set of infinitesmals is uncountable; in fact, it has cardinality equal to the set of subsets of real numbers, which is greater than the cardinality of the real numbers. Every concept involving real numbers has an extension to the non­ standard real numbers, and every true statement about the real num­ bers is also true about the non-standard real numbers, if properly inter­ preted. For example, the non-standard real numbers form a complete ordered field. However, the interpretation of statements in the non­ standard real numbers requires a great deal of caution. For example, consider the Axiom of Archimedes. Since the non-standard real num­ bers contain infinitesmals, numbers x > 0 such that x < 1, x < 1/2, x < 1/3, .. . , it is clear that the Axiom of Archimedes in its usual interpre­ tation is false for *R. Nevertheless, since the Axiom of Archimedes is true for R, it must be true for *R in the appropriate interpretation. To find the appropriate interpretation we write out the statement formal­ ly: for every positive x in R there exists n in N (the natural numbers) such that x > lin. We then must substitute the non-standard version for everything-not just x in 1R but also n in N. There is a non­ standard notion of natural number, a subset * N of *1R that is larger than N. It contains infinite integers as well as finite integers. Thus the true interpretation is: for every positive x in *R there exists n in * N (the non-standard natural numbers) such that x > lin. IT x is an infinitesmal, then x > lin for some infinite integer n. The real power of the non-standard real number system is that es­ sentially all heuristic reasoning concerning infinitesmals can be made into valid logical proofs. For example, the derivative /' (x) can be com­ puted by forming the difference quotient(f(x + h) - f(x))lh when h is an infinitesmal and by taking the standard part of this non-standard real number (taking the standard part replaces the dubious practice of discarding infinitesmals in the final limit). Similarly, limits of infinite sequences Xl, X2, ' •• become the standard part of Xn for n infinite, and �.4 Other Versions and Visions 65 integrals can be interpreted as infinite sums of infinitesmals. Because the non-standard real number system encompasses valid methods of reasoning that were formerly thought of as merely plausible arguments, it has enabled mathematicians to prove theorems that they might oth­ erwise have not discovered. On the other hand, there are also several drawbacks to the non­ standard real number system that must be pointed out: 1. It is not unique. There are many non-standard real number sys­ tems ·R that are not equivalent to each other but work just as well, so there is no reason to prefer one to the another. Intu­ itively one would expect the real number system to be unique-of course, one first has to deal with the more serious problem of the non-uniqueness of set theory, but once a version of set theory is chosen the real number system 1R is uniquely determined. 2. The \"construction \" of *R (there are now several equivalent ones) involves the use of the axiom of choice in a more serious way than the \"construction\" of R. This is not to say that our \"construc­ tion\" of 1R is truly \"constructive\" . When we say there exists a Cauchy sequence of rationals ... we do not imply the existence of an algorithm for producing the rationals in the sequence. Our arguments also frequently use the countable axiom of choice-we assume that a countable number of unspecified choices can be made. However, the very definition of .1R requires the uncount­ able axiom of choice--simultaneously an uncountable number of unspecified choices must be made. This puts an additional level of abstraction between the intuition and the non-standard real number system. 3. Any theorem about the real number system that can be proved using the non-standard real number system can be proved without it. This is a meta-mathematical theorem; there is even a trans­ lation mechanism for taking a non-standard proof and replacing it with a standard one. In fact, the first well-known published theorem discovered using non-standard analysis was followed in the same journal by a \"translation\" so that mathematicians un­ familiar with non-standard analysis could follow the proof. From a practical standpoint, however, this is a rather trivial drawback, 66 Chapter 2 Construction of the Real Number System since we are interested in theorems whose proofs we can discov­ er rather than whose proofs exist. Since non-standard analysis is a proven aid to the discovery of proofs, it helps us learn more mathematics. 4. Non-standard analysis is more difficult than standard analysis to learn. We will take this drawback as the incontestable reason for ending this discussion of non-standard analysis. 2.4.4 Constructive Analysis* At the opposite philosophic pole to non-standard analysis, we find Er­ ret Bishop's theory, enunciated in his book Foundations of Constructive Analysis (Academic Press, 1967). The idea behind his work is that we have failed to make the distinction in meaning between \"there exists blah\" and \"there exists an algorithm for constructing blah\" . This fail­ ure is embedded in our logic, which allows us to pass in an argument from a constructive existence to a non-constructive existence. A simple example of this is as follows: let Xl, X2, ••• be the Cauchy sequence of rationals defined by Xn = 0 if every even number (> 4) less than n is the sum of two primes, while otherwise Xn = 11k where k is the first even number (> 4) less than n that is not the sum of two primes. Clearly there is an algorithm (involving finding all primes less than n, forming all sums of pairs, and comparing the list with all even numbers less than n) for computing Xn in a finite number of steps. The number this Cauchy sequence represents, call it X, is 0 if Goldbach's conjecture is true and X > 0 if Goldbach's conjecture is false. However, our proof that X = 0 or X > 0 does not provide us with an algorithm for deciding which case is true-for if it did it would provide us with an algorith­ m for settling Goldbach's conjecture. Such an algorithm might exist, but no one expects its discovery to be a routine consequence of real analysis. Thus the theorems proved in the standard theory of the real num­ ber system are lacking in constructive content. We don't know if things asserted to exist can actually be found, even if every hypothesis of the theorem is true constructively. If we are interested in the constructive content of our theorems we must initiate a new mathematical develop­ ment. Such a posteriori development is given by the theory of recursive 2.4 Other Versions and Visions 67 functions; however, the school of Bishop rejects this development be­ cause it allows too broad a notion of algorithm (a recursive sequence Xn consists of a finite set of instructions that enables you to compute Xn in a finite length of time given nj the problem is that there may not be a proof that the length of the computation is finite even though this is in fact the case). Instead, Bishop proposes that we begin a priori with only algorithmic existence and use a system of logic that allows us to deduce only algorithmic existence. He develops a substitute for the real number system, called the constructive real number system, and he is able to prove substitute constructive versions of the theorems in this book. The definition of the constructive real number system bears a su­ perficial resemblance to the definition of the real number system. It is based on Cauchy sequences of rationals, but with the additional re­ striction that there must be an algorithm for demonstrating the rate of convergence (Bishop uses the technical trick of requiring IXn - Xm I < lin + 11m for all his Cauchy sequences). However, the actual num­ ber system that results from this definition is radically different from the usual one. The most striking distinction is that the act of doing mathematics actually changes the constructive real number system. The reason for this is that there is a large \"don't know\" category of sequence Xl, X2, ••• of rationals for which we neither have a proof of the Cauchy criterion nor a disproof. These sequences do not define constructive real numbers now. However, if tomorrow we discover an algorithmic proof that one of these does satisfy the Cauchy criterion, then that sequence defines a new constructive real number. Another way the system may change is that we may \"learn\" that two numbers X and y are really equal, if we discover an algorithmic proof that the Cauchy sequences defining them are equivalent. It is easy to dismiss the work of Bishop and his disciples as that of a group of reactionary religious zealots intent on bullying the mathe­ matical community into accepting its peculiar orthodox tenets. This is probably the attitude of most mainstream mathematicians, and it is aided and abetted by some overenthusiastic pronouncements from the constructivist school. However, I believe it is more valuable to look on this work as an interesting, and potentially fruitful, separate branch of mathematics. There is no doubt that the theorems of con­ structive analysis are legitimate mathematical discoveries, even when 68 Chapter 2 Construction of the Real Number System interpreted in conventional terms. They spell out in precisely what ways conventional statements can be made algorithmic. Of course it is the responsibility of constructive mathematicians to come up with mathematical discoveries that will be exciting and profound enough to capture the imagination of the larger mathematical community, if they want their work to be taken very seriously. Constructive analysis should not be confused with applied mathe­ matics, where the goal is not just algorithms but algorithms that can be carried out efficiently. Applied mathematics has not been notably influenced by the work of the constructivists. It has, on the contrary, benefitted greatly from mathematics developed in a completely non­ constructive spirit, which leads to the paradox that constructive math­ ematics may be best advanced by allowing free use of non-constructive reasoning. One can also argue that mathematics, as it develops, becomes pro­ gressively less constructive. Even the notion of \"construction\" has e­ volved from the purely finite notion in Greek mathematics (straightedge and compass) to the contemporary idea of an algorithm giving a finite set of instructions for obtaining successive approximations. Construc­ tivism can then be seen as a \"reaction\" to this \"progress\" . In the remainder of this book, we will freely use non-constructive ideas, although whenever possible we will give constructive demonstra­ tions because they usually convey more information. Thus when we assert that something exists, we do not necessarily imply that we have provided explicitly or implicitly a method for finding it. The reader who has misgivings about this may wish to study Bishop's work, but I recommend that this be done only after the non-constructive theory has been well digested. 2.4.5 Exercises 1. Let L be the set of all negative rational numbers and those positive rational numbers satisfying r2 < 2. Show that L is a Dedekind cut that represents the number J2. 2. If A is a set of real numbers and Lx is the Dedekind cut associated with each x in A, show that the union of all the cuts Lx is itself either a Dedekind cut or the set of all rationals. 2. 5 Summary 69 3. If x and y are positive reals, show that Lry consists of all non­ positive rationals and all positive rationals of the form r s where r and s are positive rationals in Lx and Ly • 4. Give a simple non-constructive proof that there exist positive ir­ rational numbers a and b such that ab is rational by considering the possibilities for � and (�)v'2. Does this proof allow you to compute a to within an error of 1/100? 5. Let ak, bk, Ck, nk for k = 1, 2, .. . be an enumeration of all quadru­ ples of positive integers with nk > 3. Let Xj = 0 if a�\" + b�\" i= c�\" for all k < i and otherwise Xj = l/k where k is the smallest in- < . � hich n\" bn\" n\" Ph ' teger _ J lor w ak + k = ck• rove t at XI , X2, ••• 1S a Cauchy sequence. What is the relationship between the Axiom of Archimedes for the real number given by this Cauchy sequence and Fermat's Last Theorem? 2.5 Summary 2.1 Cauchy Sequences Definition A Cauchy sequence of rational numbers is a sequence XI, X2,. \" of rational numbers such that for every n there exists m such that IXj - xk l < l/n for all j and k > m. Definition Two Cauchy sequences x}, X2, • •• and yt, Y2, ••• are equiv­ alent if for every n there exists m such that IXk - Ykl < l/n for k > m. Lemma 2.1.1 The equivalence of Cauchy sequences of rationals is an equivalence re�ation (it is symmetric, reflexive, and transitive). Definition 2.1.1 A real number is an equivalence class of Cauchy sequences of rationals. 2.2 The Reals as an Ordered Field Definition 2.2.1 The real number x + Y is the equivalence class of 70 Chapter 2 Construction of the Real Number System Xl +Yl, X2 +Y2, ' \" where Xl, X2, '\" and Yb Y2, ' \" are Cauchy sequences of rationals representing X and y. Lemma 2.2.2 A Cauchy sequence is bounded. Definition 2.2.2 The real number X • Y is the equivalence class of XlYl , X2Y2,. · • where Xl, X2, ••• and Yb Y2, ••• are Cauchy sequences rep­ resenting x and y. Definition A field is a set with two operations, addition and multi­ plication, such that both operations are commutative and associative, multiplication distributes over addition, there exist distinct additive i­ dentity 0 and multiplicative identity l, and every element X has an additive inverse -x and a multiplicative inverse x-l (if X =F 0) . Theorem 2.2.1 The real numbers fonn a field. Lemma 2.2.4 Every real number not equal to zero is bounded away from zero (there exists N such that for every Cauchy sequence Xl, x2, .. . representing X there exists m with IXj l > liN for all j > m) . Definition 2.2.3 A real number x is positive if there exists N and m and Xl, X2, ••• a Cauchy sequence representing x such that Xj � liN for all j > m. A real number is negative if -x is positive. Theorem 2.2.2 The reals fonn an ordered field-every real number is either positive, negative, or zero, and sums and products of positive numbers are positive. Definition X > Y means x - Y is positive, Ixl = x if x > 0 and -x if x < O. Theorem 2.2.3 (7hangle Inequality) Ix + yl < Ixl + IYI· Theorem 2.2.4 (Axiom of Archimedes) If x > 0 there exists n such that x > lin. 12. 5 Summary 71 Theorem 2.2.5 (Density of Rationals) Given x a real number and n, there exists a rational number y such that Ix - yl < lin. 2.3 Limits and Completeness Definition A Cauchy sequence of real numbers is a sequence Xl, X2, ••• of real numbers such that for every n there exists m such that IXj -Xk I < lin for all j and k > m. Definition For x a real number and Xl, X2, ••• a sequence of real num­ bers, X = limk_oo Xk if for every n there exists m such that k > m implies IXk - xl < lin. Theorem 2.3.1 (Completeness of Reals) Every Cauchy sequence of real numbers has a real limit. Theorem 2.3.2 a. Limits commute with addition, multiplication, and division (with non-zero denominator) . h. Limits preserve non-strict inequalities. Theorem 2.3.3 Every positive real has a unique real positive square root. 2.4 Other Versions and Visions Theorem Every real number has an infinite decimal expansion. Definition A Dedekind cut is a set L of rational numbers satisfying 1. L is not empty; 2. L is not all the rationals; 3. if r is in L and q < r, then q is in L; 4. if r is in L there exists B in L with B > r. 72 Chapter 2 Construction of the Real Number System Theorem There is a one-to-one cofTUpondence between real numbers and Dedekind cuts. Chapter 3 Topology of the Real Line 3.1 The Theory of Limits 3. 1.1 Limits, Sups, and Infs In this chapter we delve deeper into the properties of real numbers, sequences of real numbers, and sets of real numbers. Many of the concepts introduced in this chapter will reappear in a broader context (metric spaces) in Chapter 9. By considering these concepts first in the concrete case of the real number line, you will have the opportunity to develop an intuition for them. This will make it easier to appreciate the generalizations that follow. We can think of the real number system as representing a geometric line. We are interested in properties that have a qualitative geometric nature, which is the meaning of the word ''topology'' . One of the fundamental concepts is that of limit, which we have already discussed but repeat its definition for emphasis. If XI, X2, X3, ••• is a sequence of real numbers and if x is a real number such that given any error l/n there exists a place in the sequence m, such that Ix - xjl < l/n for all j > m, then we say x is the limit of the sequence, x = limj_oo Xi . A limit need not exist, but if it does it is unique. We have already motivated this definition by the idea that any number from the sequence beyond the mth place is very close to x. We can also think of this in a geometric way. For each l/n, the set of all real numbers y that satisfy the inequality Ix - yl < l/n is the open interval x -l/n < y < x + l/n of length 2/n centered at x. Think of this interval as comprising a 73 74 Chapter 3 Topology of the Real Line neighborhood of x (we will give this a precise definition later). As we increase n these neighborhoods shrink, giving a nested picture, as shown in Figure 3. 1.1, Figure 3.1.1: more and more accurately pinpointing the location of x. The definition of the limit says that limj-+oo Xj = x if the sequence eventually (j > m) lies entirely in each neighborhood. It is sometimes convenient to give a meaning to the expressions limj_oo Xj = +00 and limj-+oo Xj = -00. If we think of the half­ infinite intervals {x : x > n} and {x : x < n} as defining neighborhoods of +00 and -00, respectively (allowing n to be any integer, positive or negative) , then the definition is again the same: lim) -00 x j = +00 if the sequence eventually lies entirely in each neighborhood of +00. Sometimes it is convenient to think of the symbols +00 and -00 as standing for new numbers in what is called the extended real number system. The system consists of the real numbers together with +00 and -00. It has an obvious order (+00 is the biggest, -00 the smallest) and a limited arithmetic, with rules like x + (+00) = +00 for x real, but certain expressions, such as +00 + ( -00), must remain undefined. Of course not every sequence that fails to have a real number limit will have +00 or -00 as a limit. A sequence that jumps about, such as 0, 1, 0, 1, 0, 1, . .. , is an obvious counterexample. (Some mathematician­ s, such as Leibniz and Euler, felt that this sequence should have 1/2 as limit; nevertheless it does not under the definition we have adapted, since the sequence never lies in the neighborhood 1/4 < x < 3/4 about 1/2.) However, we can consider weaker notions that provide some in­ formation about where the points of a sequence lie, and these notions turn out to have great importance. The simplest of these are the supre­ mum and infimum, which are based on the order properties of the real numbers. These concepts can be defined not just for sequences but for any sets of real numbers. We will use the abbreviation sup and info 3. 1 The Theory of Limits 75 If E is any finite set of real numbers, we can define sup E and inf E to be the largest and smallest numbers in E, respectively. But if E is an infinite set of real numbers, there may not be a largest or smallest number in E. For example, the set of positive integers has no largest number; the set of positive reals has no smallest number. Nevertheless, if we imagine the set E as represented geometrically on the line, there should be a left-most and right-most point (possibly -00 or +00) indicating the range of the set; these endpoints might or might not belong to the set. We will call them inf E and sup E. How are we to define them? First let us develop the intuition that leads us to believe they exist; this will indicate the definition we want to adopt, and then we will have to give a proof that inf E and sup E exist. For simplicity we will deal only with sup E; the treatment of inf E is completely analogous, or one may simply say that inf E is minus the sup of -E. To avoid triviality we assume E is non-empty. If sup E is supposed to indicate the top-most extent of E, then every point in E must be less than or equal to it. Thus, in searching for sup E, we can confine attention to numbers Y with the property that every number x in E satisfies x < y. (The example of a finite set should convince you that we want x < y and not x < y.) Such numbers are called upper bounds of E. Not every set possesses upper bounds, for example, the set of positive integers. We say E is bounded from above if it has any upper bounds or unbounded from above if it has none. By convention we set sup E = +00 if E is unbounded from above. Among all upper bounds for E (if they exist), which shall we choose for sup E? Obviously the smallest one! But are we sure that a smallest one exists? We have already mentioned that some sets of numbers, such as the positive numbers, have no smallest element. Well, suppose we start with one upper bound, call it Yl . If it is not the smallest, then pick a smaller one, Y2 . Continuing in this way, we could pick a sequence Yl , Y2 , Y3, .. . of upper bounds that get smaller and smaller and hope that limj - 00 Yj = Y would give us sup E. Unfortunately, we have to be a bit more careful to really go down far enough at each step-for it is clear from Figure 3. 1.2 only that y is an upper bound for E, not that it is the smallest. To bring the sequence {Yi } down close to E we must consider some points in E as well as upper bounds. Along with Yl choose a point 76 • E Y Chapter 3 Topology of the Real Line • • • • • • Y3 Y2 YI Figure 3.1.2: Xl in E (we assumed E is not empty). Since YI is an upper bound for E, Xl < Yb and clearly the sup must lie somewhere in between. Again we use a divide and conquer argument. Consider the midpoint, (Xl + yd/2. If it is an upper bound for E, choose it for Y2, and set X2 = Xl. If it is not an upper bound for E, then it fails because there is some point X2 in E bigger than the midpoint; in this case we take Y2 = Yl. The two cases are illustrated in Figure 3.1.3. midpoint I midpoint E + [ • ] • • XI Y2 YI : E , [ x� . . ] • X2 YI X2 first case second case Y2 Figure 3.1.3: In either case, we have replaced the original pair xl, Yl with a new pair X2, Y2 with X2 in E and Y2 an upper bound to E, with the distance apart IX2 - Y21 at most half the original distance IXI - YI I (in the first case IX2 -Y21 = IXI -Yll/2 since Y2 is the midpoint, while in the second case IX2 - Y21 < IXI - Yl l/2 since X2 is greater than the midpoint). By iterating this argument we obtain an increasing sequence Xl, X2, X3, ••• of points in E and a decreasing sequence Yl , Y2 , Y3, ••• of upper bounds for E such that IXn - Ynl < IXI - Yl l/2n. It is an easy matter to conclude from this that these are equivalent Cauchy sequences and, hence, converge to the same limit; call it y. What can we say about this point y? 1. It is an upper bound for E. In fact this follows from the more general fact that a limit of upper bounds for E is an upper bound 3. 1 The Theory of Limits 77 for E. The condition of being an upper bound for E is given by non-strict inequalities x < Y for all x in E, and non-strict inequalities are preserved by limits (thus x < Yj for all Yj implies x < limj_oo Yj, and this reasoning applies at each point x of E) . 2. It is the least upper bound of E: if y' is another upper bound for E, then Y < y'. The reason for this is that x j < y' since x j is in E and Y' is an upper bound for E and so Y = limj -00 Xj < y' since the non-strict inequality is preserved in the limit. Clearly there is only one number with these two properties-and this deserves to be defined as sup E. The terminology least upper bound, abbreviated l.u.b., is used synonomously, while greatest lower bound, abbreviated g.l.b., is used for info We restate the important theorem that we have established. Theorem 3.1.1 For every non-empty set E of real numbers that is bounded above, there exists a unique real number sup E such that 1. sup E is an upper bound for E; 2. if Y is any upper bound for E, then Y > sup E. A closely related theorem concerns sequences whose terms are in­ creasing (there is an analogous result for decreasing sequences). A sequence Xl, X2,' •• is called monotone increasing if Xj+l > Xj for every j. Note that we do not demand strict inequality, which explains the use of the awkward adverb \"monotone\" . If a monotone increasing sequence is unbounded, then it has limit +00 (once Xj > n we have Xk > n for all k > j). But suppose it is bounded; it would appear to rise to some finite limit, namely, the sup of the set of �umbers {x j }. It is important to understand the distinction between the sequence XIt X2, ••• and the set {XIt X2, ••• }. The sequence has the numbers in a specified order, and numbers may be repeated. In the set, elements are unordered, and repeated numbers are treated no differently from unre­ peated numbers. Thus the set associated to the sequence 3, 2, 1, 2, 1, .. . is just the three element set {I, 2, 3}. We will sometimes follow con­ ventional usage and denote a sequence by {Xj}. It should be clear from context that we mean the sequence and not the set, even though the notation makes no distinction. 78 Chapter 3 Topology of the Real Line Now we define the sup of a sequence to be the sup of the associated set, which we can write either as sup {Xj } or SUPjXj . Let us verify that indeed limj_oo Xj = sup{Xj } if the sequence is monotone increasing. Let y denote the sup. We know Xk < Y for every k since y is an upper bound. Since y is the least upper bound, we know y - 1 I n is not an upper bound, for any choice of lin. What does this mean? It means that Xj < Y - lin must fail for some Xj ' This is the same as Xj > y - lin, and because the sequence is monotone increasing, Xk > Y - lin for every k > j, as indicated in Figure 3.1.4 . • y -l ln • x· J • Figure 3. 1.4: • ••• • The combined inequalities Xk < yand Xk > y -lin show IXk - yl $ lin for every k > j, and this says exactly limj_oo Xj = y. We have shown: Theorem 3.1.2 A monotone increasing sequence that is bounded from above has a finite limit, and the limit equals the sup. 3.1.2 Limit Points Now we turn to the case of a general sequence, which may not have a limit. We have defined the sup and inf of the sequence (the sup may be +00 and the inf -oo). The interval between the inf and sup contains all the points in the sequence and is the smallest such interval. Never­ theless, it provides only a very crude indication of where the sequence really lies. For instance, the convergent sequence 0, 3, 1, 1, 1, ... has inf = 0 and sup = 3. What do 0 and 3 have to do with the limit? We need a more refined concept, one that is not influenced by only a finite number of terms. Suppose we take two convergent sequences Xl, X2, ••• and Yl , Y2, .•• that have different limits, x and y, and shuffle them to form the se­ quence Xl , Yll X2, Y2, • .. . The shuffled sequence will not have a limit; nevertheless the two values x and y are connected to the sequence in 9. 1 The Theory of Limits 79 some weaker but still important way. Suppose we look at a neighbor­ hood of z, the interval from Z - lin to z + lin, where we choose lin SO small that y and all points in a neighborhood of y do not lie in this neighborhood (we are assuming z =F y, so this is possible by the ax­ iom of Archimedes). The situation is illustrated in Figure 3.1.5. Will it be true that all the terms of the sequence beyond a certain place lie in the neighborhood? No, because the Yj'S eventually all lie in the neighborhood of y. ( . x ) ( . ) y Figure 3.1.5: However, all the z j 's eventually will lie in the neighborhood of z. We can state this as follows: an infinite number of terms of the shuJ1fed sequence lie in each neighborhood of z. Comparing this with the defi­ nition of limit, we see that the strong statement, \"all terms beyond the mth\" has been replaced by a weaker statement, \"an infinite number of terms\" . We use this weakening to define the concept of limit-point (the expressions accumulation point and cluster point are frequently used synonomously) . Definition 3.1.1 If {Zj } is a sequence of real numbers and z a real number, we say z is a limit-point of the sequence if for every error lin, there are an infinite number of terms Zj satisfying Iz - zj l < l/n. An equivalent way of formulating this is the following: given any n and m, there exists j > m such that IZj - zi < l/n. You should be able to show that these are equivalent. By convention we say +00 is a limit-point of the sequence if for every n there are infinitely many terms satisfying Zj > n. You should be able to verify that this is equivalent to the condition that the sequence is unbounded from above. In the example of the shuffled sequence Z}, Y17 Z2, Y2, .•• , the two numbers Z and Y are both limit-points of the sequence, and there are no other limit-points (why?). In a way this is typical. In order to understand this we need to think about subsequences. The concept 80 Chapter 3 Topology of the Real Line of subsequence is extremely simple to comprehend but remarkably d­ ifficult to notate. If Xl, X2, X3, ••• is a sequence, a subsequence is any other sequence obtained by crossing out some (possibly infinitely many) terms, keeping the same order for the remaining terms. For an exact definition we first need to specify the class of functions m( n) from the non-negative integers to the non-negative integers that are increasing, m(n + 1) > m(n) for all n. Call such a function a subsequence selection function (it will pick out the position of the terms that remain after the crossing out). Then {Yi} is a subsequence of {Xj } if there exists a subsequence selection function such that Yn = xm(n) . In place of the compound subscripts (it gets worse if you take a subsequence of a subsequence) we will follow the convention of using primes to denote subsequences, so {xj } denotes a subsequence of {Xi}. Note that in the shufHed sequence Xl , YI, X2, Y2, ••• each of the original sequences is a subsequence. (What are the corresponding subsequence selection func­ tions?) Notice the connection in this example between limit-points (x and y) and limits of subsequences. This is true in general. Theorem 3.1.3 Let {Xj } be any sequence of real numbers. A real number (or even an extended real number) X is a limit-point of {xi } if and only if there exists a subsequence {xj } such that limi_ooxj = x. Proof: This theorem is almost completely trivial if you understand the definitions. We assume that X is a real number. The case X = ±oo is treated similarly. First suppose there exists a subsequence with X as a limit. Given any error l/n, the subsequence approaches within l/n of X beyond a certain place, and since all the terms of the subsequence belong to the sequence, there are an infinite number of terms of the sequence within l/n of x. Thus x is a limit-point. For the converse we have to do a little work; namely, we have to construct a subsequence with limit x, assuming x is a limit-point of the sequence {xi }. To make life easy we will choose the subsequence {xj } so that Ix� - xl < l/n; this clearly implies limj_oo xj = x. How do we choose x�? By the definition of limit-point there are infinitely many Xi satisfying IXi - xl < l/n; we choose x� , x2, ... in order such that, after choosing x� , ... , x�_l' we take for x� some xi beyond x� , ... , x�_ l in the original sequence with IXi - xl < l/n. In this way {xj } is a subsequence of {xi} with limit x. QED 9. 1 The Theory of Limits 81 Thus if the sequence {Xj} has a limit-point x, we can think of it as a kind of shufHing of a sequence converging to x with another sequence but not necessarily an even shufBing. Of course the structure of the set of limit-points of a sequence can be quite complex, as the following example illustrates. Let {Xj } be a sequence in which every rational number appears infinitely often. Such a sequence is easily constructed by applying the diagonalization argument to the rectangular array rl / r2 / r3 / rl / r2 / r3 / / rl / r2 / r3 / / / / where each row is the same enumeration of the rational numbers; thus the sequence {Xj } is rI, rI, r2, rl, r2, r3, rI, r2, r3, r4, .... It has the prop­ erty that every real number is a limit-point! Indeed if x is a real number there is a Cauchy sequence of rationals converging to it, and any se­ quence of rationals is a subsequence of {Xj} (why?). A convergent sequence has only one limit-point, namely its limit, since every subsequence of a convergent sequence converges to the same limit. The converse is also true: if a sequence has only one limit-point (counting +00 and -00 as possible limit-points), then it is convergent. This is not so obvious, but it will emerge from further considerations. Does every sequence have a limit-point? We will show that this is the case (allowing +00 and -oo) . In fact there are two special limit­ points, the largest, called limsup, and the smallest, called liminf. We could simply define limsup to be the sup of the set of limit-points, but this begs the question of the existence of limit-points. Instead we will write down a formula for limsup. Note that limsup is quite different from sup; for the sequence 2, 1, 1, 1, ... , the sup is 2, but the only limit-point is 1, and this is the limsup. Nevertheless, the sup is a good starting point for finding limsup. Let's assume the sequence is bounded above, for otherwise we take +00 by convention for both sup and limsup. The trouble with the sup, as the example shows, is that it might be Xl, which has nothing to do with the limiting behavior of the sequence Uust as in the case of the limit, any finite number of terms of a sequence can be changed without changing the limit-points) . We could try to fix things by throwing the rascal out-consider the sup over all 82 Chapter 3 Topology of the Real Line Xj in the sequence except xl-write this SUPj>1 {Xj }. This is not much of an improvement, for now X2 might be the culprit. If we continue to throw the rascals out, considering in turn SUPj>2{Xj}, SUPJ>3{Xi}, \" \" we will never achieve our objective, but we may be approximating it. Since at each stage we are taking the sup over a smaller set (these sets are infinite, so smaller refers to containment, not cardinality), the sups are decreasing. That is, if we let Yk = SUPi>k{Xj }, then Yk+l < Yk, so the sequence {Yk} is monotone decreasing and so has a limit, its inf (possibly -00). If we write out the expression for this limit, Y = limk_oo sUPi>k{Xj }, then we are sorely tempted, on purely linguistic terms, to define this to be lim SUPj_oo Xj . To justify the definition we need to verify two facts: 1. limsup is a limit-point of the sequence. 2. limsup is the sup of the set of limit-points of the sequence. Incidentally fact 2 does not imply fact 1 a priori, since there exist sets that do not contain their sups. Proof of fact 1: Suppose first that Y is finite. Since Y is the limit of sUPi>k xi , given any lin we can find m such that ly-suPi>k xJ I < 1/2n for all k > m. Since SUPj>k Xj is finite, we can find Xl for 1 > k such that IXl - sUPi>k Xi I < l/2n, so Iy - xd < lin. In fact we can find an infinite number of Xl (since I > k and we can take any k > m). This shows Y is a limit-point of the sequence. If Y = +00, then {SUPi>k Xj} is unbounded above, hence {Xj} is unbounded above; so +00 is a limit-point. Finally, if y = -00, then given any -n there exists m such that SUPj>k Xj < -n for all k > m. Thus there are infinitely many Xj with Xj < -n, so -00 is a limit-point of the sequence. Proof of fact 2: We have to show that Y = limsup is an upper bound for the set of limit-points-since we know by fact 1 that it is a limit­ point, this will show it is the least upper bound. Thus what we need to show is that if X is any limit-point of the sequence, then X < y. If X is a limit-point let {xj } be a subsequence converging to x. Let us I • h S' { ' } . b I compare Xk+1 WIt Yk = SUPj>k Xi ' Ince Xj IS a su sequence, Xk+1 is one of the X j with j > k, so Yk is the sup of a set containing X�+ 1 , 3. 1 The Theory of Limits 83 hence x�+l < Yk' Since this holds for each k, we have x < Y since limits preserve non-strict inequality (you should understand why the k + 1 in place of k makes no difference). We can reformulate the above discussion by adopting the following definition. Definition 3. 1.2 The limsup of a sequence is the extended real number limsuPk_ooxk = limk_ooSUPj>kXj . Similarly, the liminf is defined by liminfk_ooxk = limk_ooinfj>kxj . We have proved the following theorem. Theorem 3.1.4 The limsup of a sequence is a limit-point of the se­ quence and is the sup of the set of limit-points of the sequence. Because the proof is non-trivial, it would be a good exercise for you to try to write out the analogous proof that lim infk_oo Xk = limk_oo infj>k Xk is a limit-point and the inf of the set of limit-points. Incidentally, since the sequence {SUPj>k Xj } is monotone decreasing and the sequence {infj>k Xj } is monotone increasing, we can also write limsuPk_ooXk = infk SUPj>k Xj and liminfk_ooxk = sUPk infj>k Xj ' The difference of the limsup and liminf, sometimes called the oscil­ lation of the sequence, measures the spread of the set of limit-points. We are not asserting that every value in between is a limit-point; in the sequence 0, 1, 0, 1, ... , the limsup is 1 and the liminf is 0, and there are no other limit-points. But, if the limsup and liminf are equal, we would expect the sequence to converge to their common value. To see why this is true, call the common value x. Suppose first that x is fi­ nite. We have two sequences {Yk} and {Zk} converging to x, where Yk = SUPj>k Xi and Zk = infj>k Xj , by the definition of limsup and liminf. Note that Zk < Xj < Yk if j > k. If we choose k large enough so that Ix - Yk l < lin and Ix - zk l < lin, which we can do because x is the limit of {Yk } and {Zk}, then 1 1 x - - < Zk < Xj < Yk < X + - n n for all j > k, so Ix - Xj I < lin for all j > k, proving x is the limit of {Xi }' Thus if limsup = liminf is finite, the common value is the limit. (Incidentally, it is not so easy to prove this using only the property of 84 Chapter 3 Topology of the Real Line limsup being the sup of the limit-points, etc.) From this we deduce the immediate corollary: if a sequence {Xj } has only one limit-point and the limit-point is finite, then the sequence is convergent. Notice that we have to know there is only one limit-point among the extended real numbers, for a sequence like 0, 1, 0, 2, 0, 3, 0, 4, ... has the two limit­ points ° and +00 but is not convergent. Another way to state this is to require that the sequence be bounded (bounded means bounded above and below; this is sometimes expressed concisely as IXj I < M for all i). A bounded sequence has finite limsup and liminf, since limsup < sup and inf < liminf. Theorem 3.1.5 A bounded sequence is convergent if and only if the limsup equals the liminf or, equivalently, if and only if it has only one limit-point. Finally, we need to consider the case when limsup = liminf = +00, say. The condition liminf = +00 means Zk = infj>k Xj can be made greater than any n by taking k large enough; but then Xj > Zk > n for all i > k, and this means limj_oo Xj = +00. 3.1.3 Exercises 1. Compute the sup, inf, limsup, liminf, and all the limit points of the following sequences Xl, X2 , ••• where a. xn = 1/n + (-1)n, b. Xn = 1 + ( - 1)n/n, c. x n = (-1 ) n + 1/ n + 2 sin n 7r /2. 2. If a bounded sequence is the sum of a monotone increasing and a monotone decreasing sequence (xn = Yn + Zn where {Yn} is monotone increasing and {zn} is monotone decreasing) does it follow that the sequence converges? What if {Yn} and {zn} are bounded? 3. If E is a set and Y a point that is the limit of two sequences, {xn} and {Yn} such that Xn is in E and Yn is an upper bound for E, prove that Y = sup E. Is the converse true? 4. Prove sup(A U B) > sup A and sup(A n B) < sup A. 9. 1 The Theory of Limits 85 5. Prove limsup{zn + Yn} < limsup{zn} + limsuP{Yn} if both lim sups are finite, and give an example where equality does not hold. 6. Is every subsequence of a subsequence of a sequence also a subse­ quence of the sequence? 7. Construct a sequence whose set of limit points is exactly the set of integers. 8. Write out the proof that +00 is a limit-point of {xn} if and only if there exists a subsequence whose limit is +00. 9. Can there exist a sequence whose set of limit points is exactly 1, 1/2, 1/3, ... ? (Hint: what is the liminf of the sequence? ) 10. Prove that the set of limit-points of a shufHed sequence Xl , YI , X2, Y2 , •.. is exactly the union of the set of limit-points of {X j} and the set of limit-points of {Yi} . Is the same true if the shufBing is not regular? 11. Consider a sequence obtained by diagonalizing a rectangular ar- ray. au / al2 / al3 / a21 / a22 / a23 / / a31 / a32 / a33 / / / / Prove that any limit-point of any row or column of the array is a limit-point of the sequence. Do you necessarily get all limit-points this way? 12. Say two sequences are equivalent if they differ in only a finite number of terms (there exists m such that Xj = Yj for all j > m) . Prove that this is an equivalence relation. Show that equivalent sequences have the same set of limit-points. 86 Chapter 3 Topology of the Real Line 3.2 Open Sets and Closed Sets 3.2. 1 Open Sets We have already had many occasions to use inequalities and sets defined by inequalities. Perhaps you have notited that on some occasions the distinction between strict and non-strict inequalities is not essential­ for example, in the definition of limit, we could require either IXk - xl < lin or IXk -xl < lin and it would make no difference; however on other occasions the distinction is essential, for example, non-strict inequalities are preserved in the limit, but strict inequalities may not be. We are now going to delve further into the matter, from the point of view of the sets defined by the inequalities. The set determined by the strict inequalities a < x < b (for a < b) we will call an open interval, written (a, b); while the set determined by the non-strict inequalities a < x < b we will call a closed interval, written [a, b]. For the open interval we will also allow a = -00 or b = +00 or both. It may seem a trifling matter whether or not the endpoints are included in the interval, but it makes a significant difference for certain questions. In the open interval, every point is surrounded by a sea of other points. This is the qualitative feature we will want when we define the notion of open sets; it is certainly not true of the endpoints of the closed interval. On the other hand, an open interval (a, b) seems to be \"missing\" its endpoints. Although they are not points in the interval, they can be approached arbitrarily closely from within the interval. It is as if they had been unfairly omitted. The closed interval has all the points it should from this point of view, and this is the \"closed\" aspect that we will generalize when we define a closed set. Let us begin with open sets. The idea of \"open\" suggests that one should always be able to go a little further, that one should never reach the end. Thus we will define an open set A of real numbers to be a set with the property that every point x of A lies in an open interval (a, b) that is contained in A. The open interval may vary with x, and it may be very small. If A itself is an open interval, then it is trivially an open set because A contains the open interval A that contains each point x in A (this is an example where the interval does not have to vary with x). A closed interval [a, b] is not an open set because the point a in A does not lie in any open interval contained in A. The union of 3. 2 Open Sets and Closed Sets 87 two open intervals, say A = (0, 1) U (1, 2), is open, since any point in A lies in either the open interval (0, 1) or the open interval (1, 2). The fact that the point 1 does not lie in an interval contained in A is not relevant, because 1 does not belong to A. The empty set is an open set because it satisfies the definition trivially (since it contains no points, there is nothing to verify). In what follows we are mainly interested in non-empty open sets, but we phrase the results so that they remain true for the empty set as well. The union of any number (finite and infinite) of open intervals is an open set, simply because any point in the union must belong to one of the open intervals. Conversely, every open set is a union of open intervals. In fact, if A is an open set, then each point x in A, according to the definition, lies in some open interval Ix contained in A. Then A is the union of all the intervals Ix, A = Ux£A Ixi for x is in Ix for each x in A, so A C Ux£A Ixi on the other hand each Ix is contained in A, so UXfA Ix � A. Actually we can say a little more precisely what every open set is like. For if two open intervals intersect at all, they must overlap, and so their union can be combined into a single open interval, as shown in Figure 3.2. 1. ( ( a c ) ) b d ( a ( ) c d (a, b) U (c, d) = (a, d) (a, b) U (c, d) = (a, b) Figure 3.2. 1: ) b Thus a union of open intervals can be simplified to a union of disjoint open intervals (disjoint means no two intersect). (Strictly speaking this requires a more elaborate proof, since there may be multiple overlaps. We leave the details to exercise set 3.2.3, number 15) . How many open intervals? There could be any finite number or an infinite number. As an example of an infinite number, consider the set (1/2, 1)U (1/4, 1/2) U (1/8, 1/4) U . . . shown in Figure 3.2.2. 88 ( X 118 114 Chapter 3 Topology of the Real Line x ) 112 1 Figure 3.2.2: This set can also be described as the interval (0, 1) with the points 1/2, 1/4, 1/8, . . . deleted. From this second description it is not obvious that we are dealing with a disjoint union of intervals. Of course the general disjoint union of intervals can be much more complicated than this, with the sizes of the intervals distributed in incredibly complex ways. We can, however, assert that the cardinality of the collection of disjoint intervals is at most countable. That is, we cannot have an uncountable union of disjoint open intervals. To understand why this is so we have to reason about the length of the intervals. Let us call A the collection of disjoint intervals. Consider AI, the subset of A of those intervals of length greater than 1. The set Al is at most countable because every interval of length greater than 1 must contain at least one integer, and the disjointness means that no two intervals in Al can contain the same integer. Next consider A2 , the subset of A of those intervals of length greater than 1/2. Every interval in A2 contains at least one half-integer (a number m/2 where m is an integer), so again A2 is at most countable. Continue in this way to define An to be the subset of A of those intervals of length greater than lin. By the same reasoning all the sets An are at most countable. But A = Un An for every open interval has a length greater than lin for some n. Since .A is a countable union of at most countable sets, it is countable. Thus we have a structure theorem for open sets: every open set of real numbers is a disjoint union of a finite or countable number of open intenJals. The intervals that comprise the union are uniquely determined; we will leave the proof to exercise set 3.2.3, number 16. This structure theorem has no analogue in higher dimensions and so is rarely emphasized. (For example, if you want to prove something about open sets of real numbers, it would be better not to use the structure theorem if you can avoid it, for then your proof would stand a better chance of generalizing.) 9. 2 Open Sets and Closed Sets 89 Next we study the closure properties of the class of open sets; in other words, what operations can you perform on open sets and still come out with an open set? Theorem 3.2.1 1. The union of any number of open sets is an open set. 2. The intersection of a finite number of open sets is an open set. Notice also that we have to restrict the intersections in property 2 to finitely many, while there is no such restriction for unions (the number of open sets in the union is even allowed to be uncountable) . Here is an example that shows why we need this restriction. Take a closed interval, say [0, 1] . We have observed that this is not an open set. Yet we can easily get it as a countable intersection of, say, the open intervals (- lin, 1 + lin), as shown in Figure 3.2.3. ( ( ( [ ] o 1 Figure 3.2.3: Proof of Property 1: Let A denote any collection of open sets and U.A A their union. A point x in the union must belong to one particular open set A. Since A is open, x must lie in an open interval I contained in A and, hence, in the union. Thus the union is open. Proof of Property 2: Let At , ... ,An be a finite number of open sets, and let A = At n· .. n An be their intersection. Any point x in A lies in all the Ak. (If A is empty there is nothing more to do, since the empty set is open.) Since each Ak is open, x lies in an open interval (ak' bk) contained in Ak. So we have a picture like Figure 3.2.4 (n = 3). We want an open interval containing x that lies entirely in A. We can't take any one of the intervals (ak' bk), because all we know about 90 ( ( Chapter 3 Topology of the Real Line ( • ) ) ) x Figure 3.2.4: it is that it lies in Ak . The only hope is to take the intersection of all the intervals, since that will lie in A. But is the intersection an open interval containing x? A glance at Figure 3.2.4 will convince you that the intersection is the open interval (a, b) where a is the largest of the ak's and b is the smallest of the bk 'S and of course it contains x since it is the intersection of intervals containing x. (Note that this is where the argument breaks down for infinite intersections: if there were an infinite number of intervals the intersection might not be an open interval.) QED This rather innocent theorem on the closure properties of open sets turns out to have an unexpected significance. In the general theory of topology, properties l and 2 are chosen as the axioms for the abstract notion of \"open set\" (together with a trivial axiom that the empty set and the whole universe are open sets) . We will not discuss the general theory in this work, but from time to time we will point out some of the ways in which abstract theories are forshadowed in concrete instances. What is the significance of the open sets? To explain this let's con­ sider a closely related concept. A neighborhood of a point x is defined to be any open set containing x (sometimes the word \"neighborhood\" is taken to mean any set containing an open set containing x, and the narrower meaning we have ascribed to the term is denoted by \"open neighborhood\" ). A particularly simple neighborhood of x is an open in­ terval containing x, or even an interval of the form (x - lIn, x + lIn). By the definition of open set, every neighborhood of x contains an open interval containing x and, by the axiom of Archimedes, even one of the special form (x - lIn, x + lIn). Thus, although there are an un­ countable number of possible neighborhoods of x, if we are willing to shrink neighborhoods, we need only consider a countable number, the 9. 2 Open Sets and Closed Sets 91 intervals (x - lin, x + lin). In most instances when we use the term \"neighborhood\" it comes quantified, \"for all neighborhoods of x blah­ blah-blah\" , or \"there exists a neighborhood of x such that phooey\" , and it usually does not change the meaning of the sentence to say \"for every interval (x - lin, x + lin) blah-blah-blah\" , or \"there exists an interval (x - lin, x + lin) such that phooey\" . This simple observation will play an important role in Chapter 14 as part of a general strategy to replace uncountable collections of sets by countable collections of sets. An important and typical example of the use of the neighborhood concept is in the definition of limit. We have defined limj _oo Xj = x to mean that given any error lin, we can make IXj -xl less than that error by taking j sufficiently large. But the condition IXj - xl < lin is ex­ actly the statement that Xj lies in the neighborhood (x - lin, x + lin) of x. Bearing in mind what we said about replacing general neighbor­ hoods by special ones, we expect the following reformulation of the definition of limit to be equivalent to the old one: limj_co Xj = x if for every neighborhood of x, there exists m such that all Xj are in that neighborhood for j > m. Indeed this says exactly the same as before for the special neighborhoods (x - lin, x + lin), and since ev­ ery neighborhood contains a special one, the statement is true for all neighborhoods if and only if it is true for the special ones. What is the advantage of reformulating the definition of limit as above? It shows that the concept of open set alone suffices to define limit, without any reference to distance. We will find that this is true for many other concepts as well. As an exercise, try giving the definition of limit-point using neighborhoods. On the other hand, a concept like sup or inf, which involves the order properties of the real number system, cannot be defined by neighborhoods alone. 3.2.2 Closed Sets We now turn to the closed intervals and, their generalization, the closed sets. We have said that the term \"closed\" is used to indicate that the set contains all the points that it \"ought to\" contain. Here we are thinking that a set \"ought to\" contain those numbers that can be approximated arbitrarily closely by numbers already in the set. In this sense the endpoints of an interval ought to be in the interval, and their absence 92 Chapter 3 Topology of the Real Line in the open interval leads to the expectation that the open interval isn't closed. To make these ideas precise we need to introduce the concept of limit-point for sets. This will be analogous to the concept of limit­ point for sequences but with a subtle twist. Let A denote a set of real numbers, and let x denote a real number (perhaps in A, perhaps not) . We want to say that x is a limit-point of A if there are points in A that approximate x arbitrarily closely. We can say this in terms of distance: given any error lin, there exists a point Yn in A (depending on n) such that Ix - Yn l < lin; or we can say it in terms of neighborhood: every neighborhood of x contains a point in A. It is easy to see that these statements are equivalent; however, they are not quite right. The reason is that they allow x to approximate x. If A contains x, then the above requirement is trivially satisfied by taking the point x in A, so we would end up having all the points of A automatically limit-points. While this makes perfect logical sense, it fails to capture the meaning we want, which is that of an infinite cluster of points in A around x (the synonym \"cluster point\" reinforces this point). Thus we must add to the definition a clause that eliminates x from consideration as an approximating point. Definition 3.2.1 x is a limit-point of A if given any error lin, there exists a point Yn of A not equal to x satisfying IYn - xl < lin or, equivalently, if every neighborhood of x contains a point of A not equal to x .. Note that this definition actually implies that every neighborhood of x contains an infinite number of points of A. For if on the contrary it only contained a finite number of points of A, say al, ... ,an, we could find a smaller neighborhood of x that does not contain al , ... , an, as indicated in Figure 3.2.5. ( . . ( . ) . ) Figure 3.2.5: If we reformulate the definition to include this, we can drop the clause 9. � Open Sets and Closed Sets 93 excluding x: x is a limit-point of A if every neighborhood of x contains infinitely many points of A. Note that if x is contained in an interval (closed or open) contained in A, then x is a limit-point of A. In particular, every point of an open set is a limit-point. But there are other ways of being a limit point. The set {1, 1/2, 1/4, ... } has 0 as limit-point; in fact 0 is the only limit­ point of this set. The set of integers has no limit-points, for no number has an infinite number of integers nearby. What is the relationship between the concepts of limit-point for sequences and sets? If we denote the sequence by Xl, X2, ••• and the set by {x j }, are the limi t-points of X I, X2, • • • the same as the limit points of {Xj }? Unfortunately, the answer is no. The simplest example is the sequence 5, 5, 5, ... , which has the limit-point 5. The corresponding set contains just the one point 5, so it has no limit-points. Clearly the culprit here is repetition. If the sequence has no repetition, or only a finite number of repetitions, then the two concepts of limit-point coincide. In the general case we can only say that a limit-point of the set is a limit-point of the sequence. Incidentally, this confusion would not be cleared up if we adopted the convention of allowing X to approximate itself. See exercise set 3.2.3, number 3. Now we can define a closed set to be any set that contains all its limit-points. Note that we do not require that all points of the set be limit-points (such sets are called perfect sets). A set with no limit­ points, such as the empty set, or a finite set, is automatically closed. A closed interval [a, b) (with a < b) is a closed set; in fact, it is a perfect set. A non-empty open interval (a, b) with a or b finite is not closed because the finite endpoint { s) are limit-points. However the whole line ( -00, 00) is closed (note that we have not defined the possibility of ±oo being limit-points of a set; although we could do so in the same way we did for sequences, it would confuse matters too much). The whole story of closed sets is revealed in the following basic theorem: Theorem 3.2.2 A set is closed if and only if its complement is open. To simplify the proof we first prove a lemma. If B denotes any set in 1R, write B' for its complement, B' = {x in 1R : x is not in B). Lemma 3.2.1 A point x in B' is not a limit-point of B if and only if x is contained in an open intenJal contained in B' . 94 Chapter 3 Topology of the Real Line Proof: x is not a limit-point of B means that there exists a neighbor­ hood (x - lin, x + lin) containing no points of B other than x. But x already is in B', so (x - lin, x + lin) is the open interval (containing x) that is contained in B'. Conversely, if x is in (a, b) contained in B', then (x - lin, x + l/n) is contained in (a, b), hence B', for sufficiently small i/n. This implies x is not a limit-point of B. QED Proof of Theorem 3.2.2: The definition that B be closed says \"for all x, x is a limit-point of B implies x is in B\" . Replacing the implication by its contrapositive yields the equivalent statement \"for all x, x is in B' implies x is not a limit-point of B\" . Since x is assumed to be in B', we can use the lemma to replace \"x is not a limit-point of B\" by the equivalent \"x is contained in an open interval contained in B'''. We now have the definition that B' be open: for all x in B', x is contained in an open interval contained in B'. QED Note that this theorem does not say that if B is not closed, then B is open. Most sets are neither open nor closed. Can you give an example? Using this theorem we can deduce many properties of closed sets from properties of open sets. For example, since union and intersection are interchanged by complementation, it follows that the closed sets are closed under finite unions and arbitrary intersections. Of course we can also prove this directly, and it is worth doing so. Theorem 3.2.3 1. The union of a finite number of closed sets is a closed set. 2. The intersection of any number of closed sets is a closed set. Proof: a. Let B1 ,\" \" Bn be closed sets, and let B = B1 U ... U Bn. To show that B is closed, we have to show it contains all its limit-points. So let x be a limit-point of B. Does this mean x is a limit-point of B1 ? Perhaps not, as Figure 3.2.6 suggests. Of course x is a limit-point of B2 in this case. This suggests that perhaps we must have x as a limit-point of one of the sets B1 , ••• , Bn. If this is true it will certainly do the trick, for each of these sets is 9. 2 Open Sets and Closed Sets 95 ] [ • x Figure 3.2.6: closed, hence contains all its limit-points, so x would belong to one of these sets, hence to the union. Let's try to prove it. What do we know? Since x is a limit-point of B, every neighborhood of x contains a point, not x, of B. Now B is the union of the Bj 's, so to each neighborhood, say (x - 11k, x + 11k) of x, there is a point Yk in the neighborhood in one of the Bj 's. Now, we want to focus on each of the sets Bl , B2 , ••• ,Bn in turn. The Yk'S are distributed among them in some unspecified way. But since there are only a finite number of sets and an infinite number of points Yl, Y2, ... to distribute among them, one of the sets must contain an infinite number of points. Call the set B29 and the points !h, Y2,!h, .... Since the points Y�, Y2' Y3' .. . approximate x arbitrarily closely, x is a limit-point of B29. (The fact that not all the points in the original sequence Yl , Y2, ... belong to B29 is not important-the ones that do, being infinite in number, get into every neighborhood of x and so x is a limit-point.) Thus we have x in B29 because B29 is closed and, hence, x in B. b. Let 8 be any collection of closed sets, and let nB£B B be the intersection. To show the intersection is closed we have to show it contains all its limit-points. So let x be a limit-point. It follows easily from the definition of limit-point that if you increase a set you do not lose any limit-points (you may gain some). Since each B in 8 contains the intersection, it follows that x is a limit-point of each B in B. Since each B is closed, x belongs to each B and, hence, to the intersection. QED Let's look at an example of a closed set that is perhaps a bit more complicated than you might expect. It is called the Cantor set and is the prototype of a large family of sets, which are called somewhat loosely Cantor sets. These sets are obtained from the closed interval [0, 1] by removing a countable collection of open intervals, so they are 96 Chapter 3 Topology of the Real Line the countable intersection of finite unions of closed intervals, hence closed sets. In this example we will successively remove the middle­ third of every closed interval. In the first stage we remove the interval (1/3, 2/3) and so are left with the two intervals [0, 1/3] U [2/3, 1] . In the second stage we remove the middle-third of each of these inter­ vals, (1/9, 2/9) and (7/9, 8/9) respectively, leaving the four intervals [0, 1/9] U [2/9, 1/3] U [2/3, 7/9] U [8/9, 1] , as shown in Figure 3.2.7. [ ] 0 1 [ ] [ ] 0 1/3 213 1 [ ] [ ] [ ] [ ] 0 1/9 219 113 213 719 8/9 1 Figure 3.2.7: Iterating this process infinitely often produces the Cantor set. There is another way to describe this set. Write the numbers between 0 and 1 in base-3 notation. Then the numbers in the middle third (1/3, 2/3) are those that begin .1 .. . , those in the second set of middle thirds (1/9, 2/9) and (7/9, 8/9) are those that begin .01 . . . and '.21 .... Thus all the deleted numbers are those with a 1 in their base-3 expression, so the Cantor set consists of all numbers expressible with just O's and 2's (note that numbers like 1/3 and 2/3 that have ambiguous expressions, .1000 . .. or .0222 . . . for 1/3, .2000 . . . or .1111 . . . for 2/3, are included in the Cantor set-as they should be-because they have one expression not involving 1 's) . The Cantor set is a perfect set but it contains no intervals. It is uncountable (as all perfect sets must be, although this is more difficult to prove). We leave these facts as exercises. We conclude this section with some concepts related to open and closed sets. A point x is said to be in the interior of a set A if A contains a neighborhood of x. Every point in an open set is in its interior. The concept of interior points is clearly a localized version of open set. Note that the interior of any set is automatically an open set. 9. 2 Open Sets and Closed Sets 97 In fact it is the largest open set contained in the set (see exercises). If A is any set, the closure of A is the set consisting of all the points of A together with all the limit points of A. Thus a set is closed if and only if it is equal to its closure. The closure of A is always a closed set. This is not obvious from the definition but requires a proof. The issue here is that by adding the limit-points of A to A, we might conceivably produce new limit-points that were not there before. But we can rule out this possibility as follows: Suppose x is a limit-point of the closure of A. This means that every neighborhood of x, say (x - lIn, x + lIn), contains points Yn not equal to x in the closure of A. If Yn belongs to the closure of A either Yn belongs to A or Yn is a limit-point of A. Now we want to show that x is a limit-point of A; so we need to show that (x - lIn, x + lIn) contains a point of A. Now if Yn is in A we are done. If not, Yn is a limit-point of A, so the neighborhood (Yn - lIn, Yn + lIn) contains points of A, say Zn (choose Zn =F x, which is possible because we know there are infinitely many-hence at least two-points of A there) . From I Zn - Yn I < lIn and Ix - Ynl < lIn we obtain IZn - xl < 21n, so the neighborhood (x - 21n, x + 21n) contains a point of A not equal to x. Clearly the factor of 2 is irrelevant, so x is a limit-point of A. The closure of A is thus closed. Also it is clearly the smallest closed set containing A. One could very easily obtain the smallest closed set containing A by taking the intersection of all closed sets containing A-but this abstract construction is less informative. If B is a subset of A such that A is contained in the closure of B (so B C A C closure (B)), we say that B is dense in A. Put another way, B is dense in A (or we say B is a dense subset of A) if B is a subset of A, and every point in A is either a point of B or a limit-point of B. For example, the rational numbers are dense in the real numbers, since every real number is a limit of a sequence of rational numbers-that's how we constructed the real number system. The open interval (a, b) is dense in the closed interval [a, b] . Dense subsets are very convenient and are used in the following manner. If you want to prove that every point in A has a certain property that is preserved under limits, then it suffices to prove that every point in a dense subset B of A has that property. The dense subset might be simpler and smaller than A. 98 Chapter 3 Topology of the Real Line 3.2.3 Exercises 1. Let A be an open set. Show that if a finite number of points are removed from A, the remaining set is still open. Is the same true if a countable number of points are removed? 2. Let Xl, X2, • .• be a sequence, and let A be the set whose elements are Xl, X2, • .. . Show that a limit-point of A is a limit-point of the sequence. Show that if no point in A occurs more than a finite number of times in the sequence, then a limit-point of the sequence is a limit-point of the set. 3. Suppose that the definition of limit-point of a set is changed to the one first suggested (every neighborhood of X contains a point of the set-without requiring the point to be different from x). Give an example to show that it would still not be true that the limit-points of a sequence and the limit-points of the underlying set must be the same. Can you show that one contains the other? 4. Let A be a set and x a number. Show that x is a limit-point of A if and only if there exists a sequence Xl , x2, • • . of distinct points in A that converges to x. 5. Let A be a closed set, x a point in A, and B be the set A with x removed. Under what conditions is B closed? 6. Prove that every infinite set has a countable dense subset. Give an example of a set A such that the intersection of A with the rational numbers is not dense in A. 7. Give an example of a set A that is not closed but such that every point of A is a limit-point. 8. Show that the set of limit-points of a sequence is a closed set . 9. Given a closed set A, construct a sequence whose set of limit­ points is A. (Hint: use exercise 6.) 10. Show that the set of numbers of the form k/Sn, where k is an integer and n a positive integer, is dense in the line. 9. 9 Compact Sets 99 11. Show that the set of numbers in the interval [0, 1] having decimal expansions using only odd digits is closed. Describe this set by a Cantor-set type construction. 12. a) Show that the Cantor set is a perfect set that contains no open intervals. Show that it is uncountable. b) Are the same statements true of the set in exercise 11? 13. Define the derived set of a set A as the set of limit-points of A. Prove that the derived set is always closed. Give an example of a closed set A that is not equal to its derived set. Give an example of a set A such that the derived set of A is not equal to the derived set of the derived set of A. (Note: Cantor was originally led to study set theory in order to understand better the notion of derived set and to answer questions similar to the above.) 14. What sets are both open and closed? 15. Show that a union of open intervals can be written as a disjoint union of open intervals. 16. Show that an open set cannot be written in two different ways as a disjoint union of open intervals (except for a change in the order of the intervals). 3.3 Compact Sets Infinite sets are more difficult to deal with than finite sets because of the large number of points they contain. Nevertheless, there is a class of infinite sets, called compact sets, that behave in certain limited ways very much like finite sets. The compact sets of real numbers turn out to be exactly the sets that are both closed and bounded, but this is a theorem and not the definition of compactness. The concept of compactness is not confined to sets of real numbers; we shall deal with it again later in other guises. In what way can an infinite set behave like a finite set? Consider the infinite pigeon-hole principle: if an infinite number of letters arrive addressed to a finite number of people, then at least one person must receive an infinite number of letters. In more conventional terms, if 100 Chapter 3 Topology of the Real Line Xl, X2, ••• is an infinite sequence of real numbers, and each x j belongs to a finite set A then at least one element of A must be equal to X j for an infinite number of j 'so Now if A were an infinite set, this state­ ment is obviously false. However, we could hope for a slightly weaker conclusion: that A contains a limit-point of the sequence. After all, a limit-point is one that is approximated arbitrarily closely infinitely often, and for most purposes such approximation is just as good as equality. Let us take this property as the definition of compactness (there are several other equivalent conditions, and any of them could serve as well for the definition). Definition 3.3.1 A set A of real numbers is said to be compact if it has the property that every sequence Xl, X2, ••• of real numbers that lies entirely in A has a (finite) limit-point in A (or, equivalently, has a subsequence that converges to a point in A). What kind of sets can be compact? Certainly only closed sets. For if A is not closed, it must have a limit-point y not in A; but then by the definition of limit-point we could construct a sequence Xl, X2, ••• of points in A that converge to y. Thus y would be the sole limit-point of the sequence, and the defining condition of compactness would fail. For similar reasons an unbounded set can never be compact. Indeed if A is unbounded we can find a sequence of points Xl, X2, •.• in A such that Xn > n or Xn < -n, and such a sequence clearly has no finite limi t-point. Thus only closed and bounded sets can be compact. We will show, conversely, that all closed and bounded sets are compact. The proof will be easy because we know that every bounded sequence has a finite limi t-point. Theorem 3.3.1 A set of real numbers is compact if and only if it is closed and bounded. Proof: We have already seen the necessity of the conditions that the set be closed and bounded. Conversely, let A be closed and bounded, and let Xl, X2, '\" be any sequence of points in A. Since A is bounded, the sequence is bounded; and we have proved that a bounded sequence possess a limit-point. But A is closed and contains all its limit-points, 9. 9 Compact Sets 101 so we need only show that a limit-point of the sequence is a limit-point of the set. Actually this is a statement about limit-points that is false in general. Nevertheless we can still save the proof. Recall that y is a limit-point of the sequence if every neighborhood of y contains infinitely many points in the sequence. For y to be a limit-point of the set, every neighborhood of y must contain points of A not equal to y. Clearly the only way things could go wrong would be if all these points were equal to y. But if y ever appears in the sequence that means y is in A, which is what we are trying to prove. Thus to complete the proof we need only consider first the special case when the limit-point y appears in the sequence-in that case y is already in Aj and then in the contrary case, when y never appears in the sequence, we can conclude that y is a limit-point of A and then that y is in A since A is closed. QED We consider now another property of compact sets that resembles a property of finite sets. This may seem rather artificial at first, but it twns out to be extremely useful. We introduce the concept of a cotler of a set A, which is any collection of sets, finite or infinite in number, whose union contains A. We have the obvious \"picture\" of the sets in the cover covering A. Now if A is a finite set, we clearly have no need for an infinite number of sets to cover it. Nevertheless, by very bad planning, we might find ourselves with an infinite collection B of sets that cover A. In that case we could certainly simplify things by throwing away all but a finite number of the sets in B. We need only select one set containing each point of A and throw the rest away as redundant. We define a subcotler of a cOtler to be a subset Bl of B that is still a cover (note that in B we are dealing with a set of setsj the \"subset\" in the definition refers to the big collection .8, not to the individual sets in 8 that are either accepted whole into 81 or discardedj similarly when we speak of finite covers we mean that the big set B should be finite, consisting say of B1 1 B2 ,' .. , Bn, but the sets Bj themselves may be infinite) . Then we can express this trivial property of finite sets as follows: etlery cOtler contains a finite subcotler. Again we have a statement that is obviously false for any infinite setj just consider a cover by sets with one element. The remarkable fact is that we obtain a true principle for compact sets by simply requiring the sets in the cover to be open sets! We call such a cover an open cotler. Why should an open cover be better than an arbitrary cover? 102 Chapter 3 Topology of the Real Line Essentially because it is quite difficult to cover things with open sets. Two open intervals that intersect must overlap, and two open intervals that just nestle together fail to cover the point in between, as in Figure 3.3. 1. ( ( Figure 3.3. 1: Let us attempt to cover the closed interval [0, 1] by open sets so that no finite subcover exists. We might try something like (1/2, 2) , (1/3, 1) , (1/4, 1/2) , (1/5, 1/3) , and so on, as in Figure 3.3.2 . • • .. � � � • � � • • • • ) • 0115 114 113 112 1 2 Figure 3.3.2: Clearly we cannot remove �ny one of these sets without uncovering a point (if we remove (l/(n + 2), l/n) we uncover the point l/(n + 1)). Of course we have not quite covered the closed interval [0, 1]. We have missed the point O. Well, why not just add one more set to the cover to cover O. Aye, but there's the rub! The set must be open, and, therefore, it must contain a neighborhood of zero, say (- l/n, l/n). But then we can use this set and discard all but a finite number of the other sets; we need keep only (1/2, 2) and (l/(k + 2), l/k) for k = 1, 2, ... , n - 1. Well, perhaps we need to try a more ingenious method of covering. I will not pursue the matter but invite you to try your own ideas for covering the closed interval [0, 1] by an infinite number of open sets so 3. 9 Compact Sets 103 that no finite subcover exists. Remember that you must cover every point and that you must show that no finite sub cover is possible, not merely that one particular attempt to find a finite sub cover fails. I promise you it will be a frustrating experience. Let's turn the problem around, then, and try to find sets that do not have the property that every open cover has a finite subcover. We have already found one such set, namely (0, 1] . Note that this set is not closed because it does not contain the limit-point O. Can we show that every set that fails to be closed fails to have this property? Stated in contrapositive form, if every open cover of set A has a finite sub cover, can we prove that A is closed? Suppose y is a limit point of A. We have to show y is in A. Suppose it were not. We want to construct an open cover of A with no finite subcover. Let's try the complements of closed intervals [y - lin, y + 1/n]-we take complements of closed intervals to get open sets. Clearly this covers the whole real line except for the point y and so covers A since y is not in A. Suppose it had a finite subcover. Since these are nested sets (they increase with n) , this would mean that a single one contains A, as in Figure 3.3.3. A ) • ( A y -lln y y+ lin Figure 3.3.3: But this means the neighborhood (y - lin, y + lin) of y contains no points of A, contradicting the fact that y is a limit-point of A. Thus only closed sets can have this property. We can also easily show that only bounded sets can have this property. For the open sets ( n, n + 2), with n varying over all integers, cover the whole line, hence any set A. If a finite number cover A, then A is bounded. So far we have shown that if a set has the property that every open cover has a finite subcover, then the set must be closed and bounded, hence compact. The converse is also true and is called the Heine-Borel Theorem. You may very well feel at this point that such a theorem could not possibly be very interesting-I certainly felt that way when I first encountered this theorem. I hope that when you see the way this theorem is used, you will gain an appreciation for it. 104 Chapter 3 Topology of the Real Line Theorem 3.3.2 Every open cover of a compact set has a finite sub­ cover. Proof: Let A be a compact set and 8 an open cover. As a first step we show that B has a countable subcover. (This part of the argument does not use the fact that A is compact.) The idea is that, although there are an uncountable number of open sets, there exists a countable set of open sets-namely, the open intervals with rational endpoints­ that suffices for most purposes. Clearly the open intervals with rational endpoints form a countable set because they are indexed by a pair of rational numbers-the endpoints. We will choose a subcover of B that is in one-to-one correspondence with a subset of the collection of open intervals with rational endpoints and, hence, is a finite or countable subcover. Here is how we do it: for each such interval I, we choose one set in 8 that contains I, if there are any. (If there are none, leave well enough alone.) We claim that we still have a cover of A. Indeed, start with any point x in A. We need to show it is covered. Since all of B is a cover, there must be a set B in 8 containing x. ( I ( . ) x Figure 3.3.4: Since B is open, it must contain an open interval I containing x, and by shrinking the interval I if need be, we can arrange for it to have rational endpoints, as shown in Figure 3.3.4. So now we have the existence of at least one set in 8 containing Ii hence we must have selected a set in B containing I for our sub cover, and since x is in I, it is covered. Thus we have a sub cover B1, B2, ••• that is at most countable (if it is finite then there is nothing more to prove). We now come to the heart of the proof: if we take n large enough, then B1, B2, ... , Bn already covers A. Suppose not. Then for each n there is a point Xn of A that isn't covered by B}, B2, ••• ,Bn. Since A is compact, the sequence x}, X2, ••. has a limit-point x in A. Now, since the infinite collection B} , B2, ... covers A, there must be a Bk that contains x . But Xk, Xk+ b Xk+2, ••• are not in Bk by the choice of the Xk. We now have a contradiction, because if x is a limit-point of the sequence x}, X2 , ••• , the neighborhood 9.3 Compact Sets 105 BIc of x must contain infinitely many of them. The contradiction shows that Bl, •.• ,Bn must cover A for some n. QED The property that every open cover has a finite subcover is some­ times taken as the definition of compactness; in that case the Heine­ Borel Theorem says that every closed, bounded set is compact. To bring these ideas full circle we should prove directly that if A is a set with the property that every open cover has a finite subcover, then every sequence of points in A has a limit-point in A. We already have a two-stage proof of this; the argument given before the Heine-Borel Theorem shows A is closed and bounded, and this implies A is com­ pact. For a more direct proof, consider a sequence Xl, X2,\" • in A with no limit-point in A. Then the closure of the set {Xl , X2, ••• } is closed and contains no points of A other than Xl, X2, ••• • Now the complement of this set is open. Take it as the first set Bo in an open cover. For the other sets Bl, B2, ... in the cover simply choose Bj to be an open interval containing Xj but no other XIc that is not equal to Xj. Then Bo, Bl, B2, ... is an open cover of A, since Bo contains all points of A except Xl, X2, ••• • If this open cover is to have a finite sub cover, then there can only be a finite number of distinct points in the sequence-for Bo contains none of them, and each Bj for j > 1 contains exactly one of them. But if the sequence contains only a finite number of distinct points at least one of them must repeat infinitely often and then that point is a limit-point of the sequence in A. To summarize, we have shown that the following three conditions on a set A are equivalent: 1. A is closed and bounded. 2. Every sequence of points in A has a limit-point in A. 3. Every open cover of A has a finite subcover. There are other equivalent statements, but they are less important and are left as exercises. We conclude this section with an important property of compact sets. A sequence of sets AI, A2, . .. is called nested if An contains An+ 1 for every n. For a nested sequence of sets, the intersection of the first n, Al n A2 n .. . n An, is equal to An, so we may think of the intersection of all of them, r1::l An, as a kind of \"limit\" 106 Chapter 3 Topology of the Real Line of the sequence. If the sets An are all non-empty we might expect this intersection to be non-empty also, but this need not be the case. If we take the sequence of open intervals (0, 1), (0, 1/2) , (0, 1/3) , (0, 1/4) , ... , as shown in Figure 3.3.5, ( ) )) } o 114 113 112 1 Figure 3.3.5: there is no point in the intersection. The same is true if we take for An the closed set {x; x > n}. However, if the sets An are compact, this cannot happen. Theorem 3.3.3 A nested sequence of non-empty compact sets has a non-empty intersection. Proof: Let At, A2, . . . denote the nested sequence. Choose points Xn in An. The sequence XI, X2, .. ' lies in Al by the nesting and has a limit-point X in Al since Al is compact. But x is also a limit-point of Xn, Xn+l, ... and since this sequence lies in An, X must lie in An (again we must argue separately that either x equals one of the points Xn, Xn+I, ... or x is a limit-point of the set {xn, Xn+I, . .. } and, hence, is in An since An is closed}. Since x lies in An for every n, x is in the intersection, so the intersection is non-empty. QED 3. 3.1 Exercises 1. Show that compact sets are closed under arbitrary intersections and finite unions. 2. Show that the following finite intersection property for a set A is equivalent to compactness: if B is any collection of closed sets such that the intersection of any finite number of them contains a point of A, then the intersection of all of them contains a point of A. (Hint: consider the complements of the sets of B.) 9.4 Summary 107 3. If B1, ••• ,Bn is a finite open cover of a comp�.ct set A, can the union Bl U ... U Bn equal A exactly? 4. If A C Bl U B2 where Bl and B2 are disjoint open sets and A is compact, show that An Bl is compact. Is the same true if Bl and B2 are not disjoint? 5. For which compact sets can you set an upper bound on the number of sets in a sub cover of an open cover? 6. For two non-empty sets of numbers A and B, define A + B to be the set of all sums a + b where a is in A and b is in B. Show that if A is open, then A + B is open. Show that if A and B are compact, then A + B is compact. Give an example where A and B are closed but A + B is not. 7. Which of the analogous statements of exercise 6 are valid for the product set A·B (consisting of all products a· b)? Can you modify the false ones slightly to make them true? 8. If A is compact, show that sup A and inf A belong to A. Give an example of a non-compact set A such that both sup A and inf A belong to A. 9. Show that every infinite compact set has a limit-point. Is the same true of closed sets? of open sets? 10. Find necessary and sufficient conditions for A to be the comple­ ment of a compact set. 3.4 Summary 3. 1 The Theory of Limits Definition limj_ooxj = +00 if for every n there exists m such that x j > n for all i > m. Definition y is an upper bound for a set E if x < y for all x in E. 108 Chapter 3 Topology of the Real Line Theorem 3.1.1 For every non-empty set E of real numbers that is bounded above there exists a unique real number sup E such that 1. sup E is an upper bound for E. 2. if Y is an upper bound for E then y > sup E. Definition A sequence Xl , X2, •.• is said to be monotone increasing if Xj +l > Xj for every j. Theorem 3.1.2 A monotone increasing sequence that is bounded from above has a finite limit, equal to the sup . Definition 3.1.1 A real number X is said to be a limit-point of a se­ quence Xl, X2, ••• if for every n there exists an infinite number of terms Xj such that Ix - Xj I < lIn. Definition A sequence YI , Y2 , ••• is said to be a subsequence of X I, X2, ••• if there is an increasing function m{n) (meaning m{n + 1) > m{n) for all n) such that Yn = xm(n) ' Theorem 3.1.3 X is a limit-point of Xl, X2, ••• if and only if there exists a subsequence with limit x. Definition 3. 1.2 1imsuPk_ooXk = limk_ooSUPj>kXj and liminfk_ooxk = limk_ooinfj>kx) . Theorem 3.1.4 The set of limit-points in the extended reals of a se­ quence is non-empty, containing limsup, which is its sup, and liminf, which is its info Theorem 3.1.5 A bounded sequence converges if and only if it has only one limit-point (if and only if the llmsup and liminf are equal). 3.2 Open and Closed Sets Definition A set is open if every point of the set lies in an open intenJal entirely contained in the set. 3.4 Summary 109 Theorem A set of reals is open if and only if it is the disjoint union of at most countably many open intervals. Theorem 3.2.1 Open sets are preserved under arbitrary unions and finite intersections. Definition A neighborhood of a point is an open set containing the point. Theorem x = limj_ooxj if and only if every neighborhood of x con­ tains all but a finite number of the Xj . Definition 3.2.1 x is a limit-point of a set A if every neighborhood of x contains a point of A different from x. Definition A set is said to be closed if it contains all its limit-points. Theorem 3.2.2 A set is closed if and only if its complement is open. Theorem 3.2.3 Closed sets are preserved under finite unions and ar­ bitrary intersections. Definition The Cantor set is the subset of [0, 1] of all numbers ex­ pressible in base 3 with digits 0 and 2. Definition The interior of a set A is the subset of all points which lie in an open interval entirely contained in A. Definition The closure of a set is the union of the set and all its limit-points. Theorem The closure of a set is closed. Definition A subset B of A is said to be dense in A if the closure of B contains A. 110 3.3 Compact Sets Chapter 3 Topology of the Real Line Definition 3.3.1 A set A of real numbers is said to be compact if every sequence of points in A has a limit-point in A. Theorem 3.3.1 A set of real numbers is compact if and only if it is closed and bounded. Theorem 3.3.2 (Heine-Borel) A set is compact if and only if it has the property that every open cover has a finite subcover. Theorem 3.3.3 A nested sequence of non-empty compact sets has a non-empty intersection. Chapter 4 Continuous Funct ions 4. 1 Concept s of Continuity 4. 1.1 Definitions In this section we introduce four important concepts: 1) functions, 2) continuity, 3) uniform continuity, and 4) limits of functions. There are some subtle distinctions to be made here, and it will be important to look at some examples and to pay attention to the motivation behind the definitions. It is more common to define limits of functions first and then base the definition of continuity on the notion of limits. However, it is easier to motivate the definition of continuity, so that is the order we follow. The abstract notion of function is that of a correspondence between sets. Two sets, called the domain and the range, are given; and to each element x of the domain there is given an element f (x) of the range. We will study functions whose domain and range are sets of real numbers, and unless explicitly stated otherwise, the term junction will be reserved for this special case. Definition 4. 1.1 A junction consists of a domain D, a range R-both subsets of the real numbers, and a cofTe8pondence x -+ f{x) where x is a variable point in D and f (x) is a point in R. We do not require that every point in R actually occurs as f{x) for some x in D. We will call the image f{D) the set of values f{x) as x varies in D. The image is a subset of the range. We say the junction is onto if the image equals the III 112 Chapter 4 Continuous Functions range. We say the function is one-to-one if f{xd '# f{x2) if Xl '# X2 for any Xl and X2 in the domain. We will usually take the range R to be the whole real line R, and we will not distinguish between junctions that are the same except for the range Uor example, f (x) = x2 with domain R. and range R and f(x) = x2 with domain R and range y > 0). However we must distinguish between junctions with the same rule and different domains (f(x) = x2 with domain R and f(x) = x2 with domain [0, 1] are different junctions) . Concerning the cOfTespondence X � f(x), we make no assumptions. It may be given by a recognizable rule, or by a bizafTe rule, or by no describable rule at all. We only require that there is a unique value f (x) that can or could be determined if the value of x is given. This might be described as an agnostic view of function. It is one of the broadest views possible-except that we are requiring that the junction be single-valued. This is not the only concept of function that mathematicians have put forth. The concept of a function as a formula was very prevalent during the eighteenth century, but it led to great confusion since the concept of \"formula\" kept changing. Later, when we discuss Fourier series, we will discover that many of the functions in our agnostic sense do have formulas after all. In the twentieth century, various concepts of recursive function and constructible function in which the correspon­ dence x � f{x) must be given in a manner that would in principle be computable, have been put forth. In my opinion it would be impossi­ ble to learn about these concepts without first mastering the agnostic theory presented in this work. Basically there are three ways a function can be specified: 1. Explicitly, the rule x � f (x) is given by a formula, and the domain is specified. 2. Implicitly, the correspondence is given by the solution of an e­ quation involving x and f{x) = y, and the domain consists of all x for which the equation has a solution. In this case you have to be careful about uniqueness of the solution, since we insist on single-valued functions. For example the equation x2 + y2 = 1 does not lead to a single-valued function, but together with the condition y < 0 we obtain the function f(x) = -vI - x2 with domain [- 1, 1]. 4. 1 Concepts of Continuity 113 3. By giving the graph, which is by definition the set of ordered pairs (z, /(z)) where z varies in the domain. We follow the usual Carte­ sian convention of picturing the ordered pairs of real numbers as points in the Euclidean plane. The concept of function, even restricting the domain and range to sets of numbers, is in a way too general to be very interesting. Cer­ tainly in order to do any analysis we have to restrict further the kind of functions with which we deal. In this chapter we will discuss con­ tinuous functions. This is neither the largest nor the smallest class of functions that is convenient for analysis, but it is perhaps the most in­ tuitive. Unfortunately there are many intuitive ideas behind the notion of continuity. Some of them are quite helpful and valid, while others may lead to confusion. Our goal is to provide a rigorous framework to which we can attach our intuitions and to make some subtle but important distinctions that would otherwise slip by. One rather geometric intuitive idea of a continuous function is one whose graph consists of a single, connected piece. Now it is indeed possible to make a precise mathematical definition of connected sets in the plane so that the graph of a continuous function is connected. However, it turns out that there are functions that are not continuous whose graphs are also connected. Thus we will put aside the intuitive idea of continuous as ''without a break\" or \"drawable without lifting the pen\" and turn to other ideas. Let us for the moment think of a function as a mathematical repre­ sentation of a relationship between variables in the real world. Think of a measurement or experiment where the input is x and the output is / (z ). One of the things we require of experimental science is re­ peatability. If we put the input z in several times, we should always get / (z) out. The requirement that a function be single-valued would seem to take care of this, but in fact it is not enough. The reason is that in any real situation we cannot control the input exactly, any more than we can measure the output exactly. So / (Zl) and /(Z2 ) might represent outputs of what we believe to be identical experiments if Zl and Z2 are very close to each other. Therefore the requirement of repeatability is actually that very close values of the input should yield very close values of the output. This is exactly the intuitive idea behind continuity. 114 Chapter 4 Continuous Functions Let us look at the situation a little more closely. What do we mean by very close values of the input and output? Clearly we must be referring to some condition like Ix - xol < lIn for the input and I/{x) - f(xo}l < 11m for the output, where lIn and 11m are small errors. The statement ''very close values of the input yield very close values of the output\" then should translate into \"Ix - xo l < lIn implies II (x) - 1 (xo) I < 1 1m\" . But this is still vague, for we have not specified the relationships between the errors lIn and 11m. We have the correct statement, but we have to decide on the quantifiers and their order. To help us decide, let's ask how small an error in the output we would accept. Would 1/10 be good enough? Or 1/100 or 1/1023? Isn't the tolerance for error in the output a relative judgment-one that should not be made once and for all? Today we might be happy with an error of 1/1, 000, but tomorrow we might want to do better. To build a mathematical theory on a fixed notion of acceptable error would be absurd. We must have the flexibility to make the error in the output as small as we like. Thus the first quantifier must be \"for all errors 11m in the output\" . To meet any given tolerance for error in the output , we may have to take drastic action to control the error in the input. Again we do not want to say in advance how small this error must be; only that some small error in the input will do the trick. Thus the second quantifier must be \"there exists an error 1 I n (depending on 1 1m) in the input\" . Altogether we now have: \"for every 11m there exists lIn such that Ix - xol < lin implies I f (x) - f (xo)1 < 11m\" . In the familiar f. - 6 formulation we would write 6 for lin and f. for 11m. We are not quite done, for we have not specified what x and Xo are and how the errors 11m and lIn relate to them. This is by no means a trivial question. In fact there are two distinct concepts that await the resolution-in two different ways-of this question. Let us imagine that Xo is the value-perhaps idealized-of the input variable in which we are interested. Then x represents a nearby value, which must be allowed to vary over the domain of the function with no control other than the error specification Ix - xo l < lIn. This leads to the definition of continuity at a point Xo: for every 11m there exists lIn such that for every x in the domain of the function with Ix - xo l < lIn we have I/(x) - l(xo)l < 11m. The error lIn depends on 11m and on Xo; the dependence on Xo need not be mentioned in this definition, since Xo is fixed. However, when we define a continuous function to �. 1 Concepts of Continuity 115 be a function that is continuous at every point of its domain, this dependence becomes important. The best way to see this is through an example. Let's show that the function f(x) = l/x on the domain x > 0 is continuous. We fix a point Xo in the domain. Given any error l/m, we need to find an error l/n such that Ix - xol < l/n and x > 0 (x in the domain) implies 11/x - l/xol < l/m. Now we compute l/x - l/xo = (xo - x)/xxo; and if we are to bound this from above, we need to bound xXo from below. Since Xo does not vary, the problem is to keep x from getting close to zero. Thus we want to require something like l/n < xo/2, for then Ix - xol < l/n implies x > xo/2, as in Figure 4.1.1. Then • o 1 1 x Xo ( . Figure 4.1.1: < Ix - xol 2 I I \"----� < - x - Xo xXo - x5 < 2 nx2 o and we need 2/ nX5 < 1/ m. Running the argument backward, if we choose l/n to be less than xo/2 and less than x5/2m, we have Ix -xol < l/n (the condition x > 0 is now redundant) implies 11/x - 1/xol < l/m. This demonstrates the continuity of the function at each point of its domain. Note, however, that the error lin depends on the point Xo . As Xo gets closer to zero the error l/n must be made smaller in order to guarantee the same error l/m in the output. This is clear from the graph of the function, as shown in Figure 4. 1.2. 116 1/ Xo -------� ------- I I I I I I I I Chapter 4 Continuous Functions y = 1/x ------- . ------- 1 --------------- � __ I I I I I I I I • I I I I I o�----�----�----------�------------ Xo Figure 4.1.2: Of course this function is not even bounded near x = 0, so we might expect trouble. The trouble with which we are dealing, however, can turn up even for bounded functions. For example, consider a function with domain (0, 1] whose values zigzag between ° and 1, hitting ° at lin for n even and 1 at lin for n odd, as shown in Figure 4.1.3. If we want the error in the output less than 1/2, we will have to restrict Ix - xol severely if Xo is close to 0, and no condition Ix - xol < lin will work for all Xo in the domain (for example, it fails for Xo = lin). In both examples the domain of the function isn't closed, and the trouble arises near a limit-point that is not in the domain. Later we will see that if the domain is compact this situation can't arise. If the error in the input Ix - xol < lin can be chosen so as to make the error in the output If(x) - f(xo)1 < 11m for all points x and Xo in the domain, then we have a stronger condition than continuity, which is called uniform continuity. We summarize the discussion in a formal definition. 4.1 Concepts of Continuity 1 1 1 1 1 65 4 3 1 2\" Figure 4.1.3: 117 1 Definition 4.1.2 Let f be a function on a domain D. Let Xo be a point of D. We say I is continuous at Xo if for every 11m there exists lin such that I/(x} - f(xo}1 < 11m lor every x in D satisfying Ix - xo l < lin . We say f is continuous if for every Xo in D and lor every 11m there exists lin (depending on Xo and 11m) such that If{x) - l{xo}1 < 11m lor every x in D satisfying Ix - xol < lin . We say I is uniformly continuous if for every 11m there exists lin such that If(x} - f{xo} l < 11m for all x and Xo in D satisfying Ix - xo l < lin. If f is continuous at xo, then the values of f(x} for x near Xo are approximating the value f(xo). This suggests a close relationship between the concept of continuity of functions and limits of sequences. We can make . the analogy stronger if we introduce a related concept, the limit of a function. Let f be a function defined on a domain D, and let Xo be a limit-point of D. We do not require that Xo be actually in D-frequently we will want to take D to be an open interval and Xo an endpoint. The reason we require Xo to be a limit-point of D is that we need values of x in D nearby. We want to define the limit of f (x) at Xo to be the number, il it exists, that is approximated by f (x) for x near Xo. For purposes of defining the limit we will ignore the value f(xo} if 118 Chapter 4 Continuous Functions Xo happens to be in the domain-this being a convention chosen not for compelling reasons but for convenience in certain applications. Definition 4.1.3 Let / be a junction defined on a domain D, and let Xo be a limit-point of D. We say / has a limit at Xo if there exists a number y, which we call the limit 0/ / at Xo and write y = limx_xo /(x), such that for every 11m there exists lin such that I f(x) - yl < 11m for all x in D not equal to Xo satisfying Ix - xo l < lin. The number y, if it exists, is unique for the same reason that the limit of a sequence, if it exists, is unique. There is no requirement that the limit have anything to do with /(xo), if Xo happens to be in D, since we have made the convention of excluding the value x = Xo. Thus the function equal to 1 for all values of x =F 0 and 0 for x = 0, as shown in Figure 4.1.4, has limit 1 at x = O. j(x) Figure 4.1.4: Comparing the definition of limit of a function with limit of a se­ quence we see that the only difference is that the condition of going far out in the sequence is replaced by the condition of going near the point Xo· The connection between the definitions of limit of a function and continuity is also clear. A function is continuous at a point Xo in its domain that is a limit-point 0/ its domain if and only if f has a limit at Xo and the value of f(xo) equals limx_xo f(x). If Xo is a point of the domain that is not a limit-point of the domain, then the definition of continuity is trivially valid-we take lin so that the only point of the domain satisfying Ix - xo l < lin is x = Xo itself. Thus every function is continuous at a non-limit-point (called an isolated point) of its domain, and we normally will not be interested in this trivial case. 4. 1 Concepts of Continuity 119 4. 1.2 Limits of Functions and Limits of Sequences Now let us further examine the connection between the notion of limits of functions and sequences. Let Xo be a limit-point of the domain D of a function, and let Xl! X2, . .. be a sequence of points in D, none equal to xo, that converges to Xo. Then we would expect the sequence /(xd, /(X2), . . . to converge to limx-xo f(x), if the limit exists, for by going far out in the sequence we make IXi - xo l < lin. Of course there are usually an uncountable number of points in the domain sat­ isfying Ix - xo l < lin, so we cannot expect that the convergence of f(xd, f(X2), . .. for any one sequence will contain as much informa­ tion as the existence of the limit of the function. In the example of the zigzag function in Figure 4. 1.3, the function does not have a lim­ it as x � 0; but if we choose the sequence 1, 1/3, 1/5, 1/7, ... where the function takes on the value 1, then the sequence /(1), f (1/3) , ... is just 1, 1, 1, . . . and so has the limit 1. Of course it was only by a careful choice of the sequence of points that we were able to come out with a limit; the sequence 1, 1/2, 1/3, 1/4, ... also converges to zero, but 1(1), 1 (1/2) , (1/3) , ... is the sequence 1, 0, 1, 0, ... , which has no limit. This suggests that perhaps the convergence of /(XI), f(X2), . . . for ev­ ery sequence Xl! X2, ' .. converging to Xo is equivalent to the existence of limx_xo f (x). This is indeed the case. Theorem 4. 1.1 Let Xo be a limit-point of the domain D of a function f· Then limx-xo f (x) exists if and only if f ( Xl), f (X2), . . . converges for every sequence Xl ! X2, ... of points of D, none equal to xo, converging to Xo. It is not necessary to assume that the limit of all the sequences is the same, although this must be true, and the common limit is equal to the limit of the function. Proof: Suppose limx_xo f(x) = y exists, and let XI ,X2, ... converge to Xo. Given any error 11m, we want to make If(xj ) - yl < 11m by going far out in the sequence. Now first by the existence of limx_xo I(x) we know we can make If(x)-yl < 11m by taking Ix -xol < lin, where lin depends on 11m and Xo. We would like to apply this to x = Xi , so we must next use the convergence of the sequence Xl! X2, .. . to Xo. Given lin, there exists k such that IXi - xo l < lin for all j > k, by this convergence. Also x j =F Xo by assumption. Thus we can apply the implication Ix - xo l < lin implies //(x) - y/ < 11m derived above to 120 Chapter 4 Continuous Functions x = Xj if j > k, and we obtain j > k implies If(xj) - yl < 11m. Thus we have established the convergence of f(XI), f(X2), ... to y. Conversely, suppose the sequences f(xI ), f(X2), ... always converge if Xl , X2, ... converges to xo, with the Xi in D and different from Xo. We want to show this implies the existence of the limit of the function limx_xo f(x) . First we claim all the sequences f(xd, f(X2), ... have a common limit, for if not we could shufBe two sequences with different limits. In other words, if Xl , X2, . .• and YI , Y2, ... both converge to Xo and f(xI), f(X2), ... converges to a and f(yt} , f(Y2), 0 0 0 converges to b with a # b, then the shufBed sequence Xl, YI , X2 , Y2 , . 0 • still has limit Xo but the shufHed sequence f(xt}, f(YI), f(X2), f(Y2), 0 • 0 does not converge, contradicting the hypotheses. Thus there is a common limit, call it y, of all the sequences f(xt}, f(X2), .00 0 This is the value that we will show is equal to limx_xo f(x). Suppose limx_xo f(x) = Y were false. Negating the definition leads to the statement: there exists 11m such that for all lin there exists a point Zn in the domain, not equal to xo, such that IZn - xol < lin, and yet If(zn) - yl > 11m. This is the statement that we must show leads to a contradiction. But if this statement were true, the sequence {zn} would converge to Xo (since IZn - xo l < lin) and yet f(zt }, f(Z2), ... would not converge to y, since If (zn) - yl > 11m for every n. This contradicts the fact that f(ZI ), f(Z2), ... converges to Y that we just established. QED This theorem has a very striking consequence regarding continuous functions. Suppose f is continuous, and let Xl, X2, ... be any sequence of points in the domain that converges to a point Xo in the domain (with none of the Xj equal to xo). Then Xo is a limit-point of the domain; and since limx_xo f(x) exists and equals f(xo), we have that f(XI), f(X2), ..• converges to f(xo). We can paraphrase this by saying that the image under f of a convergent sequence (converging to a point in the domain) is convergent. We can easily remove the artificial re­ quirement that none of the Xi equal Xo; however the condition that Xo be in the domain is crucial, as the zigzag example shows. The converse is also true, so we can characterize continuous functions as those that preserve convergent sequences or, equivalently, as those that commute with sequential limits, f(limj_oo Xj ) = limj_oo f(xj ). 4. 1 Concepts of Continuity 121 Theorem 4.1.2 Let f be a junction defined on a domain D. Then f is continuous if and only if for every sequence of points XI, X2,.\" that has a limit in D, the sequence f(xd, f(X2}, ... is convergent. It is not necessary to assume that the limit of the sequence f(xt}, f(X2}, .. . 18 equal to f(limj_oo Xj }, but this follows from the hypotheses. Proof: The proof is quite similar to the proof of the previous the­ oremj we could in fact reduce it to the proof to the previous theorem, at the expense of a lot of special cases. Suppose first f is continuous. Then if Xl , X2, . .. converges to Xo we can show f(xI), f(X2}, . . . converges to f(xo} by the same argument as in the previous theorem: given 11m we first find lIn such that Ix - xo l < lIn implies If(x} - f(xo} 1 < 11m by continuity of f and then find k such that j > k implies IXj - xo l < lin, by the convergence of Xl , X2 ,··· to Xo. Then j � k implies If(xj) - f(xo)1 < 11m. For the converse we first use the shuffling argument to show the limit of the sequence f(xI ), f(X2}, ... is the same for all sequences Xl, X2, ... converging to the point Xoj and since Xo, Xo, .. . is one such sequence and the limit of f(xo}, f(xo}, . . . is !(xo), it follows that the common limit of all these sequences is f(xo}. Now if Xo is not a limit-point of D there is nothing to prove, while if Xo is a limit-point of D the previous theorem implies limx_xo f (x) exists and equals the common limit !(xo). Thus ! is continuous at Xo. QED 4. 1.3 Inverse Images of Open Sets We now have two equivalent characterizations of continuity, and we will presently find a third. Recall that we were able to characterize conver­ gent sequences entirely in terms of open sets: Xl, X2, . . . converges to Xo if for every neighborhood of Xo, all but a finite number of terms in the sequence lie in that neighborhood. Similarly we can rephrase the defini­ tion of continuity of f at Xo as follows: for every neighborhood of f(xo} there exists a neighborhood of xo that is mapped into the neighborhood of f (xo} by f. If we denote by M the set {y : Iy - f(xo}1 < 11m} and N the set {x : Ix - xo l < lIn}, then the statement \"f maps N into M\" is the same as \"Ix - xo l < lIn implies If(x} - !(xo} 1 < 11m\" . Now if A is any subset of the range of f, we denote by f -l (A), the inverse image of A under f, the set of points x in the domain of f such that f (x) is in A. The fact that f maps N into M is the same as saying N 122 Chapter 4 Continuous Functions is contained in f- l (M) and so continuity at Xo becomes: the inverse image of every neighborhood of f(xo) contains a neighborhood of Xo . It is important to convince yourself that it is the inverse image that be­ longs in this statement. It is not true that the image of a neighborhood of Xo under a continuous function ! contains a neighborhood of !(xo); for example, a constant function is continuous, but its entire image is a single point . The situation actually improves if we reformulate the definition of continuity on the whole domain rather than at a single point . For simplicity we assume that the domain is an open set. (We will return to this in Chapter 9.) Theorem 4. 1.3 Let f be a function defined on an open domain. Then ! is continuous if and only if the inverse image of every open set is an open set. Proof: First suppose f is continuous. Let A be an open set of real numbers. We want to show f- l (A) is open. To do this we need to show that every point in 1- 1 (A) is contained in an open interval lying in 1-1 (A) . Of course f-1 (A) may be empty, but in that case there is nothing to prove since the empty set is open. So suppose Xo is in 1- 1 (A). This means that Xo is in the domain of I and !(xo) is in A. Since A is open, there is an open interval about I(xo), say {y : Iy - l(xo)1 < 11m}, contained in A. By the continuity of I, there is an open interval about xo, Ix - xo l < lIn, that is mapped into the interval about !(xo) (actually the definition says Ix - Xo I < lIn and x in the domain implies If(x) - f(xo)1 < 11m, but since we have assumed the domain is open, we can arrange that Ix -xol < lin implies x is in the domain by taking lIn small enough). But this implies that the interval Ix - xo l < lIn lies in !-l (A), which shows that 1-1 (A) is open. Conversely, suppose f- l (A) is open for every open set A. We want to show that f is continuous at every point Xo of the domain. To do this we have to show that given any 11m we can find lIn such that Ix - xol < lIn implies I/(x) - !(xo ) 1 < 11m. Let us choose for A the open set {y : Iy - !(xo)1 < 11m}. By hypothesis 1- 1 (A) is open. Note that Xo is in 1- 1 (A), for I/(xo) - !(xo)1 = O. Since Xo is a point of the open set 1- 1 (A) , there is an open interval about xo, say Ix - xo l < lin, 4. 1 Concepts 01 Continuity 123 contained entirely in 1-1 (A). But this means that Ix-xo l < lin implies I(x) is in A, and by the choice of A, I/(x) - l(xo)1 < 11m as desired. QED This last characterization of continuous function may be furthest from the intuition of continuity, but it is undeniably simple and elegant. It is extremely general-we will see that it is valid also for functions of several variables-and it is in fact taken to be the definition of conti­ nuity in general topology. There is a similar characterization in which open sets are replaced by closed sets, if the domain of I is closed. This is not at all surprising in view of the fact that complements of open sets are closed, but it is an important fact. We leave the details to exercise set 4. 1.5, number 1. If the domain of f is the whole line, then both results apply. In particular, a set defined by an \"open\" condition like I(x) > a is open and a set defined by a \"closed\" condition like I(x) > a or I(x) = a is closed. See exercise set 4.1.5, numbers 2 and 3 for related results. 4. 1. 4 Related Definitions Continuity is a qualitative property, in that it concerns a relation be­ tween the error of the input and error of the output that is not spec­ ified. It is not surprising that there are many related quantitative properties-where the relation between the errors takes on a specific form. The simplest possible form is proportionality-the existence of a constant M such that Ix - xol < 11Mm implies I/(x) - f(xo)1 < 11m. It is simple to see that this is equivalent to the condition I/(x) - l(xo) 1 < Mix - xo l· If this holds with a fixed M for all x and Xo in the domain we say I satisfies a Lipschitz condition. A typical function satisfying this con­ dition is f (x) = Ix I, where the constant M can be taken equal to 1. Other variants of this are the Holder conditions of order a, 0 < a < 1 (sometimes referred to as Lipschitz conditions of order a): I/{x) - f(xo) 1 < Mix - xola• This implies continuity in that If(x) - f(xo) 1 < 11m if Ix - xol < 1/{mM)1/a. Another way of thinking about these conditions is to 124 Chapter 4 Continuous Functions define the modulus of continuity w(xo, 8) of f to be the sup of the values If(x) - f(xo )1 as x varies over the interval Ix - xol < 8. The condition that f be continuous at Xo is the statement that w(xo, 8) as a function of 6 has limit 0 as 6 -+ 0, while the quantitative conditions describe the rate of convergence w(xo, 6) < M 6 for the Lipschitz condition. Generally speaking, for every theorem about continuous functions, there is an analogous quantitative version for Lipschitz functions, which can be proved by similar methods. There are many circumstances when we will want to consider limits and continuity that are one-sided. For example, consider the signum function _ { +1 if x > 0, sgn x - l'f 0 - 1 X < . The domain of this function is all x i= 0, although sometimes one takes the convention sgn 0 = 0 to have the function defined on the whole line. The graph is shown in Figure 4. 1.5. +I�'----------------- • '0 -I I • Figure 4.1.5: sgn x This function does not have a limit at x = 0, because if you approach 0 from positive numbers the value is 1 while if you approach from negative numbers the value is - 1. We would then like to say limx_o+ sgn x = + 1 and limx_o- sgn x = - 1, and it is not hard to define such limits from above and below (or right and left) to make this so. By limx_xt f (x) = y (where Xo is a limit-point of the domain) we will mean for every lIn there exists 11m such that Xo < x < Xo + 11m, and x in the domain implies If(x) - yl < lIn, while by limx_xo f(x) = y we will mean the same condition with now Xo - 11m < x < Xo. Similarly we will say 4. 1 Concepts of Continuity 125 that 1 is continuous from the right at Xo if 1 (xo) = limx_xt 1 (x) and that 1 is continuous from the left at �o if I(xo} = limx_x; I(x}. Clearly continuity is the same as continuity from both the left and right . The choice sgn 0 = 0 makes the signum continuous from neither side at 0, but a different convention would allow us to have one or the other but not both. The kind of discontinuity that signum has is called a jump discon­ tinuity or discontinuity 01 the first kind. The definition is that both limx_xt I(x) and limx_xo I(x) should exist and be different. Any worse discontinuity, where one or another one-sided limit does not ex­ ist, is called a discontinuity of the second kind. If we adjoin 0 to the domain of the zigzag function (Figure 4.1.3) it will have such a dis­ continuity there. There is another technical kind of discontinuity, in which the limit exists at Xo but is different from f(xo). This is called a removable discontinuity, because if we simply redefine the function at Xo to equal its limit then we will have a continuous function there. An example is the function f(x) = { 1 �f x # 0, o If x = O. It is not unreasonable to think of removable discontinuities as simply mistakes that can be, and should be, corrected. The one-sided limits we have discussed involve restricting the do­ main of the function to one side of the point. There are also concepts of upper semi-continuity and lower semi-continuity that involve restrict­ ing the range of the function. These are less frequently used and will not be needed in this book. Finally we note that it is often convenient to allow the extended real numbers ±oo to appear in limits, in either the domain or range. We leave it to the reader to supply the obvious meaning for statement like lim I(x) = y and lim I(x) = +00. x-+oo x-q 4. 1.5 Exercises 1. Let 1 be a function defined on a closed domain. Show that 1 is continuous if and only if the inverse image of every closed set is a closed set. 126 Chapter 4 Continuous Functions 2. Let A be the set defined by the equations It (X) = 0, 12 (X) = 0, . . . , In{x) = 0, where iI, ... , In are continuous functions defined on the whole line. Show that A is closed. Must A be compact? 3. Let A be the set defined by the inequalities 11 (x) 2': 0, h(x) 2': 0, ... ,f n (x) > 0 where II , ... ,f n are continuous functions defined on the whole line. Show that A is closed. Show that the set defined by It (x) > 0, ... , In(x) > 0 is open. 4. Give a definition of limx_oo I(x) = y. Show that this is true if and only if for every sequence Xl , X2, ... of points in the domain of I such that limx_oo Xn = +00, we have limn_oo I{xn) = Y. 5. Show that the function I{x) = xi3 on [0, 1] for 0 < {3 < 1 satisfies a Holder condition of order a for 0 < a < {3 but not for a > (3. 6. Let I have a jump discontinuity at Xo. Show that if Xl , X2 , ... is any sequence of points in the domain of ! converging to xo , with no Xj equal to xo, then the sequence l{xI ), I(X2 ), ... has at most two limit-points. 7. Give an example of a continuous function with domain R such that the inverse image of a compact set is not compact. 8. Give an example of a continuous function with domain lR such that the image of a closed set is not closed. 9. Show that the function I{x) = x2 with domain 0 < X < 00 is one­ to-one but the function I(x) = x2 with domain R is not. What is the image of these functions? Are they uniformly continuous? 10. Show that a function that satisfies a Lipschitz condition is uni­ formly continuous. 11. If I is continuous on R, is it necessarily true that f{limsupn_ooxn) = limsupn_oo/{xn)? 12. If I is a continuous function on 1R, is it true that X is a limit-point of Xl, X2, ... implies I(x) is a limit-point of !(XI), I(X2), ... ? 13. Is the inverse image of a convergent sequence under a continuous function necessarily a convergent sequence? 4.� Properties of Continuous Functions 127 14. Show that f-1 (A U B) = f-l (A) U f-l (B) and f-l (A n B) = f-l (A) n f-l (B) for any function f. Is the same true of images (as opposed to inverse images)? 15. If f is defined on a finite open interval ( a, b) and uniformly con­ tinuous, show that the limit of f exists at the endpoints and I can be extended to a uniformly continuous function on the closed interval. 4.2 Properties of Continuous Functions 4.2 .1 Basic Properties We begin with some simple observations on the preservation of conti­ nuity under arithmetic operations. Suppose f and 9 are defined on the same domain D. Then by 1+ 9 we mean the function with domain D that takes the value I{x) + g(x) at x. Even if I and 9 have different domains, we can define I + 9 on the intersection of their domains. If I and 9 are both continuous, then I + 9 will also be continuous. This follows immediately from the characterization of continuity in terms of taking convergent sequences to convergent sequences and from the fact that the sum of convergent sequences is convergent. This property is expre�ed by saying the continuous junctions are preserved by addition or the sum 01 continuous junctions is continuous. This is true whether we consider continuity at a point or continuity on the whole domain. (For uniform continuity and Lipschitz conditions, see the exercises.) Clearly the same is true for scalar multiples ai, differences f - g, and products I· g. For quotients f / 9 we must avoid dividing by zero. If we have I and 9 defined and continuous on D, then f / 9 will be defined and continuous on the subset of D of points where 9 is not zero. It may happen that f / 9 can be further defined and continuous at points where both I and 9 are zero, but this has to be determined on a case­ by-case basis. We will return to this when we discuss l'Hopital's Rule in Section 5.4.3. Since the constant functions and the identity function I (x) = x are easily seen to be continuous, if follows that all rational functions p{ x) / q{ x) where p and q are polynomials are continuous on the domain {x : q( x) ;f: o}. This gives us a large collection of continuous functions. 128 Chapter 4 Continuous Functions Most of the special functions, such as sin x, cos x, eX, log x, are also continuous. We will prove this when we give the precise construction of these functions. Continuous functions can also be created by gluing together con­ tinuous pieces. If f is defined and continuous on [a, b) and 9 is defined and continuous on [b, c) with f(b} = g(b}, then h(x} = { f(X}, a < x < b, g(x), b < x < c, is continuous on [a, c) . The proof is left to the exercises. The maximum and minimum of two continuous functions are also continuous. If f and 9 are defined on the same domain D, let max(f, g) denote the function on D that at x takes the value f (x) if f (x) > 9 (x) or g(x} if g(x} > f(x}; define min(f, g} similarly. (Note that the graphs of f and 9 may cross each other infinitely often, so we cannot reduce this to a gluing argument.) Theorem 4.2.1 Iff and 9 are continuous, then max(f, g) and min(f, g) are continuous. Proof: Fix a point Xo in the domain; and suppose f(xo) > g(xo), so max(J, g)(xo} = f(xo}. To show max{f, g) is continuous at Xo we have to show that for each l/m there exists l/n such that Ix - xol < l/n implies I max(f, g)(x} - max(f, g)(xo)1 < l/m. We know that f and 9 are continuous at xo , so given l/m we can find l/n (take the smaller of the two values for f and g) such that Ix - xol < l/n implies If(x} - f(xo}1 < l/m and Ig(x} - g(xo}1 < l/m. This l/n will do the job for max(f, g}. To see this we have to examine the two possibilities, max(f, g)(x) = f(x} or g(x). In the first case f(x) - f(xo} = max(f, g)(x) - max(f, g)(xo}, so If(x) - f(xo} 1 < l/m gives the result we want. In the second case we have g( x) > f (x) and max(f, g)(x} - max(f, g)(xo} = g(x} - f(xo). Now g(x) - f(xo} > f{x} - f(xo} because g(x} > f(x}, while g(x) - f(xo) < g(x} - g(xo) since f(xo) > g(xo}. So Ig(x} - f(xo}1 < max(lf(x} - f(xo}l, Ig(x} - g(xo)1) < l/m. QED Using these kinds of ideas it is generally speaking possible to con­ struct continuous functions that will do whatever you like. For example, 4.2 Properties 01 Continuous Functions 129 suppose we want to construct a continuous function 1 (x) on the line that is equal to zero exactly on a set A. We know (exercise set 4.1.5, number 1) that the set of solutions to I{x) = 0 is closed, so A will have to be closed, but no other restrictions on A are needed. To construct the function 1 we look at the complement of A, which is open. By our structure theorem for open sets, the complement of A is an at most countable union of disjoint open intervals so that the whole line is a disjoint union of A and some open intervals. The function 1 will be zero on A, and on each open interval we construct a tent (see Figure 4.2.1), Figure 4.2. 1: which rises with slope 1 to the midpoint and falls with slope - 1 to the end. For the infinite intervals {there are at most two of them, (a, 00 ) and (-00, b) ) we keep the slope +1 or - 1 throughout. The total picture might resemble that in Figure 4.2.2. From the construction it is clear that 1 = 0 exactly on the set A. Figure 4.2.2: It remains to see that 1 is continuous. But in fact 1 satisfies the Lipschitz condition I/{x) - /{y)1 < Ix - yl, which implies continuity. We leave the verification of the Lipschitz condition to the exercises. 130 Chapter 4 Continuous Functions We now turn to the properties of continuous functions. One proper­ ty that seems obvious is that a continuous function must pass through all intermediate values on its way from one value to another. If I( a) = YI and I(b) = Y2, with I continuous on [a, b] (or some larger domain) with say YI < Y2 , then for any value of Y in between, YI < Y < Y2 , there must exist at least one solution of I(x) = Y in (a, b). This is certainly evident graphically, as shown in Figure 4.2.3, if we imagine a moving horizontal line going from height Yl to height Y2, the intersections of this line with the graph of I gives the solutions to Y = I(x). Y2 ../ Y .r � ./ / � Yl a b Figure 4.2.3: Theorem 4.2.2 (Intermediate Value Theorem) Let I be a continuous junction on a domain containing [a, b] , with say I(a) < I(b) . Then lor any Y in between, I(a) < Y < I(b), there exists x in (a, b) with I(x) = y. Proof: We use the divide and conquer method. We repeatedly bisect the interval, retaining the half that might contain a solution. In other words, fixing a value of y, we consider a sequence of in­ tervals [aI, bt1, [a2, �], ... where [ab bl) is the original interval [a, b] and [a2' �] is one of the halves [a, a + b/2] or [a + b/2, b]-chosen so that l(a2) < Y < I(�). Of course if I (a + b/2) = y, then you are done; otherwise either I (a + b/2) < y in which case you take [a + b/2, b] or I (a + b/2) > y in which case you take [a, a + b/2] . It­ erating this process we obtain either the solution we seek or a pair of sequences a}, a2,'\" and bl '�\" \" such that I(ak) < y < I(bk), where bk - ak = 21 -k (b - a). This condition shows that both se­ quences are Cauchy sequences and converge to a common limit x. 4.2 Properties of Continuous Functions 131 Since f is continuous, f(x) = limk_oo f(ak ) = limk_oo f(bk ) while from f(ak) < Y < f(bk) we obtain f(x) < y < f(x) in the limit, hence f(x) = y. QED A frequently used special case of this theorem is the following: if a continuous function changes sign on an interval, then it has a zero in the interval. This is a valuable method for locating zeros of a function. We can use it to give a quick proof that a polynomial of odd degree (with real coefficients) has a real root. If the polynomial is anXn +£ln_ lXn- 1 + ... + ao with say an > 0 and n odd, then it is not hard to see that the sign is determined by the leading term if Ix I is large-positive for x > 0 and negative for x < 0 because n is odd. Indeed and the expression in parenthesis can be made less than one by taking Ixl large enough, so that an _lxn- 1 + ... + ao is too small to change the sign of anxn. Thus since the polynomial of odd degree assumes positive and negative values, it must have a root (we can even give an upper bound for the absolute value of the root in terms of the coefficients, namely the smallest value of x that makes the expression in parenthesis equal one) . This argument does not work for polynomials of even degree, for the sign of the leading term is then always positive­ this is as it should be, since such polynomials may (x2 - 1) or may not (x2 + 1) have real roots. Another application of the intermediate value theorem is that the image of a function defined on an interval is also an interval-the end­ points being the sup and inf of the image, which may or may not belong to the image. We leave the proof for an exercise. 4.2.2 Continuous Functions on Compact Domains N ext we consider some theorems concerning continuous functions on a compact domain. Since we have said that compact sets have properties analogous to finite sets, we would expect properties of all functions on a finite set to be valid for continuous functions on a compact set. Two 132 Chapter 4 Continuous Functions very obvious properties of all functions on a finite set are that they are bounded and attain their maximum and minimum values. Theorem 4.2.3 Let f be a continuous junction with domain D that is compact. Then f is bounded and there exist points y and z in D (not necessarily unique) such that f(y) = sup{f(x) : xinD} and f(z) = inf {f ( x) : x in D} . Proof: If f were not bounded above, there would exist a sequence of points Xl ,X2, ••• in D such that f(xj) > j. Since D is compact, we could find a subsequence converging to a point Xo in D. Since f is continuous at xo, it would have to take this convergent subsequence to a convergent sequence, which contradicts f (x j) > j. Similarly f is bounded below. Since the set {f (x) : x in D}, the image of f, is bounded above, it has a finite sup, and there must exist a sequence of values {f (xj )} converging to this sup. Again by the compactness of D, there must exist a convergent subsequence of x!, X2, ••• ; say x� , x�, ... converges to y in D. Then {f(xj)} is a subsequence of {f(xj)} and so also converges to the sup. By the continuity of !, !(y) = !(limJ_oo xj ) = limj_oo !(xj), which equals the sup. QED A function defined on a finite set takes on only a finite number of values; in other words, its image is also a finite set. To obtain the correct analogy we must replace both finite sets by compact sets. Theorem 4.2.4 If f is a continuous junction on a compact domain, then the image of ! is compact. Proof: Let f(D) denote the image. To show it is compact we will show that every sequence in f(D) has a limit-point in f(D). Now the points in f(D) are the values f(x}, so a sequence in f(D} has the form f(xd, !(X2}, ... for points Xl, X2, ... in D. If the value f(xd is assumed more than once then we could change Xl without changing f(xd, so the sequence Xl, X2, ••• is not uniquely determined by the sequence of values f(xd, f(X2}, .. .. But this turns out not to matter. The important thing is that we can pass from a sequence of values in the image to some sequence of points in the domain. Since the domain is compact, there is a limit-point x of the sequence Xl, X2, ... 4.12 Properties of Continuous Functions 133 in D or, equivalently, there is a subsequence x� , x2 , ... that converges to x. Then f(xD , f(x2)\" \" is a subsequence of the given sequence of values in the image, and by the continuity of f it converges to f (x) . Thus f (x) is a point in the image that is a limit-point of the sequence f(Xl ), f(X2), .. .. This shows the image is compact. QED Note that the image of a closed set under a continuous function is not necessarily closed. As an example take f(x) = 1/(1 + x2) defined on the whole line, shown in Figure 4.2.4. Then 0 is a limit-point of the image but is not in the image, which is (0, 1]. This gives an example of a continuous function on a closed set that does not attain its info Figure 4.2.4: Finally we have a result without any analogue for functions on finite sets: the uniform continuity of continuous functions on compact sets. If you look back at the examples of functions that are not uniformly continuous (Figure 4.1.3, or exercise set 4.1.5, number 9) you will notice that the domains are not compact. Theorem 4.2.5 (Uniform Continuity Theorem) Let f be a function on a compact domain D that is continuous. Then it is uniformly con­ tinuous. Proof: First let us recall what the issue is here. For f to be con­ tinuous means that given the error 1/ m and the point Xo, we can find an error l/n such that Ix - xol < l/n and x in the domain implies If{x) - f (xo) 1 < l/m. We do not know how the error l/n varies with the point Xo. Uniform continuity means that we can find a value of l/n that will work for all points Xo in the domain. This is what we are going to prove must be true if the domain is compact. 134 Chapter 4 Continuous Functions Let us consider what would have to be true for uniform continuity to fail. To negate a statement that begins \"for all 11m there exists lin\" , we have to begin with ''there exists 11m such that for all lin\" . The negation of \"Ix - YI < lin implies If(x) - f(Y) 1 < 11m\" would be an example of two points x, y in the domain such that Ix - yl < lin and If(x) - f(Y) 1 > 11m. Since there must be one such example for each lin, we should label the points Xn, Yn' We now have the full statement that ! is not uniformly continuous: there exists 1 1m such that for all lin there exists two points Xn, Yn in the domain such that IXn - Yn l < lin but I!(xn) - f(Yn}l > 11m. We have to show that this leads to a contradiction and so is impossible. Since D is assumed compact, the obvious first step is to replace the sequences Xl, X2, ••• and Yl, Y2, '\" by convergent subsequences. The condition IXn - Yn l < lin implies that both subsequences converge to the same limit, call it Xo. Calling the subsequences x� , x�, ... and Y� , !4, ... we have If(x�) - f(y',J I > 11m and yet both limn_oo f(x�} = f(xo) and limn_oo f(!ln} = f(xo} by the continuity of f at the point Xo. This is a contradiction; we cannot have limn_oo(f(x�} - f{y�}} = f{xo} - f{xo} = 0 and If{x�) - f{Y�}1 > 11m for all n. QED These theorems concerning continuous functions on compact sets can be used in a relative way for continuous functions on non-compact domains. Suppose for example that f is a continuous function on an open interval (a, b). Then the restriction of f to any compact subinter­ val [c, dJ is a continuous function on a compact set. Thus f is bounded, uniformly continuous, and attains its sup and inf on the set [c, dJ. How­ ever, all these statements must be interpreted relative to the domain [c, d] and say something different from what they would say for the domain {a, b)-where they may be false. For example, f (x) = 1 I x on the domain {O, oo} is continuous but is unbounded and not uniformly continuous. On the domain [c, d] , however, for 0 < c < d < 00 the function f{x) = l/x shown in Figure 4.2.5 is bounded and uniformly continuous, attaining its sup at x = c and its inf at x = d. 4.2.3 Monotone Functions We conclude this section with a discussion of monotone functions. We have seen that bounded monotone sequences have limits, so we would 4.� Properties of Continuous Functions f(x) = 1/x c d Figure 4.2.5: 135 expect some analogous result for monotone functions. We say f is monotone increasing on a domain D if x < y for two points in the domain implies f(x) < f(y) and monotone decreasing if x < y for two points in the domain implies f (x) > f (y). For simplicity we will restrict our discussion to the case when the domain is an interval. Now a monotone function can have jumps (the signum, for example), so we cannot prove that a monotone function is continuous. The analogue of the convergence theorem for monotone sequences is that one-sided limits always exist, so a bounded monotone function has at worst jump discontinuities. Theorem 4.2.6 (Monotone Function Theorem) Let f be a monotone function defined on an intenJal. Then the one-sided limits limx_xt f (x) and limx_x; J(x) both exist (allowing +00 or -00) at all points Xo in the domain. These limits are finite except perhaps at the endpoints. 136 Chapter 4 Continuous Functions Proof: Let f be monotone increasing, and consider first a point Xo in the interior of the domain. Then the sequence f(xo-1}, f(xo - 1/2}, f(xo - 1/3}, .. . is monotone increasing (the first few terms may be undefined, but eventually Xo - lin is in the domain since Xo is an interior point) and so has a limit y that must be finite since f (xo - lin) < f(xo}. We claim this value y must be limx_x- f(x}. o The reason for this is simply that any point x less than Xo but near it must be squeezed between some Xn and Xn+l, and by the mono­ tonicity f(xn} < f(x} < f(xn+d, which forces f(x} to be close to y. To make this more precise, suppose we are given an error 11m. By the convergence of the sequence {f(xo - lin)} there must ex­ ist k such that y - 11m < f(xo - lin} < y for all n > k. Then if Xo - 1 I k < x < Xo we have Xo - 1 I n � x � Xo - 1 I (n + 1) for some n > k, so f(xo - lin) < f(x) < f(xo - I/(n + 1)), which implies y - 11m < f(x} < y. Thus limx_x- f(x) = y. o A similar argument shows the existence of limx-+xt f(x), where this time we use the convergence of the monotone decreasing sequence f (xo + 1), f{xo + 1/2}, f(xo + 1/3}, .... At the endpoints of the interval we can also show the existence of the one-sided limit, allowing the possibility of +00 and -00. We leave the details as an exercise. QED Corollary 4.2.1 A monotone function on an open interval is continu­ ous at all points except at an at most countable number of points where it has a jump discontinuity. Proof: We have to show that there are at most a countable number of points of discontinuity. Let us define the jump at a jump discontinuity Xo to be limx-+xt f (x) - limx-+xo f {x}. If the function is monotone increasing, then the jumps are all positive and it would seem plausible that the sum of all the jumps between a and b should be at most f{b) - f(a}. We will use this idea cautiously in fashioning the proof. Let [c, d] be any compact interval contained in the domain, and consider the set of jump discontinuities in [c, d] for which the jump exceeds 11m. We claim this set is finite-if we can prove it we are done because the set of all discontinuities is a countable union of such sets, where we vary 11m and [c, d] over countable sets. In fact we can show that the number of jump discontinuities in (c, d) with jump exceeding 11m is bounded by m(f(d) - f(c)). Sup­ pose Xl, \" \" xn are distinct jump discontinuities in (c, d) . Then we can 4.12 Properties of Continuous Functions 137 shufHe them inside a sequence c, YI , ••• , Yn-l , d so that c < Xl < Yl < X2 < Y2 < ... < Yn- l < xn < d. Because the function is monotone increasing, the jump at Xl is bounded above by f{Yd - f{c) (see Figure 4.2.6), c Yl Figure 4.2.6: the jump at X2 is bounded above by f(Y2) - f(yt}, and so on. We leave the proof of this as an exercise for the reader. Adding up, the sum of the jumps at the points Xl, ••• , xn is at most f(d) - f(c). Thus if each jump is at most 11m, there are at most m{f{d) - f(c)) points. QED Despite the apparent simplicity of this result, you should not be lulled into thinking that the general monotone function is anything like the simple pictures you can draw. For example, if rl , r2 , . . . is an enumeration of the rational numbers and if fk{X) is the function shown in Figure 4.2.7, -------- A(x) • Figure 4.2.7: which is one for X > rk and zero for X < rk , then the function f(x) = E�1 2-kfk(X) is a monotone increasing function with a jump 138 Chapter 4 Continuous Functions discontinuity at every rational number. We postpone the discussion of this example to the chapter on infinite series. 4.2.4 Exercises 1. If f is monotone increasing on an interval and has a jump discon­ tinuity at Xo in the interior of the domain, show that the jump is bounded above by f(X2) - f{XI) for any two points Xl, x2 of the domain sWTounding xo, Xl < Xo < X2. 2. If f is monotone increasing on an interval (a, b), write out the complete proof that limx_b f(x) exists either as a real number or +00. 3. If the domain of a continuous function is an interval, show that the image is an interval. Give examples where the image is an open interval. 4. If a continuous function on an interval takes only a finite set of values, show that the function is constant. 5. Suppose f and 9 both satisfy a Lipschitz condition on an interval (If(x) - f{y) l < Mix - yl for all X and y in the interval). Show that f + 9 also satisfies a Lipschitz condition. 6. Show that if f and 9 are bounded and satisfy a Lipschitz condi­ tion on an interval, then f · 9 satisfies a Lipschitz condition. Give a counterexample to show that it is necessary to assume bound­ edness. 7. Let f be a monotone function on an interval. Show that if the image of f is an interval, then f is continuous. Give an example of a non-monotone function on an interval whose image is an interval but that is not continuous. 8. Let f = p + 9 where p is a polynomial of odd degree and 9 is a bounded continuous function on the line. Show that there is at least one solution of f{x) = O. 9. If f and 9 are uniformly continuous, show that f + 9 is uniformly continuous. 4.9 Summary 139 10. If f and 9 are uniformly continuous and bounded, show that f . 9 is uniformly continuous. Give a counterexample to show that it is necessary to assume boundedness. 11. If f is a continuous function on a compact set, show that either f has a zero or f is bounded away from zero. (I f (x) I > 1 I n for all x in the domain, for some lin). 12. If f and 9 are continuous functions and the domain of 9 contains the image of f, show that the composition 9 0 f defined by 9 0 f(x) = g(f(x)) is continuous. If f and 9 are uniformly continuous, is 9 0 f uniformly continuous? What about Lipschitz conditions? 13. If f is continuous on [a, b] and 9 is continuous on [b, c] , show that h (x) = { f (x) , a < x < b, g(x), b < x < c, is continuous if and only if f(b) = g(b). 14. Show that the function constructed in Section 4.2.1 to vanish ex­ actly on the closed set A satisfies a Lipschitz condition. 15. Give an example of a function on R that assumes its sup and inf on every compact interval and yet is not continuous. 16. Let f be a function defined on the extended reals 1R U {±oo} but whose range is R, which is continuous in the usual sense for points in R, and limx_±oo f(x) = f(±oo). Prove that f is bounded and attains its sup and inf (possibly at the points ±oo). Prove that f is uniformly continuous when restricted to R. 17. Give an example of a function on R that has the intermediate value property for every interval (it takes on all values between f(a) and f(b) on a < x < b) but fails to be continuous at a point. Can such a function have jump discontinuities? 140 Chapter 4 Continuous Functions 4.3 Summary 4. 1 Concepts of Continuity Definition 4.1.1 A function consists of a domain D, a range R, and a correspondence x -+ f{x) assigning a point f{x) of R to each point x of D. The image f(D) is the set of all values f(x). The junction is onto if the image equals the range and is one-to-one if x =F y implies f(x) =F f(y) · Definition 4.1.2 A junction f is said to be continuous at a point Xo of its domain D if for every m there exists n such that Ix - xo l < lin and Xo in D implies If(x) - f{xo)1 < 11m. We say f is continuous if it is continuous at every point of D. We say f is uniformly continuous if for every m there exists n such that Ix - yl < lin and x and y in D implies If(x) - f(y) 1 < 11m. Definition 4. 1.3 y = limz_zo f (x) for Xo a limit-point of the domain D means for every m there exists n such that Ix - xo l < lin, x i= xo , and x in D implies I f (x) - yl < 11m. Theorem 4.1.1 limx_xo f(x) exists if and only if f(xI), f(X2), .. . con­ verges for every sequence xl , X2, ... of points of D not equal to Xo but converging to Xo . Theorem 4.1.2 A function is continuous if and only if it takes con­ vergent sequences to convergent sequences. Theorem 4.1.3 A function on an open domain is continuous if and only if the inverse image of every open set is open. Definition A function satisfies a Lipschitz condition if If(x) - f(xo)1 < Mix - Xo I for some M and all x and Xo in the domain. Definition A function f is said to have a limit from the right at Xo equal to y, written limx_xt f (x) = y if for every 1 In there exists 1 1m such that Xo < x < Xo + 11m implies If(x) - yl < lin. Similarly we 4.9 Summary 141 define limits from the left, written lim%_%o f (z ) . We say f has a jump discontinuity at Zo if it has limits from both 'ides at zo and they are different. 4.2 Properties of Continuous Functions Theorem Continuity is presenJed under addition, multiplication, and division (if the denominator never vanishes). Theorem 4.2.1 If f and 9 are continuous, so is max(f, g) or min(f, g). Theorem 4.2.2 (Intermediate Value Theorem) A continuous function f on a closed interval [a, b] as,umes all values between f(a) and f(b). Theorem A polynomial of odd degree has a real zero. Theorem 4.2.3 A continuous function on a compact set is bounded and attains its sup and info Theorem 4.2.4 The image of a continuous function on a compact set is compact. Theorem 4.2.5 A continuous function on a compact set is uniformly continuous. Theorem 4.2.6 A monotone function on an interval has one-sided limits at all points of the domain, finite except perhaps at the endpoints. Corollary 4.2.1 A monotone function on an intenJal has at most a countable number of ducontinuitiu, all of which are jump discontinu­ ities. Chapter 5 Differential Calculus 5.1 Concepts of the Derivative 5.1.1 Equivalent Definitions In this chapter we are going to review the highlights of the differential calculus, supplying precise definitions and proofs for all results. From a computational point of view you will not learn very much new-you will still compute the derivative of (sin(sin 1/(1 + x2)))3 in the same way you always have. From a conceptual point of view, however, we will pursue two goals. First, we want to provide a sound logical foun­ dation for this enormously successful branch of mathematics. (This is not to say that this is the only possible foundation or even that it is the foundation that Newton and Leibniz had in mind but were not able to formulate clearly. Another possible foundation can be based on Abraham Robinson's Non-Standard Analysis, but this is consider­ ably more difficult to describe.) Our second goal is to clarify certain concepts in the rather simple one-dimensional case so that we will be better prepared to deal with the many beautiful and more complicated generalizations to higher dimensions and beyond. The idea of the derivative comes from the intuitive concepts of rate of change, velocity, and slope of a curve, which are thought of as in­ stantaneous or infinitesimal versions of the basic difference quotient (f(x) - f(xo))/(x - xo) where f is a function defined on a neighbor­ hood of Xo. This is often written (f(xo + h) - f(xo))/h, which is clearly equivalent if we set x - Xo = h. The difference quotient has the imme- 143 144 Chapter 5 Differential Calculus diate interpretation as the ratio of changes in the variables x and f (x) over the interval from Xo to x, as shown in Figure 5.1. 1. j{x) Figure 5. 1. 1: The intuitive idea of letting x get closer and closer to Xo (without actu­ ally reaching it) is captured in the definition of the limit of a function: form q(x) = (f(x) - f(xo))/(x - xo) as a function of x, and take its limit as x � Xo. We call this limit, if it exists, the derivative f' (xo) at Xo, and we say the function is differentiable at Xo. We only allow real number limits and explicitly exclude the possibility that f'(xo) might equal +00 or -00 when we say f is differentiable at Xo. Note that our explicit refusal to consider the value at x = Xo in the definition of the limit pays off here, since the difference quotient is undefined, (f (xo) - f(xo))/(xo - xo), at x = Xo. Thus Xo is not in the domain of the difference quotient q(x), which consists of the domain of f with Xo removed. This is the definition of derivative that is usually given in modern calculus books, without a complete explanation of the limit concept . Let us write out the complete statement defining /'(xo) with the mean­ ing of the limit made explicit : Definition 5.1.1 Let f be a junction defined in a neighborhood of Xo. Then f is said to be differentiable at Xo with derivative equal to the real number f'(xo) if for every error l/m there exists an error l/n such that 5. 1 Concepts 01 the Derivative Ix - xol < lin and x =F Xo implies I(x} - I(xo} _ I' {xo} < ..!:... x - Xo - m 145 Now observe that since x - Xo =F 0, we can multiply the inequality above by Ix - xol to obtain the equivalent inequality I/(x} - I(xo} - I'(xo}{x - xo} 1 < ..!:.. Ix - xo l · m This new inequality admits an interesting interpretation. We think of I ( x) - I (xo) - f' ( xo) {x - xo} as the difference of two functions­ the original function I{x} and the function I{xo} + I' {xo} {x - xo}. Here Xo is thought of as a constant, as are I(xo} and I'(xo}, so this second function is simply an affine function ax + b, where a = I'(xo} and b = I{xo} - xo/'(xo}. We use the term affine rather than linear because we want to reserve the term linear for the special case b = O. An affine function is one whose graph is a straight line, and any non­ vertical straight line is the graph of an affine function (for the function to be linear the line must pass through the origin). Clearly the affine functions are extremely simple to understand-almost any question about an affine function that one can imagine asking can be answered by a simple computation. Now the existence of the derivative of I at Xo is a statement about the difference between the original function and the affine function g(x} = I{xo} + I'(xo}{x - xo}, which we will think of as a statement about how well 9 approximates I. The problem is that there are many different notions of approximation, and we must pick out the one that is pertinent here and distinguish it from others. To do this let us rewrite the definition in terms of the functions I and g: for every 11m there exists lin such that Ix - xo l < lin implies I/(x} - g(x} 1 < Ix - xol/m. {According to the definition we should require x =F Xo, but it is trivially true that I/{xo} - g{xo} 1 < 0 because I(xo} = g(xo} by the form of g.} Notice that this is a statement about what happens for x near Xo. It is a local approximation property. How close does x have to be to xo? That will depend on the choice of 11m, but it will never hurt us to make it closer, and we may be forced 146 Chapter 5 Differential Calculus to make it very close indeed. For a particular value of x, not equal to Xo, the statement may say nothing at all, since this value of x may not satisfy any of the conditions Ix - xol < lIn. It is only as x is varied closer to xo that the statement implies that g( x) approximates / (x) well. N ow let us look at the graphs of I (x) and the various affine functions that might be g(x) (see Figure 5.1.2). Since g(x) is supposed to be approximating x at Xo we may as well have the graphs cross at Xoj in other words take I(xo) = g(xo). However, there are many affine functions whose graph crosses the graph of I at the point (xo, /(xo)). These functions have the form I(xo) + a(x - xo) for any real constant a. What distinguishes the unique correct choice?\" It is what we visually identify as tangency-the extremely close touching of the graphs for x near xo. Figure 5.1.2: It is not just that I(x) - g(x) tends to 0 as x tends to xo-this would happen with any choice of a-but it goes to zero laster than for any other choice of a. In fact the condition \"Ix - xol < lin implies I/(x) - g(x) 1 < Ix - xol/m\" means exactly that it goes to zero laster than Ix - xol. If we compare any two distinct affine functions g1 (x) = I (xo) + at {x - xo) and g2(X) = I(xo) + a2(x - xo) passing through (xo, /(xo)) we find Igl (X) - g2(x)1 = la1 - a211x - xol, which goes to zero at a rate proportional to Ix -xol. This is fundamentally different from the rate of vanishing of the difference I(x) - g(x). In fact it shows the uniqueness of the affine function g( x) = I (xo) + /' (xo) (x -xo) corresponding to the 5. 1 Concepts of the Derivative 147 choice a = I' (xo) and, hence, the uniqueness of the derivative. If at is different from f' (xo), then the difference I (x) - g1 (x) can be estimated from below by the triangl� inequality, I/(x) - gl (x) 1 1(/(x) - g(x)) + (g(x) - gl (x))1 > Ig(x) - g1 (x)l - I/(x) - g(x)1 > la1 - !'(xo)l lx - xo l - -.!:.. Ix - xol m if Ix - xol < lin. By taking 11m less than lal - f'(xo)1/2 we have If{x) - g1 (x)1 � la1 - f'(xo} llx - xo l/2 for all x satisfying Ix - xol < l/n for some value of l/n. This means we can never make I(x) - gdx) go to zero faster than Ix - xol. We can see this clearly in Figure 5.1.2 by the way the graphs of I(x) and gl (x) cross cleanly (the technical term transversal is sometimes used to describe this). We can formulate the condition that f(x) - g(x) vanishes at x = Xo at a faster rate than Ix - Xo I in a convenient manner by introducing \"big Oh\" and \"little oh\" notation. Definition 5.1.2 Let I and 9 denote arbitrary junctions defined near x = Xo. We say I(x) = O(g(x)) as x � Xo (read I is \"big Oh\" of g) il there exists lin and a positive constant c such that Ix - xol < lin implies I/(x) I < clg(x)\\ (or equivalently, the ratio I I 9 remains bounded lor Ix - xo l < l/n). We say f(x) = o(g(x)) as x � Xo (read f is \"little oh\" 01 g) if lor every l/m there exists l/n such that Ix - xol < lin implies I/(x)1 < Ig(x)l/m (or equivalently, limx_xo l(x)lg(x) = 0). Note that o(g(x)) is a stronger statement than O(g(x)); o(g(x)) implies O(g(x)) but not conversely. Usually the function g(x) in the definition is taken to be something relatively simple, such as a power of Ix - Xo I, so that the condition gives a comparative statement concerning the size of f near Xo and a standard of decay or growth. The simplest choice is 9 = 1. Then I (x) = 0(1) as x � Xo means I is bounded near x = Xo, while I(x) = 0(1) as x � Xo means limx-xo I(x) = o. Continuity at Xo can be expressed by I(x) - I(xo) = 0(1) as x � Xo. The choice g(x) = Ix -xol enables us to 148 Chapter 5 Differential Calculus express differentiability as f(x) - h(x) = o( lx - xo ! ) as x ....... :ro where h is the affine function f(xo) + f' (xo)(x - xo) . For any other affine functions hI (x) = f(xo ) + a(x - xo ) we have merely f(x) - hl (x) = O(lx - xo ! ) . Let us define a best affine approximation to f at Xo to be an affine function g(x} such that I(x} - g(x} = o(lx - xo l) as x � Xo. We have seen that I is differentiable at Xo if and only if it has a best affine approximation at xo, in which case the best affine approximation is unique and equals I(xo} + I'(XO}{X - xo}. Thus the derivative here appears as the slope of the best affine approximation, and the graph of the best affine approximation is the tangent line to the graph of I(x} at the point (xo, /(xo}). Having defined differentiability at a point, we define differentiability on an open set A simply to mean differentiability at every point of A. (One might think, in analogy with continuity, that one would also want to consider a stronger condition of uniform differentiability, where the relationship between the errors is specified independently of the point xo. In this regard see exercise set 5.2.4, numbers 8 and 9.) Thus I is differentiable on A il lor every xo in A there exists a constant f' (xo) such that lor every lim there exists lin (depending on lim and xo) such that Ix - xo l < lin implies If(x) - (f(xo) + f'(xo)(x - xo )) 1 � Ix - xol 1m. Note that if f is defined and differentiable on A, then the derivative Xo ....... f' (xo) can also be viewed as a function defined on A. This is the point of view that we will adopt. Note that it requires a non-trivial change of perspective, since the definition of I'(XO} involves holding Xo fixed. 5.1.2 Continuity and Continuous Differentiability Differentiability of I at Xo implies that I is continuous at Xo. In­ deed, continuity at Xo would require that we can make I (x) - I (xo) small, whereas differentiability at Xo means we can make I(x} - I(xo} ­ I' (xo) (x - xo) small. Since I' (xo) is fixed, we can also make I' (xo) (x - xo) small and, hence, I (x) - I (xo) small. More precisely, we choose lin so that Ix-xo l < lin implies I/(x)-f(xo}-f'(XO}{X-xo} l < Ix - xol. Then by the triangle inequality we have If(x} - f (xo ) 1 � 1J'(XO ) (X - xo ) 1 + Ix - xo l = ( 1 + 1 f' (xo) 1 ) Ix - xo l · 5. 1 Concepts of the Derivative 149 (In fact, this argument only uses the condition f(x) - f(xo} - f'(xo}{x - .zo) = O(lx - xo!), which is weaker than differentiabili­ ty. ) This is a kind of local Lipschitz condition that implies conti­ nuity as follows : given 11m, choose 11k such that both k > n and k > (1 + 1/'(.zo)l)m. Then Ix - xol < 11k implies I!(x) - !(xo)! < (1 + If'(xo) !)lx - xol < 11m. Since differentiability at a point implies continuity at a point, it follows that differentiability on an open set implies continuity on that set. Later we will show that if the derivative is also bounded, then the function is uniformly continuous; in fact it will satisfy a Lipschitz condition. Differentiability of a function implies continuity of the function, but it does not imply continuity of the derivative. This is a rather subtle point, since the obvious attempt to create a counterexample doesn't work. Since the simplest function that fails to be continuous is one with a jump discontinuity, such as the signum, it would seem plausible that to create a function with a discontinuous derivative one would take a function like Ixl (shown in Figure 5.1.3) whose derivative is sgn x. The problem with this example is that the function is not differentiable at x = 0, the very point where the discontinuity in the derivative occurs. Indeed the difference quotient at x = 0 is +1 for positive values and -1 for negative values, so it can't have a limit (it has two distinct one-sided limits) . j(x) = lxI Figure 5.1.3: No amount of patching will make this an example of a function dif- 150 Chapter 5 Differential Calculus ferentiable at every point of an open set with a derivative that is dis­ continuous. In fact later we will prove that jump discontinuities never occur in a derivative that exists at every point. Thus we have to look for discontinuities of the second kind. The picture we have in mind is a function that oscillates more and more rapidly as x approaches xo, but the size of the oscillations also decreases, tending to zero. We must then control the relative heights and widths of the oscillation rather carefully. The idea is that by making\" the heights decrease rapidly e­ nough we can make the derivative exist and equal zero at the point x = Xo and then by making the width decrease even more rapidly we can make the derivative discontinuous (even unbounded) . Figure 5. 1.4: An explicit example is the function f(x) = { x2 sin(1/x2), x #- 0, 0, x = 0, shown in Figure 5.1.4. We may compute the derivative in the usual fashion for x =F 0 (we are assuming here that the usual laws of dif­ ferential calculus are valid-facts that we will eventually prove). We find ' ( . 1 2 1 f x) = 2x sm 2' - - cos 2' if x =F 0; x x x and this function is clearly unbounded as x � 0, so no way of defining /' (0) could possibly make it continuous. Notice here that the speed of oscillation of the factor sin(1/x2) overcomes the decay of x2 to produce the unbounded derivative. The usual procedures of the differential calculus do not provide a computation of /'(0), let alone a guarantee that the derivative exists at 5. 1 Concepts 01 the Derivative 151 x = o. Indeed it would be natural to guess that the derivative could not possibly exist at x = 0 because of all the oscillations nearby. However, it turns out that the decay of the factor x2 is enough to overwhelm the oscillations and produce a zero derivative at x = O. In fact the difference quotient at x = 0 is I(x) - 1(0) x2 sin(1/x2) - 0 . 1 -..;..�-..;.....;... = = xsm- , x - 0 x - 0 x2 which clearly has limit equal to 0 since I sin(1/x2)1 < 1. Thus I is differentiable at x = 0, and I' (0) = O. This is an everywhere differ­ entiable function with a derivative that is discontinuous at x = o. (In fact, by modifying this example it is possible to produce an everywhere differentiable function whose derivative is nowhere continuous.) A function whose derivative exists and is continuous is called con­ tinuously differentiable or of class ct . We will see that many of the theorems of differential calculus do not require this hypothesis; nev­ ertheless, it is a very frequently encountered condition, and one could make a case for the viewpoint that there is very little importance at­ tached to the game of trying to eliminate this hypothesis from theorems. In deference to established traditions we will play the game for a while. Before passing to the study of properties of differentiable functions, we will discuss briefly the intuitive notion of smoothness of the graph and its relation to differentiability. A rule of thumb that is frequent­ ly expounded in calculus courses is that a continuous function is one whose graph can be drawn without a break (without lifting pen from paper or chalk from blackboard), while a differentiable function is one whose graph is sufficiently smooth so that you can run your finger along it without getting cut. There is a good deal of truth to this maxim, although the example of x2 sin(l/ x2) should convince you of the super­ ficial nature of the assumption that you can always \"draw\" the graph of a function. Nevertheless, if you can draw the graph, then sharp corners do indicate points where the derivative fails to exist. However, there is another reason the derivative can fail to exist even When the graph is smooth-namely, the tangent can become vertical. An example is the function f(x) = -Vi defined for all real x (the cube root of a negative number is negative), whose graph is the graph of x = y3, as shown in Figure 5.1.5. At x = 0 the tangent is vertical and the derivative fails 152 Chapter 5 Differential Calculus to exist (/(X) - 1(0)) = � = 1 tends to + 00 as x � 0), x - 0 X (�)2 even though the graph is perfectly smooth. I(x) = � Figure 5.1.5: 5.1.3 Exercises 1. Show that I(x) = O(lx-xoI2) as x � Xo implies I(x) = o{lx-xol) as x � Xo, but give an example to show that the converse is not true. 2. Show that j(x) = O(lx - xolk) and g(x) = O(lx - xolk) imply (I + g)(x) = O(lx - xolk). Is the same true of \"little oh\" ? 3. Show that I(x) = O(lx - xolk) and g(x) = o(lx - xoli) imply I· g(x) = o{lx - xolk+i). 4. Show that I(x) = O(lx-xolk) implies I(x}/x-xo = 0(lx-xolk-1} if k > 1. 5. Show that if f(xo) = 0 and f(x) = o(lx - xol) as x ---. xo , then f' (xo) exits. What is /,(xo)? What does this tell you about x2 sin( 1/x1,OOO)? 5.� Properties 01 the Derivative 153 6. Show that x sin{l/x} fails to have a derivative at x = 0 and even the one-sided limits {limx_o+(/(x} - I{O))/(x - O}, etc.} fail to exist. 7. Give an example of a differentiable function whose tangent line at a point fails to stay on one side of the graph {above or below} even locally (when restricted to any neighborhood of the point). 8. Show that if I is an affine function, it is equal to its own best affine approximation at every point. What does this tell you about the derivative of I? 9. A \"zoom\" on the graph of y = I(x) near {xo, YO} (with Yo = I(xo)} with magnification factor M (the same in both x and y directions) is the graph of the function defined by 1 {xo + x / M} = Yo + y / M. Prove that if I is differentiable at Xo, then the zoom converges to the straight line through the origin with slope I'(xo}, as M � 00. What happens to the zoom of Ixl near the origin? 5.2 Properties of the Derivative 5.2. 1 Local Properties The basic idea of the differential calculus is to relate properties of the function to properties of its best affine approximation at a point. The simplest such properties involve questions of increase, decrease, and maxima and minima. We study first these properties at a point. Definition 5.2.1 Let f be a junction defined in a neighborhood of a point Xo. We say 1 is monotone increasing at Xo il there exists a {perhaps smaller} neighborhood of Xo such that I{xd < I{xo} < l{x2} for all points % 1 and %2 in the neighborhood satisfying % 1 < %0 < %2 . We say f is strictly increasing at Xo if there exists a neighborhood 01 Xo such that I(xd < I{xo} < l(x2} lor all points Xl and %2 in the neighborhood satisfying Xl < Xo < X2. We say that f is monotone increasing on an interval ill(xd < l(x2} lor all points in the interval satisfying Xl < X2; 1 strictly increasing on an interval is defined in the same way with strict inequalites I(Xl} < l(x2}. We define monotone 154 Chapter 5 Differential Calculus and strictly decreasing similarly, reversing the inequalities lor I (x) . We say that I has a local maximum at Xo il there exists a neighborhood 01 Xo such that I(x) < I(xo) lor all x in the neigborhood. We say that I has a strict local maximum at Xo il there exists a neighborhood 01 Xo such that I (x) < I (xo) lor all x not equal to Xo in the neighborhood. We define local minimum and strict local minimum similarly, reversing the inequalities. These definitions are fairly obvious. One way to think of them is to draw the horizontal and vertical lines through the graph of I at the given point, dividing the plane into four quadrants, as in Figure 5.2.1. left-up right-up right-down Figure 5.2.1: The function is increasing if the graph passes from the left-down to the right-up quadrant, decreasing if the graph passes from left-up to right-down, and so on. For strict behavior we exclude the boundary of the quadrants. The condition \"there exists a neighborhood of xo\" in all the definitions means we only look at a piece of the graph near the point. One possible source of confusion is that the fact that I is monotone increasing at Xo is not the same as saying I is monotone increasing on a neighborhood of Xo. To say I is monotone increasing in a neighborhood of Xo we would want to know Xl < X2 implies !(Xl) < !(X2) for every Xl and X2 in the neighborhood, which is a stronger condition. For example, the zig-zag function illustrated in Figure 5.2.2 is monotone increasing 5.12 Properties 01 the Derivative 155 at x = 0, but it is not monotone increasing in any neighborhood of O. The same remark applies to strict increasing. Figure 5.2.2: On an intuitive level we expect these local properties of a function to correspond to the same properties for the best affine approximation at the point in question, and the properties of the best affine approxi­ mation binge on the sign of the derivative. Since the derivative is the limit of the difference quotient (/(x) - I(xo» /(x - xo) and the sign of the difference quotient is related to the relative values of I (x) and I (xo), it is not difficult to establish the basic facts. Since there is a loss of information in passing to the limit, in that strict inequalities may not be preserved, we can't get a perfect match-up of conditions. Let us start with the true implications. Theorem 5.2.1 Let f be defined in a neighborhood of xo, and let I be differentiable at Xo. a. II I'(xo) > 0, then I is strictly increasing at Xo. Similarly, il I'(xo} < 0, then I is strictly decreasing at Xo. b. II f is monotone increasing at Xo, then f'(xo} > O. Similarly, il I is monotone decreasing at Xo, then f'(xo} < O. 156 Chapter 5 Differential Calculus c. II I has a local maximum or minimum at Xo, then f'(xo} = O. Proof: a. Since the limit of the difference quotient is strictly positive, there must be a neighborhood of Xo in which the difference quotient is strictly positive. For x in this neighborhood (/(x) - I(xo}}/(x - xo} > 0, so f(x} - I(xo} > 0 if x > Xo while I{x} - I(xo} < 0 if x < Xo, showing that f is strictly increasing at Xo. b. If I is monotone increasing at Xo, then there exists a neighbor­ hood of Xo for which the difference quotient is >0. Since non-strict inequality is preserved in the limit, the derivative at Xo is also > O. c. Suppose I has a local maximum at Xo. Then the difference quotient formed for x < Xo will be > 0, while the difference quotient formed for x > Xo will be < 0, for x in a neighborhood of Xo. Since we can take the limit from either side, the derivative at Xo must be both > 0 and < 0, hence zero. QED Figure 5.2.3: Almost as important as what the theorem says is what it does not say. If the function is strictly increasing we cannot conclude that the derivative is positive, as the function f(x} = x3 at x = 0 shows (see Figure 5.2.3). Similarly if the derivative is zero at a point we cannot draw any conclusions. Also it is necessary to assume the function is 5. 2 Properties of the Derivative 157 differentiable at the point in question; f{x) = Ixl has a local minimum at x = 0 but is not differentiable there. Part c of the theorem will be extremely useful to us and forms the basis of many familiar applications of calculus. It is usually attributed to Fermat, but in fact Fermat developed a somewhat different method for locating maxima and minima. Fermat observed that in a neighbor­ hood of a strict local maximum (say f(xo) = M), the function assumes smaller values exactly twice but the maximum value only once, as in Figure 5.2.4. x+h Figure 5.2.4: Thus Fermat looks at the equation / (x + h) = / (x), finds the non-zero solution h (h = 0 is always a solution), expresses x as a function of h, and then sets h = 0 (strictly speaking one must take the limit as h � 0). Thus for f(x) = x2 his method sets (x + h)2 = x2. The two solutions are h = 0 and h = -2x. For the non-zero solution we find x = -h/2; and when h ---. 0 we find the minimum at x = o. For f(x) = x3 the equation (x + h)3 = x3 has only h = 0 as a real root, so Fermat's method does not get fooled by the critical point x = 0, which is neither a maximum nor a minimum. Despite the fact that Fermat's method has this advantage over the usual method, it has been largely forgotten because it requires the explicit solution of the equation f(x + h) = f{x), which is often intractible. 5.2.2 Intermediate Value and Mean Value Theorems We turn now to properties of functions that are differentiable on an open interval. The two main theorems are the intermediate value theo­ rem (not to be confused with the theorem of the same name in Section 158 Chapter 5 Differential Calculus 4.2.1) and the mean value theorem. The proofs are quite similar, based on the observation that to get a solution of I'(x) = 0 we can take a local maximum or minimum and then by subtracting an appropriate affine function we can get /,(x) to take on other values. The interme­ diate value theorem is something of a curiosity, since its conclusion is a consequence of the other intermediate value theorem if we assume the derivative is continuous, which we will frequently do for other reasons. The mean value therorem, on the other hand, is one of the most use­ ful theorems in analysis. It turns out that its proof is not made any simpler by assuming the derivative is continuous. Intermediate Value Theorem Let I{x) be differentiable on an open interval ( a, b) . Then its derivative has the intermediate value property: il Xl < X2 are any two points in the interval, then f' ( x) assumes all values between 1'{xI) and 1'(X2) on the interval (Xl, X2). Proof: First let us prove the theorem in the case when the value we want I' (x) to assume is zero. This means zero must lie between I'{xd and 1'{X2), so one must be positive and one must be negative, say f'{xI) < 0 < 1'(X2). This is shown in Figure 5.2.5. • • Figure 5.2.5: • • b To find a solution to I' (x) = 0 we need only show that I has a local maximum or minimum in the open interval (XI, X2). In the case we are considering we can show it must have at least one local minimum-it may, of course, have more than one, and it may have local maxima as well. To find a local minimum we look for a point where I attains its inf 5.2 Properties 0/ the Derivative 159 on the closed interval [Xl , X2]. Here we use the fact that differentiability implies continuity of I, and then the fact that continuous functions on compact intervals attain their info If the inf is attained at an interior point xo of the interval, then Xo is a local minimum {because (XI, X2) is a neighborhood of Xo such that I(x) > I(xo) for all points in the neighborhood.) However, if the inf were attained at an endpoint we could not assert that we have a local minimum, as in the example I{x) = X (Figure 5.2.6). inf ;.: local minimum Figure 5.2.6: Thus we have to use the hypotheses I'{xt} < 0 < 1' (X2) to show that the inf cannot occur at either endpoint. It can't occur at the left endpoint Xl, because there the function is strictly decreasing, so I{x) < I{XI) for X in the interval near Xl, and it can't occur at the right endpoint X2, because there the function is strictly increasing, so I{x) < I{X2) for X in the interval near X2. (If we had assumed the reverse inequalities 1'{X2) < 0 < I'{xt}, then a similar argument would show that / can't attain its sup at either endpoint.) We have thus proved that I'{x) attains an intermediate value if that value happens to be zero. Now we need to see how the general case can be reduced to this special case. Suppose we want to show that I' (x) can attain the value Yo, where say 1'{xI) < Yo < 1'{X2). The linear function g{x) = YoX has derivative everywhere equal to Yo, so we need to solve F'{x) = 0 where F = I - 9 (we are using here the elementary property F' = I' - 9', whose proof we will be given in Section 5.3.1). But F'{xd = I'{XI) - Yo < 0 and F'{X2) = 1'{X2) - Yo > 0, 80 we can apply the previous argument to F. QED 160 Chapter 5 Differential Calculus The intermediate value theorem explains why it is so tricky to get a function whose derivative is discontinuous-the discontinuity can't be a jump because then the intermediate value property would be violated. The proof of the intermediate value theorem is a good warm-up exercise for the proof of the mean value theorem. Mean Value Theorem Let f be a continuous function on a compact intenJal [a, b] that is differentiable at every point in the interior. Then there exists a point Xo in the interior where f'(xo) = (f(b) - f(a))/(b ­ a). The great significance of the mean value theorem is that it enables us to obtain information about the derivative from the computation of a single difference quotient, without passing to the limit. Of course we lose the precision of knowing the point Xo exactly. The intuitive content of the theorem is that the difference quotient is the slope of the secant line joining the two points (a, f (a)) and (b, f (b)) of the graph, while the derivative is the slope of the tangent line. If we translate the secant line parallel to itself up or down, then at the moment it loses contact with the graph it should be tangent to it, as shown in Figure 5.2.7. --- Figure 5.2.7: This intuition can be made to form the basis of the proof if we first reduce to the case where the lines are all horizontal and then notice that a horizontal line loses contact with the graph at exactly the local maximum and minimum points. 5.12 Properties of the Derivative 161 Proof: We begin with the special case when f(a) = I(b), so the difference quotient is zero (this case is known as Rolle's Theorem). Then we are looking for a point where !,(x) = 0, so it will suffice to find a local maximum or minimum. We have assumed that I is continuous on the compact interval [a, b), so we know that I attains its sup or info If either happens at an interior point we have our local maximum or minimum. Thus we need only consider the special case where I attains both its sup and inf at the endpoints. This is not an impossible occurrence (for example, I(x) = X)i but because we have assumed I(b) = I(a), this implies I must be constant on [a, b), so I' (x) = 0 at any point in the interval. Next we reduce the general case to the special case. Let g(x) be the affine function passing through the two points (a, I ( a)) and (b, I (b) ), as shown in Figure 5.2.8. The slope of the graph is obviously the difference quotient, so g(x) has derivative equal to (f(b) - I(a))/(b - a) at every point. By subtracting it off, F = I - g, we reduce the problem of solving f'(XO) = (/(b) - f(a))/(b - a) to that of solving F'(xo) = O. y = j(x) Figure 5.2.8: But clearly F vanishes at both endpoints because f and 9 attain the same values at the endpoints. Thus F(b) = F(a) , so the previous argument applies. You can easily verify that g(x) = (J(b! = �(a)) (x - a) + J(a) is the formula for the affine function, and one can then verify alge- 162 Chapter 5 Differential Calculus braically that g'{X) = (/(b) - I(a»/{b - a) while I = g at x = a and x = b-facts that are evident from the graph. QED 5.2.3 Glpbal Properties Using the mean value theorem we can obtain relations between the derivative on an interval and the behavior of the function on the inter­ val. Theorem 5.2.2 Let I be a differentiable function on the intenJal (a, b). a. I is monotone increasing on (a, b) il and only il f' (x) > 0 lor every x in the intenJal. Similarly I is monotone decreasing on ( a, b) il and only il I' (x) < 0 on the intenJal. b. II I' (x) > 0 lor every x in the intenJal, then I is strictly increasing on the intenJal. Similarly I' (x) < 0 implies that I is strictly decreasing. c. II I' (x) = 0 lor every x in the intenJal, then I is constant on the interval. Proof a. If I is monotone increasing on the interval, then the same argu­ ment as in the pointwise case (the difference quotients are all > 0 and non-strict inequality is preserved in the limit) shows that I' (xo) > 0 at any particular point Xo in the interval. Conversely, suppose I' (x) > 0 on the interval. Let Xl and X2 be two points in the interval with Xl < X2. Then apply the mean value theorem to I on the closed in­ terval [Xl, X2]. Notice that the continuity hypothesis of the mean value theorem is satisfied since differentiability implies continuity. The mean value theorem gives us the identity I'{XO) = (/(X2) - l(xI))/(X2 - xI) for some point xo. Since I'{XO) > 0, we obtain I(X2) - I{xd > 0, proving that I is monotone increasing. b. We argue exactly as in part a to get I'(XO) = (/(X2) - l(xI))/ (X2 - xI). Since now we are assuming I'(XO) > 0, we obtain I(X2) -l{xI) > 0, proving that I is strictly increasing. c. This time from I'(XO) = (/(X2) -l(xd)/(X2 -xd and I'(XO) = 0 we obtain I(X2) - I(XI) = O. Since this is true for any two points in the interval, I is constant. QED 5. � Properties of the Derivative 163 Notice that we have done somewhat better in part a than in the pointwise case (from I'(xo) > 0 at one point we can deduce nothing)­ we have an if and only if statement. The converse of part b is of course false, as the familiar example I (x) = x3 shows. One can in fact show that I' (x) > 0 on an interval implies that I is strictly increasing unless I' (x) = 0 on an open subinterval. We leave this as an exercise. Part c can be used to prove the uniqueness of the indefinite integral. Another easy application of the mean-value theorem shows that a differentiable function with bounded derivative satisfies a Lipschitz condition. Indeed, suppose f is continuous on [a, b] and differentiable in the interior and 1/'(x)1 < M for all x in (a, b). Then for any x}, X2 in the interval, I(X2) -f(xd = f' (XO)(X2 -xI) for some Xo, so I/{X2) -I{xdl < Mlx2 - xI I , which is the desired Lipschitz condition. The converse is not true, for I (x) = Ix I satisfies a Lipschitz condition but is not differentiable at x = O. Lipschitz functions have slightly rougher graphs than differentiable functions-as a rule of thumb they can have corners but not cusps (see Figure 5.2.9). comers cusps Figure 5.2.9: Because of the greater flexibility that corners allow, there are some applications where it is important to allow Lipschitz functions. (A very profound theorem of Lebesgue-well beyond the scope of this work­ says that Lipschitz functions must be differentiable at some points and, in fact, at most points in a certain well-defined sense.) 5.2.4 Exercises 1. Let f and 9 be continuous functions on [a, b] and differentiable at every point in the interior, with g(a) =F g(b). Prove that there 164 Chapter 5 Differential Calculus exists a point Xo in ( a, b) such that I(b) - f(a) _ f'(xo) g(b) - g(a) - g'(xo) · (Hint: apply the mean value theorem to the function (f(b) - f(a»g(x) - (g(b) - g(a»/(x).) This is sometimes called the second mean value theorem. 2. If f is a function satisfying I/(x) - f(y)1 < Mix - ylQ for all x and y and some fixed M and a > 1, prove that I is con­ stant. (Hint: what is I'?) It is rumored that a graduate student once wrote a whole thesis on the class of functions satisfying this condition! 3. Is the converse of the mean value theorem true, in the sense that if f is continuous on [a, b) and differentiable on (a, b), given a point Xo in (a, b) must there exist points Xb X2 in [a, b] such that 4. Suppose f is defined on [a, b] and 9 is defined on [b, c] with f(b) = g(b). Then define h(x) = { f(x) if a < x < b, g(x) if b < x < c. Give an example where f and 9 are differentiable but h is not. Give a definition of one-sided derivatives f'(b) and g'(b) and show that the equality of these is a necessary and sufficient condition for h to be differentiable, given that I and 9 are differentiable. 5. Draw a picture of the graph of a function that is strictly increasing at a point but is not even monotone increasing in a neighborhood of that point. 5.9 The Calculus 01 Derivatives 165 6. Show that if I is differentiable and f' (x) > 0 on (a, b), then I is strictly increasing provided there is no subinterval (e, d) with e < d on which f' is identically zero. 7. Draw the graph of a function that has a local maximum that is not a strict local maximum but is not constant on an interval. 8. Suppose I is continuously differentiable on an interval (a, b). Prove that on any closed subinterval [e, d) the function is uniformly dif­ ferentiable in the sense that given any lin there exists 11m (inde­ pendent of xo) such that I/(x} - I(xo}- 1'(XO}(X -xo}1 < Ix -xol/n whenever Ix - xol < 11m. (Hint: use the mean value theorem and the uniform continuity of I' on [e, d) .} 9. *Show that the converse to problem 8 is also valid: if I is uni­ formly differentiable on an interval, then I is continuously differ­ entiable. (Hint: for two nearby points Xl and X2, consider the difference quotient (/(X2) - l(xd}/(x2 - xd as an approximation to both I'(xd and f'(X2).} 10. If I assumes a local maximum or minimum at an endpoint of its domain [a, b], what can you say about the one-sided derivative (assuming it exists) ? Warning: The answer depends on which endpoint it is. 11. Prove that if /' is constant, then I is an affine function. 12. Give an example of a function that is differentiable on (a, b) but cannot be made continuous on [a, b) by any definition of I(a) or I(b). Can you give an example where I is bounded? 13. If I is a differentiable function, prove that between any two zeroes of I there must be a zero of I'. 5.3 The Calculus of Derivatives 5.3. 1 Product and Quotient Rules In this section we derive the familiar rules of the differential calculus. These rules are all analogous to-and derived from-rules of the cal­ culus of differences. One might find it surprising that the calculus of 166 Chapter 5 Differential Calculus derivatives is somewhat simpler than the calculus of differences-but then the whole success of calculus is due to similar surprises. If f is a function, we write Ahf(x) = f(x + h) - f(x) whenever it is defined. Think of h as a fixed number and Ah as an \"operator\" , something that takes the function f as input and produces the function f (x + h) - f (x) of x as output. The concept of operator is a distinctly twentieth century idea. We will use it only in an informal way in this work, but you will encounter it frequently if you continue your studies. We can also think of the derivative as an operator, taking the function f as input and producing the function I' as output. We are claiming here that the properties of the derivative operator are related to prop­ erties of the difference operator. Since f' (x) = limh_O Ahf (x) / h by the definition of the derivative, this is not at all surprising. Suppose we apply arithmetic operations on functions to obtain new functions. What happens to the differences? This is a matter of simple computation: (f(x + h) ± g(x + h)) - (f(x) ± g(x)) Ahf(x) ± Ahg(X); Ah(f · g) (x) f(x + h)g(x + h) - f(x)g(x) - f(x + h)(g(x + h) - g(x)) + g(x)(f(x + h) - f(x)) f(x + h)Ah9(X) + g(x)Ahf(x); Ah(f· g) (x) - f(x)(g(x + h) - g(x)) + g(x + h)(f(x + h) - f(x)) f(x)Ahg(X) + g(x + h)Ahf(x); t.h (�) (x) - f(x + h) f(x) - -- g(x + h) g(x) f(x + h)g(x) - f(x)g(x + h) g(x + h)g(x) g(x)(f(x + h) - f(x)) - f(x) (g(x + h) - g(x)) g(x + h)g(x) g(x)Ahf(x) - f(x)Ah9(X) g(x + h)g(x) 5.9 The Calculus 01 Derivatives 167 Now to obtain the analogous rules for derivatives, we simply divide these identities by h and take the limit as h � O. For sums and products there is no difficulty, since the limits interchange with these operations. For the quotient we need to assume that 9 is not zero at the point in question. Theorem 5.3.1 II I and 9 are differentiable at Xo, then I ± 9 and I· 9 are also differentiable at Xo, and (I ±g)'(xo) = I'(xo} ±g'(xo}, (f· g)'(xo) = f(xo}g'(xo} + f'(xo}g(xo}· In addition, il g(xo} =F 0, then / / 9 is differentiable at Xo, and ( I)' (xo) = g(xo}f'(xo} - I(xo}g'(xo} . 9 g(xO}2 Proof: We write out the complete proof for the quotient. The as­ sumptions about differentiability mean limh_o Ilhl(xo}/h = I'(xo} and limh_o Ilhg(xo}/h = g(xo}. The fact that 9 is differentiable at ·xo im­ plies that it is continuous at Xo , so limh_O g(xo + h) = g(xo). Since we are assuming g(xo) f::. 0, we have also limh_O g(xo + h) f::. O. Altogether lim �h (/ /g) (xo) h-O h lim g(xo}llhf(xo} - f(XO}llh(XO} h-O hg(xo + h)g(xo) g(xo} limh_O ll.hf(xo)/h - !(xo) limh_o ll.hg(xo)/h g(xo) limh_O g(xo + h} which shows the limit exists (meaning I/g is differentiable at xo) and equals g(xo)f'(xo} - I(xo)g'(xo) g(xO)2 The proof for the sum and product is similar. For the product we can use either identity for the difference of a product-in the limit they yield the same formula. We obtain immediately similar results about differentiability on an interval and even continuous differentiability since the formulas for derivatives preserve continuity (the condition g( x) =F 0 for all x in the interval is required for the quotient, of course). What happens to the derivative of a quotient when both f and 9 are zero is a very inter­ esting question-one we will be able to answer after we discuss Taylor's theorem. 168 Chapter 5 Differential Calculus 5.3.2 The Chain Rule The next basic calculus formula is the chain rule for the derivative of the composition go /(x) = g(/(x)). We begin with a direct approach to the computation in terms of dif­ ference quotients; this approach encounters some obstacles, which will lead us to rethink the whole problem. We compute first the difference of the composition: Ah90 /(x) - g(/(x + h)) - g(/(x)) - g(/(x) + (/(x + h) - /(x))) - g(/(x)) (A�,d(x)9)(/(X) ). This rather cumbersome notation means we take the difference of the function 9 at the point /(x) with increment Ahl(x). Of course the domain of 9 must include /(x) and I(x + h) for this to be meaningful. To compute the derivative we want to divide by h and let h � O. To simplify the notation we let z = Ah/(X). Then Ah90 f(z) h (Azg)(f(z» h Az9(/(X)) z . -z h Azg(f(x)) Ahl(x) -..;;.....;..;....;.....;..;.. .-�-z h and so the limit will exist (and equal the product) if the limits of both Azg(/(x))/z and Ahf(x)/h exist. Now if we fix x = xo and assume that / is differentiable at Xo, then we have limh_O Ahl(xo)/h = I'(xo). For the other factor, if we assume 9 is differentiable at the point / (xo), we have limz_o Az9(/(xo))/z = 9'(/(Xo)). This is not quite what is called for, since we are taking the limit as h goes to zero, and z is defined in terms of h, namely z = t1h/(XO)' Now we do know that 1 is continuous at Xo, because it is differentiable, so limh_o z = 0, which seems to imply limh_O t1zg(/(xo))/z = g'(/(xo)), leading to the familiar chain rule (g 0 J)' (xo) = g' (J (xo » J' (xo). However, if you try to make this into a precise proof you will come upon one very sticky point: if z = 0 nothing is defined. Of course nothing is defined if h = 0, either, but this is excluded in the definition of the derivative, while there is 5.9 The Calculus of Derivatives 169 nothing to exclude z = O. In fact z = 0 whenever f(xo + h) = f(xo), which may well happen for values of h arbitrarily close to zero. Thus we have only established the chain rule if there exists a neighborhood of zero such that Ilhf (xo) =F 0 for non-zero h in the neighborhood. We can make a separate proof in the contrary case, showing that then both f'(xo) = 0 and gof'(xo) = O. However this results in a rather awkward proof, so we will try another tack, leaving the completion of the first approach for the exercises. Let us think about the chain rule in terms of best affine approxi­ mations. If f is differentiable at xo, then f(x) = f(xo) + f'(xo)(x -xo) + o(x - xo). [Strictly speaking, we should write f(x) = f(xo)+ f'(xo)(x-xo) + R (x) with R(x) = o(x -xo) as x -+ Xo, and this is the meaning of our abbre­ viation. This is a convenient and standard notational short-hand. You should keep in mind, however, that different occurrences of the same symbol o(x - xo) might refer to different functions.] If 9 is differen­ tiable at Yo = f(xo), then g(y) = g(yo) + g'(yo)(y - Yo) + o(y - Yo). Substituting y = f(x) we obtain g(f(x» g(f(xo» + g'(f(xo»(f(x) - f(xo» + o(y - Yo) g(f(xo» + g'(f(xo»(!'(xo)(x - xo) +o(x - XO» + o(y - Yo) - g(f(xo» + g'(f(xo)}f'(xo)(x - xo) + remainder, where the remainder term is the sum of g'(f(xo» o(x - xo) and o(y - yo). To complete the proof we have to show this remainder is o( x - xo). Before doing this we should provide some interpretation for these computations. The formula f(x) = f(xo) + f'(xo}{x - xo) + o(x - xo) is the same as f(x) - f(xo) = f'(xo)(x - xo) + o(x - xo) or even Ilhf(xo) = f'(xo)h + o(h) if we set x = Xo + h. We inter­ pret this to say that for values of x near xo, changes in the x variable are multiplied by the magnification factor J' (xo)-aside from a small remainder term-in order to obtain changes in y = f (x) . Similarly g(y)-g(yo) = g'(Yo)(y-Yo)+o(y-Yo) means changes in y, for y near Yo, get multiplied by the factor g' (Yo )-again aside from a small error-in passing to changes in g(y). Thus in the composition go f the change in 170 Chapter 5 Differential Calculus x first gets multiplied by f' (xo) and then by g'(yo) = g'(f(xo)) , hence altogether by g'(f(xo))f' (xo) , before producing a change in g o f. No­ tice that the error in the first stage also gets multiplied by g' (f(xo )) and is then added to the error in the second stage. We can now put this all together into a complete proof. Theorem 5.3.2 (Chain Rule) Let f be defined in a neighborhood of Xo and differentiable at xo , and let 9 be defined in a neighborhood of f (:to) and differentiable at f (xo) . Then go f is differentiable at Xo and (g 0 f)' (xo) = g' (f(xo))f' (xo). Proof: We need to show that given any 11m we can make Ig(f(x)) - g(f(xo)) - g'(f(xo))f'(xo)(x - xo)1 � Ix - xo l m by taking x close enough to Xo. From our discussion we know that we want to break this into two parts as follows: g(f(x) ) - g(f(xo)) - g'(f(xo))f' (xo)(x - xo) = [g(f(x)) - g(f(xo)) - g' (/(xo)) (f(x) - f(xo))] +[g' (/(xo)) (/(x) - /(xo) - f'(xo)(x - xo ))]. If we can show that each of the terms in brackets is at most Ix - xoI/2m, we will be done. For the second term this is just the differentiability of f at xo , which enables us to get , I x - xo l If(x) - /(xo) - / (xo)(x - xo) 1 < 2m lg' (/(xo))1 by taking x close to Xo (if g'(/(xo)) = 0 the whole term is zero and there is nothing to prove). For the first term we have to work a little harder. By the differentiability of 9 at f (xo) = Yo we can make I { , (( I y - Yo I g(y) - 9 Yo ) - 9 Yo) y - yo) 1 � km if Iy - yo l < lin by choosing n to depend on km (the value of k will be chosen later). Substituting y = /(x) and Yo = / (xo) we obtain that If(x) - /(xo)1 < lin implies Ig(f(x)) - g(f(xo)) - g' (f(xo) )(/(x) - f(xo )) I < If{x) - f{xo) 1 km 5. 9 The Calculus 01 Derivatives 171 Finally, by the differentiability of I at xo, we can make both I/(x) - f(xo)1 < lin, so the above applies, and If(x) - l(xo)1 < Mlx -xol where M = l+lf'(xo)1 (recall the proof that differentiability implies Lipschitz continuity) by taking x close enough to Xo. This gives the estimate M I km for the first term in brackets, and we need only take k = 2M to complete the proof. QED When we come to discuss the differential calculus in several vari­ ables we will also have a chain rule, and we will be able to adapt the above proof to that context. 5.3.3 Inverse Function Theorem The last of the important formulas in the calculus of derivatives is the rule for differentiating functions given implicitly. We are going to have to postpone a full discussion until a later chapter, because it requires the differential calculus in two variables. Here we will discuss a special case, that of inverse functions. In the abstract definition of function, if I is one-to-one from its domain D to its range R and is onto R (the image I(D) is all of R), then the inverse function 1-1 with domain R and range D is defined by f-I(y) = x if and only if I(x) = y. If ID and I R denote the identity functions on D and R respectively, then 1-1 0 I = I D and I 0 1-1 = I R. To begin the discussion we will assume that I is a numerical func­ tion and I and 1-1 are both differentiable. This is a big assumption, and we will have to return to the point later. What we can see eas­ ily is that the chain rule establishes an identity involving the deriva­ tives of I and 1-1. Note that I(x) = x is the identity function on R, so 1-1(/(x)) = x. Since this is an equality between functions, we may differentiate both sides of the equation. (Unfortunately, mathe­ matical notation is sometimes ambiguous about whether an equation I (x) = g( x) is meant to hold for all x or just for some particular value x. From the equality f (x) = g( x) at one point x we can conclude nothing about the derivatives of I and 9 at that point; but if I(x) = g(x) for all x in the domains, then I and 9 are the same function, so f' (x) = g' (x) for all x because I' and g' are the same function.) From the chain rule 172 Chapter 5 Differential Calculus we obtain (f-l )'(f(x))/'(x) = 1, hence (/-1 )'(y) - 1 I'(x) ' or I' � '\" ) if Y = f ( '\" ) , or 1 1'(/-1 (y)) . The last form is what we obtain by differentiating 1(/-1 (y)) = y and solving for the derivative of 1-1 . We might attempt to paraphrase this relation as saying the deriva­ tive of the inverse function is the reciprocal (the multiplicative inverse) of the derivative of the function. However, this is only part of the sto­ ry, because it doesn't say where the derivatives are evaluated. It is not true that (1- 1 )'(x) has any relation to 1/ f'(x), for example. A good way to think about the situation is via the graphs of I and 1-1 . Since y = I(x) if and only if x = 1-1 (y), the graph of 1- 1 is obtained from the graph of I by interchanging the axes. This is the same as reflecting the graph in the diagonal line y = x , as shown in Figure 5.3.1. y=x j(x) , Figure 5.3.1: Now the tangent line to the graph of I at the point (xo, Yo) is also reflected in y = x into the tangent line to the graph of 1-1 at the point 5.9 The Calculus 01 Derivatives (YO, XO), as shown in Figure 5.3.2. I / Xo �------- / / . 1 / I 1 / Yo � - - - - - - .,. � - I / 1 1 I / / 1 I I / I / / 1 / I / / I / 1 Yo Xo Figure 5.3.2: / / 173 The interchange of axes clearly changes the slope of the tangent line ll.y / ll.x into its reciprocal ll.x / ll.y, while the first coordinate of the point of tangency is also clearly changed from Xo to Yo . The formal computation of (/- 1 )', made under the assumption that I- I exists and is differentiable, has given us a good intuitive grasp of the situation. Now we have to come to grips with three important problems: 1. How do we know if I- I exists? 2. How do we know if I- I is differentiable? 3. What happens when I' {x) = O? It turns out that all these problems are interconnected. We will start with a differentiable function f, and to avoid splitting hairs let us as­ sume that J is continuously differentiable on an interval (a, b) . How Can I be one-to-one? If I is strictly increasing or strictly decreasing, then I cannot assume one value twice. Actually the converse is true; we will leave the proof as an exercise, since we will not need this result. How can we assure that I is strictly increasing or decreasing? By making I' ( x) > 0 or I' (x) < 0 on the interval. If we make this assumption, 174 Chapter 5 Differential Calculus then we can define 1-1 with domain equal to the image of I, which is also an open interval. We also avoid the problem of what happens at a point where I' is zero. In fact it is clear from the reBection picture that if I'(xo) is zero, hence the tangent is horizontal, and if 1-1 exists, then the tangent to the graph of 1-1 must be vertical at the corresponding point Yo = I(xo), so 1-1 is not differentiable at Yo. The simplest exam­ ple of this is I(x) = x3 at x = O. The inverse function 1-1(y) = ¥y is not differentiable at y = O. Therefore we are not missing any positive results if we assume either I' (x) > 0 or I' (x) < 0 on the interval. Inverse Function Theorem Let I be a continuously differentiable function on an open interval (a, b), with image (c, d); and suppose either I'(x) > 0 or I'(x) < 0 on (a, b). Then 1-1 with domain (c, d) and image (a, b) is continuously differentiable, and (/-1 )/(y) = 1/ f'(x) il y = I(x). Proof: Let Xo, Yo denote fixed points such that I(xo} = Yo, and let x, y denote variable points such that I (x) = y. Then lim y - Yo = !'(xo) X-Xo x - Xo exists and is non-zero, so limx_ xo(x - xo)/(y - Yo) = 1/ f'(xo}. Now (x -xo)/(y -Yo) is the difference quotient whose limit is the derivative of 1-1 at Yo. The only problem is that in the definition of (1-1), we are supposed to take the limit as y � Yo. Is this the same thing? To find out, let 's write what we know and what we need to show. We know limx_xo(x - xo)/(y - Yo} = 1/1'(xo), so given any error l/m there exists 1/ n such that x - xo y - Yo 1 1 <-I'(xo) m provided Ix - xol < l/n and x #- Xo. What we need to show is limy_yO (x - xo) / (y - yo) = 1/ I' ( xo), in other words given any error l/m there exists 1/k such that x - Xo y- YO 1 1 <-I'(xo) m 5.9 The Calculus 01 Derivatives 175 provided Iy - yo l < l/k and y =/: Yo. Thus to bridge the gap between these statements we need to show: lor any error lin there exists 11k such that Ix - xol < l/n and x # Xo promded Iy - yol < l/k and y =/: Yo . Note that y =/: Yo implies x =/: Xo because I is one-to-one, so that part is easy. The rest of the statement is exactly the definition of the continuity of 1-1 at Yo. This is the non-trivial part. Why should I-I be continuous? The idea is that since I' is never zero, it must be bounded away from zero in a neighborhood of xo, so that changes in x must result in substantial changes in y-we get estimates that go in the opposite direction of the continuity estimates for I, so that when we switch over to I-I the estimates will go in the correct direction. More precisely, first choose a neighborhood of Xo such that 1/'(x)1 > l/N for some fixed N and all x in the neighborhood (here we use the continuity of the derivative). Then the mean value theorem (/(x) - I(xo))/(x - xo) = I' (xt} gives the estimate I/(x) - l(xo) 1 > Ix - xo l/N for all x in the neighborhood. Note that this is the reverse of the usual Lipschitz condition. But now y = I(x) and Yo = I(xo), so Iy - Yol < l/Nn implies Ix - xol < Nly - yo l < l/n as desired. This proves the continuity of 1-1 and so completes the proof of the differentiability of 1-1 with the correct derivative. Finally (/-1 )(y) = 1/J'(/-1 (y)) is continuous because I' and I-I are continuous and I' is never zero. QED The inverse function theorem as stated is unique to one dimen­ sion, because only in one dimension do we have a criterion like strictly increasing or decreasing for the function to be one-to-one. There is a local version of the theorem, however, that can be generalized to higher dimensions, and for that reason we state it here. Local Inverse Function Theorem Let f be defined and continuously differentiable in a neighborhood 01 xo, and suppose I'(xo) # O. Then there exists a neighborhood (a, b) 0/ Zo such that the restriction 0/ / to (a, b) has a continuously differentiable inverse on the image (c, d) = 1« a, b)). Proof: Since I' is assumed continuous and I'(xo) # 0, we can find a neighborhood (a, b) of Xo such that either I' (x) > 0 or I' (x) < 0 there, and then we apply the global theorem. QED 176 Chapter 5 Differential Calculus The inverse function theorem is an extremely useful and powerful theorem. Many important functions such as exp, sine, and cosine are best defined as inverses of functions given by explicit integrals. We will develop these ideas in a later chapter. The inverse function theorem in higher dimensions, which is a generalization of the local version only, is used to prove the differentiability (and existence) of functions defined implicitly. 5.3.4 Exercises 1. Define x = { z if x > 0, + 0 if x < O. Prove that I (x) = xi is continuously differentiable if k is an integer greater than one. 2. Show that (x -a)� {b-x)� is a continuously differentiable function that is non-zero exactly on the interval (a, b). 3. Given a closed set A, construct a continuously differentiable func­ tion that has A as its set of zeroes. 4. Prove that if f is any continuous one-to-one function on an interval (a, b) , then either I is strictly increasing or strictly decreasing 5. If I is differentiable on (a, b) and I' (x) =F 0 for all x in the interval, prove that either I'{X) > 0 or I'{X) < 0 on the entire interval. 6. Give a proof of the chain rule arguing separately in the case when every neighborhood of zero contains a value of h for which ahl(xo) = O. 7. Prove that f(x) = xl/k can be defined on [0, 00) by the require­ ment that it be the inverse function of g{x) = xk on [0, 00), where k is any positive integer. Use the inverse function theorem to derive the usual formula for I'. 8. For any rational number r give a definition of I{x) = xT for x > 0 and show I'{X) = rxT -l. 9. Show that x+ is continuously differentiable for any rational r > 1. 5.4 Higher Derivatives and Taylor's Theorem 177 10. Show that a polynomial of even order (=F 0) has either a global maximum or a global minimum but not both. 11. Show that the class of rational functions (polynomial divided by polynomial) is closed under the operation of differentiation. 12. *Show that no rational function has derivative equal to 1/x. 13. Let In denote the nth iterate of I, fI = I, 12 (x ) = l(fI (x)), . . . In(x) = 1(ln-l (x)). Express I� in terms of I'. Show that if a < II'(X) I < b for all x, then an < 1/�(x)1 < bn. 14. If f is a polynomial, show that In is a polynomial. What is the degree of In if I has degree N? Similarly, show that if I is a rational function, then In is a rational function. 15. A function is called algebraic if it satisfies a polynomial identity � ajkxi I(x)k = 0 (finite sum, not all coefficients ajk zero). As­ suming I (x) is differentiable, find a formula for f' in terms of f· 5.4 Higher Derivatives and Taylor's Theorem 5.4. 1 Interpretations of the Second Derivative If I is a differentiable function on an interval, then I' is also a func­ tion on that interval, which may or may not be differentiable. If I' is differentiable at Xo we call its derivative I\"(XO) the second derivative of I at Xo. If I\" exists for every point in the interval and is continuous we say I is twice continuously differentiable or I is C2• You are no doubt familiar with the interpretation of acceleration as a second derivative. The significance of acceleration in Newton's theory of mechanics guarantees that the notion of second derivative is of great importance. Another familiar application of second derivatives involves concavity of the graph and the problem of distinguishing local maxima and minima. Roughly speaking, in an intenJal where I\" is positive, the graph lies above tangent lines and below secant lines, and only local minima can occur, while the reverse is true on an intenJal where I\" is negative. This is illustrated in Figure 5.4.1. 178 Chapter 5 Differential Calculus I\" > 0 Figure 5.4. 1: We will establish these relationships in two theorems. The first deals with properties of the second derivative at a single point, and the sec­ ond with properties of a continuous second derivative on an interval. The relationship involving the secant line only shows up in the second theorem. Theorem 5.4.1 Suppose f is differentiable in a neighborhood of Xo and f\"{xo) exists. Let g{x) = f{xo) + f'{xo)(x - xo) denote the best affine approximation to f at Xo . a. II I\"{xo) > 0, then there exists a neighborhood 01 Xo where I{x) > g{x) (even f{x) > g{x} for x # xo}, while il f\"(xo} < 0 there exists a neighborhood of Xo where f{x) < g(x) . b. If f{x) > g{x) in a neighborhood 01 xo, then I\"{xo) > 0; while if f{x} < g{x) in a neighborhood of xo, then I\"{xo) < O. c. Suppose also f'{xo) = O. If f\"{xo) > 0, then xo is a strict local minimum; while if I\"(xo} < 0, then Xo is a strict local maximum. d. If xo is a local minimum, then I\" {xo} > 0; while if xo is a local maximum, then f\"{xo} < O. Proof: We begin with part c. If f\" (xo) > 0 this means the derivative of I' is positive at xo, hence f'(x} is strictly increasing at Xo. Since f'{xo) = 0, this means that f'{x) < 0 if x < xo and I'{x) > 0 if x > xo for x near xo, say Ix -xol < lin. But this implies f is strictly decreasing on (xo - lin, xo) and strictly increasing on (xo, Xo + lin), so xo is a 5.4 Higher Derivatives and Taylor's Theorem 179 strict local minimum. Notice that the proof used twice the relations between sign of the first derivative and behavior of the function: first in going from the sign of the derivative of I\" at a point to behavior of I' near the point and then in going from the sign of I' on an interval to behavior of I on the interval. The proof that I\"(XO} < 0 implies Xo is a strict local maximum is analogous. N ext part d is essentially the contrapositive of part c, for a local minimum cannot be also a strict local maximum, so we cannot have I\"(XO} < 0 by part c. Finally we can derive part a from part c and part b from part d. The function I (x) - g{ x} vanishes at Xo, and its derivative is also zero at Xo while its second derivative is merely I\"{xo}. If I\"{xo} > 0, then part c implies that I(x} - g(x} has a strict local minimum at Xo, hence f{x} - g{x} > I(xo} - g(xo} = 0 in a neighborhood of Xo, with strict inequality for x ;/= Xo. Similarly, we can derive part b from part d. QED The function I(x} = x4 has a strict minimum at x = 0, but its second derivative is zero there, showing that we cannot improve part d to have strict inequality. Theorem 5.4.2 Let I be a C2 junction on an interval {a, b} . Let 9 denote any affine junction whose graph intersects the graph 01 I at two points {x}, yI) and {X2' Y2} with Xl < X2 · If I\"{x} > 0 lor all x in (Xl , X2), then f(x} < g(x} lor all x in (Xl , X2}j while il f\"(xo) < 0 lor all x in (Xl , X2), then f(x} > g(x} lor all x in {Xl , X2}. Proof: Suppose I\" > 0 in the interval (x} , X2}. Then the same is true for h = f -g because g\" = O. Note that h vanishes at the endpoints of the interval. We want to prove that h is negative on (Xl , X2 ). If not, it would achieve a local maximum on {x}, X2), say at Xo, and by part d of the previous theorem this would imply h\"(zo) < 0, a contradiction. QED The same proof also applies to non-strict inequalities. There is a converse to this theorem, which we leave to the exercises. A different interpretation of the second derivative involves the no­ tion of the second difference. This idea is implicit in the notation 180 Chapter 5 Differential Calculus fily / dx2 and is useful in numerical solutions to differential equations. Recall that we defined the difference operator ah with increment h as ahf(x) = f(x+h) - f(x) and f'(x) as the limit of ahf(x)/h as h � O. The second difference operator a� is simply ah applied twice: ah(ahf)(x) - ll.hf(x + h) - ahf(x) - [f (x + h + h) - f (x + h)] - [f (x + h) - f (x) ] f(x + 2h) - 2f(x + h) + f{x). The second derivative should then be the limit of a�f (x)/h2 as h � O. The reason for this is that for small h and so f(x + 2h) - f{x + h) � f' (x + h) h f(x + h� - f{x) � f'{x), a�f(x) __ f' (x + h) - f' (x) -- f\"{ ) h2 -- h -- x . To make this argument precise we will need to use the mean value theorem. A direct approach would be to replace the difference quo­ tients (f(x + 2h) - f{x + h))/h and (f{x + h) - f(x))/h by deriva­ tives. However this would lead to the awkward situation of having a�f(x)/h2 = (f'(X2) - f'(xt ))/h where X2 is in (x + h, x + 2h) and Xl is in (x, x + h), and we would have no control over X2 - Xl . We need a more clever idea. Theorem 5.4.3 If f is C2 on an interval, then limh_O a�f(x)/h2 ex­ ists and equals f\" (x) for any x in the interval. Proof: We apply the mean val ue theorem to the function g(t) = f(t + h) - f(t) on the interval l x, x + hi. Since g'(t) = f'(t + h) - f'(t), we have the required differentiability and continuity of 9 if h is small enough. The mean value theorem gives (g{x + h) - g(x))/h = g'(xo) for Xo in (x, x + h), and this is exactly l:J.2 �(x) = /'(xo + h) - /'(xo); 5.4 Higher Derivatives and Taylor's Theorem hence, �2 I(x} h2 I'(xo + h} - I'(xo) h 181 This is similar to what we had before, with Xl = Xo and X2 = Xo + h, but now we have the difference X2 - Xl = h under control. Applying the mean value theorem again to this difference quotient we obtain ��/(x}/h2 = 1\"(xI) for some point Xl in (xo, Xo + h). Since Xl must lie between X and X + 2h and I\" is assumed continuous, we may take the limit as h -T 0 and get I\" (x). QED There is also a converse to this theorem, but it is much more difficult to prove. 5.4.2 Taylor's Theorem We come now to the last, and in many ways the most important, interpretation of the second derivative. We have seen that the first derivative can be thought of as one of the constants in the best affine approximation to I at the point. Now an affine function is a poly­ nomial of degree one, and the derivative shows up as the coefficient of the leading (highest degree) term. We can think of the best affine approximation as an improvement over approximation by the constan­ t function y = I(xo}, which is the best polynomial of degree-zero approximation to I at Xo. The affine approximation is an improve­ ment because we only have I(x} - I(xo} = 0(1) = o(lx - xolO) while I(x} - (/(xo) + I'(xo}{x - xo}} = o(lx - xo!) as X -T Xo. From this we would guess that by allowing polynomials of degree 2 we should be able to improve the approximation to o(lx - xoI2). Now if I itself is a polynomial of degree at most 2, then I(x) = I(xo) + !' (xo}{x -xo) + � I\" (xo}{x - xO)2, as can be verified by a simple computation. For more general J, we would expect g2(X) = I(xo) + I'(xo}{x - xo} + �/\"(xo)(x - xO}2 to be the best approximation to I at Xo by polynomials of degree at most 2. The second derivative thus appears as the coefficient of the leading term, except for the factor of 1/2. 182 Chapter 5 Differential Calculus Now the expected improvement in using 92 rather than the affine ap­ proximation concerns the rate of convergence as x � Xo. For any par­ ticular value of x we do not know whether 92 is a better approximation­ it might very well be worse. However, the error being o(lx-xoI2) means that by taking x close enough to xo we have a very good approxima­ tion, since Ix - xol2 is an order of magnitude smaller than Ix - xol. The graphs of f and 92 in Figure 5.4.2 show this in the order of contact at the point. y= I(x) Figure 5.4.2: Since the quadratic term f\"(xo}(x - xo)2/2 is O(lx - xo l2) as x � xo, we can expect this order of improvement. Theorem 5.4.4 Let 1 be a C2 function defined in a neighborhood 01 xo, and let 92 (x) = f (xo) + f' (xo) (x - xo) + �f\" (xo) (x - xO)2 . Then 1 - 92 = o(lx - xol2) as x � Xo; in other words, given any error 11m, there exists lin such that Ix - xo l < lin implies I/(x) - 92 (x)1 < ..!:.. Ix - xol2• m 5.4 Higher Derivatives and Taylor's Theorem 183 Proof: The function 92 was chosen so that I(xo} = 92(XO}, I'(xo} = 5h(xo), and I\"(xo) = g'2(xO). Thus if we let F = I -g2 we have F(xo) = 0, F'(xo) = 0, and F\"(xo} = 0, and F is (J2, being the difference of I and a quadratic polynomial. We need to show that we can make IF(x)1 < Ix - xol2/m by taking x near Xo, and we can do this by applying the mean value theorem twice to F. First, since F(xo) = 0, we have F(x) = F'(xd(x - xo) for some Xl between Xo and x. Similarly, since F'(xo) = 0, F'(xd = F\"(X2)(Xl - xo} for some X2 between Xo and Xl. The fact that F is C2 guarantees that the continuity and differentiability conditions of the mean value theorem are satisfied by F and F'. Putting together these two equations gives us F(x) = F\"(X2)(X - XO)(XI - xo). Hence IF(x)1 < IF\"(X2}llx - xol2 since IXI - xol < Ix-xol because Xl lies between Xo and x. Now F\"(xo) = ° and F\" is continuous, so given 11m there exists lIn such that Ix - xol < lIn implies IF\"(x)1 < 11m. The point X2 must lie in the neighborhood Ix - xol < lIn also, since it lies between Xo and x, so IF\"(X2)1 < 11m and we have as required. QED We will not discuss the problem of obtaining a converse kind of statement, deducing the existence of the second derivative from the ex­ istence of quadratic polynomial approximations, because such theorems are extremely difficult to prove and have few applications. The theorem we have just established is clearly part two of a more general theorem, which is known as Taylor's Theorem. Let us write Tn(xo, x) = I(xo) + I'(xo)(x - xo) + � I\" (xo)(x - xO)2 + ... + �! I(n) (xo}{x - xot, called the Taylor expansion of I at Xo. Here I(n) denotes the nth derivative of I, defined by induction I(n) = I(n-l),. We say I is en il all derivatives up to order n exist and are continuous. We think of Xo as a fixed point and Tn(xo, x) as a function of x. It is a polynomial of degree n and is uniquely determined by the requirement that at the point Xo it agrees with I up to the nth derivative. If we need to discuss 184 Chapter 5 Differential Calculus more than one function at a time we will write Tn(f, Xo, x) instead of Tn(xo, x). Theorem 5.4.5 (Taylor's Theorem) Let f be en in a neighborhood of Xo. Then f - Tn = o(lx - xoln) as x -+ Xo· Proof: Setting F = f -Tn, we have F(k) (xo) = 0 for k = 0, 1 , ... ,n . We need to show F(x) = o(lx - xoln) as x -+ Xo. We apply the mean value theorem n times to the functions F, F', ... ,F(n-l) to obtain points Xl! X2, ... , Xn all between Xo and Xl, such that F(x) F'(xd F(n-l)(xn_d F'(XI)(X - xo), F\" (X2)(XI - xo), ... F(n)(Xn)(Xn_1 - xo), each time using F(k)(XO) = 0, and the hypothesis that f is en (hence F is en). Altogether we obtain F(x) = F(n) (xn)(x - XO)(XI - xo) · ·· (Xn-l - xo), hence IF(x)1 < IF(n)(xn)l lx-xoln and we complete the proof as before using F(n)(xo) = 0 and the continuity of F(n). QED Taylor's theorem is extremely useful for understanding the behavior of a function near a point. It is important to realize, however, that the theorem does not assert anything about the behavior of Tn (xo, x) at a point x as n varies. The parameter n must be fixed in any application of the theorem, and X must vary close to xo. We will return to this later when we discuss two seemingly related but in fact quite different topics: power series and the Weierstrass approximation theorem. Taylor's theorem gives us a formula for the Taylor expansion Tn(xo, x), but it is not always necessary-or advisable--to use this formula to compute the Taylor expansion. We know Tn(xo, x) is uniquely deter­ mined among polynomials of degree n by the condition f(x)-Tn(xo, x) = o(lx - xoln) as x -+ Xo, for if we also had f(x) - g(x) = o(lx - xoln) as x -+ Xo for 9 a polynomial of degree n, then g(x) - Tn(xo, x) -+ 0 (x - xo)n 5.4 Higher Derivatives and Taylor's Theorem 185 as x -+ Xo and by writing g(x) - Tn(xo, x) = L�=o ak(x - xO)k we can show first ao = 0, then al = 0, etc., since the lowest order non­ zero term of L:=o ak(x - xo)k dominates all the others as x -+ Xo. This means that if we can obtain, by hook or crook, a polynomial 9 of degree n such that I(x) - g(x) = o(lx - xoln) as x -+ Xo, then g( x) = Tn (xo, x). For example, if 1 is the product of two functions 1 = II . 12 and we know the Taylor expansions of order n of II and f2, then we can obtain the Taylor expansion of order n of 1 by multiplying the Taylor expansions of 1 and 9 and retaining only the terms of degree up to n. Indeed the powers (x-xO)k for k > n are all o(lx-xoln) and so may be discarded. We will not state this-or other related results-as a formal theorem but rather enunciate a useful informal principle: you can operate with Taylor expansions in the same way you can operate with junctions, discarding higher order terms. We will leave as exercises various special cases of this principle. 5.4.3 L'Hopital's Rule* As an application, let's look at the notorious L'Hopital's rule for evalu­ ating limits of quotients, limx_xo 1 (x) / g( x) w hen both limits limx_xo J(x) and limx_xo g(x) vanish. We will see that Taylor's The­ orem leads to a conceptually clear proof of L'Hopital's rule and also allows us to answer some related questions, such as: what is the deriva­ tive of a quotient 1/ 9 at a common zero of J and g? Suppose f and 9 are C1 and g'(xo) =F 0. We write f(x) g(x) J(xo) + f'(xo)(x - xo) + o(lx - xol) g(xo) + g'(xo)(x - xo) + o(lx - xol) J'(xo)(x - xo) + o(lx - xol) g'(xo)(x - xo) + o(lx - xol) since we are assuming I(xo) = 0 and g(xo) = o. Now we would like to cancel the common factor x - Xo, which is non-zero if x ;/; Xo. This will change the o(lx - xol) terms, which stand for functions with limit zero at Xo after dividing by x - Xo, to 0(1) terms, which stand for functions with limit zero at Xo. Thus I(x) J'(xo) + 0(1) g(x) - g'(xo) + 0(1) 186 Chapter 5 Differential Calculus and if g'(xo) =F 0 there is no difficulty in taking the limit as x � Xo to get lim f(x) = lilIlx-xo(f'(xo) + 0(1)) = f'(xo) X-xo g(x) limx_xo(g'(xo) + 0(1)) g'(xo) . Now let's ask the question: what is the derivative of f(x)/g(x) at xo ? We assume, of course, that we define the value of f(x}/g(x) at Xo to be f' (xo ) / g' (xo) so as to have a continuous function. It is not obvious that f(x)/g(x) is differentiable at Xo, and even if it is, the usual quotient formula for the derivative will not be very helpful. Instead we want to look at the difference quotient and use Taylor's theorem to find its limit. The difference quotient at Xo is 1 [f(X) f'(xo)] x - Xo g(x) g'(xo) because f'(xo)/g'(xo) is the value of the function at Xo. Let us assume that f and 9 are C2 so that we can take the Taylor expansions to order 2. We obtain 1 [/(Z) _ I'(zo)] = I(z)g'(zo) - I'(zo)g(z) = A{z) x - Xo g(x) g'(xo) (x - xo)g(x)g'(xo) B(x) where A(x) - g'(xo) [/'(Xo)(X - xo) + il\"(xo)(x - xO)2 + o(lx - xoI2)] -I'(xo) [g'(xo)(x - xo) + igll(xO)(x - xO)2 + o(lx - xoI2)] . and B(x) = (x-xo)g'(xo) [g'(xo)(X - xo) + ig\" (xo)(x - xO)2 + o(lx - xoI2)] since f(xo) = g(xo) = O. Notice that the terms f'(xo)g'(xo)(x - xo) in the numerator cancel, and then we may factor out (x - xO)2 in the numerator and denominator to obtain simply g'(xo) [!f\"(xo) + 0(1)] - f'(xo) [!g\"(xo) + 0(1)] g'(xo) [g'(xo) + !g\"(xo)(x - xo) + o(lx - xol)] . 5.4 Higher Derivatives and Taylor's Theorem It is clear that this has a limit as x � Xo equal to g(xo)f\"(xo) - f'(xo)g'(xo) 2g'(xO)2 187 by the quotient formula for limits, so f / 9 is differentiable at xo and this is its derivative. We can also compute higher derivatives of f / 9 at Xo by similar arguments; to get the nth derivative we need to assume that f and 9 are cn+ 1• So far we have been dealing only with the case g'(xo) ;/; O. If g(xo) = 0 but f'(xo) =/: 0 we can easily show that f /g does not have a finite limit as x � xo. If both f'(xo) and g(xo) are zero, then we can go to higher order Taylor expansions (assuming more derivatives of f and 9 exist) to compute the limit of f /g. If f and 9 are en and f(k}(xO) = 0 and g(k}(xO) = 0 for k = 0, 1, ... , n - 1 but g(n)(xo) ;/; 0, then which clearly has limit f(n)(xo)/g(n)(xo) as x � xo. Using this gener­ alized L'Hopital's rule with n = 2 on the quotient f'(x)g(x) - f(x)g'(x) g(x)2 which is the derivative of f /g for x ;/; xo, we can show, under the assumptions that 1 and 9 are C3 and f(xo) = g(xo) = 0 but g'(xo) ;/; 0, that lim (f)' = g'(xo)/\"(xo) - f'(xo)g\"(xo) . :1:-:1:0 9 2g'(xO)2 Since this is the value we computed for (f /g)' at Xo, we have the con­ tinuity of (I/g)' at Xo. We leave the details as an exercise. The point of the above applications (and a number of exercises to follow) is that Taylor's theorem reduces certain kinds of problems to rather straightforward computations. Whenever the issue is the local behavior of a function near a point, it is the first technique you should try. Incidentally, I have not given the best possible results for L'Hopital's rule. There are slightly weaker hypotheses that will also do. 188 Chapter 5 Differential Calculus 5.4.4 Lagrange Remainder Formula· For many applications of Taylor's theorem one needs a more precise for­ m for the remainder, or error, term o{lx - xoln). We give now one such expression, the Lagrange remainder formula. We will give an integral remainder formula in the next chapter. The Lagrange remainder formu­ la is really a generalization of the mean value theorem since it involves the value of a higher derivative of the function at an unspecified point. If we write the mean value theorem as f{x) = f{xo) + f'{XI){X -xo) for some Xl between xo and x, we can interpret this as a zero-order Taylor theorem with remainder f'{XI}{X - xo). Note that the remainder looks exactly like the next term in the Taylor expansion except for the one change that the point Xl appears instead of Xo when we evaluate f'. This suggests the generalization for some point Xl between Xo and x. Note that this would give the error as O(lx - xoln+l), which is somewhat stronger than o{lx - xoln) (if f(x) - Tn(xo,x) = O(lx - xoln+l) then f(x) - Tn(xo, x) _ 0( 1 I) --:-----:--- - X - Xo , Ix - xoln so it goes to zero as X � xo) but would also require assuming f is cn+l since the derivative of order n + 1 is involved (as in the case of the mean value theorem we could get away without assuming the continuity of f(n+l) ). Lagrange Remainder Theorem Suppose f is cn+ I in a neighbor­ hood of Xo. Then for every X in the neighborhood there exists Xl between Xo and X such that Proof: It would appear that we should attempt to give a proof by induction, based on the mean value theorem. However, if you look back at the proof that we gave for Taylor's theorem, you will see that 5.4 Higher Derivatives and Taylor's Theorem 189 we do not quite get the desired form for the remainder. Therefore we will take a different approach. We ask what could make the difference f(x) - Tn(xo,x) as bad as possible? If f(n+l)(x) were identically zero, then f would be a polynomial of degree n and so f would equal Tn (xo, x) exactly. It would appear then, that to make f(x)-Tn(xo, x) big we need to have f(n+l)(x) big, and it seems reasonable that taking j(n+l)(x) equal to a constant M would do the most damage among all possibilities with f(n+l)(x) bounded by IMI. Of course if j(n+l)(x) = M for all x, then f is a polynomial of degree n + 1 and so for any Xl. More generally, if M+ and M_ denote the sup and inf of f(n+l) on the interval between Xo and x, then it is reasonable to expect that f(x) should lie between the extremes and Tn(xo. x) + ( 1 )' M+( x - xo)n+1 n+ 1 . Tn( xo. x) + (n � 1)1 M_ (x - xo)n+l, This will allow us to complete the proof since f(n+l) assumes all values between M_ and M+ on the interval between Xo and x. Suppose for simplicity that x > Xo. We need to show that where M_ < f(n+l) < M+ on [xo, xl. Let us write We need to show g(x) > 0; in fact we will show 9 is non-negative on the interval [xo, xl. Now the way we have constructed �ubtracting off the nth order Taylor expansion from f and then subtracting M_{x - xo)n+l J(n + 1)! guarantees that 9 and all its derivatives up to order n vanish at Xo (all these derivatives of (x - xo)n+l vanish at 190 Chapter 5 Differential Calculus xo), and furthermore g(n+l) is non-negative on the interval [xo, x] be­ cause g(n+l) = j(n+l) - M_ and M_ is the inf of j(n+l) on the interval (notice that here the factor l/(n + 1)! cancels the (n + I)-derivative of (x - xo)n+l ). Next we use reverse induction to show g(n), g(n-l), ... ,g', 9 are all non-negative on the interval. First we note that g(n)(xo) = 0 and g(n) is monotone increasing because its derivative g(n+l) is non-negative, so g(n) is non-negative. Once we know g(n) is non-negative we can apply the same reasoning to g(n-l) and so on. Finally when we have g(x) > 0 we have established M_(x - xo)n+l/(n + 1)! < j(x) - Tn(xo, x). The other inequality j(x)-Tn(xo, x) < M+(x-xo)n+l /(n+l)! is established by analogous reasoning. The case x < Xo is actually a little more complicated, because we have the same estimates when n + 1 is even but the reverse estimates 1 M ( )n+l f( ) 'T\" ( ) (n + 1)! + x - Xo < x - .Ln xl, Xo < 1 M ( )n+l ( )' - x - Xo n + 1 . when n + 1 is odd (when (x - xo)n+l is negative). We will leave the details as an exercise. Notice that the reversal of the estimates does not in any way destroy the final step in the argument, that we must have f(x) -Tn(xo, x) = j(n+l)(xd/(n + I)! for some Xl because j(n+l) assumes all values between M_ and M+. QED 5.4.5 Orders of Zeros· Taylor's theorem allows us to generalize many concepts and theorems about polynomials to more general functions that are sufficiently dif­ ferentiable. Here we discuss the notion of the order of a zero. If 9 is a polynomial and g(xo) = 0, the order of the zero at Xo is defined to be the highest integer k such that (x - xo)k divides g(x); in other words g(x) = gl(X)(X - xO)k for some polynomial gl(X) and gl(XO) # O. Now it is simple algebra to show that the order k is characterized by the fact that g(xo) = 0, g'(xo) = 0, ... , g(k-l) (xo) = 0 but g(k) (xo) # O. If the order is one we say Xo is a simple zero. The order gives the number of times (x - xo) divides the polynomial. It also gives the rate at which g(x} tends to zero as x � Xo; namely, g(x} = O(lx - xolk). 5.4 Higher Derivatives and Taylor's Theorem 191 N ow let f be an arbitrary function that vanishes at Xo and is of class Ck. We can say that f has a zero of order k at Xo if f (xo) = 0, f'(xo) = 0, .. . , f(k-l)(xO) = 0 but f{k}(xo) =F 0; in other words if the polynomial Tk(XO, x) has a zero of order k at Xo. Zeroes of order 1, 2, 3 are shown in Figure 5.4.3. Taylor's theorem then says f(x) = ak(x -xo)k + o{lx - xolk) where ak = f(k)(xo)/k! is non-zero, so f(x) = O(lx - xolk) as x � Xo. Thus the rate at which f tends to zero is the same as for a polynomial with the same order zero. We can also deduce that if the zero is of odd order the functions must change sign near Xo, while if the zero is of even order it does not change sign near Xo. Order 1 Order 2 Order 3 Figure 5.4.3: Finally we can also prove an analogue of factorization: f (x) = h (x) (x­ xO)k where h(x) is a continuous function if f has zero of order k at Xo. This is in fact a variation on l'Hopital's rule, which we leave as an exercise. We can paraphrase this discussion by saying the zeroes of order k of an arbitrary junction are qualitatively like (x-xo)k. A natural question that arises is: are there any other kinds of zeroes? If we call the zeroes we have been discussing zeroes of finite order, it turns out that there are also zeroes of infinite order. For this we must assume the function is Coo, which means that derivatives of all orders exist (hence must be continuous). A Coo function is said to have a zero of infinite order at Xo if /(n)(xo) = 0 for all n-so that all the Taylor expansions Tn(xo, x) vanish identically. It is not obvious that such zeros exist (except for f = 0), but the function e-1/x2 at x = 0 gives one example. We will discuss this further in the chapter on transcendental functions. 192 Chapter 5 Differential Calculus 5.4.6 Exercises 1. Suppose 1 is a e2 function on an interval (a, b) and the graph of f lies above every secant line. Prove that I\" (x) < 0 on the interval. 2. Suppose /'(xo) = 0, I\"(xo) = 0, . . . , I(n-l)(xo) = 0 and I(n) (xo) > 0, for a en function I. Prove that 1 has a local minimum at Xo if n is even and that Xo is neither a local maximum nor a local minimum if n is odd. 3. If 1 is e2 on an interval prove that li I(x + h) - 2/(x) + I(x - h) - 1\"( ) m h2 - x . h-O The expression 1 (x + h) -2/ (x) + I (x - h) is called the symmetric second difference. 4. Let 1 and 9 be e3 functions with I(xo) = g(xo) = 0 but g'(xo) # O. Show that the derivative of II 9 is continuous at Xo. 5. Under the same hypotheses as exercise 4 show that (1Ig)\" exists at Xo and compute it. 6. If 1 and 9 are Cn+1 and I(xo) = g(xo) = 0 but g'(xo) ;/; 0 show that Ilg is en near Xo and find a formula for (1Ig)(n) (xo). 7. If 1 and 9 are e3 functions and I(xo) = I'(xo) = g(xo) = g'(xo) = o but g\" (xo) =F 0 show that (1Ig)' exists at Xo and compute it. 8. For each of the following functions defined for x =F 0 find limx_o 1 (x) and 1'(0) if the function is appropriately defined at x = O. You may use the familiar formulas for derivatives of sine and cosine: a. 1 (x) = sin x I x, b. I(x) = (1 - cosx)lx2, c. I(x) = (x2 - x)1 sinx, d. I(x) = xl(l - cos x - sinx). 9. Suppose 1 is a en function on an interval and Tn (xo, x) is the same function of x for all Xo in the interval. What can you say about I? 5.4 Higher Derivatives and Taylor's Theorem 193 10. Complete the proof of the Lagrange remainder formula for x < Zo. 11. Suppose I and 9 are en functions with Taylor expansions denoted Tn(/, xo, x) and Tn(g, xo, x). Prove that Tn(/, xo, x) + Tn(g, xo,x) is the Taylor expansion of I + 9 at Xo. 12. Under the same hypotheses as exercise 11, show that the Taylor expansion of I·g at Xo is obtained by taking Tn(/, Xo, x)Tn(g, Xo, x) and retaining only the powers of (x - xo) up to n. 13. Suppose I is a en function in a neighborhood of Xo and 9 is en in a neighborhood of I(xo). Let ��=o ak(x - xO)k be Tn(/, Xo, x), and let �j=o bi (Y - Yo)i be Tn(g, Yo, y) where Yo = I(xo). Show that Tn(g 0 I, Xo, x) is obtained from by retaining only the powers of (x - xo) up to n. 14. If I(x) = 1/(1 + x) show that Tn(f, 0, x) = �k=O( _ 1)kxk. 15. Suppose f is a en function in a neighborhood of Xo and suppose I(xo) # O. Let Tn(/, Xo, x) = 2:k=O ak(x - xO)k. Show that Tn(l/ I, Xo, x) is obtained from by retaining only the powers of (x - xo) up to n. (Hint: use exercises 13 and 14.) 16. Compute the Taylor expansions to order 3 for each of the following functions at the points Xo = 0 and Xo = 1: a. I(x) = (x2 + 1)25, b. I(x) = x/(x2 + 1), c. I(x) = (1 + x + 2x2) sin2 1rx, d. I(x) = cos(l + x2). 194 Chapter 5 Differential Calculus 17. Suppose I is CI on an interval and I' satisfies the Holder condition of order (l, 1/'(x)-1'(y)1 < Mlx-ylQ for all x and y in the interval, where (l is a fixed value, 0 < (l < 1. Show that IA�/(x)1 < clhI1+Q• How does the constant c relate to the constant M? 18. Let I be a en function. Show that the derivative of Tn (I, Xo, x) is equal to Tn-d/', Xo, x). 19. Suppose I has a zero of order j at Xo and 9 has a zero of order k at Xo. What can you say about the order of zero of the function I + g, I . g, 1/ 9 at xo? 20. Use the second-order Taylor theorem with Lagrange remainder to estimate VIOl. 21. Apply Taylor's theorem with Lagrange remainder to (x + y)a for a rational to obtain a form of the binomial theorem. 22. *a. Let I be a C2 function on [a, b] and let Xl, . . . ,Xn be points in [a, b]. Show that I\"(x) > 0 on [a, b) implies f G (x! + . . . + Xn)) ::; � ( f(x l l + .. . + f(xn)) while f\"(x) < 0 implies the reverse inequality. b. More generally, let PI, ... ,Pn be positive and satisfy the con­ dition PI + . . . + Pn = 1. Show I\"(x) > 0 on [a, b] implies I(PIXI + .. '+Pnxn) < PI/(xt}+·· '+Pnf(xn), while I\"(x) < 0 implies the reverse inequality. 23. a. If I is en on an interval and has n + 1 distinct zeroes, prove that I(n) has at least one zero on the interval. b. If I is en on an interval and I{ n) never vanishes, then I has at most n zeroes on the interval. c. A polynomial of degree 11. has at most n real zeroes. d. *Ir I is e2 on an interval and Xl, X2, x3 are three distinct points on the interval, then there exists y in the interval with (Xl - x2)/{X3) + (X2 - x3)/{xt} + (X3 - Xt}/{X2) -�/\"(Y)(XI - X2)(X2 - X3)(X3 - xt}. 5. 5 Summary 195 (Hint: subtract a quadratic polynomial to reduce to part a) . 24. If f is C2 , prove that f cannot have a local maximum or minimum at an inflection point (note that an inflection point is defined as a point where f\" changes sign; it is not enough that f\" vanish at the point). 5.5 Summary 5.1 Concepts of the Derivative Definition 5.1.1 A junction f defined in a neighborhood of Xo is said to be differentiable at Xo with derivative f' (xo) if I· f(x) - f(xo) f' ( ) 1m = Xo X-Xo X - Xo or, equivalently, if for every m there exists n such that Ix - xo l < l/n implies If(x) - g(x)1 < Ix - xol/m where g(x) = f(xo) + f'(xo}{x - xo), called the best affine approximation to f at Xo. Definition 5.1.2 For junctions f and 9 defined in a neighborhood of Xo, we say f(x) = O(g(x)) as x � xo if If(x) 1 < clg(x)1 for some constant c in a neighborhood of Xo. We say f(x) = o(g(x)) as x � Xo if limx_xo f(x)/g(x) = 0. Theorem If f is differentiable at Xo, then f is continuous at Xo. Definition A junction is said to be differentiable on an open set if it is differentiable at each point of the set. It is said to be continuously differentiable (C1 ) if the derivative is a continuous function on the set. Example f(x) = { x2 sin(1/x2 ) , X =F 0, 0, x = 0, is differentiable but not C1 • 196 Chapter 5 Differential Calculus 5.2 Properties of the Derivative Definition 5.2.1 A junction I defined in a neighborhood of Xo is said to be monotone (resp. strictly) increasing at Xo if there exists a neigh­ borhood of Xo on which Xl < Xo < X2 implies f(xI} < f(xo} < f(x2} (resp. I(xd < I(xo) < I(X2}}. It is said to have a local maximum (re­ sp. strict local maximum) il there exists a neighborhood 01 Xo on which I{x} < I{xo} (resp. I(x) < I(xo} lor X ;/; xo} . A function defined on an interval is said to be monotone (resp. strictly) increasing on the interval il X < Y implies I{x} < I(y} (resp. I{x) < f(y}} lor all x and y in the interval. Similar definitions apply to monotone and strict decreasing and local minimum and strict local minimum by reversing the inequalities. Theorem 5.2.1 I'(xo} > 0 implies I is strictly increasing at Xo. II I is monotone increasing at Xo, then I'(xo) > o. II I has a local maximum at Xo, then I'(xo} = o. Intermediate Value Theorem II I is differentiable on (a, b) , then I'{x) assumes all values between I'(xd and 1'(X2) on the interval (XI,X2). Mean Value Theorem II I is continuous on [a, b) and differentiable on (a, b), then I'(xo} = {/(b} - I(a}}/(b - a} lor some Xo in (a, b) . Theorem 5.2.2 Let I be differentiable on (a, b) . 1. I is monotone increasing on (a, b) if and only if I' ( x) > 0 on (a, b). 2. I' ( x) > 0 on (a, b) implies I is strictly increasing on (a, b) . 3. I'(x} = 0 on (a, b) implies I is constant on (a, b) . Theorem II I is differentiable on (Q, b) and f' is bounded, then I satisfies a Lipschitz condition unilormly on (a, b) . 5.5 Summary 197 5.3 The Calculus of Derivatives Theorem 5.3.1 If / and 9 are differentiable at xo, then so are f±g, f· g, and f /g (i/ g(xo) =F O} with the familiar formulas for the derivatives. Theorem 5.3.2 ( Chain Rule) If f is differentiable at Xo and 9 ·is dif­ ferentiable at /(xo), then go f is differentiable at Xo and (g o f)'(xo) = 9' (/(xo) )/' (xo). Inverse Function Theorem Let / be Ct on (a, b) with image (c, d), and suppose /,(x) > 0 on (a, b) (or /,(x) < 0 on (a, b)}. Then /-1 exists on (c, d) and is C1 with (/-1 )'(y) = 1/ /,(x) il y = /(x). Local Inverse Function Theorem Let / be C1 in a neighborhood of Xo with /'{xo} =F O. Then there exists a neighborhood {a, b} of Xo such that / restricted to (a, b) has a C1 inverse on (c, d) = /« a, b)}. 5.4 Higher Derivatives and Taylor's Theorem Definition 1/ /' is defined in a neighborhood of Xo and differentiable at xo, then / is said to be twice differentiable at Xo with second deriva­ tive I\"{xo} equal to (/')'{xo). II f\"{x) exists and is continuous on an interval we say / is twice continuously differentiable (C2 ). Theorem 5.4. 1 Suppose /\"(xo} exists, and let g(x} = /(xo)+ I'(xo)(x­ xo} be the best affine approximation to f at Xo. 1. If f\"(xo} > 0, then /(x) > g(x} on a neighborhood 0/ xo, for x =F Xo (the graph 0/ / lies above the tangent line) . 2. If I(x) > g(x ) in a neighborhood 0/ xo , then /\" (xo) > o. 3. 1/ /'(xo) = 0 and /\"(xo} > 0, then Xo is a strict local minimum. 4. 1/ Xo is a local minimum, then /\"(xo} > O. Theorem 5.4.2 If / is C2 on (a, b) and /\"{x} > 0 on (a, b), then the graph 0/ / lies below any secant line. 198 Chapter 5 Differential Calculus Theorem 5.4.3 II I is e2 on an interval, then lim ��(x) = I\"{x) h-O h2 on the interval. Theorem 5.4.4 II I is e2 in a neighborhood olxo, then l{x)-g2{x) = o{lx - xol2) as x -T Xo where g2{X) = I{xo) + !'(xo)(x - xo) + �J\"(XO)(X - XO)2. Definition I(n)(xo) = (/(n-l))'{xo) by induction, il it exists. We say I is en il f(k) exists and is continuous lor all k < n. The Taylor expansion 01 order n at Xo lor a en function is defined by n Tn(xo, x) = L :! I(k) (xo}{x - xO}k. k=O Theorem 5.4.5 (Taylor's Theorem) II I is en, then I (x) -Tn (xo, x) = o{lx - xoln) as x -T Xo. L'Hopital Rule II I and 9 are e1 with I(xo} = g(xo} = 0 but g'(xo} =F 0, then lim I{x} = I'{xo}. X-Xo g(x} g'(xo) II I and 9 are e2 , then I / 9 is differentiable at Xo with (I)' (xo) = g'(xo)/\"(xo) - I'(xo)g\"(xo}. 9 2g'(xO)2 II I and 9 are e3, then 1/ 9 is e1 • Lagrange Remainder Theorem II I is en+ 1, then 1 I(x} = Tn(xo,x} + (n + 1)!/(n+l){xd(x - xot+1 5. 5 Summary 199 for some Zl between Zo and z. Definition If f is Ck we say f has a zero of order k at Zo if f(xo) = f'(xo) = . .. = f(k-l}(zO) = 0 but f(k} (xo) =f. O. Theorem If f has a zero of order k at Xo, then f(x) = O(lx - xolk ) as x -+ Xo . Chapter 6 Integral Calculus 6.1 Integrals of Continuous Funct ions 6.1.1 Existence of the Integral In this section we will prove the existence of the definite integral f: f{x) dx of a continuous function f on a compact interval [a, b], fol­ lowing the usual approach. That is, we partition the interval into n subintervals [Xk-l , Xk] where a = Xo < Xl < ... < Xn = b and form the approximating sum Lk=l f(Xk)(Xk-Xk-I). The value f(Xk)(Xk-Xk-d is the area of the rectangle shown in Figure 6.1.1 with base [Xk-l l Xk] and height f{Xk), which should be approximately the area under the graph of f over the interval [Xk-l , Xk] if f does not vary much. Thus, the approximating sum should be close to the area under the graph of f (with the convention that regions below the x-axis are counted with a minus sign). The integral should then be obtained as a limit of these approximating sums as the size of the subintervals decreases to zero, and the number n of subintervals increases without bound. The notion of \"limit\" we are using here is somewhat different from the notion of a limit of a function or limit of a sequence, but it is very much in the same spirit. We will give the precise definition below, but before doing so we need to discuss some of the intuitive ideas that will be needed in the proof and that will also play a role in our later extension of the notion of integral to more general (not necessarily continuous) functions. The choice of the point Xk at which we evaluate f is somewhat arbitrary. We could just as well choose any other point ak in the interval 201 202 Chapter 6 Integral Calculus a Figure 6.1.1: [Xk-l, Xk]. In fact let us write 8(/, P} = �k=l /(ak)(xk - xk-d where P denotes the partition and ak is any point in [Xk-l, Xk] and call this a Cauchy sum. Two important special cases are when we choose / (ak) as large (or as small) as possible. If Mk denotes the sup of / on [Xk-b Xk] and mk the inf, then Lk=l Mk(Xk -xk-d and Lk=l mk(xk -xk-d are the largest and smallest Cauchy sums we can form (since f is assumed continuous, it attains its sup and inf on the closed subintervals). We call these the upper and lower Riemann sums, written n 8+ (/, P} = E Mk(Xk - Xk-l}, k=l n 8- (/, P} = L mk(xk - xk-d· k=l (See Figure 6.1.2). Clearly any Cauchy sum 8(/, P} must lie between these. Also, from the intuitive properties of area, it is clear that the area under the graph of f must lie somewhere in between the upper and lower Riemann sums. Definition 6.1.1 For any partition P, the maximum interoal length is the maximum length 0/ the subintervals 0/ the partition. We say that the limit 0/ 8(/, P} exists and equals the number J: f(x} dx if for every efTOr liN there exists 11m such that 18(/, P} - J: /(x) dxl < liN for any partition P with maximum interval length < 11m. 6. 1 Integrals 0/ Continuous Functions 203 v � \"\"'- \"., Figure 6. 1.2: Since the \"area under the graph of /\" is only an intuitive concept, we cannot use it to prove the existence of the integral; rather we want to use the integral to give a precise mathematical counterpart to the intuitive concept of area. Our strategy will be to show that the upper and lower Riemann sums converge to a common limit. Then the intu­ itive \"area\" should also be equal to this limit, because it is squeezed in between. The same argument will show that any Cauchy sums S(/, P) will converge to the limit. Thus we need to show that S+(/, P) and S- (/, P) converge to a common limit as the size of the intervals in P tends to zero. Why is this true? Let's first look at a somewhat simpler ques­ tion that contains the crux of the matter: what will make S+(/, P) - S-(/, P) small? The difference of the upper and lower Riemann sums is the area of the little rectangles in Figure 6. 1.3, or 2:�=1 (Mk -mk)(Xk -xk-d· The sum of the lengths of the bases of these rectangles is clearly the length of the full interval b - a = Ek=dxk - xk-d, which does not depend on the particular partition. The heights of the rectangles, Mk - mk, are the variations of the function f over the subintervals [Z k- lt Zk] , and these can be made small by taking the subintervals sufficiently small, by the continuity of /. Since we need to make them all small simultaneously, it is clear that we should use uniform continuity. Because / is assumed continuous on the compact interval [a, b), we know that / is uniformly continuous: given any error lIN there exists 11m such that Ix - yl < 11m implies I/(x) - /(y)1 < lIN. 204 Chapter 6 Integral Calculus Figure 6.1.3: Thus if we choose the partition P such that Xk - Xk-l < 11m for all k, then Mk - mk < liN since Mk and mk are values assumed by / on [Xk-b Xk). Thus s+ (/, P) - S- (/, P) n L:(Mk - mk)(xk - xk-d k=l n < IINL(xk - xk-d = IIN(b - a) , k=l which can be made as small as desired since b - a is fixed. Being able to make the upper and lower Riemann sums close to each other for a fixed partition does not in itself imply the existence of the limit defining the integral. It is still conceivable that the values of these Riemann sums vary a lot as we vary the partition. This in fact does not happen, but to see why we need a new idea: the upper Riemann sums decrease and the lower Riemann sums increase when we add points to the partitions. Let us say that a partition Pl is a refinement of P if Pl contains P (we think of the partitions as consisting of the endpoints of the subintervals) ; in other words Pl is obtained by further partitioning the subintervals of P. Since the sup of / over the smaller subintervals of Pl will be smaller than the sup of / over the containing subintervals of P, we will have S+ (/, PI) < S+ (/, P). Similarly S- (/, Pd > S- (/, P). Thus if we consider a sequence of partitions Pl, P2, .. . , each of which 6. 1 Integrals 0/ Continuous Functions 205 is a refinement of the previous one, the sequence {S+(f, Pk)} will be monotone decreasing and {S-(/, Pk)} will be monotone increasing, so each will have a limit (the limits are finite since all Cauchy sums are bounded above and below by b - a times the sup and inf of / on the interval). If the maximum interval length Pk tends to zero as k � 00, then the argument above shows S+(/, Pk) - S-(/, Pk) � 0, so the two limits must be equal. We can take the limiting value as the definition of J: /(x) dx. Of course we then need to verify that the limit does not depend on the particular sequence of partitions PI, P2, .. .. This is not hard to accomplish, using the ideas we have already encountered. Theorem 6.1.1 (Existence 0/ the IntegraQ Let / be a continuous func­tion on [a, b] . Then the limit 0/ the Cauchy sums S(/, P) exists. The integral J: / (x) dx is also equal to the inf 0/ the upper Riemann sums S+(/, P) and the sup 0/ the lower Riemann sums S-(/, P) as P varies over all partitions. Proof: Let U denote the set of values of upper Riemann sum­ s S+(/, P) and L denote the set of values of lower Riemann sums S-(/, P). We claim that inf U = sup L. Indeed inf U > sup L because every element in U is greater than every element of L (if PI and P2 are two partitions and P3 is the union of the points in PI and P2, so that P3 is a refinement of both PI and P2, then S+(/, PI) > S+(/, P3) > S-(/, P3) > S-(/, P2)). If Pk is any sequence of partitions such that Pk+ I is a refinement of Pk and the maximum interval length of Pk tends to zero, then limk_oo S+(/, Pk) = limk_oo S-(/, Pk), so we cannot have inf U > sup L. Let J: /(x) dx equal the common value of inf U and sup L. Given the error liN, choose 11m so that Ix-yl < 11m implies I/(x)-/(y)l < 1/N(b-a). If P is any partition with maximum interval length at most 11m, then n S+(/, P) - S-(/, P) - E(Mk - mk)(xk - Xk-t} k=l n < IIN(b - a) E(Xk - xk-d = liN k=l and so any Cauchy sum S(/,P) lies in the interval [S-(/,P), S+(/,P)] of length at most liN. But J: /(x) dx also lies in this interval (inf U < 206 Chapter 6 Integral Calculus S+ {/, P) and sup L > S- {/, P)), so the two differ by at most liN. QED From the definition we obtain immediately the linearity properties of the integral: l (f(x) + g(x)) dx = t I(x) dx + t g(x) dx lb c/(x) dx = c lb I(x) dx, c constant, and the additivity: [ I(x) dx = t I(x) dx + [ I(x) dx if a < b < c. By defining the integral for a > b by I: 1 (x) dx = -Ib4 I{x) dx and for a = b by I: I{x) dx = 0, we can easily verify that the additivity continues to hold. We also have the basic estimate m(b - a) < t I(x) dx < M(b - a) for a < b where M is the sup and m the inf of 1 on [a, b). This fol­ lows from the fact that M{b - a) and m(b - a) are Riemann upper and lower sums for the partition consisting of the single interval [a, b). The expression I: f{x) dxl(b - a) may be interpreted as an \"average\" value of 1 on the interval [a, b), so our basic estimate can be interpreted as saying that the average lies between the maximum and the minimum values. This is certainly a property that one would expect an average to have. Another property one would expect from an average is linearity, and this is an immediate consequence of the linearity of the integral. This integral average is an ''unbiased\" average in that subintervals of equal length contribute to the average equally. For some application­ s it is desirable to give different weights to different portions of the interval. This can be accomplished by using a continuous, positive weight function w(x) and defining the weighted integral average to be J: I{x)w(x) dxl J: w{x) dx. We leave to the exercises the verification that this satisfies the above properties of a reasonable average. 6. 1 Integrals of Continuous FUnctions 6.1.2 Fundamental Theorems of Calculus 207 We will frequently want to consider the integral with one of the end­ points variable, to obtain a function, say F(x) = J: f(t) dt for a < x < b if f is continuous on [a, b]. We will informally call F the \"integral\" of f. We make the obvious remark that it is easier for the integral of f to exist than for the derivative of f to exist, contrary to the impression given in calculus courses, where one is impressed by the fact that it is easier to compute a \"formula\" for the derivative than to compute a \"formula\" for the integral. Our perspective now is that J: f ( x) dx is a formula for the integral; this formula does involve an infinite process, but we can always obtain approximations to J: f(t) dt with any desired error. The restriction that f be continuous can be relaxed, and we will discuss this in detail later. We can now obtain easily the fundamental theorem of the calculus or rather the two fundamental theorems-differentiation of the integral and integration of the derivative. Theorem 6.1.2 (Differentiation of the Integral) Let f be a continuous function on [a, b], and let F(x) = I: f(t) dt for a < x < b. Then F is C1 and F' = f. Proof: From the basic properties of the integral we find the difference quotient for F is F(xo + h� - F(xo) = ! 1xo+h f(t) dt. Xo Now (1/h) J:o o+h f(t) dt is a kind of average value of f on the interval [xo, Xo + h], so we would expect it to converge to f(xo) since f is continuous. (In Figure 6.1.4, it is the shaded area divided by the length of the base.) More precisely, if h > 0, then Ix:o+h f(t) dt lies between hM and hm where M and m are the sup and inf of f on [xo, Xo + h] . Thus m < (1/h) J:oo+h f(t) dt < M. If h < 0, then and 1 1xo+h 1 1xO h f ( t) dt = - h f ( t) dt xo xo+h 1xo -mh < f(t) dt < -Mh xo+h 208 Chapter 6 Integral Calculus f Figure 6.1.4: where now M and m are the sup and inf of I on [xo + h, xo]. Since -h is positive, we obtain again m < (l/h) f:o o+h I(t) dt < M. Since I is continuous, both M and m tend to /(%0 ) as h ---+ 0, so l 1xo+h lim h I(t) dt = I(xo). h-O Xo This shows F' = I; and since I was assumed continuous, we have F is CI. QED The antiderivative F is not the unique solution to the equation g' = I. However, any other solution must differ from F by a constant, for then F - 9 would have derivative zero; but we have seen that a function with zero derivative on an interval must be constant. Note that the previous theorem has a rather trivial analogue involv­ ing sums and differences: if Xl, X2, ••• is any sequence of numbers and we form the sequence of sums Yb Y2 , ••• with Yn = Xl + X2 + ... + Xn, then Xn = Yn - Yn - l . Similarly, the next theorem (integration of the derivative) is an \"in­ finitesimal\" version of the familiar fact that sums of differences \"tele­ scope\" : 2:k=1 (Xk-Xk-d = Xn -Xo. It was first stated in the fourteenth century by Nicole Oresme in the form: the area under the graph of ve- 6. 1 Integrals of Continuous Functions 209 locity is the distance traveled. He justified it by saying that the area was the sum of the areas of the vertical lines-thought of as rectangles with infinitesimal bases-and the areas of the vertical 1ines represent the distance traveled in an infinitesimal time interval, as indicated in Figure 6. 1.5. I a b Figure 6.1.5: Theorem 6.1.3 (Integration of the Derivative) Let f be Cl on [a, b] (since the internal is closed, the derivative f' at the endpoints is a one­ sided derivative) . Then J: f'{x) dx = f{b) - f(a). Proof: For any partition P of the interval, the Cauchy sum n E !'(ak)(xk - xk-d k=l adds up terms f'(ak)(xk-xk-d that are approximately f(Xk)-f(Xk-I}. In fact, by the mean value theorem, it is possible to choose ak in the interval [Xk-b Xk] to make this exact equality: f'(ak)(xk - xk-d = f(Xk) - f(Xk-d. For this choice of ak the Cauchy sum telescopes, so S(f', P) = f(b) - f(a) exactly. Since we know that J: f'{x) dx is the limit of any choice of Cauchy sum 5(/', P) as the maximum interval length tends to zero, it follows that it is the limit with this particular choice, hence f(b) - f(a}. QED It is also possible to prove the integration of the derivative as a consequence of the differentiation of the integral, but this proof lacks intuitive appeal. We leave it as an exercise. 210 Chapter 6 Integral Calculus It is interesting to compare the integration of the derivative theorem with the mean value theorem. Both give the value of (f (b) - f (a)) / (b - a) in terms of the derivative f'. In the mean val­ ue theorem the derivative is evaluated at an unspecified point; in the integration of the derivative theorem this is replaced by the integral average J: f'(t) dt/(b - a). In many applications you can use either re­ sult. (For example, as an exercise, try reproving the results in Section 5.2.3 by using the integration of the derivative theorem). Although the mean value theorem has the advantage that it holds with weaker hypotheses (the derivative does not have to be continuous), it also has the disadvantage of the unspecified nature of the point. A good rule of thumb is to try the mean value theorem first , but if you run into difficulties, to switch to the integration of the derivative theorem. The two fundamental theorems enable us to define the indefinite integml or primitive of the continuous function f to be any Ct function F such that F' = f. The differentiation of the integral theorem shows that an indefinite integral always exists, and we have seen that it is unique up to an additive constant. The integration of the derivative theorem shows us how to evaluate definite integrals using indefinite in­ tegrals. The two theorems can also be interpreted as saying the opera­ tions of differentiation and integration are inverse operations; however, since differentiation is not one-to-one, the inverse indefinite integration operator is only defined up to an additive constant. As a consequence of the integration of the derivative and the prod­ uct formula for derivatives we obtain the familiar integration by parts formula. Theorem 6.1.4 (Integration by Parts) Let f and 9 be CI on [a, b] . Then t f(x)g'(x) dx = f(b)g(b) - f(a)g(a) - t I'(x)g(x) dx. Proof: Since (f ·g), = f'g+ fg', we have J:[J'(x)g(x)+ f(x)g'(x)] dx = f(b)g(b) - f(a)g(a). QED As an application we derive the integral remainder formula for Taylor's theorem. Assume f is CTI+ l. We define the remainder Rn (xo . x) by the equation 6. 1 Integrals of Continuous Functions 211 where Tn (xo, x) is the Taylor expansion of f to order n. We have already established Lagrange's remainder formula where Xl is some unspecified point between Xo and x. For some ap­ plications, especially when one needs to vary x, the unspecific nature of Xl causes difficulties (it gives no information about the derivative of the remainder, for example). The integral remainder formula is 1 1x Rn(xo, x) = -, (x - t)n f(n+l) (t) dt. n. Xo Note that J: (x - t)n dtln! = (x - xo)n+l /(n + 1)!, so both the integral o . remainder and Lagrange remainder are of the same order of magnitude, namely O(lx - xoln+1 ). Notice that the Taylor expansion with integral remainder formula for n = 0 is f(x) = f(xo) + J� f'(t) dt just the inte­ gration of the derivative. To establish the integral remainder formula in general we simply apply integration by parts to 1 1x -, (x - tt f(n+l) (t) dt n. xo integrating f(n+l) and differentiating (x - t)n In! to obtain and the proof can be completed by induction (see exercises). Another important consequence of the fundamental theorems is the familiar change of variable formula. Theorem 6.1.5 (Change of Variable Formula) Let g be Cl and in­ creasing on [a, b) . Then for any continuous function f on [g(a), g(b)), we have f.9(b) f.b f(x) dx = f(g(x))g'(x) dx. g(a) a 212 Chapter 6 Integral Calculus Proof: Let F be an indefinite integral for f. Then F(g(x)) has derivative f(g(x))g'(x) by the chain rule, so J: f(g(x))g'(x) dx = F(g( b)) - F(g( a)) by the integration of the derivative theorem. But this is the same value that the same theorem gives for f;�i f(x) dx since F' = f. QED As a special case we have the translation invariance of the integral. Corollary 6.1.1 (7ranslation Invariance) If I is continuous on [a, b), then J: I(x) dx = J:�: I(x + y) dx lor any y. Proof: Use g(x) = x + y, and observe g' = 1. QED 6. 1. 3 Useful Integration Formulas In this section we discuss briefly three integration formulas that will be proved later in the text. From time to time we will need to use these formulas, and you may find them useful in doing some of the exercises. Strictly speaking, we should not be allowed to do this, but it would simply take us too far afield to define all the concepts and do the preparatory work needed to present the proofs here. The oth­ er extreme-avoiding all use of these theorems until after they are proved-would have the negative consequence that we would not be able to complete the discussion of other topics in the place where they naturally belong. So a healthy compromise seems in order. Of course you should check, when we eventually prove these theorems, that we have not used anything in the proof that was derived assuming the result. The first result is the familiar arclength formula for the graph of a function. Theorem 6.1.6 (A rclength Formula) Let I be a C1 function on [a, b] . Then the length 0t the curve given by the graph 01 the function I on [a, b] is equal to fa /1 + I'(x )2 dx . Since we have not defined the length of a curve, we cannot begin to prove this result here. A thorough discussion will be given in Chapter 13, where we will give a more general result (for curves not given as 6. 1 Integrals of Continuous Functions 213 graphs) . We will need to use this result in Chapter 8 to motivate the definition of the trigonometric functions. The next result is the general formula for differentiating a function defined by an integral. Here we allow the integrand to be a function of two variables g(x, t), and let J.b(X) f(x) = g(x, t) dt a(x) where a( x) and b( x) are functions of x as well. Theorem 6.1.7 Let a(x) and b(x) be C1 functions and g(x, t) be a C1 function of two variables. Then if f(x) = fat] g(x, t) dt we have J.b(X) og f'(x) = b'(x)g(x, b(x)) - a'(x)g(x, a(x)) + - 8 (x, t) dt. a(x) x Since we have not discussed functions of two variables yet and have not defined partial derivatives, we will have to postpone the complete proof until Chapter 10. However, we can indicate the main ideas of the proof rather easily. We write the difference quotient as a sum of three terms that isolate the three appearances of the x variable: 1 h (f(x + h) - f(x)) 1 J.b(X+h) h g(x + h, t) dt b(x) 1 J.a(X+h} - h g( x + h, t) dt a( x) J.b(X) 1 + h (g(x + h, t) - g(x, t)) dt. a(x) Each of the three terms will converge to the corresponding term in the formula. For the first two terms this is almost the differentiation of the integral theorem combined with the chain rule, except for the translation of x by h in g(x + h, t). It is plausible that this does not affect the outcome since h is tending to zero. In the special case that 9 is only a function of t alone this problem does not arise (see exercises) . For the third term the issue is the interchange of the integral and the limit that defines 8g/8x. We will discuss the question of interchanging limits and integrals in Chapter 7. 214 Chapter 6 Integral Calculus The last formula in this section is the interchange of integrals. Sup­ pose f(x, y) is a continuous function of two variables for x in [a, b) and y in [e, d]. The exact definition is given in Chapter 9. We may consider the function le d f(x, y) dy as a function of x. If it is continuous, which is in fact always true, we can take its integral l (t I(x, y) dY) th. Similarly, we may perform the integrations in the reverse order. Theorem 6. 1.8 (Interchange of Integrals) Let f(x, y) be a continuous function for x in [a, b] and y in [c, d) . Then le d f(x, y) dy is a continuous function of x for x in [a, b] , I: f(x, y) dx is a continuous function of y for y in [e, d], and l (t l(x, Y) dY) dx = t (l I(X, Y) dX) dy. We will prove this theorem in Chapter 15 , where we show that both of the above iterated integrals are equal to the double integral II f(x, y) dx dy defined by partitioning the rectangle [a, b) x [e, d] in the plane. 6. 1. 4 Numerical Integration The existence of the integral as a limit of sums is a qualitative result in that we know the sums approximate the integral but don't know how fast the process converges. For practical purposes we would like to have a quantitative counterpart-an estimate for the difference of the sum and the integral. This is possible if we assume more about the function in terms of smoothness (this is quite reasonable because wiggling of the function is likely to cause greater errors). In this section we discuss briefly four methods of numerical integration and estimates for their errors. Suppose f is differentiable and If'(x) 1 < Ml on [a, b]. Then if x and Yk are points in the interval [Xk-ll Xk), we have If(x) - f(Yk) 1 < M1 lx - Yk l by the mean value theorem. Now the difference between J:1c1c_1 f(x) dx and f(Yk)(Xk-Xk-d can be written J:1c 1c_1 (f(x)-f(Yk)) dx 6. 1 Integrals of Continuous Functions 215 (think of the contribution f(Yk)(Xk - Xk-l) to the Cauchy sum as the integral of the constant function f(Yk) over the interval [Xk-b Xk)). The biggest this can be (in absolute value) is f:1c Mllx - Yk I dx because \"'Ic-l f(x) - f(Yk) is at most M1 lx - Ykl (in absolute value) . This is an elementary integral that we can evaluate. Note that it is worst (largest) if Yk is one of the endpoints and best if Yk is the midpoint, as seen in Figure 6. 1.6. Yk = left endpoint Yk = midpoint height = M1(Xl - Xl -1)12 Figure 6.1.6: At worst the error is Ml (Xk - xk_d2/2; and if we sum over all the intervals in the partition, the total error is bounded by n E M1 (Xk - xk_d2/2. k=l If we let 6 denote the maximum interval length of the partition, the error bound is L�=l M16(Xk - xk-d/2 = (b - a)M16/2. This is called a first-order estimate because 6 appears to the first power. Since 6 is the only quantity we can control, by making the partition finer we are assured that we can make the error as small as we like but at a rather large cost in computation time and computation accuracy. For example, if (b - a)Ml /2 < 1 and we want an accuracy of 10-4, we have to take 6 = 10-4, which means about 10, 000 intervals in the partition. We can do a lot better simply by taking the point Yk to be the mid­ point of the interval, provided the function is smooth enough. Assume 216 Chapter 6 Integral Calculus f is C2 and If\"(x}1 < M2 on the interval. The point of using the mid­ point rule, Yk = (Xk-l + xk}/2, is that it gives the exact answer for any affine function on each subinterval. In other words, if f ( x) = ax + b on [Xk-l ,Xk], then J:,.1c_1 f(x} dx = f(Yk)(Xk - xk-d. (Geometrically, this just says that the area of a trapezoid is the product of the base times the midpoint altitude.) To exploit this fact we simply use the first­ order Taylor expansion with Lagrange remainder about the point Yk, so f{x} = f(Yk}+(X- Yk}f'{Yk}+Rl {X} with Rl (X} = (X - Yk}2f\"(Z}/2 for some point z in [Xk, Yk] so that we have IRI (x) 1 < M2(X - Yk)2/2. Now we integrate the Taylor expansion: f:, I(x) dx = f:, I(Yk) dx+ !'(Yk) f:, (X-Yk) dx+ 1�:, R\\(x) dx. The first integral on the right is exactly !(Yk)(Xk - xk-d, the midpoint rule; and the second integral is zero because x - Yk is an odd function about Yk (this is where we require that Yk be the midpoint). If ! were affine there would be no third term, so the midpoint rule would produce no error. But in any case, the error is at most The total error using the midpoint rule is at most � 1 3 1 2 � 1 2 L.J 24 M2 (Xk - xk-d < 24 M26 L.J(Xk - xk-d = 24 M2(b - a}6 . k=l k=l This is a second-order estimate, because of the factor 62• If M2 (b - a}/24 < 1 and we want an error of at most 10-4 we only have to take 6 = 10-2 or about 100 points in the partition. A closely related method is the trapezoidal rule, which is obtained by replacing !(Yk) by �(!(xk-d + !(Xk)), the average value at the endpoints, the point being that �(/(xk-d+ !(Xk))(Xk-Xk-d is exactly the area of the trapezoid lying under the line segment joining the two points (Xk-b I(xk-d) and (Xk, !(Xk)) on the graph of I, as shown in Figure 6.1.7. The trapezoidal rule also gives the exact integral for any affine function on each subinterval and also has a second-order error estimate. This is a little trickier to prove, and we leave it to the exercIses. 6. 1 Integrals of Continuous Functions 217 Figure 6.1. 7: Simpson's method uses n L)I/6)(f(xk-l ) + 4f(Yk) + f(Xk))(Xk - xk-d· k=l It gives the exact integral for all cubic polynomials and has a fourth­ order error estimate involving M4 = sup If\"\"(x)l, assuming f is C4• Notice that we have a trade-off: in order to obtain higher order esti­ mates we must assume more smoothness for the function. For any fixed 6, it is not obvious which method will give the best approximation, s­ ince the constants multiplying the power of 6 will vary. However, once we let 6 get small, the higher order methods quickly win out. It usually pays to be clever. 6.1.5 Exercises 1. If f(x) = J:gl g(t) dt where a(x) and b(x) are Cl functions and 9 is continuous, prove that f'(x) = b'(x)g(b(x» - a'(x)g(a(x» . (This is a special case of Theorem 6.1. 7. ) 2. Show that I J: f(x) dxl < J: If(x) l dx. 3. Derive the integration of the derivative theorem from the differ­ entiation of the integral theorem. Can you prove the converse implication? 218 Chapter 6 Integral Calculus 4. Prove the integral mean value theorem: if I is continous on [a, b), then there exists y in (a, b) such that J: I(x) dx = (b - a)/(Y). 5. Let 9 be continuous on [a, b) , and let I(x) = f: (x - t)g(t) dt. Prove that I is a solution of the differential equation I\" = 9 and the initial conditions I (a) = I' (a) = O. 6. Suppose you want to compute a table of arctangents for values of x in [0, 1] using the formula arctan x = fox 1/(1 +t2) dt. What size must you take for 6 if you want the error to be at most 1/1, 000 using the midpoint rule? 7. Write out the complete proof of the integral remainder formula in Taylor'S theorem. 8. Let I be a C1 function on the line, and let g(x) = fo l l(xy)y2 dy. Prove that 9 is a C1 function and establish a formula for g' (x) in terms of I. 9. If I is continuous on [ea, eb] , show f: I{ex) dx = (l/e) Jc� I{x) dx for c > O. Is the same true for c < O? 10. For a continuous, positive function w{x) on [a, b), define the weighted average operator Aw to be Aw (f) = l J(x)w(x) dx/ l w (x ) dx for continuous functions I. Prove that Aw is linear and lies be­ tween the maximum and minimum values of I. 11. Show that Simpson's rule gives the exact integral for any cubic polynomial. 12. Let f(x) be a continuous function that is periodic of period a(f(x + a ) = f(x) ). Prove that F (x) = I; f (t) dt is also periodic of period a if and only if IoU f (t) dt = o. 13. Let F{x) = f; I(t) dt for continuous f. Show that F has strict lo­ cal maxima and minima at points where I changes sign. Compare this to the F' (x) = 0 criterion. 6. 2 The Riemann Integral 219 14. *a. If f is C2 on [a, b] with If\"(X) 1 < M2 and f(a) f(b) = 0, prove that If(x)/ < M2 /x - a/ Ix - bl. (Hint: use the mean value theorem to write f(x) = J'(y)(x - a) , use Rolle's theorem to find a point z where I' ( z) = 0, and use the mean value theorem to write I' (y) = I\" ( w) (y - z) .) b. Use part a on each subinterval to establish a second-order estimate for the trapezoidal rule. 6.2 The Riemann Int egral 6.2. 1 Definition of the Integral Often we want to form the integral of a function that is not continu­ ous. For example, it is convenient to think of the Cauchy sums as the integral of a function that is constant on each of the subintervals of the partition. This function is not continuous at the partition points, where it may have a jump discontinuity. It is not hard to show that the definition of integral we have given can be extended to functions that have a finite number of jump discontinuities. One can then ask if it can be extended further. The answer is yes, if the function has a finite number of any type of discontinuity and is bounded. Even if the num­ ber of discontinuities is countable. The trouble with each such theorem extending the definition of integration is that it raises still more ques­ tions. Are there other functions for which the definition of the integral also makes sense ? No amount of piece-meal extension of the concep­ t of the integral will put to rest the possibility that some important cases have been left out. However, there is a bold-stroke method for getting all possible extensions at once. This method was introduced by Bernard Riemann in the middle of the nineteenth century after many piece-meal methods had been discovered. Here is Riemann's idea. We restrict attention to bounded functions on bounded intervals (so the graph of the function lies in a finite rect­ angle). This is an important restriction, because many new kinds of difficulties arise when the interval or the function is unbounded; later we will come back and deal with some of the more well-behaved un­ bounded cases when we discuss \"improper integrals\" . The Riemann integral is thus a theory of \"proper integrals\" . If we want the largest 220 Chapter 6 Integral Calculus possible class of functions for which the definition of the integral makes sense, we should define the class of functions exactly in that way. Thus we will say that a bounded function on [a, b] is Riemann integrable if the Cauchy sums S(/, P) converge to some limit, called the Riemann integral of / and written J: /(x) dx as before, as the maximum internal length of P tends to zero. Notice that this definition is nothing but a linguistic trick-taking a theorem and making it a definition. Of course the theorem can be reinterpreted in light of the definition: every continuous function on [a, b] is Riemann integrable. The important thing is that we have made a change in viewpoint. Instead of thinking of integration as a process attached to a specific class of functions (such as continuous functions), we think of it as a general process and search for functions to which it can be applied. Notice that this is the way we have dealt with the derivative from the start (you might argue that in a calculus course the derivative is presented piece-meal: first you learn to differentiate polynomials, then rational functions, and so forth) . Before we can make ruemann's idea precise we have to clarify one technical but important point. In establishing the existence of the integral of a continuous function, we saw that there were several e­ quivalent ways of obtaining it. We could take the limit of 5(/, Pn) for a specific sequence of Cauchy sums and partitions, or the limit of 5(/, P} for all Cauchy sums and partitions, or the inf of upper Rie­ mann sums S+ (/, P} or the sup of lower Riemann sums S- (/, P). If we were to define the Riemann integrable functions by any one of these conditions, would we obtain the same class of functions? It turns out that the answer is yes, provided we avoid one rather silly choice. To understand why, we need to make a few simple observations about the sums S(/, P}. We are not assuming that / is continuous any more, merely that it is bounded. Thus the sup Mk and the inf mk of / on the interval [Xk-l , Xk] are still defined, but there do not have to exist points of the interval where / takes on these values. Thus the Riemann upper and lower sums S+ (/, P) = Ek=l Mk (Xk - xk-d and S- (/, P) = Ek=l mk(xk - xk-d are not necessarily Cauchy sums 5(/, P) = Ek=l/(Yk)(Xk - xk-d. However the Cauchy sums lie in be­ tween, 5- (/, P) < 5(/, P) < 5+ (/, P), and can be made as close as desired to the Riemann sums (this is with P fixed) simply by choosing Yk in [Xk-b Xk] so that /(Yk) is as close as needed to the sup or info 6. 2 The Riemann Integral 221 Let us define the oscillation of 1 on P, Osc(/, P), to be the difference S+ (/, P) - S- (/, P). Since this also measures the spread of the differ­ ent Cauchy sums S(/, P) associated with P, it is clear that it is the important quantity in deciding whether 1 is Riemann integrable. If 1 is Riemann integrable we will have the integral J: 1 (x) dx also lying in the interval between S- (I, P) and S+ (I, P), so if Osc( I, P) is small we know any Cauchy sum S(/, P) is close to the integral. Now we need to relate the oscillation of 1 for different partitions. If P' is a refinement of P, then clearly Osc(/, Pi) < Osc(/, P), because the upper sums decrease and the lower sums increase as points are added to the partition. However we also need to compare the oscillation of I on partitions that are not necessarily refinements of P but are in some ways finer than P. Let 6 be the minimum length of the subintervals in P. Then if pi is another partition with the maximum interval length less than 6, we claim Osc(/, P') < 3 Osc(/, P). The factor 3 arises in this estimate because the subintervals of pi covering a fixed subinterval of P can be three times as long; it will turn out to be harmless when we try to make Osc(/, Pi) small. Lemma 6.2.1 II the maximum interval length 01 P' is less than the minimum length 01 subintervals 01 P, then Osc(/, P') < 3 Osc(/, P) . Proof: Look at one particular interval [xj-I ' xj] of P'. By the length assumptions, it overlaps at most two consecutive subintervals [Xk-h Xk] and [Xk' Xk+I] of P. The oscillation of Mj - mj of 1 on [xj-I ' xj] is certainly less than the sum of the oscillations Mk -mk and Mk+I -mk+I over the intervals [Xk-h Xk] and [Xk' Xk+I] that cover [xj_I ' xj]. Thus we have We sum this inequality over all j, and on the left side we obtain exactly Osc(/, P'). On the right side we obtain a rather complicated expression; however, if we sort the terms according to the index k of (Mk-mk), then we find (Mk - mk) multiplied by (xj - xj-I) for every subinterval of P' that intersects [Xk-I, Xk). These subintervals of P' cover [Xk-I, Xk) with perhaps some overlap at either end, as illustrated in Figure 6.2.1. But because the lengths of the subintervals of P' are less than (Xk - Xk-t), we certainly have the sum of the lengths of the covering intervals less 222 Chapter 6 Integral Calculus than 3(Xk -Xk- d. Thus (Mk -mk) is multiplied by at most 3(Xk-Xk- d on the right side, proving Osc(f, Pi ) < 3 Osc(f, P) . QED ( • )( )( • ) Figure 6.2.1: We are now in a position to prove the equivalence of several possible ways of defining Riemann integrability and the Riemann integral. Theorem 6.2. 1 Let f be a bounded function on [a, b] . Then the fol­ lowing are equivalent: a. There exists a sequence Pj of partitions such that Osc(f, Pj ) � O. b. Osc(f, P) � 0 as the maximum interval length of P tends to zero, in the sense that given any lin there exists 11m such that Osc(f, P) < lin for any partition P with maximum interval length < 11m. c. infpS+ (f, P) = suppS- (f, P) . d. There exists a sequence of partitions Pj and a real number J: f (x) dx such that S(f, Pi ) � J: f(x) dx as j � 00 for every choice of Cauchy sums S(f, Pj ). e. S(f, P) � J: f(x) dx as the maximum interval length of P tends to zero, in the sense that given any lin there exists 11m such that IS(f, P) - J: f(x) dxl < lin for any Cauchy sum S(f, P) and any partition P with maximum interval length < 11m. Proof: Clearly condition b is a stronger statement than condi­ tion a, but condition a implies condition b by the lemma, since once Osc(f, Pj ) < l/3n, we have Osc(f, P) < lin if the maximum inter­ val length of P is less than the minimum length of subintervals of Pj . Thus conditions a and b are equivalent. The same reasoning shows that conditions d and e are equivalent. 6.12 The Riemann Integral 223 Now let's show that condition c is equivalent to condition a. Just as in the case of continuous functions, every upper sum 8+ (/, P} is greater than or equal to every lower sum 8- (/, P' ), as follows by com­ parison with a partition P\", which is a common refinement of P and P' . Thus infp 8+ (/, P} > sUPp 8- (/, P) in any case. If we have e­ quality, there must exist sequences Pi and PJ of partitions such that limj_oo 8+ (/, Pj } = limj _oo 8- (/, PJ}. By passing to common refine­ ments PJ' of Pj and PJ we have limj _oo 8+ (/, Pi') = limj_oo 8- (/, PJ'), which is the same thing as limj_oo Osc(/, PJ') = o. Thus condition c implies condition a. But conversely condition a implies limj_oo 8+ (/, Pi ) - limi _oo8-(/, Pj) for any sequence Pj , so infp 8+ (/, P) - sUPp 8- (/, P). So far we have established the equivalences a H b H c and d H e. To complete the proof we will show condition d implies condition a and condition c implies condition d. Since the oscillation of / on P is the spread of the values of the Cauchy sums 8(/, P) , the con­ vergence of 8(/, Pj } implies Osc(/, Pj ) -+ O. So condition d implies condition a. But as before condition c implies limi-oo 8+ (/, Pj ) = limn_oo 8- (/, Pj ) for a sequence of partitions Pj and so limj _oo 8(/, Pj ) equals the common value infp 8+ (/, P) = sUPp 8- (/, P) for any Cauchy sums 8(/, Pj ). This is condition d. QED A function satisfying any one of the above equivalent conditions will be called Riemann integrable. Of course any continuous function is Riemann integrable, as was shown in Theorem 6.1.1. Condition a or b is useful because it does not involve explicitly the value of the integral. We note that for Riemann integrability it does not suffice to verify that 8(/, Pi ) converges for one particular sequence of Cauchy sums. To see this we need to examine a famous example due to Dirichlet: the function / on [0, 1] equal to 1 if x is rational and 0 if x is irrational. This function is not continuous at any point, and there is no way to picture its graph. It is trivial to compute that S+ (/, P) = 1 and S- (/, P) = 0 for this function and any partition because the sup and inf of / on any interval are 1 and 0, respectively. Thus / is not Riemann integrable. However one can easily choose Cauchy sums to converge to zero or one. Dirichlet's function may strike you as rather pathological; indeed many of his contemporaries dismissed it as the work of a crackpot mentality. However, from the point of view of twentieth century math- 224 Chapter 6 Integral Calculus ematics, Dirichlet's function is rather tame in comparison with many functions that arise in solving very practical problems. Thus the in­ ability of the Riemann theory of integration to deal with it is a sign of significant weakness. We shall also observe that there is rather com­ pelling evidence for assigning the value zero to the integral of Dirichlet's function. We will return to this example when we discuss the Lebesgue theory of integration in a later chapter. 6.2.2 Elementary Properties of the Integral It is a simple matter to show that the elementary properties of the integral of continuous functions are also true of the Riemann integral. Such properties now require an additional statement about Rieman­ n integrability. Here is linearity: if f and 9 are Riemann integrable functions on [a, b) and c is a real number, then f + 9 and cf are also Riemann integrable functions on [a, b) and t(f +9)(X) dx t(c/){X) dx - 16 /(x) dx + 16 g(x) dx c 16 /(x) dx. Additivity says that if a < b < c and f is defined on [a, c) and the restrictions of f to [a, b) and [b, c) are Riemann integrable, then f is Riemann integrable on [a, c) and [/(X)dx = t /(x) dx + [/(X) dX. We leave the proofs as exercises. The basic estimate m(b- a) < t /(x) dx < M(b - a) where M and m are the sup and inf of f on la, b] is also easily verified for Riemann integrable functions. This implies that the integral of a non-negative function is non-negative, and hence the integral freserves order: if f{x) > g{x) for every x in [a, b), then f: f{x)dx > fa g(x) dx. It is also possible to show that the product of two Riemann inte­ grable functions is Riemann integrable, although there is no formula 6. � The Riemann Integral 225 for the integral of a product. The proof is based on the Osc(/, Pi) � o criterion, as might be expected, and the estimate Osc(lg, P) < M(Osc{/, P)+ Osc(g, P)) where M is the sup of III and Igl over the interval. We leave the details for the exercises, along with some related results on quotients and compositions. It is important to be able to estimate the size of an integral; in other words to obtain a bound for If: I(x) dxl. Now if 9 is any non­ negative Riemann integrable function such that I/(x) 1 < g(x) (we say 9 dominates I) for every x in [a, b] , then -g(x) < I(x) < g(x), so -lb g(x) dx < lb I(x) dx < lb g(x) dx by the order preservation of the integral; hence, we obtain lb I(x) dx < lb g(x) dx, Often we will choose 9 in such a way that we can evaluate J: g{ x) dx explicitly. Now I/{x)1 is the smallest non-negative function that dominates I. By the above argument we expect to have the estimate [ I(x) dx < [ 1/(x) I dx, There is one hitch in the argument, however: how do we know If{x} l is Riemann integrable? It turns out to be true, but not obvious, that if I is Riemann integrable, then III is also Riemann integrable. Before proving this let us observe that the converse is not true. We can have III Riemann integrable without I being Riemann integrable; just consider the variant of Dirichlet's function that takes the value 1 for x rational and -1 for x irrational. This is still not Riemann integrable, but the absolute value of this function is identically one, hence continuous. This example helps to motivate the positive result in that it shows how taking the absolute value decreases the amount of oscillation in a function. 226 Chapter 6 Integral Calculus Theorem 6.2.2 a. II I is Riemann integrable on [a, b), then so is III . b. II I and 9 are Riemann integrable on [a, b] , then so are max(l, g) and min(l, g) . Proof: a. We claim Osc(l/l, P) < Osc(/, P) . Indeed on any subinterval [Xk-l , Xk) let Mk and mk denote the sup and inf of I. If they both have the same sign, then the oscillation of I I I on the subinterval is the same. If they have the opposite sign, then Mk > 0 and mk < 0 and Mk - mk = Mk + (-mk) is greater than either Mk or -mk' But the sup of Ili on the subinterval is the larger of Mk or -mk, and the inf of III is at least zero since III > O. Thus the sup minus the inf for III is less than Mk - mk. Adding up over all the subintervals gives Osc(l/l, P) < Osc(l, P) . Since I is Riemann integrable, there exists a sequence Pj such that Osc(/, Pj) � 0; hence, Osc(l/l, Pj ) � 0 and III is Riemann integrable. b. Let us consider { I(x) if I(x) > g(x), max(j, g) (x) = g(x) if g(x) > I(x). We claim Osc(max(l, g) , P) < Osc(l, P)+ Osc(g, P) . This follows by considering the values that max(l, g) assumes on each subinterval­ they can vary at most from the larger of the two sups to the small­ er of the two infs. Then Osc (max(l, g) , P) � 0 as the maximum length of the subintervals of P tends to zero since Osc(l, P) � 0 and Osc(g, P) � 0, so max(j, g) is Riemann integrable. QED We now turn to the problem of showing that some discontinuous functions are Riemann integrable. We begin with a simple result. Theorem 6.2.3 Let I be a bounded function on [a, b) that is contin­ uous except at a finite number oj points (we do not assume anything about the nature 01 the discontinuities at these points) . Then I is Rie­ mann integrable. Proof: Let al ,\" ., aN denote the points of discontinuity. Given any lin, surround each of these points by an interval Ik of length at most 6. 12 The Riemann Integral 227 lin. Then the function is continuous on the set consisting of [a, b) with U�l Ik removed. Let P denote any partition that contains all the intervals Ik. It will also contain some other interval Jk. In estimating Osc(f, P) we will use a separate argument for contributions from the I and J type intervals. For the I type intervals we use the crude estimate that the length of each interval is at most lin and the oscillation of the function is at most M - m, where M and m are the sup and inf of f on [a, b] (we assumed f was bounded, so M and m are finite) . Thus each interval contributes at most (At - m)ln, and there are N such intervals, so the total contribution is at most N(NI - m}/n. For the contribution from the J type intervals we use the existence of the integral for continuous functions to conclude that it can be made as small as desired, say less than lin, by taking the length of the subintervals Jk sufficiently small. Thus we have shown that Osc(/, P) � lin + N(Af - m) ln if P is any partition containing the intervals Ik and the remaining subintervals of P are sufficiently small. Now the quantities N (number of discontinuities) and M and m (sup and inf of f on [a, b]) are fixed, so by taking n large we can make Osc(f, P) as small as desired, proving f is Riemann integrable. QED Notice that the idea of the proof is to cover the set of discontinuities of f by a union of a finite number of intervals whose lengths add up to a small number (N I n in the argument). Inside these intervals we have no control over f other than its boundedness, but this is enough in estimating Osc(f, P) because the total lengths of the intervals is small. Outside these intervals the function f is continuous and we can control the oscillation as before. 6.2.3 Functions with a Countable Number of Disconti­ nuities* [Note: the arguments in this section use some elementary facts about infinite series that are discussed in detail in the next chapter.] The arguments of the last section could be generalized to show the Riemann integrability of any function f that is continuous except for a set E with the property that given any lin there exists a finite covering of E by intervals whose lengths add up to at most lin. Such 228 Chapter 6 Integral Calculus a set is said to have content zero. (Sets of content zero will play a role in the theory of multiple integrals in Chapter 15. The general notion of content has been superseded by the notion of measure, which will be discussed in Chapter 14.) An example of a set of content zero is a countable set aI, a2 , .. . that converges to the limit ao, together with ao; for then, given l/n, we cover ao with an interval of length 1/2n, and this will cover all but a finite number of the aj since limj-+ex> aj = ao . The finite number of points left uncovered can then be covered by a finite number of intervals with lengths adding up to at most 1/2n. [. ] [. ] [. ] Figure 6.2.2: However, not every countable set has content zero. The rational numbers in [0, 1] , for instance, can be covered by a finite number of intervals only if their lengths add up to one. Nevertheless, a bounded function with only a countable number of discontinuities is also Rie­ mann integrable. This will require a new and more difficult kind of proof. Before embarking on it we will consider an example that shows there are functions that have discontinuities on the rational numbers alone (Dirichlet's function is not an example because it is discontinuous at every point). The idea of constructing the example is to place jumps at each rational points but to make the jumps very small so that the function will be continuous at all irrational points. The fact that we are forced to make the jumps small helps explain why such a function must be Riemann integrable. Let rl , r2, . . . be any enumeration of the rational numbers. Then the function ( ) _ { 1 if x < rk, qk x - O .f > 1 X _ rk is continuous at every point except rk. We will multiply qk by a factor bk and take the sum f = 2:�1 bkqk(X). For simplicity we take bk = 2-k, but any absolutely convergent series E Ibkl < 00 will do as well. Then the function f can also be expressed f(x) = 2: 2-k where the sum extends over all k such that x < rk. Since E�l 2-k = 1, the function 6. 2 The Riemann Integral 229 I takes on values between 0 and 1. Now I is continuous at every irrational point Xo because given any N we can find a neighborhood of Xo that does not contain the first N rational numbers rl , ... , r N. The variation of l over this neighborhood is confined to the terms 2-krk (X ) for k < N, and the maximum these change is E�N+l 2-k = 2-N . Thus I/(x) - l(xo)1 < 1/2N in this neighborhood, so I is continuous at Xo . Roughly the same argument proves that I is discontinuous at each point rk' Just write f = 2-kqk + Ej¢k 2-i qi ' Then Ej¢k 2-j qj is continuous at rk by the argument just given, so I can't be continuous at rk without implying 2-kqk is continuous there, which it clearly is not. Again it is not possible to draw a picture of the graph of this function. Theorem 6.2.4 Let I be a bounded function on la, b] . II I is contin­ uous except at a countable set 01 points, then I is Riemann integrable. Proof: The first step is to make precise the idea that I cannot jump around a lot at too many points. Define the oscillation of f at a point Xo, denoted Osc (/, xo) to be the limit as n � 00 of the difference of the sup and inf of I on the interval [xo - l/n, Xo + l/n] . Clearly if f is continuous at Xo, then Osc(l, xo ) = 0, and conversely. Furthermore, the size of Osc(l, xo) at a point of discontinuity gives a quantitative measurement of the amount of jumping around. If I has a jump discontinuity at xo , then Osc(f, xo) is the size of the jump (as long as I(xo) takes on some intermediate value between llmx_xt I(x) and limx_xo I(x)) . Regardless of the type of discontinuity, Osc(l, xo) is well defined because the difference of the sup and inf decreases with the size of the interval. Now the set where Osc(/, x) < l/n is open. To see this, notice that if Osc(l, xo) < l/n, then Osc(/, xo) < 0 for some 0 < l/n. This means there is an interval [xo - l/k, Xo + 1/k] on which the difference of the sup and inf of I is at most l/n, and hence the oscillation of f at every point of (xo - l/k, Xo + l/k) is less than l/n. Since the set where Osc(/, x) < l/n is open, its complement, where Osc (l, x) > l/n, is closed. Note that the set of discontinuities of I is the union over n of these closed sets. This fact, which is true of an arbitrary function, is sometimes stated as follows: the set of discontinuities of a function is an Fq set (Fq means a countable union of closed sets) . 230 Chapter 6 Integral Calculus Now the hypothesis that the set of discontinuities is countable im­ plies that the smaller set where Osc (f, x) > lin is at most countable. The fact that it is also closed means that it is in some sense better behaved than the original set of discontinuities. In particular we want to show that it has content zero (it can be covered by a finite number of intervals whose lengths add up to as small a number as desired). To do this we use the Heine-Borel theorem. Given lin, we cover the closed countable set by a countable collection of open intervals whose lengths are 1 I 1 2n ' 22n ' 23n ' .... Thus if aI, a2, .. . is the countable closed set (it must be compact be­ cause it is also bounded), we cover it by the intervals (ak - 2k!l n ' ak + 2k!l n) . By the Heine-Borel theorem a finite number of these intervals will cover, and the sum of lengths of these intervals is at most 2:�1 l/2kn = lin. Thus ai , a2, .. . has zero content. Now let us consider what we have accomplished. We have the in­ terval [a, b] divided into two sets. On one, where Osc (f, x) < lin, the function is fairly well behaved-it is not necessarily continuous, but at least whatever discontinuities exist are not too jumpy. The comple­ mentary set, where Osc(f, x) > lin, is small, in that we can cover it by a finite number of intervals of small length. We want to combine these two properties. However we still need to move cautiously and apply the Heine-Borel theorem one more time. First we cover the set where Osc(f, x) > lin by a finite number of open intervals II , ... ,IN such that the lengths add up to at most lin (the lin here is deliber­ ately the same as the lin above). Now consider the complementary set, [a, b) with Uf=l Ij removed. This is again a compact set, and Osc(f, x) < lin on this set. But Osc(f, x) < lin means that x lies in an open interval in which f varies by at most lin. Thus there exists a covering of the compact set [a, b] - Uj:l Ij by such intervals and by the Heine-Borel theorem, a finite covering. By shrinking these intervals we can obtain a non-overlapping covering by closed intervals Jl ,' . . , Jk. Altogether we have the interval [a, b] partitioned into subintervals II ,' .. ,IN and Jl ,\" . , Jk with the properties: 6. 2 The Riemann Integral 231 1. The sum of the lengths of I} , ... , IN is at most lin. 2. The difference of the sup and inf of f on each Jj is at most lin. If P denotes the partition of [a, b] consisting of these intervals we can estimate Osc(f, P) as follows: the contribution from the I type intervals is at most (M - m) 11 n where M and m are the sup and inf of f on [a, b] ; while the contribution from the J type intervals is at most lin times the sum of the lengths of the J intervals, hence at most (b - a) In. Thus Osc(f, P) < (M - m)/n + (b - a)/n; and since M - m and b - a are fixed quantities, we can make Osc(f, P) as small as desired. Thus f is Riemann integrable. QED 6.2.4 Exercises 1. If a < b < c and f is Riemann integrable on [a, c], prove that f is Riemann integrable on [a, b) (strictly speaking we should say that the restriction of f to [a, b] is Riemann integrable). 2. Prove the linearity of the Riemann integral. 3. Prove the additivity of the Riemann integral. 4. Prove that if f and 9 are Riemann integrable on [a, b], then f . 9 is Riemann integrable on [a, b] . 5. Prove that if f and 9 are Riemann integrable on [a, b] and 9 is bounded away from zero (there exists l/n such that Ig(x)l > l/n for all x in [a, b], then f / 9 is Riemann integrable. 6. Prove that if f is Riemann integrable on [a, b] and g(x) = f(x) for every x except for a finite number, then 9 is Riemann integrable. 7. *Let f be Riemann integrable on [a, b] and let 9 be continuous on [m, M], where M is the sup and m the inf of f on [a, b]. Prove that go f is Riemann integrable on [a, b). (Hint: This is tricky. Not only do you need to use the uniform continuity of g, but you need to argue separately concerning the subintervals of a partition for which Osc(f, P) is small but Mk - mk is large.) 232 Chapter 6 Integral Calculus 8. Let 9 be C1 and increasing on [a, b], and let I be Riemann inte­ grable on [g( a), g( b)]. Prove that lo g is Riemann integrable on [a, b] and the change of variable formula holds. 9. a. If I is Riemann integrable on [a, b], prove that F(x) = f: I(t) dt is continuous. b. Prove it satisfies a Lipschitz condition. 10. If I is Riemann integrable on [a, b] and continuous at xo, prove that F(x) = J: I(t) dt is differentiable at Xo and F' (XO) = I(xo). Show that if I has a jump discontinuity at Xo, then F is not differentiable at Xo. 11. If I is continuous on [a, b] and differentiable on (a, b) and f' is Riemann integrable on [a, b], show that J: I' ( x) dx = I (b) - I ( a ). 12. Prove that the complement of an Fq set is a G 6 set (a countable intersection of open sets). 13. Give an example of an Fq set that is not a G 6 set and a G 6 set that is not an Fq set . 14. Prove that every open set is an Fq set and every closed set is a G6 set. 15. Prove that a G6 set that is dense must be the whole line. 6.3 Improper Integrals * 6.3.1 Definitions and Examples We frequently need to deal with integrals of functions that are un­ bounded and with integrals over unbounded intervals. In the Riemann theory of integration the only way to handle these is to take appropriate limits of integrals over smaller intervals. The term improper integral is used informally to denote any of a variety of such integrals. For exam­ ple, consider the expression f01 X4 dx where a < O. (Strictly speaking, we have only defined X4 for a rational; the general case will be dealt with in Chapter 8. For now you can either assume that a is rational or 6.3 Improper Integrals 233 else accept that the basic calculus formulas for xa are also valid for all real a.) Since the function xa is unbounded, we have not yet defined this integral. However, the function xa is bounded and continuous on the interval [E, I] for any E > 0 and so J(l xadx is defined. In fact we can compute it exactly as 1 - Ea+1 a;/; -1, /.1 \",. dx = a+l , - log E, a = -1. Thus we define the improper integral fo1 xa dx to be lim(_o J(l xa dx, and this is 1/ (a + 1) if -1 < a < 0; while the limit does not exist (or equals +00 in the extended real numbers) if a < -1. Next let us look at an example where the interval of integration is in­ finite, f 1 °O xadx, again with a < O. We define this to be limy_oo flY xa dx. Again we can compute explicitly [ \",· dx = ya+l - 1 a-i. - l, a + l ' r log y, a = -1, and so the limit exists and equals -1/ (a + 1) if a < -1 and fails to exist if a > -1. Notice that a = -1 is again the cut-off point between the existence and non-existence of the improper integral, but the inequality goes the other way. In particular, for no value of a does the improper integral fooo xa dx exist. We can state these basic facts informally as follows: the function xa has an integrable singularity near x = 0 if and only if a > -1 and an integrable singularity near 00 if and only if a < -1. So far we have looked at examples of improper integrals where the existence of the limit does not depend on cancellation of positive and negative values of the function. Suppose, to be specific, that f is a func­ tion defined on [0, 1] that is Riemann integrable on [E, 1] for every € > O. We say that f has an absolutely convergent improper integral on [0, 1] if lim(_o f(l lf(x) 1 dx exists. This implies the existence of J} f(x) dx as well. To see this we use the Cauchy criterion. Given € and � with say € < � then fl.1 /(x) dx - fl f{x) dx = f(6 f(x) dx by additivity and 234 Chapter 6 Integral Calculus I J(6 f (x) dx I ::; J(6 If (x) I dx by our previous results. This means [ f(x) dx - l' f(x) dx < [ If(x)1 dx - l' If(x)l dx, so the Cauchy criterion for convergence of lim(-+o J(1 If (x) I dx implies the Cauchy criterion for convergence of lim(-+o J} f{x) dx. Similar rea­ soning shows the existence of limy_oo JlY If (x) I dx implies the existence of limy-+oo JlY f (x) dx. There are some important examples of improper integrals that are not absolutely convergent. One is the integral 100 • 1Y . smx d 1· smx d -- x= 1m -- x. o x y-oo 0 X There is no difficulty near x = 0 because sin x I x is continuous there. However, Jt I sinxlxl dx does not have a finite limit as y � 00, for much the same reason that 2:�=1 1/n diverges. Nevertheless, we can easily show that limy_oo J� (sin x I x) dx exists by applying the Cauchy criterion. We have -- x - -- x - -- x - - -- + -- - -- dx 1y sin x d 1% sin x d -1% sin x d _ cos z cos Y 1% cos X o x 0 x y x Z y Y x2 by integration by parts. Using the crude estimate I cos xl ::; 1 we find -- dx - --dx <- + -+ -dx= -1y sin x 1% sin x 1 1 1% 1 2 o x 0 x Z y Y x2 y if Z > y, and this goes to zero as y, Z � 00. It is possible to compute Jooo {sin x I x)dx exactly using methods of complex variables. You might be amused to look up the answer in a table of integrals. Another important class of examples are the Cauchy principal val­ ue integrals. In these examples the singularity lies in the interior of the interval. Say f is defined on [-1, 1] (possibly undefined at x = 0) and is bounded on [-1, - f) and (f, l], for every f > 0, but unbounded on ( -E , E) . We define the principal value integral P.V. J�l f(x) dx to be the limit lim(-+o+ J�l( + J(1 f(x) dx if it exists. In other words, we cut away a symmetric neighborhood of the singularity and take the limit as the size of the deleted neighborhood goes to zero. For ex­ ample, P.V. J�1 (l/x) dx = 0 although f{x) = l/x is not absolutely 6. 9 Improper Integrals 235 integrable. One can also show (see exercises) that P.V. J�l (f(x)/x) dx always exists if f is CI . The fact that the neighborhood is symmetric is important, since for example lime_o+ J�l + I2 11.(1/x) dx = -log 2 while lime_o+ J�l + Je;(1/x) dx doesn't exist. The question of the existence or non-existence of improper integrals boils down to the question of existence of limits, which we will take up in detail in the next chapter. 6.3.2 Exercises 1. For which values of a and b does the improper integral r1/2 Jo xal log xlbdx exist? 2. For which values of a and b does the improper integral 100 :t°l 1og :tJb d:t exist? 3. If f is non-negative and It) f(x) dx exists as an improper integral, must limx_oo f(x) = O? Must f be bounded? What can you say if limx_oo f(x) exists? 4. Let p( x) be a polynomial with a simfle zero at x = 0 but no other zeroes in [-1, 1]. Show that P.V. f_1 1/p(x) dx exists. Also show that I�l lp(x)l-adx exists for 0 < a < 1. 5. Show that P.V. f�1 (f(x)/x) dx exists if f is CI on [-1 , 1] . 6. Show that fo oo x-a sin x dx exists for 0 < a < 2. 7. If the improper integral J�oo f(x) dx exists, prove f�oo f(x+y) dx = J�oo f(x)dx for all real y. 8. If f is positive and continuous on (0, 1] and the improper integral fO I f(x) dx exists, prove that the lower Riemann sums converge to the integral. 236 Chapter 6 Integral Calculus 6.4 Summary 6.1 The Fundamental Theorem Definition Let P denote a partition of the internal [a, b), a = Xo < Xl < ... < Xn = b and f a continuous function on [a, b]. A Cauchy sum S(f, P) is any sum of the form L�=l f(ak)(xk - xk-d where ak is in [Xk-l , Xk]. The upper and lower Riemann sums are S+ (f, P) = ��=l Mk (Xk - xk-d and S- (f, P) = �k=l mk(xk - xk- d where Mk and mk denote the sup and inf of f on [Xk-l, Xk)' The maximum in­ terval length of P is the maximum value of Xk - Xk-l ' Theorem 6.1.1 (Existence of the Integral) If f is continuous on [a, b) there exists a real number J: f (x) dx such that given N there exists m such that if the maximum interval length of P is less than 11m, then IS(f, P) - J: f(x) dxl < liN. Also J: f(x) dx = infS+ (f, P) = supS- (f, P) where P varies over all partitions. Theorem The integral 0/ continuous functions is linear and additive, and m(b - a) < J: f(x) dx < M(b - a) where M and m denote the sup and inf of f over [a, b) . Theorem 6.1.2 (Differentiation of the Integra/) If f is continuous on [a, b] , then F(x) = J: /(t) dt is Cl and F' = /. Theorem 6.1.3 (Integration of the Derivative) If f is CI on [a, b) , then J: f'{x) dx = f(b) - f(a) . Definition F is called an indefinite integral or primitive of f if F' = f. Theorem 6.1.4 (Integration by Parts) If / and 9 are CI on [a, b] then t /(x)g'(x) dx = /(b)g(b) - /(a)g(a) - t /'(x)g(x) dx. Theorem (Integral Remainder Formula for Taylor's Theorem) If f is 6.4 Summary 237 Theorem 6.1.5 (Change of Variable) If 9 is C1 and increasing on [a, b] and / continuous on [g(a), g(b)), J.9(b) J.b f(x) dx = f(g(x))g'(x) dx. g(a} a Corollary 6.1.1 (7ranslation Invariance) J.b J.b-Y a f(x) dx = a-y f(x + y) dye Theorem 6.1.6 (Arclength formula) The length of the graph of a C1 function f on [a, b] is J: Jl + f'(x)2 dx. Theorem 6.1.7 Let f(x) = J:(�l g(x, t) dt for a(x), b(x), and g(x, t) C1 junctions. Then J.b(X) !'(x) = b'(x)g(x, b(x)) - a'(x)g(x, a(x)) + 8g/8x(x, t) dt. a(x) Theorem 6.i.8 (Interchange 0/ Integrals) Let f(x, y) be continuous for x in [a, b) and y in [e, d). Then fed f(x, y) dy and J: f(x, y) dx are continuous and t (t f(x, y) dY) <Ix = t (t f(x, Y)dX) dy. 238 Chapter 6 Integral Calculus Theorem If f is CI on [a, b) with II'(x)1 < Ml and 0 is the maximum interval length of P, then lb 1 a f(x) dx - 8(/, P) < 2Mdb - a)o. Theorem (Midpoint rule) If f is C2 on [a, b) with If\"(x)1 < M2 and 8(1, P) is formed by evaluating / at the midpoint of each subinterval, then 6.2 The Riemann Integral Definition A bounded function 1 on [a, b) is said to be Riemann inte­ grable with integral J: /(x) dx i/ 8(/, P) converges to J: /(x) dx as the maximum interval length 0/ P tends to zero. Definition Osc(/, P) = 8+ (/, P) - 8- (f, P) . Lemma 6.2.1 If the maximum interval length of pi is less than the minimum length of subintervals of P, then Osc(/, PI) < 3 Osc(/, P). Theorem 6.2.1 Let / be bounded on [a, b). Then the following are equivalent: a. Osc (f, Pj) � 0 for some sequence of partitions. h. Osc(f, P) � 0 as the maximum interval length of P goes to zero. c. inf 8+ (/, P} = sup 8- (f, P). d. 8(f, Pj ) converges for every choice of Cauchy sequence for some sequence of partitions. 6.4 Summary 239 e. f is Riemann integrable. Theorem The Riemann integral is linear and additive, and m( b - a) < I: f(x) dx < M(b - a) where M and m denote the sup and inf of f on [a, b] . Theorem 6.2.2 If f and 9 are Riemann integrable on [a, b] , then so is If I, max(f,g) , and min(f,g)· Theorem 6.2.3 A bounded junction with a finite set of discontinuities on [a, b] is Riemann integrable. Example There exists a junction continuous at the irrational numbers but discontinuous at the rational numbers. Theorem 6.2.4 A bounded junction on [a, b] continuous except at a countable set of points is Riemann integrable. 6.3 Improper Integrals Example The function X4 has an integrable singularity near x = 0 if and only if a > -1 and an integrable singularity near 00 if and only if a <- 1. Definition If f is defined on [0, 1] and Riemann integrable on [E, 1) for every E > 0 we say f has an absolutely convergent improper integral on [0, 1] if liml_o II I If(x)1 dx exists. This implies liml_o 1(1 f(x) dx exists. Example limn_oo Ion (sin x/x) dx exists, but limn_oo Ion I sin x/x I dx does not. Definition The Cauchy principal value integral P. V. I�l f(x) dx is defined to be lim(_o r:l( + 1(1 f(x) dx if the limit exits. Chapter 7 Sequences and Series of Functions 7. 1 Complex Numbers 7. 1.1 Basic Properties of C So far we have been dealing with the real number system R and func­ tions whose domain and range are subsets of R. For many purposes it is important to consider also the complex number system C. We can describe this system succinctly by defining a complex number to be a symbol x + iy, where x and y are real numbers and i is a formal symbol, which operationally is to be thought of as a solution of the equation x2 = -1. We have already observed that there are no real solutions of this equation. The arithmetic of complex numbers is described by the formulas (x + iy) + (x' + iy') = (x + x') + i(y + y'), (x + iy) . (x' + iy') = x · x' - y . y' + i(x . y' + x' . y), which are obtained by adopting the usual rules of arithmetic together with the identity i2 = -1. It is a familiar fact from algebra that the complex numbers satisfy the field axioms. Perhaps the only nontrivial one is the existence of multiplicative inverses, but we easily verify that -- = +! ---=--� 1 x .( y ) X + iy x2 + y2 x2 + y2 241 242 Chapter 7 Sequences and Series of Functions does the trick. We leave the details as an exercise. The construction of the complex numbers from the real numbers is purely algebraic (involving only finite operations). It is an example of a general procedure for enlarging any field by adjoining roots of an equation (in this case x2 + 1 = 0). It is a remarkable fact that the com­ plex numbers are algebraically complete, meaning that all polynomials with complex coefficients ( ( J5 + i) X27 + 3X6 - 7r, for example) have complex roots. Thus the complex numbers cannot be further enlarged algebraically. This fact is called the fundamental theorem of algebra. It will not be used in this book. For a proof, the reader can consult any text on complex variable theory. The complex numbers do not possess an order that is mathemat­ ically relevant (one could impose an order, say lexicographic, but it would not have enough properties to make it worth studying). But there is a related concept of absolute value or modulus of a complex number, Ix + iYI = Jx2 + y2 . Note that x2 + y2 is non negative, so the square root exists as a non negative real number. If we adopt the familiar convention of identifying the complex numbers with points in the plane (x + iy corresponds to (x, y» ) , then Ix + iyl is the distance of the point to the origin by the Pythagorean theorem (see Figure 7. 1.1). �(x.y) x2+y2 y i x Figure 7. 1.1: The two most important properties of the absolute value are the multiplicativity, Iz ·zd = Izl ' lzd, and the triangle inequality, Iz +zd < Izl+ lzd, where z and Zl are any complex numbers. The multiplicativity is established by a direct computation; if z = x + iy and Zl = Xl + iYl , then 7. 1 Complex Numbers 243 Iz . zd2 - I(XXI - yyd + i(XYI + xIy)12 (XXI - yyd2 + (XYI + XIy)2 x2xi + y2yi + x2y� + xIy2 because the cross terms cancel, and this is (x2 + y2)(xI + yr). Thus Iz · zd2 = Izl2 lzd2 , so the multiplicativity follows by taking the square­ root. There are many different proofs of the triangle inequality. First let's justify the name with a geometric interpretation. Consider the triangle in the plane with vertices at the origin, at z and at Zl . Then the lengths of the sides are Izl, Izd, and I ZI - zl, as shown in Figure 7. 1.2, Izi o Figure 7. 1.2: and so I ZI - z I < I z I + I zi l says the length of one side of the triangle is less than the sum of the lengths of the other two sides. This is equivalent to the inequality I ZI + zl < Izl + IzI/ since I - zl = I zl . It is then clear from the geometry that the inequality is an equality exactly when the triangle degenerates into a straight line with z and zI on the same side of the origin. Another way of saying this is Zl = rz where r is a non negative real number. We can use this insight to fashion a proof. Let us hold Zl fixed and vary z so that Izi = c is also fixed and ask when Iz + zl l is maximized. The answer should be when z = czl/ lzI /, and if this is indeed the case we have I z + zl l = I z I + I zl l for this particular choice and, hence, I z + zI / < I zl + Izd for every other choice (note that Izi + I zd is not varying because Zl and Izi = c are fixed). 244 Chapter 7 Sequences and Series of Functions Figure 7.1.3: Now we have the problem of maximizing ! Z + Zl!, or what is the same thing, maximizing Iz + zt l2 = (x + xd2 + (y + yd2 given that Zl = Xl + iYl is fixed and x2 + y2 = c2 , as shown in Figure 7.1.3. But {x + XI}2 + (y + yI)2 = x2 + y2 + xI + Yf + 2XXl + 2YYI and, since x2 + y2 + x� + y� = c2 + x� + y� is fixed we need to maximize 2(XXI +yyI) given x2+y2 = il. This can be reduced to a simple calculus problem by solving Y = ±v'c2 - x2 and finding the critical points of f{x} = 2{XXl ± Yl'/c2 - x2}. Since f'{x} = 2(XI =F YIX/Jc2 - x2}, we obtain f'{x} = 0 when XIY = XYI' The two critical points occur when Z and Zl are colinear with the origin, but the maximum is clearly assumed when they both lie on the same side. This is by no means the simplest proof of the triangle inequality, and we will give another after we discuss trigonometric functions. A useful consequence of the triangle inequality is the inequality Ilzl - IZIII < Iz - zI i , which has the interpretation that the distance between points on concentric circles is at least the difference of the radii {see Figure 7.1.4}. We leave the details to the exercises. For our purposes, the main reason for introducing the absolute value is to use it to formulate topological properties of the complex numbers. For example, what do we mean by the limit of a sequence of complex numbers? If Zn = Xn + iYn we could define limn -oo Zn = Z where Z = x + iy to mean limn_oo Xn = x and limn_oo Yn = y. In other word­ s, we separate the real and imaginary parts of the complex numbers and require convergence of each. In fact, with most concepts involving complex numbers we will take this approach. But there is another ap- 7. 1 Complex Numbers 245 Figure 7.1.4: proach, which is to replace the neighborhood Iz - zol < lin concept for reals by the neighborhood I z - %01 < lin concept for complex num­ bers. This would lead to the definition: limk_oo Zk = Z means given any error lin there exists m such that k > m implies I Zk - zi < lin. We claim that the two definitions are equivalent. Indeed the second definition says the sequence eventually is entirely contained in any disc about z, while the first definition says the sequence eventually is entirely contained in any rectangle about z, as in Figure 7.1.5 (limk_oo Zle = x means eventually IZk - xl < lin and limk_oo 11k = 11 means eventually lYle - YI < 11m, and these two conditions mean Zk lies eventually in a rectangle) . D Figure 7.1.5: The equivalence of the two definitions is thus a consequence of the fact that for every such rectangle there exists a disc about z entirely con- 246 Chapter 7 Sequences and Series of Functions tained in the rectangle (so Zk in the disc implies Zk is in the rectangle), and conversely for every disc about z there exists such a rectangle en­ tirely contained in the disc (so Zk in the rectangle implies Zk is in the disc). These facts are illustrated in Figure 7.1.6. We leave the details of the algebraic verification to the exercises. Figure 7.1.6: In the same way we can define a Cauchy sequence of complex num­ bers Zl, Z2, ••• by the condition: for all lin there exists m such that IZk - Zj I < lin if j > m and k > m. We can show this is equivalent to the condition that Xl, X2, ••• and Yl, Y2, ••• be Cauchy sequences of real numbers and hence obtain the completeness of the complex numbers: every Cauchy sequence of complex numbers converges to a complex number limit. (Note that the word completeness is used here in an entirely different sense than the algebraic completeness mentioned be­ fore.) The complex number system has no direct intuitive interpretation. For this reason it met with some difficulty in being accepted into the mainstream of mathematics-such terminology as \"imaginary\" and \"complex\" reflects the resistance and even hostility of the imagina­ tions of many mathematicians to accepting the complex numbers as a legitimate number system. After all, what do these numbers mean? Fortunately, such objections did not prevail, as the complex number system proved extraordinarily useful, in almost every branch of pure and applied mathematics. As far as the question of \"meaning\" is con­ cerned, we can be content with no answer because there are so many different \"interpretations\" of the complex number system, each of which gives some significance-if not meaning-to the abstract mathemati- 7. 1 Complex Numbers 247 cal system. Intuition is not completely excluded from the picture; one simply has to develop an intuition for the complex number system. 7. 1.2 Complex-Valued Functions We will be considering mostly functions whose domain lies in the real numbers and whose range lies in the complex numbers. Functions with domain and range in the complex numbers involve the theory of complex analysis, which requires a book of its own. We will only give a hint of this theory in the section on power series. Functions whose range lies in the complex numbers, also called complex-valued functions, can be dealt with by splitting the real and imaginary parts. If F(x) is a complex number for each x in the domain, then F(x) = f(x) + ig(x) for uniquely determined real numbers f(x) and g(x); and this defines f and 9 as real-valued functions on the same domain. Conversely, if f and 9 are real-valued functions on a common domain, then F(x) = f(x) + ig(x) is a complex-valued function on the same domain. We call f and 9 the real and imaginary parts of F, respectively. Properties such as continuity, differentiability, and integrability can be defined for complex-valued functions by modifying the definition for real-valued functions, and it can easily be shown that the complex-valued function has the property if and only if its real and imaginary parts both have the property. For example, if F is a complex-valued function on [a, b] , then F is said to be differentiable at Xo, a point in (a, b), if limh_o (F(xo + h) - F(xo))/h exists. For integrability we do not have a notion of Riemann upper and lower sums, but we can still define F to be integrable if all the Cauchy sums S(F, P) converge to a limit as the maximum length of subintervals of P goes to zero. We leave the details as exercises. Again we must stress that the complex values appear in the range and not the domain of the functions. For functions defined on the complex numbers there is no corresponding splitting into functions defined on the real numbers. By and large, all the theorems we have established so far for real­ valued functions are also valid for complex-valued functions. The proofs can either be modified simply or one may break up the complex-valued function F = f + ig and apply the real-valued theorem to the real and imaginary parts. We discuss here only the few exceptions to this rule, where either the analogous theorem is false or a new idea is needed for 248 the proof. Chapter 7 Sequences and Series of Functions The mean value theorem does not hold for complex-valued func­ tions. If we apply the theorem to the real and imaginary parts we obtain and f(b) - f(a) = I'(xl) b - a g(b) - g(a) '() b = 9 X2 , - a but there does not have to be any connection between the points Xl and X2. It is easy to construct a counterexample, say F(x) = x2 + ix3 on [0, 1] where F'(x) = 2x + i3x2 and (F(1) -F(0))/(1 - 0) = 1 +i, and ne'er the twain shall meet. Similarly, the Lagrange remainder formula for Taylor's theorem does not hold for complex-valued functions, but Taylor's theorem itself is true, as is the integral remainder formula. There is also no intermediate value property for continuous complex­ valued functions, since there is no notion of \"between\" for complex numbers. The next result is an example of a theorem that is true for both real- and complex-valued functions, but the complex version requires a more intricate proof. Theorem 7.1.1 Let F be a complex-valued integrable junction. Then the real-valued junction IFI is integrable, and If: F(x) dxl < J: IF(x)1 dx. Proof: We first show Osc(lFI, P) < Osc(f , P)+ Osc(g, P). This proves the integrability of IFI since F integrable implies f and 9 are integrable, so Osc(f, P) and Osc(g, P) can be made as small as desired. N ow the oscillation over a partition is just the sum of the oscillations over each subinterval multiplied by the length of the subintervals, so it suffices to show that on each subinterval the oscillation of IFI is less than or equal to the sum of the oscillations of f and g. Recall that the oscillation of a real-valued function f on an interval was defined to be the difference of the sup and inf, and this is clearly the sup of the values I f (x) - f (y) I as x and y vary over the interval. Thus we are trying to prove sup I IF(x)I -IF(y)1 1 < sup I/(x) - f(y) 1 + sup Ig(x) - g(y)l, ::t,1I %,11 ::t,Y 7. 1 Complex Numbers 249 and for this it suffices to prove IIF(x) l- IF(y)1 1 < If(x) - f(y)1 + Ig(x) - g(y) 1 for then we may take the sup over all x and y in the interval and use the fact that the sup of a sum is less than or equal to the sum of the sups (the worst possible case is when the sups of If(x)-f(y)1 and Ig(x)-g(y) 1 are assumed for the same value of x and y, when sUPx,y{lf(x) - f{y) 1 + Ig(x) - g{y)1) = SUPx,y If(x) - f(y)1 + SUPx,y Ig(x) - g(y)1 whereas if If{x) - f(y)1 and Ig(x) - g(y)1 are largest for different values of x and y, then there will be inequality) . But this follows from the inequality involving complex numbers IIzl - IZ1 11 < Ix - xI I + Iy - yd, where z = x + iy and Zl = Xl + iY1' The proof is left to the exercise set 7. 1.3, number lOb. Altogether, then, we have shown that Osc(IFI, P) < Osc(f, P)+ Osc{g, P). (We could also prove Osc(IFI, P) < Osc(F, P) if we defined Osc{ F, P) appropriately, taking the definition of the oscillation of a complex-valued function on an interval to be the sup of IF(x) - F(y} l over all X and y in the interval.) Thus F integrable implies IFI inte- grable. The inequality If: F(x) dxl < J: IF{x)1 dx then follows from the corresponding inequality IS{F, P) I < S{IFI, P) for Cauchy sum­ s (evaluated at the same points), which is just a consequence of the triangle inequality (iterated to sums of n numbers) n n IS(F, P) I = L F{Yj )(xj - Xi-I) < L IF(Yi)(Xj-xj-I)1 = S(IFI, P) since j=l j=l IF{Yj)(Xj - xj-dl = IF(Yi)l(xj - Xj-I), Xj - Xj-l being positive. QED 7. 1.3 Exercises 1. Prove that a complex-valued function is Riemann integrable (in the sense of convergence of Cauchy sums) if and only if its real and imaginary parts are Riemann integrable. 2. Prove the integral remainder formula for Taylor's theorem for a complex-valued function. 250 Chapter 7 Sequences and Series of Functions 3. If f{x) is a continuous complex-valued function and f{x) =F 0 for any x in the domain, prove that II f(x) is continuous. 4. Find a countable dense subset of C. 5. If z is a complex number define the complex conjugate z to be x - iy if z = x + iy. a) Show that ZI + Z2 = ii + £2, Z1z2 = %1£2, and Izl = \"fti. b) Show liz = z/lzl2. c) Show that z is real if and only if z = z. 6. If f is a complex-valued Cl function and f{x) ;/; 0 on the domain, prove that If I is Cl. Can you find a formula for Ifl'? (Hint: use exercise 5.) 7. Show that z2 = i has solutions z = IIv'? ± iiv'?. 8. State and prove the fundamental theorem of the calculus (both forms) for complex-valued functions. 9. Prove that every disc {z : I z - Z() I < 1 In} is contained in a square {z : Ix - xol < lin and Iy - yol < lin} and that every square {z : Ix - xol < lin and Iy - Yol < lin} is contained in a disc {z : Iz - zol < v'?ln}. 10. a. Prove the inequality IIzl-lzdl < IZ-Zll for complex numbers. (See Figure 7.1.4.) b. Prove IIzl - IzI/ I < Ix - xd + Iy - yI/ for z = x + iy and Zl = Xl + iYl' 7. 2 Numerical Series and Sequences 7. 2.1 Convergence and Absolute Convergence We have already discussed the meaning of the convergence of an infinite sequence of real or complex numbers. We will also want to consider infinite series, written X l + X2 + .. . or ��l Xk . To each infinite series corresponds the infinite sequence of partial sums Sn = 2:�=1 Xk , and we define 2:�1 Xk to be convergent with 2:�1 Xk = S if 81, 82, . . . is con­ vergent with limit 8. This definition applies to real- or complex-valued 7. 2 Numerical Series and Sequences 251 series. This convergence is sometimes called ordinary converyence to distinguish it from the more stringent absolute convergence we will de­ fine later. A series that is not convergent is called diveryent, and we will sometimes speak of series that diverye to +00 or -00 (or write L�l Xk = ±oo) if 81, 82, . .. converges to +00 or -00 in the extended real numbers. From the sequence of partial sums 81, S2, ••• we can recover the terms Xn of the series by the difference formula Xl = Sl and Xn = 8n - 8n-1 for n > 1. Note that if 81 ,82, .. . is any infinite sequence of numbers we can obtain by the same formula an infinite series L�l Xk that has 81 , S2, ••• as partial sums. In this way we have a naturally defined one-to-one correspondence between infinite series and infinite sequences-and so in a sense the theory of the two is the same. Nevertheless, it is sometimes more convenient to think about certain problems in one or the other form, so we will maintain both perspec­ tives. An example of a concept that is natural for series but not for sequences is that of absolute convergence. We say �k:1 Xk is absolutely convergent if �k:1 IXk l is convergent. This definition applies to real­ or complex-valued series. The idea of absolute convergence in the real case is that the convergence should not be caused by cancellation of positive and negative terms. Later in this chapter we will discuss infinite series and sequences of functions. The material in this section lays the foundation for that more complicated theory. The reader is probably familiar with most of the ideas-at least on an informal level-from calculus. Before beginning the discussion of general series, we start with an important and familiar example, the geometric series L�l rk for o < r < 1. Since we have we have so {1 - r)(r + r2 + ... + rn) _ + 2 + + n 2 n n+1 n+1 -r r ... r -r - . . ·- r - r =r-r , n r rn+1 8n = �rk = - , � l - r 1 - r k=l r rn+1 8n - = - . 1-r 1- r 252 Chapter 7 Sequences and Series of Functions We claim for 0 < r < 1 that this has limit zero as n � 00, which will show L:�1 rk is convergent and equals r/(l - r). Since r < 1, the factor 1/(1 - r) is harmless, so we need to show limn_oo rn = o. If r < 1, then 1/r > 1, so by the axiom of Archimedes 1/r > 1 + 11k for some integer k. Then -> 1+- =1 +-+ . . · -- +- 1 ( l) n n n 1 rn - k k kn-1 kn by the binomial theorem. Since all the terms in the binomial expansion are positive, we have l/rn > 1 + nlk, so rn < kl(n + k) and this can be made < 11m by taking n > k(m - 1). Note that the rate of convergence of rn to 0 (hence the rate of convergence of L::l rn) depends on how close r is to 1. The closer r is to 1, the larger k is in the estimate 1 I r > 1 + 1 I k and the slower the convergence. The estimate we have given is rather crude; the geometric series actually converges much more rapidly for fixed r. Nevertheless it is true that there is no uniform rate of convergence for all r < 1. We leave this as an exercise (note that the argument we gave for the convergence does not suffice to prove that the rate of convergence is not uniform-it only shows that one attempt to estimate the rate of convergence leads to dependence on r). We begin the discussion of general properties of series with the elementary observations of linearity and order preservation. If �k:l Xk and Lr=1 Yk are convergent, then ��1 (Xk + Yk) is convergent and ��1 aXk is convergent with ��l (Xk + Yk) = L�l Xk + L�l Yk and ��1 aXk = a ��l Xk· Also if Xk > Yk for every k, then L:�l Xk > L�1 Yk· These follow from the corresponding results for the sequences of partial sums and the fact that like operations prevail (the partial sums of the sum series ��l (Xk + Yk ) are the sums of the partial sums of the summands, etc.). Incidentally, there is no such result for products; L:�l XkYk need not be convergent (see exercises). Indeed there is no relation between �k=l XkYk and Lk=l Xk and Lk=1 Yk· Another relatively simple observation is that the convergence of an infinite series (but not the limit) does not depend on any finite number of terms. Indeed changing the terms Xk for k < n means that all the partial sums 8m beyond 8n are changed to 8m + c for a fixed number c and so converge or not as with 8m• A particular form of modifying a finite number of terms is to rearrange the first n terms. In this case the 7. 2 Numerical Series and Sequences 253 constant c is zero, so the limit is unchanged. Rearranging an infinite number of terms is another matter, which we will return to later. The Cauchy criterion for convergence of sequences translates easily into a criterion for convergence of series that again does not involve the limit. Theorem 7.2.1 L�l Xk converges if and only if for every error l/n there exists m such that 12::=p Xkl < l/n for all p, q satisfying q > P > m. Proof: If 81 , s2, • •• denotes the partial sums, then 8q - Sp-l = 2::=p Xk, so this is exactly the Cauchy criterion for 8b 82 , . . .. QED A special case of this is the observation that convergence of 2:�l Xk implies limk_oo Xk = 0, since Xk = Sk - Sk-l. Of course the converse is false (we have already discussed the fact that the smallness of the difference between neighboring terms 8k- l and 8k in a sequence is not the same thing as the Cauchy criterion). As we will show shortly, 2:�1 l/k diverges. A series L�1 Xk is said to be absolutely convergent if the series of absolute values 2:�1 IXk l is convergent. To justify the terminology let us observe that absolute convergence implies convergence. This is an immediate consequence of the Cauchy criterion, since I L%=p xkl < 2::=p IXkl by the triangle inequality. Intuitively we can argue that the possibility of cancellation of positive and negative values (or the more complicated cancellation of positive and negative values in the real and imaginary parts in the complex-valued case) can only help with convergence. An example of a convergent series that is not absolutely convergent is 1 - 1/2 + 1/3 - 1/4 + 1/5 - 1/6 + .. . = L�1 (-l)k /k (we will prove this later). Absolute convergence is an extremely useful concept, and most tests for convergence actually establish absolute convergence. The most fun­ damental test is the comparison test. Theorem 7.2.2 (Comparison test) Let 2:�1 Xk and 2:r=l Yk be infi­ nite series with the Yk 'S non-negative and IXkl < Yk (it suffices to have this for all but a finite number of terms). If L�l Yk is convergent, then 2::::1 Xk is absolutely convergent. 254 Chapter 7 Sequences and Series of Functions Proof: Note that for a series of non-negative terms, convergence and absolute convergence are the same. The theorem is a trivial con­ sequence of the Cauchy criterion as 2::=p IXk l < E:=p Yk from the hypothesis (if there is a finite number of exceptions to IXk l < Yk we must take p sufficiently large). From the convergence of E�l Yk we know we can make E:=p Yk < l/n if q > P > m and so E:=p IXk l < l/n also, so 2:�l lxk l converges. QED The comparison test can also be used in contrapositive form to prove divergence of series of non-negative terms (see exercises). Many applications of the comparison test use the geometric seriesj in fact the familiar root and ratio tests are proved in this fashion. We state the results here but leave the proofs to the exercises. Theorem 7.2.3 a. (Ratio test) If IXn+l/Xnl < r for all sUfficiently large n and some r < 1, then EXn converges absolutely; while if IXn+ l /Xnl > 1 for all sufficiently large n, then EXn diverges. b. (Root test) If v'lxn I < r for all sufficiently large n and some r < 1, then EXn converges absolutely. Next we consider the important class of series 2:�=1 l/na where a is a positive real number. (Strictly speaking we have not yet defined na unless a is rational, so we should either restrict the discussion to rational numbers a = p/q when nP/q = � or else observe that the argument we give depends only on the familiar properties of powers, so the results will ultimately be justified in the next chapter when we establish these properties in general.) We want to show 2:�=1 1/na converges for a > 1 and diverges for a < 1. If this reminds you of the result concerning the improper integrals fl°O l/xa dx, it should. In fact one can use the results about the integrals to establish the results about the series (see exercises). We shall give a more direct argument here. Notice that we will not evaluate E:=1 1/na exactly, as a function of aj this is the notorious Riemann zeta function, which is related to questions about the distribution of prime numbers in ways that are too mysterious to explain here. You 7. 2 Numerical Series and Sequences 255 might also be intrigued with the identity E�=1 1/n2 = 11\"2/6, which we will establish in the chapter on Fourier series. The key idea for deciding the convergence or divergence of the series L�=1 l/na is to break the sum into dyadic pieces, meaning the range 2k < n < 2k+l -1. For n in this range the values of l/na vary between 1/2ka at the largest to 1/2(k+l)a = 1/2a . 1/2ka at the smallest-so they are roughly the same order of magnitude. For the proof of convergence we use the upper bound, l/na < 1/2ka if 2k < n < 2k+1 , and for the proof of divergence we use the lower bound, l/na > 1/2a . 1/2ka if 2k < n < 2k+ 1 • By the comparison test we thus need to determine the convergence of the series E�=1 bn where bn = 1/2ka where k is related to n by 2k < n < 2k+l . Thus 22 terms 1 1 + ... + - + ... + - + . . . . 2ka 2ka , , ... Note that each block of 2k terms (all equal to 1/2ka) adds up to exactly 2k . 1/2ka = 2(I-a)k, so E!:ll bn = L;:;01 2(I-a)k and this is a geometric series with r = 21-a. If a > 1, then r < 1, so the geometric series converges; while if a < 1, then r > 1 and the geometric series diverges. Strictly speaking we have only analysed the behavior of the partial sums L:=1 bn for k = 2m - 1; but since the terms bn are non-negative, this is enough to decide the convergence (a > 1) and divergence (a < 1) of the series. In particular, we have established the divergence of the harmonic series L�=1 lin. (As an interesting computer \"experiment\" , try evalu­ ating the sum of the harmonic series on your favorite computer or pro­ grammable calculator. You may come up with a finite answer because 1 I k is rounded off to zero before the partial sums become very large. This illustrates how slowly the series diverges. It also raises a profound 256 Chapter 7 Sequences and Series of Functions philosophical question: can there be any natural phenomenon whose existence depends on the divergence of the harmonic series?) Why, then, does the series L�= 1 ( -1) n j n converge? One way to see this is to combine consecutive terms, say n = 2k - 1 and n = 2k, -1 1 -1 2k - 1 + 2k = (2k - 1)2k ' The series L�l -lj(2k - 1)2k converges absolutely by comparison with L%\"=1 Ijk2, so the partial sums L�d -1)njn with m even con­ verge and if m is odd we have Lk=l (-I)njn = ( _ I)m jm+ L�-/ ( -1)njn, so the odd partial sums converge to the same limit. We will discuss another way to establish the convergence of L�=l ( -l)n jn in section 7.2.3. 7.2.2 Rearrangements If L�=l an is an infinite series, we say L�=l bn is a rearrangement if there is a one-to-one correspondence between the terms; or, put another way, bn = amen) where m is a function from the natural numbers to the natural numbers that is one-to-one and onto. Thus L�=l bn is a series consisting of the same terms as L�=l an but with a different order. At first we might think that if L�=l an is convergent, then L�=l bn should also be convergent with the same limit, but this turns out to be the case only for absolutely convergent series. To understand why this should be so, we consider the intuitive idea that the tail of the series is small. That is, L�l an = L�=l an + L�=N+l an and the finite sum L�=l an is close to the limit, so L�=N+l an is small. In the absolutely convergent case L�=N+l lanl can also be made small, but in the nonabsolutely convergent case L�=N+l lanl is divergent no matter how large N is. This means L�=N+l an is small only because of cancellation. N ow consider a partial sum of the rearrangement L� 1 bn • If we take m large enough, then all the terms al , a2, ... ,aN will show up (here we fix N and m will depend on N) so that 7. 2 Numerical Series and Sequences 257 where I::'V + 1 an just represents a finite sum of some of the an with n > N + 1-a selection of the tail L�=N+l an. For the absolutely convergent case p E 'an < E lanl N+l n=N+l for p large enough so that each an in the selection of the tail L�'V + 1 an has n < p. This can be made as small as desired by taking N large (hence m depending on N also large), so L�=1 bn differs from L�=l an by as little as desired, showing that L�=1 bn converges to the same limit. But in the nonabsolutely convergent case we do not know that the selection of the tail L�'V+l an is small just because the tail is small. On the contrary, we expect that by an especially nasty selection of the tail we should be able to get something large, since L�=N+l lanl diverges. For example, in the case that all the terms are real, the divergence of L�=N+l lanl can only occur if either the sum of all the positive an's or the sum of all the negative an's diverges. Let us say anA, > 0 for some sequence nl < n2 < n3 < ... and E�1 anA, = +00. Then if the selection of the tail L:'V+l an is made entirely from the values of n equal nl, n2, ... , then the selection of the tail can be made as large as desired! This is the idea that lies behind the next theorem. Theorem 7.2.4 a. Let L�=1 an be absolutely convergent. Then any rearrangement is also absolutely convergent and has the same limit. b. Suppose every rearrangement of L�=l an is convergent. Then L�=1 an is absolutely convergent. Proof: a. Given any error 11m, we have to show that L:=l bn can be made to differ from L�=1 an by at most 11m, by taking k large enough. Here L:=1 bn denotes a fixed rearrangement. First we choose N large enough so that E�N+l lanl < 11m and then choose k large enough so that aI , a2, ... ,aN occur in bl ' �' ... ,bk' Then E:=l bn - L:�=1 an is a selection of the tail L�=N + 1 an, hence k N E bn - L an n=1 n=l < � - , m 258 Chapter 7 Sequences and Series of Functions so L�=l bn converges to the same limit as L�=l an. The absolute convergence of L�=1 bn follows because L�=l lbnl is a rearrangement of L�=l lan l. b. Suppose L�=l l£lnl diverges. We need to construct a rearrange­ ment of L�=1 an that diverges. Assume first that the terms an are real. We can also assume without loss of generality that there exists a sequence nl < n2 < n3 < .. . such that anA: > 0 and L�1 anA: = +00 (if not, then we can find anA: < 0 with L�1 anA: = -00, and the ar­ gument is essentially the same). To simplify the notation let Ck = anA: and let dl , d2, ... be the remaining an's (they may be finite in number). To describe a rearrangement of L�=l an we will tell how to pick all the Ck'S and dk'S in some order. Now the idea is that we would like to take Cl, C2, • •• for this will clearly give a divergent series. But this is not a rearrangement, because we have omitted the dk'S. So we need to fix this by sprinkling the dk'S very thinly among the Ck'S. Look at d1 • Wait until Cl + C2 + ... + CNl exceeds Idl l + 1, so then Cl + C2 + ... + CN1 + d1 > 1. Next look at d2 • Wait until Cl + .. '+ CN1 +d1 +CN1 +1 + .. '+ CN2 exceeds Id21 +2, so then Cl + ... + CNl + d1 + CNl +1 + ... + CN2 + d2 > 2. We can continue in this fashion to sprinkle in dk after CNA: so that the sum up to dk exceeds k. In this way we obtain a rearrangement that diverges. In the case where the an are complex, say an = Xn + iYn, the diver­ gence of L�=1 lanl implies that either L�=l IXn l or L�=l IYnl diverges (else L�=1 lanl < L�=l IXnl + L�=l IYnl by the triangle inequality, hence L:=1 lanl converges by comparison). Then by the previous ar­ gument we can rearrange L�=1 an so that either the real or imaginary parts of the series diverge, and this implies the complex series diverges (convergence of a complex series is equivalent to convergence of the real and imaginary parts). QED We say that L�=1 an converges unconditionally if every rearrange­ ment converges. The theorem we have just proved shows that L�=l an converges unconditionally if and only if it converges absolutely. A series is said to converge conditionally if it converges but some rearrangement diverges. We can generalize the previous argument to show that a conditionally convergent series of real numbers can be rearranged so that it converges to any prescribed real number! The 7.2 Numerical Series and Sequences 259 idea is that now we can divide the terms an into those that are non­ negative, Cb C2, C3, '\" and those that are negative, dl , d2,\" \" and we must have L�=l en = +00 and L�=l lin = -00 (if both were finite the series would converge absolutely, while if only one were finite the series would diverge). Also, limn_oo en = 0 and limn_oo dn = 0 since the series L�=l an converges. Now suppose we want to rearrange the series to converge to A. Say A > O. Take Cl , C2 ,\" \" CNI until Cl + C2 + . . . + CNI > A for the first time. Then take dl , •.• , dN2 until CI + . . . + CNI + dl + ... + dN2 < A for the first time. Keep switching back and forth between c's and d's to make the partial sums oscillate above and below A. This is always possible since L�= 1 en = +00 and L�=l lin = -00 , and we eventually use all the c's and d's so that we have a genuine rearrangement. Finally the conditions limn_oo en = 0 and limn_oo lin = 0 imply that the limit of the rearranged series is A, because we switch directions just when the partial sums cross the value A. We leave the details as an exercise. Returning to the positive results, we note also that absolute con­ vergence implies the possibility of rearrangement of mUltiply indexed series. For example, let Clmn denote a real or complex number for each natural number n and m. Then we can sum all the amn in either order, Thinking of amn as an infinite matrix all al2 al3 a2l a22 a23 a31 a32 a33 these correspond to summing by rows or by columns. We could also consider summing along diagonals to get an ordinary infinite series. In general, the fact that one of these procedures yields a finite number does not imply that any of the others will or that even if they are all finite that they must be equal. However, if any of these procedures yields a finite number when applied to lamnl, then we say the double 260 Chapter 7 Sequences and Series of Functions infinite series E E amn is absolutely convergent, and we can prove that all three summing procedures yield the same finite number. The idea of the proof is the same as in Theorem 7.2.4. We leave the details as an exercise. An analogous result holds for multiple integrals; we will cover this in Chapter 15. 7. 2.3 Summation by Parts· In this section we establish a general method of proving convergence of non-absolutely convergent series, called summation by parts, which is an analog of the integration by parts formula. It can be used to give another proof of the convergence of E:=l (_I}n In. Suppose a series can be written in the form E�=l Anbn (of course this is always possible in many ways, the idea being that a clever choice of An and bn will be required to get anything out of the method) . We then want to do the analog of integrating bn and differentiating An. So we let Bn = E�=l bk and an = An+l - An. Then m E anBn - alBI + a2B2 + . . . + amBm n=l (A2 - At }bl + (A3 - A2)(b1 + �) + (� - A3)(b1 + � + �) + . .. + (Am+l - Am} {b1 + � + � + . . . + bm). If we collect all the terms that contain b1 , then all the terms that contain �, and so on, we obtain bd (A2 - Al ) + (A3 - A2) + .. . + (Am+l - Am)) + �« A3 - A2) + (A4 - A3) + . . . + (Am+l - Am)) + ... + bm{Am+l - Am) m + ... + bm(Am+l - Am} = - L bnAn + Am+1Bm. n=l Thus, if the term Am+lBm goes to zero, the question of convergence and the limit of E�=l Anbn is the same as the question of convergence 7. � Numerical Series and Sequences 261 and the limit of - 2:�=1 anBn (note that the absolute convergence of these two series is a different question, because the above manipulations would not work with absolute values). By clever choice of An and bn we may well find it easier to prove convergence of 2: anBn. For the series 2:�=1 (_l}n In we take An = lin and bn = (_l}n. Then 1 1 -1 a = -- = ---n n + 1 n (n + l}n and Bn = 0 or -1 depending on whether n is even or odd. Since An+I Bn -t 0 as n -t 00, we conclude L�=I (-l}nln is convergent since L:�-l anBn is absolutely convergent by comparison with L�=l 1/n2• Of course this is essentially the same argument as before, but we can now generalize it. Theorem 7.2.5 a. Let AI, A2,.' . be a sequence of positive numbers converging mono­ tonically to zero (so Al > A2 > A3 . . . and limn-ex> An = o). Then L�= 1 ( -1) n An is convergent. h. Suppose also bl, �, . . . is any sequence of real numbers with Bn = bl + . . . + bn bounded, say IBnl < M for all n. Then L�=l Anbn is convefYent. Proof: Part a is a special case of part b with bn = (-1) n, so we prove part b. Note that if we form an = An+l - An, then -an > 0 since An+ I < An and m E -an - -(A2 - AI) - (A3 - A2) - ... - (Am+l - Am) n=l Al - Am+I , which converges as m -t 00 to Al since Am -t O. Thus L�=l -an is an absolutely convergent series. Now if we multiply the terms of an absolutely convergent series by a bounded sequence the resulting series is still absolutely convergent. In this case IBnl < M, so L�=p lanBnl < M L�=p lanl -t 0 as p, q -t 00, proving L:=l anBn is absolutely con­ vergent by the Cauchy criterion. Since we also have limn_ex> An+ IBn = o since limn-oo An+l = 0 and IBn l < M, we conclude that L:=l Anbn is convergent by summation by parts. QED 262 7.2.4 Exercises Chapter 7 Sequences and Series of Functions 1. Give an example of two convergent series E�l XIc and E�l Ylc such that E�l XkYIc diverges. Can this happen if one of the series is absolutely convergent? 2. State a contrapositive form of the comparison test that can be used to show divergence of a series. 3. Show that it is not true that for every error 11m there exists n such that I E�=I ric - r/{l - r)1 < 11m for all r in 0 < r < 1. 4. Prove the ratio test (Theorem 7.2.3a) . What does this tell you if lillln_oo IXn+l /xnl exists? 5. Show E�=2 1/n4 < Ii' 1/x4 dx, and use this to prove the conver­ gence of the series for a > 1. 6. Prove that every conditionally convergent series of real numbers that does not converge absolutely can be rearranged to have any prescribed real limit. 7. Prove that a series of complex numbers is absolutely convergent if and only if the series of real and imaginary parts are absolutely convergent. is finite for every m and then E:=l (E�=l amn) - 9. Give an example of a doubly indexed series amn such that E:=l (E�=l amn) =F E:=l (E:=l amn). 10. Prove the root test (Theorem 7.2.3b) . 11. Suppose lanl < bn - bn+l where bn decreases monotonically to zero. Prove that E:=l an converges absolutely. 12. *Show that if E�=l an is absolutely convergent, there exists an absolutely convergent series E�=l bn such that liIlln_oo anlbn = o. Explain why this result shows that there is no \"universal\" comparison series for testing absolute convergence. 7. 9 Uniform Convergence 263 13. Give an example of a divergent series whose partial sums are bounded. 14. *Show that L�=l l/an converges, where al, a2, ... is the Fibonac­ ci sequence 1, 1, 2, 3, 5, 8, 13, ... 7.3 Uniform Convergence 7.3.1 Uniform Limits and Continuity The results discussed in this section are valid for both sequences and se­ ries of functions. We will usually state the result for sequences {fn {x) } and leave as an exercise for the reader the formulation of the analogous result for series Lk:l gk, since this amounts to stating the sequence result for the partial sums fn = L�=l gk of the series. Let l1 (x}, f2 (x), ... be a sequence of real- or complex-valued func­ tions defined on a common domain D. We say the sequence converges to a function f{x) , written limn_oo fn(x) = f{x) , if for each Xo in the domain the sequence of numbers fn(xo} converges to the number f(xo} . This notion of convergence is sometimes called pointwise or simple con­ vergence in order to distinguish it from other notions of convergence we will have to consider. In fact, we will see that pointwise convergence is not always a very useful notion. Consider, for example, the infinite series L�=l xn. From our dis­ cussion of the geometric series we recognize that this is a pointwise con­ verging series of functions on the domain -1 < x < 1, and the limit is x/{l -x). However, we observed that the rate of convergence gets slow­ er as x approaches 1. Thus if we select an error 11m, we cannot say how many terms N we have to take to make L�=l xn differ from xl(l - x) by at most 11m without first specifying x. In other words, the order of quantifiers in the definition of pointwise convergence is universal­ existential (for every x there exists N) . If we want the existential­ universal form-which is a stronger condition-then we come up with a stronger notion of convergence, called uniform convergence: a se­ quence fn(x} of junctions on a common domain D is said to converge uniformly to a junction f (x) {equivalently, f (x) is said to be the uni­ form limit of fn{x)) if for every error 11m there exists N (depending on 11m) such that for all x in the domain D, Ifn(x} - f(x}1 < 11m if 264 Chapter 7 Sequences and Series of FUnctions n > N. The definition of uniform convergence of a series of functions is analogous. In particular, 2:�=1 xn does not converge uniformly on -1 < x < 1. On the other hand it does converge uniformly on a smaller domain -Xo < x < Xo for fixed Xo < 1. If a convergent sequence fails to converge uniformly, there may be serious consequences in that the limit function may fail to share prop­ erties with the approximating functions. For example, the pointwise limit of continuous functions may not be continuous! Let f n (x) be the function whose graph is shown in Figure 7.3.1 1 lin Figure 7.3. 1: so that fn(x) = 0 if x < 0, fn(x) = 1 if x > lin, and fn{x) is linear in between, f n (x) = nx if 0 < x < 1 In. Then clearly limn_oo f n (x) exists for every x. If x < 0, then fn{x) = 0 for every n, so the limit is zero; while if x > 0, then fn{x) = 1 once n > 1/x, so the limit is one. The limit function (shown in Figure 7.3.2) has a jump discontinuity at x = 0, but the functions f n (x) are all continuous. Of course the convergence is not uniform-the closer x is to zero the longer it takes for fn(x) to approach one. Since fn(1/2n) = 1/2 and f{1/2n) = 1, we can never make Ifn(x) - f{x) 1 < 1/2 for all x. We will see shortly that this must always be the case: a uniform limit of continuous functions is continuous. This example also shows that compactness of the domain will not suffice to turn convergence into uniform convergence. (It is important not to confuse uniform convergence with uniform continuity, where compactness of the domain does suffice!) The notion of uniform convergence can be rephrased in terms of 7. 9 Uniform Convergence 265 1-'------- Figure 7.3.2: the quantities sUPx{lfn(x) - f(x) I}, which can be thought of as a kind of \"distance\" between the functions f n and f (we will return to this interpretation in a later chapter) . We claim f n � f uniformly if and only if limn_co sUPx{lfn(x) - f{x) l} = O. Note that the limit here is the limit of a sequence of real numbers. Writing out the meaning of limn_co sUPx{lfn(x) - f{x)l} = 0 we have: given any error 11m there exists N such that n > N implies sUPx{lfn (x) - f{x)1} < 11m. Of course sUPx {lfn(x) - f(x)l} < 11m is the same as Ifn(x) - f(x)1 < 11m for every x, so we are back to the definition of uniform convergence. There is a Cauchy criterion for uniform convergence: Theorem 7.3. 1 (Cauchy criterion) A sequence of junctions f n (x) con­ verges uniformly to some limit junction if and only if given any error 11m there exists N such that k, n > N imply Ifn(x) - fk{X)1 < 11m for all x. Proof: It is easy to show that a uniformly convergent sequence satisfies the Cauchy criterion using the estimate We leave the details to the reader. Conversely, suppose the Cauchy criterion is satisfied. It follows that at each point x, the numerical sequence {fn (x)} satisfies the Cauchy criterion, hence it must converge to a limit. We then define f (x) to be 266 Chapter 7 Sequences and Series of Functions this limit. To complete the proof we need to show that the convergence of fn(x) to f(x) is uniform. To see this, we take the Cauchy criterion as stated and let one of the indices, say k, go to infinity. That is, given the error 11m, we find N such that k, n > N imply Ifn(x) - fk(X)1 < 11m for all x; then n > N implies Ifn(x) - f(x)1 < 11m for all x since non-strict inequalities are preserved in the limit. But this is exactly the statement of uniform convergence. QED We leave it as an exercise to formulate the Cauchy criterion for pointwise convergence. The next theorem makes precise the idea that uniform limits preserve continuity. Theorem 7.3.2 Let fn converge to f uniformly on the domain D. If all the fn are continuous at a point Xo in D, then f is also continuous at Xo . If all the f n are continuous on D, then f is continuous on D. If all the fn are uniformly continuous on D, then f is uniformly continuous on D. Proof: The idea of the proof is that since we can make f n (:x) close to f(x) for all points x, we can turn questions of continuity about f into questions of continuity about fn. More precisely, let an error 11m be given, and choose n large enough so that Ifn(x) - f(x)1 < 113m for all x. Then we can compare f(x) with f(y) by first comparing f(x) with fn(x), then comparing fn(x) with fn(Y), and finally comparing fn{Y) with f(y), using the triangle inequality, as shown in Figure 7.3.3: f I� f\" • • x y Figure 7.3.3: 7. 3 Uniform Convergence 267 I/(x) - f(Y) 1 < I/(x) - fn{x) 1 + Ifn(x) - In (Y) 1 + I/n{Y) - l(y) l· The first and third terms are at most 113m by the uniform closeness of I and In, so I/{x) - I(Y)I < 213m + I/n(x) - In(Y) 1 for all x and y. Note that we still have 113m to play around with when we want to make If(x) - l(y) 1 < 11m. The value of n and hence the function In is now fixed, but the choice of n did depend on the error 11m that we were given. Consider the continuity at the point Xo. After choosing n as above, we can then use the continuity of In to assert that there exists a neigh­ borhood Ix - xo l < lIN of Xo in which I/n(x) - fn(xo)1 < 113m. This will then make I/(x) - l(xo)1 < 213m + I/n(x) - In{xo)1 < 11m. This is the continuity of f at Xo. Notice that the order of choice is crucial: given 11m we first choose n, then based on the continuity of the particular f n we choose the neighborhood Ix - xo l < lIN. If we did not have uniform convergence we would not know that a single function In could make lin (x) - I (x) I small for all x. We would only know that for each x some In would do this, and we would be unable to use the continuity of In to carry out the proof. The continuity of f on D follows from the continuity of In on D because of the pointwise result. Finally suppose the In are uniformly continuous. Then given the error 11m we need to find lIN independent of the point so that Ix -yl < lIN implies If(x) - f(Y) 1 < 11m. Choosing n as before, we already have I/{x) - l{y) 1 < 2/3m+ l/n(x) -In{Y) I· By the uniform continuity of this In we can find lIN so that Ix-YI < lIN implies I/n(x) -In(y) 1 < 113m, and this lIN then does the trick. QED This theorem is a two-edged sword: on the one hand it shows the usefulness of uniform convergence; but on the other hand it shows that we frequently can expect �form convergence to fail. For example, when we consider Fourier series, we will want discontinuous functions to have Fourier series. But these cannot converge uniformly because the sines and cosines in the Fourier series are continuous functions, so the theorem says that uniformly convergent Fourier series can only represent continuous functions. 268 Chapter 7 Sequences and Series of Functions The theorem just proved is notorious because Cauchy got it wrong­ he claimed to prove that the limit of continuous functions is continuous. At least part of the reason why he went wrong was that he couched his proof in the language of infinitesmals. For an interesting discussion of this see the Appendix 1 to Proofs and refutations by Imre Lakatos, Cambridge University Press, 1976. Uniform convergence depends on the domain of the functions. Fre­ quently we encounter the situation of a sequence of functions fn(x} that converges pointwise but not uniformly on an open domain D, but the restrictions of f n to all compact subsets converge uniformly. In such a case we say that f n converges uniformly on compact sets. For example, ��=l xn converges uniformly on the domain Ixi < 1 - € for any € > O. 7.3.2 Integration and Differentiation of Limits Uniform convergence can also be used to establish integrability and dif­ ferentiability of limits of functions and the interchange of the operation and the limit. We begin with integration because it is simpler, and we will need it in the discussion of differentiation. Theorem 7.3.3 Let f n converge uniformly to f on a finite internal [a, b) . If all the fn are Riemann integrable on [a, b], then so is f and lim J.b fn(x} dx = J.b f(x} dx n-oo a a (or more generally we can interchange the limit and integral over any subinterval) . Proof: The idea of the proof is that if Ifn(x) - f{x)1 < 11m, then the Cauchy sums S(f, P} and S(fn, P} evaluated at the same points can differ by at most (b - a}/m. Thus suppose the error 11m is given. We want to show that the Cauchy sums S(f, P) can be made to differ from each other by at most 11m by making P sufficiently fine, since this will prove the integrability of f. Thus choose n large enough (say n > N) so that Ifn(x) - f(x)1 < 1/3m{b - a}. Then IS(fn,P} - S(f, P}1 IE(fn(Yj} - f(Yj))(Xj+l - Xj)! < Elfn(Yj) - f(Yj)l(xj+l - Xj) 1 1 < 3m(b - a) E(Xj+l - Xj) = 3m 7. 3 Unilorm Convergence 269 for any partition P, where Yj denotes an arbitrary point in the subinter­ val [Xj, Xj+l) that is the same for both Cauchy sums (we could also get the same estimate comparing Riemann upper and lower sums). Thus if P' is any other partition, 18(/, P) - 8(1, pI)1 < 18(/, P) - 8(/n, P)I +18(/n, P) - 8(/n, pI)1 +18(/n, pi) - 5(/, pI)1 2 < 3m + 15(/n, P) - 5{/n, pI)l· Now that n is fixed, we know from the integrability of In that 5{/n, P) converges to J: In(x) dz as the maximum interval length of the parti­ tion goes to zero. Therefore by taking the maximum interval length for P and 1\" sufficiently small we can make 15{/n, P) - 5(ln, PI) I < 113m, hence 15{/, P) - 8{/, 1\")1 < 11m. This proves the integrability of /. Finally we need to show that liIIln_oo J: In (X) dx exists and equals J: /(x) dx. From the integrability of / we know 15(/, P) -J: I(x) dxl < 113m if the partition P is sufficiently fine. If we choose n as before, then 15(/n, P) - 5(/, P) I < 113m, so 18{/n, P) - J: I(x) dzl < 213m. Note that for this to hold we only have to choose n large enough (n > N) so that I/n{x) - /(x)1 < 1/3m{b - a) and the partition P sufficiently fine. These conditions on n and P depend on 11m but are independent of each other. Now for any fixed n > N, we can also require that the partition P be sufficiently fine so that 15(/n, P) - J: In{x) dzl < 113m. Here the partition P does depend on n, but when we combine this with the previous estimate 15{/n, P) - f: /(x) dxl < 213m we obtain simply I J: /n(x) dx-f: /(x) dxl < 11m, so the partition P used for making the comparison drops out of the picture. Since this holds for every n > N, with N depending on 11m, we have the result liIIln_oo f: In(x) dx = J: I (x) dx as desired. QED There are a few subtle points about the above proof that are worth observing. First note that in the proof that / is integrable we did not use the full strength of the uniform limit-we only needed 1 In (x) - I(x)l < 11m for one particular value of n for each 11m. For the proof of the limit and integral interchange we did need to use this estimate holding for all n > N. Here we had to introduce a partition P to 270 Chapter 7 Sequences and Series of Functions make the comparisons S(/, P) to f: I(x) dx, S(ln, P) to S(j, P), and S(ln, Pi to i: In(x) dx. The particular partition was restrIcted by the maximum length of subintervals in two ways, once depending on I and once depending on In. It is not true that one particular partition P can work for all n > N. Nevertheless, we still obtained the estimate t fn(x) dx - t f(x) dx < ! that we sought for all n > N. This theorem may seem perfectly reasonable, but it turns out not to be as useful as one might like because there are many examples of non-uniform limits of functions (expecially in Fourier series) where one wants to interchange the limit and integral. Here is a particularly vex­ ing example. Let rl , r2, ... be an enumeration of the rational numbers in the interval [0, 1], and let In be defined on [0, 1] by In(x) = 1 if x = rl , r2 ,\" \" rn and by In(x) = 0 otherwise. Clearly In(x) is con­ verging pointwise (but not uniformly) to Dirichlet's function I (x) = 1 if x is rational and I(x) = 0 if x is irrational. Now each In is zero except on a finite set of points, so In is integrable and J� In(x) dx = O. Thus limn_oo f� In(x) dx exists and equals zero, so we would expect fo l I (x) dx = O. But I (x) is not integrable and fo l I (x) dx is not defined. It is exactly this kind of failure of the Riemann integral to behave prop­ erly in limits that are not uniform that will m0tivat€ us to study a more general notion of integration-the Lebesgue theory-in a later chapter. Next we consider the problem of interchanging limits and deriva­ tives. First we note that the limit of differentiable functions need not be differentiable, even if the limit is uniform. The reason for this is that the uniform closeness of two functions, lin (x) - I (x) I < 1/ m, does not imply anything about the relative smoothness of the graphs. The function I(x) can be perfectly smooth, say I(x) = 0, while In(x) can have lots of bumps and wiggles, as in Figure 7.3.4. Perhaps the sim­ plest example is the approximation of f(x) = Ixl by smooth functions obtained by rounding out the corner, as shown in Figure 7.3.5. To get a positive result we need to assume the uniform convergence of the derivatives. 7.9 Uniform Convergence 271 e,.A. Figure 7.3.4: Figure 7.3.5: Theorem 7.3.4 Let fn be defined on (a, b) and be Cl . If fn{x) -+ f{x) pointwise and f� converges uniformly to g{x), then f is Cl and f' = g. Proof: A direct approach to the proof will not work, since there is no obvious way to estimate the difference of the difference quotients for f and In, f{x + h) - f{x) h for all small h. We therefore seek an indirect method via the funda­ mental theorem of the calculus. This is frequently a good method for gaining information about derivatives. 272 Chapter 7 Sequences and Series of Functions We fix a point Xo in the interval and write the integration of the �\"' ... :.�+; .. �n I'\" ... ...vto ... l..\" ...... ..... __ . ..... _. - .. _ .. .. - In{x} = fn{xo} + LX f�{t} dt, Xo which holds because In is cl. We now take the limit as n -+ 00, to obtain f{x} = I{xo} + 1:0 g(t} dt, where we have used the previous the­ orem to obtain the limit of the integral. Since we know 9 is continuous (it is the uniform limit of continuous functions), the differentiation of the integral theorem tells us that f is C1 and I' {x} = g{ x} (the term I {xo) is just a constant whose derivative is zero} . QED There are a number of ways to improve this result . It suffices to have I� converge uniformly on every subinterval (a + 1/ m, b - 1/ m ) because then we can apply the argument on each subinterval and the conclusion I' = 9 then holds on (a, b). It suffices to assume In (x) con­ verges at just one point x = Xo, for then In(x} = In(xo} + J:o I�(t} dt implies fn(x} converges at every point since the right side converges. In fact, the convergence is uniform if the interval is bounded. We can­ not , however, conclude that /n(x) converges merely from the uniform convergence of f�{x}, as the example fn{x) = n shows. Also, the point­ wise convergence of I� and In will not guarantee the differentiability of I. For a counterexample we need only integrate the functions in the example of a. discontinuous limit of continuous funrtion� It is also possible to show that the theorem is valid for differentia­ bility in place of continuous differentiability. But the proof is trickier (using the mean value theorem in place of the fundamental theorem), and the result is not as useful. 7.3.3 Unrestricted Convergence* We conclude this section with another way of looking at uniform con­ vergence, at least for sequences of continuous functions on a compact interval. Since we are dealing with sequences of functions, it makes sense to vary the point as well as the function and to ask if In{xn} converges to I(x} whenever Xn converges to x. Theorem 7.3.5 Let In{x) be a sequence 01 continuous functions on a compact domain D. Then In(xn} converges to I(x) lor all sequences 7. 9 Uniform Convergence 273 Xn I\" D convergel�t to x (Jvr all x in D) iJ and onl:l 'I,j fn coaverges .,\"'.�\"-\"'., &\" I . . . Proof: Suppose first fn -+ f uniformly and Xn � x in D {this half of the proof does not require the compactness of D}. We need to compare fn(xn} with f(x}. Following the method of proof used in Theorem 7.3.2, there are two intermediate values, fn(x} and f(xn}, that we might consider in making the comparison, or The trouble with the first estimate is that we would need to invoke the continuity of fn to estimate Ifn(xn} - fn(x}l, and this would require making IXn - xl small depending on fn. Since we cannot vary the n separately for Xn and fn, we would be in trouble. Thus we work with the second inequality. Here we need to use the uniform convergence to estimate Ifn{xn} - f(xn}1 and the continuity of f to estimate If{xn}- f(x} l. Giv­ en any error 11m we first use the uniform convergence to find N such that n > N implies Ifn{Y} - f{y)! < 112m for any y and, hence, in par­ ticular for y = Xn. Thus Ifn{xn} - f{xn}1 < 112m for all n > N. Next by t!:: con::�uity :;� I, a consc;uencc :of t:\":� fact +h�t f !: �he unj�N'm limit of continuous functions, there exists 11k such that Iy - xl < 11k implies If(y} - f(x)1 < 112m (here x is fixed and y is variable) . In particular setting y = Xn we have IXn - xl < 11k implies !f{xn} - f{x}1 < 112m. Summing the two estimates we obtain Ifn(xn} - f(x}1 < 11m, the es­ timate we want , under the two conditions n > N and IXn - xl < 11k. But since Xn � x by assumption, we can make IXn - xl � 11k by taking n large enough {say n > N'}, so the conclusion Ifn{xn} - f{x}1 < 11m follows by taking n larger than both N and .. \"'TI. This is the st ;:..tement limn_ oo fn{xn} = f{x}. Conversely, assume fn(xn} -+ f(x} if Xn -+ x. To show fn con­ verges uniformly to f we consider the sets Am,N = {x in D such that Ifn(x} - f{x}1 < 11m for all n > N}. The condition for uniform con­ vergence that we want to prove is that for all m there exists N such that Am.N = D. Ordinary pointwise convergence would say that for 274 Chapter 7 Sequences and Series of Functions all x and all m there exists N such that x is in Am,N . But we are assuming more than pointwise convergence, and we claim the following stronger conclusion: for each x in D and every m, there exists N such that Am,N contains a neighborhood of x. We prove this claim by contradiction. If it were not true, then there would exist a fixed x and m and a sequence of points {x N} converging to x such that each XN is not in Am,N . But XN not in Am,N means there exists k(N) > N such that Ifk(N)(XN) - f(x)1 > 11m. By inserting some terms equal to x into the sequence {xn} we can obtain a new sequence {Yk } converging to x such that Ifk(Yk) - f(x)1 > 11m for infinitely many k. Specifically, we take Yk = x N if k = k (N), choosing the smallest N if there is more than one choice and Yk = x otherwise. But this contradicts the hypothesis limk_oo fk (Yk) = f(x) , proving the claim. To complete the proof we apply the Heine-Borel theorem. Fix m. For each x in D there exists N and a neighborhood (x - lin, x + lin) of x contained in Am,N . This set of neighborhoods is an open cover of D, which is compact, so there exists a finite subcover. Thus D is a finite union of sets of the form Am,N for m fixed. But the sets Am.N increase with N, so the finite union is just Am.N for the largest value of N. Since D = Am,N for some N holds for every m, we have proved uniform convergence. QED 7.3.4 Exercises 1. State and prove a Cauchy criterion for pointwise convergence. 2. Suppose f n -t f and the functions f n all satisfy the Lipschitz condition Ifn (x) - fn (Y) 1 < Mix - yl for some constant M in­ dependent of n. Prove that f also satisfies the same Lipschitz condition. 3. Give an example of a sequence of continous functions on a compact domain converging pointwise but not uniformly to a continuous function. 4. Prove that a sequence of complex-valued functions converges u­ niformly if and only if the sequences of real and imaginary parts converge uniformly. 7. 3 Unilorm Convergence 275 5. If limn_oo In = I and the functions In are all monotone increas­ ing, must I be monotone inc!,�3Sing? '�'h:.t h�ppen3 if In :!l''' �l strictly increasing? 6. Give an example of a sequence of continuous functions converging pointwise to a function with a discontinuity of the second kind. 7. If I/n{x} 1 < an for all x and 2:::1 an converges, prove that 2:�=1 In {x ) converges uniformly. 8. Give an example of a sequence of continuous functions on a non­ compact domain D that does not converge uniformly, yet liIDn_oo In{xn} = I{x} for every sequence {xn} converging to x in D. 9. If In -T I uniformly and limx_xo In (x) exists for every n, then limx_xo I (x) exists and equals limn_oo limx_xo In (x) (note: we are not assuming continuity of In or I). 10. If In -T I uniformly and the functions In have only jump discon­ tinuities, prove that I has only jump discontinuities. 11. *Give an example of a sequence of continuous functions f n on [0, 1] that converge pointwise to zero but such that limn_oo fol In {x} dx is not zero. 12. If In -T I uniformly on [a, b), prove that Fn -T F uniformly on [a, b] where Fn{x) = J: In{t) dt. Is the same true on the whole line? 13. Define a step function to be a function that is piecewise constant, I{x) = 2:7=1 CjX[aj,bj) where [aj,bj) are disjoint intervals. (X denotes the characteristic function of the interval.) a. Prove that every continuous function on a compact interval is a uniform limit of step functions. b. Prove that a uniform limit of step functions (on a compact interval) is Riemann integrable. 14. Define a linear spline to be a continuous function on a compact interval that is piecewise linear {equal to an affine function on each 276 Chapter 7 Sequences and Series of Functions subinterval in a finite partition) . Prove that every continuous function (on a compact interval) is the uniform limit of linear splines. 7.4 Power Series 7.4.1 The Radius of Convergence An important class of infinite series of functions is the class of power series L�=o an{x - xo)n where Xo is fixed (we refer to Xo as the point about which the power series is expanded) and an are real (or complex) coefficients. By definition (x - xo)o = 1, so the first term is merely the constant function ao. Note that the partial sums of the power series are polynomials; L�=o an(x - xo)n is a polynomial of degree N. In many ways power series can be thought of as polynomials of infinite order. In fact, the theory of power series was developed dwing the eighteenth century in just such a spirit, with an unfortunate disregard for the question of convergence. We are in a position now to develop the basic properties of power series with complete rigor. Before beginning it is only fair to warn you that power series are very atypical of series of functions in general, so you should not expect the insights derived from the study of power series to extend to other classes of series. This will be especially important in a later chapter when we discuss Fourier . serIes. In discussing power series it is good to recall a nursery rhyme: \"There was a little girl Who had a little curl Right in the middle of her forehead When she was good She was very, very good But when she was bad she was horrid.\" The first question we need to answer is the question of convergence: given a specific power series L�=o an (x - xo) n , that is, given Xo and ao, aI , a2, . .. , for which values of x does it converge? Note that the answer depends only on x - Xo, so if we can answer the question for Xo = 0 we 7.4 Power Series 277 can answer the question in general. In what follows we will frequently deal with the c�c Xo = 0 only, in order to simplify notaticr.. The convergence of �::o anxn at a point x depends on the coeffi­ cients an. We can always arrange for anxn to be unbounded (if x =F 0), and in fact by taking an = n! we can make anxn unbounded for every x =F 0, so the power series need not converge except at x = O. How­ ever, if the power series does converge at some point x =F 0, this has implications about convergence at other points. The idea is extremely simple. If L�=o anxn converges at some point x = x I, then the terms anxi must certainly be bounded. So there must exist a constant M such that lanxi l < M for all n. We are not saying that this condi­ tion is sufficient for the convergence; only that it is necessary. But it turns out to be sufficient for the convergence of the series for any x with Ixl < IX II. In fact, if we rewrite the condition as lan l < Mlxd-n, then we have lanxn l < Mlx/xl ln and so ��=o anxn converges by com­ parison with L::o Mrn for r = IX/XI I < 1 if Ixi < IXI I. In fact the convergence is absolute, and it is uniform in any interval Ixl < R for fixed R < lXI I, because we can compare with L�=o M (R/lxl lt for all x, lxl < R. This implies that the power series represents a continuous function on Ixi < IXI I since it is the uniform limit on compact subsets of the partial sums, which are continuous because they are polynomials. We will see shortly that the behavior of power series is much better than continuous. 'T'\\\"�� �1·m-1A A \\.. �A-...\" tl·on lead'\" :mmedl· ... tcl�. �o the dA�_:�: �- \"\"c �\\..e .&. �., pn .. v .... .,,,.L Wu. ., .l (A. �J \" �.I..i. .lU \".lVU vI. \" ...... radius of convergence of the power series ��=o anxn as the unique number R such that the series converges for Ix I < R and diverges for Ixi > R. We allow R = +00 if the series converges for all X and R = 0 if the series converges only for X = O. If the series diverges for some value of x, then R = sup{ x : series converges}. At the values x = ±R the series may either converge or diverge. However, if Ixi > R, then the series must diverge; in fact, the terms must be unbounded­ otherwise by our observation we would have convergence for all values in (-lxi, lxI), contradicting the definition of R. Thus the region Ixl < R is where the series is very, very good, and the region Ix I > R is where it is horrid. Again we must emphasize that this property is special to power serIes. Here are some simple examples that illustrate the variety of behav­ iors of power series at the radius of convergence. The geometric series 278 Chapter 7 Sequences and Series of Functions L�o xn converges for Ixl < 1 and diverges for Ixl > 1, so the radius of convergence is 1. At x = ±1 the terms (±1)n are bounded but the series diverges. The series L:=o nxn also has radius of convergence 1 but the terms are unbounded at x = ±1. The series L�=1 (1/n)xn has radius of convergence 1, and at x = 1 it diverges while at x = -1 it converges, since L::1 (_I)n /n converges, although not absolutely. Finally the series L:=1 (l/n2)xn converges at both endpoints x = ±1. We will verify the computations of the radius of convergence for these series after the next theorem. The root test for convergence gives a formula for the radius of con­ vergence. Theorem 7.4. 1 The radius of convergence R of a power senes L:=o anxn is given by 1/R = lim suPn_oo v'lanl · Proof: First we will establish the inequality lim suPn_oo lan l1/n < 1/ R. If R = 0 there is nothing to prove. If R > 0, choose any r < R. Then the terms anxn are bounded for x = r, lanrnl < M. This means lan l1/n < M1/n /Irl and so lim sup lan l 1/n < (1/lrl) lim sup M1/n = 1/lr l n-oo n-oo since limn_oo M1/n = 1 for any M > 0 (we will give a proof of this as a separate lemma below). This shows lim sUPn_oo lan l1/n < 1/lrl for any value of r with Irl < R, so lim sUPn_oo lanj I/n < 1/ R. For the reverse inequality write lim sUPn_oo lan l1/n = 1/ Ro (al­ lowing Ro = 0 or (0) . We need to show that L�=o anrn converges if Irl < Ro, for that will imply R > Ro. Now for any fixed r with Irl < Ro we can find R1 satisfying Ir l < R1 < Ro (if Ro = 0 there is nothing to prove) . Then lim sUPn_oo lanl1/n < 1/ Rl so that for k large enough, lan l1/n < 1/ R1 for all n > k (this is a consequence of the definition lim suPn_oo lan l1/n = limk_oo SUPn>k lanI1/n). This means lanl < 1/ Ri and, hence, lanrnl < Ir / R1 1n for all n > k, which proves the convergence of L anrn by comparison with the geometric series since Ir / R1 1 < 1. One can also prove the convergence of L anrn by appealing directly to the root test-the above argument essentially incorporates the reasoning used to derive the root test. QED Lemma 7.4.1 liIIln-oo M1/n = 1 for any M > O. 7.4 Power Series 279 Proof: It suffices to do this for M > 1 since liDln_oo {l/M)I/n = {limn_oo MI/n)-l. One can give a quick proof using logarithms but since we have not discussed the properties of logarithms, we will give a longer proof using the binomial theorem. We use the identity All the terms are positive, so we have hence 1 ( n ) lin 1 + ;;; > 1+ ;;; since the function f(x) = xn preserves the order relation. Now if we fix M > 1, then given any error 11m we can find k such that M < 1 + kim, so M < 1 + nlm for all n > k. Altogether MI/n < (1 + nlm)l/n < 1 + 11m; and since the inequality 1 < MI/n is an immediate consequence of M > 1, we have IMI/n - 11 < 11m for all n > k, proving liDln-oo MI/n = 1. QED N ext we look at some examples. In these, as is usually the case, the limit of lanll/n will exist, so it is not necessary to invoke the limsup. First consider the case when the coefficients an are given by a rational function of n, an = p(n)lq(n) where p and q are polynomials (perhaps modified at the finite number of zeroes of q) . We claim the radius of convergence is 1. To see this it suffices to show limn_oo Ip{n) II/n = 1 for any non-zero polynomial. In the lemma we have already established this for p( n) = M, the constant polynomials. Since it is easy to show Monk < Ip(n) l < Mnk for all large n and some values of Mo, M and k (depending on the polynomial), it suffices to show liffin-oo n1/n = l. Then limn_oo(Mnk)l/n = (limn_oo Ml/n}(liIIln_oo nl/n)k = 1 by the properties of limits (f{x) = xk is continuous, so we can interchange it with the limit). Finally we establish 1i1lln_oo nl/n = 1 without loga­ rithms using the binomial theorem. Since {1 + 1/m)n = 1 + nlm + .. . + (l/m)n, we have nlm < (l+ l/m)n, so nl/n < ml/n{1 + 1/m). Keeping m fixed and letting n -+ 00 we obtain lim suPn_oo nl/n < (1 + 11m) 280 Chapter 7 Sequences and Series of Functions since we already have shown liffin_oo m lin = 1. Since this is true for any value of m, lim sUPn_oo n lin < 1 and the obvious inequality nl/n > 1 implies limn_oo nl/n = 1. To get an example of a power series with radius of convergence +00 or 0 we must do something more dramatic (to get a finite posi­ tive value for R we can merely take L R-nxn). The most important example is the exponential power series L�o l/n!xn. To see this has radius of convergence +00 we need to show limn_oo l/(n!)l/n = 0 or, equivalently, limn_oo{n!)l/n = +00. This will also show that the series E�=o n!xn has radius of convergence O. Now limn_oo{n!)l/n = +00 is plausible because n! = 1 · 2 · .. n, a product of n factors, so that (n!)l/n is a kind of average (the geometric average) of the numbers from 1 to n, and this average should not remain bounded as n � 00. In fact, for any fixed m, once n > m we can estimate n! > m(n-m) simply by ignoring the first m factors and noting that the last n - m factors, m+ 1, m.+2, ... , n, are all greater than m. Thus (n!)l/n > m1-m/n and so liminfn_oo{n!)l/n > mliffin_oo{m-m)l/n = m by our previous re­ sult limn_oo Ml/n = 1. Since m is arbitrary, we have limn_oo{n!)l/n = +00. Next we discuss differentiability of power series, which is based on the fact that in the interior of the interval of convergence the power series converges very rapidly. This will allow us to differentiate the series term-by-term. It is easy to verify that, on a formal level, the power series E�o anxn has derivative 00 00 L nanxn-l = L(n + l)an+lXn. n=O n=O We can also verify that the derived power series E(n + 1)an+lXn has the same radius of convergence as the original power series. Note that lim sup I(n + 1)an+d1/n = lim (n + l)l/n lim sup lanI1/(n-l). n-oo n-oo n-oo But limn_oo{n + 1)1/n = 1 by the arguments already given, while lim suPn_oo lanI1/(n-l) = limsuPn_oo lanl1/n (because lanI1/(n-l) = (lanI1/n)n/(n-l) and n/{n - 1) � 1 as n � 00). One can also de­ rive directly that the boundedness of the terms anxn for fixed x = r implies the convergence of E nanxn-1 for Ix I < r because the geometric decrease of Ix/rln swamps the growth of the factor n. 7.4 Power Series 281 Theorem 7.4.2 Let I: anxn have radius of convergence R with R =F O. Then the function f(x) = E anxn is CI on ( -R, R) and f'(x) = I: nanxn-1 there. In fact f(x) is COO on (-R, R) , and the derivative f(k) of order k is given by the power series formally differentiated k times. Proof: We apply Theorem 7.3.4 on differentiating infinite sequences of functions. The individual terms anxn are all differentiable, so we need to show the convergence of I: anxn and the uniform convergence of L nanxn-1• But we have already shown that a power series with radius of convergence R converges uniformly on any smaller interval and that the power series I: nanxn-1 has radius of convergence R also. Thus we obtain f'(x) = E nanxn-1 on any smaller interval and, hence, on (-R, R) . The results for f(k) then follows by induction. QED This result is a two-edged sword. It shows that power series are really terrific-you can differentiate them term-by-term in the interior of the interval of convergence; but it also shows that only very special kinds of functions can be represented by power series-any such func­ tion must be Coo. In the next chapter we will even give examples of Coo functions that do not have power-series expansions. We can now relate the coefficients of a convergent power series with the Taylor expansions of the function equal to the sum, f (x) = E:=o Clnxn. By differentiating n times and setting x = 0 we obtain j(n) (O) = n!an (by convention O! = 1). In other words, the partial sums of the power series are the Taylor expansions of the function. From this we also obtain the uniqueness of the power series. If E anxn and I: bnxn converge in Ix I < r to the same function j, then an = bn = 1/n!f<n) (0), so they are identical series. Notice that the same thing holds for power series about an arbitrary point Xo. If E an(x - xo)n converges to f(x) in Ix-xol < r, then an = 1/n!j(n)(xo); so if I: an(x­ xo)n = E bn(x-xo)n in Ix-xol < r, then an = bn for all n. However, we can have equality between different power series about different points. As we will see in the next section, this is a rather important idea. 7.4.2 Analytic Continuation Suppose I: anxn converges to f(x) in Ixl < R (we have expanded about x = 0 for simplicity). Now for any fixed Xo in Ixol < R, we might hope 282 Chapter 7 Sequences and Series of Functions to find a power series Ebn(x - xo)n converging to J(x) in Ix - xol < r where r = R - Ixol (see Figure 7.4.1). In fact this is always possible, as we will now see. We know in fact that if there is such a series, it must be given by bn = 1/n!f(n)(xo), but surprisingly this remark does not help in establishing the convergence of L bn(x - xo)n to f. We therefore take a different approach, which is more direct . .. ( ( • • ) -R o R Figure 7.4.1: We observe that if the series were finite (so f would be a polynomial), we could simply write x = (x - xo) + Xo and xn = «x - xo) + xor = t ( � ) (x - xO)kxo-k k=O and substitute this into f(x) = L�=o anxn to obtain /(x) = � a,. � ( � ) (x - xO)kxO-k, and by regrouping and rearranging terms, f(x) = 2:�=o bk{X - xo)k where bk = L�=k Cln n!) xo-k. This is just algebra. But it suggests that for the infinite series f{x) = L�=o anxn we should have f{x) = 2:�o bk(X - xo)k with bk = f:: an ( � ) xo-k = f:: an+k ( n � k ) xo. n=k n=O Notice that the expression we have guessed for the coefficient bk is itself a power series in Xo that converges also in Ixol < R (if 2: anxn converges in Ixl < R) because the factor ( n + k ) k ={n+k)·(n + k-l) .. · (n + 1)/k! 7.4 Power Series 283 is a polynomial in n for k fixed, so limn_oo(ntk)l/n = 1 for each k. Thus the reafTangement (note that we are using this term in a somewhat d­ ifferent sense than in section 7.2.3) 2: bk(X - xO)k of 2: anxn where bk = E::o an+k(ntk)xo is well defined for any Xo in (-R, R) . Inciden­ tally, the formula for bk agrees with the previously derived f(k)(xo)/k! as can be seen by differentiating f(x) = 2: anxn k times and setting x = Xo. It remains to show that E bk(X - xo)k actually converges to f(x), at least for Ix - xol < R - Ixol. To see this we want to invoke the unconditional nature of an absolutely convergent series, namely the . expressIOn f: t an ( � ) (x - xO)kxO-k n=Ok=O (this is an infinite series, but it is not indexed by n; rather it is indexed by the pairs (n, k) with k < n in lexicographic order). If we put in abso­ lute values for each term an (I:) (x - xo)kxo-k we obtain the expression E:=o E�=o lanl (I:) Ix - xolklxoln-k, since the binomial coefficients are positive. We can next evaluate the k-sum t ( � ) Ix - xolklxolk = (Ix - xol + Ixol)n = rn k=O where r = Ix - xol + Ixol satisfies r < R by the conditions we have assumed for x and Xo. Thus f: t lanl ( � ) Ix - xolklxoln-k = f: lanlrn, n=Ok=O n=O which converges because the power series is absolutely convergent in (-R, R) . Thus we are dealing with an absolutely convergent series. If we take the given order and sum on k first we obtain ft a\" ( � ) (x - xO)kxO-k = f a\"xn = I(x). n=Ok=O n=O On the other hand, if we rearrange the series, summing first on n with k fixed, we obtain ��a\" ( � ) (x - xO)kxO-k = � (�an ( � ) XO-k) (x - XO)k 284 Chapter 7 Sequences and Series of FUnctions 00 - E bk {X - XO)k, k=O so f{x) = L:�o bk {X - xO )k in Ix -Xo I < R -Ixol. We have thus proved the following theorem. Theorem 7.4.3 If L: an{x - xI )n is a convergent power series in Ix - xli < R converging to the function f, then f also has a power­ series expansion about each point X2 of the interval Ix - xli < R, which converges at least in the largest symmetric interval Ix - x21 < r lying entirely in the original interval Ix - xli < R. Notice that the theorem does not preclude the convergence of the new power series in a larger interval. For example, L�=o xn = 1/{I-x) converges in Ix l < 1. If we fix a point Xo in this interval, we can compute the poYtt:r-series expan::;lOn 2:n'�o bn{x - xo)n by bn = f(7, \\xo)/ n! or more directly as 1 1 1 1 1 - x 1 - Xo - (x - xo) 1 - Xo 1 - (x - xo)/(1 - xo) 1! Xo f (� = ::) \" = f(1 - xO)-\"-I(X - xo)\", n=O n=O provided I{x - xo)/{l - xo) \\ < 1 using a power-series expansion about O. Notice that we have a power-series expansion for 1/{1-x) convergent in the interval /x -Xo / < /1 -Xo /. If 0 < Xo < 1 this is the same interval predicted by the theorem, but for -1 < Xo < 0 it is a larger interval. 4' - -. - ---- ----- Ix - xol < 1 1 - .to I ( -- _. _, - - -- -- - ----- -1 + 2xo -1 Xo Figure, 7.4. 2: o - ,_. --) 1 In fact, this computation gives the power series of 1/ (1 - x) about any point Xo except 1. 7.4 Power Series 285 Functions that have power-series expansions about all points in their domain are called analytic functions. The theorem shows that functions defined by power series about one point are analytic-they have convergent power series about the other points in their domain. Analytic functions have remarkable properties-the values of the func­ tion on any small interval determine the values of the function on any larger interval. This is just a consequence of the uniqueness of power series and the formula If we know f(x) for Ix - xol < €, then we can compute f(n)(xo) for all n and so obtain the values of f(x) on the interval of convergence from ��=o an(x - xo)n. This in turn allows us to compute f(n) (xI) for any point x I in the interval of convergence, hence we can obtain the power series for f about other points. This process of passing from power series to power series about new points is called analytic continuation. We leave as an exercise the proof that if ! is defined in (a, b) and analytic, then we can obtain the value of !(XI) for any Xl in (a, b) by analytic continuation from the power series f(x) = � an(x-xo)n about any point Xo in (a, b) in a finite number of steps. Note that analytic continuation of the power series L�=o xn leads to the analytic function 1/(1 - x) on the domain (-00, 1). However, analytic continuation will not enable us to extend 1/(1 - x) past the singularity at x = 1 to the region (1, 00). To do this, we need to move into the complex plane. This will be discussed briefly in the next section. Most important functions in mathematics are analytic-at least if the domain is suitably restricted. Polynomials are the simplest exam­ ples, having power series with a finite number of non-zero terms. All the special functi�ns-sine, cosine, exponential, and logarithm, and more exotic functions such as Bessel functions, hypergeometric functions, and so on, are analytic; indeed they are often defined by power-series. As we will see, the class of analytic functions is closed under arithmetic operations and compositions-so that any function for which you can write a formula is analytic (again with the domain suitably restricted) . This means that power-series expansions should be extremely useful. However, it would be a mistake to think that only analytic functions are 286 Chapter 7 Sequences and Series of Functions of interest. Many functions that are supposed to represent physical da­ ta from the real world are not analytic. Also, the procedure of analytic continuation is computationally unstable, involving high derivatives of the function that cannot be effectively controlled. 7.4.3 Analytic Functions on Complex Domains· To understand the behavior of a power series, even if we are only interested in a real domain, requires that we consider its behavior in a complex domain. IT f{x) is a real- or complex-valued function of a real variable x, defined on some domain in R, it is not a pri­ ori clear what we should mean by J{z), where z varies in C. Of course for some special functions we have a good candidate. IT J is a polynomial, J{x) = E�=o anxn, then we simply take for granted that J(z) = E�=o anzn. This is not the unique possible choice-if J(x) = 0 we could consider F(x + iy) = y, which also extends the original function in that F(z) = J{z) if z = x is real. However, we are certainly justified in claiming that the first choice is somehow most natural. Now it turns out that we can do the same thing for power series. IT E�o anxn = f(x) converges on the interval Ix l < R, then E�o anzn = J(z) also converges in the circle Ixl < R (this explains why R is referred to as the radius of convergence). In fact the identi­ cal argument for the absolute convergence of the power series for real x proves also the absolute convergence for complex z. Thus analytic functions possess natural extensions to domains in C. For example, 1/(1 - x) = E�=o xn for Ixl < 1, and also E�=o zn = 1/(1 - z) for Izi < 1. Clearly J(z) = 1/(1 - z) is the most natural candidate for the extension of J(x) = 1/(1 - x) to complex numbers-although you might be hard pressed to explain why without the use of power series. By using analytic continuation in C we can get around the obstacle at z = 0 that we could not get past in It However, analytic continuation in C leads to other types of complications that can't be discussed here. The theory of analytic functions of a complex variable is beyond the scope of this book-it requires a book of its own. I will give one example that hints at some of the ways the theory of analytic functions of a complex variable can shed light on questions that only involve real numbers. If we are told that the function 1/( 1 - x) has a power-series expansion about x = 0, we can guess immediately that the power series 7. 4 Power Series 287 could converge at most for Ixl < 1 because the function 1/(1 - x) has a singularity at x = 1. We might be led to guess, then, that a power series 2: anxn = f(x) should converge on the largest interval Ixl < R for which the function f (x) has no singularities (never mind exactly what singularity means-just interpret it as any \"irregular\" behavior). Put another way, if 2: anxn = f(x) converges in Ixl < R, then f is analytic in Ixl < Rj we can ask, conversely, if f being analytic in Ixl < R (remember this means it has a power-series expansion about each point in Ixl < R) implies that the power series about 0 converges in Ixl < R? The answer turns out to be no. The function f (x) = 1/( 1 + x2) is analytic on the whole real line. At any point Xo we can compute its power series from f(x) = 1 1 1 + x2 - 1 + «x - xo) + xO)2 1 1 + x5 + 2xo(x - xo) + (x - xO)2 1 1 1 + x5 1 - (-2xo(x - xo) - (x - xo)2)/(1 + x5) 1 f: (-2xo(X - xo) - (x - Xo)2)n 1 + x5 n=O 1 + x5 with absolute convergence if 12xo(x - xo) + (x - xo)21 < 1 + x5. Now if Ix - xol < r for r sufficiently small we have 2xolx - xol and (x - xo)2 each < (1 + x�)/2, so we not only have the absolute convergence of the above series (this is not quite a power series) but after substituting the binomial expansion (-2XO(X-XO)-(X-XO)2)n = (-it t ( � ) (2xo(x-xo))n-k(x-xo)2k k=O we still have the absolute convergence of because taking absolute values of (-1)n (�) (2xo(x - xo))n-k(x - xO)2k 288 leads to Chapter 7 Sequences and Series of Functions t I(-it ( � ) (2xo(x - XO)t-k(X - XO)2kl k=O = (12xo(x - xo)1 + Ix - xol2t , which is < (1 + xij)n. Since we have an absolutely convergent series, we can rearrange it according to the powers of (x - xo) and so obtain the convergent power series of f(x) = 1/(1 + x2) about x = Xo. The computation for general Xo is quite messy, but for Xo = 0 it is sim­ ply 1/(1 + x2) = ��=o( _1)nx2n. From this we see that the radius of convergence is exactly 1. This, despite the fact that the function 1/(1 + x2) does nothing unusual at x = ±1, destroys our conjecture. Nevertheless, if we look at the function 1/(1 + x2) of a complex variable, we see immediately what is happening. We still have 00 E( _1)nz2n = 1/(1 + z2) for Iz i < 1, n=O but now there are singularities at z = +i and z = -i (because 1/(1 + i2) = 1/(1 - 1) = 1/0, which is undefined). The presence of those singularities explains why the real power series cannot converge in any interval Ixl < R for R > 1. If it did, the complex power series would converge in Izi < R and the function would be defined at z = +i and z = -i. In fact one can prove-although we will not do so here­ that the radius of convergence of a power series � an (x - xo)n = f(x) is exactly equal to the distance from Xo to the first complex singularity of f(z) = � an(z - xo)n. 7.4.4 Closure Properties of Analytic Functions· In this section we show that analytic functions are preserved under op­ erations of arithmetic and composition. This will involve understanding how power series behave under these operations. We work entirely in the real domain. Theorem 7.4.4 Let �an(x - xo)n = f(x) and �bn(x - xo)n = g(x) converge in Ix - xol < R. Then f ± 9 and f . 9 have power-series expansions about Xo convergent in Ix-xol < R. Furthermore, ifg(xo) # 7.4 Power Series 289 0, then 1/ 9 has a power-series expansion about Xo convergent in some (perhaps smaller) neighborhood 01 Xo. Proof: The theorem for f ± 9 is trivial since the sum or difference of the convergent power series gives a convergent power series for 1 ± g, (I ± g)(x) = L�=o(<1n ± bn}xn. We have to do a little work for the product. In the process we will find a formula for the power series of the product. If we formally multiply the two power series we obtain (We must use a different label for the index of summation in each power series because the distributive law for multiplication requires that we take all products of terms-one from each series). Now the point is that the power series are absolutely convergent in Ix - xo l < R, and this implies that the double series is also absolutely convergent N ,\\1 E E lanbm{x - xo)n+ml n=Om=O < which is bounded (independent of N and M). This justifies the formal multiplication and allows us to rearrange terms to make a convergent power series: 00 00 00 I(x)g(x) = E E anbm(x - xo)n+m = E Ck(X - xO}k n=Om=O k=O where Ck = aobk +albk-l + .. . +akbo. Since everything we have done is valid in Ix -Xo I < R, we may conclude that the power series for 1 9 has radius of convergence at least R. (This could also be verified directly from the formula for Ck.) Finally, we need to consider quotients. Since f / 9 = 1 . (1/ g), it suffices to show that 1/g has a convergent power series about Xo if 290 Chapter 7 Sequences and Series of Functions g(xo) =F O. Note that g(xo) =F 0 is the same as bo =F O. We can then write 00 g(x) bo + L bn(x - xot n=l 00 bo(1 + L dn(x - xo)n) n=l where dn = bn/bo. We define h(x) = L�=l dn(x - xo)n. We note that this is a convergent power series in Ix - xol < R, so h is continuous. Then since h(xo) = 0, we can find some smaller neighborhood Ix-xol < r on which Ih(x) - h(xo)1 = Ih(x)1 < 1, so that we can expand 1 1 1 1 � k k g(x) = bo 1 + h(x) = bo L..,, ( -1) h(x) k=O with the series converging absolutely. Thus we have found where both the inner and outer series converge absolutely if /x -xol < r. This is not yet a power series, but it is very close to one. Remember that we have already shown how to multiply two power series, so by induction we know h(x)k = (L�=l dk(X - xo)n)k has a power-series expansion obtained by formally multiplying out all terms and collecting the (finite) sums corresponding to each power of x - Xo. Let us say h(x)k = L�=k hn,k(X - xo)n (because there is no zero-order term in the h(x) power series, the lowest order term in the h(x)k power series is (x - xO)k). Using this notation, we have It is merely a question of whether we can rearrange the sum to read 7.4 Power Series 291 in order to obtain a convergent power series. We know that the con­ dition for rearrangement is absolute convergence. Thus we need to show is finite. 00 00 L L Ihn.kl lx - xoln k=ln=k At first glance this looks like an unpleasant task, since even to obtain a closed-form expression for the coefficients hn.k would require some formidable combinatorial notation. Fortunately we can argue the difficulties away. However, it is first necessary to shrink the neigh­ borhood somewhat, say Ix - xol < ro, so that not only do we have Ih{x)1 = 12:�=1 dn(x - xo)nl < 1 but also H{x) < 1, where we define H(x) = 2: Idnllx - xoln. This of course is possible since the conver­ gence of I::=1 dn(x - xo)n implies the convergence of the power series defining H, and we still have H{xo) = O. Since we have IH{x)1 < 1 for Ix - xol < ro, we may conclude 1/(1 - H(x)) = 1 + I:�1 H(x)k converges absolutely, so 00 00( 00 )k 1 + � H(z)k = 1 + � � Idnl lz - zoln converges absolutely. In expanding the kth power we have (00 ) k 00 � Ia..llz - zoln = ?; Hn,klz - zoln, Note that all the terms are non-negative (this uses the fact that the combinatorial factors are all natural numbers) and so the double series I:�1 I::=k Hn.k Ix -Xo In converges in the order indicated. Finally, we have Ihn.kl < Hn•k, since the Hn•k are obtained in the same manner as hn.k except that dn is replaced Idnl. Thus we have proved the absolute convergence of the double series L�l (_l)k L:=k hn,k(X -xo)n, hence its rearrangement as a power series in Ix - xol < ro is justified. QED The theorem implies immediately that if f and 9 are analytic func­ tions on a domain D, then so are f ± g, f . g, and f /g (if 9 =F 0 on D). The proof of the expansion for 1/ 9 actually contains the germ of an im­ portant generalization concerning compositions (1/ 9 is the composition of 9 followed by f{x) = l/x) . 292 Chapter 7 Sequences and Series of Functions Theorem 7.4.5 Let f(x} = 2:�=o an(x-xo}n converge in Ix-xol < r, and let g(x) = 2:�=o bn(x - XI)n converge in Ix - xl ! < rl where f{xo} = Xl {so Xl = ao}. Then go f{x} has a convergent power series in a sufficiently small neighborhood of Xo that is obtained by rearrangement from ��=o bn (�::l ak{x - xo}k)n). Proof: Since f{x) - Xl = �::l ak{x - xo)k and this converges for Ix - xol < ro {hence absolutely}, we have g o I(x) = E b,. (E ak(x - XO)k) ,. converging if If(x) - xII < rl also. Since f{xo} = Xl and f is continu­ ous, this will be true if Ix - Xo I is small enough. To complete the proof we have to justify the rearrangement. We have with convergence in Ix - xol < ro, so we need to show the absolute convergence of the double infinite series �::o �k:n bnak,n{x - xo}k. As in the previous proof we do this by comparison with 00 00 L L IbnlAk,nlx - xolk n=Ok=n where lak,nl < Ak,n and Ak,n is obtained in the same way as ak,n with lanl replacing an, Finally the convergence of the dominating double series 00 00 L L IbnlAk,nlx - xolk n=Ok=n follows if we restrict X - Xo so that �::l lakl lx - xolk < rl, for then E�=o Ibnl (2:�l lakl lx - xolk)n converges absolutely and expanding 7.4 Power Series 293 out CLk:l lakl lx - xolk)n does not change the sum since all terms are non-negative. QED The theorems in this section justify the assertion that essentially all functions that can be written in closed form are analytic, provided the domain is suitably restricted to eliminate points where division by zero is called for at some stage of the definition. This of course assumes that all the special functions we introduce are analytic. (To show that general powers f (x) = X4 are analytic for x > 0 we anticipate the results X4 = e4 log x and the analytic nature of eX and log x from the next chapter. ) The proof of the rearrangement of the series for 9 0 f suggests an interesting question. If !I, 12, ... are analytic functions with convergent power series Ik = E�=o an,k{x -xo)n in an interval Ix -xol < R and if Ek:l /k = I converges in Ix-xol < R, does 1 have a convergent power series E:=o (Ek:l an,k) (x_xo)n? The answer turns out to be no, even if we require the convergence of the series E�l Ik to be uniform. We will see this in the next section, where we show that any continuous function can be obtained as a uniform limit of polynomials. A deeper theorem says that if 2: Ik{Z) converges uniformly for all complex Z in a disc, then the limit is analytic. (For a proof, consult any book on complex variables.) We now summarize what we have discovered about three closely related topics: power series, analytic functions, and Taylor series. Sup­ pose we start with a Coo function 1 (x) defined in a neighborhood of Xo. Then we can form the Taylor expansions E�=o I(n){xo)(x-xo)n/n! to any order N at Xo. Taylor's theorem describes the accuracy of ap­ proximation to 1 (x) as x -+ Xo for fixed N. It says nothing about limiting behavior as N -+ 00, and in fact we will see in the next chap­ ter that in general nothing can be said. However, there is nothing to prevent us from considering the behavior as N -+ 00 and asking if the resulting power series E::o an {x - xo)n converges (where we have set an = I(n)(xo)/n!). If it does converge to 1 (there are examples where it converges but to a different function) on an interval Ix - xol < R, then we say that 1 is analytic on Ix - xol < R. We have shown that 1 is also equal to a power-series expansion E:=o bn{x - XI)n about an arbitrary point Xl in the interval; the coefficients bn are again given 294 Chapter 7 Sequences and Series of Functions as in Taylor's theorem by bn = l/n!f(n)(xd, and the interval of con­ vergence is at least as large as the largest symmetric interval about Xl contained in the original interval about Xo. Inside the interval of con­ vergence, these power series are very well behaved. The convergence is absolute, uniform on any smaller interval, and the series may be differentiated term-by-term. Two power series about the same point converge to the same function only if they are identical series. Pow­ er series about a point Xo may be combined by arithmetic operations, and power series may be composed if the expansion points match up appropriately. These properties make power series a powerful tool in the study of differential equations and other applications. The class of analytic functions is wide enough to contain most im­ portant funtions. On the other hand, it is a rather special class of functions. An analytic function is determined by its values in an ar­ bitrarily small neighbohood of a point since these suffice to determine all the derivatives fen) (xo) and, hence, the power series about Xo. It is even true that f is determined by its values on any sequence of points Xb X2, ' \" converging to a point in the interior of its domain (see the exercises), but there is then no nice formula for f (x) in terms of f(xd, f(X2}, .... To learn more about analytic functions see A primer of real analytic functions by S. G. Krantz and H. R. Parks, Birkhauser-Verlag, 1992. 7.4.5 Exercises 1. Let f be defined in {a, b} and have a power-series expansion about every point Xo in (a, b) that converges in a neighborhood of Xo. Show that the values of f(x} on (a, b) are determined from the values of f(x} on any neighborhood in (a, b). 2. If f is analytic in a neighborhood of Xo and f(xo} = 0, show that f(x}/{x - xo} is analytic in the same neighborhood. 3. If f is analytic on (a, b) and f{Xk} = 0 for a sequence of distinct points Xk in (a, b) with limk-+oo Xk = Xo in (a, b) (note Xo = a or Xo = b is not allowed) , prove that f = O. (Hint: show f(xo) = 0 and divide the power series by x - xo.} 7.4 Power Series 295 4. Prove that the binomial series a( a - 1) 2 a( a - 1) ... (a - n) n (1 + x)a = 1 + ax + x + . . . + x + ... 2! n! converges in Ixl < 1, for any real a. 5. Expand f(x) = ft(l/t) dt in a power series about x = 1 by ex­ panding l/t in a power series about t = 1 and integrating term­ by-term. What is the radius of convergence of the series for f(x)? 6. Prove that if f(x) is analytic on (a, b), then F(x) = fex f(t) dt is also analytic on (a, b), where c is any point in (a, b). 7. Compute the power-series expansion of the following functions about x = 0: a. f(x) = x2/(l - x2), b. f(x) = 1/(1 - x)2, c. f(x) = V1 + x. 8. Compute the radius of convergence of the following power series: a. En4/n!xn, b. L ynxn, c. En22nxn. 9. *Compute the power-series expansion of 1/(1 + x2) about any point Xo from the formula an = f(n)(xo)/n!. 10. If f is analytic on (a, b) prove that for every Xo in ( a, b) there exists a neighborhood of Xo and constants M and r such that If(k)(x)1 < Mk!rk for all k and x in the neighborhood. 11. *Prove the converse to 10, namely if f is Coo on (a, b) and if for every Xo in (a, b) there exists a neighborhood of Xo and constants M and r such that If(k)(x)1 < Mk!rk for all k and x in the neighborhood, then f is analytic on ( a, b). (Hint: show that the Taylor approximations about Xo converge to f in a neighborhood of xo.) 296 Chapter 7 Sequences and Series of Functions 7.5 Approximation by Polynomials 7. 5.1 Lagrange Interpolation In this section we discuss the problem of approximating functions by sequences of polynomials. This is clearly a worthwhile goal, since a polynomial is a simpler object than a general continuous function, and many questions about polynomials can be answered easily by algebraic computations. One's first thoughts on the matter naturally turn to power series since the partial sums of a power series form a sequence of polynomials. However, using power series restricts us to analytic functions, excluding such simple functions as lxi, and even for analytic functions the interval of convergence may be too small. But we will show that an arbitrary continuous function on a compact interval can be approximated uniformly by polynomials-this is the famous Weier­ strass approximation theorem. This does not in any way contradict the fact that some continuous functions do not have power-series expan­ sions, because the partial sums of power series are very special ways of creating a sequence of polynomials. If the power series is expanded about the origin, for example, and Pn (x) = Ek=O akxk, then the se­ quence Pl (x), P2 (x), . .. has the property that once the coefficient an of xn is added in Pn1 it never changes in the subsequent polynomials. When we construct sequences of polynomials PI , P2 ,. .. converging uniformly to f, we will not be requiring any relationship between the coefficients of Pn and the subsequent polynomials. Before getting into the proof of the Weierstrass approximation the­ orem, we will discuss a related but simpler problem that was first solved by Lagrange-that of fitting a polynomial to any finite set of data. In other words, we want to find a polynomial P(x} satisfying P(Xk} = ak for k = 1, ... , n where Xk are arbitrary distinct real points and ak are arbitrary real (or complex) values. Since an arbitrary polynomial of degree n - 1, CO + ClX + . .. + Cn_lXn-l, has n arbitrary constants, we would hope to solve the problem with a polynomial of degree n - 1. In fact, substituting this in the equations P(xn} = an leads to n linear e­ quations in n unknowns, which may or may not have a unique solution. In the present case we can simply write down a solution. Note that the function qk(X} = IIj�k(x - Xj) is a polynomial of degree n -1 that vanishes at every Xj except Xk. Note that qk(Xk} = IIj�k(xk - Xj) is a 7.5 Approximation by Polynomials 297 non-zero constant and the polynomials Qk(X} = [qk(Xk}]-lqk(x} satisfy so P(x) = ��=1 akQk(x} gives a solution to the problem that is called the Lagrange interpolation polynomial. However, merely passing the graph of a polynomial through a finite set of points in the plane does not solve the problem of approximating a function because the formula for the Lagrange interpolation polynomial does not allow you to control P(x} at points in between the Xk'S. For example, for the function / in Figure 7.5.1, the polynomial P(x) = 0 passes through all seven points where the function / crosses the x-axis, and yet P is a very poor approximation to /. y =j{x) Figure 7.5. 1: Even if we were to choose additional points on the graph of / through which to pass a polynomial, we would not be sure of a better fit. In section 7.5.3 we will give a constructive proof of the Weierstrass approximation theorem. The proof is instructive for two reasons. The first is that it is the prototype of a very general method for obtaining approximations to functions. The second is that it allows one to say more about the approximation if more is known about / (for example, if f is C1 , then the derivatives of the polynomials approximate I'). 7. 5.2 Convolutions and Approximate Identities The method we are going to use is called convolution with an approxi­ mate identity. The term convolution refers to a kind of product between 298 Chapter 7 Sequences and Series of Functions functions defined by f · g(x) = i: f(x - y)g(y) dy. In the case we will consider both 1 and 9 will be continuous functions and one of them will be zero outside a bounded interval so that the integral will be a proper integral and 1 * g(x) will be defined for each x. More generally one considers convolution products under much weaker assumptions on 1 and g. The key point to observe about the convolu­ tion is the commutativity, 1 * g(x) = 9 * I(x). This follows from the simple change of variable in the integral-replace y by x - y (hence x - y gets replaced by y). The convolution product is also associative, (I * g) * h = 1 * (g * h )-a fact we leave as an exercise. What is the significance of the convolution product? We can inter­ pret 1 (x - y) as a translate of 1 (the graph is translated to the right by y), and this is then \"averaged\" with the weight g(y). So 1 * 9 is a weighted average of translates of f. But writing 1 * g(x) = 9 * I(x) = J g( x - y) f (y) dy shows that the convolution product is also a weighted average of translates of g. Thus f * 9 is a kind of hybrid, having the properties of both 1 and 9 (at least those properties that are preserved under translation and averaging) . For example, if 9 is a polynomial and 1 is continuous and vanishes outside a bounded interval, then 1 * 9 is a polynomial. Indeed if g( x) = 2:�=o akxk, then f . g(x) = j g(x - y)f(y) dy - j (ta ak(x - y)k) f(y) dy jti)-l)Hak ( � ) xiyHf(y)dY. k=Oj=O J Since this is a finite sum, we can interchange it with the integral to obtain 1 * g(x) = 2:7=0 bjxj where 7.5 Approximation by Polynomials 299 are just constants (note the integral J yk-j f(y) dy is a proper integral since f = 0 outside a bounded interval). Thus we can obtain polyno­ mials to approximate f by taking f * 9 where 9 is a polynomial. We still need one further idea to make f * 9 approximate f: that of an approximate identity. Looking at f * g(x) = J f(x - y)g(y) dy, this will be close to f(x) if only small values of y are emphasized (then f(x - y) will be close to f{x) by the continuity of f) and the average is \"fair.\" Suppose for example that the graph of 9 were something like Figure 7.5.2. n -----. o lin Figure 7.5.2: Then Jo lIn g{y) dy = 1, so we are getting a fair average and f*g{x) = n Jo lIn f(x - y) dy approximates f well since f(x - y) is close to f(x) for all y in 0 < Y < lIn by the uniform continuity of f. This can be seen most simply by writing so (lIn f * g(x) - f{x) = n Jo (f{x - y) - f{x)) dy, ( lIn If * g{X) - f{x)1 < n Jo If{x - y) - f{x)1 dy J.l/n 1 1 < n -dy = - o m m if If(x - y) - f(x)1 < 11m for ali lyl < lIn. Clearly the exact form of the function 9 is not crucial, but we do need the condition J g(y) dy = 1 and some condition that makes 9 concentrate near zero. Any sequence of functions {gn} with such prop­ erties is called an approximate identity. This is not quite a definition 300 Chapter 7 Sequences and Series of Functions because I have been vague as to what is meant by the condition that gn gets more concentrated near zero as n -+ 00. In fact, depending upon the context, there are several ways of making this precise. Here is one: suppose gn > 0 satisfies f gn(Y) dy = 1 and f�n + ft/n gn(Y) dy -+ 0 as n -+ 00. Then II * 9n(\"') - 1(\"')1 - i: (1('\" - II) - 1(\",»gn(lI) dy < j-l/n + ( 00 If{x _ y) _ f{x)lgn{Y) dy - 00 JI/n + jl/n If(x _ y) _ f(x)lgn(Y) dy. -lin We are assuming f is continuous and vanishes outside a bounded inter­ val. This implies that f is bounded and uniformly continuous. Thus If{x) 1 < M for all x, and given any error 11m there exists lIn such that If(x - y) - f(x)1 < 11m for all lyl < lIn. Substituting these estimates into the integrals (using If(x - y) - f(x)1 < If(x - y)1 + If(x) 1 < 2M in the IYI > lin integral) we obtain If * gn(x) - f{x)1 < 2M ( gn{Y) dy + .!.jl/n gn{Y) dy J1yl?l/n m -lin < 2M ( gn{y)dy + .!.. J1Y1?I/n m since J�{in gn{Y) dy < J�oo gn(Y) dy = 1. But we are assuming �YI?l/n gn{Y) dy -+ 0 as n -+ 00 (this is our concentrating hypoth­ esis) , so we can make 2M �YI?l/n gn{Y) dy < 11m by taking n large enough and, hence, If * g{x) - f(x)1 < 21m if n is large enough. We can summarize this result as follows: Definition 7.5.1 A sequence of continuous junctions on the line {gn} satisfying 1. gn(x) > 0, 2. J�oo gn{x) dx = 1, 3. lirnn_oo �xl?l/n gn{x) dx = 0 7.5 Approximation by Polynomials 301 is called an approximate identity. Lemma 7.5.1 (Approximate Identity Lemma) Let {gn} be an approx­ imate identity. Then if f is any continuous function on the line van­ ishing outside a bounded internal, 1 * 9n converges unilormly to I. 7. 5.3 The Weierstrass Approximation Theorem Theorem 7.5.1 (Weierstrass Approximation Theorem) Let 1 be any continuous function on a compact internal [a, b]. Then there exists a sequence of polynomials converging uniformly to f on [a, b] . Proof: There are two obstacles to using the approximate identity lemma. The first is that 1 is not defined and continuous on the whole line, and the second is that it is impossible to find polynomials gn to satisfy the approximate identity conditions. The first obstacle is readily overcome in two different ways. Note that if it happens that I(a) = I(b) = 0, then we can extend the domain of 1 to the whole line by setting 1 = 0 outside [a, b], and the extended function will be continuous. We can reduce the general case to this special case by enlarging the domain, say to [a -1, b + 1], adding ''flaps\" to the graph of f, as in Figure 7.5.3 Figure 7.5.3: and then extending 1 to be zero outside [a - 1, b + 1]. Any uniform approximation of 1 on [a - 1, b + 1] will automatically yield uniform approximation on the smaller interval [a, b]. The other method is to subtract from 1 an appropriate affine function Ax+B so that I-Ax-B vanishes at the endpoints-since Ax + B is a polynomial, we can add it back on to the polynomials approximating 1 - Ax - B to obtain polynomials approximating I. 302 Chapter 7 Sequences and Series of Functions So now we assume that f is a continuous function on the whole line vanishing outside [a, b), and we need to approximate f by polynomials on [a, b). It is crucial that we observe that the approximation is only needed on [a, b), since the growth of polynomials as x � 00 precludes approximation on the whole line. Also, by restricting attention to the interval [a, b), we can overcome the problem that no polynomials satisfy the approximate identity properties. The idea is that if f vanishes outside [a, b), then 1 * g(x) = J I(x - lI)g(lI) dll = t 1(II)g(x - II) dll only involves the values of 9 on the interval [x - b, x - a)j and if x is also restricted to lie in [a, b), then only the values of 9 on the compact interval [a', b') = [a - b, b - a] are involved. Therefore, if we take 9n (x) to be equal to a polynomial on [a', b'] and zero elsewhere, then f * 9n will be equal to a polynomial on [a, b) (for x not in [a, b] we will not have f *9n(X) equal to a polynomial, but we are only interested in what happens on [a, b)). -1 1 Figure 7.5.4: Thus to complete the proof of the Weierstrass approximation the­ orem via the approximate identity lemma we need to show that there exists an approximate identity that consists of functions 9n that are equal to polynomials on [a', b'] and vanish outside. For simplicity we take the interval [-1, 1], since the general case can be obtained by 7.5 Approximation by Polynomials 303 composing 9n with an appropriate affine function and multiplying by a constant, We can actually write down a simple formula for the approximate identity we want. Consider the function (1 - x2)m, shown in Figure 7.5,4, Note that it vanishes to high order at x = ±1 and its graph over the interval [- 1, 1] appears concentrated near x = 0, The condition that the integral be equal to one is not satisfied, so we have to multiply by the appropriate constant, namely c;,l, where em = J�1 (1 - x2)m dx, Now while it is possible to compute em explicitly, the result is quite complicated (see exercise set 7.5,5, number 14) and it is more illumi­ nating to get an estimate instead, Since we will want an estimate from above for c;,l, we need an estimate from below for em and, hence, an es­ timate from below for (1 -x2)m. For x near zero it is natural to compare (1 - x2)m with 1- mx2, the first terms of the Taylor expansion about x = O. (See Figure 7,5,5 where the two functions are graphed together. ) Since they are equal at x = 0 and d/dx(l - x2)m = -2mx(1 - x2)m-l while d/dx(l - mx2) = -2mx, we see 1 - mx2 < (1 - x2)m for all x, the desired estimate, Note that 1 - mx2 vanishes at x = ±J1/m, so the estimate 1 - mx2 < (1 - x2)m is of interest only for Ixl < 1/..;m, In fact, if Ixl < 1/2..;m, then the estimate tells us (1 - x2)m > 1- mx2 > 1- m/4m = 3/4 and so a lower bound for J�1 (1 - x2)mdx is (the length of the interval m -1/2 times the lower bound for the func­ tion) , So if we set hm{z) = c�l {1 - z2)m (on [- 1, 1] and zero elsewhere) we will have J�1 hm(x) dx = 1 and, by the above estimate, Ihm(x)1 < (4/3}m1/2(1 - x2)m. Clearly hm satisfies the first two conditions for an approximate identity. To verify the third condition we need to show �zl� l/n hm(x) dx goes to zero as m � 00, for every fixed n. Since hm vanishes outside [-1, 1], this is a proper integral, so it suffices to show hm(x) � 0 uniformly on [l/n, l] (since hm is even, the behavior 304 -1 Chapter 7 Sequences and Series of Functions 1 f(x) = 1- mx2 Figure 1. 5.5: is the same on [-1, -l/n]). But hm is clearly decreasing on [l/n, 1], so it assumes its maximum at x = l/n. Thus we really need to show limm_oo hm (l/n) = 0 for each n. Because of our bound for hm(x), this will follow from liffim-oo m1/2 (1 - 1/n2)m = o. Notice what the issue is here. The factor m1/2 goes to infinity, and the factor (1 - 1/n2)m goes to zero because 1 - 1/n2 < 1. Which term dominates? In the next chapter we will discuss the general principle that exponential factors always dominate polynomial factors. Here we can finish the proof by recalling that our proof that limm_oo rm = 0 for r < 1 gave the estimate (1 + c)m > 1 + em; hence, 1/(1 + c)m < 1/(1 + em). In our case 1/(1 + c) = 1 - 1/n2; hence, as m � 00. ml/2 (1 _-.!:.)m < m1/2 < 1 � o n2 - 1 + em - em 1 /2 This completes the verification that {hm} is an approximate identi­ ty. The approximate identity lemma tells us that hm * f � f uniformly 7.5 Approximation by Polynomials 305 on [-1, 1], and we have observed that hm * I is equal to a polynomial on [-1, 1]. QED A typical application of the Weierstrass approximation theorem is the following: if I is a continuous function on [0, 1J and all the moments an = J� I(x }xndx are known for n = 0, 1, 2, . . . , then is I determined? By considering the difference of two functions with the same moments, the question reduces to: if the moments of I are all zero, is I zero? If the moments of I are all zero, then also J� l(x)P(x) dx = 0 for any polynomial P by linearity of the integral. But by the Weierstrass approximation theorem we can find a sequence of polynomials Pn con­ verging uniformly to I (if I is complex-valued take 1 instead). Then IPn converges to 1/12 uniformly (the difference IIPn -121 = 1/I IPn -II is dominated by the maximum value of III, which is finite, times the value of IPn - II, which tends to zero uniformly) . Thus we can inter­ change the limit and integral: 0= lim 0 = lim (1 l(x)Pndx = (1 1/(x)12 dx, n-oo n-oo Jo Jo so 1/12 = 0 and I = O. The problem of actually reconstructing a function from its moments is more difficult, and we will not discuss it here. 7.5.4 Approximating Derivatives Next we show that if I is differentiable we can also approximate I' by the derivatives of the polynomials approximating I (this is by no means automatic, as we have seen) . To be precise, let us assume that I is C1 on [a, b), meaning that one-sided derivatives exist at the endpoints and JI(Z} is continuous on [a, b]. As in the proof of the Weierstrass approx­ imation theorem, we extend I to the whole line, but this time we need to do it in a more elaborate way so that the extension is C1• This can be accomplished either by adding flaps that are adjusted to match up derivatives or by subtracting from I a higher order polynomial to make both I and f' vanish at the endpoints. After this more careful preparation, the same construction of I * gn will yield the desired ap­ proximation. Indeed it suffices to verify that (I * gn)' = I' * gn, for the proof of the Weierstrass approximation theorem shows I' * gn converges uniformly to f'. We state this as a general principle. 306 Chapter 7 Sequences and Series of Functions Theorem 7.5.2 Let I be Cl and vanish outside a bounded internal, and let 9 be continuous. Then I * 9 is Cl and (I * g)' = I' * g. Proof: We form the difference quotient I * g(x) - I * g(xo) x - Xo x � xo (f I(x - y)g(y) dy - f I(xo - y)g(y) dY) f (/(X - y; = ��xo - y)) g(y) dy. Now we claim I(x - y) - I(xo - y) x - Xo converges uniformly to I'(xo - y) as x � Xo. Indeed by the mean value theorem it is I'(XI - y) for some Xl between Xo and x (Xl may depend on y), and by the uniform continuity of I' we have f'(XI - y) � I' (xo - y) uniformly. Since the integration only extends over a finite interval, we can interchange the integral with the uniform limit to obtain f f'(XO-y)g(y) dy as the limit of the difference quotient for I*g at Xo, simultaneously proving that 1* 9 is differentiable and supplying the formula f' * 9 for the derivative. QED Because of the commutativity of the convolution product, we also have (I * g)' = I * g'. By induction we can extend the theorem to higher derivatives: if I is Ck, then so is I * 9 and (I * g)(k) = I(k) * g. By choosing more sophisticated flaps we can extend Ck functions on a compact interval [a, b) to Ck functions on the line that vanish outside a larger interval and so obtain in {I * gn} a sequence of polynomials that converges uniformly to I with all derivatives of orders < k converging to the corresponding derivative of I. Finally it is even possible to have derivatives of all orders of I * gn simultaneously converge uniformly to the corresponding derivatives of f, provided f is Coo. This requires adapting the flaps to match derivatives of all orders. We will see how to do this in the next chapter. In obtaining a sequence of polynomials approximating I, we have not paid particular attention to the orders of the polynomials (of course the orders must increase to 00 unless I is a polynomial) . An interesting 7.5 Approximation by Polynomials 307 question that involves such considerations is the question of best approxi­ mation to 1 by polynomials of degree < n. For any fixed polynomial P, we define E{/, P) = sup{l/{x) - P{x)1 : x is in [a, b]}, the maximum error (the sup is achieved because 1 - P is continuous and [a, b] compact). We then define En(/) = inf{E(/, P) : P is any polynomial of degree < n}. It is not clear that this inf is attained nor that the polynomial attaining the inf.-if it exists-is unique. N­ evertheless, both statements are true. The �eierstrass approximation theorem implies limn_co En (I) = 0, but we can also ask at what rate En{/) vanishes. It turns out that we can relate the rate of convergence to the smoothness of /. All these considerations are beyond the scope of this book. 7.5.5 Exercises 1. Show that there exists a polynomial of degree 2n - 1 satisfying I(Xk) = ak and 1'{Xk) = bk for k = 1, ... , n. 2. Let 1 be C1 on [a, b] . Construct a Cl extension of / to the line that vanishes outside [a - 1, b + 1] . (Hint: use exercise 1.) 3. If 1 and 9 are continuous on the line and 1 vanishes outside a bounded interval, prove 1 * 9 is continuous. 4. Prove that (/ * g) * h = / * (g * h) if /, g, and h are continuous and two of them vanish outside a bounded interval. (Note: this requires interchanging the order of two integrations.) 5. If f is Ck and 9 is em and one of them vanishes outside a bounded interval, prove that / * g is Ck+m and (I * g)(k+m) = I(k) * g(m). 6. Define the support of f to be the closure of the set of points where 1 1= O. Prove that a continuous function 1 has compact support if and only if 1 vanishes outside a bounded interval. Prove that support (f * g) C support (f) + support (g) where the + means the set of all sums of numbers from support (I) and support (g) . 308 Chapter 7 Sequences and Series of Functions 7. If I is CI on la, b] prove that there exists a cubic polynomial P such that I - P and its first derivative vanish at the endpoints of the interval. 8. If I > 0, on la, b) show that the polynomials approximating I may be all taken > 0 on la, b]. 9. If I{c} = 0 for some point c in {a, b}, prove that the polynomials approximating f on [a, b] may be taken to vanish at c. 10. Let I be an even function {/{x} = I{ -:t}} on [-1, 1]. Prove that if J�l f(x)x2kd,x = 0 for k = 0, 1, 2, ... , then I = o. 11. Prove that none of the power-series expansions of 1/(1 + x2) con­ verge to it on [-2, 2]. 12. Let I be defined and CI on (a, b), and suppose one-sided limits of I' exist at a and b. Prove that one-sided limits of I exist at a and b and f can be extended to a C1 function on [a, b]. 13. Let Pn --+ f uniformly on [a, b) where {Pn} is a sequence of poly­ nomials of degree < N. Prove that I is a polynomial of degree < N. {Hint: for each k < N find a continuous function hk (x) such that J: hk{X}xidx = 0 for all j < N such that j =F k but J: hk{X}xkdx = 1, and consider limn_ co J: hk(X}Pn{x} dx.} 14. a. For em = J� I (1 - x2}m dx, obtain the identity em = Cm-I - {1/2m)Cm by integration by parts. b. Show that em = 2 2·4·6 ··· (2m) _ 2 (2mm!)2 3·5·7 .. · (2m + 1) (2m + 1)! 15. Compute f * f for f equal to the characteristic function of [0, 1] (equal to one on the interval, zero elsewhere) . Explain why this is called a \"hat function\" . 7. 6 Equicontinuity 7.6 Equicontinuity 7. 6. 1 The Definition of Equicontinuity 309 Compactness is a powerful method for producing existence theorems­ for example, the existence of a point where a continuous function achieves its maximum or minimum on a compact interval. In many problems we need to find functions, rather than points, that maximize or minimize certain quantities (often physical quantities such as ener­ gy or entropy are involved). For such problems we need a different notion of compactness. In order to describe one such notion we consid­ er the compactness condition \"every sequence of points in a set has a subsequence converging to a point in the set\" . If we replace the word ''point'' by \"function\" , we are led to consider the problem of when a sequence of functions has a subsequence that converges. We will limit the discussion to continuous functions defined on a compact interval [a, b), and we will demand uniform convergence. A typical way this problem arises is when we try to minimize some \"functional\" E(f) over all continuous functions f (for example, E(f) = Jo1 If{x )12dx). If we can show that E(f) is bounded from below, E{f) > c, then the inf of all the real values E(f) exists and so we can find a sequence of functions fn such that E{fn) converges to this info If we knew there were a subsequence that converged uniformly, f n' � f, then we could hope that liffin_oo E{fn') = E{f) (in actual applications this is usually the most difficult step) and f would then be a continuous function (the uniform limit of continuous functions) minimizing E. Not every sequence of continuous functions on [a, b) has a uniformly convergent subsequence. The simplest example is fn{x) = n. Here the trouble is that the functions are unbounded. It is natural then to impose the condition that functions be uniformly bounded, meaning that Ifn (x) 1 < M for some M for all n and all x. Note that the condition that the sequence of functions be bounded at each point (for every x there exists M:r such that Ifn{x)1 < M:c for all n) is enough to guarantee that for every point there is a subsequence converging at that point (for every Xo there exists {n{k)} depending on Xo such that limk_oo fn(k) (xo) exists). The reason we require uniform boundedness {the bound M does not depend on the point x} is that it is a property of every uniformly convergent sequence of continuous functions. If f n � f 310 uniformly, then Chapter 7 Sequences and Series of Functions Ifn(x) - f(x)1 < 1 for all n > N, so Ifn(x)1 < l+supx If{x)1 for n > N and we can take for M the largest of sUPx Ifn{x)1 for n < N and 1 +suPx If(x)l. Thus we are imposing on the original sequence a condition that must be met by the convergent subsequence. But we are still far from our goal. It is easy to give examples of uniformly bounded sequences of continuous functions that possess no uniformly convergent subsequences-essentially because they oscillate too much. A simple example is the sequence {sin nx }. Figure 7.6.1 shows a typical function from this sequence. We will not give a detailed proof that no convergent subsequence exists, but this is clear from the graph. In order to find the correct condition that will rule out this kind of oscillatory behavior, let us try to determine what kind of behavior a uniformly convergent sequence of continuous functions possesses that rules out such unrestrained agitation. Figure 7.6.1: An individual continuous function is prevented from jumping around by the continuity condition. Since the domain is assumed compact, we automatically have uniform continuity: for every error l/m there ex­ ists l/n such that Ix - yl < l/n implies If(x) - f(y)1 < l/m. If we switch to a different continuous function g, the same condition is sat­ isfied, except that the value of l/n may be different. If we look at functions like sin kx for large k we see that l/n must be taken very small-the larger k the smaller l/n. However, if fk � f uniformly, 7.6 Equicontinuity 311 then the error estimate 1 In for the single function f can serve as well for all the functions fk with k sufficiently large. More precisely, if we choose lin so that Ix - yl < lin implies If{x) - f{y)1 < 113m, then Ix - yl < lin also implies Ifk(X) - fk(Y) 1 < 11m once k is large e­ nough that Ifk(X) - f(x)1 < 113m for all x. (The proof follows from the three-term estimate Ifk{X) - fk{y)1 < Ifk{X) - f(x)1 + If{x) - f{y)1 + If{y) - fk {y)1 and the fact that each term is < 113m). This still leaves a finite set of functions fk for which we don't have Ifk{X) - f{x)1 < 113m for all x. But they do not cause much trouble because there are a finite number of them. For each fk there is link such that Ix - yl < link implies Ifk{X) - fk(y)1 < 11m because each fk is uniformly continuous. Thus by taking the minimum of link for the finite number of fk not covered above and the lin that works for all large k, we obtain a single value of liN such that Ix - yl < liN implies Ifk(X) - fk(y)1 < 11m for all k. This kind of continuity estimate that is valid for all fk is referred to as equicontinuity. Definition 1.6.1 A sequence of junctions {fk} defined on a domain D is said to be uniformly equicontinuous if for every 11m there exists an error lin (depending only on 11m) such that Ix - yl < lin implies Ifk{X) - fk{y) 1 < 11m for all k. Similarly we say any family (possibly uncountable) of junctions is uniformly equicontinuous if for every 11m there exists lin such that Ix - yl < lin implies If{x) - f(y)1 < 11m for every junction of f in the family. We can also define equicontinuity at a point, but since we will not use this notion explicitly, we will not give the definition. We can summarize the discussion so far by saying that any uniform­ ly convergent sequence of continuous functions on a compact interval . IS 1. uniformly bounded and 2. uniformly equicontinuous. We will now show that these two conditions imply the existence of a uniformly convergent subsequence. (Note: if you have difficulty pro­ nouncing the words \"equicontinuity\" and \"equicontinuous\" , try saying 312 Chapter 7 Sequences and Series of Functions the words \"continuity\" and \"continuous\" and then prefix them with an unaccented \"equi\" .) 7.6.2 The Arzela-Ascoli Theorem Theorem 7.6.1 (Arzela-Ascoli Theorem) Let {fk} be a sequence of junctions on a compact interoal that is uniformly bounded and uni­ formly equicontinuous. Then there exists a uniformly convergent sub­ sequence. Proof: The idea of the proof is first to obtain a subsequence that converges at every point of a countable dense subset of the domain and then to show that this subsequence converges uniformly. The first step requires the uniform boundedness; the second step requires the uniform equicontinuity. Let Xl, X2, •• • be a countable dense subset of the domain (say all rational numbers in the interval). The sequence of numbers fdxk), f2 (x k), . .. for each fixed k is bounded (by the uniform boundedness), so for each k there is a subsequence that converges. The problem is to obtain a subsequence that converges simultaneously at all the points Xk. We do this by a diagonalization procedure. First choose a sub­ sequence of {In} that converges at Xl. Call it In , 112, 113, . .. . Then choose a subsequence of In, 112, 113, . .. that converges at X2 • Call it f2l ' f22, 123, ... . Then this sequence also converges at Xl because it is a subsequence of a sequence that converges at Xl. Next we choose a sub­ sequence of f2l ' f22' f23, ' \" that converges at X3. In this way we obtain a sequence of subsequences of the original sequence, each one a subse­ quence of the previous one, such that the subsequence Ikl ' ik2, fk3,' .. converges at the points Xl, X2, ... , Xk. We still do not have a subse­ quence converging at the infinite set of points Xl , X2, • • •• To get this we write all our subsequences in an infinite matrix 111 112 113 121 122 123 131 f32 133 and take the diagonal, fll' 122, /33, . . .. The diagonal is a subsequence of the original sequence; in fact, except for the first k terms it is a subse­ quence of the kth row fleI, Ik2, Ik3, . .. , because every row below the kth 7. 6 Equicontinuity 313 is a subsequence of the kth row. Therefore the diagonal sequence con­ verges at Xk (a subsequence of a convergent sequence converges). This is true for all values of k, so 111, /22, /33, . •• is the desired subsequence converging at a countable dense subset. Now we come to the second step. We need to show that this sub­ sequence actually converges uniformly. To do this we need to verify the uniform Cauchy criterion (given any error 11m there exists N such that i, k > N implies l/j(x) - Ik (X) 1 < 11m for all x) since we know this implies uniform convergence. How can we accomplish this? The idea is that we need only nail down the Cauchy criterion at a finite set of points (depending on 11m) from our countable dense subset, and then the uniform equicontinuity holds down the other points (imagine a finite number of clothespins holding together two clotheslines that are not too wiggly) . We will make the comparison where xp is chosen from the finite set of points and is near x. The middle term will be controlled by the Cauchy criterion at xp, while the other two terms will be controlled by the uniform equicontinuity. Let the error 11m be given. By the uniform equicontinuity, there exists lin such that Ix - yl < lin implies l/j (x) - /j(Y) 1 < 113m. Let XI, X2, • . • , Xr be chosen from the countable dense set such that every point x in the domain is within a distance of lin of at least one of x}, X2, ••• ,Xr• The number of such points will depend on lin, but it will be finite because 1. the full sequence Xl, X2, ••• is dense and 2. the interval is compact (if the countable dense set was all rational numbers in the interval, then we need only choose all points of the form kin that lie in the interval) . Since Ik converges at each of the points XIt X2, ••• , Xr, we can find N such that i, k > N implies l/j(xp) - Ik(xp)1 < 113m for p = 1, 2, . . . r (choose N to be the largest value of those required to make this state­ ment true for each xp). We claim that j, k > N implies l/j (x) - fk (X) 1 < 11m for any point in the interval . Indeed given any x we find xp with Ix - xpl < lin, and 314 then Chapter 7 Sequences and Series of Functions IfJ (x) - Ik(X)1 < IfJ (x) - iJ (xp)1 + l/j(xp) - Ik(Xp)1 +llk(Xp) - Ik(X)1 < 113m + 113m + 113m = 11m, the first and third estimates following from Ix - xpl < lin and the uniform equicontinuity, and the middle one from the Cauchy criterion at xp. QED In order to apply the Arzela-Ascoli theorem we need a criterion for equicontinuity. Fortunately there is one that is very simple to verify. Suppose all the functions in the sequence are GI and the derivatives are uniformly bounded, say I/Hx)1 < M. Then I/k(X) - Ik(y)1 = I/k(z) l lx-yl < Mlx-yl by the mean value theorem and so the sequence is uniformly equicontinuous (choose lin = 11Mm ) . This is the most common condition used to verify uniform equicontinuity, so we state it separately: Corollary 7.6.1 Suppose {Ik} is a sequence olGI functions on a com­ pact interval such that Ifk(x)1 < M and Ifk (x) 1 < M for all k and x. Then there exists a unilormly convergent subsequence. Of course the condition of uniform boundedness of derivatives is not necessary for uniform equicontinuity, so there may be cases where the theorem applies but not the corollary. Unfortunately we cannot give here any honest applications of either, since they are all difficult and would take us far afield. (Some of the difficulties arise from the unbal­ anced nature of the corollary: although we make hypotheses about the derivatives of the functions, we do not obtain any conclusions concern­ ing derivatives.) In a later chapter we will show how the Arzela-Ascoli theorem can be interpreted as a compactness theorem. 7.6.3 Exercises 1. If In is a uniformly equicontinuous sequence of functions on a compact interval and In -t I pointwise, prove that In -t I uni­ formly. (You should not assume that I is continuous, although this is a consequence of the result.) 7. 6 Equicontinuity 315 2. If Ifn(x) - fn(y)1 < Mix - yin for some fixed M and 0: > ° and all x, y in a compact interval, show that {In} is uniformly equicontinuous. 3. Let {In} be a sequence of Coo functions on a compact interval such that for each k there exists Mk such that I/�k) (x) l < Mk for all n and x. Prove that there exists a subsequence converging uniformly, together with the derivatives of all orders, to a Coo function. 4. Prove that the sequence f n ( x) = sin nx is not uniformly equicon­ tinuous on any non-trivial compact interval. 5. Give an example of a sequence that is uniformly equicontinuous but not uniformly bounded. 6. Prove that the family of all polynomials of degree < N with co­ efficients in [-1, 1] is uniformly bounded and uniformly equicon­ tinuous on any compact interval. 7. Prove that the family of all polynomials P( x) of degree < N satisfying IP(x)1 < Ion [0, 1] is uniformly equicontinuous on [0, 1]. 8. Let 11,/2,. '\" In be any finite set of continuous functions on a compact interval. Show that the family of all linear combinations I:j=l ai Ii with all lai I < 1 is uniformly bounded and uniformly equicontinuous. 9. Give an example of a uniformly bounded and uniformly equicon­ tinuous sequence of functions on the whole line that does not have any uniformly convergent subsequences. 10. Give an example of a sequence of functions satisfying the hypothe­ ses of the corollary that has no subsequence whose derivatives converge uniformly. 11. Let {/k} be a sequence of uniformly bounded uniformly equicon­ tinuous functions on a bounded open interval (a, b). Show that the functions can be extended to the compact interval [a, b] so that they are still uniformly bounded and uniformly equicontinuous. 316 Chapter 7 Sequences and Series of Functions 12. Let {fA:} be a sequence of functions defined an open interval (a, b) (not necessarily bounded) satisfying 1/j(x}1 < F(x} and Ifj(x)1 < G(x} for all j, where F and G are continuous functions on (a, b). Prove that {fk} has a subsequence that converges uni­ formly on compact subsets of (a, b). (Hint : use the diagonaliza­ tion argument after obtaining subsequences converging uniformly on [a + lin, b - lin].) 13. Suppose !I , f2, ... is a sequence of functions on a compact interval that is pointwise bounded (lfk(x}1 < M(x) for all k} and point­ wise equicontinuous (for each x in the interval and for all 11m, there exists lin such that Ifk(x) - fk(y)1 < 11m for all k pro­ vided Ix - yl < lin}. Prove that there is a pointwise convergent subsequence. 7.7 Summary 7. 1 Complex Numbers Definition A complex number Z is an expression x + iy where x and y are real numbers. Under the operations (x + iy) + (x' + iy/) = X + x' + i(y + y/} and (x + iy) . (x' + iy') = xx' -yy' + i(xy' + x'y} the complex numbers form a field, denoted C. The modulus or absolute value of a complex number is Izi = Ix + iYI = y'x2 + y2. Theorem IZ'Zll = Izl lzll and Iz +zd < Izl + lzd (triangle inequality). Definition If ZI, Z2, ' \" is a sequence of complex numbers (Zk = Xk + iYk), then Zk -t Z if for every lin there exists m such that k > m implies IZk - zi < lin. Theorem Zk -t Z if and only if Xk -t x and Yk -t y. Theorem (Completeness of C) If Zl, Z2,'\" is a Cauchy sequence of complex numbers Uor every lin there exists m such that j, k > m implies IZj - zk l < lin), then there exists a complex number Z such that Zk -t z. 7. 7 Summary 317 Theorem If a complex-valued function F is integrable, then IFI is integrable and I f: F{z) dzi < J: IF{z)1 dz. 7.2 Numerical Series and Sequences Definition E�1 Xk is convergent if SI, S2, ••• is convergent, where Sn denotes the partial sums, Sn = 2:1:=1 Zk, and 2:k:l Zk = liIIln_oo Sn· Otherwise, the series is said to be divergent. Il liIIln-oo Sn = +00, then 2:�1 Xk is said to diverge to +00. II 2:�1 IZkl is convergent, Ek:l Zk is said to be absolutely convergent. Example The geometric series 2:r:l rk - r/{l - r) converges for o < r < 1 and diverges for r > 1. Theorem IIE�1 Zk and Er:l Yk are convergent, then so are E�1 aZk and 2:�1 (Zk + Yk), and E�1 aZk = a E�l Xk and E�1 (Xk + Yk) = E�1 Zk + E%\"=l Yk· II Zk > Yk lor every k then E�1 Zk > E::l Yk· If 2:r:l Xk is convergent and Yk = Xk for all but a finite number of k, then E Yn is convergent. Theorem 7.2.1 (Cauchy criterion) 2:k:l Zk converges if and only if for every 1 In there exists m such that q > P > m implies I 2:1=1' Z k I < lin. Theorem Absolute convergence implies convergence. Theorem 7.2.2 (Comparison test) IIIZkl < Yk and E�1 Yk converges, then 2:k:l Zk converges absolutely. Theorem 7.2.3 a. (Ratio test) If IZn+l/Znl < r for all sufficiently large n and some r < 1, then EZn converges absolutely, while if IZn+l/Znl > 1 for all sufficiently large n, then EZn diverges. h. (Root test) II v'lxn I < r for all sufficiently large n and some r < 1, then EZn converges absolutely. 318 Chapter 7 Sequences and Series of Functions Example L:�=1 1/na converges for a > 1 and diverges for 0 < a < 1. Example L:�=1 ( -l)n In converges but not absolutely. Definition L:�=l bn is a rearrangement of L:�=1 an if bn = am(n) for some one-to-one onto junction m(n) from the natural numbers to the natural numbers. Theorem 7.2.4 A series is absolutely convergent if and only if ev­ery rearrangement is convergent, in which case the rearrangement is absolutely convergent and has the same limit. Definition A series is said to converge unconditionally if every rear­rangement converges, conditionally if it converges but some rearrange­ ment diverges. Theorem If L::=1 Ianml is convergent for every n and 2:�=1 (2::=1 lanm l) is convergent, then E�= l (2::=1 £lnm ) 2::=1 (E�1 anm). Theorem (Summation by Parts) Let AI , A2, ••• and b1, b2, ... be two sequences and an = An-1 - An, Bn = L:�=1 bk; and suppose An+1 Bn � O. Then L:�=1 Anbn converges if and only ifL:�=1 anBn converges, and L:�=1 Anbn = L:::1 anBn. Theorem 7.2.5 If AI ,A2, ..• is a sequence of positive numbers, Al 2': A2 2': . . . , and limn_oo An = 0, then L�l (_l) n An converges. More generally L�=l bnAn converges if also IBnl � Al for all n, where Bn = L�=l bk· 7.3 Uniform Convergence Definition Let h(x), f2(x), ... be a sequence of functions on a domain D. We say fn(x) � f(x) pointwise if for every x in D, the sequence of numbers {fn(x)} converges to the number f(x). We say fn(x) � f(x) uniformly if for every lin there exists m (not depending on x) such that for all x in D and all k > m we have Ifk(x) - f(x)1 < lin. 7. 7 Summary 319 Theorem 7.3. 1 (Cauchy criterion) {f n (x)} converges uniformly to some limit function if and only if for every l/n there exists m such that l/j{x) - b:{x)1 < l/n for all i, k > m and all x in D. Theorem 7.3.2 Uniform convergence preserves continuity at a point, con­ tinuity on the domain, or uniform continuity. Theorem 7.3.3 lilIln_oo f: fn{x) dx = f: f{x) dx if fn{x) -t f{x) uniformly on [a, b] . Theorem 7.3.4 If In are Cl functions on (a, b), In -t f pointwise and f� -t 9 uniformly, then f is CI and f' = g. Theorem 7.3.5 If fn are continuous functions on a compact domain D, then fn(xn) -t f{x) for all sequences Xn -t x in D if and only if fn -t f uniformly. 7.4 Power Series Definition A power senes about Xo 18 a senes oj the Jorm I::=o an{x - xo)n. Lemma If a power series converges for x = Xl , then it converges absolutely for Ix - xol < IXI - xol and uniformly in Ix - xol < r for any r < IXI - xo l. Definition The radius oj convergence oj a power series is the unique number R in [0, 00] such that the series converges Jor Ix - xo l < R and diverges Jor Ix - xo I > R. Example The power series E:':o xn, E:':l (l/n )xn, and E:=l (1/n2)xn all have radius oj convergence R = 1, but the first diverges at x = ±1, the second converges at x = -1 but diverges at x = + 1, while the third converges at x = ± 1. Theorem 7.4. 1 The radius of convergence R of I::=o an (x - xo)n is given by l/R = limsuPn_oo v'lanl. 320 Chapter 7 Sequences and Series of Functions Examples If an = p(q)/q(n) where p and q are polynomials, then R = 1. L�=o xn/n! has R = +00, while L�=o n!xn has R = O. Theorem 7.4.2 If f(x) = L�=o an(x-xo)n with radius of convergence R > 0, then f is Coo in Ix -xol < R and the series can be differentiated term-by-term. Theorem If f(x) = L�=o an(x - xo)n with radius of convergence R> 0, then an = f(n)(xo)/nL IfL�=o an(x-xo)n = L�=o bn(x-xo)n for Ix - xol < R and R > 0, then an = bn for all n. Theorem 7.4.3 If f(x) = L�=o an(x - xdn in Ix - xII < R, then for any X2 satisfying IX2 - xII < R there exists a power series E�=o bn(x - X2)n converging to f at least for Ix - x21 < R - lx2 - xII, and Definition An analytic function f (x) on an interval (a, b) is a function with a convergent power-series expansion (non-zero radius of conver­gence) about each point in the domain. Theorem 7.4.4 If f and 9 are analytic, then so are f ±g, / . g, and f / 9 (provided 9 never vanishes), with the power series obtained by formal combination 0/ the senes for / and g. Theorem 7.4.5 1/ / and 9 are analytic functions and the range 0/ / lies in the domain of g, then 9 0 f is analytic with the power series obtained by formal substitution of the power series for f in the power series for g. 7.5 Approximation by Polynomials Theorem Given distinct points Xl , ... ,I n and values al , '\" • an, there exists a unique polynomial P(x) of degree � n - 1 such that P(Xk ) = ak, namely P(x) = E�=l akQk (x) where Qk (X) = (qk(Xk ))-lqk(X) and qk (X) = nj¥k (X - Xi )' P(x) is called the Lagrange interpolation poly­ nomial. 7. 7 Summary 321 Definition The convolution f * 9 of two continuous functions on the line, one of them vanishing outside a bounded set, is given by J * g(x) = i: J(x - y)g(y) dy. Theorem The convolution product is commutative. Definition 7.5.1 An approximate identity is a sequence of continuous functions gn on the line satisfying 1. gn > 0, 2. f�oo gn(x) dx = 1, and 3. Iimn_oo f�;!n + ft/ngn(x) dx = O. Lemma 7.5.1 (Approximate Identity) If gn is an approximate identity and f is a continuous function vanishing outside a bounded interval, then gn * f � f uniformly. Theorem 7.5.1 (Weierstrass Approximation) Any continuous func­ tion on a compact interval is the uniform limit, on that interval, of polynomials. Corollary If f is continuous on [0, 1] and f01 f(x)xndx = 0 for all n = 0, 1, . .. , then f = o. Theorem 7.5.2 If f is C1 and vanishes outside a bounded interval and 9 is continuous, then f * 9 is C1 and (f * g)' = f' * g. Theorem If f is Ck on [a, b], then there exists a sequence of polyno­ mials Pn with pW) � f{j} uniformly on [a, b) for all j < k. 7.6 Equicontinuity Definition 7.6.1 A sequence of functions {fk} on a domain D is said to be uniformly bounded if there exists M such that Ifk(x)1 < M for all k and all x in D. It is said to be uniformly equicontinuous if for every 322 Chapter 7 Sequences and Series of FUnctions l/m there exists l/n such that Ix - yl < l/n implies Ih:{x} - fk{y}1 < l/m for all k. Theorem 7.6.1 {Arzela-Ascoli} A sequence of uniformly bounded and uniformly equicontinuous functions on a compact interval has a uni­ formly convergent subsequence. Corollary 7.6.1 If {fk} is a sequence of Ct functions on [a, b] sat­isfying Ifk{x}1 < M and IfHx)l < M for all k and x, then it has a uniformly convergent subsequence. Chapter 8 Transcendental Funct ions 8.1 The Exponential and Logarithm 8. 1.1 Five Equivalent Definitions The exponential function, exp{ x) or eX , is one of the most important functions in mathematics. There are many ways to characterize it, such as: 1. the power series expansion exp{x) = L�=o xn In!, 2. the unique solution to the differential equation I' = I with 1(0) = 1, 3. the number e raised to the power x, 4. the inverse of the natural logarithm It lit dt, 5. the limit of (1 + xln)n as n -T 00. This list does not exhaust all the characterizations, but chances are any calculus book will use one of the above. One of the main goals of this section is to show that all five are equivalent, so it is not too important which one we take as the official definition. However, not all of these characterizations are of the same nature; for example, def­ initions 1 and 5 are directly algorithmic, giving a formula to compute exp( x) (although neither formula would be a particularly good choice for computing exp( 1007r) ). Many of these characterizations require that 323 324 Chapter 8 Transcendental FUnctions certain facts be proved first, for example, that the limit in definition 5 actually exists. We will take definition 1 for our definition, use it to establish some of the basic properties of the exponential function, and then prove in turn that each of the other descriptions yields the same function. Definition 8.1.1 The exponential function exp(x) is defined lor any real x by exp{x) = L�=oXn/n!. We have observed in the last chapter that this power series has infinite radius of convergence, so exp{ x) is well defined and is a Coo function and the power series converges absolutely and uniformly on any bounded interval; in particular, the series can be rearranged and differentiated term-by-term. Theorem 8. 1.1 a. The exponential function satisfies the differential equation I' = I, with 1(0) = 1. b. exp(z + y) = expz expy for any real z and y. c. exp(x) > 0 for any real x. Proof: a. The differential equation follows by term-by-term differentiation of the power series, and exp{ 0) = 1 since on = 0 for n > 1. Indeed, we could deduce the form of the power series from the differential equation: if CE anxn)' = L anxn, then n an = an-b so an = ao/n! and I{O) = 1 yields ao = 1. b. The identity may be established by multiplying the power series and rearranging terms: 00 n 00 m exp(x) exp(y) = � � � L L; n! L; m! n=O m=O 00 ( xnym) 00 {x + y)k E E n!m! = E k! k=O n+m=k k=O by the binomial theorem. The rearrangement is justified by the abso­ lute convergence of the doubly indexed series. 8. 1 The Exponential and Logarithm 325 c. For x > 0 each term in the power series is positive, so exp( x) > o. For x negative just use part b to obtain exp(x) exp( -x) = 1, hence expx = l/exp( -x) is positive. QED Theorem 8.1.2 exp{x) is the unique solution 01 the differential equa­tion I' = I with 1(0) = 1. Proof: We have already established existence. The uniqueness is a special case of a more general theorem to be established in Chapter 11. We give here a simple but tricky proof of this special case. Look at g(x) = I(x)/ exp(x). Since exp(x) never vanishes, this is well defined and 9 is differentiable (it is implicit in writing I' = I that I is differentiable; and since differentiability implies continuity, I is also continuous; hence 1 is C1 since I' = I). We compute '() I' {x) exp(x ) - I{x) exp{x) 9 x = �-.;...-�..;......-,...�-....;;....;..� (exp x)2 using the fact that d/dx exp(x) = exp(x). But I' = I then gives g' = 0 for all x; hence 9 is constant, so I{x) = g(x) exp(x) is a constant multiple of exp(x). Clearly the constant is 1 if and only if 1(0) = 1. QED For the third characterization, we define the real number e to be exp(l) = ��=1 l/n! � 2.7. This number is not rational-a fact that is not too difficult to prove, but we will not give the proof here. It is not even algebraic (i.e., it does not satisfy any polynomial equation with ra­ tional coefficients )-although this is more difficult to establish. For this reason the number e is called transcendental. For a similar reason the function exp(x) is called transcendental (there is no polynomial F(x, y) in two variables with rational coefficients such that F(x, exp x) = 0, for then F{l, e) = 0 would imply that e is algebraic). Theorem 8.1.3 For every rational number p/q (p and q integers, q > 0) we have exp{p/q) = (eP) I/q• For x real and Xk = Pk/qk a Cauchy sequence 01 rationals converging to x, exp(x) = limk_oo exp(xk ) = limk_oo (ePic ) 1/ qlc • Proof: The identity exp{x + y) = exp x . exp y implies exp(2) = e2, and by induction exp( k) = ek for any non-negative integer k. From 326 Chapter 8 Transcendental Functions e = exp(1/2 + 1/2) = exp{1/2)2 we obtain exp{1/2) = e1/2 (remember exp is always positive). In a similar way we obtain exp(l/n) = e1/n and exp(P/q) = (eP)l/q for every rational number p/q. Since exp is continuous, we have exp(x) = limk_oo exp(xk) where Xk is any Cauchy sequence of rational numbers converging to x, so exp{x) = limk_OO(ePII)l/fll . This shows the limit exists (it would be awkward, although not impossible, to prove this directly), and it justifies writing exp{x) = eX even for irrational values of x. QED N ext we consider the fourth characterization in terms of the inverse function. For this we need to know that the image of the exponential function is the set of positive real numbers, which we denote R+ . Theorem 8.1.4 The exponential function maps R one-to-one and onto R+ . Proof: We have seen that exp{x) assumes only positive values. From the differential equation d/ dx exp( x) = exp( x) and the positivity of exp(x) we see that exp(x) is strictly increasing and, hence, one-to-one. To show that it assumes all positive values we observe that liIIln-oo en = +00 and limn_oo e-n = 0, since e > 1 and 0 < e-1 < 1. Since exp is continuous, the intermediate value theorem implies that it takes on all positive values. QED The inverse function to exp is called the natural logarithm, denoted log x or ln x (or loge x). It is a function with domain R+ and range R, increasing, one-to-one, and onto. Theorem 8.1.5 log x = J: l/tdt. Proof: By the inverse function theorem log x is differentiable since d/dx exp{x) =F 0, and the derivative of log x at x = Xo is the reciprocal of the derivative of exp(x) at x = Yo where exp{yo) = Xo. Thus d 1 1 1 .I_ 10gx x=xo - d - -- = -, UOli 'L' exp x exp Yo Xo ax' X=YO so d / dx log x = 1/ x. From the fundamental theorem of the calculus and log 1 = 0 (from eO = 1) we deduce log x = J: l/t dt. QED 8. 1 The Exponential and Logarithm 327 An alternative approach to defining the exponential and logarithm functions is to start with log x = It lit dt. From this definition it is a simple matter to deduce log{ xy) = log x + log y by a change of variable argument. Then we can define exp as the inverse function to log and deduce the differential equation exp' = exp from the inverse function theorem. The fundamental identity exp{x+y) = exp x exp y and its equivalent log{xy) = log x + log y show that exp and log establish an isomorphism between the additive group of R and the multiplicative group of a+ . Logarithms were invented by Napier to exploit this isomorphism for computational purposes-only recently have these applications become obsolete. We come now to the fifth characterization of the exponential in terms of a limit. Theorem 8.1.6 exp{x) = liIIln_oo {l + xln)n for any real x. Proof: We start by writing lim (1 + xln)n = lim exp log (1 + xlnt = exp lim log (1 + xln)n n-oo n-oo n-oo since exp is continuous. Thus it suffices to show limn_oo 10g(1+xln)n = x. But ( log( 1 + x In) - log 1 ) 10g(1 + xln)n = n 10g{1 + xln) = x xln since log 1 = O. But with x =F 0 fixed, xln goes to zero as n � 00, so (1og(l + xln) - log l)/{xln) converges to the derivative of log x at x = 1, which is one. This establishes liIIln_oo 10g{1 + xln)n = x as claimed. QED This completes the proof of the equivalence of all five characteriza­ tions of expo An important property of the logarithm is that it also has power­ series expansions, although the radius of convergence is finite. Starting from log x = It lit dt we compute 328 � (-I)k (x _ l)k+l L-, k+l k=O Chapter 8 Transcendental Functions where we assume Ix - 11 < 1 in order to have uniform convergence of the 1/(1 + t) expansion, justifying the interchange of sum and integral. This is frequently written x2 x3 x4 log{ 1 + x) = x - 2\" + 3\" - \"4 + ... . For the power-series expansion of log x about an arbitrary point Xo > 0 we use log x = log xo + log x/xo = log xo + log(l + (x - xo )/xo) = log xo + E�l (- l)k+l ((x - xo)/xo) kjk, which converges for Ix - xo l < Xo . Thus log x i.� an analytic function. We can use exp and log to define general powers, ab = exp{ b log a) for a > 0 and any real b, and we can verify that ab = (aP) l/q if b = p/q is rational. Also ab is an analytic function of either variable. If we fix a > 0, then aX = exp( x log a) is analytic in x because exp is (here log a is just a constant). If we fix b, then xb = exp{ b log x) is the composition of analytic functions and, hence, analytic in x > O. Similarly f(x)g(x) is analytic if f and 9 are analytic and f{x) > O. However, there may be points where f(x) = 0 and f(x)g(x) is still defined but not analytic {as in (x2 )1/2 = Ix!) . The familiar identities (ab)C = ab·c and log(ab) = blog a can also be easily deduced-we leave these as exercises. In addition to the identities for exp and log, we need to understand the asymptotic behavior of these functions. The significance of \"ex­ ponential growth\" is that exp( x) beats out any polynomial in x, that is, limx_oo x-n exp{x) = +00 for any n. This is an immediate conse­ quence of the power-series expansion, since exp( x) > xn / n! for any n, if x > 0 (just throw away the other positive terms of the power series), and so (substituting n + 1 for n) x-n exp(x) > x-nxn+ 1 /(n + 1)! = x/(n + I)! � 00 as x � 00. Similarly we have rapid exponential de­ cay as x � -00, limx_+oo xn exp{ -x) = 0 for any n, which is just the reciprocal of the exponential growth. For the logarithm we have slow growth, limx_oo log x = +00 but limx_oo x-a log x = 0 for any a > O. This follows from log x = It l/t dt � It ta-1 dt = {xa - l)/a for any a > 0, hence (substituting a/2 for a) limx_oo x-a log x < Ii -a xo/2 _ 1 0 S' 1 1/ 1 h' 'I mx-oo x a/2 = , IDce og X = - og x, we ave sImI ar es- timates near zero: limx_o xa log x = 0 for any a > 0 (substitute 1/ x for x), 8. 1 The Exponential and Logarithm 8.1.2 Exponential Glue and Blip Functions 329 With the aid of the exponential function, we can do gluing of functions with matching of all derivatives. The basic tool is the function /(x) = exp( -1/x2 ), which is defined for all x =F 0 and can be extended by defining /(0) = 0, since limx_o exp(- 1/x2) = limx_oo exp(-x) = O. Thus 1 (x) is a continuous function. We claim that 1 is in fact a Coo function. This is clear at every point x =F 0 (in fact it is analytic on x > 0 and x < 0). At x = 0 the function I(x) has a zero of infinite order, I(x) = O(lxln) as x -T 0 for every n. Indeed the substitution 1/x2 = t shows limx_o Ixl-n exp( -1/x2) = limt_+oo tn/2 exp( -t) = O. From this we can prove by induction that /(n)(o) = O. Since /(0) = 0, we have (I (x) - I(O))/x = f(x)/x -T 0 as x -T 0, so 1' (0) = O. Also /'(x) = 2x-3 exp (- 1/x2) = 2x -3f(x) for x =F 0, so limx_o f' (x) = 0, proving that f is ct . It is clear for x =F 0 that f(n} (x) = Qn(x)f(x) where Qn is a polynomial in l/x, so lirnx_o f(n)(x) = OJ and if we assume by induction that f(n)(o) = 0, then (/(n)(x) - f(n} (o) )/x = Qn (x)f(x)/x -T 0 as x -T 0 proving f(n+l} (o) = O. Thus f is Coo and all derivatives vanish at x = O. Notice that the Taylor expansions of 1 about x = 0 vanish iden­ tically for all orders. Thus f is not analytic at x = 0, for the Taylor expansions converge to zero and not to f(x) (if x =F 0). The graph of f(x) is completely flat at x = 0, although the function is not constant in a neighborhood of x = O. We can thus glue /(x) for x > 0 to the zero function on x < 0 and have a Coo function. It is shown in Figure 8.1.1. exp (-lIx2) Figure 8.1.1: 330 Chapter ' 8 Transcendental Functions Using this idea we can create Coo functions to suit every need. For example, the Coo function shown in Figure 8.1.2, g(x) = { e2 exp (-1/(x - 1)2) exp (-1/(x + 1)2) , 0, Figure 8.1.2: -1 < x < 1, x > 1 or x < 1, vanishes outside (-1, 1) and satisfies g( 0) = 1. We will refer to 9 as a blip function centered at x = O. We can obtain other blip functions centered at other points x = Xo by taking g( A -1 (x - xo)); this function vanishes outside Ix - xol < A and satisfies g(xo) = 1. We can construct other Coo functions using blip functions. The idea is to use the convolution of a blip function with an arbitrary continuous function. Let g( x) be a blip function satisfying 1. g(x) is Coo, 2. g(x) = 0 if Ixl > 1, 3. g{x) > 0, and 4. J�oo g(x) dx = J21 g(x) dx = 1. This involves nothing more serious than multiplying the previous blip function by a constant to obtain condition 4. If we set then g>., (x) satisfies all of the above, except that in place of condition 2 we have g>.,(x) = 0 if Ixl > A. We call g>., a Coo approximate identity. 8. 1 The Exponential and Logarithm 331 If 1 is any continuous function, then we can form 1 * 9>.. As we saw in the discussion of the Weierstrass approximation theorem, f * 9>. will be a Coo function ((I * 9>.)(k) = 1 * 9lk)) and 1 * 9>. will converge to f as A � 0, uniformly on compact intervals. This procedure is called regularization. It differs from what we did in the proof of the Weier­ strass approximation theorem only in that 9>. are Coo (the polynomials (1 - x2)n were joined up to zero at x = ±1 creating discontinuities in the derivatives of order > n). Regularization is an important tech­ nique, although most of its applications are beyond the scope of this work. Suppose we apply regularization to the function f (x) whose graph is shown in Figure 8.1.3. a-2£ a-£ b+£ Figure 8.1.3: Since f = 1 on fa - e, b + e], we have for A < e and x in [a, b] f * 9>. (x) = 1>' f(x - Y)9>.(Y) dy = 1>' 9>.(Y) dy = 1 ->. ->. b+2£ since 1 (x - y) = 1 for all values of x - y in the integral. We also have if x < a - 3e or x > b + 3e, again for A < e. Thus F = f * 9>. is a Coo function satisfying F{x) = 1 on [a, b) and F(x) = 0 outside [a - 3e, b - 3e]. We also observe that 0 < F(x) < 1 for every x because f satisfies the same estimate. The graph of F is shown in Figure 8.1.4. 332 Chapter 8 Transcendental Functions y = F(x) a b Figure 8. 1.4: 8. 1.3 Functions with Prescribed Taylor Expansions* Using blip functions we can build Coo functions having prescribed Tay­ lor expansions. The key observation is that the function Ik (x) = g(>,-lx)xk/k! satisfies (d/dx)klk(X) = 1 but (d/dx)j Ik(X)lx=o = 0 for j < k. The reason for this is that (d/dx)ixklx=o = 0 unless j = k, so by the product rule for derivatives each term of (d/dx)ig(A-1X)(xk/k!) contains a factor vanishing at x = 0 if j < k and when j = k the only term not vanishing is g(>..-lx)(d/dx)k(xk/k!), which gives 1 at x = o. Thus if we want a Coo function I vanishing outside Ixl < >.. with (d/dx)k l(x)lx=o = ak for k = 0, ... , n we need only take I = Lk=O bkxk9(>..-lx) and then successively solve the linear equations 1(0) 1'(0) I\" (0) I(n) (0) bo = ao bl + d/dx(bog{A-1x))lx=o = al 2� + d2/dx2(bog{>..-lx) + b1xg{>..-lx)lx=o = a2 - n!bn + (d/dx)n (E bk\",kg(�-l\",)) Ix=o = an. k=O Since the kth equation expresses k!bk in terms of ak and the previously determined bo, bl, .. . t bk-l, there is a unique solution. Notice that it would not hurt to vary A with k (taking >\"k < A). This is the important observation that enables us to control all derivatives simultaneously. Theorem 8.1.7 (BoreQ Given any sequence £LO, aI, a2, . .. 01 real (or complex) numbers and given any point Xo and neighborhood Ix-xol < A, 8. 1 The Exponential and Logarithm 333 there exists a Coo function I vanishing outside the neighborhood and satisfying f(k)(zo) = ak lor all k. Proof: For simplicity we take xo = o. (For the general case just replace x by x - xo.) We want f(x) = 2:�O bkxkg(A;1x) where bk and Ak < A are to be determined. The idea of the proof is that while we cannot control the values of bk (they will be determined as above by solving linear equations to make l(k)(O) = ak), we can control the values of Ak' Thus if we insist that Ak -T 0 as k -T 00, the sum defining I (x) is actually finite for any fixed x. Indeed, if x = 0 only the first term is nonzero; while if x =F 0, then g(A;1x) = 0 once Ak < Ixl (because g(Ak1x) vanishes outside Ixl < Ak). Of course the number of non-zero terms increases without bound as x -T O. Assuming we can differentiate the series term-by-term at x = 0 (this is true for x =F 0 because the series is finite, but it is not clear at x = 0, and indeed it won't be true unless we choose Ak cleverly), we find the following equation for the condition I(n) (0) = an: n!bn + (d/dz)n (� bkXkg(AklX)) Ix=o = an . k=O We will use this equation to define inductively 60, b1, .... Notice that the value of An does not enter into this equation or any earlier one, so we are free to choose An after seeing what 60, ... , bn are, and the choice of An will not change 60, b1, ••• , bn• Therefore we choose An to make (d/dz)k(bnxng(A�1x)) very small for all k < n and all x, say l(d/dz)k(bnxng(A;lx)1 < 2-n for all k < n and all x. Why is this possible? Essentially because the function xng(x) vanishes to order n at x = 0, so by taking An very small we can nip it off before it has grown very much. This is easiest to see for k = 0, where there are no derivatives involved. Then we can simply estimate Ibnxng(A�lz)l < IbnlA� since g(A�lx) = 0 if Ixl > An, Ig(A�lx)1 < 1 in general, and Ixnl < A� if Ixl < An. Thus, no matter how large bn may be, we can make IbnlA� < 2-n by taking An < 1/2IbnI1/n. But even when there are derivatives involved, there are less than n of them. If k = 1 we have d/dz(bnxng(A;;lx)) = nbnxn-lg(A;;lx) + bnA;;lxng'(A;;lx) 334 Chapter 8 1i'anscendental Functions and in general (d/dx)k(bnxng(A;1x)) is a sum of terms of the form cjbnxn-j (A; 1 )k-j g(k-i) (A; 1 x) where Cj are combinatorial coefficients and j < k < n. Each such term can be estimated by the same reasoning, using g(k-j)(A;lx) = 0 for Ixl > An and Ig(k-j)(A;;lx)1 < Mk-j where Mk-j is the s,:!p of Ig(k-j)I, some finite number independent of An, and Ixn-i I < A�-J on Ixl < An. We obtain ICjbnXn-i (A;; 1 )k-j g(k-j) (A;;1)1 < CjMk-ibnA�-j (A;1 )k-i = CjMk_jbnA�-k. Since n - k > 0, we can make this as small as we like by taking An small enough. There are only a finite number of such terms in (d/ dx)k (bnxng(A;;lx)), so we can bound this uniformly by 2-n. Finally, we can do this for all k < n since there are only a finite number of k. This completes the description of how to choose the bn's and An's. We still have to justify the term-by-term differentiation of f(x) = 2:�o bkxkg(A;lX) in order to conclude that f(n)(o) = an. To do this we use the estimates l(d/dx)kbnxng(A;;lx)I < 2-n for all k < n and all x. These estimates imply that the differentiated series converges uniformly, since for any fixed k the condition k < n is satisfied for all but a finite number of n, so converges uniformly. Thus I is Coo and term-by-term differentiation is justified, proving I(n) (0) = an. Finally we note that the conditions on An were all of the nature that An must be sufficiently close to zero, so we can arrange to have An < A for any prescribed A > 0, proving that I vanishes outside Ix I < A. QED Using this theorem we can glue flaps onto Coo functions on an inter­ val. Suppose f is Coo on [a , b) (by this we mean one-sided derivatives exist at the endpoints, and fen) is continuous on [a, b) for all n) . Then by constructing Coo functions fa and fb to match up all derivatives 8. 1 The Exponential and Logarithm 335 with f at x = a and x = b and to vanish outside [a - 1, b + 1] , we can obtain in { la (x) if x < a, F(x) = f(x) if a < x < b, fb(X) if x > b a Coo function on the whole line extending f and vanishing outside [a - 1, b + 1] . This theorem can be paraphrased as saying that there are no a priori restrictions on the infinite Taylor expansion of a Coo function, since the Taylor expansion is determined by the derivatives at the point. In particular, the infinite Taylor series expansion about a point Xo may diverge at every point except Xo. 8.1.4 Exercises 1. Using log x = J; l/t dt show log(xy) = log x + log y. 2. Find limx_o xx . 3. Compute d/dx(/ (x)9(x» ) if f and 9 are C1, I(x) > o. 4. Show directly that if (1 + x / n ) n converges uniformly to a function f on a compact interval, then f is C1 and f' = f. 5. Show that I' = >\"1 for a real constant >.. has only ce�x as solutions. 6. For which values of a is the improper integral {1/2 1 io x /log x/a dx finite? 7. For which values of a is the improper integral 100 1 ---:--�a dx 2 x I log x l finite? 336 Chapter 8 1i'anscendental Functions 8. For which values of a is the improper integral r2 1 J1/2 x Ilog xla dx finite? 9. Show that for every closed set A there exists a Coo function on the line such that f{z) = 0 if and only if Z is in A. 10. Show that there exists a Coo function on the line having pre­ scribed derivatives of all orders on any sequence of distinct points Zit Z2 , ••• with no finite limit point. 11. Show that there exists a Coo function on (a, b) having prescribed derivatives of all order on any sequence of distinct points Z l , Z2, ..• with no limit points in (a, b) . 12. Prove that any Cl real-valued function satisfying I(z + y) -f (z ) f (y) must be exp{ az) for some real a . . (Hint: differentiate the identity. ) 13. Give an interpretation of definition 5 in terms of compound in­ terest rates. What does it say about interest that is compounded instantaneouly? 14. For f(t) = e-at (a positive) define the half life as the time T such that f{t + T) = f(t)/2. Show that T is well defined, and find the relationship between a and T. 15. For f (t) = eat (a positive) define the doubling time as the time T such that f(t + T) = 2f(t). Show that T is well defined, and find the relationship between a and T. 16. Show that any function of the form f(x) = cza will have a straight line graph on log-log graph paper. What is the slope of the line? 8. 2 Trigonometric Functions 8.2 Trigonometric Funct ions 8. 2.1 Definition of Sine and Cosine 337 Our approach to defining the sine and cosine functions will be indi­ rect: first we will obtain the inverse functions, which will enable us to define sine and cosine on an interval, and then we will extend the defi­ nition to the whole line. Along the way we will derive some important properties of these functions. We begin with the geometric idea that ( cos (I, sin (I) should be the x- and y-coordinates of the point obtained by measuring a length 8 along the unit circle from the point (1, 0), with the counterclockwise direction taken as positive, as in Figure 8.2. 1. �-........ (1, 0) Figure 8.2. 1: For ° < (I < 1r /2 this is consistent with the sides of a right trian­ gle definition-taking the radian measurement of angles (equal to the length of the arc of the unit circle subtended), and for other values of 8 it is consistent with the usual conventions. In order to turn this into an analytic definition we use the calculus formula for the arc length of a piece of the circle. We can compute the length of the piece of the circle between 0 and 8 (for 8 < 1r /2) by considering it as the graph of the function g(y) = V1 - y2 as y varies between ° and sin 8, as in Figure 8.2.2: {sin 8 {sin 8 (}= Jo Vl +gl (y)2 dy = Jo 1 + (_ Y )2 dy VI - y2 18in8 1 = dy. o VI - y2 338 Chapter 8 Transcendental Functions sin (9) x=Jl-y2 1 Figure 8.2.2: Upon examining this formula we find that it does not in fact furnish a definition of sin 8 but rather of its inverse function arcsin. It tells us how to compute 8 from sin 8. If we substitute x = sin 8 so that 8 = arcsin x we have arcsin x = {OX 1 dy, for - 1 < x < 1 Jo VI - y2 (because of our sign conventions this formula is also valid for negative values of x). For x = 1 we have an improper integral since the integrand tends to +00. However, note that 1 1 1 yl +y y''l - y and the first term remains bounded as y � 1. Thus, 1 < c v'1 - y2 - Ji - y in [0, I} and so the improper integral exists and is finite (recall that for a local singularity the cutoff point for integrability of Ix - xo l-O: is 0: = 1). We can now define the number 1r by 1r = arcsin 1 = {I 1 dy = lim {X 1 dy, 2 J 0 v'1 - y2 x-l J 0 v'1 - y2 which is simply a translation of the geometric definition of 1r as half the length of the unit circle. 8. 2 Trigonometric Functions 339 The function arcsin x is defined on (-1, 1) and is C1 with deriva­ tive 1/v'1 - x2 by the fundamental theorem of the calculus (note the derivative does not exist at x = ±1). Since the derivative is strictly positive, we can invoke the inverse function theorem to define sin 8 on (-1r/2, 1r/2)-the image of arcsin x on (-1, 1) (note that the continuity of arcsin x up to x = ±1 guarantees that (-1r/2, 1r/2) is the image of ( -1, 1)). The inverse function theorem tells us that there is a unique C1 function sin 8 defined on (-1r /2, 1r /2) taking values in (-1, 1) satisfying such that {sin (J (J = Jo 1/-/1 - y2 dy, � sin 9 = 1/ (� arcsin x ) = Vl - x2 for x = sin 9. Thus on the right half circle we have recovered the geometric descrip­ tion of sin (J as the y-coordinate of the point on the unit circle where the angle (J is measured by arc length along the circle from the point (1,0), as shown in Figure 8.2.3. sin a a Figure 8.2.3: Since the equation of the circle is x2 + y2 = 1 and the right half circle is given by x > 0, we can define cos 8 = + -/1 - sin2 8 for -11'/2 < (J < 1r /2. This gives the x-coordinate of the point on the circle with angle 8. The formula for the derivative of sin 8 now simplifies to � (sin 8) = -/1 - sin2 8 = cos (J, 340 Chapter 8 Transcendental Functions and by differentiating the equation defining cos 8 we obtain d d8 (cos 8) .!!.-V 1 - sin2 8 d8 -sin 8(d/dx) sin 8 = -sin 8cos O = -sin 8. V 1 - sin2 8 cos 8 The graphs of the functions sin 8 and cos 8 for 8 in (-1r /2, 1r /2) are shown in Figure 8.2.4. We have the fundamental identities sin2 8 + cos2 8 = 1, : 8 sin 8 = cos 8, : 8 cos 8 = - sin 8, 1 sin 8 -1 Figure 8.2.4: holding on this interval. Next we will extend the functions sin 8 and cos 8 to the whole line in accordance with our geometric definition so that these identities continue to hold. The easiest way to do this is first to establish the identities sin 8 = cos (8 - ;) , cos 8 = - sin (8 - ;) for 0 < 8 < 1r /2. Indeed suppose (x, y) = (cos 8, sin 8) is the point on the unit circle corresponding to angle 8 in 0 < 8 < 1r /2. Then 8. ! Trigonometric Functions 341 (y, -z) is also a point on the unit circle (see Figure 8.2.5). It clearly lies in the fourth quadrant, so we must have (sin B, - cos 8) = (y, -z) = (cos 4>, sin 4» for some 4> in -7r /2 < 4> < O. We need to show 4> = 8 -7r /2 in order to have the desired identities. In other words, we need to show that the arc length along the circle from (y, -z) to (z, y) is 7r/2-one quarter of the circle. Since (z, y) is in the first quadrant and (y, -z) is in the fourth quadrant, (1, 0) is an intermediate point. (x, y) -------tF---;--..... (1, 0) Figure 8.2.5: The portion of the arc from (1, 0) to (z, y) has length J� I/Vl - t2 cIt and the portion from (y, -z) to (1, 0) has length J: I/V1 - t2 dt (here we are using the z-coordinate as parameter, or equivalently the iden- tity fy1 1/Vl - t2 dt = fO\"/1-y2 I/Vl - s2 ds, which follows from the substitution s = ../1 - t2). Thus the total length is {y 1 dt + 1.1 1 cIt = {1 1 dt = 7r 10 vi - t2 y vi - t2 10 vi - t2 2 as desired. This result is clear on geometric grounds because the radii joining the origin to the po�ts (z, y) and (y, -z) are perpendicular and perpendicular radii cut the circle in quarters. Now the identity sin 8 = cos{8 -7r/2) allows us to define sin 8 in the interval [11'/2, 11'] , since cos(8 -11'/2) will already be defined. Similarly we can define cos 8 = -sin(8 - 11'/2) for 8 in [11'/2, 11'), and then we can extend sine and cosine for [11', 311'/2), and so on. The extension 342 Chapter 8 Transcendental Functions to values of 8 < -1r /2 is accomplished in a similar way. Notice what happens to sin 8 near 8 = 1r/2. We have sin 8 = cos(8 - 1r/2) (for 8 < 1r/2 because we proved it, and for 8 > 1r/2 because we defined it), so sin 8 is continuous and differentiable at 8 = 1r /2 and d/ d8 sin 816=7r /2 = d/d8 cos(8 - 1r/2) 16=1r/2 = - sin(8 - 1r/2) 16=7r/2 = O. It is easy to verify that the functions sin 8 and cos 8 so extended agree with the geometric definition in terms of (cos 8, sin 8) giving the coordinates of a point on the unit circle a distance 8 from (1, 0) in the counterclockwise direction, and they continue to satisfy the identities sin2 8 + cos2 8 = 1, � sin 8 = cos 8, � cos 8 = - sin 8 sin 8 = cos (8 - ;) , cos 8 = - sin (8 - ;) . Iterating the last two identities we find sin 8 = - sin (8 - 1r), cos 8 = -cos(8 - 1r) , sin 8 = sin(8 -21r), cos 8 = cos(8 -21r) , so sine and cosine are periodic functions of period 21r. Their graphs are shown in Figure 8.2.6. Since sine and cosine are continuous, the derivative formulas imply they are Coo, (d/ dfJ)2k sin fJ = (- l)k sin fJ, etc. 1-' I , I , I , I , , , , • • • • • • • • , • • , , , Figure 8.2.6: • • • • · • • • • • • , , • • • • , , '. Another way to obtain a global definition of sine and cosine is via power series. Since we can easily compute the derivatives of sine and cosine of all orders, we find the infinite Taylor expansions about the origin are 8. 12 Trigonometric Functions 343 S(x) C{x) We consider them as power series. From the size of the coefficients (they are comparable with the exponential power series) we see that they converge for all x. However, we cannot conclude from this that they converge to sin x and cos x (as we have seen the Taylor expansion of exp{- 1/x2) about x = 0 converges to zero). This will turn out to be true, but it will require a proof.-and a rather indirect proof, since our definition of sine and cosine via the arcsine does not give us direc­ t information about the power series. We do observe that S(x) and C(x) satisfy the same sort of differential equations as sine and cosine, S'(x) = C(x) and C'(x) = -S(x)-these follow simply by differentiat­ ing the power series term-by-term. It would seem plausible that these differential equations essentially characterize sine and cosine, at least with the conditions S(O) = 0 and C(O) = 1, which are clearly satis­ fied. Thus we will have S (x) = sin x and C{ x) = cos x for all x as a consequence of the following lemma. Lemma 8.2.1 II I and 9 are Ct functions on the line satisfying I' = 9 and g' = -l and 1(0) = 0, g(O) = 1, then I(x) = sin x and g(x) = cos x. Proof: This result is a consequence of a general uniqueness the­ orem for ordinary differential equations that we will establish in a later chapter. However, there is a simpler proof of this special case, modeled on the proof of the uniqueness of solutions of the exponen­ tial differential equation. We observe that the complex-valued func­ tion F{x) = g{x) + if (x) satisfies the differential equation F' (x) = -f{x) + ig(x) = iF{x), as does the function cis x = cos x + isin x. Also, both F and cis take on the value 1 at x = O. Therefore we want to form F(x)/cis x and show that the derivative is zero. We note that leis xl2 = cos2 X + sin2 X = 1, so cis x # 0; hence we can divide by it. 344 Chapter 8 Thanscendental Functions The computation .!!.- (�(X)) dx ClSX cis x-i;F(X) - F(x)-i;cis x (cis x)2 icisxF(x) - iF(x)cisx = 0 (cisx)2 is as easy as before. Thus F(x) = a cisx and a = 1 follows by setting x = O. QED We could also disguise the argument to remove all reference to the complex numbers by noting 1/(cosx + isin x) = cos x - isin x, since cos2 x + sin2 x = 1, so that F(x) . CIS X (cos x - i sin x )(g(x) + if(x)) [cos xg(x) + sin xf(x)] + i[cos xf(x) - sin xg(x )]. Thus we compute d�[COS Xg(x) + sin xf(x)] =0 and ! [cos xf(x) -sinxg(x)] =0 from the differential equations, hence cosxg(x) + sinxf(x) = 1 and cosxf(x) - sinxg(x) = 0 (the values at x = 0 providing the constants 1 and 0). We get f(x) = sin x and g( x) = sin x by solving these linear equations (multiply the first by sin x and the second by cos x and add, using cos2 x + sin 2 x = 1). Of course such a purely real-valued proof would seem quite magical (out of what hat did we draw cos xg(x)+sin xf(x) and cosxf(x)-sinxg(x)?) if presented without motivation. 8.2.2 Relationship Between Sines, Cosines, and Com­ plex Exponentials The connection between sines and cosines and the exponential func­ tion is now clear from two perspectives. We have seen that F(x) = cos x + i sinx satisfies F'(x) = iF(x), the same differential equation 8. � Trigonometric FUnctions 345 that exp{ix) should satisfy. By exp{z) for z a complex number we mean the result of substituting z in the exponential power series, exp{ z) = �::o zn In!. For z = ix we find 00 (' )n 00 'n n 00 2k 00 2k+l , � 'x � , x � k x ,� k x exp{,x) = L..J n! = L..J � = L..J{ - 1) (2k)! +t L..J{ -1) (2k + 1)! n=O n=O k=O k=O by separating the real and imaginary parts (the rearrangement is justi­ fied by the absolute convergence of the series) . Thus we have exp{ ix) = cos x + i sin x, the notorious Euler identities. In a like manner we find exp{-ix) = cos x - isin x, and so we can solve for sine and cosine: sin x cos x exp{ix) - exp(-ix) 2i exp(ix) + exp( -ix) 2 These are truly remarkable identities. Although they are trivial consequences of the power-series expansions, they are totally unexpect­ ed from the geometric definitions of sine and cosine. We should also point out the rather remarkable nature of the power-series expansions for sine and cosine. For example, the periodicity of the cosine means that L�o( _1)kx2k Ik! = L�o( -l)k (x + 21r)2k Ik!. This identity is true in the sense that rearrangement of the second series-expanding (x + 21r )2k in the binomial theorem-gives the first series. But a direct proof of this fact is out of the question. The Euler identities simplify the study of the trigonometric func­ tions. For example, the addition formulas sin{x + y) = sin x cos y + cos x sin y, cos{x + y) = cos xcos y - sin xsin y can be obtained by taking the real and imaginary parts of the identity exp{i(x + y)) = exp(ix) exp(iy) after substituting the Euler identities: cos(x + y) + isin{x + y) = (cos x + i sin x) (cos y + isiny). 346 Chapter 8 1i'anscendental Functions The other trigonometric functions are definable in terms of sine and cosine, so we will not discuss their properties in detail. We will mention one interesting result, the arctangent integral: arctan: arctan x = J; 1/(1 + t2) dt. To derive this we compute d 8 _ d sin 8 _ cos2 8 + sin2 8 _ 1 28 d8 tan - d8 cos 8 - cos2 8 - + tan , which shows tan 8 is increasing on (-1r /2, 1r /2); and since cos ±1r /2 = 0, we see that tan 8 maps (-1r /2, 1r /2) onto the real line. The graph is shown in Figure 8.2.7. tan(9) Figure 8.2.7: By the inverse function theorem tan 8 has a C1 inverse (denoted arctan x) on the whole line taking values in (-1r /2 , 1r /2) with the derivative given by d/dx arctan x = 1/{d/d8 tan 8) = 1/{1 + tan2 8) if x = tan 8. Thus d/dx{arctan x) = 1/{1 + x2); and since arctan 0 = 0, we obtain arctan x = J; 1/{1 +t2) dt by the fundamental theorem of the calculus. With the aid of the sine and cosine we can give another perspective on the complex number system. If z is a non-zero complex number, then z/Izl is a complex number of absolute value 1, Iz/lzlI = Izl/Izl = 1. Since Izl2 = x2 + y2 for z = x + iy, a complex number of absolute 8. � Trigonometric Functions 347 value one corresponds to a point (x, y) in the plane lying on the unit circle. Thus, (x,y) = (cos O, sin O) and zllzl = cos B + i sin B. The value of the angle B is only determined up to a multiple of 27r and is called the afYUment of z or arg z. Thus, we have the polar coordinates representation of an arbitrary non-zero complex number z = rei6 = r cos 0 + i r sin B where r = Izi is the length of the line segment joining (0,0) to (x, y) and 0 is the angle it makes with the positive x-axis. This gives us a better understanding of complex multiplication. If ZI = rl ei61 and Z2 = r2 ei62 , then Z1 Z2 = rl ei61 r2 ei62 = (rl r2 )ei(61 +62), so the absolute values multiply and the arguments add. Similarly for powers: zn = (rei6 )n = rneinB • The absolute value is raised to the power n and the argument multiplied by n. Notice that in both these formulas the ambiguity in the argument does not matter. For example, since kn is also an integer. However, for non-integer powers we find more than one value for za, since and now ak need not be an integer. In fact, if a is irrational there are infinitely many values for za, while for a rational there are only finitely many. For example, there are two square roots, (rei6 ) 1/2 = rl/2ei6/2 and (rei(6+21r» ) lf2 = rl/2ei6/2e1ri = _rl/2ei6/2 , exactly as we expect. Thus (i) I/2 = (e1ri/2 ) 1 /2 = ±e1ri/4 = ± (cos � + i sin 7r) = ± (� + �) . . 4 4 J2 J2 We can use these ideas to define an infinite-valued logarithm func­ tion for complex numbers. We want log to be the inverse function of exp, but exp is not one-to-one on C, since exp(z + 27rki) = exp z. To see how to define log z we look at the equation exp(log z) = z (in the other direction we can only expect that one of the values of log( exp z) will equal z). Writing z = rei6 and log z = a + bi we are led to the equation rei6 = eaeib and, hence, r = ea and ei6 = eib, so a = log r and b = 0 + 27rk for some integer k. Thus log z = log r + i( 0 + 27rk ) = log Izl + i arg z. We can also express this in terms of the real and imaginary parts of z since Izl 2 = x2 + y2 and 348 Chapter 8 1i'anscendental Functions arg z = arctan y/x, so log(x + iy) = 1/2 10g(x2 + y2 ) + i arctan y/x (actually there is more ambiguity in arctan y/x than in arg z, so this equation must be understood in the sense that only half the values of arctan y / x are allowed). With the aid of the polar coordinate representation we can give a simple proof of the triangle inequality (lz1 - z21 < IZ1 1 + IZ21) for complex numbers. Writing Z1 = r1 ei91 and Z2 = r2ei� we compute I Z1 - z212 - (Z1 - Z2)(%1 - %2 ) = (r1ei91 - r2ei62)(r1e-ilh - r2e-i92) - r� + ri - r1r2(ei(91-�) + e-i(91-92)) - r� + ri - 2r1r2 COS(81 - 82 ), o Figure 8.2.8: which is the familiar law of cosines for the triangle (shown in Figure 8.2.8) with vertices at 0, Z1 , Z2. Since cos(81 - 82) varies between +1 and -1, we have I ZI -z212 lying between r� +r� -2rlr2 = (r1 - r2)2 and r� + r� + 2r1r2 = (rl + r2)2, with the maximum and minimum values assumed when the angle 81 -82 is 1r and o. Thus I Z1 -z2 12 < (rl +r2)2 , so IZI - z2 1 < IZl l + IZ21 with equality holding only when Z1 and Z2 are colinear. In addition to the exponential, logarithm, and trigonometric func­ tions, there are a number of other transcendental functions that have been carefully studied. Examples of these special functions are Bessel functions, hypergeometric functions, Legendre functions, and the gamma function. The main tools used in the study of these func­ tions are those we have already discussed: representation as integrals, power-series expansions, and differential equations. 8. � Trigonometric Functions 349 8.2.3 Exercises 1. Show by direct substitution (t = x/V1 + x2) that 1\"\" 1/(1 + \",2) dx = f 1/\"/1 - t2 dt. 2. Show by direct substitution that Interpret this result in terms of the arctangent. 3. *Using 1r = 4 J� 1/(1 + x2) dx and the midpoint and trapezoidal rules with increments of 1/10, compute the approximate value of 1r. Compare the predicted error with the actual error. (Use a calculator for this problem. You might also try programming the computation to allow different values of the increment and see if the actual error depends on the increment in the predicted manner.) 4. Verify the identity sin2 8 + cos2 8 = 1 by rearranging the power­ series expansions. 5. Compute the power-series expansions of sin 8 and cos 8 about the point 1r/2. 6. Find all complex solutions of the equation zn = 1. Can you give a geometric interpretation of the result? 7. Let J(z) = L�=o Clnzn be convergent in Izl < R, and suppose the coefficients Cln are all real. Show J (z) = J (z ). 8. *Show that eZ = z has no real solutions but that it has complex solutions. (Hint: write z = x + iy, and show that eZ = z is equivalent to x2 + y2 = e2x and y/x = tan y.) 9. Br expanding 1/(I+x2) in a power series about x = 0 prove 1r/4 = Jo 1/(1 + x2) dx = liIIlr_l L�o( -1)kr2k+l/(2k + 1), and then show 1r/4 = Lk:o(-I)k/(2k + 1). (Hint: combine neighboring terms in the series.) 350 Chapter 8 Transcendental Functions 10. Show a sin % + bcos % - A cos(% + B). How are a, b and A, B related? 11. Show that exp{z) assumes every complex value except zero and that exp(zt } = exp(Z2 ) if and only if ZI - Z2 = 21rki for some integer k. 12. Express (sin %)n as a linear combination of cos kx and sin kx for o < k < n. (Hint: use sin % = (eiZ - e-iZ)/2i.) 13. Prove J: sin n% sin m% cb: = 0 if n :I: m. 14. Prove cos % cos y = 1/2 c08{% + y) + 1/2 cos {x - y). Explain how this formula could be used, in conjuction with a table of cosines, to simplify the process of multiplication of two numbers in [0, 1] . (This idea was proposed by Francois Viete in the 15908 under the name prosthapooeruil. It became obsolete after the introduction of logarithms by Napier.) 8.3 Summary 8.1 The Exponential and Logarithm Definition 8.1.1 The ezponential function exp{x) is defined lor any real x by exp{x) = E�=o %n/n!. Theorem 8.1.1 a. The exponential function satisfies the differential equation I' = f, with f(O) = 1. b. exp{x + y) = exp% expy for any real x and y. c. exp{x) > 0 for any real x. Theorem 8.1.2 exp(x) iI the unique solution of the differential equa­tion I' = I with f(O) = 1. 8.9 Summary 351 Theorem 8.1.3 For every rational number p/q(p and q integers, q> 0) we have exp(P/q) = (eP)1/q. For x real and Xlc = plclqlc a Cauchy sequence of rationals converging to x, exp(x) = limlc_oo exp(xlc) = limlc_oo (ePic ) l/qlc • Theorem 8.1.4 The exponential function maps R one-to-one and onto R+ . Theorem 8.1.5 log x = It lit dt. Theorem The junctions exp and log establish an isomorphism between the additivE group of the reals and the multiplicative group of the positive reals. Theorem 8.1.6 exp(x) = liIIln_oo (l + xln)n for any real x. Theorem x2 x3 x4 . 10g(1 + x) = x - - + - - - + ... 234 for Ixl < 1, and more generally � (_l)le+l ( x - xo) Ie 10g x = 10g xo + L..J k Ie=l Xo for Ix - Xo I < Xo; hence log x is analytic. Theorem limz_+oo x-n exp(x) = +00 and liIIlx_+oo xn exp( -x) = 0, for any n > 0; limz_+oo x-4 log x = 0 and limz_o x4 log x = 0 for any a> O. Theorem The function F(x) = { exp( -1/x2), x ¢ 0, 0, x = 0, is Coo and vanishes to infinite order at x = 0; hence, it is not analytic at x = o. 352 Chapter 8 1i'anscendental Functions Theorem The \"blip function\" g(x) = { e2 exp (-1/(x - 1)2) exp (-1/(x + 1)2) , -1 < x < 1, 0, Ixl > 1, is Coo, vanishes outside Ixl > 1, and satisfies g(O} = 1. Theorem 8. 1.7 (BoreQ Given any sequence ao, al, ... of reals, any point xo, and any neighborhood I x -Xo I < A, there exists a Coo function f vanishing outside the neighborhood such that f<k)(xo} = ak for all k. Corollary Given any Coo function on a compact interval [a, b] (mean­ing one-sided derivatives exist at the endpoints) there exists a Coo ex­tension to the line vanishing outside a larger interval [a - E, b + E] . 8.2 Trigonometric Function Definition arcsin x = J; 1/ '1'1 - y2 dy for -1 < x < 1, and 1r = 2 arcsin 1. Theorem arcsin x is a Cl function mapping (-1 , 1) onto (-1r/2, 1r/2) with derivative 1/ v'1 - x2, and has a Cl inverse junction sin 8 mapping (-1r/2, 1r/2) onto (-1, 1) with derivative d/d8 sin 8 = '1'1 - sin2 8. Definition cos 8 = + '1'1 - sin2 8 for -1r/2 < 8 < 1r/2. Theorem There exist unique functions sin 8 and cos 8 defined for all real 8 coinciding with the above definitions for -1r /2 < 8 < 1r /2 and satisfying sin 8 = cos(8 -1r/2}, cos 8 = - sin(8 - 1r/2} for all real 8. Theorem sin 8 and cos 8 are Cl functions periodic of period 21r, and satisfy the identities sin 2 8 + cos2 8 = 1, d / d8 sin 8 = cos (}, d / d8 cos 8 = - sin 8. Theorem sin and cos are analytic junctions with power series x3 xS 00 x2k+ 1 sin x = x - -3' + -, - ... = E ( _ 1}k ( k ) , . 5. k 2 + 1 . =0 8.9 Summary 353 converging lor all real x. Lemma 8.2.1 The unique C1 solutions to I' = 9 and g' = -f with 1(0) = 0 and g(O) = 1 are I(x) = sin x and g(x) = cos x. Theorem (Euler identities) exp( ix) = cos x + i sin x, exp(ix) - exp( -ix) 2i sin x exp( ix) + exp( -ix) 2 cos x - Theorem arctan x = J; 1/(1 + t2) dt. Theorem An arbitrary non-zero complex number z can be written z = rei9 , where 8 (determined modulo 27r) is called the argument and r the modulus 01 z. In multiplying complex numbers the moduli are multiplied and the arguments added, while zn = rnein8 for integer n. Theorem (Law of Cosines) IZI - z212 = r� + r� - 2rlr2 cos(81 - 82) if ZI = rl ei91 ,Z2 = r2ei92• Chapter 9 Euclidean Space and Metric Spaces 9. 1 Structures on Euclidean Space 9.1.1 Vector Space and Metric Space We are now ready to begin the study of functions of several variables, !(XI, X2, ••• , xn), where each XIc varies over III Since we live in a three­ dimensional world, we can easily appreciate the importance of this subject, at least for n = 3. We allow the number n to be arbitrary because it is necessary to do so for many applications and also because the mathematics is not appreciably more difficult. We will frequently appeal to our three-dimensional geometric intuition to guide us to an understanding of the general case. We begin by studying the Euclidean space Rn of n real variables. We can simply define Rn to be the set of all ordered n-tuples (Xl, X2, ••• , xn) of real numbers. Of course this is not the whole story. We also want to define on the set Rn various \"structures\" : vector space, metric space, normed space (Banach space) , and inner product space (Hilbert space) . Each of these structures can be defined by rather simple formulas; however, we will also be interested in a more abstract description of these structures. For each type of structure, we will first describe the Euclidean version, then present some of the basic properties of the structure, and finally use these properties to define a general notion of the structure. In this way, the Euclidean version becomes just a 355 356 Chapter 9 Euclidean Space and Metric Spaces special case of abstract structure; but it is the special case in which we are most interested, and it serves to motivate the abstract definition. All these structures play an important role in mathematics, although it is the metric space structure that will be most emphasized in this book. The reader who has not seen these ideas before should not expect to appreciate the signficance of these structures immediately; such an understanding can only come after the theory is developed. In order to simplify the notation we will adopt the following con­ventions. Letters at the end of the alphabet x, y, z, etc., will be used to denote points in an , so x = (Xl , X2, ... , xn) and Xk will always refer to the kth coordinate of x. We will reserve the letter n for the dimension of the space. Letters from the beginning of the alphabet, a, b, c, etc., will denote real numbers, also called scalars. We begin with the vector space structure of an . We define vector addition by X + y = (Xl + YI, X2 + Y2, . . . , Xn + Yn) and scalar multipli­ cation by ax = (ax!, aX2, ... ,axn). It is easy to verify that with these definitions an forms a vector space over the scalar field lR. We recall the vector space axioms: a set V with a vector addition and scalar multiplication is said to be a vector space over the scalar field IF (in this book we will always take a or C) provided 1. vector addition satisfies the commutative group axioms: commu­ tativity (x + Y = Y + x), associativity «x + y) + z = x + (y + z)), existence of zero (x + ° = x for all x), and existence of additive inverses (x + (-x) = 0); and 2. scalar multiplication is associative « ab)x = a(bx)) and distributes over addi�ion in both ways (a( x + y) = ax + ay and (a + b)x = ax + bx). The study of vector spaces is called linear algebra. We assume the reader has had some exposure to the elementary theory of linear alge­ bra, at least in the concrete setting of Rn . We recall that an has dimen­ sion n because the vectors (1, 0, ... ,0), (0, 1, 0, ... ,0), ... , (0, ... ,0, 1) form a basis (a set of vectors that is linearly independent and spans) and that every basis must have n elements. We refer to this special basis as the standard basis, and we sometimes denote it by e(l}, e(2), . .. , e(n} . The vector x is written uniquely Xl eel) + X2e(2) + ... + xne(n) as a linear combination of the standard basis vectors, and the coordinate x k is the coefficient of e(k) in this representation. 9. 1 Structures on Euclidean Space 357 The vector space structure of an is not enough--on its own-to allow us to express geometric concepts. We are thus led to consider the metric structure in order to define length. We take the Pythagore­ an formula d(x, y) = V(XI - yd2 + ... + (xn - Yn)2 as the definition of the Euclidean distance between x and y. Our geometric intuition validates this definition when n = 1, 2, 3. It is also the only reasonable choice in general if we want subspace consistency (if x and y happen to lie in an m-dimensional subspace defined by the vanishing of a specified set of n - m coordinates, then the distance is the same measured in the subspace or in all of an) . This distance function satisfies three basic conditions: 1. d(x, y) > 0 with equality if and only if x = y (positivity). 2. d(x, y} = d(y, x) (symmetry). 3. d(x, z} < d(x, y} + d(y, z} (triangle inequality). The Euclidean distance clearly satisfies the first two properties; only the triangle inequality requires proof. We have already proved this in the case n = 2 under the guise of a triangle inequality for distances in the complex plane. Indeed we can regard C as R2 with some additional structure-complex multiplication-by identifying x = (Xl, X2 ) in a2 with z = Xl + iX2 in C, and the distance functions are the same. We could generalize the proof given for C to the case of an but will obtain a simpler proof very shortly, so we postpone the discussion until the next section. The abstract notion of metric space is that of a set M with a distance function (or metric) d(x, y) taking real values for X and y in M and satisfying the above three conditions of positivity, symme­ try, and triangle inequality. These are considered to be the minimum conditions needed to justify the crudest intuitions of distance (some­ times, however, a condition weaker than the triangle inequality, such as d(x, z) < M(d(x, y) + d(y, z) ) for some constant M, can be substituted and one still obtains a useful notion of distance}. Thus we have shown that Rn with the Pythagorean distance function forms a metric space. We will give many more examples in the next section. 358 Chapter 9 Euclidean Space and Metric Spaces 9.1.2 Norm and Inner Product The metric structure of an is related to the vector space structure, since d(x, y) depends only on x -y. To make this explicit we introduce the Euclidean norm, defined by Ixl = \"';xi + ... + x�, so that d(x, y) = Ix - yl. The basic properties of the norm are: 1. Ixl > 0 with equality if and only if x = 0 (positivity). 2. laxl = lal lxl for any scalar a (homogeneity). 3. Ix + yl < Ixl + Iyl (triangle inequality). Note that in the statement of homogeneity the symbol II is used with two different meanings-Ial referring to the absolute value of a. Of course the absolute value and the norm coincide for Rl , so there is no danger of misinterpreting the formula. Nevertheless, it is sometimes preferable to use double bars IIxll to donate the norm. We have chosen to use the single bars for the norm on Rn so that we can use double bars to refer to other norms. The abstract definition of norm is of course any function on a vector space that satisfies the above conditions of positivity, homogeneity, and triangle inequality. Notice that a norm must be defined on a vector space in order for conditions 2 and 3 to make sense. For a metric there is no need to assume the space has a vector space structure. The verification that the Euclidean norm on Rn actually satisfies the positivity and homogeneity conditions is trivial, and again we postpone the proof of the triangle inequality. What we want to show is that these conditions on the norm imply the defining conditions of a metric for the distance d(x, y) = Ix - yl. In other words, if we start with any vector space V with a norm IIxll, then V becomes a metric space with the distance function d(x, y) = IIx - yll. The proof of this is trivial: the positivity of the norm implies the positivity of the metric, d(x, y) = Ilx -yll > 0 with equality if and only if x -y = 0, or in other words x = y. The symmetry of the metric follows from the homogeneity of the norm with a = -1, d(x, y) = Ilx -yll = II( -l}(y -x)11 = I- li lly -xII = lIy -xII = d(y, x). 9. 1 Structures on Euclidean Space 359 Finally, the triangle inequality for the norm implies the triangle in­ equality for the metric- d{x, z} = Ilx - zll = II{x - y} + (y - z} 11 < Ilx - yl l + Ily - zll = d(x, y) + d{y, z). The metric d{ x, y) = Ilx - yl l is said to be the metric associated with (or induced by) the norm. Note that in our proof that d(x, y) is a metric we used the homogeneity of the norm only in the special case a = -1. This means that the homogeneity condition is considerably stronger than is absolutely essential-so not every metric on a vector space that depends only on x - y is associated with a norm (for an example see exercise set 9.1.4, number 15). Here are two more examples of norms, with the underlying vector space being an : n E lxj l, j=1 IIx Iisup m?-X{lxj I}. 1 The verification of the norm axioms is straightforward for these--we leave it to the exercises. The associated distances are different from the Pythagorean distance--in the first case we can interpret the distance IIx - yl l as the shortest distance between x and y along a broken line segment that moves parallel to the axes (taxicab distance in a city laid out on a square grid). The norms we are considering are special cases of the p-norm IIxll\" = (t Ix; I\") l/p with p a constant satisfying 1 < p < 00 (the norm Ilxlisup can be thought of as limp_oo Ilxl ip and is frequently denoted I lx lloo). The proof of the triangle inequality for the p-norm in general is more difficult. If we draw the graph of the set of points in a2 satisfying Ilx II = 1 we can get a picture of the differences between these norms, as in Figure 9.1.1. For another important example we consider the space C([a, b] ) of continuous real-valued functions on the compact interval [a, b), with norm Ilfllsup = sUPx If{x} l. The vector space structure of C([a, b]) 360 Chapter 9 Euclidean Space and Metric Spaces Figure 9. 1.1: IIxlli = 1 diamond IIxl12 = 1 circle IIxl loo = 1 square is the obvious one, f + 9 is the function f(x) + g(x), and af is the function af(x). The verification of the norm axioms for the sup-norm is again simple and left as an exercise. This vector space is not finite dimensional. The last structure on Rn. we want to consider is the inner product. We need this structure in order to express the geometric notion of angle. We define x . Y = XtYt + . .. + xnYn-this is sometimes called the scalar product or dot product. The connection with angle is given by the formula x . Y = Ixl lYI cos 8 defining the angle 8 between the vectors x and y. Note that the angle is only defined if both x and Y are nonzero, and then the sign of 8 is not defined (in dimension n > 3 we cannot unambiguously choose a sign convention). For most applications we will only be interested in the condition x . Y = 0 characterizing perpendicular vectors. The geometric justification of the angle formula in R2 is familiar: if x = (r cos8,rsin 8) and Y = (R cos</>,R sin </» in polar coordinates, then x· Y = rR(cos 8cos ,p + sin 8sin ,p) = rR cos(8 - ,p), and r = lx i, R = IYI, and 8 - 4> is the angle between, as in Figure 9.1.2. The basic properties of the inner product are: 1. X· Y = y . x (symmetry). 2. (ax + 11y) • z = ax . z + I1y • z and x . (ay + bz) = ax . y + bx . z (bilineanty) . 9. 1 Structures on Euclidean Space 361 ---y Figure 9.1.2: 3. x · x > 0 with equality if and only if x = 0 (positive definiteness). Notice that all three conditions are trivially verified. Any real-valued function (x, y) defined for x and y in a vector space and satisfying symmetry, bilinearity, and positive definiteness is said to be an inner product. The connection between the Euclidean inner product and norm is evidently given by Ixl = .;x:x. In general, if we are given an inner product (x, y) we define the associated (or induced) norm to be Ilxli = J (x, x). This requires, of course, that we prove IIxll = J (x, x) actually is a norm. To do this we need an important estimate, known as the Cauchy-Schwartz inequality: I(x, y)l < J(x, x)J(y, y). This is one of the most important inequalities in all of analysis and appears under myriad guises. By stating it as we have in the abstract formulation we include all the special cases-corresponding to different choices of inner product. For the case of the Euclidean inner product the inequality reads n EXjYj < j= 1 An integral version, ( n ) 1/2 ( n ) 1/2 Ex� EYJ j=1 j= 1 b ( b ) 1/2 ( b ) 1/2 1I(X)g(X) dx < 1 1/(x)l2 dx 1 1g(x)l2dX , 362 Chapter 9 Euclidean Space and Metric Spaces follows easily from the fact that (f, g) = J: f(x)g (x) dx is an inner product on C([a, bD . We will give a simple proof in the general set­ ting. A good exercise would be to rewrite it in the special case of the Euclidean inner product . Theorem 9. 1.1 (Cauchy-Schwartz Inequality) On any vector space with an inner product (x, y) , we have l (x, y) 1 < (x, x) 1/2 (y, y) 1/2 (or equiv­ alently, I (x, y) 1 < Ilx11 11 Y1 1) for any x, y. Furthermore, equality occurs if and only if the vectors x and y are colin ear (x = ay or y = bx for some scalar) . Proof: The proof is based on the observation (x + y, x + y) > 0 and (x - y, x - y) > 0 by the positivity. Expanding these using the bilinearity and symmetry we obtain (x , x) + (y, y) + 2(x, y) > 0 and (x, x) + (y, y) - 2(x, y) > 0, so l(x, y) 1 < ((x, x) + (y, y) )/2. This is almost the inequality we want . Notice that if (x, x) = 1 and (y, y) = 1, then this is just I (x, y) I < 1 = (x, x) 1/2 (y, y) 1/2 as desired. Thus we already have the Cauchy-Schwartz inequality for unit vectors (those satisfying (x, x) = (y, y) = 1). Finally we can reduce the general case to this special case . Leaving aside the trivial cases x = 0 or y = 0 (then both sides of the inequality are zero) , we can always write x = ax', y = by' with (x', x') = (y', y') = 1 simply by choosing a = (x, x) 1/2 and b = (y, yj 1/2 and setting x' = a- l x, y' = b- l y (a- l and b- l are defined because x #- 0, y #- 0, and the inner product is positive definite ). Then I (x, y) I = I (ax', by') I = lab(x' , y') I = l abl l (x', y' ) I < labl by the special case I (x', y') 1 < 1, and l abl = (x, x) 1/2 (y, y) 1/2 . To see when equality can hold consider first the special case of unit vectors. Then (x', y') = 1 implies (x' - y' , x' - y') = 0, while (x', y') = -1 implies (x' + y' , x' + y') = O. Thus equality holds if and only if x' = ±y' . In the general case equality holds if and only if I(x', y') 1 = 1, so the condition of colinearity follows . QED Notice that the first inequality obtained, I(x, y) 1 < ((x, x) +(y, y) )/2, is in general weaker than the Cauchy-Schwartz inequality because the geometric mean (x, x) 1/2 (y, y) 1/2 is less than the arithmetic mean ((x, x) + (y, y) )/2. Thus the \"scaling\" part of the proof is indispen­ sible. 9. 1 Structures on Euclidean Space 363 We can now prove that the formula IIxll = (x, X)1/2 really defines a norm-incidentally giving the promised proof of the triangle inequality for the Euclidean norm, since we have already verifed that the Eu­ clidean inner product x . y is an inner product. Theorem 9. 1.2 Let (x, y) be an inner product on a vector space. Then IIxli = (x, x)1/2 is a norm. Proof: The positive definiteness of the inner product implies the positivity of the norm, and the homogeneity lIaxll = (ax, ax)1/2 = (a2(x, x) )1/2 = lal(x, x)1/2 = lalllxli follows from the bilinearity. The only nontrivial property is the triangle inequality, which we prove in its squared version, Ilx + Yl12 < (11xll + lIyll)2 = Ilx 112 + 211x II lIyll + Ilyll2, for we can then take the square root. Now (x + y, x + y) = (x, x) + 2(x, y) + (y, y) IIxl12 + 2(x,y) + IIYI12. Now by the Cauchy-Schwartz inequality Ilx+yl12 < IIxl12 +211xll llyll + IIyll2 as desired. QED It is a curious, and sometimes useful, fact that we can also express the inner product in terms of the norm. This is called the polarization identity: 1 (x, y) = 4(llx + Yl12 -llx _ yI12), which follows immediately by expanding Ilx±yl12 = (x±y,x±y) using the bilinearity. Of course not every norm is associated to an inner product (of the examples of norms on lRn, only the Euclidean one is), so the polarization identity does not make sense for an arbitrary norm. Norms that are associated to inner products satisfy the parallelogram law Geometrically this can be interpreted to say the sum of the squares of the diagonals of a parallelogram equals the sum of the squares of 364 Chapter 9 Euclidean Space and Metric Spaces the sides (see Figure 9. 1.3) . It is again a simple exercise to derive the parallelograph law for norms associated with an inner product. It is actually true that the parallelogram law characterizes such norms. If a norm satisfies the parallelogram law, then the polarization identity de­ fines an inner product, and the norm associated with the inner product is equal to the original norm. We leave the details as an exercise. Ilxll IIxl l Figure 9. 1.3: 9.1.3 The Complex Case A discussion of the structure of vector space, norm , and inner product would be incomplete without mention of the complex analogs because they have many important applications. A complex vector space is a space satisfying the axioms of a vector space with C as the field of scalars. This means that ax is defined for complex numbers a. A complex vector space may be thought of as a real vector space with ad­ ditional structure (multiplication by i = v=I) . The simplest example is en, the set of n-tuples z = (Zl ' Z2, .•. , zn) of complex numbers . This has complex dimension n since the basis vectors e(1) , •.. , e(n) of JRn also form a basis of en, Z = Zl e(l) + . . . + zne(n) . (Warning: regarded as a re- I trm h d' ' . 2 'th (1) (n) . ( 1 ) . (n) a vector space, \\I..... as ImenslOn n, WI e , ... , e ,'le , ... ,'le forming a basis. The paradox is explained because the definitions of linear independence and spanning involve the notion of linear combi­ nations, which refers to the scalar field.) The definition of norm on a complex vector space is the same as for a real vector space except that the homogeneity condition I laxll = lal llxli must hold for all complex scalars, where l al is the absolute value of the 9. 1 Structures on Euclidean Space 365 complex number a. The proof that a complex norm defines a metric via d(x, y) = Ilx - yll is the same as in the real case. The definition of complex inner product requires one important modification. In place of the bilinearity, we must introduce complex conjugates on one or the other side. (By convention mathematicians have chosen the right side and physicists the left.) This is referred to as Hermitian linearity, and it also spoils the symmetry. The conditions on (x, y) necessary for it to be an inner product in the complex case read as follows: 1. (x, y) = (y, x) (Hermitian symmetry) . 2. (ax + by, z) - a(x, z) + b(y, z) and (x, ay + bz) a(x, y) + b(x, z} (Hermitian linearity). 3. (x, x) is real and (x, x) > 0 with equality if and only if x = o. For en the usual inner product is (z, w) = zl WI + ... + znwn. It satisfies these conditions, as is easily verified. The associated norm is IIzll = (z, z)I/2, which is still a positive real number. Note that the homogeneity of the norm, lIazll = (az, az)I/2 = (aa(z, z) )1/2 = lal llzll, depends on the Hermitian form of the linearity since lal = (aa)l/2 but lal :I: (a2)1/2 for complex a. Now the Cauchy-Schwartz inequality I(z, w}1 < IIzll llwll is still valid for complex inner products, but the proof requires one additional twist. We begin, as in the real case, by expanding (z + w, z + w) > 0 and (z - w, z - w) > 0 to obtain (z, z) + (z, w) + (w, z) + (w, w) > 0 and (z, z) - (z, w) - (w, z) + (w, w) > O. Thus, (z, w) + (w, z) is real and satisfies I(z, w) + (w, z)1 < (z, z) + (w, w). However, we do not have (w, z) = (z, w) but rather (w, z) = (z, w) because of the Hermitian symmetry, so (z, w) + (w, z) = 2Re(z, w} (a+a = 2Rea for any complex number a) . Thus we have IRe(z, w)1 < (11z1l2 + Ilw1l2)/2 or, IRe(z, w)1 < 1 for IIzll = Ilwll = 1. Now for the twist: if we knew that (z, w) were real, then we would have Re(z, w) = (z, w) and, hence, I(z, w)1 < 1. The point is that we can always make 366 Chapter 9 Euclidean Space and Metric Spaces (z, w) real by multiplying z by the appropriate complex number of absolute value one without changing Ilzll. In other words, Ilazll = Ilzll if lal = 1 and if (z, w) = rei6 in polar coordinates, then the choice a = e-i6 makes (az, w) = a(z, w) = e-i6rei6 = r real, so I(z, w) I 1 I(az, w)1 = IRe(az, w)1 < '2(lIazll + Ilwl!) 1 - '2(lIzll + IIwll}· Thus I(z, w)1 < 1 for IIzll = IIwll = 1 and we can complete the proof in general by scaling as in the real case. The triangle inequality then follows by the same token: liz + wll2 (z + w, z + w) - (z, z) + 2 Re(z, w} + (w, w) < IIzll2 + 211zll llwil + IIwll2 _ (lIzll + IIwll)2 where we use the Cauchy-Schwartz inequality and the trivial inequality Re(z, w) < I (z, w)l. Incidentally, the polarization identity also must be modified in the complex case. It reads: We leave the verification as an exercise. 9.1.4 Exercises 1. Let u(l), u(2) , .. . , u(n) be any orthonormal basis (u(j) . u(k) = 0 if j # k, u(j) . u(j) = 1} in Rn . Prove that x = L:j=1 aju(j) where aj = x . u(j) and Ixl = (2:7=1 a;}1/2. 2. Verify that the sup norm on C([a, b) ) is a norm. 3. Verify that II/III = J: 1/(x}ldx on C([a, b) ) is a norm. 4. Prove that IIxllsup = liIllp-oo IIxllp on Rn. 9. 1 Structures on Euclidean Space 367 5. Verify that (/, g) = J: f(x)g(x) dx is an inner product on C([a, b]). What is the associated norm and metric? 6. Verify the polarization identity in both the real and complex cases. 7. Verify the parallelogram law. 8. ·Prove that if a norm Ilx li on a real vector space satisfies the parallelogram law, then the polarization identity defines an inner product and that the norm associated with this inner product is the original norm. 9. Prove that if IIxll is any norm on Rn , then there exists a positive constant M such that IIxll < Mlxl for all x in Rn where Ixl is the Euclidean norm. (Hint: M = (I:i=1 lIe{D 112) 1/2 will do.) 10. Prove that the norm Ilxlll on an for n > 1 is not associated with an inner product. (Hint: violate the parallelogram law.) Do the same for IIxllsup• 11. Prove that a real n x n matrix A satisfies Ax . Ay = x . y for all x and y in r if and only if IAxl = Ixl for all x in an . Such matrices are called orthogonal. 12. Prove that a real n x n matrix is orthogonal if and only if its columns form an orthonormal basis for Rn . 13. Prove that Ax . y = x . A ty where At denotes the transpose ma­ trix-obtained from A by interchanging rows and columns. 14. Let A denote any n x m matrix, and define IIA II - sup{IAxl : Ixl < 1}. Show that this is indeed a norm on the space of n x m matrices (regarded as an (n . m )-dimensional vec­ tor space). 15. Verify that d(x, y) = Ix - yl/(l + Ix - yl) defines a metric on an , but this metric is not induced by any norm. (Hint: homogeneity fails.) 368 Chapter 9 Euclidean Space and Metric Spaces 9.2 Topology of Metric Spaces 9.2.1 Open Sets In this section we want to discuss the generalizations of the concepts introduced in Chapter 3, including open set, closed set, compact set, limits, and completeness. It turns out that these concepts can be de­ scribed in terms of the most rudimentary structure on JRn , the metric space structure. In order to make this clear we will develop those con­ cepts for an abstract metric space. This doesn't really involve any more work, and it has many rewards, for there are other contexts in which these concepts are very useful. Recall that a metric space is simply a set M on which we have defined a distance function d(x , y) , real-valued, for x and y in M, sat­ isfying 1. d(x , y) > 0 with equality if and only if x = y (positivity) , 2. d(x , y) = d(y, x) (symmetry) , and 3. d(x , z) < d(x, y) +d(y, z) for any x, y, z in M (triangle inequality) . We begin by describing some examples so that we can refer the ab­ stract concepts to concrete situations. Our basic example is Euclidean space JRn with the Pythagorean metric We have also seen that JRn has other metrics, such as those associated with the norms Ilxl lsup and Il xl ll. Another important example is the space C( [a, bD of real-valued continuous functions on a compact interval [a, b] with the sup-norm metric d(j, g) = sUPx Ij (x) - g(x) l. Whenever we have one metric space we can immediately get many more by the simple device of restricting to a subset. If M is a metric space with distance function d(x, y) , then any subset M' C M be­ comes a metric space, called a subspace, with the same distance func­ tion d(x , y) (now x and y are restricted to lie in M'). Clearly there are many interesting metric subspaces of JRn (warning: the term \"subspace\" here is being used in a completely different way than in linear algebra, where a vector subspace must have the vector space properties) . We will find in particular that it is very useful to consider metric space 9. 2 Topology of Metric Spaces 369 concepts for subspaces of Euclidean space. Sometimes the restricted distance function for a subspace may not be the most natural one to consider. For example, the unit circle in the plane as a subspace of JR2 has a chord-length distance function, as illustrated in Figure 9.2. 1. It is not difficult to verify that arc-length distance makes the circle a metric space--a different but perhaps more natural metric space. We will return to this idea in a later chapter. For a completely different example of a metric, see exercise set 9.2.5, number 12. Figure 9.2.1: Now that we have some examples, we begin the topological theory. The analog of open intervals in JR will be played by the open balls Br(y) = {x : d(x, y) < r} where the radius r is p·ositive and the center y is an arbitrary point in the metric space. We follow the mathematical convention of using the word \"ball\" for the solid region and \"sphere\" for the boundary, {x : d(x,y) = r} . In the example of JRn for n = 2 or 3 these balls are what we normally think of as balls (or discs in JR2 ) with radius r and center y. In a general metric space, however, we cannot expect the balls to have any \"roundness\" . As a consequence of the triangle inequality, we can easily show that an open ball with center y also contains op en balls centered at all its other points. To be precise, if x is a point in Br (y) , thEm d (x, y) = rl < r and so Br-r1 (x) � Br (y) because if z is in Br-r1 (x) , then d (x, z) < r - rl , which implies d(y, z) < d(y, x) + d(x, z) 370 Chapter 9 Euclidean Space and Metric Spaces by the triangle inequality; so z is in Br (y) . (See Figure 9.2.2.) We will use this property to define a general notion of open set. Figure 9.2.2: Specifically, we define an open set in a metric space to be a set A with the property that every point in A lies in an open ball contained in A. This is equivalent to saying for every point y in A, Br (y) C A for some r > O. Notice that it suffices to consider only balls with radius 1/ m for some integer m, since r > 1/ m for some m by the axiom of Archimedes, so B1/m(y) C Br (y) . We define a neighborhood of a point to be an open set containing that point. For most applications we can restrict attention to the countable sequence B1/m (y) of neighborhoods of y. We define the interior of a set A to be the subset of all points in A contained in open balls contained in A. Thus A is open if and only if it equals its interior. From the definition it is clear that a nonempty open set (the empty set is open by convention) is a union of open balls and conversely. However, the open sets in JRn are quite complicated-there is no nice structure theorem as there is in JR1 , where every open set is a disjoint union of open intervals. Even more distressing, if we consider subspaces of JRn , the concept of open set changes. If M is a subspace of JRn , then the open balls of M are the sets {x in M : d( x, y) < r} for center points y in M. The open subsets of M are thus unions of these kinds of balls and need not be open in JRn . To make the distinction clear we sometimes refer to these sets as open relative to M or relatively open sets. The set M is always open relative to M but need not be open in JRn . Of course if M is open in JRn , then all open subsets of M are open 9. 12 Topology of Metric Spaces 371 in Rn . But in general all we can say is that the open subsets of M are the intersections of M with open subsets of an . None of this has to do specifically with an , so we prove it in general. Theorem 9.2.1 Let M be a metric subspace of a metric space MI ' Then a subset A of M is open in M if and only if there exists an open subset Al of MI such that A = Al n M. If M is open in M1 , then for subsets A of M we have A is open in M if and only if A is open in MI . Proof: If A C M is open in M, this means for every Y in A, Br (y) C A for small enough radius r. Here Br (y) refers to the metric space M and so is defined by Br{y) = {x in M: d{x, y) < r}. On the other hand we can also consider the ball of radius r centered at y in the larger metric space M1 , Br(Yh = {x in MI : d(x, y) < r}. Since the distance function is the same (this is the definition of metric subspace), we clearly have Br {Y) = M n Br {yh . In other words, the open balls in M are exactly the intersections of M with open balls in MI whose centers happen to lie in M. Now given an open set A in M, we construct the required set AI . Simply take Al to be the union of all the balls Br (Yh such that Br {Y) lies in A. Since Br {y) C A C M, we have Br {Yh n M = Br {y)j so Al n M is the union of all the balls Br (Y), which equals A from the defining property of A being open in M. Also Al is clearly open in MI because it is a union of open balls. Thus we have constructed an open subset Al of MI , such that Al n M = A. Incidentally, we are not claiming that such a set Al is unique. Conversely, if Al is an open subset of MI , then A = Al n M is an open subset of M. Indeed if y is in A, then Br(Yh � Al for small enough radius r because Al is open and y is in AI . Then so A is open in M. 372 Chapter 9 Euclidean Space and Metric Spaces Finally if M itself is open in Mb then Br {Yh = Br{y) for small enough r {depending on y} for each y in M. Thus the conditions that A be open in M and MI are the same: for all y in A, Br {y) = Br (Yh must lie in A for r small enough. QED The basic closure properties of open sets on the line are true in general. Theorem 9.2.2 In any metric space, an arbitrary union of open sets is open and a finite intersection of open sets is open. Proof: These are immediate consequences of the definition. If A is any set of open subsets A of M, we want to show U.A A is open. Since the union consists of all points that lie in at least one of the set A, given any point x in the union there is a set A in A containing x. Since A is open, it contains Br (x) for small enough radius rj so Br (x) is contained in the union, proving the union is open. Next consider a finite intersection A = Al n A2 n ... n Am, where each Ak is open. If x is in A, then x is in each Ak; hence, Brie {x} C Ak for some positive rk because Ak is open. Taking r to be the minimum of rb . .. ,rm {r is positive because there are only a finite number of rk's} we have Br {x} C Brie (x) C Ak for every kj so Br {x) C A, proving A is open. QED In the more general theory of topological spaces, the closure prop­ erties of this theorem together with the trivial property that the empty set and the whole space are open are taken as axioms for the open sets. That is, a topological space is defined to be any set with a col­ lection of open subsets satisfying those axioms. A metric space then becomes a special case of a topological space with the open sets given by the definition we have chosen. It is possible to fntroduce many of the concepts we are discussing in the still more abstract setting of gen­ eral topological spaces, but we have chosen not to do this here because all the examples we need to deal with are in fact metric spaces. There are, however, topological spaces that are not metric spaces, and some of these are important in more advanced analysis. 9. 2 Topology of Metric Spaces 9.2.2 Limits and Closed Sets 373 Next we discuss the concept of limit in a metric space. If X l , X2 , .. . is a sequence of points in M, then we say the sequence has a limit X in M (or the sequence converges to x), written Xn 4- x or limn_oo Xn = x, provided that for any error 11m there exists N such that n > N implies d(xn' x) < 11m. An equivalent way of saying this is that every neighborhood of x contains all but a finite number of xn . This is the identical definition we gave for limits in 1Rj we have simply replaced the distance IXn - xl in 1R with the distance function d(xn' x) in M. Again we have the bull's eye picture of the neighborhoods BI/m (x), as shown in Figure 9.2.3, and the points in the sequence must eventually end up in each neighborhood. Figure 9.2.3: In a similar way we define limit point of. a sequence, this time re­ quiring infinitely many Xn to be in each neighbor hood of x. Just as in the real case, this is equivalent to a subsequence converging to x. A limit point of a set A is a point x such that every BI/m (x) contains a point of A different from x-hence, infinitely many points of A. A set A is said to be closed if it contains all its limit points. The closure of a set is the union of the set and all its limit points. The closure is always 374 Chapter 9 Euclidean Space and Metric Spaces a closed set, and a set is closed if and only if it equals its closure. These are all straightforward to verify. We say a subset A of B is dense in B if the closure of A contains B. Theorem 9.2.3 A subset of a metric space is closed if and only if its complement is open. Proof: Let A be open and B be its complement. To show B is closed we need to show it contains its limit points. So let x be a limit point of B. To show x is in B we must show x is not in A since B is the complement of A. But if x were in A, then BT (x) C A for the radius r sufficiently small since A is open. But this contradicts the fact that x is a limit point of B, for every BT(X) must contain points of B. Therefore x is not in A, hence in B. Now conversely assume B is closed and A is its complement. We want to show A is open. So given any point x in A, we want to show Br(x) C A for some r. If not, then Br(x) would contain points of B (not equal to x) for all r, hence x would be a limit point of B. Since B is assumed closed, it would have to contain x, contradicting the fact that x is in A. Thus Br {z) C A for some r, proving A is open. QED From this we can conclude that finite unions and arbitrary intersec­ tions of closed sets are closed. We could also prove this directly from the definition. 9.2.3 Completeness One very important fact that we learned about convergence in R. is that a sequence converges if and only if it satisfies the Cauchy criteri­ on. In an arbitrary metric space we can define a Cauchy sequence as follows: for every error 11m there exists N such that j, k > N implies d(xj, Xk) < 11m. It is easy to see that a convergent sequence is always a Cauchy sequence because once d(Xk' x) < 112m for all k > N it follows that d(xj, Xk) < 11m for j, k > N by the triangle inequality. However, the converse is not true for the general metric space. For example it is not true for the rational numbers, which is a metric subspace of R.. A metric space is called complete if every Cauchy sequence is convergent. We will show that Rn is a complete metric space. This will be easy once we show that convergence in an is equivalent to convergence in each 9. 2 Topology of Metric Spaces 375 coordinate. Here we follow the notational conventions of the previous section. Theorem 9.2.4 Let x(1 ) , X (2) , ... be a sequence of points in }Rn . Then x( 1) , x(2) , .•. converges to a limit x if and only if the sequence of real ( 1) (2) numbers xk ,xk , ... converges to Xk for k = 1 ,2 , ... ,n . Proof: The idea of the proof is that we can fit a circle in a square and a square in a circle (or more precisely, the n-dimensional analog) . We essentially proved this result for n = 2 when we showed convergence in C was equivalent to convergence of the real and imaginary parts. Suppose first limj-+oo x(j ) = x exists. Given any error 11m there exists N such that j > N implies d(xU) ,x) < 11m. Since lak l < (L:;=1 IapI2 ) lj2 , we have Ix�) - xkl < d(x(j ) , x), so Ix�) - xk l < 11m for j > N and so limj-+oo x�) = Xk. This is the circle in the square part. Conversely, suppose limj-+oo x�) = Xk for each k. Then given any error 11m we can find Nk such that j > Nk implies I (j) I 1 xk - X k < vn m ' By taking N to be the largest of the Nk we have j > N implies Ix�) - Xk I < II vnm for all k. Then-square in the circle- for j > N, so limj-+oo x(j) = x. QED Corollary 9.2.1 lRn is a complete metric space. 1 m Proof: Let x( 1 ) , x(2) , ... be a Cauchy sequence. Then by the theo­ rem, x�l) , x�2) , .•. is a Cauchy sequence of real numbers for each k. By the completeness of the reals each of these sequences has a limit, say limj-+oo x� ) = Xk . Then limj-+oo xU) = x = (X l , ... , xn ), also by the theorem. QED Another interesting example of a complete metric space is C ([ a, b] ). 376 Chapter 9 Euclidean Space and Metric Spaces Theorem 9.2.5 C( [a, b] ) with the sup-norm metric is a complete met­ MC space. Proof: This theorem is really just a reformulation of the Cauchy criterion for uniform convergence (Theorem 7.3. 1). In fact, we claim that convergence in the sup-norm metric is the same as uniform con­ vergence. Indeed convergence in the sup-norm metric means given any error 11m there exists N such that k > N implies sUPx Ilk(X) - l(x) 1 < 11m, which is the same as saying there exists N independent of x such that k > N implies Ilk (X) - l(x) 1 < 11m for every x, which is uniform convergence. The same reasoning shows that the Cauchy criterion for a sequence {In} in the sup-norm metric is identical to the uniform Cauchy criteri­ on: given any error 11m there exists N such that l/j (x) - Ik(X) 1 < 11m for all x provided j, k > N. Thus any Cauchy sequence in the sup-norm metric converges uniformly to a function I that is continuous (being the uniform limit of continuous functions), which is the same as saying In --+ I in the sup-norm metric. QED It is important to realize that this result concerns just the sup­ norm metric on the space C( [a, b] ). There are other metrics, such as the L1 metric d(/, g) = J: I/(x) - g(x) ldx on the same set C( [a, b] ) for which completeness fails. In fact the sequence of continuous function­ s converging pointwise to a discontinuous function gives an example of a Cauchy sequence in this metric with no limit in C( [a, b] ). See the exercises for details. The L1 metric is associated to a norm and will be discussed in detail in Chapter 14. In a finite-dimensional vector space every metric associated to a norm is complete, so it is the infinite­ dimensional nature of the space C( [a, b] ) that is crucial in this example. The kind of incompleteness here is different in nature from the incom­ pleteness of the rationals in that there are no \"holes\" in between points of the space. Any metric space that is not complete can be completed by a pro­ cess completely analogous to the procedure whereby we constructed the real numbers from the rationals. The completion M of M is de­ fined to be the set of equivalence classes of Cauchy sequences of points in M-where equivalence is defined in exactly the same way as with 9. � Topology of Metric Spaces 377 numerical sequences. We regard M as a subset of M by identifying the point x in M with the equivalence class of the sequence (x, x, ... ) ­ exactly the way we regarded the rationals as a subset of the reals. We can make M into a metric space by defining the distance between the equivalence class of x} , X2, . .. and the equivalence class of Yl, Y2, . . . to be limn_co d(xn' Yn). This definition requires that we verify: 1) the limit exists, 2) the limit is independent of the choice of sequences from the equivalence classes, and 3) the distance so defined satisfies the ax­ ioms for a metric. All these verifications are routine. A general metric space M has no further structure, so we can't say any more about M. But if M happens to be a vector space and the metric is associated to a norm or an inner product on M, then we can extend the norm or inner product structure to M. Finally we can prove that M is com­ plete, justifying the terminology. Again the proof of the completeness of M is completely analogous to the proof of the completeness of R. A complete normed vector space is called a Banach space, and a com­ plete inner product space is called a Hilbert space. The study of these structures forms an important part of twentieth century analysis, but it is beyond the scope of this work. It should be pointed out that the abstract construction of the com­ pletion M sketched above is not always very satisfactory. Frequently we want a more concrete description of M. For example, in the Ll metric d(f, g) = J; lf(x) -g(x)ldx on C([a, b]), the completion is essentially the space of Lebesgue integrable functions. However, the construction of Lebesgue integration theory is much more difficult than the abstrac­ t completion-indeed the abstract completion does not enable you to identify the elements of the completion space as certain functions on [a, b), while the Lebesgue theory does. For this reason we will not discuss completions in more detail. 9.2.4 Compactness The idea of compactness is important in the general setting of metric spaces and an in particular. The definition of a compact subset A of a metric space is that every sequence ai , a2, . .. of points in A has a limit point in A (or, equivalently, has a subsequence that converges to a point in A). Notice that the definition refers only to the points in A and to the distance function between points of A, but it does not refer 378 Chapter 9 Euclidean Space and Metric Spaces to points not in A. Thus it is the same thing to say A is a compact subset of M or A is a compact subset of N if N is any subspace of M containing A (remember that \"subspace\" implies the metric is the same) . Thus compactness is an absolute concept, unlike \"open\" and \"closed\" , which depend on the whole space. In particular we say that a metric space M is compact if M is a compact subset of itself or, in other words, if all sequences of points in M have' limit points in M. Then A is a compact subset of M if and only if A as a subspace is a compact metric space. Clearly there is a close connection between the concepts of com­ pactness and completeness, since both refer to the existence of limits of sequences. In fact it is easy to see that compactness implies complete­ness, but completeness does not imply compactness. Indeed suppose M is compact . To show that M is complete, consider any Cauchy sequence Xl, X2 , • • •• We need to show it has a limit in M. By the compactness it has a limit point in M, and it is easy to show that the Cauchy criterion then implies that the limit point is actually a limit (see exercises) . On the other hand, IR is already an example of a complete metric space that is not compact. As in the case of subsets of 1R, compactness is also equivalent to other conditions. The most important is the Heine-Borel property: every open covering has a finite subcovering. The definitions are the same as in the case of subsets of It If A is a subset of M, we say B, a collection of subsets B of M, is a covering of A if Us B :::> A and an open covering if all the sets B are open sets in M. A subcovering simply means a subcollection B' of B that still covers A. Notice now that there are two ways in which we can interpret the Heine-Borel property-in the metric space M and in the metric sub­ space A. They are somewhat different but turn out to be equivalent. The reason is that \"open\" means different things for subsets of A and subsets of M. If we were to consider the Heine-Borel property with respect to A we would have to consider coverings of A by open subsets of A. If B is an open subset of A, it is not in general an open subset of M. Thus a covering of A by open subsets of A is not a special case of a covering of A by open subsets of M. Nevertheless, because of the relationship between open subsets of A and M, we know that if B is a covering by open subsets of A, then by extending each B in B to iJ an open subset of M (with iJ n A = B), we obtain covering B by 9.2 Topology of Metric Spaces 379 open subsets of M. Conversely we can intersect open subsets of M with the set A to obtain open subsets of A, and by doing this to each set in a covering of A by open subsets of M we can obtain a cover­ ing of A by open subsets of A. In this way we can go back and forth between the two Heine-Borel properties and show they are equivalent (see exercises) . Theorem 9.2.6 (Abstract Heine-Borel Theorem) A metric space (or a subset of a metric space) is compact if and only if it has the Heine-Borel property. Proof: Many of the ideas of the proof have already been given in the proof of the analogous theorem for sets of real numbers. We start by proving that the Heine-Borel property implies compactness. Thus we need to show that an arbitrary sequence Xl, X2 , ... of points in A has a limit point in A. We may assume without loss of generality that all the points Xl , X2, . . . are distinct. We want to show that not having a limit point would contradict the Heine-Borel property. To do this we construct a cover of A by the sets BI , B2, ... where BI is A with the sequence Xl , X2, ... removed, B2 is A with X2, X3, .. . removed, and in general Bk is A with Xk, Xk+l, ... removed. Clearly the sets {Bk } cover A, and no finite subcovering exists. But are the sets Bk open in A? The answer is yes because we are assuming the sequence XI , X2,' .. (and hence Xkl Xk+l ... ) has no limit points. Since the sequence Xk, Xk+l , . . . has no limit points, it is a closed subset of A (the definition of closed is vacuously satisfied) , so its complement Bk is open. Thus the Heine-Borel property is not satisfied, proving half the theorem by contradiction. Conversely, suppose A is compact. We want to show that the Heine­ Borel property holds. Let us first show that every countable open cover has a finite sub cover-and afterward we will reduce the general case to this one. Let the sets in the cover be BI , B2 , . . .. If there were no finite subcover, then each of the sets BI , BI U B2 , ... , BI U B2 U··· U Bn, ... would fail to cover A. Thus there would be points aI , a2, ... in A with an not in BI U ... U Bn. By the compactness of A there must be a limit point a of the sequence aI , a2 , . .. in A. For any fixed n, the tail of the sequence an, an+l, an+2 , . .. consists of points not in Bn; and since the complement of the open set Bn is closed, it must contain its 380 Chapter 9 Euclidean Space and Metric Spaces limit point a (of course a separate-more trivial-argument must be given if infinitely many of the Cln equal a) . Thus a is not in any Bn, contradicting the fact that Bl, B2,\" . was supposed to be a cover of A. To reduce the case of an arbitrary open cover to a countable one we need the fact that a compact metric space has a countable dense set (without the assumption of compactness this is not necessarily true of an arbitrary metric space-although it is true of an arbitrary subspace of the reals, or of Rn ). We will prove this as a separate lemma following this proof. Assuming it is true, let us denote by Xl, X2,' . . this countable dense set and consider the countable collection of balls Bl/m (xn) of radius 11m about Xn, where m and n vary over all positive integers. The idea is to reduce an arbitrary cover to a cover that is in one-to-one correspondence with a subset of this countable collection of balls­ hence will be a countable (or finite) subcover. To do this we start with the original cover B and choose one set B containing Bl/m(xn), if any such sets exist. This requires the countable axiom of choice, one arbitrary selection from each of the sets {B in B containing Bl/m(xn)}. This gives us a countable (or finite) sub collection B' of B. Why does it cover A? Let a be any point in A. Since B covers A, there must be a set B in B containing a. Since B is open, it must contain a neighborhood of a. Now since XIt X2, .. . is dense in A, we can find points in the sequence arbitrarily close to a, and it follows easily that one of the balls B1/m(xn) contains a and is contained in B (if say B2/m ( a) � B, then by choosing d(xn, a) < 11m we have a in Bl/m(xn) and Bl/m(xn) � B2/m (a) C B), as shown in Figure 9.2.4. Since Bl/m(xn) � B for some B in B, by the definition of B' there is a set in B' also containing Bl/m(xn) and, hence, a since a is in Bl/m (xn). Thus B' covers A. To complete the proof of the theorem we need only prove the following lemma. Lemma 9.2.1 Any compact metric space has a countable dense subset. Proof: Choose any point for X 1 . For X2 we choose any point not too close to Xl. We let R be the sup of d(XI' x) as X varies over the space and require that d(Xl ' X2) > R12. The fact that R is finite follows from the compactness, since otherwise there would be a sequence Yl , Y2, ... with limn_ co d(Xl, Yn) = +00, and no subsequence of Ylt Ym ' . . could converge-for yj -t Y would imply d(Xl' yj) < d(xlt y) + d(y, yj) 9. 2 Topology of Metric Spaces 381 Figure 9.2.4: remains bounded since d(y, yj ) -t 0 and d(XI ' y) is a fixed constant. Having chosen Xl and X2 , we choose X3 so that both d(XI ' X3 ) and d(X2' X3) exceed R2/2, where R2 is the sup of the minimum of d(XI ' x) and d(X2' x) as x varies over the space. In this way X3 is not too close to either Xl or X2. Proceeding inductively, having chosen Xl , ... ,Xn we let Rn be the sup of the minimum of d(X I ' x), ... , d(xn' x) as x varies over the space. As long as there are an infinite number of points in the space (if there were only a finite number there would be nothing to prove) there are always points x not equal to any of Xl , ... ,Xn, so Rn is not zero. And Rn is finite since it is always < R. We can think of Rn as measuring the furthest one can possibly get away from all the points Xl, ... ,Xn in the space. We then choose for Xn+l any point such that d(Xb xn+d > Rn/2 for all k = 1, 2, ... ,n. This construction requires the countable axiom of choice. So far we have merely obtained a sequence Xl , X2,' .. that is \"spread out\" over the space. Our argument did not use the compactness of the space in any essential way (only boundedness) . Now we are going to use the compactness to show that the set Xl , X2, ... is in fact dense. First we need to show that limn-+oo Rn = O. Note that the choice of Xn+l required that d(Xn+b Xk) > Rn/2 for k < n; so if we did not have limn-+oo Rn = 0, then there would exist c > 0 such that d(xj , Xk) > c for all j and k (j ust take c = 1/2 1imn-+oo Rn, the limit existing because Rn 382 Chapter 9 Euclidean Space and Metric Spaces is decreasing) . But then no subsequence could converge, contradicting the compactness. Thus limn_oo Rn = O. To show that X l , X2 ,' •• is dense, choose any point X in the space. Given any 11m we need to find Xn with d(x, xn) < 11m. Choose n large enough so that Rn < 11m. Then d(x, Xk) < 11m for some k < n or else by the definition of Rn we would have Rn > 11m. QED In the course of the proof we have established several properties of compact metric spaces that are of interest on their own. The first is boundedness. We can express this in two different but equivalent ways: 1) there exists a point X in the space such that d(x, y) < R for every y in the space, or BR (X) is the whole space. The inf of such R defines the radius of the space with respect to x. The triangle inequality then implies that the radius is finite with respect to every point in the space, < 2R in fact. 2) Let D = SUPx,y d(x, y) be the diameter of the space. The diameter is finite if and only if the radius is finite, with R < D < 2R no matter which point we use to compute the radius. These are immediate consequences of the triangle inequality. In addition to boundedness, compact metric spaces have the prop­ erty that given any 11m there exists a finite set of points Xl , .. . , Xn such that every point x is within a distance 11m of one of them. This was established in the course of the proof of the lemma. Notice that it says Bljm (x), . .. , BI/m (xn) covers the space, so it is also an immediate consequence of the Heine-Borel property. We have seen that a compact metric space must be bounded and complete. Here the completeness is playing the role of \"closed\" for subsets of the reals. In the abstract setting, saying that a set is closed may have no significance-if the whole space is being considered, then it is always closed. The connection between \"complete\" and \"closed subset of the reals\" is explained by the following simple fact, whose proof we leave as an exercise: a subspace A of a complete metric space M is itself complete if and only if it is a closed set in M. -Since the reals are complete, the closed subsets (as metric subspaces) are the same as the complete subspaces. It is natural to pose the question: if a metric space is complete and bounded, is it necessarily compact? For subsets of the reals we have seen this is true, but in general it is false. Before giving a counterexam­ ple, let us first show that the analogous statement in Euclidean space 9. � Topology of Metric Spaces 383 Rn is true. Theorem 9.2.1 A subspace of Rn is compact if and only if it is closed and bounded. Proof: Since we have already seen that a compact set is closed and bounded, it remains to show that if A is a closed and bounded subset of an , then it is compact. Thus let x(l), x(2), ••. be any sequence of points in A. Since A is bounded, the sequence of coordinates x�l), x�2), . . . must also be bounded, for each fixed k, 1 < k < n. Thus each of these sequences of reals has a limit point and, hence, a convergent subsequence. By taking subsequences of subsequences we can arrange fi d . I b 11' (1) (2) h h (1) (2) to n a smg e su sequence, ca It y , Y , ..• suc t at Yk , Yk , .. • converges, for each k, 1 < k < n. Since convergence in each coordinate implies convergence in Rn , the subsequence Y( 1) , y(2) , • .. converges to some limit y in Rn . Since A is closed, the limit must be in A. This shows A is compact. QED The complete metric space C([a, b)) with sup-norm metric d(f,y) = sup If(x) - g(x)1 :r provides us with examples of subspaces that are closed (hence com­ plete) and bounded but not compact. To see this, let !I, f2, . . . be a sequence of continuous function converging pointwise to a discontin­ uous function; for example, on [-1, 1], we could take In as shown in Figure 9.2.5. Let A be the set {!I, f2,\" '} in C([-I, 1)). A is bounded because d(fn , O) < 1. A is closed because it has no limit points-any sequence from A converges pointwise to a discontinuous function and so cannot converge uniformly (remember uniform convergence is the met­ ric convergence) to a continuous function. But A is not compact, since as we have just seen 11 , h, . .. is a sequence from A with no convergent subsequence. We can now give an interpretation of the Arzela-Ascoli theorem in terms of compactness in C([a, b]). Recall that the Arzela-Ascoli theo­ rem says that a sequence of functions in C([a, b)) that is both uniformly bounded and uniformly equicontinuous has a uniformly convergent sub­ sequence. Now suppose A is any subspace of C([a, b]) that is 1) closed, 384 -1 Chapter 9 Euclidean Space and Metric Spaces �--- f\" lin 1 Figure 9.2.5: 2) bounded, and 3) uniformly equicontinuous (for every l/m there ex­ ists l/n such that for every f in A and x and y in [a, b) with Ix - yl < l/n, we have If{x) - f(y)1 < l/m). Given any sequence of functions in A, 2) and 3) imply by the Arzela-Ascoli theorem that there exists a uniformly convergent subsequence, and the limit is in A by 1). Thus A is compact. Conversely, if A is a compact subspace of C([a, b)), then it must satisfy 1), 2), and 3). Indeed, we have already seen that a compact set is closed and bounded; the uniform equicontinuity is a consequence of the Heine-Borel property. We leave the details as an exercise. Thus we have a complete characterization of the compact subspaces of C([a, b)). 9.2.5 Exercises 1. If Xn � x in a metric space and y is any other point in the space, show liIIln_oo d(xn' y) = d(x, y). 2. If Xn � x and Yn -+ y in a metric space, show liInn-oo d(xn' Yn) = d(x, y). 3. Prove that the metric d(f, g) = J: lf(x) - g(x) ldx on C([a, b)) is not complete. (Hint: consider the example of a sequence of con­ tinuous functions converging pointwise to a discontinuous func­ tion.) 4. Prove that the space of bounded sequences with metric d{ {xn}, {Yn}) = sUPn IXn - Ynl is complete, and the same is true on the subspace of sequences converging to zero. 9. 2 Topology of Metric Spaces 385 5. Prove that if a Cauchy sequence in a metric space (not assumed to be complete) has a limit point, then it has a limit. 6. Prove directly that if A is a subspace of M, then the Heine-Borel property for A as a subspace of M (open meaning open in M) is equivalent to the Heine-Borel property for A as a subspace of A. 7. Prove that a metric space is compact if and only if it is bounded, complete, and given any 11m there exists a finite subset X l , ... ,Xn such that every point X in the space is within 11m of one of them (d(x, Xk) < 11m for some k, 1 < k < n) . 8. Prove that a subspace of a complete metric space is complete if and only if it is closed. 9. Construct a sequence of functions il , 12, ... in C([O, 1] ) with sup­ norm metric such that d(/b 0) = 1 and d(/j , Ik ) = 1 for any j and k. 10. Show that any compact subspace of C( [a, b]) in the sup norm is uni­ formly equicontinuous. (Hint: for each 11m consider the covering by Bn = {f in C([a, b]) : Ix - yl < lin implies If(x) - f(y) 1 < 11m}.) 11. Prove that if Al :J A2 :J A3 :J .. . is a nested sequence of non­ empty compact subsets of a metric space, then n�=l An is non­ empty. 12. *a. Let Z denote the integers, and let p be any fixed prime. Every integer z can be written uniquely base pas ±aNaN-I . .. al aO N ' k where 0 < aj < p - 1 and z = ± 2:j=o ajrY . Let Izlp = p- , where k is the smallest integer for which ak i= O. Prove that d( x, y) = I x - yip is a metric. (It is called the p- adic metric. ) b. Show that the p-adic metric satisfies d(x, z) < max(d(x, y), d(y, z)). (Metrics with this property are called ultra metrics. ) c. Show that the Euclidean metric on :lR3 is not an ultra metric. d. Show that the completion of the integers with the p-adic metric can be realized concretely by infinite base p integers 386 Chapter 9 Euclidean Space and Metric Spaces ± ... anan-l .. . al where 0 < an < p - 1 and that the ordi­ nary rules of addition and subtraction make the completion a group (called the p-adic integers) . 13. Give explicitly a countable dense subset of Rn . 14. Call two metrics dl and d2 on the same set M equivalent if there exist positive constants CI ,C2 such that d1 (x, y) < c2d2 (x, y) and d2 (X, y) < Cl d1 (x, y) for all x and y in M. Prove that Xn � x in dl-metric if and only if Xn � x in d2-metric, if dl and d2 are equivalent. 15. Prove that equivalent metrics have the same open sets. Give an example of two metrics on lR that have the same open sets but are not equivalent. 16. Prove that the metrics on an associated to the norms Ix lsup and Ixl l are equivalent to the usual metric. 17. Which subsets of lRn are both open and closed? 18. Prove that the intersection of an open subset of ]R2 with the x-axis is an open subset of the line. 19. Let S denote the circle x2 + y2 = 1 in lR2 . For points on S define the distance to be the length of the shortest arc of the circle joining them. Prove this is a metric. Is it the same metric as that of S as a subspace of ]R2 ? Can you describe the distance function in terms of the angular parameter 9 in the representation (cos 9, sin 9) of points on 8? 9.3 Continuous Funct ions on Metric Spaces 9.3.1 Three Equivalent Definitions In this section we are going to discuss functions whose domains and ranges are metric spaces. Although most of the examples we deal with will concern only subspaces of Euclidean space, it is instructive to see the theory in the more abstract setting. The proofs are certainly no more difficult, and there are many applications in which other metric 9. 3 Continuous Functions on Metric Spaces 387 spaces are involved. Since we have had the experience of studying functions whose domains and ranges are subsets of the reals, we will find many of the concepts and proofs familiar. On the other hand there will also be a few new ideas. We introduce the notation f : M � N to mean f is a function whose domain is M and whose range is N, where both M and N are metric spaces. The image f(M) is the set of all values actually assumed by f, f{M) = {y in N: there exists x in M with f{x) = y}. It is a subset of N, not assumed equal to all of N. If it is all of N we say I is onto. We are interested primarily in continuous functions, and as in the case of numerical functions there are several equivalent definitions. We list three important definitions, all familiar: 1. For every 11m and every Xo in M there exists lin such that d{x, xo) < lin implies d{f{x), f(xo)) < 11m. 2. For all sequences in M, if Xl , X2, ••• converges in M, then I{xd, f{X2), .. . converges in N. 3. The inverse image 1-1 (B) of any open set B in N is an open set in M. Note that in definition 1 the distance function d(x, xo) refers to the metric on M, while d(/(x), /(xo)) refers to the metric on N. We will not burden the notation with this distinction. Of course definition 1 is the continuity at the point Xo for each point Xo in the domain. We occasionally will need the notion of continuity at a point-the condition in definition 1 for an individual Xo. In definition 2 we do not need to add the condition I{limn_oo xn) = limn_oo I(xn), but this will be an immediate consequence of shuffling X = liIIln-+oo Xn into the sequence. We can paraphrase definition 2 as saying f preserves limits. In the case of numerical functions we only discussed definition 3- inverse images of open sets are open-for functions whose domains were open subsets of lIt The reason for this is that we had not yet discussed the concept of open subset of M where M is a subspace of R. Of course when M is an open subset of IR the open subsets of M are the subsets of M that are open in 1R, so there is no difficulty. When M is not open in R, the meaning of \"1-1 (B) is open in M\" is exactly what it says, open in M, not necessarily open in R.. Thus the general viewpoint enables 388 Chapter 9 Euclidean Space and Metric Spaces us to improve our understanding even in the concrete setting of subsets of R. On the other hand, it is immaterial whether we take the range N as given, or reduce it to the image f(M}, or enlarge it to some space containing N, as long as we keep the same metric on the image. The reason for this is that f-l (B} is the same as f-l (B n f(M}}, because only points of B in the image of f contribute to the inverse image. Thus as B varies over the open subsets of N, B n f{M) varies over the open subsets of the image f (M)-and the same inverse images occur. We can take any one of the three conditions as the definition of f is continuous on M, since we will now show they are equivalent. Theorem 9.3. 1 For a function f : M � N, the three definitions above are equivalent. Proof: First we show the equivalence of definitions 1 and 2. Suppose definition 1 holds, and let Xk � Xo in M. We want to show f(Xk) � f{xo} in N. Given any error 11m we use definition 1 at Xo to find lin such that d{x, xo) < lin implies d{f{x}, f{xo)) < 11m. Then from Xk � Xo we know there exists j such that k > j implies d(Xkl xo} < lin. Thus d{f{Xk), f{xo)) < 11m for k > j, which proves f(Xk} � f{xo} and, hence, definition 2. Conversely, assume definition 2 holds. By shuffling Xo = limk-+oo Xk into the original sequence Xo, Xl , Xo, X2, Xo, X3, ... we still have a conver­ gent sequence, and hence by definition 2 f(xo}, f{xd, f{xo}, f(X2}, . . . is also convergent, which can only happen if limk_oo f (Xk) = f(xo}. Thus definition 2 implies the stronger statement \"Xk � Xo implies f{Xk} -+ f{xo)\" . Now let's establish definition 1 at the point Xo. Sup­ pose it were false. Then there would exist 11m such that for every lin there exists Xn such that IXn - xol < lin but If(xn} - f(xo) 1 > 11m. The sequence Xl ! X2, ... clearly violates definition 2, since Xn � Xo but f (xn) does not converge to f (xo). Next we show the equivalence of definitions l and 3. Assume first definition 1 holds, and let B be any open set in N. We have to show f-l (B} is open. So let Xo be in f-I {B}j this simply means f{xo} is in B. We need to find a ball Br{xo) contained in f-l(B}. Since B is open, it contains a ball BI/m(f(xo)} about f(xo}, and by definition 1 there exists lin (for that 11m and xo) such that Ix - xol < lin {x in 9. 3 Continuous Functions on Metric Spaces 389 B1/n(xo)) implies I/(x) - l(xo)1 < 11m (/(x) in B1/m(/(xo)}}. Thus the ball B1/n(xo} lies in 1-1 (B}. Conversely, assume definition 3 holds. Given the point Xo and 11m, we look at the inverse image of the ball B1/m(/(xo}}. Since B1/m(l(xo}) is open in N, f-1(B1/m(f(xo))) is open in M by definition 3. Now Xo belongs to this inverse image since I(xo) is in B1/m(J(xo)); so by the definition of open set in M there is a ball B1/n(xo} contained in the inverse image J-1 (B1/m(/(xo))), or x in B1/n(xo) implies I(x) is in B1/m(J(xo)). This is just another way of writing definition 1. QED We note some simple properties of continuity that are easily de­ duced from the definition. If f : M -+ N and 9 : N -+ P are con­ tinuous, then 9 0 1 : M -+ P is continuous. If f : M -+ Rn and 9 : M -+ Rn are continuous, then 1 + 9 : M -+ Rn is continuous. If 1 : M -+ Rn and 9 : M -+ R are continuous, then 9 . J : M -+ Rn is continuous. If 1 : M -+ N is continuous and Ml C M is any sub­ space, then the restriction of 1 to Ml is continuous. If 1 : M -+ Rn and we define the coordinate functions Jk : M -+ R for 1 < k < n by f(x) = (h(x}, ... , fn(x)), then f is continuous if and only if all the fk are continuous. We leave the verification of these facts as exercises. In the special case where the domain and range are Euclidean s­ paces, or subspaces of Euclidean spaces, it is important to have a rich collection of continuous functions. We have already observed that the range space can be split into coordinate components, so it is really enough to consider the case 1 : Rn -+ R. The simplest nontrivial exam­ ples are the coordinate projection maps Ik(X) = Ik(Xb ... , xn} = Xk. These are easily seen to be continuous by the preservation of limits cri­ terion. From these, using composition and arithmetic operations, we can establish the continuity of all \"elementary\" functions-functions for which we have a finite formula-provided we restrict the domain to all points for which the formula defining the function makes sense. The class of polynomials on Rn is the class of functions built up by addition and multiplication from the coordinate projections and the constants. Writing these in concise notation is difficult, but the fol­ lowing multi-index convention seems to work extremely well. Let a = (al , ... ,an) denote an n-tuple of non-negative integers (each ak can equal 0, 1, 2, ... ), and let xQ = xr1 X�2 ••• x�n . Then p(x) = 2: cQxQ, where the sum is finite and CQ are constants, is the general polynomial 390 Chapter 9 Euclidean Space and Metric Spaces on lRn . We further let lal = al + a2 + . . . + an (note this is a different notational convention from the usual Pythagorean metric on JRn ). We call xQ a monomial of order or degree lal, and we call the order of the polynomial the order of the highest monomial appearing in it with non-zero coefficient (frequently we are sloppy in saying \"a polynomial of order m\" when we really mean \"a polynomial of order < m\" ) . In dealing with functions defined in an or subsets of ]Rn , it is tempt­ ing to think of the variable x = (Xl, \" ., Xn) as consisting of n distinct real variables Xl, X2 , ••• ,Xn. In particular, we can hold n - 1 of them fixed and vary just one, obtaining a function of one variable. We could hope to reduce questions about a single function of n variables to ques­ tions about the many functions of one variable that arise in this fashion. However, while there are some situations in which this technique proves useful, in general it is very misleading. To understand why, we have only to consider the case n = 2, where we can visualize the domain as the plane. By fixing one variable and varying the other, we sweep out all the horizontal and vertical lines in the plane. The function 1 (x 1, X2 ) considered as a function of Xl with X2 fixed is then the restriction of 1 to the horizontal line X2 = a. Thus our seductive suggestion is to try to reduce questions about 1 to questions about its restriction to all horizontal and vertical lines. This may not be too helpful if we need to compare the values of 1 at two different points that are not on the same horizontal or vertical line. Let's look at continuity from this point of view. It is easy to see that the continuity of 1 : Rn -T R implies the continuity of the restriction of 1 to each of the lines obtained by holding n - 1 variables constant-this is an immediate consequence of the preservation of limits criterion for continuity. We say that 1 is separately continuous if it has this proper­ ty: for every k and every fixed value of all Xj with j #- k, the function g(Xk} = I(X b ... , xn} is continuous. Thus continuity implies separate continuity. But the converse is not true. It is easy to give a counterex­ ample in JR2 • Take the function 1 (x, y) = sin 28 where 8 = arctan (y / x) is the angular polar coordinate, and I(O, O} = O. The factor of 2 is chosen so that f is zero, hence continuous, on the coordinate axes. On every line not passing through the origin the function is continuous because f (x, y) = 2xy / ( x2 + y2) (this follows from sin 28 = 2 sin 8 cos 8 and sin 8 = y/ vx2 + y2 ,cos 8 = x/vx2 + y2) and we don't encounter any zero divisions. Thus 1 is separately continuous. But f is discon- 9. 9 Continuous Functions on Metric Spaces 391 tinuous along any line through the origin not equal to one of the axes, for it assumes the value zero at the origin and is equal to the constant non-zero value sin 28 along the ray with 8 constant. From this it is easy to see that f is not continuous. 9.3.2 Continuous Functions on Compact Domains We continue our discussion of continuous functions f : M � N for general metric spaces. Just as in the case of numerical functions, we can define a notion of uniform continuity in which the error relations are uniform over the domain: for every error l/m there exists an error l/n such that d(x, y) < l/n implies d(f(x), f(y)) < l/m. Once again we can show that a continuous function on a compact domain is auto­ matically uniformly continuous. The proof is a nice application of the Heine-Borel property. Theorem 9.3.2 Let M be a compact metric space, and let f : M � N be continuous. Then f is uniformly continuous. Proof: Since f is continuous, for each l/m and each point Xo there exists l/n such that d(x, xo) < 2/n implies d(f{x), f{xo)) < 1/2m. By the triangle inequality d(f(x), f(y)) < l/m if both x and y are in B2/n(xo). Here l/n depends on Xo and l/m. Keeping l/m fixed and varying Xo over M, consider the open covering by the smaller balls B1/n(xo). By the Heine-Borel property, there exists a finite subcover. That means there exists a finite number of points Xl , X2, ••• , XN and radii l/ni such that every point lies in one of the balls B1/nj (Xj). We now take l/n to be the smallest value of l/ni ' Given any point x, we have X in B1/nj (xi) for some j. If d(x, y) < l/n, then d(y, Xj ) < d(x, y) + d(x, Xj) < l/n + l/ni < 2/nj by the triangle inequality, so both z and y belong to B2/nj (z i)' We have already observed that this implies d(f(x), f(y)) < l/m. This proves the uniform continuity. QED Continuous functions on compact domains have other special prop­ erties. For example, if the range is the reais, then we can assert that the sup and inf are attained. 392 Chapter 9 Euclidean Space and Metric Spaces Theorem 9.3.3 Let f : M --+ 1R be continuous and M compact. Then sup f (x) and inf f (x) are both finite, and there are points in M where these values are assumed. Proof: We give the proof just for supx f (x). There exists a sequence of values {f (xn)} converging to the sup (or to +00 if the sup is +(0) . By the compactness of M we can obtain a convergent subsequence x� --+ Xo. Then f(x�) --+ f(xo) by the continuity of f. Thus the sup is finite and equals f(xo ). QED More generally, if f : M --+ N is continuous and M is compact, then the image f(M) is compact. This implies the previous result because a compact subset of 1R is bounded and contains its sup and info Theorem 9.3.4 The image of a compact set under a continuous func­ tion is compact. Proof: Let A be compact. To show f(A) is compact we need to show every sequence of points in f (A) has a subsequence converging to a point in f(A) . But a sequence of points in f(A) must have the form f(XI ), f(X2 ), ... where X l , X2 , . . . is a sequence of points in A. (The point Xk may not be uniquely determined by f(Xk) if f is not one-to­ one, but all that matters is that there is at least one such point) . By the compactness of A there exists a convergent subsequence x� --+ Xo with Xo in A. Then by the continuity of f, the subsequence f(xU converges to f(xo), which is in f(A) . Thus f(A) is compact. QED We mention now that for sequences or series of functions on metric spaces, results analogous to those of Chapter 7 for numerical functions can be obtained without difficulty. For example, if a sequence of con­ tinuous functions f n : M --+ N converges uniformly to f : M --+ N, then f is continuous. The definition of uniform convergence and the proof can be repeated almost word for word. We leave the details as an exercise. Similarly for the Arzela-Ascoli theorem: if fn : M --+ 1R is a sequence of real-valued functions on a compact metric space M that is uniformly bounded and uniformly equicontinuous, then there exists a uniformly convergent subsequence. The same result is even true for functions fn : M --+ N as long as N is complete. 9. 9 Continuous Functions on Metric Spaces 393 9.3.3 Connectedness We consider next some analogs of the intermediate value property of numerical functions. If f is a continuous numerical function defined on an interval, then the intermediate value property says it assumes all values in between values it assumes-and this implies easily that the image of the interval must be an interval. The first question that faces us, then, is to find some intrinsic properties of intervals that have counterparts in a general metric space. The kind of properties for which we are looking will express the intuitive idea of being of one piece, or connectedness. There are actually two distinct concepts of connectedness. The first, which we will call connectness, involves the impossibility of splitting the space up into pieces. The second, which we call arcwise connectedness, involves being able to join any two points by a continuous curve; it turns out to be a stronger condition than connectness. Let M be a metric space. We say M is connected if there does not exist a pair of disjoint nonempty open sets A and B with M = Au B. Equivalently, since the complement of an open set is closed, M is connected if the only subsets of M that are both open and closed are the empty set and the whole space. To justify-at least in part-this definition we should observe that an interval of R is connected, and the only connected subsets of 1R are intervals. Let I be an interval of R-it doesn't matter whether or not I con­ tains its endpoints or whether or not the endpoints are finite or infinite. Suppose I = A u B, A and B disjoint open (in I) subsets. If A and B are both nonempty, they must contain points a and b and we may assume a < b (A and B are disjoint, so we can't have a = b). To produce a contradiction we look for a dividing point between A and B. Thus let r = sup{z in I : z < b and z is in A}. Since a is in A and a < b, we have r > a. By the definition of the sup we have a sequence of points Zl , %2, •.. in A converging to r, so r is in A since A is closed in I. But A is also open in I. Since r < b, (we have r =F b since r is in A), r is in the interior of I, so A must contain an open neighborhood of r, which contradicts the definition of r as the sup of points of A. Thus I is connected. We now show, conversely, that intervals are the only connected subsets of R (points are special cases of intervals, [a, aD . Suppose A is 394 Chapter 9 Euclidean Space and Metric Spaces a connected set in � and a < b < c with a and c in A. We want to show this implies b is in A. Suppose it were not; then by dividing A at b as A = (A n ( -00, b) ) U (A n (b, (0)) we would obtain a forbidden decomposition into disjoint open sets. Thus we must have b in A. It is then a simple exercise to show that A must be an interval with endpoints inf A and sup A. For the second concept of connectedness, we need to define the notion of curve, also known as path or arc. A curve in M is defined to be a continuous function f : 1 ---T M where 1 is an interval in R The image f(1) is a set of points in M, which we can think of as being traced out by f(t) as t varies in 1, interpreted as a time variable. Thus the curve is a \"trajectory of a moving particle\" in M. We do not assume f is one-to-one, so the image of the curve is allowed to intersect itself. It is tempting to identify the curve with the image f(1) in M, with f(t) supplying a parametric representation of it. Of course the same set of points in M can be the image of many different curves, so, strictly speaking, we are not justified in calling f(1) a curve-nevertheless, we will do so when there is no danger of confusion. When M is a subspace of �n the curve has the form f(t) = (h (t), h (t) , ... , fn (t)) where fk (t) are continuous numerical functions, giving the coordinates of the trajectory at each time t. For example, f(t) = (cos t, sin t) is the curve whose image is the unit circle traced out in the usual manner (counterclockwise at constant angular velocity) infinitely often as t varies in R The graph of a continuous function 9 : 1 ---T � is a curve in the plane given by f( t) = (t, g( t)) for t in 1. A metric space (or subspace of a metric space) is called arcwise connected (sometimes the term path\";llise is used instead, but never curvewise) if there exists a curve connecting any two points. In more precise language, given any two points x and y in M there exists a curve f : [a, bJ ---T M such that f(a) = x and f(b) = y. The intuitive content of this definition is clear; on a technical level it allows us to reduce questions about M to questions about the intervals [a, bJ . For example, if 9 : M ---T � is any continuous real-valued function on an arcwise connected space M, we can show that 9 has the intermediate value property. Suppose g(x) = a and g(y) = b, with a < b. Let f : 1 ---T M be a curve connecting x to y, as shown in Figure 9.3. 1. Then go f is a continuous function from 1 to � that assumes the values a and b at the endpoints of 1. By the intermediate value property for 9. 3 Continuous Functions on Metric Spaces 395 numerical functions, go f assumes all values in [a, b) ; hence, 9 assumes all these values. b Figure 9.3.1: Theorem 9.3.5 An arcwise connected space is connected. Proof: Suppose M were arcwise connected but not connected. Then M = A u B where A and B are disjoint non-empty open sets. Let x be in A and y be in B, and let f : [a, b) � M be a curve connecting x and y in M. We claim f-l (A) and f-l (B) give a forbidden decompo­ sition of the connected interval [a, b]. Indeed they are open sets because f is continuous and the inverse image of open sets is open. Further­ more, for each t in [a, b) , either f(t) is in A or B but not both. Thus [a, b] = f- l (A) U f- l (B) and f- l (A) and f-l (B) are disjoint. This contradiction to the connectedness of [a, b) proves that M is connected. QED The converse of this theorem is not true, although it is true under extra assumptions on M. (See exercise set 9.3.7, number 7.) From a practical point of view, the easiest way to show a space is connected is to show that it is arc wise connected. Indeed, most of the subspaces of an with which we will deal, such as balls and generalized rectangles ({x in an ; aj < Xj < bj for j = 1, ... , n} ), are obviously arcwise connected. Any straight line segment in an is a curve, as is any broken line segment; so any subspace of an such that all points may be joined by broken line segments is connected, such as the region shown in Figure 9.3.2. 396 Chapter 9 Euclidean Space and Metric Spaces Figure 9.3.2: The notion of connectedness allows us to attain the broadest gen­ eralization of the intermediate value property: the continuous image of a connected set is connected. Furthermore, since the only connected subsets of R are intervals, this implies immediately that a continuous function f : M -T R has the intermediate value property if M is con­ nected. Theorem 9.3.6 Let f : M -T N be continuous and onto, f(M) = N. If M is connected, then N is connected. If M is arcwise connected, then N is arcwise connected. Proof: Both results are simple consequences of the definitions. Sup­ pose, first, that M is connected. If N = A u B with A and B disjoint non-empty open subsets, then M = f- l (A) U f-l {B) since N = f{M) with f -l (A) and f - l(B) disjoint non-empty open subsets of M, a con­ tradiction. So N is connected. N ext assume M is arcwise connected. Let x and y be points of N = f(M). Then x = f(u) and y = f(v) for u and v in M. Since M is arcwise connected, there exists a curve 9 : [a, b) -T M joining u to v. Then fo g : [a, b] -T N is a curve joining x to y. Thus N is arcwise connected. QED The implications in the theorem cannot be reversed. It is easy to give examples (see exercises) of f : M -T N onto, where N is connected but M is not. 9. 9 Continuous Functions on Metric Spaces 397 9.3.4 The Contractive Mapping Principle The next theorem we discuss is the Contractive Mapping Principle. It has a very simple proof but many important applications. We will use it many times in the chapters to come. We consider a function whose domain and range are of the same metric space, which we assume is complete. The term mapping is sometimes used to denote a continuous function and suggests the intuitive idea of moving points around. For a mapping I : M -+ M, we can ask if there are any fixed points, points for which f ( x) = x. This is not merely idle speculation, because many problems can be cast in this form. The Contractive Mapping Principle gives a criterion for there to be a unique fixed point and a simple constructive means of finding the fixed point. Definition 9.3.1 We say f : M -+ M is a contractive mapping if there exists a contant r < 1 such that d(f(x), f(y)) < r d(x, y) for all x and y in M. Note that this condition is just a Lipschitz condition with constant less than one. It says that under the mapping, all distances are reduced by at least a factor of r. If we apply f repeatedly we will shrink distances drastically, which makes the existence of a unique fixed point seem plausible. We introduce the notation fn for the iterated mapping fofo .. . of (n times). Contractive Mapping Principle Let M be a complete metric space and f : M -+ M a contractive mapping. Then there exists a unique fixed point xo, and Xo = limn_co fn(x) for any point x in M, with d(xo, In(x)) < crn lor a constant c depending on x. Proof: Choose any x in M, and consider the sequence f (x), f2 (x), 13 (:x), . .. . We will show it is a Cauchy sequence; for then, by the completeness of M, it will have a limit. By the contractive mapping property, Hence, by induction, 398 Chapter 9 Euclidean Space and Metric Spaces Thus, if m > n, we have d(fm (x), fn(x)) < d(fm(x), fm-l (x)) + ... + d(fn+l\"(x) , fn(x)) < (rm-l + rm-2 + ... + rn)d(f(x) , x) by the triangle inequality. But d(f(x), x) is just a constant, and we can make (rm-l + ... + rn) as small as we please by making n large enough, because 2: rn converges (since r < 1). Thus, {fn (x)} is a Cauchy sequence and Xo = limn-+oo fn (x) exists because M is complete. It is easy to see that Xo is a fixed point since f(xo) = f( lim fn(x)) = lim fn+l (x) = Xo n-oo n-+oo by the continuity of f. The above estimates also give us the rate of convergence, lim d(fn(x), fm(x)) m-+oo 00 n < \"\"rlcd(f(x), x) = r d(f(x), x). � l -r Ic=n Finally the fixed point is unique, for if Xl were another one, then with r < 1, which is impossible. QED It would seem that contractive mappings are hard to come by, s­ ince they have such strong properties. This is in fact the case, and in most applications we must first restrict the space. That is, we start with a mapping f : M --+ M that is not necessarily contractive and seek a closed subspace Mo (this implies Mo is 'complete) on which f is contractive. We then have to verify that d(f(x), f(y) ) < r d(x, y) for every x and y in Mo and also that f(x) is in Mo for every x in Mo. This second condition is easy to overlook, but it is necessary if we are to apply the theorem to f restricted to Mo and have a mapping f : Mo --+ Mo with the same domain and range. We will discuss this in detail when we apply the Contractive Mapping Principle to obtain solutions of differential equations. 9. 9 Continuous Functions on Metric Spaces 399 It is tempting to consider weakening the contractive property to allow r = 1, but this will not work. The simplest counterexample is the translation f(x) = x + 1 on R, for which d(f(x), f(y)) = d(x, y) but there are no fixed points. It is not even possible to allow the condition d(f(x), f(y) ) < d(x, y) for every x and y, for there are examples of mappings without fixed points satisfying this condition. There are many other fixed point theorems, such as the Brouwer fixed point theorem, which asserts that there is always a fixed point (not necessarily unique) if M is a closed ball in Rn . But that theorem is non-constructive, and Brouwer himself had to renounce it when he became a constructivist! Incidentally, there does not have to be a fixed point if M is an open ball. 9.3.5 The Stone-Weierstrass Theorem· We consider next a famous generalization of the Weierstrass approx­ imation theorem. A straightforward generalization would simply be that any continuous real-valued function f : M � R for M a com­ pact subspace of an can be uniformly approximated by polynomials. This will follow from a more general theorem of Marshall Stone, which is known as the Stone-Weierstrass theorem. Stone asked the question: what are the properties of the polynomials that enable them to approx­ imate arbitrary continuous functions on an interval? He observed that the collection of polynomials on an interval, call it 1', has the property that it forms a vector space: if f and 9 are in 1', then af + bg is in l' for constants a, b. Also it is closed under multiplication: f and 9 in 'P imply f . 9 is in 1'. We summarize these properties by saying l' forms an algebra. More generally, if A denotes any collection of real­ valued functions on a set M, we say A forms an algebra if f and 9 in A imply af + bg and f· 9 are in A. If M is any subset of an, then the polynomials on M form an algebra. Stone discovered that any algebra of continuous functions on a com­ pact metric space will suffice to approximate uniformly all continuous real-valued functions on M, provided that we impose some conditions­ which are obviously necessary-to guarantee that A is large enough. We say that A strongly separates points on M if 1) given any x in M there exists f in A with f(x) '# 0, and 2) given any distinct points x and y in M there exists f in A with f(x) '# f(y) . If A failed to 400 Chapter 9 Euclidean Space and Metric Spaces strongly separate points (say f (xo) = 0 for all f in A or f (x 1 ) = f (X2 ) for all f in A), then the same would be true of all uniform limits of functions in A and we could never approximate all continuous functions without these properties. Thus the condition that A strongly separates points is necessary. On the other hand the condition that A forms an algebra is not necessary; there are many interesting examples of vector spaces of functions that do not form an algebra and yet can uniformly approximate all continuous functions. Nevertheless, there are enough applications of the Stone-Weierstrass theorem to justify its fame. The proof of the Stone-Weierstrass theorem uses the one-dimensional Weier­ strass theorem and so cannot be used to give an alternative proof of the Weierstrass theorem. Theorem 9.3.1 (Stone-Weierstrass Theorem) Let M be a com­ pact metric space and A an algebra of continuous real-valued functions on M that strongly separates points. Then any continuous real-valued function on M can be uniformly approximated by junctions in A. Proof: We have to show that given any continuous function f : M -T R and any error 11m there exists 9 in A with If(x) - g(x)1 < 11m for all x in M. We write this estimate as f (x ) - 11m < g(x) < f(x) + 11m. We will first get 9 in A to satisfy g(x) > f(x) - 11m, and then we will decrease 9 to get the other inequality. A key technical device is that if g1 and g2 are in A, then max(gb g2 ) and min(g1' 92 ) are \"almost\" in A. More precisely, we have the following lemma: Lemma 9.3. 1 Let g1 and g2 be in A. Then for every error 11m there exist functions g3 and g4 in A such that Ig3 - max(gl ' g2 )1 < 11m and Ig4 - min(gl ,g2)1 < 11m for all points of M. Proof: Since max(gl ' 92 ) = (g1 + g2 + Ig1 - g2 1)/2 and min(g1' g2 ) = (g1 +g2 - lg1 -g2 1) 12, it suffices to prove the analogous statement for Igi : if 9 is in A there exists g1 in A with Ig1 - igi l � 11m. Here we use the fact that A is an algebra. Let A = sUPx Ig(x) l, which is finite because M is compact and 9 is continuous. Then Ig(x)1 is the composition of 9 : M -T R followed by the function Ixl : [-A, A] -T R. By the Weierstrass approximation theorem on the interval [-A, A], there exists 9. 3 Continuous Functions on Metric Spaces 401 a polynomial p with Ip(t) - Itl l < 11m for every t in [-A, A] (of course p depends on both 11m and A) . Then Ip(g(x) ) - lg(x) 1 1 :::; 11m (just take t = g(x) ), and p(g(x)) is in A because A is an algebra. This proves the lemma. Returning to the proof of the theorem, we begin by finding a so­ lution of a simpler interpolation problem-to find a function g in A satisfying g(Xk) = Yk for any finite distinct set of points Xl , ... , Xn in M and any real values YI , ... , Yn' This step in the proof uses the hy­ pothesis that A strongly separates points. We will only need to use the result for pairs of points Xl , X2 and so we give the proof in that case. The reader can easily supply the general case proof by induction. We know there is a function hI in A such that hI (Xl) =I- hI (X2), and we can assume without loss of generality that hI (Xl) =I- 0 and even hI (Xl ) = 1 by multiplying by a suitable constant. We have to consider two cases, depending on whether or not hI (X2 ) = O. If hI (X2 ) =I- 0, then hr (X2) =I- hl (X2) (we know hl (X2) =I- hl (XI ) = 1), and linear combina­ tions of h I and hr will solve the interpolation problem. If hI (X2 ) = 0, then we use the existence of h2 in A with h2 (X2) =I- 0, say h2 (X2) = 1, and then linear combinations of hI and h2 will solve the interpolation problem. Consider any continuous function f : M � R For any two points Xl and X2 we can find h in A with h(x) = f(x) for X = Xl or X2 . Because both functions are continuous, there exists a neighborhood of each of these points on which h(x) > f(x) -1 1m. By holding one of the points fixed, say Xl, and varying X2, we get an open covering of M by neighborhoods A for which there exists h in A with h(XI) = f(XI ) and h(x) > f(x) - 11m for all X in A. By the compactness of M there exists a finite subcovering. Thus M C U�=l Bj and for each BJ there exists hj in A such that hj (XI) = f(XI) and hj (x) > f(x) - 11m for X in BJ ' Now the function H = max(hl , ... , hk) satisfies H(XI ) = f(xd and H(x) > g(x) - 11m for every X in M. By the lemma, and induction, we can find g in A such that Ig(x) - H(x) 1 < 11m for every X in M. Thus the function g in A satisfies g( x) > f (x) - 21m for every X in M but g(XI ) < f(XI ) + 11m, as well. (In Figure 9.3.3 the graph of g is constrained to lie above the lower line-the graph of f(x) - 21m, but at X = Xl it must pass through the vertical line-between f(xd - 21m and f(XI ) + 11m.) 402 Chapter 9 Euclidean Space and Metric Spaces f(xI ) + ! f(x) Xl Figure 9.3.3: f(x) - 2!n Thus we have succeeded in both pinning down the value of 9 near that of f at one point Xl and at the same time bounding the values of g(x) below by f(x) - 21m at all points. We now repeat the same procedure to decrease g, preserving the lower bound we have already obtained, and at the same time getting the desired upper bound. Since we have one such function for each point X l of M and by the continuity of 9 and f we have g(x) < f(x) + 21m for X in a neighborhood of Xl , we can use the compactness of M to find a finite set of functions gl , \" \" gk in A and an open covering BI , ' .. ,Bk such that gj (x) < f(x) + 21m on Bj . Of course we still have gj (x) > f(x) - 21m on all of M. Thus G(x) = min{gl (x), ... ,gk(X)} satisfies f(x) - 21m < G(x) < f(x) + 21m for all X in M. By the lemma we can find 9 in A satisfying IG(x) -g(x) 1 < 11m on M, so Ig(x) - f(x) 1 < 31m. Thus any continuous function f can be uniformly approximated by functions in A. QED There is also a complex-valued version of this theorem, where we require the additional hypothesis that if g( x) is in A, then g( x) is in A. The proof can be reduced to the real version by taking real and imaginary parts. We leave the details for the exercises. Without this additional hypothesis the theorem is not true, but a proper explanation of the counterexample requires the theory of complex variables. If M is any compact subset of an , then the Stone-Weierstrass the­ orem applies to the algebra of polynomials on M. Indeed the constant polynomial f (x) = 1 gives a non-zero value at every point of M, and 9. 3 Continuous Functions on Metric Spaces 403 one of the coordinate monomials fk(X) = Xk will assume different values at two distinct points. 9.3.6 Nowhere Differentiable Functions, and Worse* We turn now to certain examples of continuous functions that have variously been described as pathological, bizzare, monstrous, obscene, etc. The first such example is a continuous nowhere differentiable func­ tion, discovered by Bolzano around 1830. His discovery was not widely circulated and so when Weierstrass discovered a similar example some 40 years later it was regarded as new and shocking. The reason for this was that mathematicians had tacitly assumed that all continuous func­ tions would be differentiable except for isolated exceptional points. It is tempting to react to these examples by saying, \"very well, but let's just add some hypotheses to rule them out\" . It turns out, however, that nowhere differentiable functions have an important role to play in very down-to-earth problems. In the study of Brownian motion­ one of the central topics in modern probability theory with widespread physical applications-one finds that nowhere differentiable functions are the rule, not the exception. (With probability one, every Brownian motion path is nowhere differentiable.) Bolzano's example was very graphic. It is also a model for a kind of construction that occurs often in the theory of fractals. The function we seek will be the limit of a sequence of approximating functions. For simplicity, we take [0, 1] for the domain and range. The first function we consider is f1 (x) = x. For the second function we add a zigzag to the graph, as shown in Figure 9.3.4. For the third function we take each of the three straight line segments of the graph of 12 and add zigzags to them. Continuing in this fashion we pass from 1 n-l to In by adding zigzags to all the straight line segments of the graph of In-I. This process is illustrated in Figure 9.3.5. By controlling the size of the zigzags appropriately we can make the sequence !l, 12, . . . converge uniformly to a limit function f that will be continuous. It is certainly plausible that f should fail to be differentiable at the countable set of points where we have corners in the graphs of the In . But why should I (x) fail to have a derivative at every point? To understand this we need a simple remark. Normally we compute the derivative at a point Xo by taking the limit of a difference quotient 404 1 Chapter 9 Euclidean Space and Metric Spaces 1 1 3 4 1 4 Figure 9.3.4: 1 3 1 (f{x) - f(xo))/(x - xo) where Xo is one of the points at which we evaluate f. However we could also hope to get f' (xo) as a limit of different quotients (f{x) - f(y))/(x - y) where both points x and Y approach Xo. It turns out that this is the case if x and y stay on opposite sides of Xo. Lemma 9.3.2 Suppose f(x} is defined in a neighborhood of Xo and differentiable at Xo. Then if Xn -+ Xo and Yn -+ Xo with Yn < Xo < Xn we have Proof: The idea is that the difference quotient (f(xn)-f(Yn)}/(Xn- Yn) is an average of the difference quotients {f(xn} - f{xo}}/{xn - xo} and {f{Yn} - f(xo}}/{Yn - xo)· In fact we compute f(xn} - f(Yn} _ f(xn} - f{xo} + b f{Yn} - f{xo} ---'----- - Cln. n ---'------'--'- Xn - Yn Xn - Xo Yn - Xo where an = {xn - xo}/{xn - Yn} and bn = (xo - Yn}/{xn - Yn). Notice that an + bn = 1 and an and bn are > 0 because of the assumption Yn < Xo < Xn. Thus 0 < an, bn < 1 and since both f(xn) - f(xo) _ !'(xo) Xn - Xo 9. 3 Continuous Functions on Metric Spaces and I (Yn ) - I (xo) _ !' (xo) Yn - Xo can be made as small as desired, f(xn ) - I (Yn ) _ f' (xo) Xn - Yn can also be made as small as desired. QED 405 We use this result in contrapositive form. To show f' (xo) does not exist we need only find sequences {xn} and {Yn } surrounding Xo and converging to Xo for which the difference quotients (f(xn) - I (Yn))/ (xn - Yn) do not converge. This makes life easy, for we need only know how to compute f at a countable dense set of points in order to compute difference quotients and show I' does not exist at every point. We are now in a position to verify Bolzano's example. To be specific, we add the zigzags by dividing each interval of the domain in thirds. On the first and last thirds we cover 3/4 of the vertical distance in the same direction and in the middle third we cover 1/2 the vertical distance in the opposite direction, as shown in Figure 9.3.5. The exact values are not important. We note that If{ (x) I > 3/2 at all points except x = 1/3 and 2/3 where ff doesn't exist. By induction I f� (x) 1 > (3/2)n at all points except x = k/3n where I� doesn't exist, since adding the zigzag multiplies the slope of the line segment by 9/4 on the first and last thirds and -3/2 on the middle third. We also note that the value of fn (x) does not change for x of the form k/3m once n > m so that f ( k3: 1 ) - f ( �) =3m (f ( k + l ) _ f (�)) . k + 1 k m 3m m 3m - - 3m · 3m Note that fm is linear on the interval [k/3m , (k + l)/3m], so the estimate for f:n shows 13m (lm ((k + 1)/3m ) - Im (k/3m))1 > (3/2)m . Thus the difference quotient for I computed at points k/3m and (k + 1)/3m is large. But for any point Xo in the unit interval and any m there is some 406 Chapter 9 Euclidean Space and Metric Spaces 10 and It 1 , , , , \" i , 16 It and h 1 2 145 2 78 1 9939 9399 Figure 9.3.5: 1 value of k such that k/3m < Xo < (k + 1)/3m and so, by the lemma, I is not differentiable at Xo. Thus I is nowhere differentiable. It remains to verify that I is continuous-that the sequence {In} converges uniformly. In fact we claim I/n{x) - In-dx)l < (3/4)n, for all x, which will establish the uniform convergence by comparison with E{3/4)n. Notice Ih{x) - lo{x)1 < 3/4 by inspection. Furthermore, the maximum vertical height of any line segment in the graph of II is at most 3/4. Adding the zigzag to any line segment does not change the value of the function by more than 3/4 times the vertical height of the segment, and each of the three segments of the zigzag are of height at most 3/4 times the vertical height of the original segment. Thus by induction we have that all the vertical heights of the segments composing the graph of In are at most (3/4)n, and I/n{x) - In-dx) 1 < (3/4)n as desired. While Bolzano's example is geometrically appealing, it has the de­ fect that there is no reasonable formula for the function. To obtain an example of a nowhere differentiable continuous function with a formu­ la, we note that in Bolzano's example the differences In - In- l have graphs that zigzag rapidly around the x-axis. Now if g{x) denotes the function periodic of period 2 whose graph is as shown in Figure 9.3.6, then g(2nx) is also a function that zigzags rapidly about the x-axis and vanishes at x = k/2n. Thus we could try to get an example in the form �::o ang{2nx) for appropriate coefficients an. In fact it is not hard to show I{x) = E�=o{3/4)ng{4nx) will work. We leave the details for the exercises. 9. 9 Continuous Functions on Metric Spaces 407 Figure 9.3.6: The example of Weierstrass is similar, except sin 1rX is used in place of g(x}. Our last example is that of a space-filling curve. The individual components of the curve are nowhere differentiable functions, so we can think of this curve as a higher species of monster. To be specific, we will construct a continuous function / : [0, 1] -+ ]R2 such that the image is the square 0 < x, y < 1. This function is not one-to-one, and it is possible to prove that there is no one-to-one example. However, the proof requires a rather elaborate study of the topological meaning of dimension and is beyond the scope of this book. Think of a child scribbling on a piece of paper if you want an intuitive idea of how one might proceed to obtain an approximation to such a curve. We just have to make sure that the scribbling doesn't omit any region of the paper! The original example is due to Peano, and such curves are usually called Peano cUnJes. The example we give is due to I. J. Schonberg. We let t denote the parameter variable in [0, 1] and x(t) and y(t) the coordinates of the curve (x(t), y(t)). We need to show that x(t) and y(t) are continuous functions and that for every point (xo, YO) in the square there exists to such that (x(to), y(to)) = (xo, yo). Let / ( t) and g( t) be the functions whose graphs are sketched in Figure 9.3.7 and which are extended to the whole line to have period 1. The idea behind these functions is that the curve (f(t), g(t)) visits all four corners (0, 0), (0, 1), (1, 0), and (1, 1) of the square and remains in them during the intervals [. 1, .2] , [.3, .4], [.5, .6] , [.7, .8] respectively. In particular, if we write an arbitrary point (x, y) in the square by expressing x and y in binary expanion, x = .x 1 X2 ••• , y = 'Yl Y2 • • • , then we can match the first digits ,XI and 'Yl by /(t) and g(t) by controlling the first digit in the decimal expansion of t (here we are 408 Chapter 9 Euclidean Space and Metric Spaces I 1 ! / \\ I I I 01 I 0 .1 .2 .3 .4 .S .6 .7 .8 .9 1 o .1 .2 .3 .4 .S .6 .7 .8 .9 1 Figure 9.3.7: thinking of .111 .. . as the binary expansion of 1). To control all the binary digits of � and y simultaneously by the decimal digits in t we take the infinite series 00 1 x(t) = E 2k !(10k-1t), k=1 00 1 y(t) = E 2k g(10k-1t}. k=1 Notice that these series converge uniformly by comparison with El/2k and so the limits are continuous functions. Now suppose t is a real number in [0, 1] whose decimal expan­ sion t = .tlt2 '\" contains only the digits 1, 3, 5, 7. Then !(10k-1t) = I(.tktk+l • . • } because f is periodic of period 1, and this is 0 if tk = 1 or 3 and 1 if tk = 5 or 7. Thus x(t) = �%:1 £k/2k = ,£1£2 ••• in binary notation, where if tk = 1 or 3, if tk = 5 or 7. Similarly we have y(t) = E�l 6k/2k = .6162 '\" in binary notation, 9. 9 Continuous Functions on Metric Spaces where if tk = 1 or 5, if tk = 3 or 7. 409 Thus by choosing tk appropriately we can simultaneously obtain any binary expansions .CIC2 ... and .81 82 ,,, and so (z(t),y(t) ) takes on every value in the unit square for one such t. 9.3.7 Exercises 1. Prove that I : M � N is continuous if and only if 1-1 (A) is closed in M for every set A closed in N. 2. If M is a metric space and Xo a point in M, prove that d(x, xo) : M � R is continuous. 3. If I: M � N and g: N � P are continuous, prove go! : M � P is continuous. Give an example where 9 0 I is continuous but 9 and I are not. 4. If I : M � Rn and 9 : M � R are continuous, prove g . I : M � an is continuous. 5. If I : M � N is continuous and M1 C M is any subspace, prove that the restriction of I to M1 is continuous. 6. If Ik : M � R for k = 1, ... ,n and I(x) = (!1 (x), .. . ,ln(x)) : M � Rn , prove I is continuous if and only if all the I k are con­ tinuous. 7. Prove that if A is an open set in Rn , then A is connected if and only if A is arcwise connected. (Hint: consider the set of points in A that can be joined to a given point Xo by a curve.) 8. Give an example of a continuous mapping of a disconnected set onto a connected set. 9. Give an example of a 'continuous mapping of a noncompact set onto a compact set. 10. Formulate a definition of uniform convergence for a sequence of functions In : M � N, and prove that the uniform limit of con­ tinuous functions is continuous. 410 Chapter 9 Euclidean Space and Metric Spaces 11. State and prove a version of the Arzela-Ascoli theorem for se­ quences of functions f n : M � N where N is complete and M is compact. 12. Prove that if A satisfies the hypotheses of the Stone-Weierstrass theorem then for any distinct points X l , ... , xn in M and any real values YI , .. . , Yn there exists a function f in A satisfying f(X k ) = Yk , k = 1, . .. ,n o 13. Prove that if A is an algebra of complex-valued functions on a compact metric space that strongly separates points and such that if f is in A, then f is in A, then any continuous complex-valued function on M can be uniformly approximated by functions in A. 14. Show that the conclusion of the Stone-Weierstrass theorem is e­ quivalent to saying A is dense in the metric space C(M) of contin­ uous real-valued functions on M with metric d(f, g) supx Jf(x) - g(x) J. 15. Give an example of a continuous mapping of (0, 1) onto (0, 1 ) with no fixed points. 16. Let a be a fixed real number with 1 < a < 3. Prove that the mapping f(x) = (x/2) + (a/2x) satisfies the hypotheses of the contractive mapping principle on the domain ( 1, 00) . What is the fixed point? 17. Let T: C( [O, 1]) � C([O, 1]) be defined by Tf(x) = x+ fo x tj(t) dt. Prove that T satisfies the hypotheses of the contractive mapping principle. Show that the fixed point is a solution to the differential equation f' (x) = xf(x) + 1. 18. Show that the set of trigonometric polynomials (functions of the form L�=-n akei k() for some n) satisfies the hypotheses of the Stone-Weierstrass theorem (complex-valued) on the circle. 19. Let g( x) be the sawtooth function in Figure 9.3.6. Prove that f(x) = L�=o (3/4)ng(4nx) is a nowhere differentiable continuous function. (Hint : evaluate the difference quotient 4n (f((k + 1)/4n) - f(k/4n)), and show that the contribution from (3/4)n- lg(4n-1x) is the dominant term. ) 9. 3 Continuous Functions on Metric Spaces 411 20. Let I : M --+ N be continuous and onto, and let M be compact. Prove that A is closed in N if and only if 1-1 ( A) is closed in M. Prove that if I is also one-to-one, then 1-1 : N --+ M is continuous. 21. Show that I: [0, 27r) --+ S defined by I(t) = (cos t, sin t) , where S is the unit circle in ]R2 , is one-to-one, onto, and continuous, but 1-1 is not continuous. 22. Give an example of a metric space that is complete but not con­ nected and one that is connected but not complete. 23. Give an example of a continuous function I : M --+ N that does not take Cauchy sequences in M to Cauchy sequences in N. 24. Give examples of continuous functions I : M --+ N that are onto such that M is complete and N is incomplete or M is incomplete and N is complete. 25. Give an example of a contractive mapping on an incomplete metric space with no fixed point (Hint: remove the fixed point from a complete metric space.) 26. Show that the graph of I ( x) = { So in 1/ x x -=f. 0 x = O is a connected subset of ]R2 even though I is discontinuous. Is it arcwise connected? 27. Prove that the graph of a continuous function I : I --+ ]R for an interval I is a connected subset of ]R2 . 28. If Al :J A2 :J .. . is a nested sequence of compact, connected sets, show that nn An is also connected. Similarly, show that if the sets are arcwise connected, then so is the intersection. Would the same be true if we did not assume compactness? 29. *Let K denote the set of compact subsets of a complete metric space M. Define the Hausdorff distance on K as follows: dH (A, B) 412 Chapter 9 Euclidean Space and Metric Spaces is the smallest value of c such that for every point a in A there exists a point b in B with d( a, b) < c and for every b in B there exists a in A with d(a, b) < c. a. Show that dH is a metric on IC. b. Show that IC is complete in this metric. 30. * An iterated function system on a complete metric space M is de­ fined to be a finite set h, ... ,fm of contractive mappings. Prove that there exists a unique compact set K (called the attractor) such that K = Uj: l fj (K). (Hint: show that the mapping A -+ Uj=l fJ(A) on JC satisfies the hypotheses of the contractive mapping principle, using the Hausdorff distance from the previous exercise. ) 31. If f satisfies the hypotheses of the contractive mapping principle and X l is any point in M, show that d(XI ' xo) < d(XI ' f(xI) )/(l ­ r) where Xo is the fixed point. Informally, this says that if f(xI) is close to X l , then X l is close to the fixed point (but r must not be too close to 1 for this to be a good estimate) . , 32. Let TI and T2 satisfy the hypotheses of the contractive mapping theorem on the same metric space M with the same contractive ratio r. Suppose TI and T2 are close together, in the sense that d(TIX, T2X) < c for all X in M. Show that the fixed points Xl and X2 of TI and T2 are also close together, namely d(xl , X2) < c/ (1 - r) . 9.4 Summary 9.1 Struct ures on Euclidean Space Definition JRn is the set of ordered n-tuples X = (Xl , X2 , ... ,xn) of real numbers. Definit ion A metric space M is a set with a real-valued distance func­ tion d(x, y) defined for x, y in M satisfying 1. d(x, y) > 0 with equality if and only if X = Y (positivity) , 9.4 Summary 413 2. d(x, y) = d(y, x} (symmetry), 3. d(x, z) < d(x, y) + dey, z) (triangle inequality) . Definition A nonn on a real or complex vector space is a function I lx II defined for every x in the vector space satUftJing 1. Ilxli > 0 with equality if and only if x = 0 (positivity), 2. lIaxll = lal llxli for any scalar a (homogeneity), 3. liz + yll < IlzlI + lIyll (triangle inequality) . Theorem If Ilzll is a nonn, then d(z, y) = liz - yll (called the induced metric) is a metric. Example Let C([a, b) ) denote the continuous functions on [a, b) . Then IIflisup = sup lf(x}1 is a nonn on C([a, b)), called the sup nonn. Definition An inner product on a real vector space is a real-valued function (z, y) defined for all x and y in the vector space satisfying 1. (x, y) = (y, z) (symmetry), 2. (ax + by, z) a (x, z) + b(y, z) and (x, ay + bz) a(z, y) + b(z, z) for all real numbers a, b (bilinearity), 3. (z, x) > 0 with equality if and only if x = 0 (positive definiteness) . Theorem 9.1.1 ( Cauchy-Schwartz Inequality) On a real inner product space, l(z,y) 1 < V(x, z)V(y, y), with equality if and only if z and y are colinear. Theorem 9.1.2 If (x, y) is an inner product, then Ilzll = V(z, z) is a nonn. Example On R\" z . Y = Ei=l ZjYj is an inner product; hence, Izl = JEi=l z� is a nonn and Iz - yl is a metric. Theorem On an inner product space the polarization identity (z, y) = (liz + Yll2 - liz - yIl2}/4 holds, and the associated noma satisfies the parallelogram law IIx + Yll2 + liz - Yl 12 = 211z112 + 211Y1 l2 . 414 Chapter 9 Euclidean Space and Metric Spaces Definition A complex inner product on a complex vector space is a complex-valued junction (x, y) defined for all x and y in the space sat­ isfying 1. (x, y) = (y, x) (Hermitian symmetry) , 2. (ax + by, z) - a(x, z) + b(y, z) and (x, ay + bz) a(x, y) + b(x, z) (Hermitian linearity), 3. (x, x) is real and (x, x) > 0 with equality if and only if x = 0 (positive definiteness). 9.2 Topology of Metric Spaces Definition A subspace M' of a metric space M is a subset of M with the same metric. Definition The open ball Br (y) in a metric space with center y and radius r is Br {y) = {x : d{x, y) < r}. Definition A subset A of a metric space M is said to be open in M if every point of A lies in an open ball entirely contained in A. A neighborhood of a point is an open set containing the point. The interior of a set A is the subset of all points contained in open balls contained in A. Theorem 9.2.1 Let M be a subspace of MI . A set A is open in M if and only if there exists Al open in MI such that A = Al n M. If M is open in MI , then a subset of M is open in M if and only if it is open in MI . Theorem 9.2.2 In a metric space, an arbitrary union of open sets, or a finite intersection of open sets, is open. Definition limn_oo Xn = x means for all 11m there exists N such that n > N implies d{xn' x) < 11m. We say x is a limit point of a sequence {xn} if every neighborhood of x contains Xn for infinitely many n and x is a limit point of a set A if every neighborhood of x contains points 9.4 Summary 415 of A not equal to x. A set is closed if it contains all its limit points. The closure of a set consists of the set together with all its limit points. If A C B we say A is dense in B if the closure of A contains B. Theorem 9.2.3 In a metric space, a set is closed if and only if its complement is open. Definition We say {xn} is a Cauchy sequence if for every 11m there exists N such that d(xj, Xk) < 11m for all j, k > N. A metric space is complete if every Cauchy sequence has a limit. Theorem 9.2.4 A sequence x(I) , x(2) , ... in an converges to x if and I :1 th if rd' t (1) (2) t I on 11 SJ e sequence 0 coo sna es Xk ' Xk , ••• converges 0 Xk Jor every k = 1, ... , n. Corollary 9.2. 1 an is complete. Theorem 9.2.5 C([a, b)) with the sup-nonn metric is complete. Definition We say A is compact if every sequence of points in A has a limit point in A. Theorem A compact metric space is complete. Theorem 9.2.6 (Heine-Borel) A metric space is compact if and only if it has the Heine-Borel property: every open covering has a finite subcovering. Lemma 9.2.1 A compact metric space has a countable dense subset, and given any 11m there exists a finite set of points such that every point is within distance 11m of one 0/ them. Theorem A subspace A of a complete metric space M is itself complete if and only if it is a closed set in M. Theorem 9.2.7 A subspace of an is compact if and only if it is closed and bounded (this is not true of general metric spaces) . 416 Chapter 9 Euclidean Space and Metric Spaces 9.3 Continuous Functions on Metric Spaces Theorem 9.3.1 Let M and N be metric spaces, f : M --+ N a function. The following three conditions are equivalent (and a function satisfying them is called continuous) : 1. for every 11m and Xo in M there exists lin such that d(x, xo) < lin implies d(f(x) , f(xo)) < 11m; 2. if Xl , X2 , . . . is any convergent sequence in M, then f (Xl ), f(x2 ), . . . is convergent in N; 3. if B is any open set in N, then f- l (B) is open in M. In part 2 it follows that limn-+oo f(xn) = f(limn-+oo Xn) . Theorem Continuous functions are closed under restridion to a sub­ space, composition, addition (when the range is IRn ) and multiplication (when the range of one is IR and the other IRn ). If f (x) = (11 (x), .. . , ! n (x)) is a function ! : M --+ }Rn , then f is continuous if and only if all fk : M --+ IR are continuous. Example The function f : }R 2 --+ IR given by ! (x, y) = { sin 28 (x, y) =1= (0, 0), o (x, y) = (0, 0) where 8 = arctan (y I x) is the polar coordinates angular variable, is not continuous at the origin, but is continuous in x for each fixed y and continuous in y for each fixed x. Definition f : M --+ N is said to be uniformly continuous if for every 11m there exists lin such that d(x, y) < lin implies d(f(x), f(y) ) < 11m. Theorem 9.3.2 Let M be compact. Then f M --+ N continuous implies it is uniformly continuous. Theorem 9.3.3 If M is compact ' and f : M --+ IR is continuous, then supx f(x) and infx f(x) are finite and there are points in M where f attains these values. 9.4 Summary 417 Theorem 9.3.4 The image of a compact set under a continuous func­ tion is compact. Definition M is said to be connected if there do not exist disjoint nonempty open sets A and B with M = A u B; or equivalently, the only sets both open and closed in M are the empty set and M. Theorem A subspace of R is connected if and only if it is an interval. Definition A curve (or arc) in M is a continuous function from an interval to M. A space M is said to be arcwise connected if for every pair of points x, y in M there exists a curve f : [a, b] � M with f(a) = x, f(b) = y. Theorem 9.3.5 Arcwise connected implies connected. Theorem 9.3.6 Let I : M � N be continuous and onto. If M � connected, then so is N. If M is arcwise connected, then so is N. Definition A contractive mapping is a junction f : M � M such that there exists r < 1 with d(f(x), f(y)) < rd(x, y) for all x, y in M. Theorem (Contractive Mapping Principle) A contractive mapping on a complete metric space has a unique fixed point Xo , which is the limit of fn (x) (fn denotes f iterated n times) for any x, and d( Xo, In (x)) < ern. Theorem 9.3.7 (Stone- Weierstrass) Let M be a compact metric space and A a collection of real-valued junctions on M that forms an algebra (is closed under linear combinations and products) and strongly sepa­ rates points (there are functions in A assuming distinct and non-zero values at distinct points) . Then any continuous real-valued function on M can be uniformly approximated by functions in A. Corollary Any continuous function f : M � R for M C Rn compact can be uniformly approximated by polynomials. Example (Bolzano) There exists a continuous function f R � R 418 Chapter 9 Euclidean Space and Metric Spaces such that I' fails to exist at every point. Lemma 9.3.2 If f'{:co) ezists, then /'(:co) = lim (f{:cn) _ I{Yn) ) n-oo (:Cn - Yn) for any pair of sequenceS :Cn -t :Co and Yn -t :Co such that Yn < :Co < Xn . Example (Peano) There ezists a continuous function from [0, 1] onto the unit square in R2 . Chapter 10 Differential Calculus in Euclidean Space 10.1 The Different ial 10.1.1 Definition of Differentiability Recall that the idea of the differential calculus for numerical functions was to approximate locally a general function by a special kind of func­ tion, an affine function ax + b, and to relate properties of the general function to properties of its affine approximation. The idea of the d­ ifferential calculus for functions f : an � am is essentially the same. The affine functions will still have the form ax + b, but now a is an m x n matrix (m rows and n columns) and b is a vector in lRm. We adopt the convention that all vectors are considered as column vectors in any equation involving matrix multiplication. Thus ( gl (X) ) g(x) = ax + b = : gm{x) with gk(X) = Ej=l akjXj + bk. Since these affine functions are more complicated than in the n = m = 1 case, the differential calculus in general will also be more complicated .. However, we assume the reader has some familiarity with elementary linear algebra and so will feel comfortable in dealing with these affine functions. 419 420 Chapter 10 Differential Calculus in Euclidean Space Suppose f is a function f : D � Rm with D C Rn . For simplicity we will assume that the domain D is an open set. We want to define the best affine approximation to 1 at a point y. From the n = m = 1 case we expect this should be given by the condition f (x) = g( x) + o( Ix - yl) as x � y, where 9 is an affine function. This means lim (f(x) - g(x}}/lx - yl = o. x-y The presumption is that if such an affine function exists, then it is unique. To see why this is so suppose there were two such functions gl and g2, and let 9 = gl - g2 be their difference. Then g(x) - -(f(x) - 91 (X)) + (f(x) - g2(X)) = o(lx - yl) + o(lx - yl) = o(lx - yl), and of course 9 is also affine. But we can show that zero is the only affine function such that g(x) = o(lx - yl) as x � y. We write g(x) = a(x - y) + b; since g(y) = b we obtain b = 0 from g(x) = o(lx - yl) as x � y. So it suffices to show that la(x - y) l = o(lx - yl) implies a = O. Setting z = x - y, the hypothesis is lazl/lzi � 0 as z � O. But if we let z vary along a ray z = tw, for t > 0 and w in Rn with w =1= 0 fixed, then lazl = tlawl while Izi = tlwl, so lazl/lzi = lawl/lwi is a constant independent of t. Since this must tend to zero as t � 0, it must already be zero, so aw = 0 for all w # 0, and this implies a = O. Thus the best affine approximation to f at a given point, if it exists, is uniquely defined. We can also assert that the best affine approxima­ tion, if it exists, must have the form g(x) = a(x - y) + b where b = f(y). This follows simply from the fact that 1 (x) - g( x) = o( Ix - yl) as x � y implies f(y) - g(y) = 0, and b = g(y). In other words, the graphs of 1 and 9 pass through the same point at the value y of the independent variable. Thus it is only the matrix a that needs to be determined, and we shall call it the differential of f at y, written dl(y). (The terms derivative and total derivative are often used to mean the same thing. ) Definition 10.1.1 We say f is differentiable at y if there exists an m x n matrix dl(Y), called the differential 01 1 at y, such that f(x) = f(y) + df(y)(x - y) + o(lx - yl) as x � y; or in other words, given any error liN, there exists 11k such that Ix - yl < 11k implies If(x) - f(y) - df(y)(x - y) 1 < Ix - yl/N. 10.1 The Differential 421 Notice that Ix - yl refers to the distance in Rn and If{x) - f(y) - df(y) (x - y) 1 refers to the distance in Rm . Otherwise, the definition is the same as in the case of numerical functions. We do not specify in the definition what the entries of the matrix df(y) should be. We will deal with this question in the next section, after we derive some basic properties that follow from the definition directly. It is easy to show that the m variables in the range do not add anything significantly new. In fact, if we write ( l1(x) ) f(x) = : fm(x) in components, then f is differentiable at y if and only if all the func­ tions /j (x) are differentiable at y and df (y) is the m x n matrix whose jth row is d/j (y). However, having n variables in the domain is a significant generalization. If f is real-valued, then df(y) is a 1 x n matrix-a row vector. It is sometimes called the gradient of f and written V f(y). We will later give a geometric interpretation of this vector. We may also rearrange the row vector into a column and then write f(x) = f(y) + V f(y) . (x - y) + o(lx - yl) where the dot indicates the inner product of vectors. It will not be nec­ essary for us to distinguish between row and column vectors. However, it is only fair to point out that in the study of differential geometry this distinction becomes meaningful and important. The best affine approximation f (y) + df (y ) (x - y) has a graph that can be interpreted as a tangent plane (actually an n-dimensional plane) to the graph of f at y. This is most meaningful geometrically in the cases f : R2 -+ at where the tangent plane is an honest plane in Jt3 and / : al -+ a2 where the tangent \"plane\" is a line in r . Just as in the numerical case, it is easy to show that the differen­ tiability of f at y implies the continuity of f at y, as follows. From f(x) = f(y) + df(y)(x - y) + o(lx - yl) we take limits as x -+ y. We ob­ tain limx_y /(x) = /(y) because /(y) is constant and both df(y}{x - y) and o(lx - yl) tend to zero as x -+ y. We can show a little more, namely that a pointwise Lipschitz condition holds: there exists a neighborhood 422 Chapter 10 Differential Calculus in Euclidean Space of y on which If(x) - f(y)1 < Mix - yl for some constant M. To see this, observe that If(x) - f(y) 1 = Idf(y)(x - y) + o(lx - yl) l < Idf(y)(x - y) 1 + 10(lx - yD I · Since o(lx - yl) implies O(lx - yl), we can make 10(lx - yl) I < Ix - yl on a neighborhood of y. Then Idf(y)(x - Y) I < Mix - yl because IAxl < M Ixl for any matrix A, with M depending on A (see exercises) . This proves the pointwise Lipschitz condition If(x) - f(y)1 < Mix - yl, for x in a neighborhood of y. Note, however, that since the constant M may depend on y, this is not as strong as a uniform Lipschitz condition. If 1 is differentiable at every point of the domain D, we say 1 is differentiable on D. We can then regard the differential df(y) as a function of y, taking values in the space of m x n matrices am x n . If df : D -+ am xn is continuous we say 1 is continuously differentiable or 1 is C1 • This will turn out to be the more useful notion. We note that differentiability and the differential are linear: if f and 9 (both mapping D -+ am ) are differentiable at y, then so is af + bg for scalars a, b and d(al + bg) = adl + beIg. These are immediate consequences of the linearity of matrix multiplication, al (x) + bg (x) = a (I (y) + dl (y) (x - y) + 0 (Ix - yl) + b (g (y) + dg (y) (x - y) + 0 (Ix - yl) = a! (y) + bg (y) + (ad! (y) + bdg (y) ) (x - y) + ao (Ix - yl) + bo (Ix - yl) and the error term ao(lx - yl) + OO(lx - yl) is also o(lx - Yl)' It also follows that if f and 9 are differentiable or CI on D, then so is af + bg. There is also a product formula, in the case that 1 : D -+ am and 9 : D -+ R so that 9 . f : D -+ Rm . Then the differentiability of f and 9 at y implies that 9 . f is differentiable at y and d(g . f) (y) = g(y)df(y) + I(y)dg{y). Here df(y) is an m x n matrix and is multiplied by the scalar g{y), while I{y) is an m x 1 matrix and dg{y) is a 1 x n matrix, so the matrix product I(y)dg(y) is an m x n matrix. This follows from g{x)/{x) = (g(y) + dg(y){x - y) + o(lx - yD) . (/{y) + df{y)(x - y) + o{lx - yl) - g(Y)/{Y) + [(dg{y){x - y» f(y) + g(y)df(y)(x - y)] + o(lx - yl) 10.1 The Differential 423 (the new remainder term includes o(lz - yl) multiplied by bounded functions, and (dg(y)(x - y))dJ(y)(x - y), which is O(lx - Y12) hence o(lx - y!).) AU that remains is to verify that (dg(y)(z - y))f(y) = (f(y)dg(y))(x - y), and this is simply matrix algebra. 10. 1.2 Partial Derivatives We come now to the problem of determining the entries of the matrix dJ. If we choose x = y + tej where ej is the unit vector in the jth direction, then f(x) - f(y + tej ) = f(y) + dJ(y)tej + o(ltej l) f(y) + tdJ(y)ej + o(ltl). The kth coordinate of this equation is where dJ(Y)lej denotes the kth coordinate of the vector df(y)ej or the kj entry of the matrix df(y). But this equation simply expresses the fact that the function fie (y + tej) as a function of t is differentiable at t = 0 with derivative df (y ) lej . We recognize this as just the usual par­ tial derivative {}fle/{}xj , which is obtained by keeping all the variables Xl, ••• , Xn except Xj fixed and differentiating lie as a function of Xj . Note that we can define the partial derivatives independently of the concept of the differential. We simply say 8fle/8x; exists at a point y if lle(y + tej) = fle(Y) + at + o( lt!) for some constant a as t -t 0 and then set a = 81 Ie / 8x j (y). This can also be expressed as the limit of the difference quotient {} fie (y) = lim fle(y + tej ) - JIe(y) . 8xj t-O t Notice that in general the differential is not expressible as the limit of a difference quotient, and for this reason we have consistently downplayed difference quotients in our development of differential calculus. More generally, if u is any non-zero vector in Rn , we can define the directional derivative in the u direction: du/(y) = lim(f(y + tu) - I(y))/t. t-O 424 Chapter 10 Differential Calculus in Euclidean Space Note that this means f(y + tu) = f(y) + tfLuf(y) + o(t) as t � O. IT f takes values in Rm , then so does duf; we can also consider dufk, the kth component of fLuf. Then 8fk/8xj (y) = dej fk(y). We will also write of /OXj for dej f without taking components and call this the partial derivative of f with respect to Xj . (In some calculus books the term \"directional derivative\" is reserved for the case that u is a unit vector, but there is no need for such a restriction. In fact, we will also allow u = 0 in duf, in which case we obviously have duf = 0.) We have observed that the existence of the differential implies the existence of partial derivatives. This generalizes easily to the case of directional derivatives. Theorem 10.1.1 If f : D � Rm with D � Rn is differentiable at y with differential df(y), then fLuf exists at y for any U in Rn and duf(y) = df(y)u. Proof: From f(x) = f(y) + df(y)(x - y) + o(lx - yl) we obtain by substituting x = y + tu f(y + tu) QED f(y) + df(y)tu + o(ltul) /(y) + tdf(y)u + o(t) . Notice that choosing u = ej shows df(y)ej = of /OXj (Y) as we 0- riginally noted. Also we can write out df(y)u = EJ=l 8f /8xj (y)uj or (df(Y)U)k = EJ=1 8/k/8xj (y)Uj in components. Thus all direc­ tional derivatives are determined by the special ones in the coordinate directions, if / is differentiable. This is a somewhat surprising re­ sult, because the directional derivative fLuf(y) is defined entirely in terms of the values of f along the line y + tu passing through y in the u direction (these lines are shown in Figure 10.1.1.) Aside from the point y itself, these lines have no points in common, so there is no reason to believe there should be any connection between the derivatives of f along them. In fact it is easy to construct functions for which there is no connection. Take the plane R2 and y = (0, 0), and define f(r cos 8, r sin 8) = rg(8) for any function g(8) that is odd, g(-8) = -g(8) . Then duf(O, O) = g(8) if u = (cos 8, sin 8). The func­ tion f is linear along each line through the origin, but the slopes are unrelated. 10.1 The Differential 425 Figure 10.1.1: The point is that these functions are not differentiable (unless g( 8) is very special). The graph of I near the origin has a folding fan ap­ pearance and is not smooth. We see that differentiability for a function of several variables is a rather strong condition. The existence of the partial derivatives, or even all directional derivatives,- does not imply differentiability. In fact, in the above example if we take g( 8) smooth, say g(8) = sin 28, then I(x,y) = xy/vx2 + y2 has direction derivatives in all directions and at all points in the plane but is not differentiable at the origin. Thus the converse to the last theorem is false. It is a remarkable fact, however, that if the partial derivatives are continuous, then I has to be differentiable; this will provide a modified converse to the theorem. The hypothesis of continuity of a f / ax i (y) is strong enough to allow us to compare quantities computed from the values of I along different lines parallel to the axes and passing through points near y. Figure 10.1.2 illustrates the geometry in the plane. These lines fill up in a neighborhood of y. Theorem 10. 1.2 Let I : D � am lor D c an have partial derivatives 8 1/ ax i : D -+ IF lor j = 1, ... ,n that are continuous in a neighbor­hood 0/ y. Then / is differentiable at y. Moreover, a necessary and 426 Chapter 10 Differential Calculus in Euclidean Space y Figure 10 .1.2: sufficient condition that f be Cl on D is that all the partial derivatives a 1 laxj exist and are continuous. Proof: The idea of the proof is to apply the mean value theorem n times, to express f (x) - 1 (y) in terms 6f partial derivatives. The mean value theorem, however, involves evaluating derivatives at unde­ termined points, and we will use the continuity of the partial derivatives to make the change to the partial derivatives evaluated at y. For sim­ plicity of notation we present the proof in the case n = 2 and m = 1. Assume that a f laxl and a f lax2 are continuous in a neighborhood of y. To prove the differentiability of f at y we write and apply the mean value theorem to both terms. (These are the three corner points in Figure 10.1.3.) Notice that I(xl, X2) - I (Xl , Y2) is the difference of the values of ' 1 along the horizontal line, so by the one-dimensional mean value theorem for some value Z2 between X2 and Y2. 10.1 The Differential 427 Fi�e 10. 1.3: Similarly, by the mean value theorem applied to 1 on the vertical line, I(Xl, Y2) - I(Yb Y2) = a al (Zl' Y2)(Xl - Yl) Xl for some Zl between Xl and Y2. This stage of the argument only requires the existence of the partial derivatives (not their continuity) to justify the use of the mean value theorem. Summing the two identities, we obtain which is related to but not identical to the statement of differentiability I(Xl, X2) - I(Yl, Y2) = 81 /8Xl (Yl , Y2)(Xl - Yl ) + al /8X2(Yb Y2)(X2 - Y2) + o(lx - yl), that we are trying to prove. Therefore, we rewrite our identity as where I(Xb X2) - I(Yb Y2) = al /8Xl (Yb Y2)(X l - yd + al/aX2(Yb Y2)(X2 - Y2) + R, R - [al/aXl (Zb Y2) - al/aXl (Yb Y2)](Xl - yd + [at /aX2 (Xb Z2) - al /aX2(Yl , Y2)] (X2 - Y2). 428 Chapter 10 Differential Calculus in Euclidean Space To complete the proof we need to show R = o(lx - yl) as x � Y or limx_y IRl/lx - yl = O. But IXI - Yl l < Ix - yl and IX2 - Y2 1 < Ix - yl, so IR/ 81 81 81 81 I I < -8 (Zb Y2 ) - -8 (Yl , Y2) + -8 (X I , Z2) - -8 (YI , Y2 ) . x - Y Xl Xl X2 X2 Now we are ready to use the continuity of 8118x1 and 8118x2. We have only to note that as (X l, X2) approaches (Yl , Y2 ), so do (Zl ' Y2 ) and (Xl, Z2) because Zl and Z2 are intermediate values. Thus limx_y RI Ix - yl = 0, proving the differentiability of 1 at y. Next, assume that the partial derivatives are continuous on all of D. Then, by what we have shown, 1 is differentiable on all of D. Since the matrix dl(Y) has entries 8lkl8xj (Y) and these are continuous by hypothesis, it follows that dl : D � Rm xn is continuous, hence 1 is Cl . Conversely, assume 1 is C1 j then 81 k I 8x j (y) exists and is an entry of the matrix df(y). But the continuity of the matrix function implies the continuity of the entries, so 8IkI8xj (Y} is continuous. QED If we examine the argument carefully, we observe an asymmetry a­ mong the variables. This was caused by the arbitrary choice of /(Xl, Y2 ) over 1 (Yl , X2) for the intermediate comparison. As a result we ended up with a comparison of values of 8/18xl along a horizontal line, but the values of 8118x2 are compared between (Xl , Z2) and (Yl , Y2 )-not along a vertical line. We will see in the next section that the proof of commutativity of partial derivatives is very similar. This theorem is extraordinarily useful, since it provides a simple and expedient method of showing functions are differentiable. We even get continuity of the derivative in the bargain! We can immediately conclude from this theorem that every function 1 : an � am given by a finite formula involving arithmetic operations, roots, and special numerical functions such as exp, log, sin, cos, which are known to be differentiable, is continuously differentiable on its natural domain-all X for which all operations are defined (without dividing by zero or taking roots of zero, etc.). 10. 1.3 The Chain Rule While the previous theorem allows us to reduce many questions in the differential calculus of several variables to computations of partial 10.1 The Differential 429 derivatives, hence to the one-dimensional calculus, there are still sit­ uations in which we need to think in terms of the differential in its full multi-dimensional incarnation. One of these is the chain rule. The underlying idea is that the composition of two linear transformations corresponds to matrix multiplication. Since the differential calculus lets us approximate a differentiable function f by an affine function, which is a linear transformation plus a constant, the composition of differen­ tiable functions should be differentiable and the differential should be obtained by appropriately multiplying the differentials of the functions being composed. As in the one-dimensional case, we need to specify the points at which the differentials are evaluated. Let f : D --+ }Rm with D C }Rn and g : A --+ }RP with A C }Rm , and suppose the image f (D) is contained in A; so g 0 f : D --+ }RP is defined by g 0 f(x) = g(f(x)) for x in D. Now fix a point y in D, and let z = f(y) . Note that z is an image point of f, so z is in A. Theorem 10.1.3 (Chain Rule) If f is differentiable at y and g is dif­ ferentiable at z = f(y), then go f is differentiable at y and d(g o f) (y) = dg(z)df(y) (matrix multiplication) . Moreover, if J and g are differen­ tiable (respectively C1 ) on their domains, then so is g 0 f . Proof: We write f(x) = f(y) + dJ(y) (x - y) + Rl (x, y) and g ( w) = g ( z) + dg ( z )( w - z) + R2 ( w, z) where Rl (X, y) = o(lx - yl ) as x --+ y and R2 (w, z) = o(lw - zl) as w --+ z. Setting w = f(x) and z = f(y) in the second equation and then using the first equation we obtain g(f(x)) g(f(y) ) + dg(z) (f (x) - f(y) ) + R2 (J(x), f(y) ) g(f(y)) + dg(z)dJ(y) (x - y) + dg(z)Rl (X, y) + R2 (f(x), f(y) ). This will prove both the differentiability of go f at y and the formula for the differential, if we can show that dg(z)R1 (x, y) + R2 (f(x), J(y)) = o( lx-y l) as x --+ y. But dg (z)R1 (x, y) = o(lx -yl) because R1 (x, y) = 430 Chapter 10 Differential Calculus in Euclidean Space o(lx - yl) and dg(z) is a fixed matrix (so Idg(z)Rl(X, y)1 < clRdx, y)1 where c depends only on dg(z)). To show R2(f(x), f(y)) = o(lx - yl) we need to appeal to the pointwise Lipschitz continuity of f at y, which we have shown to be a consequence of the differentiability of f at y. Given any error liN, we first use R2(Z, w) = o(lz - wI) to find 11k such that Iz-wl < 11k implies IR2(Z, w)1 < Iz-wI/NM, where M is the constant in the pointwise Lipschitz condition If(x) - f(y)1 < Mix - yl holding for x in a neighborhood of y, say Ix -yl < lip. Next we choose llq so that llq < lip and Ix-yl < llq implies If(x)-f(y)1 < 11k since f is continuous (we may take llq = minimum (lip, 1/kM) ). Then if Ix - yl < llq we have IR2(f(x), f(y))1 < If(x�:(Y)1 < Ix;, YI. This proves R2(f(x), f(y)) = o(lx - yl). Thus we have simultaneously shown that 9 0 f is differentiable at y and computed its differential at y to be dg(z)df(y), under the assump­ tions that f is differentiable at y and 9 is differentiable at z = f(y). If f and 9 are differentiable on their domains this shows 9 0 f is differen­ tiable on its domain, and if dg and df are continuous the formula for d(g 0 f) shows that it, too, is continuous. QED By taking components we can obtain the chain rule for partial derivatives. For simplicity of notation we assume the range of 9 is ]Rl, so go f(x) = g(11 (x), ... , fm(x)). Then m 8(g 0 f)/8xj(Y) = E 8g18zk(Z)8fkI8xj(Y). k=1 This formula was derived under the assumption that f and 9 are differentiable-not just that the partial derivatives exist. We can easily interpret this formula if we think about how a small change in the x j variable affects 9 0 f. First it produces a change in each fk (x) roughly proportional to 8 fkl 8xj, and each of these is transmitted to go f with a factor roughly equal to 8g18zk. The fact that these terms are more or less independent, so we sum their contributions, can be justified by ar­ guing that any interactions between terms will be of smaller order and hence vanish in the limit. This can be seen clearly if we take polynomial 10.1 The Differential 431 functions, say h(Xl,X2) = XIX2,!2(Xb X2) = x� - x�, and g(Zl,Z2) = Zl Z2. Then giving Xl an increment, Xl + h results in !I (Xl + h, X2) = (Xl + h)X2 = XIX2 + x2h and f2(XI + h, X2) = (Xl + h)2 -x� = XI - x� + 2Xlh+h2. Here we have h(XI +h,X2) = h(Xl, X2) +8h/8xI (XI ,X2)h exactly, while f2 (XI + h, X2) = f2(XI, X2) + 8f2/8xt {Xl, x2)h + h2 . Sub­ stituting into 9 we find g(h (XI + h, X2), f2(XI + h, X2)) - h (Xl + h, X2) . f2(Xl + h, X2) (XIX2 + X2h)(XI - X� + 2Xlh + h2) (XIX2)(X� - X�) + «XIX2)2xI + X2(XI - x�))h + (x22xl + XIX2)h2 + x2h3 and the h2 and h3 terms are discarded in the o(h) remainder. Notice that the term X22xl h2 comes from an interaction between 8h /8xl (XI ,X2)h and 8f2/8xI (XI,X2)h and it is, as expected, of s­ maller order than the significant terms. The chain rule can also be interpreted as giving a formula for trans­ forming partial derivatives under a change of variable. For this inter­ pretation we think of g( Zl, ••• , Zm) as a given function of m variables whose partial derivatives 8g/8zk are known. We then assume that Xl, ••• ,Xn are new variables that are connected to the Z variables by the equations Zk = fk(Xl , ... , xn). (Usually we have n = m in this interpretation, although strictly speaking this isn't necessary.) Then we may regard 9 as also a function of the X variables, g(Zl , ... , zm) = g(fI (X l , ••• ,xn), f2(Xl , ... , xn), ... , fm(x}, ... ,xn)). Of course this new function is just go f(x). Then the partial derivatives of the new 9 with respect to Xj are computed by the chain rule: 8g t 8g ( 8zk) 8xj = k= l 8Zk 8xj . Of course this notation suppresses some of the evidence of what is going on, but it is undeniably convenient. There is, however, one grave danger of confusion. If some of the Z variables are the same as the X variables, the corresponding partial derivatives may be different. In other words, Zl = Xl does not imply 8g/8xI and 8g/8z1 are equal. Perhaps the simplest way to understand this is to realize that 8g/8xI 432 Chapter 10 Differential Calculus in Euclidean Space means the derivative of g obtained by varying Xl and holding fixed X2 , ••• , Xn, while 8g/8z1 involves varying Zl = Xl but holding fixed Z2 , ••• ,Zm' Clearly these are different. The real problem is that when Zl = X l one is tempted not to introduce a new name for the variable. Clearly this is a temptation to be resisted. We conclude this section with a discussion of maximum and min­ imum problems in several variables. This is just a preliminary dis­ cussion, and we will return to the topic several times again. Here we simply want to observe that the vanishing of the gradient is a neces­ sary condition for the existence of a max or min in the interior of the domain, which is almost an immediate consequence of the analogous one-dimensional result. Theorem 10.1.4 Let f : D -t 1R for D C lRn , and let y be a point in the interior of D. If f assumes its maximum or minimum value at y and f is differentiable at y� then df (y) = 0 (i. e. , 8 f /8X I (y) 0, 81/8x2 (Y) = 0, . . . ,8/ /8xn (y) = 0) . Proof: If y is in the interior of D, then y + tej must belong to D for t in a neighborhood of zero; and if d/ (y) exists, then g( t) = 1 (y + tej) is differentiable at t = O. Clearly g attains its max or min at t = 0, so g' (O) = 0 by the n = 1 case. Thus 8/ /8xj (Y) = g' (O) for all j, so df (y) = O. QED 10. 1. 4 Differe ntiation of Integrals We return to the question of differentiating a general function defined by an integal. A function of a single variable X might be given by an expressIOn lb(X) /(x) = g(x, y) dy a(x) where a( x) and b( x) are Cl functions of one variable and g is CI on 1R2 • In Chapter 6, we stated without proof the theorem that 1 is Cl and its derivative is given by lb(X) 8g /' (x) = b' (x)g(x, b(x)) - a' (x)g(x, a(x)) + a (x, y) dy. a(x) X We are now in a position to give the proof. 10.1 The Differential 433 To do this we introduce a function F(XI , X2, X3} of three variables that isolates the three appearances of x in the definition of f: Then f(x} = F(x,x, x} and so I 8F 8F 8F f(x} = -8 (x, x, x} + -8 (x, x, x} + -8 (x, x, x) Xl X2 x3 by the chain rule (provided F is CI ). But the computation of 8F/8xl and 8F / 8X2 is easily accomplished by the one-dimensional chain rule and the fundamental theorem of the calculus (differentiation of the integral). For F(Xb X2, X3) = G(b(xt}, a(x2), X3) where G(b, a, X3) = J: g(X3, y) dy, so and 8F 8G 8b I 8Xl (Xl , X2, X3) = 8b 8XI = b (Xdg(X3, b)(XI)) 8F 8G 8a I 8X2 (Xl , X2, X3) = 8a aX2 = -a (X2)g(X3, a(x2)}. This shows 8F/8xI and 8F/8x2 are continuous, and 8F/8xI(X, X, X) and 8F/8x2(X, x, x) are the first two terms in the claimed formula for f' (x). It remains to compute 8F/8x3. Since b(xd and a(x2} are held fixed, we can simplify the notation and show 8 lb lb 8g 8x a g(x, y} dy = a 8x (x, y) dy. We also need to show that this a continous function. Thus to com­ plete the proof of our differentiation formula we need to establish the following lemma. Lemma 10. 1.1 a. If 9 is a continuous function on R2 , then J: g(x, y} dy is a contin­ uous function of x. 434 Chapter 10 Differential Calculus in Euclidean Space b. If g is C1 on �2 , then J: g(x, y) dy is C1 on � and Proof: d lb lb dx a g(x, y) dy = a 8gI8x(x, y) dy. a. On any compact set, say the rectangle a < x < b, c < Y < d, the function g is uniformly continuous. So given any lin there exists 11m such that Ig(x, y) - g(XI, y) I < lin provided Ix - x'I < 11m for (x, y) and (x', y) in the rectangle (of course more is true, but this is all we need) . If we consider two Cauchy sums approximating J: g(x, y) dy and J: g(X', y) dy, evaluating at the same y values, they can differ by at most (b - a)ln, because I L g(x, yj )�yj - L g(x\" Yj)�yj l < L Ig(x, Yj ) - g(x', Yj )I�Yj 1 < n L�Yj = (b - a)ln. Keeping x and x' fixed (with I x - x' I < 11m) and taking the limit as the maximum interval length of the partition goes to zero, the sums become integrals and we obtain I J: g(x, y) dy - J: g(X', y) dyl < (b - a)ln. This is the desired continuity of the integral. b. We form the difference quotient ! ([ g(x + h, y) dy -[ g(x, y) dY) = [ ! (g(x + h, y) -g(x, y)) dy. We want to take the limit as h ---t 0 and interchange the limit and the integral, which will be justified if we can show that (g(x + h, y) - g(x, y))lh converges to 8gI8x(x, y) uniformly for y in [c, d]. But the mean value theorem shows that the difference quotient (g(x + h, y) - g(x, y) )lh is equal to 8gI8x(z, y) for some point z be­ tween x and x + h (z depends on y also) . The uniform convergence of 8gI8x(z, y) to 8gI8x(x, y) then follows from the · uniform continuity of 8g 18x on the rectangle. QED 10.1 The Differential 435 10. 1. 5 Exercises 1. If A is any m x n matrix prove that there exists a constant M such that IAxl < Mlxl for every x in an . 2. Prove that f : D � am is differentiable at a point if and only if each of the coordinate functions fk : D � a is differentiable at that point. 3. If f is differentiable at y, show that duf(y) is linear in u, meaning d(au+lro)f(y) = a�f(y) + bdvf(y) for any scalars a and b. 4. Let f : D � am and 9 : D � am be differentiable at y. Let f . 9 : D � R be defined by the dot product in am . Prove that / . 9 is differentiable at y, and find a formula for the differential d(f . g)(y). 5. Let f : D � a3 and 9 : D � 1R3 be differentiable at y, and let f x 9 be defined by the vector cross product in Jlt3. Prove that f x 9 is differentiable at y and d(f x g) (y) = df(y) x g(y) + f(y) x dg(y). 6. Let f : D � R be differentiable at y, and suppose V f(y) ;/; O. Show that duf(y) as u varies over all unit vectors (lui = 1) attains its maximum value when u = >..Vf(y) for some >.. > 0 and duf(y) = IVf(y) 1 for that choice of u. 7. Let f : D � a be differentiable at y, and suppose V f(y) =F O. Show that duf(y) = 0 if u is orthogonal to V f(y). 8. Let f : D � a for D c a2 be differentiable. Let (x, y) denote cartesian coordinates in R2 and (r, 8) denote polar coordinates in ]R2 . Express 8/18x and 8f 18y in terms of 8f 18r and 8f 188 and, conversely, at every point except the origin. 9. Let / : an -+ R be differentiable. Show that there exists 9 an-1 � a with f(x}, . . . xn) = g(X2 , ... , xn) if and only if 8f 18X! = O. 10. Let 9 : [a, b] � Rn be differentiable. If f : Rn � R! is differen­ tiable, what is the derivative (dldt)f(g(t))? 436 Chapter 10 Differential Calculus in Euclidean Space 11. Let Xl , ... ,Xn and YI ,' .. ,Yn be given real numbers with the x's distinct. Find the affine function g( x) = ax + b such that ,,£j=I (Yj - g(Xj ))2 is minimized. 12. *Suppose 1 : jRn --+ jR is Cl and g : jRn --+ jR is an affine function such that the graphs of 1 and g intersect at the point (y, 1 (y) ) in jRn+1 but do not intersect at any other point in a neighbor­ hood of (y, 1(y) ), where n > 2. Prove that g is the best affine approximation to 1 at y. 13. Show that the following functions are differentiable and compute d1 : a. 1 : jR2 --+ jRI , b. 1 : jR3 --+ jR2 , c. 1 : jR2 --+ jR3 , 1(XI, X2 ) = X l eX2 • 1(XI , X2 , X3 ) = (X3, X2 ). 1(XI, X2 ) = (Xl , X2, XIX2 ). 14. * A contour map shows the curves h(x, y) = c for values of c differing by fixed amounts (usually 50 feet or 100 feet), where h is the altitude function. The gradient \\1 h is larger in regions where the contour curves are denser, and \\1 h lies in a direction roughly perpendicular to the contour curves. Explain why this is so. 15. If 1 : D --+ jR is el with D C jRn and D contains the line segment joining x and y, show that 1(Y) = 1(x) + \\1 1(z) , (y - x) for some point z on the line segment. Explain why this is an n-dimensional analog of the mean value theorem. 16. Let 1 : jRn --+ jRm be el . Show that dl = 0 if and only if I is contant and that dl is constant if and only if I is an affine function. 17. Let 1 : jR2 --+ jR be e1 and satisfy 1(0, y) = 0 for all y. Prove that there exists g: jR2 --+ jRI that is el , such that I(x, y) = xg(x, y) 18. If 1 : jR --+ jR is el and g : jR --+ jR is continuous and one of them has compact support, show that I * g is el and (I * g)' = I' * g. 19. If g : jRn+1 --+ jR is el and I(x) = J: g(x, y) dy (for x E jRn ) , show that I is el and 81/8xj (x) = J: 8g/8xj (x, y) dy. 10.2 Higher Derivatives 10.2 Higher Derivatives 10.2.1 Equality of Mixed Partials 437 We begin by defining the second derivative. IT f : D -+ Rm (with D C Rn ) is differentiable, we can regard df as a function df : D -+ lRm xn taking values in the space of m x n matrices. We can then ask if this function is differentiable. IT it is, its differential d(df)(y) at a point will be an (m x n) x n matrix, which we will call the second derivative, ,p. f(y). For simplicity we will usually deal with the case m = 1, since the general case reduces to this by considering coordinate functions. IT f : D -+ R, then ,p. f(y), if it exists, is an n x n matrix called the Hessian of f at y. We can also define higher derivatives, but the notation becomes a bit awkward. What are the entries of the Hessian matrix? To answer this we write dl = af aXn as a column vector. (We are thinking of df as taking values in Rn that we identify with 1 x n matrices by transposing the row vector to a column vector.) IT dl : D -+ Rn is differentiable, then we can again express d( df) in terms of partial derivatives: 8 8f a 8f -- -- aXl aXl 8xn aXl d(df) = a af a al -- -- ax! aXn aXn aXn We write 821 /8xj 8xk for 8/8xj ({)I/{)Xk) and so (cP I)jk = {)2 1/()Xj{)Xk. We call 02 f /OXjOXk a second-order partial derivative, which is given by a2 f () _ Ii af /aXk (y + tej) - 8f /8Xk(Y) -::---�- y - m . aXj8Xk t-O t Notice that this can be defined, independent of the existence of d2 I, as long as 81/8xk exists in a neighborhood of y. 438 Chapter 10 Differential Calculus in Euclidean Space The main result in which we are interested is the equality 82 j /8xj 8xk = 82 f /8Xk8xj . This is not true without additional hy­ potheses, but the counterexamples are not of great significance, so we leave them to the exercises. We can interpret the identity 82 j /8xj 8xk = 82 j /8Xk8xj in two ways. First, it says that the Hessian is a symmet­ ric matrix. This is a significant observation since there are a number of powerful theorems of linear algebra that apply to symmetric matri­ ces. For example, a symmetric matrix always has a complete set of eigenvectors. This fact is especially valuable in studying maxima and mlmma. The second interpretation of 82 f /8xj 8xk = 82 j /8Xk8xj involves the commutativity of the \"operators\" 8/8xj and 8/8xk . Here we are thinking of the partial derivatives 8/8x j as functions ( \"operators\" ) whose domain and range consist of spaces of functions j : D --+ JR., with 8/8x j mapping the \"point\" j to the \"point\" 8 j /8x j. Without going into the details of the precise definition of 8/8x j as an operator, it is clear that 8/8xj (8j /8Xk ) = 8/8xk (8j /8xj ) does in fact express a commutative law for partial derivatives. If we simply substitute the definitions in terms of difference quo­ tients we find 8j (x + tek) _ 8j (x) 1. 8xj 8xj = 1m -�-------=:-- t-O t 1· l' j(x + tek + sej) - j(x+tek ) l' j(x+sej) - j(x) 1m 1m - 1m ----=----� t-O s-O st s-O st 1. l' j(x + tek + sej) - j(x + tek ) - j(x + sej) + j(x) 1m 1m . t-Os -O st On the other hand, if we compute 82 j /8xj 8xk we will obtain the double limit of the same expression (think of it as a mixed second difference quotient) with the order of the limits interchanged. Thus the identity of 82 j8xk8xj and 82 j8xj 8xk is a statement about the interchange of two limits. Theorem 10 .2.1 Let f : D ---+ R and all partial derivatives of order one and two be continuous. Then 82 f /8xj 8xk = 82 f /8Xk8xj for all j 10.12 Higher Derivatives 439 and k. Proof: We will use the mean value theorem twice to replace the mixed second difference quotient by a second partial derivative evaluat­ ed at an undetermined point and then use the continuity of the second partial derivatives. Define the difference operator, au, by auf(x) = f (x + u) - f (x). In this notation the mixed second difference quotient is ate/c a,ej f(x)/st. A direct computation shows that the operators ate/c and a,ej commute, that is, atelc a,ej f (x) = a,ej atelc f (x), since both are equal to f(x + tek + sej) - f(x + tek) - f{x + sej ) + f(x). Con­ sider first atelc a,ejf(x), and think of it as atelcg(x) for the function g(x) = a,ej f(x). Note that the mean value theorem for 9 (regarded as a function of Xk alone, with the other variables held fixed) can be written in the form ate/c g(x)/t = 8g/8xk(X + t1ek) for some t1 between o and t. Thus Then one more application of the mean value theorem yields where S1 lies between 0 and s. The same argument with the difference operators in the reverse order shows for different values t2 and S2 in the same range. Since the differ­ ence operators commute, we have the equality of the mixed partial derivatives in reverse order at two different points, 82 f /8Xk8xj (X') = 82 f /8xj8xk (X\"), where x' = X +t1ek+s1ej and x\" = X + t2ek + s2ej are both confined to the same small rectangle near x, as shown in Figure 10.2.1. Since this is true for all s and t, we have only to let s -+ 0 and 440 Chapter 10 Differential Calculus in Euclidean Space x Figure 10.2. 1: t --+ 0 in any order and appeal to the continuity of 82 f /8xj 8xk and 82f/8xk8xj to obtain 82f/8xj 8xk (X) = 82 f/8xk8xj (x). QED A careful reworking of the final limiting argument in the proof will allow you to deduce the equality from the assumption that just one of the mixed second partial derivatives is continuous-however, this is of minor interest. Under the hypothesis that all partial derivatives of orders one and two are continuous we can apply Theorem 10. 1.2 twice to conclude that df is differentiable. Such functions are said to be of class C2 . Similarly if all partial derivatives of orders up to k are continuous, the function is said to be Ck • This again implies that full derivatives up to order k exist and are continuous. If f is in Ck for all finite k, we say f is Coo . In dealing with partial derivatives of higher order, a good notation is very important. We will find the multi-index notation introduced for polynomials in the last chapter extends nicely to this context. We let ( 8 ) a _ ( 8 ) al ( 8 ) a2 ( 8 ) an - J- - . - ... - J 8x 8X 1 8X2 8xn for any multi-index a. We will always assume the functions involved are Ck for k = 10'1 (recall 1 0'1 = 0'1 + 0'2 + . . . + an ) so that the order of the partial derivatives is irrelevant. Note that again assuming f is Ck for k = 10'1 + 1,8 1 . 10.2 Higher Derivatives 441 10.2.2 Local Extrema We now consider further the question of local maxima and minima for C2 functions. We have seen already that the vanishing of the differential is a necessary condition for a local extremum. A point where df(x) = 0 is called a critical point. In this section we will show how to use the second derivative d2 f to analyze the behavior of a function near a critical point. It will turn out that we can reduce the problem to the one-dimensional situation by considering the restriction of the function to all lines passing through the critical point. Let f : D -+ R be a C2 function with a critical point at y, so df(y) = O. Let � f(y) denote the Hessian matrix {82 f(y)/8xj8xk} at the point y. For any line passing through y, given as y + tu, the restriction of f to the line gives a function g(t) = f(y + tu) of one variable, which is C2• Note that g(t) = df(y + tu)u = 2:7=1 8f /8xj (Y + tU)Uj by the chain rule, so g'(O) = O. Also g\"(t) = E�k=l 82 f /8xj8xk(y+tU)UjUk = (�f(y+ tu)u, u), where ( , ) denotes the inner product on an . Thus it is not surprising that the expression (�f(y)u, u) (regarded as a function of u in Rn ) is the key quantity to study, since it is g\" (0) and we know how g\"(O) relates to the behavior of g(t) near the critical point t = O. For example, if f has a local minimum at y, then so does 9 at 0 and so 9\" (0) > O. On the other hand, if g' (O) > 0, then we know 9 has a strict local minimum at O. If this is true for all lines through y, we expect to be able to prove that f has a strict local minimum at y. This discussion points to the importance of conditions like (�f(y)u, u) > 0 or (d2 f(y)u, u) > 0 for all vectors U =F 0 in an . The first case we call non-negative definite and the second we call positive definite. These definitions come from the theory of quadrat­ ic forms, which we can define simply as functions on an of the for­ m (Au, u) = Ej\\=l Ajkujuk where A is any symmetric matrix. A quadratic form is said to be non-negative definite if (Au, u) > 0 for all non-zero u in an and positive definite if (Au, u) > 0 for all DOD-zero u in Rn . We define non-positive definite and negative definite in the same way with the inequalities reversed. We will need the following basic facts about positive definite quadrat­ ic forms: 442 Chapter 10 Differential Calculus in Euclidean Space Lemma 10.2.1 a. A quadratic form (Au, u) is positive definite if and only if there exists e > 0 such that (Au, u) > elul2 for all u. b. If (Au, u) is positive definite, then so is (Bu, u) for all symmetric matrices B sufficiently close to A. Proof: a. It is clear that the inequality implies that the quadratic for­ m is positive definite, so it suffices to prove the converse. Note that (Atu, tu) = t2(Au, u) for real t, so the quadratic form has the same sign along lines through the origin. Thus (Au, u) is positive definite if and only if it satisfies (Au, u) > 0 for u in the unit sphere lui = 1. (The setup is symbolized in Figure 10.2.2) . Figure 10.2.2: But the sphere is compact, and (Au, u) is continuous on Rn and, hence, on the sphere (with the subspace metric). Thus the quadratic form attains its inf on the sphere, which must be positive since (Au, u) > o. Thus we must have (Au , u) > e > 0 on the sphere for some e > o. This then implies (Au, u) > elul2 for general u (because Itu l = 1 if t = lui-I ). b. The symmetric matrices may be viewed as a Euclidean space of dimension n(n + 1)/2 (as coordinate variables take all entries on or above the diagonal-the below diagonal entries are determined by symmetry). Given a positive definite quadratic form (Au, u) , choose 10.2 Higher Derivatives 443 e > 0 as in part a. If we take any symmetric matrix B sufficiently close to A in the Euclidean metric, then all the entries of B - A will be small and we can make ((B - A)u, u) < eluI 2/2. Then (Bu, u) = (Au, u) + ((B - A)u, u) > e lu l2 - clul2 /2 = eluI2 /2, so B is positive definite. QED Part b of the lemma says exactly that the positive definite matrices form an open set in the space of symmetric matrices. In particular, for a C2 function f, if (d2 f(x)u, u) is positive definite for one value of x it must be positive definite in a neighborhood of x. Theorem 10.2.2 Let f : D --+ IR be C2 with D C JRn an open set. Let y in D be a critical point. a. If y is a local minimum (respectively maximum) , then d2 f(y) 'tS non-negative definite (respectively nonpositive definite) . b. If d2 f (y) is positive definite (respectively negative definite) , then y is a strict local minimum (respectively maximum) . Proof: a. This is an immediate consequence of the one-dimensional case and the fact that g\"(O) = (d2 f(y)u, u) for g(t) = f(y + tu) . b. Here we have to proceed more cautiously, because we cannot deduce that f has a local minimum at y merely from the fact that g(t) = f(y + tu) has a strict local minimum at 0 for every u. The problem is that g(t) having a strict local minimum at 0 means there exists c > 0 such that g(t) > g(O) for t f:. 0 and It I < c. But this c depends on 9 and, hence, on u. Thus we know only that f (y+tu) > f (y) if t f:. 0 and It I < e(u) , and the set of such values y + tu may not necessarily constitute a neighborhood of y, as in Figure 10.2.3. To show y is a strict local minimum we need to show f (x) > f (y) for x in a neighborhood of y. We will show that this is true on a ball Ix - yl < c on which d2 f (x) is positive definite-we have already observed that such a ball exists by the lemma. Fix u with lui = 1, and look at g(t) = f(y+ tu) on It I < c (this c does not depend on u). We have g' (O) = 0 and g\" (t) = (d2 f(y+ tu)u, u) > 0 as a consequence of the positive definiteness. We claim that this implies 444 Chapter 10 Differential Calculus in Euclidean Space Figure 10.2.3: o is a strict minimum of 9 on the interval It I < E. (Indeed if g(td < g(O) for 0 < tl < E, then for 0 < t2 < tl by the mean value theorem and then for 0 < t3 < t2 by another application of the mean value theorem (a similar argument works if -E < tl < 0.) Thus g(y) < g(y + tu) for t =F 0, It I < E, and every u with lui = 1; hence, g(y) < g(x) for x =F y in the ball Ix - yl < E. QED In view of this result it becomes important to know whether or not a quadratic form is positive definite. We can understand the problem better if we use a basic fact from linear algebra-the spectral theorem. Given any square matrix A, we say u is an eigenvector with eigenvalue A if u =F 0 and Au = AU. Here A is any scalar value, with A = 0 allowed. We must insist u =F 0, otherwise AO = '\\0 for any A. The spectral theorem says that for a symmetric matrix A there exists a complete set of eigenvectors; that is, there exists an orthonormal basis u(1) , ... , u(n) of Rn with Au(k) = AkU(k). This is sometimes expressed by saying A is diagonalizable by an orthogonal matrix, for the linear transformation 1 O. � Higher Derivatives 445 x � Ax is represented by the diagonal matrix with respect to the basis u(1), ... , u(n). We will not make use of this interpretation. What does the spectral theorem say about the quadratic form (Ax, x)? Since an arbitrary vector x can be expressed as a linear combi­ nation of the orthonormal basis elements u(j) as x = Lj=1 (x, u(j») u (j), we can substitute this into (Ax, x), noting that n n Ax = E(x, u(j»)Au(j) = E(x, u(j»)Aju(j) j=1 j=1 and so (Ax, x) = 2:j=1 Aj (x, u(j))2 because the u(j) are orthonormal «u(j),u(k») = 0 if j =F k and (u(j), u(j») = 1). Thus the spectral theorem shows us that the most general quadratic form is a weighted sum of squares. The terms (x, u(j») are just the coordinates of x with respect to the orthonormal basis {u(j)}, and the weighting factors Ai are just the eigenvalues. It is clear that the sign of (Ax, x) will be determined by the sign of the eigenvalues Aj. The quadratic form will be positive­ definite if and only if all the eigenvalues are positive, non-negative definite if and only if the eigenvalues are all non-negative, and so on. The problem of deciding the type of a quadratic form is thus reduced to the signs of the eigenvalues. Since the eigenvalues of a matrix A are the roots of the characteristic polynomial p( A) = det (AI - A), this reduces to an examination of the signs of the coefficients of p( A). In fact, p(A) = TIj=1 (A - Aj ) = Lk=O akAk with an = 1. If Aj > 0 for all j, then the signs of ak alternate; while if all Aj < 0, then ak > 0 for k. The converse statements are also true and so we have a criterion for positive or negative definiteness in terms of the characteristic polynomial. There is also a related criterion in terms of the signs of the determinants of sub matrices of A. In view of the importance of the spectral theorem, we will give a proof of it. This proof is not algebraic but rather uses the differential calculus in Euclidean space. It also has the virtue of being adaptable to 446 Chapter 10 Differential Calculus in Euclidean Space certain infinite-dimensional situations. It is based on the observation that the function (Ax, x) / (x, x), called the Rayleigh quotient, attains its maximum value when x is an eigenvector corresponding to the largest eigenvalue. If we assumed the spectral theorem this would be a simple exercise; but since we are trying to prove the spectral theorem, we will have to use this only for motivation. In fact, we observe that the Rayleigh quotient is homogeneous of degree zero-if we multiply x by a scalar it does not change the Rayleigh quotient. This means that the values of the Rayleigh quotient on JRn minus the origin (it is not defined for x = 0) are the same as its values on the unit sphere. But the unit sphere is compact and the Rayleigh quotient on the sphere is just (Ax , x), a continuous function, so it attains its maximum. Passing back to JRn minus the origin, we have shown the existence of a maximum for (Ax, x)/ (x, x), hence a critical point . Lemma 10.2.2 Let x =1= 0 in lRn be a critical point for (Ax, x)/(x, x) . Then x is an eigenvector for A. Proof: We compute � ( (AX,x)) = Ix I 2� (AX, x} - 2xj (Ax, x} aXj (x, x) Ix l4 and so the equations for a critical point are IxI2a/axj (Ax, x) 2xj (Ax, x), for j = 1, ... ,no Now since A is symmetric, a ax ' (Ax, x) J a nn n n ax ' L L AikXiXk = L AjkXk + L AijXi J i= l k= l k=l i= l n 2 L Aj kX k = 2(Ax)j . k=l Thus the critical point equations are 2IxI2 (Ax)j = 2xj (Ax, x) or Ax = AX where A = (Ax, x)/(x, x). QED Thus we have a way to get eigenvectors and so we know that there is at least one eigenvector, which we can normalize to have length one by multiplying by an appropriate scalar. Call it u. To complete the proof of the spectral theorem by induction we want to restrict attention to 1 o. � Higher Derivatives 447 the orthogonal complement of u, the (n - 1 )-dimensional vector space of all x in Rn with (x, u) = o. Now the symmetry of the matrix A is equivalent to the condition (.4%, y) = (x, Ay) for any x and y (choosing x = ej and y = ele gives Ajle = Alej). Thus if x is orthogonal to u, then so is Ax, (Ax, u) = {x, Au} = (x, AIU) = Al (z, u) = 0 since u is an eigenvector. Thus if we call this vector subspace u.l, we have A acting on u.l . Furthermore, A is still symmetric on u.l because the condition (Ax, y) = (x, Ay) is true when we restrict x and y to u.l. We can then repeat the argument to get an eigenvector of length one in u.l, and continuing in this fashion by induction we obtain the complete set of eigenvectors U(l), ••• , u(n). The manner of choice shows that these form an orthonormal set, hence a basis for Rn . This procedure also yields the formula \\ { (.4%, x) 4 0 d· h al (1) (Ie-I)} I\\Ie = sup (x, x) : x -r an x 18 ort ogon to u , ... ,u for the kth largest eigenvalue. This formula is often used in obtaining estimates for the eigenvalues. Example Let /(x, y) = (1/32)x\" + x2y2 - X - y2. The critical points are the solutions of 0/ /ox = (1/8)x3 + 2xy2 - 1 = 0 and 0/ /oy = 2x2y - 2y = O. A simple computation shows there are only the three critical points (2, 0), (1, v'7/2) and (1, -v'7/2). The Hessian for f is ( �x2 + 2y2 4xy ) 4xy 2x2 - 2 • At the point (2 , 0) this is ( 3/2 0 ) o 6 ' which is clearly positive definite, so (2, 0) is a local minimum. At (1, ±V7 /2) this is ( 3 8 1 ±2.../7 ) . ±2\\17 0 Since this matrix has determinant -28 and the determinant is equal to the product of the eigenvalues, we conclude that the two eigenvalues 448 Chapter 10 Differential Calculus in Euclidean Space have opposite signs and so these points are neither local maxima or minima (they are called saddle points) . We will return again to the theory of maxima and minima in Chap­ ter 13, after we have discussed the implicit function theorem. 10.2.3 Taylor Expansions We have been thinking of the differential df as giving the crucial piece of information needed to form the best approximation to f by an affine function in a neighborhood of a point. We can think of an affine func­ tion as a polynomial of degree one, and then the natural generalization is to consider the best local approximation to f by polynomials of high­ er degrees. For simplicity we take f to be real-valued, f : D --+ IR with D � IRn an open set. Motivated by the n = 1 case, we seek a polyno­ mial Tm (Y, x) of degree m in x (here y is a fixed point in D) such that f(x) = Tm (Y, x) + o(lx - ylm ) as x --+ y. Notice that this is truly an n-dimensional problem in that we need to show for every 11 N there ex­ ists 11k such that Ix - YI < 11k implies If(x) - Tm (Y, x)1 < Ix - ylm IN. It is not enough to show that this is true along every line through y, for then the 11k might depend on the choice of the line. Nevertheless, our method of proof will be to use Taylor's theorem in one dimension applied to the restriction of f to each line through y. This will tell us what T m (y, x) has to be, and we will be able to give a proof based on the proof of the one-dimensional Taylor's theorem that will enable us to control 1 I k independent of the line. Let f be cm. This means all partial derivatives (a I ax y� f for 1 0' 1 < m (recall lal = al + ... + an) exist and are continuous. It is easy to see that the restriction of f to every line in IRn (intersected with the domain D of f) is em . We will need a formula for the derivatives of the restriction. Let y + tu be such a line, where y is in D, u is in IRn (u =I 0) , and t is a real variable. Then g(t) = f(y + tu) is the restriction. Lemma 10.2.3 If f is Cm, then g(t) =f (y +tu) is Cm and 1 ( d ) k ua ( a ) a k! dt g(t) = L a! ax f(y + tu) lal=k where a! = al !a2 ! ... an!, for any k < m (note O! = 1 by convention) . 1 O. � Higher Derivatives 449 Proof: This is essentially just an application of the chain rule k times. For k = 1 we have d/dtl(y + tu} = I:i=1 uj81/8xj(Y + tu}, which is of the required form (Ial = 1 implies all aj = 0 except for one aj = 1). For k = 2 we compute ,p. d ( n 81 ) n n 821 dt21 (y Hy) = dt t; Uj 8x/y + tu) = tt t; UjUj OXjOX /y HU). There are two kinds of multi-indices a with lal = 2: those with n - 2 zeroes and two ones and those with n - 1 zeroes and one two. The first kind correspond to 821 /8Xi8xj = 821 /8xj8xi (off-diagonal terms in ,p. I) with j :I: i and occur twice in the sum. The second kind correspond to 82 f /qxj8xj (diagonal terms in ,p. f) and occur only once. But a! is equal to one for the first kind and two for the second kind, so n n 821 0: ( 8 )0: EEUiUj8 .8 . (y + tu) = 2 E ; -8 I(y + tu), .. X, x1 a. x ,=1 3=1 10:1=2 which gives the result for k = 2. The general case is proved by induction. So let us assume that (k � I)! (!r-1 I(y + tu) = E :� (!, r I(y + tu) 1001=k-l and prove the result for k. We differentiate both sides of the induction hypothesis identity to obtain :! (!r I(y + tu) = IQ�-l !:�! (!,r I(y + tu) n 1 uo: 8 ( 8 )0: - E � k a! Uj 8x . 8x I(y + tu). 1001=k-l J=1 1 But (8/8xj) (8/8:£}0: = (8/8x}/3 where f3i = ai for i =F j and f3j = Ot; + 1. Clearly every multi-index f3 with 1f31 = k arises in this way n times, one for each j. Also f3! = f3ja!, so E t! u: Uj� (�)o: I(y + tu) 1 . 1 k Q. 8xJ 8x 10: =k-1J= = E � t f3� uJ3 (!...)/3 I(y + tu) 1/3I=k k j=1 f3. 8x 450 Chapter 10 Differential Calculus in Euclidean Space and (11k) 2:,'1=1 {3j = 1 (since 1{31 = k)j hence, we have the desired identity. QED We write out the one-dimensional Taylor expansion for g{ t) f{y + tu), substituting in the above computation, to obtain m 0: ( 8 )0: g(t) = L L:! ax f(y)tk + o(tm ) . k=O 1001=k Choosing u = (x - y)/lx - yl and t = Ix - yl this becomes I(x) = L (x :t)'\" U: r I(Y) + o(lx - Ylm). 1001$m This looks like the kind of result we want, with (x - y)o: ( 8 )0: Tm (y, x) = L , -8 f(y). I I a. x o: $m Note that Tm (y, x) is a polynomial of degree < m in x. We call it the Taylor expansion of f at y of order m. When n = 1 this agrees with our previous definition. Also note that Tm(y, x) = J(x) exactly if f is a polynomial of degree < m. The problem is that we do not yet have an honest proof that f(x) = Tm(y, x) + o(lx - ylm), because we have only proved it line by line. Since the o{lx - ylm) estimate on each line through y may vary, we may not be able to make o(lx - ylm)/lx - ylm small uniformly on a neighborhood of y. Nevertheless, we will see that we can produce a valid argument by looking back at exactly what was proved in the one-dimensional case. Taylor's Theorem Let f : D -+ R be em, where D C Rn is open, and let y be in D. Define the mth order Taylor expansion as Then f(x) = Tm(y, x) + o(lx - ylm) as x � y. Proof: We have to show that given any error lIN there exists 11k such that Ix - yl < 11k implies If(x) - Tm(y, x) < Ix - ylmlN. Let 10.2 Higher Derivatives 451 h(x) = f(x) - Tm(y, x). Then we claim (% x)/3h(y) = 0 for any 1,81 < m. This follows by direct computation since (818x)/3(x _ y)Q = o at x = y unless f3 = a, and then (818x)Q(x - y)Q = a!. Thus (oI8x)/3Tm(y, x) at x = y consists of just the one term (818x)/3 f(y) and so (818x)/3h(y) = O. Now we use the assumption that f is em, hence h is em, to conclude that (81 8x )P h must be small in a neighborhood of y for all 1f31 < m. Let liN be given. Then there exists 11k such that Ix - yl < 11k implies 1(818x)/3h(x)/ < liN for all 1f31 < m. We want to prove that this in turn implies Ih(x}/ < enlx - ylm IN where en is a constant depending only on the dimension n. If we can do this we will have shown f(x) - Tm(y, x) = o(lx - ylm) as desired. But now we can apply the proof of the one-dimensional Taylor theorem to the function g(t) = h(y + t(x - y)). We have ( d )k tk(x y)k ( 8 )Q dt g(t) = E a� 8x h(y + t(x - y)) IQI=k by the lemma. So setting t = 0 we obtain (dldt)kg(O) = 0 for k < m since (818x)Qh(y) = O. We also have Iy + t(x -y) -yl = tlx -yl < 11k for 0 < t < 1 if Ix - yl < 11k. Thus 1(818x)Qh(y + t(x - y})1 < liN, which gives us the key estimate for 0 < t < 1, where en = LIQI=m 1/a!. (We have also used the estimate I(x - y)QI < Ix - ylm for lal = m, which we leave as an exercise.) The proof of the one-dimensional Taylor's theorem (Theorem 5.4.5) shows that Ig(t)1 < tml(dldt)mg(tl)1 for some value of tl in (0, t). Taking t = 1 and applying (*) we obtain as desired. QED It is worth pointing out the similarity of this proof with that of Theorem 10.2.2 (tJ2 f(y) being positive definite at a critical point im­ plies the critical point is a local minimum) . In both cases we reduced 452 Chapter 10 Differential Calculus in Euclidean Space the n-dimensional result to the one-dimensional result along all lines passing through the point. However, in both cases it was not enough simply to quote the one-dimensional result; we needed further to use the continuity of the derivatives in n-dimensions to obtain estimates uniformly on the lines, and this in turn required that we re-examine the proof of the one-dimensional result. There is also a Lagrange Remainder Formula for I(x) - Tm (Y, x), under the assumption that 1 is cm+ 1 • It has the form I(x) - Tm(y, x) = � (x - y)Q (!...) Q I(z) L.J a! 8x IQI=m+ l where z is some point on the line joining x and y. From this we obtain I(x) -Tm (Y, x) = O(lx _ ylm+l ). The proof of the Lagrange Remainder Formula in n-dimensions is a direct consequence of the one-dimensional case and the lemma. We leave the details as an exercise. 10.2.4 Exercises 1. Let 1 : R2 � R be defined by !(x, y) = xY(X2 - y2 )/(x2 + y2) for (x, y) ;/; (0, 0) and 1(0, 0) = O. Express 1 in polar coordinates. Show that 81 I 8x, 81 I 8y, 82 1 I 8x8y, and 82 1 18y8x exist for all (x, y) in R2 but 821 18x8y(0, 0) #- 821 18y8x(0, 0). 2. Prove the equality of 821 18xj8xk and 821 18xk8xj under the hy­ pothesis that one of them is continuous (and 8118xj and 8118xk are continuous) . 3. Let A be a symmetric matrix. Prove that A is nondegenerate (for every x#-O there exists y#-O such that (Ax, y) #- 0), if and only if all the eigenvalues of A are non-zero. 4. Prove that a positive definite matrix has positive entries on the diagonal. Give an example of a symmetric matrix with positive entries on the diagonal that is not positive definite. 5. Prove IxQI < Ixl/Q/ for every a. 6. Prove the Lagrange Remainder Formula in n-dimensions. 10.12 Higher Derivatives 453 7. *Find a formula for (8/8x)Q(f· g) in terms of derivatives of f and g. 8. For the affine function g(x) = ax + b that minimizes 2:1=1 (Yj -g(Xj))2 (see problem 11 of section 10. 1), show by direct computation that the Hessian is positive definite. 9. Show that if f is C2 and f(x, y) = g(r, 8) where (r, 8) are polar coordinates in R2, then for all (x, y) =F (0, 0). 10. Prove dudvf = dvduf if f is C2 for any vectors u and v. 11. Prove that if f is C3 and tP f (y) = 0 at a critical point y but (8/8x)Qf(y) =F 0 for some a with lal = 3, then y is not a local maximum or minimum. 12. Let f and g be C2 real-valued functions with f(y) = g(y) = 0, dJ(y) = dg(y) = 0, and tP f(y) = >.tPg(y) where tPg(y) is posi­ tive definite (or negative definite). Prove that limx_y f(x)/g(x) = >.. Give a counterexample to the naive generalization of l'Hopital's rule to dimensions greater than one (i.e., find f and 9 that are C1 with f(y) = g(y) = 0, df(y) = >.dg(y) =F 0, but limx_y f(x)/g(x) does not exist). 13. If f and 9 are em functions, prove that the Taylor expansion of order m about y of f . 9 is obtained by multiplying the correspond­ ing Taylor expansions of f and 9 and retaining only the terms of order < m. 14. Prove that the Taylor expansion Tm(Y, x) is unique in that if 9 is any polynomial of degree < m such that f (x) = g( x) + o( Ix _ y\\m) as x -+ y, then g(x) = Tm(y, x). 15. Classify the critical points of the following functions: a. f(x, y) = x4 + x2y2 - y. 454 Chapter 10 Differential Calculus in Euclidean Space x b. I(x, y) = 1 2 2 · + x +y c. I(x, y) = X4 + y4 - x3• 16. Show that if 1 : an � R is C2 and tP I(Y) is positive definite, then the graph of 1 locally lies above the graph of its tangent plane at y. Prove conversely that if the graph of 1 lies locally above its tangent plane at y that tP I(Y) is non-negative definite. 17. Let 1 : a2 � a be C2• Show that 1 satisfies 821 /8x8y(x, y) = 0 if and only if there exist C2 functions g, h : R � a such that I(x, y) = g(x) + h(y). To what extent are 9 and h uniquely determined by 11 18. *Let 1 : a2 � R be C2• Show that f satisfies 82 /8t2 I(x, t) = c2(82 /8x2 )/(x, t) (vibrating string equation) if and only if there exist e2 functions g, h : R � R such that I(x, t) = g(x + ct) + h(x - ct). Here c is a constant (the speed of sound). (Hint: make a change of variable to reduce to problem 17.) 19. Define Pf(x) = 2: lo:l�m co:(8/8x)Q f(x) for 1 : Rn � R any em function, where Co: are constants. Show that if PI = 0, then the same is true for any translate of 1 (g( x) = 1 (x + y) for fixed y). P is called a constant coefficient partial differential operator. 20. If 1 : R � 1R is ek and even (/{ -x) = I(x)), show that F : Rn � R defined by F(x) = f{lxl} is ek• 10.3 Summary 10. 1 The Differential Definition Let f : D � Rm with D c an open. We say f is differen­ tiable at y (a point in D) if there exists an m x n matrix df (y ), called the differential of 1 at y, such that f(x) = f(y) + dl(y) (x - y) + o( lx - yl} 10.9 Summary 455 as x � y (or in other words, given any liN there exists 11k such that Ix - yl < l/k implies If(x) - f(y) - df(y} (x - y) 1 < Ix - yl/N). The differential is uniquely determined by this condition. If m = 1 we also call dl (y) the gradient of f at y and write it V f (y) . If f is differentiable at every point of D we say f is differentiable on D, and if df : D � JRm xn is also continuous we say f is continuously differentiable or Cl . Theorem If f is differentiable at y, then I is continuous at y; in lact, If(x) - f(y) 1 < Mix - yl for x in a neighborhood of y, for some M. Theorem If f and 9 are differentiable at y (or CI • respectively), then so is af + bg and the differential is linear: d(af + bg}(y) = adf(y) + bdg(y) . If f : D � am and 9 : D � a are differentiable, then so is g . f and d(gf} (y) = g(y)df(y) + f(y)dg(y) . Definition The partial derivative 8fk/8xj is said to exist at a point y if fk (y + tej ) = fk (Y) + 8fk/8xj (y)t + o(t) as t -t O. More generally, if u is in an , the directional derivative duf is said to exist at y if f(y + tu) = f(y) + tduf(y) + o(t) as t -t O. Theorem 10. 1.1 II f is differentiable at y, then all partial and direc­ tional derivatives exist at y and dl(Y) is the matrix 8Ik/8xj (Y), while duf(y) = df(y)u. Example f(x, y) = xy/ J x2 + y2 has directional derivatives in all di­ rections at all points in the plane but is not differentiable at the origin. Theorem 10. 1.2 A function f : D � am with D � an open is Cl if and only if the partial derivatives exist and are continuous on D. Theorem 10.1.3 (Chain Rule) Let f : D � am with D � an open, and let 9 : A � ap with A C am open and f(D) C A. If f is differen­ tiable at y and 9 is differentiable at z = f (y ), then go f is differentiable at y and d(g 0 f){y) = dg(z)df(y) (matrix multiplication) . 456 Chapter 10 Differential Calculus in Euclidean Space Theorem 10.1.4 Let I : D -4 R with D C Rn and y in the interior 01 D. If I assumes its maximum or minimum at y and I is differentiable at y, then df(y) = O. Theorem Let 9 : R2 -4 R, a : R -4 R, and b : R -4 R be C1 • Then I(x) = J:�i g(x, y) dy is C1 and lb(X) 8 I'(x) = b'(x)g(x, b(x)) - a'(x)g(x, a(x)) + 8g (x, y) dy e a(x) x Lemma 10. 1.1 a. If 9 : R2 -4 R is continuous, then G(x) = J: g(x, y) dy is continu­ ous. h. II 9 is C1 , then G is C1 with G'(x) = J: 8g/8x(x, y) dy e 10.2 Higher Derivatives Definition Let I : D -4 Rm with D C Rn be differentiable. II dl : D -4 Rn)( m is differentiable at y, then its differential d( d/) (y) (il it exists) is called the second derivative, denoted d2/(y) . 11 m = 1, then d2/(Y) is an n x n matrix called the Hessian 01 I at y. Definition II I is differentiable and 81 / 8x j has a partial derivative 8/8xle(8f /8xj ) at a point y, we say the second-order partial derivative 82 1/8x1e8xj exists at y and equals 8/8xle(81/8xj ). Theorem II I : D -4 R with D C Rn has a second derivative at a point y, then all second-order partial derivatives exist at y and the Hessian � I(y) matrix is (�/)jle = 82 1/8xj8xle. Theorem 10.2.1 Let I : D -4 R be continuous together with all partial derivatives 01 order one and two. Then 821 /8xle8xj = 821 /8xj8xk; hence, the Hessian metrix is symmetric. Definition A function is said to be 01 class Cle il all partial derivatives 01 orders up to k exist and are continuous. 10.:1 Summary 457 Notation a = (aI , a2 , ... , an) is called a multi-index, each aj being a non-negative integer; (a/ax y� f = (a/ aXI y�l (a / aX2y�2 ... (a / aXny�n f; and lal = al + . .. + an is the order of the partial derivative. Definit ion A quadratic form on JRn is a function of the form (Au, u) where A is a symmetric n x n matrix. It is said to be non-negative definite if (Au, u) > 0 for all u and positive definite if (Au, u) > 0 for u =I o. (Similarly, we define non-positive definite and negative definite by reversing the inequalities) . Lemma 10.2.1 a. A quadratic form (Au, u) is positive definite if and only if there exists c > 0 such that (Au, u) > clul 2 for all u. h. If (Au, u) is positive definite, then so is (Bu, u) for all symmetric matrices B sufficiently close to A. Theorem 10.2.2 Let f : D --+ IR be e2 with D C IRn an open set. Let y in D be a critical point. a. If y is a local minimum (respectively maximum) , then d2 f(y) M non-negative definite (respectively non-positive definite) . h. If d2 f (y) is positive definite (respectively negative definite), then y is a strict local minimum (respectively maximum) . Definition An eigenvector u for a matrix A with eigenvalue A 1,S a non-zero solution of Au = AU. Spectral Theorem A symmetric matrix has a complete set of eigen­ vectors. Lemma 10.2.2 Let x =I 0 in JRn be a critical point for (Ax, x)/(x, x) . Then x is an eigenvector for A. Lemma 10.2.3 If f is em , then g(t) = f(y + tu) is em and 1 ( d ) k Q ( a ) Q kl dt g(t) = :E :1 ax f(y + tu) IQI=k ) 458 Chapter 10 Differential Calculus in Euclidean Space where o! = Od02 ! ··· an!, for any k < m (note O! = 1 by convention). Taylor's Theorem Let f : D � 1R be em , where D C 1Rn is open; and let y be in D. Define the m th order Taylor expansion as \" (x -y)Q ( 8 ) Q Tm {Y, x) = L..J o! 8x f(y). IQI$m Then f(x) = Tm {Y, x) + o(lx - ylm) as x -4 y. Chapter 11 Ordinary Differential Equat ions 11.1 Existence and Uniqueness 11. 1.1 Motivation An ordinary differential equation is a relationship between a function and its derivatives, where the derivative is taken with respect to a single variable. Usually we think of this variable as time, although in some applications there may be other interpretations for it. We also want to consider systems of ordinary differential equations that involve more than one function. The term \"ordinary\" thus refers to the number of variables with respect to which we take derivatives-not to the num­ ber of variables in the problem. For example, the theory of celestial mechanics-describing the motions of any number of bodies through three-dimensional space under the influence of gravitational forces-is cast in the form of a system of ordinary differential equations since only time derivatives appear. On the other hand, Einstein's theory of Gen­ eral Relativity describing the same system involves partial derivatives. We have already used ordinary differential equations in the study of transcendental functions. The exponential function satisfies y' = y, and up to a constant multiple it is the unique solution. Similarly y{t) = cos t and z{t) = sin t satisfy the system y' = -z, z' = y; and with the conditions y{O) = 1, z{O) = 0 they are again the unique solution to the system. These observations played a crucial role in our derivation of the 459 460 Chapter 11 Ordinary Differential Equations properties of these functions. We will see that these results are special cases of the general theory that we are going to develop; however, the special tricks that made the proof of existence and uniqueness for these special equations so simple are not available in general, so we will have to work harder. We let t denote the variable with respect to which we take deriva­ tives, and we let x(t) : [a, b) � Rn denote a function of t taking values in an . The coordinate components x j ( t) of x ( t) can be thought of as n separate real-valued functions that the system of equations describes. An ordinary differential equation, abbreviated o. d. e., is an equation of the form F(t, x(t), x'{t), ... , x(m) {t)) = 0 where F is a function defined on an open subset of a1+n(m+l) and taking values in }Rk . Each of the k components of F may be thought of as a separate equation, so we are compressing k equations into one. (Usually k = n, but we will not insist on this here.) Choosing zero for the right side is merely a simplifying convention, for we could always absorb a constant into F (in place of y' + Y = 27 write Y' + Y - 27 = 0). The order of the o.d.e. is defined to be m-the highest derivative that appears in it. Notice that all the functions in the o.d.e. are evaluated at the same time t. Sometimes it is necessary to consider relationships such as x'{t) +x{t - 1) = 1, which involve simultaneously different time values; however, such equation­ s are not included in the standard theory of o.d.e. 's; they are called functional-differential equations or retarded differential equations. By a solution to the o.d.e. F{t, x(t), x'(t), ... ,x(m) (t)) = 0 on an interval I we mean a function x(t) : I � an of class em such that the o.d.e. holds for every t in I (if the interval contains one or both endpoints we interpret the o.d.e. as referring to one-sided derivatives at those endpoints). This means in particular that for each t in I, the value (t, x(t) , x'{t), ... , x(m) (t)) must lie in the domain of F. The solutions we are considering may be thought of as \"local\" solutions, in that we do not require that the interval I be of maximal length in any sense. The function F may be defined for t outside the interval I, and it may even be possible to extend the solution beyond I. For example, consider the o.d.e. x'(t) + x{t)2 = 0 for x(t) taking values in R. The function F ( t, x ( t), x' (t )) is defined on all of 1R3 (in terms of coordinates (Yl , Y2, Y3) for Jlt3 the function is F{y) = y� + Y3) . A solution for this o.d.e. is the function x(t) = lit on any interval I not containing zero. Other solutions are x{t) = I/{t - to) where to 11.1 Existence and Uniqueness 461 is any fixed constant and the interval I does not contain to. It is easy to verify that these are solutions since x'(t) = -l/(t - to)2 and x'(t) + x(t)2 = -l/(t - to)2 + l/(t - to)2 = o. As a consequence of the uniqueness theorem we will prove that there are no other solutions to this o.d.e. In particular there are no solutions defined on the entire line-despite the fact that the function F is defined everywhere and is Coo. This example underlies the motivation for looking at merely \"local\" solutions-if we demanded \"global\" solutions defined for all t for which the o.d.e. makes sense, then we would put ourselves out of business for even this simple example. Later we will see that it is still possible to get global solutions for a certain important class of o.d.e. 's, the linear o.d.e. 'so There is a fairly standard device for reducing an arbitrary o.d.e. to one of first order. In the process we will increase the number of variables (the dimension of the range of x (t) )-in particular, we will always end up with a system, even if we started out with a single equation. The trick is to introduce new names for the derivatives x'(t), ... , x(m-l) (t), up to but not including the highest order. Say m = 3; then let y(t) = x'(t) and z(t) = x\"(t). If the original o.d.e. involves x(t) taking values in Rn (n unknown functions) and F taking values in Rk (k equations), the new o.d.e. will involve 3n unknown functions, namely x(t), y(t), and z(t), and k + 2n equations, namely F(t, x(t), y(t), z(t), z'(t» = 0, x'(t) - y(t) = 0, y' (t) - z(t) = O. The second and third sets of equations simply say what y(t) and z(t) are in terms of x (t), and the first set of equations restates the original o.d.e. The claim is that x(t) : I --T an is a solution of the original o.d.e. if and only if (x(t), x'(t), x\"{t» : I --T ]R3n is a solution of the new o.d.e. and furthermore any solution (x(t), y(t), z(t» : I -+ �n of the new o.d.e. must be of the above form. We leave the simple verification of this claim as an exercise. The new o.d.e. may appear more complicated than the original o.d.e., but it is of first order. It is customary in discussions of o.d.e. 's to insist on this reduction to the first-order case since then one can proceed with a minimum of notational baggage. However, this has the disadvantage that whenever 462 Chapter 11 Ordinary Differential Equations one wants to apply the theory to a higher order equation, it becomes necessary to go through a translation process. We will sometimes opt to deal directly with equations of higher order. There is one other preliminary simplification that we will need to do; namely to solve the equations for the highest order deriva­ tives. In other words, we want to rewrite the equation in the form x(m)(t) = G(t, x(t), ... ,x(m-l) (t)). Usually this is easy to do by in­ spection. If the original o.d.e. is x\"(t)x'(t) + t2 = 0, then we can rewrite it as x\"(t) = -t2/x'(t). However, if the original o.d.e. is x'(t)2 - 1 = 0, then solving for x'(t) yields two different o.d.e. 's, x'(t) = 1 and x'(t) = -1, which have different solutions, all of which are solutions of the original equation. Notice that by solving for the highest order derivative we may end up with a more singular equation. In going from x'(t)2 + 1 - x(t)2 = 0 to x'(t) = ±y'x(t)2 - 1 we go from an everywhere defined Coo F to a partially defined, multivalued G that is not even differentiable when x(t) = 1. This is an important observation, since we will be making assumptions about the function G, and these are not consequences of the corresponding assumption­ s on F. The abstract question of when we can solve equations like F(t, x(t), ... , x(m) (t» = 0 for x(m) (t) = G(t, x(t), ... , x(m-l) (t» is one we will take up in a later chapter with the aid of the Implicit Function Theorem. For now we will simply assume that this preliminary step has been accomplished, and all o.d.e. 's we consider will be in the normal form x(m)(t) = G(t, x(t}, ... , x(m-l)(t» where G is a function defined on an open set of 1R(mn+l) taking values in an . We will always assume G to be continuous, since we want x(t} to be em and so x(m)(t) to be continuous. Notice that in the normal form the number of equations and unknown functions is the same (namely n) . From now on we will always assume this. Perhaps the simplest o.d.e. in normal form we might consider is x'(t) = g(t} for a continuous function 9 : R � lR (here n = k = I). We know from the fundamental theorem of the calculus that this o.d.e. has solutions x(t} = J� g(x) ds + c where c is an arbitrary constant. (The choice of 0 for the lower endpoint in the integral is also arbitrary; we could just as well have started the integration from another point.) We also know these are the only solutions. We can therefore expect in general that solutions to o.d.e. 's are not unique, but we can hope that they can all be described in terms of a finite number of constants. 11. 1 Existence and Uniqueness 463 Looked at another way, we can hope to adjoin a finite number of side conditions to the o.d.e. in order to make the solution unique. In the example x'(t) = g(t) , the condition x(O) = a determines the unique solution x(t) = J� g(s) ds + a. Ideally we would like to adjoin just the correct number of conditions so that the solution is unique and so the solution always exists for all values of the parameters that are involved. Clearly, existence demands fewer conditions and uniqueness demands more conditions, so we hope to strike a happy balance in the middle. (In the example x'(t) = g(t) , the conditions x(O) = a and x(l) = b would also guarantee uniqueness, but there does not exist a solution for every choice of a and b. ) We would like to give an intuitive answer to the question: how much extra information do we need to determine a solution to a given o.d.e.? The first approach is to ask how many free constants-parameters­ one can expect in the general solution. That is, we can expect all solutions to be given by a formula x(t) = f(t, a, b, . . . ) , each choice of the parameters a, b, ... yielding a solution and all solutions corresponding to some choice of the parameters. Indeed, if you look at any elementary textbook on o.d.e. 's, you will find most of the book devoted to methods for explicitly obtaining such formulas in many special cases. Such an approach is often disparagingly described as \"cookbook\" , but in fact many of the \"recipes\" turn out to be valuable in unexpected ways. Here we will use only the very imprecise observation that all the \"recipes\" for solving an o.d.e. of order m involve performing m integrations, and of course each integration picks up an arbitrary constant. Since there are n functions Xl(t), ... , xn(t) being integrated m times, we expect mn constants to be generated and so there should be mn parameters in the general solution. This also means that we will be looking for mn side conditions in order to determine a solution uniquely. This does not mean that we can expect any mn side conditions to work-we still have to examine the problem in detail for particular choices of side conditions. We are only claiming at this point to have a grasp of the number of conditions that need to be imposed. We will now simplify the discussion to consider only conditions involving the unknown functions and their derivatives at a single value of t, say to . Such conditions are known as initial value conditions, with the interpretation that to is some initial time at which we make some measurements on the system, and then we want to predict the behavior 464 Chapter 1 1 Ordinary Differential Equations of the system at future times t > to. Actually our methods will also allow us to \"predict the past\" as well, t < to, so we should take \"initial\" with a grain of salt. It is certainly not the case that all interesting or natural problems involving o.d.e. 's lead to initial value conditions­ many involve boundary conditions in which the values at two points, thought of as the endpoints of the interval on which the solution is expected to exist, are specified. However, initial value conditions are the easiest with which to deal, and form the basis for discussing more general problems. Let us look at the simplest case: one first-order equation in one unknown function, x'(t) = G(t, x(t»j and consider an initial value condition at t = to. Since we expect only one such condition (m = n = 1), the simplest choice would be to specify the value x(to) = a. Is it reasonable to expect that this should determine a unique solution for each choice of the parameter a? One way to think about this is graphically. Suppose we consider the graph of the solution in the t - x plane. What does the differential equation say about this graph? It says the slope of the curve x'(t) at a point t is specified by G(t, x(t» ­ the value of G at the point in the plane on the graph of the solution, as shown in Figure 11.1.1 . x(t) slope = G(t. x(t» t Figure 11.1.1: We can thus think of G( t, x) as a function assigning a slope to every point in the t - x plane. The differential equation requires that we draw the graph of a function subject to the restriction that at each point on the graph the slope is the one prescribed by G. We can further imagine G as given by drawing a tiny (perhaps infinitesimal) line segment at 11. 1 Existence and Uniqueness 465 each point with the given slope so that the plane is covered by a pattern of porcupine quills. The graph of a solution is then obtained by piecing together a curve out of the porcupine quills. The initial condition x(to) = a asserts that the graph of the solution must pass through the point (to, a) . Some people find that this graphical description makes the existence and uniqueness of a solution seem plausible. Another way of looking at the question is in terms of the Tay­ lor expansion of the solution at the point to. The initial condition x(to) = a allows one to determine the value of the first derivative x/{t) of the point to via the differential equation x'(t) = G(t, x(t)), name­ ly x'(to) = G(to, x(to)) = G(to, a). (This computation reveals why it would be foolish to try to specify x' ( to) as well as x (to).) Thus we have the first two terms of the Taylor expansion of x about to, x( t) = a + G(to, a)(t - to) + o(lt - tol}. But we can in fact go further, sim­ ply by differentiating the differential equation. Since x'(t) = G(t, x(t)) holds for t in an interval, we also have (d/dt)x'(t) = (d/dt)G(t, x(t)) or x\"(t) = 8G/8t(t, x(t)) + 8G/8x(t, x(t))x'(t) by the chain rule. This, of course, presupposes that x(t) is C2 and Gis Cl. Under these additional hypotheses we can set t = to and obtain x\" (to) 8G 8G I {jt(to, x{to)) + 8x (to, x(to))x (to) 8G 8G Tt{to, a) + 8x (to, a)G(to, a) where we have substituted the previously determined x/{to) = G{to, a). By induction we can continue to determine all the derivatives x(n)(to) at to by differentiating the o.d.e. n - 1 times, (d/dt)(n-l)x'(t) = (d/dt)(n-l)G(t, x(t)) and setting t = to, for the right side of this e­ quation only involves derivatives of x at to of orders < n, which have previously been determined in the induction step. Again we need to assume that G is en and x ( t) is en+ 1• If the function x ( t) were ac­ tually analytic, then we would have a complete determination of the power series of x(t) about to, which would uniquely specify x(t). Thus we have another plausible reason why the initial condition x(to) = a should specify a unique solution. Despite these plausible reasons, the uniqueness of the solution is not assured without further assumptions. The way to obtain a coun­ terexample is to work backward from the solution to the equation. We 466 Chapter 11 Ordinary Differential Equations want a function whose graph looks like that in Figure 11.1.2 Figure 11.1.2: so that it is identically zero for a while and then slowly lifts off, say x(t) = { t3/2 if t > 0, o if t < O. We choose t3/2 so that the second derivative will fail to exist, but the function is still C1 and '(t) = { (3/2)t1/2 if t > O, x 0 if t < 0 so that x'(O) = o. Now it is easy to concoct the o.d.e., namely x'(t) = (3/2)x(t) 1/3, which this function satisfies. Note that the func­ tion G(t, x) = (3/2)x1/3 is continuous and everywhere defined, al­ though it does fail to be differentiable. This o.d.e. also has the solution x(t) = 0, and both these solutions satisfy the initial condition x(to) = 0 for any choice of to < O. Thus uniqueness fails for this example. It will turn out that the failure of G to be differentiable is the culprit here-we will be able to prove the uniqueness and existence under hypotheses on G that are slightly weaker than differentiability. Before discussing the positive results, let's consider the case of gen­ eral systems (n > 1) and general orders (m > 1). For first-order systems, the same reasoning as above leads us to choose the initial conditions x(to) = a, where this is now a vector equation, Xk(tO) = ak 11. 1 Existence and Uniqueness 467 for k = 1, ... , n, involving n parameters. (Incidentally, we can't re­ duce the general first-order system to n separate first-order equations, because they may be \"coupled\" , as in the example which is familiar from the discussion of the sine and cosine functions.) When we reduce the general o.d.e. system of order m to one of first order, we introduce new variables for the derivatives of x(t} up to or­ der m - 1, so the initial conditions for the first-order system translate to the conditions x(to} = a(O),x'(to} = a(l), .. . ,x(m-l)(to} = a(m-l) where each a(j) is a vector in an . Notice that there are exactly mn conditions. We will call these conditions the Cauchy initial value con­ ditions, and we will refer to the specified values a(j) of the param­ eters as the Cauchy data. Then the Cauchy problem for the o.d.e. x(m)(t) = G(t, x(t}, .. . , x(m-l)(t)) consists of solving the o.d.e. with given Cauchy data. It is a simple matter to verify that the Cauchy da­ ta determines uniquely the values of all derivatives of all the functions Xk (t) at the point t = to, under the assumption that the Xk and G are Coo functions. 11.1.2 Picard Iteration We will now consider how to obtain a proof of the existence and u­ niqueness of solutions of an o.d.e. with Cauchy initial conditions. We will begin with first-order systems and then extend the results to higher order systems. The key idea of the proof is to integrate the o.d.e. to obtain an equivalent integral equation. That is, we take the equation x'(t} = G(t, x(t)) and integrate both sides from to to t: or x(t) - x(to} = i t G(s, x(s)} ds to x(t} = a + i t G(s, x(s}} ds to using the initial condition x(to} = a. This is exactly the way we would obtain the solution of the simple o.d.e. x'(t) = g(t). In the general case we do not obtain the solution in this manner, because after integration the unknown function x(t} appears on both sides of the equation. But 468 Chapter 11 Ordinary Differential Equations is is easy to show that the new equation is equivalent to the o.d.e with the Cauchy initial condition. Lemma 11.1.1 A el function x (t) defined on an interval I containing to satisfying the Cauchy problem x' (t) = G(t, x(t)) and x(to ) = a also satisfies the integral equation x(t) = a + (t G(s, x(s)) ds. Jto Conversely, any continuous function x(t) satisfying the integral equa­ tion is el and satisfies the Cauchy problem. Proof: This is an immediate consequence of the two fundamental theorems of the calculus. We use integration of the derivative as above to go from the Cauchy problem to the integral equation. Conversely, given the integral equation, the differentiation of the integral theorem tells us that f(t) = Jt� G(s, x(s)) ds is a el function with derivative f' (t) = G(t, x(t) ) -this uses the hypotheses that G and x are contin­ uous functions, hence so is G(t, x(t) ). But the integral equation says x(t) = f(t), so we have that x is el and x' (t) = f' (t) = G(t, x(t)) . Thus the o.d.e. is satisfied. Finally we obtain the initial condition x(to ) = a by substituting t = to in the integral equation. QED Thus we have reduced the Cauchy problem to the solution of an integral equation. Have we gained anything by doing this? On a very superficial level we have managed to combine both the o.d.e. and the initial value condition into a single equation. But the real accomplish­ ment is considerably deeper. We can see a hint of it in the asymmetric statement of the lemma. For the o.d.e. we had to assume x(t) was el , but in the integral equation it was enough to assume x(t) was continuous-it then followed that x( t) was el . This gratuitous gain of a derivative is highly non-trivial-normally one doesn't expect a con­ tinuous function to be automatically differentiable. There is a reason for it in this case: the integral equation. Integration \"smooths things out\" , while differentiation \"roughens things up\" . Therefore it is easier to deal with an equation in which integrals appear than with an equa­ tion involving derivatives. There is also one technical point that we will exploit in the proof: aside from the constant a, the right side of the integral equation Jt� G( s, x( s)) ds is small if t is close to to. 11. 1 Existence and Uniqueness 469 It is also significant to consider that the process whereby we passed from the o.d.e. to the integal equation, integration, gave the exact solu­ tion to the simpler o.d.e. x'{t) = g(t). In fact, the gist of our argument will be that the general o.d.e. is some kind of a \"perturbation\" of the simpler one--this will be especially clear in the case of linear equations where we can actually write down a perturbation series expansion of the solution. The idea of exploiting an explicit solution to a simpler problem to prove the existence of a less explicit solution to a more difficult problem is an important theme in the theory of differential equations and perhaps in all of mathematics. The form of the integal equation suggests that we look for the solu­ tion as a fixed point of the mapping x(t) -+ a + ft� G(s, x(s)) ds. That is, we think of a + Jt� G{s, x{s)) ds as a mapping from the function x ( t) to a new function of t-the integral equation then says that the solution we seek is a fixed point of this mapping. It is natural, then, to try to apply the Contractive Mapping Principle, since this will give us a unique fixed point. We consider the metric space C(I) of continuous functions x : I -+ Rn , where I is some interval containing to, with the sup-norm metric d(x, y) = supl lx(t) - y{t)1 where I I denotes the Euclidean norm in Rn . We have seen that this is a complete metric space. We define a mapping T : C(J) -+ C{I) by Tx(t) = a+ It: G(s, x(s)) ds. For this to be defined we need only assume G to be continuous, but for this to be a contraction (d(Tx, Ty) < pd(x, y) for some p < 1) we need to assume more. We have already seen that uniqueness can fail, and even if the solution exists it may not exist over the whole interval. Thus we must both put additional hypotheses on G and shrink the interval I. Since the contraction property is a kind of Lipschitz condition, it is not surprising that we will need to have G satisfy a Lipschitz condition. A quick glance at the form of d(Tx,Ty) = sup! a+ f.:G(S,X(S)) dS - (a+ !.:G(S,Y(S))dS) sup I r\\ G(s, x(s)) - G( s, y{s))) ds lto indicates that we will have to estimate differences G ( s, x) - G ( s, y) where the value of s is the same for both terms. Thus the kind of 470 Chapter 11 Ordinary Differential Equations Lipschitz condition we want is IG(s, z) - G(s, y)1 < Mlz - yl for all z and y in Rn and all s in I (here we are using the letters z and y to denote points in Rn rather than functions taking values in Rn-although there is no harm in substituting these functions into the Lipschitz condition). One might think that we have to put some restriction on the size of the Lipschitz constant M because for the contraction property we need p < 1, but it turns out that this is unnecessary because we can obtain p < 1 by shrinking the interval. We will refer to this kind of Lipschitz condition as a global Lipschitz condition, because it must hold for all z and y in Rn . This is usually too strong a condition-it rules out too many important examples-so we will later have to consider also local Lipschitz conditions. Lemma 11.1.2 Suppose G(t, z) is a continuous junction defined for t in I and x in Rn taking values in Rn , which satisfies the global Lipschitz condition IG(t, x) - G(t, y)1 < Mix - yl for all x and y in an and t in I, and some constant M. Let J be any subinterval of I contained in It - to I < P / M lor some p < 1. Then the mapping Tz(t) = a+ It G(s, z(s)) ds jto on C(J) is contractive, d(Tx, Ty) < pd(x, y) for any x(t) and y(t) in C(J}. Proof: As before, we have d(Tx, Ty) = suPJ l (G(s, x(s)) - G(s, y(s))) ds , except now we are restricting attention to the interval J. Here we need to use a basic inequality known as Minkowski's inequality, which says I f: I(s} dsl < J: I/(s)1 ds for any continuous function I(s) tak­ ing values in an, where I I denotes the Euclidean norm. We have already discussed this inequality in the case n = 1. For the general case it is really a generalization of the triangle inequality. The integral J: f(s} ds is a limit of Cauchy sums L, I(tj)(sj - Sj-l}, for which we have I L, f(tj}(sj-sj-I}I < � If(tj)l(sj -Sj-I} by the triangle inequal- ity, and L, If(tj)l(sj - Sj-I} is a Cauchy sum for J: If(s}! ds. Passing to the limit we obtain Minkowski's inequality. 11.1 Existence and Uniqueness 471 We apply Minkowski's inequality to estimate l' (G{s, x{s)) - G(s, y(s))) ds < l' IG{s, x(s)) - G(s, y(s))1 ds. to to We then substitute the global Lipschitz condition to obtain 1t IG(s, x(s)) - G(s, y(s))1 ds < l' Mlx(s) - y(s)1 ds. to to Thus we have altogether d(Tx, Ty) < supJM 1t Ix(s) - y{s)1 ds. to Finally we make the crude estimate Ix(s) - y(s)1 < d(x, y} for s in J, so It t Ix(s) - y(s)lds < It - told(x, y) for t in J. Since we chose J so that 1t - tol < p/M for t in J, we have d{Tx, Ty) < supJM 1t Ix(s) - y(s)1 ds < supJMlt - told{x, y) to < M· (p/M)d{x, y) = pd{x, y), which is the desired contraction property. QED Notice the crucial way we have used the observation that I� G(s, x(s)) ds is small for t near to to overcome the lack of control over M. We are now in a position to apply the contractive mapping principle to obtain the existence and uniqueness of the solution of the integral equation, hence the Cauchy problem, on the subinterval J. Notice that the contractive mapping principle gives us a constructive method for finding the solution by iteration: choose an arbitrary first guess xdt) (it is simplest to take Xl{t) = a) and then define inductively Xk+l (t) = a + It� G{s, Xk{S)) ds. The solution x{t) is just the limit of x k ( t) as k � 00 in the metric, which means x k ( t) converges to x ( t) uniformly on J. This construction of the solution is known as the Picard iteration method. It can be shown by using more careful estimates that the Picard iteration method actually converges to the solution on the whole interval I not just on J. However, the Picard iteration method is 472 Chapter 11 Ordinary Differential Equations not really very practical for obtaining approximations to the solution­ since doing successive integrations is very time consuming. (It is never used in numerical solutions.) Therefore we will not devote our energy here to obtain more information about the scope of this method, but we will simply take it as a method for proving existence and uniqueness over a small interval. We can then get existence and uniqueness over a larger interval by piecing together solutions over smaller intervals. Theorem 11.1.1 (Global Existence and Uniqueness) If G(s, x) satis­fies a global Lipschitz condition for s in I, then the Cauchy problem x'(t) = G(t, x(t)), x(to) = a, has a unique solution on I (the solution is even unique on any subin­ tenJal containing to). Proof: By the lemmas and the Contractive Mapping Principle, there exists a unique solution on J. If J is not all of I we take a point t1 of J and the value x( tl) = b and give the Cauchy initial conditions X{tl ) = b. Applying the argument to this Cauchy problem we obtain a solution to the o.d.e. on an interval J1 containing ti' Since the two solutions have the same Cauchy data at t1, they must be equal on the overlap of the domains J n J1 because of the uniqueness of the Cauchy problem on J1. Thus we may combine the • • J Figure 11. 1.3: two solutions to obtain a single solution of the o.d.e on the union JUJ1 of the two intervals, as shown in Figure 11.1.3. Repeating this process a finite number of times, we will eventually extend the solution to every point of I since the size of the interval of solution at each stage is 11. 1 Existence and Uniqueness 473 restricted only by the condition It - tk l < p/M for the same fixed p and M (tk here denotes the point at which the Cauchy data is given) . If the interval I is unbounded it will take an infinite number of steps to extend the solution to all of I but only a finite number of steps to get to any given point in I. In this way we pass from local existence and uniqueness to global existence by piecing together solutions. To complete the proof it re­ mains to show that the solution is unique. This is done by looking at the first point where two proposed solutions begin to differ and ap­ plying the local uniqueness result there. Suppose then that x(t) and y(t) are two solutions of the o.d.e. on a subinterval h, containing to , and suppose x(to) = y(to) . We want to show x(t) = y(t) on h. Let tl = sup{t in 11 : t > to and x(t) = y(t) }. Then, by the continuity of x and y, we have X(tl ) = y(tl ) and so, by the local uniqueness of the Cauchy problem at tl , we have x(t) = y(t) in a neighborhood of tl . This contradicts the definition of tl , unless tl is the upper endpoint of h. In a similar way we show that x( t) = y( t) down to the lower endpoint of h. QED 11.1. 3 Linear Equations The global existence and uniqueness theorem allows an immediate ex­ tension: if I = U�l Ij and G satisfies a global Lipschitz condition IG(s, x) - G(s, y) 1 < Mj lx - yl for s in Ij and all X, y in jRn , where the Lipschitz constant Mj depends on the subinterval IJ , then existence and uniqueness holds on I. The reason for this is simply that exis­ tence and uniqueness on I is equivalent to existence and uniqueness on each Ij , which is a consequence of the theorem. This extension is valu­ able because such a function G may fail to satisfy a global Lipschitz condition on all of I. An important example where this remark applies is the class of linear o.d.e. 's, x' (t) = A(t)x (t) + b(t) where A : I -T jRn x n is a continuous (n x n )-matrix-valued function and b : I -T jRn is con­ tinuous. Strictly speaking we should call these \"affine\" equations, limiting the term \"linear\" to the case b = 0, but instead it is tra­ ditional to call x'(t) = A(t)x(t) the homogeneous linear o.d.e. and x' (t) = A(t)x (t) + b(t) the inhomogeneous linear o.d.e. Of course the homogeneous linear o.d.e. is \"linear\" in the sense that linear combina- 474 Chapter 11 Ordinary Differential Equations tions of solutions are solutions, and the theory of linear algebra may be applied. For a linear first-order o.d.e., the function G(t, z) is A(t)x + b(t). The assumptions that A and b are continuous imply that G is contin­ uous. The global Lipschitz condition that needs to be verifed is IG(t,x) - G(t,y)1 = IA(t)x - A(t)yl = IA(t)(x - y)1 < Mix - yl· Now for any fixed matrix A we have IA(x - y)1 < Mix - yl where M depends on the entries of the matrix. The question of finding the smallest M is very delicate, but we can easily get a crude estimate with M2 = 2':j,k IAjk12• Thus if all the entries Ajk(t) of A(t) are bounded on I, we will have a global Lipschitz condition for G holding on I. Since we are assuming that A (t )-hence the entries-are continuous, this is immediately the case if I is compact. But even if I is not compact, we can always write I = Uj=l Ij with Ij compact, and G satisfies a global Lipschitz condition on each Ij• Thus we have Corollary 11.1.1 The Cauchy problem for the linear o. d.e. x'(t) = A(t)x(t) + b(t) with A : I -+ lRnxn and b : I -+ lRn continuous has a unique solution on I. It is instructive to examine the Picard iteration method in the spe­ cial case of linear equations, for then we can represent it in terms of a perturbation series. We consider the equation x'(t) = A(t)x(t) +b(t) as a perturbation of the simpler equation x'(t) = b(t), which we know how to solve exactly. We can represent this in concise notation by writing Dx for x'(t) and Ax for A(t)x(t). Then Dx = b is the simple equation and Dx = Ax + b or (D - A)x = b the perturbed equation. Under the initial condition x(to) = a, the simple equation Dx = b has the explicit solution x(t) = a + J,: b(s) ds. For simplicity we will set a = O. We define D-l f(t) = It: /(8) ds so that D-1b is the solution of Dx = b with initial condition x(to) = O. In the perturbed equation (D - A)x = b with initial condition x (to) = 0, we will think of A as being small relative to D. This suggests writing the equation as (D-A)x = D(I -D-l A)x = b, where I denotes the identity operator, I x = x. Then, at least formally, we can solve x = (I -D-l A)-l D-1b. We already know what D-l means, but what does (I - D-l A)-l mean? We are thinking of A as small compared to 11 .1 Existence and Uniqueness 475 D, so D-l A should be small compared to I. Now if r is a real number that is small compared to 1 (if Irl < 1), then (1 -r )-1 = 1+r+r2+ . .. = ��o rk. We could thus hope that 00 (I - D-1 A)-l = 1+ D-1 A + (D-1 A)2 + ... = E(D-1 A)k. k=O This leads to the \"solution\" 00 x = E(D-1A)kD-lb k=O D-1b + D-1 AD-1b + D-1 AD-1 AD-1b + ... . Of course we have only derived this perturbation series solution in a formal manner. Now, what does this have to do with the Picard iteration method? Since we are free to choose any initial approximation xo(t) to the solu­ tion, let's take xo(t) = D-1b(t), the solution to the simpler equation. Then the Picard iteration method defines and inductively xdt) = r (A(s)xo(s) + b(s)) ds, }to Xk(t) = rt (A(S)Xk-l (X) + b(s)) ds. lto Since this is just Xk = D-l AXk-l + D-lb, we find Xl - D-1AD-lb + D-lb, x2 - D-l AD-1 AD-lb + D-l AD-1b + D-lb, and in general Ie xk = E(D-1 A)1 D-1b. 1=0 Thus the Picard interation method produces the partial sums of the perturbation series. H we take the general case a =F 0 and choose xo(t) = a + D-lb(t), then we find XIc = EJ=o(D-l A)i(a + D-lb). We 416 Chapter 11 Ordinary Differential Equations leave the details as an exercise. In particular, since we know the Picard iterations approximate the solution on some interval about to , we can conclude that the perturbation series converges on that interval (in fact, that the convergence is uniform, since we are using the sup-norm metric in the Contractive Mapping Principle). There are many other contexts in which the method of perturbation series can be applied. 11.1. 4 Local Existence and Uniqueness* Aside from the linear equations, there are very few o.d.e. 's for which the function G satisfies a global Lipschitz condition. We have already observed that the o.d.e. x'(t) = -x(t)2 has solutions x(t) = l/{t - td that fail to exist for all t, so the global existence and uniqueness theorem can't apply. In this case it is easy to see that G( t, x) = -x2 fails to satisfy a global Lipschitz condition. Nevertheless, it satisfies a local Lipschitz condition, IG(t, x) - G(t, y) 1 < Mix - YI, if we restrict x and Y suitably, say Ixl < Nand Iyl < N (then the Lipschitz constant M will depend on N). Such a local Lipschitz condition is rather easy to obtain-in fact it is true in general if we merely assume that G is Cl . We could hope, then, that the local Lipschitz condition would suffice to prove a local existence and uniqueness theorem. This is indeed the case and provides us with a very valuable theorem. The idea of the proof is again to use the contractive mapping prin­ ciple, not on the whole space C(I), but rather on a part of it-a part on which x(t) is bounded-so the local Lipschitz condition applies. The difficult part of the proof turns out not to be the contractive estimate-­ that argument is the same as before--but the verification that the part of C(I) is mapped into itself. As before we will take a subinterval J of I, but now we will also impose the condition Ix(t) - al < N for all t in J. We let Co(J) denote the metric subspace of C(J) of all continuous functions x : J � an satisfying Ix(t) - al < N for all t in J, with the sup-norm metric d(x, y) = sUPJ Ix(t) - y(t) l. Note that the condition Ix(t) - al < N for all t in J is the same as d(x, a) < N, where a denotes the function that is identically equal to a. Thus the subspace Co (J) is actually the closed ball of radius N and center a in C(J). Being a closed subspace of a complete space it is complete, so we can apply the contractive mapping principle to mappings of Co (J) to itself. We want to apply it in particular to the mapping Tx(t) = a + Jt� G(s, x(s))ds. 11. 1 Existence and Uniqueness 477 It will not be hard to show that T is a contractive mapping from Co (J) to C(J) , but first we show that the image lies in Co (J). Lemma 11 .1.3 Let G(t, x) be defined and continuous for t in I and x in Ix - al < N, and let Mo be the sup of IG(t, x) 1 for t in I and Ix - a l < N. Then Tx (t) = a+ ftt G(s, x(s) ) ds maps Co (J) into Co (J) provided J is contained in It - tol < N/Mo . Proof: Note that Tx (t) is a continous function (even C1 ) because it is a constant plus an integral of the continuous function G(s, x(s)). Thus the image of T lies in C(J) . We need to show ITx(t) - al < N for every t in J. But ITx(t) - a l = (t G(s, x(s)) ds < (t IG(s, x(s))1 ds �to �to by Minkowski's inequality, and then we can substitute IG(s, x(s))1 < Mo to obtain ITx(t) - al < Mo lt - to l < N if It - to l < N/Mo . QED Notice that the local Lipschitz condition did not play a role in the above argument-it will only be used to get the contractive estimate. Theorem 11.1.2 (Local Existence and Uniqueness) Let G(t, x) be de­ fined and continuous for t in I and Ix - a l < N, and let it satisfy the local Lipschitz condition IG(t, x) - G(t, y) 1 < Mix - yl for t in I and Ix - al < N, Iy - al < N. Then for to in I there exists a subinterval J containing to on which the Cauchy problem x'(t) = G(t, x(t) ), x(to ) = a, has a unique solution. Proof: By the lemma, if we take J small enough, T will map Co (J) into Co (J) . But by the same argument as in the proof of the global theorem, we will have the contractive estimate d(Tx , Ty) < pd( x , y) for some p < 1 and for x and y in Co ( J) , if J is small enough. This is because that argument only involved using the Lipschitz condition for G(s, x(s)) - G(s, y(s) ), and the condition that x and y be in Co (J) says exactly that the Lipschitz condition applies. Thus once again the Contractive Mapping Principle yields the existence and uniqueness of solutions to the integral equation and, hence, to the Cauchy problem. QED 478 Chapter 11 Ordinary Differential Equations Corollary 11.1.2 Let G{t, z) be a Cl function defined for t in I and for x in some open set D in Rn , taking values in Rn . Then the Cauchy problem x'{t) = G{t, x{t)), x{to) = a for to in I and a in D has a unique solution on some subinterval J containing to. Proof: By taking N small enough we can make the ball B = {Ix -al < N} lie in D since D is open. We then can apply the theorem to this ball and a subinterval J, provided we verify IG{t, x) - G{t, y)l < Mix - yl for x and y in B. But this follows from the hypothesis that G is Cl by considering the restriction of G to the line segment joining x and y. We can parameterize this segment by x + s{y -x) for 0 < 8 < 1. Then for fixed t,x, and y, g{s) = G{t,x + s(y - x)) is a Cl function (for x and y in the ball B the line segment stays inside B because the ball is convex, as shown in Figure 11. 1.4). x� • a Figure 11.1.4: y Also g'{s) = ��=l (Yk - xk)8G/8xk{t, x + s{y - x)) by the chain rule. We have G(t, 1/) - G(t, z) = g(l) - g(O) = l g'(s) dB by the fundamental theorem of the calculus, so IG(t,l/) - G(t, zli < l lgl(8)1 ds by Minkowski's inequality. But n Ig'(8)1 = E{Yk - xk)8G/8xk{t,x + s{y - x)) , k=l 11. 1 Existence and Uniqueness 479 and this can be dominated by Mix - yl where M depends only on the maximum of IBG/Bxk l on J x B. (This is finite because B and J are compact and G is C1 .) The most efficient way to do this is to apply the Cauchy-Schwartz inequality in }Rn to obtain n BG E(Yk - Xk ) Bx (t, x + s(y - x)) k=l k ( n ) 1/2 ( n ) 1/2 < E(Yk - Xk )2 E :� (t, x + sty - x))2 ( n ) 1/2 = Ix - y l E :� (t, x + s(y - x))2 k=l k One could also use the triangle inequality and IXk - Yk l < Ix - YI to obtain n BG E(Yk - Xk ) Bx (t, x + s(y - x)) k=l k n BG < E IYk - xk l a(t, x + s(y - x)) k=l Xk n BG < Ix- YI E a(t, x + s(y - x)) . k=l Xk Either approach yields the desired Lipschitz condition with slightly different M. (One could also use the mean value theorem in place of the fundamental theorem of the calculus.) Thus the theorem applies. QED It is natural to ask how big the interval J, on which we have ex­ istence and uniqueness, can be taken. In particular, why can't we use the idea of piecing together local solutions as we did in the proof of the global existence and uniqueness theorem? The answer is that of course we can use the idea, although it will not take us quite as far. The u­ niqueness of the solution-if it exists-is a global fact. If two solutions x(t) and y(t) exist on any subinterval 10 of 1 and x(to) = y(to ) for to in 10 then they must be equal on 10 . The same argument as in the global theorem works-just apply the local uniqueness at the points where the two solutions stop being equal. 480 Chapter 11 Ordinary Differential Equations Regarding the existence of the solution on larger intervals, the best we can say is that the solution exists until it becomes unbounded, or leaves the domain of the function G. To treat the simplest case, let us assume that G is defined and C1 for all t in R and all x in Rn . Starting with the initial condition z ( to) = a, we have the existence of the solu­ tion on an interval J. Then, by starting at points near the endpoints of J we can extend the solution. Let 1 denote the largest interval on which the solution exists. By the local existence and uniqueness this must be an open interval. If it is not the whole line, then what is the behavior of the solution as we approach an endpoint of 11 We claim that the solution must become unbounded. The reason for this is a bit subtle. Suppose to the contrary that x ( t) remained bounded, say Iz(t) 1 < N, as t � c from below, where c is the upper endpoint of I. Then the function G( t, x) is bounded and satisfies a Lipschitz condition under the restrictions to < t < C+E and Ixl < 2N. Now an examination of the proof of the local existence and uniqueness theorem shows that starting with Cauchy data in the region to < t < c and Ix I < N, the solution will exist over an interval of fixed length 0, where 0 depends only on the bounds for G and the Lipschitz constant over the larger region to < t < C + E, Ixl < 2N. 2N ------- N 1--------, c c+£ Figure 11. 1.5: Therefore, if we start at the point t = c - 0/2 we will be able to extend the solution past c, contrary to the assumption that the solution could not be extended past c. Of course, if z(t) becomes unbounded as t -+ c, then the interval of existence gets smaller and smaller as t -+ c (because the bounds on G get larger and larger), and there is no contradiction. This argument shows that functions like sin l/x with 11.1 Existence and Uniqueness 481 oscillating discontinuities cannot be solutions to the kind of o.d.e. 's we are considering. 11.1. 5 Higher Order Equations* Finally, we turn to the case of higher order equations, x(m)(t) = G(t, x(t), ... , x(m-l)(t)), where G is a continuous function defined on an open set in 1R1+mn taking values in 1Rn . We will assume that either G satisfies a global Lipschitz condition IG(t, y) - G(t, z)1 < Mly - zl for all t in I and all y and z in 1Rnm or that G satisfies a local Lipschitz condition IG(t, y) - G(t, z)1 < Mly - zl for all t in I and all y and z in some ball B in 1Rnm . In the first case we have global existence and uniqueness and in the second case local existence and uniqueness for the Cauchy problem x(m) (t) = G(t, x(t), ... , x(m-l) {t)), x(to) = a(O), . .. , x(m-l)(to) = a(m-l) (with the Cauchy data a(O), .. . ,a(m-l) in the ball B in the second case}. This can be proved by reducing to the first-order case as indicated before, but it can also be proved directly. The idea is that we now want to integrate m times to obtain an equivalent integral equation. To see what this should look like let's consider the case m = 2. Then integrating x\"{t) = G(t, x(t), x'{t)) once yields or x'(t} - x'(to} = f' x\"(s} ds = ft G(s, x(s}, x'{s)) ds wi to wi to x'(t) = a(1) + ft G(s, x{s), x'{s)} ds. wi to Integrating again we obtain x(t) = a(O) + (t - to}a(l) + ft fT G(s, x(s}, x'{s}} ds dr. Jto Jto 482 Chapter 11 Ordinary Differential Equations We can simplify the iterated integral by interchanging the order (we will give a proof that this is valid in Chapter 15), it iT G(s, x(s), x'(s)) ds dr = it it G(s, x(s), x'(s)) dr ds to to to s - it (t - s)G(s, x(s), x'(s))ds. to Thus the integral equation for m = 2 is x(t) = a(O) + (t - to)a(l) + it (t - s)G(s, x(s), x'(s)) ds, to and it is easy to verify directly that any solution of the integral equation is a solution to the Cauchy problem. By induction, it follows that the Cauchy problem in general is equivalent to the integral equation m-l . \" (t - toP (j) x(t) = � ., a . 0 J. 1= it (t - s)m-l (m 1) + to (m _ I) ! G(s, x(s), ... , x - (s))ds. We leave the details as an exercise. Notice that the integral equation also involves derivatives-up to order m - I-but there is still a gain of one derivative: assuming that x(t) is em-1 and satisfies the integral equation we obtain that x(t) is em by the fundamental theorem of the calculus applied m times to the right side of the equation. To solve the integral equation by the Picard iteration method we choose an initial approximation xo(t) and define inductively m-1 . Xk(t) = L (t - .:0)1 a(j) . 0 J. 1= it (t - s)m-l (m- i) + to (m - I)! G(s, Xk-1(S), ... , Xk-1 (s)) ds. Again we prove the sequence {Xk} converges to a solution of the integral equation on a sufficiently small interval by appealing to the Contrac­ tive Mapping Principle. This time we have to take the metric space e(m-l)(J) with metric d(x, y) = suP . max Ix(j)(t) - y(j)(t)1 J 1=O, ... ,m-l 11.1 Existence and Uniqueness 483 (or a ball in c(m-l)(J) in the local case). Of course, it is necessary to show that this is a complete metric space and that the Lipschitz condition on G implies that the mapping Tx(t) = m-1 . '\" (t - to)1 (j ) L....J '1 a j=O J. it (t )m-l - S (m 1) + ( _ ) 1 G ( s, x ( s ) , ... , x - ( s )) ds. to mI . is a contraction on that metric space. The details are not too much different than before, so we leave them for the exercises. It is interesting to observe that the Picard iterations described above are somewhat different from the iterations obtained if you first reduce the equation to first order. Of course either method produces approximations that converge to the same solution. 11.1.6 Exercises 1. Put the following o.d.e's into normal form by solving for the high­ est order derivatives: a. x'(t)x(t) + sin x(t) = 27. b { x'(t)y(t) + t2Y'(t) = 0, . x(t)y'(t) + x(t)2 = t4. c. exp (x\") - x'(t)2 = t2. 2. Reduce the following o.d.e. 's to first-order systems by introducing new variables: a. x\"(t) = t2x'(t) + sin t. b. x\"'(t) = x\"(t)x'(t) + x(t). { x\"(t) = sin y'(t) + x(t)y(t), C. y\"(t) = y'(t)2 + x'(t)2. 3. Verify that x(t) is a solution of the mth order o.d.e. x(m) (t) = G(t, x(t), . .. , x(m-l)(t)) if and only if (xo, . . . , Xm-l) = 484 Chapter 11 Ordinary Differential Equations (x, X', ... ,X(m-i)) is a solution of the first-order system X�_i {t) = G{t, xo{t), ... ,Xm-i {t)), Xk (t) = x k+ d t) k = 0, 1, ... , m - 2. Also verify that x{t) satisfies the Cauchy initial conditions x(k){tO) = a(k) for k = 0, 1, ... ,m -l if and only if (xo, ... , Xm-l) satisfies the Cauchy initial conditions {xo{to), . .. , Xm-l (to)) = (a(O), .. . , a(m-i)). 4. Show that all solutions of x\"{t) = -x{t) are of the form x(t) = A cos t+ B sin t. Using this, decide for which values of ti and t2 the o.d.e. x\"{t) = -x{t) with boundary conditions X(tl) = aI, X(t2) = a2 has a unique solution on [ti' t2], for any choice of ai , a2. 5. Prove that a homogeneous linear o.d.e. x'(t) = A(t)x(t), where x{t) takes values in am and A(t) is a continuous m x m matrix valued function, has an m-dimensional vector space of solutions. 6. Write out Picard iterations explicitly as a perturbation series for the inhomogeneous linear o.d.e. x'(t) = A(t)x{t) + b(t) with Cauchy data x(to) = a choosing xo(t) = a+D-1b(t). What would happen with a different choice of Xo ( t)? 7. Prove that x(t) is a em solution to the o.d.e. x(m}(t) = G(t, x(t), ... , x(m-l) (t)) with Cauchy data x(j) {to) = aU), j = 0, 1, ... , m - 1, if and only if x{t) is a Cm-i solution of the integral-differential equation x{t) m-l . \" (t - to)J (j) L..J \" a . 0 J. J= it (t )m-l - S (m- l) + ( _ ) ' G{s, x{s), . .. , X (s)) ds. to m 1. 8. Compare the Picard iterations for the above integral-differential equation when m = 2 with the Picard iterations obtained by first reducing the system to first order. 11 .2 Other Methods 0/ Solution 485 9. The first-order o.d.e. with n = 1 is called separable if G( s, x) = 91 (S)92(X) for some functions 91 and 92. Assume they are C1 and 92 is never zero. The usual technique for solving a separable o.d.e. is to write formally dx/dt = 91(t)92(X) hence dx/92(X) = 91(t)dt, so J dx/92{X) = J 91 (t)dt + c. Justify this method by showing that for Gl{t) = It: 91(S) ds and h(x) = J: dY/92(Y), the solution to the o.d.e. with initial value x(to) = a is given by x(t) = h-1(Gl(t)). 11 .2 Other Methods of Solution* 11 .2.1 Difference Equation Approximation In this section we discuss two alternate approaches to obtaining so­ lutions of the Cauchy problem. The first, which is sometimes called Euler's method, involves obtaining approximations to the solution by replacing the differential equation by a difference equation. This is anal­ ogous to approximating a definite integral by a Cauchy sum. Euler's method actually yields a proof of existence under weaker condition­ s than Picard's method-we need only assume the function G in the o.d.e. is continuous. Of course we have seen that under such weak as­ sumptions the uniqueness of the solution is not assured. Quite frankly, I don't know of any applications in which existence without uniqueness is of any value, but I will present the proof anyway because it uses the Arzela-Ascoli theorem in a nice way. The real importance of Euler's method is that it forms the basis of efficient numerical algorithms for approximating solutions of o.d.e. 'so There are many improvements on Euler's method, essentially based on the idea of using an improvement on the Cauchy sum approximation to an integral, such as the trape­ zoidal rule or Simpson's rule. We will not discuss these here. The second method involves expansions into power series of both the solution and all the functions involved in the o.d.e. This method is evidently limited to o.d.e. 's for which power-series expansions are avail­ able but within this narrower class of equations gives a computational algorithm of some practical importance, and it yields some information that is not readily available through the other approaches. We will consider Euler's method in the case of a single first-order o.d.e. x'{t) = G(t, x(t)). Recall the interpretation of this equation as 486 Chapter 11 Ordinary Differential Equations saying that the graph of x(t) in the t-x plane has its slope prescribed by G (t, x) and so can be imagined as being pieced together out of in­ finitesmal line segments of slope G(t, x) through the point (t, x). Euler's method takes small, rather than infinitesmal, line segments and pieces them together to obtain an approximate solution. Let x(to ) = a be the given initial data, and suppose we want the solution on the interval [to , T] . We partition the interval as to < tl < ... < ('\" = T. On the first interval [to , tl] we take the affine linear function y(t) that satisfies the same initial condition y(to) = Yo and the condition y' (t) = G(to , Yo ) where we set Yo = a for consistency of notation. Yl Yo = a Figure 11.2.1: Clearly this determines y(t) on the interval [to, tl] to be y(t) = Yo + G(to , yo)(t - to ), as shown in Figure 11.2.1. We set YI = y(tl ) ' The function y( t) on the interval [to , tl] differs slightly from the solution x(t) of the o.d.e. x' (t) = G(t, x(t) ) because G(t, x(t) ) will in general be different from G(to, Yo ). But if the interval is small the difference will not be great (assuming G is continuous) , so we should have a good ap­ proximation. We then repeat the process on the interval [tl I t2] starting with the initial data y(tl ) = YI . We now require y' (t) = G(t1 1 YI) and so y(t) = YI +G (tl ,YI )(t-tl ). We continue by induction to define y(t) on each of the intervals [tk , tk+l] by y( t) = Yk + G( tk , Yk ) (t - tk) where Yk = y(tk) ' In this way we obtain a continuous piecewise affine function y(t) on the interval [to , T] where each affine piece of the graph of Y is a line segment of the prescribed slope at the left end, as illustrated in Figure 11 .2.2. Before we get into the question of whether (or how well) y(t) ap­ proximates the solution x (t), we should consider some alternate inter- 11.2 Other Methods of Solution 487 • • • • Figure 11.2.2: pretations of y( t). Since the graph of y( t) is a broken line, it clearly suffices to compute the values Yk = y(tk)-for then we can \"connect the dots\" to obtain the intermediate values. Notice that the equations y(t) = Yk +G(tk, Yk)(t - tk) for tin [tk, tk+l] evaluated at t = tk+l yield the relations Yk+l - Yk = G(tk, Yk)(tk+l - tk) or Yk+l - Yk = G(tk, Yk), tk+l - tk which is clearly a difference equation analog of the o.d.e. x'(t) = G(t, x). Thus Euler's method can be construed as solving the differential equa­ tion approximately by replacing it with a difference equation. Another interpretation of Euler's method derives from looking at the integral equation z(t) = Q + f. G(B, Z(B» dB and replacing the integral by a Cauchy sum. If we take t = tk+l and we partition the interval [to, tk+l] in the obvious way as to < tl < t2 < ... < tk+lt this becomes k Yk+l = Yo + EG(tj,:I:(tj»(tj+l - tj> j=O (evaluating G(s, x(s)) at the left endpoint s = tj). Of course we don't know x( tj) exactly, but we could approximate it by Yj; this yields k Yk+l = Yo + E G(tj, Yj )(tj+l - tj), ;=0 488 Chapter 11 Ordinary Differential Equations which is just another way of writing Euler's method. This interpre­ tation shows clearly that there are two sources of error, one from re­ placing the integral by a Cauchy sum, and one from evaluating G at (tj ,Yj) rather than (tj, x(tj)). Also there is the possibility that errors will compound, since the Yj are determined inductively and any error in one particular Yj gets passed on to all subsequent ones. Thus we can't simply conclude that Yk approximates X(tk) from the fact that the Cauchy sum approximates the integral. Nevertheless, it is possible to show that if G is C1 , then on a suf­ ficiently small interval [to , T] Euler's method does approximate the so­ lution. In fact if h denotes the maximum length of the subintervals [tk ' tk+l], then y(t) - x(t) = O(h); in other words, Iy(t) - x(t) 1 < ch for to < t < T where c is a constant depending only on the o.d.e. From a practical point of view, the 0 (h) error is not very good, and more sophisticated methods-based on better approximations to the integral-are preferred. To avoid technicalities we assume the partition intervals are of equal length h, so tk = to +kh, and that G and its first derivatives are globally bounded. Under this hypothesis the solution exists for all t and the Euler approximation is valid on any interval. Theorem 11.2.1 Let G be C1 function that is bounded together with its first derivatives. Then there exist constants Ml and M2 (depending on the bounds for G and dG) such that where x(t) is the exact solution and y(t) is the Euler approximation using step size h. Notice that if we extend the size of the interval on which we do the approximation, the constant eMilt-tol - 1 that multiplies h in our estimate grows exponentially. This is exactly what we should expect because the errors in the method may compound. Of course, if we fix any interval, we can choose h small enough to make the error estimate as small as we like on that interval. But it is only fair to point out that the smaller we take h, the more points we have to take in the partition and, hence, the more computations we have to perform. Also, any numerical implementation of this algorithm will involve round-off 11 .! Other Methods of Solution 489 error; and when a large number of calculations need to be performed, the round-oft' error has to be taken into account. Proof: For simplicity we only prove the error estimate at the parti­ tion point tie. Thus we need to show We will prove this by induction. Notice that for k = 0 we have Yo = x(to) = a as required. Thus we may assume that (*) holds, and we need to show the analogous estimate holds for k + 1. (In the course of the argument we will specify the constants Ml and M2.) Euler's method gives us YIe+l = !lie + G(tle' YIe)h, and the integral equa­ tion gives x(tle+d = x(tle) + ft:lc+1 G(s, x(s)) ds for the exact solution. Then YIe+l - X(tle+l) = Yle - x(tle) + G(tle, YIe)h - ft tlc+1 G(s, x(s)) ds and the first difference Yle - x(tle) is controlled by (*). In compar­ ing the integral ft:Ic+1 G(s,x(s)) ds with g(tle,YIe)h we are on slippery footing because the value Yle is not exactly x(tle). Therefore we will write G(tle, Yle)h - ft:Ic+1 G(s, x(s)) ds = [G(tle, YIe)h - G(tle, x(tle))h] + [G(tle, x(tle)}h - ft:Ic+1 G(s, x(s)) ds] and estimate each of the bracketed differences separately. The first is easy. Using the mean value theorem we have IG(tle, YIe)h - G(tle, x(tle)hl < M1hlYIe - x(tle)1 where Ml (this will be the constant Ml in ( *)) is an upper bound for the derivatives of G (actually just the x-derivatives, since the point tie is the same in both G(tle, YIe) and G(tle, x(tle))). Notice that this is just what the doctor ordered, because we have lYle - x(tle)1 on the right, which is controlled by (*). For the second difference, notice that we have the integral over an interval of length h of the function G( s, x( s)) being compared with the value of this function at the left endpoint s = tie multiplied by the length of the interval. If we call this function g(s) = G(s, x(s)), then 490 Chapter 11 Ordinary Differential Equations by the mean value theorem. Thus where M is a bound for g ' . But 8G 8G g'(s) = -8 (s, x(s)) + -8 ( s , x(s))x'(s) s x . by the chain rule and x'(s) = G(s , x(s)) by the o.d.e., so g' can be bounded in terms of the bounds for G and its derivatives. If we combine all three estimates we have altogether (triangle in­ equality) IYk+l - x(tk+dl < IYk - x(tk)1 + M1hlYk - x(tk) 1 + (1/2)Mh2. Then substituting ( *) , we have We now can specify that M2 = M /2M} . It then follows that IYk+l - x(tk+dl < M2h[(1 + Ml h)(eMlkh - 1) + Ml h] = M2h[(1 + Mlh)eMlkh - 1] < M2h(eMdk+1)h - 1) because 1 + Ml h < eAllh (remember the power series for exp). Thus we have the desired analog of ( *) for k + 1. QED 11 .2.2 Peano Existence Theorem We will now show how Euler's method can be used to establish the existence of solutions under the hypothesis that G is continuous. Since we don't yet know that solutions exist under such weak assumptions, we cannot refer to \"the solution\" x(t) -in fact we know by example (x' = (3/2)xl/3) that there may be more than one solution to the Cauchy problem. Nevertheless, the formulas defining Euler's method, for tk < t � tk+l, make sense without reference to any solution. We can use these to obtain a solution via the Arzela-Ascoli theorem. 11.2 Other Methods of Solution 491 Theorem 11.2.2 (Peano Existence Theorem) Let G(t, x) be a contin­uous real-valued function for t in some interval 1 containing to and x in some neighborhood of a. Then there exists an interval J containing to and a solution x(t) to the Cauchy problem x'(t) = G(t, x(t)) and x (to) = a on the interval J. The solution need not be unique. Proof: If the domain of G is not compact we can always make it so by shrinking it. Then let M be the sup of IGI over this compact domain, which is finite because G is continuous. We want to shrink the domain still further to a rectangle (t in J and Ix -al < r) in which the approximations y( t) and the solution will be trapped, as shown in Figure 11.2.3. slope +M i a � I I I slope -M ---J --- I Figure 11.2.3: The condition for trapping the solution is that Mit - tol < r for t in J, which can be achieved by making J small enough while holding r fixed (the constant M, which is the sup of IGI over a larger domain, will still be an upper bound for IGI over this smaller domain). The reason the condition Mit - tol < r for t in J traps the solution is that the derivative x'(t) is trapped between -M and +M, so any solution must lie between the lines through (to, a) with slope -M and +M. For simplicity we assume J is [to, T). Consider any partition to < tl < . . . < t N = T of this interval, and let's attempt to define induc­ tively the Euler method function y(t) = Yk + G(tk, Yk)(t - tk} for t in [tk' tk+l] where Yo = a and Yk = y(tk}. For this to make sense we need to verify that (tk' Yk) is in the domain of G; in fact we will 492 Chapter 11 Ordinary Differential Equations show IYk - al < r or more precisely Iy(t) - al < Mit - to l for t in J. We do this by induction. Since Yo = a, we have trivially Iyo - al < r and Iy(t) - al = IG(to, yo)(t - to) 1 < Mit - to l for t in [to, tl] ' Since we are assuming Mit - to l < r in J, we have IYl - al < r. Continuing by induction, assuming IYk - al < r and Iy(t) - al < Mit - to l for to < t < tk, we have Iy(t) - al IYk - a + G(tb Yk)(t - tk) 1 < IYk - al + IG(tb Yk)(t - tk) 1 < M(tk - to) + M(t - tk) = M(t - to) for tk < t < tk+l' Thus also IYk+l - a l < r since M(tk+l - to) < r by assumption. This completes the induction argument. N ow we want to vary the partition, letting the maximum length of the subintervals go to zero. Let y(1), y(2 ) , ... denote the sequence of functions obtained by the Euler method from the partitions. We would hope to obtain a solution as the limit of this sequence, but the nonuniqueness means the limit may not exist. Instead we must settle for something weaker, a limit of a subsequence. For this we invoke the Arzela-Ascoli theorem. Thus we need to verify the hypotheses of that theorem, that the sequence is uniformly bounded and uniformly equicontinous (they are obviously continuous functions defined on a compact domain) . The estimate Iy(t) - al < Mit - to l < r established above shows that the functions are uniformly bounded. The uniform equicontinuity is essentially a consequence of the fact that the func­ tions are piecewise affine with derivative G(tk' Yk) bounded by M. We claim that any function y( t) constructed by Euler's method will satisfy Iy(t) - y(s) 1 < Mit - sl for t and s in J-this just follows by summing the same estimate over all the subintervals connecting t and s, since Iy(t) - y(s) 1 = IG(tb Yk) (t - s) 1 < Mit - sl if t and s belong to the same subinterval [tb tk+l]' Since the constant M does not depend on the partition, we obtain the uniform equicontinuity. Thus the Arzela- Ascoli theorem applies and so there exists a uni­ formly convergent subsequence. For simplicity of notation let us also denote this subsequence Y( 1) , Y(2) , ... . Let x(t) = limj�oo Y(j) (t), the 11.! Other Methods 01 Solution 493 limit converging uniformly on J. To complete the proof we will show that x(t) satisfies the integral equation x(t) = a + lt G(s, x(s)) ds to for we have already seen that the integral equation is equivalent to the Cauchy problem. We will obtain the integral equation if we can show that y(j)(t) = a+ lt G(s,y(j)(s))ds+Rj(t) to where Rj(t) � 0 as j � 00, for .lim It G(s, y(j) (s)) ds = It G(s, x(s)) ds )-00 � � because the convergence of y(j) to x is uniform. The definition of y(j)(t) by Euler's method shows that yU}(t) - a is a certain Cauchy sum for the integral Jt� G(s, y(j)(s)) ds corresponding to the partition to < t�j) < ... < t�) < t of [to, t] and evaluation of G( s, y(j) (s)) at the left endpoint of each subinterval. Here to < t�j) < ... < t�) = T is the partition corresponding to yU) and t�) is the largest value for which y�) < t (thus k depends on t and j, but we have not burdened the notation with this dependence). This is just the equation y(j)(t�») + G(t�),y(j)(t�»))(t - t�») k-l a + L G(t¥), y(j)(t¥»))(t��l - t�») p=o + G(t�), y(j)(t�»))(t - t�»). Therefore the error Rj is just the difference between a Cauchy sum and an integral. Notice that both the partition and the function G(s, y(j)(s)) being integrated vary with j. Since the maximum interval lengths of the partitions are going to zero, we know that the Cauchy sums for any fixed continuous function 1 are converging to the integral of I. An examination of that proof, however, shows that the rate of con­ vergence depends only on the modulus of continuity, which is defined 494 Chapter 11 Ordinary Differential Equations to be w(6) = sup{ lf(s) - f(t)1 given that Is - tl < 6}. In the present case, the uniform equicontinuity of the functions y(j) implies that a single function w(6) dominates the modulus of continuity for all the in­ tegrands G ( 8, y(j) ( 8 )) so that the difference between Jt� G ( 8, y(j) ( s)) ds and a Cauchy sum is small for all j provided the partition is small. This implies Rj -+ 0 as j -+ 00 and so the integral equation holds. QED Although we have stated the theorem only for single equations, it is clear that the proof goes over almost without change to first-order systems and, hence, to systems of arbitrary order x(m) (t) = G(t, x(t), x'(t), . .. , x(m-l) (t)) for G continuous. 11 .2. 3 Power-Series Solutions We turn now to power-series methods. We will consider only linear o.d.e. 's of second order, because this special case includes many im­ portant examples. Making the assumption of linearity vastly simplifies the problem, although it is still true that the Cauchy problem for the general equation x(m) (t) = G(t, x(t), x'(t), .. . , x(m-l)(t)) has a power-series solution that converges in a small neighborhood of to provided the function G has a convergent multiple power series in a neighborhood of the Cauchy data. The proof of this, however, would take us too far afield. We should also point out that the result has a generalization to partial differential equations, the famous Cauchy­ Kovalevsky Theorem. The o.d.e. 's we consider are of the form x\"(t) = p(t)x'(t) + q(t)x(t) + r(t) where p, q, r are the analytic functions 00 p(t) = L Pk(t - to)k, k=O 11.2 Other Methods 0/ Solution 00 q(t) - L qk(t - to)k, k=O 00 r(t) = L rk(t - to)k k=O 495 with power series converging at least in It - tol < E. We wish to solve the Cauchy problem (x(to) = a, x'(to) = b) by an analytic function with power series x(t) = �k:O Ck(t - to)k, also convergent in It - tol < E. Notice then that the Cauchy initial data z(to) = a, z'{to) = b just means CO = a, Cl = b. Thus the problem can be restated: find an analytic solution of the o.d.e. z(t) = ��o Ck(t - to)k with CO and Cl specified. For simplicity of notation we will set to = O. We proceed backward, assuming the solution exists. What does the o.d.e. say about the coefficients Ck? Inside the radius of convergence we can perform all the operationS called for in the o.d.e. by operating formally on the power series. We obtain 00 Zll(t) = L k(k - 1)Cktk-2 k=2 00 - L(k + l)(k + 2)Ck+2tk k=O and also (by making a change of variable in the k summations) p{t)x'(t) + q(t)x{t) + r(t) - (fp;t;) (f(k + l)Ck+ltk) 1=0 k=O + (tu q;� ) (tu Cktk) + tu rktk - f: (tp;(k - j + l)Ck-Hl) tic k=0 j=O + f (t fl;Ck-;) tk + f rktk k=O 1=0 k=O 496 Chapter 11 Ordinary Differential Equations All these power series will be convergent in It I < c. By the uniqueness of power-series expansions we can equate the coefficients of x\" (t) and p( t)x' (t) + q( t )x( t) + r( t) . This leads to a system of algebraic equations for k = 0,1 ,2 , . . .. Notice that the right side of the equation contains Co, ... ,Ck+l but no other coefficients and that the left side is just Ck+2 multiplied by a positive constant . Thus, given values for Co and Cl, these algebraic equations have a unique solution; in fact they are inho­ mogeneous linear equations in triangular form. It is the simplicity of the solution of these equations that makes the use of power series so appealing here. So far we have seen that if the problem has a power-series solution, then we have the recursion formulas ( *) to find the coefficients. The next question is can we reverse the process? That is, we start by solving the equations ( *) to obtain the formal power series L:r=o cktk. If we can show that this power series converges in It I < c, we will be done, for then ( *) will show that the power series satisfies the o.d.e. However, this seems a formidable task, since the coefficients Ck are only given indirectly as solutions of ( *) and because in order to show that the power series converges we will need some estimates for the size of ICkl . While it is possible to derive such estimates directly from the equations ( *) , there is a simpler indirect approach known as Cauchy 's method of majorants. The idea of this method is to show there exists a majorant series L:�o dktk, with Ickl < dk (so the dk are all positive) and yet L:�o dktk converges in It I < c. This implies the convergence of L:�o Cktk by the comparison test. In order to produce the majorant series we will systematically increase all the coefficients of the power series of p, q, r. Because of the form of ( *) , it is easy to show this produces a majorant series. Finally, we will obtain the convergence of the majorant series not by estimating its coefficients but because we will be able to write down the function L:�o dktk explicitly-it will be 11 . 2 Other Methods of Solution 497 the solution of an o.d.e. that can be solved by inspection. This is the trick that saves us the tedious work of estimating coefficients. We begin by proving the Majorant lemma: Lemma 11.2.1 (Majorant lemma) Suppose 00 00 00 P(t) = L Pktk , Q(t) = L Qktk, and R(t) = L Rktk k=O k=O k=O are majorants of p(t) = ��o Pktk, q(t) = ��o qktk, and r(t) ��o rktk respectively, meaning IPk l < Pkl lqk l < Qk, and Irk l < Rk . Suppose CO and Cl are given and ��o Cktk is defined by the equation (*) (k+l )(k+2)Ck+2 = (t Pj (k - j + l)Ck-j+l + qjCk-j) +rkl )=0 and similarly suppose do and d1 are given and ��o dktk is defined by the analogous equation (**) (k+1) (k+2)dk+2 = (� pj (k - j + l)dk-HI + Qj dk-j) +Rk . Finally assume lcol < do and ICl I < dl . Then � dktk is a majorant for � Cktk, meaning ICkl < dk for every k. Proof: Notice that this is a purely algebraic fact-we assume noth­ ing and conclude nothing about the convergence of any of the formal power series. The proof is by induction and is almost completely triv­ ial. We are assuming Icol < do and ICl l < dl, so let us assume we know ICj I < dj for 0 < j < k + 1 and then prove ICk+2 1 < dk+2' But from ( *) and the triangle inequality (k + l)(k + 2) lck+2 1 < (� IPj l (k - j + 1) lck-HI I + 1 % IICk-j l) + Irkl since the coefficients (k - j + 1) are all positive. Substituting the majorants for Pj , Qj, r k and the assumed estimates I Cj I < dj for 0 < j < k + 1 we obtain (k + l)(k + 2) 1ck+2 I < (� pj(k - j + 1)dk-HI + Qjdk-j) + Rk 498 Chapter 11 Ordinary Differential Equations and the right side is just (k + l)(k + 2)dk+2• QED Theorem 11.2.3 Let the power series for p, q, r converge in It I < E. Then the power series x(t) = L:�o Cktk, where Ck are given by ( *) and CO and Cl are arbitrarily chosen, also converges in It I < E to a solution of the Cauchy problem x\"(t) = p(t)x'(t) + q(t)x(t) + r(t), x(O) = CO , x'(O) = Cl. Proof: In order to put the lemma to work we have to make a clever choice of the majorants P, Q, R. Fix a value 6 < E. From the conver­ gence of L:�o Pktk in It I < 8 we know that IPk I < M 8-k for some M and all k (recall that this followed from the boundedness of Pktk for t = 8). Thus the choice Pk = M 8-k would seem natural. Notice then that 00 00 P(t) L Pktk = L M8-ktk k=O k=O M(l _ 8-1t) -1 = M 6 = Ml 8 - t 8-t is an elementary function and its power series converges in It I < 8. We might similarly be tempted to try Q( t) = M2/ (8 - t) and R( t) = M3/(8 - t) for suitable constants M2 and M3, but this choice leads to the o.d.e. x\"(t) = P(t)x'(t) + Q(t)x(t) + R(t), which can't be solved by inspection. However, a slight modification of the choice of Q and R will lead to a linear o.d.e. of homogeneous type \"( ) Ml ,( ) M2 ( ) M3 x t = 8 _ tX t + (8 _ t)2x t + (8 _ t)3' which can easily be solved. This means we want to choose Since M2 Q(t) = (8 _ t)2 and M3 R(t) = (8 - t)3 . 11.2 Other Methods of Solution and R(t) 00 - L 8-3 M3 (k + 2)(k + 1)8-ktk, k=O 499 we can always choose M2 and M3 large enough to make these majo­ rants of q( t) and r( t )-the point being that the factors (k + 1) and (k + 2) (k + 1) do not spoil the estimates. Choosing do = lco I and dl = ICI I, we can apply the lemma to conclude ICk I < dk where L dktk is the power series for the solution to \"( ) MI ,( ) M2 ( M3 X t = 8 _ t X t + (8 - t)2 x t) + (8 - t)3 x(O) = lcol, x'(O) = ICI I. But this o.d.e. has solutions of the form a(8 - t)..\\l + b(8 - t)..\\2 + c(8 - t)-l. Indeed by substituting this in to the o.d.e. and doing the routine calcu­ lations (see exercises) we find that .\\ 1 and .\\2 must satisfy the quadratic equation A(A -l) = MI A +M2 and C must satisfy 2c = MIC+M2C+M3. Thus we have determined a unique value of C (if Ml + M2 = 2 we can increase M 1 to avoid this problem) , and the quadratic equation for A has two distinct real roots Thus by adjusting the two constants a and b we can meet the initial conditions x(O) = lcol, x'(O) = ICl l (this requires only the distinctness of the two roots Al and A2 ). The solution a(8 - t)..\\l + b(8 - t)..\\2 + c(8 - t)-l is an analytic function with a power series about t = 0 convergent in It I < 8; the explicit power series is given by the binomial theorem (see exercise 4 of section 7.4). But this power series must be the same as L dktk because the coefficients must satisfy (**) of the majorant 500 Chapter 11 Ordinary Differential Equations lemma. Thus E dktk converges in It I < 6 and so E Cktk converges in It I < 8 by the majorant lemma. Since we could take any 8 < c, it follows that L Cktk converges in It I < E as desired. QED Of course one could also compute dk explicitly (first computing M 1 , M 2, M 3, \"x 1 , \"x2, a, b, C) from the binomal theorem and then prove by induction ICk l < dk directly from (*), thereby replacing the above indirect argument by a mass of incomprehensible computation. For many applications it is necessary to extend this technique to the case when the functions p(t), q{t), r{t) do not have power-series expansions about the point to but rather have singularities of specified nature (for example, Bessel's o.d.e. t2x\"{t) + tx'{t) + (t2 - \"x2)x{t) = 0, where \"x is a fixed constant, becomes xl/(t) = t 1 x'(t) + (�; - 1) x(t), so p{ t) and q( t) have singularities at t = 0). This is the theory of regular singular points. 11 .2.4 Exercises 1. Solve the Cauchy problem x' (t) = x (t)2 , X (to) = a by power series. What is the radius of convergence of the solution? 2. Write out the explicit recursion formulas for Euler's method for appoximating solutions of the Cauchy problem x\"(t) = G{t, x(t), x'{t)), x(to) = a, x'{to) = b, for a second-order o.d.e. by reducing to a first-order system. 3. Prove that the first-order linear o.d.e. x'(t) = p(t)x(t) + q{t) with initial condition x{to} = a is solved in closed form by x(t} = au(t) + ft u{t)q{s) ds Jto u{s) where u{t) = exp(Jt� p(s) ds). (Hint: show first u'{t) = p(t)u(t).) 11.3 Vector Fields and Flows 501 4. Substitute x(t) = a(6 - t)..\\l + b(6 - t)..\\2 + c(6 - t)-l into the o.d.e. \"( ) Ml ,( ) M2 ( ) M3 x t= 6 _ t xt+ (6 _ t)2 xt + (6 _ t)3 and derive the conditions on a, b, c that are necessary and sufficient for this to be a solution. Then show (with Ml + M2 - 2 =F 0) that any initial conditions x(O) = do and x'(O) = dl can be met by the appropriate choice of a and b. 5. Write out a proof that the first-order linear o.d.e. in problem 3 can also be solved by power-series methods if p(t) = E�O Pk(t - to)k and q(t) = E�o qk(t - to) converge in It - tol < c. 6. Show that if G is C1 , then there exists an interval [to, T] and constants M}, M2 such that Iy(t) - x(t) 1 < M2(eMlit-tol - l)h on [to, T] where y is the Euler approximation to the exact solution x with stepsize h. 7. Show that 00 (-l)i (t/2)k+2i Jk(t) = E \"(k + ')' . 0 J. J . J = has infinite radius of convergence and satisfies Bessel's differential equation x\"(t) + (l/t)x'(t) + (1 - k2/t2)x(t) = O. 11 .3 Vector Fields and Flows· 11.3.1 Integral Curves We want to consider now some elegant applications of the existence and uniqueness theorem for o.d.e. 'so We want to discuss the notion of vector field, which intuitively is the assignment of an arrow to every point in space. More precisely, a continuous vector field on an open domain D in an is defined to be a continuous function F : D -+ an , but we want to think of the value F(x) as giving a vector sitting at the point x (pictorially, the arrow joining x to x + F(x), as in Figure 11.3. 1). 502 Chapter 11 Ordinary Differential Equations F(x) - x Figure 11.3. 1: Of course we cannot draw in too many of the arrows at once or they will criss-cross unintelligibly, but we can certainly imagine the vector field as a well-groomed head of hair on a flat-headed person. You can also think of a weather map showing wind velocities. A common way to get a vector field is to take the gradient of a scalar function, f : D -? R where f is assumed cl, so F = V f. This is called a gradient vector field. Not all vector fields are of this form, however (see exercises). We want to think of the vector field as giving directional instruc­ tions: when at x, move with velocity F(x}. If we obey the instructions we will trace out an integral curve of the vector field, which is defined to be a C1 curve x : [a, b] -? IF such that x'(t} = F(x(t}} for all t in [a, b]. If we think of x'(t) as the tangent vector to the curve, then we are saying that the curve has tangent vectors prescribed by the vector field. (W aming: This is slightly different from, although related to, our interpretation of the o.d.e. x'(t) = G(t, x(t)) as prescribing the slope of the graph of the solution.) It is clear that the equation for an integral curve is just a first-order o.d.e. that is already in normal form, so we are ready to apply the existence and uniqueness theorem. We will assume that the vector field F is C1 so that the local theorem can be applied. The o.d.e. for the integral curve is sometimes called an autonomous o.d.e. because it does not depend on t (thought of as time). Theorem 11.3.1 Let F : D -? Rfl with D an open subset of Rn be a C1 vector field. Then through every point y of D there passes a unique integral curve x (t) with x (O) = y. Furthermore x (t) has a natural max­ imal domain of definition I, an interval of R, such that as t approaches a finite endpoint of I (if I is not all of R) the curve x (t) either becomes unbounded or leaves the domain D. Two different integral curves either 11.3 Vector Fields and Flows 503 coincide as subsets of �n (x(l)(t) = x(2)(t + s) for some fixed s) or are disjoint. Proof: The existence and uniqueness of x (t) follow from the local existence and uniqueness of x' (t) = F(x(t)) with x(O) = y. As we observed following the proof of that theorem, the solution can be con­ tinued beyond t = a if limt-+a x(t) exists and is in D. Thus the integral curves cannot simply disappear but must move out of D or toward infinity if they don't exist for all t. The fact that two integral curves must either coincide or be disjoint follows from the fact that the o.d.e. is autonomous. If x(t) satisfies the o.d.e., then so does x(t+s) for any fixed s, for x' (t +s) = dx/dt(t+s) = F(x(t+s)). Now suppose x(l)(t) and x(2)(t) are two integral curves and x(l)(td = x(2)(t2) for some values tl and t2 ' Then x(3) (t) = x(1) (t + s) for s = tl - t2 satisfies the o.d.e. and x(3) (t2) = x( l)(td = x(2) (t2 )' By the uniqueness for the Cauchy problem at t2 we must have x(3) (t) x(2)(t) and, hence, x( l)(t + s) = x(2)(t) for all t. QED Notice that the integral curves are actually C2 ; one derivative exists via the o.d.e. and x\" (t) = dF( x( t) )x' (t) by the chain rule, which is continuous because F is assumed C1 . You should imagine a picture of the domain D filled with disjoint smooth integral curves, such as the example shown in Figure 11.3.2. Incidentally, nothing prevents the curves from being closed. We can have X(tl ) = x(O) for some tl , in which case the curve repeats periodically with period tl , x(t+ td = x(t) for all t, again by the uniqueness. The curves may in fact consist of a single point , x(t) - y if F(y) = O. Next, we observe that we can follow the integral curves to obtain a flow. We think of t as a time parameter, and we move the point x(O) to x(t) in time t. Putting all the integral curves together we define the flow ft by ft (y) = x (t) where x is the unique integral curve such that x(O) = y. The flow is possibly only locally defined, as x(t) may not exist for all values of t; but for each fixed y it is defined for some interval of time containing zero. The flow has a local group property, ft (fs (Y)) = ft+s (y) , whenever both sides are defined. The reason is again the uniqueness. If we let z = fs (y) and start the flow at z, say x(l)(t) is the integral curve with x(1) (O) = z, then x(t + s) = x(1) (t) because this is true for t = 0 and so fs+t (Y) = ft (z) = ft (fs(Y)). 504 Chapter 11 Ordinary Differential Equations Figure 11.3.2: Conversely, from the flow we can recover the vector field, F(y) = (8/at)/t(y) lt=o. This is an immediate consequence of the definition, for if x(t) is the integral curve with x(O) = y, then (8/8t)/t(Y) = x'(t) = F(x(t)), so (8/at)/t(y)lt=o = F(x(O)) = F(y). In fact we have actually shown (8/8t)/t{Y) = F{/t{Y)) for any value of t since x{t) = It (Y). Even if we don't start with a vector field but are simply given a Bow, a function It (x) defined for x in D and t in some neighbor­ hood of 0 (depending on x) with It (x) also in D, satisfying the local group law It (Is (x)) = It+s (x) whenever both sides are defined, then we can define a vector field F by the equation F(x) = {8/8t)/t (x)lt=o (we must assume that h{x) is differentiable in t, of course). We can again show that (8/at)/t(x) = F(lt(x)), this time by appealing to the local group law: F(lt{x)) = {8/8s)ls(lt(x)) ls=o by definition and (8/8s)ls(lt(x))ls=o = (8/8s)ls+t(x) ls=o = (8/8t)/t (x). From this it follows that It (x) for any fixed x is an integral curve for the vector field F. In this way we can establish a one-to-one correspondence between vector fields and Bows. We will refrain from stating this as a formal theorem because the comparison of smoothness properties of the vector field and the Bow requires some more careful work. 11.3 Vector Fields and Flows 505 11. 3.2 Hamiltonian Mechanics We can describe classical mechanics in Hamiltonian form using vector fields and Bows. Following the standard physicist's conventions, we let q = (ql, ... , qn) denote a variable in a domain D in Rn called position or configuration space and let P = (PI , ... , Pn) denote a variable in a domain in Rn (usually all of Rn ) called momentum space. The domain D x Rn in R2n of all q, p variables is called phase space. Usually the position variables q are determined by the location of certain masses in space, and Pi is the coordinate of the momentum associated with the mass located at %. For k particles in three-dimensional space we take n = 3k. Now we assume we are given a real-valued function on phase space H(q, p) called the Hamiltonian. This function is interpreted as giving the energy of the system when the positions and momenta are given by q, p. The Hamiltonian is determined by the physics of the system under study. We are making the special assumption that the Hamiltonian is time-independent. That means that any external influences on the system cannot vary with time. Each point in phase space represents a possible description of the system at a moment of time. The basic idea of Hamiltonian mechanics (which is, of course, equivalent to Newtonian mechanics) is that the system is completely determined by a point in phase space and that the future evolution of the system is also determined; in fact there i� a Hamiltonian vector field determined by H, and the flow associated with this vector field, called the Hamiltonian flow, gives the evolution of the system. If the system is at the point x in phase space at time to, then it will be at the point Jt (x) in phase space at time to + t. The Hamiltonian vector field is given by 8H(q, p) 8p 8H(q, p) 8q so the o.d.e. for the integal curves x(t) = (q(t), p(t)) is dqj(t) 8H dt = 8pj (q, (t), p( t)), dpj (t) = _ 8H ( () ()) d 8 q t ,p t . t qj Note that this is really an o.d.e. because the partial derivatives that appear are taken of a known function H; the unknown functions are 506 Chapter 11 Ordinary Differential Equations q(t) and p(t). This o.d.e. system is known as the Hamilton-Jacobi e­ quation.t-they play an important role in the modern theory of partial differential equations and in mechanics. Clearly our existence and u­ niqueness theorem applies if we assume H is C2• Conservation of energy is an immediate consequence of the Hamilton­ Jacobi equations. Since H(q(t),p(t)) is the energy of the system at time t, we need to show (d/dt)H(q(t) ,p(t)) = 0 to conclude that the energy remains the same. But by the chain rule d n 8H dp ·(t) n 8H dq · dtH(q(t), p(t)) = L a-:- (q(t), p(t)) �t + L a (q(t), p(t)) d: (t) and J=l Pl j=l % 8H dpj (t) 8H d% 8pj (q(t), p(t)) dt = - 8qj (q(t), p(t)) Tt by the Hamilton-Jacobi equations. It is usually possible to deduce the existence of solutions for all time from the conservation of energy and some special features of H that prevent the solution from becoming unbounded in a finite time with H constant. A typical example of a Hamiltonian system is a single particle of mass m moving under the influence of a force vector field F(q) that is assumed to be a gradient vector field, F(q) = -VV(q) where V(q) is called the potential energy. The configuration space is all of R3 , and the phase space is R6 . The Hamiltonian for this system is H(q, p) = (1/2m) 1P12 + V(q), interpreted as a sum of kinetic and potential energy. The Hamilton-Jacobi equations are dqj (t) pj (t) dt m dpj (t) _ 8 8V (q(t)) = Fj (q(t)). dt qj The first set of equations defines the momentum pj (t) = m(dqj(t)/dt) as mass times velocity, and the second set of equations can then be interpreted as Newton's F = ma law. 11 .3.3 First-Order Linear P.D.E.'s As a final application of the existence and uniqueness theorem for o.d.e. 's, we show how to obtain all solutions to a first-order linear par­ tial differential equation 2:j=l pj (x)8f /8xj (x) = q(x )f(x) +r(x) where 11.:3 Vector Fields and Flows 507 Pj, q, r are given real-valued continuous functions on an open domain D in lRn and 1 is the unknown function. (N 0 such simple method works for higher order equations.) Let us consider first the case q - 0 and r _ O. Think of P = (PI , ... ,Pn) as a vector field on D. Then 2:/J=o Pj (x)81 j8xj (x) says that 1 has directional derivative equal to zero along the vector field and so should be constant along the integral curves. Indeed if x (t) is an integral curve for the vector field p( t), then d dt I(x(t)) so 1 being constant along the integral curves is necessary and sufficient for 1 to be a solution of �j=l pj (x)81 j8xj (x) = O. Here we must assume P is Cl in order to have the domain D covered by integral curves. If we want to consider the more general equation n al L Pj (X) ax . (x) = q(x)/(x)+r(x) j=1 J we can use the same computation to reduce the problem to a first-order linear o.d.e. along the integral curves as d dt l(x(t)) = q(x(t))/(x(t))+r(x(t)). A function 1 is a solution of the p.d.e. ( *) if and only if for each integral curve the restriction I(x(t)) is a solution of the o.d.e. ( **) . Of course the o.d.e. ( **) is linear and so can be solved in closed form (see exercise 3 of section 11.2). However the o.d.e. for the integral curves x(t) is in general non-linear and rarely can we give an explicit formula for x(t) . 11 .3.4 Exercises 1. Prove that a C1 vector field F that is a gradient vector field must satisfy the curl F = 0 equations 8Fj j aXk - aFkj aXj = 0 for all j # k. 508 Chapter 11 Ordinary Differential Equations 2. Prove that if F is a C1 vector field on ]Rn satisfying curl F = 0, then F is a gradient vector field (Hint: integrate components of F along lines parallel to the axes.) 3. Let F = grad f} where f} is the angular polar coordinate in ]R2 . Write out an explicit formula for F in terms of rectilinear coordi­ nates. Show that F is single-valued (even though f} is not) and C1 in ]R2 \\ {o} . Show that curl F = 0 but F is not a gradient vector field. 4. Suppose F = V'V is a gradient vector field and x (t) an integral curve. Show that V(x (t) ) is an increasing function of t. 5. Describe explicitly the integral curves and the flow for the vector field ( -y ) . 2 F ( x, y) = x In ]R • 6. The n-body problem is described by the Hamiltonian where q(k) = (qik) , q�k), q�k) ) denotes the position, p(k) = (pik) ,p�k) ,p�k) ) denotes the momentum of a particle of mass mk, and G is the universal gravitational constant . Show that the Hamilton-Jacobi equations reduce to Newton's F = ma law and the universal law of gravitation. Show that the total momentum L:�=l p(k) and total angular momentum L:�=l q(k) x p(k) (here x is the vector cross product in ]R3 ) are conserved-that is, constant on integral curves. 7. Find all solutions to the p.d.e. -y(8!18x) (x, y)+x (8!18y) (x, y) = !(x, y) in the quadrant x > 0, y > O. 11.4 Summary 509 11. 4 Summary 11.1 Existence and Uniqueness Definition An ordinary differential equation (or system of equations), abbreviated o. d.e., of order m is an equation F(t, x(t), x'(t), ... , x(m) (t)) = 0 where F is a given function defined on an open subset of R1+n(m+l) taking values in ak and the unknown function x (t) is defined on an interval 1 of a taking values in an . We say x(t) is a solution of the o. d. e. if the equation holds for every t in 1. Example The o.d.e. x'(t) + X(t)2 = 0 has solutions x(t) = l/(t - to) on any interval not containing to. Theorem Every o. d. e. of order m may be reduced to an equivalent o. d. e. of order one by introducing new variables equal to the derivatives of x of orders < m - 1. Definition An o.d.e. of order m is said to be in normal form if it is written x(m) (t) = G(t, x(t), ... , x(m-l) (t)) where Gis a function defined on an open set in R1+nm taking values in Rn . Example The o. d.e. x'(t) = (3/2)x(t)1/3 has the solution _ { t3/2 if t > 0, x ( t) - 0 if t < 0 as well as x(t) = 0, both with x(O) = 0, despite the fact that G(x) = (3/2)x1/3 is continuous. Definition For an o. d. e. of order m in normal form, the conditions x(to) = a(O) ,x'(to) = a(1), ... ,x(m-l) (to) = a(m-l) , where each aU) is a vector in Rn , are called the Cauchy initial value conditions, the vectors aU) are called the Cauchy data, and the problem of solving the o.d.e. subject to the Cauchy initial value conditions on an interval containing to is called the Cauchy problem. 510 Chapter 11 Ordinary Differential Equations Lemma 11.1.1 A Cl function x(t) solving the Cauchy problem x'(t) = G(t, x(t) ), x(to) = a, also solves the integral equation x(t) = a + It: G(s, x( s)) ds. Conversely, any continuous solution of the integral equation solves the Cauchy problem. Theorem (Minkowski 's Inequality) If f : [a, b] -t lRn is continuous, then I I: f(t)dtl < I: !f(t) ! dt where II denotes the Euclidean norm. Lemma 11.1 .2 Let G(t, x) be continuous for t in I and x in an ; taking values in Rn ; and let G satisfy the global Lipschitz condition IG(t, x) - G(t, y) 1 < Mix - yl for all x and y in lRn and t in I. Then the Contractive Mapping Principle applies to the mapping Tx (t) = a + It: G( s, x( s)) ds on the space C( J) of continuous functions on J, where J is a sufficiently small interval containing to . Theorem 11.1.1 (Global Existence and Uniqueness) Under the hy­ pothesis of the lemma, the Cauchy problem has a unique solution on I. The same is true if we can write I = U� 1 Ij and for every subinterval Ij there exists Mj such that IG(s, x ) - G(s, y)1 < Mj Ix - yl for all x and y in lRn and all s in Ij . Corollary 11.1.1 The Cauchy problem for the linear o. d.e. x' (t) = A(t)x(t) + b(t) where A : I -t lRnxn and b : I -t lRn are continuous has a unique solution on I. In fact, the solution with x ( to ) = 0 can be written as a convergent perturbation series x = I:�O(D- l A)k D- 1b = D- 1 b + D- 1 AD- 1b + D-1 AD- 1 AD- 1b + ... where D-1 denotes the solution to the problem with A = 0, namely D- 1 x(t) = It: x(s) ds . Theorem 11.1.2 (Local Existence and Uniqueness) Let G(t, x) be de­ fined and continuous for t in I and Ix - al < N, and satisfy IG(t, x) - G(t, y) 1 < Mlx -yl for t in I and Ix -a l < N, Iy -a l < N. Then for a sufficiently small interval J containing to there exists a solution of the Cauchy problem x' = G(t, x}, x(to} = a, which is unique on as large an interval as the solution exists. Corollary 11.1.2 Let G(t, x) be a C1 function defined for t in I and x in D (an open set in lRn ), taking values in Rn . Then the Cauchy 11 .4 Summary 511 problem x' = G(t, x), x(to) = a for to in I and a in D has a unique solution on a sufficiently small interval J containing to . Theorem If G(t, x) satisfies the hypotheses of the local existence and uniqueness theorem, then the solution can be extended uniquely until x(t) either becomes unbounded or leaves the domain of G. Theorem Let G(t, y) be a continuous function defined for t in I and y in an open set in anm . Assume IG(t, y) - G(t, z) 1 < MIY - zl ei­ ther a) for all t in I and all y and z in Rnm or b) for all t in I and y and z in some open ball B in Rnm . Then the Cauchy problem x(n) = G(t, x, x', ... ,x(m-l»), x(to) = a(O), ... ,x(m-l) (to) = a(m-l), has a unique solution a) on I or b) on some sufficiently small interval J containing to if the Cauchy data (a(O), ... ,a(m- l») belongs to B. 11.2 Other Methods of Solution· Definition The Euler approximation to the solution of the Cauchy problem x'(t) = G(t, x), x(to) = a, associated to the partition to < tl < ... < tn = T, is the piecewise affine function y(t) on [to, T] defined inductively by y(t) = Yle + G(tle, YIe)(t - tie) on [tie, tle+l] where Yo = a and Yle = y(tle) for k > 1. Theorem 11.2.1 If G and its first derivatives are bounded and tie = to + kh is a partition with uniform stepsize, then there exist constants Ml and M2 (depending only on the bounds for G and dG) such that Iy(t) - x(t) 1 < M2 (eMllt-tol _l)h where y(t) is the Euler approximation. Theorem 11.2.2 (Peano Existence) Let G(t, x) be continuous for t in I and x in a neighborhood 0/ a. Then there ezists a solution (not necessarily unique) to the Cauchy problem x' = G(t, x), x(to) = a, on a sufficiently small interval J containing to. The solution is a limit of Euler approximations. Definition If 2:�o aletle and 2:k:O Aletle are formal power series, we say 2: Aletle is a majomnt of 2: aletle if lalel < Ale for every k. 512 Chapter 11 Ordinary Differential Equations Lemma If L: Aktk is a majorant of L: aktk and L: Aktk converges in It I < c, then so does L: aktk . Lemma 11.2.1(Majorant Lemma) Suppose P(t) = L:�o Pktk,Q(t) = L:�o Qktk, R(t) = L:�o Rktk are formal power series that are majo­ rants of p(t) = L:�o Pktk, q(t) = L:::o qktk, r(t) = L:::o rktk, respec­ tively. Suppose CO and Cl are given and L:k:O Cktk is defined by the equations and suppose do and dl are given and L:�o dktk is defined by (k + l) (k + 2)dk+2 = (t P, (k - j + l)dk-i+1 + Qjdk_i) + Rk· 1=0 Theorem 11.2.3 Let p, q, r have convergent power series in It I < c. Then the Cauchy problem x\" = px' +qx + r, x(O) = CO, x'(O) = Cl , has a solution given by a power series x(t) = L:::o Cktk convergent in It I < c. 11. 3 Vector Fields and Flows· Definition A continuous vector field on an open set D in Rn is a continuous function F : D � Rn . It is said to be a gradient vector field if there exists a C1 function f : D � a such that F = V f . An integral curve of a vector field F is a C1 curve x : [a, b] � an such that x'(t) = F(x(t)) for all t in [a, b] . Theorem 11.3.1 If a vector field F is C1, then there exist unique integral curves satisfying x (0) = y for any y in D. Two integral curves either coincide (as subsets of D) or are disjoint. Definition A flow on an open set D in an is a continuous function ft (z) defined for x in D and t in a neighborhood of 0 (depending on x) 11.4 Summary 513 taking values in D, satisfying ft (fs(x)) = ft +s(x) whenever both sides are defined. The flow associated to a C1 vector field F is given by ft(Y) = x(t) where x(t) is the integral curve satisfying x(O) = y. The vector field associated to a C1 flow It is F (x) = 8/ 8t It (x) I t=O . Example (Hamiltonian Mechanics) Let q and p denote variables in lRn (interpreted as position and momentum); and let H(q, p) be a real­ valued function, called the Hamiltonian (interpreted as energy) . The vector field (8H(q, p)/8p, -8H(q,p)/8q) is called the Hamiltonian vec­ tor field, and the o.d. e. for an integral curve comprise the Hamilton­ Jacobi equations dQj 8H dt = 8pj (q,p), The Hamiltonian is constant on integral curves (conservation of ener­ gy) . If H(q,p) = (1/2m) lpI2 + V(q), the Hamilton-Jacobi equations are equivalent to Newton's laws of motion for a particle of mass m mov­ ing under the influence of a force F = -VV and V is interpreted as potential energy. Theorem Let Pj for j = 1, .. . , n be C1 and q and r be continuous functions on an open set D in lRn . Then f(x) is a solution of the p.d. e. n L Pj (x)8f/8xj (x) = q(x)f(x) + r(x) j=l if and only if for each integral curve x(t) of the vector field p, the re­ striction f(x(t)) is a solution of the o.d.e. u'(t) = q(x(t))u(t) +r(x(t)). Chapter 12 Fourier Series 12. 1 Origins of Fourier Series 12.1.1 Fourier Series Solutions of P. D.E. 's Fourier series were first stumbled upon by Daniel Bernoulli in the 1750s while studying the equation of a vibrating string, which is the partial differential equation (p.d.e.) Here y (x, t) denotes the vertical displacement of a string at the hori­ zontal point x at time t for 0 < x < L, as in Figure 12. 1.1. ,Y I I ! y(x, t) t;.- ........ � Figure 12. 1.1: 515 x 516 Chapter 12 Fourier Series Also L is the length of the string and the constant c is determined b h d· d . f h . ( 2 tension � . y t e enslty an tension 0 t e string c = d . lor approprIate enslty units) . We will not dwell on the derivation of this equation, which is a combination of Newtonian mechanics, simplfying assumptions, a limiting argument, and a little hocus pocus. We can give a plausible explanation of the equation, however, as follows: 82y / 8t2 is the accel­ eration of a point on the string located horizontally at x. According to Newtonian mechanics, the acceleration should be proportional to the force acting on that point on the string. This force is caused by the tension on the string, which acts to straighten it out. But 82y/8x2 measures the concavity of the string shape and has the correct sign to impart an acceleration in the direction of straightening out the string, as shown in Figure 12. 1.2. Figure 12. 1.2: In the problem considered by Bernoulli, the string is held down at the endpoints, yielding the boundary conditions y(O, t) = y(L, t) = 0 for all t. Also the string is initially (t = 0) held at rest in some position and then is released to follow the time evolution dictated by the equation (as in all Newtonian mechanics, the initial position and velocity are supposed to determine the future evolution of the system). This means the initial conditions y(x, O) = f(x}, 8y at (x, 0) = 0 are imposed, where 1 (x) is the initial shape of the string (for consis­ tency we need 1(0) = I(T} = O}. 12. 1 Origins of Fourier Series 517 Bernoulli observed that there were some particularly simple solu­ tions to the p.d.e., namely . k7r ck7r y(x, t) = sm LX cos yt where k is a postive integer, that satisfy the boundary conditions and the initial conditions with f(x) = sin(k7r/L)x. These solutions have a musical interpretation in terms of the sound produced by the string­ they give the overtone series for the fundamental tone (k = 1). Since the p.d.e. is linear, linear combinations of these simple solutions are also solutions. In Bernoulli's day it was presumed that infinite linear combinations would also satisfy the p.d.e., so would satisfy the p.d.e. and the initial conditions for 00 f{x) = L ak sin � x. k=l We can in fact verify that this is the case if we make suitable as­ sumptions on the coefficients to justify differentiating the infinite series term-by-term {see exercise set 12. 1.4}. Bernoulli went further, however, and claimed that in this manner he obtained all solutions. This claim can be made plausible in terms of the musical interpretation, but Bernoulli rested his claim on the vague and dubious grounds that with an infinite number of variables (the ak ) at his disposal, he could do anything at all. Euler immediately attacked Bernoulli's claim, pointing out that it would imply that an arbitrary function f(x) on 0 < x < L with f(O} = J (L) = 0 could be expanded in an infinite sine series Euler thought this was patently absurd, since the sine series possessed special properties, such as being an odd function in x and periodic of period 2L, which a function such as f{x} = x{L - x} does not possess. 518 Chapter 12 Fourier Series We will return to discuss this objection later. Of course, Euler had an axe to grind: he (and D'Alembert, independently) had found a completely different solution to the problem, namely 1 - -y{x, t) = \"2{f{x + ct) + f{x - ct)) where i denotes the extension of f to the whole line, which is odd, i{ -x) = -f{x), and periodic of period 2L, i{x + 2L) = i{x). It is a routine exercise to verify that Euler's solution actually works. Euler pointed out that Bernoulli's solution was a special case of his, which is clear from the trigonometric identity . k7r ck7r 1 ( . k7r ( ) . k7r ( )) sm L x cos yt = 2\" sm L x + ct + sm L x - ct . Bernoulli was not able to answer Euler well, except to repeat his lame argument that the equation 00 f{x) = L ak sin 7 x k=l was like an algebraic system of an infinite number of linear equations in an infinite number of unknowns. One of the most significant weak­ nesses in his argument was that he could not produce a formula for the coefficients ak in terms of f. This formula was actually first discovered by Euler several years later in the course of an unrelated investigation (Euler had cosines instead of sines), but as Euler was predisposed to reject Bernoulli's claim he never pointed out the possible relevance. Thus, did the two of them botch the opportunity of developing Fourier series a full half century before Fourier. Before leaving this interesting historic episode behind, it is worth commenting on one line of thought that Bernoulli might have pursued to great advantage. If we modify the vibrating string equation to in­ clude a damping term for friction, 82y 82y 8y 8t2 = � 8x2 - a at ' which is plausible on physical grounds (no real string vibrates forever like Bernoulli's simple solutions), then Bernoulli's method of solution 12. 1 Origins 01 Fourier Series 519 is easily modified (see exercise set 12. 1.4) , but Euler's fails completely. If there had been as many mathematicians in those days as there are today, no doubt some graduate student looking for a thesis topic would have observed this, which might have been enough to push Euler and Bernoulli onto the right track. Fourier came to consider Fourier series by way of a related p.d.e. , the heat equation 8u 2 82u 8t (x, t) = C 8x2 (x, t) where u(x, t) represents the temperature of a one-dimensional object (think of an insulated thin bar) at the point x at time t where c is a con­ stant that depends on the physical properties of the object. Imposing boundary conditions u(O, t) = u(L, t) = 0 (the physical interpretation of this kind of boundary condition is that the ends of the bar are at­ tached to reservoirs held at a constant temperature, which is taken to be zero) and initial conditions u(x, O) = I(x) for 0 < x < L, where 1 (x) is the initial temperature distribution, Fourier found the simple solution (for t > 0) if 1 ( x) = sin ( k7r / L ) x and hence 00 ( -c2 k27r2t) k7r u(x, t) = � ak exp £2 sin L x if 1 (x) = 2:%\"=1 ak sin( k7r / L)x by the linearity of the equation. Fourier went farther than Bernoulli and produced the formula 2 fL k7r ak = L J o I(x) sin LX dx for the coefficients in terms of I. This is easily verified by multiplying by sin (j7r/L)x and integrating term-by-term (assuming 2:�llak l is finite, so the series converges uniformly). We then need the elementary calculation • 7r • J7r 1L k . o sm L x sm L x dx 520 Chapter 12 Fourier Series I lL [ (k - j)1r (k + j)1r 1 dx - cos L x - cos x 2 0 L { L/2 if k = j, o if k # j. (Curiously, neither Euler nor Fourier presented this simple derivation immediately but rather first gave long-winded and largely incompre­ hensible derivations using power-series expansions and clever but in­ valid manipulations-presumably the method they used to discover the result-and then added the simple computation above as an after thought.) Armed with a formula for the coefficients, Fourier was able to make a more convincing claim that every function f (x) on 0 < x < L with f(O) = f(L) = 0 has a sine-series expansion. Actually this was quite a bold claim for his time, since neither the concept of function nor the meaning of the integral in the formula for ak with a general function f (in Fourier's time the integral was usually defined as an anti-derivative) were at all clear. In fact it was the interest in understanding Fourier's claim that helped spur a good deal of the work we have discussed in earlier chapters. Fourier devoted a good deal of effort to computing the sine-series expansions of explicit functions and examining the con­ vergence of the partial sums. This \"empirical\" evidence helped bolster his claim. 12.1. 2 Spectral Theory Before we begin the detailed study of Fourier series, it is worth remark­ ing on some of the special features of the trigonometric functions that enter into the expansions. Bluntly stated, we want to know why we should care about Fourier series and into what general framework they fit . It turns out that there are two distinct perspectives available, one leading to spectral theory and the other to harmonic analysis. If we ask why the sines appeared in the simple solutions to the vibrating string or heat equation, the answer can be given in terms of the \"operator\" 82/8x2 on the space of C2 functions on 0 < x < L with boundary conditions f(O) = f(L) = O. The sines are the solutions 1�. 1 Origins 0/ Fourier Series 521 (eigenvectors) of the eigenvalue problem tP dx2 1jJ(x) = )..1jJ(x) on 0 < x < L, 1jJ(0) = 1jJ(L) = O. This is completely analogous to the eigenvalue equation A1/J = )..1/J where A is an n x n matrix and 1/J a vector in an. In the present case, in place of A we take tP / dx2 and in place of Rn we take 1/J in the vector space of C2 functions on 0 < x < L satisfying 1/J(O) = 1/J(L) = O. The space of C2 functions is an infinite-dimensional vector space, but lJ2 / dx2 is linear: tP cf2 lJ2 dx2 (af(x) + bg(x)) = a dx2 /(x) + b dx2 g(x). Since the o.d.e. has explicit solutions for every possible ).. (real or com­ plex), it is simple to verify, because of the boundary conditions, that the only solutions to the eigenvalue problem are multiples of sin( k1T / L)x, which correspond to ,\\ = _k21T2 / L2 (see exercise set 12. 1.4). The eigenvectors 1/J then yield simple solutions of the above problems (and many more) by separation of variables: try u(x, t) = g(t)1/J(x) in the heat equation and obtain g'(t) = c2 '\\g(t), hence 9 is a multiple of exp (c2 '\\t) . So we can restate Fourier's claim as follows: every function has an expansion in eigenvectors for the operator d2 / dx2 on the space V of C2 functions on 0 < x < L satisfying /(0) = /(L) = 0, called the Dirichlet boundary conditions. (The fact that the range of d2 / dx2 on V is not equal to V creates some technical problems, but the eigenvectors will be in Vasa consequence of the eigenvalue equation.) We note one special property of this operator. If (/, g) denotes the inner product L L -- fo /(x)g(x) dx (or fo /(x)g(x) dx if we want to allow complex-valued functions), then ( d2/ ) ( 82g) dx2 ' 9 = /, 8x2 for / and 9 in V. This is easily seen by integrating by parts twice, using the boundary conditions /(0) = f(L) = 0 and g(O) = g(L) = 0 (from / and 9 being in V) to obtain the vanishing of the boundary terms in the integration by parts formula (see exercise set 12.1.4). The condition (A/, g) = (/, Ag) for a linear operator on an inner product space is called symmetry, and it is a direct generalization of the symmetry of 522 Chapter 12 Fourier Series an n x n matrix considered as a linear operator on the inner product space ]Rn . Recall that for a symmetric matrix we proved a spectral theorem asserting that ]Rn has an orthonormal basis of eigenvectors. The Fourier sine expansion can be expressed as a generalization of this spectral theorem, and both are special cases of a very general spectral theorem of von Neumann. In the spectral theorem for symmetric matrices, the eigenvectors can be taken to be orthogonal. This is true in general for symmetric operators. If A'l/Jl = .Al'l/Jl and A'l/J2 = .A2'l/J2 for .AI #- .A2 , then and ('l/Jl , A'l/J2) = ('l/Jl , .A2'l/J2) = .A2 ('l/Jl , 'l/J2); so the symmetry (A'l/Jl ' 'l/J2) = ('l/Jl , A'l/J2) implies .Al ('l/Jl , 'l/J2) = .A2 ('l/Jl , 'l/J2), hence ('l/Jl , 'l/J2) = 0 if .AI #- .A2 . This is just rL . k1r . j1r J 0 sm L x sm LX dx = 0 if j #- k in the special case under consideration, which is the key formula for finding the Fourier coefficients. In the general case, if j = I: Ck'l/Jk where the 'l/Jk are eigenvectors with distinct eigenvalues, then (if there exist linearly independent eigenvectors with the same eigen­ value, then we must use the Gram-Schmidt orthogonalization process to make them orthogonal to each other) . Another closely related example is the operator d2/ dx2 on the vector space VI of C2 functions satisfying the boundary conditions j' (0) = j' (L) = 0 (called the Neumann boundary conditions). Notice that we have not changed the formula for the operator but that we have changed the vector space of functions on which it operates. We take the same formula for the inner product as before, (j, g) = JoL j(x)g (x) dx . Once again we find that d2/dx2 is symmetric, (d2 /dx2 j, g) = (j, d2/dx2g) by integration by parts, this time using the Neumann boundary conditions to show that the boundary terms vanish. In case you are beginning to 12.1 Origins 01 Fourier Series 523 suspect that tP / dx2 will be symmetric for any boundary conditions, this turns out to be false (see exercise set 12.1.4). The eigenvectors for d2 / dx2 on VI are cos{ k7r / L)x with eigenvalue _k27r2 / L2 for k = 0, 1, .... From the symmetry we can conclude im­ mediately that Jo L cos(k7r / L)x cos(j7r / L)x dx = 0 if j :F k. Using the standard trigonometric identities as in the sine case we could obtain the same result, and also Thus if then /.L ( k7r ) 2 { L if k = 0, o cos LX dx = L/2 if k:F O. 2 /.L k7r ak = L 0 I{x) cos LXdx (the choice of the factor 1/2 in front of ao is purely conventional, so the formula for ak is the same for k = 0 as for k :F 0). This is called the Fourier cosine expansion, and Fourier also conjectured that every function 1 ( x) has such an expansion. Fourier used it to solve the heat equation with Neumann boundary conditions 8u 8u 8x (O, t) = 8x (L, t) = 0, which can be interpreted physically as saying the ends of the bar are insulated, hence no heat Bows across them. We can also combine the Fourier sine and cosine expansions by doubling the interval. IT /(x) is defined on [-L, L), then we can write I(x) = le{x) + lo(x) where le{x) = 1/2{/(x) + I( -x)) is even and /o{x) = 1/2{/{x) - I( -x)) is odd about the point x = O. Since the cosines are even and the sines odd, if le(x) restricted to [0, L) has a Fourier cosine series 00 ao \"\" k1f' \"2 + � ak cos L x, k=l then the same series will give le(x) on [-L, L) and, similarly, if lo{x) restricted to [0, L) has a Fourier sine expansion Ek:l bk sin(k7r / L)x, 524 Chapter 12 Fourier Series then the same series will give lo(x) on [-L, L] . Adding, we have the full Fourier series where and 00 ( ) ao k1r . k1r I(x) = - + '\"\" ak cos -x + bk SIn-x 2 t-r L L IlL k1r ak = L I(x) cos -x dx -L L 1 lL k1r bk = - I(x) sin - L x dx, L -L the factor 2 having disappeared because we extended the integration to the full interval (notice also that lL k1r lo(x) cos LX dx = 0 and -L lL k1r le(x) sin -x dx = 0 -L L because the integrands are odd functions). N ow recall that for the Fourier sine series we were assuming that 1(0) = I(L) = O. What does this mean for the odd function lo (x) above? The condition 10(0) = 0 is automatic from the definition lo (x) = 1/2(/(x) - I( -x)), but the condition 10 (L) = 0 is the same as I(L) = I( -L) (for the even part the condition le(L) = le( -L) is auto­ matic) . We can interpret this as a periodicity condition if we extend I to be periodic of period 2L. This is a natural thing to do since the sines and cosines in the series already are periodic of period 2L. Thus we define I(x) on the whole line by saying l(x + 2L) = I(x) for all x. The condition I ( -L) = I (L) is then necessary and sufficient for this con­ dition to be fulfilled. We will usually discuss Fourier series in terms of the periodic extension-thus the condition that I be continuous mean­ s that I is continuous on [-L, L] and I(L) = I( -L) , the condition that I be C1 means that I is CI on [-L, L] and I(L) = I( -L) and I' (L) = I' ( -L) , and so on. Thus Fourier's conjecture is that every continuous function I(x) on the line that is periodic of period 2L has a full Fourier series expansion. This follows from the two conjectures concerning Fourier sine and cosine series, and it implies them by considering even and odd extensions across x = 0 (see exercise set 12. 1.4) . The conjecture is actually not 1�. 1 Origins of Fourier Series 525 quite correct as we will see in the next section, but it can be modified in a number of ways to give a correct theorem. Notice already that we have successfully countered Euler's objection that the function f(x) = x(L - x) cannot have a Fourier sine-series expansion because it is not odd and periodic. Fourier's claim is only that x(L - x) = fbk Sin � x k=l for 0 < x < L. For other values of x the sine series converges to the function f(x), which is obtained by extending x(L - x) to be odd and periodic of period 2L, but f(x) =F x(L - x) outside the interval [0, L] . Euler could not conceive of this possibility because he was experienced in dealing with power series and knew that one cannot have a power series converge to different analytic expressions on different interval­ s. Euler naively assumed that trigonometric series would behave like power series-in fact nothing could be further from the truth! 12. 1.3 Harmonic Analysis In dealing with the full Fourier series we can simplify matters con­ siderably by introducing complex numbers. Recall the Euler relations eix = cos x + i sin x, cos x = (eiX + e-iX) /2, and sin x = (eix - e-ix) /2i. Using these it is easy to show that ao � ( kTr • kTr ) 2 + � Qk cos yx+bksm L X k= l 00 E c\",e(in:tr/ L)x n=-oo where en = (1/2L) J�L f (x) e-(imr/L)xdx (see exercise set 12.1.4). The condition that, f (x) be real-valued is then equivalent to the condition C-n = en on the Fourier coefficients. Note then that the functions e(in1r/L)x are exactly the eigenfunctions of the operator d/dx on the space of C1 functions with the periodic boundary conditions f ( -L) = /(L) (note that the operator d/dx is now skew-symmetric instead of symmetric but it can be made symmetric by multiplying by ±i). Now we are in a position to discuss the second interpretation of Fourier series. Let Ty denote the operation of translation by y, Tyf(x) = 526 Chapter 12 Fourier Series f{x + y}. We can apply this to any function on the line, but for this discussion we restrict attention to periodic functions of period 2L. We can relate the operators Ty and the operator d/ dx by the formula d/dx = (8/8Y}Ty ly=o. In a sense that we need not make precise, d/dx is a sort of infinitesmal translation, and conversely the translations may be obtained by integrating d/dx. The point of this vague discussion is the following: if the functions e(ik1r/L)x are eigenvectors for d/dx, they should also be eigenvectors for Ty• Having said this, it is immediately obvious that they are: It is not hard to show (see exercise set 12.1.4) that (up to constant multiples) these are the only periodic functions that are eigenvectors for all the operators Ty• We can go a little further with the eigenvalue equation for Ty and write it as 1/J(x + y) = 1/J(x)1/J(y). This equation, called the character identity, has a beautiful symmetry. It is not hard to show that any complex-valued C1 solution must be of the form exp (Ax) where A is a complex number (see exercise set 12.1.4), and with more work it is possible to show the same is true under the hypothesis that \"p is continuous. The condition that 1/J be periodic of period 2L then implies A = ikrr / L for some integer k. Notice that the character identity determines exp( ikrr / L}x exactly, whereas the eigenvalue equation allows an arbitrary multiple of exp( ikrr / L )x. The significance of the character identity is that it has a group­ theoretic interpretation. We think of the real numbers mod 2L as form­ ing a commutative group under addition (the elements of this group are the sets {x + 2Lk} as k varies over the integers, and {x + 2Lk} + {y + 2Lk} = {x + y + 2Lk} is well defined). A periodic function of period 2L may be thought of as a function on this group. The charac­ ter identity then says that \"p is a homomorphism of this group into the multiplicative group of the non-zero complex numbers. We note that in this case all the solutions of the character identity e(ik1f/L)x take on only complex values of absolute value one, 11/J( x} 1 = 1. Recall that the complex numbers of absolute value one, Izl = 1, can be written z = eifJ 1�. 1 Origins of Fourier Series for 8 real and 8 is determined mod 21T. Since ei91 ei92 = ei(91 +92) , 527 we see that the complex numbers of absolute value one under multi­ plication give an isomorphic model of the group we are considering for L = 1T. Let us denote this group T. We can summarize the above discussion {for L = 7r} by saying that the functions eik:c are continuous homomorphisms of the group T into itself. It turns out that these are the only ones (see exercise set 12.1.4, number 18 for a slightly weaker result). They are called the characters of T. Fourier's conjecture then says that an arbitrary complex-valued function on T is an infinite linear combination of characters. This is a special case of what is called harmonic analysis {or sometimes Fourier analysis}. There are far-reaching generalizations to other groups. If a group G is commutative we again consider characters, which are defined to be homomorphisms of G into T (usually there is a metric or more generally a topology on G, and the characters are assumed continuous). IT a group is non-commutative, then the character identity must be further generalized to the theory of group representations. In the case where the group G is the additive group of the line, the harmonic analysis leads to the theory of Fourier transforms. If we had not expanded our perspective to the complex numbers, the group-theoretic significance of the sines and cosines would not be so apparent. Nevertheless, there is still something we can say. Look at the two-dimensional vector space {a cos{k1T/L}x + bsin{k1T/L)x} of linear combinations of the two functions cos{ k1T / L}x and sin{ k7r / L}x. Then applying Ty to any function in the space produces another function in this space: Ty (a cos k; '\" + bsin � '\" ) k1T . k1T - a cos T {x + y} + bsm T {x + y} ( k7r k7r . k7r . k7r ) - a cos -x cos -y - sm -x sin -y L L L L ( . k7r k7r k7r . k7r ) + b sm L x cos L y + cos L X sm L y k1T . k1T A cos L x + B sin L x 528 Chapter 12 Fourier Series where ( A ) = ( cos(k1r/L)y B _ sin(k1r / L)y sin(k1r/L)y ) ( n . cos(k1r / L)y The constant functions of course form a one-dimensional vector space of functions that is preserved by all translations. It turns out that any finite-dimensional vector space of functions (periodic of period 2L) that is preserved by all translations must be a kind of sum of these basic building blocks. Thus the sines and cosines that appear in the Fourier series are in this sense the functions that behave most simply under translation. We have now given three reasons why Fourier series are so impor­ tant: 1) they are useful in solving p.d.e.'s, 2) they are a special case of the spectral theorem, 3) they are a special case of harmonic analysis. 12. 1. 4 Exercises 1. Assuming L:�1 k2 1ak l < 00, verify that � . k1r ck1r � ak sln L xcosyt k=l converges uniformly and absolutely to a C2 solution of the vibrat­ ing string equation with boundary conditions y(O, t) = y(L, t) = 0 and initial conditions y(x, O) = f(x), (8/8t)y(x, 0) = 0 for 2. Show that it is impossible to have sin x = L:�2 ak sin kx on 0 < x < 1r with the series converging uniformly, for any choice of the ak, even though there are an infinite number of parameters in the problem. (Hint: multiply by sin x and integrate.) 3. Verify that the Euler-D' Alembert solution 1 - - y(x, t) = 2 (f(x + ct) + f(x - ct)), 12. 1 Origins 01 Fourier Series 529 - where 1 denotes the extension of 1 to the whole line satisfying i( -x) = - I(x) and i(x + 2L) = i(x), actually solves the initial value problem for the vibrating string equation for any function 1 ( x) such that i is C2• What conditions on 1 are necessary and sufficient for j to be C2? 4. Solve the damped vibrating string equation 82y 82y 8y 8t2 = c2 8x2 - a 8t with boundary conditions y(O, t) = y(L, t) = 0 and initial condi­ tions y(x, O) = I(x), 8y/8t(x, 0) = 0 assuming 00 I(x) = E ak sin � x k=l with E k21akl < 00. (Hint: look for special solutions g(t) sin(k1r/L)x and obtain an o.d.e. for g. You will have to dis­ tinguish three cases depending on whether a is greater than, equal to, or less than 2ck1r / L.) 5. Verify that satisfies the heat equation for t > 0 with boundary conditions u(O, t) = u(L, t) = 0 and initial condition u(x, 0) = I(x) if I(x) = E�l Ok sin( k1r / L)x with E lak I < 00. 6. Show that all solutions of 1/J\" (x) = .\\1/J(x) on 0 < x < L with 1/J(0) = 1/J(L) = 0 are of the form csin(k1r/L)x. (Hint: write down all solutions of the o.d.e. and impose the boundary conditions.) 7. Show that all solutions of 1/J\" (x) = .\\1/J(x) on 0 < x < L with 1/J'(0) = 1/J' (L) = 0 are of the form ccos(k1r/L)x. 8. Prove the symmetry of d2 / dx2 on the vector space of C2 functions with a) Dirichlet (/(0) = I(L) = 0) or b) Neumann (/'(0) = /' (L) = 0) boundary conditions. 530 Chapter 12 Fourier Series 9. For which values of a and b is the operator lJ2 /dx2 symmetric on the vector space of C2 functions on [0, L] satisfying al(O) + b!'(O) = al'(L) + b!'(L) = O? Prove the symmetry in the cases it is true, and give counterexamples to the symmetry in the cases it is false. 10. Find all eigenvectors for the operator lJ2 / dx2 on the space of C2 functions on [0, L] satisfying the boundary conditions 1(0) = I'(L) = O. 11. Prove the symmetry of the Sturm-Liouville operator AI = pI\" + pi I' + ql, where p and q are real-valued functions, on the space of C2 functions with a) Dirichlet boundary conditions, or b) Neumann boundary conditions. 12. Show how any result about convergence of the full Fourier series on [-L, L] implies a result about Fourier sine and cosine series on [0, L). 13. Express the a's and b's in terms of the c's and vice versa in the two forms and 00 ( ) ao k7r . k7r \"2 + L ak cos L + bk Sin L x k=l 00 L ene(lk1f/L)x n=-oo of the full Fourier series. 14. Show that E�=-oo ene(ik1f/L)x is real-valued if and only if C-n = en· 15. Show that all eigenfunctions of d/ dx on the space of C1 functions on [-L, L] satisfying I(-L) = I(L) are of the form ce(ik1f/L)x. 16. Show that (AI, g) = -(I, Ag) on a complex inner product space if and only if iA is symmetric. 17. Show that if Ty/{x) = g{y)/{x) for every x and y and some C1 function g(y), where I is a C1 periodic function of period 2L, then I{x) = ce(ik1f/L)x. (Hint: differentiate and use exercise 15.) 12. 2 Convergence of Fourier Series 531 18. Show that any complex-valued C1 function satisfying the charac­ ter identity must be of the form exp(.Ax) for .A complex. 19. Show that any bounded C1 function on the line satisfying the character identity must be of the form f(x) = eitx for real t. 20. a. \"Sketch\" the graph of sin 10, OOOx. (Note: Your ear is capable of hearing a tone with this frequency, a little more than an octave above the highest note on a piano.) b. \"Sketch\" the graph of sin 10, OOOx + sin 10, 001x. (Hint: use the trigometric identity sin ( a + b) + sin( a - b) = 2 sin a cos b. ) 21 . Solve the differential equation in the rectangle 0 < x < a, 0 < Y < b with boundary conditions that u(x, O) = f(x) on the bottom side and u = 0 on the other three sides (i.e., u(x, b) = 0, u(O, y) = 0 and u(a, y) = 0) by expanding u(x, y) in a Fourier sine series in x, for each fixed y. 12.2 Convergence of Fourier Series 12.2.1 Uniform Convergence for C1 Functions Dirichlet was the first mathematician to give a good proof of the con­ vergence of Fourier series. His work on the question was important also because it stimulated Riemann to investigate integration theory. Dirichlet proved that a continuous function is equal to a pointwise con­ vergent Fourier series if it has only a finite number of maxima and minima. Dirichlet also proved a similar result for a function that has a finite number of discontinuities, and he remarked that he only used that property to ensure the existence of the integral. He had the in­ tegrity to admit that he saw no way to remove the hypothesis that the number of extrema be finite, even though he could not see any natural reason why the hypothesis should be needed. We will follow Dirichlet's argument part way, and use it to establish the uniform convergence for a C1 function. 532 Chapter 12 Fourier Series Our starting point will be a function f (x) that is continuous and periodic of period 27r (we now follow the convention of taking the period equal to 27r in order to simplify the notation-clearly the arguments will go through in the general case). We form the Fourier coefficients 1 111' . en = - f(x)e-mx dx 21T -11' and the Fourier series n=-oo To investigate the convergence we form the partial sums S N f (x) - E�=-N eneinz. Notice that the order we are taking corresponds to the natural order in terms of sines and cosines, N ) ao \"\" . S N f (x = 2\" + L..J (ak cos kx + bk sIn kx). k=l We want to show SNf(x) -t f(x) as N -t 00. Dirichlet's key idea is simply to substitute the definition of the Fourier coefficients in order to write S N f (x) as a convolution. To see how this works, we need the elementary observation that if f is 21T-periodic, then 1..: /(x) dx = [+2W /(x) dx for any real a-for any interval of length 27r can be cut in two pieces and translated back by multiples of 27r to the interval [-7r, 1T] . Note that this remark also applies to f(x)e-inz, since this function is again 27r-periodic. Using these ideas, we find SNf(x) = N . N 1 (111\" . ) . E enelnX = E - f(y)e-my dy e'n,x n=-N n=-N 21T -11' � f: 111' f(y)ein(x-y) dy 21T n=-N -11' � 111' f(y) ( f: eiRCZ-Yl) dy 21T -11' n=-N 1 111\" 21T - 1r f(y)DN(X - y) dy, 1!.! Convergence 01 Fourier Series where we have defined the Dirichlet kernel D N by N DN (t) = E eint. n=-N 533 Since this is a geometric progession, we can evaluate it exactly. We have so N+l eit DN (t) = E eint = DN (t) + ei(N+l)t - e-iNt, n=l-N _ ei(N+l)t _ e-iNt _ ei(N+l/2)t _ e-i(N+l/2)t _ sin(N + 1/2)t DN (t) - eit _ 1 - eit/2 _ e-it/2 - sin(1/2}t . We call the expression J�7r 1 (y )g( x - y) dy the periodic convolution of 1 and g, written 1 * g( x}, for any 21r-periodic functions 1 and g. We observe that it is a commutative product, for by the change of variable y -? x - y we obtain j7r lx+7r j7r -7r I(y)g(x - y) dy = X-7r f(x - y)g(y) dy = -7r I(x - y)g(y) dy. Thus we have If (1/21r)DN behaves like an approximate identity we can hope to show SNI -? I· Let us examine the graph of DN (t) (see Figure 12.2. 1 for the case N = 3). Notice that DN (O) = 2N + 1, so DN has a peak at the ori­ gin. However, the function sin(N + 1/2}x in the numerator oscillates frequently between -1 and +1, and the function sin z/2 in the denom­ inator has only the single zero at x = o. Thus the quotient does not actually become small for x away from zero. However, there is a great deal of oscillation away from x = 0 so that \"on the average\" D N is small away from the origin. We do have (1/21r) J�7r DN (t} dt = 1, which can be seen quite easily from the expression D N (t) = ��=_ N eint, since only the term n = 0 survives the integration. 534 Chapter 12 Fourier Series sin(7z/2) sin(z/2) sin(7z/2)/ sin(z/2) Figure 12.2. 1: Since we are interested in the convergence of S N f to f, we write 1 111\" SN f(x) - f(x) = - [f(x - y) - j(X)]DN (Y) dy. 21r -'If But now we cannot take absolute values inside the integral without courting disaster, since we have no control over IDN (y) l. In fact it can be shown that J::7r IDN(y) ldy > c log N (see exercise set 12.2.6) . It follows that a direct appeal to the approximate identity method will not work. Nevertheless, the cancellation implied by the oscillation of D N away from the origin should make the contribution to the integral from 6 < Iyl < 1r very small. The way to see this is by the appropri­ ate integration by parts. We begin by proving the convergence under stronger hypotheses, namely that f is C2• The proof is simpler in this case. As a bonus we get a faster rate of convergence. 1�.� Convergence 01 Fourier Series 535 Theorem 12.2.1 Let I be a C2 periodic junction of period 27r. Then the Fourier series 01 I converges unilormly to I, and in lact SN I (x) - I(x) = O(1/N) uniformly as N � 00. Proof: We have seen that we can write 1 /11' SNI(x) - I(x} = - (/ (x - y) - l(x}}DN (Y} dy. 27r -11\" The trick is to substitute the explicit formula for D N (y) and to group the terms as follows: SNI(x) - /(x) = 2� i: ( /(X �i:�//(X)) sin (N + D ydy. We write g(y) = (/(x - y) - I(x))/ sin y/2, and observe that this is a C1 function on [-1t', 7r] . Indeed, there is no problem away from y = 0, and near y = 0 we can use the Taylor expansion of I(x - y) about x, as in our discussion of L'Hopital's rule. It is here that we use the hypothesis that I is C2• Furthermore, we can find a bound II (y) I < M for all x and y. Now we are ready to do integration by parts, differentiating 9 and integrating sin(N + 1/2)y = (-d/dy) cos(N + 1/2}y/(N + 1/2}. There are no boundary terms because the cosine of (N + 1/2)y vanishes when y = ±7r. Thus 1 /11' cos(N + l }y S N I (x) - I (x) = 27r -11' g' (y) N + � 2 dy; hence, ISN I(x) - l(x) 1 < M/(N + 1/2) as claimed. QED In fact, by integrating by parts k - 1 times, you can show that if I is Ck, then the rate of convergence is O(l/Nk-l). We leave the details to the exercises. Theorem 12.2.2 Let I be a C1 periodic function of period 21r. Then the Fourier senes of I conl1erges uniformly to I; in fact, S N I (x) - I(x) = O(N- l/2} unilormly as N � 00. Proof: Once again we write SNI(x) - /(x) = 2� i: g(y) sm( N + DY dY, 536 Chapter 12 Fourier Series for g{y) = (/{x - y) - I{x))/ sin y/2. This time we divide the interval [-1T, 7T] of integration up into two pieces, the interval [-0', 0'] and its complement 0' < Iyl < 1T, where 0' will be chosen later. In [-8, 8] we do nothing, and in its complement we integrate by parts. The hypothesis that I is C1 implies g{y) is continuous away from y = 0, but even at y = 0 we have the limit lim I{x - y) - I{x) = lim y I(x - y) - I{x) = -2/' {x) . y-o sin �y y-o sin �y y By the mean value theorem I{x - y) - I{x) = -yf' (z) for some z, which gives the estimate yl'(z) Ig(y)l < . 1 < 1T sup II' (z) I, sIn '2Y z using the fact that Iyl < 1T1 sin y/21 on Iyl < 1T (see exercise set 12.2.6) . Thus l>(y) Si�N + DYdy < 1: Ig(y) dYI < 2 ... 5 s�P II'(z)l· This is a good estimate, because we can make the integral small by taking 0' small. Next we consider the integral over the interval [0', 1T] (we treat [-1T, -0'] analogously). We integrate by parts, differentiating g(y) and integrat­ ing sin(N + 1/2) , to obtain 111' 111' , cos(N + l)y cos(N + 1)0' g(y) sin(N+l/2)y dy = 9 (y) N 12 dy+g(O') 12 6 6 + 2 N+ '2 and now can take absolute values and estimate fll' 1 J6 g{y) sin{N + 2)ydy < N � � ({ 19'(y) 1 Cos( N + D y dy + Ig(5) 1cos( N + D 5) . Now Ig{O')I < 1TSUPz 1/' {z) 1 as above, and '( ) _ -I' {x - y) _ cos �y () gy- . 1 2 ' l g y , sm 2Y sIn 2Y 1�.� Convergence 0/ Fourier Series 537 so Ig'(y) 1 < (11\"/8) sup: If'(z) 1 + (11\"/28) sup: If'(z) 1 using sin y/2 > 8/11\" on [8, 11\"] (this follows from Iyl < 11\"1 sin y/21). Thus { g(y) sin (N + n y dy < N � l G; + lI }�P II' (z)l. The factor of N + 1/2 in the denominator is helpful, but the 6 in the denominator is a potential problem. Adding the estimates for [-8, 8] and its complement we obtain ISNI(x) - l(x)1 = 2� i: 9(Y) Si{ N + DY dY < [6 + N � � (:,5 + 1) ] s�p 1/'(z) l· Is this good enough? Yes, if we choose 8 = (N + 1/2) - 1/2 we obtain the estimate ( 1) -1/2 ISN f(z) - f(z)1 < c N + 2 s�p If'(z) 1 where the constant c does not depend on f or z or N (we use here (N + 1/2) - 1 < (N + 1/2)- 1/2 for N > 1). Thus we have the uniform convergence of the partial sums to f. We have actually shown that the rate of convergence is O(N-1/2), with the constant depending only on sup: If'(z) l. QED It would be nice to know that the convergence is also absolute so that the order of terms is immaterial. This is indeed the case as we will show later. However, there are conditions on / that yield the conver­ gence of S N f but not the absolute convergence. There are also many variants of this theorem that give convergence under weaker conditions and local versions in which only the convergence at a single point is proved. Some of these are given in exercise set 12.2.6. 12.2.2 Summability of Fourier Series We have now seen that Fourier's conjecture is true if we add the addi­ tional hypothesis that the function be C1• However, there is something very unsatisfactory about this result, because the hypothesis is stronger 538 Chapter 12 Fourier Series than the conclusion. That is, the natural hypothesis for convergence of the Fourier series is that I be continuous; if I is C1 we would like to know that the differentiated Fourier series E�=-oo ineneinx also con­ verges to I'. But neither statement is true. Still, there is a way to impove matters by changing the question. Instead of asking for the convergence of the Fourier series, we ask for a weaker condition called summability. This notion exploits the great amount of cancellation that is to be expected due to the oscillations of the functions einx . The point is that by simply adding the terms of the Fourier series in pairs (cNeiNz + c_Ne-iNz) in passing from SN- il to SNI, we are doing things too abruptly, giving too much emphasis to the new terms. It is like dropping a pebble in a lake-even if the pebble is small it can make a big splash. However, there is a way to ease the pebble into the water gently. What we do with the Fourier series is to multiply each term eneinx by a constant that depends on both n and N. That is, we look at ,'V (lNI(x) = E AN,nCneinx n=-N instead of SN fez). We choose the coefficients AN,n to be small when n is near ±N so that the new terms are gently eased in, but we let AN,n -t 1 for fixed n as N -t 00 so that each term is eventually counted toward the sum. We can then ask if (I,'V I converges to I. Each choice of coefficients AN,n (with 0 < AN,n < 1 and limN_oo AN,n = 1 for each fixed n) is called a summability method, and if (I,'V I -t I we say the Fourier series is summable to I by the particular summability method. In fact the idea of summability methods can be applied to any sort of series, not just Fourier series. A key fact is that if the series converges, then it is summable to the same limit. If this were not true, the use of summability methods would be very suspicious. Fortunately, it is simple to prove, and we leave it to the exercises. The simplest summability method is Cesaro summability, where we take the coefficients A,'V,n to be linear in n, AN,n = (N + 1 - Inl}/(N + 1) = 1 - Inl/(N + 1}, as shown in Figure 12.2.2. For this choice of coefficients (IN f is just the arithmetic mean of the first N + 1 partial sums, (I,'V I (Sol + S1 1 + .. . + SN I)/(N + 1). 1�. � Convergence of Fourier Series 539 1 -N - l -N o N N + l Figure 12.2.2: The idea of using Cesaro summability on Fourier series is due to Fejer, and it works splendidly. Following Fejer, we write 1 UN f{x) = N + 1 (Sof(x) + . . . + SN f(x)) 1 N 1 j7r N + 1 � 211\" -7r f(x - y)DN(Y) dy 1 j1r - 211\" - 7r f(x - y)KN(y) dy where the Fejer kernel KN(y) is given by 1 � 1 � sin(n + 1/2)y KN(y) = N + 1 � Dn(Y) = N + 1 � sin(1/2)y . Now the idea is that the Fejer kernel should be better behaved than the Dirichlet kernel, because it involves an averaging process that exploits the cancellations in the Dirichlet kernel. To see this more clearly we have to simplify the expression for K N, using familiar trigonometric identities in an especially clever way. We observe that - cos(n + l)y + cos ny - cos[ ( n + Dy + �y] + cos[ ( n + Dy - �y] - - (cos( n + Dycos �y - sm( n + Dy sm �Y) 540 Thus and so finally Chapter 12 Fourier Series + (cos( n + i)ucos iu + sm( n + i)uSin iu) . ( 1) . 1 2 sm n + 2 y sm 2Y' 1 N . 1 E( - cos(n + l}y + cos ny} 2 sin 2Y n=O 1 - cos(N + l}y _ (sin( ¥ )y)2 2 sin !Y sin !y KN(Y) = 1 (sin� ¥ )y) 2 • N + 1 sln !y Examining this expression carefully, we notice two important improve­ ments over the Dirichlet kernel ( ) sin(N + �)y DN Y = . 1 . sm 2y The first is the appearance of the factor 1/(N + 1), which means KN(Y) gets small as N � 00, except near Y = 0 where sin Y /2 vanishes. This is the concentration of K N (y) near Y = 0, which gives it the properties of an approximate identity. This fact is not surprising in view of our strategy of averaging oscillations of Dn (y). The second fact is that K N is non-negative, KN(Y) > 0 for all y. This is rather startling, and I know of no explanation for it other than the computation itself. However, it is not essential for the theorems we will prove. The sketches of the graphs of D3 (X) and K3 (X) in Figure 12.2.3 show a marked contrast. Theorem 12.2.3 (Fejer) Let f be any continuous junction periodic of period 21T. Then the Fourier series of f is uniformly Cesaro summable to f, UN f � f uniformly as N � 00 where N f( ) E N + 1 - Inl inz UN X = N ene. +1 n=-N 1B.! Contletyence 0/ Fourier Series 541 -r Figure 12.2.3: Proof: This is essentially a consequence of the approximate identity lemma, since we have seen 1 1'\" (IN /(x) = 211\" -11\" f(x - y)KN (Y) dye Thus we need to verify that 1. KN (Y) > 0, 2. (1/21r) J�'Ir KN {Y) dy = 1, and 3. limN_co KN(Y) = 0 uniformly on Iyl > � for any 6 > o. From the expression KN (y) = 1 (Sin� ¥ )y) 2 N + 1 sln iy 542 Chapter 12 Fourier Series we obtain property 1, and then property 3 follows since IK ( )1 < lI e N Y - N + 1 (sin !y)2 < 82 (N + 1) for 8 < lyl < 7r. To verify property 2 we integrate the expression KN(Y) = E�=o Dn{y)/(N + 1), using the fact that f�7r Dn(Y) dy = 1 for all n. Repeating the argument of the approximate identity lemma, we write (using property 2) and so 1 17r uNf(x) - f(x) = - [/(x - y) - f(x)]KN(Y) dy 211\" -7r 1 17r IUN f(x) - f(x}1 < 27r -1r If(x - y) - f(x)IKN(Y) dy by Minkowski's inequality. Given E > 0 we first find 8 > 0 such that Iy!' < 8 implies I/(x - y) - f(x)1 < &/2 for all x. This follows from the uniform continuity of I, which is a consequence of periodicity. Indeed it suffices to prove the result for Ixl < 7r by periodicity, and then we have the uniform continuity of 1 on the compact interval Ix I < 7r + 1 (keeping 8 < 1 to stay inside it). This enables us to estimate 16 I/(x-y)-l(x) lKN(Y) dy < :'2 16 KN (y) dy < =-17r KN (y) dy = :. -6 -6 2 -7r 2 for all N. Given 8 we choose N large enough so that i:6 + { KN (Y) dy < 4� where M = sUPx I/(x)l. This is possible using property 3 if we take 27rc/82(N + 1) < E/4M. Then L:6 + { If(Z-Y)-f(z) IKN (y) dy < 2M (L:6 + { KN(Y) dY) < � and so IUN f(x} - l(x)1 < E for all x. QED 12.2 Convergence 01 Fourier Series 543 There are many variants of this result. For example, if 1 is just Riemann integrable but continuous at a point Xo, a simple modification of the same proof shows UN I(xo) � I(xo). Even if 1 has a jump discontinuity at xo, UN I(xo) will converge to the average value -2 1 ( lim I(x) + lim I(X)) = lim -2 1 (/(xo + 8) + I(xo - 8)). z-z+ z-z- 5-0 o 0 Notice that we are then approximating a discontinuous function by continuous functions, so the convergence cannot be uniform. For the same reason, the family UN 1 cannot be uniformly equicontinuous. Fejer's theorem gives an explicit proof that every periodic contin­ uous function can be uniformly approximated by trigonometric poly­ nomials. A trigonometic polynomial is defined to be any finite Fourier series, ��=-N eneinD• Since the trigonometric polynomials form an al­ gebra, this fact is also obtainable from the Stone-Weierstrass theorem, although in less explicit form. In the opposite direction, we can obtain the Weierstrass approximation theorem as a consequence of Fejer's the­ orem by replacing the exponentials einz in (1 N 1 (x) by partial sums of their power-series expansion, which we know converge uniformly on bounded intervals. An immediate corollary of Fejer's theorem is the uniqueness 01 Fourier series: if 1 and 9 are two continuous functions with the same Fourier coefficients, then 1 = g. Indeed if the Fourier coefficients are equal, then UN 1 = uNg for every N and, letting N � 00, we obtain 1 = g. 12.2.3 Convergence in the Mean Although Fejer's theorem suggests that the Cesaro sums UN 1 may do a better job than the partial sums 5 N I in approximating I, there is a criterion by which S N 1 is the best approximation among all trigono­ metric polynomials �f!.N aneinz of order N. This involves measuring the error in the mean-square sense as ( 1 j1r ) 1/2 d2(/, g) = 211\" -11' I/(x) - g(x )12 dx . 544 Chapter 12 Fourier Series This is the metric associated to the L2-norm associated to the inner product 1 111' (/,g) = 211\" _lr f(x)g(x)dx. Recall that the exponential functions e'nz are orthogonal vectors with respect to this inner product, (einz, eikx) = 0 if k =F n; and that the choice of the factor 1/211\" in the inner product makes them normal­ ized, (einz, einz) = 1. The normalization is purely conventional, and everything would work as well without it. We will need to use the following basic fact about orthonormal vectors in an inner product space (real or complex), which generalizes the formula for projecting a vector onto a subspace of Rn. We state and prove the result in the abstract context because it clarifies the ideas. Theorem 12.2.4 (Projection Theorem) Let til t .•. , tiN be orthonormal vectors in an inner product space V and W denote the subspace they span, W = {E�=l antln}. Given any vector u in V, the problem 0/ finding the vector w in W that minimizes the distance d( u, w) is solved by w = Pu = E�l (u, vn)vn . Pu is called the orthogonal projection 0/ u onto W and is characterized by the condition that Pu is in W and u - Pu is orthogonal to W. The distance d( u, Pu) is given by N d(u,Pu)2 = IIull2 - L 1 (u,vn) 12 , hence, we have Bessel's inequality N n=l L I(u, vn)12 < Ilu112. n=l Proof: We define Pu = E�=l (u, vn}vn and observe (Pu, Vk) = (u, Vk) for any k by the orthonormality condition. Therefore (u - Pu, Vk) = 0 and so (u - Pu, E�=l akvk) = 0, showing u - Pu is orthogonal to W. Of course Pu is in W from the definition. Now if 1�. � Convergence of Fourier Series 545 w is any vector in W, then u - w = (u - Pu) + (Pu - w) and Pu - w is also in W. Thus d(u, w)2 - (u - w, u - w) ((u - Pu) + (Pu - w), (u - Pu) + (Pu - w) - (u - Pu, u - Pu) + (Pu - w, Pu - w) _ d(u, Pu)2 + d(Pu, w)2 because u - Pu is orthogonal to W, as in Figure 12.2.4. This is a generalization of the Pythagorean theorem. u Pu '--\"\"'-_______ � w Figure 12.2.4: Notice that the first term d(u, Pu)2 is independent of w, and the second term d(Pu, w)2 is non-negative. It is obvious that the sum is minimized if the second term d(Pu, w)2 vanishes, which happens exactly when w = Pu. Thus w = Pu is the unique minimizer. To obtain the formula for d(u, Pu)2 we compute d(u, PU)2 - (u - Pu, u - Pu) - (u, u) + (Pu, Pu) - (u, Pu) - (Pu, u) and (using the definitions of Pu) N (Pu, Pu) = (u, Pu) = (Pu, u) = L l(u, vn)12• n=l QED Returning to the concrete context of the L2 inner product on 211'­ periodic continuous functions, we consider the set of orthonormal vec- 546 Chapter 12 Fourier Series tors einx for -N < n < N. Note that PI is exactly S N I. Thus we have the following corollary. Corollary 12.2.1 Among all trigonometric polynomials ��=-N aneinx 01 degree N, SN 1 minimizes the L2 distance to I, for any 21f'-periodic continuous function /. Furthermore, we have Bessel's inequality and where en = (1/21f') J�7r I(x)e-inx dx. In particular, is less than 1 j7r 21f' -11\" I/{x) - uN/{x) 12 dx. On the other hand, 1 - uN f goes to zero uniformly, so 1 j1l' lim - 2 I/{x) - UN l(x) 12 dx = O. N-+oo 1f' -11\" Thus combining Fejer's theorem and the projection theorem we obtain 1 j7r lim - 2 I/(x) - SN l(x) 12 dx = 0, N-+oo 1f' - 11\" the mean-square convergence of Fourier series. We can then take the limit as N -+ 00 in the identity 12.2 Convergence of Fourier Series 547 to obtain Parseval's identity: This identity gives us very useful information concerning the rate of growth of the Fourier coefficients. In particular, it implies limn-+±oo en = 0, a fact that is referred to as the Riemann-Lebesgue Lemma. Inciden­ tally, both the Riemann-Lebesgue lemma and Parseval's identity are valid under much more general hypotheses than continuity on f, but it requires the Lebesgue theory of integration to explain these hypothe­ ses. We will return to this in Chapter 14. There is also a bilinear form of Parseval's identity: where cn (f) and cn (g) denote the Fourier series coefficients of f and g. This is obtainable by applying the polarization indentity to both sides of Parseval's identity. The mean-square convergence of Fourier series implies a property of the orthonormal system einx called completeness (warning: this use of the term is somewhat different from the previous usages we have encountered): there is no non-zero continuous function f (x) that is orthogonal to all the functions emx, -00 < n < 00. For if there were such a function, then all S N f would be identically zero and so as N -+ 00; hence - I f(x) 12 dx = 0, 1 1 71\" 211\" -71\" so f - ° (the same conclusion also follows from Fejer's theorem since (j N f would also be identically zero) . The completeness can be inter­ preted as saying we have not omitted any terms in forming the Fourier series expansion-in retrospect, this is the idea Bernoulli should have advanced. 548 Chapter 12 Fourier Series One striking property of the mean-square convergence is that it does not depend on the order of the terms . If A is any finite subset of integers, let PAI(x) = I:A cneinx. Then where B denotes the complement of A, by Parseval's identity (the Fourier coefficients of I - PAl are Cn if n is in B and 0 if n is in A) . If AN is any sequence of finite subsets increasing to all of the integers and BN is the complement of AN, then We are now in a position to show the absolute convergence of Fourier series of C1 functions. Because leinxi = 1, the absolute convergence is only a question of the size of the coefficients, I:�=-oo eneinx converges absolutely if and only if I:�=-oo len l < 00. Now if I is C1 , then I' is continuous, and the Fourier coefficients of I' are - !,(x)e-mx dx = in- I(x)e-mx dx = inen 1 171\" . 1 171\" . 27r -71\" 27r -71\" by integration by parts (there are no boundary terms because I is assumed periodic, so I( -7r) = 1(7r) ). Note this is the same result that we would obtain by formally differentiating the Fourier series. The Parseval identity for I' is which implies is finite by the Cauchy-Schwartz inequality. Thus the order of terms in the Fourier series of a C1 function is immaterial, PAN I -? I uniformly. We should point out, however, that this argument only shows that S N I 12.2 Convergence of Fourier Series 549 converges; it does not show that the limit is f. For that we have to refer to the original proof. Another application of Parseval's identity (actually the Riemann­ Lebesgue lemma) is the principle of localization: the convergence of a Fourier series at a point Xo depends only on the behavior of f (x) for x in a neighborhood of Xo. Theorem 12.2.5 (Localization) Let f and g be two continuous peri­ odic functions such that f (x) = g( x) for x in [xo - 8, Xo + 8] , for some fixed 8 > o. Then the Fourier series for f and 9 either both converge or both diverge at Xo . Proof: As in the proof of convergence of the Fourier series for C1 functions, we write 1 J7r - [J(xo - y) - f(xo)]DN(Y) dy 211\" -7r 1 J8 - [J(xo - y) - f(xo)]DN (Y) dy 211\" -8 1 J-8 1 7r + - 2 + [J (xo - y) - f(xo)]DN(Y) dy. 11\" - 7r 8 The first term will be the same for 9 in place of f, so it suffices to show that the second term goes to zero as N -+ 00. Using a trigonometric identity for sin(N + 1/2)y we compute (f(xo - y) - f(xo))DN (Y) ( f(xo -.y) - f(Xo))sin(N + �) y sIn !y 2 (f(xo - y) - f(xo)) (f(xo - y) - f(xo)) sin Ny + 1 cos Ny. tan\"2Y When we integrate over [11\", -8] and [8, 11\"] we avoid the zero of tan y, so the limit is 0 as N -+ 00 by the Riemann-Lebesgue lemma. (Actu­ ally we have to extend the Riemann-Lebesgue lemma to discontinuous functions because the integral cuts off at y = ±8. Another way to get around this is to use a continuous cutoff of the integral, multiplying by a continuous function equal to 1 on Iyl > 8 and zero on Iyl < 8/2. We leave the details to the exercises.) QED 550 Chapter 12 Fourier Series 12.2.4 Divergence and Gibbs' Phenomenon· We come now to our first negative result, an example of a continu­ ous function whose Fourier series diverges at a point. The first such example was given by du Bois Reymond in 1876. The example we give is due to Fejer. In a sense these examples show that Fourier's conjecture was false. Nevertheless, the three positive results that we have established-me an-square convergence and Cesaro summability for continuous functions and uniform convergence for C1 functions­ more than compensate. In this regard we should also mention three more recent results that are beyond the scope of this work: 1. A \"typical\" continuous function has a Fourier series that diverges on a countable dense set of points. 2. In 1926 Kolmogorov gave an example of a function (integrable in the sense of Lebesgue) whose Fourier series diverges at every point. This function is not continuous, however. 3. In 1966 Carleson showed that for a large class of functions (L2 integrable in the sense of Lebesgue) including all continuous func­ tions, the Fourier series converges at \"almost every\" point (the set of points at which the series diverges has Lebesgue measure zero). The first result is relatively easy to demonstrate using some functional analysis, the second result is very difficult to demonstrate, and the third result is horrendously difficult. These results should give you an inkling of the complexity and subtlety of the issues raised by Fourier's conjecture. However, the essential validity of Fourier's point of view is firmly established. The idea of Fejer's example of a divergent Fourier series is to con­ struct the Fourier coefficients en in such a way that a certain subse­ quence of partial sums converges uniformly (this will give us the con­ tinuous function f) but other subsequences of partial sums will be unbounded at x = O. The basic building block is the sum Qn,m(x) cos mx cos(m + 1)x cos(m + 2)x cos(m + n - 1)x --n- + n-1 + n-2 + . .. + 1 1 �. � Convergence of Fourier Series cos (m + n + 1) x 1 cos (m + n + 2) x cos (m + 2n) x 2 - ... - n 551 Notice that if we sum just the first n positive terms at x = 0 we get lin + 1/(n - 1) + ... + 1 > log n by comparison with log n = It lit dt. This sum is Sn+mQn.m(O) . On the other hand, Qn.m (O) = 0, and in fact we will show that Qn.m ( x) is bounded by a constant independent of n and m . Thus Qn.m (x) is a function with the property that a certain partial sum of its Fourier series is very much larger at x = 0 than any value of Qn.m(x). Once we have established this it will be a simple matter to create f (x) by taking a suitable infinite linear combination of such functions. Lemma 12.2.1 There exists a constant c such that IQn,m(x)1 < c for all n, m, and x. Proof: We group together the two terms cos(m + n - k)x k cos(m + n + k)x k and use cos(m + n ± k)x = cos(m + n)x cos kx T sin(m + n)x sin kx to obtain . � sin kx Qn.m(x) = 2 sm(m + n)x L...J k . k=l To complete the proof we will show that E�=l(sin kx)/k is uniformly bounded. We use an interpretation for L�=l (sin kx)/k in terms of integrals of the Dirichlet kernel. Recall that and so n n Dn( x) = L eikx = 1 + 2 L cos kx k=-n k=l � sin kx LX 1 1 LX 1 L...J k = 2\"(Dn(t) - 1) dt = 2\" Dn(t) dt - -x. k=l 0 0 2 Thus we need to verify the uniform boundedness of Lx D ( ) d - LX sin(n + �)t n t t - . 1 dt. o 0 sin 2t 552 Chapter 12 Fourier Series Figure 12.2.5: This can easily be seen if we recall that the graph of D n(t) oscillates between positive and negative values, changing sign at the zeros of sin( n + 1/2)t, � 2� n� t = n + 1/2 ' n + 1/2 ' ... , n + 1/2 ' (See Figure 12.2.5). The function fox Dn (t) dt thus Increases on [O, �/ (n + 1/2)], then decreases on [�/(n + 1/2) , 2�/(n + 1/2)], and continues to alternate between intervals of increase and decrease. Fur­ thermore, the absolute value of (k+l ,.. j n+l 2 � Dn (t) dt n+l/2 decreases with k because the numerator sin(n + 1/2)t is the same in absolute value and the denominator sin( 1/2)t increases with k. 12.2 Convergence of Fourier Series 553 Thus the function J; Dn (t) dt attains its absolute maximum at x = rr/(n + 1/2}. But we can easily estimate (1r/(n+1)/2 rr ( 1) Jo Dn(t) dt < n + � ·2 n + 2 = 2rr because Dn (t) attains its maximum value 2(n + 1/2) at t = O. QED Concerning the functions Qn,m (X), we have shown IQn,m (x) 1 < C for all n and m while Sn+mQn,m (O) > log n. Now we select sequences {nk} and {mk} so that there is no overlap between the exponentials occurring in the different Qnlr ,mlr' We can accomplish this by requiring mk > mk-l + 2nk-1 since cos jx occurs in Qn,m only for m < j < m + 2n. We then choose a sequence {ak} of positive coefficients such that 2:�1 ak is finite and set f(x) = 2:::1 akQnlr,mlr (x). The series converges uniformly by Lemma 12.2.1, so f is continuous. Also, the series that defines f is the Fourier series of f, because 1 j1r 00 1 j1r -ijx -ijx Cj = -2 f(x)e dx = L ak- Qnlr ,m\" (x)e dx, rr -1r k 2rr _1r =1 the sum commuting with the integral because the limit is uniform. At most one of the terms J::7r Qnlc,mlc (x) e-ijxdx is non-zero because of the non­ overlapping condition. In particular Snlc+mlcf(O) = akSnlc+mlc Qnlc,mlc (0) because Snlr+mIrQnj,mj = Qnj,mj for j < k and Qnj,mj(O) = 0 while Sn\"+m,,Qnj,mj = 0 for j > k. Thus Snlr+mlr/(O) > ak 1og nk, and if we choose ak and nk so that ak log nk -? 00 we have the divergence of the Fourier series for f at O. A particular choice of the mk, nk, and Ok that meet all the above conditions is ak = l/k2 (so Eak < oo), nk = 2(k3) (so ak log nk -? 00) , and mk = 2(k3) (so mk > mk-1 + 2nk-l). An interesting fact about the sums E�=l (sin kx)/k is that they are the partial sums of the Fourier series of the function { (7r - x) /2 if 0 < x < 7r, 9 (x) = _ (7r + x) /2 if - 7r < X < 0, whose graph is shown in Figure 12.2.6. To see this, we compute ! (1r (rr - x) sin kx dx = (rr - x) ( - cos kX) 1r _!. (1r cos kx dx = .!:. rr Jo 2 7r k 0 7r Jo k k 554 Chapter 12 Fourier Series and observe that there are no cosine terms since 9 is odd. Note that g( x) has a jump discontinuity at x = O. What is the behavior of the partial sums of the Fourier series of 9 in a neighborhood of this discontinuity? Of course they must approximate the jump, but in fact they do something more. At the point x = 1r/(n + 1/2} we computed n sin kx l lo1r/(n+l/2) 1r E k = - Dn(t) dt - . k=l 2 0 2n + 1 -1t o Figure 12.2.6: Now the claim is that this value actually exceeds 7r /2, which is the maximum value of g, by an amount that does not go to zero as n -? 00. In fact li E n sin kx li 1 lo n+�!2 D ( ) 1r m = m- n t - --n-oo k 11' n-oo 2 0 2n + 1 k=l x= n+l!2 _ lim ! f n+�!2 sin(n + 1/2}t dt n-oo 2 10 sin t/2 lim ! f n+�72 ( t ) sin(n + 1/2)t dt n-oo 2 10 sin t/2 t li lo n+�!2 sin( n + 1/2}t d li lo1r sin t d lo1r sin t d - m t= m - t= -- t n-oo 0 t n-oo 0 t o t because (1/2)tfsin(1/2)t -? 1 uniformly on 0 < t < 1r/(n + 1/2). Now we can compute Jo1r(sin t/t) dt > 1.08 1r/2 by numerical integration (we can also argue that J; (sin tit) dt > JoOO(sin tit} dt by an argument simi­ lar to the proof that J; sin(n+1/2}tfsin(t/2) dt attains its maximum at t = 1r/(n + 1/2}; and we compute JoOO(sin t}/t dt = 1r/2 exactly, giving 12.2 Convergence of Fourier Series 555 Io7r (sin t)/t dt > 1r/2). This means the partial sums of the Fourier series of g( x) make a little leap before they jump across the discontinuity, as can be seen in Figure 12.2.7, Figure 12.2.7: and the height of the leap is independent of the number of terms in the partial sum. This is referred to as Gibbs ' phenomenon, and it is true of any function with a jump discontinuity that is C1 up to the jump, for such a function can be written as the sum of a C1 function plus a variant of g. It may be regarded as a negative result because it shows that the behavior of Fourier series near jump discontinuities is worse than it has to be. 12.2.5 Solution of the Heat Equation* To conclude this chapter on a positive note, let's return to the heat e­ quation that Fourier considered and see what we can say. For simplicity of notation we choose L = 1r and c = 1, so the p.d.e. is 8u/8t = 82u/8x2 on 0 <x< 1r with boundary conditions u(O, t) = u(7t, t) = O. We will reflect u oddly about x = 0, u( -x, t) = -u(x, t) , and then extend it to be periodic of period 21r. Thus instead of the original boundary condi­ tions we will assume periodicity: u(x + 21r, t) = u(x). We will assume that u(x, t) is a C2 function on t > 0 and that u is continuous on t > 0 with u(x, 0) = f(x). For each fixed t > 0 we consider the Fourier series of the continuous 556 Chapter 12 Fourier Series function u ( x, t). The Fourier coefficients are c.. (t) = (1/211\") I: u(x. t)e-\"''' dz . Now we claim that the p.d.e. for u implies that en (t) satisfies the o.d.e. c'n (t) = -n2en (t). This requires first differentiating inside the integral to show en (t) is C1 and 1 11f' au c� (t) = - at (x, t)e-mx dx, 21T -1f' which is justified by the uniform convergence of the difference quotient (u(x, t + s)e-inz - u(x, t)e-inz)/s to the derivative as s -t O. Then we use the p.d.e. to replace 8u/at by 82u/8x2 and integrate by parts twice: c� (t) the boundary terms always cancelling because all the functions are periodic. Now we know the o.d.e. has only the solutions en(t) = ene-n2t where en is a constant. The fact that u(x, t) is continuous on the compact set I x I < 1T, 0 < t < 1 implies that it is uniformly bounded there, so en (t) must satisfy len(t) 1 < M for some fixed constant M for 0 < t � 1 and so lenl < M. This means that the Fourier series ��=-oo ene-n2teinx converges absolutely if t > 0 (by comparison with � e-n2t ). We could also obse.rve that since u(x, t) is assumed differentiable, the absolute and uniform convergence u(x, t) = ��=-oo en(t)einx has already been established. Finally we can assert that en are the Fourier coefficients of f because the uniform continuity of u(x, t) on 0 < t < 1 (by com­ pactness) implies the uniform convergence of u(x, t) to f(x) as t -t 0+ , so 1 111' . - 2 f(x)e- mx dx - 1T - 11' lim 2 1 111' u(x, t)e-inx dx = lim cne-n2t t-O+ 1T -11' t--+O+ en · 12.2 Convergence 01 Fourier Series 557 Thus we have shown that if the heat equation with periodic boundary conditions and initial condition u(x, 0) = f(x) has a solution, then this solution is 00 111' u(x, t) = E ene-n2teinz where en = (1/21r) I(x)e-inx dx. n=-OO -11' This establishes the uniqueness of the solution and justifies Fourier's formula. But now we have to confront the question: does this formula always produce a solution? We cannot use the above argument to answer this question because we assumed the existence of the solution in deriving the formula. What we have to do is start from the formula and see if it solves the problem. In other words, we are given the continuous func­ tion I(x), compute its Fourier coefficients en = (1/21r) J�lr I(x)e-inx dx and then write the series 00 u(x, t) = E ene-n2teinx. n=-oo What can we say about it? First we observe that the sequence en is bounded, lenl < (1/21r) J�lr I/(x)1 dx, so that the series defining u(x, t) converges if t > 0; in fact the convergence is absolute and uniform in t > c for any c > 0 by comparison with E e-en2• Thus the function u(x, t) is well defined and continuous in t > 0, and it is clearly periodic in x. Furthermore, we can differentiate term-by-term any number of times with respect to either variable, because ��=-oo Inlke-n2t converges for any fixed k. This enables us to conclude that u(x, t) is C2 in t > 0 (it is also COO) and satisfies the p.d.e. by direct computation. There remains only the question of what happens as t -+ O. We would like to assert that u( x, t) -+ 1 ( x) uniformly as t � 0+ , for this will show that by setting u(x, 0) = I(x) we obtain a continuous function on t > 0 with the correct initial conditions. This turns out to be more difficult to do. We do not know that E:=-oo eneinx converges in general, so the formula defining u(x, t) does not necessarily make sense for t = O. If we are willing to assume that I is C1 , then we know the Fourier series for 1 converges absolutely, E lenl < 00, and from this it is straightforward to prove 558 Chapter 12 Fourier Series uniformly since 00 00 L (ene-n2teinx - eneinx) < L lenl le-n2t - 11 n=-oo n=-oo n=-oo However, this hypothesis is not natural, and in fact the conclusion is true without it. The idea of the proof is very similar to the proof of Fejer's theorem. We substitute the definition of en in the formula for u and interchange the integral and sum to obtain u(x, t) = this being justified by the uniform convergence of the sum for t > O. We thus have u(x, t) written as a periodic convolution operator applied to f: 1 j7r u(x, t) = 211' -7r f(y)Ht (x - y) dy where the heat kernel Ht is given by n=-oo It turns out that the heat kernel is positive and behaves like an approxi­ mate identity (with continuous parameter t -+ 0 in place of the discrete parameter n -+ 00 before). This implies u (x, t) -+ f (x) uniformly as t -+ 0+ . We will not give the proof of the properties of the heat kernel, since this would take us too far afield. This example shows the utility of the Fourier series technique for the problems that gave rise to it, but it also indicates that it is by no means a trivial exercise to carry out the details of the applications. During the eighteenth century, the concept of \"function\" was often confused with that of \"analytic expression\" or \"formula\" . The concep­ t of \"function\" that we now accept was introduced in the nineteenth 12. 2 Convergence of Fourier Series 559 century-Dirichlet is reputed to be the first to state it explicitly, al­ though Fourier also seemed to have it in mind. On the other hand, if we accept a Fourier series as an \"analytic expression\" , then we can close the circle of ideas: at least for periodic continuous functions, there always is an analytic expression! 12.2.6 Exercises 1. Prove there exists a constant c > 0 such that Hint: 2. Let I be continuous and let I' (xo) exist. Prove S N I (xo) � f (xo) as N � 00. 3. Let f be Riemann integrable and continuous at the point Xo. Prove UN f{xo) � /(xo) as N � 00. 4. Let f be continuous except for the point Xo where / has a jump discontinuity. Prove (IN f{xo) � (limx_xt f{x)+limx_xo f(x))/2. 5. Let / be Riemann integrable. Prove f�1r IUNf(x) - f(x)/ dx � 0 as N � 00. 6. Apply Parseval's identity to the function { (1T -x) /2, g(x) = -(1T+x)/2, o < x < 1T, -7r < X < 0, 7. Compute the Fourier sine series for cos x and the Fourier cosine series for sin x on [O, 1r) . 8. Give a complete proof of the localization theorem. 560 Chapter 12 Fourier Series 9. Prove there exists a continuous function whose Fourier series di­ verges at a countable set of points. (Hint: if the example of a divergent Fourier series given in the text only diverges at a finite set of points, take an infinite linear combination of translates of it. ) 10. If {/k } is a sequence of continuous functions converging uniformly to I, prove that the Fourier coefficients of Ik converge to the Fourier coefficients of I. 11. Let Ty/(x) = I(x + y). What is the relationship between the Fourier coefficients of I and Tyl? 12. Let I * g(x) = f:'7r I(x - y)g(y) dy for continuous periodic func­ tions. What is the relationship between the Fourier coefficients of I, g, and 1 * g? 13. Prove that Iyl < 11\"1 sin y/21 on IYI < 11\". 14. *An alternative summability method, invented by John Hubbard, uses the factors a. Show that (Hint: use the Euler identity for cos x /2 and expand (cos x/2)2N using the binomial theorem.) b. Show that (22N / ( 2: )) (cos x/2r satisfies the same approximate identity properties as the Fejer kernel KN (properties 1-3 in the proof of Fejer's theorem) . c. Conclude that E�-N AN,nCneinx converges to I uniformly as N � 00 for any continuous, periodic function I. 12.2 Convergence 01 Fourier Series 561 15. *Let f be a Ck periodic function of period 211' for k > 2. a. Show that g(y) = (f(x - y) - I(x))/ sin y/2 is Ck-1 and there exists M such that Ig(k-l) (y) 1 < M for all x and y. b. Show that g(y + 211') = -g(y). c. Show that s I( ) - f( ) = ±� 111' (k-l) ( ) cos(N + 1/2)y d N x X 211' -11' 9 Y (N + 1/2)k-l y if k is even and a similar formula holds with cosine replaced with sine if k is odd. (Hint: use b to show that the boundary terms at ±11' cancel.) d. Conclude that SN f(x) - I(x) = O( I/Nk -l) uniformly as N� 00. 16. *Let A = 82/ 8x2 + 82/ 8y2 in R2 . For this problem you will have to use the polar coordinates representation 82 1 8 1 82 A = 8r2 + ;: 8r + r2 882 (section 10.2, exercise 9) . a. Show that rlkleik9 is the unique solution of Au = 0 in the disc r < 1 of the form g( r )eik9 with g( 1) = 1. (Hint: the o.d.e. for 9 has a two-dimensional space of solutions, but some of these solutions are singular at r = 0.) b. Assuming u(r, 8) = �k:-oo gk(r)eik9 has a Fourier series ex­ pansion for each fixed r < 1 and that the series can be d­ ifferentiated twice and also the limit as r � 1 can be in­ terchanged with the series, show that the Dirichlet problem Au = 0 in r < 1 and u(1, 8) = 1(0) has the unique solution u(r, 8) = �k:-oo ckrlkleik9 where Ck are the Fourier coeffi­ cients of I. c. Show that the solution can also be written in convolution form, u(r,8) = (1/211') J�lI' Pr(9 - <P)f(<p)d<p where Pr(8) = �k=-oo rlkleik9. 562 Chapter 12 Fourier Series d. Evaluate the infinite series for Pr (8) to obtain 1 - r2 Pr (8) = . 1 - 2r cos 8 + r2 Note that Pr (8 - <p) = (1 - IAI2)/IA - BI2 where A = rei() and B = eic.p. e. Show by direct differentiation that au = 0 if for any continuous function f on the circle. f. Show by an approximate identity argument that u(r, 8) -? f (8) uniformly as r -? 1 if f is continuous. 12.3 Summary 12.1 Origins of Fourier Series Theorem The solutions to the eigenvalue problem d2t/J/dx2 (x) = At/J(X) on 0 < x < L with t/J(O) = t/J(L) = 0 (Dirichlet boundary conditions) are multiples of the functions sin(k1r / L )x, k = 1, 2, .. . , with A = -k21r2 / L2 . Theorem If f(x) = 2:�1 bk sin(k1r/L)x with uniform convergence on [0, L], then bk = (2/ L) JoL f(x) sin(k1r / L)x dx. Similarly, if f(x) = ao/2 + 2:�l ak cos(k1r/L)x with uniform convergence on [O, L], then ak = (2/L) JoL f(x)cos(k1r/L)x dx. If with uniform convergence on [-L, L] , then ak = (1/ L) J!:L f(x) cos(k1r / L)x and bk = (1/L) J!:L f(x) sin(k1r/L)x, and in this case we also have f(x) = 2:�=-oo cnei(n1r/L)x with Cn = (1/2L) J�L f(x)e-i(n1r/L)x dx . 12. 3 Summary 563 Theorem The solutions to the character identity 1/J( x + y) = 1/J( x )1/J(y) that are C1 and periodic of period 2L are the functions ei(mr/ L):c , for n an integer. Theorem The two-dimensional real vector space of linear combinations of cos( k1r / L)x and sin( k1r / Lk)x is preserved under translation. 12.2 Convergence of Fourier Series Definition If f (x) is periodic of period 21r, the Fourier coefficients en are defined by en = (1/21r) J�7r f(x)e-in:c dx for n an integer and the formal series L:�oo enein:c is called the Fourier series of f. The partial sums 5 N f (x) of the Fourier series are defined by 5 N f (x) = E�=-N enein:c. The Fourier series is said to converge (pointwise, uni­ formly, or absolutely), if 5Nf(x) -? f(x) in the desired sense. Lemma If f is periodic of period 21r, then J�7r f(x) dx = J:+27r f(x) dx lor any a. Theorem 5NI(x) - (1/21r) J�7r l(y)DN (X - y) dy where DN is the Dirichlet kernel N DN (t) = L eint n=-N sin(N + 1/2)t sin t/2 Theorem 12.2.1 and 12.2.2 If I is periodic of period 21r and C1 , then the Fourier series converges uniformly to I and the rate of convergence is O(N- l/2). If f is C2, then the rate of convergence is O(N- l) . Definition The Fourier series of I is said to be Cesaro summable to f if UN f con verges to f, where � N+ I-Inl · 1 UN f(x) = � N + 1 ene'n:c = N + 1 (50f(x) + .. . + 5N f(x)). n=-N Theorem uNf(x) = (1/21r) J�7r l(x - y)KN(Y) dy where the Fejer ker- 564 Chapter 12 Fourier Series nel K N (y) is given by 1 00 1 sin( N + 1 ) Y ( ) 2 KN (Y) = N + 1 � Dn(Y) = N + 1 sin�/2 Theorem 12.2.3 (Fejer) If f is continuous and periodic of period 211\", then the Fourier series of f is uniformly Cesaro summable to f. Theorem (Uniqueness of Fourier Series) If f and 9 are continuous periodic functions with the same Fourier series, then f = g. Theorem 12.2.4 (Projection) Let VI , . . . , VN be orthonormal vectors in an inner product space V with span W. Then Pu = 2:f=l (u, vn) vn for any vector u in V is the orthogonal projection of u onto W in the sense that Pu is the unique vector in W such that u - Pu .1 W. Furthermore Pu is the unique minimizer in W of the distance to u and d(u, Pu)2 = IIu l 12 - 2:�=1 I(u, vn) 12 ; hence, we have Bessel's inequality 2:�=1 1 (u , vn) 12 < Ilu 112 . Definit ion A trigonometric polynomial of degree N is a function of th I \"N inx e Jorm wn=-N ane . Corollary 12.2.1 (Mean-Square Convergence of Fourier Series) Let f be continuous and periodic. Then S N f minimizes the L2 distance to f among all trigonometric polynomials of degree N and (1/211-) L: If(x} - SN f(x }12 dx --+ 0 as N --+ 00. Furthermore, Parseval's identity 2:�=-00 len l2 = (1/211\") J::7r I f(x) 12 dx holds or, more generally, 00 1 j7r L cn(f) en (g) = - If(x)g(x) dx 211\" -7r n=-oo for two such functions. Lemma (Riemann-Lebesgue) If f tS continuous and periodic, limn_±oocn = O. 12.3 Summary 565 Theorem (Completeness of Trigonometric System) The functions einz as n varies over the integers form an orthonormal set with respect to the inner product (f, g) = (1/21T) J�1f f(x)g(x) dx, which is complete in the sense that no other non-zero continuous function is orthogonal to all einx. Theorem The mean-square convergence of Fourier series does not de­ pend on the order of the terms; i. e., !.!..� ( 1/2,..) i: II ( .,) - PN I (., W d., = 0 if PN f(x) = EAN eneinz where AN is any increasing sequence of sub­ sets of integers such that U�=l AN is all integers. Theorem If f is C1 and periodic with Fourier series E eneinx, then f' has Fourier series E inen einz . Theorem If f is C1 and periodic its Fourier series converges absolute­ ly. Theorem 12.2.5 (Localization) The convergence or divergence of the Fourier series of a continuous function at a point Xo depends only on the function on any neighborhood of Xo. Lemma The trigonometric polynomials Qn.m (X) cos mx cos(m + 1}x --- + + ... n n-1 cos(m + n - 1)x cos(m + n + l)x + 1 - 1 cos(m + n + 2}x _ . . . _ cos(m + 2n}x 2 n are uniformly bounded for all x, n, m, but Sn+mQn.m (O) > log n. Example For the appropriate choice of sequence ak, nk, mk (e.g., ak = k-2, nk = mk = 2k3) the function Ek:l akQn\" ,mlc is continuous but has divergent (in fact unbounded) Fourier series at x = o. 566 Chapter 12 Fourier Series Example (Gibb, ' Phenomena) Let _ { (1r - x)/2 il O < x < 11\", g(x) - -(11' + x)/2 if - 11' < X < O. Then 9 has a jump ducontinuity at x = 0 with jump 11\", but the par­ tial sum. 01 the Fourier ,enes SN9 jump by more than 1.0811\" between ±N:1/2 lor all N. Theorem (Fourier) If u(x, t) is a C2 junction for t > 0, periodic of period 21r in x, satilflling the heat equation 8u/8t = 82u/8x2 together with the initial condition limt-o u(x, t) = I(x) uniformly, then 00 u(z, t) = L ene-n2teinx n=-oo where en are the Fourier coefficients of /. Conversely, for every C1 function I (actually continuous will suffice) , (*) solves the heat equation and initial conditions. Chapter 13 Implicit Funct ions , Curves , and Surfaces 13. 1 The Implicit Function Theorem 13. 1.1 Statement of the Theorem It frequently happens that a function is not given explicitly as y = I (x) but rather implicitly as the solution to an equation F(x, y) = O. In this section we will describe the Implicit Function Theorem, which gives conditions under which such equations actually do define functions. This is an extremely useful and important theorem, but it is also quite subtle. We have already seen an important case, involving inverse functions. If y = I (x) is given explicitly, the inverse function 1-1 ( x) is defined implicitly as the solution of the equation x = I (y), . which we can write x - I(y) = O. Note that this is of the form F(x, y) = 0 for F(x, y) = x - I(Y). We have proven an inverse function theorem in one dimension, and we exploited it in the definition of the sine and cosine. We will prove an n-dimensional version as a corollary of the Implicit FUnction Theorem. Another situation in which implicit functions arise naturally is in some of the so-called exact (or cookbook) solutions of o.d.e. 's. For example, the o.d.e. dy M(x, y) dz + N(x, y) = 0 567 568 Chapter 13 Implicit FUnctions, Curves, and Surfaces (often written M(x, y)dy + N(x, y)dx) is called exact if there exists F(x, y) such that M = 8F/8y and N = 8F/8x (this will happen if 8M/8x = 8N/8y and the region of definition is reasonable-see the exercises in section 11.3). Even if the o.d.e. is not exact, it can often be made exact by multiplying by an appropriate factor. Once the o.d.e. is exact, it is equivalent to (8/ 8x )F( x, y( x)) = 0 and, hence, F(x, y(x}} = c for some constant c. Thus all solutions of the o.d.e. are solutions of the implicit function equation F(x, y) - c = O. In order for this procedure to produce a solution to the o.d.e. we have to know how to solve the implicit equation. A third natural situation in which implicit equations arise is in the study of curves and surfaces. We frequently describe such geometric objects as the solution sets of certain equations. For instance, the unit sphere in � is the solution set for F(x, y, z} = 0 where F(x, y, z} = x2 + y2 + z2 - 1. We can think of this sphere as a two-dimensional surface because we can solve for one of the variables in terms of the others-at least in portions of the sphere, say z = - /1 - x2 - y2 in the lower hemisphere z < O. Thus x and y provide a pair of coordinates for this hemisphere. But if the function F were more complicated, say X27 y5 _ z16x9 + x4y4 z4 - 8xyz - 1, so that we could not solve F(x, y, z) = 0 explicitly, could we still main­ tain that the solution set is a two-dimensional surface? We will see in a later section that the implicit function theorem is the perfect tool for answering this question. The basic idea of the differential calculus is that if you have a ques­ tion about a general function in a neighborhood of a point, ask the same question about the best affine approximation at that point and the answers should be qualitatively the same. This perspective will lead us to the correct statement of the implicit function theorem and will give us a hint at how to prove it. Notice that this approach limits us to a local theorem. This turns out to be just right because simple examples show there are no nice global theorems. In this respect the one-dimensional inverse function theorem is very misleading because there is a nice global result. ·V'·/e want to consider a system of m equations for m unknown func­ tions Yl, ... ,Ym (each being a function of n variables Xl , .•• , Xn) . We will write Y = (Yl t . . . , Ym) and x = (Xl , ••• , xn), and we will write the 19.1 The Implicit Function Theorem 569 equations F(x, y) = 0 where F is a function defined in an open set in an+m taking values in 2m • Notice that we are prejudging the outcome that the number of equations and unknowns should be equal if there is to be any hope of having unique solutions. We are looking for a local theorem, so we consider fixed points i and y that give one particular solution, F(i, ii) = 0, and we ask if there is a way to define functions Yl , . . . , Ym of x (or y( x) taking values in Rm ) in a neighborhood of x so that y(i) = ii and F(x, y(x)) = 0 for all x in the domain of y. Because we want to use differential calculus we make the hypothesis that F be C1 and we also demand that the solution functions y( x) be C1 • If we were to replace F by its best affine approximation at (i, y), then we would be looking at the system � 8Fj(i, y) ( - ) � 8Fj(i, y) ( - ) 0 L..J 8 Xk - Xk + � 8 Yk - Yk = k=l Xk k=l Yk for j = 1, . . . , m, since F(i, y) = O. We abbreviate this system as Fx(i, y) (x - i) + Fy(i, y) (y - y) = 0 where Fx stands for the m x n matrix { 8Fj } , 8Xk 1 < j < m, 1 < k < n, and Fy stands for the m x m matrix { 8Fj } , 8Yk 1 < j < m, 1 < k < m. This is a system of affine linear (more commonly called inhomogeneous linear) equations for y, Ay = b(x), where A is the m x m matrix Fy(i, y) and b(x) is the vector Fy(x, y)y -Fx(i, y)(x -i). The implicit function theorem says essentially that if the affine linear sytem has a unique solution, then so does the original problem. At this point we need to review some basic facts from linear alge­ bra concerning matrix equations Ay = b. An m x m matrix is called invertible (or nonsingular) if there exists an m x m matrix B with AB = I, I denoting the identity matrix. If such a matrix exists it is unique, denoted A-I , and it is a two-sided inverse, A- I A = AA -1 = I. 570 Chapter 13 Implicit Functions, Curves, and Surfaces If A -1 exists, then y = A -1 b is the unique solution of Ay = b; and conversely if Ay = b has a unique solution for each b, then A -1 exists. In fact if Ay = 0 has the unique solution y = 0 (otherwise said, zero is not an eigenvalue of A), then A is invertible. Finally there is the determinant criterion: A is invertible if and only if det A # 0, in which case A-I may be explicitly given by Cramer's rule in terms of ratios of determinants of (m - 1) x (m - 1) submatrices of A. This is not a particularly efficient method for computing A-I, however. One crucial fact that we will need is that the set of invertible ma­ trices is an open set in Rmxm ; if A is invertible, then any matrix suf­ ficiently close to A is also invertible. One way to see this is via the determinant criterion: the set of matrices where det A # 0 is the in­ verse image under the continuous function det : Rnxn --? Rl of the open set Rl \\ {o}. However, we prefer a different proof that is more in the spirit of what we will be doing. Let us write a matrix close to A as A + B, where B is a small matrix. The most convenient measure of the \"size\" of a matrix M is the nonn IIMII, which is defined to be the least constant c such that IMxl < clxl for all x in Rm where Ixl denotes the Euclidean norm (warning: IIMI I is not the same as the Euclidean norm on Rnxn ). We will frequently use the estimate IMxl < IIMlllxl in this section. Here we want to point out that every entry Mj k is dominated by the nor­ m, IMjk l < IIMII (take x = (0, ... ,0,1, 0, ... ,0) with the 1 in the kth place, so Ixl = 1 and (Mx)j = Mjk; hence, IMjkl = I(Mx)j l < IMxl < IIMll lxl = IIMII)· On the other hand IIMII < (L:j,k MJk) 1/2 since 1M xl2 = L:j (L:k MjkXk)2 < L:j (L:k MJk L:k x�) = (L:j,k MJk)lxl2 by the Cauchy-Schwartz inequality. Thus the norm of a matrix is small if and only if all its entries are small. Now we will write a perturbation series for (A + B)-I . We have A + B = (1 + BA-1)A, so (A + B)-l 00 A-I E(-1)k(BA-1)k k=O A-I - A-1BA-1 +A-1BA-1BA-1 _ ••• • 13. 1 The Implicit Function Theorem 571 We need to verify that the infinite series converges, for then it is a simple matter to multiply by A + B and get the identity matrix. But this is easy to show if l iB A-I II < 1. In that case the series converges geometrically, so it gives an efficient method of computing (A + B) -1 if A-I is known. For the details, see the exercises. Note that we have actually established a quantitative result: if A is invertible and IIBA-I II < 1, then A + B is invertible. This method works in great generality, even in infinite­ dimensional problems where there is no determinant. We will also need to know that A- I is a continuous function of the entries of A. This follows from Cramer's rule, and we can also deduce it from the perturbation series (see exercise set 13.1.3, number 2) . Let us now return to the general implicit equation F(x, y) = 0 and the linearized version Fx(x, y) (x - x) + Fy(x, y) (y - y) = 0 near the point (x, y). The condition we want in order that the lin­ earized version have a unique solution is that Fy{x, y) be invertible. This condition then implies that the equation F(x, y) = 0 has a local solution. Theorem 13. 1.1 (Implicit Function Theorem) Let F{x, y) be a C1 function defined in a neighborhood of x in Rn and y in Rm taking values in Rm , with F(x, y) = c. Then if Fy(x, y) is invertible there exists a neighborhood U of x and a Cl function y : U -? Rm such that y{ x) = y and F{x, y(x)) = c for every x in U. Furthermore, y is unique in that there exists a neighborhood V of y (V is the image y{U)) such that there is only one solution z in V of F(x, z) = c, namely z = y(x}. Finally, the differential of y can be computed by implicit differentiation as dy(x) = -Fy(x, y{x ))-1 Fx(x, y{x)). A special case is the following: Theorem 13.1.2 {Inverse Function Theorem} Let f be a C1 function defined in a neighborhood of y in Rn taking values in Rn . If df{y) is invertible, then there exists a neighborhood U of x = f{y) and a Cl function g : U -? an such that f (g{ x)) = x for every x in U. Furthermore g maps U one-to-one onto a neighborhood V of y and 572 Chapter 13 Implicit FUnctions, Curves, and Surfaces g(/(y)) = y for every y in V. The function 9 is unique in that lor any x in U there is only one z in V with I(z) = x, namely z = g(x). Finally dg(x) = dl(y)-l il l(Y) = x. The inverse function theorem is a special case of the implicit func­ tion theorem with F(x, y) = I(Y) -x and c = o. Notice that Fy(x, y) = dl(y), so the hypotheses are the same. There is also a trick for reducing the implicit function theorem to the inverse function theorem: given F(x, y) = c we construct I : U -t Rn+m , where U is a neighborhood of (i, jj) in Rn+m , by I(x, y) = (x, F(x, y)). Then df(z, y) = (�% �J , and this is invertible with inverse ( I py-1p% �il ) if and only if Fy is invertible. Thus the hypothesis of the implicit function theorem for F implies the hypothesis of the inverse function theorem for f. If 9 is the local inverse to I, then g(x, c) = (x, y(x)) where y(x) is the solution to F(x, y(x)) = c. This is the way the implicit function theorem is proved in most texts. However, we will give a direct proof with an explicit algorithm for approximating the solution. Notice that in the above reduction the dimension was increased, so in order to have the one-dimensional implicit function theorem (n = m = 1) we need the two-dimensional inverse function theorem. Before beginning the proof let's look at some examples. Example 13.1.1 Consider the equation x2 +y2 = 1 of the unit circle in R2 , as shown in Figure 13.1.1. Here F(x, y) = x2+y2 and Fy(x, y) = 2y. This 1 x 1 matrix is invertible if and only if y # o. Thus according to the implicit function theorem, at any point (z, jj) on the circle except (1, 0) and ( -1, 0), we can locally solve for y as a function of x. Of course there are two possible solutions, y = V1 - x2 and y = -vi - x2, and the point (z, jj) will determine which of these it is. At the points (±l, 0) this breaks down, as y can't be defined for x < -l or x > -1 and the function y = ±VI - x2 does not even have a one-sided derivative at x = ±1. 13. 1 The Implicit Function Theorem 573 Figure 13. 1.1: Example 13.1.2 We consider what is essentially the function z2 on C. In terms of real variables alone this is the function f : R2 � a2 given by f(x, y) = (x2 - y2, 2xy). We would like to apply the inverse function theorem to this function. We compute d/(x, y) = (�: -�� ) and det df(x, y) = 4x2 + 4y2, so df(x, y) is invertible if (x, y) # (0, 0) . Thus the inverse function theorem says that there exist local complex square roots. But even if we cut away a neighborhood of the origin, we cannot define a global complex square root because the mapping f is not globally one-to-one. Indeed I(x, y) = f( -x, -y). We can visualize the mapping f as follows: cut the plane along the positive real axis, then wrap it twice around (simultaneously stretching r � r2) , and then glue it together again. This example shows that the local nature of the conclusion of the theorems is inherent in the situation. 13. 1.2 The Proof* We come now to the proof. The idea we use can be traced directly back to Isaac Newton, who used it to locate zeros of functions. Newton's method for solving I(x) = 0 is to obtain x as a limit of a sequence xo, Xl, ••• • The first value Xo is chosen close to a root of f(x) = o. We then replace f by its best affine approximation f(xo) + I'(xo)(x - xo), set this equal to zero, and solve x = Xo - I' (xo) - 1 I (xo). The point we obtain is the intersection of the tangent line to f at Xo with the x-axis, as shown in Figure 13.1.2. 514 Chapter 13 Implicit Functions, Curves, and Surfaces Figure 13.1.2: This is not the solution to I(x) = 0 in general, but we take it to be Xl. Iterating this process, we define Xn = Xn- l - 1'(xn-d-1/(xn-d. For this to make sense we need l' to be non-zero at all the points considered. Notice also that the iterative equation for Xn in terms of Xn- l can be written concisely as Xn = TXn- l where T is the transformation Tx = x - I' (x)- l/(x). We see that f(x) = 0 if and only if x is a fixed point of T. This suggests that we should apply the Contractive Mapping Principle. For technical reasons it will be easier to analyse the transformation Tx = x - !'(XO)-l f(x). Notice that it is also true of T that we have Tx = x if and only if I (x) = O. Furthermore, if I' doesn't vary too much the difference between T and T will be slight. We will not carry this discussion of Newton's method further, since we intend it only as motivation for the proof. Here is an outline of the proof: 1. For each point x in U we construct a map T : V � V with the property that F(x, y) = c if and only if Ty = y. This mapping T is a slight variant of the one suggested by Newton's method. 2. We verify the hypotheses of the Contractive Mapping Principle. The fixed point, y(x), is the implicitly defined function. 3. We show that y( x) is differentiable and the derivative at x is obtained by differentiating the identity F(x, y(x)) = c. This part of the proof only uses the identity F(x, y(x)) = c itself and does not refer to the way we obtained y( x ). 19. 1 The Implicit Function Theorem 575 4. By varying X, we establish dy(x) = -Fy(x, y)-l Fx(x, y(x)) for x in a neighborhood of X. This formula shows that y is C1 . There are unfortunately several small technical difficulties that make the proof long and pedantic. We mention one at the onset: the sets U and V in the implicit function theorem are required to be open sets, while the Contractive Mapping Principle requires a complete metric space and, hence, closed sets. (Actually this is only a problem for V, since U is in the parameter space.) To get around this mismatch, we have to consider both V and its closure iT. If we can show T : iT -+ V and is contractive on V, then we can apply the Contractive Mapping Theorem to V. This gives a unique fixed point in iT, but the fixed point must actually lie in V since T maps into V. Thus we may conclude the existence of a unique fixed point in V. Proof of the Implicit Function Theorem: We want the solution y to F(x, y) = c to be the limit of successive approximations obtained by iterating a contractive mapping. (The mapping will depend on x, which we treat as a constant.) Avoiding subscripts, let us suppose we have found y for which F{x, y) � c and we want a better approximation z. Replacing F by its best affine approximation at (x, y), which is F{x, y) + Fy{x, y) (z - y) (since we don't vary x, there is no Fx term), and setting this equal to c, we can solve F{x, y) + Fy{x, y) (z - y) = c to obtain z = y+Fy{x, y)-l {c-F{x, y)). Since our invertibility hypothesis concerned Fy(x, y) and (x, y) is a nearby point, we will simplify this to z = Y + Fy(x, y) -l(c - F(x, y)). Thus we are led to consider the mapping Ty = y + Fy(x, y)- l (C - F(x, y)), which is well defined since Fy{x, y) -l is assumed to exist, and has the property that Ty = y if and only if F{x, y) = c. We would like to find a neighborhood V of y, say V = {y : Iy - 1i1 < 6}, on which T is a contractive mapping; for then we will know that T has a unique fixed point and, hence, F(x, y) = c has a unique solution for y in V. Presumably we will have to restrict x to lie in a neighborhood of x in order for this to work, say U={x: lx -xl < e-}. In order to verify the amended hypotheses of the Contractive Map­ ping Principle we need to show that T maps V to V (y in V implies Ty is in V) and that ITy - Tzi < ply - zl for some p < 1 for y and z in V. We are free to take 6 and e- as small as needed to obtain these 576 Chapter 13 Implicit Functions, Curves, and Surfaces results. First we show that T satisfies the contraction property. Since Fy(x, y) is invertible, we can write Ty - Tz y - z + Fy(x, y) - I(F(x, z) - F(x, y)) = Fy(x, y)-1 [F(x, z) - F(x, y) - Fy(x, y) (z - y)]. Now the factor Fy(x, y) -1 is a fixed matrix, so if we can control the term in brackets it will only increase the value of p. The term in brackets looks very much like a comparison of F(x, z) with the best affine approximation to F at (x, y), the only difference being that we are evaluating Fy at the wrong point. However, Fy is continuous so that should not be too serious. Now if we were in one dimension we could use the mean value theo­ rem on F(x, z) - F(x, y), but in the general case we have to resort to a more technical argument involving the fundamental theorem of the cal­ culus applied to the line segment joining y and z. We parametrize this segment y + t(z - y) with 0 < t < 1 and consider the restriction h(t) = F(x, y + t(z - y)) of F to this line (x remains constant throughout) . Now F(x, z) - F(x, y) = h(1) - h(O) and h(1) - h(O) = f� h'(t) dt by the fundamental theorem, while h'(t) = Fy (x, y+ t(z -y))(z -y) by the chain rule. Altogether F(x, z) -F(x, y) = fol Fy(x, y+t(z -y))(z-y) dt, which enables us to compare it with Fy(x, y)(z - y) by writing F(x, z) - F(x, y) - Fy(x, y)(z - y) [ (Fy(z. y + t(z - y» - Fy(x. y»)(z - y) dt where we have used the linearity of matrix multiplication and the fact that f0 1 dt = 1 to bring Fy(x, ii) inside. Now we use the hypothesis that Fy is continuous. By taking c small enough we can make x close to X, and by taking 8 small enough we can make y and z close to y; hence, all points y + t(z - y) on the line segment joining them will be close to y. By doing this we can make Fy(x, y + t(z - y)) close to Fy(x, y), say IIFy(x, y + t(z - y)) - Fy(x, y)11 < ,X for any preassigned 'x. Thus I(Fy(x, y + t(z - y)) - Fy(x, y))(z - y) 1 < 'xlz - yl; 13. 1 The Implicit Function Theorem 577 hence, by (*) and Minkowski's inequality (see section 11.1.2) IF(z, z) - F(z, y) - Fy(x, ii)(z - y) l < l .\\lz - YI dt = .\\Iz - yl· So ITy - Tzl = IFy(x, y)-l [F(x, z) - F(x, y) -Fy(x, y) (z - y)] 1 < M.\\lz - YI where M = IIFy (x, y)-l ll is a fixed constant. Thus by choosing .\\ so that p = M'\\ < 1 and € and 8 accordingly we obtain the contractive estimate for T and V. The argument that T maps iT into V is quite similar. We need to show that for 8 small enough, Iy - yl < 8 implies ITy - yl < 8. Now Ty - Y y - y + Fy(x, y)-l (c - F(x, y)) = Fy(x, y)-l [F(x, y) - F(x, y) + Fy(x, y) (y - y)] since c = F(x, y). Again the terms in brackets resemble the comparison of F(x, y) with the best affine approximation to F at the point (x, y). We write it as [F(x, y) + Fx(x, y) (x - x) + Fy(x, y)(y - y) - F(x, y)] -Fx (x, y)(x - x). By the differentiability of F at (x, y) we can arrange to make IF(x, y) + Fx(x, y)(x - x) + Fy(x, y) (y - y) - F(x, y)1 < .\\(€ + 6) for any given .\\ by making € and 6 small enough, and the second term we estimate by IFx(x, y)(x - x) 1 < ce for c = IIFx (x, Y)II. Combining these we obtain ITy - iii < MIF(x, y) - F(x, y) + Fy(x, y) (y - y) 1 < M('\\(€ + 6) + ce) where M = IIFy(x, y)-l ll as before; and we can make this < 6 by first taking .\\ so that M'\\ < 1/2, fixing the required 6, and then choosing € so that M(.\\ + c)€ < 6/2. We have now completed the most difficult part of the proof. We have shown that there exist neighborhoods U of x and V of y such 578 Chapter 13 Implicit FUnctions, Curves, and Surfaces that T : 11 -+ V is a contractive mapping for each x in U (T depends on x) . Therefore F(x, y) = c for fixed x in U has a unique solution y(x) in V that is obtained algorithmically as the limit of iterating T on some initial first guess, say y, so y(x) = limk�oo Tky. All that remains is to show that y( x) is a C1 function and its differential is obtained by implicit differentiation of the identity F(x, y(x)) = c. We will obtain this information directly as a consequence of that identity and the differentiability of F. Now both F(x, y) = c and F(x, y(x)) = c, so F(x, y(x) ) - F(x, y) = O. On the other hand F is differentiable at (x, y), so o F(x, y(x) ) - F(x, y) Fx (x, y) (x - x) + Fy (x, y) (y(x) - y) + R(x) where R(x) = o(lx - xl + Iy(x) - Yl). We can then solve y(x) - y = - Fy (x , y) - l Fx (x, y) (x - x) - Fy (x, y)- l R(x). Notice that this will say that y( x) is differentiable at x with differential -Fy (x, y) -l Fx (x, y) once we show that Fy (x, y) - l R(x) = o(lx - x/ ) . This is not immediately apparent because our estimate for R( x) in­ volves Iy(x) - yl, but we can establish it in two steps. The first step is to prove the Lipschitz condition Iy( x) - yl < clx - xl for some constant c and x near X. For this we use ( *) and estimate Iy(x) - yl < IFy(x, y) -l Fx (x, y) (x - x) I + IFy(x, y)-l R(x) 1 < M1 lx - xl + M2 IR(x) 1 where Ml = IIFy(x, y)- l Fx (x, y) 1I and M2 = IIFy(x, y) -l ll are fixed constants. Then by taking x close enough to x we can make IR(x) 1 < (Ix - xl + Iy(x) - y/) /2M2, so 1 Iy(x) - yl < M1 lx - xl + 2 (lx - xl + I y(x) - y/). 13.1 The Implicit Function Theorem 579 We rearrange terms to obtain establishing the Lipschitz condition with constant c = 2Ml + 1. The sec­ ond step is then to argue that given any c > 0 we can make IFy(x, ii) - l . R(x) 1 < c lx - xl , since if x is close enough to x we can make IR(x) 1 < 8( lx - xl + Iy(x) - iiI), and then I Fy (x, ii) - l R(x) 1 < M2 IR(x) 1 < M28(lx - xl + Iy(x) - iiI) < M28( lx - xl + clx - xl) < M28(1 + c) lx - xl . Then we need only choose 8 so that M28(1 + c) = c. This completes the proof of the o( Ix - x I ) estimate for the remainder in ( *) , thus proving the differentiability of y( x) at x with the correct differential. Finally, we need to vary the point X. We have seen that the invert­ ibility of Fy (x, ii) implies that all nearby matrices are also invertible, so Fy (x, y(x) )- l exists for x near X. Thus the above argument can be repeated at x to show dy (x) = -Fy (x, y) -l Fx (x, y(x) ), so y( x) is differentiable and, hence, continuous. But this expression for dy(x) is clearly a continuous function. Thus y(x) is Cl . QED Notice that the formula for the differential shows that y is actually Ck if F is Ck • It can even be shown that y is analytic if F is analytic, although we will not do this here. The reader may be struck with the resemblance of the proof of the implicit function theorem and the proof of the existence and unique­ ness theorem for o.d.e. 's via Picard iteration. In a sense, the integral equation x(t) = x(to ) + rt G(s, x(s)) ds lto can be thought of as an infinite-dimensional implicit function equation. 580 Chapter 13 Implicit Functions, Curves, and Surfaces We can now complete the discussion of the exact o.d.e. M(z, y) Z + N(x, y) = 0 where M = Fy and N = Fx for some C1 function F(z, y). We saw that the o.d.e. was equivalent to the implicit equation F(z, y) = c. We can now apply the implicit function theorem to assert the local existence of solutions of the implicit equation provided Fy = M is non-zero. In other words, if M(zo, YO) 1= 0, then there exists a unique solution y(x) of the o.d.e. with y(xo) = Yo defined in a neighborhood of Xo. The condition M(xo, YO) 1= 0 is quite natural, for it means we can put the o.d.e. in normal form, dy N(x, y) - = -dx M(x, y) ' in a neighborhood of (xo, yo). 13. 1. 3 Exercises 1. Verify that if IIBA-1 11 < r < 1, then the series A- l L�o( _1)k. (B A -1) k converges at a rate that depends only on r. 2. Show that (A +B)-l -A-l = A-l L:�I (BA-l)k --+ 0 as B --+ O. 3. Write out the proof of the inverse function theorem by modifying the given proof of the implicit function theorem. 4. In the following examples, decide at which points (x, ii) the hy­ potheses of the implicit function theorem are satisfied: a. x4 + xy6 - 3y4 = C. { sin( x + yt} + y� = Cl , b. yr + xy� = C2. c. { yf + 3YlY2 = Xl , y� + 4yry� = X2· 5. Prove that the o.d.e. GJiYi + 1 +z2) Z + 2xy = 0 has unique local solutions with y(xo) = Yo for any Xo and YO. Does the existence and uniqueness theorem for o.d.e. 's apply? 19. � Curves and Surfaces 581 6. a. Prove that for every n x n matrix M sufficiently close to the identity matrix there exists a square-root matrix (solution of A 2 = M) and the solution is unique if A is required to be sufficiently close to the identity matrix. b. Compute the derivative of the square-root function M � A. c. Show that the binomial expansion can be used to compute A (write M = I + B and substitute B into the power series for v'l + x) for M sufficiently close to the identity. 1. a. Show that the autonomous o.d.e. y' = F{y) has a unique solution with initial condition y( to) = Yo in a neighborhood of to provided F is continuous and F(yo) i= O. (Hint: solve the o.d.e. that the inverse function satisfies.) b. *Let F : R � R be continuous, and let A = {y : F(y) = O}. Since A is closed, its complement can be written uniquely as a (finite or countable) disjoint union of open intervals U( aj, bj ) . Show that there exists a unique solution to y' = F(y) with any initial condition y(to) = Yo if and only if all the im- proper integrals r;j IF(y) l-l dy and f!:. IF(y)I-1 dy diverge, J J with mj the midpoint of the interval (if one of the inter- vals is unbounded, say (aj , 00 ), the condition should read Ja a!+l IF(y)I-1 dy = +00). J 13.2 Curves and Surfaces 13.2.1 Motivation and Examples We want to consider three ways to describe a subset A of Rn : 1. Parametrically, as the image of a function 9 : U � Rn where U is an open subset of Rm , A = g(U). The usual cartesian coordinates (tl ,' .. ,tm) = t in U give curvilinear coordinates for A. Usually the function 9 is assumed to be one-to-one. Frequently we can only describe part of the set A in this way, but we can describe all of A as a union A = Uj 9j (Uj) where each 9j : Uj � Rn is as above. It is natural to think of such sets A as being m-dimensional. 582 Chapter 13 Implicit Functions, Curves, and Surfaces 2. Implicitly, as the solution set of an equation or set of equations. That is, if F : �n -1- �k , A = {x : F(x) = a}. Here we expect k to be the co dimension of A (the difference between the dimensions of the ambient space �n and the subset A), so m = n - k should be the dimension. The domain of F may also be an open subset of �n . 3. As the graph of a function. We split the variables ( Xl , ... , xn) into two groups t = (tl ,\" \" tm ) and 8 = ( 81 , ... , 8k) , where m+k = n, consider a function f : �m -1- �k , and set A = {(t, 8) in �m+k : 8 = f(t) }. Again we may also allow the domain of f to be an open subset of �m . This is really a special case of part 1, since the t variables can serve as parameters, and g(t) = (t, f(t) ). In this case the function g is obviously one-to-one. We will loosely refer to the subsets A that can be described in one of the above manners as m-dimensional surfaces. When m = 1 we will use the term curve. We will give more precise definitions later. Our goal is to show that all three approaches yield the same class of surfaces. Also, we are interested only in smooth surfaces, so we will assume that all functions involved in the descriptions of A are CI . The graph-of­ function description is the simplest from this point of view, since we do not have to impose any further conditions on the function f. On the other hand, a graph-of-function description is not so easy to find. The main theorem in section 13. 2.3 says that a parametric description leads to a graph-of-function representation, while the main theorem in section 13.2.4 says that an implicit description also leads to a graph-of­ function representation. However, it is important to realize that both these theorems impose additional hypotheses on the defining functions. In fact, section 13.2.2 is devoted to explaining the condition we need to impose for parametric representations. Also, the theorems are local in nature; generally speaking, it is only the implicit representation that allows us to describe the whole surface at once. The intuitive idea is that a smooth m-dimensional surface is a set that has an m-dimensional tangent space at each point. Unfortunately, there is an ambiguity in how one should define the tangent space at a point x: it can be 1) the vector subspace passing through the origin 13.2 Curves and Surfaces 583 of all directions that are tangent to A at Xj or 2) the affine subspace passing through x lying tangent to A. The tangent space according to definition 2) is just the tangent space according to definition 1) translated by x so as to sit tangent to A. We will use definition 1), but from time to time we will indicate how to obtain the affine tangent space of definition 2). One thing to keep in mind is that with whatever description of A we start-parametric, implicit, or graph-of-function­ we will obtain the same kind of description of the tangent space. Now we look at some examples that reveal some of the difficulties with which we have to deal. 1 . The unit circle in ]R2 can be described implicitly as the solution set of x2 + y2 - 1 = O. We can describe it parametrically by the angular variable 8 and the function g(8) = (cos 8, sin 8) . Notice that we cannot find an open interval on which 9 is both one-to­ one and onto (we could take a half-open interval such as [0, 27r) , but this just hides the difficulties at the endpoint 0) . We can, however, cover the circle with two patches such that the param­ eter function 9 is one-to-one on each, say 9 : (0, 27r) -+ ]R2 and 9 : ( -1r /2, 1r /2) -? ]R2 , as indicated in Figure 13.2. 1. Figure 13.2. 1: Portions of the circle can be given as graphs of functions, x ±y'1 - y2 or y = ±J1 - x2 . 584 Chapter 13 Implicit Functions, Curves, and Surfaces 2. Next consider the solution set in R2 of the equation y3 - x2 = 0, as shown in Figure 13.2.2. This can be represented parametrically by g(t) = (t3, t2) or as the graph of y = x2/3• Figure 13.2.2: Notice that there appears to be a sharp cusp at the point (O, O) on the curve, even though the functions in the implicit and paramet­ ric representations are smooth. We will see that it is the vanishing of certain derivatives that is to be blamed for this. Notice that this problem is apparent in the representation as the graph of /(x) = x2/3 because /'(O) does not exist. 3. The unit sphere in r is given implicitly by the equation x2 + y2 + z2 - 1 = O. We can describe each of the six hemispheres as graphs of the functions x = ±v'1 - y2 - z2, Y = ±v'l - x2 - z2, z = ± v'1 - x2 - y2 . Another popular parametric representation is the spherical coordinates (latitude-longitude) (x, y, z) = (cos 9 sin </>, sin 9 sin </>, cos <1». 4. If we intersect the unit sphere in RJ with the x - y-plane, we obtain the unit circle in R2 again, but this time as a subset of r. Implicitly this means considering the pair of equations x2 + y2 + z2 - 1 = 0 and z = 0, or in other words, F{x, y, z) = 0 where F{x, y, z) = (x2 + y2 + z2 - 1, z) is a function from aa to R2 . Parametrically we can represent this circle by adding a zero 19.2 Curves and Surfaces 585 third coordinate to the a2 parametrization, g( 8) = (cos (}, sin (}, 0). We can also use the graph of (y, z) = (±Jl - x2, 0) or (x, z) = (±Jl - y2 , 0) to represent parts of the circle, but we cannot use a graph of a function of z. 5. As a final example consider the implicit equation xy = 0 in R2 , which defines the set consisting of the x-and y-axes. In a neigh­ borhood of the origin where the axes cross, it is impossible to describe this set parametrically in a one-to-one fashion, although we can write the set as a union of the axes, each represented as a graph of a function. These examples reveal some of the problems with which we are go­ ing to have to come to grips in creating a nice theory of surfaces. We can see from the start that we are going to have to describe surfaces locally and that there are really two distinct notions of \"local\" . In the more stringent notion, we take a neighborhood U of a point on the sur­ face in an and demand some property of the intersection of U with the surface-in other words we take a piece of the surface as it sits in an . In this sense the crossing of the axes in the last example cannot be cut apart. In the other, less stringent, sense of \"local\" , we ask only that the surface be a union of pieces with certain properties. In this sense the two axes are the union of axes, and each axis is well behaved. The first, stricter notion is the one we shall adopt, since we can obtain a nice re­ sult about implicitly defined surfaces with this concept. The technical name for the two concepts are embedded surfaces and immersed sur­ faces. Although we will not emphasize immersed surfaces, we should point out that they are important in topology and in some ways easier to study. For example, there is a famous theorem of Smale that says the unit sphere in a3 can be turned inside out-everted-by continuously deforming it through a sequence of immersed surfaces. It is intuitively clear that no such result would be possible using embedded surfaces. 13.2.2 Immersions and Embeddings The next problem with which we have to deal is the possibility of cusps or other non-smooth behavior of the surface. We want to deal with smooth surfaces, so we can use differential calculus, but the sec­ ond example shows that rough spots can develop even if the functions 586 Chapter 13 Implicit Functions, Curves, and Surfaces defining the surface are Cl. Of course we did notice that this problem doesn't seem to arise in the graph of function description. One way to evade the problem would be to make a definition in terms of the graph-of-function description: a Cl surface in an is a subset that is locally the graph of a Cl function. This approach seems overly restric­ tive, however. How do we know there aren't subsets of an that we would intuitively agree are smooth surfaces and yet cannot locally be expressed as a graph of a C1 function? Actually it turns out that there aren't any; but this should be a theorem, not part of the definition. For the definition we should only require some sort of local parametric representation. But not every Cl parametric representation will do, as the cusp example g(t) = (t3, t2) shows. So our problem becomes how to restrict parametric representations to ensure \"smoothness\" of the surface. To get a feel for the answer, let's look first at the simplest case: curves. The parameter is just a single variable t, which we can assume takes values in an open interval (a, b). Let 9 : (a, b) -+ an be Cl . If we think of g( t) as tracing out the curve in Rn with t as time, then g' (t) represents the velocity of the motion. It will be a vector that is tangent to the curve, as in Figure 13.2.3. If the curve has a g'(t) Figure 13.2.3: tangent, then it is smooth, so what can go wrong? In the example g(t) = (t3, t2), the thing that goes wrong is g'(O) = (0, 0). If the velocity vector vanishes, then we don't necessarily have a tangent to the curve and the curve may not be smooth.' Our interpretation of g' ( t) as velocity means that g'{to) = 0 is interpreted as saying the tracing comes to a stop at time to. In other words, you can draw a rough curve in smooth motions if the motion is allowed to stop. Therefore, the condition we want to impose is that g' is never zero. This is not 13.2 CUnJes and Surfaces 581 to say that g' (to) = 0 necessarily implies that the curve is not smooth at to. There are many different parametric representations of a curve, and we can always stop along a smooth curve to admire the view (for example, g(t) = (cos t3,sin t3) parameterizes the circle) . Nevertheless, it is plausible that if a curve is smooth we can move along it at a non-zero velocity in a smooth manner. Since we have seen that for a curve the condition we want to impose on 9 is the nonvanishing of the derivative, we might be tempted to guess that this is also the right condition in general. However, if we analyse the following simple \"fold singularity\" we will see that this is not strong enough. We simply take the cusp curve and add a dimension. The parameter space will have two variables t, 8; and the two-dimensional surface in Jt3 will be parametrized by g( t, 8) = (t3, t2, s) . Note that ( 3t2 0 ) dg(t, s) = � � is never zero. Nevertheless, the surface folds at t = 0 and so it is not smooth. The differential when t = 0 is and although it is not zero, it does appear less full of life than it might be. This gives us a good clue toward finding the condition we want. It is time to appeal once again to the basic principle of differential calculus: do unto the derivative what you would do unto the function. In this case we want the parametrizing function 9 to be one-to-one, so we should demand that the best affine approximation be one-to­ one. Clearly this doesn't depend on the constant term, but only on the linear part, the differential. The question is then whether matrix multiplication by dg is one-to-one. It is easy to see when m = 1 that this is the same as the non-vanishing of dg, but for m > 1 the question is more subtle. We need to recall some basic facts from the linear algebra. Let A denote an n x m matrix, so Ax is a linear transformation from am to an. The rank of A is defined to be the dimension of the 588 Chapter 13 Implicit Functions, Curves, and Surfaces image of A, which is the linear span of the columns of A. This is also equal to the dimension of the span of the rows of A and the size of the largest invertible square submatrix (a submatrix means we select certain rows and columns, not necessarily in any special order) . The kernel of A, also called the null-space, is the set of solutions of Ax = 0; and the linear function Ax is one-to-one if and only if the kernel is {o} . The basic formula dimension of domain = dimension of image + dimension of kernel means that Ax is one-to-one if and only if the rank of A is equal to the dimension of the domain, which we are calling m. This is the largest possible value for the rank, since there are only m columns. Note that if A is one-to-one we necessarily have m < n, for there are only n rows. The matrix has rank 1 and Ax is clearly not one-to-one, as The same is true of and we have We now want to consider those C1 functions 9 : U -+ lRn where U is an open subset of lRm such that dg(x} has rank m at every point x of U. Such functions are called immersions. We will insist that local parametrizations of C1 surfaces be given by immersions. As expect­ ed, immersions will be locally one-to-one; we will not prove this now since it will be a consequence of a later result. An immersion does not have to be globally one-to-one, as the familiar circle parametriza­ tion shows. We define an embedding to be an immersion that has two additional properties: 9 : U -+ lRn is one-to-one, and the inverse map 19.2 Curves and Surfaces 589 g-I : g(U) � Rm is continuous (here we are considering g(U) as a metric subspace of Rn ). The following pictures of immersions that are not embeddings (m = 1, n = 2) .... (------t) U u ) Figure 13.2.4: should illustrate the bad behavior we are trying to avoid. In Figure 13.2.4 the map on the left fails to be one-to-one at the cross point. The map on the right is one-to-one, but the inverse fails to be continuous at the touching point (the map is defined on an open interval, so the touching point is only covered once). However, the map in Figure 13.2.5 does give an embedding g (-----f) U Figure 13.2.5: because the touching point is no longer a point of g(U). If 9 : U � an is an embedding, we take the usual Euclidean coordi­ nates in U C Rm and carry them by 9 onto a set of coordinates for the image g(U). Fix a point i in U, and let y = g(i) be the corresponding point in the image g(U). If we fix all the coordinates of x except for one, say i2 , i3, ... , im, and vary ZI , then we obtain a straight line in U that gets mapped under 9 into a curve in g(U), 590 Chapter 13 Implicit Functions, Curves, and Surfaces passing through y. The tangent vector d/ ( _ ) 8g ( _ _ _ ) -d Xl = -8 XI , X2, ••• , Xm t Xl is non-zero because it is a column of dg. In fact, if we vary each of the coordinates Xk in turn, we get curves in g(U) with tangent vectors at y that are the different columns of dg(i) and, hence, are linearly independent. This is indicated in Figure 13.2.6. They span an m­ dimensional subspace of Rn that we will call the tangent space to g(U) at the point y. Notice that this gives a parametric description of the tangent space, namely all vectors Ek-l ck8g/8xle(i) for any choice of the parameters Cl , ••• , em . Figure 13.2.6: If h : (a, b) � U is any Cl curve passing through i, say h(c) = i, then goh : (a, b) � g(U) is a Cl curve in g(U) passing through y, goh(c) = y and the tangent vector m �g 0 h(c) = L dhk (c) 8g (i) dt Ie=l dt 8Xk is a linear combination of these vectors 8g/8xk(i) and, hence, belongs to the tangent space at ii. Thus the tangent space is composed of tangent vectors to curves lying in g(U) and passing through y. Also, because g-l : g(U) � Rm is continuous, any curve on g(U) passing through y is the image of a curve in U passing through i as above. 13. 2 Curves and Surfaces 591 13.2.3 Paramet ric Description of Surfaces Definition 13 .2.1 A C1 m-dimensional surface in jRn (with m < n) is a subset Mm of jRn such that for every point Y in Mm there exists a neighborhood V of Y in jRn and an embedding g : U -1- jRn for U open in jRm such that g(U) = V n Mm . We say Mm is of class Ck if each of the embeddings is of class Ck • Our definition thus says that Mn is locally parametrized by C1 embeddings. Next we want to show the fact hinted at before, that this implies that locally Mn is the graph of a C1 function. By this we mean that for each V there is a partition of the variables Y1 , ... , Yn into two groups, t1 , \" \" tm and 81 , ... , 8n-m, such that V n Mm = {(t, 8) : 8 = f(t) for t in U} where f : U -1- jRn-m is a C1 function. (Actually it may be necessary to decrease the size of the sets V for this to be true.) Note that this is a special case of an embedding, namely g(t) = (t, f(t)). Since the first m rows of dg are the m x m identity matrix, we have rank dg = m. Also 9 is clearly one-to-one, and the inverse is continuous because it is just the projection onto the t-variables. Theorem 13.2.1 Let 9 : U -1- jRn with U an open subset of jRm be a C1 immersion. Then for any point x in U there exists a neighborhood U of x such that 9 is one-to-one on U and g(U) is the graph of a C1 function. The theorem holds for all immersions and is local in the domain of g. However, if 9 is actually an embedding, then g(U) is a neighborhood of g( x) in g(U) and so the result is local on the surface. Thus the theorem shows that every surface is locally the graph of a function. Proof: The idea of the proof is to solve for Xl , ••• ,Xm (variables in the domain of g) as a function of some of the Y variables (in the range of g) t1 , ... , tm , using the inverse function theorem. Look at the matrix dg (x) . By assumption it has rank m, so among the n rows dgj(x), j = 1, . . . ,n , there are m linearly ind.ependent ones. The corresponding variables Yj may be taken as the t variables. The remaining n - m variables will then be the 8 variables. In other words, among all possible partitions of the Y variables we are allowed to choose any one for which the rows dgj (i) , corresponding to those variables Yj we have called 592 Chapter 13 Implicit FUnctions, Curves, and Surfaces t variables, are linearly independent (or equivalently, the sub matrix formed by taking the rows corresponding to t variables is invertible) . To simplify the notation we now assume that the first m variables YI , ... , Ym are the t variables-we can always arrange this by relabeling the variables. Now we use the inverse function theorem to solve for Xl , ... , Xm as a function of tl , . . . ,tm. Indeed we are given the equations which we can abbreviate t = h( x) where so dh(x) consists of the first m rows of dg(x) and, hence, is i�vertible. By the inverse function theorem there exists a neighborhood U of x on which h has a Cl i�verse h- l .:. V -t U �o that x = h-l (t) if and only if t = h(x) for x in U and t in V, wh�re V is an open set in the t space. This shows that 9 is one-to-one on U. Now the remaining equations which we can abbreviate as s = 4>( x) where ( gm+ . I(X) ) 4>(x) = : , gn (x ) allow us to write s = 4>(h-1 (t) ) = f(t) for f = 4> 0 h- I j and f is a composition of Cl functions and, hence, CI . Thus Y = g( x) for x in (; if and only if Y = (t, s) with t in iT and s = f(t) , so g(U) is a graph of f. QED 19.2 Curves and Surfaces Example 13.2.1 Consider (8) = ( c�s 8 ) = ( x ) 9 SIn () y ' an immersion of ]Rl into ]R2 , the image being the unit circle. Since d (8) = ( - sin 8 ) 9 cos 8 ' 593 we can solve for x as a function of y in a neighborhood of any point for which 8g2/8() = cos 8 :/; 0 and for y as a function of x in a neighborhood of any point for which Choosing a point 8g1 . 8 0 88 = - SIn i= . ( : ) = ( :::: ) on the circle with sin 80 i= 0 (hence Xo :/; ±1), we can first solve for 8 as a function of x, 8 = arccos x (choosing a branch of arccosine so that 80 = arccos xo ) and then y = sin( arccos x) gives part of the circle as the graph of a function (depending on the branch of arccosine, we have sin (arccos x) = ±v'1 - x2). Example 13.2.2 Consider the spherical coordinates map y = 9 q, ) = sin 8 sin q, , ( X ) ( 8 ( cos 8 sin 4> ) z cos 4> 9 : ]R2 -? ]R3 , with the image of 9 equal to the unit sphere. We compute ( - sin 8 sin 4> cos 8 cos 4> ) dg = cos 8 sin 4> sin 8 cos 4> • o - sin 4> When sin 4> = 0 the first column is zero and dg has rank 1, which is less than m = 2; so 9 is not an immersion. However, at all other points dg 594 Chapter 13 Implicit Functions, Curves, and Surfaces has rank 2, so 9 will be an immersion if we restrict it to any open set in (f), ¢) space for which sin 4> never vanishes, say the strip 0 < 4> < 1r. Then 9 wraps this strip around the sphere with the north and south poles removed (f) is the longitude and ¢ - 1r /2 the latitude) . Suppose we want to solve for z as a function of x and y on the sphere. We need to have the first two rows of dg linearly independent or ( - sin f) sin ¢ cos f) sin 4> ) cos f) sin ¢ sin () cos ¢ invertible. Since the determinant of this 2 x 2 matrix is - sin 4> cos 4>, we need cos ¢ i= G-in other words we have to stay away from the equator. Then we can solve x = cos f) sin 4>, y = sin f) sin 4> for f) and ¢j indeed x2 + y2 = sin2 4>, so ¢ = arcsin Jx2 + y2 , and y/x = tan f), so f) = arctan y / x, and then z = cos 4> = cos (arcsin J x2 + y2 ), which simplifies to z = ± J 1 - x2 - y2 depending on the hemisphere. In this case the graph-of-function extends to the north and south poles, which had to be excluded in the spherical coordinate description. At points on the equator (cos ¢ = 0) we have ( - sin () dg = co; f) so that we can solve for x as a function of y and z if cos f) i= 0 or we can solve for y as a function of x and z if sin f) i= O. In the first case we solve y = sin f) sin 4>, z = cos ¢ for f) and </>, and ¢ = arccos z, f) = arcsin (-J!--) = arcsin ( . y ) . sm 4> SIn arccos z Then x = cos f) sin ¢ = cos( arcsin (y / sin arccos z) ) sin( arccos z), which as we know must simplify to x = ±J1 - y2 - z2. The theorem shows that we could just as well have defined a C1 surface as a set that is locally the graph of a Cl function. However, it is preferable to have the greater flexibility of general embeddings 9 : U -? V n Mm . We call the subsets V n Mm of the surface coordinate 19.2 CUnJes and Surfaces 595 patches and the function 9- 1 : V n Mm -? U a local coordinate map since it assigns coordinates (the standard cartesian coordinates in U) to each point in the coordinate patch. The theorem asserts that if we take a small enough coordinate patch we can arrange for the coordinate map to be the projection onto m of the cartesian coordinates of Rn , or in other words we can obtain local coordinates on the surface by selecting m of the cartesian coordinates of Rn • It is interesting to compare two local coordinate maps on coordinate patches that overlap. Suppose Vi n Mm and V2 n Mm are two patches for which VI n V2 n Mm is non-empty, as indicated in Figure 13.2.7. On the overlap we have two coordinate maps, g'1 1 and g; l , and let (It and U2 be the images of the overlap in U1 and U2 . Then the maps 1 - - 1 - -9i 0 91 : U1 -? U2 and g'1 0 g2 : U2 -? Ul Figure 13.2.7: tell us how to change from one coordinate system to another. We claim these functions are CI . This is not obvious because 91 1 and 92 1 are not defined on an open subset of Rn . However, if 92 happens to be one of the special graph-of-function embeddings, then gi l is just the projection onto some of the coordinates, so 9i 1 0 gl is Cl and then g'1 1 0 g2 = (gil 0 91 ) -1 is C1 by the inverse function theorem. Since by the theorem we can always interpose a third coordinate patch of this special form, it follows that these functions are C1 in general. We 596 Chapter 13 Implicit Functions, Curves, and Surfaces can interpret this as saying that, despite the non-uniqueness of the local parametric representations, any two local parametric representations of the same portion of the surface differ only by a C1 change of variable in the parameters. Recall that an embedding 9 : U -1- ]Rn allows us to define a tangent space to the image g(U) at any point. We want similarly to define the tangent space to a C1 surface at a point to be the tangent space given by one of the local embeddings 9 : U -1- V n Mm. In order for this to make sense we must verify that we get the same tangent space in the overlap of coordinate patches. We do this by giving a characterization of the tangent space T Mm (y) for y a point in Mm as the set of all tangent vectors to C1 curves lying in Mm at the point y. This characterization is intrinsic in the sense that it does not refer to any coordinate patch. We will show that the two definitions coincide: the set of tangent vectors to C1 curves in Mm at y is equal to the span of 8gj8xk (X) , k = 1, . . . m, where g: U -1- VnMm is a local embedding and g(x) = y. Recall that every C1 curve passing through y that is obtained by composing a C1 curve f(t) in U with the map 9 has tangent vector d � dfk 8g -g 0 f(t) = � ---(x) dt dt 8Xk k=l that lies in this span, and clearly we get every vector in the span in this way for appropriate straight lines f (t) . What remains to be seen is that every C1 curve in the patch V n Mm is actually obtained in this way. But if h(t) is any C1 curve in the patch, we look at f(t) = g- l 0 h(t), which is clearly a curve in U with go f(t) = h(t), as indicated in Figure 13. 2.8. We need to show that f is in fact C1 . But this is obvious if the coordinate map g- l is a projection onto Euclidean coordinates, and it follows in general by the above observation that all changes of coordinates are C1 • This completes the proof of the equivalence of the two definitions of tangent space. D sing the local coordinate maps we can transfer much of the differ­ ential calculus in ]Rm to the surface Mm . A function f defined on Mm (say taking real values) is said to be C1 if the coordinate version fog is C1 for every coordinate patch. Questions about f can be pulled back 13. 2 Curves and Sur/aces 597 u g Figure 13.2.8: to /0 g, which is an ordinary C1 function. It is obvious that if / is the restriction of a C1 function on jRn to Mm , then / is C1 , say / = FIMm, and then /0 9 = Fog, the composition of two C1 functions. However, there are many instances when functions are defined on surfaces Mm without any obvious extension to jRn (it can be shown that such ex­ tensions must exist locally) . We can similarly define what is meant by C1 functions from one surface Mm to another surface, M:n,; and it is possible to show that the differential df (y) can be sensibly defined as a linear transformation from the tangent space T Mm (y) to the tangent space T M:n, (/ (y)), but we will not go into the details of this. 13.2. 4 Implicit Description of Surfaces We have seen now some of the significance and versatility of the concept of C1 surface from the point of view of parametric and graph-of-function descriptions. We now want to understand how C1 surfaces may be given implicit descriptions as the solution set of F(x) = O. Here F(x) = ( F(x) ) Fn-� (x ) is a C1 functi�n from jRn to jRn-m , and we can think of the sets {x : F(x) = c} as the level sets of F. Suppose for a moment that we knew that one of these level sets, say Mm = {x : F(x) = O}, were a C1 m­ dimensional surface. Then if x(t) is any curve lying in Mm we have Fj (x (t)) - 0, so 598 Chapter 13 Implicit Functions, Curves, and Surfaces in other words the gradient of Fj is perpendicular to the tangent vector dx/dt for j = 1, ... , m - n. Since this is true for any curve in Mm , it follows that VFj(x) is perpendicular to the tangent space TMm (x). We call the subspace of all vectors in Rn that are perpendicular to T Mm (x) the normal space at x, denoted NMm(x). It is clear from linear algebra that the normal space has dimension n - m and TMm (x) is the space of all vectors perpendicular to NMm (x). Thus the normal and tangent spaces determine one another. We have observed that if a Cl m-dimensional surface is given im­ plicitly by F( x) = 0, then the gradients V Fj (x) give us n - m vectors in the normal space N Mm (x). Since the normal space has dimension n - m, it would be especially convenient if these gradients V Fj (x) were linearly independent because then they would span the normal space and hence determine the tangent space. Since these gradients are the rows of dF(x), the condition that they be linearly independent is the same as saying rank dF( x) = n - m (notice that n - m is the maximal rank possible for an (n - m) x n matrix). If F was actually a linear transformation, then Mm would equal the tangent space, so this con­ dition would be necessary and sufficient for Mm to be m-dimensional. Thus we expect that this condition should imply in general that the level set should be a Cl m-dimensional surface, and the proof should involve the implicit function theorem. Theorem 13.2.2 Let F : Rn � Rn-m be a C1 /unction, and suppose dF(x) has rank n - m at every point on a level set {x : F(x) = c}. Then this level set is a Cl m-dimensional surface. Proof: Let x be a point on the level set. Since we are assuming dF(x) has rank n - m, we can find n - m variables Xj such that the columns 8F/8xj (x) are linearly independent. Call these the 8 variables and the remaining variables the t variables. We want to show that in a neighborhood V of x the level set is the graph of a C1 function, V n {x : F(x) = c} = ((t, 8) : 8 = f(t) for t in U} for a Cl function f : U � Rn-m , U an open set in Rm . For simplicity we assume the first m variables Xl, ••• , xm are the t variables. We write the equation of the level set F( t, 8) = c. The condition on the linear independence of the vectors 8F / 88j says that the (n - m) x (n - m) 13.2 Curves and Surfaces 599 matrix Fs is invertible, so we can apply the implicit function theorem to solve for 8 = f (t) as desired. QED For example, the unit sphere in RJ is given implicitly by x2 + y2 + z2 = 1. Here F(x, y, z) = x2 + y2 + z2 and dF(x, y, z} = (2x, 2y, 2z) has rank 1 provided (x, y, z) # (0, 0, 0) . Thus by the theorem all the spheres x2 + y2 + z2 = c for c > 0 are C1 two-dimensional surfaces. The theorem does not apply to the level set F(x, y, z) = 0, which is in fact not a two-dimensional surface. If we intersect the sphere with the x-y-plane, we are looking at the pair of equations x2 + y2 + z2 = 1 and z = 0, which can be written Then ( 1 ) ( x2 + y2 + z2 ) F(x, y, z) = 0 for F(x, y, z) = z . dF = ( 2X 2y 2Z ) 001 ' which has rank 2 provided either x # 0 or y # O. We can check that no point of the form (0, 0, z) occurs on the given level set, so the theorem asserts it is a one-dimensional surface. In fact we know it is a circle. The implicit representation is very convenient because with it we can describe the whole surface at once, whereas with the other rep­ resentations we usually can only describe it in pieces. Also the im­ plicit description allows us to compute easily the normal space and, hence, the tangent space at each point. For example, for the sphere x2 + y2 + z2 = 1, the vector (2xo, 2yo, 2zo) is normal at the point (xo, Yo, zo); hence, the tangent plane at that point is given by the e­ quation 2xox + 2yoY + 2zoz = O. Notice that by giving the tangent space as the orthogonal complement to the normal space we are giving an implicit description: the tangent space at x consists of all vectors v that satisfy the equations v . V Fj (x) = 0, j = 1, . .. , n - m. There is a more abstract concept, called manifold, which is essen­ tially a surface that is not described as a subset of a Euclidean space. Roughly speaking, a C1 m-dimensional manifold Mm is a metric space that is covered by coordinate patches Vi on which coordinate map­ s hj : Vi --+ Uj are defined, where Uj are open subsets of Euclidean space. The condition for differentiability takes the form of an assump­ tion that on overlapping patches the change of coordinates functions 600 Chapter 13 Implicit Functions, Curves, and Surfaces must be C1 • We will not go into the details here. There is a theorem to the effect that every Cl manifold can be realized as a Cl surface in a Euclidean space of sufficiently high dimension, so we don't get any new objects by considering manifolds rather than surfaces. Neverthless, we do gain a more intrinsic and flexible point of view by doing so. 13.2.5 Exercises 1. Decide which of the following maps are immersions, and for those that are decide which variables can be taken to be the independent variable ( s} in the description of the image locally as a graph of a function: a. g(t) = (cos t, sint, t) tin KI , b. g(t, s} = (cost,sin t, s) (t, s) in R2 , c. g( t, s) = (s cos t, s sin t, s) (t, 8) in R2 , d. g(t, s) = (s cost,s sin t, s) s> 1, t in RI . 2. For which values of the constants do the following implicit equa­ tions define a CI surface? For those that do, decide which vari­ ables can be taken to be the independent variables in the descrip­ tion of the surface locally as a graph of a function: a. x2 + y2 - z2 = C; b. x2 + y2 + z2 = CI, x2 + y2 - z2 = C2; c. xyz = c. 3. For each of the surfaces in exercise 2, compute the normal space and tangent space at each point. 4. Let I : Mm � R be a C1 function, where Mm � Rn is a C1 surface. Prove that every point in Mm lies in a neighborhood U such that there exists a C1 function F : U � R that extends I, i.e., F(y) = I(Y) for y in Mm n U. (Hint: use graph of function representation. ) 5. For each point (i, y, i) on the unit sphere x2 + y2 + z2 = 1 and each vector v = (Vb V2, V3) in the tangent space to the sphere at (i, y, i), construct a CI curve lying in the sphere whose tangent vector at the point (i, jj, i) is (VI , V2, V3). 19.2 CUnJes and Surfaces 601 6. Show that the set of m x n matrices of rank m (with n > m) is an open set in the space of matrices Rmxn . 7. Let M2 be any C1 two-dimensional surface in Jt3 that is compact. Show that for every two-dimensional vector space V in Jt3, there exists a point x on M2 whose tangent space equals V. (Hint: if u is a vector perpendicular to V, what happens at points on M2 where x' u achieves a maximum or minimum?) 8. Let M2 be the surface of revolution in Jt3 obtained by rotating a circle in the x-z-plane, that does not intersect the z-axis, about the z-axis. Show that M2 is a C1 two-dimensional surface, and compute its tangent space at any point (Note: this surface is called a torus.) 9. Show that the Cartesian product Mml x Mm2 of two C1 surfaces of dimensions ml and m2 in anI and Rn2 is a C1 surface of dimension ml + m2 in Rnl +n2. Express the tangent space of Mml x Mm2 at a point (x, y) in terms of the tangent space of Mml at x and the tangent space of Mm2 at y. 10. Show that the equation xr +x�+ ... +x� = 1 defines a C1 (n-1)­ dimensional surface in an (called the unit sphere). Compute its tangent space at every point. 11. *Show that the orthogonal n x n matrices form a C1 surface of dimension n(n - 1)/2 in an2 • 12. Show that the n x n matrices with determinant equal to one form a C1 surface of dimension n 2 - 1 in Rn 2 • 13. Let Mm be a C1 m-dimensional surface in Rn . Let T Mm be the set of points in a2n of the form (x, y) with x in Mm and y in the tangent space to Mm at x. (This is called the tangent bundle of Mm.) Prove that T Mm is a C1 2m-dimensional surface in R2n . 602 Chapter 13 Implicit Functions, Curves, and Surfaces 13.3 Maxima and Minima on Surfaces 13.3.1 Lagrange Multipliers As an application of the material in section 13.2 .4, we consider the problem of determining the local maxima and minima of a C1 func­ tion f defined on a C1 surface Mm C lRn . Given a local parametric representation 9 : U --t lRn with U an open set in lRm , we can find all local maxima and minima on g(U) by finding the local maxima and minima of fo g on U. This reduces the problem to one we have already solved. However, the procedure is often awkward and long, especially if we have to consider several local parametric representations to cover the surface or if the expressions for the functions 9 are complicated. There is an alternate method, called Lagrange multipliers, that works in the situation where the surface is given implicitly and the function f is the restriction to the surface of a function defined on lRn (or at least a neighborhood of Mm in lRn ). Whenever these condi­ tions are fulfilled, the method of Lagrange multipliers is almost always simpler and more direct. Frequently problems solved by Lagrange mul­ tipliers are stated in terms of constraints: maximize f (x) defined on lRn subject to the constraints G(x) = o. We recognize that the constraint equation restricts x to the surface G(x) = 0, and in fact the hypotheses on the constraint equation will be exactly what we needed to conclude that the solution set of G(x) = 0 is a C1 surface. The method can be described very elegantly. We assume f and G are C1 functions, and we write where Gj (x) are real-valued C1 functions. We form the function H(x, A) of n + k variables H(x, A) = f(x) + A1 G1 (X) + ... + AkGk (X) and find all critical points of H (points where VH(x, A) = 0) . Then the local maxima and minima of f(x) on G(x) = 0 must occur at the x values of these critical points. The A values are discarded. The method also finds some values of x that are neither maxima nor minima. Why does the method work? We can break the n + k equations V H = 0 into two groups, namely the x-derivatives and the A-derivatives. 13.3 Maxima and Minima Surfaces 603 The A-derivatives yield Gl (x) = 0, G2 (X) = 0, . .. , Gk (X) = 0, which are the constraint equations, so every solution of V H (x , A) = 0 automati­ cally satisfies the constraint equations. The x-derivatives yield al k aGr -a . (x) = - L .\\r-a . (x), j = 1, . . . ,n, xJ r=l xJ which we can abbreviate as k V I(x) = - L Ar VGr(x). r=l This equation says that V I lies in the span of the gradients of the functions Gr (x), or in other words in the normal space to the surface G( x) = 0, provided we assume these gradients are linearly indepen­ dent. This means the components of the gradient of I are zero in the tangential directions, which is what we expect if I has a maximum or minimum on the surface. Theorem 13.3. 1 (Lagrange Multipliers) Let I : Rn -t R and G : an -t Rk be C1 /unctions, and let x be a point where G(x) = 0 and such that dG(x) has rank k. III(x) is a local maximum or minimum lor I on {x : G ( x) = O}, meaning there exists a neighborhood U 01 x in Rn such that I (x) > I (x) (or I (x) < I (x)) lor all x in U n {x : G (x) = O}, then there exists � in Rk such that H(x, A) = I(x) + A • G(x) has a critical point at (x, �) . Proof: The condition rank dG(x) = k implies that the level set G(x) = 0 is a C1 surface (dimension m = n - k) in a n�ighborhood of x, and since the result is purely local, we can disregard what happens away from X. We have seen that V ..\\H(x, �) = 0 just says G(x) = 0, so it remains to show V xH(x, X) = 0 for some X. Now consider any C1 curve h(t) lying in the surface G(x) = 0 passing through z, say h(to) = z. Then f 0 h( t) is a C1 function (the composition of C1 functions) with a local maximum or minimum at to. Hence (d/dt)/o h(to) = 0 by the one-dimensional theorem. But (d/dt)1 0 h(to) = V I(x) . h'(to), so V f(x) is perpendicular to the tangent vector h'(to) to the curve. By varying the curves we see that V I (x) is perpendicular to the tangent space of the surface at x; hence, V/(x) lies in the normal space. But we 604 Chapter 13 Implicit Functions, Curves, and Surfaces know that the normal space is spanned by VG1 (X) , ... , VGk (x); hence, V!(x) = -X . VG(x) for some X in ]Rk and this says V xH(x, X) = o. QED If the rank condition on G is not satisfied, the method may not work. For example, consider G(x , y) = y3 - x2 in ]R2 , which gives a curve with a cusp at the origin, as shown in Figure 13.3.1. Figure 13.3. 1: Clearly the function ! (x, y) = y assumes a minimum at the origin, but V/(O, O) = ( � ) is not a linear multiple of dG(O, O) = ( � ) . Thus in using the method of Lagrange multipliers, you must also search for maxima and minima among the points where rank dG < k. Fortu­ nately these are usually either isolated points or themselves surfaces of lower dimension to which the method may be applied anew. The method is also useful for finding maxima and minima of func­ tions over regions given by inequalities-for interior points use the usual V! = 0 test, and for boundary points use Lagrange multipliers. 13.3 Maxima and Minima Surfaces 605 For example, suppose we want to find the maximum and minimum values of I{x, y) = x2 _y2 on the unit disk x2 +y2 < 1. We first observe that V/(z, u) = ( _!: ) vanishes only at the origin (0, 0), so this is the only possible point in the interior. On the boundary x2 +y2 -1 = 0 we solve VH(x, y, '\\) = 0 for H(x, y, ,\\) = x2 - y2 + '\\(x2 + y2 - 1), obtaining the equations 2x + 2x,\\ = 0, -2y + 2y'\\ = 0, x2 + y2 - 1 = O. From the first equation we obtain x = 0 or ,\\ = -1 and from the second y = 0 or ,\\ = 1, so all solutions (x, y, .\\) are (0, ±1, 1), (±1, 0, -1). Discarding the ,\\ values we have the four points (± 1, 0) and (0, ±1). Finally we evaluate 1 at the five possible points and find that (±1, 0) are maxima and (0, ±1) are minima, but (0, 0) is neither. As another example we consider the problem of maximizing and minimizing I(x, y) = x + y on the lemniscate (x2 - y2 )2 = x2 + y2. Forming H(x, y, '\\) = x+y+'\\((x2 _y2 )2 _x2 _y2) and setting VH = 0 we obtain the equations 1 + '\\(4x(x2 - y2) - 2x) = 0, 1 + ,\\( -4y(x2 - y2) - 2y) = 0, (x2 _ y2)2 = x2 + y2. Subtracting the first two equations we obtain Since ,\\ # 0 by the first equation, we obtain either x = y = 0 or 4{x + y)2 - 2 = 0 and, hence, x + y = ±1/v'2. The points on the lemniscate where x + y = ±1/.J2 give the maximum and minimum values of x + y, since 1(0, 0) = 0 and (0, 0) , is the only point at which the gradient of (x2 - y2)2 - x2 - y2 vanishes. 13.3.2 A Second Derivative Test· It is possible to give a second derivative test to distinguish between maxima, minima, and saddle points. Suppose x is a point where 606 Chapter 13 Implicit Functions, Curves, and Surfaces V H{x, �) = 0 and dG{x) has rank k. As in the proof of the theo­ rem let h{t) be a C2 curve lying in the level set G{x) = 0 passing through X, h{to) = X. We assume that 1 and G are also C2• We want to compute the second derivative tP /dt2{1 0 h) at to. This is t t a: 2£z/ (x)hj (to)h;(to)+ t :! (x)hj(to). j=1 1=1 J j=1 J Now we want to eliminate h\" from this expression. We can do this by observing that Gr {h(t)) = 0, so (tP /dt2)Gr{h{to)) = 0 for r = 1, ... , k. Thus n n 2G n 8G L L a: a�/ (x)hj (to)hHto)+ L ax r (x)hj(to) = O. j=1 1=1 J j=1 J Now recall that we have 81/8xj (x) = - \"£:=1 )..r8Gr /8Xj (x), so if we multiply each of the equations ( **) by )..r and sum we obtain � 81 (x)h\"(to) L.J ax · j=l J Finally we can substitute this back into ( *) to obtain with the obvious abbreviations. This may seem like a messy expression, but it is easy to interpret. Remember that h{t) is just a curve lying in the surface passing through x at t = to, so h'{to) is just an arbitrary vector in the tangent space to the surface at X. Thus the signs of the second derivatives of 1 along curves in the surface through x are given by the quadratic form associated to the matrix cP f(x) + ).. . cPG{x) restricted to the tangent space at x. Notice that the situation has changed in two ways from the unconstrained problem: first, we restrict 13. 3 Maxima and Minima Surfaces 607 attention to the tangent space to the surface at x; second, we \"correct\" the Hessian cP /(x) by adding the term .\\. d2G(x). Here .\\ is the vector given by the equation d/(x) + X· dG(x) = O. Also the tangent space at x is the set of vectors u in Rn such that dG(x)u = O. Thus everything we need is computable from G. Now if / has a local maximum (or minimum) at x, then (cP /dt2 )/ 0 h(to) is always < 0 (or > 0), so (d2/(x) + X . d2G(x))u, u) < 0 (or > 0) for all u such that dG(x)u = 0 is a necessary condition for a maxi­ mum (or minimum). If we have strict inequality, then we have a local maximum (or minimum )-this requires an additional argument similar to the one in the unconstrained case to show that there is a neigh­ borhood of x on the surface (as opposed to a union of neighborhoods on the curves passing through x) such that I (x) is the maximum (or minimum). Let's look at some examples. The parabolas y = ±x2 shown in Fig­ ure 13.3.2 have the same tangent space at the origin, but the function I (x, y) = y has a maximum on one and a minimum on the other. Figure 13.3.2: Taking G(x, y) = y ± x2 and applying the method of Lagrange mul­ tipliers we set H(x, y, ,x) = y + ,x(y ± x2). From V H(x, y, ,x) = 0 we 608 Chapter 13 Implicit Functions, Curves, and Surfaces get ±2XA = 0, 1 + A = 0, y ± x2 = 0, which has the unique solution (x, y) = (0, 0) and A = -1. Now we compute the matrix If /+ �lfG = ( � n + � ( ±� n and so for A = -1 this is ( =F2 0 ) o 0 . Now the tangent space at (0, 0) is the x-axis (given by (u, v) ·VG(x, y) = ±2xu + v = 0, which for (x, y) = 0 gives v = 0). Restricting the matrix ( 'F� n to vectors of the form (n gives ( ( 'F� �) ( � ) , ( � ) ) = 'F2u2 , so we have a maximum in the first case (lower parabola) and a minimum in the second case. For another example, consider the function I(x, y, z) = x - y on the unit sphere :1:2 + y2 + z2 - 1 = o. Then we find from V H = 0 that 1 + 2AX = 0, -1 + 2AY = 0, 2AZ = 0, x2 + y2 + z2 = 1, which has the two solutions (x, y, z, �) = (�, -� ,o, -�) and - (-�, �,o, �) . The matrix tP f + AtPG is � ( � � D ' 19. 9 Maxima and Minima Surfaces 609 which is negative definite on all of RJ in the first case (.\\ = -V2/2) and positive definite in the second (.\\ = V2/2). It follows that it is negative and positive definite when restricted to the tangent space of the sphere at the appropriate points, so we have a maximum and a minimum at the points (V2/2, -V2/2, 0) and (-V2/2, V2/2, 0). 13.3.3 Exercises 1. Let Mm be a C1 surface in Rn , and let y be a point in Rn not on Mm. If X is a point on Mm that minimizes or maximizes the distance to y, prove that the line joining x and y is perpendicular to the surface at x (i.e., perpendicular to the tangent space at x). (Hint: it is easier to consider the square of the distance.) 2. If Mm and M:n, are two disjoint C1 surfaces in ]in and if x in Mm and y in M:n, minimize or maximize the distance apart, prove that the line joining them is perpendicular to both surfaces at the i:1tersections. 3. Let Mm be a C1 surface in Rn that is compact (as a metric sub­ space of Rn ). Prove that there exist a pair of points x and y in Mm that maximize the distance among all such pairs and that the diameter joining them intersects the surface perpendicularly at both points. 4. Use the method of Lagrange multipliers to locate possible local maxima and minima of the function f subject to the conditions G = 0 in the following: a. f(x, y, z) = x2 + 4y2 - z2, G(x, y, z) = x2 + y2 + z2 - 1. b. f (x, y, z) = zx + 2y, G1 (x, y, z) = x2 + y2 + 2z2 - 1, G2 (x, y, z) = x2 + y + z. (Set up the equations to be solved.) c. f(x, y, z) = x2 + y2 + z2,G(x, y, z) = x2 + 4y2 - 2z2 -1 . 5. Apply the second derivative test to each of the critical points found in exercise 4. 6. Set up the equations for the maximum and minimum values of f(x , y) = x3 - 3yx + y on the unit disk x2 + y2 < 1. 610 Chapter 13 Implicit FUnctions, Curves, and Surfaces 7. Show that the entropy - 2:7=1 Xj log Xj is maximized subject to the constraints 2:7=1 Xj = 1 and all Xj > 0, at the point (lin, lin, ... , l/n) . 13.4 Arc Lengt h 13. 4.1 Rectifiable Curves Let g : [a, b] --+ ]Rn be a continuous curve in ]Rn . We want to talk about its length. The idea is very simple. If the curve consisted of broken s­ traight line segments, we would simply add the lengths of the segments, measuring the length of a straight line segment by the Pythagorean distance from one endpoint to the other. For a general curve we can approximate the length by choosing a sequence of points lying along the curve and connecting them in order by straight line segments. Since we believe that the shortest distance between two points is a straight line, the length of the approximating broken line curve should be an underapproximation to the length of the curve, as in Figure 13.4. 1. Figure 13.4. 1: We can think of this approximation in practical terms as the result of hammering nails along a curve and pulling a string taut between the nails and measuring the length of the string. As we increase the number 13.4 Arc Length 611 of points along the curve, the length of the approximating broken line curves will increase (by the triangle inequality), and we expect the limit to be the length of the original curve. Because the lengths are increasing we can replace the limit with a sup. Definition 13.4.1 The length of a continuous curve 9 : [a, b] ---* }Rn is the sup of �f=o Ig(tj+l ) - g(tj)1 taken over all partitions a = to < tl < ... < tN = b of the interval [a, b] , where Ig(tj +l ) -g(tj)1 is the distance between the points g(tj +l ) and g(tj ) in }Rn . If the length is finite, we say the curve is rectifiable. If a curve is rectifiable, then the length can be obtained as a limit of �f=o Ig(tj+ l ) - g(tj)1 along a sequence of partitions; and since adding points to the partition only increases the value of the sum, we can assume that the maximum of tj+ 1 - tj goes to zero. Conversely, if for one sequence of partitions with the maximum of tj+ 1 - tj going to zero the limit of N L Ig(tj+ l ) - g(tj)1 j=O exists and is finite, then the curve is rectifiable and the limit is the length. This is not immediately obvious from the definition but requires a proof. The idea is to use the uniform continuity of 9 to add points to the partition without appreciably increasing the sum. Suppose PI , P2 , ... is the sequence of partitions of [a, b] , and denote by L(Pk) the sum �f=o Ig(tj+l ) - g(tj)1 for the partition Pk . (The number of points increases with the partition, so strictly speaking we should write Nk rather than N. ) Since each L(Pk) < L where L denotes the length of the curve, we have limk_oo L(Pk ) < L and so it suffices to prove the reverse inequality. Since L is defined to be the sup of L( Q) over all partitions Q, we need to show that for every Q and € > 0 the inequality L( Q) < L(Pk ) + € holds for all sufficiently large k; for then L( Q) < limk_oo L(Pk ) + €, hence L < limk_oo L(Pk) + € and, hence, L < limk_oo L(Pk). To do this we will throw the points of Q into the partition Pk-call the resulting partition Q U Pk (we have to rearrange the points in their correct order and discard repeats, of course). Then L( Q) < L( Q U Pk), so it suffices to show L( Q U Pk ) < L(Pk ) + € for all sufficiently large k. 612 Chapter 13 Implicit Functions, Curves, and Surfaces We have L(Pk) < L( Q u Pk), but to obtain the reverse inequality L(Q U Pk) < L(Pk) + c we will have to reason carefully. Let N denote the number of points in Q. This number remains fixed, while by varying k we can make the points in Pk increase indefinitely, with the distance between them very small. Let 8 denote a point in Q. If s is not in Pk, then it will fall between two points tj and tj+l of Pk. Thus the sum L (Q U Pk) will contain in place of Ig(tj+d - g(tj)l in L(Pk)' (To avoid technicalities we assume that k is taken large enough so that at most one point of Q lies in each interval [tj , tj+l]. This is possible because the lengths of these intervals are going to zero.) For intervals [tj , tj+l] of Pk containing no points of Q the same Ig(tj+d - g(tj)1 will occur in both L(Pk) and L(Q U Pk) sums. Thus we have an estimate L(Q U Pk) < L(Pk) + N8 where 8 is any upper bound for with s in [tj , tj+I]. By the uniform continuity of 9 (it is a continuous function on a compact interval) we can make 8 as small as we like, say 6 < c/N, by making all the intervals [tj, tj+l] sufficiently small, and we do this by taking k large enough. Then L(Q U Pk) < L(Pk) + c and we have limk_oo L ( Pk) = L as claimed. Incidentally, this argument also shows that limk_oo L(Pk) = L along any sequence of partitions PI , P2, ... , such that the maximum length of subintervals goes to zero. The situation is analogous to that of the Riemann integral. It is important to observe that the length of a curve is a property of the subset g([a, b]) of an and its ordering and not on the particular parametrization given by the function g. This is simplest to state if 9 is assumed to be one-to-one. If h : [c, d] --+ [a, b] is a continuous function that is one-to-one and onto, then go h : [c, d] --+ an is another one-to-one parametrization of the same subset of ]in . Since h being one-to-one implies that h is either increasing or decreasing, the order of points along 9 0 h is either the same or the reverse of the order along g, so the lengths L(P) for partitions of 9 and go h are in one-to-one correspondence and so the lengths of the curves 9 and goh are the same. It is possible to show further that any other one-to-one continuous 13.4 Arc Length 613 parametrization gl : [c, d] -+ ]Rn of the same set, gl ([c, d] ) = g( [a, b] ), must be of the form gl = 9 0 h (see exercises) . Thus for simple curves, those that have a one-to-one parametrization, the length is independent of the parametric representation. For curves that intersect themselves in complicated ways, the situation is more complicated and we will not attempt to describe it . There is, however, one case that is especially easy and important. Suppose 9 : [a, b] -+ ]Rn with g(a) = g(b) but otherwise g(s) '# g(t) for s,# t in [a, b] , as in Figure 13.4. 2. The image g([a, b)] is called a simple closed curve. For these it is again g(a) = g(b) Figure 13.4.2: true that the length is independent of the parametric representation, even of the point g(a) = g(b) on the curve. It is easy enough to give examples of reasonable curves that are not rectifiable. For example, Figure 13.4.3 shows the graph of y = x sin 1/x on [0, 1] , given by the parametric representation g(t) = (t, t sin lit) for t in [0, 1] . Note that limt_O t sin lit = 0, so 9 is continuous and, in fact, 9 is differentiable at every point of the interior although not at zero. However, if we take the partition points tk = 2Ik1r, k = 1, . . . , N, then sin 1/tk = ° for k even and ±1 for k odd; hence, and so the length is infinite. \"'\" . 1 . 1 > � tk+1 SIll-- - tk S10- tk+1 tk 2 2 L Itk l = 2 L k1r = +00 kodd kodd 614 Chapter 13 Implicit Functions, Curves, and Surfaces Figure 13.4.3: 13.4.2 The Integral Formula for Arc Length Next, we would like to derive the familar calculus formula for the length of a curve under the assumption that 9 : [a, b) -? lRn is CI . Actually, it suffices to have 9 piecewise C1 , which is quite handy for applications. Theorem 13.4.1 Let g : [a, b] -? lRn be a continuous curve, and as­ sume that there exists a finite partition a = to < tl < .. . < tN = b of [a, b] such that g' (t) exists and is continuous on [tj , tj+l] (at the endpoints this means one-sided derivatives) for each j = 0, .. . , N - 1. Then the curve is rectifiable and the length is given by L = J: 19'(t) 1 dt. If we recall the interpretation of g' (t) as the velocity of the motion along the curve and Ig' (t ) 1 as the speed, then this formula says that the distance traveled is obtained by integrating the speed. Proof: It suffices to prove the formula if 9 is Cl over the whole interval, since both L and the integral are additive over the finite par­ tition. Then J: Ig' (t) 1 dt is the integral of a continuous function, so it is approximated by the Cauchy sums N E Ig' (tj )1(tj+1 - tj) j=O 13 . .4 Arc Length 615 for partitions of the interval (not to be confused with the single parti­ tion in the hypothesis of the theorem). We want to say that Ig(tj ) l (tj+l - tj ) is approximately equal to 19(tj+l ) - g(tj ) l. To do this we will show that the vectors g'(tj )(tj+l - tj ) and g(tj+l) - g(tj) are approximately equal and, hence, their lengths are approximately equal. But 1t .+1 J , g(tj+d - g(tj ) = t . 9 (t) dt J by the fundamental theorem of the calculus (since get) takes values in an, we apply the theorem to each coordinate and put them all to­ gether). If the interval is small, then g' (t) won't vary much over it, so J/�+l g'(t) dt will be approximately g' (tj) (ti+l - tj ). More precisely, J rtj+1 Jt.. g'(t) dt - g'(tj )(tj+l - tj ) J - [HI (!I(t) _ g'(tj )) dt J rtj+1 < it.. Ig' (t) - g' ( tj ) I dt J by Minkowski's inequality. Thus I (g(tj+d - g(tj)) - g'(tj)(tj+l - tj ) 1 < 6(tj+l - tj ) where 6 is the sup of Ig'(t) - g(tj) 1 for t in [ti t tj+l)' By the unifor­ m continuity of g(t), we can make 6 as small as desired by taking the partition fine enough. Using the triangle inequality in the form IIul - lvll < lu - vi for u = 9(tj+l) - g(tj ) and v = g(tj )(tj+l - tj ), we also have IIg(tj)l(tj+l - tj) -Ig(tj+l) - g(tj ) I I < 6(tj+l - tj). Adding up, we obtain N N L Ig'(tj )l (tj+l - til - L 19(ti+l ) - g(tj ) 1 j=O j=O N < L IIg'(tj )l(tj+l - tj) - Ig(tj+l - g(tj) \" j=O N < 6 L(tj+l - tj ) = 6(b - a). j=O 616 Chapter 13 Implicit Functions, Curves, and Surfaces Thus the integral and the length are equal. QED In particular, if the curve is given as the graph of a C1 function of one of the variables, say (Xl, ••. , Xn-l) = h(xn} for a < Xn < b, then the length is given by ( 1 ) 1/2 l 1 + � hj (t)2 dt, since g(t} = (hi (t}, ... , hn-l (t), t) is the associated parametrization. 13.4.3 Arc Length Parameterization· The notion of arc length allows us to choose a particularly apt para­ metric representation for a simple rectifiable curve, in which arc length is the parameter. Let us say that the curve is initially given by 9 : [a, b] -? an . We then define a function s(t} on [a, b] by setting s(to) e­ qual to the length of the curve for t restricted to [a, to]. Then s(t) takes values in [0, L] and is monotone increasing. Since we are assuming the curve is simple, 9 is one-to-one and so s(t) is strictly increasing. It is not hard to show that s(t) is continuous because the curve is rectifi­ able (see exercise set 13.4.4). Thus s is a one-to-one function taking [a, b] onto [0, L], so it has a continuous inverse because the intervals are compact (see exercises). We denote the inverse simply by t(s). Then g(t(s}} : [0, L] -? Rn is a parametric representation of the curve and the parameter s equals the length of the curve from the initial point corresponding to s = 0 to the point with parameter s. We can inter­ pret this parametric representation as tracing out the curve with speed equal to one, even if the derivative doesn't exist so that there is no tangent vector. For a simple curve it is easy to see that there are only two ways to parametrize by arc length-starting at either of the ends. The arc length parametrization has several useful properties. If the curve is a Cl one-dimensional surface so that it is given by a C1 function 9 : [a, b] -? an with g' (t) #- 0, then the arc length parametrization will be C1 (in fact it will be Ck if 9 is Ck ). The tangent vector will then have length equal to one. If the arc length parametrization x (s) is C2 , then the acceleration vector x\"(s) will be normal to the curve. This follows by differentiating the identity x' (s) . x' (s) = 1. This is called 13 . .4 Arc Length 617 the principal normal. The plane determined by the tangent vector and the principal normal is called the osculating plane, and the reciprocal of the length of the principal normal is called the radius of cUnJature. The circle of that radius in the osculating plane tangent to the curve at the point (on the appropriate side) is thought of as the circle that best approximates the curve at the point. 13.4.4 Exercises 1. Prove that the shortest curve joining two points is a straight line segment. Can you also give a proof directly from the formula L = f: Ig'(t) 1 dt for those curves to which it applies? 2. Prove that arc length is additive: if the curve is divided into two parts the sum of the lengths of the parts equals the length of the whole. 3. Let 9 : [a, b] -? an be a rectifiable curve, and let s(t) : [a, b] -? [0, L] be defined by s(to) = length of the curve 9 restricted to [a, bo]. Prove that s( t) is continuous. 4. Let 91 : [a, b] -? Rn and g2 : [c, d] -? Rn be two one-to-one con­ tinuous function with the same image. Prove that there exists a continuous function h : [a, b] -? [c, d] such that 91 = 92 0 h. 5. Prove that a one-to-one onto map of compact intervals (or more generally compact metric spaces) has a continuous inverse. 6. Show that there are exactly two ways to parametrize a rectifiable curve so that the arc length is equal to the parameter. 7. Prove that if a curve is given by a C1 parametrization 9 with 9' ( t) i= 0, then the arc length parametrization is also C1 and has tangent vector of length one. Show also that if 9 is Ck, then so is the arc length parametrization. Give an example to show that the condition 9' (t) =F 0 is essential. 8. Prove that if a C2 curve lies in a plane in Rn , then the osculating plane to the curve at any point is that plane. 9. Prove that the radius of curvature of any circle is equal to radius of the circle. 618 Chapter 13 Implicit FUnctions, Curves, and Surfaces 10. Prove that a continuous curve 9 : [a, b] -+ lRn is rectifiable if and only if each coordinate function gk is of bounded variation (a function f : [a, b] -+ lR is said to be of bounded variation if N sup L If(tj+1 ) - f(tj ) 1 j=O is finite, the sup taken over all partitions of [a, b] ). 11. Prove that a Lipschitz continuous curve 9 : [a, b] -+ lRn is rectifi­ able. 12. Let (r (t), 8(t)) for t in [a, b] describe the polar coordinates of a curve in the plane. Assuming r(t) and 8(t) are C1 functions, find an integral fomula for the arc length of the curve. 13.5 Summary 13.1 Implicit Function Theorem Definition An o. d. e. in the form M(x, y)dy/dx + N(x, y) = 0 is called exact if there exists F(x, y) such that M = 8F/8y and N = 8F/8x . Theorem y( x) is a solution of the exact o. d. e. M 8y / 8x + N = 0 if and only if F(x, y(x)) = c for some constant c, for all x. Definition An m x m matrix A is called invertible (or nonsingular) if there exists an m x m matrix B with AB = I) where I denotes the m x m identity matrix. We write B = A- I. The norm II AI I of an m x m matrix is the least constant c such that IAxl < c Ixl for all x in }Rm, where Ixl denotes the Euclidean norm. Theorem If A is invertible and II BA - 1 II < 1, then A + B is invertible and (A + B)- l = A- l 2:�O (- I)k (BA- l )k, the series converging. 13.5 Summary 619 Theorem 13.1.1 (Implicit Function Theorem) Let F(x, y) be a Cl function defined in a neighborhood of x in ]Rn and y in ]Rm taking values in ]Rm , with F(x, y) = c. Then if Fy (x, y) is invertible there exists a neighborhood U of x and a Cl function y : U -+ ]Rm such that y( x) = y and F(x, y(x)) = c for every x in U. Furthermore y is unique in that there exists a neighborhood V of y (the image y(U)) such that there is only one solution z in V of F(x, z) = c, namely z = y(x) . Finally the differential of y can be computed by implicit differentiation, dy(x) = -Fy(x, y(x) )- l Fx (x, y(x) ). Theorem 13.1.2 (Inverse Function Theorem) Let f be a Cl function defined in a neighborhood of y in ]Rn taking values in ]Rn . If df (y) is invertible, then there exists a neighborhood U of x = f (y) and a Cl function 9 : U -+ ]Rn such that f(g(x)) = x for every x in U. Furthermore, 9 maps U one-to-one onto an open neighborhood V of y and g(f (y) ) = y for every y in V. The function 9 is unique in that for any x in U there is only one z in V with f(z) = x, namely z = g(x). Finally dg (x) = df (y) -l if f(y) = x . Remark The inverse function theorem is a special case of the implicit function theorem. Conversely, the implicit function theorem for F( x, y) is a consequence of the inverse function theorem in ]Rn+m for f (x, y) = (x, F(x, y) ). Theorem If M(xo , Yo ) #- 0, then the exact o. d. e. M(dyjdx) + N = 0 has a unique solution satisfying y(xo) = Yo in a neighborhood of Xo . 13.2 Curves and Surfaces Definition A subset A of ]Rn is given parametrically if A = Uj gj (Uj) where Uj c ]Rm is open and 9 : Uj -+ ]Rn is continuous; implicitly if A = {x : F (x) = O} where F : ]Rn -+ ]Rk is continuous; as the graph of a function if A = {( t, s) in ]Rm+k : s = f (t)} where f : ]Rm -+ ]Rk is continuous, m + k = n, and the variables tl , ... , tm , 81, . . . ,sk are a permutation of the variables X l , .. . , xn . Example The cusp curve in ]R2 given parametrically by g(t) = (t3 , t2) 620 Chapter 13 Implicit FUnctions, Curves, and Surfaces for t in JR1 , or implicitly by y3 - x2 = 0, or as the graph of y = x2/3, has a nonsmooth point at (0, 0) . Example The unit sphere in JR3 can be represented parametrically by spherical coordinates (x, y, z) = (cos 8sin q), sin 8sin q), cos q») , implicitly by x2 + y2 + z2 - 1 = 0, or locally as the graph of a function by x = ±Jl - y2 - z2 or y = ±Jl - x2 - z2 or z = ±Jl - x2 - y2. Definit ion If g : (a, b) -+ JRn is a C1 curve, then g' (t) is the tangent vector to the curve at g( t) . Definition The rank of an m x n matrix A is defined to be the dimen­ sion of the image of A (regarded as a linear transformation from JRm to JRn ). It is equal to the dimension of the span of the columns of A in JRn and is equal to the dimension of the span of the rows of A in lRm and equal to the size of the largest invertible square submatrix. A C1 func­ tion g : U -+ JRn where U C JRm is open is called an immersion if dg( x) has rank m for every x in U. If g is also one-to-one and the inverse function g- l : g(U) -+ JRm is continuous it is called an embedding. Definition If 9 : U -+ JRn is an embedding, the tangent space to g(U) at a point ii = g(x) in g(U) is the span of the vectors 8g/8xk (X), k = 1, ... 1m . Definition 13.2.1 A C1 m-dimensional surface in lRn (with m < n) is a subset Mm of JRn locally parametrized by embeddings, in the sense that every point in Mm lies in a neighborhood V in JRn such that there exists an embedding 9 : U -+ JRn for U C JRm open such that g(U) = V n Mm. Theorem 13.2 .1 Let 9 : U -+ JRn with U C JRn open be an immersion. For every point x in U there exists a neighborhood U of x such that g is one-to-one on U and g(U) is the graph of a C1 function. Definition In a C1 surface, the subsets V n Mm are called coordinate patches and the functions g-l : V n Mm -+ U are called local coordinate maps. 13.5 Summary 621 Theorem If VI nMm and V2 nMm are coordinate patches that intersect and (h and (h are the images of the intersection V1 nV2 nMm under g1 1 1 1 - - 1 - - and g:; in Ul and U2 , then g:; 0 gl : Ul -+ U2 and gl 0 g2 : U2 -+ Ul are C1 functions. Theorem The tangent space to gj (Uj) at a point ii on a surface Mm does not depend on the coordinate patch and can be taken as the def­ inition of the tangent space Tm M(ii) to Mm at ii. It is equal to the set of tangent vectors g' (t) at g(to) = ii as 9 ranges over all C1 curves 9 : (a, b) -+ Mm lying in the surface and passing through ii. Definit ion The normal space NMm (x) to a surface Mm at a point x in Mm is the (n - m) -dimensional subspace of ]Rn of all vectors perpen­ dicular to TMm (x) . Theorem 13.2.2 Let F : ]Rn -+ ]Rn-m be a C1 function with rank dF (x) equal to n - m at every point on a level set {x : F(x) = c}. Then this level set is an m-dimensional c1 surface Mm and V' Fj ( x) for j = 1, ... , n - m span NMm (x) . 13.3 Maxima and Minima on Surfaces Theorem 13.3.1 (Lagrange Multipliers) Let f : ]Rn -+ ]R and G : ]Rn -+ ]Rk be C1 functions, and let x in ]Rn be a point where G(x) = 0 and dG(x) has rank k. If f(x) attains a local maximum or minimum for f on {x : G ( x) = O}, then there exists ,X in ]Rk such that H : ]Rn+k -+ ]R defined by H(x, 'x) = f(x) + 2:;=1 'xj Gj (x) has a critical point at (x, 'x) . Example If G(x, y) = y3 - x2 and f(x, y) = y, then f attains its minimum value on G = 0 at (0, 0) but H does not have a critical point of the form (0, 0, ,X) . In this case the rank condition of the theorem does not hold. Theorem (Second Derivative Test) If f attains a local maximum (re­ sp. minimum) on G(x) = 0 at x and the conditions of the Lagrange Multiplier Theorem hold and if f and G are assumed C2 , then d2 f (x) + ,X • d2 G (x) is non-positive (resp. non-negative) definite on the tangent 622 Chapter 13 Implicit Functions, Curves, and Surfaces space at x to G(x) = o. Conversely, if f and G are C2, if dG has mnk k at x, if (x, .\\) is a critical point of H, and if d2 f(x) + .\\ . d2 G(x) is negative (resp. positive) definite on the tangent space to G(x) = 0 at x, then x is a strict local maximum (resp. minimum) of f on G(x) = o. 13.4 Arc Length Definition 13.4. 1 The length of a continuous curve 9 : [a, b] -+ ]Rn is the sup of �f=o Ig(tj+l ) - g(tj)1 over all partitions a = to < tl < . . . < t N = b. If the length is finite the curve is called rectifiable. Theorem If �f=o Ig(tj+l ) - g(tj)1 has a finite limit for a sequence of partitions with the maximum of tj+l - tj going to zero, then the curve is rectifiable and the limit equals the length. Definit ion A curve 9 : [a, b] -? ]Rn is called simple if 9 is one-to-one. It is called a simple closed curve if 9 is one-to-one except g(a) = g(b). Theorem The length of a simple curve, or a simple closed curve, does not depend on the parametrization. Example The graph of y = x sin 1/x on [0, 1] is a continuous curve that is not rectifiable. Theorem 13.4. 1 A piecewise C1 continuous curve 9 : [a, b] -+ ]Rn (meaning there exists a finite partition a = to < tl < ... < t N such that 9 is C1 on each subinterval) is rectifiable, and the length equals J: 19'(t) ldt. Theorem A simple rectifiable curve can be parametrized by arc length: if L denotes the length there exists h : [0, L] -+]Rn onto the curve such that the length of h restricted to [0, s] equals s, for 0 < s < L, and there are exactly two possibilities for h (the other being h(L - s) ). Chapter 14 The Leb esgue Integral 14. 1 The Concept of Measure 14. 1.1 Motivation The idea of the Lebesgue integral is to enlarge the class of integrable functions so that J: f(x) dx will be given a meaning for functions f that are not Riemann integrable. For functions that are Riemann in­ tegrable the Lebesgue theory will assign the same numerical value to J: f(x) dx as the Riemann theory. Thus the Lebesgue integration the­ ory can be thought of as a kind of completion of the Riemann integra­ tion theory. This can be given a precise sense in terms of the metric d(f, g) = J: If(x) - g(x) ldx on the continuous functions C([a, b]) so that the Lebesgue integrable functions are obtainable from the contin­ uous functions by the same process as the real numbers are obtained from the rational numbers. However, it is best if we observe this fact after we have developed the Lebesgue theory in a more concrete way. Before beginning on the rather difficult path of developing the Lebesgue theory we will recall some of the weak points of the Riemann theory that can serve as motivation for seeking a better theory. The Riemann theory works well for continuous functions and for uniformly convergent sequences, but one weakness is that it breaks down if we go too far beyond this tame territory. We have seen that a bounded function with a countable set of discontinuities is Riemann integrable, 623 624 Chapter 14 The Lebesgue Integral but Dirichlet's function I(x) = U if x is irrational, if x is rational is not, even though it is a pointwise limit of functions f n (x) = { I if x = � 1 � r2 � . .. , r n � o otherWIse where rl , r2,'\" is an enumeration of the rationals, with fol fn(x) dx = O. Now one might object that Dirichlet's example is somewhat artificial, but it is possible to conceive of more natural examples. For example, consider a Fourier series E�oo aneinx that is given by specifying the coefficients an in some way. Unless we know that E�oo l an l is finite we cannot be sure that the series converges to a continuous function. Nevertheless it is tempting to integrate the series term-by-term as b ( OC ) 00 b J. � ane'nx dx = � J. une'\"' dx because the factor n in the denominator helps make the series converge (if we assume E lan l2 < 00, which is a weaker condition than L l an l < 00, we have by the Cauchy-Schwartz inequality). The Riemann theory of integra­ tion, which was invented to handle similar problems in Fourier series, fails to give a meaning to this integration. Certainly the trend in math­ ematical analysis has been to consider more and more wildly behaved functions. Perhaps this trend has been encouraged by the Lebesgue theory, which allows us to deal with such functions, but it is still a worthwhile goal to pursue the integration of all functions that come along. (It would be nice to have a theory that provides an integral for all functions, but this turns out to be impossible.) 14. 1 The Concept of Measure 625 A second weakness of the Riemann theory of integration is the lack of a good convergence theorem. We have seen that the Riemann inte­ gral can be interchanged with a uniform limit, but in many applications this is not adequate. For example, with Fourier series we frequently do not have uniform convergence, even if the function is continuous . Of course even in the Lebesgue theory we will not be able to interchange all limits with integration. For example, if fn{x) = { n if 0 < � < lIn, o otherwlSe, then fol fn{x) dx = 1 but limn_oo fn{x) = 0 at every point , so fl lim fn {x) dx :;f lim fl fn {x) dx. Jo n-oo Jo Nevertheless we will find two rather useful criterion for interchanging limits and integrals-the monotone convergence theorem and the dom­ inated convergence theorem. A third weakness of the Riemann theory is that improper integrals have to be treated separately. In the Lebesgue theory we will be able to treat absolutely convergent improper integrals on the same footing as proper integrals. A fourth weakness is that we have no reasonable criterion for de­ ciding whether or not a function is Riemann integrable (Riemann did in fact give such a criterion, but I have not bothered to present it be­ cause it seems no easier to apply than to verify the definition of the Riemann integral). With the aid of the Lebesgue theory it is possible to give a criterion for the Riemann integral to exist (although it must be admitted that we don't have a very good criterion for the Lebesgue integral to exist) . Finally a fifth weakness involves the theory of multiple integrals. We have postponed discussing multiple integrals until after the Lebesgue theory because the Riemann theory yields only very awkward and in­ complete results. In addition to overcoming these weaknesses, the Lebesgue theory yields a remarkable bonus-it allows a very far-reaching and fruitful generalization of the concept of integration. We have already observed at least superficially an analogy between infinite series and integrals. 626 Chapter 14 The Lebesgue Integral The Lebesgue theory allows us to say that the sum of an absolutely con­ vergent series is a form of integration, and this conceptual framework allows us also to give a foundation to probability theory. Lebesgue's theory stands at the doorway to twentieth century mathematics, and all who enter must pass through this gate. Much of the motivation we have given for the Lebesgue theory comes after the fact. Historically, Lebesgue was viewed by his contem­ poraries as almost a crack-pot--or at least as someone who was going very far out on a limb to study esoteric problems of little importance to the mainstream of mathematics. He was once asked why he both­ ered to study the problem of defining the area of very irregular surfaces since the usual calculus formula was valid for all surfaces that would ever arise in applications. Lebesgue replied by producing a crumpled handkerchiefl However, once Lebesgue's results were published they were rapidly recognized as being of great importance. Lebesgue explains the basic idea of his method by a parable. Sup­ pose a merchant wishes to add the day's receipts. The most straight­ forward approach would be to add the amounts in the order in which they came, say 5 + 10 + 1 + 1 + 25 + 5 + 10 + 50 + 25 + 10 (in Lebesgue's day you could buy things for those amounts). But a better approach would be to tally the number of coins of each denomination, 2 pen­ nies, 2 nickles, 3 dimes, 2 quarters, 1 half-dollar, and then compute 2 x 1 + 2 x 5 + 3 x 10 + 2 x 25 + 1 x 50 = 2 + 10 + 30 + 50 + 50 = 142. The Riemann integral is like the first approach; it adds the values of the function f (x) in the order they occur-partitioning the domain. Lebesgue's integral is like the second approach; it first sorts the values of f (x )-partitioning the range, and then sums the values multiplied by the size of the set on which they occur. Of course if the function is con­ tinuous, or nearly so, the values of f (x) will not vary much over a small interval and the Riemann integral will work well. But if the function f (x) is wildly discontinuous-as the parable suggests it very well might be-then partitioning the domain really makes no sense. Why should f(zj) (xj - xj-d for Zj in [Xj- b Xj] represent a good approximation of IX! f(x) dx even if the interval is small if the values of f(x) on the X)-l interval vary considerably? On the other hand, if A] denotes the set of x such that Yj- l < f(x) < Yj , then Yj times the size of the set Aj will be a good approximation to the contribution to the integral of f over the set Aj provided Yj - Yj-l is small. If Yo < Yl < Y2 < ... < Yn is a 14. 1 The Concept of Measure 627 partition of the range of f (we assume for simplicity that f is bounded so we can do this), then the Lebesgue approximating sum Ej=l YjlAjl, where IAi l denotes the size of the set Aj = {x : Yj-1 < f(x) < Yj }, will approximate the Lebesgue integral J: f(x) dx. To complete the program we have to make precise the notion of the size of the set Ai . Here we come against a formidable difficulty. Even if the function f is quite smooth, the set Ai can be quite hairy; if f(x) = x2 sin 11x (as shown in F�gure 14. 1.1) the set where 0 < f(x) < 1 is a countable union of intervals. Figure 14. 1.1: If the function is wildly discontinuous, then we can expect even worse trouble. Thus we need to be able to give a numerical value to the size of a set for rather complicated sets, which generalizes the length of an interval. This leads to the concept of Lebesgue measure. 14. 1.2 Properties of Length Before we can discuss the concept of Lebesgue measure we need to discover the basic properties of the concept of length of an interval, for these will be the properties we can hope to generalize. If I denotes an interval (a, b) or [a, b] or (a, b] or [ a, b), then b - a is its length, which 628 Chapter 14 The Lebesgue Integral we will denote III. Notice that if a = -00 or b = +00, then III = +00, so that III is a non-negative extended real number. Perhaps the most obvious property of the length is its additivity: if I is the union of two disjoint intervals I = II U 12 (say I = (a, b) and II = (a, c) , 12 = [c, b) with a < c < b) , then III = III 1+ Ih l. Notice that this makes sense even if some of the lengths are zero or infinity. By induction we can obtain the finite additivity of length: if I = II U ... U In is a disjoint union of intervals, then III = Ih l + . . . + IInl. Actually the induction argument is not completely trivial since we need to observe that it is possible to remove one of the intervals I k (say the one containing an endpoint or a neighborhood of an endpoint if I is open) so that the union of the remaining intervals is still an interval. An immediate consequence of the finite additivity is the following subadditivity: if I is covered by II , h, ... , In, not necessarily disjoint, thea III < L:j=1 IIj I· We leave the details of the proof as an exercise, the idea being that we can shrink the intervals Ij to I� so that I is the disjoint union I = I� U . . . U I�. An important special case, n = 1, is called monotonicity: if I C J, then III < I JI . From the finite additivity it is tempting to jump to a general addi­ tivity principle that would include infinite unions. Here, however, we come up against a famous paradox that troubled many of the math­ ematicians who worked on the foundations of calculus: an interval of non-zero length, say (0, 1), is the union of the points it contains, yet each point c is an interval [c, c] of zero length. How can a non-zero value be obtained by summing an infinite number of zeroes? There is no way to make sense out of this-although some have tried by arguing that the zeros are actually infinitesimals. The only way out is to conclude that there is no general principle for additivity of length. However, we observe that in the example we broke up the interval (0, 1) into an un­ countable disjoint union of intervals. We know that uncountable sets are apt to cause more trouble than merely countable infinite sets, which are in effect limits of finite sets. Suppose we had a countable disjoint union I = hu h u .. . of intervals, with I also an interval. We could hope that III = Ih 1+ Ih 1+ ' \" . Such a principle does in fact hold, and we call it countable additivity or f7- additivity for short. Although it is plausible because a countable union is a limit of finite unions, we can­ not prove it quite so easily because there are many complicated ways to write an interval as a countable disjoint union of intervals. Instead 14. 1 The Concept of Measure 629 we must resort to trickery and the Heine-Borel theorem. Lemma 14. 1.1 Let I be an internal, I = II U h u··· where 11,12,.\" are disjoint interoaZs. Then III = L:�1 IIj I (we interpret this to mean that if one side is +00, then so is the other, where L:�1 IIj I can be +00 either because one of the summands is +00 or because the series diverges) . Proof: Consider first the case when III is finite. If we break off the union after a finite number of terms, then II U 12 U ... U In C I and the order of the terms can be rearranged if need be so that Ik-l lies to the left of Ik - for 2 < k < n. We can then fill in other intervals Jb\" ', Jm as needed in between (as indicated in Figure 14. 1.2) so that I = II U ... U In U Jl U . .. U Jm (disjoint) so that III = �j=I IIj l + ��=1 IJkl by the finite additivity, hence �i=I IIj I < III· I J1 ( 11 ) Figure 14. 1.2: Letting n -+ 00 we obtain L:;:1 IIj I < III· The tricky step is obtaining the reverse inequality. We could try to argue directly that the J -intervals in the above picture must get smaller as we add more I-intervals, but it is hard to do this convincingly. Instead we resort to subterfuge. We shrink the interval I if need be to make it compact, and we expand the Ij intervals if need be to make them open. We claim we can do this while changing the values of I II and L:�l IIj l by at most e. Indeed if a and b are the endpoints of I, then set (if e is small enough) I' = [a + e/2, b - e/2] ; and if aj and bj are the endpoints of Ij , set Ij = aj - 2-Je/2, bj + 2-j e/2) . We then have I' compact, Ij open, and 11'1 = 111 - e, L:�l IIj l = e + L:� lIIj l . Because the Ij cover I, it follows that the Ij cover I' since we expanded the coverers and contracted the covered. The Ij are no longer disj oint, but this doesn't matter. By the Heine-Borel theorem there is a finite subcover, I' C U;=1 Ij for some finite N. 630 Chapter 14 The Lebesgue Integral Now the finite subadditivity implies 11' 1 < L:f=l II; I. Finally, from 11'1 < L:f=l II;1 and 11'1 = 111 - €, 11; 1 = IIjl + 2-j€ we obtain 111- € < €+ L:f=l IIj I < €+ L:�1 IIj I and, since this holds for every € > 0, III < L:�1 IIj I· This completes the proof when III < 00. If III = +00 we simply intersect all the intervals with [-N, N] and let N -+ 00. By the previous case we have 00 lI n [-N, N] I = L IIj n [-N, N] I j=l 00 since IIj n [-N, N] I < IIj I by the monotonicity. But lim II n [-N, N] I = +00 if III = +00 N-oo (for then a = -00 or b = +00) , so L:�1 IIj I > +00 hence = +00. QED It is perhaps worth pointing out a technical aspect of the proof: when we expanded the intervals Ij we threw in a factor of 2-j so that the sum of all the errors would remain small. This is a common theme in many arguments in Lebesgue integration theory. We can paraphrase it by saying a countable number of small errors can be made small. When we give a formula for Lebesgue measure we will need the following corollary to the lemma. Corollary 14.1.1 If I is any interval, then III = inf {� IIj I : I C g Ij where {Ij lis any countable covering of I by intervals.} Proof: We can always cover I by itself (h = I and Ij = 0 for j > 1), showing that the inf is at most III. Thus it suffices to show I c U�l Ij implies III < L:�1 IIj I. If the intervals Ij are not disjoint we can replace them by smaller intervals that are disjoint, in the process 14.1 The Concept of Measure 631 reducing L:�1 IIj l· If I is then not equal to U�l Ij , we can make it so by replacing each interval with its intersection with I, again reducing ��l IIj l. After these two reductions we apply the lemma to obtain equality III = E�l IIj l, hence we must have had the desired inequality all along. QED We have now completed a description of all the basic properties of the length of an interval that will be needed for the generalization of the concept of measure. We can summarize them succinctly in three simple statements: 1. III is a value in [0, 00] . 2. III = 0 if I is the empty interval. 3. III = ��l IIj I if I = U�l Ij and the Ij are disjoint. We are not claiming that these three statements determine III uniquely-far from it, there are many different ways to define a measure of size III for every interval in such a way that these three statements are valid. Rather we are claiming that these represent a sort of minimal distillation of the concept of length, or even of the general concept of measurement of \"extent\" that would include such things as area, vol­ ume, mass, and probability. We will eventually take them to be axioms for the abstract concept of measure, just as we took a few simple prop­ erties of distance and used them for axioms for the abstract concept of metric. But before doing this we need to extend our vision beyond the simple world of intervals and come to grips with the question of which kinds of sets we need to measure. 14. 1.3 Measurable Sets Our first choice would be to measure all sets. However this turns out to be impossible if we want to retain the properties listed above. (Actually the situation is more complicated: we need the uncountable axiom of choice to prove the impossibility, and Solovay has shown that without some such strongly nonconstructive axiom it is impossible to prove the impossibility.) This does not turn out to be too devastating a blow to the theory, since we can do analysis with a more restricted class of 632 Chapter 14 The Lebesgue Integral sets. It does mean, however, that we have to be more careful than we might prefer to be. Recall that the kind of sets we want to measure are of the form A = {x : a < j(x) < b} for some function j we want to integrate. Because we cannot measure all sets, we cannot integrate all functions; but we would like to integrate as many functions as possible, so we want the collection of measurable sets, those A for which IA I is defined, to be as versatile as possible so that we can manipulate the functions freely. This means we want these sets to be preserved under the usual operations of set theory: union, intersection, complement, difference. Any collection of sets with this property is called a field of sets. Technically it suffices to assume only the following axioms for a field F of sets: 1. The empty set is in F. 2. If A is in F, then the complement C A is in F. 3. If A and B are in F, then Au B is in F. Here all the sets in F are subsets of a fixed universe X and the complement is defined with respect to this universe, C A = {x in X : x is not in A}. For most of our applications X will be a subset of some Euclidean space. It is a simple exercise to show that these axioms imply that if A and B are in F, then A n B and A \\B are also in F. The term algebra of sets is sometimes used instead of field. The algebraic terminology derives from the fact that a field forms a Boolean algebra under the operations A + B = A�B, A· B = An B where A�B denotes the symmetric difference defined by A�B = (A \\B) U (B\\A) = (A U B)\\(A n B) , as indicated by the shaded region in Figure 14. 1.3. An important example of a field of sets is the following: take for X any fixed interval of lR and take for F all sets that are finite unions of intervals contained in X. We leave the simple verification of the axioms as an exercise. It is necessary to consider unions of intervals rather than merely intervals in order to have a field of sets. So that we will be able to perform limit processes on functions, we have to assume more about the measurable sets-namely that they are preserved under countable set-theoretic operations. For technical reasons it suffices to assume the following additional axiom: 4. If AI , A2 , .•• is a sequence of sets in F, then A = U,i=I Aj is in F. 14. 1 The Concept of Measure 633 Figure 14. 1.3: Any field of sets that satisfies this condition is called a C7-field. The identity n�l Aj = C(U�l C Aj ) shows that a C7-field is closed under countable intersections as well. Notice that we only consider countable operations; we do not require that arbitrary uncountably infinite unions of sets in the C7-field must belong to the C7-field. Nevertheless a C7-field is in general a very large collection of sets. For example, the field :F of finite unions of intervals in X is not a C7-field. We could try to make it into a C7-field by considering :F1 , the collection of all countable unions of intervals of X. This will satisfy the last axiom, but it is not closed under complements (for example, the Cantor set is not in :F1 , but its complement is), so it isn't even a field. We could try to fix this by taking :F2 to be all countable intersections of sets in :F1 and then :F3 to be all countable unions of sets in :F2 and so on alternately taking countable intersections and unions and finally setting :Foo = U�l :Fj . It is not hard to show that :Foo is again a field, but alas it too is not a C7-field. We need to repeat this process through a sophisticated transfinite induction up to the first uncountable ordinal in order to obtain a C7-field! Naturally such a complicated \"construction\" is of little use and so we rely on a non-constructive description. If F is any field of sets we define the C7-field generated by :F, denoted by :F(71 to be the intersection of all C7-fields containing :F. We leave it as an exercise to verify that this is actually a C7-field and is the smallest C7-field containing F, in the sense that any C7-field containing :F must contain Fq . When :F is the field of finite unions of intervals contained in a fixed interval X of lR we call Fq the C7-field of Borel subsets of X and we call sets in Fq Borel sets. The Borel sets can equally well be described as the smallest C7-field containing all the open sets (or all the 634 Chapter 14 The Lebesgue Integral closed sets), and this definition makes sense in an or any metric space. The point of the above discussion is that there is no really satisfactory description of what a Borel set is like. However, it is a sufficiently large category of sets so that it contains any set that is describable in conventional mathematical terms. (Actually, many authors use a slightly larger u-field of sets, called the Lebesgue sets, but there is not much to be gained by doing this.) The point of view we will take in the remainder of this chapter is that only the Borel sets are important. In this sense we can say that Lebesgue made Cantor obsolete: Cantor wanted to make set theory the foundation of mathematics, while Lebesgue showed that just about all mathematics can be done within the smaller confines of the Borel sets. 14 .1.4 Basic Properties of Measures We can now state our first main goal as follows: to extend the length measure III from the intervals to the u-field of Borel sets so as to preserve the basic properties. We will call the extended length measure Lebesgue measure. More generally, we will define a measure to be a function IAI defined on au-field :F of sets (called the measurable sets) satisfying: 1. (non-negativity) IAI is in [0, 00] ; 2. 101 = 0 where 0 is the empty set; 3. (a-additivity) if A = Uf=l Aj with Aj disjoint, IAI = L� l IAjl. Note that this implies finite additivity simply by taking all hut a finite number Aj equal to the empty set. It is by no means clear that there exists such an extension as called for in the definition of Lebesgue measure. We will give a proof that such an extension exists in section 14.2. For the remainder of this section we will derive properties of measures that follow from the above three axioms. These properties will hold for Lebesgue measure, but the proofs are just as easy for general measures. It will also turn out that these properties lead to a formula for Lebesgue measure, which is given in section 14. 1.5. Next we observe some simple properties of measures that are con­ sequences of the defining properties: 14. 1 The Concept of Measure 635 1. A measure is monotone: If A and B are measurable sets with A C B, then I AI < I BI . To see this observe that B is a disjoint union of A and B\\A, as shown in Figure 14. 1.4, so IBI = IAI + IB\\AI by additivity and, hence, IBI > IAI since IB\\AI > o. o B Figure 14.1.4: 2. Continuity from below: If Al C A2 C A3 C . .. is an increasing sequence of measurable sets and A = U�l Aj , then IAI = limj-+oo IAj l . To see this we define the difference sets Bk = Ak \\Ak- l for k = 2, 3, ... and observe that A is the disjoint union A = Al U B2 U B3 U . \" , so IAI = IAI I + IB21 + IB3 1 + . . . by the a-additivity. On the other hand if we terminate the union we have Al U B2 U .. . U Bn = An a disjoint union, so IAI I + IB2 1 + . .. + IBn l = I An l and so I AI = limn-+oo IAn l · 3. Conditional continuity from above: If Bl ::J B2 ::J B3 :? . . . is a decreasing sequence of measurable sets and B = n�l Bj and if the measures IBj I are finite, then IB I = limj-+oo IBj I. To see this we define the difference sets Ak = Bk \\Bk+l for k = 1, 2, . .. and observe that Bl can be written as a disjoint union Bl = B U Al U A2 U . .. (see Figure 14. 1 .5) ; hence, IBI I = IBI + IAII + IA2 1 + ' '' , which we can write as IBI I - IBI = 2:�1 IAj I since IBI I and, hence, IBI are finite. On the other hand Bl = Bn U Al U A2 U · .. U An- l is a disjoint union, so IBII = IBn l + IAI I + ... + IAn- I I · Thus IBl l -I Bnl = 2:j::i I Aj l -* IBl l - IBI as n -* 00, so limn-+oo IBn l = IBI. The requirement that IBj I be finite was used in the argument to avoid meaningless manipulations with 00 - 00 expressions. To see that it is actually necessary for the result consider the example of Lebesgue measure on lR with Bn = (n, 00) . Then n Bn = 0, but limn-+oo IBn l = +00. 4. Subadditivity: If AI , .. . ,An are measurable sets, not necessarily disjoint, then IAI U ... U An i < 2:j=l IAn l . To see this we replace the 636 Chapter 14 The Lebesgue Integral Figure 14. 1.5: union with an equivalent disjoint union Al U· · 'UAn = BI UB2U\" ·uBn by defining BI = AI, B2 = A2\\A} , B2 = A3\\(AI U A2), ... , Bn = An \\(AI U· ·· U An- I). Then the Bj are disjoint and Bj C Aj , so IBj I < IAj l by monotonicity. Thus IAI U · ·· U An i = L:j=I IBj l < L:j=I IAj l· 5. u·Subadditivity: If AI , A2, . .. is a sequence of measurable sets, then I U�I Aj l < L:�I IAjl· By essentially the same argument as in the finite case we write ��I Aj = U�l Bj where the .�j .are disjoint and Bj C Aj . Then 1 Uj=1 Aj I = Ej=1 IBj I by U·addltlvlty, and the result follows. Frequently we need to combine subadditivity and monotonicity to obtain the following statement: if B C Al U ... U An, then IBI < Ei=l IAj I· A similar statement holds for countable unions. 14.1. 5 A Formula for Lebesgue Measure Let us return to the special case of Lebesgue measure. Although the proof of the existence of this measure is very difficult, it is not too hard to derive a formula for the measure. The remaining task will then be to show that the three axioms for a measure are indeed satisfied. Suppose that a set B is covered by a countable union of internals, B C U�I Ij • Then if B is to be measurable, the u-subadditivity would imply IBI < E�l IIj I. Notice that here we know what IIj I is: 14. 1 The Concept of Measure 631 just the length of the interval Ij • Thus any countable covering of a set by intervals gives us some information about the measure of that set. Of course the same would be true about finite coverings of B by intervals. However it is a key observation of the Lebesgue theory that the information obtained from countable coverings is much more precise than that obtained from finite coverings. To understand this we should look at an example. Let B be the set of rational numbers in [0, 1] . Then if we want to cover B by a finite union of intervals it is not hard to see that we must cover the entire interval [0, 1], so the lengths must add up to at least one. Thus we obtain only the estimate IBI < 1. However, using a countable cover gives us greater flexibility. If rl, r2, . .. is an enumeration of the rational numbers in [0, 1] set Ij = (rj - 2-je, rj + 2-je). Then U�l Ij :) B and U�l lIj l = e, so IBI < e. Since this is true for every c > 0, we have IBI < 0 and, hence, I B I = 0 (if we are willing to use closed intervals in the cover we can take Ij = [rj, rjl and get IBI < 0 immediately). In this case we have determined the value of I B I exactly by considering countable coverings by intervals. It turns out that this is true if B is any Borel set. Suppose B is an arbitrary set. We have seen that if B is to be mea­ surable we must have IBI < L:�l IIj l where U�l Ij is any countable covering of B by intervals. Similarly we must have IBI < inf U.�l IIjl where the infinum is taken over all countable coverings of B by intervals. The heart of the proof of the existence of Lebesgue measure is to take this to be an equality, to define We can see immediately some consequences of this definition. First note that the arbitrary countable union of intervals can be replaced by a disjoint union to cover the same set B while reducing the value of E�l IIj I· To do this we consider the differences It , 12 \\ I} , 13 \\(11 U 12)\" \" as in the proof of the sUbadditivity. These differences are not necessarily intervals, but they are clearly finite unions of intervals, so altogether we end up with a countable disjoint covering by intervals. Since the definition IBI involves an infinum, we clearly obtain the same value if we restrict to disjoint coverings. We may also assume that the intervals Ij are open, since we can always expand Ij to make it open, 638 Chapter 14 The Lebesgue Integral increasing its length by c2-j ; and the increase in L:�1 IIj I is at most c. In particular, if B happens to be an interval, then by Corollary 14. 1.1 we know that the Lebesgue measure of B coincides with the length of B. Thus Lebesgue measure does extend the length measure of intervals. We now want to look at two other special cases when the definition of Lebesgue measure can be given a significant interpretation . First suppose inf {2::;:1 IIj I : B � U Ij} = O. Then we have no choice by the a--subadditivity but to set IBI = O. Such sets are said to have measure zero. They will play an important role-that of \"negligible\" sets that can be ignored-in the integration theory. It is not difficult to show from the definition that sets of measure zero have the properties they should have: every Borel subset of a set of measure zero has measure zero, and any finite or countable union of sets of measure zero has measure zero. In particular we have a proof of a trivial kind of O'-additivity for sets of measure zero. Second, we consider the case of an open set . Recall that we proved a structure theorem for open sets, B = Uj Ij where Ij are disjoint open intervals, the union being finite or countable. FUrthermore, this decom­ position is unique. If we believe the countable additivity of Lebesgue measure, we must have IBI = L:j IIj I. Now the definition of Lebesgue measure is somewhat different in that it requires that we take the inf of all such sums over countable covers of B by intervals; the union given by the structure theorem is just one of these covers. It certainly seems plausible that this is the best cover so that the infimum is actually achieved. This can be proved directly without using the O'-additivity (see exercise set 14. 1.7). Consider a general Borel set B. As we observed before, in the definition of I BI we can restrict attention to disjoint open coverings, so B C U Ij says exactly B C A where A is open (A = U Ij ) and so L:j IIj l = IAI . Thus the definition becomes simply IBI = inf{ IA I : B C A, A open} if we adopt the above definition for the measure of open sets. This property is called outer regularity (see exercises for inner regularity). In other words, once we know what the Lebesgue measure is for open sets, the outer regularity property tells us what it is for all Borel sets. 1,4. 1 The Concept of Measure 639 (Outer regularity is also an interesting property in its own right, and many other measures also share this property.) Next we observe that we can replace the infimum by a limit: there must exist a sequence of open sets AI , A2, . .. such that IBI - limj_oo IAj I. (This is just a consequence of the properties of the in­ f over any set of real numbers.) By the monotonicity we can obtain the same limit using AI , Al n A2, Al n A2 n A3, . ... Indeed we write � = Al n A2 n ... n An. It is easy to see that � is also a count­ able disjoint union of open intervals and B C �. Since A� C An, we have I�I < IAnl, so IBI < limn_oo IA�I < limn_oo IAnl = IBI. The point of this is that the sequence A� , A�, ... is decreasing. Finally set A = n�l Aj . Since B C Aj for all j, we have B C A. In summary, for every Borel set B, there exists a decreasing sequence A � , A� of coverings by countable disjoint unions of open intervals, such that limj_oo IAj I is the value we have defined for IBI. IT we had B = A we would certainly want to take IBI = limj_oo IAi l ; in fact we would have to take this value by the conditional continuity from above if the measures IAj I are finite (this is always the case if the universe X is a bounded interval). In the general case we are merely asserting that A \\B has measure zero. A set that is the countable intersection of open sets is called a G 6 set (the G stands for \"open\" and the 6 stands for \"intersection\" ). As the above discussion shows, the definition of the measure of a G 6 set is perfectly natural. Now the class of G6 sets is quite large, but it is not a O'-field. But if we modify the G 6 sets by sets of measure zero we do obtain the Borel O'-field: every Borel set B can be covered by a G 6 set A such that A \\B has measure zero, and IBI = IAI. 14. 1.6 Other Examples of Measures Although Lebesgue measure on an interval of R is the principal example of a measure in which we will be interested, there are a few other examples worth keeping in mind: 1. We can define a Lebesgue measure on an . In place of the intervals we consider rectangles I = 11 x 12 x ... x In = {x in an : Xl is in 11, X2 is in 12, ... ,Xn is in In} where I}, ... ,In. are intervals in 1R, with measure (volume) equal to 111 1 · 1121 .. .. · IInl. The Lebesgue measure of a set A that is a countable disjoint union of rectangles is the sum of the measures of the rectangles, and IBI = inf{IAI : B C A} with A as 640 Chapter 14 The Lebesgue Integral above for a general Borel set B. We will use this measure in the theory of multiple integrals. 2. Let the universe X consist of the positive integers {I, 2, 3, ... }, and define IAI to be the number of points in A (+00 if A is an infinite set) . This is called counting measure, and it is defined on all subsets of X. It is trivial to verify that the axioms for a measure are satisfied. We will see that the integration theory associated with this measure is the theory of absolutely convergent series. More generally, counting measure can be defined on any universe X. 3. Let the universe X be a finite set (Xl! \" \" xn). Let Pl ,P2, ··· ,Pn be any non-negative values (+00 is allowed); and define IAI to be the sum of Pi for all points Xi in A, where A is any subset of X. Again it is trivial to verify the axioms for a measure. In this case we can also easily show that any measure defined on all subsets of the universe X must have this form. If the values Pi also satisfy 1:7=1 Pi = 1 (or equivalently, IX I = 1) , then we can interpret them as the probabilities. Thus Pj is the probability that Xi occurs; IAI is the probability that one of the x's in A occurs. 4. More generally, for any universe X and any measure such that IX I = 1 we can interpret the measure as giving probabilities for \"ran­ dom\" events with outcomes in X, IAI being the probability that the outcome lies in A. Conversely, in the point of view pioneered by Kol­ mogorov and now almost universally accepted by mathematicians, ev­ ery description involving probabilities may be cast into this form. To give one important illustration, let us give such a decription for the random tossing of a fair coin in an infinite sequence of independent trials. The universe X consists of all possible outcomes, i.e., sequences of heads (H) and tails (T), as HTHT . .. . If A is a subset of X that is measurable (i.e., belongs to a certain u-field of subsets that we will not describe explicitly), then IAI will be interpreted as the probabil­ ity that a random sequence of tossings will lie in A. For example, if A consists of all sequences beginning with H, then IAI = 1/2; and more generally if A consists of all sequences whose first n outcomes are specified, then IAI = 2-n• However, for more general sets it is not im­ mediately apparent how to define IAI. There is a device for doing this, however. We interpret H as 0 and T as 1, and each infinite sequence HT . .. as a binary expansion .01.... In this way we obtain a map­ ping of the universe X onto the unit interval [0, 1] ; this mapping is not 14. 1 The Concept of Measure 641 quite one-to-one because of identifications such as .0111 . . . = .100 . . . , but there are only a countable set of such exceptions and this set will have measure zero. Furthermore, if we consider the set A in X of all sequences starting with H, this is mapped into the interval [0, 1/2] , so IAI is equal to the Lebesgue measure of [0, 1/2] . More generally, if A is the set of all sequences whose first n outcomes are specified, this is mapped into an interval of the form [k/2n, (k + 1)/2n] and IAI still a­ grees with the Legesgue measure of the image of A. We can thus define IAI for a general subset of X as the Lebesgue measure of the image of A under the mapping (A will be measurable if its image is a Borel set) . In this way we obtain a new interpretation of Lebesgue measure on [0, 1] as the probability measure associated with an infinite sequence of independent tosses of a fair coin. 14. 1.7 Exercises 1. Show that a field of sets is closed under finite intersections, and differences . 2. Show that the collection of all finite unions of intervals forms a field. Show the same is true for finite unions of intervals in R that are left open and right closed, (a, b] . 3. Prove that the intersection of all O'-fields containing a field F is a O'-field and that it is the smallest O'-field containing F. 4. Prove that if A = Uj=l Ij , a disjoint union of intervals, then L:j=l IIj I is independent of the particular decomposition. Show that if we define IAI = Ej=l IIj l, then all the axioms for a measure are satisfied on the field of finite unions of intervals, where 0'- additivity means I U�l Aj l = E;l 1Aj l if AI, A2, '\" and U�l Aj are all in the field. (Hint: use the O'-additivity on intervals proved in the text.) Why doesn't this argument establish the existence of Lebesgue measure? 5. Prove that the Cantor set (delete middle thirds) has Lebesgue measure zero. 6. Prove that a countable union of sets of Lebesgue measure zero has 642 Chapter 14 The Lebesgue Integral measure zero, directly from the definition IBI = 0 if inf {� IIj I : B C ,Q Ij } = o. . 7. What is the Lebesgue measure of the set of irrational numbers in [0, I]? 8. What is the Lebesgue measure of a countable set? Is the same true of a general measure? 9. Prove that a countable intersection of countable unions of intervals is a G8 set. 10. Prove that the class of finite unions of rectangles in ]Rn is equal to the class of finite disjoint unions of rectangles in ]Rn and forms a field. 11. Prove that every open subset of ]Rn is a countable union of rect­ angles. Can the rectangles in the union be taken to be disjoint? 12. Prove that any measure on the field of all subsets of a finite set X has the form IA I = 2:xoinA Pj for some values Pj in [0, 00] . What J if X is countable? 13. Prove directly (without assuming a-additivity) that I U�l Ij I = 2:�1 IIj I if {Ij} are disjoint intervals and III denotes Lebesgue measure. 14. Prove the following inner regularity for Lebesgue measure: IBI = sup{IFI : F C B is closed}, for all Borel sets B. (Hint: if B is contained in (-N, N) use the outer regularity for (-N, N)\\B. ) 15. Prove that for compact sets A, the Lebesgue measure can be com­ puted using only finite coverings, 16. Let /-L be a measure on a a-field Y, and let F be a set in Y. Define the restriction of /-L to F, denoted /-LIF, by /-LI F(A) = /-L(F n A) . Prove that /-L I F is a measure on Y. 14.2 Proof of Existence of Measures 14.2 Proof of Existence of Measures * 14 .2.1 Outer Measures 643 In this section we will give a proof of the existence of Lebesgue measure, following a method of Caratheodory. As a bonus we will also obtain the existence of other measures, including the Hausdorff measures that are used in the theory of fractals. The strategy of the proof is as follows. First, we weaken the axioms for a measure to conditions that are easy to verify. The resulting object will be called an outer measure. (This is truly dreadful terminology, because an outer measure is not a special case of a measure but something more general.) It will be easy to obtain examples of outer measures; in particular, the definition of Lebesgue measure yields an outer measure. The second step in the proof is to show that an outer measure does yield a measure if we restrict the a-field of sets appropriately. That is, we start with a a-field :F and consider a possibly smaller collection :Fo of sets that satisfy a certain \"splitting\" condition. We prove a general theorem to the effect that :Fo is a a-field and the restriction of the out­ er measure to :Fo is indeed a measure. Such a general theorem could yield a vacuous result in special cases because :Fo could be very small, perhaps consisting of just the empty set and the whole space. To give significance to the general theorem we need the third step in the pro­ gram, which gives a criterion for concluding :Fo = :F. Fortunately, this criterion is easy to verify for Lebesgue measure and for other measures as well. To begin the first step of the proof we give the axioms for an outer measure /-L defined on a-field of sets :F: 1. (non-negativity) /-L(A) is in [0, 00] for every A in :F; 2. /-L(0) = 0; 3. (a-subadditivity) if A = U�l Aj with all Aj in :F, then /-L(A) < 2:�1 /-L(Aj ) ; 4. (monotonicity) if A C B are in :F, then /-L(A) < /-L(B) . Notice that axioms 1 and 2 are the same as the corresponding ax­ ioms for measures and that axiom 3 is a weakening of a-additivity. 644 Chapter 14 The Lebesgue Integral Since we have an inequality, it is not necessary to assume the sets Aj are disjoint. Ordinary additivity is not being assumed, but of course we have subadditivity for finite unions as a consequence of axioms 2 and 3 by taking all but a finite number of sets equal to the empty set. We have already noted that axioms 3 and 4 are properties that hold for measures, so every measure is an outer measure. (Note: Most books require that F be the o--field of all subsets of X in the definition of out­ er measure. This is totally unnecessary and contrary to the philosophy that non-measurable sets should play no role in analysis.) Now, as promised, I will show that Lebesgue measure, defined by t-t(A) = inf{2:�l IIj I : A C U�l Ij }, is an outer measure on the Borel sets (or any o--field, for that matter) . Indeed, axioms 1, 2, and 4 are immediate consequences of the definition; and axiom 3 follows easily because if we have countable coverings of each of the sets Aj by intervals, we can take the union of these coverings to obtain a countable covering of A by intervals. Thus if Aj c Uk Ijk, then A C Uj Uk IJk' so t-t(A) < 2:j 2:k IIjkl ; and if we take the coverings of Aj so that 2:k IIjk I < t-t(Aj ) + c-2-j (note that if t-t(Aj ) = +00 for any j, then there is nothing to prove) we have t-t(A) < 2:j (t-t(Aj) + c-2-j ) = c- + 2:j t-t(Aj). Since this is true for any c- > 0, it is true for c- = 0 and we have the required o--subadditivity. Since we have not worked very hard to establish the outer measure axioms for Lebesgue measure, we do not deserve to obtain very much as a consequence. Still, we get a little more than we deserve out of the following theorem. First we need to define the splitting condition , which will enable us to carry out the second step in the proof. Definition 14.2.1 Let t-t be an outer measure on a o--field F. We say that a set A in F satisfies the splitting condition if we have t-t(B) = t-t(B n A) + t-t(B\\A) for every set B in F. Since the splitting condition is an exact additivity statement for the disjoint sets B n A and B\\A, we cannnot expect it to hold very often, unless t-t is a measure, in which case it would always hold. It is obviously true for the empty set and the whole space but may not hold for any other sets. What the next theorem says is that things are very good for the sets that do satisfy the splitting condition. 14.� Proof of Existence of Measures 645 Theorem 14.2.1 Let JJ be an outer measure on the u-field F, and let :Fo denote the sets in :F that satisfy the splitting condition. Then :Fo is a u-field, and JJ restricted to :Fo is a measure. Proof: It is clear from the definition that A is in Fo if and only if the complement of A is in :Fo because the splitting condition is the same for A and C A (B\\A = B n C A). We first show that Fo is a field and that JJ is finitely additive on :Fo. So let Al and A2 be in :Fo, and take any set B in F. Write B = Bl UB2UB3UB4 (disjoint), according to the Venn diagram shown in Figure 14.2.1. B Figure 14.2.1: All four sets Bj are in F. The splitting condition for Al U A2 and B that we need to prove is Now Al satisfies the splitting condition, so splitting B yields JJ(B} = JJ(B1 UB3) +JJ(B2 UB4). Also A2 satisfies the splitting condition, so we can use it to split the sets Bl U B3 and B2 U B4 to obtain JJ(BI U B3) = JJ(Bl ) + JJ(B3) and JJ(B2 U B4) = JJ(B2) + JJ(B4). Combining these results yields If instead of starting with B we start with Bl U B2 U B3 and repeat the above arguments we obtain 646 Chapter 14 The Lebesgue Integral This proves the desired splitting of B, IJ{B) (IJ(Bd + \",{B2) + IJ{B3)) + IJ(B4) - IJ{B1 U B2 U B3} + IJ(B4). So :Fo is a field. Furthermore, if A1 and A2 in Fo are disjoint, then using A1 to split A1 U A2 yields Thus IJ is finitely additive on :Fo. Next we show that Fo is a u-field. Since we have shown that it is a field, it suffices to show that it is preserved by countable disjoint unions (since any countable union can be replaced by a disjoint one without leaving the field). Suppose {Aj} is a disjoint sequence of sets in Fo, and let A = U�1 Ai' Given any B in F, we need to show that the splitting formula IJ{B} = IJ(B n A} + IJ{B\\A) holds. Now JJ is an outer measure, so by the u-subadditivity, which implies finite sub-additivity, we already know IJ{B) < IJ{B n A) + IJ{B\\A}; so it suffices to establish the reverse inequality. Consider the sets Fn = Uj=1 Aj . Since Fn C A, we have B\\A C B\\Fn and so IJ(B\\A) < IJ{B\\Fn} by the monotonicity of IJ. On the other hand, Fn is in :Fo because Fo is a field; so Fn splits B, yielding and furthermore n IJ(B n Fn) = L\",{B n Aj) i=1 by induction on the splitting property since the sets Aj are in Fo and disjoint. By the O'-subadditivity (applied to B n A = U�1 {B n Aj )) we have IJ(B n A) < E�l IJ(B n Aj). Altogether we have shown IJ(B n A) + IJ{B\\A) 14.� Proof of Existence of Measures 00 < L JJ(B n Aj} + JJ(B\\A} j=l n nl!.� L JJ(B n Aj) + JJ(B\\A) j=l < n�� (� I'(B n Aj) + I'(B\\Fn)) lim (JJ(B n Fn) + JJ(B\\Fn}} n-oo lim JJ(B} = JJ(B}. n-oo 647 This completes the verification that Fo is a u-field. But if we look at the last string of inequalities for B = A we find 00 JJ(A} = L JJ(Aj), j=l which is exactly the u-additivity of JJ on :Fo. This is the only axiom for a measure not contained in the axioms for an outer measure, so JJ restricted to Fo is a measure. QED 14. 2.2 Metric Outer Measure We now come to the third stage in our process. We are going to give a simple criterion for :Fo to equal :F in the last theorem. This will allow us to conclude that JJ is a measure on all of :F. We assume that X is a metric space and F is the u-field of Borel sets. Recall that this is defined to be the smallest u-field containing the open sets (or closed sets, since these are the complements of open sets) . Definition 14.2.2 We say two sets A and B in X are separated if the distance from A to B (the inf of d(x, y) for all x in A and y in B} is positive. We define a metric outer measure to be an outer measure that is additive on separated sets, if A and B are separated. 648 Chapter 14 The Lebesgue Integral Of course, separated sets are disjoint, but disjoint sets need not be separated (think of adjacent open intervals) . It is usually not difficult to verify the metric condition in specific cases. For example, take Lebesgue measure. Notice that in the definition of J.£{A} we can always assume that the covering intervals have length less than e, for any fixed e. {If not, break any interval of length greater then e into a disjoint union of small intervals; this does not change the sum E IIj I.} Given two separated sets A and B, say of distance e apart, cover A U B by U Ij with IIj I < e. Then each Ij can meet only one of the sets A or B {or else the distance apart would be less than e} . Thus we can pick apart the covering of A U B into a covering of A and B, say A C U Ii and B C UIj' with {Ii} U {Ij'} = {Ij} so that L IIil = L IIil + L 11;'1· If we chose the covering Au B � UIj so that J.£(A U B) > L IIjl - 8, then J.£{A U B} > J.£(A} + J.£{B) - 8. Since this is true for any 8 > 0, it is true for 8 = O. This completes the verification that Lebesgue measure is a metric outer measure, since the reverse inequality is automatic by subadditivity. Essentially the same argument shows that Lebesgue measure on Rn is also a metric outer measure. Thus the next theorem will complete the proof of the existence of Lebesgue measure. Theorem 14.2.2 (Caratheodory) A metric outer measure is in fact a measure on the Borel sets. Proof: By the previous theorem it suffices to show that :Fo = :F. Since :F is generated by the closed sets and :Fo is a O'-field, it suffices to show that every closed set A is in :Fo, which means J.£(B} = J.£{B n A) + J.£{B\\A} for every B in :F. Notice that we already know this is true if B n A and B\\A are separated. But in general, B n A and B\\A are disjoint but not separated. Now we want to use the fact that A is closed and we are in a metric space. We break up B\\A into \"rings\" , as indicated in Figure 14.2.2, that is 00 B\\A = U Rj (disjoint ) j= l 14.� Proof of Existence of Measures 649 where the ring Rj is defined to be the set of points in B\\A whose distance to the set A(d(x, A) = inf{d(x, y) : y in A}) satisfies Iii < d(x, A) < 1/(j - 1) . The fact that A is closed is equivalent to the statement that d( x, A) > 0 if x is not in A because d(x, A) = 0 says that x is a limit-point of A. A Figure 14.2.2: Notice that the sets B n A and Uj=l Rj are separated (distance at least lin) , so we have By monotonicity we have so 1'(8) > I' ((8 n A) U jQ Rj) , 1'(8) > 1'(8 n A) + I' tQ Rj) . To complete the proof we only need 650 Chapter 14 The Lebesgue Integral since the reverse inequality IJ{B) < IJ(B n A) + IJ(B\\A} is automatic by subadditivity. But by O'-subadditivity we know 00 + L IJ(Rj}, j=n+l so it suffices to show 00 lim \" IJ(Rj} = 0, n-oo L...J j=n+l which would follow from the convergence of the series E�l IJ(Rj}. We need one more trick to get this. Notice that the convergence would follow if we could show E IJ{Rj) converges when summed separate­ ly over even and odd values of j. The point of this is that the sets R1 , R3, Rs, .. . are all separated, as are the set R2, R4 '�\" '\" Thus \",(Rl) + IJ(R3) + .. . + IJ{R2j+d = IJ(R1 U R3 U ... U R2)+d by the metric hypothesis on IJ. Since IJ(RI U R3 U ... U R2j+d < IJ(B\\A} by monotonicity and we may assume IJ(B\\A} < 00 (or else JJ(B) = +00 by monotonicity and the splitting is obvious), we have the convergence of the odd sums. A similar argument shows that the even sums converge. QED 14.2.3 Hausdorff Measures· Lebesgue measure on the line has the simple scaling property that if we dilate a set by a factor t, then the measure is multiplied by t. In n-dimensions the corresponding factor is tn (so if your height doubles, your weight should increase by about a factor of eight, assuming you live in three dimensions). Hausdorff had the brilliant insight that we can construct measures that scale with factor to: for any positive Q by making a simple change in the definition of Lebesgue measure. Haus­ dorff's construction works in any metric space. In recent years, these Hausdorff measures have played an important role in the development of fractal geometry. 14.2 Proof of Existence of Measures 651 For simplicity we begin with the definitions for subsets of the line. If A is a Borel set covered by a countable union of intervals A � U�l Ij, we may take L:�l IIj 10: as an upper approximation to the measure JJo:. However, the definition inf{L:�l IIj IO:} over all such coverings does not work. The reason it fails is that if we split an interval I into pieces, say I = Uf=l Ij (disjoint), then III = L:;=l IIj l but we do not have 1110: = 2:;=1 IIj 10: for any Q :/; 1. In fact, for 0 < Q < 1, which is the case in which we will be interested, L:;=l IIj 10: is larger then 1110:. This means that if we have a covering A � U�1 Ij with 2:�1 IIj I0: small, we cannot automatically replace it with a covering where all the intervals are small simply by splitting the intervals into small pieces. Since the smallness of the covering intervals was a crucial fact that was used in proving the metric property of Lebesgue measure, we will have to build the corresponding fact into the definition of JJo:. Definition 14.2.3 For any fixed c > 0, define ��) (A) = inf {� IIj I'\" : A C iQ Ij and the intervals Ij all satisfy IIj I < e } . Then define JJo:(A) = li�_o JJ�) (A) . The limit defining JJo:(A) always exists in the extended real numbers because JJ�) (A) increases as c -? 0 (it is the infimum over a smaller collection of coverings for smaller c) . If A is � bounded set we will always have a finite value for JJ�) (A), but we may nevertheless have JJ�) (A) = +00. In fact, if Q < 1 we will usually have JJo:(A) = +00 unless A is very thin. For example, if A is a nonempty open interval, then JJo:(A) = +00. The reason we require Q < 1 is that if Q > 1, then JJo:(A) = 0 for every set A. We leave the details to the exercises. Theorem 14.2.3 JJo: is a measure on the Borel sets. Proof: First we observe that JJo: is an outer measure. The proof of the required properties is routine and is left to the exercises. Then we observe that JJo: is a metric outer measure. The proof is almost the 652 Chapter 14 The Lebesgue Integral same as for Lebesgue measure. If A and B have distance apart 8, then for any c < 8 we have because any countable covering of A U B by intervals of length at most c splits into a disjoint union of coverings of A and B. Taking the limit as c -+ 0 we obtain the additivity for /-La . Finally, we apply the Caratheodory theorem on metric outer measures. QED It is easy to show (see exercises) that /-Ll is Lebesgue measure and /-Lo is counting measure and that /-La has the desired scaling property, /-La (8t A) = ta/-La (A) for dilations 8t A = {tx : x is in A} . To get a feeling for what /-La is like for 0 < 0: < 1 consider the middle-third Cantor set C. Choose 0: = log 2/ log 3. We claim /-La (C) < 1. The idea is that we can cover C by 2n intervals of length 1/3n (the intervals that remain from the unit interval after we have removed middle thirds n times) . Thus we obtain an upper bound of 2n . (1/3n ) a = (2/3a)n = 1 (because Q = log 2/ log 3) for /-L�) (C) for c = 1/3n , hence /-La (C) < 1 in the limit . It is trickier to show /-La ( C) = 1, and we leave the details to the exerCIses. To extend the definition of /-La to }Rn or any metric space, we drop the requirement that the covering sets Ij be intervals and allow them to be arbitrary closed sets, interpreting III to denote the diameter of the set (the sup of d( x, y) as x and y vary over I) . The definition is otherwise the same, and the proof that /-La is a measure is essentially the same. (In }Rl the two definitions coincide because every closed set is contained in a closed interval of the same diameter.) It is much harder to compute Hausdorff measures in }Rn because we have to consider such general coverings. For example, it is true that /-Ln is equal to a multiple of Lebesgue measure in }Rn , and one can even compute the constant (/-Ln (Br) = (2r )n for a ball Br of radius r) , but this requires a deep geometric fact, the isodiametric theorem: the maximal volume of a set of fixed diameter is attained by a ball. It is usually easy to obtain upper bounds for Hausdorff measure since this only requires finding efficient coverings. Lower bounds are more problematic because they require proving estimates for all possible coverings by quite general sets. For example, if C is a rectifiable curve in }Rn , then /-Ll (C) < length( C) . If 1.1.! Prool 01 Existence 01 Measures 653 a(t) is an arc length parametrization for t in [a, b), then the coverings by pieces of the curve corresponding to a partition of {a, b} will give this estimate. However, it is necessary to make stronger assumptions on the curve in order to conclude that this is an equality. Using Hausdorff' measures with varying a, we can give the definition of Hausdorff' dimension. It is based on the following simple lemma. Lemma 14.2.1 a. Suppose #-'Q(A) < 00. Then #-',8(A) = 0 lor f3 > a . h. Suppose #-,Q(A) > O. Then #-',8(A) = +00 lor f3 < a . Proof: Consider any covering A C U�l Ij with IIj I < e. Then if f3 > a we have E�l IIi 1,8 = E�l IIj V�-QIIj IQ < eP-Q E�l IIj IQ, while if f3 < 0 we have similarly E�l IIj 113 > e,8-Q E IIj IQ. Thus #-'�) (A) < eP-Q��) (A) if f3 > 0 and ��) (A) > eP-Q��) (A) if f3 < a. Taking the limit as e � 0 we obtain the desired result. QED Thus if we graph �Q(A) as a function of a, there will be a unique value ao such that �Q(A) = +00 for 0 < 00 and �Q(A) = 0 for 0 > 00. o �--------�------------ <X() Figure 14.2.3: The value �Qo(A) may be anything in [0, 00]. We define 00 to be the Hausdorff dimension of A. Of course, if we can find 00 such that #-'ao(A) is finite and positive, then ao is the Hausdorff dimension of A. Thus the Hausdorff dimension of the Cantor set is log 2/ log 3. 654 Chapter 14 The Lebesgue Integral 14.2.4 Exercises 1. Verify that Lebesgue measure on the Borel sets in Rn is an outer measure, and in fact a metric outer measure, so it is indeed a measure by Caratheodory's theorem. 2. a. Prove that IJo:{A} = 0 for every Borel set A in R if a > 1. b. Prove the same for every Borel set A in R,n if a > n. 3. Verify that IJo: is an outer measure. 4. Show that IJo is counting measure on any metric space. 5. Show that IJI on R equals Lebesgue measure. 6. Show that IJo: on Rn is translation invariant, IJ{A + y} = IJ{A} where A + y = {x + y: x is in A}. 8. *Show that IJo:{ C} = 1 for the Cantor set C and a = log 2/ log 3. (Hint: if I is an interval that has the form I = II U 12 U 13 where h is a deleted interval in the construction of C and II and 13 are adjacent to 12 and of smaller length, then Ilt lO: + 11310: < 1110:.) 9. Let C be the Cantor set and a = log 2/ log 3. Let IJ be the restric­ tion of IJo: to C, so IJ{A} = IJo:{A n C). Show that IJ(A) < IAIO: (where IAI denotes the diameter of A). 10. *Let IJo: be n-dimensional Hausdorff measure on Rn, and let IJ be Lebesgue measure on Rn. a. Show that there exist constants Cl and C2 such that IJ {A} < cIIJn(A} and IJn(A} < c2IJ(A) for all Borel sets A. b. Show that there exists a constant c such that IJ(R) = cIJn(R) for all rectangles R. 14.9 The Integral 655 14.3 The Integral 14.3.1 Non-negative Measurable Functions The Lebesgue integral is an absolutely convergent integral; J f (x) dx will be defined if and only if J If(x) 1 dx is defined and finite. There­ fore we will concentrate first on defining the integral for a non-negative function. Then for real-valued functions we will split the function into the difference of its positive and negative parts, f = f+ - f- , where f+ = max(O, I) and 1- = max(O, -I) , so that 1+ and 1- are non­ negative and then define J f(x) dx = J f+ (x) dx- J f- (x) dx. Similar­ ly for complex-valued functions we will integrate the real and imaginary parts separately. Let X be a set on which we have defined a measure on a u-field of subsets F. We will let IJ or dIJ stand for the measure, as is conventional, so we write IJ(A) for the measure of a set and J fdlJ for the integral with respect to the measure. It is standard terminology to refer to the pair (X, F) as a measurable space and the triple (X, F, IJ) as a measure space, and we will refer to sets in F as measurable sets. It is usually safe to adopt the attitude that all sets that you will ever encounter are measurable. If you can write down a description of a set, then it will almost always be measurable, and usually it is a routine exercise to verify this. Of course these remarks apply primarily to Lebesgue measure on an interval of the line (or ]in ); there are situations in probability theory (as in the definition of conditional probability) where one deliberately takes a very small u-field of sets so that not all reasonable sets are measurable. Now suppose f is a non-negative function on X, in other words, f(x) > 0 for every x in X. The range of f is thus [0, 00), and for convenience we will even allow the possible value of +00. Now we partition the range [0, 00]. For convenience let Pn denote the specific partition The reason for this particular choice is that it gives us a sequence of partitions, each being a refinement of the previous ones, such that in the limit every finite piece of the range is cut up into arbitrarily small 656 Chapter 14 The Lebesgue Integral pieces. Of course there are other ways to accomplish the same thing. Then we form the Lebesgue approximate sum Notice that for this to be well defined the sets {x : k/2n < I(x) < (k + 1) /2n} must be measurable; this will put some sort of restriction on I but of a very weak nature since we believe most sets are measurable. Given that this condition is met, it is clear that L(/, Pn) represents an underapproximation to the integral because we are mUltiplying the size t-t(A) of each set A by the minimum value that I assumes on A, where A = {x : k/2n < I(x) < (k + 1)/2n} or {x : I(x) > 2n}. In other words, A = 1- 1 (B) where B is one of the sets in the partition Pn. More gen­ erally, for any partition P of [0, 00] into a finite number of intervals we can define L(/, P) = L:p (inf B)t-t(/-1 (B)) (here inf B means the lower endpoint of the interval B). Notice also that as we refine the partition we increase the Lebesgue approximate sum. If, say, a particular Bo in P splits into B� U .. . u B� (disjoint) in a refined partition pI , then (inf Bo)t-t(Bo) < L:�=l (inf B�)t-t(B�) because inf Bo < inf B� for every k and t-t(Bo) = L:�=l t-t(B�) by the additivity of the measure. Since we have chosen the particular sequence of partitions Pn so that each one is a refinement of the previous ones, we have a monotone increas­ ing sequence of Lebesgue approximate sums {L(/, Pn)} and can define the integral as the limit , J Idt-t = limn_oo L(/, Pn). This will be a non­ negative extended real number (the value +00 can occur either because L(/, Pn) increases without bound or because L(/, Pn) = +00 for some n) . We can be confident that this gives a reasonable definition because the maximum size of the intervals on any fixed bounded region goes to zero as n --1- 00 (since we are partitioning the unbounded range [0, 00] into a finite number of intervals, we must have one infinite interval) . Before going further with the definition of the integral we briefly pause to fill in the technical details of assuring that t-t(/-1 (B)) is de­ fined. We say that a function I : X --1- lR is measurable if 1- 1 (B) is a measurable subset of X whenever B is a Borel subset of lR (recall that the Borel subsets are the a-field generated by the intervals). We leave it as an exercise to verify that it suffices to show that 1- 1 (B) is mea­ surable for every interval B (or even every interval ( a, 00 ) , or [a, 00 ) , 14 .3 The Integral 657 or (-00, a) , or (-00, aD to conclude that f is measurable. The reason for this is that the intervals generate the Borel sets and f- 1 preserves set-theoretic operations. It is of course simpler to verify that f- 1 (B) is measurable for every interval B (or every interval of the form (a, 00 ) , etc. ) than for every Borel set B, so this remark is quite useful. We expect that every function we will encounter will be measurable, so it will be mostly a technical nuisance to have to verify it. Nevertheless, the Lebesgue theory of integration is restricted to measurable function­ s only. We can also define measurable functions taking values in the extended reals, by allowing the intervals B to contain +00 and -00. For technical reasons it is often convenient to do this, and we will not explicitly distinguish this minor variant. There is a superficial resemblance between the definition of \"mea­ surable\" function and one of the forms of the definition of \"continu­ ous\" function: you need only interchange the words \"measurable\" and \"open\" (here we interpret \"measurable\" for subsets of the range � to mean \"Borel set\" ) . However, because there are so many more measur­ able sets than open sets-the axioms for a O\"-field are quite generous­ there are many more measurable functions than continuous functions. All the usual operations for generating functions preserve measurabili­ ty; this explains why you won't \"meet\" a non-measurable function. Theorem 14.3.1 If f and g are measurable functions on X, then af + bg, f· g, fig (if 9 -=I- 0) , max(f , g), min(f, g), and ifi are measureable functions. If h : JR ---7 JR is measureable (with respect to the O\"-field of Borel sets in JR) , then h 0 f is measurable. If fn is a sequence of measurable functions on X, then sUPn fn ' infn fn ' lim sup fn' lim inf fn , and lim f n (if it exists pointwise) are measurable functions. Proof: We give the proof in some of the cases, leaving the others as exercises. Suppose h = f + g and f : X -+ � and 9 : X -+ lR are measurable. Let us define Fa = {x : f(x) > a} and similarly for Ga and Ha , so Fa = f-1{(a, 00)}. We know that Fa and Ga are measurable, and we want to show that Ha is measurable. So we ask: how can h(x) be greater than a? Clearly h(x) > a if f(x) > b while g( x) > a - b, and this must be true for some b if h( x) > a. Thus Ha = Ub (Fb n Ga-b). This shows how the sets Ha can be constructed out of the sets Fa and Ga. Unfortunately this construction involves 658 Chapter 14 The Lebesgue Integral an uncountable union that threatens to take us out of the u-field of measurable sets. However a closer look at the argument suggests a trick to replace the uncountable union over all real b by a countable union. Since I ( x) is a real number, there must exist a rational number b such that I{x} > b. Thus we have Ha = Ub rational(FbnGa-b) and this exhibits Ha as a measurable set. We have used tricks like this before, and we will have to use them again. Next suppose In : X � R are measurable functions, and let us show that SUPn In (x) is measurable. This is easy, since sUPn In (x} > a if and only if In{x) > a for some n, so {x : SUPn In(x} > a} = Un {x : In (X) > a} and a countable union of measurable sets is mea­ surable. A similar argument works for infn In. Then we obtain the result for lim sup /n and lim inf /n since lim sup /n = infn (supk>n lk } and lim inf In = sUPn (infk�n Ik}. The same argument works for lfm/n, if it exists pointwise, because then lim /n = lim sup In = lim inf In. QED In order to use the theorem to show that all \"usual\" functions are measurable, we have to \"get started\" with some basic measurable func­ tions. If X is lR or an interval (or Rn ), then every continuous function is measurable, since 1-1 (B) for B open is open, and hence, measur­ able. Also, the characteristic function of a measurable set (the function that is one on the set and zero off it) is measurable. These functions enable us t.o get started constructing measurable functions . Finite linear combinations of characteristic functions of measurable sets are called simple functions. We write f = L�=l akXAk where XA denotes the characteristic functions of A. It is easy to see that we may assume that the measurable sets Ak are disjoint, even if they are not originally given disjoint, and the simple functions are exactly the class 01 measur­ able functions that assume only a finite set 01 values. Simple functions play a key role in our development of the integral, and we will need to establish some elementary facts about them along the way. In terms of the simple functions, we can give a new interpretation to the Lebesgue approximate sums. Let I be a non-negative measur­ able function, and let P be a finite partition of [0, 00] into intervals. For each interval B in the partition, 1-1 (B) is a measurable set and so Lp(inf B}X,-l(B) is a simple function, obtained by replacing I(x) by a possibly smaller value depending in which interval of the partition f (x) 14.3 The Integral 659 lies. Then L(/, P) is a kind of primitive integral of this simple function equal to the sum of the \"areas\" of the \"rectangles\" (the graphs of the functions (inf B)Xf- 1 (B) ), which are the products of the height inf B with the measure /-L(/- 1 (B)) of the \"base\" 1- 1 (B). The situation is en­ tirely analogous to the interpretation to the Cauchy approximate sums as integrals of step functions (more precisely the Riemann lower sums) , but the simple functions are more versatile than the step functions, since the characteristic function of a measurable set is more general than the characteristic function of an interval. In fact, I dare not draw a picture of a simple function for fear of lulling you into thinking it is \"simpler\" than it might be-the measurable sets on which the function assumes its values might be Cantor sets, or worse. N ow suppose we consider the particular sequence Pn of partitions of [0, 00] described above, so Pn consists of [2n, 00] together with [0, 2n) chopped up into intervals of length 1/2n , as indicated in Figure 14.3. 1. I I I I I I I I I I 0 1 2 2n 2n Figure 14.3. 1: I I I Let In = L:Pn (inf B)Xf-1 (B) be the associated simple function. Then {In} is monotone increasing and has limit equal to I pointwise. This is clear if we consider an individual point x and the value I(x) . For each n we locate the value I (x) in one of the intervals of Pn , and then In (x) is the inf of that interval. This value clearly increases as the partition is refined and approaches I (x) since the size of the intervals is 1/2n (once I ( x) < 2n). In fact it is even true if I is allowed to assume the value +00, for then In (x) = 2n where I(x) = +00. We have thus shown that every non-negative measurable function is obtainable as the pointwise limit of simple functions (it is then straight­ forward to obtain the same result for real-valued measurable functions) . This justifies thinking of simple functions as the basic building blocks out of which general measurable functions are constructed. Actually we have proved a slightly stronger statement: every non-negative measur­ able lunction is the pointwise limit 01 a monotone increasing sequence 01 non-negative simple lunctions. Having the sequence monotone in- 660 Chapter 14 The Lebesgue Integral creasing may seem like only a minor improvement, but it turns out to be crucial for the theory of the integral. To understand its significance we need to look at some disturbing examples: 1. Let X = [0, 1] with Lebesgue measure and set In = nX(O,l/n)' Then lim In(x) = ° pointwise, but the integral nJ£(O, l/n) = 1 does not approach zero. If instead we take In = n2X(O,1/n), then still lim In(x) = ° but now the integral n2J£(0, lin) = n doesn't even have a limit. 2. Let X = [0, 00) with Lebesgue measure and set In = (l/n)X(O,n)' Again lim In{x) = 0, but the integrals (l/n)J£{O, n) = 1 do not tend to zero. Of course the limits are not monotone in these examples. The point is that without monotonicity, or at least some such restriction, there need be no relationship between the integral of I and the limit of the integrals of f n, where f n are simple functions such that lim In (X) = I (X) pointwise. 14.3.2 The Monotone Convergence Theorem We start with the definition of the integral: If I = 2:�=1 akXA\" is a non-negative simple function we define J IdJ£ = 2:�1 ak,u(Ak}' It is a simple exercise to verify that this definition is independent of the representation: if 2:ak xA \" = 2:bjXBj' then 2:akJ£(Ak} = 2:bjJ£(Bj}. Next if I is a non-negative measurable function we define J IdJ£ = limn-co L(/, Pn) = limn_co J fndJ£ where In = 2:Pn (inf B}Xf-1(B)' It is again easy to verify that this is consistent with the special case definition: if I is simple, say f = 2:�1 akXA\" , then limn_co L(/, Pn} = 2:�=1 akJ£{Ak). To see this assume, as we may, that the sets Ak are disjoint and the values ak distinct. Then for n large enough the values ale will all be less than 2n and fall into distinct intervals of length 1/2n of Pn, so L(/, Pn} = 2:�1 bkJ£(Ak} where Ibk - ak l < 1/2n and so limn_co L(/, Pn) = 2:�1 akJ£(Ak} (note that both sides are +00 if J£{Ak) = +00 for some k}. This definition is extremely simple, but it has the defect that it appears to depend on the particular choice of the partitions Pn. If this were really the case, it would not be worth very much. Thus our 14.3 The Integral 661 next goal is to show that the same value for the integral would be obtained from other sequences of partitions. Recall that the sequence In = L:Pn (inf B)Xf-1 (B) of simple functions associated with the par­ titions Pn had the property that it was monotone increasing and had limit I. Clearly the same will be true if we take any other sequence of partitions such that each is a refinement of the previous one (to get monotonicity) and the maximum length of the subintervals on any bounded region goes to zero (to get the limit). Thus it suffices to show that limn_oo J IndJ-L = J IdJ-L if In is any monotone increasing sequence of non-negative simple functions converging to I. It turns out that the same is true even if the In are not assumed to be simple. This is the famous Lebesgue monotone convergence theorem. Since the proof is not much harder, we will go directly to the general case. Theorem 14.3.2 (Monotone Convergence Theorem) Let 0 < II < 12 < .. . be a monotone increasing sequence 01 non-negative measurable lunctions, and let I = limk_oo Ik · Then J IdJ-L = limk_oo J Ik dJ-L (both sides may be equal to +00) . Proof: Since we have defined J IdJ-L = limn_oo L(/, Pn ) and J IkdJ-L = limn_oo L(/b Pn), we need to show limk_oo limn_oo L(/b Pn ) = limn_oo L(limk_oo Ib Pn). Now we claim that the inequality limk_oo J IkdJ-L < J IdJ-L is easy to obtain from the monotonicity. To prove it we ob­ serve that since Ik < I, we have L(/b Pn) < L(/, Pn). This follows from the fact that the simple functions I�n) = L:Pn (inf B)Xf; l (B) and I(n) = L:Pn (inf B)Xf- 1 (B) (whose integrals give L(/b Pn ) and L(/, Pn)) satisfy I�n) < I(n) and the integral for simple functions is clearly monotone: I < 9 implies J IdJ-L < J gdJ-L (see exercises). From L(/b Pn) < L(/, Pn) we obtain J IkdJ-L < J IdJ-L by letting n -+ 00, and then by letting k -+ 00 we obtain limk_oo J Ik dJ-L < J IdJ-L. Now we work on getting the reverse inequality. Note that it suffices to show limk_oo J IkdJ-L > L(/, Pn) for all n. Now L(/, Pn) = J l(n)dJ-L where I(n) is a simple function, and limk_oo Ik = I > I(n). To sim­ plify notation set I(n) = g. Thus to complete the proof we need to show that if 9 is any simple function such that limk_oo Ik > g, then limk_oo J IkdJ-L > J gdJ-L. Write 9 = L:f=l bj XBj where the sets Bj are disjoint. We then re­ strict the functions Ik to the sets Bj by multiplying by XBj ' and observe 662 Chapter 14 The Lebesgue Integral that Ik > 2:;=1 IkXBj by disjointness, so J IkdIJ > 2:;=1 J IkXBj dIJ. If we can prove limk_oo J I1cXBj dIJ > bjIJ(Bj } then we will have limk_oo J IkdIJ > J gdIJ by adding over j. In other words, without loss of generality we can assume N = 1 and so can drop subscripts and write 9 = bXB. We need to show that limk _oo Ik > bXB implies limk_oo J IkdIJ > bIJ(B}. Finally we can complete the proof of the theorem by appealing to the continuity from below for the measure. Suppose b and JJ(B) are finite (we leave as an exercise the simple modifications necessary if either is +oo). Fix an error E and look at the set Ek where Ik (X) > b - E. Since limk_oo Ik(X) > b on B, it follows that Uk:1 Ek 2 B. Since Ik is increasing, so are the sets Ek ; hence limk_oo IJ(Ek} > IJ(B } by continuity from below. But since Ik (X) > b - e on Ek, we have J IkdIJ > (b - e)IJ(Ek} , so limk_oo IkdIJ > (b - e) lim IJ(Ek} > (b ­ e)IJ(B}. Since this is true for every error e, we have limk_oo J IkdJJ > bIJ{B} as desired. QED With the aid of the monotone convergence theorem we can deduce the elementary properties of the integral of non-negative measurable functions quite easily from the corresponding properties of the integral of non-negative simple functions. For example, J(I + g}dIJ = J IdIJ + J gdIJ if I and 9 are non-negative simple functions. Then if 1 and 9 are merely non-negative measurable functions, let {In} and {gn} be monotone increasing sequences of simple functions approximating 1 and g. Then {In + gn} is a monotone increasing sequence of simple functions approximating / +g, so from I (/n +gn)dIJ = I IndIJ + J gndIJ we obtain J(I + g)dIJ = J IdIJ + J gdJJ by passing to the limit. In a similar way we can prove the following theorem. Theorem 14.3.3 The integral 01 non-negative measurable functions � a. linear, J(al + bg)dIJ = a J IdIJ + b J gdIJ il a and b are non­ negative reals; b. monotone, J I dIJ > J gdIJ if / > g; c. additive, JAUB fdIJ = JA /dJJ + 18 fdIJ for A and B disjoint mea­ surable sets, where IA fdIJ denotes I fxAdIJ. 14.3 The Integral 663 Note that if J-L is Lebesgue measure and A is an interval (a, b) , then J A f dJ-L plays the role of J: f (x) dx in the Riemann theory of in­ tegration. In fact it is easy to see that if f is Riemann integrable, then the two must be equal. Indeed if f is Riemann integrable the Riemann upper and lower sums for any partition of (a, b) are integral­ s of step functions 9 and h such that 9 < f < h on ( a, b) and the step functions are just simple functions constant on intervals. Thus J gdJ-L < J fX(a,b) dJ-L < J hdJ-L by the monotonicity of the Lebesgue in- tegral; hence, J fX(a,b)dJ-L = J: f(x) dx (of course a separate, technical argument must first be given to show that if f is Riemann integrable then f is measurable so J fX(a,b) dJ-L is defined). Since the Riemann and Lebesgue integrals agree on their common domain of definition, we will not insist on separate notation and will write J: f (x) dx for the Lebesgue integral as well. The monotone convergence theorem gives us a criterion for inter­ changing limits and integrals for non-negative functions, and we have seen some examples in which the interchange is not valid. One feature of these examples is that they both result in a \"loss of mass\" in pass­ ing to the limit-the limiting function has a smaller integral than the limit of the integrals. It turns out that this is always the case-it is impossible to gain mass by passing to a limit. This is a special case of a famous theorem of Fatou. Theorem 14.3.4 (Fatou 's Theorem) Let f = limn_oo fn where fn are non-negative measurable functions. If limn_oo J fndJ-L exists, then J fdJ-L < limn_oo J fndJ-L . Proof: The idea of the proof is to replace the sequence {fn} by a monotone increasing sequence {gn} with the same limit. A lit­ tle thought shows that gn = inf k�n fk will do the job. Note that gn < fn, so J gndJ-L < J fndJ-L and passing to the limit limn_oo J gndJ-L < limn_oo J fndJ-L. But limn_oo J gndJ-L = J fdJ-L by the monotone conver­ gence theorem. QED Actually the full Fatou's Theorem says J lim infn_oo fndJ-L < lim infn_oo J fndJ-L even when lim fn and lim J fndJ-L are not assumed to exist, as long as fn are assumed non-negative. We leave it as an ex­ ercise to verfiy that essentially the same argument works in this case. 664 Chapter 14 The Lebesgue Integral 14.3.3 Integrable Functions We have now discussed all the important properties of the integral of non-negative measurable functions, and we would like to pass to the general case of measurable real-valued functions. We can always write I = 1+ - 1- and so we will define J IdIJ = J 1+ dIJ - J 1- dIJ provided both terms are finite. For non-negative functions we could afford the luxury of allowing a value of +00 for the integral-this allowed us to define the integral for every measurable non-negative function and ac­ tually simplified the statements of the theorems. For real-valued func­ tions, however, we have to avoid dealing with expressions like 00 - 00 and so make the definition that a measurable function is integrable if 1+ and 1- both have finite integrals. We then define the integral J IdIJ = J l+dIJ - J l-dIJ for integrable functions only. The terminol­ ogy is slightly confusing in that we have previously defined an integral for all non-negative measurable functions, including those that are not integrable, and we do not wish to recant. It does mean that you will have to adjust to the possibility that a function that isn't integrable may have an integral (but the integral won't be finite). Notice that III = 1+ + 1- , so a measurable function I is inte­ grable if and only if III is integrable and we have Minkowski's inequality I J IdIJI < J IfldlJ· It is in this sense that we say the Lebesgue integral is an absolutely convergent integral. In particular, certain improper Riemann integrals whose convergence depends on cancellation (such as Jo oo (sin x/x) dx) are not subsumed in the Lebesgue theory. If IJ denotes counting measure on {I, 2, 3, . .. }, then the integrable functions are the absolutely convergent series, with the integral equal to the sum of the series (see exercise set 14.3.5, number 9) . From the properties of the integral of non-negative functions it is simple to deduce the corresponding properties of the integral of real­ valued integrable functions. In particular, it is linear (with real coeffi­ cients), monotone, and additive. For example, let's show J(I + g)dIJ = J IdIJ + J gdIJ· This would follow immediately if we had (I + g)+ = 1+ + g+ , but this need not be the case since the pos­ itive and negative parts of f and 9 can overlap. Nevertheless, from 1= f+ - 1- and 9 = g+ - g- we obtain 1 + 9 = 1+ + g+ - (/- + g- ). We also have / + 9 - (I + g)+ - (/ + g) -, so by equating the two we obtain 1+ + g+ - (/- + g- ) = (I + g)+ - (/ + g)- , which 14. 3 The Integral 665 we can rewrite as an equality between sums of non-negative functions, 1+ + g+ + (I + g) - = 1- + g- + (I + g) + . We integrate this equality and use the linearity of the integral of non-negative functions to interchange the finite sums and the integral: Finally we rewrite this as J (J + g) + d{l - J (J + g) - d{l (J f+ d{l - J rd{l) + (J g+ d{l - J g- d{l) , which says J(/+g)dJ-L = J IdJ-L + J gdJ-L. (A separate argument to show that all these integrals are finite must be given to justify the rearrange­ ment of terms.) The derivation of the other properties is similar, and we leave it to the exercises. We can also define an integral for complex­ valued measurable functions by splitting into real and imaginary parts. Again we leave the details as an exercise. The monotone convergence theorem, on the other hand, does not extend to real-valued functions. Now some sort of interchange of limit and integral is vital to a good theory; essentially the only way to com­ pute the integral of \"new\" functions I is to write I = limk_oo Ik where Ik are functions whose integrals we can compute by elementary means and then to compute J IdJ-L = limk_oo J Ik dJ-L by quoting the appropri­ ate theorem. Thus we need to find a good substitute for the monotone convergence theorem. Lebesgue's dominated convergence theorem will serve this purpose very well. This theorem is motivated by the follow­ ing elementary observation: if 9 is a non-negative integrable function and I is a measurable real-valued function such that III < g, then I is integrable. This follows immediately from the two facts III < 9 implies J I/ldJ-L < J gdJ-L and J I/ldJ-L < 00 implies I is integrable. If III < 9 we say that 9 dominates I. It implies that the graph of I lies between the graphs of +g and -g, a region (shown in Figure 14.3.2) that has finite \"area\" since 9 is integrable. Now if {In} is a sequence of measurable functions, each of which is dominated by g, then the graphs of In are all contained in this region of finite area and so it is plausible that there is no room for any mass to leak out when we pass to the limit. 666 Chapter 14 The Lebesgue Integral Figure 14.3.2: If we look back at the examples where the limit and the integral cannot be interchanged, we see that the smallest function that dominates all the fn is essentially l/x, and this function just fails to be integrable. Theorem 14.3.5 (Dominated Convergence Theorem) Let {fn} be a sequence of measurable functions converging pointwise to f. If there exists an integrable function 9 such that Ifn (x) 1 < g(x) for all n and x, then f is integrable and J fdJ1- = limn-+oo J fndJ1- . Proof: Assume first limn-+oo J fndJ1- exists. Then {g - fn} and {g + fn } are sequences of non-negative measurable functions converging to 9 - f and 9 + f· Since 9 dominates f, f is integrable. By Fatou's theorem J (g ± f)dlJ < Ji.� J (g ± fn)dlJ Ji.� U gdlJ ± J fndlJ) J gdlJ ± Ji.� J fndlJ and by subtracting the finite term J gdJ1- from both sides the inequality we obtain ± J fdJ1- < ± limn-+oo J fndJ1-, which implies the equality. Without the assumption that J fndJ1- converges we first pass to a convergent subsequence (the sequence {J fndJ1-} is bounded since I J fndJ1- 1 < J Ifn ldJ1- < J gdJ1-) and then conclude lim J fnl dJ1- = J fdJ1- along the subsequence. Since this is true for any convergent subse­ quence, we conclude that the whole sequence converges to J fdJ1-. QED 14 .3 The Integral 667 One important special case of this theorem is the following: if the measure of the whole space is finite and the sequence f n is uniformly bounded, then limn---+oo I fndJ.1. = I limn---+oo fndJ.1.. In this case we can take 9 - M where M = sUPn,x Ifn(x) l· 14.3.4 Almost Everywhere Suppose f and 9 are two measurable functions that are equal except on a set of measure zero, f(x) = g(x) if x is not in E with J.1.(E) = O. Then we say f = 9 almost everywhere, abbreviated a.e. More generally we say of any property that it holds a.e. if it is true for all x except for x in a set of measure zero. Because sets of measure zero are preserved under finite and even countable unions, the a.e. concept is suitably flexible. For instance, if h = gl a.e. and f2 = g2 a.e., then h + f2 = gl + g2 a.e. ; or if f n = gn a.e. for all n, then limn---+oo f n = limn---+oo gn a.e. Since sets of measure zero cannot contribute to the integral, we expect that functions equal almost everywhere should be more or less interchangable when integrated. Theorem 14.3.6 Let f and g be integrable functions. Then f = 9 a. e. if and only if IA fdJ.1. = IA gdJ.1. for every measurable set A. Proof: Suppose f = 9 a.e. Then we can write f = g + h where h = 0 a.e. To show I fdJ.1. = I gdJ.1. it suffices to show I hdJ.1. = O. Now h = 0 a.e. implies h+ = 0 a.e. and h- = 0 a.e., so it suffices to show I hdJ.1. = 0 if h = 0 a.e. and h is non-negative. But I hdJ.1. = limn---+oo I hndJ.1. for a sequence of simple non-negative functions increasing monotonically to h. Since 0 < hn < h, we have hn = 0 a.e., so hn = I:t'::1 akXAk with J.1.(Ak) = O. It follows that I hkdJ.1. = I:t'::1 akJ.1.(Ak) = 0, hence I hdJ.1. = O. More generally, if A is any measurable set , then f = 9 a.e. implies fXA = gXA a.e., so the above argument shows fA fdp = f4. gdp. Conversely, suppose IA fdJ.1. = IA gdJ.1. for every measurable set A. Apply this to the measurable set An = {x : f(x) < g(x) - lin}. Then IAn fdJ.1. < IAn (g - l /n)dJ.1. by monotonicity; hence, 668 Chapter 14 The Lebesgue Integral which contradicts fAn Idp, = fAn gdp, unless P,(An) = O. Now P,{U�=l An} = 0 by a-additivity, so I(x) > g(x) a.e. Interchanging 1 and 9 gives g(x) > I(x) a.e., hence I(x) = g(x) a.e. QED This result means that whenever we have a theorem about integrals, we can replace any condition that is supposed to hold for every x by the same condition a.e. For example, in the dominated convergence theorem, we need only assume limn-+oo In (x) = I(x) a.e. and I ln (x) 1 < g(x) . a.e. The almost everywhere concept has some rather paradoxical conse­ quences. For example, with respect to Lebesgue measure, an individual point, or even a countable set of points, has measure zero. Thus as far as integration theory is concerned, the value of a function 1 (x) at an individual point x is immaterial. We can always find 9 = 1 a.e. that takes a different value at x. If we think of all the functions equal to 1 a.e. as forming an equivalen�e class, then there is no meaning within this equivalence class of the value at an individual point. Nevertheless, how can we know the function if we don't know its value at any point? There is a resolution to this paradox, but it is beyond the scope of this book. The Lebesgue Differentiation of the Integral Theorem says that the \"average value\" limr-+o (1/2r) f:�: I(y) dy exists for almost every x, and this provides a \"canonical\" choice of value for 1 (x) for such points. The \"average values\" are unchanged if we change 1 on a set of measure zero. 14.3.5 Exercises 1. Let (X, :F) be a measurable space. Prove that 1 : X -+ lR is a measurable function if and only if 1- 1 (B) is in :F for every set B in a collection B of sets with the property that the smallest a-field containing B is the a-field of Borel sets. Verify that this is the case if B consists of all intervals ( a, 00) . 2. Prove that if 1 : X -+ lR and 9 : X -+ lR are measurable, then max(l, g) is measurable. 3. Prove that if 1 : X -+ lR is measurable and h : lR -+ lR is measur­ able (with respect to the a-field of Borel sets in lR) , then hoi is measurable. 14.3 The Integral 669 4. Prove that if L:r=l akXAk = L:t!:1 bj XBj for every x, then L:r=l akJ-t (Ak) = L:t!:1 bj J-t( Bj ). 5. Prove directly that if L:r=l akXAk < L:t!:1 bj XBj for every x, then L:r=l akJ-t(Ak) < L:t!:1 bj J-t(Bj). 6. Write out a complete proof that the integral is linear, monotone, and additive first for non-negative simple functions, then for non-negative measurable functions, and finally for integrable functions. 7. Prove that a Riemann integrable function on a bounded interval is measurable. (Hint: it is the pointwise limit a.e. of the step functions involved in the Riemann upper and lower approximate sums.) 8. Prove that if {In} is any sequence of nonnegative measurable func­ tions, then J lim infn-+oo IndJ-t < lim infn-+oo J IndJ-t. 9. Prove that a series L:�=1 an is absolutely convergent if and only if the function n -? an on the positive integers is integrable with respect to counting measure. 10. Prove that L:�=1 J IndJ-t = J(L:�=l In ) dJ-t if In are non-negative measurable functions. 11. Suppose In are measurable functions and L:�=1 Iln l is integrable. Prove that L:�=1 In is integrable and J (L:�=1 In)dJ-t L:�=1 J fndJ-t. 12. Restate the results of problems 10 and 11 when J-t is counting mea­ sure on the positive integers in terms of doubly indexed infinite serIes. 13. Let F = I + ig be . a complex-valued function. Define it to be integrable if I and 9 are integrable, and define J (I + ig )dJ-t = J f dJ-t + i J gdJ-t. Prove that F is integrable if and only if f and 9 are measurable and IFI is integrable, and prove Minkowski's inequality If FdJ-t1 < J IFldJ-t. 14. Prove that a non-negative measurable function has integral equal to zero if and only if it is zero a.e. 670 Chapter 14 The Lebesgue Integral 15. Prove that if f is a nonnegative integrable function, then II (A) = fA fdJ.l is a measure on the same a-field on which J.l is defined. 16. Prove that under the hypotheses of the Dominated Convergence Theorem one has liIDn_oo f l In - /ldIJ = o. 17. Explain why Fatou's Theorem shows that the \"hard\" inequality in the proof of the Monotone Convergence Theorem is always valid, even without the assumption of monotonicity. Did the proof of this part of the theorem use the hypothesis of monotonicity? Why can't we use Fatou's theorem to simplify the proof of the Monotone Convergence Theorem? 14.4 The Lebesgue Spaces Ll and L2 14.4.1 L1 as a Banach Space We have already seen the utility of thinking of a set of functions as forming a \"space\" on which certain structures are defined. We particu­ larly made use of the space C(I) of continuous functions on a compact interval I, which is a vector space and has a natural metric space struc­ ture given by the sup-norm 1I/IIsup = sup! I/(x)l. One of the reasons the space C(I) with this metric is so useful is that it is complete, so we can apply the contractive mapping principle, for example. We observed that there are also other norms on this space, 11/111 = f1 1/(x)1 dx and 111112 = (f1 1/(x)12dx)1/2, the 2-norm even being associated with an in­ ner product (I, g) = II /(x)g(x)dx. But the space C(I) is not complete with respect to these norms. In this section we will see how with the aid of Lebesgue integration we can construct complete spaces with these norms, called Ll (I) and L2(I). These will be concrete realizations of the \"completions\" of C(I) with respect to these norms (analogous to the real numbers as completion of the rationals). Recall that a complete normed vector space is called a Banach space. Thus we are construct­ ing two more examples of a Banach space. The study of Banach spaces is one of the central topics in twentieth century analysis. We will also give some applications of the space L2([_1r, 1r]) to Fourier series. This is not surprising if you recall the role of the inner product in defining Fourier coefficients and in the derivation of Parseval's identity. 14.4 The Lebesgue Spaces L1 and L2 611 Let us consider the space of integrable functions on an interval or more generally on a measure space (X, :F, IJ). Recall the definition: these are function I : X � lR that are measurable and for which J 1+ dIJ and J 1-dIJ are finite. It is also important sometimes to con­ sider complex-valued functions, F: X � C with F = 1+ ig and I and 9 real-valued integrable functions. Unless we specify otherwise, every­ thing we say pertains to either case, although we will usually discuss the real-valued case for simplicity. Now it is easy to see that the inte­ grable functions form a vector space, and we can define 11/111 = J I/ldIJ. However, when we check the definition of the norm, we find one prob­ lem: the statement \"I I/I It = 0 implies 1=0\" is not correct. In fact we have established that J I/ldIJ = 0 if and only if I = 0 a.e., and except in certain special cases (such as counting measure), there are functions I = 0 a.e. that are not identically zero. To overcome this difficulty we are forced to consider equivalence classes of functions that are equal a.e. In other words we say I is equivalent to 9 if I = 9 a.e. It is easy to see that this is an equivalence relation, so the measurable functions divide into equivalence classes. We then define L1 (IJ) to be the set of equivalence classes of integrable functions. It is easy to show that the vector space structure of functions respects equivalence classes: al + bg is equivalent to air + bg1 if I is equivalent to Ir and 9 is equivalent to g2 (al + bg = al1 + bg1 except on the union of the sets where I # Ir and 9 # gl , and the union of two sets of measure zero has measure zero). We can then define the norm of an equivalence class to be 1I/Ib = J I/ldIJ for any I in the equivalence class since the value of IIfll l is constant on the equivalence class. We will follow the usual convention of conlounding the equivalence class and a representative junction I in the equivalence class. This is, when we say \"let I be a function in Ll (IJ}\", we really mean \"let I be a representative function in an equivalence class in L1 (IJ)\" , with the understanding that nothing we do to I depends on the particular choice of representative. This convention spares us from overburdening the notation, but it does mean that one has to be careful interpreting statements. Now it is a straightforward matter to verify that II I II I satisfies the axioms for a norm on L1 (IJ). The triangle inequality comes from inte­ grating the pointwise inequality I/(x) + g(x}1 < If(x} 1 + Ig(x} l, and the homogeneity is obvious. The troublesome positivity condition, 11/111 = 0 implies f = 0, is built into the definition because now f = 0 612 Chapter 14 The Lebesgue Integral means I and 0 are in the same equivalence class, I = 0 a.e. We want to prove that Ll (I-') is complete in this norm. Recall that this means that every Cauchy sequence converges. Lemma 14.4. 1 ( Chebyshev's Inequality) Let I be in L1 (IJ), and let 8 > O. Then IJ(Es) < II/lh/s where Es = {x : I/(x) 1 > 8}. Proof: IE. III dIJ < I III dIJ = 11/11t· On the other hand 8 < Ili on Es, so IE. s dIJ < IE. III dIJ and IE. 8 dIJ = sIJ(E,). QED Theorem 14.4.1 Ll (l-') is complete. Proof: Let {/k} denote a Cauchy sequence in Ll (IJ). As usual it suffices to show that a subsequence converges, for the convergence of the subsequence and the Cauchy criterion will give the convergence of the original sequence. Now we pass to a subsequence that comes together rapidly, say 11/�+1 - Ik ll < 4-k (we choose 4-k for convenience only; actually we only need a sequence e k with E e k < 00) . It is a routine matter to obtain such a SUbsequence: Given k, we choose j(k} depending on k so that j(k) > j(k - 1) and II/j(k) - Imll < 4-k for all m > j(k), such j(k) existing by the Cauchy criterion, and then set lie = Ij(k)' Since j(k + 1) > j(k), we have II/j(k) - Ij(k+l)II < 4-k as desired. For simplicity of notation we denote the subsequence by {/k}. Now the remarkable fact is that for this subsequence we have con .. vergence at almost every point. This fact will enable us to get a hold of the limit function. To verify it we define the sets and estimate the measure of En by Chebyshev's inequality as 00 I-'(En} < L IJ{x : I/k+l (x) - Ik(X)1 > n2-k} k=1 00 1 < L: -2klllk+l - Ikllt k=1 n 00 < L: !.2k . 4-k = !.. k=1 n n 14.4 The Lebesgue Spaces L1 and L2 673 The measure of En is small, but on the complement of En the sequence {Ik} clearly converges pointwise by comparison; write gk = Ik - Ik-1 for k > 2, gl = il , so Ik = 2:1=1 gj and Igk(x) 1 < n2-k for every k on the complement of En and 2:k n2-k converges. Thus {Ik} converges pointwise on the complement of n�=l En , which has measure zero. We may now set I(x) = limk-+oo Ik (X) = 2:::1 9k (X) on the set where the limit exists and set I (x) = 0 on the set of measure zero where the limit fails to exist. By redefining Ik (X) to be zero also on this set of measure zero (this just means choosing a different representative of the equivalence class) we have I ( x) = limx-+oo I k (x) at every point , so I is a measurable function. We need to show that I is integrable and limk-+oo I llk - 1 1 1 1 = 0 to complete the proof. To do this we will need both the monotone and dominated convergence theorems. We first consider 9 = 2:::1 Igk l , which converges a.e. by the above argument. This will essentially be our dominator. Notice that since I lgk l h < 4-k for k = 2, 3, ... and the Igk I are non-negative measurable functions, we can apply the monotone convergence theorem to conclude J gdjJ = I= J IgkldjJ < Il hl l + I= 4-k < 00, k=l k=2 so 9 is integrable. This shows that I is integrable also since I I I 1 2:::1 gk l < g. Finally Ilk - I I < I lk l + III = � g; + III < (� lg; l) + III < 2 1gl, so we may apply the dominated convergence theorem to the sequence {Ilk - II }· Since limk-+oo Ilk - II = 0 a.e, we have limk-+oo J Ilk - Iid/-L = J 0 d/-L = 0 as desired. QED 14.4.2 L2 as a Hilbert Space Althought the space L1 (/-L) of integrable functions is very natural to consider, it turns out for technical reasons to be less useful than the space L2 (/-L) of measurable functions for which 1 1 12 is integrable. Our discussion of L2 (/-L) follows the same outline as before. We will again be dealing with equivalence classes of functions, although we will not indi­ cate this in the notation. In the case of L2 (/-L) , however, we encounter 674 Chapter 14 The Lebesgue Integral a new difficulty: it is by no means obvious that L2 (IJ) forms a vector space. If 1/12 and Igl2 are integrable, why is II + gl2 integrable? Taking the real case for simplicity, we can write (I + g)2 = 12 + 21g + g2 , so we need to show that I · 9 is integrable. If this were the case, then we could define an inner product (I, g) = J IgdIJ (put 9 in the complex case) , and the norm 11/112 = (f 1/12dIJ)1/2 would be associated to this inner product. Furthermore, the Cauchy-Schwartz inequality would say which would in turn imply that Ig is integrable since III and Igl have the same norm as I and g. We seem to be caught in circular reasoning­ I . 9 integrable implies that the Cauchy-Schwartz inequality implies I . 9 integrable. The way out of this circle is first to consider simple functions where the integrability of I 9 is obvious. Theorem 14.4.2 (Cauchy-Schwartz Inequality) If 1/12 and 1912 are in­ tegrable, then I 9 is integrable and Proof: Let V denote the vector space of (equivalence classes of) simple functions L�=l akXA\" where IJ(Ak) < 00 for each k. It is s­ traightforward to verify that V is a vector space and (I, g) = f IgdIJ defines an inner product on V. Thus we have the Cauchy-Schwartz inequality 1(/, g}1 < 1I/I12 11g1 12 for I and 9 in V, and replacing I and 9 by III and 191 we obtain f 1/91dIJ < 11/112 119112 on V. Now let I and 9 belong to L2 (IJ). Then Ig is measurable, so we need to show J IlgldlJ is finite. But if {In} and {gn} are sequences of non-negative simple functions increasing monotonically to III and Igl, then {/ngn} is a sequence of non-negative simple functions increasing monotonically to Ilgl. Furthermore it is easy to see that In and gn must be in V. If say In = L:�=l akXAA: with all ak :/; 0, then I� = E�=l a�XAA: and I� < 1/12 implies J l�dIJ < J 1/12dJ.' < 00, so J.'(Ak) < 00 for all k. Thus f i/n9nid/l < 1I!nII2ii9nll2 < 11/112 119112 14.4 The Lebesgue Spaces Ll and L2 675 and taking the limit as n -+ 00 gives J I fgldt-t < II f 1 l 2 11g112 ' showing that f 9 is integrable. QED It is now a straightforward matter to verify that L2 (t-t) forms a vector space and (f, g) = J fgdt-t defines an inner product on L2 (t-t) . What is the relationship between functions in L1 (t-t) and L2 (t-t)? If the measure of the whole space t-t(X) is finite, then we have the containment L2 (t-t) C Ll (t-t). Indeed taking 9 = 1 in the Cauchy-Schwartz inequality we obtain On the other hand, if t-t(X) = +00, then there are functions in L2 (t-t) that are not in Ll (t-t). Looking at Lebesgue measure on the line, we can say roughly speaking that to be in L2 (t-t) is a more restrictive condition concerning local behavior of singularities but a less restrictive condition concerning decay at infinity. Thus if f (x) = (1 + Ix I ) -a, then f is in L2 if and only if a > 1/2 while f is in Ll if and only if a > 1. On the other hand if f(x) = Ix l -axlxl::;1 , then f is in L2 if and only if a < 1/2 while f is in L1 if and only if a < 1. Finally, if t-t is counting measure, the containment is reversed: Ll is contained in L2 (the usual notation for counting measure is II and 12 ). Theorem 14.4. 3 L2 (t-t) is complete. Proof: The proof follows the same pattern as the proof of the com­ pleteness of Ll (t-t). We take a Cauchy sequence {fk} in L2 (t-t), pass to a subsequence such that IIgkll2 < 4-k where gk = fk - fk-1 , and then show that fk = 2:;=1 gj converges a.e. The only difference in the proof is that we use the L2 Chebyshev inequality J.L {x : If (x) I > 8} < (1/82 ) II ! II � , which follows by the same reasoning. We then set f = 2:�1 gj and 9 = 2:�1 Igj I so that I fl2 < Ig1 2 , and we prove Ig l2 is integrable by the monotone convergence theorem (here we estimate II 2:;=1 Igj 11 12 < 2:;=1 IIgj 112 by the triangle inequality for the norm) . This shows that f is in L2 (t-t) and then 21g 12 serves to dominate the sequence I f - fkl2 , so limk_o J I f - fkl2dt-t = 0 by the dominated convergence theorem; hence fk -+ f in the metric. QED 676 Chapter 14 The Lebesgue Integral A complete inner product space is called a Hilbert space. L2 (/-L) is a typical example of a Hilbert space. This is the setting for quantum mechanics, where /-L is Lebesgue measure on some Euclidean space (or more generally the classical configuration space of the system being studied) . 14.4.3 Fourier Series for L2 Functions We now consider the case where X = [-11\", 11\"] and /-L is Lebesgue mea­ sure, and we study Fourier series for functions in L2. We observe that the definition of the Fourier coefficients 1 j7r . en = - l(x)e-mX dx 211\" -7r makes sense for any 1 in L1 if we interpret the integral as a Lebesgue integral. Indeed if I(x) is integrable, then I(x)e-inx will also be inte­ grable since it is the product of measurable functions, hence measur­ able, and I/(x)e-inxl = I/(x) l, so - I/(x)e-mxl dx = - I/ (x) 1 dx = - 11/1 1 1 < 00. 1 j7r . 1 j7r 1 211\" -7r 211\" -7r 211\" We can then at least write the formal Fourier series L:�oo cneinx and ask if it converges to 1 in any sense. Unfortunately there is no good answer to this question in L1 , so we restrict attention to L2 functions (recall that L2 C L1 here because /-L(X) = 211\" is finite) . Now for continuous functions we have established Parseval's identity and the mean convergence It would seem plausible that this would continue to hold for 1 in L2 . We will show that this is in fact the case and, furthermore, that every choice of Fourier coefficients for which L: Icnl2 is finite corresponds to 14.4 The Lebesgue Spaces L1 and L2 677 some L2 function. What this means is that the Fourier coefficients give a one-to-one correspondence between L2 functions and l2 sequences {en } such that 2:�00 len l2 < 00. Furthermore this correspondence is linear and isometric so that in fact it shows the Hilbert space structure of L2 ( -7r, 1r) and l2 are isomorphic. We begin by studying the correspondence in the direction {cn} -+ I. Theorem 14.4.4 (Riesz-Fischer) Let complex coefficients en be giv­ en with 2:�00 lenl2 < 00. Then there exists complex I in L2 ( -7r, 7r) with en = (1/21r) J�7r I(x)e-inx dx such that (1/27r) J�7r I/(x) 12 dx 2:�00 lenl2 and limN_oo III - 2:�N cneinx l 12 = o . N . Proof: Let IN = 2:-N enemx. Because of the orthogonality of the functions einx with respect to the inner product we have 2 II/N - IM II� = N<lnl;5M 2 N<lnl;5M if N < M (the factor 27r appears here and not in Chapter 12 because we have not divided by 21r in defining the inner product) . From this and the fact that 2:�00 Icn l2 < 00 it follows easily that IN is a Cauchy sequence in L2. By the completeness of L2 it converges to some I in L2 in the norm, limN_ oo III - IN I 12 = o. Since I - IN and IN are orthogonal, we obtain 2� 11/11� Finally 1 j7r . - l(x)e-mX dx 27r -7r -00 1 j 7r . - 2 hv (x)e-mX dx 1r -7r 1 j 7r . + - (/(x) - IN (x))e-mX dx 27r -7r 1 j7r . en + - (f(x) - IN (x) )e-mX dx 27r -7r 678 Chapter 14 The Lebesgue Integral for any N > n. But 1 1� . - (I(x) - IN (x))e-mX dx 27r _� < 2� (1: 1/(.,) - IN (.,Wdz ) 1/2 (1: 12 d.,) 1/2 1 /tL III - flv ll2 -? 0 as N -? 00, v 27r so en = (1/27r) r:� I(x }e-inx dx. QED For the converse result we will have to work harder, because it essentially depends on the fact that we haven't left out any functions (note that the Riesz-Fischer theorem remains true if we omit some of the exponentials einx). Now we have already verified this completeness of the exponentials einx in the context of continuous functions, but there remains the possibility that by enlarging to the class L2 we have created some new functions that are orthogonal to all the exponentials. The reason this is not the case is that the continuous functions are already dense in L2 . Therefore we first must prove this density result. Incidentally, the analogous statement is true for L 1 , and the proof is essentially the same. Theorem 14.4.5 (Density 01 Continuous Functions) Let I be in L2 ( -7r, 7r} . Then there exists a sequence 01 continuous functions In ( with In ( -7r) = In (7r) , so In extends to a continuous periodic function) such that Illn - 1112 -? 0 as n -? 00. Proof: It clearly suffices to do this for non-negative I (approximate 1+ and 1- separately in the real case) , and from the definition of J f2dJJ it is clear that there exists a sequence of simple functions In such that I lf - In l12 -? O. Thus it suffuces to show that a simple function can be approximated by continuous functions. Again it is clear that it suffices to do this for characteristic functions I = XA where A is a measurable set. Now recall that JJ(A} was defined to be the infimum of L:�l IIj I where U�l Ij covers A and Ij are intervals. Without loss of generality we may assume the intervals Ij are disjoint, and given any c > 0 we can choose the intervals so that U�l Ij = AUB, with A and B disjoint, and 14.4 The Lebesgue Spaces L1 and L2 679 JJ(B) < c. We can also choose N large enough so that E�N+I IIj I < c. Thus XA and Ef=1 Xlj are equal except on a set of measure at most 2c, so I l xA - Ef=1 Xlj 112 < .j2e. Finally XI · can clearly be approximated by continous functions in J the L2-norm, as indicated in Figure 14.4.1, and we can always arrange these approximating functions to vanish at ±1T. J. ) Figure 14.4. 1: Adding together all these approximations in the usual way we ob­ tain the result. QED Theorem 14.4.6 (Parseval Identity) Let I be In L2 (1T, 1T} . Then IISN I - 1112 � 0 and (1/21T)11/1I� = E�oo len l2 • Proof: Let {Ik} be a sequence of continuous functions such that Il/k - 1112 � 0 as k � 00. We have already proved the result for the functions Ik' so we want to get the result for I by passing to the limit. Given any error c we can first find Ik so that / Ilk - 1112 < c/2 and then choose N large enough so that II SN Ik - Ik ll2 < c/2, so IISN Ik - 1112 < c. But we can apply the projection theorem to 1 to conclude that S N I minimizes the distance to 1 among all trigonometric polynomials E�N aneinz, so liS N 1 - 1112 < liS N Ik - 1112 < c (recall that for the projection theorem we needed only to have an inner product space, so L2 (-1T, 1T) will do}. This shows limN_oo I ISN/ - /112 = 0 and so also II/II� = limN_oo IISN/II� = limN_oo 21T E�N len l2 = 21T E�oo len l2• QED The Parseval identity gives us the converse of the Riesz-Fischer theorem. If we start with 1 E L2 we produce a sequence {Ck } in l2, the Fourier coefficients, and recover f as the limit of t�N cneinx 680 Chapter 14 The Lebesgue Integral in the L2 norm. The correspondence f H {Ck} is thus an isometric isomorphism, which is onto in both directions. We also obtain as a corollary the completeness of the orthogonal system einx. Corollary 14.4.1 If f in L2 is orthogonal to all the functions einx, then f is zero. Proof: The orthogonality means en = 0 for all n, hence II f l12 = 0 by the Parseval identity. This means f = 0 a.e. The importance of these results is that they show that Fourier series are well behaved on the space of L2 functions. We can recognize an L2 function from its Fourier coefficients, and we can always interpret the Fourier series as converging in L2 norm. We give one typical application to the heat equation. Theorem 14.4.7 Let {en} by any sequence satisfying 2:c:'00 Icn l2 < 00 . Then u(x, t) = 2:c:'00 e-n2teneinx for t > 0 is a solution of the heat equation Bu/Bt = B2u/Bx2 that is periodic of period 211\" in x, and SUPt>o J':7I\" lu(x, t) 1 2 dx is finite. Furthermore J':7I\" lu(x, t) - f(x) 12 dx .,. o as t .,. 0+ where f = J�oo eneinx. Conversely, every solution of the heat equation in t > 0 that is periodic of period 211\" in x and such that SUPt>o J::7I\" lu(x, t) 12 dx is finite has the above form. Proof: For any fixed t > 0 the series 2:c:'00 e-n2t cneinx converges absolutely and uniformly in x by comparison with 00 ( 00 ) 1/2 ( 00 ) 1/2 � ICn le-n2, < � ICn l2 � e-2n2, < 00 by the Cauchy-Schwartz inequality. Thus u is continuous. Further­ more if we formally differentiate with respect to t or x any number of times, the series remains uniformly convergent because the derivatives just produce polynomial factors in n, and we can repeat the previous argument since 2:c:'00 n2ke-2n2t is finite for any k. Thus u is Coo in t > 0 and the series may be differentiated term-by-term, so u satisfies the heat equation. By Parseval's identity we have i: lu (x, t) I2 dx = 2\" f I Cn 12e-2n2, -00 14.4 The Lebesgue Spaces Ll and L2 681 -00 so SUPt>o J�1r lu(x, t) 12 dx is finite; also by Parseval's identity we have and this goes to zero as t � 0+ by the dominated convergence theorem for counting measure (len I2(1 - e-n2t)2 goes to zero pointwise and is dominated by the integrable lenI2). For the converse, assume u(x, t) is a solution to the heat equa­ tion in t > o. Then we have already shown in Chapter 12 that 2 . u(x, t) = E e-n tene,nx for some coefficients en. Now we add the con- dition that f�1r lu(x, t) 12 dx < M for all t > o. By Parseval's identity this is E:1I' IenI2e-2n2t < M/21r. Finally we let t � 0 and apply the monotone convergence theorem (e-2n2t lenI2 � lenl2 monotonically) to conclude that E�oo len l2 must be finite. QED 14.4.4 Exercises 1. Prove the V Chebyshev's inequality: if 1/11' is integrable (for fixed p > 0), then �{x : I/(x)1 > s} < (1/81') f I/IPd�. 2. Prove that II C 12 (recall lP means lJ' for counting measure) . 3. Prove that if I is in Ll and I is bounded, then I is in L2. 4. Give an example of a function on the line that is in Ll but not L2 and one that is in L2 but not Ll . S. Prove that if I is any Ll function such that f�1I' I(x)e-inx dx = 0 for all n, then I = 0 a.e. 6. Prove the Riemann-Lebesgue Lemma: if I is in Ll , then liIDn_:oo en = o. (Bint: use the density of continuous functions in L 1 and Parseval '8 identity. ) 1. Let I be in L2 ( -1r, 1r) , and extend I to be periodic of period 21r. Prove the continuity of translation in L 2: if h( t) = f�1I' I I (x + t) - l(x) 12 dx, then llmt_o h(t) = o. (Hint: use density of continuous functions.) State and prove the analogous result for Ll . 682 Chapter 14 The Lebesgue Integral 8. Prove that if u(x, t) is a solution to the heat equation in t > 0 that is periodic of period 21r and for which SUPt>o J::1r lu(x, t) l2 dx is finite, then there exists a constant c such that u(x, t) � c uniformly as t � 00. 9. Consider the Laplace equation (82/8x2 + 82 /8y2)u(x, y) = 0 in x2 + y2 < 1 subject to the restriction L: iu(r cos8, r sin 8Wd8 < M for 0 < r < 1. Prove that u(r cos 8, r sin 8) = E�oo enrlnlein8 gives a solution for every choice of en with E�oo lenl2 finite and conversely that all solutions have this form. 10. Give an example of a sequence of functions fn(x) on [0, 1] such that J� Ifn(x) 1 dx � 0 as n � 00 but fn(x) does not converge to zero for any x in [0, 1]. Can you make the functions fn continuous? 14.5 Summary 14.1 The Concept of Measure Example Dirichlet 's function on [0, 1] f(x) = { O i! x � i�tional, 1 if x IS rational is not Riemann integrable, even though it is the pointwise limit of Rie­ mann integrable functions. Example Let f n (x) = { n if 0 < � < 1/ n, o othenmse. Then Jo1 (limn_oo fn(x)) dx =1: limn_oo J� fn(x) dx. 14.5 Summary 683 Lemma 14.1.1 Let II , 12 , . .. be disjoint intervals such that I = II U 12 U .. . is also an interval. Then III = 2:�1 IIj I where III denotes the length of the interval I. Corollary 14.1.1 If I is any interval, then III = inf {� IIj I : I C jQ Ij } . Definition A collection F of subsets of a fixed set X (the universe) is called a field of sets if 1. the empty set is in F; 2. if A is in F, then the complement of A is in F; and 3. if A and B are in F, then Au B is in F. A field of sets is called a a-field if in addition 4. if AI , A2, .. . is a sequence of sets in F, then U�I Aj is in F. Definition The a-field generated by the field F, denoted FO', is the smallest a-field containing F or, equivalently, the intersection of all a­ fields containing F. The (I-field generated by the field of finite unions of subintervals of a fixed interval X of the line is called the u-field of Borel sets in X. The same definition applies to any metric space X. Definition A measure on a a-field F (referred to as the measurable sets) is a function /-L : F -? [0,00] satisfying /-L(0) = 0 and a-additivity: if A = U�I Aj with Aj disjoint sets in F, then /-L(A) = L:�I /-L(Aj). Theorem Any measure /-L is 1. monotone: A C B implies /-L(A) < /-L(B); 2. continuous from below: if Al C A2 C . . . is an increasing sequence of measurable sets, then /-L(U�I Aj ) = limj_oo /-L(Aj); 3. conditionally continuous from above: if BI :=) B2 :=) ••• is a de­ creasing sequence of measurable sets and if the measures /-L(Bj) are finite, then /-L(n�l Bj ) = limj_oo /-L(Bj)\" 684 Chapter 14 The Lebesgue Integral 4. subadditive: If B C Al U A2 U · .. U An, then /-L(B) < /-L(Al ) + . . . + /-L(An) ; 5. a-subadditive: if B C U�1 Aj , then /-L(B) < �i=l /-L(Aj). Definition The Lebesgue measure /-L(B) of a Borel set in lR is defined to be /-L(B) = inf{��1 IIj I : B C U.i=1 Ij }. Without loss of generality we may assume the intervals Ij to be disjoint. Lemma The Lebesgue measure of an interval is equal to its length. Theorem Sets of Lebesgue measure zero are preserved under countable unions, and subsets of sets of measure zero also have measure zero. Theorem Any Borel set B can be covered by a Gb set A (a countable intersection of open sets) such that A\\B has Lebesgue measure zero, and IAI = IB I · Definit ion The Lebesgue measure /-L(B) of a Borel set in lRn is defined to be /-L(B) = inf{��1 IRj I : B C U.i=1 Rj } where Rj denotes any rectangle II x 12 X ••• x In with volume IRj I = 111 1112 1· . . lIn I . Example Counting measure is the measure on the a-field of all subsets of X that assigns to each set its cardinality (the number of elements it contains) . Definit ion A probability measure is any measure such that IXI = 1. 14.2 Proof of Existence of Measures Definition An outer measure on a a-field :F of sets is a function /-L(A) satisfying: 1. (non-negativity) /-L : :F -+ [0, 00] ; 2. /-L(0) = 0; 3. (a-subadditivity) if A = U.i=1 Aj , then /-L(A) < �.i=1 /-L(Aj); 4. (monotonicity) if A C B, then /-L(A) < /-L(B) . 14.5 Summary 685 Theorem Lebesgue measure is an outer measure. Definition 14.2.1 For /-L an outer measure on F and A in F, we say A satisfies the splitting condition if /-L(B) = /-L(B n A) + /-L(B\\A) for every B in F. Theorem 14.2.1 Let /-L be an outer measure on F. The sets satisfying the splitting condition (denoted Fo ) form a u-field and /-L restricted to Fo is a measure. Definition 14.2.2 The distance between two sets A and B in a metric space is the infimum of d(x, y) for x in A and y in B. If this distance is positive we say A and B are separated. An outer measure on the Borel sets of a metric space is said to be a metric outer measure if /-L(A U B) = /-L(A) + /-L(B) whenever A and B are separated. Lemma Lebesgue measure on lR is a metric outer measure. Theorem 14.2.2 (Caratheodory) A metric outer measure is a measure on the Borel sets. Definition 14.2.3 Hausdorff measure /-La of dimension 0:' on the Borel sets in lR is defined by /-La ( A) = limc:_o /-L�) ( A) where /-L�) ( A) inf{2:�l IIj la : A C U�l Ij for intervals Ij satisfying IIj l < c}. Theorem 14.2.3 /-La is a measure on the Borel sets. Definition On an arbitrary metric space, the Hausdorff measure of dimension 0:' is defined as in lR where Ij are allowed to be arbitrary closed sets and IIj I denotes the diameter of Ij (the supremum of d( x, y) for x and y in Ij ). Lemma 14.2.1 a. /-La (A) < 00 implies /-L,l3(A) = 0 for (3 > 0:'. h. J£a (A) > 0 implies J£,l3 (A) = +00 for {3 < 0:'. 686 Chapter 14 The Lebesgue Integral Definition The Hausdorff dimension of A is the unique value 00 such that J£a: (A} = +00 for Q < Qo and J'a:(A} = 0 for Q > Qo . Example The Hausdorff dimension of the Cantor set is log 2/ log 3. 14.3 The Integral Definition A measurable space is a pair (X, F) where F is a u-field of subsets of X. A measure space is a triple (X, F, J£) where, in addition to the above, J' is a measure on F. The sets of F are called measurable sets. Definition A junction f : X � R is said to be measurable if f-1 (B) is measurable for every Borel subset B of R. Lemma If f : X � R and f-l (I} is measurable for every interval I (or even for every interval of the form (a, oo), or [a, oo), or (-oo, a), or ( -00, a]), then f is measurable. Theorem 14.3.1 If I and 9 are measurable junctions, then so are al + bg, / . g, I/g (il 9 :f: O), max(/, g}, min(/, g} , and III. 1/ h : R � R is measurable (with respect to the Borel q-field), then h 0 f is measur­ able. If fn. is a sequence of measurable junctions, then SUPn fn. , infn. fn., lim sup fn' lim inf fn., and lim fn (if it exists pointwise) are measurable junctions. Definition A simple junction is a finite linear combination 0/ char­ acteristic junctions 01 measurable sets I = L�=1 akXAJI where Ak are measurable sets; and {I if x is in A, XA = 0 ii x is not in A. Equivalently, a simple junction is a measurable junction that takes on only a finite set of values. Lemma Every simple junction has a representation f = E akXAJI where the sets Ak are disjoint, and the representation is essentially 14. 5 Summary 687 un�que. Theorem (Approximation by Simple Functions) Every non-negative measurable function is the pointwise limit of a monotone increasing sequence of simple functions. Definition The integral of a non-negative simple function f = 2:r=l akXAk is defined by I fdIJ = 2: akIJ(Ak), which does not de­ pend on the representation. The integral of a non-negative measurable function f is defined by I fdIJ = limn_co I fndJ-L where fn is a se­ quence of non-negative simple functions increasing monotonically to f. The integral does not depend on the sequence. A particular choice is fn = Lp. (inf B)x 1 and Pn is the partition consisting of set n f- (B) [(k - 1)/2n, k/2n] for 1 < k < 22n and [2n , 00] . Theorem 14.3.2 (Monotone Convergence Theorem) If 0 < h < f2 < ... is a monotone increasing sequence of non-negative measurable func­ tions, then I limn_oo fndJ-L = limn_oo I fndJ-L (both sides may be +(0) . Theorem 14.3.3 The integral of non-negative measurable functions is 1. linear: I (af + bg )dJ-L = a I f dJ-L + b I gdJ-Li 2. monotone: I f dJ-L < I gdJ-L if f < g; 3. additive: IAUB fdJ-L = IA fdJ-L + IB fdIJ for A and B disjoint mea­ surable sets, where IA fdJ-L denotes I fXAdJ-L. Theorem If f is Riemann integrable, then f is Lebesgue integrable and the two integrals are equal. Theorem 14.3.4 (Fatou's Theorem) If f = limn_oo fn where fn are non-negative measurable functions and if limn_co I fndIJ exists, then I fdJ-L < limn_oo I fndIJ· More generally, if {fn} is any sequence of non-negative functions, then I lim inf fndIJ < lim inf I fndJ-L. Definition If f : X -? lR, then f+ = max(f , O) and f- = max( -f, 0) , so f = f+ - f- and f± are nonnegative. If f is measurable we say f 688 Chapter 14 The Lebesgue Integral is integrable il J l±dIJ are both finite and then define the integral 01 I by J IdIJ = J l+dIJ - J l-dIJ· Theorem II I : X � R is measurable, then I is integrable if and only il III is integrable and Minkowski's inequality I J IdIJI < J I/ldIJ holds. Example For counting measure on {l , 2, 3, ... } the integrable functions are the absolutely convergent series, and the integral is the series sum. Theorem The integral is linear, monotone, and additive on real-valued integrable functions. Theorem 14.3.5 (Dominated Convetyence Theorem) II 9 is a non­ negative integrable function with I/n{x)1 < g(x) lor all x and n lor a sequence In 01 measurable functions such that In{x) � I(x) as n � 00 lor every x, then I is integrable and f IdIJ = limn_oo J IndIJ· Corollary II JJ(X) if finite and In is a uniformly bounded sequence of functions converging pointwise to I, then J IdIJ = liIlln_oo f fndIJ· Definition Any statement about points x in X is said to hold almost everywhere (abbreviated a. e.) if it is true for all x not in a set E of measure zero. Theorem 14.3.6 Let I and 9 be integrable functions. Then I = 9 a. e. if and only if fA fdIJ = fA gdIJ lor every measurable set A. 14.4 The Lebesgue Spaces Ll and L2 Definition We say I is equivalent to 9 if f = 9 a. e., where I and 9 are measurable functions on a measure space. We define L 1 (IJ) to be the vector space of equivalence classes 01 integrable functions, and the Ll norm is defined to be IIfllI = J I/ldIJ. This is a norm on L 1 (IJ) . Lemma 14.4.1 (Chebyshev's Inequality) For any f in L1 (IJ) and 8 > 0 we have IJ ( {x : II ( x) I > 8}) < (l /8) II fi l l . 14. 5 Summary 689 Theorem 14.4.1 L1 (\"') is complete. Definition L2(\",) is the space 01 equivalence classes 01 measurable func­ tions I such that 1/12 is integrable, with L2 nonn 11/112 = (J 1/12dJJ)1/2 and inner product (I , g) = J I gdJJ (take 9 in the complex-valued case) . Theorem 14.4.2 ( Cauchy-Schwartz Inequality) II I and 9 are in L2 (\",), then I 9 is integrable, so the inner product is well defined and the Cauchy-Schwartz inequality J IlgldJJ < (f 1/12dJJ) 1/2(J IgI2dJJ)1/2 hold- s. Theorem II JJ (X) is finite, then L2 (JJ) eLl (JJ) . For counting measure the spaces are denoted 11 and 12 and we have 11 C 12 . Theorem 14.4.3 L2(JJ) is complete. Definition A complete nonned space is called a Banach space, a com­ plete inner product space is called a Hilbert space. Theorem 14.4.4 (Riesz-Fischer) For any complex coefficients en with �::-oo len 12 < 00 there exists a complex-valued function I in L2 ( -11', 11') with Fourier coefficients equal to en : en = (1/211') f�1r I(x)e-inz dx. Furthennore, (1/211') J�1r I/(x) l2 dx = E�oo len l2 (Parseval's identity) , and the partial sums SN I(x) = ��=-N eneinx converge to I in L2 nonn. Theorem 14.4.5 (Density 01 Continuous Functions) The continuous functions on [-11', 11'] with I( -11') = 1(11') are dense in L2( -11', 11') . Theorem 14.4.6 (Parseval Identity) 1/ / is in L2 ( -11\", 11\") , then the partial sums 01 the Fourier series converge to I in L2 nonn and Parse­ val's identity holds. In particular, the correspondence I H {en} between L2 ( -11', 11') and 12 is onto in both directions. Corollary 14.4.1 II I is in L2 and orthogonal to all the junctions einx, then I is zero. 690 Chapter 14 The Lebesgue Integral Theorem 14.4. 7 IrE�oo lenl2 is finite, then u(x, t) = ��oo e-n2teneinz for t > 0 is a solution of the heat equation 8u/at = 82u/8x2 that is periodic of period 27r in x, and SUPt>o 1':11' lu(x, t) 12 dx is finite, with 1':11' lu(x, t) - f(x)12 dx � 0 as t � 0+ where f = ��oo eneinz. Con­ versely, every solution of the heat equation in t > 0 that is periodic of period 27r in x and such that SUPt>O 1':11' lu(x, t) l2 dx is finite has the above form. Chapter 15 Mult iple Integrals 15.1 Interchange of Integrals 15. 1.1 Integrals of Continuous Functions An important fact in the calculus of several variables is the equality of iterated integrals and multiple integrals, at least for continuous func­ tions on well-behaved domains. For simplicity of notation we will state all results for R2 , but the generalization to higher dimensions will be evident. Suppose R = [a, b) x [c, d) is a closed bounded rectangle and 1 : R -t R is a continuous function. The iterated integrals are t (l f(z, y) dz) dy and l (t f(z, Y) dY) dz. The double integral f fR I(x, y) dx dy is defined as the limit of Cauchy sums N M 8(/, P) = L L I(xj, Yk )(Xj - Xj-l)(Yk - Yk- d j=lk=l where P denotes a partition a = Xo < Xl < ... < XN = b, c = Yo < Yl < . . . < YM = d, of the sides of the rectangle (hence determining a partition of the rectangle into M N little rectangles), and (x j , Yk) is any point in the rectangle Rjk = [Xj-b Xj] X [Yk-l, Yk]. The limit is taken as the maximum length of the subintervals x j - x j -1 and Yk - Yk-l goes to zero. It is a straightforward matter to show that this limit exists, using the uniform continuity to show that the variation of l over any 691 692 Chapter 15 Multiple Integrals of the subrectangles Rjk goes to zero. Perhaps the only subtle point is that we must require that both sides of the rectangles Rjk get small; it is not enough that the areas of the rectangles go to zero, for we have no control of the variation of f over long skinny rectangles. We leave the details to the exercises. We briefly sketch the proof of the equality of the double integral and one of the iterated integrals for a continuous function f on a rect­ angle R. Given any e > 0 we first choose a partition P of the rectangle R into subrectangles Rjk such that If(x, y) - f(x, y) 1 < e if (x, y) and (x, y) belong to the same Rjk. This is possible by the uniform continu­ ity of f. Then S(f, P) for this partition differs from the double integral f fR f(x, y) dx dy by at most e' area(R). This follows by the same argu­ ment as in the one-dimensional case. Now consider the function 9 that is constant on each of the rectangles Rjk and equal to f(xj , Yk) there. 9 is discontinuous, but it has only a finite number of discontinuities, so the integrals involving 9 are covered by the theory of the Riemann integral. Notice that If(x, y) - g(x, y) 1 < e everywhere on R. Thus for any fixed y, 16 f(x, y) dz - 16 g(x, y) dz < e(b - a) , so t ([I(X, y) dz ) dy - t ([ g(x, y) dz ) dy < e area(H). On the other hand a direct calculation of the iterated integral fcd(f: g(x, y) dx) dy shows it is equal to S(f, P). Thus the iterated and double integral differ by at most 2e area(R), and by letting e � 0 we obtain their equality. For many applications it is desirable to relax the condition that the domain be a rectangle. Suppose the domain is a compact set K in a2 • We can always set it inside some rectangle R and define the double in­ tegral f JK f(x, y) dx dy by partitioning R as before and taking Cauchy sums S(f, P) = L: L: f(xj , Yk)area(Rjk) where the sum extends only over those rectangles Rj k that lie entirely in K, as indicated in Figure 15. 1.1. 15.1 Interchange of Integrals 693 Figure 15.1.1: In order for the double integral to exist and be equal to the iter­ ated integrals for continuous functions on K we need to make some assumptions on K that will control the error that arises from omitting the rectangles that lie partially in K. It is clear that this error will be negligible if we assume that the sum of the areas of those rectangles that are partially in K goes to zero as the partitions are refined. It is not difficult to see this is the same as saying the boundary of K has content zero. Recall the boundary of K is defined to be all points of K that are not in the interior-the interior points being those lying in a neighborhood entirely contained in K. A subset of the plane is said to have content zero if given any e > 0 it can be covered by a finite set of rectangles whose areas sum to at most e. (Notice that this is a stronger condition than having measure zero because the covering must be finit�for measure zero the definition is the same except that countable coverings are allowed.) If the boundary of K is the union of a finite number of smooth curves, it is easy to show that it has content zero and this is the case in the usual calculus applications. We leave the details to the exercises. Needless to say, the same theory of multiple integration is valid in Rn . If K c r is a bounded set whose boundary has content zero and f is a continuous function on K, then we can define the multiple integral JK f(x) dx and show that it is equal to the iterated integrals (n-fold) in any order. In particular, we can define the volume of K, written vol(K), to be the integral of the function f = l over K. 694 Chapter 15 Multiple Integrals 15.1.2 Fubini's Theorem We discuss next the equality of iterated and double integrals in the context of Lebesgue integration. (We are deliberately skipping the case of Riemann integrable functions because the results are inconclusive and not very useful.) We let J-L denote Lebesgue measure on �2 . Recall that J-L is the unique measure on the Borel subsets of �2 that assigns to each rectangle its usual area (it is convenient to adopt the convention o . 00 = 0 in defining areas of rectangles so that the area is defined for unbounded rectangles in a consistent manner) . We would like to relate this measure on �2 to Lebesgue measure on � by summing the lengths of horizontal or vertical sections. Figure 15. 1.2: Let A be a measurable subset of �2 . Then for each y, the section Ay = {x in � : (x, y) is in A} is a subset of �, as shown in Figure 15. 1.2. If we take the Lebesgue measure of the section Ay and then integrate with respect to y we should get J-L(A). Notice we use Lebesgue measure on � twice, once to measure Ay and once to integrate with respect to y. We can make this look like an iterated integral if we consider the characteristic function of A: { 1 if (x, y) is in A, XA (X, y) = ( ) o if x, y is not in A. Then the Lebesgue measure of Ay is J�oo XA (X, y) dx, so we are looking at the iterated itegral J�oo (J�oo XA (x , y) dx) dy. If we were to section first in the y-direction (for fixed x) and then integrate in x, we would obtain the iterated integral in the other order. The double integral J XAdJ-L is just J-L(A) , so our claim that J-L(A) is equal to the area of A 15.1 Interchange of Integrals 695 by sectioning is equivalent to the equality of the double integral and the iterated integrals for the particular function XA. There are some technical difficulties with defining the iterated inte­ gral for XA . First, in order to form J�oo XA(X, y) dx, we need to know that for each fixed y the function XA(X, y) as a function of x is mea­ surable. Then we need to know that J�oo XA (X, y) dx is measurable as a function of y in order to perform the next integration. The res­ olution of these difficulties is by no means trivial, and we postpone the details to section 15.1.3. Given that these functions are measur­ able, we indicate a simple proof that f�oo(J�oo XA (X, y) dx) dy = �(A). We note that the identity is trivially true when A is a rectangle. Since J1 is characterized as being the unique measure on the Borel sets that gives the usual area for rectangles, it suffices to show that the iterated integral defines a measure. In other words, if we set v(A) = J�oo(J�oo XA (X, y) dx} dy, then we have to verify the axioms for a measure for v-the only non-trivial axiom being countable addi­ tivity. Thus we need to show v(A) = E�l V(Ak} if A = U�l Ak is a disjoint union of Borel sets. But we claim this follows easily from two applications of the monotone convergence theorem. Indeed the condi­ tion A = U�l Ak (with Ak disjoint) translates into XA = E�l XAA:' Since these are non-negative functions, we have 00 J XA (X, y) dx = L J XA. (X, y) dx k=l for each fixed y by the first application of the monotone convergence theorem. But we can then regard this equation as writing one non­ negative function of y as an infinite series of non-negative functions, so by a second application of the theorem J (J XA (X, y) dx ) dy = f J (J XA. (X, y) dx) dy, k=l which is the countable additivity of v. Of course our technical assump­ tions about measurability were used implicitly in this argument. This result admits an interesting interpretation. Suppose f : R -? R is a non-negative measurable function. Then one interpretation of f f(x} dx is .as the area under the graph of f. Thus let A denote this region under the graph of f, A = {(x, y) : 0 < Y < f(x}}. If we 696 Chapter 15 Multiple Integrals section A first by varying y, as indicated in Figure 15. 1.3, then the iterated integral J (J XA (x, y) dy) dx is equal to J f (x) dx. Thus our result implies the equality of the integral of a non-negative measurable function and the area under its graph. Figure 15.1 .3: We now turn to the problem of extending the equality of double and iterated integrals to more general functions than characteristic func­ tions. To begin with we study non-negative functions. Theorem 15.1.1 (Fubini 's Theorem, first version) Let f be a non­ negative measurable function on ]R2 . Then the double integral J f dJ-L and the two iterated integrals J (J f (x, y) dx) dy and J (J f (x, y) dy) dx are all equal (they may be all + 00 ) • Proof: Let fn be a monotone increasing sequence of non-negative simple functions converging to f· Then J fdJ-L = limn-+oo J fn dJ-L by definition. But we have seen that the double and iterated integrals are equal for characteristic functions and, hence, for simple functions. Thus J fndJ-L = J(J fn (x, y) dx) dy. The last step in the argument is to take the limit. Regarding fn (x, y) as a function of x (for fixed y), we know it is measurable (this will be proved in section 15.1.3) ; and as we vary n we have an increasing sequence of non-negative functions, so f(x, y) is measurable and J fn (x, y) dx .,. J f(x, y) dx by the monotone convergence theorem. Since J f n (x, y) dx is measurable, this shows that J f (x, y) dx is measurable, and one more application of the monotone convergence theorem shows J (J fn (x, y) dX) dy --t J (J f(x, y) dX) dy, completing the proof. QED 15.1 Interchange of Integrals 697 One word of caution in interpreting this theorem: even though the integral J fdIJ may be finite, some of the single integrals J f(x, y) dx may be infinite. This can only happen for values of y in a set of measure zero, of course. Thus the second integration in the iterated integral may involve a function taking values in the extended reals. For example, suppose f(x, y) = (x2 + y2)-1/2Xx2+y2�1 . Then is finite for y # 0 but +00 for y = 0 since J21 Ixl-1 dx = +00. In this case the double integral is finite, but this is easiest to see using polar coordinates, which we discuss in section 15.2. It is not necessary that f be defined on all of ]R2 to apply the theorem. If suffices to have f defined on a measurable set A, for then we can simply extend f to be zero outside of A. Notice that we do not need any assumptions about the boundary of A. Next we consider functions that are not necessarily nonnegative. Theorem 15.1.2 (Fubini's Theorem, second version) Let f be a mea­ surable function on a2 , and assume that f is integrable with respect to IJ (this means J f+ dIJ and J f- dIJ are finite) . Then the double in­ tegral and iterated integrals are equal. In particular for almost every y, f(x, y) as a function of x is integrable and J f(x, y) dx is integrable as a function of y and the same with x and y reversed. Proof: We need only apply the previous version to f+ and f-. Since J f±dIJ is assumed finite, we have J(J f± (x, y) dx) dy = J f±dIJ and this implies J f± (x, y) dx is finite for almost every y (or else the y inte­ gration would produce +00). Subtracting and using the linearity of the double integral and the iterated integrals we obtain J(J f(x, y) dx) dy = J fdIJ· QED This result says a lot less than appears since the hypothesis that f be integrable involves the double integral and normally we want to compute it by computing an iterated integral. The existence of the iterated integral, if it involves cancellation, need not imply the existence 698 Chapter 15 Multiple Integrals of the double integral. For example, consider { 1 if 0 < x < 1, I ( x, y) = -1 if - 1 < x < 0, o otherwise. Then J I(x, y) dx = 0 for every y, so J(J I(x, y) dx) dy = 0, but J I (x, y) dy = ±oo for x in (- 1, 1), and of course I is not integrable. With a little more ingenuity one can construct examples with iterat­ ed integrals existing in both orders but not equal. All these examples exploit concealed cancellation of ±oo, as the final version of Fubini's Theorem makes clear. Theorem 15.1.3 (Fubini 's Theorem, third version) Let I be a mea­ surable function on R2 , and suppose one 01 the iterated integrals for III exists and is finite; say J I I (x, y) I dx is finite for almost every y and J(f I/(x, y) 1 dx} dy is finite. Then I is integrable with respect to IJ and both iterated integrals lor I are equal to J IdIJ. Proof: By the first version applied to III we have J I/ldIJ = f(f I/(x, y}1 dx} dy, so III is integrable. This means I is integrable, so by the second version the iterated integrals both equal the double integral of I. QED This is the most useful of the three versions, since the hypothesis is one that we can hope to check by finding an upper bound for the iterated integral. It is significant that we have to deal with only one of the two iterated integrals, since it is often the case that one is easier to estimate. The consequences of Fubini's theorem are often surprising. We give one application that is typical and an important theorem in its own right. Recall we defined the convolution of two functions I * g( x} = J�oo I(x-y)g(y} dye We originally defined this in terms of the Riemann integral, but now we can interpret it as a Lebesgue integral and can ask under which conditions on I and 9 it is defined. Theorem 15.1.4 (Ll Convolution Theorem) Let I and 9 be integrable functions on the line. Then I * 9 is defined as an integrable func­ tion in the lollowing sense: lor almost every x, the function h(y) = 15. 1 Interchange of Integrals 699 f(x - y)g(y) is an integrable function and f * g(x) = J h(y) dy so de­ fined for almost every x (it doesn't matter how it is defined on the remaining set of measure zero) is an integrable function. In addition we have the estimate III * gl II < 11I1 II I lg111 . Proof: Since I and 9 are measurable, it follows easily that h(x, y) = f(x - y)g(y) is a measurable function on ]R2 . We want to apply the third version of Fubini's theorem to h (x, y) , and we will compute the iterated integral in the reverse order to what one might expect. For almost every y, g(y) is finite and J Ih(x, y) 1 dx J I/(x - y)g(y) ldx Ig(y) I J I/(x - y) 1 dx Ig(y) 1 J I/(xli dx = Ig(y) I II /III ' Here we have used the translation invariance of Lebesgue measure. Integrating this identity we obtain J (J Ih(x, y) 1 dX) dy = J Ig(y) 1 1I/1 I 1 dy = 11/11 1 11gll 1 , which is finite. Thus by Fubini's theorem Jh(x, y) dy = f *g(x) is finite for almost every x and by the equality of the iterated integrals. This shows f * 9 is integrable and establishes the desired estimate. QED Even the statement that f * 9 is defined for almost every x is not obvious. It is easy to construct examples where f * 9 fails to exist at a single point . Take f = 9 = Ix l - 1/2Xlxl�1 . Then f and 9 are integrable because the singularity at x = 0 is not too bad, but f * g(O) = 11 Ix l -1/2 . Ixl -1/2 dx = 11 Ix l -1dx = + 00 . -1 -1 The idea here is simply that the ordinary product of two integrable functions need not be integrable. Since the convolution integrates the 100 Chapter 15 Multiple Integrals product of two functions, it would seem plausible that by placing the singularities I and 9 so that they reinforce each other in the product /(x - y)g(y) it would be possible to construct integrable functions such that I * g(x) = +00 for every x. The theorem shows that this is not possible. There are many variants of this theorem: for example, if I is in L1 and 9 is in L2, then / * 9 is in L2; or if / and 9 are both in L2, then I * 9 is bounded and continuous. Fubini's theorem generalizes not only to Rn but to any situation where there are functions of several variables. If (X, :F, JJ) and (Y, Q, v) are two measure spaces (a certain technical condition is required that X and Y be expressible as a countable union of sets of finite measure, but this condition is satisfied by most examples), then we can consider functions I (x, y) of variables x in X and y in Y to be a function on the Cartesian product X x Y. There is a u-field of subsets of X x Y called :F x Q, which is the u-field generated by the \"rectangles\" A x B where A is in F and B is in Q (of course in ]R2 these are not the conventional rectangles, since the \"sides\" are allowed to be arbitrary measurable subsets of R). On this u-field there is a product measure JJ x v that gives the correct area of a rectangle JJ x v(A x B) = JJ(A)v (B). Then Fubini's theorem says the integral J /dJJ x v is equal to the iterated integrals or J U I(x, Y)dl'(X)) dv(y) J U I(x, Y)dv(Y)) d*) provided / is non-negative, or integrable, or one iterated integral is finite for III. This is especially important in probability theory, where the choice of the product measure is interpreted as saying the events represented by x and y are independent. If JJ and v are counting mea­ sure on the positive integers, then Fubini's theorem is equivalent to the interchange of order of summation for absolutely convergent doubly indexed series. 15. 1. 3 The Monotone Class Lemma* In this section we will explain the technicalities involved in proving measurability in Fubini's theorem. They key idea is a set-theoretic fact 15. 1 Interchange of Integrals 701 called the Monotone Class Lemma. The proof of this fact is very tricky although not very long. It serves as a device for finessing the difficulty of dealing with differences of sets. We define a monotone class M to be a collection of sets (subsets of the universe X) that is closed under monotone increasing and decreasing sequences: if Al C A2 C . . . with Aj in M, then U�1 Aj is in M; and if Bl ::J B2 ::J . . . with Bj in M, then n�1 Bj is in M. These are conditions that are easy to check, especially using the monotone and dominated convergence theorems. It is easy to see that a u-field is a monotone class, but a monotone class need not be a u-field since it does not have to be closed under complements or differences. The Monotone Class Lemma gives a simple criterion for a monotone class to contain a u-field. Lemma 15. 1.1 (Monotone Class) Let M be a monotone class that contains a field F. Then M contains the u-field generated by F. Proof: Let Fl denote the u-field generated by F, and let M l be the monotone class generated by F (the smallest monotone class containing F) . Clearly M 1 C M since M is a monotone class containing F. We will show that M 1 is a field, and this will complete the proof because it follows easily that Ml is a u-field and, hence, contains Fl (actually M 1 = Fl since Fl is also a monotone class) . For each set A in Ml, define M l(A) to be the collection of sets B in M l such that An B, A u B, A\\B, and B\\A are also in M I ' (This is the trick!) Notice the symmetry between A and B in the definition, so B is in Ml (A) if and only if A is in M l (B). Of course there is no reason to believe a priori that M 1 (A) contains any sets other than the empty set and A. But we will eventually show that Ml (A) is all of M 1 , which will imply that M 1 is a field. First we claim that M 1 (A) is a monotone class. This is easy be­ cause each of the operations that defines M 1 (A) preserves monotone sequences. For example, if Bl C B2 C \"' , then A \\B1 ;2 A \\B2 ::J . . . (notice the switch from increasing to decreasing, but this doesn't mat­ ter because the definition of monotone classes involves both) . This means that if M l (A) contains F, then it must be all of MI. But how do we get started? We use that fact that F is a field; so if A and B are in F, then B is in M l(A) . That means for any set A in F, Ml (A) contains F; hence, Ml (A) = MI . 702 Chapter 15 Multiple Integrals We are almost done, but first we need a clever use of the symmetry condition. For any B in M I we know that B is in M I (A) for A in :F, so A is in MI (B). That means Ml (B) contains :F; hence, M l (B) = MI. Since B was any set in M 1, we have succeeded in proving our main claim. We can now see that Ml is a field, because A in M 1 (B) for any A and B in Ml means AnB,AuB,A\\B, and B\\A are also in Ml' By using the field properties we can replace any countable union by a countable increasing union, so Ml is a O'-field. QED Now we can fill in the missing arguments in the proof of Fubini's theorem. Lemma 15.1.2 Let A be a Borel subset of a2 • Then every section Ay is a Borel subset of a, and the function IAy l = J�oo XA (X, y) dx is a measurable function of y (taking values in the extended real numbers). Proof: First we prove the analogous result for Borel subsets of a finite rectangle [a, b) x [c, d]. Let M denote the class of Borel sets A for which the conclusions of the lemma hold. Clearly M contains the field generated by the rectangles. We claim M is a monotone class. For this we simply apply the dominated convergence theorem to interchange the integral with limits. We can use a constant function as dominator since we are in a finite rectangle. For example, if Al C A2 C \"' , then the same is true for the sections, and {b X u Aj (x, y) dx = .lim (b X A) (x, y) dx L J-� h is measurable, being the limit of measurable functions. Thus the mono­ tone class lemma implies that M contains all Borel subsets of [a, bl x [c, d). For a general Borel subset A of a2 we write it as the countable disjoint union of An [mll ml + 1) x [m2' m2 + 1) as ml and m2 vary over all integers. The conclusions are preserved under countable disjoint unions (the function IAyl may now assume the value +00). QED This lemma also implies the measurability of f(x, y) as a function of x for fixed y and J f(x, y) dx as a function of y for any simple function 15.1 Interchange of Integrals 703 I (just use the analogous facts for the sets Ale in the decomposition f = Ef=l aleXA. J, which was used in the proof of Fubini's theorem (first version). The same argument can be used to justify the definition of the product measure JJ x v for any two finite measures JJ and v, and more generally for the case of u-finite measures, which is defined as follows: JJ is u -finite if the space X can be written as a countable union X = U�l Xj with JJ{Xj) finite. For if JJ and v are u-finite and we write JJ = E JJj and v = E Vie where JJj and Vk are the restrictions of JJ to Xj and v to Yle (we can always take the decompositions X = U Xj and Y = UYk to be disjoint), then we can define JJxv = E�l E�l JJj X Vie . Another important application of the Monotone Class Lemma is the following uniqueness theorem of Hahn: Theorem 15.1.5 (Hahn Uniqueness Theorem) Let JJ and v be u-finite measures on au-field Fl generated by a field F. If JJ and v are equal on F, then they are equal on Fl . Proof: Suppose first that JJ and v are finite measures. Let M be the collection of sets A in Fl for which JJ(A) = v(A). It is easy to see that M is a monotone class, so M = Fl by the monotone class lemma. (The finiteness of the measures is needed in order to use the continuity from above for monotone decreasing sequences.) For the general case just split the space into a countable union of sets of finite measure for both JJ and v. A priori these sets may not belong to F, but this can always be arranged (see exercise set 15.1.4 for details). Then apply the special case of finite measures to each of the pieces and sum, using u-additivity. QED In particular, this uniqueness theorem gives another proof of the uniqueness of Lebesgue measure. It might seem possible to avoid using the Monotone Class Lemma in these applications and argue directly that the classes we called M are u-fields. It isn't! 'lry it if you don't believe me. 15. 1.4 Exercises 1. Write out the details of the proof of the existence of the double integral of a continuous function on a rectangle. 704 Chapter 15 Multiple Integrals 2. State and prove (by induction) the equality of all iterated integrals (how many are there?) for a continuous function on a rectangular parallelopiped in ]Rn . 3. a. Prove that if K is a set in ]R2 whose boundary has content zero, then the double integral of a continuous function on K exists. b. Assume also that every section of K is a finite union of inter­ vals. Prove that the iterated integrals are equal to the double integral. 4. Prove that a C1 bounded curve has content zero. 5. Prove that a finite union of sets of content zero is also a set of content zero. 6. Prove that the graph of f(x) = sin l/x on [0, 1] has content zero. 7. Let f : ]R -+ ]R be measurable, and let A C ]R2 be the graph of f. Prove that A has measure zero. (Hint: use Fubini's theorem.) 8. Let A be a measurable subset of ]R2 . Prove that A has measure zero if and only if almost every section Ay has measure zero. 9. Prove that if f : ]R2 -+ ]R is bounded, measurable, and vanishes outside a bounded region, then the iterated integrals are equal. 10. Prove that the convolution of two L2 functions is bounded. 11. Define a periodic convolution f * g( x) = J::'7r f (x - y )g(y) dy where f and 9 are periodic of period 211\". Prove that if f and 9 restricted to ( -11\", 11\") are integrable, then f * g(x) is defined a.e. and is also integrable on (- 11\" , 11\"). 12. Give an example of a function on ]R2 for which both iterated in­ tegrals exist and are finite but unequal. Can you do it with a continuous function? 13. State each of the three versions of Fubini's theorem for counting measure, in terms of doubly indexed series. 14. Give an example of a measure that is not a-finite. 15.2 Change of Variable in Multiple Integrals 705 15. If /-L is a a-finite measure on a a-field fl generated by a field f, show that in the decomposition X = U�1 Xj with /-L(Xj) < 00 it is possible to take each Xj in f. 15.2 Change of Variable in Mult iple Integrals 15.2.1 Determinants and Volume Our goal is to establish the change of variable formula f f(y) dy = f f(g(x)) ldet dg(x) 1 dx JD JD' for suitable functions f and g, where 9 : D' .,. D is a one-to-one change of variable (D' and D are suitable regions in ]Rn ). This result is usually stated in calculus courses with an intuitive argument that Idet dg(x) I is the correct magnification factor for relating the volumes in the x and y = g( x) variables. This argument is based on the observation that Idet dg (x) 1 is the correct magnification factor if 9 is a linear (or affine) transformation, and the general case follows by localization via the differential. We will follow the same outline, presenting the com­ plete details. It is not an easy theorem to prove, even under strong assumptions on the domains D and D' and the functions f and g. We begin with the case of a linear transformation g( x) = Ax , where A is an n x n matrix. Here dg( x) = A is constant. The claim is that if R is any rectangle, then the volume of g(R) is exactly IdetA I times the volume of R. Let us think of the n x n matrix A as being composed of n column vectors AI , ... ,An . These vectors are the image of the -standard basis for ]Rn (e(I) , . •• , e(n) ) under multiplication by A. Now the unit cube consists of all vectors 2:j=1 bj e(j) where 0 < bj < 1, and this is mapped under multiplication by A into the parallelopiped of all vectors of the form 2:j=1 bj Aj for 0 < bj < 1. Let us call this the parallelopiped generated by AI \" '\" An. The unit cube is thus the parallelopiped generated by the standard basis vectors e(l) , ... ,e(n) . The volume of the parallelopiped generated by AI , ... , An is clearly the magnification factor for which we are looking, because the unit cube has volume one and it is clear by linear algebra that the same factor relates the volume 706 Chapter 15 Multiple Integrals of A(R) to the volume of R for any rectangle R (just decompose R into an approximate union of cubes) . We need to show that the volume of the parallelopiped generated by AI , ... ,An is equal to Idet AI . The key to understanding why this is so is to get rid of the absolute value. Let us consider det A as a function of the n column vectors AI , ... , An that comprise A. With this understanding we will write det (AI ' ... ,An ). We now recall the basic properties of this function, properties that in fact will characterize it uniquely: 1. det (AI , ... ,An) is real-valued; 2. it is multilinear, meaning that for each k = 1, ... ,n we have det (AI , ... , aAk + bBk , ... , An) = adet(AI ,\" \" Ak, ... , An) + bdet (AI , ... , Bk , ... , An); 3. it is skew-symmetric (or sometimes called alternating), meaning for any j =f. k det(AI , ... , Aj , \"\" Ak , ... , An) = -det(Al , ... , Ak , ... , Aj , ... , An); 4. det (e(1), ... , e(n) ) = 1. Any function satisfying properties 1, 2, and 3 is called a skew­ symmetric multilinear form. Property 4 is just a normalizing condition. A theorem of linear algebra says that the space of skew-symmetric mul­ tilinear forms in n vectors from ]Rn is one-dimensional, so together with the normalizing condition 4 this uniquely determines the determinant . In view of this uniqueness result, in order to show that the volume of the parallelopiped generated by AI \"' \" An is Idet(Al , ... , An)1 we want to invent a signed volume for parallelopipeds that will have all the properties of the determinant. We give the argument first in the case n = 2 where we can draw pictures. Let Al and A2 be two vectors in ]R2 . We define m(AI , A2) to be ± the area of the parallelogram with sides Al and A2, where we take the plus sign if the angle from Al to A2 is less than 1800 and the minus sign if it is more than 1800 , as indicated in Figure 15.2. 1. 15.2 Change of Variable in Multiple Integrals 707 + Figure 15.2.1: If the angle is 00 or 1800 , then the area is zero, so we need not determine the sign. Note that this definition automatically makes m skew-symmetric, m(Ab A2) = -m(A2' AI ), and it clearly satisfies the normalization condition m(e(1 ) , e(2) ) = 1. Thus the only condition we need to check is the bilinearity; and by the skew-symmetry it suf­ fices to establish it for one of the variables, say the second. Now fix Al i= 0 (if Al = 0 there is nothing to prove) , and let A2 be any vector such that Al and A2 are linearly independent. We claim m(AI , al AI +a2A2) = a2m(AI ' A2 ) for any real al and a2, and this will prove the linearity because every vector in ]R2 has the form al AI +a2A2 and a2 m ( A I , A 2) is linear in (a I , a2). To prove this identity we com­ pare the parallelograms with sides AI , a2A2 and sides AI , al AI + a2A2, as shown in Figure 15.2.2. Notice that they have the same base (I AI I) and the same altitude, hence the same area, and also the angle between the sides is always on the same side of 1800 ; so we have m(AI ' al AI + a2A2 ) = m(AI , a2A2). Next it is clear that the factor a2 multiplying A2 changes the area by la2 1 since this is the change in the altitude. Also, the angle remains the same if a2 > 0 and changes by 1800 if a2 < O. Thus m(AI ' a2A2) = a2m(AI ' A2)' By the uniqueness of the determinant we conclude that m(AI ' A2) = det (A I, A2), which completes the proof that the area of the parallelo­ gram generated by AI , A2 is Idet(AI ' A2 )1. In ]Rn the proof is similar. We define m(AI , . .. ,An) to be the volume of the parallelopiped gen­ erated by AI \"' \" An multiplied by ±l. The easiest way to specify the choice of the sign is to take the sign of det ( A I , . . . , An) . From 708 Chapter 15 Multiple Integrals Figure 15.2.2: the properties of det this guarantees the skew-symmetry and the cor­ rect normalization m(e(I), ... , e(n» ) = 1. To show the multilinearity it suffices to prove linearity in the last factor because of the skew­ symmetry. Let AI, . .. , An- l be fixed vectors that we may assume to be linearly independent, for otherwise m(Al t ... , An- I, An) = 0 for any choice of An. We choose one more vector An, so AI ' ... ' An form a basis for an . We will show m(Ab ... , An-b alAI + ... + anAn) = anm(AI , ... , An- I, An), which implies the linearity. We can use the same argument as before to throw away the terms aIA2 +·· · +an-IAn-1 since they don't change the base (the parallelopiped of dimension n - 1 generated by Ab ... ,An-I) and they don't change the altitude (the dis- tance from al AI + ... + anAn to the base) ; hence they leave unchanged the volume = altitude x area of base and also the determinant (us­ ing properties of the determinant), so they don't change the sign. So m(Ab ... , An-b alAI + .. . + anAn) = m(Al , ... ,An-I, anAn). Final­ ly the factor an changes the measure by lan l since it doesn't change the base but multiplies the altitude by �anl; and the determinant is changed by a factor of an, so the sign changes appropriately. Thus we have established: Theorem 15.2.1 Let g(x) = Ax where A is an n x n matrix. If R is any rectangle, then vol(g(R)) = IdetAlvol(R) . 15.2 Change of Variable in Multiple Integrals 709 15.2.2 The Jacobian Factor· Since we have shown that the absolute value of the determinant of a linear transformation gives the exact magnification factor for volumes under the transformation, the basic principle of differential calculus suggests that for a C1 mapping 9 : U -+ Rn (U an open set in Rn ) the absolute value of the determinant of the derivative J(x) = Idet dg(x) I should give an approximate local magnification factor for volumes un­ der the mapping near x. We call J(x) the Jacobian factor. We then expect to get the exact volume of g(U) by integrating J(x) over U, if 9 is one-to-one. It turns out to be extremely difficult to prove this. Be­ fore beginning the proof we need to understand some of the difficulties we will encounter. If we fix a point x and use the differentiability of 9 at ii to write g(x) = g(x) + dg(x)(x - x} + o( lx - xl), then the mapping g1 (X} = g(x} + dg(x} (x - x) satisfies vol(g1 (R}) = J(x)vol(R} for any rectangle R. We would like to say vol(g(R} } � VOI(gl (R} ) with the approximation improving as the size of R decreases. But we will need to have an estimate that is uniform in ii, and for that we will need to use the continuity of the derivative. We will use this idea to prove the upper bound vol(g(U) ) < Iv J(x) dx. But the lower bound is more delicate. Suppose gl (R) is a long skinny rectangle, say [O, e- 1] x [O, e] in R2 , with volume one. Then by moving each point in g1 (R) by a distance of only e (send (x, y) to (x, 0)) we can squash the rectangle down to a segment of the x-axis, [0, e- 1] x 0, so the volume drops to zero. So even if we know that g(R) is point-by-point close to g1 (R) , we cannot conclude that vol(g(R}} is close to VOI(gl (R}}. Instead, we will use the inverse function theorem and the upper bound estimate for the inverse mapping, but for this we will have to avoid points where J ( x) = 0, or even points where J(x) is close to zero. Fortunately these points contribute very little to the integral, so we can omit them when we try to prove the lower bound vol(g(U» > lu J(x) dx. We begin with a simple geometric lemma that gives an upper bound for the volume of a neighborhood of set. We define the e-neighborhood � of A to be the set of points of distance at most e from points in A. This definition makes sense for any set Aj but we will only need to consider parallelopipeds, which are the images of rectangles under linear mappings. 710 Chapter 15 Multiple Integrals Lemma 15.2.1 Let A be a parallelopiped contained in a ball of radius r in Rn . Then there exists a constant c depending only on n such that vol(At} < vol(A} + ce(r + €)n-l for all € < 1. Proof: We give the proof for n = 2. Then A is a parallelogram with perimeter P. Clearly every point in At that is not in A must be within distance of € from P, so At C AuPt• Thus vol(At) < vol(A) +vol(Pt), and the result follows from the estimate vol(Pd < ce(r + e), which is essentially trivial since P consists of four line segments each of length at most 2r, and vol(Lt} < (I + 2€)€ if L is a line segment of length I. The argument for general n is similar, using induction. The key fact is again the uniform upper bound for the (n - 1 )-dimensional volume of the boundary of A that follows from the fact that A is contained in a ball of radius r. We leave the details to the exercises. QED Now let C6 denote a cube with center at x and side length 6. If 9 is a C1 mapping in a neighborhood of x we want to compare vol(g(C6)) with J(x)6n, which is the volume of 91 (C6), where gl (X) = 91 (X) + dg(x) (x - x} is the best affine approximation to 9 at X. We would like to have a good approximation for 6 small, but it is important that we be able to control the size of 6 independent of the point X. The next lemma tells us how to do this in terms of the variation of dg( x) as x varies over C. Since dg(x} is an n x n matrix, it is natural to measure its size by the matrix norm (recall that IIMII is the smallest constant c such that IMxl < clx l for all x in Rn ). Lemma 15.2.2 Suppose IIdg( x) II < M and Ildg( x) - dg( x) II < € for all x in C6 ' Then vol(g(C6)) < (J(x) + ce)6n where c is a constant that depends only on n and M. Proof: The hypothesis Ildg( x) II < M easily implies that gl ( C 6) lies in a ball of radius cb (here we use the letter c to denote a constant that depends only on n and M with the understanding that different occurences may stand for different constants) . We will apply the pre­ vious lemma with r = cb. To do this we need an estimate for the difference g(x) - gl (X). This is provided by the fundamental theorem of calculus: g(:I:} - g(i} = l dg(i + s(z - i})(:I: - i} dB, 15.2 Change of Variable in Multiple Integrals 711 so g(x) - gl (X) = l (dg(x + B(X - x) - dg(x))(x - x) dB. Since x + s(x - x) lies in C6, we can use the hypothesis to obtain the estimate I (dg(x + s(x - x)) - dg(x))(x - x) 1 < elx - xl. Thus we have Ig(x) - gl (x) 1 < a6, hence g(C6) lies in the a6 neighborhood of 91 (C6). Thus the previous lemma gives the estimate QED vol(g(C6)) < VOI(gl (C6)) + a6(c6 + a6)n- l < (J(x) + a)on. Lemma 15.2.3 Let 9 : U � Rn be a one-to-one map of a bounded open set U whose boundary has content zero, and assume 9 is C1 on the closure of U. Then vol(g(U)) < L J(x) th. More generally, if f is any non-negative continuous function on the closure of g(U), then Ig(v) f(x) dx < Iv f(g(x))J(x) dx. Proof: Since the closure of U is compact, we have a uniform upper bound IIdg(x)1 I < M. This enables us to use the previous lemma. It also allows us to conclude that the boundary of g(U) has content zero (see exercises) , so the integrals over g(U) are well defined. We subdivide U into cubes of side length 6, discarding those that do not lie entirely in U. Given any e, we can choose 6 so that Ildg(x) - dg(x) 1I < e for x and x in the same cube, by the uniform continuity of dg on the compact closure of U. With these fixed e and 6, write {Cj } for the 712 Chapter 15 Multiple Integrals collection of cubes and {X j} for the center points of the cubes. By the previous lemma we have and summing over j we obtain With e fixed we can let 8 � 0 (the condition relating 8 to e allows all values smaller than a fixed 60). The sum 2:j J(Xj )6n converges to Iv J(x) dx and ce 2:j 8n converges to cevol(U) . Since the boundary of U has content zero, it is easy to show that vol(g(Uj Cj )) converges to vol(g(U)) (see exercises for the details). Thus we have the estimate vol(g(U)) < fu J(z) dx + CEvol(U) , and vol(U) is finite. Since this holds for any e > 0, we obtain the desired upper bound for vol(g(U)). To obtain the upper bound for the integral we simply multiply (*) by 1 (g( x j )) before summing to obtain j j + ce E I(g(xj ))8n. j As 8 � 0 the sum Lj l(g(xj )) J(Xj )� converges to Iv l(g(x))J(x) dx and ce 2: j 1 (g( x j ) ) 8n converges to CE Iv 1 (g( x )) dx. It is also true that 2:j l (g(xj ))vol(g(Cj)) converges to Ig(v) I(x) dx. We leave the details to the exercises. Thus 1. I(x) dx < f l(g(x))J(x) dx + c£ f I(g(x) ) dx, g(V) Jv Jv and the desired upper bound for the integral follows by letting e � o. QED 15.2 Change of Variable in Multiple Integrals 713 Theorem 15.2.2 (Change of Variable Formula) Let 9 : U --+ ]Rn be a one-to-one map of a bounded open set U whose boundary has con­ tent zero, and assume 9 is CI on the closure of U. Also let f be any continuous function on the closure of g(U). Then f f(x) dx = f f(g(x))J(x) dx. Jg(U) Ju Proof: It suffices to prove the result for non-negative f, and we already have the inequality in one direction. We start by proving the reverse inequality under the additional assumption that J( x) never vanishes on the closure of U. Then the inverse function theorem implies that g- l is a C1 map from g(U) to U (remember we are assuming 9 is one-to-one, which is not a consequence of the inverse function theorem). We may thus apply the inequality of the last lemma to the function f(g(x)) J(x) = F(x) on U = g- l (g(U) ) and the map g- l : g(U) --+ U. We have Iu F(x) dx < fg(u) F(g-1 (x) )J1 (X) dx where J1 (X) = Idet dg- 1 (x) 1 is the Jacobian factor for g- l . But F(g- 1 (x) )J1 (X) = f(x) J(g-1 (x) )J1 (X) = f(x) by the inverse function theorem (remember that the product of deter­ minants is the determinant of the product, and dg-1 (x) is the inverse matrix of dg(g- l (x)). So we have the desired reverse inequality f f(g(x)) J(x) dx < f f(x) dx. Ju Jg(U) To deal with the general case we cut up U into a union of small cubes, except for a neighborhood of the boundary that does not con­ tribute to the integral in the limit. For each cube C in the partition, either J(x) does or does not vanish on the closure of C. If not, we are in the special case already completed, so f f (g ( x) ) J ( x) dx < f f ( x) dx. Jc Jg(C) When we sum over all such cubes we obtain L f f(g(x) )J(x) dx < L f f(x) dx < f f(x) dx, j JCj j Jg(Cj ) Jg(U) 714 Chapter 15 Multiple Integrals where the sum extends over the cubes for which J(x) does not vanish. But if we form the lower Riemann sum to approximate the integral Iv f(g(x))J(x) dx, the cubes where J(x) vanishes contribute zero while the others contribute at most fe. f(g(x))J(x) dx . Thus the lower Rie- J mann sum is bounded above by Ig(u) f(x) dx, hence so is the integral. This completes the proof of the reverse estimate in the general case. QED 15.2.3 Polar Coordinates As an example we consider polar coordinates. The situation in ]R2 is familiar. We have r o (x2 + y2)1/2, Y arctan -, x relating the polar coordinates r and 0 to the Cartesian x and y coor­ dinates, and x r cos 0, y r sin 0 in the reverse direction. To get a one-to-one correspondence we must omit the origin in ]R2 (a set of content zero that doesn't contribute to the integral) and suitably restrict 0, say -7r < 0 < 7r. Thus we let D' = {(r, O) : r > ° and -7r < 0 < 7r} and D = {(x, y) : (x, y) #- (O, O)}, with g: D' .,. D defined by g(r, 0) = (rcosO,r sin O) . Note that 9 is one-to-one and onto. (The domain D' is not open because it contains the boundary strip 0 = 7rj but since this is a set of content zero, we can ignore it. Technically, to apply the theorems as stated, we should take D' to be given by -7r < 0 < 7r and D to be ]R2 with the negative real axis omitted.) We compute easily d = ( cos 0 9 -r sin 0 so det dg = r and, hence, sin 0 ) r cos 0 ' 1. f(x, y) dx dy = j 7r foo f(r cos 0, r sin O)r dr dO. ]R 2 -7r Jo 15.� Change of Variable in Multiple Integrals 115 Next we consider the situation in Rn . We have polar-spherical co­ ordinates r, 8b 82 , ... , 8n-l related to Cartesian coordinates Xb ... , Xn by Xl - rcos 8l X2 - r sin 81 cos 82 x3 - r sin (h sin ()2 cos 83 Xn-l r sin ()l sin 82 . . . sin ()n-2 cos ()n-l Xn - r sin 81 sin 82 . . . sin 8n-2 sin 8n-l , which we write X = g(r, ()) and in the reverse direction r - Jxi + ... + x� 81 Xl arc cos - r 82 x2 - arc cos r sin ()l Xn-l -8n-2 arc cos r sin 81 . . . sin 8n-3 8n-l Xn - arc tan -- . Xn-1 If we take D'{(r, 8) : 0 < r < 00, 0 < 81 < 1r, ••• , 0 < 8n-2 < 1r, -1r < 8n- l < 1r} , then 9 maps D' one-to-one onto D = {xn : Xl ::1= 0, X2 ::1= 0, ... , Xn ::1= A}, which differs from Rn by a set of content zero. Next we compute dg = C08 lh -r sin lh ain 'l C08 '2 \" C:OS 'l C:OS'2 sin lh sin 82 '\" sin 8n -2 c08 8n-l rC0881 sin 82 '\" sin8n_2 c08 8n-1 sin 81 sin 92 '\" sin 9n - 2 sin 9n -1 r C0891 sin 82 '\" sin 9n- 2 sin 8n- 1 o o -r sin 81 '\" sin 8n-1 r sin 91 '\" sin 9\",- 2 c089n-l where the first column is (8xj/8r), the second column is (8xj/88t }, ... , and the last column is (8x j / 88n-l ). 716 Chapter 15 Multiple Integrals Lemma 15.2.4 det dg = rn-1 (sin (h )n-2 (sin fh)n-3 . .. sin (}n-2 . Proof: We prove the result by induction, the case n = 2 having been previously computed. Suppose the result is true for n - 1. Notice that the last column of dg (the (}n- I derivative) has only two non-zero entries. We can eliminate one of these non-zero entries without chang­ ing the determinant by multiplying the last row by sin (}n- I I cos (}n- I and adding it to the (n - 1)th-row. This has the effect of reducing the upper left (n - 1) x (n - 1) submatrix of dg to that of the n - 1 case except that the last row is multiplied by cos (}n- I + sin2 (}n- Il cos (}n-I . Thus det dg = r sin (}I ... sin (}n-2 [cos (}n- I (cos Iin- 1 + sin2 :n- l ) 1 det dgn- I cos n- I where gn-I denotes the (n -I)-dimensional case. Note that the expres­ sion in brackets equals 1. Then by the induction hypothesis QED n-I ( ' (} )n-2 . (} � r SIn I ... sm n-2 . Thus we have the integration formula = j7r f7r.. . f7r foo f (r cos (}I , r sin (}l cos (}2, . . . , r sin (}l ... sin (}n- I -7r Jo Jo Jo rn- I (sin (}I )n-2 (sin (}2 )n-3 ... sin (}n-2dr d(}l d(}2 .. . d(}n- I ' This is especially useful if f is a radial function (a function of r alone) . Then we can evaluate the polar-spherical integral as an iterated inte­ gral, and the (}-integrations just produce a constant en depending on the dimension 15.2 Change 01 Variable in Multiple Integrals 717 15 .2 .4 Change of Variable for Lebesgue Integrals * In the context of the Lebesgue integral we can obtain a stronger change of variable theorem, allowing a general Lebesgue integrable function 1 and also weakening the assumption on the domain. Suppose U is an ar­ bitrary open set in lRn and 9 : U � lRn is a one-to-one C1 mapping. No­ tice that we are not assuming anything about the behavior of 9 on the boundary of U. In particular, the Jacobian factor J(x) = Idet dg(x) 1 does not have to be bounded. By the way, the boundary of a gener­ al open set can be quite bizarre; it can even have positive Lebesgue measure, so the integral of a function over the closure of U might be different from the integral over U. In most applications of the change of variable formula the set U is rather tame, but frequently we need to deal with unbounded sets and mappings 9 that do not extend con­ tinuously to the boundary. Note that our hypotheses do imply that g(U) is an open set (but this is a deep theorem, Brouwer's Invariance of Domain Theorem, which we will not prove here), but the Jacobian factor may .have zeros in U (as is the case for g(x) = x3 on lR) . To explain the change of variable formula from the Lebesgue point of view we need a simple construction that gives the image of a measure under a mapping. Suppose we have a measurable function 9 : X � Y for two measure spaces (so there are u-fields f1 on X and f2 on Y such that g-l (A) is in f1 for every A in f2 ). In our case X will be U and Y will be g(U) , with the u-fields of Borel sets. If lJ is a measure on X, then define the image measure lJ 0 g- l on Y by This definition makes sense even if 9 is not one-to-one, and it is easy to show that lJ 0 g-l is a measure (see exercise set 15.2.5) , because taking inverse images commutes with set-theoretic operations. Intuitively, if you think of I! as a mass distribution on X, then lJ 0 g -l moves the mass via 9 onto Y (if some regions of Y are hit more than once, then the mass transported by 9 is simply summed) . A basic property of the image measure is the integral identity Jy Id(lJ 0 g-l ) = Jx lo g dlJ for any non-negative measurable func­ tion 1 on Y (and more generally for any integrable 1 with respect to the measure lJ 0 g- l ) . Indeed, if 1 is the characteristic function of a measurable set A in f2 , 1 = XA , then lo g = Xg-l (A) because x is in 718 Chapter 15 Multiple Integrals g- l (A) if and only if g( x) is in A. Thus the integral identity reduces to the definition for characteristic functions. It then follows easily that it holds for simple functions and then for non-negative measurable func­ tions by the definition of the integral. The integral identity is in some ways more natural than the definition since it involves 9 rather than - 1 9 . What does this have to do with the change of variable formula? If we denote by /-L Lebesgue measure on lRn and /-Llu its restriction to U and let 1I = J(x)d/-Llu(x), then one side of the change of variable formula is Iu l o g dll, which is just Jg(U) I d 1I 0 g- l. Thus the change of variable formula says that 1I 0 g- l is equal to Lebesgue measure restricted to g(U). Lemma 15.2.5 II U is open in lRn and 9 : U .,. lRn is one- to-one and C1 , then 1I 0 g-l is equal to Lebesgue measure on g(U) , where 1I = J( x )d/-Llu(x) . Proof: Let R denote any closed rectangle contained in U. Then we can apply the change of variable theorem to the mapping 9 : R .,. g(R) to get 1 I d/-L = fl o 9 dll g(R) J R for any continuous function I on 9 (R) . In particular, /-L (g (R) ) = 1I 0 g-l (g( R) ). Similarly, if A is any subset of R whose boundary has content zero, then /-L(g(A) ) = 1I 0 g-l (g(A)). Consider first the special case of a rectangle R such that J (x) =1= 0 on R. Then the inverse function theorem implies that g- l is a C1 mapping from g(R) to R, so any rectangle B contained in g(R) is of the form B = g(A) where A = g- l (B) has boundary with content zero. Thus /-L and 1I 0 g- l agree on rectangles contained in g(R) , hence by the Hahn uniqueness theorem they are equal as measures on g(R) . What do we do with the set where J(x) = O? This is called the critical set for the mapping g. Notice that it is a closed set, since J(x) is continuous; and if we restrict attention to a bounded subset of U, say Ur = U n { Ixl < r}, then it is compact. Given any c, we can cover the set of points in Ur where J( x) = 0 by rectangles on which J(x) < c (because J(x) is continuous) , and by compactness can reduce to a finite subcover, say Rl l ... RN. Also, by further decomposition if 15. 2 Change of Variable in Multiple Integrals 719 necessary, we can make the interiors of these rectangles disjoint. We can still apply the change of variable theorem on each rectangle Rk, so we have This means v 0 g-l (Y9(Rk)) < 0 �J'(Rk) = oJ' (yRk) < ejJ(Ur) < erne since Ur is contained in the ball {I x I < r }. Since J(x) ::j:. 0 on Ur \\ Uk Rk and we can write this set as a count­ able union of rectangles, we know that jJ = 1I 0 g-l on g(Ur \\ Uk Rk) = g(Ur) \\ Uk 9(Rk). But Uk g(Rk) has measure at most crne for both measures, so IjJ(A) - 1I 0 g-l(A) 1 < crne for any measurable subset of g(Ur). First let e -+ 0 to get jJ = 1I 0 g- l on g(Ur) , and then let r -+ 00 to get jJ = 1I 0 g- l on g(U). QED Theorem 15.2.3 Let U C ]Rn be open and 9 : U -+ ]Rn be one-to-one and C1 • Then for any non-negative measumble function f on g(U) , { fdjJ = ( f 0 gJdjJ. Jg(U) Ju More generally, if f is real- or complex-valued and measumble on g(U), then f is integrable if and only if f 0 gJ is integrable on U, in which case the change of variable formula holds. Proof: This is an immediate consequence of the lemma and the integral identity ( fd(lI 0 g-l ) = ( f 0 gdll. Jg(U) Ju QED One consequence of the change of variable formula is the fact that the image of the critical set under 9 has Lebesgue measure zero, 720 Chapter 15 Multiple Integrals p,(g(C)) = 0 where C = {x : J(x) = o} . Indeed, p,(g(C)) = lI(C) = Ie J dp, = 0 since J is zero on C and part of the proof of the lem­ ma involved convering the set g( C) by sets of small Lebesgue measure (after localizing to a bounded region) . An examination of the proof shows that we really do not need the assumption that 9 is one-to-one, because all we used was the upper bound p,(g(Rk)) < IRk J(x)dp,(x) and the proof of this in the previous section did not use the one-to-one hypothesis. This result is of importance in the theory of differential topology, where it goes under the name of Sard 's Theorem. Theorem 15.2.4 (Sard) If 9 : U -+]Rn is Cl and C = {x : detg(x) = O}, then g( C) has Lebesgue measure zero. Returning to the example of the integration formula for polar coor­ dinates worked out in section 15.2.3, we have the validity of this result for Lebesgue integrals. In particular, if f (r) is a measurable function on (0, 00) and we consider the corresponding radial function f( lxl) on ]Rn , which is also measurable, we see that f( lxl) is integrable on ]Rn if and only if r n- l f (r) is integrable on (0, 00) . Recall that rOt is integrable near r = 0 if and only if Q' > -1 and that rOt is integrable near r = 00 if and only if Q' < - 1 . That translates to the condition that Ixl Ot on ]Rn is integrable near the origin if and only if Q' > -n and integrable near infinity if and only if Q' < -no In particular, no power IxlOt is globally integrable. By cutting and pasting, we obtain the following useful criterion for integrability on ]Rn : Theorem 15.2.5 Suppose f is continuous on ]Rn except for a finite set of isolated singularities al , ... , an . Suppose we have If (x) 1 < ck lx - ak lOtk for x near ak and If(x) 1 < clx l.B for all large x, where Q'k > -n for all k and f3 < -no Then f is integrable. 15.2.5 Exerc ises 1. Evaluate J�oo e-x2 dx by considering IIR2 e-x2 -y2 dx dy as an iter­ ated integral and in polar coordinates. 2. Prove that a one-to-one Cl mapping 9 : U -+ g(U) is measure­ preserving (p, (g(A) ) = p,(A) for every measurable subset A C U) if and only if det dg(x) = ±1 for every x in U. 15.2 Change of Variable in Multiple Integrals 721 3. Classify all continuous measure-preserving transformations 9 : lR .,. R Give an example of a discontinuous measure-preserving transformation 9 : lR .,. R 4. Prove that the set of non-invertible n x n matrices has measure zero in lRn 2 • 5. Let GL(n, lR) denote the set of n x n invertible real matrices. Prove that for any y in GL(n, lR) , r f(xy) ldet x l -n dx = r f(x) ldet xl -n dx JCL(n,lR) JGL(n,lR) for any non-negative measurable function f : GL( n, lR) .,. lR, where xy denotes matrix multiplication. Is the same true if we replace xy by yx? 6. Define a multiplication on lR2n+ 1 as (x, y, t) 0 (x', y', t/) = X + x' , y + y' , t + t' + x . y' - x' . y) for x in lRn , y in lRn , t in lRl . Prove that J1R2n+1 f( (x, y, t)o( x', y', t/)) dx dy dt = J1R2n+1 f(x, y, t)dx dy dt for any (x', y', t/) . 7. Prove JlRn f(tx ) dx = t-n fIR f(x) dx for any t > 0 where tx (tx l , tX2 ,\" \" txn ). Show also flRn f(tx)dx/ lxln = JlRn f(x)dx/ lx in. 8. Prove JlRn f(x/ lxI2 )dx/lxln = flRn f(x)dx/ lxl n• 9. Complete the proof of the estimate vol(Ac) < vol(A) + ce(r+c)n- l for c < 1 if A is a parallelopiped in lRn contained in a ball of radius r, where c is a constant depending only on n. 10. Suppose U is a bounded open set in lRn whose boundary has con­ tent zero. If 9 : U .,. lRn is CI on the closure of U, show that the boundary of g(U) has content zero. 11. a. Suppose U is a bounded open set in lRn whose boundary has contant zero. For each fixed 8, decompose lRn by the standard tiling with cubes of side length 8; and let {Ck } be the collection of cubes in the tiling that lie entirely in U. Show that L:k vol( Ck) converges to vol(U) as 8 .,. O. 722 Chapter 15 Multiple Integrals b. Suppose that g : U -+ ]Rn is one-to-one and CI on the closure of U. Show that L:k vol (g ( Ck)) converges to vol(g(U) ) as 8 -+ O. 12. Let U be a bounded open set in ]Rn whose boundary has content zero. Consider finite partitions U = Uj Aj where the sets Aj have disjoint interiors and boundaries with contant zero. For f a continuous function on the closure of U, form the generalized Cauchy sums L:j f(xj )vol(Aj ) where Xj is an arbitrary point in Aj . Prove that these sums converge to Iv f(x) dx as the maximum diameter of the sets Aj tends to zero. 15.3 Summary Definition If f is a continuous function defined on a rectangle R = [a, b] x [c, d] in ]R2 , the Riemann double integral I I R f (x, y) dx dy is defined to be the limit of Cauchy sums N M S(f, P) = L L f(xj, ih ) (xj - Xj-l)(Yk - Yk-l ) j=l k=l where P denotes a partion a = Xo < Xl < . .. < X N = b, c = Yo < Yl < . . . < YM = d, of the sides of the rectangle, Xj-l < Xj < Xj , Yj- l < iiJ < Yj , and the limit is taken as the maximum lengths of X j - x j-l and Yk - Yk-l both tend to zero. Theorem For a continuous function on a rectangle R = [a, b] x [c, d] , the double integral is equal to each of the iterated integrals fcd(f; f(x, y) dx) dy and I;(f; f(x, y) dy) dx. Definition A subset of the plane is said to have content zero if for every c > 0 there exists a finite covering by rectangles whose areas sum to at most c. Corollary The double and iterated Riemann integrals are equal for a continuous function defined on a compact subset of the plane whose boundary has content zero. 15.3 Summary 723 Lemma If J.1. denotes Lebesgue measure on ]R2 , then for any measurable set A, where the iterated Lebesgue integrals are well defined. Corollary The Lebesgue integral of a non-negative function f on ]R is equal to the Lebesgue measure of the region under the graph. Theorem 15.1.1 (Fubini 's Theorem, first version) Let f be a non­ negative measurable function on ]R2 . Then the double and iterated Lebesgue integrals are equal. Theorem 15.1.2 (Fubini 's Theorem, second version) Let f be inte­ grable on ]R2 . Then the double and iterated Lebesgue integrals are e­ qual; and for almost every y, f(x, y) as a function of x is integrable and J f(x, y) dx is integrable as a function of y, and the same is true with x and y reversed. Example The function f(x, y) = { 1 if 0 < x < 1, -1 if - 1 < x < 0, o otherwise is not integrable, but the iterated integral J(J f(x, y) dx) dy = O. Theorem 15.1.3 (Fubini 's Theorem, third version) Let f be measur­ able on ]R2 . If one of the iterated integrals of If I is finite, then f is integrable and the double and iterated Lebesgue integrals (in both order­ s) of f are equal. Theorem 15.1.4 (Ll Convolution Theorem) The convolution f*g(x) = J f(x - y)g(y) dy is well defined for f and 9 in Ll in the sense that for almost every x, the function h(y) = f(x - y)g(y) is integrable. Furthermore, f * 9 is in Ll and Il f * gl h < Il f l hllgl h. 724 Chapter 15 Multiple Integrals Definition A monotone class M is a collection of subsets of X that is closed under monotone increasing and decreasing sequences. Lemma 15.1.1 (Monotone Class)If a monotone class contains a field, it contains the u-field genemted by the field. Lemma 15.1.2 If A is a Borel subset of JR2 , then every section Ay is a Borel set of JR and the Lebesgue measure of Ay is a measurable function of y· Definition A measure /-L on X is u-finite if X = U�1 Xj and /-L(Xj) is finite for all j. Theorem 15.1.5 (Hahn Uniqueness Theorem)If two u-finite measures are equal on a field, they are equal on the u-field generated by the field. 15.2 Change of Variable in Multiple Integrals Definit ion Let AI , . .. ,An denote n vectors in JRn . The parallelopiped generated is defined to be the set of vectors of the form 2:7=1 bj Aj with o < bj < 1. Theorem 15.2.1 If g(x) = Ax where A is an n x n matrix, then vol(g(R) ) = Idet A lvol(R) for any rectangle R. Definition If 9 : U -+ JRn is a C1 function for U an open set in JRn , then the Jacobian factor is J(x) = Idet dg(x) l. Definition The c-neighborhood Ac of a set A is the set of points at distance at most c from A. Lemma 15.2.1 There exists c depending only on n such that vol(Ac ) < vol(A) + cc(r + c)n- l for c < 1 for every parallelopiped A contained in a ball of radius r. Lemma 15.2.2 Let C8 denote a cube centered at x of side length 8. Suppose 9 is CI on C8 satisfying Ildg(x) 11 = M and Il dg(x) -dg(x) 11 < c 15.9 Summary 725 for all x in Cfj. Then vOl(9(C6)) < (J(i) + ce)6\" where c depends only on n and M. Lemma 15.2.3 Let 9 : U � R\" be one-to-one on a bounded open set U whose boundary has content zero, and suppose 9 is CI on the closure of U. Then vol(g(U)) < Ju J(x) dx and 1. f(x) dx < f f(g(x))J(x) dx g(U) Ju for any non-negative continuous function f on the closure of g(U). Theorem 15.2.2 (Change of Variable Formula) Let 9 : U � a\" be a one-to-one map of a bounded open set U whose boundary has content zero, and �sume 9 is C1 on the closure of U. Let f be continuous on the closure of g(U) . Then 1. f(x) dx = f f(g(x))J(x) dx. g(U) Ju Example (Polar Coordinates) 1 f(x, y)dx dy = 1 11' fOO f(r cos8,r sin 8)r dr d8. an -11' 10 Definition Polar-spherical coordinates in R\" for n > 3 are r, 81 , 82, ... , 8,,-1 given by Xl - rcos 81 x2 r sin 81 COS 82 x3 r sin 81 sin 82 cos 83 X,,-1 r sin 81 sin 82 ' . . sin 8,,-2 cos 8,,-1 X\" - r sin 81 sin 82 .. . sin 8,,-2 sin 8,,-1' 726 Chapter 15 Multiple Integrals Lemma 15.2.4 If 9 denotes the mapping (r, 8) .,. x given by polar­ spherical coordinates, then 9 maps D' = {(r, 8) : 0 < r < 00, 0 < 8j < 7r for j < n - 2 - 7r < 8n- l < 7r} one-to-one onto D = {x : Xj #- 0 all j} and d td n-l ( . il )n-2 ( . il )n-3 . il e 9 = r sin Ul sin U2 ••. sin Un-2. Corollary If 9 is radial ( i. e. , a function of r alone), then IIR. n f (I x I) dx = en 1000 f(r)rn- l dr where en is a constant depending on the dimension n alone. Definition If 9 : X .,. Y is measurable function (with repect to (7- fields :Fl on X and :F2 on Y) and 1I is a measure on X, then the image measure lIog- l on Y is given by lIog- l (A) = lI(g-l (A) ) for any A in :F2 . Lemma If f is a non-negative measurable function on Y, then Jy fd(lI 0 g- l ) = Ix f 0 gdll. Lemma 15.2.5 Let /-L denote Lebesgue measure on ]Rn and /-L lu denote its restriction to U. Suppose U is open and 9 : U .,. ]Rn is one-to-one and Cl . If 1I = J(x) d/-L lu, then 1I 0 g- l = /-L lg(u) . Theorem 15.2.3 Let U be open and 9 : U .,. ]Rn be one-to-one and Cl . Then Ig(u) f d/-L = Iu f 0 gJ d/-L for any nonnegative measurable function f on g(U) . Moreover, f is integrable if and only if f 0 gJ is integrable on U, and the same identity holds. Theorem 15.2.4 (Sard) If 9 : U .,. ]Rn is Cl and C = {x : det dg(x) = O} is the critical set of g, then /-L(g(C) ) = O. Theorem 15.2.5 Let f be continuous on ]Rn except for a finite set of singularities al , ... , aN , and suppose If(x) 1 < ck lx - ak iak for x near ak and If(x) 1 < clxl.B for all large x, where Q:k > -n for all k and f3 < -n. Then f is integrable. Index A primer of real analytic functions 294 a.e. 667 absolute convergence of Fourier series 548 absolute convergence 250 absolute value 20, 242 absolutely convergent improper in­ tegral 233 absolutely convergent integral 655 absolutely convergent 253, 260, 262 640, 664 acceleration 177 accumulation point 79 additive group 327 additive identity 41 additive 662, 664 additivity 206, 224, 231, 628, 644 affine approximation 419 affine function 145, 419 algebraic identities 48 algebraically complete 242 algebraic 177 algebra 399, 631 algorithm 66 almost everywhere 550, 667 alternating 706 analytic continuation 281, 285 analytic expression 558 analytic functions 285, 286 , 293 727 angle 360 angular momentum 508 anti-derivative 208, 520 approximate identity lemma 301 , 541 approximate identity 297, 330, 533, 558 approximating sum 201 approximation by polynomials 296 Archimedes xiii arc length parametrization 616, 653 arc length 212, 610, 614 arcsin 338 arctangent integral 346 arctangent 218, 346, 349 arcwise connectedness 393 arc 394 area under the graph 201, 695 area 201 , 631 arithmetic 38 Arzela-Ascoli theorem 312, 383, 392, 410, 485, 490, 492 associated 361 associative 41, 298, 356 attractor 412 autonomous 502, 581 average value 668 average 206 axiom of Archimedes 20, 34, 42, 46, 47, 63 , 64, 370 728 ball 369 Banach space 355, 377, 670 basis 356 Bernoulli xiii, 515, 547 Bessel functions 285 , 348 Bessel's differential equation 501 Bessel's inequality 544, 546 Bessel 's o.d.e. 500 best affine approximation 148, 420 best approximation 307 big Oh 147 bilinearity 360 binomial expansion 252, 287 binomial series 295 binomial theorem 279, 324 Bishop 26, 66 blip functions 329 Bolz ano 's example 403 Bolz ano xiv, 25, 403 Boolean algebra 632 Borel sets 633 Borel 332 boundary conditions 464, 519, 520, 529 bounded away from zero 46 bounded from above 75 bounded variation 618 bounded ness 382 bounded 40, 84 broken line segment 395 Brouwer fixed point theorem 399 Brouwer's invariance of domain the- orem 717 Brouwer 399 Brownian motion 403 C([a, b)) 359 C1 151, 422 C2 177, 440 COO 281, 440 Ck 440 Index Cantor set 95, 99, 633, 641, 652, 554, 659 Cantor xiv, 8, 11, 25, 634 Caratheodory theorem 652 Caratheodory 643, 648 cardinality 8 Carleson 550 Cartesian coordinate 581, 715 Cartesian product 10, 13, 22, 601, 700 Cauchy completion of the rationals 26 Cauchy criterion 30, 50, 234, 253, 265, 274, 313, 374 Cauchy data 467 Cauchy initial value conditions 467 Cauchy principal value integrals 234 Cauchy problem 467 Cauchy sequence 25, 31, 34, 36, 50: 62, 246, 374, 376 Cauchy sum 202, 220, 247, 249, 268: 487, 692, Cauchy 's method of majorants 496 Cauchy-Kovalevsky theorem 494 Cauchy- Schwartz inequality 361, 362, 365, 479 , 674 Cauchy xiv, 25, 30, 268 celestial mechanics 459 center 369 Cesaro summability 538, 550 chain rule 168, 428 change of variable 211, 232, 705, 713, . 71 7, 719 character identity 526 characteristic function 275, 308 , 658, 694 char acteristic polynomial 445 Index characters 527 Chebyshev inequality 672, 675, 681 choice function 23 chord-length 369 circle 583, 584, 593, 599 cis 343 classical mechanics 505 classical real number system 26 closed interval 86 closed sets 91, 373 closure properties 372 closure 97, 373 cluster point 79, 92 Cohen 12 commutative group 356, 526 commutative 41 commutativity 298 compact domains 131, 391 compact sets 99 compa�tness 309, 377 comparison test 253, 255, 262 completeness of the reals 51 completeness 28, 34, 50, 246, 374, 547, 680 complete 382, 672 completion 376, 670 complex analysis 247 complex conjugate 250 complex domains 286 complex exponentials 344 complex inner product 365 complex mUltiplication 347 complex number system 241 complex numbers 54 complex plane 285 complex square root 573 complex vector space 364 complex-valued functions 247, 274 composition 168, 288 729 compound interest 336 computer experiment 255 Conditional continuity from above 635 conditional probability 655 configuration space 505 connectedness 113, 393 conservation of energy 506 constant coefficient partial differen- tial operator 454 constraints 602 construction 68 constructive analysis 66 constructive content 66 constructive real number system 26 Constructivism 6 content zero 228, 693 content 228 continued fractions 55 continuity from below 635 continuity of translation 68 1 continuous differentiability 148 continuous from the right 125 continuous functions 387 continuously differentiable 151, 422 continuous 111, 388 Continuum Hypothesis 12 contour map 436 contractive mapping principle 397, 469, 471, 476, 482, 574, 575 contrapositive 2 converge conditionally 258 convergence in the mean 543 convergence 250, 276 convergent subsequence 310 converge unconditionally 258 converge uniformly on compact sets 268 converge 36, 373 730 converse 2 convolution 297, 698 cookbook 463 coordinate components 389 coordinate maps 599 coordinate patches 595, 599 coordinate projections 389 corners 151 cosine 285, 337, 344 countable additivity 628 countable axiom of choice 22, 381 countable coverings 637 countable dense subset 98, 312, 380 countable sets 8 countable 9 counting measure 640, 654 coupled 467 cover 101 Cramer 's rule 570 critical point 441 , 451 critical set 718, 719 cross product 435 crumpled handkerchief 626 cube root 55 , 151 curl 508 curve 394, 568, 581 curvilinear coordinates 581 cusp 584, 585 DN 533 D' Alembert 518 damped vibrating string equation 529 damping term 518 decreasing 154 Dedekind cuts 56, 59 Dedekind real number system 60 Dedekind xiv, 25 , 59 definite integral 201 definition of the integral 660 Index degree 390 dense 28, 97, 374 density of continuous functions 678 density of the rationals 34, 48 derivative 143, 420 derived set 99 determinants 570, 705 diagonalizable 444 diagonalization argument 11, 81 diagonal 313 diameter 382, 652 difference equation 485 difference operator 439 differentiable 144, 404, 419, 420 differential 420, 597 differentiate 281 differentiation of integrals 207, 432, 668 dilate 650 direct proof 6 directional derivative 423 Dirichlet boundary conditions 521 Dirichlet kernel 533, 539, 551 Dirichlet problem 561 Dirichlet's function 223 , 225, 228 , 270, 624 Dirichlet 223, 531, 559 discontinuity of the first kind 125 discontinuity of the second kind 125, 275 discriminant 55 distance function 357 diverge to + 00 251 divergent 251 divide and conquer 53, 76, 130 domain 111 Dominated Convergence theorem 625, 666, 670 dominates 225 , 665 Index dot product 360, 435 double indexed series 260, 262, 704 doubling time 336 du Bois Reymond 550 dyadic pieces 255 e 323 c-neighborhood 709 eigenvalue 444, 521 eigenvector 444, 521 Einstein 459 elementary functions 389 embedded surfaces 585 embeddings 585, 588 empirical evidence 520 energy 505 entropy 610 equality of mixed partials 437 equation of a vibrating string 515 equicontinuity 309 equivalence class 35, 36, 668, 671 equivalent 34, 85, 386, 671 Euclidean distance 357 Euclidean inner product 361 Euclidean norm 358 Euclidean space 355 , 368 Euclid 59 Eudoxes 59 Euler identities 345, 525 Euler's method 485 , 490 Euler xiii , 74, 517, 525 everted 585 exact 568, 580 examples of measures 639 existence and uniqueness 467 existence of Lebesgue measure 648 existence of measures 643 existential quantifier 3 exponential decay 328 731 exponential function 285 , 323, 459 exponential growth 328 exp 324 extended real number system 74, 657 extensions 524 Fu set 232 fair coin 640 Fatou's theorem 663, 670 Fatou 663 Fejer kernel 539 Fejer 539, 550 Fermat 157 Fibonacci sequence 263 field axioms 41, 241 field 19, 41, 632 filter 23 finite coverings 637 finite intersection property 106 first order linear partial differential equation 506 first uncountable ordinal 633 fixed points 397 flaps 301, 305, 334 fold singularity 587 follow your nose 15 Fourier analysis 527 Fourier coefficients 522, 532, 676 Fourier cosine expansion 523 Fourier series xiii, 112, 255, 267, 270, 276, 515, 624, 625, 670, 676 Fourier transforms 527 Fourier's conjecture 550 Fourier 519, 559 fractal geometry 650 fractals 643 Frankel 25 Frege xiv, 25 Fubini 's theorem, first version 696 732 Fubini 's theorem, second version 697 Fubini 's theorem, third version 698 Fubini 's theorem 694, 700, 702 full Fourier series 524 functional-differential equations 460 functional 309 functions of a complex variable 286 functions 111 fundamental theorem of algebra 242 fundamental theorem of the calculus 207, 250, 271 , 462 fundamental tone 517 Go set 232 Go set 639, 642 GL(n, JR) 721 g.l.b. 77 Godel 12 Galileo 8 gamma function 348 General Relativity 459 generated 633 geometric average 280 geometric series 251 Gibbs' phenomenon 550, 555 Global Existence and Uniqueness 472 global Lipschitz condition 470, 474 global solutions 461 glue 329 gluing 128 Goldbach's conjecture 5, 66 gradient vector field 502 gradient 421 Gram-Schmidt orthogonalization 522 graph of a function 582 graph-of-function representation 582 graph 113 gravitational forces 459 gravitation 508 greatest lower bound 77 group representations 527 group 527 Index Holder condition 123, 126, 194 Hahn uniqueness theorem 703 Hahn 703 half life 336 Hamilton-J acobi equations 506 Hamiltonian mechanics 505 Hamiltonian 505 harmonic analysis 520, 525 harmonic series 255 hat function 308 Hausdorff dimension 653 Hausdorff distance 411 Hausdorff measures 643, 650 Hausdorff 650 heat equation 519, 555, 680, 682 heat kernel 558 Heine-Borel property 378, 385, 391 Heine-Borel Theorem 103, 230, 274, 379, 629 Heine xiv, 25 Hermitian linearity 365 Hermitian symmetry 365 Hessian 437, 607 higher derivatives 437 higher order equations 481 Hilbert space 355, 377, 673 homogeneity 358 homogeneous linear o.d.e. 473 homomorphisms 527 Hubbard 560 hypergeometric functions 285, 348 i 241 image 111, 132, 387 immersed surfaces 585 Index immersions 585, 588 Implicit Function Theorem 462, 567, 571 implicit description 597 implicit differentiation 571 , 578 implicit function theorem 598 implicitly 582 improper integrals 232, 219, 625 improper Riemann integrals 664 increasing 77 indefinite integral 210 independent trials 640 independent 700 indirect proofs 6, 16 infimum 74 infinite decimal expansions 29, 56 infinite matrix 259 , 312 infinite sets 8 infinite Taylor expansion 335 infinitesimals 63, 628 inf 74, 391 inhomogeneous linear o.d.e. 473 initial value conditions 463 inner product space 355 inner product 358 inner regularity 638, 642 integral equation 487 integrable functions 664 integrable singularity 233 integrable 664 integral curves 501 integral differential equation 484 integral equation 46 7, 482, 579 integral remainder formula 210, 218, 248, 249 integral 201, 655 integration by parts 210 integration of the derivative 209 interchange of integrals 214, 691 733 interior 96, 370 intermediate value property 248, 396 intermediate value theorem 130, 158 interval of convergence 280 intrinsic 596, 600 Intuitionism 6 Inverse Function theorem 171, 571, 592 inverse functions 171, 567 inverse images 121, 387 invertible 569 isodiametric theorem 652 isolated point 118 iterated function system 412 iterated integrals 691, 694, 704 iterated mapping 397 iterate 177 J aco bian 709, 717 jump discontinuity 125, 136, 229 , 275 KN 539 kernel 588 Kolmogorov 550, 640 Krantz 294 L 1 convolution theorem 698 L 1 metric 376 L1 670 L 2-norm 544 L2 673 l'Hopital's Rule 127, 185, 191, 453 l. u.b. 77 Lagrange interpolation polynomial 297 Lagrange interpolation 296 Lagrange multipliers 602, 603 Lagrange remainder formula 188, 193, 248, 452 734 Lagrange 296 Lakatos 268 Laplace equation 682 latitude-longitude 584 law of cosines 348 least upper bound 77 Lebesgue approximate sums 656, 658 Lebesgue Differentiation of the Inte- gral Theorem 668 Lebesgue integral 623 Lebesgue measure on ]Rn 639, 648 Lebesgue measure zero 550 Lebesgue measure 627, 630, 634, 636, 641 , 643, 648, 652, 654, 718 Lebesgue monotone convergence the- orem 661 Lebesgue sets 634 Lebesgue spaces 670 Lebesgue theory of integration 224 Lebesgue 163, 270, 550, 626, 634 Legendre functions 348 Leibniz xiii, 74, 143 lemniscate 605 length 611, 627 level sets 597 lexicographic order 283 liminf 81 limit points 92, 78, 373 limits from above and below 124 limits of functions 111 limit 31, 36, 50, 73, 201, 244, 373 limsup 81 linear algebra 356, 419 linear equations 473 linear spline 275 linearity 206 , 224, 231 linearly independent 356 linear 461, 662, 664 Lipschitz condition 123, 129, 138, 139, Index 149, 163, 232, 274, 397, 421, 469, 578 little oh 147 local coordinate map 595 local existence and uniqueness 476 local extrema 441 local inverse function theorem 175 local Lipschitz condition 470, 476 local maxima and minima 154, 441, 45 1 local solutions 460 localization theorem 559 localization 549 log-log graph paper 336 logarithm 279, 285, 323, 347 logic of connectives 2 log 326 lower semi-continuity 125 m-dimensional 591 m-dimensional manifold 599 m-dimensional surfaces 582 Majorant lemma 497 majorant 496 manifold 599 mapping 397 mass 631 maxima and minima 602 maximum and minimum problems 432 maximum interval length 202 max 128 mean value theorem 160, 210, 248 , 272, 436 mean-square convergence 550 measurable functions 655, 657 measurable sets 631, 634, 655 measurable space 655 measurable 656 Index measure preserving 720 measure space 655 measure zero 638, 667, 693 measure 623, 63 1, 634 Meray 25 metric outer measure 647 metric space 355, 368 metric 357 midpoint rule 216 Minkowski 's inequality 470, 664, 669 min 128 models 12 modulus of continuity 124 modulus 242, 305 moments 305 momentum space 505 momentum 508 monomial 390 Monotone Class Lemma 700 Monotone Convergence Theorem 625, 660, 661, 665 monotone class 701 monotone decreasing 135 monotone function theorem 135 monotone functions 134 monotone increasing 77, 135, 153 monotone 635 , 662, 664 monotonicity 643 multi-index 389, 440 multilinear 706 multiple integrals 228 , 625, 691 multiplicative group 327 multiplicative inverses 241 multiplicative 42 multiplicativity 242 multiply indexed series 259 n-body problem 508 Napier 350 natural logarithm 323 negative definite 441 negative 20, 41, 46 negligible sets 638 neighborhood 74, 90, 370 nested sequence 385 nested 105 735 Neumann boundary conditions 522 Newton xiii , 143, 177 Newton 's method 573 Newtonian mechanics 505 , 516 non-constructive mathematics 21 non-measurable function 657 non-negative definite 441 non-positive definite 441 non-standard analysis 63 non-standard numbers 26, 64 nondegenerate 452 nonmeasurable sets 644 nonnegativity 634, 643 nonsingular 569 normal form 462, 580 normal .§J>ace 598 normed space 355 norm 358, 361, 364, 570, 670 nowhere differentiable functions 403 null- space 588 numerical integration 214 o.d.e. 460, 567 one-to-one 112 onto 171, 387 open balls 369 open covering 101, 378 open interval 86 open neighborhood 90 open sets 86, 368 operator 166, 438 , 520 order of a zero 190 736 order of quantifiers 263 ordered field 20, 27, 34, 38, 46, order 20, 45, 390 ordinary convergence 251 ordinary differential equations 343 , 459 Oresme 208 orthogonal matrix 444 orthogonal projection 544 orthogonal 367 orthonormal basis 366 oscillation 83, 221, 248 osculating plane 617 outer measure 643 outer regularity 638 overtone series 517 7r 349 p-adic integers 386 p-adic metric 385 p-norm 359 p.d.e. 515 parabolas 607 paradox 628 parallelogram law 363, 367 parallelopiped 705 parametric representations 582 parametrically 581 Parks 294 Parseval identity 547, 549, 670, 676, 679 partial derivatives 423 partial differential equations 506, 515 partial sums 250, 532 partition the range 626 , 655 partitioning the domain 626 partition 201, 248 path 394 Peano curves 407 Peano existence theorem 490 Peano xiv , 25, 407 perfect sets 93, 96 perimeter 710 periodic convolution 533, 704 periodic extension 524 periodic 218 perturbation series 474, 570 perturbation 469 perturbed equation 474 phase space 505 Picard iteration 471 , 482, 579 piecewise constant 275 piecewise linear 275 Index pointwise convergence 263, 274 polar coordinates 348 , 453, 714, 720 polar-spherical coordinates 715 polarization identity 363, 366 polynomials 389, 448, 296 porcupine quills 465 positive definiteness 361, 441, 451 posi ti ve 20, 46 positivity 357, 358 , 368 potential energy 506 power series 184, 276 , 293, 308, 485 , 494, 525 power set 10 powers 328 primitive 210 principal normal 617 principal value integral 234 probability 626, 63 1, 640, 655, 700 product and quotient rules 165 product measure 700, 703 Projection theorem 544 proof by contradiction 16 Proofs and refutations 268 proofs 13 proper integrals 219 Index propositional calculus 2 prosthaphaeresis 350 Pythagorean formula 357 Pythagorean metric 368 Pythagorean theorem 242, 545 quadrants 154 quadratic form 441, 606 quantifiers 1 radial function 716 radius of convergence 276, 277, 286 radius of curvature 617 radius 369, 382 range 111 rank 587 rate of convergence 252 ratio test 254, 262 rational number system 18, 19, 34 Rayleigh quotient 446 real and imaginary parts 244, 247, 258, 262, 274 real number system 26, 36 rearrangements 256, 283, 292 recipes 463 reciprocal 42 rectifiable curves 610 recursive functions 67 recursive sets 10 reductio ad absurdum 17 refinement 204 , 656 regular singular points 500 regularization 331 relatively open 370 removable discontinuity 125 representative function 671 retarded differential equations 460 Riemann integrable 669 737 Riemann integrable 220, 223, 249, 268, 275, 623, 663, 669 Riemann integral 220, 270 Riemann theory of integration 663 Riemann upper and lower sums 202, 220, 247, 269 Riemann zeta function 254 Riemann-Lebesgue lemma 547, 549 , 681 Riemann 219, 531 Riesz-Fischer theorem 677, 678 rings 648 Robinson 26, 63, 143 Rolle 's theorem 161 root test 254, 262, 278 Russell 25 a-additivity 628, 634, 643 a-field 633 a-finite measures 703 a-subadditivity 636, 643 saddle points 448 , 605 Sard's theorem 720 scalar field 356 scalar multiplication 356 scalar product 360 scalars 356 scaling property 650 Schonberg 407 secant lines 177 second derivative test 605 second derivative 177, 437 second difference 179 second mean value theorem 164 second-order estimate 216 sections 694, 702 separable 485 separated 647 separately continuous 390 738 sequence of approximations 28 sequences of polynomials 296 shuffled sequence 78 side conditions 463 signed volume 706 simple closed curve 613 simple functions 658 simple zero 190 Simpson 's rule 217, 218, 485 sine series 520 sine 285, 337, 344 singularity 287, 500, 675, 699, 720 skew-symmetric multilinear form 706 skew-symmetric 525, 706 Smale 585 Solovay 631 space filling curve 407 spans 356 special functions 285, 348 spectral theory 520 spectral theorem 444, 522 speed of sound 454 sphere 369, 584, 593, 599, 601, 609 spherical coordinates 584, 593 splitting condition 643, 644 square roots 52, 347, 581 standard basis 356 step function 275 Stone-Weierstrass theorem 399, 543 strict local maximum 154 strictly increasing 153 strongly separates points 399 structure theorem for open sets 88, 638 structures 355 Sturm-Liouville operator 530 subadditivity 635 sub cover 101, 378 subsequence selection function 80 subsequences 79 subspace 368 summability method 538 summability 537 summation by parts 260 Index summing along diagonals 259 sup-norm 360, 366, 368, 376, 383, 469, 670 supremum 74 sup 74, 391 surface of revolution 601 surfaces 568, 581 symmetric difference 632 symmetric matrix 441, 522 symmetric second difference 192 symmetry 357, 360, 368, 521 systems of ordinary differential equa- tions 459 tail of the series 256 tangent bundle 601 tangent line 153, 177 tangent plane 421 tangent space 582, 590, 596 taxicab distance 359 Taylor expansion 183, 28 1, 303, 332, 448 Taylor series 293 Taylor's theorem 167, 181, 210, 218, 248 , 249, 448 temperature 519 term-by-term 281 topological space 372 topology 73, 90, 123 torus 601 total derivative 420 trajectory 394 transcendental functions 459 transcendental 325 Index transfinite induction 633 translation invariance 212, 654 translation 298 , 525 transpose matrix 367 transversal 147 trapezoidal rule 216, 485 triangle inequality 20, 47, 242, 243, 357, 358, 366, 368 trigonometic polynomial 410, 543 trigonometric functions 213, 244, 337, 520 truth table 2 twice continuously differentiable 177 two dimensional picture 32 ultra metrics 385 ultrafilter 23 unbias�d average 206 unbounded tn ... '\" above 75 uncountable axiom of choice 631 uncount able sets 10 uncountable 9 uniform Cauchy criterion 313 uniform continuity theorem 133 uniform continuity 111, 116, 117, 264, 266, 391 uniform convergence 263, 272, 392, 531 uniform limits 263 uniformly bounded 309, 383, 392 uniformly convergent subsequence 309, 392 uniformly differentiable 165 uniformly equicontinuous 311, 383, 385, 392 uniqueness of Fourier series 543 uniqueness of Lebesgue measure 703 unit sphere 568 universal gravitational constant 508 universal quantifier 3 unrestricted convergence 272 upper bounds 75 upper semi-continuity 125 vector addition 356 vector field 501 vector space 355 velocity vector 586 739 vibrating string equation 454, 518 Viete 350 volume 631, 693, 705 von Neumann 522 Weierstrass approximation theorem 184, 296 , 297, 301 , 305 , 543 Weierstrass xiv, 25, 403, 407 weight function 206 weighted average 298 weighted integral 206 well-ordering 21 Whitehead 25 Zermelo 25 zero 131 zoom 153 zeros of finite order 191","libVersion":"0.3.1","langs":""}
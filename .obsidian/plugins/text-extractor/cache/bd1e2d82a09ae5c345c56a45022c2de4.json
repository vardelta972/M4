{"path":"iCloudDrive/bks/OlympiadQPs/USAMO PYQ/2018.pdf","text":"USAMO 2018 Solution Notes Evan Chen《陳誼廷》 10 August 2023 This is a compilation of solutions for the 2018 USAMO. Some of the solutions are my own work, but many are from the official solutions provided by the organizers (for which they hold any copyrights), and others were found by users on the Art of Problem Solving forums. These notes will tend to be a bit more advanced and terse than the “official” solutions from the organizers. In particular, if a theorem or technique is not known to beginners but is still considered “standard”, then I often prefer to use this theory anyways, rather than try to work around or conceal it. For example, in geometry problems I typically use directed angles without further comment, rather than awkwardly work around configuration issues. Similarly, sentences like “let R denote the set of real numbers” are typically omitted entirely. Corrections and comments are welcome! Contents 0 Problems 2 1 Solutions to Day 1 3 1.1 USAMO 2018/1, proposed by Titu Andreescu . . . . . . . . . . . . . . . . 3 1.2 USAMO 2018/2, proposed by Titu Andreescu, Nikolai Nikolov . . . . . . 4 1.3 USAMO 2018/3, proposed by Ivan Borsenco . . . . . . . . . . . . . . . . . 6 2 Solutions to Day 2 9 2.1 USAMO 2018/4, proposed by Ankan Bhattacharya . . . . . . . . . . . . . 9 2.2 USAMO 2018/5, proposed by Kada Williams . . . . . . . . . . . . . . . . 10 2.3 USAMO 2018/6, proposed by Richard Stong . . . . . . . . . . . . . . . . 13 1 USAMO 2018 Solution Notes web.evanchen.cc, updated 10 August 2023 §0 Problems 1. Let a, b, c be positive real numbers such that a + b + c = 4 3√abc. Prove that 2(ab + bc + ca) + 4 min(a2, b2, c2) ≥ a2 + b 2 + c 2. 2. Find all functions f : (0, ∞) → (0, ∞) such that f ( x + 1 y ) + f (y + 1 z ) + f ( z + 1 x ) = 1 for all x, y, z > 0 with xyz = 1. 3. Let n ≥ 2 be an integer, and let {a1, . . . , am} denote the m = ϕ(n) integers less than n and relatively prime to n. Assume that every prime divisor of m also divides n. Prove that m divides ak 1 + · · · + ak m for every positive integer k. 4. Let p be a prime, and let a1, . . . , ap be integers. Show that there exists an integer k such that the numbers a1 + k, a2 + 2k, . . . , ap + pk produce at least 1 2 p distinct remainders upon division by p. 5. Let ABCD be a convex cyclic quadrilateral with E = AC ∩ BD, F = AB ∩ CD, G = DA ∩ BC. The circumcircle of △ABE intersects line CB at B and P , and the circumcircle of △ADE intersects line CD at D and Q. Assume C, B, P , G and C, Q, D, F are collinear in that order. Let M = F P ∩ GQ. Prove that ∠M AC = 90◦. 6. Let an be the number of permutations (x1, . . . , xn) of (1, . . . , n) such that the ratios xk/k are all distinct. Prove that an is odd for all n ≥ 1. 2 USAMO 2018 Solution Notes web.evanchen.cc, updated 10 August 2023 §1 Solutions to Day 1 §1.1 USAMO 2018/1, proposed by Titu Andreescu Available online at https://aops.com/community/p10226140. Problem statement Let a, b, c be positive real numbers such that a + b + c = 4 3√abc. Prove that 2(ab + bc + ca) + 4 min(a 2, b2, c2) ≥ a 2 + b 2 + c 2. WLOG let c = min(a, b, c) = 1 by scaling. The given inequality becomes equivalent to 4ab + 2a + 2b + 3 ≥ (a + b)2 ∀a + b = 4(ab) 1/3 − 1. Now, let t = (ab)1/3 and eliminate a + b using the condition, to get 4t3 + 2(4t − 1) + 3 ≥ (4t − 1) 2 ⇐⇒ 0 ≤ 4t3 − 16t2 + 16t = 4t(t − 2) 2 which solves the problem. Equality occurs only if t = 2, meaning ab = 8 and a + b = 7, which gives {a, b} = { 7 ± √17 2 } with the assumption c = 1. Scaling gives the curve of equality cases. 3 USAMO 2018 Solution Notes web.evanchen.cc, updated 10 August 2023 §1.2 USAMO 2018/2, proposed by Titu Andreescu, Nikolai Nikolov Available online at https://aops.com/community/p10226145. Problem statement Find all functions f : (0, ∞) → (0, ∞) such that f ( x + 1 y ) + f ( y + 1 z ) + f ( z + 1 x ) = 1 for all x, y, z > 0 with xyz = 1. The main part of the problem is to show all solutions are linear. As always, let x = b/c, y = c/a, z = a/b (classical inequality trick). Then the problem becomes ∑ cyc f ( b + c a ) = 1. Let f (t) = g( 1 t+1 ), equivalently g(s) = f (1/s − 1). Thus g : (0, 1) → (0, 1) which satisfies ∑cyc g ( a a+b+c ) = 1, or equivalently g(a) + g(b) + g(c) = 1 ∀a + b + c = 1. The rest of the solution is dedicated to solving this equivalent functional equation in g. It is a lot of technical details and I will only outline them (with apologies to the contestants who didn’t have that luxury). Claim — The function g is linear. Proof. This takes several steps, all of which are technical. We begin by proving g is linear over [1/8, 3/8]. • First, whenever a + b ≤ 1 we have 1 − g(1 − (a + b)) = g(a) + g(b) = 2g ( a + b 2 ) . Hence g obeys Jensen’s functional equation over (0, 1/2). • Define h : [0, 1] → R by h(t) = g( 2t+1 8 ) − (1 − t) · g(1/8) − t · g(3/8), then h satisfies Jensen’s functional equation too over [0, 1]. We have also arranged that h(0) = h(1) = 0, hence h(1/2) = 0 as well. • Since h(t) = h(t) + h(1/2) = 2h(t/2 + 1/4) = h(t + 1/2) + h(0) = h(t + 1/2) for any t < 1/2, we find h is periodic modulo 1/2. It follows one can extend ̃h by ̃h : R → R by ̃h(t) = h(t − ⌊t⌋) and still satisfy Jensen’s functional equation. Because ̃h(0) = 0, it’s well-known this implies ̃h is additive (because ̃h(x + y) = 2̃h ((x + y)/2) = ̃h(x) + ̃h(y) for any real numbers x to y). 4 USAMO 2018 Solution Notes web.evanchen.cc, updated 10 August 2023 But ̃h is bounded below on [0, 1] since g ≥ 0, and since ̃h is also additive, it follows (well-known) that ̃h is linear. Thus h is the zero function. So, the function g is linear over [1/8, 3/8]; thus we may write g(x) = kx + ℓ, valid for 1/8 ≤ x ≤ 3/8. Since 3g(1/3) = 1, it follows k + 3ℓ = 1. For 0 < x < 1/8 we have g(x) = 2g(0.15)−g(0.3−x) = 2(0.15k +ℓ)−(k(0.3−x)+ℓ) = kx + ℓ, so g is linear over (0, 3/8) as well. Finally, for 3/8 < x < 1, we use the given equation 1 = g ( 1 − x 2 ) + g ( 1 − x 2 ) + g(x) =⇒ g(x) = 1 − 2 ( k · 1 − x 2 + ℓ ) = kx + ℓ since 1−x 2 < 5 16 < 3 8 . Thus g is linear over all. Putting this back in, we deduce that g(x) = kx + 1−k 3 for some k ∈ [−1/2, 1], and so f (x) = k x + 1 + 1 − k 3 for some k ∈ [−1/2, 1]. All such functions work. 5 USAMO 2018 Solution Notes web.evanchen.cc, updated 10 August 2023 §1.3 USAMO 2018/3, proposed by Ivan Borsenco Available online at https://aops.com/community/p10226222. Problem statement Let n ≥ 2 be an integer, and let {a1, . . . , am} denote the m = ϕ(n) integers less than n and relatively prime to n. Assume that every prime divisor of m also divides n. Prove that m divides ak 1 + · · · + ak m for every positive integer k. For brevity, given any n, we let A(n) = {1 ≤ x ≤ n, gcd(x, n) = 1} (thus |A(n)| = ϕ(n)). Also, let S(n, k) = ∑ a∈A(n) ak. We will prove the stronger statement (which eliminates the hypothesis on n). Claim — Let n ≥ 2 be arbitrary (and k ≥ 0). If p | n, then νp(ϕ(n)) ≤ νp(S(n, k)). We start with the special case where n is a prime power. Lemma Let p be prime, e ≥ 1, k ≥ 0. We always have S(pe, k) = ∑ x∈A(pe) xk ≡ 0 (mod p e−1). Proof. For p odd, this follows by taking a primitive root g modulo pe. We will have S(pe, k) ≡ 1 + gk + g2k + · · · + g(ϕ(pe)−1)k ≡ gϕ(pe)k − 1 gk − 1 . If p − 1 ∤ k, then the denominator is not divisible by p and hence the entire expression is 0 (mod pe). In the other case where p − 1 | k, since νp(ϕ(pe)) = e − 1, the exponent lifting lemma implies νp ((gk) ϕ(pe) − 1) = νp(gk − 1) + (e − 1) and so the conclusion is true here too. In the annoying case p = 2, the proof is broken into two cases: for k odd it follows by pairing x with 2e − x and when k is even one can take 5 as a generator of all the quadratic residues as in the p > 2 case. Corollary We have νp(1k + · · · + tk) ≥ νp(t) − 1 for any k, t, p. Proof. Assume p | t. Handle the terms in that sum divisible by p (by induction) and apply the lemma a bunch of times. 6 USAMO 2018 Solution Notes web.evanchen.cc, updated 10 August 2023 Now the idea is to add primes q one at a time to n, starting from the base case n = pe. So, formally we proceed by induction on the number of prime divisors of n. We’ll also assume k ≥ 1 in what follows since the base case k = 0 is easy. • First, suppose we want to go from n to nq where q ∤ n. In that case ϕ(nq) gained νp(q − 1) factors of p and then we need to show νp(S(nq, k)) ≥ νp(ϕ(n)) + νp(q − 1). The trick is to write A(nq) = {a + nh | a ∈ A(n) and h = 0, . . . , q − 1} \\ qA(n) and then expand using binomial theorem: S(nq, k) = ∑ a∈A(n) q−1∑ h=0(a + nh)k − ∑ a∈A(n) (qa)k = −qkS(n, k) + ∑ a∈A(n) q−1∑ h=0 k∑ j=0 [( k j ) ak−jnjh j] = −qkS(n, k) + k∑ j=0   ( k j ) nj   ∑ a∈A(n) ak−j   (q−1∑ h=0 h j)  = −qkS(n, k) + k∑ j=0 [( k j ) njS(n, k − j) (q−1∑ h=1 h j)] = (q − qk)S(n, k) + k∑ j=1 [(k j )njS(n, k − j) (q−1∑ h=1 h j)] . We claim every term here has enough powers of p. For the first term, S(n, k) has at least νp(ϕ(n)) factors of p; and we have the q − qk multiplier out there. For the other terms, we apply induction to S(n, k − j); moreover ∑q−1 h=1 hj has at least νp(q − 1) − 1 factors of p by corollary, and we get one more factor of p (at least) from nj. • On the other hand, if q already divides n, then this time A(nq) = {a + nh | a ∈ A(n) and h = 0, . . . , q − 1} . and we have no additional burden of p to deal with; the same calculation gives S(nq, k) = qS(n, k) + k∑ j=1 [( k j ) njS(n, k − j) (q−1∑ h=1 h j)] . which certainly has enough factors of p already. Remark. A curious bit about the problem is that νp(ϕ(n)) can exceed νp(n), and so it is not true that the residues of A(n) are well-behaved modulo ϕ(n). As an example, let n = 2 · 3 · 7 · 13 = 546, so m = ϕ(n) = 1 · 2 · 6 · 12 = 144. Then A(n) contains 26 elements which are 1 mod 9 and 23 elements which are 4 mod 9. 7 USAMO 2018 Solution Notes web.evanchen.cc, updated 10 August 2023 Remark. The converse of the problem is true too (but asking both parts would make this too long for exam). 8 USAMO 2018 Solution Notes web.evanchen.cc, updated 10 August 2023 §2 Solutions to Day 2 §2.1 USAMO 2018/4, proposed by Ankan Bhattacharya Available online at https://aops.com/community/p10232389. Problem statement Let p be a prime, and let a1, . . . , ap be integers. Show that there exists an integer k such that the numbers a1 + k, a2 + 2k, . . . , ap + pk produce at least 1 2 p distinct remainders upon division by p. For each k = 0, . . . , p − 1 let Gk be the graph on {1, . . . , p} where we join {i, j} if and only if ai + ik ≡ aj + jk (mod p) ⇐⇒ k ≡ − ai − aj i − j (mod p). So we want a graph Gk with at least 1 2 p connected components. However, each {i, j} appears in exactly one graph Gk, so some graph has at most 1 p (p 2) = 1 2 (p − 1) edges (by “pigeonhole”). This graph has at least 1 2 (p + 1) connected components, as desired. Remark. Here is an example for p = 5 showing equality can occur:       0 0 3 4 3 0 1 0 2 2 0 2 2 0 1 0 3 4 3 0 0 4 1 1 4       . Ankan Bhattacharya points out more generally that ai = i 2 is sharp in general. 9 USAMO 2018 Solution Notes web.evanchen.cc, updated 10 August 2023 §2.2 USAMO 2018/5, proposed by Kada Williams Available online at https://aops.com/community/p10232392. Problem statement Let ABCD be a convex cyclic quadrilateral with E = AC ∩ BD, F = AB ∩ CD, G = DA ∩ BC. The circumcircle of △ABE intersects line CB at B and P , and the circumcircle of △ADE intersects line CD at D and Q. Assume C, B, P , G and C, Q, D, F are collinear in that order. Let M = F P ∩ GQ. Prove that ∠M AC = 90◦. We present three general routes. (The second route, using the fact that AC is an angle bisector, has many possible variations.) ¶ First solution (Miquel points) This is indeed a Miquel point problem, but the main idea is to focus on the self-intersecting cyclic quadrilateral P BQD as the key player, rather than on the given ABCD. Indeed, we will prove that A is its Miquel point; this follows from the following two claims. Claim — The self-intersecting quadrilateral P QDB is cyclic. Proof. By power of a point from C: CQ · CD = CA · CE = CB · CP . Claim — Point E lies on line P Q. Proof. ∡AEP = ∡ABP = ∡ABC = ∡ADC = ∡ADQ = ∡AEQ. P B Q D E C H A G F M To finish, let H = P D ∩ BQ. By properties of the Miquel point, we have A is the foot from H to CE. But also, points M , A, H are collinear by Pappus theorem on BP G and DQF , as desired. 10 USAMO 2018 Solution Notes web.evanchen.cc, updated 10 August 2023 ¶ Second solution (projective) We start with a synthetic observation. Claim — The line AC bisects ∠P AD and ∠BAQ. Proof. Angle chase: ∡P AC = ∡P AE = ∡P BE = ∡CBD = ∡CAD. There are three ways to finish from here: • (Michael Kural) Suppose the external bisector of ∠P AD and ∠BAQ meet lines BC and DC at X and Y . Then −1 = (GP ; XC) = (F D; Y C) which is enough to imply that XY , GQ, P F are concurrent (by so-called prism lemma). • (Daniel Liu) Alternatively, apply the dual Desargues involution theorem to complete quadrilateral GQF P CM , through the point A. This gives that an involutive pairing of (AC, AM ) (AP, AQ) (AG, AF ). This is easier to see if we project it onto the line ℓ through C perpendicular to AC; if we let P ′, Q′, G′, F ′ be the images of the last four lines, we find the involution coincides with negative inversion through C with power √CP ′ · CQ′ which implies that AM ∩ ℓ is an infinity point, as desired. • (Kada Williams) The official solution instead shows the external angle bisector by a long trig calculation. ¶ Third solution (inversion, Andrew Wu) Noting that CE · CA = CP · CB = CQ · CD, we perform an inversion at C swapping these pairs of points. The point G is mapped to a point G∗ ray CB for which QEG∗C is cyclic, but then ∡CG∗E = ∡CQE = ∡CQP = ∡DBC = ∡CBE and so we conclude EB = EG∗. Similarly, ED = EF ∗. Finally, M ∗ = (CG∗D) ∩ (CF ∗B) ̸= C, and we wish to show that ∠EM ∗C = 90◦. D B C E K L G∗ F ∗ M ∗ 11 USAMO 2018 Solution Notes web.evanchen.cc, updated 10 August 2023 Note that M ∗ is the center of the spiral similarity sending BG∗ to F ∗D. Hence it also maps the midpoint K of BG∗ to the midpoint L of F ∗E. Consequently, M ∗ lies on the circumcircle KLC as well. In other words, ELCKM ∗ is a cyclic pentagon with circumdiameter CE, as desired. 12 USAMO 2018 Solution Notes web.evanchen.cc, updated 10 August 2023 §2.3 USAMO 2018/6, proposed by Richard Stong Available online at https://aops.com/community/p10232388. Problem statement Let an be the number of permutations (x1, . . . , xn) of (1, . . . , n) such that the ratios xk/k are all distinct. Prove that an is odd for all n ≥ 1. This is the official solution; the proof has two main insights. The first idea: Lemma If a permutation x works, so does the inverse permutation. Thus it suffices to consider permutations x in which all cycles have length at most 2. Of course, there can be at most one fixed point (since that gives the ratio 1), and hence exactly one if n is odd, none if n is even. We consider the graph Kn such that the edge {i, j} is labeled with i/j (for i < j). The permutations we’re considering are then equivalent to maximal matchings of this Kn. We call such a matching fantastic if it has an all of distinct edge labels. Now the second insight is that if edges ab and cd have the same label for a < b and c < d, then so do edges ac and bd. Thus: Definition. Given a matching M as above we say the neighbors of M are those other matchings obtained as follows: for each label ℓ, we take some disjoint pairs of edges (possibly none) with label ℓ and apply the above switching operation (in which we replace ab and cd with ac and bd). This neighborship relation is reflexive, and most importantly it is symmetric (because one can simply reverse the moves). But it is not transitive. The second observation is that: Claim — The matching M has an odd number of neighbors (including itself) if and only if it is fantastic. Proof. Consider the label ℓ, and assume it appears nℓ ≥ 1 times. If we pick k disjoint pairs and swap them, the number of ways to do this is (nℓ 2k)(2k −1)!!, and so the total number of ways to perform operations on the edges labeled ℓ is ∑ k (nℓ 2k ) (2k − 1)!! ≡ ∑ k (nℓ 2k ) = 2nℓ−1 (mod 2). This is even if and only if nℓ > 1. Finally, note that the number of neighbors of M is the product across all ℓ of the above. So it is odd if and only if each factor is odd, if and only if nℓ = 1 for every ℓ. To finish, consider a huge simple graph Γ on all the maximal matchings, with edge relations given by neighbor relation (we don’t consider vertices to be connected to themselves). Observe that: 13 USAMO 2018 Solution Notes web.evanchen.cc, updated 10 August 2023 • Fantastic matchings correspond to isolated vertices (of degree zero, with no other neighbors) of Γ. • The rest of the vertices of Γ have odd degrees (one less than the neighbor count) • The graph Γ has an even number of vertices of odd degree (this is true for any simple graph, see “handshake lemma”). • The number of vertices of Γ is odd, namely (2 ⌈n/2⌉ − 1)!!. This concludes the proof. 14","libVersion":"0.3.1","langs":""}
{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Order and Primitive Roots - X - Canada 2010.pdf","text":"2010 IMO Summer Training: Number Theory 1 Week 1: Number Theory - Euler Phi Function, Order and Primitive Roots 1 Greatest Common Divisor and the Euler Phi Func- tion Consider the following problem. Exercise 1.1 Let n be a positive integer and d a positive integer such that d divides n. Amongst the fractions 1 n, 2 n, · · · , 1 n written in lowest terms, how many of these fractions have denominator d? Your ﬁrst thought should deﬁnitely be that this problem is related to the notion of greatest common divisor. A fraction a n has denominator d for some a ∈ {1, · · · , n} if and only if the numerator and denominator are divided by n d to reduce the fraction to lowest terms. Hence, gcd(a/(n/d), d) = 1, or equivalently, gcd(a, n) = n d . Therefore, the number of such fractions with denominator d is equal to the num- ber of positive integers a ∈ {1, · · · , n} such that gcd(a, n) = n d , or equivalently, gcd(a/(n/d), d) = 1. For each positive integer n, let ϕ(n) denote the number of positive integers that is at most n and relatively prime to n. Example 1.2 ϕ(12) = 4, since {1, 5, 7, 11} are the only positive integers from 1 to 12 that are relatively prime to 12 and there are four such numbers. Let’s return to Exercise ??. Let Sd be the set of the fractions in Exercise ?? with denominator d. Try the following exercise. Exercise 1.3 Prove that |Sd| = ϕ ( n d ). Based on this exercise, try to prove the following useful result: Theorem 1.4 For any positive integer n, prove that ∑ d|n ϕ(d) = n. 1 2010 IMO Summer Training: Number Theory 2 This is an awesome result that can come in extremely handy. It is well known enough that you can state it without proof on a competition. But just in case, do know the proof of this result. Now, try the following exercises. 1. Let n ≥ 3 be a positive integer. n lilypads are placed in a circle, with one lilypad marked start. There are n frogs, labeled 1, · · · , n, such that frog k in one leap jumps k lilypads in the clockwise direction. For each k ∈ {1, · · · , n}, if frog k is at start, how many (positive number of ) leaps does the frog make to return to start for the ﬁrst time? 2. (University of Waterloo Big E Competition 1998) Let x be a positive real number such that |x| < 1. Prove that ∑ a,b≥0,a+b≥1,gcd(a,b)=1 xa+b 1 − xa+b = x (1 − x)2 . 2 What Is Your Order Your Majesty? We recall two important theorems in number theory. Theorem 2.1 Euler’s Theorem: Let n be a positive integer and a be a positive integer such that gcd(a, n) = 1. Then aϕ(n) ≡ 1 (mod n). Of course, Euler’s Theorem has a famous child. Theorem 2.2 Fermat’s Little Theorem: Let p be a prime number and a a positive integer not divisible by p. Then ap−1 ≡ 1 (mod p). Euler’s theorem tells you that the sequence a0, a, a2, a 3, · · · (mod n) does eventually reach 1, is periodic, and reaches 1 at aϕ(n). Of course, this may not be the ﬁrst time that the sequence a, a 2, a 3 · · · (mod n) reaches 1. It is possible that the sequence reaches 1 well before aϕ(n). But when? Good question. One thing for certain is that there is some smallest positive integer m such that am ≡ 1 (mod n). hmmm.. Maybe we should give m a name. Deﬁnition 2.3 Let n, a be positive integers such that gcd(a, n) = 1. The smallest positive integer m such that am ≡ 1 (mod n) is called the order of a modulo n. This is denoted by ordn(a). 2 2010 IMO Summer Training: Number Theory 3 1 = a^0 = a^m a^1 a^2 a^{m−1} a^{m−2} Figure 1: Demonstrating Order Example 2.4 1. ord15(2) = 4, since 2 4 ≡ 1 (mod 15) and 2, 2 2, 2 3 ̸≡ 1 (mod 15), i.e. we need to reach the fourth term in the sequence 2, 2 2, 2 3, · · · before we reach one that is congruent to 1 modulo 15. 2. ord7(3) = 6, since 3 6 ≡ 1 (mod 7) and 3, 3 2, 3 3, 3 4, 3 5 ̸≡ 1 (mod 15). Let m = ordn(a). It is important to note that a0, a 1, a 2, · · · , a m−1 are all distinct modulo n. Suppose ai ≡ aj (mod n) for i, j ∈ {0, · · · , m − 1}. Suppose i ≥ j. Then ai−j ≡ 1 (mod n). Note that the only term in a0, a 1, · · · , a m−1 that is congruent to 1 modulo n is 2 0. Since 0 ≤ i − j ≤ m − 1, i − j = 0. Therefore, i = j. Therefore, a0, a 1, · · · , a m−1 are all distinct modulo n . Since am ≡ 1 (mod n), the sequence a0, a 1, · · · (mod n) is periodic with period m. Think of this sequence as a cycle; See Figure ??. No element except for a0 = am is equal to 1. Therefore, no other element in the cycle is equal to 1. How does this help us? If ak ≡ 1 (mod n) for some positive integer k, then k is divisible by m = ordn(a). Wow, this fact is awesome. Better show how awesome it is by putting it as a theorem. Theorem 2.5 Let a, n be positive integers such that gcd(a, n) = 1. Suppose ak ≡ 1 (mod n) for some non-negative integer k. Then ordn(a) divides k 3 2010 IMO Summer Training: Number Theory 4 But wait, we already know that aϕ(n) ≡ 1 (mod n). Nice! What does this mean? Corollary 2.6 Using the notation of Theorem ??, ordn(a) divides ϕ(n). Corollary 2.7 Let p be a prime and a a positive integer not divisible by p. Then ordp(a) divides p − 1. New to the notion of order? Do the following exercises. Exercises 1. Let a, n, d be positive integers such that gcd(a, n) = 1. Let m = ordn(a). Express ordn(ad) in terms of m and d. (Hint: Think about the frogs problem from the previous section and the cyclic nature of a0, a 1, a 2, · · · (mod n). 2. Let a, n be positive integers. Prove that ϕ(an − 1) is divisible by n. (Hint: There is a short solution to this problem.) 3. Let p be a prime which is not 2 or 5 and 0 < n < p be a positive integer. Let d = ordn(p). Prove that the decimal representation of n p is periodic with period d. 4. Find all positive integers n such that n | 2 n − 1. (Hint: If n > 1, consider the smallest prime factor p of n.) 5. Let p be a prime number. Prove that pp − 1 contains a prime factor congruent to 1 modulo q. 6. If 3 ≤ d ≤ 2 n+1, then d ∤ (a2n + 1 for all positive integers a. 4 2010 IMO Summer Training: Number Theory 5 3 Primitive Roots Let’s look back at the beautiful ﬁgure in Figure ??. Wow, what a wonderful piece of art. Well, most of the time it is. But what does the ﬁgure look like if a = 1. Wow, what a boring ﬁgure. A single dot. Let’s consider another example. Suppose a = 2 and n = 7. So we have 1, 2, 2 2, 2 3 ≡ 1 (mod 7). So the cycle contains the numbers 1, 2, 4 (mod 7). The picture is kind of pretty. It contains three numbers. A cycle of three numbers is nice. But you know what would make a super beautiful picture? If the cycle contains everything modulo 7. Well, except 0. Since gcd(a, n) = 1, 0 can never appear. But what if we want {1, 2, 3, 4, 5, 6} to all appear? Can we? Pick another a. Say, a = 3. Let’s calculate 1, 3, 3 2 = 2, 3 3 = 6, 3 4 = 4, 3 5 = 5. And of course 36 is back at the beginning of the cycle. Yes, we can make the cycle contain everything modulo 7. Sweet! So you may be thinking that seven is just a lucky number. Surely you cannot do this with all prime numbers. Well, I’m telling you that you can. If you believe me, read on. If you don’t believe me, well, keep reading on. I will prove it to you. Let’s formalize what we are trying to prove. For a prime number p, we want to ﬁnd g ∈ {1, · · · , p − 1} such that {1, 2, · · · , p − 1} = {1, g, g2, · · · , gp−2} (mod p). Equivalently, ordp(g) = p − 1. Can you see why these two properties of g are equivalent? (Think about the cycle picture again.) Such an element g is called a primitive root modulo p. Does g always exist? The answer is yes! Theorem 3.1 Let p be a prime number. Then there exists g ∈ {1, · · · p − 1} such that g is a primitive root modulo p. Proof: Since ap−1 ≡ 1 (mod p), ordp(a) is a divisor of p − 1 for each a ∈ {1, · · · , p − 1}. For each d|p−1, let Sd be the subset of {1, · · · , p−1} with order d. We claim that |Sd| ≤ ϕ(d). If |Sd| = 0, then clearly our claim holds. Otherwise, let a ∈ Sd. Consider {1, a, · · · , a d−1}. Every element in this set are roots of the polynomial xd − 1 (mod p). Such a polynomial 5 2010 IMO Summer Training: Number Theory 6 contains at most d roots. Therefore, {1, a, · · · , a d−1} is the complete set of roots of this polynomial. Furthermore, all elements of order d are in this list, namely ak, where k ∈ {1, · · · , d − 1} and gcd(k, d) = 1. Hence, |Sd| = ϕ(d). Therefore, p − 1 = ∑ d|p−1 ϕ(d) ≥ ∑ d|p−1 |Sd| = p − 1. Hence, equality must hold throughout. Speciﬁcally, |Sp−1| = ϕ(p − 1) > 0. □ Wow, this is great. Not only did we prove that primitive roots modulo p exist, but also that there are ϕ(p − 1) of them. So how do we ﬁnd a primitive root modulo p? There is no clean way to do it. In practice, 2 or 3 usually is a primitive root. For now, we will just call it g. We don’t know what g is. But g exists. And that’s more than enough to make us happy. After all, we have ϕ(p − 1) beautiful cycles. Example 3.2 Prove that 2 is a primitive root modulo 101. Solution: So we calculate 2, 2 2, 2 3, · · · , 2 99 to see that none of them are 1 (mod 101). Or, we can be clever. It suﬃces to show that 2 20 and 2 50 are not 1 (mod 101). (Why? – I’ll let you ﬁgure this one out.) Now, you do know the trick to calculate 2 m (mod n) reasonably quickly? Just calculate 2, 2 2, 2 4, 2 8, · · · (mod 101). (Each term is just the square of the previous term, so this isn’t too cumbersome.) I will leave this as an exercise for you. Okay. Let’s use primitive roots to actually solve an olympiad style problem. Exercise 3.3 Let p ≥ 5 be a prime and 1 ≤ n < p − 1 a positive integer. Prove that 1 n + 2n + · · · + (p − 1) n is divisible by p. Solution: So we take the general formula for 1 n + 2 n + · · · + (p − 1) n and .... wait, what is that formula again? Oh right. It’s ugly and complicated. We need something else. We’re trying to prove that 1n + 2n + · · · + (p − 1) n ≡ 0 (mod p). If only we have an alternate way of representing {1, 2, · · · , p − 1} (mod p). If only. 6 2010 IMO Summer Training: Number Theory 7 Oh wait we do! Let g be a primitive root modulo p. Then {1, 2, · · · , p−1} = {1, g, · · · , gp−2}. Then (1 n + 2n + · · · + (p − 1) n) ≡ (1 + gn + g2n + · · · + g(p−2)n (mod p). Oh nice. A geometric sequence. We know how to sum this. Life is good again. (1 + gn + g2n + · · · + g(p−2)n = 1 − g(p−1)n 1 − gn . By Fermat’s Little Theorem, the numerator of this expression is divisible by p. Since n < p−1 and g is a primitive root, the numerator is not divisible by p. Hence, we are not dividing by zero. This solves the exercise. □ Exercises: 1. Let p be an odd prime and g a primitive root modulo p. Prove that g p−1 2 ≡ −1 (mod p). 2. Let p be a prime such that p ≡ 3 (mod 4). Prove that p−1∏ j=1(j2 + 1) ≡ 4 (mod p). 3. (Putnam 1994) For each non-negative integer m, let nm = 101m−100·2 m. Let a, b, c, d be integers such that 0 ≤ a, b, c, d ≤ 99 such that na + nb ≡ nc + nd (mod 10100). Prove that {a, b} = {c, d}. 4. (IMO 1984 Variant) Find all pairs of positive integers (a, b) such that ab(a + b) is not divisible by 7, but (a + b) 7 − a7 − b7 is divisible by 7 7. 7","libVersion":"0.3.1","langs":""}
{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Kimball Martin/NT 2 (To the skies)/Notes (Individual sections)/chap2.pdf","text":"2 Primes in extensions This chapter is about the following basic question: given an extension of number ﬁelds L/K and a prime ideal p in OK, how does pOL factor into prime ideals of OL? This question is intimately tied up with many questions of arithmetic. Going back to our motivating question of which primes p are of the form p = x2 + ny2 (n ￿=1 squarefree), we will see that these are essentialy the p for which (p) is a product of two principal ideals in Q( √−n). After addressing this general question about splitting of prime ideals, we will apply this to primes of the form x2 + ny2. Afterwards, we may do some more stuﬀ, but then again maybe we won’t. Note: we will sometimes talk about “ideals” of K or L, or “primes” of K or L. This is merely a simpliﬁcation of terminology and simply means (ordinary) ideals of OK or OL, or prime ideals of OK or OL. Another piece of notation to be careful of: if α ∈ OK, then (α) may represent αOK or αOL depending upon whether we are talking about ideals of K or ideals of L. This should hopefully be clear from context in most cases. If not, we will explicitly write αOK or αOL. The presentation of this material in this chapter is, for the most part, based on [Marcus] and, to a lesser extent, [Cohn] (for the quadratic case) and [Neukirch]. 2.1 Splitting of primes Throughout L/K denotes an extension of number ﬁelds. Before we give the basic deﬁnitions, let’s recall what happens in the simplest example, which we studied last semester. Example 2.1.1. Let K = Q and L = Q(i).Since OK = Z is a PID, any prime ideal of OK is of the form (p) where p is a prime of Z.If p = x2 + y2 = NL/K(x + yi),then p = αβ for some α, β ∈ OL and (p)=(α)(β) in OL,i.e., (p) is a product of two principal ideals in OL.Furthermore p1 =(α) and p2 =(β) are both prime since they have norm p.The ideals p1 and p2 are distinct except in the case p =2= (1 + i)(1 − i) since 1+ i = −i(1 − i),i.e., 1+ i and 1 − i diﬀer by units. If p is not a sum of two squares, then this means there is no element of norm p in OL,so p is irreducible in OL.Hence if some prime ideal p of OL divides (p) but p ￿=(p),then it can’t be principal (otherwise, the generator of p would divide p). However hL =1 so OL is a PID. Thus (p)= pOL = {pα : α ∈ OL} is itself a prime ideal. Hence in this example, there are 3 possibilities for what happens to a prime ideal pOK of K in the extension L: (1) it splits as a product of two distinct prime ideals (p)= p1p2 in OL iﬀ ±p = x2 + y2 and p ￿=2,i.e.,iﬀ p ≡ 1 mod 4; (2) it ramiﬁes as the square of a prime ideal (p)=2OL =(1 + i)2 = p2 in OL iﬀ ±p =2;and (3) it remains prime or is inert,i.e., pOL is a prime ideal of OL,if and only if ±p ￿= x2 + y2, i.e., iﬀ p ≡ 3 mod 4. If a is an ideal of OK, we deﬁne aOL = {a1x1 + a2x2 + ·· · + akxk : ai ∈ a,xi ∈ OL} . Notice this is just like the deﬁnition of the product of two ideals of the same ring. It is easy to see that this is the smallest ideal of OL which contains the set a (see exercise below). Note if a =(a) is a principal ideal of OK, then aOL =(a)= {ax : x ∈ OL}. 27 Exercise 2.1. Let a be an ideal of OK and A be an ideal of OL.Show aOL is an ideal of OL and A ∩ K = A ∩ OK (justify this equality) is an ideal of OK.We call aOL the extension of a to L and A ∩ OK the restriction of A to K. It is tradition to use gothic lower case letters for ideals of OK and upper case gothic letters for ideals of OL. (Though I suppose it’s also tradition to write OK as OK, I’m not as fond of that one.) However if K = Q, we just use integers for the ideals of OK = Z since they are all principal, and lower case gothic letters for ideals of the extension L, as in the example above. If you have trouble writing gothic letters by hand, you can just write the corresponding roman letter with an underscore, or use another script. While the extension and restriction of ideals are deﬁned uniquely, this is not a 1-to-1 correspon- dence, as there are more ideals of OL than ideals of OK. Precisely, we will see that diﬀerent ideals of OK extend to diﬀerent ideals of OL, but diﬀerent ideals of OL can restrict to the same ideal of OK. Deﬁnition 2.1.2. Let p be a prime ideal of OK and P be a prime ideal of OL.We say P lies over (or lies above) p in L/K if P|pOL.We sometimes write this as P|p. Going back to the previous example, in case (1) p1 and p2 lie above (p); in case (2) p lies above (p) and in case (3) (p)= pOL lies above (p)= pOK. Let p be a prime (ideal) of OK and P be a prime (ideal) of OL. Lemma 2.1.3. The following are equivalent: (a) P|p,i.e., P|pOL (b) P ⊇ p (c) P ∩ OK = P ∩ K = p. Proof. (a) ⇒ (b) since P ⊇ pOL ⊇ p. To see (b) ⇒ (c), observe that P ⊇ p implies P ∩ OK ⊇ p. Since p is maximal, and P ∩ OK is an ideal by the exercise above, we have P ∩ OK is either p or OK. The latter is impossible since it would imply 1 ∈ P. To see (c) ⇒ (b) ⇒ (a), note that (c) implies P ⊇ p is obvious, and then P ⊇ pOL since P is an ideal of OL. In light of the equivalence (a) ⇐⇒ (b), the notation P|p for one ideal lying over another agrees with the usage of the notation I|J to mean divides (contains) for ideals of OK. Another thing this lemma shows is that two diﬀerent ideals of L can restrict to the same ideal of K. For example if p is a prime of K = Q,and pOL = p1p2 with p1 ￿= p2, then p1 and p2 both restrict to the ideal pZ of Z. More generally, all primes P of OL lying above a prime p of OK restrict to p. Proposition 2.1.4. Every prime P of OL lies above a unique prime p of K.Conversely, every prime p of K is contained in some prime P of OL,i.e.,there is some prime P of OL such that P|p. Proof. Suppose P ∩ OK|ab for some ideals a, b of OK. Then P ⊇ (aOL)(bOL) so P ⊃ aOL or P ⊃ bOL since P is prime. Restricting to K, we see P ∩ OK|a or P ∩ OK|b. Hence P ∩ OK is a prime ideal p of OK by deﬁnition, i.e., P|p. By the previous lemma, P|p implies P ∩ OK = p, hence 28 p is unique. This proves the ﬁrst statement, though technically one should also show P ∩ OK ￿= {0}. This is easy—see the exercise below. The second statement is seemingly obvious: given p, the extension pOL has a prime ideal factorization in OL, so any prime ideal P occurring in the factorization lies above p. However as before, one needs to show a seemingly obvious technicality: pOL ￿= OL (otherwise pOL would not have a prime ideal factorization). This is also an exercise. Exercise 2.2. Let L/K be an extension of number ﬁelds and I be a (nonzero) ideal of OL.Show I ∩ OK ￿= {0}.(You may want to consider using norms.) Exercise 2.3. (a) Let a be a proper ideal of OK.Show there exists a γ ∈ K − OK such that γa ⊆ OK. (b) Let L/K be an extension of number ﬁelds and p aprime idealof OK.Show pOL ￿= OL. (Use (a) to get a contradiction if pOL = OL.) Exercise 2.4. (a) Let a, b be ideals of K.Show aOL|bOL =⇒ a|b.(Think about prime factoriza- tions in K and L.) (b) Show aOL ∩ OK = a for any ideal a of OK,i.e., the restriction of an extension gives the ideal you started with. (Use (a) with b = aOL ∩ OK.) (c) Determine which ideals A of L satisfy (A ∩ OK)OL = A,i.e., determine when the extension of the restriction of an ideal is the ideal you started with. Looking back at the case of K = Q and L = Q(i) from Example 2.1.1, we see sometimes the number of primes lying above p is 1 and sometimes it is 2. In general, the number of primes above p is never greater than n =[L : K], and if we count with primes with “multiplicty” and “weight” it will always be n. Multiplicity is easy to imagine: if [L : K]=2 and p = P2 then it makes sense to count P two times—technically this multiplicity is called the ramiﬁcation index (or ramiﬁcation degree). There is only one prime that is ramiﬁed in the extension Q(i)/Q, namely 2Z[i]= (1 + i)2. The notion of some primes being “weighted” is a little more subtle, but it can obviously happen that p = P, i.e., a prime p of K remains prime (or is inert)in L, i.e., pOL = P is prime in L. If we go back to Example 2.1.1, half of the primes in Q are inert in Q(i), the ones ≡ 3 mod 4, i.e., the primes not sums of 2 squares. One way to diﬀerentiate the case of inert and “split” primes in this example is the following. For split primes (p ≡ 1 mod 4),we have pOL = pOL = P1P2, then [OL : Pi]= N (Pi)= p (this also holds for the ramiﬁed case of p =2), but for inert primes (p ≡ 1 mod 3), then P = pOL = pOL is prime in L and we have [OL : P]= N (P)= NL/K(p)= p2. Hence, if we think of the exponent of p in N (P)= [OL : P] as the “weight” of P, then we can say the weighted sum of the primes above p (with multiplicity) is always 2, at least in Example 2.1.1. In general, when the base ﬁeld K ￿= Q, this deﬁnition of weight needs to be appropriately modiﬁed, and we give the formal deﬁnitions of the appropriate multiplicity (ramiﬁcation index) and weight (inertial degree) below. Exercise 2.5. Suppose P ∩ OK = p.Show the ring embedding OK ￿→ OL yields a ﬁeld embedding OK/p ￿→ OL/P. In other words, the ﬁnite ﬁeld OL/P is an extension of OK/p. Deﬁnition 2.1.5. Let p be a prime of K.Suppose the prime ideal factorization of pOL is p = ￿ P ei i where each Pi is distinct. The ramiﬁcation index of Pi over p is e(Pi|p)= ei and the inertial degree of Pi over p is f (Pi|p)= fi =[OL/Pi : OK/p]. 29 This deﬁnition of inertial degree is really the natural generalization of the “weight” of P we suggested in the case of Q(i)/Q (see also lemma below). The previous exercise guarantees it makes sense. For instance, if K = Q, then and P = pOL is prime in L, then f (P|(p)) = [OL/pOL : Z/pZ]. Now OL/pOL must be the ﬁnite ﬁeld of order N (pOL)= NL/Q(p)= pn where n =[L : K], which has degree n over Z/pZ, so the inertial degree is f (P|(p)) = n. The above deﬁnition of inertial degree, is the standard one, but it is clearly equivalent to the following form, which will be useful to us. Lemma 2.1.6. The inertial degree fi = f (Pi|p) satisﬁes N (Pi)= N (p)fi. Proof. We know OK/p is a ﬁnite ﬁeld of some order, say q = N (p). By the exercise above OL/P is an extension of OK/p, and the order of this extension ﬁeld is qfi = N (Pi) by the deﬁnition of the inertial degree. Hence N (p)fi = N (P). Theorem 2.1.7. (The fundamental identity) With the notation in the deﬁnition, ￿ eifi = n =[L : K]. For simplicity, we will omit some details of the proof when K ￿= Q. Proof. Note N (pOL)= ￿ N (Pi) ei = ￿ N (p) eifi, by the previous lemma. Then the theorem follows from the statement that N (pOL)= N (p)n. This is true but not entirely obvious—one must check some details. However in our main case of interest, which is K = Q, it is particularly simple, and in the interest of time and simplicity we will restrict to when K = Q. Then p =(p) for some p ∈ N and N (pOL)= N (pOL)= NL/K(p)= pn. Hence if pOL = ￿ P ei i (with each Pi distinct), the number of Pi lying above p is at most n =[L : K], and is exactly n if we count multiplicities ei’s and “weights” fi’s. Now let’s give a couple names for diﬀerent ways in which p (i.e., pOL) can factor in OL. Deﬁnition 2.1.8. Write pOL = ￿g i=1 P ei i (with each Pi distinct). If ei > 1 for some i,we say p ramiﬁes in L.Otherwise, we say p is unramiﬁed in L. If g> 1,i.e. there is more than one prime of L above p,then we say p is split in L.If g =1, i.e. there is only one prime of L above p,wesay p is nonsplit in L. If g = n,i.e. pOL = P1P2 ·· · Pn,then we say p is totally split (or splits completely)in L. If g =1 and e1 =1,i.e. if pOL = P1,then wesay p is inert (or remains prime)in L. Note by the fundamental identity, if p is totally split in L, then ei = fi =1 for each i.Similarly if p is inert in L then f (P|p)= n where P = pOL. In particular if p is totally split or inert in L, then it is unramiﬁed. We will see shortly that ramiﬁcation is a special phenomenon which only happens for ﬁnitely many primes. We now give a couple of simple consequences of the lemma and fundamental identity. Corollary 2.1.9. Let p be a prime ideal of K which lies above a prime p ∈ N.Then N (p)= pk for some 1 ≤ k ≤ [K : Q]. Proof. It follows from the lemma above (or the argument before with the base ﬁeld being Q), that N (p)= pf (p|(p)).We know k = f (p|(p)) ≤ n by the fundamental identity. 30 Knowing this is useful in determining whether an ideal is prime or not, and in determining how aprimeof Q splits in K. A consequence of this (without requiring the bound on k) is the fact that an ideal of K divides (the ideal generated by) its norm. Recall we mentioned this result can be used to prove that the class number of K is ﬁnite (see Lemma 1.6.6. Corollary 2.1.10. Let I be an ideal of K and m = N (I).Then I|mOK. Proof. Write I = ￿ pi where the pi’s are (not necessarily distinct) prime ideals of K. Then m = N (I)= ￿ N (pi). By the previous corollary, we can write N (pi)= pfi i for some fi where pi|pi.In particular pi ⊇ piOK ⊇ pfi i OK. Hence I = ￿ pi ⊇ ￿ pfi i OK = mOK. Now one might ask if all primes of L above p have the same ramiﬁcation index and inertial degree. This is not true in general, but it is true if we pass to the Galois closure of L. Precisely, we have the following. Theorem 2.1.11. Suppose L/K is Galois and write p = P e1 1 ·· · P eg g where the Pi’s are distinct prime ideals of L.Then Gal(L/K) acts transitively on P1,. .., Pg.In particular e1 = e2 = ·· · = eg and f1 = f2 = ·· · = fg.In this case, if we set e = e1 and f = f1,wehave pOL = P e 1P e 2 ·· · P e g and the fundamental identity becomes n = ef g. Proof. Let σ ∈ Gal(L/K) and P|p. Since L/K is Galois, σ(P) ⊆ OL. It follows immediately from the deﬁnitions that σ(P) is an ideal of OL and σ(P) is prime. Note if x ∈ p, then σ(x)= x since x ∈ OL. Thus P ⊇ p implies σ(P) ⊇ p, i.e., σ(P)|p. This implies Gal(L/K) acts on P1,. .., Pg. Now we want to show this action is transitive. Suppose it is not, i.e., suppose P, P￿|p but P￿ ￿= σ(P) for any σ ∈ Gal(L/K). By the Chinese Remainder Theorem (for general rings) there is an x ∈ OL such that x ≡ 0 mod P ￿,x ≡ 1 mod σ(P) for all σ ∈ Gal(L/K). Now y = NL/K(x)= ￿ σ(x) ∈ P￿ ∩ OK = p. On the other hand P ￿ (y)= ￿(σ(x)) since no σ(x) ∈ P. But this means y ￿∈ p = P ∩ OK, a contradiction. This shows Gal(L/K) acts transitively on P1,. .., Pg. On the other hand, Gal(L/K) ﬁxes pOL = P e1 1 P e2 2 ·· · P eg g , so all the ramiﬁcation indices ei are the same by uniqueness of prime ideal factorization. Also, because P1,. .., Pg are Galois conjugates of each other, they all have the same norm. Hence the all the inertial degrees fi are the same. The restatement of the fundamental identity is immediate. When L/K is Galois, we say the ideals σ(P) are conjugates of P. We remark that just like one can deﬁne the norm of elements from L to K, one can deﬁne the norm of ideals from L to K. Precisely, if A is an ideal of L, then the norm from L to K of A is NL/K(A)= ￿ σ∈Gal(L/K) σ(A) ∩ OK. 31 Of course, this norm is an ideal, not a number, but remember that ideals are a sort of generalization of numbers. One can show this satisﬁes various nice properties, and thus it can be useful like the usual norm is useful. Exercise 2.6. Suppose L/K is Galois. (a) Suppose P is a prime of L lying above p,a prime of K.Let f = f (P|p).Show NL/K(P)= pf . (b) Show NL/K(AB)= NL/K(A)NL/K(B) for any ideals A, B of OL. (c) Let A be an ideal of L with norm n = N (A)= |OL/A|.Show NL/Q(A)=(n).In other words, the notion of an “ideal-valued norm” from L to K agrees with the original deﬁnition of the integer-valued norm when K = Q (identifying the principal ideal (n) with the integer n). 2.2 Splitting in quadratic ﬁelds In this section, we will let K = Q( √d) be a quadratic ﬁeld. As usual we will assume d ￿=1 is squarefree. Further p will denote a prime (element) of Z and p will denote a prime (ideal) of OK. In this case, the splitting of p (i.e., of pZ)in K is particularly simple. By the fundamental identity there are at most 2 prime ideals of K lying above p (i.e., pZ), counting multiplicity. Hence either p is inert in K, i.e., pOK is a prime ideal of OK,or pOK = p1p2 where p1 and p2 are prime ideals of OK. When p1 = p2, p is ramiﬁed in OK, and when p1 ￿= p2, p splits in OK.Note that since K is quadratic, p splitting and p splitting completely are one and the same. Let ∆ = ∆K be the discriminant of K. Recall ∆ = d if d ≡ 1 mod 4 and ∆ = 4d if d ≡ 2, 3 mod 4. Let ￿a p￿ denote the Kronecker symbol mod p.If p is odd, ￿a p￿ is the ordinary Legendre symbol deﬁne for any a ∈ Z, i.e., ￿a p￿ =1 when gcd(a, p)= 1 and a is a square mod p, ￿a p￿ = −1 when gcd(a, p)= 1 and a is a nonsquare mod p,and ￿a p￿ =0 when p|a.If p =2, we set ￿a 2 ￿ =    04|a 1 a ≡ 1 mod 8 −1 a ≡ 5 mod 8 undeﬁned a ￿≡ 0, 1 mod 4. This is an extension of the Legendre symbol where we have allowed p =2 on the bottom, and p|a for p odd. Note the deﬁnition for p =2 satisﬁes ￿a 2 ￿ = ￿2 a ￿ whenever a ≡ 0, 1 mod 4. Since the squares mod 8 are 0, 1, 4, the Kronecker symbol mod 2 detects whether an a ≡ 0, 1, mod 4 is a square mod 8. The problem with a ￿≡ 0, 1 mod 4, is one cannot extend the Kronecker symbol to integer values for such a so that it is multiplicative in a. However, this is ﬁne for us, since we only want that ￿∆ p ￿ is deﬁned for any prime p ∈ N, which it is since ∆ ≡ 0, 1 mod 4. The utility of this deﬁnition is apparent from the following result on the splitting of p in K. Theorem 2.2.1. Let p ∈ N be prime. (i) If ￿∆ p ￿ =0 then p is ramiﬁed in K. 32 (ii) If ￿∆ p ￿ =1 then p is split in K. (iii) If ￿∆ p ￿ = −1 then p is inert in K. Note this say the primes with ramify in K are precisely the ones dividing ∆. In particular, there are ﬁnitely many. Proof. Let p be a prime of K lying above p. Then p is a subgroup of OK which is free of rank 2 over Z. In particular, p is generated (as an ideal) by at most 2 elements of OK. We may take one of them to be p, and write p =(p, π) for some π ∈ OK.Write π = a+b √d 2 . Further, since N (p)|NK/Q(π) we have p|NK/Q(π)= a2−db2 4 ,so a2 ≡ db2 mod p (in fact, mod 4p). We ﬁrst prove the contrapositive of (iii). Suppose pOK is not inert and p is odd. Then p ￿= pOK, so p ￿ π, i.e., a and b are not both divisible by p. This implies b ￿≡ 0 mod p. Let b−1 such that b−1b ≡ 1 mod p. Then a2 ≡ db2 mod p implies (ab−1)2 ≡ d mod p, i.e., d is a square mod p so either ￿d p￿ =1 or 0, according to whether p ￿ d or p|d. Since ∆ = d or ∆ = 4d, ￿d p￿ ￿= −1 implies ￿∆ p ￿ ￿= −1. This proves (iii). A similar argument works for p =2. Now suppose ￿∆ p ￿ =0 and p odd. Then ￿∆ p ￿ = ￿d p￿,so p|d. In this case, we can take p =(p, √d). To see this, observe that any element of p looks like 1 2 ((x + y√d)p +(z + w√d) √d)= 1 2 (px + dw +(z + py) √d) for some x, y, z, w ∈ Z. Since p|d, this means OK ￿ (p, √d)= ￿ 1 2 (px + y√d): x, y ∈ Z ￿ ∩ OK ￿ pOK. Hence p =(p, √d) lies above p. Thus pOK = pp where p is the conjugate ideal of p in K,but p =(p, − √d)= p,so p is ramiﬁed in K. The case of ￿∆ p ￿ =0 and p =2 is an exercise below. Now assume ￿∆ p ￿ =1 and p odd, so that ￿∆ p ￿ = ￿d p￿ =1. Let a ∈ Z be such that a2 ≡ d mod p. Note p ￿ a since p ￿ d. We claim we can take p =(p, a + √d). Then the conjugate ideal is p =(p, a − √d). It is clear thatp, p ￿ pOK, so it suﬃces to show p ￿= OK. To see this, observe that pp =(p2,pa + p√d, pa − p√d, a 2 − d) ⊆ pOK. Hence pOK = pp (and p, p are primes of K). It remains to show p ￿= p.If p = p,then we would have 2a = a + √d − a − √d ∈ p ∩ Z = pZ, which is impossible since p ￿ 2a. This shows p splits in K. Suppose ￿∆ p ￿ =1 and p =2. Then ∆ ≡ 1 mod 8. Then as in the p odd case one shows one can take p =(2, 1+√d 2 ), p ￿= p and pp =2OK. Exercise 2.7. Suppose ￿∆ 2 ￿ =0.Show p =(2, π) is a proper ideal of K containing 2OK,where π = √d or 1+ √d according to whether d is even or odd. Use this to verify (i) in the above theorem for p =2. Exercise 2.8. Let K = Q( √−5).Determine which primes of Q ramify in K and which are unramiﬁed. Then determine which primes of Q split completely in K and which are inert. 33 Note that in the course of the proof of the above theorem, we were able to explicitly describe the prime ideals of K lying above p. For convenient reference, we summarize this below. Corollary 2.2.2. If p ￿=2 is ramiﬁed in K,then p =(p, √d) is a prime of K lying above p.(For p =2 ramiﬁed in K,see Exercise 2.7 above.) If p ￿=2 splits in K,then p =(p, a + √d) is a prime of K lying above p for any a such that a2 ≡ d mod p.If 2 splits in K,then d ≡ 1 mod 4 and p =(2, 1+√d 2 ) is a prime of K lying above 2. The above theorem is very useful for many things. One application is to determining class numbers and class groups of quadratic ﬁelds. Example 2.2.3. Let K = Q( √−19).This has determinant ∆ = −19.By Lemma 1.6.4 (or Minkowski’s bound, which is the same in this case), every ideal of OK is equivalent to one of norm at most 2 π √19 ≈ 2.85.There is only ideal of norm one, namely OK,which is principal. Any ideal of norm 2 must lie above 2 (Corollary 2.1.9), but ￿∆ 2 ￿ = −1 since ∆ = −19 ≡ 5 mod 8,i.e., 2 is inert in K.Hence there is no ideal of norm 2,whichmeans theclass number hK =1. Exercise 2.9. Show K = Q( √−15) has class number 2. Exercise 2.10. Show K = Q( √−43) has class number 1. Another application of the above theorem is to determining primes of the form x2 + ny2, which we consider next. 2.3 Primes of the form x2 + ny2 Recall that one of our motivating questions, both this semester and last semester, was to study numbers of the form x2 + ny2. Any two number of the form x2 + ny2 have a product which is also of the form x2 + ny2 by Brahmagupta’s composition law, so this question largely reduces to the question of which primes p are of the form x2 + ny2. It is clear that p = x2 + ny2 means p is reducible in the ring of integers of K = Q( √−n).For simplicity, we assume n is a square free integer, and put d = −n,so K = Q( √d) which coincides with the notation in the previous section. For the result below we will allow n to be negative, because it is no extra work (it just involves including a ± sign), though our main interest is in n> 0. We will also assume n ￿= −1, because then K = Q. So the case of n = −1 is particularly simple, as our question is: which primes are of the form p = x2 − y2 =(x − y)(x + y). But this factorization means (say for p> 0)that x − y =1 so p =2y +1, i.e., all odd p> 0 are of the form x2 − y2. Interchanging x and y also shows that any odd p< 0 is of the form x2 − y2. Proposition 2.3.1. Let p be a prime of Z.If p = x2+ny2 for some x, y ∈ Z,then pOK = p1p2 where p1 and p2 are (not necessarily distinct) principal prime ideals of OK.Conversely, if pOK = p1p2 where p1 and p2 are principal prime ideals of OK,then (i) ±p is of the form x2 + ny2 if n ≡ 1, 2 mod 4; (ii) ±4p is of the form x2 + ny2 if n ≡ 3 mod 4. Proof. (⇒) As above, set d = −n to match with notation from the previous section. Suppose p = x2 + ny2 = x2 − dy2 =(x + y√d)(x − y√d). Since p is squarefree, both x and y must be nonzero so α = x + y√d and β = x − y√−d are nonzero nonunits of OK. Thus pOK =(α)(β) 34 is the prime ideal factorization of pOK. (The ideals (α) and (β) are prime either by the argument that NK/Q(α)= NK/Q(β)= ±p or using the fundamental identity to count the prime ideals in the factorization of pOK). (⇐) Suppose pOK is a product of two principal prime ideals p1 =(α) and p2 =(β). Since the ideals (α) and (β) are conjugate, we may assume α and β are conjugate, i.e., α = x + y√d, β = x−y√d for some x, y ∈ Q. Then NK/Q(α)= NK/Q(β)= p, and the factorization pOK =(α)(β) implies p = uαβ = u(x2 − dy2) for some unit u of OK. Since x2 − dy2 ∈ Z,we must have u = ±1. If d ≡ 2, 3 mod 4, then we may assume x, y ∈ Z so we have shown (i). If d ≡ 1 mod 4, then x, y ∈ 1 2 Z and (ii) follows. Note that we can rephrase the n ≡ 1, 2 mod 4 case as follows: ±p = x2 + ny2 if and only if pOK is a product of 2 (not necessarily distinct) principal ideals in OK. When n> 0,the ± sign here is moot: negative p are never of the form x2 + ny2, but for n< 0 the distinction of whether p or −p is of the form x2 + ny2 is somewhat more subtle. Our main focus is when n> 0, so we will not worry about this now, but it can be treated via the general theory of binary quadratic forms. We will discuss binary quadratic forms in Part II, but again our focus there will be mostly on the “positive” cases. One can make a similar if and only if statement when n ≡ 3 mod 4. Exercise 2.11. Suppose n ≡ 3 mod 4.Show pOK = p1p2 for two (not necessarily distinct) prime ideals p1, p2 of OK if and only if ±4p = x2 + ny2 for some x, y ∈ Z. To see that these two cases are necessary, look at K = Q( √−11). Then p =3= 1+√−11 2 1−√−11 2 so p splits in OK,but 3 ￿= x2 + 11y2 for x, y ∈ Z. Of course 12 = 4 · 3=12 + 11 · 12. We remark that one could treat the n ≡ 3 mod 4 and the n ≡ 1, 2 mod 4 uniformly as follows: ±p = x2 + ny2 if and only if pZ[ √−n] is a product of two proper principal ideals of Z[ √−n]. However the issue with this is that the ideals of Z[ √−n] (when n ≡ 3 mod 4) are more diﬃcult to study than OK, e.g., the prime ideal factorization theorem does not hold for Z[ √−n]. Now let’s see how we can use this to give alternative (simpler) proofs of some of our main results from last semester. New cases are contained in the exercises. Below p denotes a prime number in N and x, y ∈ Z. Corollary 2.3.2. (Fermat’s two square theorem) We can write p = x2 + y2 if and only if p =2 or p ≡ 1 mod 4. Proof. By the proposition, p = x2 + y2 if and only if p is a product of two (not necessarily distinct) principal ideals in Q(i).(−p cannot be a sum of 2 squares so the ± in the proposition is not an issue here.) Since we know the class number of Q(i) is 1, we in fact have p = x2 + y2 if and only if p splits or ramiﬁes in Q(i). Here ∆ = ∆Q(i) = −4, so by Theorem 2.2.1, p = x2 + y2 if and only if p =2 (the ramiﬁed case) or ￿∆ p ￿ = ￿−4 p ￿ = ￿−1 p ￿ =1. But the ﬁrst supplementary law to quadratic reciprocity tells us ￿−1 p ￿ =1 if and only if p ≡ 1 mod 4. Exercise 2.12. We have p = x2 +2y2 if and only if p =2 or p ≡ 1, 3 mod 8. We proved this in Chapter 9 last semester, but you should give a simpler argument using the above results. Then we left the case of x2 +3y2 as an exercise in Chapter 9, which you may recall was considerably more challenging than the x2 +2y2 case. In fact, we still haven’t made things any 35 easier on ourselves for this case since this corresponds to d ≡ 1 mod 4 above. It may be worthwhile to see what the issue is, so let’s go through this. Suppose p = x2 +3y2. Then by the above proposition pOK is a product of two principal ideals of OK, where K = Q( √−3). In this case hK =1, so every ideal is principal. Hence p either splits or ramiﬁes in OK which means ￿∆ p ￿ = ￿−3 p ￿ = ￿p 3￿ =0 or 1, i.e., p =3 or p ≡ 1 mod 3. Clearly p =3 is of the form x2 +3y2. It remains to show if p ≡ 1 mod 3, then p = x2 +3y2. By this same computation of ￿∆ p ￿,if p ≡ 1 mod 3,the p splits into two (prinicipal) ideals of K. However since d = −n ≡ 1 mod 4,the above proposition only tells us that 4p = x2 +3y2.For instance 4 · 7= 52 +3 · 12. It is not clear how to conclude that we must have p =(x￿)2 + 3(y￿)2 for some x￿,y￿, though it is true. Roughly, one might like to use Brahmagupta’s composition law (the product of two numbers of the form x2 + ny2 is again of this form—this is simple, but not pretty, computation) in reverse: 4=12 +3 · 12 and 4p are both of the form x2 +3y2, so their quotient p =4p/4 should be. We will see that one can more or less do just this using Gauss’s theory of binary quadratic forms in Part II. Hence for now, we will forget about the case n ≡ 3 mod 4 (i.e., d ≡ 1 mod 4). Corollary 2.3.3. We have p = x2 +5y2 if and only if p =5 or p ≡ 1, 9 mod 20. Proof. Let K = Q( √−5) so ∆ = ∆K = −20.Only two primes p ramify in K, p =2 and p =5. Clearly 2 ￿= x2 +5y2 and 5= x2 +5y2, so from now on, assume p is unramiﬁed. (By the proposition above, this corresponds to the fact that 2OK is the square of the nonprincipal ideal (2, 1+ √−5) and 5OK is the square of the principal ideal ( √−5).) Note that p is split in K if and only if ￿∆ p ￿ = ￿−5 p ￿ =1, i.e., if and only if p ≡ 1, 3, 7, 9 mod 20. (⇒) If p = x2 +5y2, then p splits in K by the proposition, so p ≡ 1, 3, 7, 9 mod 20.On the other hand, x2 +5y2 ≡ x2 + y2 ≡ 0, 1, 2 mod 4 so p ￿≡ 3, 7 mod 20. (Alternatively, one can look at the squares mod 20.) (⇐) Suppose p ≡ 1, 9 mod 20 but p ￿= x2 +5y2. The congruence conditions imply pOK = pp where p is a prime ideal of K,and p ￿= x2 +5y2 means p is nonprincipal. Since hK =2, this means p ∼ (2, 1+ √−5), i.e., p = α(2, 1+ √−5) for some α ∈ K. Write α = a c + b d √−5 for some a, b, c, d ∈ Z.Note that 2α and (1 + √−5)α must lie in OK. Since 2α ∈ OK, c|2 and d|2 so we can write α = a+b √−5 2 (replacing a and b with 2a and 2b if necessary). Then one has (2)p =(a + b√−5)(2, 1+ √−5). Taking norms yields 2p = a 2 +5b2. Reducing this equation mod 5 yields a2 ≡ 2, 3 mod 5 (since p ≡ 1, 4 mod 5), which is a contradic- tion.∗ For a slightly diﬀerent argument, see last semester’s Chapter 12 Notes. One could simplify this proof if we knew we could use Brahmagupta’s composition law in reverse (see above remarks on x2+3y2). In particular, for the argument in the (⇐) direction, p ∼ (2, 1+√−5) means (a+b√−5)p = (c + d√−5)(2, 1+ √−5) for some a, b, c, d ∈ Z[ √−5]. Taking norms gives p(a2 +5b2) = 2(c2 +5d2). Since 2 is not of the form x2 +5y2, one would like to conclude p is not either, but it is not obvious how to make this argument work. We will essentially be able to via genus theory in Part II. ∗Thanks to Victor Flynn for correcting an earlier argument. 36 Before moving on, let us observe there is another interesting characterization of which primes are of the form x2 +5y2.Suppose n> 0 and n ≡ 1, 2, mod 3. As before, set K = Q( √−n). When hK =1, the above proposition and the theorem if that a prime p is of the form x2 + ny2 if and only if ￿∆ p ￿ =0 or 1. By quadratic reciprocity, one can then essentially say an prime p is of the form x2 + ny2 if and only if p is a square mod ∆. (One can formalize this with a diﬀerent extension of the Legendre symbol called the Jacobi symbol—we won’t go through the details, but you can observe it in the simplest case: p ￿=2 is of the form x2 + y2 if and only if p is a square mod ∆Q(i) = −4.) When hK =2 (or larger), the problem is the quadratic residue symbol can essentially only detect 2 things—whether p is split or inert (or ramiﬁed). But we need to distinguish when a p splits into principal ideals and when p splits into nonprincipal ideals. Check the following criterion for x2 +5y2. Exercise 2.13. Let K = Q( √−5),and p ∈ N be a rational prime. Show p = x2 +5y2 if and only if ￿∆ p ￿ =1 and p is a square mod ∆. One can treat other forms x2 + ny2 similar to x2 +5y2 when the class number of Q( √−n) is 2. Exercise 2.14. Determine all primes of the form x2 +6y2. When the class number of K = Q( √−n) is larger than 2, determining the primes of the form x2 + ny2 can get considerably more complicated, and the solution will depend upon the structure of the class group ClK. In general, primes of the form x2 + ny2 are not characterized just by simple congruence conditions (though it always will be if ClK ￿ (Z/2Z)r). We will explore some of the issues involved in Part II. 2.4 General splitting results In this section, let L/K be an extension of number ﬁelds, let p denote a prime of K and P denote aprimeof L.If pOL = ￿ P ei i with the Pi’s distinct prime ideals of L, then fi denotes the inertial degree fi = f (Pi|p). In Section 2.2, we saw that it is simple to understand completely the way a prime p splits in L when K = Q and L is quadratic. (It is also not much harder when K is arbitrary and L/K is quadratic.) In general things are not so simple, but there are some general fundamental results which describe the splitting of primes in L/K. We will not give complete proofs in both the interest of time and simplicity. Note that OK[α] is a free OK-module of rank n =[L : K], so it has ﬁnite index (either as an abelian group or OK-module) in OL. Thus OL/OK[α] is a ﬁnite abelian group. Theorem 2.4.1. Write L = K(α) and let q(x) ∈ OK[x] be the minimum polynomial for α over K.Suppose p is a prime of Z such that p ￿ |OL/OK[α]| and p is a prime ideal of K lying above p. Write q(x) ≡ q1(x) e1q2(x) e2 ·· · qg(x) eg mod p where the qi’s are distinct irreducible polynomials (of positive degree) in the ﬁnite ﬁeld OK/p.Then pOL = P e1 1 P e2 2 ·· · P eg g for distinct prime ideals P1,. .., Pg of OL such that fi = f (Pi|p)=deg qi(x). 37 This theorem provides a way to determine how prime ideals p of K split in L. For technical reasons, a ﬁnite number of primes p are excluded from this result. Proof. (Sketch.) One ﬁrst shows OL/pOL ￿ (OK[α])/(pOK[α]) ￿ (OK/p)[x]/(q(x)), where q(x) is the image of q(x) in (OK/p)[x]. The ﬁrst isomorphism requires that pOL + F = OL where the conductor F is the largest ideal of OL contained in OK[α]. This is where the technicality that p ￿ |OL/OK[α]| comes in. The second isomorphism is straightforward. Then one can use the Chinese Remainder Theorem (for general rings, whose proof is essentially the same as for Z), (OK/p)[x]/(q(x)) ￿ g￿ i=1 (OK/p)[x]/(qi(x) ei), where qi(x) is the image of qi(x) in (OK/p)[x]. Exercise 2.15. Suppose K = Q and L = Q( √−5).Determine |OL/OK[α]| where α = √−5. Verify the above theorem in this case. Theorem 2.4.2. Consider the extension K/Q.Then a prime (p) of Q ramiﬁes in K if and only if p|∆K. In particular, only ﬁnitely many primes of Q ramify in K. Corollary 2.4.3. Let L/K be an extension of number ﬁelds. If a prime p of K ramiﬁes in L,then p lies above a prime of N dividing ∆L. In particular, only ﬁnitely many primes p of K ramify in L. Exercise 2.16. Deduce this corollary from the previous theorem. 38","libVersion":"0.3.1","langs":""}
{"path":"iCloudDrive/bks/Combinatorics/Combinatorics/2010squad-comb-soln.pdf","text":"New Zealand Mathematical Olympiad Committee 2010 Squad Assignment Three Combinatorics Due: Thursday 18th March 2010 1. In the road network shown below, the vertices in the middle horizontal line are labeled 1, 4, 7, . . ., the vertices in the upper row are labelled 2, 5, 8, . . ., and the vertices in the bottom row are labelled 3, 6, 9 . . .. \u0000 \u0000 \u0000 @ @ @ @@ @@@ @\u0000\u0000 \u0000\u0000\u0000 \u0000@@ @@@ @\u0000\u0000 \u0000\u0000\u0000 \u0000@@ @@ \u0000\u0000 \u0000\u0000 How many paths are there from the vertex labelled 1 to the vertex labelled 3n + 1 such that vertices are visited only in increasing order? Solution: We observe that we can only move from one vertex to another if we are moving in the rightward direction. Let an be the number of ways of reaching vertex 3n + 1 from vertex 1 and bn be the number of ways of reaching vertex 3n + 2 or 3n + 3 from vertex 1 (clearly these two are the same from symmetry). Then by considering our previous possible position when we move to any vertex we can construct the following recursive formulas an+1 = an + 2bn and bn+1 = an+1 + bn with starting conditions a0 = 1 and b0 = 1. These can be solved for equations in terms of the ai alone: we have bn = an+1+an 2 , so bn+1 = an+2 + an+1 2 = an+1 + an + an−1 2 an+2 = 4an+1 − an. This recursion has characteristic equation x2 = 4x − 1 with roots x1,2 = 2 ± √3. Hence we solve the equation an = A(2 + √ 3)n + B(2 − √3) n with a0 = 1 and a1 = 3 to obtain A = 3+ √3 6 and B = −3+ √3 6 . Therefore an = 3 + √3 6 (2 + √ 3)n + −3 + √3 6 (2 − √3) n. 2. An odd integer is written in each cell of a 2009 × 2009 table. For 1 ≤ i ≤ 2009 let Ri be the sum of the numbers in the ith row, and for 1 ≤ j ≤ 2009 let Cj be the sum of the 1 numbers in the jth column. Finally, let A be the product of the Ri, and B the product of the Cj. Prove that A + B is diﬀerent from zero. Solution: We consider all the integers in the cells mod 4, so each entry is ±1. We will show that A ≡ B (mod 4) and since A ≡ ±1 (mod 4) we will have that A + B ≡ 2 (mod 4) and so cannot be equal to 0. Consider R to be sum of the Ri and C to be the sum of the Ci. Then clearly both R and C are the sums of all the entries in the cells, hence R = C, and in particular R ≡ C (mod 4). Because Ri and Ci are a sum of 2009 odd integers, they are both odd for all i. Let there be r values of i for which Ri ≡ −1 (mod 4) and c values of i for which Ci ≡ −1 (mod 4). Then R ≡ (2009 − r) − r ≡ 2009 − 2r ≡ C ≡ (2009 − c) − c ≡ 2009 − 2c (mod 4). Hence 2r ≡ 2c (mod 4), or r ≡ c (mod 2). Now we observe that A ≡ 1 2009−r(−1) r ≡ (−1)r (mod 4) and B ≡ 1 2009−c(−1) c ≡ (−1)c (mod 4). Hence the values of A and B mod 4 are determined by the parities of r and c, but r ≡ c (mod 2), so A ≡ B (mod 4) as we claimed. 3. A number of coins have been placed at each vertex of the regular n-gon A1A2 . . . An. These coins may be re-arranged using the following move: two coins may be chosen, and each moved to an adjacent vertex, subject to the requirement that one must be moved clockwise and the other anti-clockwise. (Thus, for example, you may move a coin from each of A1 and A5 to vertices A2 and A4 respectively: each coin ends up on a vertex adjacent to the one it started on, and they move in opposite directions.) Suppose that there are initially k coins at vertex Ak for each k, 1 ≤ k ≤ n. For which n is it possible to re-arrange the coins using ﬁnitely many such moves so that there are exactly n + 1 − k coins at vertex Ak, 1 ≤ k ≤ n? Solution: To all coins placed on vertex Ai we assign value i. We then let S be the sum of the values of all the coins and after every move we update the value of S. We observe that after a move where a coin is not moved from A1 to An or vice versa, the sum of S stays constant since one coin increases in value by 1, and another decreases by 1. If a coin is moved from A1 to An, then the change in S will be (n − 1) + 1 = n, and if a coin is moved from An to A1 then the change in S will be −(n − 1) − 1 = −n. Hence we see that after every move, the remainder of S upon division by n will stay constant. The initial value of S is 1 · 1 + 2 · 2 + · · · + n · n = n∑ k=1k2 = 1 6 n(n + 1)(2n + 1) and the ﬁnal desired value of S is n∑ k=1k(n + 1 − k) = (n + 1) n∑ k=1k − n∑ k=1k2 = 1 6 n(n + 1)(n + 2). Since the remainder of these two values must be equal upon division by n, their diﬀerence is divisible by n. Hence 1 6n(n + 1)(2n + 1) − 1 6n(n + 1)(n + 2) = 1 6n(n2 − 1) must be divisible by n, i.e. 1 6(n2 − 1) must be an integer. The only values of n for which this holds are n ≡ ±1 (mod 6). 2 Now we can show that any desired arrangement can be reached provided that the initial and ﬁnal values of S give the same remainder when divided by n. To see this, choose a coin from each of the initial and ﬁnal positions, and distinguish it from the others by painting it red. Now move every coin other than the red coin to its desired position, by moving them all in the anti-clockwise direction only, and moving the red coin clockwise at every move. We claim that once this is done the red coin must be in its desired position too. Indeed, if the sum of the coins excluding the red one is T , then the red coin must be at the unique vertex Ak such that k ≡ Sinitial − T mod n; but since Sinitial − T ≡ Sﬁnal − T mod n, this must be the position of the red coin in the desired ﬁnal arrangement also. Hence any arrangement can be reached from the initial position provided that the diﬀerence of the initial and ﬁnal values of S is divisible by n. Therefore a suﬃcient and necessary condition for n is n ≡ ±1 (mod 6). 4. A convex 2010-gon is partitioned into triangles using non-intersecting diagonals. One of these diagonals is painted green. The triangulation may be modiﬁed using the following move: if ABC and BCD are triangles of the partition having BC as a common side, then the diagonal BC may be replaced by the diagonal AD. Moreover, if BC is green, then it loses its colour and AD becomes green instead. Prove that an arbitrarily chosen diagonal of the polygon can be coloured green using ﬁnitely many such operations. Solution: Note that for any convex n-gon all the diagonals from a given vertex determine a triangulation (i.e. all the diagonals in this triangulation are attached to the one vertex). Call such a triangulation basic with respect to this vertex. We ﬁrst show that starting from an arbitrary triangulation of an n-gon we can reach any basic triangulation. For a vertex A moving anti-clockwise denote by B1, B2, . . . , Bk the consecutive vertices of the n-gon such that ABi is either a side or a diagonal in the given triangulation. If the segment BiBi+1 is not a side then it is a diagonal in the triangulation. By carrying out the allowed operation we obtain a new triangulation with one more diagonal from vertex A between ABi and ABi+1. Continuing this until A has the maximum number of diagonals completes the basic triangulation. We prove the assertion for any n-gon by induction on n. For n = 4 and 5 the veriﬁcation is straightforward. Assume the assertion is true for all n-gons with n ≤ k where k ≥ 5 and consider an arbitrary triangulation of a (k + 1)-gon with one green diagonal. Assume that A1Ai is the diagonal we wish to colour green. We then turn the triangulation into a basic triangulation with respect to A1. If after doing so A1Ai is green then we are done. So assume without loss of generality that A1Aj is green where j < i (if j > i then we can simply reverse the order of the vertex labels). Consider the polygon A1A2 . . . Ai. The inductive hypothesis implies that we can obtain a triangulation of this polygon with green diagonal A1Ai−1. Since k ≥ 5 and any triangula- tion of a (k +1)-gon has k −2 diagonals we have that there exists a diagonal diﬀerent from A1Ai−1 and A1Ai. This diagonal divides the (k + 1)-gon into two convex polygons each of them having less than k + 1 vertices. Moreover the diagonals A1Ai−1 and A1Aiboth lie in the same polygon and after applying the inductive hypothesis to this polygon we see that A1Ai can be coloured green as desired. 3 5. Let n ≥ 1 be an integer. In town X there are n girls and n boys, and each girl knows each boy. In town Y there are n girls, g1, g2, . . . , gn, and 2n − 1 boys, b1, b2, . . . , b2n−1. For i = 1, 2, . . . , n, girl gi knows boys b1, b2, . . . , b2i−1 and no other boys. Let r be an integer with 1 ≤ r ≤ n. In each of the towns a party will be held, where r girls from that town are to dance with r boys from the same town in r pairs of dancers. However, each girl will only dance with a boy that she knows. Let X(r) be the number of ways we can choose r pairs of dancers from town X, and let Y (r) be the number of ways that we can choose r pairs of dancers from town Y . Show that X(r) = Y (r) for r = 1, 2, . . . , n. Solution: For a given n we will denote X(r) and Y (r) by Xn(r) and Yn(r). We see that Xn(r) is the product of the number of ways of picking r girls, r boys and then pairing them. Hence Xn(r) = (n r)2r!. We ﬁrst check the cases when r = 1 and r = n. For town Y , gi can go with a total of 2i − 1 boys. So summing over all girls Yn(1) = n∑ i=1 (2i − 1) = n 2 = Xn(1). For r = n every girl must be picked for a pair. We see g1 can go with 1 boy, then g2 can go with 2 boys since 1 of her 3 available boys was taken by g1, then g3 can go with 3 boys since 2 of her 5 available boys were taken by g1, g2, etc. ..., gn can go with n boys. Hence Yn(n) = 1 · 2 · 3 · · · · · n = n! = Xn(n). Consider now 2 ≤ r ≤ n − 1 and choosing r pairs from town Y . We can either choose gn or not choose her. If we choose her then we have r − 1 pairs to choose from the remainder of the girls who do not know b2n−2, b2n−1. There are Yn−1(r − 1) ways of choosing the remainder of the girls, and gn is then left with (2n − 1) − (r − 1) = 2n − r available boys. Hence the total number of ways of including gn is (2n − r)Yn−1(r − 1) and note that this is well deﬁned since 2 ≤ r. If we do not include gn then since none of the girls except her know b2n−2, b2n−1, we are in the position of picking r pairs from the same town but with n − 1 girls. Hence the number of ways of not including gn is Yn−1(r), and note that this is well deﬁned since r ≤ n − 1. Now Yn(r) is the sum of these, so Yn(r) = (2n − r)Yn−1(r − 1) + Yn−1(r). It is easy to check that Xn(r) satisﬁes the same recursive formula. Since Xn(r) and Yn(r) agree on their boundary conditions and satisfy the same recursive formula which constantly looks at smaller values of n, Xn(r) = Yn(r) for all n and r ≤ n. Alternate solution. We may also give a bijective solution, as follows. We will create n towns X1, X2, . . . , Xn, each with n girls g1, g2, . . . , gn, and 2n − 1 boys, b1, b2, . . . , b2n−1. In town Xk girl gi knows only boys b1 to bk if i ≤ k, and only boys b1 to b2i−1 if i > k. Clearly, town X1 is the same as town Y ; and in town Xn every girl knows boys b1, . . . , bn, and no girl knows boys bn+1, . . . , b2n−1, so we may consider Xn to be the same as X. Our goal is to show that there is a bijection between acceptable choices of r dancers in towns Xk and Xk+1 for each k, 1 ≤ k ≤ n − 1. Suppose then that we have an acceptable arrangement of r pairs of dancers from town Xk. This will also be an acceptable arrangement in town Xk+1, unless girl gk+1 dances with boy b2k+2−i for some i ≤ k, as these two do not know each other in town Xk+1. In this case we ask girl gi to dance with boy bk+1 in their stead. If girl gi is already partnered 4 with some boy bj, j ≤ k, then we have girl gk+1 dance with bj, otherwise gk+1 does not dance; and if boy bk+1 is already partnered with some girl gl then we have boy b2k+2−i dance with girl gl, otherwise boy b2k+2−i does not dance. We claim that the result of these rearrangements will be acceptable in town Xk+1. Every girl in town Xk+1 knows boy bk+1, so the ﬁrst pairing is certainly acceptable; and the second is too, because i ≤ k forces j ≤ k, so girl gk+1 knows boy bj. For the last, we must have l ≥ k + 1 in order for girl gl to know boy bk+1 in town Xk, which gives l ≥ k + 2, since l ̸= k + 1. Then 2k + 2 − i ≤ 2(k + 1) − 1 < 2l − 1, so girl gl knows boy b2k+2−i. Conversely, suppose that we have an acceptable arrangement of r pairs of dancers in town Xk+1. This will also be an acceptable arrangement of dancers in town Xk, unless girl gi dances with boy bk+1 for some i ≤ k. In this case we simply reverse the rearrangements made above. We ask girl gk+1 to dance with boy b2k+2−i, with girl gi taking gk+1’s partner bj if she has one (otherwise gi does not dance), and bk+1 taking boy b2k+2−i’s partner gl if he has one (otherwise boy bk+1 does not dance). The result will acceptable in town Xk. We must have j ≤ k + 1, in order for girl gk+1 to know boy bj, and in addition j ̸= k + 1, since bk+1 was already dancing with girl gi. So girl gi knows boy bj in town Xk, and moreover, girl gl knows boy bk+1, because k + 1 ≤ 2k + 2 − i. As we have simply reversed the rearrangements made two paragraphs above, this establishes the desired bijection. Remark: This problem can be phrased quite naturally in terms of rook polynomials. Given a “chessboard” B, the co-eﬃcient of xr in the rook polynomial of B counts the number of ways to place r rooks on B so that no rook attacks any other. The result of the problem then says that the “chessboards” corresponding to towns X and Y have the same rook polynomial. 6. Let G be a ﬁnite connected graph, whose edges are labelled 1, 2, . . . , e in some order. Starting from an arbitrary vertex, repeat the following process: (a) Choose the edge incident to the current vertex with the largest label. (b) Move along the chosen edge to the adjacent vertex, relabelling the edge 1, and adding 1 to the labels of all the other edges. Prove that eventually each edge is traversed. Solution: Call a vertex recurrent if it is visited inﬁnitely many times, and similarly, call an edge recurrent if it is traversed inﬁnitely many times. Clearly, G must have at least one recurrent vertex, since it has only ﬁnitely many vertices. We will solve the problem by proving the following lemma: Lemma. Any edge adjacent to a recurrent vertex must itself be recurrent. Before proving the lemma we will introduce some notation and make an observation. Write ℓn(a) for the label of edge a at step n. Condition (b) implies that ℓa(n + 1) − ℓb(n + 1) =  | | ℓa(n) if b is traversed at step n + 1; −ℓb(n) if a is traversed at step n + 1; ℓa(n) − ℓb(n) otherwise. 5 In particular, if ℓa(n) − ℓb(n) is positive at n = k, it will remain positive for n ≥ k unless a is traversed. We now prove the lemma. Proof. Let v be recurrent, and let f be an edge adjacent to v that is traversed inﬁnitely often in the direction away from v. Such an edge must exist, because there are only ﬁnitely many edges adjacent to v, and v is visited inﬁnitely often. We claim that whenever f is traversed, every other edge adjacent to v must be traversed before f is next traversed in the direction away from v. Let g be an arbitrary edge adjacent to v, and suppose that f has just been traversed (in either direction) at step n. Then ℓg(n) − ℓf (n) = ℓg(n) − 1 > 0. Immediately before f is next traversed in the direction away from v we must have ℓf > ℓh for all edges h adjacent to v, by condition (a). In particular, ℓf > ℓg, so ℓg − ℓf is now negative. By our observation above, g must have been traversed. Since f is traversed away from v inﬁnitely often, and every other edge adjacent to v must be traversed between any two such occurrences, every edge adjacent to v is recurrent. The desired result now follows from the lemma. The lemma implies that every vertex adjacent to a recurrent vertex is recurrent; since the graph is connected, and has at least one recurrent vertex, every vertex is recurrent. But then every edge is adjacent to a recurrent vertex, so by the lemma again every edge is recurrent, and so is traversed at least once. 7. Determine the largest positive integer n for which there exist pairwise diﬀerent sets S1, S2, . . . , Sn with the following properties: (a) |Si ∪ Sj| ≤ 2006 for any two indices 1 ≤ i, j ≤ n, and (b) Si ∪ Sj ∪ Sk = {1, 2, . . . , 2010} for any 1 ≤ i < j < k ≤ n. Solution: Consider G{i,j} = {1, 2, . . . , 2010} \\ (Si ∪ Sj) for all 1 ≤ i, j ≤ n. Then condition (a) implies |G{i,j}| ≥ 4 and condition (b) implies G{i,j} ∩ G{k,l} = ∅ for all i, j, k, l with i ̸= j, k ̸= l and {i, j} ̸= {k, l}. It follows that 2010 ≥ \f \f \f \f \f ⋃ 1≤i<j≤n G{i,j} \f \f \f \f \f = ∑ 1≤i<j≤n |G{i,j}| ≥ 4 ( n 2 ) , hence ( n 2) ≤ 502 so n ≤ 32. Now we show that n = 32 is possible. Partition the set {1, 2, . . . , 1984} arbitrarily into 494 (disjoint) 4-element subsets, denote these subsets G{i,j}, 1 ≤ i < j ≤ n in an arbitrary manner. Then deﬁne Si = {1, 2, . . . , 2010} \\ ⋃ j̸=iG{i,j} for each i = 1, 2, . . . , 32. Then Si ∪ Sj = {1, 2, . . . , 2010} \\ G{i,j} and so condition (a) is satisﬁed and since Si ∪ Sj ∪ Sk = (Si ∪ Sj) ∪ (Sj ∪ Sk) = {1, 2, . . . , 2010} \\ ( G{i,j} ∩ G{j,k}) = {1, 2, . . . , 2010}, condition (b) is also satisﬁed. Hence the largest n satisfying the given conditions is 32. 6 8. Consider a graph with n vertices, and let k, 1 ≤ k ≤ n, be a positive integer. It is known that among any k vertices there exists a vertex which is connected to the remaining k − 1 vertices. Find all values of n and k for which there must always exist a vertex of degree n − 1. Solution: Consider the complement of the given graph, that is, the graph with the same vertices, and an edge between vertices u and v precisely when the original graph does not. The condition in the problem then states that among any k vertices, there is one that is not connected to any of the remaining k − 1; more succinctly, the subgraph induced by any k vertices contains an isolated vertex. The problem is then to determine for which n and k the graph as a whole must have an isolated vertex. We will assume that the graph as a whole does not have an isolated vertex, and determine for which n and k we are able to satisfy the condition. The solution will then be those n and k for which we are never able to do this. The assumption that the graph does not have an isolated vertex implies that every con- nected component has at least two vertices. Suppose ﬁrst that every component has exactly two vertices (and so that n is necessarily even). If k is odd then any choice of k vertices will intersect at least one connected component in just one vertex, and the condition will be satisﬁed; but if k = 2m is even then we may choose k vertices that violate the condition by choosing m of the connected components. So the graph need not have an isolated vertex if n is even and k is odd. Suppose now that there is at least one connected component C with at least 3 vertices. We claim that in this case it is possible to choose k vertices that violate the condition if k ≥ 2. The vertices may be chosen as follows: (a) Choose two adjacent vertices from C, and then two adjacent vertices from each of the other components in turn, stopping if at any point either k or k − 1 vertices have been chosen. (b) If fewer than k vertices were chosen at the previous step, then either k − 1 vertices have been chosen, or two adjacent vertices have been chosen from each component. In the former case we obtain k vertices violating the condition by choosing a third vertex from C adjacent to one of those already chosen. Otherwise, we simply continue choosing vertices adjacent to those already chosen one by one until we have a total of k vertices. This is certainly possible, since there are n ≥ k vertices, and each vertex belongs to a component containing a vertex already chosen. Since any graph satisﬁes the condition with k = 1, the above shows that the graph as a whole necessarily has an isolated vertex unless k = 1, or n is even and k is odd. April 12, 2010 www.mathsolympiad.org.nz 7","libVersion":"0.3.1","langs":""}
{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Fibonacci Sequence Modulo n - Samin Riasat - MR 2011.pdf","text":"Z[ϕ] and the Fibonacci Sequence Modulo n Samin Riasat Abstract It has long been known that the Fibonacci sequence modulo n is periodic for any integer n > 1. In this paper we present an elementary approach of proving properties of this period by working in Z[ϕ] and also deduce some new results. In the last section a method for proving identities is shown. 1 Periodicity Modulo n We will use the following notation • n is a positive integer. • Fi is the i-th Fibonacci number: F0 = 0, F1 = 1 and Fi+1 = Fi + Fi−1 for all i ≥ 1. • Li is the i-th Lucas number: L0 = 2, L1 = 1 and Li+1 = Li + Li−1 for all i ≥ 1. • ϕ = 1+ √5 2 is the golden ratio. All congruences are taken modulo n, unless otherwise stated. Deﬁnition 1. For n > 1, k(n) is the least positive index such that n | Fk(n). For brevity, we will often denote k(n) simply by k. Example: k(2) = 3, k(10) = 15 etc. Deﬁnition 2. For n > 1, ℓ(n) is the length of the period of Fibonacci sequence modulo n. Example: ℓ(2) = 3, ℓ(10) = 60 etc. We also deﬁne the integral domain Z[ϕ] = {a + bϕ | a, b ∈ Z} and congruence in Z[ϕ] as follows: (i) If 5 is a quadratic residue modulo n, then a + bϕ ≡ c + dϕ (mod n), that is (a − c) ≡ (d − b)ϕ (mod n). Mathematical Reflections 1 (2011) 1 (ii) If 5 is a quadratic non-residue modulo n, then a + bϕ ≡ c + dϕ (mod n), that is a ≡ c (mod n) and b ≡ d (mod n). The following theorem was proved in [5]. Theorem 1. The Fibonacci sequence mod n is periodic. Proof. The terms of the Fibonacci sequence mod n can take only n possible values, namely 0, 1, . . . , n − 1. Note that if a sub-sequence Fk, Fk+1 repeats at some point, the whole sequence will repeat from that point, since Fk+2 = Fk+1 + Fk and so on. There are at most n2 possible choices for the sub-sequence Fk, Fk+1. So it must reappear at some point and hence the sequence is periodic. Corollary 1. Every positive integer divides inﬁnitely many Fibonacci numbers. Proof. Because the Fibonacci sequence mod n is periodic for every positive integer n, there are inﬁnitely many positive integers k such that Fk+1 ≡ Fk+2 ≡ 1. Then Fk ≡ 1 − 1 = 0 for all such k and the conclusion follows. Proposition 1. ℓ(n) = k · ordn(Fk+1). Proof. Since Fk ≡ 0, we have Fk+1 ≡ Fk−1 ≡ λ (0 ≤ λ ≤ n − 1) and from the Fibonacci recurrence it follows that Fk+i ≡ λFi for all i. Let g = ordn(λ). Then Fgk+1 ≡ Fgk+2 ≡ λ g ≡ 1. Also, since g is the order, there are no g′ < g such that Fg′k+1 ≡ Fg′k+2 ≡ λ g′ ≡ 1. Hence ℓ(n) = gk = k · ordn(λ). Corollary 2. n | Fm ⇔ k(n) | m. Proposition 2. ℓ(n) ∈ {k, 2k, 4k} for all n > 1. Proof. We will work in Z[ϕ]. Because Fk ≡ 0, we have ϕ k ≡ (1 − ϕ) k ⇔ ϕ k+1 ≡ ϕ(1 − ϕ) k ⇔ ϕk+1 − (1 − ϕ) k+1 ≡ (1 − ϕ) k(2ϕ − 1) ⇔ ϕ k+1 − (1 − ϕ) k+1 ≡ √ 5ϕk ⇔ Fk+1 ≡ ϕ k (mod n). On the other hand, 1 − ϕ = −1/ϕ implies ϕ k ≡ (− 1 ϕ )k ⇒ ϕ 2k ≡ (−1) k ⇒ ϕ 4k ≡ 1. (1) If ϕ k ≡ 1, then Fk+1 ≡ 1 and ℓ(n) = k. Otherwise, (i) if k is even then F2k+1 ≡ ϕ2k ≡ 1, which implies ℓ(n) = 2k. (ii) if k is odd then F4k+1 ≡ ϕ 4k ≡ 1, implying ℓ(n) = 4k. Hence the conclusion. Mathematical Reflections 1 (2011) 2 Remark: It is not diﬃcult to see that ϕ k = Fkϕ + Fk−1 holds for all k. Thus Fk+1 ≡ Fk−1 ≡ ϕk follows from here as well. From Fk+1 ≡ ϕk (mod n) we can propose a new deﬁnition for ℓ(n): Deﬁnition 3. ℓ(n) = ordn(ϕ) for all n > 1. Now we present a very short proof of another theorem of Wall in [5]. Theorem 2. ℓ(n) is even for n > 2. Proof. Assume the contrary. Then ℓ(n) = k implies ϕk ≡ 1. Hence ϕ2k ≡ 1 and, by Deﬁnition 1, (−1) k ≡ 1. Therefore k is even (since n > 2) and the conclusion follows. Proposition 3. If n > 2 and k(n) is odd, then ℓ(n) = 4k(n). Proof. From the last theorem it follows that ℓ(n) ̸= k. Suppose that ℓ(n) = 2k. Then Deﬁnition 1 implies 1 ≡ ϕ 2k ≡ (−1) k ≡ −1, a contradiction. Therefore ℓ(n) = 4k. Now we will prove the central theorems of this section. From here onwards p will represent a prime. Theorem 3. If p > 3, n > 1 and n | Fp, then k(n) = p and ℓ(n) = 4p. Proof. It is well known that gcd(Fi, Fj) = Fgcd(i,j). Hence for all i ̸≡ 0 (mod p) we have gcd(Fp, Fi) = 1, gcd(n, Fi) = 1. Thus p is the least positive integer such that n | Fp, i.e., k(n) = p. Since 3 ∤ p, Fp is odd, implying n is odd, and so n > 2. Because k(n) is odd, by Proposition 2, ℓ(n) = 4p. Theorem 4. If n is prime and p > 3, then ℓ(n) = 4p ⇔ n | Fp. Proof. Using Theorem 3, we need only prove that ℓ(n) = 4p ⇒ n | Fp. From Proposition 1, 4p ∈ {k(n), 2k(n), 4k(n)}. Hence k(n) ∈ {p, 2p, 4p}. If k(n) = p, we are done. So assume that k(n) = 2p. Since n | F2p = FpLp and n ∤ Fp, we must have n | Lp = ϕ p + (−1/ϕ)p. Hence ϕ 2p ≡ 1, ℓ(n) = 2p, a contradiction. Now suppose that k(n) = 4p. Then n | F4p = F2pL2p and since n ∤ F2p, n | L2p = ϕ 2p + (−1/ϕ) 2p. But then ϕ 4p ≡ −1, a contradiction. Therefore k(n) = p. Theorem 5. If q is a prime and p > 3, then ℓ(qn) = 4p ⇔ qn | Fp. Proof. q ̸= 2; otherwise 3 = ℓ(2) | ℓ(2n) = 4p, which contradicts p > 3. Thus q is odd. Now Li = Fi+1 + Fi−1 implies gcd(Fi, Li) ∈ {1, 2} for all i. The rest of the proof is similar to that of Theorem 4. Theorem 6. If p > 3 and ℓ(n) = 4p, then n has a prime factor q with multiplicity r ≥ 1 such that qr | Fp. Mathematical Reflections 1 (2011) 3 Proof. Let n = pa1 1 · · · paj j be the prime factorization of n. Then ℓ(n) = lcm(ℓ(pa1 1 ), . . . , ℓ(paj j )) = 4p. (2) Therefore ℓ(pai i ) ∈ {2, 4, p, 2p, 4p} for all i. But there is no x such that ℓ(x) ∈ {2, 4, p}. Hence ℓ(pai i ) ∈ {2p, 4p} ∀i. If ℓ(pai i ) = 4p for some i, we are done by Theorem 5. Otherwise, ℓ(pai i ) = 2p for all i, which implies from (1.2) ℓ(n) = 2p, a contradiction. Hence the result. As a consequence of these results we arrive at the following conclusion. Proposition 4. If q is an odd prime and r ≥ 2, then the following statements are equiva- lent, and they imply that q is a Wall-Sun-Sun prime. (i) qr | Fp. (ii) k(qr) = k(qr−1) = · · · = k(q2) = k(q) = p. (iii) ℓ(qr) = ℓ(qr−1) = · · · = ℓ(q2) = ℓ(q) = 4p. Proof. The above theorems imply that (i), (ii) and (iii) are equivalent. On the other hand, it is well known that q | Fq−( q 5) for all odd primes q, where ( a b ) is the Legendre symbol. Because p is the least index such that q | Fp, we must have p | q − ( q 5) i.e. Fp | Fq−( q 5 ). Hence q2 | qr | Fp | Fq−( q 5 ), so q must be a Wall-Sun-Sun prime, as desired. It should, however, be noted that no prime p has yet been found such that q2 | Fp, and the results obtained above may suggest a possible approach for investigating the existence of such primes. 2 The Range of ℓ In 1913, R. D. Carmichael proved the following theorem: Theorem 7. Every Fibonacci number except F1, F2, F6 and F12 has a prime divisor which does not divide any smaller Fibonacci number. Such prime divisors are called characteristic divisors. Based on this result let us attempt to ﬁnd X, the range of ℓ. Proposition 5. ℓ(2) = 3 is the only odd element of X. Proof. This follows directly from Theorem 2. Proposition 6. 8n + 4 ∈ X for all n. Proof. For n = 1 we have ℓ(8) = 12. Otherwise, let p be a characteristic divisor of F2n+1. Then k(p) = 2n + 1 and from Proposition 3, ℓ(p) = 4(2n + 1) = 8n + 4, as desired. Proposition 7. 4n + 2 ∈ X for all n. Mathematical Reflections 1 (2011) 4 Proof. For n = 1 we have ℓ(4) = 6. Otherwise, let p be a characteristic divisor of F4n+2 = F2n+1L2n+1. Then p | L2n+1 = ϕ2n+1 + (−1/ϕ)2n+1 which implies ϕ 4n+2 ≡ 1 (mod p). Thus ℓ(p) = 4n + 2. Proposition 8. 8n ∈ X for all n. Proof. For n = 3 we have ℓ(6) = 24. Otherwise, let p be a characteristic divisor of F4n = F2nL2n. Then p | L2n = ϕ 2n + (−1/ϕ)2n which implies ϕ 4n ≡ −1 (mod p). Thus ϕ 8n ≡ 1 (mod p) and we conclude that ℓ(p) = 8n. The above results may be summarized into the following theorem: Theorem 8. The elements of X are precisely 3 and all even numbers > 4. 3 Proving Identities In this section we will use the following facts, to prove some identities. For integers a, b, c, d, • a + bϕ = c + dϕ ⇔ a = b and c = d. • (a + bϕ) + (c + dϕ) = e + f ϕ for integers e, f such that e = a + c, f = b + d. • (a + bϕ)(c + dϕ) = k + lϕ for integers k, l such that k = ac + bd, l = ad + bc + bd. • ϕ n = Fnϕ + Fn−1. Identity 1. n∑ i=1 Fn = Fn+2 − 1. (3) Proof. Let Sn = ∑n i=1 Fn. We have ϕ n+1 − 1 ϕ − 1 − 1 = n∑ k=1 ϕ k = n∑ k=1(Fkϕ + Fk−1) = Snϕ + Sn−1. On the other hand, ϕn+1 − 1 = Fn+1ϕ + Fn − 1. Hence Fn+1ϕ + Fn − 1 ϕ − 1 = Snϕ + Sn−1 + 1 ⇔ Fn+1ϕ + Fn = Sn(ϕ 2 − ϕ) + (Sn−1 + 1)ϕ − Sn−1 ⇔ Fn+1ϕ + Fn = (Sn−1 + 1)ϕ + Sn − Sn−1. We conclude that Sn−1 + 1 = Fn+1, as desired. Mathematical Reflections 1 (2011) 5 Identity 2. Fm+n−1 = FmFn + Fm−1Fn−1, or, Fm+n = FmFn+1 + Fm−1Fn. (4) Proof. Because ϕm+n = ϕm · ϕn, we get Fm+nϕ + Fm+n−1 = (Fmϕ + Fm−1)(Fnϕ + Fn−1) = (FmFn + Fm−1Fn + FmFn−1)ϕ + FmFn + Fm−1Fn−1 = (FmFn+1 + Fm−1Fn)ϕ + FmFn + Fm−1Fn−1. Hence (3.2) follows. Identity 3. Fkn+c = n∑ i=0 ( n i ) F i kF n−i k−1 Fc+i. (5) Proof. From ϕ kn+c = (ϕk)n · ϕc, we can write Fkn+cϕ + Fkn+c−1 = (Fkϕ + Fk−1)n · ϕ c = ( n∑ i=0 (n i )F i kϕiF n−i k−1 ) ϕc = n∑ i=0 ( n i ) F i kF n−i k−1 ϕc+i = n∑ i=0 ( n i ) F i kF n−i k−1 (Fc+iϕ + Fc+i−1) = ϕ n∑ i=0 ( n i ) F i kF n−i k−1 Fc+i + n∑ i=0 ( n i ) F i kF n−i k−1 Fc+i−1 Thus Fkn+c = n∑ i=0 ( n i ) F i kF n−i k−1 Fc+i. It is clear that many other identities, can be proven in similar ways and new identities may as well be deduced. Finally, the methods discussed here can easily be generalized to other Fibonacci-like sequences. Mathematical Reflections 1 (2011) 6 References [1] Fibonacci number, http://en.wikipedia.org/wiki/Fibonacci number [2] Pisano period, http://en.wikipedia.org/wiki/Pisano period [3] Pisano period, http://mathworld.wolfram.com/PisanoPeriod.html [4] Carmichael’s theorem, http://en.wikipedia.org/wiki/Carmichael’s theorem [5] D. D. Wall, Fibonacci Series Modulo m, American Mathematical Monthly 67 (1960), 525–532. Samin Riasat University of Dhaka, Bangladesh nayel71@gmail.com Mathematical Reflections 1 (2011) 7","libVersion":"0.3.1","langs":""}
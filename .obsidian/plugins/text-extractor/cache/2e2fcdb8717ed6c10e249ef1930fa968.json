{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/SOS, Quadratics, Vieta Jumping -X - Canada 2010.pdf","text":"2010 IMO Summer Training: Number Theory 1 Week 2: Number Theory - Sum of Squares and Vieta Jumping 1 Primes 1 and 3 (mod 4) The following is an important fact distinguishing primes that are 1 (mod 4) and those that are 3 (mod 4). Theorem 1.1 Let p be a prime. Then x2 ≡ −1 (mod p) has a solution if and only if p = 2 or p ≡ 1 (mod 4). Proof: If p ≡ 1 (mod 4), then let p = 4k + 1. We leave to the reader to prove that (2k!) 2 ≡ −1 (mod p). If p = 2, clearly x = 1 is a solution. If p ≡ 3 (mod 4), then suppose x2 ≡ −1 (mod p). Let p = 4k + 3. Then by Fermat’s Little Theorem, x4k+2 ≡ 1 (mod p). Since x2 ≡ −1 (mod p), x4k+2 ≡ −1 (mod p). Hence, 1 ≡ −1 (mod p), implying that p = 2. Hence, p ̸≡ 3 (mod 4). This is a contradiction. Therefore, x2 ≡ −1 (mod p) has no integer solutions if p ≡ 3 (mod 4). □ Corollary 1.2 Let n be a positive integer. Then n2 + 1 is not divisible by 4 and not divisible by any prime which is 3 (mod 4). Example 1.3 Prove that there are no positive integer solutions to 4ab − a − b = c2. Proof: Suppose a positive integer solution to this equation exists. We can rewrite this equation as 16 − 4a − 4b + 1 = 4c2 + 1, or equivalently, (4a − 1)(4b − 1) = 4c2 + 1. Since a, b ≥ 1, (4a − 1)(4b − 1) contains a prime factor congruent to 3 (mod 4). But 4c2 + 1 cannot have this property. This is a contradiction. □ Exercise: 1. Find all positive integer solutions (x, y) such that x2 = y3 + 23. 1 2010 IMO Summer Training: Number Theory 2 2. Prove that n7 + 7 is not a perfect square for any positive integer n. 3. (IMO 2008) Prove that there are inﬁnitely many positive integers n such that n2 + 1 has a prime divisor greater than 2n + √ 2n. 2 Sum of Squares The goals of this section are: • to demonstrate the Brahmagupta-Fibonacci identity • to determine which integers can be written as the sum of two perfect squares We ﬁrst present the BrahmaguptaFibonacci identity. Theorem 2.1 (a2 + b2)(c2 + d 2) = (ac + bd)2 + (ad − bc) 2. It is important to note that this identity can be written in two diﬀerent ways, i.e. (a2 + b2)(c2 + d 2) = (ac − bd) 2 + (ad + bc) 2. This might come in handy. (*cough* Upcoming Exercise 1 *cough*) Let S = {a2 + b2 | a, b ∈ Z}. Theorem 2.2 1. Let p be a prime number. Then p ∈ S if and only if p = 2 or p ≡ 1 (mod 4). 2. Use the Brahmagupta-Fibonacci identity, prove that if m, n ∈ S, then mn ∈ S. 3. Let p be a prime in S. Prove that m ∈ S if and only if pm ∈ S. Proof: Since x2 ≡ 0, 1 (mod 4) for every integer n, x2 + y2 ̸≡ 3 (mod 4). Therefore, if p ≡ 3 (mod 4), p ̸∈ S. If p = 2, then clearly 2 ∈ S since 2 = 1 2 + 1 2. If p ≡ 1 (mod 4), then there exists a positive integer a such that a2 ≡ −1 (mod 4). Consider all integers of the form ax − y, where x, y are integers such that 0 ≤ x, y < √ p. The number 2 2010 IMO Summer Training: Number Theory 3 of pair of positive integers (x, y) is then (⌊√ p⌋ + 1) 2 > ( √p) 2 = p. By Pigeonhole Principle, there exists integers (x1, y1) ̸= (x2, y2) such that ax1 − y1 ≡ ax2 − y2 (mod p). Then a(x1 − x2) ≡ (y1 − y2) (mod p). Since a2 ≡ −1 (mod p), −(x1 − x2) 2 ≡ (y1 − y2) 2 (mod p). Then (x1 − x2) 2 + (y1 − y2) 2 is divisible by p. Then 0 < (x1 − x2) 2 + (y1 − y2) 2 < 2p. Then (x1 − x2) 2 + (y1 − y2) 2 = p. This proves (1). (2) follows immediately from the BrahmaguptaFibonacci identity. To prove (3), let p = u2 + v2 and pm = x2 + y2. Then m = x2+y2 u2+v2 . But since (ux + vy)2 + (uy − vu) 2 = (u2 + v2)(x2 + y2). Then we get that ( ux + vy u2 + v2 )2 + ( uy − vx u2 + v2 )2 = x2 + y2 u2 + v2 and ( uy + vx u2 + v2 )2 + ( ux − vy u2 + v2 )2 = x2 + y2 u2 + v2 . It now suﬃces to show that p|ux − vy or p|ux + vy. Since this would imply that the terms inside the brackets for at least one of the two equations are all integers. This fact is clear since (ux−vy)(ux+vy) = u2x2 −v2y2 ≡ u 2x2 −(−u2)(−x2) ≡ 0 mod p. Therefore, p|ux−vy or p|ux + vy. □ Exercise 1. Prove that the n is the sum of two perfect squares if and only if every prime p ≡ 3 (mod 4) divides n an even number of times. (Hint: Use the previous theorem.) 2. Let n be a positive integer that can be written as the sum of two perfect squares in two diﬀerent ways. Prove that n is composite. 3. Let f be a polynomial with real coeﬃcients such that f (x) ≥ 0 for all x ∈ R. Prove that there exists g, h ∈ R[x] such that f (x) = g(x) 2 +h(x) 2. (Hint: Factor f completely into polynomials with real coeﬃcients. Each factor is either linear or quadratic. (Why?)) 3 2010 IMO Summer Training: Number Theory 4 4. Find all functions f : R → R such that f (ax + by) + f (ay − bx) = (f (a) + f (b))(f (x) + f (y)) for all a, b, x, y ∈ R. 3 Vieta Jumping Ah the infamous number theory solving technique. If you know of it, great! If not, here it is in its glory. It’s probably best to do this with an example. Exercise 3.1 Let m, n be positive integers such that m 2 + n 2 is divisible by mn + 1. Prove that m2 + n 2 mn + 1 is a perfect square. Proof: Let S = {(m, n) | m 2 + n2 mn + 1 is an integer.} . Note that S is symmetric, i.e. (m, n) ∈ S if and only if (n, m) ∈ S. If m = n, then 2m2 is divisible by m 2 + 1. Since 2m 2/(m 2 + 1) < 2, 2m2 = m 2 + 1. Hence, m = n = 1. Then (m2 + n2)/(mn + 1) is a perfect square. We will now suppose that m ̸= n. Suppose m2 + n2 mn + 1 = k for some positive integer k which is not a perfect square and (m, n) is chosen minimally. Rewriting this gives us m2 − kn · m + (n 2 − k). Then consider the quadratic equation x2 − knx + (n2 − k) = 0. Note that m is one root. Let m ′ be the other root. Since m is an integer, m′ is also an integer. We have m + m ′ = kn, mm′ = n 2 − k. WLOG, suppose m > n. Then since mm ′ = n2 − k, m ′ < m. If m ′ > 0, then (m ′, n) ∈ S, contradicting the minimality of (m, n). If m ′ = 0, then since mm ′ = n2 − k, n2 = k, a perfect square. This contradicts our assumption about k. If m ′ < 0, (m′ + 1)(m + 1) ≤ 0 ⇒ kn + (n2 − k) + 1 ≤ 0 ⇒ k(n − 1) + n2 + 1 ≤ 0. This is also a contradiction. Therefore, k is a perfect square. 4 2010 IMO Summer Training: Number Theory 5 The important ingredients of a Vieta jumping solution are • Setting a set like S in this past exercise. Usually, S is symmetric • Assume some minimality (or maximality) condition on S. • Root-ﬂopping, i.e. if (m, n) ∈ S and m > n, then (m ′, n) ∈ S for some m′ < n. Then (n, m ′) ∈ S and we repeat. The minimality condition on S will somehow be violated. Note: Sometimes ﬁnding the quadratic equation for which to set up the Vieta jumping re- quires some work beforehand. Sometimes the quadratic equation is practically given to you. Please practice the following problems to become familiar with this powerful technique. Exercises 1. Find all pairs of positive integers (a, b) such that a2 + b2 + 1 ab is an integer. 2. Find all pairs of positive (a, b) such that a | b2 + 1, b | a2 + 1. 3. (Romania 2005) Find all quadruples of positive integers (a, b, m, n) such that ambn = (a + b) 2 + 1. 4. (IMO 2007) Let a, b be positive integers such that 4ab − 1 | (4a2 − 1)2. Prove that a = b. 5. (Ireland 2005) Let m, n be integers with the same parity such that m 2 − n2 + 1 divides n2 − 1. Prove that m2 − n 2 + 1 is a perfect square. 6. (IMO 1981) Find all pairs of positive integers (a, b) such that 1 ≤ a, b ≤ 1000 and (a2 − ab − b2) 2 = 1. 5","libVersion":"0.3.1","langs":""}
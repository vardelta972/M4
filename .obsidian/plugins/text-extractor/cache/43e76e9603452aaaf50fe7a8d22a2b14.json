{"path":"iCloudDrive/bks/Combinatorics/Combinatorics/Algebraic Combinatorics - Po-Shen-Loh - MOP 2008.pdf","text":"Algebraic Methods in Combinatorics Po-Shen Loh 27 June 2008 1 Warm-up 1. (A result of Bourbaki on ﬁnite geometries, from R˘azvan) Let X be a ﬁnite set, and let F be a family of distinct proper subsets of X. Suppose that for every pair of distinct elements in X, there is a unique member of F which contains both elements. Prove that |F| ≥ |X|. Solution: Let X = [n] and F = {A1, . . . , Am}. We need to show that n ≤ m. Deﬁne the m × n incidence matrix A over R by putting 1 in the i-th row and j-th column if j ∈ Ai. Consider the product AT A, which is an n × n matrix. For i ̸= j, its entry at (i, j) is precisely 1. Also, the diagonal entries are strictly larger than 1, because if some element j ∈ X belongs to only one set Ak ∈ F, then the condition implies that every element i ∈ X is also in Ak, contradicting requirement that Ak be proper. Therefore, AT A is nonsingular by Lemma 1, hence rank(AT A) = n. But rank(AT A) ≤ rank(A) ≤ m, so we are done. 2 Combinatorics of sets We begin with a technical lemma. Lemma 1 Let A be a square matrix over R, for which all non-diagonal entries are all equal to some t ≥ 0, and all diagonal entries are strictly greater than t. Then A is nonsingular. Proof. Let J be the all-ones square matrix, and let D = tJ − A. Note that D is nonzero only on the diagonal, and in fact strictly positive there, so it is a positive deﬁnite matrix. Also, J is well-known to be positive semideﬁnite (easy to verify by hand), so A is positive deﬁnite, hence nonsingular. □ Now try the following problems. The last two come from 102 Combinatorial Problems, by T. Andreescu and Z. Feng. 1. (Fisher’s inequality) Let C = {A1, . . . , Ar} be a collection of distinct subsets of {1, . . . , n} such that every pairwise intersection Ai ∩ Aj (i ̸= j) has size t, where t is some ﬁxed integer between 1 and n inclusive. Prove that |C| ≤ n. Solution: Consider the n × r matrix A, where the i-th column of A is the characteristic vector of Ai. Then, AT A is a r × r matrix, all of whose oﬀ-diagonal entries are t. We claim that the diagonal entries are all > t. Indeed, if there were some |Ai| which were exactly t, then the structure of C must look like a “ﬂower,” with one set Aj of size t, and all other sets fully containing Aj and disjointly partitioning the elements of [n] \\ Aj among them. Any such construction has size at most 1 + (n − t) ≤ n, so we would already be done. Therefore, AT A is nonsingular by Lemma 1, hence rank(AT A) = r. But rank(AT A) ≤ rank(A) ≤ n, so we are done. 1 2. Let A1, . . . , Ar be a collection of distinct subsets of {1, . . . , n} such that all |Ai| are even, and also all |Ai ∩ Aj| are even for i ̸= j. How big can r be, in terms of n? Solution: Arbitrarily cluster [n] into pairs, possibly with one element left over. Then take all possible subsets where we never separate the pairs; this gives r up to 2 ⌊n/2⌋. But this is also best possible. Suppose that S is the set of characteristic vectors of the sets in the extremal example. The condition translates into S being self-orthogonal. But S ⊥ S ⇒ ⟨S⟩ ⊥ ⟨S⟩, so extremality implies that S is in fact an entire linear subspace, which is self-orthogonal (i.e., S ⊂ S⊥). We have the general fact that for any linear subspace, dim S⊥ = n − dim S. This is because if d = dim S, we can pick a basis v1, . . . , vd of S, and write them as the rows of a matrix A. Then, the kernel of A is precisely S⊥, but any kernel has dimension equal to n minus the dimension of the row space (d). Therefore, S ⊂ S⊥ implies that dim S ≤ dim S⊥ = n − dim S, which forces dim S ≤ ⌊n/2⌋, so we are done. 3. What happens in the previous problem if we instead require that all |Ai| are odd? We still maintain that all |Ai ∩ Aj| are even for i ̸= j. Solution: Answer: r ≤ n. Work over F2. The characteristic vectors vi of the Ai are orthonormal1, so they are linearly independent: given any dependence relation of the form ∑ civi = 0, we can dot product both sides with vk and conclude that ck = 0. Thus, there can only be ≤ n of them. ALTERNATE: Let A be the n × r matrix where the columns are the characteristic vectors of the Ai. Then AT A equals the r × r identity matrix, which is of course of full rank r. Thus r = rank(AT A) ≤ rank(A) ≤ n. 4. Prove that if all codegrees2 in a simple graph on n vertices are odd, then n is also odd. Solution: First we show that all degrees are even. Let v be an arbitrary vertex. All vertices w ∈ N (v) have odd codegree with v, which means they all have odd degree in the graph induced by N (v). Since the number of odd-degree vertices in any graph must always be even, we immediately ﬁnd that |N (v)| is even, as desired. Let A be the adjacency matrix. Then AT A = J − I. But consider right-multiplying by 1. A1 = 0 ⇒ AT A1 = 0 and I1 = 1, so we need to have J1 = 1, which implies that n is odd. ALTERNATE ENDING: Now, let S = {1, v1, . . . , vn} be the set of n + 1 vectors in Fn 2 where 1 is the all-ones vector and vi is the characteristic vector of the neighborhood of the i-th vertex. There must be some nontrivial linear dependence b1 + ∑ i aivi = 0. But note that if we take the inner product of this equation with vk, we obtain ∑ i̸=k ai = 0 because 1 · vk = 0 = vk · vk and vi · vk = 1 for i ̸= k. Hence all the ai are equal. Yet if they are all zero, then b is also forced to be zero, contradicting the nontriviality of this linear combination. Therefore, all ai are 1, and the equation ∑ i̸=k ai = 0 forces n − 1 to be even, and n to be odd. 5. (Introductory Problem 38) There are 2n people at a party. Each person has an even number of friends at the party. (Here, friendship is a mutual relationship.) Prove that there are two people who have an even number of common friends at the party. Solution: Let A be adjacency matrix. Suppose for contradiction that every pair of people has an odd number of common friends. Then over F2, we have AT A = J − I, where J is the all-ones matrix and I is the identity. Since all degrees even, A1 = 0. Hence AT A1 = 0. But J1 = 0 because J is a 2n × 2n matrix, and I1 = 1. Thus we have 0 = AT A1 = (J − I)1 = 1, contradiction. 6. (Advanced Problem 49) A set T is called even if it has an even number of elements. Let n be a positive even integer, and let S1, . . . , Sn be even subsets of the set {1, . . . , n}. Prove that there exist some i ̸= j such that Si ∩ Sj is even. 1Strictly speaking, this is not true, because there is no positive deﬁnite inner product over F2. However, if one carries out the typical proof that orthonormality implies linear independence, it still works with the mod-2 dot product. 2The codegree of a pair of vertices is the number of vertices that are adjacent to both of them. 2 Solution: Let A be n × n matrix over F2 with columns that are the characteristic vectors of the Si. Then AT A = J − I. A is singular because AT 1 = 0, so det AT A = (det A) 2 = 0. However, det(J − I) is precisely the parity of Dn, the number of derangements of [n]. It remains to prove that for even n, Dn is odd. But this follows from the well-known recursion Dn = (n − 1)(Dn−1 + Dn−2), which can be veriﬁed by looking at where the element n is permuted to. 3 Solution spaces Suppose we have a system of equations over some ﬁeld F, e.g. 3x1 + x2 − 8x3 = 1 9x1 − x2 − x3 = 2 The set of ordered triples (x1, x2, x3) that solve the system is precisely the set of 3-element vectors x ∈ F3 that solve the matrix equation Ax = [ 1 2 ] , where A = [ 3 1 −8 9 −1 −1 ] . When A is an m × n matrix and y is an m-element vector, the solution set of Ax = y is closely related to the following concept. Deﬁnition 1 A nonempty subset S of the vector space Fn is called a linear subspace if it is closed under both scalar multiplication and vector addition. (i.e., x ∈ S, c ∈ F ⇒ c · x ∈ S, and x, y ∈ S ⇒ x + y ∈ S.) When the right hand side (y) consists of all zeros, Ax = 0 is called a homogeneous system, and it is easy to prove the following theorem straight from the above deﬁnition. Check it. Theorem 1 (Homogeneous systems) Let A be an m × n matrix over any ﬁeld F, and let 0 be the m-element all-zero vector. Then the solution set of the system Ax = 0 is a linear subspace of Fn. It is also easy to generalize this result to inhomogeneous systems. Theorem 2 (General systems) Let A be an m × n matrix over any ﬁeld F, and let y be an m-element vector in Fm Then the solution set of the system Ax = y is either: • empty, or • has the form x0 + S, where x0 is a single n-element vector which solves Ax0 = y, and S is the linear subspace of Fn which is the solution set of the matrix equation Ax = 0. Linear subspaces have very restrictive properties. Deﬁnition 2 Let S be a linear subspace of Fn, and let B = {v1, . . . , vt} be a set of vectors in S. • If there are no nontrivial 3 linear combinations ∑ i ci · vi that equal 0 (with ci ∈ F), then we say that B is linearly independent. • If every vector x ∈ S can be expressed as a linear combination ∑ i ci · vi = x with all ci ∈ F, then we say that B spans S. • If B has both of the above properties, then we say that B is a basis of S. Note that a basis need not be unique (in fact, it never is). Theorem 3 Every linear subspace S of Fn has a basis. Furthermore, every basis of S has the same cardinality. This cardinality is called the dimension of S. 3Nontrivial means that (c1, . . . , ct) ̸= (0, . . . , 0). 3 The above theorem is not trivial (though not hard) to prove, so the reader should instead establish the following useful corollary. Corollary 1 Let F be a ﬁnite ﬁeld, and let S be a d-dimensional subspace of Fn. Then the cardinality of S must be precisely |F| d. In particular, every matrix equation Ax = y over F has either zero solutions, or exactly |F| d solutions for some integer d ≥ 0. Now try these problems. 1. (R˘azvan and Titu’s Putnam and Beyond, #238) We have n coins of unknown masses and a balance. We are allowed to place some of the coins on one side of the balance and an equal number of coins on the other side. After thus distributing the coins, the balance gives a comparison of the total mass of each side, either by indicating that the two masses are equal or by indicating that a particular side is the more massive of the two. Show that at least n − 1 such comparisons are required to determine whether all of the coins are of equal mass. Solution: Suppose there was a sequence of n − 2 comparisons, after which the operator was able to conclude that the coins were all of equal mass. Note that since we are required to put an equal number of coins on each side, the operator could only conclude that all masses were equal if every weighing was an equality. Therefore, if we let {xi} be the masses of the coins, the operator must have seen a sequence of n − 2 equations of the form x1 + x5 + x7 = x2 + x8 + x9. However, this has a 2-dimensional solution space. Therefore, it is impossible to conclude that the coins all must have equal weight, because that corresponds to the conclusion that the system has solution space spanned by the vector of all ones. 2. (USAMO 2008/6). At a certain mathematical conference, every pair of mathematicians are either friends or strangers. At mealtime, every participant eats in one of two large dining rooms. Each mathematician insists upon eating in a room which contains an even number of his or her friends. We need to prove that the number of ways that the mathematicians may be split between the two rooms is a power of two (i.e., is of the form 2 k for some positive integer k). Reduce the problem to showing that there exists at least 1 way to do this. Solution: Let there be n vertices in the graph, called {1, 2, . . . , n}. Represent a partition as a vector (x1, x2, . . . , xn) over the ﬁnite ﬁeld F2, where the value of xi (which is either 0 or 1) tells whether it is in V0 or V1, respectively. The even-degree condition boils down to the following system of equations. For each vertex i: • if its degree in G is even, write down the equation: ∑ j∼i xj = 0; • if its degree in G is odd, write down the equation: xi + ∑ j∼i xj = 1. (Here, “j ∼ i” means that vertices j and i were adjacent in G.) One can verify that a partition is valid IFF its corresponding vector satisﬁes the above system of n equations. So, if there is just at least 1 valid partition at all, then linear algebra tells us that the number of solutions is some 2 k, since all nonempty subspaces of Fn 2 have cardinality a power of 2. Remark. The Gallai Cycle-Cocycle Partition Theorem (c.f. Exercise 1.35 in Graph Theory by R. Diestel) states that The vertex set of any graph can be partitioned into two (possibly empty) sets such that each set induces a subgraph with all degrees even. This precisely implies that there is at least one way to split the mathematicians, completing the solution to USAMO 2008/6. We will prove this theorem in the next section. 4 4 But how do I know the solution space is nonempty? Unfortunately, one of the possibilities in Theorem 2 is that there are no solutions at all. There is a clean way to verify that a solution exists when the ﬁnite ﬁeld is F2. Luckily, that is essentially the only ﬁeld that arises in Olympiad combinatorics problems! Theorem 4 Let A be an m × n matrix over F2, and let 1 be the m-element all-ones vector in Fm 2 . Then the matrix equation Ax = 1 has no solution if and only if: • There is an odd number of row vectors in A whose sum (over F2) is the zero vector. Proof. The “if” direction is obvious, because the sum of the equations corresponding to those special row vectors would yield 0 on the LHS, while the RHS would be 1, because the sum of an odd number of 1’s is 1. For the “only if” direction, suppose that the bulleted condition is not fulﬁlled; we will show that there is a solution. Apply Gaussian Elimination, reducing the matrix [ A, 1 ] to row-reduced-echelon form. Note that this process replaces every row by a linear combination of the original rows. However, over F2, linear combinations are simply sums of selected rows, because the only scalars are {0, 1}. By our assumption, this process will never create a row that looks like [0, . . . , 0, 1], which is the only obstruction to the existence of a solution. Therefore, a solution exists. □ To familiarize yourself with the proof of the previous theorem, follow the same argument to prove the following slight generalization. Theorem 5 Let A be an m × n matrix over F2, and let y be an m-element vector in Fm 2 . Then the matrix equation Ax = y has no solution if and only if: • There is a collection of row vectors in A, an odd number of which have corresponding entries in y that are 1’s, whose sum (over F2) is the zero vector. Now try these problems. 1. (Iran 1997/4) Let A be a matrix of zeroes and ones which is symmetric (Aij = Aji for all i, j) such that Aii = 1 for all i. Show that there exists a subset of the rows whose sum is a vector all of whose components are odd. Solution: Let a selection correspond to a vector x over F2. A valid selection is a solution of AT x = 1, which is the same as Ax = 1 since A is symmetric. Consider an odd collection of rows, say indexed by {r1, . . . , rt}. Create the t-vertex graph G with adjacency matrix corresponding to the indices {r1, . . . , rt}, but not putting loops on each vertex (as would have been required since all Aii = 1). We need to show that the sum of this odd collection of rows is nonzero. But suppose it is zero. Then, since each Ariri = 1, the graph G must have all degrees odd. However, G also has an odd number of vertices, which is impossible! Therefore, Theorem 4 ensures that there is a solution. 2. (Odd-parity covers, by Sutner) Suppose that each of the vertices of a simple graph is equipped with an indicator light and a button. Each vertex’s button simultaneously toggles the states of all of its neighbors, as well as its own state. Initially, all lights are oﬀ. Prove that it is possible to turn on all of the lights. Solution: This is exactly the previous problem, where A is the adjacency matrix plus the identity matrix. 3. (Does not use linear algebra) Show that the previous exercise implies the Gallai Cycle-Cocycle Partition Theorem, stated at the end of the previous section. Hint: for every vertex v of even degree, attach a brand new vertex v′ which is adjacent only to it. Solution: Now all degrees are odd, hence all sets N (v) ∪ {v} are even, and so if X is an odd-parity cover, then X c is also an odd-parity cover. Immediately, we have that all degrees within each X and X c are even, but there are extra vertices, so we need to show that deleting the extra vertices keeps all degrees even. 5 But every special pair {v, v′} as introduced above must be separated by any odd-parity cover, because v′ has degree exactly 1. Therefore, if we restrict both of X and X c to the original vertex set (simply discarding the new vertices v′), all degrees will still be even. 4. (Russia 1997/40) An n × n × n cube is divided into unit cubes. We are given a closed non-self-intersecting polygon (in space), each of whose sides joins the centers of two unit cubes sharing a common face. The faces of unit cubes which intersect the polygon are said to be distinguished. Prove that the edges of the unit cubes may be colored in two colors so that each distinguished face has an odd number of edges of each color, while each nondistinguished face has an even number of edges of each color. Solution: One equation per face. Look for solution over F2. Turns out that linear combination of rows amounts to taking a cycle-sum of elementary 4-loops. If we have 2 loops in sum, their sum is a loop, and its winding number (mod 2) around the special polygon is the sum of the winding numbers of the summands. Odd number of distinguished rows in linear combination means that winding number should be odd, therefore cannot have linear combination of zero! 5 More linear algebra problems 1. (IMO Shortlist 1998/C2, but standard result) Suppose we have an m×n rectangular array of real numbers, with the property that every row sum and every column sum is an integer. Prove that it is possible to round up or down each entry to obtain an array of integers with each row and column sum the same as it was before. Solution: Given an instance of this problem, assume that we have done as many roundings as possible to reduce the number of non-integers. Suppose there are still some non-integers left. Ignore all rows that already are completely integers, and also for columns. WLOG, we are left with an m × n matrix where each row/column still has ≥ 1 (hence ≥ 2) non-integers. Write m + n equations for the sums of the rows and columns, using unknowns for the non-integers. At least 2 unknowns per row/column, so at least max(2m, 2n) ≥ m + n unknowns. But there is 1 trivial dependence between the m + n equations: by double-counting, sum of all m row equations equals sum of all n column equations. So we have more unknowns than equations, hence a nontrivial linear space of solutions (there was at least one solution by the given conﬁguration). So we may “push” the solution so that one entry hits the next integer, contradicting minimality. 2. (R˘azvan and Titu’s Putnam and Beyond, #247) There are given 2n + 1 real numbers, n ≥ 1, with the property that whenever one of them is removed, the remaining 2n can be split into two sets of n elements that have the same sum of elements. Prove that all the numbers are equal. 3. (Alon-Spencer, exercise 2.3) Recall that we proved the following result of Erd˝os in my Probabilistic Meth- ods lecture: A set S is called sum-free if there is no triple of (not necessarily distinct) elements x, y, z ∈ S satisfying x + y = z. Then every set A of nonzero integers contains a subset S ⊂ A of size |S| > |A|/3 which is sum-free. Now prove the generalization of the above result in which the elements of A are allowed to be nonzero real numbers. Solution: We reduce to the integer result, but noting that our previous proof could be trivially generalized to multisets. Let our given set A be {x1, . . . , xn}. Some of these satisfy relations, e.g., xi + xj = xk. Collect all of these relations and write them down as a system of equations. Clearly, this system has a nontrivial solution over R, because it was given as A! But the system has only rational coeﬃcients, so if we forget that the xi mean anything, there will also be a solution over Q, and in fact all in Z by clearing the denominators. Let A′ be the new set corresponding 6 to those ﬁnal values x ′ i, and apply the integer result to A′. If we end up keeping x ′ i1, . . . , x ′ ir , then we deﬁne S = {xi1, . . . , xir }. A The language of linear algebra • The rank of a matrix is its the number of linearly independent columns. This is always equal to the number of linearly independent rows. Fact: the rank of the product of two matrices is ≤ the rank of either matrix, because the columns of the product AB are linear combinations of the columns of A, hence column space can only shrink, etc. • A square matrix A is singular if the equation Ax = 0 has a nontrivial solution. Otherwise, it is nonsin- gular. • A set of vectors is orthogonal if their pairwise dot products are zero. Fact: if the vectors also have nonzero dot product with themself, then the collection is linearly independent. • A square matrix A is positive semideﬁnite if x T Ax is ≥ 0 for all vectors x. If in addition we also know that the only way to get = 0 above is by using the 0 vector for x, then we say that A is positive deﬁnite. Fact: every positive deﬁnite matrix is nonsingular, because if we have some x ̸= 0 with Ax = 0, then of course x T Ax = 0, contradicting positive deﬁniteness. 7","libVersion":"0.3.1","langs":""}
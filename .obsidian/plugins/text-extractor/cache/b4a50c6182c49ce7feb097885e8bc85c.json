{"path":"iCloudDrive/bks/Combinatorics/Combinatorics/Graph Theory 2 - Po-Shen Loh - MOP (Red-Blue) 2009.pdf","text":"Graph Theory II Po-Shen Loh June 2009 1 Warm-up 1. Let n be odd. Partition the edge set of Kn into n matchings with n−1 2 edges each. Solution: Spread the n vertices around a circle. Take parallel classes. 2. Let n be even. Partition the edge set of Kn into n − 1 matchings with n 2 edges each. Solution: Spread n − 1 vertices around a circle, and let the ﬁnal vertex be the origin. Take parallel classes, along with the orthogonal radius from the origin. 3. (Bondy 1.5.9.) There are n points in the plane such that every pair of points has distance ≥ 1. Show that there are at most 3n (unordered) pairs of points that span distance exactly 1 each. Solution: The unit-distance graph is planar. If there are 2 crossing unit-distance edges, then the triangle inequality implies that some pair of points is at distance strictly less than 1. 2 Matching Consider a bipartite graph G = (V, E) with partition V = A ∪ B. A matching is a collection of edges which have no endpoints in common. We say that A has a perfect matching to B if there is a matching which hits every vertex in A. Theorem. (Hall’s Marriage Theorem) For any set S ⊂ A, let N (S) denote the set of vertices (necessarily in B) which are adjacent to at least one vertex in S. Then, A has a perfect matching to B if and only if |N (S)| ≥ |S| for every S ⊂ A. This has traditionally been called the “marriage” theorem because of the possible interpretation of edges as “acceptable” pairings, with the objective of maximizing the number of pairings. In real life, however, perhaps there may be varying degrees of “acceptability.” This may be formalized by giving each vertex (in both parts) an ordering of its incident edges. Then, a matching M is called unstable if there is an edge e = ab ̸∈ M for which both a and b both prefer the edge e to their current partner (according to M ). Theorem. (Stable Marriage Theorem) A stable matching always exists, for every bipartite graph and every collection of preference orderings. Now try these problems. 1. Let G be a bipartite graph with all degrees equal to k. Show that G has a perfect matching. Solution: Fix any set X, and consider N (X). The number of edges coming out of X is exactly k|X|, but each vertex in N (X) can only absorb ≤ k many of them. So |N (X)| ≥ |X|, and we have Hall’s condition. 1 2. (J. Hirata.) Suppose that a regular deck of 52 playing cards has been dealt into 13 piles of 4 cards each. Show that there is a way to select one card from each pile, such that you have one card from every rank (ace, 2, . . . , king). Solution: Consider the bipartite graph where LHS corresponds to the 13 piles, and RHS corresponds to the 13 ranks. Put an edge from a pile to a rank if the pile contains at least one card of that rank. At ﬁrst this appears to be a special case of the previous problem with k = 4, but now we have a problem of multiple edges: a pile might be all kings, for example. However, the same argument works. For the purpose of bookkeeping only, write weights on the edges. If there are two aces in a pile, for example, let the corresponding edge have weight 2. We will still search for a perfect matching in the usual sense (disregarding weights). Fix some set X from LHS, and count the total weight emanating from it to N (X). This is exactly 4|X|. Again, each guy in N (X) can absorb only ≤ 4 of this weight, so we again have |N (X)| ≥ |X|. 3. Let A be a square n × n matrix of nonnegative integers, in which each row and column sum up to the positive integer m. Prove that A can be expressed as a sum of m permutation matrices A = P1 +· · · Pm. Here, a permutation matrix is an n × n matrix of zeros and ones, such that each row contains a single “1”, and each column contains a single “1.” Solution: Pull out permutation matrices inductively via Hall’s theorem. LHS is the rows, RHS is the columns, and there is an edge between i on the LHS and j on the RHS if aij, the (i, j) entry of A, is > 0. Actually, write the number aij next to that edge. For any subset S of the LHS, note that the sum of all numbers on edges coming out of S is precisely m|S|. But those edges are a subset of the edges coming out of N (S), so their sum is ≤ m|N (S)|. Thus |N (S)| ≥ |S| for any S. 4. (Gale-Shapley stable marriage protocol.) Suppose there are equal numbers of men and women, and each person ranks the opposite group according to preference. A series of rounds ensue. In each round: • Every currently-not-engaged man simultaneously proposes to the top choice among those remain- ing on his list. • Then each woman compares her incoming proposals to the person she is currently engaged to. She selects the best of these (possibly dumping her current engagement), and is now engaged to the new person. • All rejected men permanently remove the corresponding women from their list. Show that when this process terminates, everybody has gotten married. Next, show that the resulting marriage is stable. Solution: First observe that if a woman is ever proposed to, then she will be married at the end of the procedure, because men can never break engagements. Now suppose for contradiction that after the entire protocol, some man M is still unmarried. Since there were equal numbers of men and women, there is also an unmarried woman W . At some point, M should have proposed to W . But we started by showing that if W was ever proposed to by anybody, she should end up married, contradicting the fact that W is still not married. Next, we show that this marriage is stable. For contradiction, suppose there are some M and W who are not married to each other, but M actually prefers W over his current wife W ′, and W actually prefers M over her current husband M ′. In that case, M should have proposed to W before proposing to W ′, but must have been rejected by W . But women only improve their matches throughout this procedure, so this implies that W actually prefers her current M ′ over M , contradiction. 5. (Turkey 1998/4.) To n people are to be assigned n diﬀerent houses. Each person ranks the houses in some order (with no ties). After the assignment is made, it is observed that every other assignment 2 assigns at least one person to a house that person ranked lower than in the given assignment. Prove that at least one person received his/her top choice in the given assignment. Solution: This proof is similar to the existence of a stable marriage. Pick a guy, call it x1, free up his assignment (call it y0), and steal his top pick, call that y1. But now somebody, say x2, lost their assignment. If x2’s top assignment was y0, then everyone would be happier if x2 just took y0 now. That would be a contradiction. So, x2 has a top pick somewhere, say y2. Note that y2 ̸= y1 or else x2 was already assigned to his favorite. Steal that from, say, x3, and repeat. We never will end up with any xi having y0 as his top pick, or else we immediately have improved everybody. But then at some point we will loop since everything is ﬁnite. This means that some xt will have stolen some yk which we had previously reassigned to some xk. That’s ﬁne—undo all reassignments of x1 through xk, so that they will match back to their original y0 through yk−1. We now have a perfect matching again, but everybody from xk+1 through xt in fact improved all the way up to their top choice, contradiction. 6. (Diestel 2.7.) Let S = {1, 2, . . . , kn}, and suppose A1, . . . , An and B1, . . . , Bn are both partitions of S into n sets of size k. Then there exists a set T of size n such that every intersection T ∩ Ai and T ∩ Bi has cardinality exactly 1. Solution: Let the LHS have n vertices corresponding to the Aj, and the RHS have n vertices corresponding to the Bj. Consider any i ∈ S. Since we have two partitions, i is in exactly one A-set and exactly one B-set. Say they were Aa and Bb. Then, put an edge between the corresponding vertices in the graph, and label it with i. Note that any perfect matching will give a set T : just let T be the collection of the labels of the edges in the matching. To see that it exists, consider any subset S of LHS, and note that since all sets have size exactly k, the number of edges coming out of S is precisely k|S|. But this is a subset of the edges coming out of N (S), so k|S| ≤ k|N (S)|, done. 3 Planarity When we represent graphs by drawing them in the plane, we draw edges as curves, permitting intersections. If a graph has the property that it can be drawn in the plane without any intersecting edges, then it is called planar. Here is the tip of the iceberg. One of the most famous results on planar graphs is the Four-Color Theorem, which says that every planar graph can be properly colored using only four colors. But perhaps the most useful planarity theorem in Olympiad problems is the Euler Formula, which is the ﬁrst item below. Try these problems. 1. (Euler Formula.) Every connected planar graph satisﬁes V − E + F = 2, where V is the number of vertices, E is the number of edges, and F is the number of faces. You may assume that the curves which connect pairs of vertices are piecewise-linear. Solution: Actually prove that V − E + F = 1 + C, where C is the number of connected components. Each connecting curve is piecewise-linear, and if we add vertices at the corners, this will keep V − E invariant. Now we have a planar graph where all connecting curves are straight line segments. Then induction on E + V . True when E = 0, because F = 1 and V = C. If there is a leaf (vertex of degree 1), delete both the vertex and its single incident edge, and V − E remains invariant. If there are no leaves, then every edge is part of a cycle. Delete an arbitrary edge, and that will drop E by 1, but also drop F by 1 because the edge was part of a cycle boundary, and now that has merged two previously distinct faces. 3 2. If G is a planar graph, then E ≤ 3V . Solution: Break into connected components. Special case is the components with only 1 or 2 vertices, but still true in those cases. Otherwise, for each face, calculate its perimeter, and add all of these up. This double-counts each edge. Each face has perimeter ≥ 3, so we get 2E ≥ 3F . Plugging in, we have 2 = V − E + F ≤ V − E + 2 3 E = V − 1 3 E. 3. Every planar graph contains a vertex of degree at most 5. Solution: Actually use the bound E ≤ 3V − 6 for V ≥ 3, and if V ≤ 2 it is trivial. 4. Show that K5 is not planar. Solution: V = 5, E = 10, so we must have F = 2 − V + E = 7. But as in the previous solution, we need to have 2E ≥ 3F , which is not the case. 5. Show that K3,3 is not planar. Solution: V = 6, E = 9, so we must have F = 2 − V + E = 5. But as in the previous solution, we need to have 2E ≥ 3F . Actually, we need 2E ≥ 4F , because K3,3 has no triangles. But this stronger inequality is false. 6. Show that K4,4 is not planar. Solution: K4,4 contains K3,3. 4 Harder problems Since the level appears to vary widely, especially in the Blue group, this section collects more challenging questions to work on if you are ahead during lecture. 1. (Petersen’s Theorem.) Let G be a graph with all degrees equal to 2k. Show that one can select a subset F of edges such that every vertex of G is incident to exactly 2 edges in F . Solution: Take an Eulerian tour of G. Now duplicate each vertex v into v− and v+. If the Eulerian tour goes −→uw, then put an edge from u− to w+. This makes a bipartite graph G(2) with all degrees exactly k, so there is a perfect matching. Collapsing each {v+, v−}, we get a 2-factor of the original G. 2. (Optimality in Stable marriage protocol.) Let there be equal numbers of men and women. We know that a stable marriage exists. For each man, let his realm of possiblity be the set of all women that he could be married to, going over all stable marriages. Say that his optimal mate is his favorite choice from his realm of possibility, and his pessimal mate is his least-favorite choice from his realm of possibility. Deﬁne these things similarly for each woman. According to the Gale-Shapley protocol, men have the ﬁrst choice in proposing, but can often be rejected because women have the ﬁnal say in everything. So does anybody have an advantage? Decide whether men or women always get their optimal or pessimal mates according to this protocol. Solution: We ﬁrst show that men always get their optimal mate. Proceed by contradiction, and suppose that M is the ﬁrst man to be rejected by his optimal mate W . Rejection means that W selected some other M ′ who had proposed to her at the same time or earlier. First also means that M ′ was not yet rejected by his optimal mate, which means that he prefers W at least as much as his optimal mate. Since W is M ’s optimal mate, there is some stable marriage that has them married, and this must have M ′ married to some W ′. But now M ′W would rather get married. Indeed, we said above that 4 W prefers M ′ over M , and also that W was at least as good as M ′’s optimal mate. But optimal mate is the best over all stable marriages, so W is also at least as good as W ′. Since W ̸= W ′ and there are no ties in preference lists, M ′ actually prefers W over W ′, and this contradicts stability. Next we show that male-optimality implies that every woman gets her pessimal mate. Consider some woman W , and suppose that the male-optimal protocol pairs her with M . Now consider any other stable marriage in which W is paired with someone else, say M ′, and M must also be paired with someone else, say W ′. It suﬃces to show that W prefers M ′ over M . By male-optimality of the ﬁrst protocol, M must prefer W over W ′. But we supposed this was a stable marriage, so W must prefer her current mate (M ′) over M . This completes the proof. 3. (Dirac’s Theorem.) Let G be a graph on n vertices with all degrees at least n/2. Show that G has a Hamiltonian cycle. Solution: Suppose the longest path has t vertices x1, . . . , xt. We will show there is a cycle of t vertices as well. Suppose not. All neighbors of x1 and xt must lie on the path or else it is not longest. Minimum degree condition implies that both have degree ≥ t/2. But if x1 ∼ xk, then xt ̸∼ xk−1 or else we can re-route to get a cycle. So, each of x1’s t/2 neighbors on the path prohibit a potential neighbor of xt. Yet xt’s neighbors come from indices 1 . . . t − 1, so there is not enough space for xt to have t/2 neighbors there, avoiding the prohibited ones. Now if this longest path is not the full n vertices, then we get a cycle C missing some vertex x. But min-degree n/2 implies that the graph is connected (smallest connected component is n/2+1), so there is a shortest path from x to C, and adding this to the cycle gives a longer path than t, contradiction. 4. (St. Petersburg 1997/13.) The sides of a convex polyhedron are all triangles. At least 5 edges meet at each vertex, and no two vertices of degree 5 are connected by an edge. Prove that this polyhedron has a face whose vertices have degree 5, 6, 6, respectively. Solution: By Euler, E ≤ 3V − 6, so in particular the sum of degrees is less than 6V . We will use this for a contradiction. Suppose there are no 5,6,6 faces. We will count the number of edges which connect vertices of degree 5 to vertices of degree ≥ 7. Let xi be the number of vertices of degree i for each i. No 5,6,6 implies that each 5-vertex has at most 2 neighbors of degree 6, thus it contributes 3 edges which cross from degree 5 to degree ≥ 7. On the other hand, any vertex of degree d has at most ⌊d/2⌋ neighbors of degree 5 because no two degree-5 guys are adjacent. Thus, double-counting gives: 3x5 ≤ ∑ d=7 xd · ⌊ d 2 ⌋ x5 ≤ ∑ d=7 xd · 1 3 ⌊ d 2 ⌋ . Note that for d ≥ 7, the cumbersome expression satisﬁes ⌊d/2⌋/3 ≥ d − 6. Adding to the LHS so that it becomes 6 times the number of vertices: x5 ≤ ∑ d=7 xd · (d − 6) 6x5 + 6x6 + ∑ d=7 6xd ≤ 5x5 + 6x6 + ∑ d=7 xd · d. Recognize the LHS as 6V and the RHS as sum of degrees, and this contradicts our opening observation. 5. (BAMO 2005/4.) There are 1000 cities in the country of Euleria, and some pairs of cities are linked by dirt roads. It is possible to get from any city to any other city by traveling along these roads. Prove 5 that the government of Euleria may pave some of the roads so that every city will have an odd number of paved roads leading out of it. Solution: The key is that 1000 is even. Reduce to the case when the graph is a spanning tree. (One can do breadth-ﬁrst-search, for example.) Take a leaf and its parent v, and pave the edge between them. Delete both vertices, and let the connected components of the remainder be C1, . . . , Ck. Note that since we only deleted 2 vertices, the sum of all remaining component sizes is still even, so the number of odd components is even. We are going to induct into each component, but for this we need all components to be even. For each odd component, add back a copy of v with an edge in the same place it used to be, so that now it is an even graph (but indeed still smaller than the original graph, by at least 1 vertex). Inductively solve every component, and observe that the artiﬁcial v’s get odd numbers of paved edges an even number of times, since there was an even number of odd components. So still the ﬁnal v gets an odd number of paved edges because of the inital paving. 6. (IMO Shortlist 2004/C3.) The following operation is allowed on a ﬁnite graph: Choose an arbitrary cycle of length 4 (if there is any), choose an arbitrary edge in that cycle, and delete it from the graph. For a ﬁxed integer n ≥ 4, ﬁnd the least number of edges of a graph that can be obtained by repeated applications of this operation from a complete graph on n vertices (where each pair of vertices are joined by an edge). Solution: First we show that we cannot end up with any graph with ≤ n − 1 edges. We are only breaking cycles, so we cannot destroy connectivity. Therefore, any ﬁnal graph with ≤ n − 1 edges must have exactly n − 1 edges, and be a tree, hence bipartite. But if we consider the reverse process, observe that if we start from a bipartite graph and complete C4’s, we will stay bipartite, and Kn is not bipartite! It remains to ﬁnd an n-edge graph that we can reach. I think one such graph is a triangle plus a single path leading out of one of the vertices of the triangle. See if you can prove this. 6","libVersion":"0.3.1","langs":""}
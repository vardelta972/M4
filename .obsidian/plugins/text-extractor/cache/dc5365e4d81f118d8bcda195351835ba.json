{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Orders Modulo a Prime - Evan Chen - X.pdf","text":"Orders Modulo A Prime Evan Chen March 6, 2015 In this article I develop the notion of the order of an element modulo n, and use it to prove the famous n2 + 1 lemma as well as a generalization to arbitrary cyclotomic polynomials. References used in preparing this article are included in the last page. 1 Introduction I might as well state one of the main results of this article up front, so the following discussion seems a little more motivated. Theorem 1.1 Let p be an odd prime. Then there exists an integer n such that p | n2 + 1 if and only if p ≡ 1 (mod 4). By introducing the notion of order, we will prove that p | n2 + 1 ⇒ p ≡ 1 (mod 4). By introducing the notion of a primitive root, we will prove the converse direction. Finally, we will write down the generalized version of this n2 + 1 lemma using cyclotomic polynomials. 2 Orders Let p be a prime and take a ̸≡ 0 (mod p). The order1 of a (mod p) is deﬁned to be the smallest positive integer m such that am ≡ 1 (mod p). This order is clearly ﬁnite because Fermat’s Little Theorem tells us a p−1 ≡ 1 (mod p), id est, the order of a is at most p − 1. Exhibited below are the orders of each a (mod 11) and a (mod 13). a mod 11 mod 13 1 1 1 2 10 12 3 5 3 4 5 6 5 5 4 6 10 12 a mod 11 mod 13 7 10 12 8 10 4 9 5 3 10 2 6 11 12 12 2 1Some sources denote this as ord a (mod p) or ordp a, but we will not. 1 Evan Chen 3 Primitive Roots One observation you might make about this is that it seems that the orders all divide p − 1. Obviously if m | p − 1, then ap−1 ≡ 1 (mod p) as well. The miracle of orders is that the converse of this statement is true in an even more general fashion. Theorem 2.1 (Fundamental Theorem of Orders) Suppose aN ≡ 1 (mod p). Then the order of a (mod p) divides N . Proof. Important exercise (mandatory if you haven’t seen it before). As a hint, use the division algorithm. To drive the point home: The only time when aN ≡ 1 (mod p) is when the order of a divides N . That’s why considering the order of an element is often a good idea when faced with such an expression. The observation that the orders all divide p − 1 follows from combining Fermat’s Little Theorem with Theorem 2.1. Believe it or not, this is already enough to prove one direction of Theorem 1.1. Proposition 2.2 For an odd prime p, if n2 ≡ −1 (mod p), then p ≡ 1 (mod 4). Proof. The point is that squaring both sides gives n4 ≡ 1 (mod p). Now we claim that the order of n modulo p is exactly 4. If not, it must be either 2 or 1, which implies n2 ≡ 1 (mod p). But since we assumed n2 ≡ −1 (mod p), that’s impossible. Hence the order is 4. Since all orders divide p − 1, we derive 4 | p − 1 as desired. Remark. Theorem 2.1 (and much of the discussion preceding it) still holds if we replace the prime p with any positive integer n such that gcd(a, n) = 1. In that case we replace p − 1 with just ϕ(n). 3 Primitive Roots Now we want to prove the other direction of this. The morally correct way to do so is to use something called a primitive root. Theorem 3.1 Let p be a prime. Then there exists an integer g, called a primitive root, such that the order of g modulo p equals p − 1. This theorem can be quoted on a contest without proof. Its proof is one of the practice problems. The point of this theorem is that given a primitive root g, each nonzero residue modulo p can be expressed uniquely by gα, for α = 1, 2, . . . , p − 1. Exercise 3.2. Suppose p = 2m + 1. Verify that gm ≡ −1 (mod p). (If you get stuck, try reading the rest of this section ﬁrst.) 2 Evan Chen 3 Primitive Roots Example 3.3 (Primitive Roots Modulo 11 and 13) It turns out that g = 2 is a primitive root modulo both 11 and 13. Let’s write this out. 2n mod 11 mod 13 21 2 2 22 4 4 23 8 8 24 5 3 25 10 6 26 9 12 27 7 11 28 3 9 29 6 5 210 1 10 211 7 212 1 I’ve boxed the two “half-way” points: 25 ≡ 10 ≡ −1 (mod 11) and 26 ≡ 12 ≡ −1 (mod 13). Consider p = 11. We already know that −1 cannot be a square modulo p, and you can intuitively see this come through: since p−1 2 = 5 is odd, it’s not possible to cut g5 ≡ −1 into a perfect square. On the other hand, if p = 13 then p ≡ 1 (mod 4), and you can see intuitively why g6 ≡ −1 is a perfect square: just write g6 = (g3)2 and we’re home free! See if you can use this to complete the proof of the other direction of this theo- rem. Proposition 3.4 If p ≡ 1 (mod 4) is a prime, then there exists an n such that n2 ≡ −1 (mod p). Proof. Let g be a primitive root modulo p and let n = g p−1 4 . Why does this work? I had better also state the general theorem. Theorem 3.5 (Primitive Roots Modulo Non-Primes) A primitive root modulo n is an integer g with gcd(g, n) = 1 such that g has order ϕ(n). Then a primitive root mod n exists if and only if n = 2, n = 4, n = pk or n = 2pk, where p is an odd prime. Exercise 3.6. Show that primitive roots don’t exist modulo any number of the form pq for distinct odd primes p, q. (Use the Chinese Remainder Theorem to show that xlcm(p−1,q−1) ≡ 1 for suitable x). You are invited to extend the result of this exercise to prove that if n /∈ {2, 4, pk, 2pk} then no primitive roots exists modulo n. (This is not diﬃcult, just a little annoying.) 3 Evan Chen 4 The Cyclotomic Generalization 4 The Cyclotomic Generalization So we’ve seen the polynomial x2 + 1 is somehow pretty special, in part because it divides x4 − 1 and thus lets us use the idea of orders. You might also have seen the polynomials x2 + x + 1 and x2 − x + 1 show up in some problems; they divide x3 − 1 and x3 + 1, respectively, and you might suspect similar results might hold. Our goal now is to develop a more general result involving the irreducible factors of xn − 1, thus taking us beyond just the case n = 4. The deﬁnition is a little technical, so bear with me for a little bit. Deﬁnition 4.1. A complex number z is called a primitive nth root of unity if zn = 1 and moreover zk ̸= 1 for k = 1, 2, . . . , n − 1. In other words, zn is the ﬁrst power which is 1. Exercise 4.2. Let n be a ﬁxed integer, and deﬁne ζn = cos ( 2π n ) + i sin ( 2π n ) . Show that the primitive nth roots of unity are exactly the numbers cos ( 2πk n ) + i sin ( 2πk n ) = ζ k n where 1 ≤ k ≤ n, and gcd(k, n) = 1. In particular, the number of primitive nth roots of unity is ϕ(n). Note that in particular, 1 is considered a primitive nth root of unity only when n = 1. You can thus see these numbers visually on the complex plane. For example, below we exhibit the primitive 9th roots of unity, of which there are ϕ(9) = 6. Im Re0 ζ 1 9 ζ 2 9 ζ 4 9 ζ 5 9 ζ 7 9 ζ 8 9 Deﬁnition 4.3. The nth cyclotomic polynomial is the monic polynomial Φn(x) whose roots are exactly the primitive nth roots of unity; that is, Φn(X) = ∏ gcd(k,n)=1 1≤k≤n (X − ζ k) . 4 Evan Chen 4 The Cyclotomic Generalization Example 4.4 Because the primitive fourth roots of unity are i and −i, we have Φ4(X) = (X − i)(X + i) = X 2 + 1. One can actually show Φn(X) always has integer coeﬃcients. (In fact, it’s the polynomial of minimal degree with this property.) Proposition 4.5 (Cyclotomic Polynomials Divide X n − 1) For any integer n, we have X n − 1 = ∏ d|n Φd(X). In particular, if p is a prime then Φp(X) = X p − 1 X − 1 = X p−1 + X p−2 + · · · + 1. Exercise 4.6. Prove this result. (If you don’t see why, do the case n = 4 ﬁrst.) Example 4.7 To write this lemma out explicitly for the cases 2 ≤ n ≤ 8: X 2 − 1 = (X − 1)(X + 1) X 3 − 1 = (X − 1)(X 2 + X + 1) X 4 − 1 = (X − 1)(X + 1)(X 2 + 1) X 5 − 1 = (X − 1)(X 4 + X 3 + X 2 + X + 1) X 6 − 1 = (X − 1)(X + 1)(X 2 + X + 1)(X 2 − X + 1) X 7 − 1 = (X − 1)(X 6 + X 5 + X 4 + X 3 + X 2 + X + 1) X 8 − 1 = (X − 1)(X + 1)(X 2 + 1)(X 4 + 1) We observe a “new” polynomial appearing at each level; these are the cyclotomic polynomials. Φ2(X) = X + 1 Φ3(X) = X 2 + X + 1 Φ4(X) = X 2 + 1 Φ5(X) = X 4 + X 3 + X 2 + X + 1 Φ6(X) = X 2 − X + 1 Φ7(X) = X 6 + X 5 + · · · + 1 Φ8(X) = X 4 + 1 Why is all of this in a number theory handout? Because of this: 5 Evan Chen 5 Example Problems Theorem 4.8 (Divisors of Cyclotomic Values) Let p be a prime, n a positive integer and a any integer. Suppose that Φn(a) ≡ 0 (mod p). Then either • a has order n modulo p, and hence p ≡ 1 (mod n), or • p divides n. Remark 4.9 (How to Remember This Theorem). You can kind of see why this should not be too surprising. The idea is that Φn is the polynomial which annihilates complex numbers of “order” n. So you might expect modulo p, Φn kills the integers which are of order n, and in particular that p ≡ 1 (mod n) if any such integers exist. This theorem says that, except for the few “edge cases” where p | n, this intuition is right. Proof. Suppose Φn(a) ≡ 0 (mod p). By Proposition 4.5, we deduce that an − 1 ≡ 0 (mod p). So the order m of a (mod p) divides n. Thus, we have two cases. • If m = n, we are done: n = m | p − 1. • Suppose m < n (but still m | n). Now, 0 ≡ a m − 1 = ∏ d|m Φd(a) (mod p). Hence, not only do we have Φn(a) = 0, but we also have Φd(a) = 0 for some d | m. (Here d ≤ m < n.) Thus a is a double root of the polynomial X n − 1 = ∏ d|n Φd(X) (mod p). So we can take the derivative of this polynomial modulo p to obtain nX n−1 (mod p), without changing the fact that a is a root. If p | n this is in fact the zero polynomial and we are done. But if p ∤ n then we can only have a ≡ 0 (mod p) (what else is a root of X n−1?), which is impossible. So in fact, Theorem 1.1 is just the n = 4 case of Theorem 4.8! 5 Example Problems Example 5.1 (MOP 2011) Let p be a prime and n a positive integer. Suppose that p1 fully divides 2n − 1 (meaning it is divisible by p but not p2). Prove that p1 fully divides 2p−1 − 1. Solution. Obviously p ̸= 2, so assume p is odd. 6 Evan Chen 5 Example Problems Naturally, we consider the order of 2 modulo p; denote this number by m (so p | 2m−1). We automatically know that m divides both n and p − 1. From m | n we derive that p | 2m − 1 | 2 n − 1. Now note that 2n − 1 has exactly one power of p in its prime factorization. Hence from the above we can deduce that 2m − 1 has exactly one power of p as well (it has at least one since p | 2m − 1 and at most one since it divides 2n − 1). In this way we’ve eliminated n entirely from the problem. So it remains to show that, if p1 divides 2m − 1, then 2p−1 − 1 does not gain any prime factors of p. So we consider the quotient 2p−1 − 1 2m − 1 = 1 + 2m + (2m) 2 + · · · + (2m) p−1 m −1 . Our goal is to show this isn’t divisible by p. Taking it modulo p, however, we get 2p−1 − 1 2m − 1 ≡ 1 + 1 + · · · + 1| {z } p−1 m terms = p − 1 m (mod p) Since 0 < p−1 m < p, the conclusion follows. If you really understand the above example, you have my permission to look up the so-called “Lifting the Exponent” lemma, which you may ﬁnd useful in the practice problems. The reason I don’t include it here is that I ﬁnd many students commit the result to memory without actually understanding the proof of the lemma. Actually, the proof of the lemma is extremely natural, and if you understand the above solution you should not have much diﬃculty proving the lemma yourself. Speciﬁcally, you need only check that • If a ≡ b ̸≡ 0 (mod p) and p ∤ n, then an−bn a−b ̸≡ 0 (mod p), and • If p | t and a ̸≡ 0 (mod p) then p fully divides 1 t ((a + t)p − ap). Once you can prove this, you immediately obtain the following. Lemma 5.2 (Lifting the Exponent) Let p be an odd prime and let νp(n) be the exponent of p in the prime factorization of n. If a ≡ b ̸≡ 0 (mod p) then νp(an − bn) = νp(n) + νp(a − b). On many olympiad problems, one only needs a particular case of this lemma (e.g. νp(n) = 0) and it is completely reasonable to re-derive that special case on the spot. This is exactly what I did in MOP 2011. Example 5.3 (Folklore) Find all positive integers n such that n divides 2n − 1. Solution. As you might guess after some experimentation, the only n which works is n = 1. It’s obvious that n has to be odd (since 2n − 1 is always odd). But how can we show this? Let us ﬁrst consider any prime p dividing n. We get that p | 2n −1, or 2n ≡ 1 (mod p). So practically the problem is saying that 7 Evan Chen 6 Practice Problems For any prime p | n, the order of 2 mod p also divides n. (If we’re really unlucky, we might have to consider prime powers too, but whatever.) This gives us an idea: let’s take the smallest prime p dividing n (noting that p > 2). Let m denote the order of 2 modulo p (keeping in mind that p ̸= 2). Then the order m has to divide n, but it also has to divide p − 1. This can only occur if m = 1, which is impossible! The above solution illustrates a trick perhaps worth mentioning explicitly. Lemma 5.4 (GCD Trick) If am ≡ 1 (mod N ) and an ≡ 1 (mod N ) then agcd(m,n) ≡ 1 (mod N ). This is just the famous fact that gcd(am − 1, an − 1) = agcd(m,n) − 1 phrased using modular arithmetic. Finally, here is a fun and perhaps somewhat unexpected application of cyclotomic polynomials. In fact, you may have seen the special case n = 4 already; now that we have the full cyclotomic generalization we can prove a much more general fact. Example 5.5 (Weak Dirichlet) Show that there are inﬁnitely many primes which are congruent to 1 modulo n for any positive integer n. Solution. Suppose there were only ﬁnitely many such primes p1, p2, . . . , pN . Look at the number M = Φn(np1p2 . . . pN ). As a polynomial, Φn(X) has roots which are all roots of unity (meaning they have norm 1), so its constant term can only be ±1. Now take p dividing M , and apply Theorem 4.8. 6 Practice Problems Not all of the problems below actually invoke the concept of order in the solution. However, the intuition about how exponents behave should nonetheless prove useful (hopefully). Problem 6.1. The decimal representations of 1 7 , 2 7 , . . . , 6 7 are 0.142857, 0.285714, . . . , 0.857142, which surprisingly are all cyclic shifts of each other. Is this a coincidence? Problem 6.2 (Euler). Prove that all factors of 22n + 1 are of the form k · 2n+1 + 1. Problem 6.3 (IMO 2005/4). Determine all positive integers relatively prime to all terms of the inﬁnite sequence an = 2n + 3n + 6n − 1 for n ≥ 1. Problem 6.4. Let n be a positive integer and p > n + 1 a prime. Prove that p divides 1n + 2n + · · · + (p − 1) n. 8 Evan Chen 6 Practice Problems Problem 6.5 (China TST 2006). Find all positive integers a and n such that (a + 1)n − an n is an integer. Problem 6.6 (Romania TST 1996). Find all primes p and q such that for every integer n, the number n3pq − n is divisible by 3pq. Problem 6.7 (HMMT November 2014). Determine all positive integers 1 ≤ m ≤ 50 for which there exists an integer n for which m divides nn+1 + 1. Problem 6.8 (Taiwan IMO 2014 Team Selection Quiz). Alice and Bob play the fol- lowing game. They alternate selecting distinct nonzero digits (from 1 to 9) until they have chosen seven such digits, and then consider the resulting seven-digit number (i.e. A1B2A3B4A6B6A7). Alice wins if and only if the resulting number is the last seven decimal digits of some perfect seventh power. Please determine which player has the winning strategy. Problem 6.9 (Shortlist 2006 N5). Show that x7 − 1 x − 1 = y5 − 1 doesn’t have integer solutions. Problem 6.10 (IMO 1990/3). Find all positive integers n such that n2 divides 2n + 1. Problem 6.11. Let p > 5 be a prime. In terms of p, compute the remainder when p−1∏ m=1 (m2 + 1) is divided by p. Problem 6.12 (Online Math Open). Find all integers m with 1 ≤ m ≤ 300 such that for any integer n with n ≥ 2, if 2013m divides nn − 1 then 2013m also divides n − 1. Problem 6.13 (Shortlist 2012 N2). Find all positive integers x ≤ y ≤ z which obey x3(y3 + z3) = 2012(xyz + 2). Problem 6.14 (USA TST 2008). Prove that n7 +7 is never a perfect square for positive integers n. Problem 6.15 (USAMO 2013/5). Let m and n be positive integers. Prove that there exists an integer c such that cm and cn have the same nonzero decimal digits. Problem 6.16 (IMO 2003/6). Let p be a prime number. Prove that there exists a prime number q such that for every integer n, the number np − p is not divisible by q. Problem 6.17. Prove that modulo any prime p there exists a primitive root! 9 Evan Chen References 7 Hints 6.1. 10 is a primitive root modulo 7. 6.2. It’s suﬃcient to prove the result when m is prime. Find the order of 2. 6.3. Try to pick n = −1. 6.4. Eradicated by primitive roots. 6.5. What happens when a = 1? Mimic the example. 6.6. First show {3, p, q} are distinct. Then use primitive roots modulo p and q to get some divisibility relations, and ﬁnish by bounding. 6.7. All odd m work. For the other cases, use the n2 + 1 lemma. 6.8. Primitive roots exist modulo prime powers. This is a fairly dumb game and Alice wins. (Also, don’t forget the word “distinct”.) 6.9. The left-hand side is the seventh cyclotomic polynomial. 6.10. Use the smallest prime trick, but this time p = 3 is a possibility. Use lifting the exponent to eliminate it. 6.11. Evaluate the polynomial ∏p−1 m=1(X + m) carefully mod p, and plug in X = ±i. 6.12. Call a number good if nn ≡ 1 (mod m) ⇒ n ≡ 1 (mod m). Characterize all good numbers. (For example, why is 10 good?) 6.13. This problem is a little involved. First limit the possible values of x. Then try and show 503 | y + z. Set y + z = 503k and do some bounding. 6.14. Add 121 to both sides. 6.15. 10 (mod 7k). 6.16. For this to work we must have q = pk + 1. Then np ≡ p ⇔ 1 ≡ pk. See if you can pick a q such that p has order r modulo q but k ̸≡ 1 (mod r), where r is a prime of your choice. 6.17. From [4]: Consider the cyclotomic polynomial Φp−1(X) | X p−1 − 1. Show that it factors completely modulo p, and pick any root. References [1] Exponents and Primes, by Alexander Remorov, Canada IMO 2010 Winter Train- ing. [2] Order and Primitive Roots, Canada IMO 2010 Summer Training. [3] Exponents in Number Theory, Evan Chen, 2014 A* Winter Math Camp. [4] Cyclotomic Polynomials in Olympiad Number Theory, Lawrence Sun. [5] Elementary Properties of Cyclotomic Polynomials, Yimin Ge. [6] Lifting the Exponent, Amir Hossein. 10","libVersion":"0.3.1","langs":""}
{"path":"iCloudDrive/bks/Inequalities/Inequalities/Techniques and Tricks/Lagrange Multipliers - Evan Chen - X.pdf","text":"Lagrange Murderpliers Done Correctly Evan Chen June 8, 2014 The aim of this handout is to provide a mathematically complete treatise on Lagrange Multipliers and how to apply them on optimization problems. The ideas here are presented logically rather than pedagogically, so it may be beneﬁcial to read the examples before the formal statements. Lagrange multipliers oﬀer a way to ﬁnd the extrema of an objective function f (x1, x2, . . . , xn) subject to a constraint function g(x1, x2, . . . , xn) = 0; for example, we may wish to maximize a + b + c subject to a2 + b2 + c2 = 1. However, there are lots of tiny details that need to be checked in order to completely solve a problem with Lagrange multipliers. On an olympiad the use of Lagrange multi- pliers is almost certain to draw the wrath of graders, so it is imperative that all these details are done correctly. 1 Analysis Preliminaries First, we need to deﬁne several terms. Let R denote the set of real numbers, and let Rn denote the set of n-tuples of real numbers; that is, n-dimensional Euclidean space. Deﬁnition 1.1. A neighborhood of a point p ∈ Rn is some set of points of the form {x ∈ Rn | d(x, p) < ε} where d(x, y) denotes the distance between two points, and ε is a positive real number. In other words, a neighborhood is just a “sphere” with nonzero radius ε. Now, we need to introduce some deﬁnitions from real analysis. Deﬁnition 1.2. A subset S of Rn is open in Rn if for every point p ∈ S, there exists a neighborhood of p completely contained inside S. p D Figure 1: The open disk D is open. 1 Evan Chen 1 Analysis Preliminaries Example. In R2, the open disk D = { (x, y) | x2 + y2 < 1} is open because for every point p inside it, we can ﬁnd a small neighborhood completely inside the disk. See Figure 1, noting that D does not contain its “boundary”. Similarly, the open interval (0, 1) is open in R. Deﬁnition 1.3. A subset S of Rn is closed in Rn if the following holds: if x1, x2, . . . , is a sequence of points in S which converges to some limit x, then x ∈ S. An equivalent deﬁnition is that Rn \\ S should be open. Example 1.4. The closed disk D = {(x, y) | x2 + y2 ≤ 1 } is closed. Similarly, the closed interval [0, 1] is closed in R (meaning: if a convergent sequence of reals is between 0 and 1 inclusive, then it must converge to a real number between 0 and 1 inclusive). And now you know why open and closed intervals are so called! Note that most sets are neither open nor closed in Rn, and some sets are both open and closed (such as ∅, the empty set, as well as the entire Rn). Remark. Up to now we have been k¨osher in saying that a set S is closed in Rn, this is important because a set is only open or closed relative to its parent. However, we will henceforth drop the clause “in Rn” for brevity. To aid with constructing closed and open sets, we have the following nice statements. Proposition 1.5. Let S and T be sets in Rn. If S and T are both open (resp. closed), then S ∪ T and S ∩ T are also both open (resp. closed). Proposition 1.6. Let S ⊆ Rm and T ⊆ Rn. If S and T are both open (resp. closed), then S × T is open (resp. closed) in Rm+n. You may also have noticed by now that open and closed sets seem to diﬀer by a “boundary”. We can formalize this with the notion of a closure. Deﬁnition 1.7. Given a set U , the closure of U is the smallest closed set containing U . One can prove that U is closed. I’ve cheated here with the notion of “smallest”; one can prove that “smallest by inclusion” works out. In practice, for Rn this just means e.g. adding in the boundary points back into an open set. Finally, we need one other notion, called compactness. Deﬁnition 1.8. A subset S of Rn is bounded if it can be contained inside an n-sphere of ﬁnite radius. If it is also closed, we say S is compact. The actual deﬁnition of compactness is that given any arbitrary sequence in S, we can ﬁnd a sub-sequence which converges. However, in the special case where S ⊆ Rn, these are equivalent. Example 1.9. Consider a rectangular box B = [0, 1] × [0, 2] × [0, 3] in R3. We can see that it is both closed and bounded, so it is compact. 2 Evan Chen 2 Lagrange Multipliers 2 Lagrange Multipliers We can give the statement of the theorem of Lagrange Multipliers. Theorem 2.1 (Lagrange Multipliers). Let U be an open subset of Rn, and let f : U → R and g : U → R be continuous functions with continuous ﬁrst derivatives. Deﬁne the constraint set S = {x ∈ U | g(x) = c} for some real number c. Suppose x ∈ S is a local maximum of f , meaning for some neighborhood around x the point x gives the maximal value of all points in S. Then either ∇g(x) = 0 at this point, or for some real number λ, ∇f (x) = λ∇g(x). (Note that we only discuss maximums; to ﬁnd minimums simply consider −f .) This is ﬁne and well, but it does not tell us anything about the global maximum of f constrained to g. Indeed, such a global maximum may not even exist! That means there is still tons of work left to ﬁnd the maximum value of f , if indeed it exists. The following two lemmas let us save face. Lemma 2.2. Let S be a compact set and f : U → R be a continuous function. Then f has a global maximum over S – there exists a point x ∈ S such that f (x) ≥ f (y) for any other point y ∈ S. Lemma 2.3. If g : Rn → R is a continuous function, then the set C = {x ∈ Rn | g(x) = c} is a closed set for any real number c. Hence, we can escape using the following method. Let’s take our function f : U → R with U open, and consider the closure U of U . Let’s instead optimize f : U → Rn, where U is the closure of U . Deﬁne C = {x ∈ R n | g(x) = c} . Note that C is closed by our lemma. Also, deﬁne S = U ∩ C = {x ∈ U | g(x) = c} as well as S = U ∩ C = {x ∈ U | g(x) = c } . As the notation suggests, S is the closure of S, and in any case is clearly itself closed. If either of C or U is bounded, then so is S, meaning S is compact! When that occurs, f achieves a maximum x ∈ S somewhere on the set C ∩ U . We can then consider two cases. • If x ∈ U − U , that is, x lies in the “boundary”, then we can check this case manually. • If x ∈ U , that is, x lies in the “interior”, then we can use Lagrange multipliers. After all, x is a global maximum, so it is certainly a local one as well. Here the constraint set is simply S = C ∩ U . This is the method of Lagrange multipliers. 3 Evan Chen 3 Examples 3 Examples 3.1 An Easy Example Example 3.1 (AM-GM). For positive reals a, b, c, prove that a + b + c ≥ 3 3√abc. Solution. The ﬁrst step is de-homogenizing the inequality to assume that a + b + c = 3, in which case we wish to prove abc ≤ 1. Thus, deﬁne f (a, b, c) = abc and g(a, b, c) = a + b + c. Note that ∇g = ⟨1, 1, 1⟩ ̸= 0 at all points, and moreover that f and g are continuous with continuous partial derivatives. We will let U = (0, 3)3, U = [0, 3]3 (meaning we will actually prove the inequality for all a, b, c ≥ 0). Note that U is bounded, so the constraint set S = {x ∈ U : g(x) = 3 } is compact. Hence, it achieves a maximum value, say x. If x lies on the boundary, then at least one component of x is zero, whence abc = 0; this is clearly not a maximum. Otherwise, let x = (a, b, c). By Lagrange multipliers, we know ∇f (a, b, c) = λ∇g(a, b, c) or ⟨bc, ca, ab⟩ = λ ⟨1, 1, 1⟩ . That is, bc = ca = ab = λ. If λ = 0, then a = b = c = 0, and f is zero at such points. Otherwise, we conclude that a = b = c. Since a + b + c = 3, we must have a = b = c = 1. Hence f (1, 1, 1) = 1. We ﬁnd that the critical point yielding the largest value on S is (1, 1, 1), which gives f (1, 1, 1) = 1. This must be a maximum, and hence f (a, b, c) ≤ 1 for all a + b + c = 3, 0 ≤ a, b, c ≤ 3, as desired. 3.2 A Hard Example Now we try a much bloodier example. Example 3.2 (USAMO 2001/3). Let a, b, c be nonnegative reals with a2+b2+c2+abc = 4. Prove that 0 ≤ ab + bc + ca − abc ≤ 2. Solution. The left-hand side of the inequality is trivial; just note that min {a, b, c} ≤ 1. Hence, we focus on the right side. We use Lagrange Multipliers. Deﬁne U = {(a, b, c) | a, b, c > 0 and a2 + b 2 + c 2 < 1000 } . This is an intersection of open sets, so it is open. Its closure is U = {(a, b, c) | a, b, c ≥ 0 and a2 + b 2 + c 2 ≤ 1000 } . 4 Evan Chen 3 Examples Hence the constraint set S = {x ∈ U : g(x) = 4 } is compact, where g(a, b, c) = a2 + b2 + c2 + abc. Excellent. Deﬁne f (a, b, c) = a 2 + b 2 + c 2 + ab + bc + ca. It’s equivalent to show that f ≤ 6 subject to g. Over S, it must achieve a global maximum. Now we consider two cases. If x lies on the boundary, that means one of the components is zero (since a2 +b2 +c2 = 1000 is clearly impossible). WLOG c = 0, then we wish to show a2 + b2 + ab ≤ 6 for a2 + b2 = 4, which is trivial. Now for the interior U , we may use the method of Lagrange Multipliers. Consider a local maximum x ∈ U . Compute ∇f = ⟨2a + b + c, 2b + c + a, 2c + a + b⟩ and ∇g = ⟨2a + bc, 2b + ca, 2c + ab⟩ . Of course, ∇g ̸= 0 everywhere, so introducing our multiplier yields ⟨2a + b + c, a + 2b + c, a + b + 2c⟩ = λ ⟨2a + bc, 2b + ca, 2c + ab⟩ . Note that λ ̸= 0 since a, b, c > 0. Subtracting 2a + b + c = λ(2a + bc) from a + 2b + c = λ(2b + ca) implies that (a − b)([2λ − 1] − λc) = 0. We can derive similar equations for the others. Hence, we have three cases. Case 1: If a = b = c, then a = b = c = 1, and this satisﬁes f (1, 1, 1) ≤ 6. Case 2: If a, b, c are pairwise distinct, then we derive a = b = c = 2 − λ−1, contradic- tion. Case 3: Now suppose that a = b ̸= c. That means λ = 1 2−c (of course our conditions force c < 2). Now 2a + 2c = a + b + 2c = λ(2c + ab) = 1 2 − c (2c + a 2) which implies 4a + 4c − 2a2 − 2ac = 2c + a2 meaning (with the additional note that a ̸= 1) we have c = 3a2 − 4a 2 − 2a . Note that at this point, c > 0 forces 1 < a < 4 3 . The constraint a2 + b2 + c2 + abc = 4 ⇔ c2 + +a2c + (2a2 − 4) = 0 now gives (3a2 − 4a )2 + a 2 (3a2 − 4a ) (2 − 2a) + (2a 2 − 4) (2 − 2a) 2 = 0. Before expanding this, it is prudent to see if it has any rational roots. A quick inspection ﬁnds that a = 2 is such a root (precisely, 16 − 32 + 16 = 0). Now, we can expand and try to factor: 0 = −6a 5 + 31a 4 − 48a 3 + 8a2 + 32a − 16 = (a − 2)(−6a4 + 19a3 − 10a2 − 12a + 8) = (a − 2) 2 (−6a3 + 7a 2 + 4a − 4) 5 Evan Chen 3 Examples Seeing a cubic, we desperately try every rational root and miraculously discover = (a − 2) 2(2 − 3a)(2a2 − a − 2). The only root a in the interval (1, 4 3 ) is a = 1 4 (1 + √17 ). You can guess what comes next – write c = a(3a − 4) 2 − 2a = 1 8 (7 − √17 ) and f (a, b, c) = 3a2 + 2ac + c 2 = 1 32 (121 + 17√17 ) . This is the last critical point, so we’re done once we check this is less than 6. This follows from the inequality 173 < (6 · 32 − 121)2; in fact, we actually have 1 32 (121 + 17√17 ) ≈ 5.97165. This completes the solution. 3.3 A Non-Example The following is not actually an example because you get stuck at the end (and it turns out you must get stuck, as I explain), but I included it because of popular request. Example 3.3 (USAMO 2014/1). Let w, x, y, z be real numbers satisfying wx + xy + yz + zx + wy + xz ≥ 5 + wxyz. Prove that (w2 + 1)(x 2 + 1)(y2 + 1)(z2 + 1) ≥ 16. Non-Solution. By scaling appropriately, we can assume our condition is actually an equality. Moreover, we will only prove the inequality in the case where w2 + x2 + y2 + z2 ≤ 1000 since the conclusion is obvious otherwise. Deﬁne f (w, x, y, z) = ∑ cyc ln(w2 + 1) and g(w, x, y, z) = wx + xy + yz + zx + wy + xz − wxyz − 5 where we have U = {(w, x, y, z) | w2 + x2 + y2 + z2 < 1000 } an open ball, whence U = { (w, x, y, z) | w2 + x2 + y2 + z2 ≤ 1000} is a closed ball, which is compact. First, we need to check that ∇g ̸= 0. Compute ∂g ∂w = x + y + z − xyz. 6 Evan Chen 3 Examples If it is the case that all of these are zero, we will derive a contradiction. This would imply that wx + wy + wz = wxyz. Cyclically adding we get 2(5 + wxyz) = 4wxyz, whence wxyz = 5. That means w(x + y + z) = 5 so each of w, x, y, z are the nonzero roots of the quadratic t2 − (w + x + y + z)t + 5 = 0, and so they take on at most two distinct values. Now we consider a few cases. If w = x = y = z then from w(x + y + z) = 5 we must have them all equal to ± √5/3, contradicting wxyz = 5. If x = y = z but w ̸= x, then w + x = w + x + y + z ⇒ y + z = 0, so y = z = 0 which is impossible. Finally, if w = x and y = z but w ̸= y then w + y = 2(w + y), whence w = −y. Now we can derive 5 = w(x + y + z) = −w2, which is impossible. So, ∇g ̸= 0 everywhere. Now, the extrema on the boundary of U trivially satisfy the inequality, so we only need consider the interior. Evidently we have a λ with 2w w2 + 1 = λ(x + y + z − xyz). If λ = 0 then w = x = y = z = 0, which contradicts the given. Otherwise, λ ̸= 0 whence wxyz ̸= 0. If we let s = w + x + y + z and d = wxy + xyz + yzx + zxw then we can rearrange this as 2 λ = ( 1 w + w) (x + y + z − xyz) = w + x + y + z − xyz w − 1 + w(x + y + z) − wxyz = s w − 1 + 5 − (xy + yz + zx) 2 λ − 4 = s − (wxy + wyz + wzx + xyz) w = s − d w . Hence we have two cases. Either λ = 1 2 and s = d, or w = x = y = z = s − d 2/λ − 4 In the latter case, we obtain 6w2 = w4 + 5, which implies that the constant values are one of ±1, ± √5. Check that none of these cases give f (w, x, y, z) < 16. Otherwise, we derive that w + x + y + z = wxy + xyz + yzw + zwx (1) AT this point we have used all the constraints. That means Lagrange Multipliers is telling us that any point (w, x, y, z) which also satisﬁes (1) is possibly a local extrema; in other words, one can check that any x satisfying (1) and wx+xy+yz +zx+wy+xz = 5+wxyz also satisﬁes ∇f (x) = λ∇g(x). Unfortunately, you can’t go farther than this because it turns out that (1) is precisely the equality condition of the original problem. Boo. The end. 7 Evan Chen 4 Practice Problems 4 Practice Problems 1. (USAMO 1978/1) Given that a, b, c, d, e are real numbers such that a + b + c + d + e = 8 a2 + b 2 + c 2 + d 2 + e 2 = 16, determine the minimum value of e. 2. (Mock Inequalities USAMO) Let a, b, c, d be nonnegative real numbers such that a + b + c + d = 4. Prove that 3(a2 + b2 + c2 + d2) + 4abcd ≥ 16. 3. (MOP 2012) Given that a + b + c + d = 4 for positive reals a, b, c, d, prove that 1 a2 + 1 b2 + 1 c2 + 1 d2 ≥ a 2 + b 2 + c 2 + d 2. 4. (Canada 1999/5) Prove that for nonnegative real numbers a, b, c with a + b + c = 1 we have a2b + b 2c + c 2a ≤ 4 27 . 8","libVersion":"0.3.1","langs":""}
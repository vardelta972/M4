{"path":"iCloudDrive/bks/Number Theory/Some Notes/n-sato_numbertheory.pdf","text":"Number Theory Naoki Sato <sato@artofproblemsolving.com> 0 Preface This set of notes on number theory was originally written in 1995 for students at the IMO level. It covers the basic background material that an IMO student should be familiar with. This text is meant to be a reference, and not a replacement but rather a supplement to a number theory textbook; several are given at the back. Proofs are given when appropriate, or when they illustrate some insight or important idea. The problems are culled from various sources, many from actual contests and olympiads, and in general are very diﬃcult. The author welcomes any corrections or suggestions. 1 Divisibility For integers a and b, we say that a divides b, or that a is a divisor (or factor) of b, or that b is a multiple of a, if there exists an integer c such that b = ca, and we denote this by a | b. Otherwise, a does not divide b, and we denote this by a ∤ b. A positive integer p is a prime if the only divisors of p are 1 and p. If pk | a and pk+1 ∤ a where p is a prime, i.e. pk is the highest power of p dividing a, then we denote this by pk∥a. Useful Facts • If a, b > 0, and a | b, then a ≤ b. • If a | b1, a | b2, . . . , a | bn, then for any integers c1, c2, . . . , cn, a | n∑ i=1 bici. Theorem 1.1. The Division Algorithm. For any positive integer a and integer b, there exist unique integers q and r such that b = qa + r and 0 ≤ r < a, with r = 0 iﬀ a | b. 1 Theorem 1.2. The Fundamental Theorem of Arithmetic. Every integer greater than 1 can be written uniquely in the form pe1 1 pe2 2 · · · pek k , where the pi are distinct primes and the ei are positive integers. Theorem 1.3. (Euclid) There exist an inﬁnite number of primes. Proof. Suppose that there are a ﬁnite number of primes, say p1, p2, . . . , pn. Let N = p1p2 · · · pn + 1. By the fundamental theorem of arithmetic, N is divisible by some prime p. This prime p must be among the pi, since by assumption these are all the primes, but N is seen not to be divisible by any of the pi, contradiction. Example 1.1. Let x and y be integers. Prove that 2x + 3y is divisible by 17 iﬀ 9x + 5y is divisible by 17. Solution. 17 | (2x + 3y) ⇒ 17 | [13(2x + 3y)], or 17 | (26x + 39y) ⇒ 17 | (9x + 5y), and conversely, 17 | (9x + 5y) ⇒ 17 | [4(9x + 5y)], or 17 | (36x + 20y) ⇒ 17 | (2x + 3y). Example 1.2. Find all positive integers d such that d divides both n2 +1 and (n + 1)2 + 1 for some integer n. Solution. Let d | (n2 + 1) and d | [(n + 1) 2 + 1], or d | (n2 + 2n + 2). Then d | [(n2 + 2n + 2) − (n2 + 1)], or d | (2n + 1) ⇒ d | (4n2 + 4n + 1), so d | [4(n2+2n+2)−(4n2+4n+1)], or d | (4n+7). Then d | [(4n+7)−2(2n+1)], or d | 5, so d can only be 1 or 5. Taking n = 2 shows that both of these values are achieved. Example 1.3. Suppose that a1, a2, . . . , a2n are distinct integers such that the equation (x − a1)(x − a2) · · · (x − a2n) − (−1) n(n!) 2 = 0 has an integer solution r. Show that r = a1 + a2 + · · · + a2n 2n . (1984 IMO Short List) Solution. Clearly, r ̸= ai for all i, and the r − ai are 2n distinct integers, so |(r − a1)(r − a2) · · · (r − a2n)| ≥ |(1)(2) · · · (n)(−1)(−2) · · · (−n)| = (n!) 2, 2 with equality iﬀ {r − a1, r − a2, . . . , r − a2n} = {1, 2, . . . , n, −1, −2, . . . , −n}. Therefore, this must be the case, so (r − a1) + (r − a2) + · · · + (r − a2n) = 2nr − (a1 + a2 + · · · + a2n) = 1 + 2 + · · · + n + (−1) + (−2) + · · · + (−n) = 0 ⇒ r = a1 + a2 + · · · + a2n 2n . Example 1.4. Let 0 < a1 < a2 < · · · < amn+1 be mn + 1 integers. Prove that you can select either m + 1 of them no one of which divides any other, or n + 1 of them each dividing the following one. (1966 Putnam Mathematical Competition) Solution. For each i, 1 ≤ i ≤ mn + 1, let ni be the length of the longest sequence starting with ai and each dividing the following one, among the integers ai, ai+1, . . . , amn+1. If some ni is greater than n then the problem is solved. Otherwise, by the pigeonhole principle, there are at least m + 1 values of ni that are equal. Then, the integers ai corresponding to these ni cannot divide each other. Useful Facts • Bertrand’s Postulate. For every positive integer n, there exists a prime p such that n ≤ p ≤ 2n. • Gauss’s Lemma. If a polynomial with integer coeﬃcients factors into two polynomials with rational coeﬃcients, then it factors into two poly- nomials with integer coeﬃcients. Problems 1. Let a and b be positive integers such that a | b2, b2 | a3, a3 | b4, b4 | a5, . . . . Prove that a = b. 2. Let a, b, and c denote three distinct integers, and let P denote a poly- nomial having all integral coeﬃcients. Show that it is impossible that P (a) = b, P (b) = c, and P (c) = a. (1974 USAMO) 3 3. Show that if a and b are positive integers, then (a + 1 2 )n + (b + 1 2 )n is an integer for only ﬁnitely many positive integers n. (A Problem Seminar, D.J. Newman) 4. For a positive integer n, let r(n) denote the sum of the remainders when n is divided by 1, 2, . . . , n respectively. Prove that r(k) = r(k − 1) for inﬁnitely many positive integers k. (1981 K¨ursch´ak Competition) 5. Prove that for all positive integers n, 0 < n∑ k=1 g(k) k − 2n 3 < 2 3, where g(k) denotes the greatest odd divisor of k. (1973 Austrian Mathematics Olympiad) 6. Let d be a positive integer, and let S be the set of all positive integers of the form x2 + dy2, where x and y are non-negative integers. (a) Prove that if a ∈ S and b ∈ S, then ab ∈ S. (b) Prove that if a ∈ S and p ∈ S, such that p is a prime and p | a, then a/p ∈ S. (c) Assume that the equation x2 + dy2 = p has a solution in non- negative integers x and y, where p is a given prime. Show that if d ≥ 2, then the solution is unique, and if d = 1, then there are exactly two solutions. 2 GCD and LCM The greatest common divisor of two positive integers a and b is the great- est positive integer that divides both a and b, which we denote by gcd(a, b), and similarly, the lowest common multiple of a and b is the least positive 4 integer that is a multiple of both a and b, which we denote by lcm(a, b). We say that a and b are relatively prime if gcd(a, b) = 1. For integers a1, a2, . . . , an, gcd(a1, a2, . . . , an) is the greatest positive integer that divides all of a1, a2, . . . , an, and lcm(a1, a2, . . . , an) is deﬁned similarly. Useful Facts • For all a, b, gcd(a, b) · lcm(a, b) = ab. • For all a, b, and m, gcd(ma, mb) = m gcd(a, b) and lcm(ma, mb) = mlcm(a, b). • If d | gcd(a, b), then gcd ( a d , b d ) = gcd(a, b) d . In particular, if d = gcd(a, b), then gcd(a/d, b/d) = 1; that is, a/d and b/d are relatively prime. • If a | bc and gcd(a, c) = 1, then a | b. • For positive integers a and b, if d is a positive integer such that d | a, d | b, and for any d ′, d ′ | a and d ′ | b implies that d ′ | d, then d = gcd(a, b). This is merely the assertion that any common divisor of a and b divides gcd(a, b). • If a1a2 · · · an is a perfect kth power and the ai are pairwise relatively prime, then each ai is a perfect kth power. • Any two consecutive integers are relatively prime. Example 2.1. Show that for any positive integer N , there exists a multiple of N that consists only of 1s and 0s. Furthermore, show that if N is relatively prime to 10, then there exists a multiple that consists only of 1s. Solution. Consider the N + 1 integers 1, 11, 111, . . . , 111...1 (N + 1 1s). When divided by N , they leave N + 1 remainders. By the pigeonhole princi- ple, two of these remainders are equal, so the diﬀerence in the corresponding integers, an integer of the form 111...000, is divisible by N . If N is relatively prime to 10, then we may divide out all powers of 10, to obtain an integer of the form 111...1 that remains divisible by N . 5 Theorem 2.1. For any positive integers a and b, there exist integers x and y such that ax + by = gcd(a, b). Furthermore, as x and y vary over all integers, ax + by attains all multiples and only multiples of gcd(a, b). Proof. Let S be the set of all integers of the form ax+by, and let d be the least positive element of S. By the division algorithm, there exist integers q and r such that a = qd + r, 0 ≤ r < d. Then r = a − qd = a − q(ax + by) = (1 − qx)a − (qy)b, so r is also in S. But r < d, so r = 0 ⇒ d | a, and similarly, d | b, so d | gcd(a, b). However, gcd(a, b) divides all elements of S, so in particular gcd(a, b) | d ⇒ d = gcd(a, b). The second part of the theorem follows. Corollary 2.2. The positive integers a and b are relatively prime iﬀ there exist integers x and y such that ax + by = 1. Corollary 2.3. For any positive integers a1, a2, . . . , an, there exist integers x1, x2, . . . , xn, such that a1x1+a2x2+· · ·+anxn = gcd(a1, a2, . . . , an). Corollary 2.4. Let a and b be positive integers, and let n be an integer. Then the equation ax + by = n has a solution in integers x and y iﬀ gcd(a, b) | n. If this is the case, then all solutions are of the form (x, y) = (x0 + t · b d , y0 − t · a d ) , where d = gcd(a, b), (x0, y0) is a speciﬁc solution of ax + by = n, and t is an integer. Proof. The ﬁrst part follows from Theorem 2.1. For the second part, as stated, let d = gcd(a, b), and let (x0, y0) be a speciﬁc solution of ax + by = n, so that ax0 + by0 = n. If ax + by = n, then ax + by − ax0 − by0 = a(x − x0) + b(y − y0) = 0, or a(x − x0) = b(y0 − y), and hence (x − x0) · a d = (y0 − y) · b d. Since a/d and b/d are relatively prime, b/d must divide x − x0, and a/d must divide y0 − y. Let x − x0 = tb/d and y0 − y = ta/d. This gives the solutions described above. 6 Example 2.2. Prove that the fraction 21n + 4 14n + 3 is irreducible for every positive integer n. (1959 IMO) Solution. For all n, 3(14n + 3) − 2(21n + 4) = 1, so the numerator and denominator are relatively prime. Example 2.3. For all positive integers n, let Tn = 2 2n + 1. Show that if m ̸= n, then Tm and Tn are relatively prime. Solution. We have that Tn − 2 = 2 2n − 1 = 2 2n−1·2 − 1 = (Tn−1 − 1) 2 − 1 = T 2 n−1 − 2Tn−1 = Tn−1(Tn−1 − 2) = Tn−1Tn−2(Tn−2 − 2) = · · · = Tn−1Tn−2 · · · T1T0(T0 − 2) = Tn−1Tn−2 · · · T1T0, for all n. Therefore, any common divisor of Tm and Tn must divide 2. But each Tn is odd, so Tm and Tn are relatively prime. Remark. It immediately follows from this result that there are an inﬁnite number of primes. The Euclidean Algorithm. By recursive use of the division algorithm, we may ﬁnd the gcd of two positive integers a and b without factoring either, and the x and y in Theorem 2.1 (and so, a speciﬁc solution in Corollary 2.4). For example, for a = 329 and b = 182, we compute 329 = 1 · 182 + 147, 182 = 1 · 147 + 35, 147 = 4 · 35 + 7, 35 = 5 · 7, and stop when there is no remainder. The last dividend is the gcd, so in our example, gcd(329,182) = 7. Now, working through the above equations 7 backwards, 7 = 147 − 4 · 35 = 147 − 4 · (182 − 1 · 147) = 5 · 147 − 4 · 182 = 5 · (329 − 182) − 4 · 182 = 5 · 329 − 9 · 182. Remark. The Euclidean algorithm also works for polynomials. Example 2.4. Let n be a positive integer, and let S be a subset of n + 1 elements of the set {1, 2, . . . , 2n}. Show that (a) There exist two elements of S that are relatively prime, and (b) There exist two elements of S, one of which divides the other. Solution. (a) There must be two elements of S that are consecutive, and thus, relatively prime. (b) Consider the greatest odd factor of each of the n + 1 elements in S. Each is among the n odd integers 1, 3, . . . , 2n − 1. By the pigeon- hole principle, two must have the same greatest odd factor, so they diﬀer (multiplication-wise) by a power of 2, and so one divides the other. Example 2.5. The positive integers a1, a2, . . . , an are such that each is less than 1000, and lcm(ai, aj) > 1000 for all i, j, i ̸= j. Show that n∑ i=1 1 ai < 2. (1951 Russian Mathematics Olympiad) Solution. If 1000 m+1 < a ≤ 1000 m , then the m multiples a, 2a, . . . , ma do not exceed 1000. Let k1 the number of ai in the interval ( 1000 2 , 1000], k2 in ( 1000 3 , 1000 2 ], etc. Then there are k1 + 2k2 + 3k3 + · · · integers, no greater than 1000, that are multiples of at least one of the ai. But the multiples are distinct, so k1 + 2k2 + 3k3 + · · · < 1000 ⇒ 2k1 + 3k2 + 4k3 + · · · = (k1 + 2k2 + 3k3 + · · · ) + (k1 + k2 + k3 + · · · ) < 1000 + n < 2000. 8 Therefore, n∑ i=1 1 ai ≤ k1 2 1000 + k2 3 1000 + k3 4 1000 + · · · = 2k1 + 3k2 + 4k3 + · · · 1000 < 2. Note: It can be shown that n ≤ 500 as follows: Consider the greatest odd divisor of a1, a2, . . . , a1000. Each must be distinct; otherwise, two diﬀer, multiplication-wise, by a power of 2, which means one divides the other, contradiction. Also, there are only 500 odd numbers between 1 and 1000, from which the result follows. It also then follows that n∑ i=1 1 ai < 3 2. Useful Facts • Dirichlet’s Theorem. If a and b are relatively prime positive integers, then the arithmetic sequence a, a + b, a + 2b, . . . , contains inﬁnitely many primes. Problems 1. The symbols (a, b, . . . , g) and [a, b, . . . , g] denote the greatest common divisor and lowest common multiple, respectively of the positive inte- gers a, b, . . . , g. Prove that [a, b, c] 2 [a, b][a, c][b, c] = (a, b, c) 2 (a, b)(a, c)(b, c). (1972 USAMO) 2. Show that gcd(am − 1, a n − 1) = agcd(m,n) − 1 for all positive integers a > 1, m, n. 9 3. Let a, b, and c be positive integers. Show that lcm(a, b, c) = abc · gcd(a, b, c) gcd(a, b) · gcd(a, c) · gcd(b, c). Express gcd(a, b, c) in terms of abc, lcm(a, b, c), lcm(a, b), lcm(a, c), and lcm(b, c). Generalize. 4. Let a, b be odd positive integers. Deﬁne the sequence (fn) by putting f1 = a, f2 = b, and by letting fn for n ≥ 3 be the greatest odd divisor of fn−1 + fn−2. Show that fn is constant for n suﬃciently large and determine the eventual value as a function of a and b. (1993 USAMO) 5. Let n ≥ a1 > a2 > · · · > ak be positive integers such that lcm(ai, aj) ≤ n for all i, j. Prove that iai ≤ n for i = 1, 2, . . . , k. 3 Arithmetic Functions There are several important arithmetic functions, of which three are pre- sented here. If the prime factorization of n > 1 is pe1 1 pe2 2 · · · pek k , then the number of positive integers less than n, relatively prime to n, is ϕ(n) = (1 − 1 p1 ) ( 1 − 1 p2 ) · · · (1 − 1 pk ) n = pe1−1 1 pe2−1 2 · · · pek−1 k (p1 − 1)(p2 − 1) · · · (pk − 1), the number of divisors of n is τ (n) = (e1 + 1)(e2 + 1) · · · (ek + 1), and the sum of the divisors of n is σ(n) = (pe1 1 + pe1−1 1 + · · · + 1)(pe2 2 + pe2−1 2 + · · · + 1) · · · (pek k + pek−1 k + · · · + 1) = ( pe1+1 1 − 1 p1 − 1 ) (pe2+1 2 − 1 p2 − 1 ) · · · ( pek+1 k − 1 pk − 1 ) . Also, ϕ(1), τ (1), and σ(1) are deﬁned to be 1. We say that a function f is multiplicative if f (mn) = f (m)f (n) for all relatively prime positive 10 integers m and n, and f (1) = 1 (otherwise, f (1) = 0, which implies that f (n) = 0 for all n). Theorem 3.1. The functions ϕ, τ , and σ are multiplicative. Hence, by taking the prime factorization and evaluating at each prime power, the formula above are found easily. Example 3.1. Find the number of solutions in ordered pairs of positive integers (x, y) of the equation 1 x + 1 y = 1 n , where n is a positive integer. Solution. From the given, 1 x + 1 y = 1 n ⇔ xy = nx + ny ⇔ (x − n)(y − n) = n2. If n = 1, then we immediately deduce the unique solution (2,2). For n ≥ 2, let n = pe1 1 pe2 2 · · · pek k be the prime factorization of n. Since x, y > n, there is a 1-1 correspondence between the solutions in (x, y) and the factors of n2, so the number of solutions is τ (n2) = (2e1 + 1)(2e2 + 1) · · · (2ek + 1). Example 3.2. Let n be a positive integer. Prove that ∑ d|n ϕ(d) = n. Solution. For a divisor d of n, let Sd be the set of all a, 1 ≤ a ≤ n, such that gcd(a, n) = n/d. Then Sd consists of all elements of the form b · n/d, where 0 ≤ b ≤ d, and gcd(b, d) = 1, so Sd contains ϕ(d) elements. Also, it is clear that each integer between 1 and n belongs to a unique Sd. The result then follows from summing over all divisors d of n. Problems 1. Let n be a positive integer. Prove that n∑ k=1 τ (k) = n∑ k=1 ⌊n k ⌋ . 11 2. Let n be a positive integer. Prove that ∑ d|n τ 3(d) =   ∑ d|n τ (d)   2 . 3. Prove that if σ(N ) = 2N + 1, then N is the square of an odd integer. (1976 Putnam Mathematical Competition) 4 Modular Arithmetic For a positive integer m and integers a and b, we say that a is congruent to b modulo m if m | (a − b), and we denote this by a ≡ b modulo m, or more commonly a ≡ b (mod m). Otherwise, a is not congruent to b modulo m, and we denote this by a ̸≡ b (mod m) (although this notation is not used often). In the above notation, m is called the modulus, and we consider the integers modulo m. Theorem 4.1. If a ≡ b and c ≡ d (mod m), then a + c ≡ b + d (mod m) and ac ≡ bd (mod m). Proof. If a ≡ b and c ≡ d (mod m), then there exist integers k and l such that a = b + km and c = d + lm. Hence, a + c = b + d + (k + l)m, so a + c ≡ b + d (mod m). Also, ac = bd + dkm + blm + klm2 = bd + (dk + bl + klm)m, so ac ≡ bd (mod m). Useful Facts • For all integers n, n2 ≡ { 0 1 } (mod 4) { if n is even, if n is odd. • For all integers n, n2 ≡    0 4 1  ‖  (mod 8)    if n ≡ 0 (mod 4), if n ≡ 2 (mod 4), if n ≡ 1 (mod 2). 12 • If f is a polynomial with integer coeﬃcients and a ≡ b (mod m), then f (a) ≡ f (b) (mod m). • If f is a polynomial with integer coeﬃcients of degree n, not identically zero, and p is a prime, then the congruence f (x) ≡ 0 (mod p) has at most n solutions modulo p, counting multiplicity. Example 4.1. Prove that the only solution in rational numbers of the equation x3 + 3y3 + 9z3 − 9xyz = 0 is x = y = z = 0. (1983 K¨ursch´ak Competition) Solution. Suppose that the equation has a solution in rationals, with at least one non-zero variable. Since the equation is homogeneous, we may obtain a solution in integers (x0, y0, z0) by multiplying the equation by the cube of the lowest common multiple of the denominators. Taking the equa- tion modulo 3, we obtain x3 0 ≡ 0 (mod 3). Therefore, x0 must be divisible by 3, say x0 = 3x1. Substituting, 27x3 1 + 3y3 0 + 9z3 0 − 27x1y0z0 = 0 ⇒ y3 0 + 3z3 0 + 9x3 1 − 9x1y0z0 = 0. Therefore, another solution is (y0, z0, x1). We may then apply this reduction recursively, to obtain y0 = 3y1, z0 = 3z1, and another solution (x1, y1, z1). Hence, we may divide powers of 3 out of our integer solution an arbitrary number of times, contradiction. Example 4.2. Does one of the ﬁrst 10 8 + 1 Fibonacci numbers terminate with 4 zeroes? Solution. The answer is yes. Consider the sequence of pairs (Fk, Fk+1) modulo 10 4. Since there are only a ﬁnite number of diﬀerent possible pairs (10 8 to be exact), and each pair is dependent only on the previous one, this sequence is eventually periodic. Also, by the Fibonacci relation, one can ﬁnd the previous pair to a given pair, so this sequence is immediately periodic. But F0 ≡ 0 (mod 10 4), so within 10 8 terms, another Fibonacci number divisible by 10 4 must appear. 13 In fact, a computer check shows that 10 4 | F7500, and (Fn) modulo 10 4 has period 15000, which is much smaller than the upper bound of 10 8. If ax ≡ 1 (mod m), then we say that x is the inverse of a modulo m, denoted by a−1, and it is unique modulo m. Theorem 4.2. The inverse of a modulo m exists and is unique iﬀ a is relatively prime to m. Proof. If ax ≡ 1 (mod m), then ax = 1+km for some k ⇒ ax−km = 1. By Corollary 2.2, a and m are relatively prime. Now, if gcd(a, m) = 1, then by Corollary 2.2, there exist integers x and y such that ax + my = 1 ⇒ ax = 1 − my ⇒ ax ≡ 1 (mod m). The inverse x is unique modulo m, since if x′ is also an inverse, then ax ≡ ax′ ≡ 1 ⇒ xax ≡ xax′ ≡ x ≡ x′. Corollary 4.3. If p is a prime, then the inverse of a modulo p exists and is unique iﬀ p does not divide a. Corollary 4.4. If ak ≡ bk (mod m) and k is relatively prime to m, then a ≡ b (mod m). Proof. Multiplying both sides by k−1, which exists by Theorem 4.2, yields the result. We say that a set {a1, a2, . . . , am} is a complete residue system modulo m if for all i, 0 ≤ i ≤ m−1, there exists a unique j such that aj ≡ i (mod m). Example 4.3. Find all positive integers n such that there exist complete residue systems {a1, a2, . . . , an} and {b1, b2, . . . , bn} modulo n for which {a1 + b1, a2 + b2, . . . , an + bn} is also a complete residue system. Solution. The answer is all odd n. First we prove necessity. For any complete residue system {a1, a2, . . . , an} modulo n, we have that a1 + a2 + · · · + an ≡ n(n + 1)/2 (mod n). So, if all three sets are complete residue systems, then a1+a2+· · ·+an+b1+b2+· · ·+bn ≡ n2+n ≡ 0 (mod n) and a1 + b1 + a2 + b2 + · · · + an + bn ≡ n(n + 1)/2 (mod n), so n(n + 1)/2 ≡ 0 (mod n). The quantity n(n + 1)/2 is divisible by n iﬀ (n + 1)/2 is an integer, which implies that n is odd. Now assume that n is odd. Let ai = bi = i for all i. Then ai + bi = 2i for all i, and n is relatively prime to 2, so by Corollary 4.4, {2, 4, . . . , 2n} is a complete residue system modulo n. Theorem 4.5. Euler’s Theorem. If a is relatively prime to m, then aϕ(m) ≡ 1 (mod m). 14 Proof. Let a1, a2, . . . , aϕ(m) be the positive integers less than m that are relatively prime to m. Consider the integers aa1, aa2, . . . , aaϕ(m). We claim that they are a permutation of the original ϕ(m) integers ai, modulo m. For each i, aai is also relatively prime to m, so aai ≡ ak for some k. Since aai ≡ aaj ⇔ ai ≡ aj (mod m), each ai gets taken to a diﬀerent ak under multiplication by a, so indeed they are permuted. Hence, a1a2 · · · aϕ(m) ≡ (aa1)(aa2) · · · (aaϕ(m)) ≡ aϕ(m)a1a2 · · · aϕ(m) ⇒ 1 ≡ aϕ(m) (mod m). Remark. This gives an explicit formula for the inverse of a modulo m: a−1 ≡ aϕ(m)−2 (mod m). Alternatively, one can use the Euclidean algorithm to ﬁnd a−1 ≡ x as in the proof of Theorem 4.2. Corollary 4.6. Fermat’s Little Theorem (FLT). If p is a prime, and p does not divide a, then ap−1 ≡ 1 (mod p). Example 4.4. Show that if a and b are relatively prime positive integers, then there exist integers m and n such that am + bn ≡ 1 (mod ab). Solution. Let S = am + bn, where m = ϕ(b) and n = ϕ(a). Then by Euler’s Theorem, S ≡ bϕ(a) ≡ 1 (mod a), or S − 1 ≡ 0 (mod a), and S ≡ aϕ(b) ≡ 1 (mod b), or S − 1 ≡ 0 (mod b). Therefore, S − 1 ≡ 0, or S ≡ 1 (mod ab). Example 4.5. For all positive integers i, let Si be the sum of the products of 1, 2, . . . , p − 1 taken i at a time, where p is an odd prime. Show that S1 ≡ S2 ≡ · · · ≡ Sp−2 ≡ 0 (mod p). Solution. First, observe that (x − 1)(x − 2) · · · (x − (p − 1)) = xp−1 − S1xp−2 + S2xp−3 − · · · − Sp−2x + Sp−1. This polynomial vanishes for x = 1, 2, . . . , p − 1. But by Fermat’s Little Theorem, so does xp−1 − 1 modulo p. Taking the diﬀerence of these two polynomials, we obtain another polynomial of degree p − 2 with p − 1 roots modulo p, so it must be the zero polynomial, and the result follows from comparing coeﬃcients. 15 Remark. We immediately have that (p − 1)! ≡ Sp−1 ≡ −1 (mod p), which is Wilson’s Theorem. Also, xp − x ≡ 0 (mod p) for all x, yet we cannot compare coeﬃcients here. Why not? Theorem 4.7. If p is a prime and n is an integer such that p | (4n2 + 1), then p ≡ 1 (mod 4). Proof. Clearly, p cannot be 2, so we need only show that p ̸≡ 3 (mod 4). Suppose p = 4k + 3 for some k. Let y = 2n, so by Fermat’s Little Theorem, yp−1 ≡ 1 (mod p), since p does not divide n. But, y2 + 1 ≡ 0, so yp−1 ≡ y4k+2 ≡ (y2) 2k+1 ≡ (−1) 2k+1 ≡ −1 (mod p), contradiction. Therefore, p ≡ 1 (mod 4). Remark. The same proof can be used to show that if p is a prime and p | (n2 + 1), then p = 2 or p ≡ 1 (mod 4). Example 4.6. Show that there are an inﬁnite number of primes of the form 4k + 1 and of the form 4k + 3. Solution. Suppose that there are a ﬁnite number of primes of the form 4k + 1, say p1, p2, . . . , pn. Let N = 4(p1p2 · · · pn) 2 + 1. By Theorem 4.7, N is only divisible by primes of the form 4k + 1, but clearly N is not divisible by any of these primes, contradiction. Similarly, suppose that there are a ﬁnite number of primes of the form 4k + 3, say q1, q2, . . . , qm. Let M = 4q1q2 · · · qm − 1. Then M ≡ 3 (mod 4), so M must be divisible by a prime of the form 4k + 3, but M is not divisible by any of these primes, contradiction. Example 4.7. Show that if n is an integer greater than 1, then n does not divide 2 n − 1. Solution. Let p be the least prime divisor of n. Then gcd(n, p − 1) = 1, and by Corollary 2.2, there exist integers x and y such that nx+(p−1)y = 1. If p | (2 n − 1), then 2 ≡ 2 nx+(p−1)y ≡ (2 n) x(2 p−1) y ≡ 1 (mod p) by Fermat’s Little Theorem, contradiction. Therefore, p ∤ (2 n − 1) ⇒ n ∤ (2 n − 1). Theorem 4.8. Wilson’s Theorem. If p is a prime, then (p − 1)! ≡ −1 (mod p). (See also Example 4.5.) Proof. Consider the congruence x2 ≡ 1 (mod p). Then x2 − 1 ≡ (x − 1)(x + 1) ≡ 0, so the only solutions are x ≡ 1 and −1. Therefore, for each i, 2 ≤ i ≤ p − 2, there exists a unique inverse j ̸= i of i, 2 ≤ j ≤ p − 2, modulo 16 p. Hence, when we group in pairs of inverses, (p − 1)! ≡ 1 · 2 · · · (p − 2) · (p − 1) ≡ 1 · 1 · · · 1 · (p − 1) ≡ −1 (mod p). Example 4.8. Let {a1, a2, . . . , a101} and {b1, b2, . . . , b101} be complete residue systems modulo 101. Can {a1b1, a2b2, . . . , a101b101} be a complete residue system modulo 101? Solution. The answer is no. Suppose that {a1b1, a2b2, . . . , a101b101} is a complete residue system modulo 101. Without loss of generality, assume that a101 ≡ 0 (mod 101). Then b101 ≡ 0 (mod 101), because if any other bj was congruent to 0 modulo 101, then ajbj ≡ a101b101 ≡ 0 (mod 101), contradiction. By Wilson’s Theorem, a1a2 · · · a100 ≡ b1b2 · · · b100 ≡ 100! ≡ −1 (mod 101), so a1b1a2b2 · · · a100b100 ≡ 1 (mod 101). But a101b101 ≡ 0 (mod 101), so a1b1a2b2 · · · a100b100 ≡ 100! ≡ −1 (mod 101), contradiction. Theorem 4.9. If p is a prime, then the congruence x2 + 1 ≡ 0 (mod p) has a solution iﬀ p = 2 or p ≡ 1 (mod 4). (Compare to Theorem 7.1) Proof. If p = 2, then x = 1 is a solution. If p ≡ 3 (mod 4), then by the remark to Theorem 4.7, no solutions exist. Finally, if p = 4k + 1, then let x = 1 · 2 · · · (2k). Then x2 ≡ 1 · 2 · · · (2k) · (2k) · · · 2 · 1 ≡ 1 · 2 · · · (2k) · (−2k) · · · (−2) · (−1) (multiplying by 2k −1s) ≡ 1 · 2 · · · (2k) · (p − 2k) · · · (p − 2) · (p − 1) ≡ (p − 1)! ≡ −1 (mod p). Theorem 4.10. Let p be a prime such that p ≡ 1 (mod 4). Then there exist positive integers x and y such that p = x2 + y2. Proof. By Theorem 4.9, there exists an integer a such that a2 ≡ −1 (mod p). Consider the set of integers of the form ax − y, where x and y are integers, 0 ≤ x, y < √p. The number of possible pairs (x, y) is then (⌊√p⌋ + 1) 2 > ( √p) 2 = p, so by pigeonhole principle, there exist integers 0 ≤ x1, x2, y1, y2 < √p, such that ax1−y1 ≡ ax2−y2 (mod p). Let x = x1−x2 and y = y1 − y2. At least one of x and y is non-zero, and ax ≡ y ⇒ a2x2 ≡ 17 −x2 ≡ y2 ⇒ x2 + y2 ≡ 0 (mod p). Thus, x2 + y2 is a multiple of p, and 0 < x2 + y2 < ( √p) 2 + ( √p) 2 = 2p, so x2 + y2 = p. Theorem 4.11. Let n be a positive integer. Then there exist integers x and y such that n = x2 + y2 iﬀ each prime factor of n of the form 4k + 3 appears an even number of times. Theorem 4.12. The Chinese Remainder Theorem (CRT). If a1, a2, . . . , ak are integers, and m1, m2, . . . , mk are pairwise relatively prime integers, then the system of congruences x ≡ a1 (mod m1), x ≡ a2 (mod m2), ... x ≡ ak (mod mk) has a unique solution modulo m1m2 · · · mk. Proof. Let m = m1m2 · · · mk, and consider m/m1. This is relatively prime to m1, so there exists an integer t1 such that t1 · m/m1 ≡ 1 (mod m1). Accordingly, let s1 = t1 · m/m1. Then s1 ≡ 1 (mod m1) and s1 ≡ 0 (mod mj), j ̸= 1. Similarly, for all i, there exists an si such that si ≡ 1 (mod mi) and si ≡ 0 (mod mj), j ̸= i. Then, x = a1s1 + a2s2 + · · · + aksk is a solution to the above system. To see uniqueness, let x′ be another solution. Then x − x′ ≡ 0 (mod mi) for all i ⇒ x − x′ ≡ 0 (mod m1m2 · · · mk). Remark. The proof shows explicitly how to ﬁnd the solution x. Example 4.9. For a positive integer n, ﬁnd the number of solutions of the congruence x2 ≡ 1 (mod n). Solution. Let the prime factorization of n be 2 epe1 1 pe2 2 · · · pek k . By CRT, x2 ≡ 1 (mod n) ⇔ x2 ≡ 1 (mod pei i ) for all i, and x2 ≡ 1 (mod 2 e). We consider these cases separately. We have that x2 ≡ 1 (mod pei i ) ⇔ x2 − 1 = (x − 1)(x + 1) ≡ 0 (mod pei i ). But pi cannot divide both x − 1 and x + 1, so it divides one of them; that is, x ≡ ±1 (mod pei i ). Hence, there are two solutions. Now, if (x − 1)(x + 1) ≡ 0 (mod 2 e), 2 can divide both x − 1 and x + 1, but 4 cannot divide both. For e = 1 and e = 2, it is easily checked that there are 1 and 2 solutions respectively. For e ≥ 3, since there is at most one factor 18 of 2 in one of x − 1 and x + 1, there must be at least e − 1 in the other, for their product to be divisible by 2 e. Hence, the only possibilities are x − 1 or x + 1 ≡ 0, 2e−1 (mod 2 e), which lead to the four solutions x ≡ 1, 2e−1 − 1, 2 e−1 + 1, and 2 e − 1. Now that we know how many solutions each prime power factor con- tributes, the number of solutions modulo n is simply the product of these, by CRT. The following table gives the answer: e Number of solutions 0, 1 2 k 2 2 k+1 ≥ 3 2 k+2 Theorem 4.11. Let m be a positive integer, let a and b be integers, and let k = gcd(a, m). Then the congruence ax ≡ b (mod m) has k solutions or no solutions according as k | b or k ∤ b. Problems 1. Prove that for each positive integer n there exist n consecutive positive integers, none of which is an integral power of a prime. (1989 IMO) 2. For an odd positive integer n > 1, let S be the set of integers x, 1 ≤ x ≤ n, such that both x and x + 1 are relatively prime to n. Show that ∏ x∈S x ≡ 1 (mod n). 3. Find all positive integer solutions to 3 x + 4 y = 5 z. (1991 IMO Short List) 4. Let n be a positive integer such that n + 1 is divisible by 24. Prove that the sum of all the divisors of n is divisible by 24. (1969 Putnam Mathematical Competition) 5. (Wolstenholme’s Theorem) Prove that if 1 + 1 2 + 1 3 + · · · + 1 p − 1 19 is expressed as a fraction, where p ≥ 5 is a prime, then p2 divides the numerator. 6. Let a be the greatest positive root of the equation x3 − 3x2 + 1 = 0. Show that ⌊a1788⌋ and ⌊a1988⌋ are both divisible by 17. (1988 IMO Short List) 7. Let {a1, a2, . . . , an} and {b1, b2, . . . , bn} be complete residue systems modulo n, such that {a1b1, a2b2, . . . , anbn} is also a complete residue system modulo n. Show that n = 1 or 2. 8. Let m, n be positive integers. Show that 4mn − m − n can never be a square. (1984 IMO Proposal) 5 Binomial Coeﬃcients For non-negative integers n and k, k ≤ n, the binomial coeﬃcient (n k) is deﬁned as n! k!(n − k)!, and has several important properties. By convention, (n k) = 0 if k > n. In the following results, for polynomials f and g with integer coeﬃcients, we say that f ≡ g (mod m) if m divides every coeﬃcient in f − g. Theorem 5.1. If p is a prime, then the number of factors of p in n! is ⌊ n p ⌋ + ⌊ n p2 ⌋ + ⌊ n p3 ⌋ + · · · . It is also n − sn p − 1 , where sn is the sum of the digits of n when expressed in base p. Theorem 5.2. If p is a prime, then (p i ) ≡ 0 (mod p) 20 for 1 ≤ i ≤ p − 1. Corollary 5.3. (1 + x) p ≡ 1 + xp (mod p). Lemma 5.4. For all real numbers x and y, ⌊x + y⌋ ≥ ⌊x⌋ + ⌊y⌋. Proof. x ≥ ⌊x⌋ ⇒ x + y ≥ ⌊x⌋ + ⌊y⌋ ∈ Z, so ⌊x + y⌋ ≥ ⌊x⌋ + ⌊y⌋. Theorem 5.5. If p is a prime, then (pk i ) ≡ 0 (mod p) for 1 ≤ i ≤ pk − 1. Proof. By Lemma 5.4, k∑ j=1 (⌊ i pj ⌋ + ⌊ pk − i pj ⌋) ≤ k∑ j=1 ⌊ pk pj ⌋ , where the LHS and RHS are the number of factors of p in i!(pk − i)! and pk! respectively. But, ⌊ i pk ⌋ = ⌊ pk−i pk ⌋ = 0 and ⌊ pk pk ⌋ = 1, so the inequality is strict, and at least one factor of p divides (pk i ). Corollary 5.6. (1 + x) pk ≡ 1 + xpk (mod p). Example 5.1. Let n be a positive integer. Show that the product of n consecutive positive integers is divisible by n!. Solution. If the consecutive integers are m, m + 1, . . . , m + n − 1, then m(m + 1) · · · (m + n − 1) n! = (m + n − 1 n ). Example 5.2. Let n be a positive integer. Show that (n + 1) lcm ((n 0 ), (n 1 ), . . . , (n n )) = lcm(1, 2, . . . , n + 1). (AMM E2686) Solution. Let p be a prime ≤ n + 1 and let α (respectively β) be the highest power of p in the LHS (respectively RHS) of the above equality. Choose r so that pr ≤ n + 1 < pr+1. Then clearly β = r. We claim that if pr ≤ m < p r+1, then pr+1 ∤ (m k ) for 0 ≤ k ≤ m. (∗) 21 Indeed, the number of factors of p in (m k ) is γ = r∑ s=1 (⌊ m ps ⌋ − ⌊ k ps ⌋ − ⌊ m − k ps ⌋) . Since each summand in this sum is 0 or 1, we have γ ≤ r; that is, (*) holds. For 0 ≤ k ≤ n, let ak = (n + 1)(n k ) = (n − k + 1)(n + 1 k ) = (k + 1)(n + 1 k + 1 ). By (∗), pr+1 does not divide any of the integers (n k), (n+1 k ), or (n+1 k+1). Thus, pr+1 can divide ak only if p divides each of the integers n + 1, n − k + 1, and k + 1. This implies that p divides (n + 1) − (n − k + 1) − (k + 1) = −1, contradiction. Therefore, pr+1 ∤ ak. On the other hand, for k = pr − 1, we have that k ≤ n and ak = (k + 1) (n+1 k+1) is divisible by pr. Therefore, β = r = α. Theorem 5.7. Lucas’s Theorem. Let m and n be non-negative integers, and p a prime. Let m = mkpk + mk−1pk−1 + · · · + m1p + m0, and n = nkpk + nk−1pk−1 + · · · + n1p + n0 be the base p expansions of m and n respectively. Then (m n ) ≡ (mk nk )(mk−1 nk−1 ) · · · (m1 n1 )(m0 n0 ) (mod p). Proof. By Corollary 5.6, (1 + x) m ≡ (1 + x) mkpk+mk−1pk−1+···+m1p+m0 ≡ (1 + x) pkmk(1 + x) pk−1mk−1 · · · (1 + x) pm1(1 + x) m0 ≡ (1 + xpk) mk(1 + xpk−1) mk−1 · · · (1 + xp) m1(1 + x) m0 (mod p). By base p expansion, the coeﬃcient of xn on both sides is (m n ) ≡ (mk nk )(mk−1 nk−1 ) · · · (m1 n1 )(m0 n0 ) (mod p). 22 Corollary 5.8. Let n be a positive integer. Let A(n) denote the number of factors of 2 in n!, and let B(n) denote the number of 1s in the binary expansion of n. Then the number of odd entries in the nth row of Pascal’s Triangle, or equivalently the number of odd coeﬃcients in the expansion of (1 + x) n, is 2 B(n). Furthermore, A(n) + B(n) = n for all n. Useful Facts • For a polynomial f with integer coeﬃcients and prime p, [f (x)] pn ≡ f (xpn) (mod p). Problems 1. Let a and b be non-negative integers, and p a prime. Show that (pa pb ) ≡ (a b ) (mod p). 2. Let an be the last non-zero digit in the decimal representation of the number n!. Is the sequence a1, a2, a3, . . . eventually periodic? (1991 IMO Short List) 3. Find all positive integers n such that 2 n | (3 n − 1). 4. Find the greatest integer k for which 1991 k divides 1990 19911992 + 1992 19911990. (1991 IMO Short List) 5. For a positive integer n, let a(n) and b(n) denote the number of binomial coeﬃcients in the nth row of Pascal’s Triangle that are congruent to 1 and 2 modulo 3 respectively. Prove that a(n) − b(n) is always a power of 2. 6. Let n be a positive integer. Prove that if the number of factors of 2 in n! is n − 1, then n is a power of 2. 23 7. For a positive integer n, let Cn = 1 n + 1 (2n n ), and Sn = C1 + C2 + · · · + Cn. Prove that Sn ≡ 1 (mod 3) if and only if there exists a 2 in the base 3 expansion of n + 1. 6 Order of an Element We know that if a is relatively prime to m, then there exists a positive integer n such that an ≡ 1 (mod m). Let d be the smallest such n. Then we say that d is the order of a modulo m, denoted by ordm(a), or simply ord(a) if the modulus m is understood. Theorem 6.1. If a is relatively prime to m, then an ≡ 1 (mod m) iﬀ ord(a) | n. Furthermore, an0 ≡ an1 iﬀ ord(a) | (n0 − n1). Proof. Let d = ord(a). It is clear that d | n ⇒ an ≡ 1 (mod m). On the other hand, if an ≡ 1 (mod m), then by the division algorithm, there exist integers q and r such that n = qd + r, 0 ≤ r < d. Then an ≡ aqd+r ≡ (ad) qar ≡ ar ≡ 1 (mod m). But r < d, so r = 0 ⇒ d | n. The second part of the theorem follows. Remark. In particular, by Euler’s Theorem, ord(a) | ϕ(m). Example 6.1. Show that the order of 2 modulo 101 is 100. Solution. Let d = ord(2). Then d | ϕ(101), or d | 100. If d < 100, then d divides 100/2 or 100/5; that is, d is missing at least one prime factor. However, 2 50 ≡ 1024 5 ≡ 14 5 ≡ 196 · 196 · 14 ≡ (−6) · (−6) · 14 ≡ −1 (mod 101), and 2 20 ≡ 1024 2 ≡ 14 2 ≡ −6 (mod 101), so d = 100. Example 6.2. Prove that if p is a prime, then every prime divisor of 2 p − 1 is greater than p. 24 Solution. Let q | (2 p − 1), where q is a prime. Then 2 p ≡ 1 (mod q), so ord(2) | p. But ord(2) ̸= 1, so ord(2) = p. And by Fermat’s Little Theorem, ord(2) | (q − 1) ⇒ p ≤ q − 1 ⇒ q > p. In fact, for p > 2, q must be of the form 2kp + 1. From the above, ord(2) | (q − 1), or p | (q − 1) ⇒ q = mp + 1. Since q must be odd, m must be even. Example 6.3. Let p be a prime that is relatively prime to 10, and let n be an integer, 0 < n < p. Let d be the order of 10 modulo p. (a) Show that the length of the period of the decimal expansion of n/p is d. (b) Prove that if d is even, then the period of the decimal expansion of n/p can be divided into two halves, whose sum is 10 d/2 − 1. For example, 1/7 = 0.142857, so d = 6, and 142 + 857 = 999 = 10 3 − 1. Solution. (a) Let m be the length of the period, and let n/p = 0.a1a2 . . . am. Then 10 mn p = a1a2 . . . am.a1a2 . . . am ⇒ (10 m − 1) n p = a1a2 . . . am, an integer. Since n and p are relatively prime, p must divide 10 m − 1, so d divides m. Conversely, p divides 10d −1, so (10 d −1)n/p is an integer, with at most d digits. If we divide this integer by 10 d − 1, then we obtain a rational number, whose decimal expansion has period at most d. Therefore, m = d. (b) Let d = 2k, so n/p = 0.a1a2 . . . akak+1 . . . a2k. Now p divides 10 d −1 = 10 2k − 1 = (10 k − 1)(10 k + 1). However, p cannot divide 10 k − 1 (since the order of 10 is 2k), so p divides 10 k + 1. Hence, 10 kn p = a1a2 . . . ak.ak+1 . . . a2k ⇒ (10k + 1) n p = a1a2 . . . ak + 0.a1a2 . . . ak + 0.ak+1 . . . a2k is an integer. This can occur iﬀ a1a2 . . . ak +ak+1 . . . a2k is a number consisting only of 9s, and hence, equal to 10 k − 1. Problems 25 1. Prove that for all positive integers a > 1 and n, n | ϕ(an − 1). 2. Prove that if p is a prime, then pp−1 has a prime factor that is congruent to 1 modulo p. 3. For any integer a, set na = 101a−100·2 a. Show that for 0 ≤ a, b, c, d ≤ 99, na + nb ≡ nc + nd (mod 10100) implies {a, b} = {c, d}. (1994 Putnam Mathematical Competition) 4. Show that if 3 ≤ d ≤ 2 n+1, then d ∤ (a2n + 1) for all positive integers a. 7 Quadratic Residues Let m be an integer greater than 1, and a an integer relatively prime to m. If x2 ≡ a (mod m) has a solution, then we say that a is a quadratic residue of m. Otherwise, we say that a is a quadratic non-residue. Now, let p be an odd prime. Then the Legendre symbol ( a p ) is assigned the value of 1 if a is a quadratic residue of p. Otherwise, it is assigned the value of −1. Theorem 7.1. Let p be an odd prime, and a and b be integers relatively prime to p. Then (a) ( a p ) ≡ a(p−1)/2 (mod p), and (b) ( a p )( b p) = ( ab p ). Proof. If the congruence x2 ≡ a (mod p) has a solution, then a (p−1)/2 ≡ xp−1 ≡ 1 (mod p), by Fermat’s Little Theorem. If the congruence x2 ≡ a (mod p) has no solutions, then for each i, 1 ≤ i ≤ p − 1, there is a unique j ̸= i, 1 ≤ j ≤ p − 1, such that ij ≡ a. Therefore, all the integers from 1 to p − 1 can be arranged into (p − 1)/2 such pairs. Taking their product, a(p−1)/2 ≡ 1 · 2 · · · (p − 1) ≡ (p − 1)! ≡ −1 (mod p), 26 by Wilson’s Theorem. Part (b) now follows from part (a). Remark. Part (a) is known as Euler’s criterion. Example 7.1. Show that if p is an odd prime, then ( 1 p ) + ( 2 p ) + · · · + ( p − 1 p ) = 0. Solution. Note that 1 2, 2 2, . . . , ((p − 1)/2) 2 are distinct modulo p, and that ((p + 1)/2) 2, . . . , (p − 1) 2 represent the same residues, simply in reverse. Hence, there are exactly (p−1)/2 quadratic residues, leaving (p−1)/2 quadratic non-residues. Therefore, the given sum contains (p − 1)/2 1s and (p − 1)/2 −1s. Theorem 7.2. Gauss’s Lemma. Let p be an odd prime and let a be relatively prime to p. Consider the least non-negative residues of a, 2a, . . . , ((p − 1)/2)a modulo p. If n is the number of these residues that are greater than p/2, then ( a p ) = (−1) n. Theorem 7.3. If p is an odd prime, then ( −1 p ) = (−1) (p−1)/2; that is, ( −1 p ) = { 1 if p ≡ 1 (mod 4), −1 if p ≡ 3 (mod 4). Proof. This follows from Theorem 4.9 (and Theorem 7.1). Theorem 7.4. If p is an odd prime, then ( 2 p) = (−1) (p2−1)/8; that is, ( 2 p ) = { 1 if p ≡ 1 or 7 (mod 8), −1 if p ≡ 3 or 5 (mod 8). 27 Proof. If p ≡ 1 or 5 (mod 8), then 2 (p−1)/2 ( p − 1 2 )! ≡ 2 · 4 · 6 · · · (p − 1) ≡ 2 · 4 · 6 · · · ( p − 1 2 ) · (−p − 3 2 ) · · · (−5) · (−3) · (−1) ≡ (−1) (p−1)/4 ( p − 1 2 )! ⇒ 2 (p−1)/2 ≡ (−1) (p−1)/4 (mod p). By Theorem 7.1, ( 2 p) = (−1) (p−1)/4. Hence, ( 2 p) = 1 or −1 according as p ≡ 1 or 5 (mod 8). Similarly, if p ≡ 3 or 7 (mod 8), then 2 (p−1)/2 ( p − 1 2 )! ≡ 2 · 4 · 6 · · · ( p − 3 2 ) · (−p − 1 2 ) · · · (−5) · (−3) · (−1) ≡ (−1) (p+1)/4 ( p − 1 2 )! ⇒ 2 (p−1)/2 ≡ (−1) (p+1)/4 (mod p). Hence, ( 2 p) = 1 or −1 according as p ≡ 7 or 3 (mod 8). Example 7.2. Prove that if n is an odd positive integer, then every prime divisor of 2 n − 1 is of the form 8k ± 1. (Compare to Example 6.2) Solution. Let p | (2 n − 1), where p is prime. Let n = 2m + 1. Then 2 n ≡ 2 2m+1 ≡ 2(2m) 2 ≡ 1 (mod p) ⇒ ( 2 p) = 1 ⇒ p is of the form 8k ± 1. Theorem 7.5. The Law of Quadratic Reciprocity. For distinct odd primes p and q, ( p q ) ( q p ) = (−1) p−1 2 · q−1 2 . Example 7.3. For which primes p > 3 does the congruence x2 ≡ −3 (mod p) have a solution? Solution. We seek p for which ( −3 p ) = ( −1 p ) ( 3 p) = 1. By quadratic reciprocity, ( 3 p ) (p 3 ) = (−1) (p−1)/2 = ( −1 p ) , 28 by Theorem 7.3. Thus, in general, ( −3 p ) = ( −1 p ) ( 3 p ) = ( p 3 ) (−1 p )2 = ( p 3 ). And, ( p 3 ) = 1 iﬀ p ≡ 1 (mod 3). Since p ̸≡ 4 (mod 6), we have that x2 ≡ −3 (mod p) has a solution iﬀ p ≡ 1 (mod 6). Example 7.4. Show that if p = 2 n + 1, n ≥ 2, is prime, then 3 (p−1)/2 + 1 is divisible by p. Solution. We must have that n is even, say 2k, for otherwise p ≡ 0 (mod 3). By Theorem 7.1, ( 3 p ) ≡ 3 (p−1)/2 (mod p). However, p ≡ 1 (mod 4), and p ≡ 4 k + 1 ≡ 2 (mod 3) ⇒ ( p 3 ) = −1, and by quadratic reciprocity, ( 3 p ) (p 3 ) = (−1) (p−1)/2 = 1, so ( 3 p ) = −1 ⇒ 3 (p−1)/2 + 1 ≡ 0 (mod p). Useful Facts • (a) If p is a prime and p ≡ 1 or 3 (mod 8), then there exist positive integers x and y such that p = x2 + 2y2. (b) If p is a prime and p ≡ 1 (mod 6), then there exist positive integers x and y such that p = x2 + 3y2. Problems 1. Show that if p > 3 is a prime, then the sum of the quadratic residues among the integers 1, 2, . . . , p − 1 is divisible by p. 2. Let Fn denote the nth Fibonacci number. Prove that if p > 5 is a prime, then Fp ≡ ( p 5 ) (mod p). 29 3. Show that 16 is a perfect 8 th power modulo p for any prime p. 4. Let a, b, and c be positive integers that are pairwise relatively prime, and that satisfy a2 − ab + b2 = c2. Show that every prime factor of c is of the form 6k + 1. 5. Let p be an odd prime and let ζ be a primitive pth root of unity; that is, ζ is a complex number such that ζ p = 1 and ζ k ̸= 1 for 1 ≤ k ≤ p − 1. Let Ap and Bp denote the set of quadratic residues and non-residues modulo p, respectively. Finally, let α = ∑ k∈Ap ζ k and β = ∑ k∈Bp ζ k. For example, for p = 7, α = ζ + ζ 2 + ζ 4 and β = ζ 3 + ζ 5 + ζ 6. Show that α and β are the roots of x2 + x + 1 − ( −1 p ) p 4 = 0. 8 Primitive Roots If the order of g modulo m is ϕ(m), then we say that g is a primitive root modulo m, or simply of m. Example 8.1. Show that 2 is a primitive root modulo 3 n for all n ≥ 1. Solution. The statement is easily veriﬁed for n = 1, so assume the result is true for some n = k; that is, 2ϕ(3k) ≡ 2 2·3k−1 ≡ 1 (mod 3 k). Now, let d be the order of 2 modulo 3 k+1. Then 2 d ≡ 1 (mod 3 k+1) ⇒ 2 d ≡ 1 (mod 3 k), so 2 · 3 k−1 | d. However, d | ϕ(3 k+1), or d | 2 · 3 k. We deduce that d is either 2 · 3 k−1 or 2 · 3 k. Now we require the following lemma: Lemma. 2 2·3n−1 ≡ 1 + 3 n (mod 3 n+1), for all n ≥ 1. This is true for n = 1, so assume it is true for some n = k. Then by assumption, 2 2·3k−1 = 1 + 3 k + 3 k+1m for some integer m ⇒ 2 2·3k = 1 + 3 k+1 + 3 k+2M for some integer M (obtained by cubing) ⇒ 2 2·3k ≡ 1 + 3 k+1 (mod 3 k+2). By induction, the lemma is proved. Therefore, 2 2·3k−1 ≡ 1 + 3 k ̸≡ 1 (mod 3 k+1), so the order of 2 modulo 3 k+1 is 2 · 3 k, and again by induction, the result follows. 30 Corollary 8.2. If 2 n ≡ −1 (mod 3 k), then 3 k−1 | n. Proof. The given implies 22n ≡ 1 (mod 3 k) ⇒ ϕ(3 k) | 2n, or 3 k−1 | n. Theorem 8.3. If m has a primitive root, then it has ϕ(ϕ(m)) (distinct) primitive roots modulo m. Theorem 8.4. The positive integer m has a primitive root iﬀ m is one of 2, 4, pk, or 2pk, where p is an odd prime. Theorem 8.5. If g is a primitive root of m, then gn ≡ 1 (mod m) iﬀ ϕ(m) | n. Furthermore, gn0 ≡ gn1 iﬀ ϕ(m) | (n0 − n1). Proof. This follows directly from Theorem 6.1. Theorem 8.6. If g is a primitive root of m, then the powers 1, g, g2, . . . , gϕ(m)−1 represent each integer relatively prime to m uniquely modulo m. In particular, if m > 2, then gϕ(m)/2 ≡ −1 modulo m. Proof. Clearly, each power gi is relatively prime to m, and there are ϕ(m) integers relatively prime to m. Also, if gi ≡ gj (mod m), then gi−j ≡ 1 ⇒ ϕ(m) | (i − j) by Theorem 8.6, so each of the powers are distinct modulo m. Hence, each integer relatively prime to m is some power gi modulo m. Furthermore, there is a unique i, 0 ≤ i ≤ ϕ(m) − 1, such that gi ≡ −1 ⇒ g2i ≡ 1 ⇒ 2i = ϕ(m), or i = ϕ(m)/2. Proposition 8.7. Let m be a positive integer. Then the only solutions to the congruence x2 ≡ 1 (mod m) are x ≡ ±1 (mod m) iﬀ m has a primitive root. Proof. This follows from Example 4.9. Example 8.2. For a positive integer m, let S be the set of positive integers less than m that are relatively prime to m, and let P be the product of the elements in S. Show that P ≡ ±1 (mod m), with P ≡ −1 (mod m) iﬀ m has a primitive root. Solution. We use a similar strategy as in the proof of Wilson’s Theorem. The result is clear for m = 2, so assume that m ≥ 3. We partition S as follows: Let A be the elements of S that are solutions to the congruence x2 ≡ 1 (mod m), and let B be the remaining elements. The elements in B can be arranged into pairs, by pairing each with its distinct multiplicative inverse. Hence, the product of the elements in B is 1 modulo m. The elements in A may also be arranged into pairs, by pairing each with 31 its distinct additive inverse, i.e. x and m − x. These must be distinct, because otherwise, x = m/2, which is not relatively prime to m. Note that their product is x(m − x) ≡ mx − x2 ≡ −1 (mod m). Now if m has a primitive root, then by Proposition 8.7, A consists of only the two elements 1 and −1, so P ≡ −1 (mod m). Otherwise, by Example 4.9, the number of elements of A is a power of two that is at least 4, so the number of such pairs in A is even, and P ≡ 1 (mod m). Remark. For m prime, this simply becomes Wilson’s Theorem. Theorem 8.8. (1) If g is a primitive root of p, p a prime, then g or g + p is a primitive root of p2, according as gp−1 ̸≡ 1 (mod p2) or gp−1 ≡ 1 (mod p2). (2) If g is a primitive root of pk, where k ≥ 2 and p is prime, then g is a primitive root of pk+1. By Theorem 8.6, given a primitive root g of m, for each a relatively prime to m, there exists a unique integer i modulo ϕ(m) such that gi ≡ a (mod m). This i is called the index of a with respect to the base g, denoted by indg(a) (i is dependent on g, so it must be speciﬁed). Indices have striking similarity to logarithms, as seen in the following properties: (1) indg(1) ≡ 0 (mod ϕ(m)), indg(g) ≡ 1 (mod ϕ(m)), (2) a ≡ b (mod m) ⇒ indg(a) ≡ indg(b) (mod ϕ(m)), (3) indg(ab) ≡ indg(a) + indg(b) (mod ϕ(m)), (4) indg(ak) ≡ k indg(a) (mod ϕ(m)). Theorem 8.9. If p is a prime and a is not divisible by p, then the con- gruence xn ≡ a (mod p) has gcd(n, p − 1) solutions or no solutions according as a(p−1)/ gcd(n,p−1) ≡ 1 (mod p) or a(p−1)/ gcd(n,p−1) ̸≡ 1 (mod p). Proof. Let g be a primitive root of p, and let i be the index of a with respect to g. Also, any solution x must be relatively prime to p, so let u be the index of x. Then the congruence xn ≡ a becomes gnu ≡ gi (mod p) ⇔ nu ≡ i (mod p − 1). Let k = gcd(n, p − 1). Since g is a primitive root of p, k | i ⇔ gi(p−1)/k ≡ a (p−1)/k ≡ 1. The result now follows from Theorem 4.11. 32 Remark. Taking p to be an odd prime and n = 2, we deduce Euler’s criterion. Example 8.3 Let n ≥ 2 be an integer and p = 2n + 1. Show that if 3 (p−1)/2 + 1 ≡ 0 (mod p), then p is a prime. (The converse to Example 7.4.) Solution. From 3 (p−1)/2 ≡ 3 2n−1 ≡ −1 (mod p), we obtain 3 2n ≡ 1 (mod p), so the order of 3 is 2 n = p−1, but the order also divides ϕ(p) ≥ p−1. Therefore, ϕ(p) = p − 1, and p is a prime. Example 8.4. Prove that if n = 3 k−1, then 2 n ≡ −1 (mod 3 k). (A partial converse to Corollary 8.2.) Solution. By Example 8.1, 2 is a primitive root of 3 k. Therefore, 2 has order ϕ(3 k) = 2 · 3 k−1 = 2n ⇒ 2 2n ≡ 1 ⇒ (2 n − 1)(2 n + 1) ≡ 0 (mod 3 k). However, 2 n − 1 ≡ (−1) 3k−1 − 1 ≡ 1 ̸≡ 0 (mod 3), so 2 n + 1 ≡ 0 (mod 3 k). Example 8.5. Find all positive integers n > 1 such that 2 n + 1 n2 is an integer. (1990 IMO) Solution. Clearly, n must be odd. Now assume that 3 k∥n; that is, 3 k is the highest power of 3 dividing n. Then 3 2k | n2 | (2 n + 1) ⇒ 2 n ≡ −1 (mod 3 2k) ⇒ 3 2k−1 | n, by Corollary 8.2 ⇒ 2k − 1 ≤ k ⇒ k ≤ 1, showing that n has at most one factor of 3. We observe that n = 3 is a solution. Suppose that n has a prime factor greater than 3; let p be the least such prime. Then p | (2 n +1) ⇒ 2 n ≡ −1 (mod p). Let d be the order of 2 modulo p. Since 2 2n ≡ 1, d | 2n. If d is odd, then d | n ⇒ 2 n ≡ 1, contradiction, so d is even, say d = 2d1. Then 2d1 | 2n ⇒ d1 | n. Also, d | (p − 1), or 2d1 | (p − 1) ⇒ d1 ≤ (p − 1)/2 < p. But d1 | n, so d1 = 1 or d1 = 3. If d1 = 1, then d = 2, and 2 2 ≡ 1 (mod p), contradiction. If d1 = 3, then d = 6, and 2 6 ≡ 1 (mod p), or p | 63 ⇒ p = 7. However, the order of 2 modulo 7 is 3, which is odd, again contradiction. Therefore, no such p can exist, and the only solution is n = 3. Useful Facts • All prime divisors of the Fermat number 22n + 1, n > 1, are of the form 2 n+2k + 1. 33 Problems 1. Let p be an odd prime. Prove that 1 i + 2 i + · · · + (p − 1) i ≡ 0 (mod p) for all i, 0 ≤ i ≤ p − 2. 2. Show that if p is an odd prime, then the congruence x4 ≡ −1 (mod p) has a solution iﬀ p ≡ 1 (mod 8). 3. Show that if a and n are positive integers with a odd, then a2n ≡ 1 (mod 2 n+2). 4. The number 142857 has the remarkable property that multiplying it by 1, 2, 3, 4, 5, and 6 cyclically permutes the digits. What are other numbers that have this property? Hint: Compute 142857 × 7. 9 Dirichlet Series Despite the intimidating name, Dirichlet series are easy to work with, and can provide quick proofs to certain number-theoretic identities, such as Example 3.2. Let α be a function taking the positive integers to the integers. Then we say that f (s) = ∞∑ n=1 α(n) ns = α(1) + α(2) 2s + α(3) 3s + · · · is the Dirichlet series generating function (Dsgf ) of the function α, which we denote by f (s) ↔ α(n). Like general generating functions, these generating functions are used to provide information about their correspond- ing number-theoretic functions, primarily through manipulation of the gen- erating functions. Let 1 denote the function which is 1 for all positive integers; that is, 1(n) = 1 for all n. Let δ1(n) be the function deﬁned by δ1(n) = { 1 if n = 1, 0 if n > 1. It is easy to check that 1 and δ1 are multiplicative. 34 Now, let α and β be functions taking the positive integers to the integers. The convolution of α and β, denoted α ∗ β, is deﬁned by (α ∗ β)(n) = ∑ d|n α(d)β(n/d). Note that convolution is symmetric; that is, α ∗ β = β ∗ α. Theorem 9.1. Let f (s) ↔ α(n) and g(s) ↔ β(n). Then (f · g)(s) ↔ (α ∗ β)(n). We now do three examples. The Dsgf of 1(n) is the well-known Riemann Zeta function ζ(s): ζ(s) = ∞∑ n=1 1 ns = 1 + 1 2s + 1 3s + · · · , so ζ(s) ↔ 1(n). This function will play a prominent role in this theory. What makes this theory nice to work with is that we may work with these functions at a purely formal level; no knowledge of the analytic properties of ζ(s) or indeed of any other Dsgf is required. By Theorem 9.1, the number-theoretic function corresponding to ζ 2(s) is ∑ d|n 1(d)1(n/d) = ∑ d|n 1 = τ (n). Hence, ζ 2(s) ↔ τ (n). Finally, it is clear that 1 ↔ δ1(n). If α is a multiplicative function, then we can compute the Dsgf corre- sponding to α using the following theorem. Theorem 9.2. Let α be a multiplicative function. Then ∞∑ n=1 α(n) ns = ∏ p ∞∑ k=0 α(pk) pks = ∏ p [1 + α(p)p−s + α(p2)p−2s + α(p3)p−3s + · · · ], where the product on the right is taken over all prime numbers. 35 As before, if we take α = 1, then we obtain ζ(s) = ∏ p (1 + p−s + p−2s + p−3s + · · · ) = ∏ p ( 1 1 − p−s ) = 1 ∏ p(1 − p−s), an identity that will be useful. We say that a positive integer n > 1 is square-free if n contains no repeated prime factors; that is, p2 ∤ n for all primes p. With this in mind, we deﬁne the M¨obius function µ as follows: µ(n) =    1 if n = 1, 0 if n is not square-free, and (−1) k if n is square-free and has k prime factors. It is easy to check that µ is multiplicative. By Theorem 9.2, the corresponding Dsgf is given by ∏ p (1 − p−s) = 1 ζ(s). Hence, 1/ζ(s) ↔ µ(n), and this property makes the the seemingly mysterious function µ very important, as seen in the following theorem. Theorem 9.3. (M¨obius Inversion Formula) Let α and β be functions such that β(n) = ∑ d|n α(d). Then α(n) = ∑ d|n µ(n/d)β(d). Proof. Let f (s) ↔ α(n) and g(s) ↔ β(n). The condition is equivalent to β = α ∗ 1, or g(s) = f (s)ζ(s), and the conclusion is equivalent to α = β ∗ µ, or f (s) = g(s)/ζ(s). Theorem 9.4. Let f (s) ↔ α(n). Then for any integer k, f (s − k) ↔ nkα(n). 36 For more on Dirichlet series, and generating functions in general, see H. Wilf, Generatingfunctionology. Problems 1. Let α, β, and γ be functions taking the positive integers to the integers. (a) Prove that α ∗ δ1 = α. (b) Prove that (α ∗ β) ∗ γ = α ∗ (β ∗ γ). (c) Prove that if α and β are multiplicative, then so is α ∗ β. 2. Prove that the following relations hold: ζ(s − 1) ζ(s) ↔ ϕ(n), ζ(s)ζ(s − 1) ↔ σ(n), ζ(s) ζ(2s) ↔ |µ(n)|. 3. Let the prime factorization of a positive integer n > 1 be pe1 1 pe2 2 · · · pek k . Deﬁne the functions λ and θ by λ(n) = (−1) e1+e2+···+ek and θ(n) = 2 k. Set λ(1) = θ(1) = 1. Show that λ and θ are multiplicative, and that ζ(2s) ζ(s) ↔ λ(n) and ζ 2(s) ζ(2s) ↔ θ(n). 4. For all positive integers n, let f (n) = n∑ m=1 n gcd(m, n). (a) Show that f (n) = ∑ d|n dϕ(d). (b) Let n = pe1 1 pe2 2 · · · pek k > 1 be the prime factorization of n. Show that f (n) = ( p2e1+1 1 + 1 p1 + 1 ) (p2e2+1 2 + 1 p2 + 1 ) · · · ( p2ek+1 1 + 1 pk + 1 ) . 5. Verify Example 3.2 in one calculation. 37 6. Let id denote the identity function; that is, id(n) = n for all n. Verify each of the following identities in one calculation: (a) ϕ ∗ τ = σ. (b) µ ∗ 1 = δ1. (c) µ ∗ id = ϕ. (d) ϕ ∗ σ = id · τ . (e) σ ∗ id = 1 ∗ (id · τ ). 7. Let a1, a2, . . . , be the sequence of positive integers satisfying ∑ d|n ad = 2 n for all n. Hence, a1 = 2, a2 = 2 2 − 2 = 2, a3 = 2 3 − 2 = 6, a4 = 2 4 − 2 − 2 = 12, and so on. Show that for all n, n | an. Hint: Don’t use the Dsgf of (an) ∞ 1 ; use the M¨obius Inversion Formula. Bigger Hint: Consider the function f : [0, 1] → [0, 1] deﬁned by f (x) = {2x}, where {x} = x − ⌊x⌋ is the fractional part of x. Find how the formula in the problem relates to the function f (n) = f ◦ f ◦ · · · ◦ f | {z } n . 8. For all non-negative integers k, let σk be the function deﬁned by σk(n) = ∑ d|n d k. Thus, σ0 = τ and σ1 = σ. Prove that ζ(s)ζ(s − k) ↔ σk(n). 10 Miscellaneous Topics 10.1 Pell’s Equations Pell’s equations (or Fermat’s equations, as they are rightly called) are diophantine equations of the form x2 − dy2 = N , where d is a positive non- square integer. There always exist an inﬁnite number of solutions when N = 1, which we characterize. 38 Theorem 10.1.1. If (a, b) is the lowest positive integer solution of x2 − dy2 = 1, then all positive integer solutions are of the form (xn, yn) = ((a + b√d) n + (a − b√d) n 2 , (a + b√d) n − (a − b√d) n 2 √d ) . We will not give a proof here, but we will verify that every pair indicated by the formula is a solution. The pair (xn, yn) satisfy the equations xn + yn√d = (a + b√d) n, and xn − yn√d = (a − b√d) n. Therefore, x2 n − dy2 n = (xn + yn√d)(xn − yn√d) = (a + b√d) n(a − b√d) n = (a2 − db2) n = 1, since (a, b) is a solution. Remark. The sequences (xn), (yn) satisfy the recurrence relations xn = 2axn−1 − xn−2, yn = 2ayn−1 − yn−2. For x2 − dy2 = −1, the situation is similar. If (a, b) is the least positive solution, then the (xn, yn) as above for n odd are the solutions of x2 − dy2 = −1, and the (xn, yn) for n even are the solutions of x2 − dy2 = 1. Example 10.1.1 Find all solutions in pairs of positive integers (x, y) to the equation x2 − 2y2 = 1. Solution. We ﬁnd that the lowest positive integer solution is (3,2), so all positive integer solutions are given by (xn, yn) = ((3 + 2 √2) n + (3 − 2 √2) n 2 , (3 + 2 √2) n − (3 − 2 √2) n 2 √2 ) . The ﬁrst few solutions are (3,2), (17,12), and (99,70). 39 Example 10.1.2. Prove that the equation x2 − dy2 = −1 has no solution in integers if d ≡ 3 (mod 4). Solution. It is apparent that d must have a prime factor of the form 4k + 3, say q. Then x2 ≡ −1 (mod q), which by Theorem 4.9 is a contradiction. Problems 1. In the sequence 1 2, 5 3, 11 8 , 27 19, . . . , the denominator of the nth term (n > 1) is the sum of the numerator and the denominator of the (n − 1) th term. The numerator of the nth term is the sum of the denominators of the nth and (n−1) th term. Find the limit of this sequence. (1979 Atlantic Region Mathematics League) 2. Let x0 = 0, x1 = 1, xn+1 = 4xn − xn−1, and y0 = 1, y1 = 2, yn+1 = 4yn − yn−1. Show for all n ≥ 0 that y2 n = 3x2 n + 1. (1988 Canadian Mathematical Olympiad) 3. The polynomials P , Q are such that deg P = n, deg Q = m, have the same leading coeﬃcient, and P 2(x) = (x2 − 1)Q 2(x) + 1. Show that P ′(x) = nQ(x). (1978 Swedish Mathematical Olympiad, Final Round) 10.2 Farey Sequences The nth Farey sequence is the sequence of all reduced rationals in [0,1], with both numerator and denominator no greater than n, in increasing order. Thus, the ﬁrst 5 Farey sequences are: 0/1, 1/1, 0/1, 1/2, 1/1, 0/1, 1/3, 1/2, 2/3, 1/1, 0/1, 1/4, 1/3, 1/2, 2/3, 3/4, 1/1, 0/1, 1/5, 1/4, 1/3, 2/5, 1/2, 3/5, 2/3, 3/4, 4/5, 1/1. Properties of Farey sequences include the following: 40 (1) If a/b and c/d are consecutive fractions in the same sequence, in that order, then ad − bc = 1. (2) If a/b, c/d, and e/f are consecutive fractions in the same sequence, in that order, then a + e b + f = c d. (3) If a/b and c/d are consecutive fractions in the same sequence, then among all fractions between the two, (a + c)/(b + d) (reduced) is the unique fraction with the smallest denominator. For proofs of these and other interesting properties, see Ross Honsberger, “Farey Sequences”, Ingenuity in Mathematics. Problems 1. Let a1, a2, . . . , am be the denominators of the fractions in the nth Farey sequence, in that order. Prove that 1 a1a2 + 1 a2a3 + · · · + 1 am−1am = 1. 10.3 Continued Fractions Let a0, a1, . . . , an be real numbers, all positive, except possibly a0. Then let ⟨a0, a1, . . . , an⟩ denote the continued fraction a0 + 1 a1 + · · · + 1 an−1 + 1 an . If each ai is an integer, then we say that the continued fraction is simple. Deﬁne sequences (pk) and (qk) as follows: p−1 = 0, p0 = a0, and pk = akpk−1 + pk−2, q−1 = 0, q0 = 1, and qk = akpk−1 + qk−2, for k ≥ 1. Theorem 10.3.1. For all x > 0 and k ≥ 1, ⟨a0, a1, . . . , ak−1, x⟩ = xpk−1 + pk−2 xqk−1 + qk−2 . 41 In particular, ⟨a0, a1, . . . , ak⟩ = pk qk . Theorem 10.3.2. For all k ≥ 0, (1) pkqk−1 − pk−1qk = (−1) k−1, (2) pkqk−2 − pk−2qk = (−1) kak. Deﬁne ck to be the kth convergence ⟨a0, a1, . . . , ak⟩ = pk/qk. Theorem 10.3.3. c0 < c2 < c4 < · · · < c5 < c3 < c1. For a nice connection between continued fractions, linear diophantine equations, and Pell’s equations, see Andy Liu, “Continued Fractions and Diophantine Equations”, Volume 3, Issue 2, Mathematical Mayhem. Problems 1. Let a = ⟨1, 2, . . . , 99⟩ and b = ⟨1, 2, . . . , 99, 100⟩. Prove that |a − b| < 1 99!100!. (1990 Tournament of Towns) 2. Evaluate 8 v u u u √ 2207 − 1 2207 − 1 2207 − · · · . Express your answer in the form a+b √c d , where a, b, c, d are integers. (1995 Putnam) 10.4 The Postage Stamp Problem Let a and b be relatively prime positive integers greater than 1. Consider the set of integers of the form ax + by, where x and y are non-negative integers. The following are true: (1) The greatest integer that cannot be written in the given form is (a − 1)(b − 1) − 1 = ab − a − b. 42 (2) There are 1 2 (a − 1)(b − 1) positive integers that cannot be written in the given form. (3) For all integers t, 0 ≤ t ≤ ab − a − b, t can be written in the given form iﬀ ab − a − b − t cannot be. (If you have not seen or attempted this enticing problem, it is strongly suggested you have a try before reading the full solution.) Before presenting the solution, it will be instructive to look at an example. Take a = 12 and b = 5. The ﬁrst few non-negative integers, in rows of 12, with integers that cannot be written in the given form in bold, are shown: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 With this arrangement, one observation should become immediately ap- parent, namely that bold numbers in each column end when they reach a multiple of 5. It should be clear that when reading down a column, once one hits an integer that can be written in the given form, then all successive integers can be as well, since we are adding 12 for each row we go down. It will turn out that this one observation is the key to the solution. Proof. Deﬁne a grapefruit to be an integer that may be written in the given form. For each i, 0 ≤ i ≤ a − 1, let mi be the least non-negative integer such that b | (i + ami). It is obvious that for k ≥ mi, i + ak is a grapefruit. We claim that for 0 ≤ k ≤ mi − 1, i + ak is not a grapefruit. It is suﬃcient to show that i + a(mi − 1) is not a grapefruit, if mi ≥ 1. Let i + ami = bni, ni ≥ 0. Since i + a(mi − b) = b(ni − a), mi must be strictly less than b; otherwise, we can ﬁnd a smaller mi. Then i + a(mi − b) ≤ a−1−a = −1, so ni < a, or ni ≤ a−1. Suppose that ax+by = i+a(mi−1) = bni − a, for some non-negative integers x and y. Then a(x + 1) = b(ni − y), so ni − y is positive. Since a and b are relatively prime, a divides ni − y. However, ni ≤ a − 1 ⇒ ni − y ≤ a − 1, contradiction. Therefore, the greatest non-grapefruit is of the form bni − a, ni ≤ a − 1. The above argument also shows that all positive integers of this form are also non-grapefruits. Hence, the greatest non-grapefruit is b(a−1)−a = ab−a−b, proving (1). 43 Now, note that there are mi non-grapefruits in column i. The above tells us the ﬁrst grapefruit appearing in column i is nib. Since 0, b, 2b, . . . , (a−1)b appear in diﬀerent columns (because a and b are relatively prime), and there are a columns, we conclude that as i varies from 0 to a − 1, ni takes on 0, 1, . . . , a − 1, each exactly once. Therefore, summing over i, 0 ≤ i ≤ a − 1, ∑ i (i + ami) = ∑ i i + ∑ i ami = a(a − 1) 2 + a ∑ i mi = ∑ i bni = a(a − 1)b 2 ⇒ a ∑ i mi = a(a − 1)(b − 1) 2 ⇒ ∑ i mi = (a − 1)(b − 1) 2 , proving (2). Finally, suppose that ax1 + by1 = t, and ax2 + by2 = ab − a − b − t, for some non-negative integers x1, x2, y1, and y2. Then a(x1 + x2) + b(y1 + y2) = ab − a − b, contradicting (1). So, if we consider the pairs (t, ab − a − b − t), 0 ≤ t ≤ (a − 1)(b − 1)/2 − 1, at most one element in each pair can be written in the given form. However, we have shown that exactly (a − 1)(b − 1)/2 integers cannot be written in the given form, which is the number of pairs. Therefore, exactly one element of each pair can be written in the given form, proving (3). Remark. There is a much shorter proof using Corollary 2.4. Can you ﬁnd it? For me, this type of problem epitomizes problem solving in number theory, and generally mathematics, in many ways. If I merely presented the proof by itself, it would look artiﬁcial and unmotivated. However, by looking at a speciﬁc example, and ﬁnding a pattern, we were able to use that pattern as a springboard and extend it into a full proof. The algebra in the proof is really nothing more than a translation of observed patterns into formal notation. (Mathematics could be described as simply the study of pattern.) Note also that we used nothing more than very elementary results, showing how powerful basic concepts can be. It may have been messy, but one should never be afraid to get one’s hands dirty; indeed, the deeper you go, the 44 more you will understand the importance of these concepts and the subtle relationships between them. By trying to see an idea through to the end, one can sometimes feel the proof almost working out by itself. The moral of the story is: A simple idea can go a long way. For more insights on the postage stamp problem, see Ross Honsberger, “A Putnam Paper Problem”, Mathematical Gems II. Problems 1. Let a, b, and c be positive integers, no two of which have a common divisor greater than 1. Show that 2abc − ab − bc − ca is the largest integer that cannot be expressed in the form xab + yca + zab, where x, y, and z are non-negative integers. (1983 IMO) References A. Adler & J. Coury, The Theory of Numbers, Jones and Bartlett I. Niven & H. Zuckerman, An Introduction to the Theory of Numbers, John Wiley & Sons c⃝ First Version October 1995 c⃝ Second Version January 1996 c⃝ Third Version April 1999 c⃝ Fourth Version May 2000 Thanks to Ather Gattami for an improvement to the proof of the Postage Stamp Problem. This document was typeset under LATEX, and may be freely distributed provided the contents are unaltered and this copyright notice is not removed. Any comments or corrections are always welcomed. It may not be sold for proﬁt or incorporated in commercial documents without the express permis- sion of the copyright holder. So there. 45","libVersion":"0.3.1","langs":""}
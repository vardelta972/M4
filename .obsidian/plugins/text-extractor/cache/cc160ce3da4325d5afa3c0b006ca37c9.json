{"path":"iCloudDrive/bks/Combinatorics/Combinatorics/Multivariate Generating Functions - Zachary Abel - MR 2006.pdf","text":"Multivariate Generating Functions and Other Tidbits Zachary R. Abel 1 Introduction This article is devoted to some of the methods and applications of generating functions as used in Olympiad problem solving. Their basic properties are well known to many problem solvers; this article is intended to explore some more advanced applications and ideas, the most prominent of which is the use of multivariate generating functions. 2 What is a Generating Function? In the words of Herbert Wilf, “A generating function is a clothesline on which we hang up a sequence of numbers for display.” 1 This placeholder or ‘clothesline’ role is what makes them so valuable. Generating functions allow us to exploit the algebra of polynomials to model many otherwise unrelated situations. Our …rst example shows how generating functions can easily store important information and illustrates the importance of exploiting properties of polynomials. Problem 1 (Zeitz) A standard die is labeled 1, 2, 3, 4, 5, 6 (one integer per face). When you roll two standard dice, it is easy to compute the probability of the various sums. For example, the probability of rolling two dice and getting a sum of 2 is just 1/36, while the probability of getting a 7 is 1/6. Is it possible to construct a pair of “nonstandard” [six-sided] dice (possibly di¤ erent from one another) with positive integer labels that nevertheless are indistinguishable from a pair of standard dice, if the sum of the dice is all that matters? For example, one of these nonstandard dice may have the label 8 on one of its faces, and two 3’s. But the probability of rolling the two and getting a sum of 2 is still 1/36, and the probability of getting a sum of 7 is still 1/6. Proof. [Solution] We can encode the contents of a standard die as a generating function by letting the coe¢ cient of x k be the number of faces that contain the number k. Thus, we de…ne D(x) = x 1 + x 2 + x 3 + x 4 + x 5 + x 6: 1 This is the opening line in Herbert Wilf’s book generatingfunctionol- ogy, a marvelous and well-written textbook available for download at <http://www.math.upenn.edu/\u0000wilf/DownldGF.html>. 1 3 A MUST-KNOW TOOL Here is why this encoding is useful: consider the product D(x) \u0000 D(x) = (x 1 + x 2 + x 3 + x 4 + x 5 + x 6)(x 1 + x 2 + x 3 + x 4 + x 5 + x 6): To get a clear idea of what the expanded polynomial looks like, consider for example the coe¢ cient of x 6. The possible ways to get an x 6 term in the product are (x 1)(x 5), (x 2)(x 4), (x 3)(x 3), (x 4)(x 2), and (x 5)(x 1), so the coe¢ cient of x 6 is 5. Looking more closely, each of these terms in the expansion represents one of the 5 ways to roll a sum of 6 with two dice: 1 + 5, 2 + 4, 3 + 3, 4 + 2, and 5 + 1. In essence, the polynomial multiplication does all dice combinations for us and stores the results in the coe¢ cients. So by this reasoning, D(x) \u0000 D(x) = x 2 + 2x 3 + 3x 4 + 4x 5 + \u0000 \u0000 \u0000 + 2x 11 + x 12; where the coe¢ cient of x k represents the number of ways to roll a sum of k with two dice. We apply the same method to the nonstandard dice. Let a1; : : : ; a6 and b1; : : : ; b6 be the numbers on the two dice, and de…ne the generating functions A(x) = x a1 + \u0000 \u0000 \u0000 + x a6 and B(x) = x b1 + \u0000 \u0000 \u0000 + x b6 to describe these dice. By the same reasoning as above, the product A(x) \u0000 B(x) represents the generating function for the possible outcomes of the sum of the numbers on the two dice. Since these are supposed to be the same outcomes as those of two standard dice, we have A(x) \u0000 B(x) = D(x) \u0000 D(x). So we factor: A(x) \u0000 B(x) = (x 1 + x 2 + x 3 + x 4 + x 5 + x 6) 2 = x 2\u0000x 3(x 2 + x + 1) + (x 2 + x + 1) \u00002 = x 2(x 3 + 1) 2(x 2 + x + 1) 2 = x 2(x + 1) 2(x 2 \u0000 x + 1) 2(x 2 + x + 1) 2: It now remains to distribute these factors between A and B. Let A(x) = x e1(x+ 1) e2(x 2 \u0000x+1) e3(x 2 +x+1) e4 and B(x) = x f1(x+1) f2(x 2 \u0000x+1) f3(x 2 +x+1) f4 where the ei and fi are non-negative integers with ei + fi = 2 for 1 \u0000 i \u0000 4. Since A(0) = B(0) = 0, each polynomial is divisible by x, i.e. e1 = f1 = 1. Also, it is clear from their original de…nitions that A(1) = B(1) = 6, which means 2 e23 e4 = 2f23 f4 = 6, i.e. e2 = f2 = e4 = f4 = 1. If we also let e3 = f3 = 1 then A(x) = B(x) = D(x), which means both dice are standard. The only other option is to let e3 = 2 and f3 = 0 (or the other way around): A(x) = x(x + 1)(x 2 + x + 1)(x 2 \u0000 x + 1) 2 = x + x 3 + x 4 + x 5 + x 6 + x 8 B(x) = x(x + 1)(x 2 + x + 1) = x + 2x 2 + 2x 3 + x 4: Now we can easily read the contents of the dice directly from the generating functions: 1; 3; 4; 5; 6; 8 and 1; 2; 2; 3; 3; 4. Since this factorization was forced, it also follows that this is the only pair of nonstandard dice that works. 3 A Must-Know Tool The use of polynomials allows access to all the information stored in its co- e¢ cients through the manipulation of a single object. There are many ways Mathematical reflections 2, (2006) 2 3 A MUST-KNOW TOOL to utilize this relationship between the polynomial and its coe¢ cients, and the next problem gives another example of this. Problem 2 (Romanian MO ‘03) How many n-digit numbers, whose digits are in the set f2; 3; 7; 9g, are divisible by 3? Proof. [Solution] Since a number is divisible by 3 if and only if the sum of its digits is divisible by 3, we’ll …nd how many of those numbers have a digital sum divisible by 3. So let’s try to make a generating function F(x) = f0+f1x+f2x 2+ \u0000 \u0000 \u0000 + f9nx 9n where fk is the number of n-digit numbers with digits in f2; 3; 7; 9g and a digital sum of k. Then the answer we want is A = f0 + f3 + f6 + \u0000 \u0000 \u0000 + f9n. Each digit will add either 2, 3, 7, or 9 to the total digit sum, and so the generating function for each digit is x 2 + x 3 + x 7 + x 9. Thus, the generating function we’re looking for is simply F(x) = (x 2 + x 3 + x 7 + x 9) n: But how do we extract every third coe¢ cient of the polynomial? The ingenious answer comes from complex numbers. De…ne \" = e 2\u0000i=3 as one of the cube roots of unity, i.e. one of the solutions to x 3 = 1. This number has the simple property that 1 + \" + \"2 = 1\u0000\" 3 1\u0000\" = 0. This property allows us to single out every third coe¢ cient of F quite easily. We have F(1) = f0 + f1 + f2 + f3 + f4 + \u0000 \u0000 \u0000 F(\") = f0 + f1\" + f2\"2 + f3 + f4\" + \u0000 \u0000 \u0000 F(\"2) = f0 + f1\"2 + f2\" + f3 + f4\"2 + \u0000 \u0000 \u0000 ; and adding these equations gives F(1) + F(\") + F(\"2) = 3f0 + (1 + \" + \"2)f1 + (1 + \" + \"2)f2 + 3f3 + (1 + \" + \"2)f4 \u0000 \u0000 \u0000 = 3(f0 + f3 + f6 + \u0000 \u0000 \u0000 ) = 3A: With this we can easily calculate the answer to the problem: A = 1 3 \u0000F(1) + F(\") + F(\"2) \u0000 = 1 3 \u0000(1 + 1 + 1 + 1)n + (\"2 + 1 + \" + 1) n + (\" + 1 + \"2 + 1) n\u0000 = 1 3 \u00004n + 2 \u0000: The method used here is certainly not speci…c to 3, and it leads to an extremely important tool: Theorem 1 (Root of Unity Filter) De…ne \" = e 2\u0000i=n for a positive integer n. For any polynomial F(x) = f0 + f1x + f2x 2 + \u0000 \u0000 \u0000 (where fk is taken to be zero when k > deg F), the sum f0 + fn + f2n + \u0000 \u0000 \u0000 is given by f0 + fn + f2n + \u0000 \u0000 \u0000 = 1 n \u0000F(1) + F(\") + F(\"2) + \u0000 \u0000 \u0000 + F(\"n\u00001) \u0000 : Mathematical reflections 2, (2006) 3 4 MULTIPLE VARIABLES Proof. The proof is based on a property of the sum sk = 1 + \"k + \u0000 \u0000 \u0000 + \"(n\u00001)k. If n j k then \"k = 1 and so sk = 1 + 1 + \u0000 \u0000 \u0000 + 1 = n. Otherwise, \"k 6= 1 and sk = 1\u0000\" nk 1\u0000\"k = 0. So F(1) + F(\") + \u0000 \u0000 \u0000 + F(\"n\u00001) = f0s0 + f1s1 + f2s2 + \u0000 \u0000 \u0000 = n \u0000 (f0 + fn + f2n + \u0000 \u0000 \u0000 ) ; and the proof is complete after division by n. 4 Multiple Variables Now that we’re familiar with (or reminded of) some of the basics, we can get to the main focus of this article: multivariable generating functions. As we’ve mentioned before, the importance of generating functions is their spectacular ability to store large amounts of information. If you come across a problem that requires a lot of information storage and that poor little x can’t do it all, give it a buddy! Add other variables to help organize the information. We have chosen two di¢ cult examples to illustrate the enormous power of these multivariate generating functions. Problem 3 (IMO ‘95/6) Let p be an odd prime number. Find the number of subsets A of the set f1; 2; : : : ; 2pg such that (i) A has exactly p elements, and (ii) the sum of all elements in A is divisible by p. Proof. [Solution] Of course, we’ll use a generating function to store information about the subsets. But what information might we want to keep track of? The problem talks about the size and the sum of the subsets, so we probably want to have information on both of these. To this end, we’ll design a generating function G(x; y) = X n;k\u00000 gn;kx nyk such that gn;k is the number of k-element subsets of f1; 2; : : : ; 2pg with a sum of n. The answer to the problem is therefore A = gp;p + g2p;p + g3p;p + \u0000 \u0000 \u0000 . The construction of the generating function G is very straightforward. We ask ourselves, how could the number m a¤ect a subset? If it is not in the subset, then it a¤ects neither the sum nor the size. But if it is in the subset, then it increases the sum by m and the size by 1. So for each m we should have the term (1 + x my) in G. Therefore, G(x; y) = (1 + xy)(1 + x 2y)(1 + x 3y) \u0000 \u0000 \u0000 (1 + x 2py) is the generating function we’re looking for. To get to our answer A, we need to extract coe¢ cients from two types of terms of G: yp, and powers of x p. Since Mathematical reflections 2, (2006) 4 4 MULTIPLE VARIABLES we already have a tool to do the latter (the root of unity …lter), we choose to do this step …rst. De…ne \" = e 2\u0000i=p. The …lter tells us that X n;k\u00000 pjn gn;kyk = 1 p \u0000G(1; y) + G(\"; y) + \u0000 \u0000 \u0000 + G(\"p\u00001; y) \u0000; (1) so we need to calculate G(\"k; y) for 0 \u0000 k \u0000 p \u0000 1. When k = 0, G(1; y) = (1 + y) 2p. For 1 \u0000 k \u0000 p \u0000 1, since gcd(p; k) = 1, the numbers fk; 2k; \u0000 \u0000 \u0000 ; pkg form a complete list of residues modulo p (verify!), so G(\"k; y) = (1 + \"ky)(1 + \"2ky) \u0000 \u0000 \u0000 (1 + \"2pky) = \u0000(1 + \"ky)(1 + \"2ky) \u0000 \u0000 \u0000 (1 + \"pky) \u00002 = \u0000(1 + \"y)(1 + \"2y) \u0000 \u0000 \u0000 (1 + \"py) \u00002 = (1 + yp) 2: Putting these values back into equation (1) produces X n;k\u00000 pjn gn;kyk = 1 p \u0000(1 + y) 2p + (p \u0000 1)(1 + yp) 2\u0000 : Now that we have successfully extracted the coe¢ cients of the powers of x p, our second task of …nding the coe¢ cient of yp is easy: this coe¢ cient (and the answer to our problem) is 1 p \u0000\u00002p p \u0000 + 2(p \u0000 1) \u0000 : Our discussion of this next problem is written to o¤er motivation and insight into the solution, and as a result it is rather lengthy. For this reason we have broken it into two parts in order to highlight the two main ideas used in the solution. Let’s get started. Problem 4 (USAMO ‘86/5) By a partition \u0000 of an integer n \u0000 1, we mean here a representation of n as a sum of one or more positive integers where the summands must be put in nondecreasing order.(E.g., if n = 4, then the partitions \u0000 are 1 + 1 + 1 + 1, 1 + 1 + 2, 1 + 3, 2 + 2, and 4). For any partition \u0000, de…ne A(\u0000) to be the number of 1’s which appear in \u0000, and de…ne B(\u0000) to be the number of distinct integers which appear in \u0000.(E.g., if n = 13 and \u0000 is the partition 1 + 1 + 2 + 2 + 2 + 5, then A(\u0000) = 2 and B(\u0000) = 3). Prove that, for any …xed n, the sum of A(\u0000) over all partitions \u0000 of n is equal to the sum of B(\u0000) over all partitions \u0000 of n. Mathematical reflections 2, (2006) 5 4 MULTIPLE VARIABLES Proof. [Solution] The idea is to create two di¤erent generating functions A(x) = P anx n and B(x) = P bnx n, where an is the sum of A(\u0000) over all partitions \u0000 of n and bn is (you guessed it!) the sum of B(\u0000) over all partitions \u0000 of n. If we succeed in …nding A(x) and B(x), we can hopefully say that A(x) = B(x), which would show that an = bn for all n, which would solve the problem. (The wonderful tactic of wishful thinking is hard at work.) So, let’s create A. We need information on two things: the sum of the partitions and the number of 1’s in the partitions. So we make a generating function that gives us both pieces of that information: F(x; y) = X n;k\u00000 fn;kx nyk = (1 + xy + x 2y2 + \u0000 \u0000 \u0000 )(1 + x 2 + x 4 + \u0000 \u0000 \u0000 )(1 + x 3 + x 6 + \u0000 \u0000 \u0000 ) \u0000 \u0000 \u0000 We’ve used the variable x to keep track of the sum of each partition and the variable y to denote the number of 1’s in that partition: the coe¢ cient fn;k is, by design, the number of partitions of n that have k ones. We may rewrite the geometric series to obtain the relatively simple F(x; y) = 1 (1 \u0000 xy)(1 \u0000 x2)(1 \u0000 x3) \u0000 \u0000 \u0000 : (For those readers who are writhing in pain because of the informal treatment of in…nite products and sums, a peek at section 5 should calm you down.) Okay, so how do we pull A out of that generating function? The coe¢ cient an is the total number of 1’s in all partitions of n. This is equal to the number of partitions of n with a single 1, plus twice the number of partitions of n with two 1’s, plus 3 times the number of partitions of n with three 1’s, etc. Hence, an = fn;1 + 2fn;2 + 3fn;3 + \u0000 \u0000 \u0000 = X k\u00000 k \u0000 fn;k: Multiplying this by x n and summing over n \u0000 0 gives A(x) = X n\u00000 anx n = X n;k\u00000 k \u0000 fn;kx n: (2) Our goal now is to mold F into this sum. The key to transforming F into the generating function above is di¤erentiation. If we take the partial derivative of F with respect to y, we get @F @y = X n;k\u00000 k \u0000 fn;kx nyk\u00001: Then, setting y = 1 produces the sum in equation (2): @F @y \u0000 \u0000 \u0000 \u0000y=1 = X n;k\u00000 k \u0000 fn;kx n = A(x): Mathematical reflections 2, (2006) 6 4 MULTIPLE VARIABLES Now all that’s left to do is to calculate. We …nd that @F @y = @ @y \u0000 1 1 \u0000 xy \u0000 \u0000 1 (1 \u0000 x2)(1 \u0000 x3) \u0000 \u0000 \u0000 = x (1 \u0000 xy)2 \u0000 1 (1 \u0000 x2)(1 \u0000 x3) \u0000 \u0000 \u0000 ; and by putting in y = 1 we get A(x) = x (1 \u0000 x)2(1 \u0000 x2)(1 \u0000 x3) \u0000 \u0000 \u0000 : Good! We’re half done. Now we’ll try to create B(x). We will proceed in a similar manner. We …rst create a generating function to keep track of the sum of the partitions (with the variable x) and the number of distinct parts in the partitions (with y): G(x; y) = X n;k\u00000 gn;kx nyk = (1 + xy + x 2y + \u0000 \u0000 \u0000 )(1 + x 2y + x 4y + \u0000 \u0000 \u0000 )(1 + x 3y + x 6y + \u0000 \u0000 \u0000 ) \u0000 \u0000 \u0000 = \u00001 + xy 1 \u0000 x \u0000 \u0000 1 + x 2y 1 \u0000 x2 \u0000 \u0000 1 + x 3y 1 \u0000 x3 \u0000 \u0000 \u0000 \u0000 The coe¢ cient gn;k is the number of partitions of n with k distinct parts. Luck- ily, B and G have a familiar relationship. The number of distinct parts in all partitions of n is the number of partitions of n with only one distinct part, plus twice the number of partitions of n with two distinct parts, etc., which shows that bn = gn;1 + 2gn;2 + 3gn;3 + \u0000 \u0000 \u0000 = X k\u00000 k \u0000 gn;k: So once again we have B(x) = P n\u00000 bnx n = P k\u00000 k \u0000 gn;kx n, and by the same reasoning as above, B(x) = @G @y jy=1. All that we need to do now is di¤erentiate G with respect to y and plug in y = 1! Well, not quite. Unfortunately, it isn’t so easy to di¤erentiate an in…nite product of functions. The closest we can get is di¤erentiating …nite products. For example, if we de…ne a function H(x) = h1(x)h2(x)h3(x), then by repeated use of the product rule we obtain H0 = h0 1h2h3 + h1h0 2h3 + h1h2h0 3 = H \u0000 \u0000 h0 1 h1 + h0 2 h2 + h0 3 h3 \u0000 : This easily generalizes to the following: Theorem 2 (Generalized Product Rule) The derivative of the function H(x) = h1(x)h2(x) \u0000 \u0000 \u0000 hn(x), where each hk(x) is a di¤ erentiable function of x, is given by H0(x) = H(x) \u0000 nX k=1 h0 k(x) hk(x) : Mathematical reflections 2, (2006) 7 5 A MORE RIGOROUS TREATMENT The proof is an easy induction on n, which we have omitted. For the moment, to make sure we’re on the right track, let’s pretend that the generalized product rule holds for an in…nite product of functions. De…ne hk(y) = 1 + x ky 1\u0000xk , so that G(x; y) = h1(y)h2(y) \u0000 \u0000 \u0000 . We have hk(1) = 1 + x k 1\u0000xk = 1 1\u0000xk and h0 k(1) hk(1) = x k 1\u0000xk 1 1\u0000xk = x k; and so by the dubious extension of the product rule, B(x; y) = @G @y \u0000 \u0000 \u0000 \u0000y=1 = 1Y k=1 hk(1) ! \u0000 1X k=1 h0 k(1) hk(1) ! = 1Y k=1 1 1 \u0000 xk ! \u0000 1X k=1 x k! = 1 (1 \u0000 x)(1 \u0000 x2)(1 \u0000 x3) \u0000 \u0000 \u0000 \u0000 x 1 \u0000 x = x (1 \u0000 x)2(1 \u0000 x2)(1 \u0000 x3) \u0000 \u0000 \u0000 ; which is exactly what we want! Now that we’re con…dent of our method, we have to …gure out a way to make it rigorous. We will come back to this issue in a later section. 5 A More Rigorous Treatment It is natural to feel somewhat skeptical about the validity of some of the ma- nipulations we have been doing. And that skepticism has good reason! Consider the generating function for the Fibonacci numbers F(x) = F0 + F1x + F2x 2 + \u0000 \u0000 \u0000 = x 1 \u0000 x \u0000 x2 : (Can you prove this?) We can substitute x = 1 3 into this identity to prove 1 3 + 1 9 + 2 27 + \u0000 \u0000 \u0000 + Fn 3n + \u0000 \u0000 \u0000 = F( 1 3 ) = 1 3 1 \u0000 1 3 \u0000 1 9 = 3 5 ; which was a problem from the Round Four Individual Mandelbrot contest in February 2002. But on the same note, we can substitute x = 1 into the same identity to ‘prove’that the sum of all the Fibonacci numbers is F0 + F1 + F2 + \u0000 \u0000 \u0000 = F(1) = 1 1 \u0000 1 \u0000 1 = \u00001; which is absurd! Mathematical reflections 2, (2006) 8 5 A MORE RIGOROUS TREATMENT What went wrong? What makes this di¤erent from the Mandelbrot ques- tion? It seems that we need a more rigorous treatment of generating functions and a clear idea of what is and isn’t legal. So here goes. We begin by discussing the formal theory of generating functions. This theory deals with a generating function as a purely algebraic object, whose sole purpose is one of storage. For a sequence fangn\u00000, called the sequence of coe¢ cients, we de…ne its Ordinary Power Series Generating Function A(x) by A(x) = a0 + a1x + a2x 2 + a3x 3 + \u0000 \u0000 \u0000 : Ordinary generating functions are algebraic objects that form a ring whose laws of addition and multiplication are de…ned naturally: A(x) + B(x) = 1X n=0(an + bn)x n and A(x) \u0000 B(x) = 1X n=0 \u0000 nX i=0 aibn\u0000i\u0000x n: (This multiplication rule is what makes ordinary generating functions applicable to so many combinatorial situations.) Other operations can also be de…ned in an intuitive way. For example, di¤erentiation is de…ned by A0(x) = 1X n=0 n \u0000 anx n\u00001: But keep in mind that a formal generating function is nothing more than an algebraic object, and x is nothing more than a placeholder. It is not a variable, and the generating function A(x) is not a function of x. Therefore functional operations such as evaluating A(1) make absolutely no sense in the realm of formal generating functions. However, it is often desirable to use generating functions for more than their place-holding capabilities. In that case, we turn to analytic generating functions. Basically, if a generating function F(x) actually converges to an analytic function on some nontrivial domain, then we may treat F(x) as an analytic function of x when x is in that domain. The power series F(x) still has all the properties of formal generating functions, but it has the added bonus of being an analytic function, which makes it very useful. For example, with the Mandelbrot question, it is easy to determine that the radius of convergence of the power series F(x) = P n Fnx n is 1=\u0000 (\u0000 is the golden ratio), and thus when \u0000 is inside that bound, saying that \u0000 1 \u0000 \u0000 \u0000 \u00002 = F(\u0000) = F0 + F1\u0000 + F2\u00002 + \u0000 \u0000 \u0000 is a valid assertion. Since 1=3 meets this condition, our calculation of F( 1 3 ) makes sense. But x = 1 lies outside this domain, and so the expression F(1) is meaningless. In the solution to problem 3, we substituted values for x without checking that it was legal. But the function G(x; y) in that problem is merely a polynomial in x and y, and polynomials are certainly analytic functions. So we’re okay there. Mathematical reflections 2, (2006) 9 6 FINITIZATION With problem 4 we were already having di¢ culties when we tried to di¤er- entiate the in…nite product of functions. Well, now we have even more troubles: we need to be sure that F(x; y) and G(x; y) are analytic functions of x and y before we can start using them as such. And with the functions we have, it’s very di¢ cult to verify this, if it is even true! So we need a way to get around the challenges that in…nity poses. 6 Finitization The easiest way to sidestep the di¢ culties of in…nity is to eliminate in…nity from the problem and instead make everything …nite. We illustrate this idea of …nitization in the following completion of our solution to problem 4. Proof. [Solution cont.] Previously we de…ned a generating function G(x; y) and said that the generating function B(x) that we were looking for is equal to @G @y with y replaced by 1. But we don’t know how to take the derivative of the in…nite function, and we don’t know if we can substitute y = 1 legally. Finitization will help us to get around that. Fix a positive integer m, and de…ne Gm(x; y) = (1+xy+\u0000 \u0000 \u0000+x my)(1+x 2y+\u0000 \u0000 \u0000+(x 2) my) \u0000 \u0000 \u0000 (1+x my+\u0000 \u0000 \u0000+(x m) my): We have simply removed terms from G to make Gm, but we have not changed any of the terms containing x m or lower. So for the same reasons as before, gm must be the coe¢ cient of x m in @Gm @y jy=1. (We indicate this with the notation gm = [x m] @Gm @y jy=1.) The only di¤erence is that Gm(x; y) is a …nite polynomial, and so we can calculate this derivative and substitute y = 1 without any problems. De…ne hk(y) = 1 + x ky + \u0000 \u0000 \u0000 + x mky, so that Gm = h1(y) \u0000 \u0000 \u0000 hm(y). We calculate h0 k(1) hk(1) = x k + \u0000 \u0000 \u0000 + x mk 1 + xk + \u0000 \u0000 \u0000 + xmk = x k(1\u0000x mk) 1\u0000xk 1\u0000x(m+1)k 1\u0000xk = x k(1 \u0000 x mk) 1 \u0000 x(m+1)k ; and so the generalized product rule (theorem 2) indicates that @Gm @y \u0000 \u0000 \u0000 \u0000y=1 = mY k=1 hk(1) ! \u0000 nX k=1 h0 k(1) hk(1) ! = mY k=1 mX i=0 x ki! \u0000 nX k=1 x k(1 \u0000 x mk) 1 \u0000 x(m+1)k ! : Remember that bm is the coe¢ cient of x m in the analytic generating function above. But now we no longer care that this generating function is analytic; the only thing we care about it is that it has bm as the coe¢ cient of x m. So we may instead treat this polynomial as a formal generating function. This updated interpretation of the polynomial allows us to do two things. First, we may modify it as much as we want as long as the coe¢ cient of x m is not changed. And second, we don’t have to feel guilty about using in…nite expressions that may or may not converge, because we don’t care if they converge. So, now we will mold it without changing the x m term or any lower terms in order to get a better view of bm. First, the only term in x k(1 \u0000 x mk) 1 \u0000 x(m+1)k = x k(1 \u0000 x mk)(1 + x (m+1)k + x 2(m+1)k + \u0000 \u0000 \u0000 ) Mathematical reflections 2, (2006) 10 6 FINITIZATION that we care to preserve is x k; we may do away with the rest. The other alterations made to the polynomial in the next few steps also do not modify the terms we care about: bm = [x m] mY k=1 mX i=0 x ki! \u0000 mX k=1 x k(1 \u0000 x mk) 1 \u0000 x(m+1)k ! = [x m] mY k=1 1X i=0 x ki! \u0000 mX k=1 x k! = [x m] 1Y k=1 1 1 \u0000 xk ! \u0000 1X k=1 x k! = [x m] x (1 \u0000 x)2(1 \u0000 x2)(1 \u0000 x3) \u0000 \u0000 \u0000 : (Go through these steps carefully and convince yourself that none of the impor- tant terms has been changed.) Since our m was arbitrary, we have rigorously proved that B(x) = x (1\u0000x)2(1\u0000x2)(1\u0000x3)\u0000\u0000\u0000 is the generating function for the se- quence fbng. The construction of A that was given previously still contains the ‡aw of treating F as an analytic function without knowing if the in…nite product converges. But a similar application of …nitization will sidestep this with ease. We went to an extreme in the …nitization of G for the sake of instruction, but other options are available that also work with less painful algebra. Here’s an example of an easier …nitization used to make our construction of A rigorous. De…ne Fm(x; y) = (1 + xy + x 2y2 + \u0000 \u0000 \u0000 )(1 + x 2 + x 4 + \u0000 \u0000 \u0000 ) \u0000 \u0000 \u0000 (1 + x m + x 2m + \u0000 \u0000 \u0000 ): When jxj < 1 2 and jyj < 2, each of the geometric series in Fm converges, and since Fm is a …nite product of these, Fm converges in that region. Furthermore, the coe¢ cient of x m in Fm is the same as that in F. So we have am = [x m] @Fm @y \u0000 \u0000 \u0000 \u0000y=1 = [x m] x (1 \u0000 xy)2(1 \u0000 x2) \u0000 \u0000 \u0000 (1 \u0000 xm) \u0000 \u0000 \u0000 \u0000y=1 = [x m] x (1 \u0000 x)2(1 \u0000 x2) \u0000 \u0000 \u0000 (1 \u0000 xm) = [x m] x (1 \u0000 x)2(1 \u0000 x2)(1 \u0000 x3) \u0000 \u0000 \u0000 So we have now rigorously veri…ed the identity of A(x). (Notice we were careful to ensure that y = 1 lies in the domain we chose. And did you catch the subtle change from analytic to formal generating functions in those last steps?) We have rigorously shown that A and B are identical, from which it follows that an = bn for all n, so the problem is …nally solved. Mathematical reflections 2, (2006) 11","libVersion":"0.3.1","langs":""}
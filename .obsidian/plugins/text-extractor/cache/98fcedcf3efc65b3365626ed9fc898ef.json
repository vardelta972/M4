{"path":"iCloudDrive/bks/Number Theory/Number Theory 2/Kimball Martin/NT 2 (To the skies)/Notes (Individual sections)/chap3.pdf","text":"3 Zeta and L-functions In this section we will use analytic methods to (i) develop a formula for class numbers, and (ii) use this to prove Dirichlet’s theorem in arithmetic progressions: that any arithmetic progression: a + m, a +2m, a +3m, . . . contains inﬁnitely many primes gcd(a, m)=1. This chapter follows [Cohn], though our presentation is reversed from his, together with some supplementary material taken from various other sources. More general treatments are found in [Marcus] and [Neukirch], though they do not do everything we will do here. 3.1 Zeta functions Recall one deﬁnes the Riemann zeta function by ⇣(s)= X 1 ns . (3.1) One knows from calculus that this converges for s> 1 (compare with Z 1 1 1 xs dx = x1\u0000s 1 \u0000 s \u00001 x=1 = 1 1 \u0000 s < 1.) Euler observed that (for s> 1) one also has the product expansion ⇣(s)= X 1 ns = Y p ✓1+ 1 ps + 1 p2s + ·· ·◆ = Y 1 1 \u0000 p\u0000s . Here p runs over all primes of N. The last equality just follows from the formula for a geometric series: P1 n=0 an = 1 1\u0000a if |a| < 1. To see the why product expansion (middle equality) is valid, it’s perhaps easiest to ﬁrst notice that it is formally true for s =1,⇤ where it says X 1 n = ✓1+ 1 2 + 1 22 + 1 23 + ·· ·◆✓ 1+ 1 3 + 1 32 + 1 33 + ·· ·◆✓ 1+ 1 5 + 1 52 + 1 53 + ·· ·◆ ·· · (3.2) What does this (formal) inﬁnite product on the right mean? It just means a (formal) limit of the sequence of ﬁnite subproducts: 1+ 1 2 + 1 22 + 1 23 + ·· · = X n2N2 1 n ✓1+ 1 2 + 1 22 + 1 23 + ·· ·◆✓ 1+ 1 3 + 1 32 + 1 33 + ·· ·◆ =1 + 1 2 + 1 3 + 1 2 · 3 + 1 22 + 1 32 + 1 22 · 3 + 1 2 · 32 + ·· · = X n2N2,3 1 n ⇤When s =1, neither side of the equality actually converges, but the explanation for why both sides should be equal is perhaps more transparent. Here “formally” is not to be confused with rigorously—we mean we can formally manipulate one side to get to the other. 39 ✓1+ 1 2 + 1 22 + 1 23 + ·· ·◆✓ 1+ 1 3 + 1 32 + 1 33 + ·· ·◆✓ 1+ 1 5 + 1 52 + 1 53 + ·· ·◆ = X n2N2,3,5 1 n ... where Np1,p2,...,pk = \u0000pe1 1 pe2 2 ·· · pek k : ei 2 N [ {0} , i.e., Np1,p2,...,pk is the set of natural numbers which only contain the primes p1,. ..pk in their prime decomposition. We now prove rigorously that the formal product expansion for ⇣(s) given above is valid for s> 1. Deﬁnition 3.1.1. Let {p} denote the set of primes of N.Let ap 2 C for each p. We deﬁne Y p ap =lim n!1 Y n<x ap. Hence we will say Q ap converges (diverges) if the limit on the right does. We say Q ap con- verges absolutely if lim n!1 Y i<n api converges for any ordering {p1,p2,p3,. ..} of the set of primes {p}. In other words, a product converges absolutely if it converges regardless of the way we order the terms in the product. One can of course similarly deﬁne inﬁnite product over any denumerable index set Example 3.1.2. If some ap =0,then after some point (no matter how the p’s are ordered), we will have a ﬁnite subproduct of Q ap =0.Thus Q ap will converge to 0 absolutely. Note that if every ap > 0, then log(Q ap)= P log ap. An immediate consequence is that Q ap converges (absolutely) if and only if the series P log ap converges (absolutely). Proposition 3.1.3. Let (an)1 n=1 be a totally multiplicative sequence of complex numbers, i.e., amn = aman for any m, n 2 N,and assume a1 =1.If P an converges absolutely, then so does Qp 1 1\u0000ap and 1X n=1 an = Y p 1 1 \u0000 ap , where the product is taken over all primes p of N. Proof. Suppose P an converges absolutely. Let ✏ > 0. Then for some N 2 N we can say X n>N |an| < ✏. Let {p1,p2,. ..} be any ordering of the set of primes of N. Then there is some K 2 N such that {p1,. .., pK} contains all  N . Observe KY i=1 1 1 \u0000 api = KY i=1 \u00001+ ap + a2 p + ·· ·\u0000 = X n2Np1,...,pK an. 40 Since Np1,...,pK contains 1,. .., N ,we have \u0000 \u0000 \u0000 \u0000 \u0000 1X n=1 an \u0000 KY i=1 1 1 \u0000 api \u0000 \u0000 \u0000 \u0000 \u0000  \u0000 \u0000 \u0000 \u0000 \u0000 X n>N an \u0000 \u0000 \u0000 \u0000 \u0000  X n>N |an| < ✏. Corollary 3.1.4. For any s> 1 the Euler product expansion ⇣(s)= Y 1 1 \u0000 p\u0000s (3.3) is valid. Proof. Apply the proposition with an = n\u0000s. The Euler product expansion demonstrates that the zeta function captures information about primes. In fact, it contains a surprising amount of information about primes. The simplest appli- cation of the zeta function to the study of primes is Euler’s proof of the inﬁnitude of primes. Theorem 3.1.5. There are inﬁnitely many primes. Proof. Assume there are ﬁnitely many primes, p1,. .., pk. Then ⇣(s)= 1 1 \u0000 p\u0000s 1 · 1 1 \u0000 p\u0000s 2 ·· · 1 1 \u0000 p\u0000s k ! 1 1 \u0000 1/p1 · 1 1 \u0000 1/p2 ·· · 1 1 \u0000 1/pk < 1 as s ! 1. On the other hand ⇣(s)= X 1 ns ! X 1 n = 1 as s ! 1. Contradiction. Exercise 3.1. For any integer k> 1,one can show 1/⇣(k) represents the probability that k “ran- domly chosen” integers are coprime (have gcd 1). Let f (x)= x on [\u0000⇡, ⇡),compute the Fourier coeﬃcients and apply Parseval’s identity. Use this to compute ⇣(2),and hence determine the proba- bility that 2 randomly chosen integers are coprime. (Alternatively, you can try to derive the product expansion sin x x = 1Y n=1 ✓1 \u0000 ⇣ x n⇡ ⌘2◆ , and look at the x2 coeﬃcient to ﬁnd ⇣(2).) We will brieﬂy discuss some deeper connections of ⇣(s) to the study of primes, but ﬁrst let us give a generalization of the Riemann zeta function. Deﬁnition 3.1.6. Let K be a number ﬁeld. The Dedekind zeta function for K is ⇣K(s)= X a 1 N (a)s , for s> 1 where a runs over all (nonzero) ideals of OK. 41 As before, one can show this series indeed converges for all s> 1, and we have an Euler product expansion ⇣K(s)= Y p 1 1 \u0000 N (p)\u0000s valid for s> 1 as above. Hence the Dedekind zeta function can be used to study the prime ideals of of K. We remark that another way to write the above deﬁnition is ⇣K(s)= X an ns where an denotes the number of ideals of K with norm n (convince yourself of this). Consequently, the Dedekind zeta function can be used to study the number of ideals of norm n. However, we will be interested in it for its applications to the class number hK of K. 3.2 Interlude: Riemann’s crazy ideas Riemann published a single paper in number theory, On the Number of Primes Less Than a Given Magnitude in 1859, which was 8 pages long, contained no formal proofs, and essentially gave birth to all of analytic number theory. We will summarize the main ideas here. We only deﬁned the Riemann zeta function for real s> 1, but in fact Riemann considered it for complex values of s. In general if a> 0 and z 2 C, then one deﬁnes az = ez ln a where ez = X zn n! . This allows one formally to make sense of the deﬁnition ⇣(s)= X 1 ns for s 2 C, and one can show the sum actually converges provided Re(s) > 1. Riemann showed that ⇣(s) can be extended (uniquely) to a diﬀerentiable function on all of C except at s =1, where ⇣(s) has a pole (must be 1). However the above series expression is only valid for Re(s) > 1. Riemann showed that ⇣(s) has a certain symmetry around the line Re(s)= 1 2 , namely one has the functional equation ⇣(1 \u0000 s)= \u0000 ⇤(s)⇣(s) where \u0000⇤(s) is a function closely related to the \u0000 function. The functional equation says one can compute ⇣(1 \u0000 s) in terms of ⇣(s), so we can indirectly use the series for ⇣(s) to compute ⇣(s) when Re(s) < 0. The region 0 < Re(s) < 1 is called the critical strip, and the central line of symmetry Re(s)= 1 2 is called the critical line. Let {⇢} denote the set of zeroes of ⇣(s) inside of the critical strip. There are countably (inﬁnitely) many, and let us order them by their absolute value. Let f (x)= ⇡(x)+ 1 2 ⇡(x1/2)+ 1 3 ⇡(x1/3)+ ·· · 42 where ⇡(x) is the number of primes less than x. Riemann discovered the following formula for f (x) f (x) = Li(x) \u0000 X ⇢ Li(x⇢) \u0000 log(2) + Z 1 x dt t(t2 \u0000 1) ln t where Li(x)= R x 0 dt ln t . Hence this formula relates ⇡(x) with the (values of Li at the) zeroes of ⇣(s). In fact, using Möbius inversion, one can rewrite ⇡(x) in terms of f (x) (and therefore the zeroes of ⇣(s))as ⇡(x)= f (x) \u0000 1 2 f (x1/2) \u0000 1 3 (x1/3) \u0000 · · · Essentially this says the following: if we know exactly where all the zeroes ⇢ of ⇣(s) are we know exactly where the primes are (these are the places on the real line where ⇡(x) jumps). Here is where Riemann made his famous conjecture, the Riemann hypothesis, that all the zeroes of ⇣(s) lying in the critical strip actually lie on the critical line. (It is easy to see from series expansion that ⇣(s) 6=0 for Re(s) \u0000 1. Then by the functional equation, ⇣(1 \u0000 s)=0 for Re(s) > 1 if and only if \u0000⇤(s)=0, which happens precisely for s a positive odd integer. Thus the only zeroes of ⇣(s) outside of the critical strip, are the so-called trivial zeroes occurring when s = \u00002k, k 2 N.) In 1896, Hadamard and de la Vallée Poussin used Riemann’s ideas to prove the prime number theorem,that ⇡(x) ⇠ Li(x) ⇠ x ln x as x !1. (This notation means ⇡(x) is approximately x ln x for x large.) This is important, for example, in cryptography where one wants to know that the primes don’t get too thinly spread out, so that large primes provide suitably secure keys for RSA. The Riemann hypothesis is equivalent to the “best possible bound” for the error term in the prime number theorem, precisely that |⇡(x) \u0000 Li(x)| < 1 8⇡ px ln(x) for x \u0000 2657. The Riemann hypothesis has natural generalizations to Dedekind zeta functions and L-functions (see below). Due to a host of applications, the generalized Riemann hypothesis is considered one of the most important open problems in mathematics. 3.3 Dirichlet L-functions Let m 2 N. In 1837 (before Riemann!)⇤, Dirichlet introduced L-functions as a generalization of the Riemann zeta function in order to study the primes mod m. In particular, Dirichlet used these L-functions to show that there are inﬁnitely many primes ⌘ a mod m, which will be one of the main results of this chapter. This result had been conjectured by Euler for a =1 and by Legendre in general. Let’s start with the example of p ⌘ 1 mod 4. (Last semester we were able to use a trick together with the ﬁrst supplemental law of quadratic reciprocity to show there are inﬁnitely many primes p ⌘ 1 mod 4, and the case of p ⌘ 3 mod 4 was an exercise using a diﬀerent trick. Legendre tried to use quadratic reciprocity to treat the general case, but was unsuccessful, and as far as I know, there is no proof of the general case which does not use Dirichlet L-functions.) ⇤Riemann’s zeta function was studied before Riemann as a function of natural numbers by Euler. 43 Knowing Euler’s proof of the inﬁnitude of primes, one might be tempted to try to deﬁne a series by Y p⌘1 mod 4 1 1 \u0000 p\u0000s . This expands out as a sum X n2N1 1 ns where N1 is the set of all natural numbers which only contain primes ⌘ 1 mod 4 in their prime factorization. If the number of such primes is ﬁnite then the product expansion converges as s ! 1, and one would like to show the series expansion diverges to obtain a contradiction. However summing over N1 is not a natural thing to do and there is no simple way to directly analyze it. Hence we will have to be a little more subtle than this. Dirichlet, being smarter than this, had the following idea using characters. Let’s ﬁrst recall a couple things about characters of ﬁnite abelian groups. Deﬁnition 3.3.1. Let G be a ﬁnite abelian group. A character (or 1-dimensional representa- tion)of G is a group homomorphism into C⇥.The set of characters of G is denoted by ˆG,and is called the dual of G. Exercise 3.2. Let G be a ﬁnite abelian group. Let \u0000, \u0000 2 ˆG. (i) Show \u0000\u0000, deﬁned by (\u0000\u0000)(g)= \u0000(g)\u0000(g),is alsoin ˆG. (ii) Show \u0000, deﬁned by \u0000(g)= \u0000(g),is alsoin ˆG.(Here the bar denotes complex conjugation.) (iii) For any g 2 G,show \u0000(g) is a (not necessarily primitive) n-th root of unity† where n is the order of g in G. (iv) Deduce that \u0000\u0000 = \u00000,where \u00000 denotes the trivial character,i.e., \u00000(g)= 1 for all g 2 G. (v) Conclude that ˆG is an abelian group. Proposition 3.3.2. Let G be ﬁnite abelian group. Then ˆG ' G. Proof. Let us ﬁrst prove the proposition in the case G = Cn (the cyclic group of order n). Let ↵ be a generator of G. By (iii) of the exercise above, if \u0000 2 ˆG, then \u0000(↵) must be an n-th root of unity ⇣. Furthermore any n-th root of unity ⇣ deﬁnes (uniquely) a character on G by setting \u0000(↵k)= ⇣ k. (Observe this is character, and that nothing else can be.) In other words, a character is determined by what it does to a generator of G. Let ⇣n denote a primitive n-th root of unity (take ⇣n = e2⇡i/n if you wish). There are nn-th roots of unity, given by ⇣ 0 n =1, ⇣n, ⇣ 2 n,. .., ⇣ n\u00001 n . Hence there are precisely n distinct character of G, \u00000, \u00001, \u00002,. .., \u0000n\u00001 given by \u0000i(↵)= ⇣ i n. It is obvious then that (\u0000i\u0000j)↵ = ⇣ i+j n , i.e., \u0000i\u0000j = \u0000i+j mod n. Hence ˆG ' Z/nZ ' Cn. Now that we have prove the proposition in the case where G is cyclic, let us assume G is an arbitrary ﬁnite abelian group. Then we know by the classiﬁcation of such groups, G ' Q Cri ni. Set ⇣ni = e2⇡i/ni and let ↵i 2 G be a generator for Cni. As above, we can deﬁne characters \u0000ij on Cni by \u0000ij(↵i)= ⇣ j ni. We can extend each \u0000ij to a character on G by setting \u0000ij(↵k)=1 whenever i 6= k and using multiplicativity. In other words, view and g 2 G as g =(↵e1 1 , ↵e2 2 ,. .., ↵et t ) †⇣ 2 C is a primitive n-th root of unity if ⇣ n =1 but ⇣ d 6=1 for any d|n. For example there are four 4-th roots of unity: ±1, ±i,but only ±i are primitive. 44 and set \u0000ij(g)= ⇣ jei ni . Hence for each i, we get disjoint subgroups of ˆG each isomorphic to ˆCni ' Cni.It is straightforward to check that any character of G is a product of some \u0000ij’s, i.e., we have ˆG ' Y ˆCni ' Y Cni ' G. We will be interested in the case where G =(Z/mZ)⇥. Example 3.3.3. Suppose G =(Z/2Z)⇥.Then G = {1} = C1 so ˆG = {\u00000}.In other words, the only character of G is the trivial one \u00000 which sends 1 to 1. Example 3.3.4. Suppose G =(Z/3Z)⇥.Then G = {1, 2} ' C2 (here 1 and 2 represent the corresponding congruence classes in Z/3Z). Since 2 generates G and has order 2,there are two possibilities for characters: \u00000 :1 7! 1, 2 7! 1 and \u00001 :1 7! 1, 2 7! \u00001 So ˆG = {\u00000, \u00001} ' C2. Note that G =(Z/4Z)⇥ ' C2 also, so this case is essentially the same as (Z/3Z)⇥. Example 3.3.5. Suppose G =(Z/5Z)⇥.Then G = {1, 2, 3, 4} ' C4.Here 2 generates G,so a character of G is determined by what 4-th root of unity 2 maps to. Explicitly, we have 4 characters, whose values are read oﬀ of the following character table: 12 3 4 \u00000 11 1 1 \u00001 1 \u00001 \u000011 \u00002 1 i \u0000i \u00001 \u00003 1 \u0000ii \u00001 Looking at this table, it is easy to see ˆG is cyclic of order four, generated either by \u00002 or \u00003. Exercise 3.3. Determine all characters of (Z/15Z)⇥ and (Z/16Z)⇥.(Write them down in character tables like our (Z/5Z)⇥ case. Feel free to order the columns and rows however you ﬁnd easiest.) Theorem 3.3.6. Let CG = {f : G ! C} denote the space of complex valued functions from a ﬁnite abelian group G into C (the group algebra of G). This is a |G|-dimensional vector space over C. The characters \u0000 2 ˆG form a C-basis for CG. We omit the proof, and in fact we do not need this precise result, but it is helpful for motivation. What this means for us is the following. We want to study the primes p in a congruence class mod m.As long as p - m,we have p ⌘ a mod m for some a 2 (Z/mZ)⇥. Let {\u0000} denote the the set of characters of G =(Z/mZ)⇥ and ﬁx a 2 (Z/mZ)⇥. Consider the function f 2 CG given by f :(Z/mZ)⇥ ! C 45 f (x)= (1 x = a 0 else. In other words, f tells me if p mod m is a or not. What the above says is that f (x)= X c\u0000\u0000(x) for some c\u0000 2 C. Hence knowing \u0000(p mod m) for all \u0000 tells us whether p ⌘ a mod m or not. Slightly more generally, the above theorem says knowing \u0000(p mod m) for all \u0000 and p - m is the same as knowing p mod m for all p - m. Put another way, the characters of (Z/mZ)⇥ distinguish all the (invertible) congruence classes mod m. This suggest it is possible to study the primes ⌘ a mod m using the characters of (Z/mZ)⇥. To somehow connect this with something like the zeta function, one actually wants to think of the characters of (Z/mZ)⇥ as “characters” of Z. Deﬁnition 3.3.7. Let \u0000 be a character of (Z/mZ)⇥.We extend \u0000 to a function \u0000 : Z ! C by \u0000(a)= (\u0000(a mod m) if a is invertible mod m 0 else. The resulting function \u0000 : Z ! C is called a Dirichlet character mod m. Note that the values of \u0000 only depend upon congruence classes mod m. Then our remarks before the deﬁnition can be rephrased as follows: knowing the value of \u0000(p) for every Dirichlet character \u0000 mod m and every p - m is equivalent to knowing the value of p mod m for every p - m. Example 3.3.8. Consider \u00002 from our earlier (Z/5Z)⇥ example. Then the corresponding Dirichlet character is \u00002(a)= 8 >>>>>>< >>>>>>: 0 a ⌘ 0 mod 5 1 a ⌘ 1 mod 5 ia ⌘ 2 mod 5 \u0000ia ⌘ 3 mod 5 \u00001 a ⌘ 4 mod 5. Exercise 3.4. Let \u0000 be a Dirichlet character mod m.Then \u0000(ab)= \u0000(a)\u0000(b) for any a, b 2 Z. Deﬁnition 3.3.9. Let \u0000 be a Dirichlet character mod m.Then Dirichlet L-function (or L-series) for \u0000 is given by L(s, \u0000)= 1X n=1 \u0000(n) ns . (3.4) for s> 1. Note that since |\u0000(n)|  1 for all n (see Exercise 3.2(iii)), we can say |L(s, \u0000)|  X 1 ns = ⇣(s)(s> 1), 46 hence the series deﬁning L(s, \u0000) converges absolutely for s> 1. Because \u0000 is multiplicative by the exercise above, the same expansion trick we used for ⇣(s) above works to give a product expansion L(s, \u0000)= Y p 1 1 \u0000 \u0000(p)p\u0000s , (3.5) which again is valid for s> 1. (Just apply Proposition 3.1.3 with an = \u0000(n) ns .) Just like ⇣(1) = 1 told us there were inﬁnitely many primes, the most important value of L(s, \u0000) for primes in arithmetic progressions is L(1, \u0000) (which is not typically 1—it will be if and only if \u0000 = \u00000 is the trivial character mod m). Example 3.3.10. To return to the case of studying primes ⌘ 1 mod 4,look at the Dirichlet char- acters mod 4.Since (Z/4Z)⇥ ' C2,there are only two Dirichlet characters mod 4.We can write them as \u00000(a)= (0 a ⌘ 0, 2 mod 4 1 a ⌘ 1, 3 mod 4 (the trivial character) and \u00001(a)= 8 >< >: 0 a ⌘ 0, 2 mod 4 1 a ⌘ 1 mod 4 \u00001 a ⌘ 3 mod 4 (the nontrivial character). Then, for s> 1,wehave L(s, \u00000)= X n odd 1 ns = Y p6=2 1 1 \u0000 p\u0000s and L(s, \u00001)= X n⌘1 mod 4 1 ns \u0000 X n⌘3 mod 4 1 ns = Y p⌘1 mod 4 1 1 \u0000 p\u0000s · Y p⌘3 mod 4 1 1+ p\u0000s . Hence these L-functions are not too far from our original naive suggestion, and they are not too diﬃculty (though not trivial) to analyze. We also note that L(s, \u00000) is essentially ⇣(s)—it is oﬀ by asinglefactor ⇣(s)= 1 1 \u0000 2\u0000s L(s, \u00000), so L(1, \u00000)= (1 \u0000 2\u00001)⇣(1) = 1. From the series expansion of L(s, \u00001) it’s not to hard to see that L(1, \u00001)= 1 \u0000 1 3 + 1 5 \u0000 1 7 + 1 9 \u0000 · · · = ⇡ 4 (The latter equality, known as Leibnitz’s formula, follows from let x ! 1 in the Taylor series for arctan(x).) Now we can use this to show there are inﬁnitely many primes ⌘ 1 mod 4 and ⌘ 3 mod 4. Suppose there were ﬁnitely many primes p ⌘ 3 mod 4.Then the above formula for L(s, \u00001) shows ⇣(s)/L(s, \u00001)= 1 1 \u0000 2\u0000s Y p⌘3 mod 4 1+ p\u0000s 1 \u0000 p\u0000s 47 for s> 1.But then letting s ! 1 yields 1 1 \u0000 1 2 · Y p⌘3 mod 4 1+ 1 p 1 \u0000 1 p = ⇣(1) · 4 ⇡ = 1, which is a contradiction since the left hand side must be ﬁnite if there are only ﬁnitely many p ⌘ 3 mod 4. Similarly suppose there were ﬁnitely many primes p ⌘ 1 mod 4.Then ⇣(s)L(s, \u00001)= 1 1 \u0000 2\u0000s 0 @ Y p⌘1 mod 4 1 1 \u0000 p\u0000s 1 A 2 Y p⌘3 mod 4 1 1 \u0000 p\u00002s = 1 1 \u0000 2\u0000s 0 @ Y p⌘1 mod 4 1 1 \u0000 p\u0000s 1 A 2 0 @⇣(2s)(1 \u0000 2 \u00002s) Y p⌘1 mod 4(1 \u0000 p\u00002s) 1 A =(1 + 2\u0000s) Y p⌘1 mod 4 1 \u0000 p\u00002s (1 \u0000 p\u0000s)2 · ⇣(2s). for s> 1.Letting s ! 1, we see the right hand side is ﬁnite, since ⇣(2) = ⇡2 6 < 1 and the product has only ﬁnitely many terms, but the left hand side approaches ⇣(1)/L(s, \u00001)= 4 ⇡ 1 = 1, acontradiction. Hence just knowing that 0 < |L(1, \u00001)| < 1 allows us to conclude there are inﬁnitely many primes p ⌘ 1 mod 4 and inﬁnitely many p ⌘ 3 mod 4. Theorem 3.3.11. (Dirichlet’s theorem on arithmetic progressions) Suppose gcd(a, m)=1. Then there are inﬁnitely many primes p ⌘ a mod m. Proof. Let {\u0000} be the set of Dirichlet characters mod m. We consider the complex logarithm deﬁned by log(1 + z)= z \u0000 z2 2 + z3 3 \u0000 · · · . for |z| < 1. Then for any \u0000,we have \u0000 \u0000 \u0000 \u0000log ✓ 1 1 \u0000 \u0000(p)p\u0000s ◆\u0000 \u0000 \u0000 \u0000 = | log(1 \u0000 \u0000(p)p\u0000s)| = \u0000 \u0000 \u0000 \u0000 \u0000(p) ps + \u0000(p2) 2p2s + \u0000(p3) 3p3s + ·· · \u0000 \u0000 \u0000 \u0000 . It follows from the Taylor expansion of log(1 + x) that log ✓ 1 1 \u0000 \u0000(p)p\u0000s ◆ = \u0000 log(1 \u0000 \u0000(p)p\u0000s)= \u0000(p) ps + ✏p(s) where ✏p(s) is an error term satisfying |✏p(s)| < 1 p2s . Hence log L(s, \u0000)= X p \u0000(p) ps + ✏\u0000(s) where ✏\u0000(s)= Pp ✏p(s) so |✏\u0000(s)| < P 1 p2s . 48 Now consider the sum X \u0000 \u0000\u00001(a) log L(s, \u0000)= X \u0000,p \u0000\u00001(a)\u0000(p) ps + ✏(s) (3.6) where ✏(s)= P\u0000 \u0000\u00001(a)✏\u0000(s) is an error term. Now we appeal to a fundamental result from repre- sentation theory (see exercise below), the orthogonality relation for characters. This is essentially a reﬁnement of Theorem 3.3.6, saying that the characters ˆG of a group G form an orthogonal basis for CG. In our case, the orthogonality relation says X \u0000 \u0000\u00001(a)\u0000(p)= (\u0000(m) a ⌘ p mod m 0 else. (Here \u0000(m)= |(Z/mZ)⇥|.) Hence by ﬁrst summing over \u0000, we see the only p that contribute are those ⌘ a mod m. In other words X \u0000 \u0000\u00001(a) log L(s, \u0000)= \u0000(m) X p⌘a mod m \u0000(p) ps + ✏(s). (3.7) It is straightforward to check that the error term ✏(s) remains bounded as s ! 1 (exercise below). Thus if there are only ﬁnitely many primes p ⌘ a mod m, then the right hand side converges as s ! 1. In other words, it suﬃces to show the left hand diverges when s ! 1. Consider the trivial character \u00000. Then L(s, \u00000)= Y p-m 1 1 \u0000 p\u0000s = Y p|m(1 \u0000 p\u0000s) · ⇣(s), hence L(s, \u00000) ! Qp|m(1 \u0000 p\u00001) · ⇣(1) = 1 as s ! 1. Thus log L(s, \u00000) !1 as s ! 1. This means the sum (3.6) must tend to 1 as s ! 1 provided no single term \u0000\u00001(a) log L(s, \u0000) !\u00001 as s ! 1. This follows from the fact that L(s, \u0000) 6=0, which is the content of Proposition 3.4.7 in the next section. The fact that L(s, \u0000) 6=0 follows from Dirichlet’s class number formula, which is itself of great interest. Historically, Dirichlet proved his class number formula, and used this to prove his theorem on arithmetic progressions, though now there are other proofs that L(1, \u0000) 6=0. We will follow Dirichlet’s approach (at least the presentation in [Cohn]) and prove the class number formula, and use this to conclude the proof of Theorem 3.3.11 in the next section. Exercise 3.5. Let G = Z/nZ.Let a, b 2 G.Show X \u00002 ˆG \u0000\u00001(a)\u0000(b)= (|G| a = b 0 else. (Hint: use the fact that we know explicitly what the characters are as in the proof of Proposition 3.3.2.) This proves the orthogonality relation we used above in the case of cyclic groups. Exercise 3.6. Check that the error term ✏(s) appearing in the proof is bounded as s ! 1. 49 3.4 The class number formula The class number formula will fall out of analysis of the Dedekind zeta function. Let K = Q(pd) where d 6=1 is squarefree. Let \u0000 = \u0000K. Recall that for s> 1, ⇣K(s)= Y p 1 1 \u0000 N (p)\u0000s . If p|p where p is a prime of N, then N (p)= p if p is split or ramiﬁed and N (p)= p2 if p is inert. If p splits in K there are 2 prime ideals p lying above p, and otherwise there is just 1. So we can rewrite ⇣K(s)= Y p ramiﬁed 1 1 \u0000 p\u0000s Y p split ✓ 1 1 \u0000 p\u0000s ◆2 Y p inert 1 1 \u0000 p\u00002s = Y p ramiﬁed 1 1 \u0000 p\u0000s Y p split ✓ 1 1 \u0000 p\u0000s ◆2 Y p inert ✓ 1 1 \u0000 p\u0000s ◆✓ 1 1+ p\u0000s ◆ = Y p 1 1 \u0000 p\u0000s Y p split 1 1 \u0000 p\u0000s Y p inert 1 1+ p\u0000s = ⇣(s) Y p split 1 1 \u0000 p\u0000s Y p inert 1 1+ p\u0000s . Note that the two products on the right, look like one of Dirichlet’s L-functions. In fact, we know p splits in K if and only if \u0000\u0000 p \u0000 =1,and p is inert in K if and only if \u0000\u0000 p \u0000 = \u00001. Hence if we extend the Kronecker symbol \u0000\u0000 p \u0000 to a function from Z ! C by \u0000\u0000(n)= 8 >< >: 0 gcd(n, \u0000) > 1 \u0000\u0000 p1\u0000e1\u0000\u0000 p2\u0000e2 ·· · \u0000 \u0000 pk\u0000ek n> 0,n = pe1 1 pe2 2 .. .pek k and gcd(n, \u0000) = 1 \u0000\u0000(\u0000n)\u0000\u0000(|\u0000| \u0000 1) n< 0. One easily checks that \u0000\u0000 is a totally multiplicative function on Z which depends only upon con- gruences classes mod \u0000. Restricting to (Z/\u0000Z)⇥ gives only nonzero values, so we get a (group) character of (Z/\u0000Z)⇥. In other words, \u0000\u0000 is a Dirichlet character mod \u0000, and one has (for s> 1) L(s, \u0000\u0000)= Y \u0000\u0000(p)=(\u0000 p)=0 1 · Y \u0000\u0000(p)=(\u0000 p)=1 1 1 \u0000 p\u0000s · Y \u0000\u0000(p)=(\u0000 p)=\u00001 1 1+ p\u0000s . In other words, we have shown Lemma 3.4.1. For s> 1, ⇣K(s)= ⇣(s)L(s, \u0000\u0000). Theorem 3.4.2. (Dirichlet’s class number formula for imaginary quadratic ﬁelds) Let K = Q(pd) where d< 0 is squarefree. Then L(1, \u0000\u0000)= lim s!1 ⇣K(s) ⇣(s) = 2⇡hK wp\u0000\u0000 , where w is the number of roots of unity in OK,i.e., w =6 if d = \u00003, w =4 if d = \u00001 and w =2 otherwise. 50 Theorem 3.4.3. (Dirichlet’s class number formula for real quadratic ﬁelds) Let K = Q(pd) where d> 1 is squarefree. Then L(1, \u0000\u0000)= lim s!1 ⇣K(s) ⇣(s) = 2 log ⌘ hKp\u0000 , where ⌘ is the fundamental unit in OK. (For us, the fundamental unit ⌘ of OK where K is real quadratic is the unique unit ⌘ > 1 such that any unit of OK is of the form ±⌘m for some m 2 Z.) The quantity lims!1 ⇣K (s) ⇣(s) is called the residue of ⇣K(s) at s =1. The idea is that while ⇣K(s) and ⇣(s) both have a simple pole at s =1⇤, these poles should cancel in the quotient to give us a ﬁnite number that tells us about the arithmetic of K. Indeed, the quotient ⇣K(s)/⇣(s)= L(1, \u0000\u0000) is (or can be continued to) a well-deﬁned continuous function at s =1. Example 3.4.4. Let \u0000 = \u00004. The quadratic ﬁeld of discriminant \u0000 = \u00004 is K = Q(i),and Dirichlet’s class number formula says L(1, \u0000\u00004)= 2⇡hK 4 p4 = ⇡hK 4 . But we saw last section, that L(1, \u0000\u00004)=1 \u0000 1 3 + 1 5 \u0000 1 7 + ·· · = ⇡ 4 , hence the class number formula provides another proof that hK =1.Or if one wishes to approach things from the opposite direction, we see that the fact that hK =1 (which we proved in two other ways before: by showing Z[i] is a Euclidean domain and by using Minkowski’s bound) implies Leibnitz’s formula for ⇡ = 4(1 \u0000 1/3+ 1/5 \u0000 · · · ). Exercise 3.7. Using the fact that Q(p\u00003) has class number 1,determinevalueoftheseries 1 \u0000 1 2 + 1 4 \u0000 1 5 + 1 7 \u0000 1 8 + ·· · from the class number formula. Exercise 3.8. Analogous to the previous exercise, explicate the class number formula in the cases Q(p\u00005) and Q(p2).(I.e., write down explicitly what the series L(1, \u0000\u0000) is and determine its value from the class number formula.) Now you may think above exercises, while interesting, are sort of the opposite of what we want. Instead of using hK to determine L(1, \u0000\u0000), we would prefer to use L(1, \u0000\u0000) to determine the class number, as we gave an alternate proof for hQ(i) =1 in the example above. Thus we will need some way of evaluating the series L(1, \u0000\u0000)= Pn\u00001 \u0000\u0000(n) n (which converges conditionally). In fact, one can write down a ﬁnite expression for L(1, \u0000\u0000) to actually compute class numbers and we will discuss this later. First we want to prove the class number formula. This immediately implies L(1, \u0000\u0000) 6=0 for any \u0000. From this one can deduce that L(1, \u0000) 6=0 for any Dirichlet character \u0000, which will complete the proof of Dirichlet’s theorem on primes in arithmetic progressions. The proof of the class number formula relies on simple geometric lattice point counting problems. ⇤This means that they go to inﬁnity at the “same rate” as 1 1\u0000s . 51 Lemma 3.4.5. (Gauss) Suppose A, B, C are integers with B2 \u0000 4AC < 0.The number \u0000(T ) of lattice points (points in Z2)containedinthe solidellipse Ax2 + Bxy + Cy2  T satisﬁes \u0000(T )= 2⇡T p4AC \u0000 B2 + O(pT ) Recall the big-O notation means the following: for f, g : R ! R,wesay f (x)= O(g(x)) if |f (x)|  cg(x) for all x>X where X and c are some constants. Another way to say this is that f (x)= O(g(x)) means lim supx!1 |f (x)| g(x) < 1 (assuming g is positive). Proof. First we observe the area of the ellipse is 2⇡Tp4AC\u0000B2 . To see this, note that there is a change of variables ✓x0 y0 ◆ = ✓ cos ✓ sin ✓ \u0000 sin ✓ cos ✓ ◆✓ x y ◆ for some ✓ such that Ax2+Bxy+Cy2 = A0x02+C0y02 for some A0,C0. (In other words, we just rotate the ellipse so its major and minor axes are on the x0 and y0 axes.) However since the determinant of this transformation (a rotation matrix) is 1, the determinant B2 \u00004AC of the form Ax2 +Bxy +Cy2 equals the determinant \u00004A0C0 of the form A0x02 + C0y02. (Just check this explicitly.) Since the major and minor axes of the ellipse must have length 2 pT/A0 and 2 p T /B0, we know the area of the ellipse is A(T )= ⇡TpA0C0 = 2⇡Tp4AC\u0000B2 . Now we can tile R2 with squares, with each square having area one and centered about some lattice point (x, y) 2 Z2. Let m(T ) be the number of squares completely contained in our ellipse Ax2 + Bxy + Cy2  T and M (T ) be the smallest number of squares which completely contain the ellipse. Since \u0000(T ) is the number of squares whose center is contained in the ellipse, we clearly have m(T )  \u0000(T )  M (T ). The point is that m(T ) and M (T ) are both roughly the area A(T ) of the ellipse. Precisely, let n(T ) denote the number of squares which intersect the boundary Ax2 + Bxy + Cy2 = T of the ellipse. Note that m(T ) \u0000 A(T ) \u0000 n(T ) and M (T )  A(T )+ n(T ). (Draw a picture.) Thus A(T ) \u0000 n(T )  \u0000(T )  A(T )+ n(T ) for all n. So it suﬃces to show that n(T )= O(pT ). Interchanging x and y if necessary, we may assume that A  C, so the ellipse is wider in the x-direction than it is tall in the y-direction. Then n(T )  8+8p T/A = O(pT ) by the exercise below. Exercise 3.9. Show there are 4 points of slope ±1 on the ellipse Ax2 + Bxy + Cy2 = T with A  C. This breaks the ellipse up into 4 arcs. Show each arc intersects at most 2+2 p T/A squares in the tiling above by considering projections onto the x-and y-axes. 52 To put the proof in simpler terms, the number of lattice points in an ellipse is essentially the area of the ellipse, with some error term which is essentially determined by the arclength. If the area increases like T , then the arclength will increase like pT , hence the O(pT ) bound on the error. Let F (T ) denote the number of (nonzero) ideals I of OK with norm N (I)  T .We know F (T ) is ﬁnite for any T . Lemma 3.4.6. We have F (T )= hKT + O(pT ) where  = ( 2⇡ wp\u0000\u0000 \u0000 < 0 2log ⌘p\u0000 \u0000 > 0, using the notation above. The number  is called Dirichlet’s structure constant. So in this notation Dirichlet’s class number formula reads (in both cases) L(1, \u0000\u0000)= hK. Proof. For a nonzero ideal I of OK, set G(I,T )= {(↵) ✓ I :0 < |N (↵)|  T }, i.e., G(I,T ) is the number of principal ideals contained in I of (absolute) norm at most T .Suppose J is an ideal of OK equivalent to I \u00001. Then IJ =(↵) is a principal ideal contained in I. Conversely, any principal ideal (↵) ✓ I is of this form ↵ = IJ for J ⇠ I \u00001 and we have N (J )  T () |N (↵)| = N (JI)  TN (I). Hence G(I,T N (I)) is the number of ideals of norm  T which are equivalent to I \u00001. Thus we may write F (T )= G(I1,T N (I1)) + G(I2,T N (I2)) + ·· · + G(Ih,T N (Ih)) where I1,. .., Ih are a set of ideal representatives for the class group ClK. Consequently, the lemma follows if we can show G(I, T N (I)) = T + O(pT ) for any ideal I of OK. Suppose \u0000 < 0. Let \u00001, \u00002 be a Z-basis for I.Write ↵ = \u00001x + \u00002y. Then N (↵)= ↵↵ = Ax2 + Bxy + Cy2, where A = N (\u00001), B = Tr(\u00001\u00002) and C = N (\u00002). Hence the number of ↵ with norm  TN (I) is the number of lattice points (points of Z2) contained inside the solid ellipse Ax2 + Bxy + Cy2  TN (I).Note ↵ and ↵0 generate the same principal ideal if and only if they diﬀer by units. Hence G(I,T N (I)) is 1 w times the number of nonzero lattice points inside the ellipse Ax2 + Bxy + Cy2  TN (I). This ellipse has discriminant B2 \u0000 4AC = \u0000[\u00001, \u00002]= \u0000KN (I)2, so the desired estimate of G(I, T N (I)) follows from Gauss’s lemma above. Suppose \u0000 > 0. The idea is basically the same. If \u00001, \u00002 is a Z-basis for I and ↵ = \u00001x + \u00002y then |N (↵)| = |Ax2 + Bxy + Cy2| where A = N (\u00001), B = Tr(\u00001\u00002) and C = N (\u00002). However there will be inﬁnitely many solutions to |N (↵)|  TN (I) owing to the inﬁnitude of units. But there is a one-to-one correspondence of 53 elements ↵ 2 I satisfying 1  |↵/↵| < ⌘2, ↵ > 0 and principal subideals (↵) of I. Hence we may write G(I,T N (I)) as the number of nonzero solutions to the following system of equations: \u0000T  Ax2 + Bxy + Cy2  T, 1  | \u00001x + \u00002y \u00001x + \u00002y | < ⌘2, \u00001x + \u00002y> 0. Since the discriminant B2 \u0000 4AC of the quadratic form Ax2 + Bxy + Cy2 is positive, one gets not an ellipse but a hyperbolic region from the ﬁrst equation. The latter two equations leave us with two ﬁnite hyperbolic sectors to count lattice points in. By setting up an appropriate integral one can show the area is 2log ⌘ Tp\u0000 . For more details, see [Cohn]. Now we can prove the class number formula. Proof. We want to show L(s, \u0000\u0000)= hK. Recall we can write ⇣K(s)= P an ns where an is the number of ideals of norm n. Hence ⇣K(s)= F (1) 1s + F (2) \u0000 F (1) 2s + F (3) \u0000 F (2) 3s + ·· · = F (1) ✓ 1 1s \u0000 1 2s ◆ + F (2) ✓ 1 2s \u0000 1 3s ◆ + ·· · = 1X T =1 F (T ) ⇢ 1 T s \u0000 1 (T + 1)s \u0000 . For a ﬁxed T ,wehave 1 T s \u0000 1 (T + 1)s = 1 T s ⇢1 \u0000 ✓ T T +1 ◆s\u0000 = 1 T s ( 1 \u0000 ✓1+ 1 T ◆\u0000s) = 1 T s ⇢1 \u0000 ✓1 \u0000 s T + s(s + 1) 2!T 2 \u0000 s(s + 1)(s + 2) 3!T 3 + ·· ·◆\u0000 = s T s+1 + ✏(T, s). The third line follows from the Taylor expansion of (1 + x)\u0000s about x =0,and the ✏(T, s) is an error term satisfying |✏(T, s)| <C s2 T s+2 for some constant C from Taylor’s theorem with remainder. Hence ⇣K(s)= s 1X T =1 · F (T ) T s+1 + 1X T =1 F (T )✏(T, s) ! . Bear in mind that we will want to take the limit as s ! 1+. By the above lemma, we know F (T )  C1T for some C1. So for s in the range 1 <s< 2,we have 1X T =1 F (T )|✏(T, s)|  CC1s2T 1X T =1 1 T s+2  4C 1X n=1 1 n2 =4C⇣(2) < 1. 54 Thus we may write ⇣K(s)= s 1X T =1 F (T ) T s+1 + f.e. where f.e. (ﬁnite error) represents an error term which remains ﬁnite as s ! 1+.Again using the lemma above, we have ⇣K(s)= shk 1X T =1 1 T s | {z } ⇣(s)+ ✏2(T )s 1X T =1 1 T s+1 + f.e., where ✏2(T ) is an error term satisfying |✏2(T )|  C2pT for some constant C2. Then the middle term satisﬁes |✏2(T )|s 1X T =1 1 T s+1  2C2 1X T =1 1 T s+ 1 2  2C2⇣(s + 1 2 )  2C2⇣( 3 2 ) < 1 for 1 <s< 2. So we may write ⇣K(s)= shk⇣(s)+ f.e. Dividing both sides by ⇣(s) and sending s ! 1+ gives the class number formula. Proposition 3.4.7. Let \u0000 be a nontrivial Dirichlet character mod m.Then 0 < |L(1, \u0000)| < 1. This result completes the proof of Dirichlet’s theorem on primes in arithmetic progressions. Proof. If \u0000 is nontrivial, one can show the series P \u0000(n) n for L(1, \u0000) converges conditionally as one shows the alternating harmonic series converges in calculus. One shows that the series L(s, \u0000)= P \u0000(n) ns converges uniformly for s \u0000 1 so that P \u0000(n) n actually equals lims!1 L(s, \u0000). The details are standard analysis and we will omit them. It remains to show L(1, \u0000) 6=0. First suppose \u0000 is a real character, i.e., the image of \u0000 is contained in R. In particular, \u0000 can only take on the values ±1 and 0. We claim that \u0000(n)= \u0000\u0000(n) for some discriminant \u0000 of a quadratic ﬁeld K. Recall that (Z/mZ)⇥ = Q(Z/pei i Z)⇥ where m = Q pei i by the Chinese Remainder Theorem. This means any Dirichlet character mod m is just a product of Dirichlet characters mod pei i . Hence it suﬃces to prove the claim when m = pe for some prime p.Assume p is odd. (The case p =2 is an exercise below.) In this case (Z/mZ)⇥ is cyclic. Let ⇠ be the restriction of \u0000 to G =(Z/mZ)⇥, i.e., ⇠ is the group character of G =(Z/mZ)⇥ which gives rise to the Dirichlet character \u0000 : Z ! R.Note that ⇠ only takes on values ±1 so ⇠2 =1.If ⇠ is trivial, then so is \u0000, contrary to our assumption. Hence ⇠ must be an element of order 2 in ˆG.(⇠ is called a quadratic character.) But ˆG ' G is cyclic, so there is only 1 element of order 2 in ˆG. Let K = Q(pp) if p ⌘ 1 mod 4 and K = Q(p\u0000p) if p ⌘ 3 mod 4,so |\u0000| = p where \u0000 = \u0000K. Thus \u0000\u0000 · \u0000 deﬁnes a quadratic character of (Z/pZ)⇥. Composing this with the natural map from (Z/peZ)⇥ ! (Z/pZ)⇥ (just taking elements mod p) gives a nontrivial quadratic character of (Z/peZ)⇥, which must equal ⇠ since it has order 2 in ˆG. Hence \u0000\u0000 = \u0000.(\u0000\u0000 is naturally a Dirichlet character mod p, but it may also be regarded as a Dirichlet character mod m = pe.) This proves the claim that any real Dirichlet character mod m is of the form \u0000\u0000 for some quadratic ﬁeld discriminant \u0000 (which will sometimes be positive and sometimes be negative). But the class number formula immediately implies that L(1, \u0000\u0000) 6=0. 55 Now suppose \u0000 is a complex character, i.e., the image of \u0000 is not contained in R.Note the derivative L0(s, \u0000)= \u0000 1X n=1 \u0000(n) log n ns exists and is continuous for s \u0000 1 (this series converges uniformly). If \u00000 is a complex Dirichlet character mod m such that L(s, 1) = 0, then by the mean value theorem for any s> 1 there is a 1 <s0 <s such that, L(s, \u00000)= L(s, \u00000) \u0000 L(1, \u00000)= L0(s0, \u00000)(s \u0000 1). Similarly we have L(s, \u00000)= L0(s0, \u00000)(s \u0000 1) where \u00000 is the complex conjugate of \u00000 (which is easily seen to also be a Dirichlet character mod m). This means that L(s, \u00000) and L(s, \u00000) go to 0 at least as fast as s \u0000 1 as s ! 1 (faster if L0(s0, \u00000) also goes to 0). From (3.7) with a =1,wehave X \u0000 log L(s, \u0000)= \u0000(m) X p⌘1 mod m 1 ps + f.e. where \u0000 runs over all Dirichlet characters mod m and f.e. represents an error term which remains ﬁnite as s ! 1.As s ! 1,both log L(s, \u00000) and log L(s, \u00000) approach \u00001 at least as fast as log(s \u0000 1). But there is only one term on the left, log L(s, \u00000) where \u00000 is the trivial Dirichlet character mod m, which goes to 1. It goes to 1 at the same rate as log ⇣(s), which is \u0000 log(s \u0000 1). Hence the left hand side of the above equation goes to \u00001,but the right hand side stays positive (in fact goes to +1), a contradiction. Exercise 3.10. Suppose \u0000 is a real Dirichlet character mod m =2e.Using the fact that (Z/mZ)⇥ ' C2 ⇥ C2e\u00002 for e> 1,show \u0000 = \u0000\u0000 for \u0000 the discriminant of some quadratic ﬁeld. Exercise 3.11. Determine all real nontrivial Dirichlet characters mod m for m =3, 5, 6, 9, 15.For each of these characters \u0000 determine a quadratic ﬁeld discriminant \u0000 such that \u0000 = \u0000\u0000.For which \u0000 we can choose a \u0000 > 0 so that \u0000 = \u0000\u0000 and when we can choose a \u0000 < 0? In the proof for real characters, we used a Dirichlet character mod p to get a Dirichlet character mod pe. Exercise 3.12. If \u0000 is a Dirichlet character mod m,is it a Dirichlet character mod mn for any n? We have now seen how to prove the class number formula (omitting some details in the real quadratic case), and how one can use this to prove Dirichlet’s theorem on arithmetic progressions. Of course, the natural thing to try to use this formula for is computing class numbers. Dirichlet could do this by obtaining a ﬁnite expression for L(1, \u0000) using Gauss sums. Let \u0000 be a Dirichlet character mod m.We say \u0000 is even if \u0000(\u00001) = 1 and \u0000 is odd if \u0000(\u00001) = \u00001. By multiplicativity, these conditions are equivalent to the conditions \u0000(\u0000n)= \u0000(n) and \u0000(\u0000n)= \u0000\u0000(n), respectively, justifying the terminology of even and odd. For k 2 N [ {0}, deﬁne the k-th Gauss sum associated to \u0000 to be ⌧k(\u0000)= X a2(Z/mZ)⇥ \u0000(a)e2⇡iak/m. 56 From the deﬁnition, notice that the Gauss sums are something like “Fourier coeﬃcients” for \u0000. We will assume that \u0000 is primitive, which means that \u0000 is nontrivial and (regarded as a character of (Z/mZ)⇥) it does not come from a character of (Z/dZ)⇥ for any proper divisor d of m.(If d|m, then any character of (Z/dZ)⇥ gives a character of (Z/mZ)⇥ just by composition with the mod d map (Z/mZ)⇥ ! (Z/dZ)⇥.) Exercise 3.13. Determine which Dirichlet characters mod m are primitive for m =4, 8, 15.Find aformulaforthenumberofprimitiveDirichletcharactersmod m for any m 2 N. Proposition 3.4.8. Let \u0000 be a primitive character mod m.Then L(1, \u0000)= ( ⇡i⌧1(\u0000) m2 Pk2(Z/mZ)⇥ \u0000\u00001(k)k \u0000 odd \u0000 ⌧1(\u0000) m Pk2(Z/mZ)⇥ \u0000\u00001(k) log sin k⇡ m \u0000 even. Proof. For s> 1, the absolute convergence of the L-series for L(s, \u0000) implies we can write L(s, \u0000)= X a2(Z/mZ)⇥ ( \u0000(a) X n2mN+a 1 ns ) . Note the characters for the additive group (Z/mZ) are just given by !k(a)= e2⇡iak/m for 0  k  m \u0000 1. Hence the character orthogonality relations, namely that m\u00001X k=0 !k(a)!\u00001 k (n)= (ma ⌘ n mod m 0 else, tell us we can rewrite the inner sum above as 1 m 1X n=1 Pm\u00001 k=0 !k(a)!\u00001 k (n) ns = 1 m 1X n=1 Pm\u00001 k=0 e2⇡i(a\u0000n)k/m ns . Plugging this in to our ﬁrst equation gives L(s, \u0000)= 1 m m\u00001X k=0 ( ⌧k(\u0000) 1X n=1 !\u0000nk ns ) , for s> 1, where ! = e2⇡i/m. It is easy to see the Dirichlet series P1 n=1 !\u0000nk ns converges for s> 1, and as s ! 1+, one can check it approaches \u0000 log(1 \u0000 !\u0000k).(Plugging in s =1 gives the Taylor expansion for \u0000 log(1 \u0000 z) evaluated at z = !\u0000k.) This gives L(1, \u0000)= \u0000 1 m m\u00001X k=1 ⌧k(\u0000) log(1 \u0000 !\u0000k). (Up to here, we do not need that \u0000 is primitive, just nontrivial.) We again use some simple character theory to obtain that ⌧k(\u0000)= (\u0000\u00001(k)⌧1(\u0000) gcd(k, m)= 1 0 gcd(k, m) > 1. 57 Then L(1, \u0000)= \u0000 ⌧1(\u0000) m X k2(Z/mZ)⇥ \u0000\u00001(k) log(1 \u0000 !\u0000k). We can replace k with \u0000k in the sum and pull out a \u0000(\u00001) to get L(1, \u0000)= \u0000 \u0000(\u00001)⌧1(\u0000) m X k2(Z/mZ)⇥ \u0000\u00001(k) log(1 \u0000 !k). Using the fact that log(1 \u0000 !k) = log 2 + log sin k⇡ m + ✓ k m \u0000 1 2 ◆ ⇡i one can write L(1, \u0000)= \u0000 \u0000(\u00001)⌧1(\u0000) m X k2(Z/mZ)⇥ \u0000\u00001(k) ✓log sin k⇡ m + k⇡i m ◆ . Note that the log 2 terms drop out since Pk \u0000\u00001(k)= 0 by orthogonality relations. One ﬁnishes the proof by checking that Pk \u0000\u00001(k) log sin k⇡ m =0 if \u0000 is odd and Pk \u0000\u00001(k)k =0 if \u0000 is even. This immediately gives a more useable version of Dirichlet’s class number formula. Though the version we give below comes from one additional simpliﬁcation—namely, since hK > 0,we only need a formula for the absolute value |L(1, \u0000)| to compute hK. By taking absolute values in the above proposition, one can get rid of the Gauss sum (which has absolute value pm). We omit the details of the complete simpliﬁcation, but in the end, one has the following. Theorem 3.4.9. (Dirichlet’s class number formula, second form) Let K = Q(pd) be the quadratic ﬁeld of discriminant \u0000.Then hK = 8 < : 1 2\u0000\u0000\u0000(2) \u0000 \u0000 \u0000P1k<|\u0000|/2 \u0000\u0000(k)\u0000 \u0000 \u0000 \u0000 < 0, \u0000 6= \u00003, \u00004 1 log ⌘ \u0000 \u0000 \u0000P1k<\u0000/2 \u0000\u0000(k) log sin k⇡ \u0000 \u0000 \u0000 \u0000 \u0000 > 0. Here ⌘ denotes the fundamental unit of OK when \u0000 > 0. Note with this form of the class number formula, we can eﬀectively compute the class number of any quadratic ﬁeld, and this is much easier than the approach via Minkowski’s bound (though in the real quadratic case one needs to determine the fundamental unit). Additionally, since \u0000\u0000(n)= 0 unless gcd(n, \u0000) = 1, we may restrict the above sums to k relatively prime to \u0000. Example 3.4.10. For d = \u00002,i.e., K = Q(p\u00002),wesee \u0000 = \u00008, \u0000\u0000(n)= (1 n odd 0 n even, so hK = 1 2 |\u0000\u0000(1) + \u0000\u0000(3)| =1. Exercise 3.14. Using the second form of the class number formula compute hK where K = Q(pd) for d = \u00005, \u00006, \u00007, \u000010, 2. 58 3.5 Postlude: Beyond Dirichlet In this chapter we have shown (modulo a few details) two landmark results in number theory: (i) Dirichlet’s theorem on primes in arithmetic progressions (ii) Dirichlet’s class number formula for quadratic ﬁelds both of which used Dirichlet L-functions. Subsequent key developments in number theory, general- izing the above, are (I) prime density theorems (II) class number formulas for general number ﬁelds. Let us ﬁrst discuss the density theorems. Let P denote the set of primes in N,and S ✓ P.We say S has (natural) density‡ ⇢ if lim x!1 |{p 2 S : p< x}| |{p 2 P : p< x}| = ⇢. Of course any ﬁnite set of primes will have density 0, but inﬁnite sets of primes can have density 0 also. Using this notion, one can strengthen Dirichlet’s theorem on arithmetic progressions to the following: Theorem 3.5.1. Let m> 1 and a 2 N such that gcd(a, m)=1.Then the set of primes ⌘ a mod m has density 1 \u0000(m) . In other words, the number of primes ⌘ a mod m is the same for any a 2 (Z/mZ)⇥.Or put another way, the primes are distributed equally among the invertible congruence classes mod m. For example, there are the same number or primes ⌘ 1 mod 4 as there are ⌘ 3 mod 4 (in the sense of density). This is one example of a statistical regularity that prime numbers satisfy, despite their apparent randomness. Proving this requires signiﬁcantly more sophisticated analysis of Dirichlet L-functions. Another way to think about distribution of primes is in terms of how they split in extensions K of Q. For example the above statement about the number of primes ⌘ 1 mod 4 being the same as the number of primes ⌘ 3 mod 4 can be recast as saying the number of primes with split in Q(i) is the same as the number of primes which are inert in Q(i). In fact the above theorem is essentially equivalent to the following Theorem 3.5.2. Let K be a quadratic ﬁeld. The set of primes in P which split in K has density 1 2 ,as does theset ofprimes whichremain inert in K. In other words, half the primes split in K and half remain prime in K, for any quadratic ﬁeld K. This is a special case of a very strong theorem, called the Chebotarev density theorem. This provides much stronger regularity results about distributions of primes than just considering congruence classes. We haven’t deﬁned everything we need at this point to state the complete theorem, but here is a (corollary of a) special case. Theorem 3.5.3. Let K be a number ﬁeld of degree n and S be the set of primes in P which split completely in K.Then S has density ⇢ \u0000 1 n .Further ⇢ = 1 n if and only if K/Q is Galois. ‡There is another weaker notion of density, now called Dirichlet density, that coincides with natural density if the natural density exists, which is essentially what Dirichlet originally considered. 59 A proof of Chebotarev density involves a more general kind of L-function called an Artin L- function. The basic idea is the following. Even though we have several Dirichlet characters mod m for a given m, the most important Dirichlet characters are those of the form \u0000\u0000 where \u0000 is the discriminant of some quadratic ﬁeld K. On the other hand, if we start with some number ﬁeld K, there is a natural group associated to it, Gal(K/Q), and so one can look at the irreducible representations ⇢ of Gal(K/Q). Artin deﬁned an L-function L(s, ⇢) associated to each such Galois representation ⇢ in order to study how the primes split in K/Q (or more generally, an arbitrary extension L/K). This L-function has some L-series expansion as well as an Euler product. If ⇢ is the trivial character of Gal(K/Q), then L(s, ⇢) is essentially ⇣K(s) (they have the same Euler product expansions except at a ﬁnite number of primes). In the case where K is quadratic, then Gal(K/Q) has only 2 irreducible representations, both of dimension 1, i.e., both characters. If ⇢ is the nontrivial character of Gal(K/Q), then L(s, ⇢)= L(s, \u0000\u0000) where \u0000 = \u0000K.If ⇢0 is the trivial character, then L(s, ⇢0)= L(s, \u00000) where \u00000 is the trivial Dirichlet character mod \u0000. Hence the Artin L-functions are a generalization of (at least the most important cases of) Dirichlet L-functions. In this quadratic case we have L(s, ⇢0)L(s, ⇢)= L(s, \u00000)L(s, \u0000) ' ⇣K(s)L(s, \u0000)= ⇣(s), where ' means equal up to a ﬁnite number of factors in the Euler product. Similarly in the case of K a general number ﬁeld, we have Y ⇢ L(s, ⇢) ' ⇣K(s) Y ⇢ nontrivial L(s, ⇢)= ⇣(s), where ⇢ runs over all irreducible representations of Gal(K/Q). One has the following generalization of Dirichlet’s class number formula. Theorem 3.5.4. (General class number formula) Let K be a number ﬁeld and {⇢} be the set of irreducible representations of Gal(K/Q).Then Y ⇢ nontrivial L(1, ⇢)= lim s!1+ ⇣K(s) ⇣(s) = 2r1(2⇡)r2R wp|\u0000K| hK, where r1 (resp. r2)isthe number of real(resp. complex)embeddingsof K, w is the number of roots of unity in K,and R is the regulator of K. The regulator is basically the volume of a certain lattice which comes up in Dirichlet’s units theorem. This provides a way to compute and study class numbers for number ﬁelds of degree greater than 2. In the case K = Q(⇣p) where ⇣p is a primitive p-th root of unity, the class number formula provides a way to determine which primes are regular, i.e., for which p is gcd(p, hK)=1. The signiﬁcance of this is that Kummer was able to prove Fermat’s Last Theorem in the case of regular prime exponents. In fact, Wiles proved Fermat’s Last Theorem by (more or less) proving the Taniyama–Shimura Conjecture, which is itself a statement about L-functions. To certain curves (irreducible smooth cubic curves) called elliptic curves E one associates an L-function L(s, E). (It can be given by an Euler product where the factor corresponding to the prime p is given by the number of points on E mod p.) On the other hand, one also has L-functions L(s, f ) attached to modular forms f ,which 60 are certain periodic functions on the upper half plane. (The Euler product factors are given by the p-th Fourier coeﬃcients in a certain Fourier expansion.) The Taniyama–Shimura Conjecture is that every elliptic curve E corresponds to a modular form f in the sense that L(s, E)= L(s, f ). (Going from modular forms to elliptic curves is easier, and is known by work of Eichler and Shimura.) While the whole story is rather involved, let me just say that it is diﬃcult to directly compare el- liptic curves and modular forms, but one can associate to both of these objects certain 2-dimensional Galois representations. Thus to prove Taniyama–Shimura, one wants to show the Galois represen- tations coming from elliptic curves are contained in the set of Galois representations coming from modular forms. In a herculian endeavor, Wiles reduced (a suﬃcient part of) the Taniyama–Shimura conjecture to a theorem of Langlands and Tunnell (also a very diﬃcult result) which tells us every (odd) 2-dimensional complex Galois representation ⇢ : Gal(K/Q) ! GL2(C) with solvable image corresponds to a modular form. Let me emphasize 2 points: 1) L-functions provide a practical (though not typically easy) way to compare objects of diﬀerent types: geometric objects (curves and varieties), algebraic/arithmetic objects (number ﬁelds/Galois representations) and analytic objects (modular/automorphic forms). 2) Galois representations and/or automorphic forms/automorphic representations provide a gen- eral framework for studying many number theoretic problems. For example, if K is an abelian extension of Q, i.e., K/Q is Galois with abelian Galois group, then all representations of Gal(K/Q) are 1-dimensional. Hence the theory of 1-dimensional Galois representations provides a way to study abelian extensions of Q, and contains the case of Dirichlet characters and everything we did in this chapter. The fact that 1-dimensional Galois representations correspond to “1-dimensional” automorphic forms is essentially class ﬁeld theory, which provides a way to understand the abelian extensions of a number ﬁeld, and is the crowning achievement of classical algebraic number theory. In this context, we can view the Taniyama-Shimura conjecture as a sort of “2-dimensional” analogue of class ﬁeld theory. A large amount of present work in modern number theory is studying higher-dimensional analogues of class ﬁeld theory (often called non-abelian class ﬁeld theory). In fact, this is essentially the area of research Ralf Schmidt, Ameya Pitale and I specialize in (and it is related to Alan Roche and Tomasz Prezbinda’s research as well). For example, in my thesis I proved that certain 4-dimensional Galois representations with solvable image correspond to automorphic forms. We will give a brief introduction to class ﬁeld theory and higher-dimensional analogues in Part III. 61","libVersion":"0.3.1","langs":""}
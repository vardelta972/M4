{"path":"iCloudDrive/bks/Combinatorics/Combinatorics/Generating Functions - Maria Monks - MOP 2011.pdf","text":"Generating Functions Maria Monks June 21, 2011 A generating function is a clothesline on which we hang a sequence of numbers up for display. –Herbert Wilf, Generatingfunctionology Generating function basics Generating functions are a useful tool for solving recurrences and counting certain combi- natorial objects. A classic example of a generating function identity is 1 1 − x = 1 + x + x2 + x 3 + · · · . The term function is misleading - here x is just a formal symbol, and the coeﬃcients of the series are the important part. Let’s make this all rigorous. Deﬁnition. The generating function of the sequence c0, c1, c2, . . . with variable x is the expression c0 + c1x + c2x2 + · · · . We abbreviate this series as ∞∑ i=0 cixi. Generating functions are not functions, but they can still be added and multiplied together. They can also be diﬀerentiated! The following are the deﬁnitions of addition, multiplication, and diﬀerentiation of gen- erating functions (we’re starting from the beginning here - no calculus allowed.) • Addition: ∑∞ i=0 aixi + ∑∞ i=0 bixi = ∑∞ i=0(ai + bi)xi • Multiplication: (∑∞ i=0 aixi) · (∑∞ i=0 aixi) = ∑∞ n=0 (∑n i=0 aibn−i) xn • Diﬀerentiation: d dx (∑∞ n=0 anxn) = ∑∞ i=1 nanxn−1 Exercise. Is there a generating function that behaves like an “additive identity”? A “multi- plicative identity”? Can subtraction and division of generating functions be deﬁned? What about composition? Exercise. Use the deﬁnitions above to prove the generating function identity 1 1 − x = 1 + x + x2 + x 3 + · · · . (Notice that 1 − x = 1 − x + 0 · x2 + 0 · x3 + · · · is a generating function as well.) 1 Tricks for manipulating generating functions Let F (x) = ∑∞ n=0 anxn and G(x) = ∑∞ n=0 bnxn be generating functions over x. Try your hand at proving the following identities, using only the deﬁnitions above. • xF (x) = ∞∑ n=1 an−1xn • F (x) − a0 x = ∞∑ n=0 an+1xn • d dx (F (x) + G(x)) = d dx F (x) + d dx G(x) • d dx (F (x)G(x)) = G(x) · d dx F (x) + F (x) · d dx G(x) • If b0 ̸= 0, G(x) has a multiplicative inverse: G(x) −1 = b −1 0 − b −1 0 b1x + (b −3 0 b 2 1 − b −2 0 b2)x2 + · · · . • If b0 ̸= 0, d dx ( F (x) G(x) ) = G(x) d dx F (x) − F (x) d dx G(x) G(x)2 . Example. Show that 1 (1 − x)2 = 1 + 2x + 3x 2 + 4x 3 + 5x4 + · · · . Using generating functions to solve recurrences Suppose we wish to ﬁnd an explicit formula for the nth Fibonnacci number Fn, where F0 = 0, F1 = 1, and Fn = Fn−1 + Fn−2 for all n ≥ 2. Consider the generating function G(x) = ∞∑ n=0 Fnx n. We can manipulate this to take advantage of the recursion: we have G(x) − xG(x) − x2G(x) = F0 + F1x − F0x + ∞∑ n=2 (Fn − Fn−1 − Fn−2)xn = x. Thus G(x) = x/(1−x−x2). Using partial fractions and expanding each term as a geometric series, we ﬁnd that G(x) = ∞∑ n=0 1 √5 (( 1 + √5 2 )n − ( 1 − √ 5 2 )n) xn, and so Fn = 1√5 (( 1+ √5 2 )n − ( 1−√5 2 )n). In general, the generating function for any linear recurrence of the form An = c1An−1 + c2An−2 + · · · + ckAn−k can be written as a rational function of x, obtained by multiplying it by the characteristic polynomial 1 − c1x − c2x2 − · · · − ckxk and using the initial conditions to solve for the generating function. We can then use partial fraction decomposition and the geometric series formula to ﬁnd an explicit formula for the nth coeﬃcient. Exponential generating functions The exponential generating function for the sequence {ai}∞ i=0 is the series ∑∞ n=0 an n! xn. Their product behaves somewhat diﬀerently from that of ordinary generating functions: ( ∞∑ n=0 an n! xn) · ( ∞∑ n=0 bn n! xn) = ∞∑ n=0 1 n! ( n∑ k=0 (n k ) akbn−k ) xn Exercise. What do addition and diﬀerentiation do to exponential generating functions? We can deﬁne ex, sin(x), and cos(x) to be the exponential generating functions shown below. • ex = ∑∞ n=0 1 n! xn • sin(x) = ∑∞ n=0(−1)n 1 (2n+1)! x2n+1 • cos(x) = ∑∞ n=0(−1)n 1 (2n)! x2n Exercise. Using the deﬁnition of ex as a generating function, show that exey = ex+y and that d dx ex = ex. Problems! 1. (Andy Niedermaier.) Find a closed form for the generating function for each of the following sequences, and use it to ﬁnd an explicit formula for an: (a) a0 = 1, a1 = 5, an+2 = 4an+1 − 3an (b) a0 = 1, a1 = 6, an+2 = 4an+1 − 4an (c) a0 = 0, a1 = 5, a2 = 47, an+3 = 31an+1 + 30an (d) a0 = a1 = 1, an+2 = an+1 + 6an + n 2. Prove the following combinatorial identities using generating functions: (a) ∑n k=0 (n k)2 = (2n n ) (b) ∑n k=0 k(n k) = n · 2n−1 (c) (n 0) + (n 2) + (n 4) + · · · = (n 1) + (n 3) + (n 5) + · · · = 2n−1 3. Find an explicit formula for ( n 0 ) + ( n 3 ) + ( n 6 ) + ( n 9 ) + · · · in terms of n. 4. Derangements: Let Dn be the number of derangements of n, that is, the number of permutations ϕ of {1, 2, . . . , n} such that ϕ(i) ̸= i for any 1 ≤ i ≤ n. Find a closed form expression for the exponential generating function of Dn, and use it to ﬁnd a formula for Dn (the formula may include a ﬁnite sum.) 5. (China 1996.) Let n be a positive integer. Find the number of polynomials P (x) with coeﬃcients in {0, 1, 2, 3} such that P (2) = n. 6. (High school mathematics 1994/1, Qihong Xie.) Find the number of subsets of {1, 2, . . . , 2000}, the sum of whose elements is divisible by 5. 7. Let Cn denote the nth Catalan number, the number of ways of parenthesizing the addition of n ones. Find a closed form expression for the generating function C(x) =∑∞ n=0 Cnxn, and use it to show that Cn = 1 n+1 (2n n ). 8. Prove that ∑ i+j=n i,j≥0 ( 2i i )( 2j j ) = 4 n. 9. Delannoy numbers: Let Pm,n denote the number of paths from (0, 0) to (m, n) using only the moves (0, 1), (1, 0), and (1, 1) at each step. For example, one valid path from (0, 0) to (3, 4) is (0, 0), (0, 1), (1, 2), (2, 2), (3, 3), (3, 4). (a) Find a closed form expression for the generating function ∑ m,n≥0 Pm,nxmyn. (b) Find a closed form expression for the generating function of the “central” De- lannoy numbers: ∞∑ n=0 Pn,nxn. 10. (Richard Stanley.) Compute ∑ a1+a2+···+ak=n,k≥1 a1a2 · · · ak. 11. (102 Combinatorial Problems.) Let A1, A2, . . . , B1, B2, . . . be sets such that A1 = ∅, B1 = {0}, An+1 = {x + 1 | x ∈ Bn}, Bn+1 = An ∪ Bn − An ∩ Bn, for all positive integers n. Determine all positive integers n such that Bn = {0}. Some problems on partitions 1. Prove that the number of partitions of a positive integer n into distinct parts is equal to the number of partitions of n into odd parts. 2. Prove that the number of partitions of an integer n into distinct odd parts has the same parity as the total number of partitions of n. 3. Let p(n) be the number of partitions of n, that is, the number of sequences (λ1, . . . , λk) with λ1 ≥ · · · ≥ λk whose sum is n. Prove that ∞∑ n=0 p(n)xn = ( 1 1 − x ) ( 1 1 − x2 ) ( 1 1 − x3 ) · · · . 4. Let p(n, r) denote the number of partitions (λ1, λ2, . . . , λk) of n (written in nonincreas- ing order) such that λ1 − k = r. Let R(z, q) = ∑ n,r p(n, r)zrqn be its two-variable generating function. Prove that R(z, q) = 1 + ∞∑ n=1 qn2 ∏n k=1(1 − zqk)(1 − z−1qk) . 5. Prove Euler’s Pentagonal Number Theorem: (1 − x)(1 − x2)(1 − x3) · · · = ∞∑ n=−∞(−1) nxn(3n−1)/2. 6. Prove that p(5n + 4) ≡ 0 (mod 5). You may ﬁnd the following identity useful: ((1 − x)(1 − x2)(1 − x3) · · · )3 = ∞∑ n=0 (−1) n(2n + 1)xn(n+1)/2. 7. Let Q(n) be the number of partitions of n into distinct parts, that is, the number of sequences (λ1, . . . , λk) with λ1 > · · · > λk whose sum is n. Prove that ∞∑ n=0 Q(n)x n = (1 + x)(1 + x2)(1 + x3) · · · . 8. Let Q(n, r) be the number of partitions of n into distinct (decreasing) parts (λ1, . . . , λk) such that λ1 − k = r. Let G(z, q) = ∑ n,r Q(n, r)zrqn be its two-variable generating function. Prove that G(z, q) = 1 + ∞∑ s=1 qs(s+1)/2 ∏s k=1(1 − zqk) .","libVersion":"0.3.1","langs":""}
{"path":"iCloudDrive/bks/OlympiadQPs/Miscellaneous/Storage - Victor Wang - X.pdf","text":"Interesting problem solutions, storage Victor Wang October 23, 2013 1. (Miklos Schweitzer, 1987/1) The numbers 1, 2, . . . , n have been colored in three colors, so that every color is assigned to more than n/4 numbers. Prove that there exist numbers x, y, z of three diﬀerent colors such that x + y = z. Solution. If we color the odds with one color and split the other two colors evenly among the evens, we get an approximate equality case. Go by contradiction. Analyzing any two colors alone and saying (a, b) ∈ A × B =⇒ a ± b /∈ C is not a powerful condition used directly. However, a potentially useful idea is pigeonhole, if we can ﬁnd a number in (A − B) ∩ (B − C) ∩ (C − A) (where diﬀerence sets are deﬁned by absolute value). (*) First we WLOG 1 ∈ A. This means nothing in B borders a C, so strings of b’s and c’s are separated by a’s. Now it’s more obvious why (*) is helpful. If we have a substring bba or abb, for instance, cac is forbidden. Similarly, bba forbids acc and abb forbids cca. This is a very powerful condition. First it tells us that we can’t have both a bb and a cc, or else if WLOG the bb comes before the cc, they’re separated by an a and we have bba and acc at the same time. However, suppose we have bb but no cc; then we can’t have cac ahead or behind of the bb, since some a must lie between any b and c which means we get one of bba and abb in addition fo cac. This means that each c is bordered by two a’s (or one, if it’s on the border), yet is distance at least two from every other a. Thus no a is bordered by two c’s, so |A| ≥ 2|C| − 1 (how to consider the border: we start with an a, but we also might end with a c). But then n − |B| = |A| + |C| ≥ 2|C| − 1 + |C| forces n + 1 ≥ 4(n + 1)/4 = n + 1 with equality only when n ≡ 3 (mod 4) and |B| = |C| = (n + 1)/4 and |A| = 2|C| − 1 = (n − 1)/2. Hence we have (n − 3)/4 strings of aca and one string of ac (at the end), with strings of b’s in between. By pigeonhole or our assumption that a bb exists, we must have acabb somewhere. But then we get an a and b of diﬀerence 2, contradicting the fact that we start with aca and so 2 ∈ C. On the other hand, if there are no bb’s and cc’s, we have at least n/2 a’s and thus at most n/2 b’s and c’s in all. But we have at least (n + 1)/4 of each, contradiction. 2. If T is a subset of {1, 2, . . . , n} such that for all distinct i, j ∈ T , i does not divide 2j, prove that |T | ≤ 4n/9 + log2 n + 2. Solution. We generalize the classic problem by considering Sr,m = {r4 m3 a2 b : (a, b) ∈ {0, 1, 2, . . .} × {0, 1}} for r ≡ ±1 (mod 6) and m ≥ 0. Indeed, Sr,m ∩ T contains at most one number, so if g(n) = {4 mr : m ≥ 0, r ∈ {1, 7, . . .} ∩ {5, 11, . . .}} ∩ [1, n], then g(n) = ⌊(n + 5)/6⌋ + ⌊(n + 1)/6⌋ + g(n/4) ≤ n/3 + 1 + g(n/4), whence the conclusion follows easily by induction. 3. Let a, b, m, n be positive integers with a ≤ m < n < b. Prove that there exists a nonempty subset S of {ab, ab + 1, . . . , ab + a + b} such that ( ∏ x∈S x)/mn is the square of a rational number. Solution. The idea is that this is algebraic rather than number theoretic. If (m, n), (n, p) can be reached, then so can mp (except when mp is a perfect square, we may need to pay more attention). 1 Victor Wang Interesting problem solutions, storage (Simpliﬁcations like this are very important to make the problem conditions easier to work with, since it’s very hard to make things explicit – also, this is the best way to use the messiness of the rational condition.) For each 0 ≤ i ≤ b − a − 2, we ﬁnd positive ki such that ab ≤ (a + i)ki < (a + i + 1)ki ≤ ab + a + b. To do this, it’s enough to show that (use ⌊x⌋ = −⌈−x⌉) ⌊(ab + a + b)/(a + i + 1)⌋ ≥ ⌈ab/(a + i)⌉ ⇐⇒ ⌊(ab + a + b)/(a + i + 1)⌋ + ⌊−ab/(a + i)⌋ ≥ 0, or equivalently, ⌊(a − bi)/(a + i + 1)⌋ + ⌊bi/(a + i)⌋ ≥ 0. Let b = a + i + 2 + r for r ≥ 0; this reduces to 1+⌊(a − i(r + 1))/(a + i + 1)⌋+⌊(i(r + 1) − a)/(a + i)⌋ = ⌊(a − i(r + 1))/(a + i + 1)⌋+⌊i(r + 2)/(a + i)⌋ ≥ 0, which is trivial (with the second expression) when a − i(r + 1) ≥ 0. When a − i(r + 1) < 0, we use the fact that ⌊x⌋ + ⌊y⌋ ≥ ⌊x + y⌋ − 1, which follows from {x} + {y} − {x + y} ≤ {x} + {y} < 1 + 1. But 1/(a + i) > 1/(a + i + 1), so we’re done. The only possible issue arises when mn is a perfect square. But this is easy to ﬁx: suppose for contradiction that x2 < ab < ab + a + b < (x + 1) 2, so 2x > a + b ≥ 2 √ab. But then ab > x2 > ab, contradiction. 4. For a positive real x, let A(X) = {⌊nx⌋ : n ∈ N}. Find all irrational numbers α > 1 satisfying the following: if a positive real number β satisﬁes A(α) ⊃ A(β), then β α is integer. Solution. It helps to consider A(α′) = N\\A(α), where 1 α + 1 α′ = 1, since A(β) ⊆ A(α) iﬀ A(β)∩A(α′) = ∅. If A(β) ⊆ A(α), then for every n ∈ N, there exists m such that ⌊mα⌋ = ⌊nβ⌋, or equivalently, [⌊nβ⌋/α, ⌊nβ + 1⌋/α) contains an integer for every n. Weakening, this means ((nβ − 1)/α, (nβ + 1)/α) has an integer for all n ≥ 1. If β/α is irrational, then if 2/α ≤ 1 we can make this not work. If β/α is rational but noninteger, then β is irrational; for some arithmetic progression of n we can make {n(β/α)} = 1/q ≤ 1/2 < 1 − 1/α (where β/α = p/q and q > 1), and then using equidistribution theorem we can get {nβ} arbitrarily close to 0 on this arithmetic progression so that 0 < {n(β/α) − {nβ}/α} ≤ 1 − 1/α. This is, however, a messy condition, so we also need to consider the complement/dual with A(α′). Note that our condition above means that β/α, β, 1 are linearly dependent for any counterexample. We want to show that if 1 < α < 2, there don’t exist n, i, j such that n/β < i < (n + 1)/β and n/α′ < j < (n + 1)/α′. We know 1/β, 1/α, 1 are lineraly dependent, or equivalently, 1/β, 1/α′, 1 are linearly dependent. If we take 1/β + 1/α′ = 1/2, we get an easy contradiction since 2 | n or 2 | n + 1, so we’re done (β/α = 2/(2 − α)). Rational β may pose a small issue but it’s trivial to ﬁx. There’s another construction for the latter part. Note that A(β) ⊆ A(α) iﬀ A(β) ∩ A(α′) = ∅ iﬀ A(α′) ⊆ A(β′), so we might as well take β′ = α′/n for some integer n ≥ 1, as long as α′/n > 1. Then if this all works out, we easily compute β/α = 1/(n − α(n − 1)), so if n ≥ 2 gives a valid β′ we know that α doesn’t work; this occurs iﬀ α′ > 2 ⇐⇒ α < 2, so we can ﬁnish the α ≥ 2 case as above. 5. Given a positive integer n ≥ 3, colour each cell of an n × n square array with one of ⌊(n + 2) 2/3⌋ colours, each colour being used at least once. Prove that there is some 1 × 3 or 3 × 1 rectangular subarray whose three cells are coloured with three diﬀerent colours. Solution. KEY IDEA: EVERY TROMINO CONTAINS A PAIR (EITHER NORMAL OR DIS- JOINT) approach 1: 1. natural to try 3x3 (nice way is to consider ﬁrst row, then next two add at most 2) 2 Victor Wang Interesting problem solutions, storage 2. extend (1) to 3xn to get an asymptotically 1/3 # squares bound, which allows for an inductive solution 3. alternatively to get to 2, want to understand mxn for small m, n (m = 1, 2 are obvious though, and don’t allow for each induction if the leading quadratic constant is 1/3) approach 2: 1. global approaches diﬃcult; note that each tromino has ≥ 2 squares of some color, so because 2 + 2 > 3, exactly one color with ≥ 2 squares 2. want to analyze each color separately, so consider # x’s and # trominos “bearin” x and do some sums (each row, column independently) 3. alternatively to get to 2, consider number of normal pairs and disjoint pairs, then note that to count these pairs we want to sum over triples 6. On the cartesian plane are drawn several rectangles with the sides parallel to the coordinate axes. Assume that any two rectangles can be cut by a vertical or a horizontal line. Show that it’s possible to draw one horizontal and one vertical line such that each rectangle is cut by at least one of these two lines. Solution. Hmm... I think the key is to elaborate on the idea of considering the leftmost right and rightmost left sides (which comes from the one-dimensional analog). Let l(R), r(R), b(R), t(R) denote the left, right, bottom, and top coordinates of rectangle R. Two rectangles are connected if they can be cut by a line; vertical and horizontal connectivity refer to the orientation of the line. (Although it doesn’t really matter, in this solution we’ll include the boundary in the “interior” of a rectangle.) Suppose we have n ≥ 3 rectangles (n ≤ 2 is trivial), and order them according to r(R1) ≤ r(R2) ≤ · · · ≤ r(Rn). If Ri and Rj are horizontally connected for all 1 ≤ i < j ≤ n, we’re done by the one-dimensional analog. Otherwise, let 2 ≤ k ≤ n − 1 denote the smallest index such that there exists 1 ≤ i ≤ k − 1 with Ri, Rk horizontally disconnected. For k + 1 ≤ m ≤ n, place Rm in set S− if l(Rm) ≤ r(Rk) and S+ if l(Rm) > r(Rk). For all Rm ∈ S−, l(Rm) ≤ r(Rk) ≤ r(Rm), so we place a vertical line at r(Rk) to account for {Rk} ∪ S−. WLOG b(Ri) > t(Rk). For all Rm ∈ S+, l(Rm) > r(Rk) =⇒ Rm is vertically disconnected from R1, . . . , Rk and thus horizontally connected to each of R1, . . . , Rk−1, Rk (including Ri, Rk!). Further- more, R1, . . . , Rk−1 are pairwise horizontally connected by the minimality of k, while Rm1 , . . . , Rmℓ (where |S+| = ℓ) are pairwise horizontally connected by the horizontal lines in [t(Rk), b(Ri)] (which belong to the vertical “gap” in between Rk and Ri), so by the one-dimensional analog, there exists a horizontal line in [max(b(R1), . . . , b(Rk−1), b(Rm1), . . . , b(Rmℓ )), min(t(R1), . . . , t(Rk−1), t(Rm1 ), . . . , t(Rmℓ))], as desired (because R1, . . . , Rk−1, Rm1, . . . , Rmℓ are pairwise horizontally connected). Does this extend to arbitrary dimensions using a similar induction idea? vector ﬁelds solution There is a less explicit way to do the same thing. Take a minimal counterexample, which must clearly have at least two rectangles. Remove an arbitrary rectangle R; by minimality, we can assume the x and y axes satisfy the remaining n − 1 rectangles and R is in the ﬁrst quadrant. Assume the x- and y-axes are “maximal”, i.e. we can’t move either up or to the right without leaving some previously covered rectangle. Then some rectangle Rx has top edge the x-axis and is not covered by y-axis; similarly we can ﬁnd Ry with right edge the y-axis and not covered by x-axis. By the condition on R, Rx and R, Ry, we have Rx, Ry in the lower right and upper left quadrants, so Rx, Ry don’t satisfy the problem condition, contradiction. 3 Victor Wang Interesting problem solutions, storage 7. Let p ≥ 3 be a prime number and a1, . . . , ap−2 a sequence of integers such that p ∤ ai, a i i − 1 for each i. Prove that some distinct terms multiply to 2 (mod p). Solution. The ﬁrst thing we notice is that the 2 is very arbitrary multiplicatively. So we want to show that we can get everything modulo p. Even 1 is diﬃcult to get directly, unless we assume that one of the residues 2, 3, . . . , p − 1 cannot be reached (then use pigeonhole on a1, a1a2, . . .). We can try to convert the problem by taking a primitive root and passing to a sum problem modulo p − 1 (and generalize this to arbitrary n), but this is not obviously useful either: it’s only very easy to do when n is prime (e.g. CNS shows we can get every residue). (On a random note, if the problem had started from this direction, the appearance of ϕ(d) for all d | n can sometimes be better behaved when we order the integers and consider their gcd with n.) But keeping all equivalent problems in mind is always a good idea. Here, we notice that 2 p−2 gives us a LOT of choices. There are two ways to look at the last step. Either we want to try a greedy approach (since there is very little obvious structure but so many options) or work backwards. If we start backwards, suppose that x cannot be reached; then x/ai cannot be reached by subsets not involving ai, etc. – we can try to extend this logic to eventually get a contradiction. But it still boils down to doing the greedy approach backwards. Indeed, including the empty set as product 1, we start with S1 = {1, a1} as the set of products generated by the ﬁrst term. Now it’s easy to show that |Sk| ≥ k + 1 for each k by induction, which is where the ak k comes into play (it cannot permute a set of k elements upon multiplication, so when multiplied to a set of k elements it makes it larger). 8. (Bulgaria 1997) Let n ≥ 4 be an even integer, and A ⊆ [n] a subset with more than n/4 elements. Show that there exist elements a, b, c ∈ A (not necessarily distinct) with one of the numbers a + b, a + b + c, a + b − c divisible by n. Solution. Assume that x ∈ A =⇒ x /∈ A and ±a ± b ± c is not divisible by n for any a, b, c ∈ A and choice of signs. This is a very useful symmetry observation for the signs, because it’s then clear that we can exchange x and −x if we want, and one may be easier to analyze than the other. So we can assume A ⊆ {1, 2, . . . , m − 1}, where n = 2m. But A is sum-free, so m − 1 ≥ |A| + |A−A|−1 2 ≥ 2|A| − 1 forces |A| ≤ m 2 = n 4 , contradiction. Alternatively, let k be the smallest element of A and use the fact taht x, x + k can’t both be in A. (This is uglier though.) 9. (Gabriel Carroll MOP Handout) Let a1, . . . , an be positive integers with the followinng property: for any nonempty subset S ⊆ [n], there exists s ∈ S with as ≤ gcd(S). Prove that a1a2 · · · an | n!. Solution. We use prime counting for every p ≤ n. This is enough since taking S to be any one element gives as ≤ s. If p k ≤ n (for some ﬁxed p, k) divides ar1 , . . . , arℓ for some indices r1 < · · · < rℓ and ℓ ≥ 1 + ⌊n/pk⌋ (we’re going by contradiction), then taking S = {r1, . . . , rℓ} ﬁrst gives r1 ≥ p k. By the Euclidean algorithm we also have the bound p k ≤ rℓ−r1 ℓ−1 ≤ n−pk ℓ−1 , whence ℓ ≤ n pk , contradiction. Another idea is to ﬁnd a bijection f : [n] → [n] such that as | f (s) for every s. To do this, start from the largest ai and move down in size. Suppose that we can’t continue this procedure at some point: say we’ve picked all the multiples of am; then there exist ⌊n/am⌋ indices k (say they form a set T ) such that ak ≥ am (since we go in decreasing order of ai) and am | f (k). But then am ≤ gcd(T ∪ {m}) < am (either the smallest index is less than am or there is a gap less than am). The second solution can be reworded in terms of Hall’s marriage theorem, since if ai1 ≤ · · · ≤ air , then ai1 ≤ gcd(i1, . . . , ir) ≤ n/r means there are at least r multiples of ai1 less than or equal to n. All three of these solutions have the same spirit, however. 10. (Vietnam 1997) Find the largest real number α for which there exists an inﬁnite sequence a1, a2, . . . of positive integers such that an > 1997 n and a α n ≤ gcd{ai + aj | i + j = n} for each n ≥ 1. Solution. Note that α = 0 works for any sequence with an > 1997 n for all n, so we can assume α > 0. 4 Victor Wang Interesting problem solutions, storage If α ≥ 1 then an ≤ a1 + an−1 shows that an = O(n), so α < 1. Furthermore, a2n ≤ an + an shows that a2k ≤ 2 α−1aα −1 2k−1 , so by induction a2k ≤ 2 α −1+···+α−k a α −k 1 =⇒ 1997(2α) k ≤ 2 1+α+···+α k−1a1 < 2 1/(1−α)a1. Thus 2α ≤ 1. To ﬁnd a construction for α = 1/2, we use “sum-to-product” identities (motivated by Chebyshev polynomials, Fibonacci numbers, etc.): set α = N + √N 2 − 1 (so α−1 = N − √N 2 − 1) for some large integer N and deﬁne bn = αn + α−n for all n ≥ 0 (clearly these are all positive integers); letting an = α2n + α−2n for each n ≥ 1, we have ai + aj = α2i + α2j + α−2i + α−2j = (αi+j + α−i−j)(αi−j + αj−i) = bi+jb|i−j|. For N suﬃciently large, clearly an > α2n > 1997 n for each n, and gcd{ai + aj | i + j = n} ≥ bn = αn + α−n = √α2n + α−2n + 2 > √α2n + α−2n = a 1/2 n , as desired. 11. Let k ≥ 1 be a positive integer and G a tournament such that for every k-element subset S of V , there is a vertex v0 ∈ V \\ S such that v0 → v for all v ∈ S. Show that |G| ≥ (k + 2)2k−1 − 1. Solution. One may observe that such bounds are most easily generated through recursion. It will be convenient to let f (S) denote the intersection of N −1(v) for all v ∈ S. So our condition, in other words, states that |f (v1, . . . , vk)| ≥ 1 for all (v1, . . . , vk) ∈ V k (note that redundancies are ﬁne). Let F (k) be the best greatest lower bound we can put on |G|. Clearly F (1) = 3. So ﬁrst we can try direct induction. The idea is that if we ﬁx v1, then for all (v2, . . . , vk) ∈ V k−1 we have f (v2, . . . , vk) ∩ f (v1) ̸= ∅. In particular, |f (v2, . . . , vk)| ≥ 1 for all (v2, . . . , vk) ∈ f (v1) k−1, so by the inductive hypothesis |f (v1)| ≥ F (k − 1). If we take v1 to have minimal indegree, then we can show that F (k) ≥ 2F (k − 1) + 1; however, this is too weak for our desired bound. (*) Why is this direct bound weak? Because when we focus so much on v1 we lose a lot of information, even if minimality does give us signiﬁcant bounds. We should try to incorporate more variety into the picture by ﬁxing k − 1 vertices and playing around with this. Suppose we have |S| = k − 1. We can try to use the same idea as (*), but this is too weak: all we get is that |f (S)| ≥ F (1) = 3. So we should use a new idea: for every v ∈ G, f (v) ∪ f (S) = f (v ∪ S) ̸= ∅ means that something in f (S) points to v. Equivalently, v does not point to everything in f (S). This holds for all v ∈ G, however, whence |f (S)| ≥ k + 1 by the hypothesis. This is good progress because while we have weakened the condition from k vertices to k − 1, we have improved the bound from 1 to k + 1, which is extremely helpful if we want to get the extra (k + 2) factor in our bound! (**) We should continue this promising logic: let |S| = k − 2 for some S. Directly using the idea from (**), we get that some k + 1 vertices in f (S) point to v (for ﬁxed v ∈ G), or equivalently, that v points to at most |f (S)| − k − 1 vertices in f (S) for each v. But then the best we can show is |f (S)| ≥ 2k + 2, and in general if |S| = k − j the best we can do is |f (S)| ≥ j(k + 1); indeed, this is too weak since we only get a linear bound by repeatedly using the global fact that f (v1, . . . , vk) ≥ 1 in such a local setting, while almost ignoring the potential of our induction. However, (*) fortunately does the trick. Indeed, taking a vertex in f (S) of minimal degree, we have (|f (S)| − 1)/2 ≥ k + 1 (if |S| = k − 2), so |f (S)| ≥ 2k + 3. By induction, we can show that if |S| = k − j (where 0 ≤ j ≤ k), then |f (S)| ≥ 2 j−1(k + 2) − 1 (note that f (∅) = G from a bunch of vacuous statements; if this is uncomfortable, we can stop at j = k − 1 and do the last step alone, noting that the degree of each vertex, particularly the minimal degree vertex, is at least 2k−2(k + 2) − 1). For j = k, this is the desired bound, so we’re done. 5 Victor Wang Interesting problem solutions, storage 12. Let p, q be coprime positive integers. A subset S of the nonnegative integers is called ideal if 0 ∈ S and n + p, n + q ∈ S for every n ∈ S. Determine the number of ideal subsets of the nonnegative integers. Solution. Deﬁne [n]q as the remainder when n is divided by q, and for 0 ≤ i ≤ q − 1, let ai denote the smallest integer such that qai + [pi]q ∈ S. Then it’s clear that S is ideal iﬀ a0 = 0 and for 1 ≤ i ≤ q − 1, 0 ≤ ai ≤ ai−1 + p+[p(i−1)]q−[pi]q q = ai−1 +⌊ pi q ⌋−⌊ p(i−1) q ⌋ (consider “jumpin” between the residue classes p(i−1) (mod q) and pi (mod q)), i.e. if bi = ai − ⌊ pi q ⌋ for 0 ≤ i ≤ q − 1 with b0 = 0, then there is a clear bijection between the ideal subsets and the nonincreasing lattice paths (each step of length 1) from (0, 0) to (q, −p) that never drop below the line px + qy = 0. Now take ti = p if the i th step is rightward and ti = −q if the i th step is downward so that t1+· · ·+tp+q = 0, and consider the partial sums si = t1 + · · · + ti for 1 ≤ i ≤ p + q. Since p, q are relatively prime, they are pairwise distinct. Notice that the index 1 ≤ m ≤ p + q that minimizes sm is the only one that satisﬁes si+m − sm ≥ 0 for all 1 ≤ i ≤ p + q (indices taken (mod p + q)). But S is ideal iﬀ si ≥ 0 for all i, so exactly one cyclic shift of indices gives a working S, i.e. there are 1 p + q (p + q p ) ideal subsets. 13. Prove that there exists a positive real number C with the following property: for any integer n ≥ 2 and any subset X of the set {1, 2, . . . , n} such that |X| ≥ 2, there exist x, y, z, w ∈ X(not necessarily distinct) such that 0 < |xy − zw| < Cα−4 where α = |X| n . Solution. Nice problem! I think we can strengthen the bound to α−3 = n3/k3 (stronger since n/k ≥ 1)... does the following work? Let k = |X|, and go by contradiction (suppose that for every C, we can ﬁnd a counterexample with some n and X). First, since |X · X| ≥ k, we have n 2/k ≥ n2/|X · X| ≥ Cn 3/k3 by pigeonhole (since max X · X ≤ n2), so k2 ≥ Cn. Now note that if some diﬀerence d > 0 occurs twice, say for a, a + d and b, b + d with a ̸= b, then a(b + d) − b(a + d) = d(a − b). (This is the key to the nontrivial part of the solution, motivated by extending the diﬀerence of squares factorization.) Let D = ⌊5n/k⌋ ≥ 5n/k − 1 ≥ 4n/k; if P denotes the number of pairs {x, x + d} with 1 ≤ d ≤ D and x, x + d ∈ X and ti = |X ∩ (D(i − 1), Di]| for 1 ≤ i ≤ ⌈n/D⌉ (take C ≥ 8 so that k2 ≥ Cn = 8n ≥ 16 =⇒ k ≥ 4, whence ⌈n/D⌉ ≤ n/D + 1 ≤ k/4 + 1 ≤ k/2), then by Jensen on f (x) = x(x − 1)/2 (convex for x ≥ 0), t1 + · · · + t⌈n/D⌉ = k =⇒ P ≥ ( t1 2 ) + · · · + (t⌈n/D⌉ 2 ) ≥ ⌈n/D⌉( k/⌈n/D⌉ 2 ) = k 2 ( k ⌈n/D⌉ − 1) ≥ k 2 ( k k/2 − 1) = k 2 . But then P/D ≥ (k/2)/(5n/k) = k2/(10n), so by pigeonhole, there exists 1 ≤ d ≤ D such that there exist ℓ ≥ k2/(10n) elements a1 < · · · < aℓ with ai, ai + d ∈ X for 1 ≤ i ≤ ℓ. We can take C ≥ 20 so that k2 ≥ Cn = 20n =⇒ ℓ ≥ k2/(10n) ≥ k2/(20n) + 1. 6 Victor Wang Interesting problem solutions, storage By pigeonhole, there exists 1 ≤ j ≤ ℓ − 1 such that 0 < aj+1 − aj ≤ n/(ℓ − 1) ≤ 20n2/k2. But then 0 ̸= |aj(aj+1 + d) − aj+1(aj + d)| = d(aj+1 − aj) ≤ D 20n2 k2 ≤ 100n3 k3 , a contradiction for suﬃciently large C. Comment. Originally I set D = ⌊5n2/k2⌋ to get the α−4 case (we cannot simply set D = n; this is too weak due to the scarcity of large diﬀerences), but later found this improvement while looking for optimal X (intuitively, it seems like X = {d, 2d, . . . , ⌊n/d⌋d}, which gets α−2, should be close to the best). The current method loses a factor of α because for this construction, the only possible diﬀerences are multiples of d. Any ideas (for either direction)? I think the size of |X · X| may be an important consideration as well, although geometric progressions make the pigeonhole application n2/|X · X| very weak. 14. Show that for two non-constant integer polynomials f, g, there exist inﬁnitely many primes p such that there exist x, y with p | f (x), g(y). Solution. The idea is to ﬁnd u(x) and v(x) such that some non-constant polynomial p(x) with integer coeﬃcients divides f (u(x)) and g(v(x)). The corresponding problem for p(x) (sometimes known as Schur’s theorem) is easy: if p(0) = 0, obvious; if p(0) = 1, consider p(p(1)p(2) · · · p(n)) ≡ p(0) = 1 (mod p(1)p(2) · · · p(n)) to generate inﬁnitely many primes; if p(0) ̸= 0, 1, then consider q(x) = p(xp(0))/p(0) instead to reduce it to previous case. It will be simpler to work with rational polynomials instead (p, u, v rational coeﬃcients); by easy scaling we can get integer polynomials later. WLOG f and g are irreducible and coprime (in Q). It suﬃces to ﬁnd an algebraic number r such that u(r) = a and v(r) = b, where a is some root of f and b is some root of g, because if we let p(x) be the minimal polynomial of r, then p(x) | f (u(x)), g(v(x)) (all in Q). So this problem boils down to the classical fact that Q(a, b) = Q(c) for some c. (ﬁeld extension generated by ﬁnitely many elements is generated by a single element) For Q(c) ⊆ Q(a, b), we’ll just need c = P (a, b) for some polynomial P ∈ Q[x]. Let a1 = a, a2, a3, . . . , am be the roots of f and b1 = b, b2, b3, . . . , bn be the roots of g. Then we need to show that a, b ∈ Q(c), or equivalently, that the minimal polynomials h1, h2 of a, b in Q(c) have degree 1. Of course, h1(x) | f (x) and h2(x) | g(x) (in Q(c)). So to approach this, we want to ﬁnd c = P (a, b) such that there exist F (x), G(x) ∈ Q(c)[x] such that F (a) = 0 and G(b) = 0 but deg gcd(f, F ) = deg gcd(g, G) = 1 (in Q(c)). It’s then natural to take c = t1a + t2b for some nonzero t1, t2 ∈ Q such that t1ai + t2bj are pairwise distinct for 1 ≤ i ≤ m and 1 ≤ j ≤ n, because we can set F (x) = g((c − t1x)/t2) ∈ Q(c)[x] and G(x) = f ((c − t2x)/t1) ∈ Q(c)[x]. From the distinctness condition, it’s then easy to check that gcd(f, F ) = x − a and gcd(g, G) = x − b, so we’re done. 15. There are 100 apples on the table with total weight of 10 kg. Each apple weighs no less than 25 grams. The apples need to be cut for 100 children so that each of the children gets 100 grams. Prove that you can do it in such a way that each piece weighs no less than 25 grams. Solution. Divide everything by 25, so the weights are 1 ≤ b1 ≤ · · · ≤ bn, b1 + · · · + bn = 4n, and we want to give a total weight of 4 to each of n children so that the weights of the pieces are all at least 1. We prove this by strong induction on n, where the base case n = 1 is obvious. Now suppose n > 1, and note that bn ≥ 4. If b1 ≤ 3, then we can split bn into 4 − b1 ≥ 1 and bn + b1 − 4 ≥ bn − 3 ≥ 1 and give b1, 4 − b1 to a child to reduce to the n − 1 case. (*) Otherwise, 3 < b1 ≤ · · · ≤ bn, and note that si = b1 + · · · + bi ≤ 4i (s0 = 0) for all 0 ≤ i ≤ n. We’ll try to mimic the general idea of (*). In view of s1 > 3, let r ≥ 1 denote the largest index j such that si > 4i − 1 for 1 ≤ i ≤ j. For 1 ≤ i ≤ r, split bi into xi = (4i − 3) − si−1 ∈ [1, 2) (we have x1 = 1) and yi = si − (4i − 3) ∈ (2, 3], and give xi+1, yi for 1 ≤ i ≤ r − 1 to the ﬁrst r − 1 children (since xi+1 + yi = 4). If r = n, then we can give x1 = 1, yr = 3 to the last child. 7 Victor Wang Interesting problem solutions, storage Otherwise, r < n, so we can split br+1 into xr+1 = (4r+1)−sr ∈ [1, 2) and yr+1 = sr+1−(4r+1) ∈ (1, 2], where we note that sr+1 ≤ 4(r + 1) − 1 by the maximality of r (in particular, r + 1 < n, since sn = 4n) and sr+1 = sr + br+1 ≥ sr + b1 > sr + 3 > (4r − 1) + 3. But then we can just give xr+1, yr to the rth child and x1 = 1, xr+1, 3 − xr+1 to the (r + 1) th child, where the third piece is obtained by splitting bn into 3 − xr+1 > 1 and bn + xr+1 − 3 ≥ 1 + xr+1 > 1. We’re done by the n − (r + 1) > 0 case. Comment. The same method shows the problem is true when 4 is replaced by any c ≥ 4 (this is important for yr+1 ≥ 1 and 3 − xr+1 ≥ 1). 16. Find all increasing f : N → R such that f (ab) = f (a)f (b) whenever gcd(a, b) = 1. Solution. b) First f (1) 2 = f (1) =⇒ f (1) ∈ {0, 1}. The ﬁrst case is trivial, so suppose that f (1) = 1, whence f (n) ≥ 1 for all n. We’ll prove that f is totally multiplicative, reducing this to the ﬁrst part. It suﬃces to show that f (p r) = f (p) r for all primes p and integers r ≥ 1 since f (n) is determined completely by the outputs of f at its maximal prime power divisors. Note that for all integers k, r ≥ 1 and primes p, f (p 2k + 1) f (pk + 1) ≤ f (p r) f (pr−1) ≤ f (p 2k − 1) f (pk − 1) . (1) Multiplying (1) over k = 1 and 1 ≤ r ≤ s, we have ( f (p 2 + 1) f (p + 1) )r ≤ f (pr) ≤ ( f (p 2 − 1) f (p − 1) )r . Now suppose for the sake of contradiction that there exists a constant c > 1 such that f (n + 1) ≥ cf (n) for all n ≥ 1. Then multiplying this inequality over 1 ≤ n ≤ pr − 1, we have c pr−1 ≤ f (p r) ≤ ( f (p2 − 1) f (p − 1) )r , a clear contradiction for suﬃciently large r. Thus for all ϵ > 0, there exists a positive integer n such that f (n + 1) < (1 + ϵ)f (n). Hence for all suﬃciently large r ≥ N , 1 ≤ f (p rn(n + 1) + 1) f (prn(n + 1) − 1) ≤ f (n + 1) f (n) ≤ 1 + ϵ. Now taking r = 1 and r = ℓ ≥ 1 in (1) and dividing, we have f (p 2k + 1) f (pk + 1) · f (pk − 1) f (p2k − 1) ≤ f (pℓ) f (pℓ−1) · 1 f (p) ≤ f (p 2k − 1) f (pk − 1) · f (pk + 1) f (p2k + 1) . Plugging in k = p N n(n + 1), we ﬁnd that 1 1 + ϵ ≤ f (pℓ) f (p)f (pℓ−1) ≤ 1 + ϵ. Since this holds for all ϵ > 0, we must in fact have f (pℓ) = f (p)f (p ℓ−1) for all ℓ ≥ 1, i.e. f (p ℓ) = f (p) ℓ for all ℓ ≥ 1 by induction, as desired. 17. Let x ̸= y be relatively prime natural numbers. Prove that for inﬁnitely many primes p, the exponent of p in xp−1 − yp−1 is odd. Solution. Assume for the sake of contradiction that for all primes p > N for some N > xy(x − y) 2, vp(xp−1 − yp−1) ≡ 1 (mod 2). First note that if q|xp − yp, gcd(q, xy) = 1, and q ≡ 1 (mod p) for some prime q > p > N , then by LTE vq(xq−1 − yq−1) = vq(xp − yp). Yet if q\f \f \f \f xp−yp x−y , then either q = p or q ≡ 1 (mod p). But the former implies that p|xp − yp =⇒ p|x − y, contradicting the fact that p > N . 8 Victor Wang Interesting problem solutions, storage Thus for all p > N , xp−yp x−y is a perfect square. Now take a prime r ≡ 3 (mod 4) dividing 4xy(x−y) 2 −1 (then gcd(r, xy(x − y)) = 1). By assumption however, if we take a prime p ≡ −1 (mod r − 1) larger than N , then there exists z such that z2 = xp − yp x − y ≡ 1 x − 1 y x − y ≡ − 1 xy ≡ −4(x − y) 2 (mod r), i.e. −1 is a quadratic residue (mod r), contradiction. Comment. There is another method using 2 s instead of p, which involves some basic diophantine equations. 18. Let p ≥ 13 be a prime. Prove that for any integers a, b, c, d such that abc is not divisible by p and (a + b + c) is divisible by p, there exist integers x, y, z belonging to the set {0, 1, 2, . . . , ⌊p/3⌋} such that ax + by + cz + d is divisible by p. Solution. Of course, the interesting part of the problem is when t = 3. As above, let k = ⌊p/3⌋ − 1 (we have 3k + 4 ≤ p ≤ 3k + 5), and set Sℓ = {0, 1, . . . , ℓ} for every ℓ ≥ 0. Deﬁne Tℓ = aSℓ + bSℓ + cSℓ (mod p); we wish to show that |Tk| = p. However, note a(k − x) + b(k − y) + c(k − z) ≡ −(ax + by + cz), so r ∈ Tk iﬀ −r ∈ Tk. Furthermore, 0 ≡ a + b + c ∈ Tk, so it suﬃces to show that |Tk| ≥ p − 1. Case 1: p | (a − b)(b − c)(c − a), WLOG (a, b, c) = (1, 1, −2). Then it’s easy to see that aS + bS + cS = S + S − 2S = {−2k, . . . , 0, 1, . . . , 2k}, so |T | ≥ min(4k + 1, p) = p (this is true for p ≥ 13). Case 2: p ∤ (a − b)(b − c)(c − a). It’s easy to check that |T1| = |{0, a, b, c, −a, −b, −c}| = 7 (since a, b, c are pairwise distinct and a + b + c ≡ 0). But Tk = T1 + Tk−1, so by Cauchy-Davenport, |Tk| ≥ min(|T1| + |Tk−1| − 1, p) = min(6 + |aSk−1 + bSk−1 + cSk−1|, p) ≥ min(6 + 3|Sk−1| − 2, p) = min(3k + 4, p) ≥ p − 1, as desired (I adapted this method from this thread). Original Method: My (uglier) original proof (perhaps more motivated, though both of these give the extra boost to Cauchy-Davenport by using the intuition that aSk, bSk, cSk are arithmetic progressions with pairwise distinct diﬀerences) uses Vosper’s theorem, which shows that if |A|, |B| ≥ 2, |A + B| ≤ p − 2, and |A + B| = |A| + |B| − 1, then A, B are arithmetic progressions with the same diﬀerence. First, note that a2, b 2, c 2 (mod p) are pairwise distinct. WLOG set a = 1 by scaling. Lemma. |aSk + bSk| = |Sk + bSk| ≥ 2(k + 1) + 1. If equality holds, then aSk + bSk must be the union of two disjoint strings of consecutive residues, one of length k + 1 and the other of length k + 2. Proof. Note that k ≥ 2 =⇒ |Sk| = k + 1 ≥ 3. Since a = 1, b ̸≡ 0, ±1. It’s easy to show that there exists 1 ≤ s ≤ k such that k + 2 ≤ [bs]p ≤ p − (k + 2) by considering the three intervals [0, k +1], [k +2, p−2−k], [p−(k +1), p] (and noting that (p−2−k)−(k +2)+1 ≥ (3k +4)−(2k +4)+1 = k + 1). Indeed, if b ∈ [k + 2, p − 2 − k] we’re done, and otherwise by symmetry (negate b if necessary) we can assume 2 ≤ b ≤ k + 1 and note that bk ≥ k + 2 (so because b ≤ k + 1, {bi}k i=0 must hit the interval [k + 2, p − 2 − k], which has length ≥ k + 1, somewhere). So we already have |Sk + {0, bs}| = 2(k + 1); note that Sk + 0 and Sk + bs are both consecutive strings of length k + 1, neither of which contains −1 or k + 1. But |Sk| ≥ 3, so if we take any s ′ ∈ Sk distinct from 0, s (mod p), Sk + bs ′ must have an element neither in Sk + 0 nor Sk + bs, establishing the inequality. If equality holds, then this last additional element must border either Sk + 0 or Sk + bs, since Sk + bs ′ is itself a consecutive string of length k + 1 and there are “gap” between Sk + 0 and Sk + bs at −1 and k + 1, so we’re done (otherwise we would add at least two elements with Sk + bs ′).■ Now assume for the sake of contradiction that |Tk| ≤ p − 2. Let U = aSk + bSk; by the lemma, |U | ≥ 2k + 3, so by Cauchy-Davenport, p − 2 ≥ |Tk| = |U + cSk| ≥ (2k + 3) + (k + 1) − 1 = 3k + 3 ≥ p − 2. Thus equality holds, so by Vosper’s theorem, U and cSk must be arithmetic progressions with the same diﬀerence in order for equality to hold. Because |cSk| = k + 1 ∈ [2, p − 2], it’s easy to show that 9 Victor Wang Interesting problem solutions, storage cSk can only be written as an arithmetic progression with diﬀerence ±c, so U is also an arithmetic progression with diﬀerence ±c. By the equality condition of the lemma, U is the union of two disjoint strings of consecutive residues, one of length k + 1 (say I1 = [m1, m1 + k]) and the other of length k + 2 (say I2 = [m2, m2 + k + 1]). By symmetry, suppose [(m1 − 1) − (m2 + k + 1)]p ≥ 2 (otherwise 2k + 5 = p ≥ 3k + 4). If I1, I2 are bordering, then |U | = 2k + 3 ∈ [2, p − 2] gives a contradiction (in the same we show the progression cSk must have diﬀerence d). Let d ≡ ±c (mod p) such that 2 ≤ d ≤ (p − 1)/2; clearly m2 + k + d, m2 + k + 1 + d /∈ I2 by simple bounding. But there’s exactly one “end” of the arithmetic sequence U , so at least one of m2 + k + d, m2 + k + 1 + d ∈ I1. Then it’s easy to see there exists x ∈ I2 such that x + d ≡ m1; since there’s at most one end to U , we must have x ∈ {m2, m2 + 1} (since m1 − 1, m1 − 2 /∈ U ). If m2 ≡ m1 + p − d, then m2 + k + 1 + d ≡ m1 + k + 1 /∈ U , so by discrete continuity (obviously m1 + k + d /∈ I1, but it can’t be the end of U ) I1+d ⊆ I2 =⇒ d ≥ [m2−m1]p = p−d, contradiction, so m2+1 ≡ m1+p−d. In this case, m2 + d /∈ U , so by discrete continuity I1 + d ⊆ I2 =⇒ d ≥ [m2 − m1]p = p − 1 − d =⇒ d = (p − 1)/2. Thus (a, b, c) ∈ {(1, (p−3)/2, −(p−1)/2), (1, (p−1)/2, (p−1)/2)}. But these are equivalent to (1, 2, −3) and (1, 1, −2) by scaling, which we’ve already dealt with, contradiction (note that a = 1 is preserved, so we don’t lose any generality from our earlier scaling). Comment. The Tk = T1 + Tk−1 method is much cleaner because it allows us to globally extend (using Cauchy-Davenport) the “local” idea of what a + b + c ≡ 0 (mod p) does at a smaller scale (i.e. what it does to T1), which is easier to understand. Nevertheless, I guess my original solution still has a few important ideas. 19. (Ehrenfucht) Suppose that (deg f, deg g) = 1; show that f (x) − g(y) is irreducible. Solution. It will be convenient in this solution to set deg 0 = 0. If f (x, y) = cxn + xn−1f1(y) + · · · + x0fn(y) for some polynomials f1, . . . , fn and positive integer n (call such a polynomial good ), set α(f ) = max1≤i≤n deg fi/i (let f0 = 1). Lemma. If f = gh for some nonconstant polynomials f, g, h (where f is good), then g, h are good as well and α(f ) = max(α(g), α(h)). (I’ve seen this in some paper, but I think the authors’ proof is kinda complicated.) Proof. g, h are obviously good. WLOG α(g) ≥ α(h). Note that for all nonzero k, deg g0hk/k = deg hk/k and deg gkh0/k = deg gk/k. If α(g) > α(h), then consider the smallest u ≥ 1 such that deg gu/u = α(g); by the minimality of u, deg fu/u = deg guh0/u = deg gu/u = α(g), so we’re done in this case (g0hu is not an issue if it exists). Otherwise, α(g) = α(h) = r, so take the largest u, v ≥ 1 such that deg gu/u = deg hv/v = r; by the maximality of u, v, deg fu+v/(u + v) = deg guhv/(u + v) = r, as desired (by maximality, g0hu+v, gu+vh0 are not issues if they exist). This is possibly more motivated if we assume WLOG f, g, h are all monic in x and write f (x, y)/xn = 1 + f1(y)/x + · · · + fn(y)/xn.■ Alternatively, choose zn, zm (possibly times some constant) to make sure the leading coeﬃcient vanishes and use a degree (in z) argument. The initial problem with f (x, y) = xm − yn is now obvious: if degx g = a and degx h = b, we have deg ga/a, deg hb/b = max(α(g), α(h)) ≤ α(f ) = n/m, but (deg ga+deg hb)/(a+b) = n/m, contradicting the fact that a, b ≥ 1 (since gcd(m, n) = 1). Of course, this generalizes just as easily to f (x) − g(y). 20. Fix two positive integers a, k ≥ 2. Suppose that there is a polynomial f ∈ Z[x] such that for all suﬃciently large positive integers n, there exists a rational number x satisfying f (x) = f (an) k. Prove that there exists a polynomial g ∈ Q[x] such that f (g(x)) = f (x) k for all real x. 10 Victor Wang Interesting problem solutions, storage Solution. Let f (xn) = f (a n) k for all n ≥ N (N such that the sign of f (x) is determined from x and leading coeﬃcient alone). If k is odd, replace f with −f if necessary so that f (xn) > 0 for all n ≥ N ; for k even this must be the case anyway. Lemma. Suppose that f (x) > 0 for some x, d = deg f , and f (x) = cdxd + cd−1xd−1 + · · · + c0. Then f (x) 1/d = ±a(x + b) + O(x−1), where a = |cd|1/d and b = cd−1/(dcd), and the ± sign is determined uniquely by the sign of x. Proof. Well, this is a somewhat standard analytic problem, so I might as well post a solution. By the problem condition, there exists a positive integer N (to be determined later) such that for every n, there exists xn ∈ Q satisfying f (xn) = f (a n)k. WLOG assume N is large enough so that f (a n) is nonzero with constant sign and xn ̸= 0 for n ≥ N ; then f (xn) must also have a ﬁxed sign for n ≥ N . By the rational root theorem, there exists a positive integer ℓ such that xnℓ ∈ Z for all n ≥ N . Now suppose d = deg f > 0, and ﬁx two integers L, M (with M > L, N ) to be determined later. By Van der Waerden’s theorem, there exist positive integers u, v ≥ N such that the subsequence {xu+iv} M i=0 has all terms of sign ϵ ∈ {−1, 1}. Let S = {u + iv} M i=L (note that we only consider i ≥ L here). Lemma 1: There exist constants A, B, C with A, C > 0 and A, B ∈ Q such that \f \f \f|f (x)| 1/d − |Ax + B| \f \f \f ≤ C|x| −1 for all x ̸= 0. Proof. Let r = 1/d > 0 and write f (x) = cxd(1 + F (x)) (note that F (x) = O(|x|−1) only contains the terms x−1, . . . , x−d). We can absorb x with small absolute value into the constant C, so it suﬃces to prove the claim for suﬃciently large |x| ≥ X satisfying |F (x)| < 1/2. Since r > 0, the binomial coeﬃcients (r i) (i ≥ 0) are bounded in absolute value, so the binomial expansion (1 + F (x)) r = 1 + (r 1 )F (x) + · · · + (r ℓ )F (x)ℓ + Rℓ(x) for any ℓ ≥ ⌈rd⌉ = 1 establishes the claim. (Comparing to a geometric series in F (x), we have Rℓ(x) = O ( F (x) ℓ+1 1 − F (x) ) = O(F (x) ℓ+1) = O(|x| −ℓ−1), as desired.)■ Corollary: There exists a constant C ′ > 0 and positive integer N > 0 such that for all n ≥ N ,\f \f|f (xn)| 1/d − |Axn + B|\f \f ≤ C ′a −kn. Proof. The relation f (xn) = f (a n)k implies that there exists a constant C ′ > 0 such that for suﬃciently large n, C|xn| −1 ≤ C ′a −kn for every n ≥ N .■ Lemma 2: There exists a polynomial h ∈ Q[x] of degree k with positive leading coeﬃcient and a constant D > 0 such that \f \f \f|f (x)|k/d − |h(x)| \f \f \f ≤ D|x| −1 for all x ̸= 0. Proof. First we mimic the proof of lemma 1 (except with r = k/d and ℓ ≥ ⌈rd⌉ = k) to get polynomial h (not necessarily with positive leading coeﬃcient). If h has negative leading coeﬃcient, however, we can just replace it with −h.■ First make L large enough so that |Axn + B| = ϵ(Axn + B) for all n ∈ S (note that A > 0). Then by the corollary of lemma 1 (take N large enough), \f \f \f|f (xn)| 1/d − ϵ(Axn + B)\f \f \f ≤ C ′a −kn ≤ C ′a −kLv ≤ C ′a −Lv for all n ∈ S. If we also take L large enough so that h(a n) > 0 for all n ∈ S (note that h has positive leading coeﬃcient), lemma 2 gives \f \f \f|f (a n)| k/d − h(a n) \f \f \f = \f \f \f|f (a n)| k/d − |h(an)| \f \f \f ≤ D|a n|−1 ≤ Da −Lv. 11 Victor Wang Interesting problem solutions, storage By the triangle inequality, we thus have |ϵAxn + H(a iv)| = |ϵ(Axn + B) − h(a n)| ≤ (C ′ + D)a −Lv for all i ∈ [L, M ] (where n = u + iv), where H(x) = ϵB − h(a ux) ∈ Q[x] is a polynomial of degree k satisfying ϵB − h(a u+iv) = H(a iv) for all i ∈ [L, M ]. Now let T : i → i+1 denote the shift operator and U (x) = (x−a 0)(x−a v) · · · (x−a kv). Viewing H(a iv) as a linear recurrence in a0, a v, . . . , akv indexed by i, we have U (T )(H(a iv)) = 0 for i ∈ [L, M − k], so again by the triangle inequality, |U (T )(ℓℓ ′Axi+uv)| ≤ ℓℓ ′(C ′ + D)a −Lv(a 0 + 1)(a v + 1) · · · (a kv + 1) ≤ ℓℓ ′(C ′ + D)2k+1a v(k(k+1)/2−L), where ℓ ′ is the smallest positive integer such that ℓ ′A ∈ Z (clearly ℓ ′ is independent of L, M ). Since ℓ, ℓ ′, C ′, D, k are all constants independent of L, M , we can choose L large enough so that the RHS is strictly less than 1, and then choose any M ≥ L + k + 2dk. But then |U (T )(ℓℓ′Axi+uv)| ∈ Z must in fact be zero, so there exists a polynomial G ∈ Q[x] of degree k (corresponding to a linear recurrence in a 0, a v, . . . , akv) such that xu+iv = G(aiv) for i ∈ [L, M − k]. Finally, if we take g(x) = G(xa−u) ∈ Q[x], then xn = g(a n) for M − k − L + 1 ≥ 2dk + 1 values of n, whence f (g(x)) − f (x)k (which has degree ≤ dk yet vanishes for at least 2dk + 1 values of x) must be identically zero, as desired. Note. This is also true for integers a ≤ −2, as we can just restrict ourselves to even n. This also generalizes easily to the more natural statement: Fix two positive integers a, k ≥ 2, and let f, p ∈ Z[x] be two nonconstant polynomials. Suppose that for all suﬃciently large positive integers n, there exists a rational number x satisfying f (x) = p(a n)k. Prove that there exists a polynomial g ∈ Q[x] such that f (g(x)) = p(x) k for all real x. 21. Let n be an integer greater than 2, and P1, P2, . . . , Pn distinct points in the plane. Let S denote the union of all segments P1P2, P2P3, . . . , Pn−1Pn. Determine if it is always possible to ﬁnd points A and B in S such that P1Pn ∥ AB (segment AB can lie on line P1Pn) and P1Pn = kAB, where (1) k = 2.5; (2) k = 3. Solution. If k ≥ 0, this is always possible iﬀ k is a nonnegative integer. If k ≤ 1, this is all obvious; from now on, suppose that k > 1. First suppose k /∈ Z, and let m = ⌈k⌉ ≥ 2 so that m − 1 < k < m. For 1 ≤ i ≤ m − 1, we take P8i−7 = (m(i − 1), 0), P8i−6 = (m(i − 1), m − i), P8i−5 = ((m − 1)i, m − i), P8i−4 = ((m − 1)i, 0), P8i−3 = ((m − 1)i, 0), P8i−2 = ((m − 1)i, −i), P8i−1 = (mi, −i), P8i = (mi, 0), where the fact that m(i − 1) < (m − 1)i < mi ensures that S is a simple curve (although the problem does not stipulate this, it’s convenient for the construction). It’s easy to see that P1 = (0, 0), Pn = (m(m − 1), 0), and the resulting ﬁgure S is symmetric about (m(m − 1)/2, 0). Hence if we go by contradiction (i.e. assume we can ﬁnd A, B such that AB ∈ (m − 1, m)), we can WLOG work with A, B on or above the x-axis. Note that the region of S above the x-axis is a sequence of m − 1 disjoint squares (bottom sides missing) with decreasing height (from left to right), so we can assume that A lies on the i th square and B lies on the jth, where 1 ≤ i < j ≤ k − 1. Since A, B have the same y-coordinate, the x-coordinate of A is either m(i − 1) or (m − 1)i, and the x-coordinate of B lies in the closed interval [m(j − 1), (m − 1)j]. If Ax = m(i − 1), then AB ≥ m(j − 1) − m(i − 1) ≥ m, contradiction, so Ax = (m − 1)i =⇒ AB ∈ [m(j − 1) − (m − 1)i, (m − 1)(j − i)]. But if j = i + 1, then AB ≤ m − 1, and if j ≥ i + 2, then m(j − 1) − (m − 1)i ≥ m(i + 1) − (m − 1)i = m + i ≥ m, contradiction. It remains to show that when k ≥ 2 is an integer, there exist A, B ∈ S such that P1Pn = kAB. Suppose otherwise; WLOG set P1 = (0, 0) and Pn = (k, 0). For any curve C (possibly a point) and 12 Victor Wang Interesting problem solutions, storage real r, let C (r) = C + (r, 0). By assumption, C (r) and C (r+1) are disjoint for all r. The key idea is to deﬁne “left/right” properly: take indices M and m such that the y-coordinates of PM and Pm are maximal and minimal, respectively, and |M − m| is as small as possible; WLOG m < M , and J is the region bounded by the two horizontal lines through PM , Pm (inclusive); note that y = 0 lies in J. Let T denote the broken line PmPm+1 . . . PM , the exterior E be the set of points X ̸= PM ∈ J such that there exists a continuous path from PM to X intersecting T only at the beginning (at PM ), and the interior I = J \\ E. Deﬁne the left L of T as the set of points X ∈ J such that there exists a continuous path from (−∞, 0) to X that stays in J and never meets T ; deﬁne the right R analogously (note that the points in I are in neither L nor R). Clearly E = L ∪ R. If S(1) intersects both I and E, then S(1) clearly hits T , contradiction, and if S(1) lies entirely in I, then the uppermost y-coordinate in S(1) is strictly less than that of I (since S(1) does not intersect T ), contradicting the fact that P (1) M ∈ S(1). Hence S(1) lies entirely in either L or R (since S(1) never leaves J and never hits T ). But it’s not hard to show that P (1) M ∈ R, so S(1) lies entirely in R. In particular, I (1) ⊂ R, so R(1) ⊂ R by the continuity of I (1) and R (in other words, a path staying in J from (∞, 0) to some X ∈ R(1) cannot meet I without ﬁrst hitting I (1), since I and I (1) are disjoint). Hence S(2) ⊂ R(1) ⊂ R; by a simple induction, S(i) lies entirely in R for i ≥ 1, and by symmetry, S(−i) lies entirely in L for i ≥ 1. Thus P (k−1) 1 ∈ R (recall that k ≥ 2) and P (−1) n ∈ L, contradicting the fact that P (k−1) 1 = P (−1) n and L ∩ R = ∅. 22. In an acute-angled ABC, ∠A > 60 ◦, H is its orthocenter. M, N are two points on AB, AC respectively, such that ∠HM B = ∠HN C = 60 ◦. Let O be the circumcenter of triangle HM N . D is a point on the same side with A of BC such that △DBC is an equilateral triangle. Prove that H, O, D are collinear. Solution. The idea is duality/symmetry (helps to think of how one might prove it using complex numbers; then note that orientation almost certainly doesn’t matter), or also cyclic quads/spiral sim- ilarity. We can also think of this as making everything completely symmetric to bring out patterns more easily. Let X, Y, Z be the feet of the altitudes, M ′ reﬂection of M over Z, N ′ reﬂection of N over Y , D′ reﬂection of D over BC. First by standard spiral similarity results, △HM ′N ∼ △HZY ∼ △HM N ′ (all same orientation), which are in turn similar to △HBC (opposite). It’s then natural (using SAS similarity) to establish using rotation (△DCH toward CB) that △DHC ∼ △M N N ′ (opposite), so ∠DHC = ∠M N N ′ = ∠M N H + 60◦ = 150 ◦ − ∠M HO = ∠OHC, and we’re done. Note that we have △D′HC ∼ △M ′N ′N as well, proven the same way, conﬁrming our intuition at the beginning that the counterpart is also true by duality. 23. (China 2012) In some squares of a 2012 × 2012 grid there are some beetles, such that no square contain more than one beetle. At one moment, all the beetles ﬂy oﬀ the grid and then land on the grid again, also satisfying the condition that there is at most one beetle standing in each square. The vector from the center of the square from which a beetle B ﬂies to the center of the square on which it lands is called the translation vector of beetle B. For all possible starting and ending conﬁgurations, ﬁnd the maximum length of the sum of the translation vectors of all beetles. Solution. Orient the grid in the lattice plane so that its center C is at (0, 0) and the vertices are at (±1006, ±1006). If a beetle lies at (x, y) then we assign it the vector ⟨x, y⟩. Let H be the set of heads and T the set of tails; we want ∑ H − ∑ T = ⃗V = ⟨X, Y ⟩ as our ﬁnal vector sum. We now make some simpliﬁcations, supposing our |V | is maximal. First take out any overlaps in H and T . Suppose there are blank squares; since there is an even number of squares we have an even number of blank squares left, so consider two of them at a, b. But then |V + b − a| + |V + a − b| ≥ 2|V |, so we can assume that all the squares are full (in fact this must be the case, but it doesn’t matter since we only care about the maximum value itself). Now suppose we have h ∈ H and t ∈ T ; swapping h, t must have |V − 2(h − t)| ≤ |V |, or equivalently, |h − t|2 ≤ V · (h − t), which means V · h > V · t. By our choice of C, there are p, q, p squares x with V · x positive, zero, and negative, respectively, for some p, q ≥ 0. If there’s a negative V · h, then there must be a nonnegative V · t, contradiction; similarly there’s no positive V · t. Thus the 13 Victor Wang Interesting problem solutions, storage q zeros are divided evenly among the V · h’s and V · t’s, so if q > 0 we get a contradiction; thus q = 0. Now draw the line perpendicular to CV ; it must not hit any centers of the squares, and it divides the grid into two sides, one of all h’s and one of all t’s. Suppose the line intersects the top and bottom edges but not the left and right edges (note that the line can’t pass through two opposite corners since q = 0). Further suppose it has positive slope; then suppose there are 1006 + xi guys to the left of the i th row for 1 ≤ i ≤ 1006; by symmetry, the ith row from the bottom has 1006 − xi guys. It’s easy to compute |X| = ∑1006 i=1 (1006 2 − x2 i ) and |Y | = ∑1006 i=1 (2i − 1)x1007−i. We have 0 ≤ xi ≤ 1006 for each i; let yi = 1006x1007−i (0 ≤ yi ≤ 1); then we need to show n2( ∑n i=1(1 − y2 i ))2 + ( ∑n i=1(2i − 1)yi)2 ≤ n4. We’ll generalize this to show that for all x ∈ [0, 1]n and positive integers n ≥ 1, f = n2( ∑n i=1(1 − x2 i ))2 + ( ∑n i=1(2i − 1)xi)2 ≤ n4, where the base case n = 1 is obvious. We’ll use the extreme value theorem of Karl Weierstrass, which states that every continuous real-valued function on a nonempty compact space attains a ﬁnite global maximum. Take some x that attains this maximum; obviously we have 0 ≤ x1 ≤ · · · ≤ xn ≤ 1 (note that x2 1 + · · · + x 2 n stays ﬁxed upon permutation of the xi). Consider some 1 ≤ i < j ≤ n; then for ﬁxed x2 i + x2 j = k, (2i − 1)xi + (2j − 1)xj must be maximal. Note that ((2i − 1) 2 + (2j − 1) 2)k = ((2i − 1)xi + (2j − 1)xj) 2 + ((2j − 1)xi − (2i − 1)xj)2. If√k(2j − 1)/ √(2i − 1)2 + (2j − 1)2 ≤ 1, then we must have (2j − 1)xi − (2i − 1)xj. Otherwise, this means (2j − 1)xi − (2i − 1)xj > 0, or else xj > 1. (Note that we must have k > 1.) Thus the minimum of ((2j − 1)xi − (2i − 1)xj) 2 occurs when (2j − 1)xi − (2i − 1)xj is minimized. The latter is strictly increasing in xi, however, so either xi = 0 or xj = 1 (since xi ≤ xj, or else swapping will increase (2i − 1)xi + (2j − 1)xj). If xi = 0, then 1 < k ≤ x2 j ≤ 1, contradiction, so xj = 1 and xi = √k − 1. If x1 = 1, then xi = 1 for all i and f = n4, so suppose x1 < 1. Then there exists 1 ≤ ℓ ≤ n and 0 ≤ λ < 1/(2ℓ − 1) such that xi = λ(2i − 1) for 1 ≤ i ≤ ℓ and xi = 1 for ℓ < i ≤ n. It remains to show that n2( ℓ∑ i=1 1 − λ 2(2i − 1)2) 2 + ( ℓ∑ i=1 λ(2i − 1) 2 + n∑ i=ℓ+1 (2i − 1)) 2 ≤ n4, or equivalently, n 2(ℓ − λ 2ℓ(4ℓ 2 − 1)/3) 2 + (λℓ(4ℓ 2 − 1)/3 + (n2 − ℓ 2))2 ≤ n4. The key is to note that this is equivalent to n2(ℓ − λ2ℓ(4ℓ 2 − 1)/3)2 ≤ (ℓ 2 − λℓ(4ℓ 2 − 1)/3)(2n2 − ℓ 2 + λℓ(4ℓ 2 − 1)/3). Of course, ℓ 2 − λℓ(4ℓ 2 − 1)/3 ≤ n2 < 2n2 and ℓ 2 − λℓ(4ℓ 2 − 1)/3 > ℓ 2 − ℓ(2ℓ + 1)/(3(2ℓ − 1)) ≥ ℓ 2 − ℓ ≥ 0, so dividing both sides by n2, it suﬃces to prove the inequality for n = ℓ. Using DOS again, we rearrange this as 4n2 − 1 ≤ 3n2(2 − λ 2(4n2 − 1)/3). It suﬃces to prove this when λ = 1/(2n − 1), but this is just 4n2 − 1 ≤ 6n2 − n2(2n + 1)/(2n − 1), or (n − 1)(2n2 − n + 1) ≥ 0, so we’re done. In fact, when xn = 1, we can use direct induction on the original inequality (when ℓ = n, the other inequality is much easier to prove). Indeed, let S = ∑n−1 i=1 (2i − 1)xi; then it boils down to n2 (n − 1)2 ((n − 1)4 − S2) + (S + (2n − 1)) 2 ≤ n4, where 0 ≤ S ≤ (n − 1) 2. By DOS, rearrange as n2 (n − 1)2 ((n − 1)2 − S)((n − 1) 2 + S) ≤ ((n − 1)2 − S)(n2 + 2n − 1 + S), which is trivial if S = (n − 1) 2; if S < (n − 1)2, then it boils down to S ≤ (n − 1)2 again, so we’re done. Comment. There’s a much cleaner solution using induction in a more geometrically symmetric way: consider the inner 2(n−1)×2(n−1) grid; for the border we get (2n−1)(2n−2)+x1(2n−x1)+(2n−x1)x1 14 Victor Wang Interesting problem solutions, storage for x-coordinate and (2n − 1)(−x1) + (2n − 1)(2n − x1) for y-coordinate. Let t = (n − x1)2 and observe that the resulting square magnitude of the vector is convex (positive quadratic) and thus maximized (we just have to be careful about the vertex, but the constant term is big enough) at boundary of t, which is either x1 = 0, 2n or x1 = n. Anyway it’s easy now by the triangle inequality. 24. Show that xx + yy ≥ xy + yx for positive reals x, y. Solution. If x = y, this is trivial, so suppose WLOG that x > y > 0. If x ≥ 1, then xx + yy ≥ xy + yx ⇐⇒ xy(xx−y − 1) ≥ yy(yx−y − 1) follows from the facts that xy ≥ yy, xx−y − 1 ≥ yx−y − 1, and xx−y − 1 ≥ 0 (note that if y < 1, the RHS is negative and the LHS is nonnegative). Otherwise, we must have 1 > x > y > 0, so xx + yy ≥ xy + yx ⇐⇒ xx − yx ≥ x y − yy ⇐⇒ ∫ x y xtx−1 dt ≥ ∫ x y yt y−1 dt, whence it’s enough to show that xt x−1 ≥ yt y−1 for y ≤ t ≤ x, or equivalently, that t x−y ≥ y/x. Because x − y > 0, the LHS is increasing in t and it suﬃces to show that yx−y ≥ y/x, or x ≥ y1−x+y. But y − 1 > −1 and 1 − x + y = 1 − (x − y) ∈ (0, 1], so by Bernoulli’s inequality, y1−x+y = (1 + (y − 1)) 1−x+y ≤ 1 + (1 − x + y)(y − 1) = x + y2 − xy ≤ x, as desired. 25. A piece begins at the origin of the coordinate plane. Two players, A and B, play the following game. In A’s turn, A marks a lattice point in the ﬁrst quadrant that the piece is not on. In B’s turn, B moves the piece up to k times, where a move is deﬁned as moving the piece from (x, y) to (x + 1, y) or (x, y + 1), as long as the lattice point that the piece moves onto is not marked. They then proceed to alternate turns, with A playing ﬁrst. If B cannot move the piece, A wins. For what values of k can A win? Solution. This is a special case of Conway’s Angel problem for which A (the devil) can always win. The idea is to reduce solution sets, where ultimately we’ll need B to be at (x, y) while (x + 1, y) and (x, y + 1) are both unavailable. The “most obvious” way to guarantee this, i.e. to make sure that when B is at some (x, y), all of the (x + i, y + j) are unavailable for i, j ≥ 0 and i + j = r (some r ≥ 1), does not directly work if we try to get consecutive things on some ﬁxed line x + y = T . The next dumbest thing, however, does work: we want to gradually narrow down the choices on this ﬁxed line x + y = T (call this L) depending on the remaining possible locations of B (note that if B is at (x, y), then it can only go to (x′, y′) later with x′ ≥ x and y′ ≥ y). Hence we’ll want to do this iteratively, checking at certain points where B is and letting A mark the remaining possible points between consecutive checks. The most natural way to do this is uniformly; for example, if we have m moves before the ﬁrst check, then B can move up to the line x + y = mk but no further, and we’ll let A mark things at (x, y) ∈ L with x ≡ 0 (mod ⌈T /m⌉). The idea is that we’ll want to do ⌈T /m⌉ checks to make sure B cannot get past L. Of course, if m is too small, our checking gets little done, and if m is too large, B will pass L before we even ﬁnish checking once (for instance, we need m ≤ T /k for the ﬁrst time). Let M = ⌈T /m⌉ and suppose that B is at xi + yi = ri at the i th checkpoint (i ≥ 0) and A responds by making mi ≤ 2 + (T − ri)/M marks at the positions (x, y) ∈ L with x ≡ i (mod M ) and x ≥ xi, y ≥ yi. Now suppose for contradiction that rn ≥ T for n minimal; since we must not have ﬁnished marking all residues (mod M ) in order for B to have passed L between the (n − 1)th and nth checkpoints, we have 1 ≤ n ≤ M (otherwise, everything would’ve been marked between the 0th and M th checkpoints before B passed L). Since ri − ri−1 ≤ kmi−1 ≤ 2k + k(T − ri−1)/M for i ≥ 1 (note that r0 = 0), this means that rn−1 + 2k + k(T − rn−1)/M ≥ rn ≥ T . Setting c = k/M (let’s choose M and T large enough so that 0 < c < 1), we get rn−1 ≥ T − 2k 1−c , and by a simple induction with geometric series we get 0 = r0 ≥ T − 2k((1 − c) −n + · · · + (1 − c) −1), so ﬁxing some 0 < c < 1 and taking T suﬃciently large, we get a contradiction. 15 Victor Wang Interesting problem solutions, storage 26. (Aaron Pixton, MOP 2012) Let n ≥ 2 be a positive integer; ﬁnd the number f (n) of n × n matrices of 0’s and 1’s with each row-sum and column-sum equal to 2. (http://oeis.org/A001499) Solution. One way is to view the rows as {1, 1, 2, 2, . . . , n, n} so that we want to pair these numbers with 1, 1, 2, 2, . . . , n, n such that there are no double occurences of (i, j). Let h(n) = 2 nf (n), so we have that “order” matters, i.e. {(i, j), (i, k)} is not the same as {(i, k), (i, j)}. Then counting the number of “double ﬁxed” points, we have (2n)! 2n = n∑ k=0 h(n − k)( n k )2k!, from which we easily get the generating function (let g(n) = f (n)/n!2) ∑ n≥0 g(n)xn = e−x/2(1 − x) −1/2. As it turns out, the asymptotic formula is (n!) 2/ √πe √n, and there is some connection to derangements. Another way is to look at cycles, where if for some r ≥ 2 we have (i1, . . . , ir) and (j1, . . . , jr), we have the cycle (i1, j1) → (i1, j2) → (i2, j2) → · · · . WLOG assuming i1 represents the smallest row remaining (if we want to recurse), this gets us (note that there are two ways to traverse a cycle, forward and backward) f (n) = n∑ r=2[( n − 1 r − 1 )(r − 1)!][ (n r ) r!](1/2)f (n − r), or equivalently, g(n) = 1 2n n−2∑ k=0 g(k). Of course, we can rewrite this as g(n + 1)(2(n + 1)) = g(n − 1) + 2ng(n), and prove by induction that g(n) ≥ 1/4 √n for n ≥ 2. 27. If a1 ≤ · · · ≤ an are positive integers such that 1/a1 + · · · + 1/an < 1, show that 1/a1 + · · · + 1/an ≤ 1/u1 + · · · + 1/un, where u1 = 2 and ui+1 = u2 i − ui + 1 for i ≥ 1. Solution. The idea is to induct and use the powerful identity 1/u1 + · · · + 1/un = 1 − 1/(u1 · · · un). Indeed, the base case n = 1 is obvious, and if we assume the result is true up to n − 1 for some n ≥ 2, then going by contradiction, we have 1 − 1 u1 · · · un = n∑ i=1 1 ui < n∑ i=1 1 ai ≤ 1 − 1 a1 · · · an , since 1/a1 +· · ·+1/an < 1. But then setting bi = 1/ai and vi = 1/ui, we have b1 ≥ · · · ≥ bn, v1 ≥ · · · ≥ vn, v1 + · · · + vm ≥ b1 + · · · ≥ bm for 1 ≤ m ≤ n − 1, v1 + · · · + vn < b1 + · · · + bn, and v1 · · · vn > b1 · · · bn. But log x is concave, so letting (w1, w2, . . . , wn) = (b1 + · · · + bn − (v2 + · · · + vn), v2, . . . , vn) so that w majorizes b, we get w1 · · · wn > v1 · · · vn > b1 · · · bn ≥ w1 · · · wn, contradiction. 28. (1999 C5, IMO 3) Let n be an even positive integer. We say that two diﬀerent cells of a n × n board are neighboring if they have a common side. Find the minimal number of cells on the n × n board that must be marked so that any cell (marked or not marked) has a marked neighboring cell. Solution. Let n = 2m; after some small cases, we see the answer is m(m + 1). The dumb idea is to use the weak inequality 2c + 3e + 4i ≥ 4m 2, but this is insensitive to the fact that having too many things close to each other is bad, and we have issues around the borders. So we want to look at some trickier set of restrictions; looking at alternate odd-length black diagonals (chessboard), for instance, and noting that each white square covers at most 2 of them, we get the desired bound. 16 Victor Wang Interesting problem solutions, storage The more motivated way is to write out all the equations ai−1,j + ai+1,j + ai,j−1 + ai,j+1 ≥ 1, where 1 ≤ i, j ≤ n and we extend ai,j = 0 for ij(n + 1 − i)(n + 1 − j) = 0. We want to sum these over some subset S of squares so that each term ai,j (1 ≤ i, j ≤ n) appears the same number of times. Since corners have only two neighbors, we can either make this set 1- or 2-regular. After some small cases, we see that the easiest (probably only) way for 2-regularity is to take the “border”, skip the next “layer”, and alternate in this fashion. (This gets the desired bound.) Alternatively, we can get a 1-regular set from the class of good markings such that every square has exactly one marked neighbor, which is easy with some small cases. 29. (USAMO submission, 2002 from Gabriel Carroll MOP handout) Let f : N → N be a function such that, for each n, f (f (n)) is the number of values of m such that f (m) ≤ n. Prove that there are inﬁnitely many values of n such that f (f (n)) = n. Solution. Observe that f 2(m) = f 2(n) =⇒ f 3(m) = f 3(n) implies that f (m) = f (n), so since f 2(n) is nondecreasing, it’s now easy to deduce the precise structure of f . Indeed, if 1 ≤ x1 < x2 < x3 < · · · are the values such that f (x) = f (xi) for x ∈ [xi, xi+1), then it’s not hard to show that the xi form the range of f (x) over all x (the only slightly diﬀerent case is x1 = 1, which is in the range since f (f (1)) > 0). Hence there exists a permutation π of the positive integers such that f (xi) = xπ(i) and π2(i) is increasing; but then π2(n) = n for all n, so f 2(xn) = xn for all n, and we’re done. 30. (MOP 2009) Prove that there exist inﬁnitely many positive integers n such that every prime factor of n2 + 1 is larger than 2009 ln n. Solution. Let p1 < · · · < pr be the ﬁrst r primes (it will not make a signiﬁcant diﬀerence to work only with primes 1 (mod 4)). By CRT, we can choose ti such that ti ≡ 1 (mod pi) and ti ≡ 0 (mod pj) for j ̸= i; then n of the form ∑r i=1 ϵiti (mod p1 · · · pr) have smallest prime divisor of n2 + 1 at least pr+1, as long as ϵk ̸≡ ±ipk (mod pk) for every k. On the other hand, for every odd prime pk we can choose a set Ak (more precisely, an arithmetic progression) of size (p − 1)/2 such that Ak − Ak contains everything except ±ipk (mod pk). (For p1, just take A1 = {0}.) By a simple pigeonhole argument, we can get 0 < n < ∏r i=1 pi/|Ai| < c r for some c > 1, which works unless pr+1 ≤ 2009 ln n = 2009r ln c, which is false for suﬃciently large r. 31. (IMO 2007) In a mathematical competition some competitors are friends. Friendship is always mutual. Call a group of competitors a clique if each two of them are friends. (In particular, any group of fewer than two competitiors is a clique.) The number of members of a clique is called its size. Given that, in this competition, the largest size of a clique is even, prove that the competitors can be arranged into two rooms such that the largest size of a clique contained in one room is the same as the largest size of a clique contained in the other room. Solution. Let c(H) denote the clique number of a graph H. Suppose c(G) = 2k and take a partition G = A ∪ B with |c(A) − c(B)| minimal. Now let r = c(A) and s = c(B) and assume for the sake of contradiction that r ̸= s; WLOG suppose that r > s and |A| is minimal, i.e. there doesn’t exist a partition G = X ∪ Y with |X| < |A|, r = c(X), and s = c(Y ). Fix some r-clique α ⊆ A and a vertex v ∈ α. If A′ = A \\ {v} and B′ = B ∪ {v}, then c(A′) ∈ {r − 1, r} (because α \\ {v} remains in A′) and c(B′) ∈ {s + 1, s} (or else B contains some Ks+1). By the minimality of |A|, we have |c(A′) − c(B′)| ∈ {|r − s − 1|, |r − s − 2|}, whence r = s + 1, |c(A′) − c(B′)| = |r − s − 2| by the minimality of r − s. But then c(A′) = r − 1 and c(B′) = s + 1, so v must belong to every Kr ⊆ A and there must exist a nonempty set f (v) of s-cliques β ⊆ B ∩ N (v). Thus α is in fact the unique r-clique in A and f (v) is nonempty for every v ∈ α. (*) On the other hand, suppose there exists v ∈ A \\ α, and deﬁne A′, B′ as before. Then c(A′) = r since v /∈ α and c(B′) ∈ {s + 1, s}, so by the minimality of |A| we have c(B′) = s + 1 =⇒ |c(A′) − c(B′)| = 0, contradiction. Hence A = α. Now ﬁx a vertex v ∈ A = α and let T (v) ⊆ B be a subset of G with |T (v)| minimal such that U (v) = T (v) ∪ (A \\ {v}) contains a Kr (such a subset exists because |A| ≥ 2 and for any w ∈ A \\ {v} 17 Victor Wang Interesting problem solutions, storage and β ∈ f (w) ̸= ∅, w ∪ β is a Kr). Since |A \\ {v}| = r − 1, we clearly must have |T (v)| > 0; by minimality, T (v) is a complete graph. Further suppose WLOG that |T (v)| is minimal over all v ∈ A. Case 1: There exists β ∈ f (v) such that T (v) ∩ β = ∅. Let A′, B′ be the sets obtained by swapping v and T (v); then c(A′) = r by the deﬁnition of T (v) and c(B′) = s + 1 = r by the deﬁnition of f (v), contradiction. Case 2: There exists t ∈ T (v) such that T ′(v)∩β ̸= ∅ for every β ∈ f (v), where T ′(v) = T (v)\\{t}. Let A′, B′ be the sets obtained by swapping v and T ′(v); by the minimality of T (v), we have c(A′) = r − 1, but because T ′(v) contains something from every β, we also have c(B′) = (s − 1) + 1 = s = r − 1, contradiction. Case 3: T (v) ∩ β ̸= ∅ for every β ∈ f (v) but for every t ∈ T (v), there exists a β ∈ f (v) such that t ∈ β but t′ /∈ β for t′ ∈ T (v) \\ {t}. If |T (v)| ≥ 2, then there exists w ∈ A \\ {v} such that U (v) \\ {w} contains a Kr, so T (v) ⊆ N (v) =⇒ |T (w)| ≤ |T (v)| − 1, contradiction. Hence |T (v)| = 1, so... Comments after fakesolving and reading Solution. this clearly is a dead end, however if we started with A = K2k and moved downward until |A| = |B| + 1, then this might be feasible; indeed, T (v) can be any of 2k − r vertices part of some ﬁxed K2k containing A, so it’s easy to show that if t /∈ β for some β ⊆ f (v) then we can swap v and t to get a contradiction. but then if we move v to B (increasing clique number to s + 1) and just start removing stuﬀ from the β’s until clique number becomes s again (note clique number decreases by at most one at any point), then we cannot add new stuﬀ to A’s clique number or else we would get a larger maximum clique of G; this is useful since maximum clique of 2k is a global restriction while previous approach would at best give a local restriction using this method key idea is that moving things doesn’t change much about clique numbers, *especially* in certain cases, which we can utilize eﬀectively using a maximal clique (not necessarily maximum, or maybe?) analyze what i could’ve changed about my thought process to keep it simpler/ think it through more eﬃciently, since i wasn’t really that far oﬀ 32. Let p be an odd prime. Determine the positive integers x ≤ y for which √2p − √x − √y attains its minimum nonnegative value. Solution. In other words, maximize x + y + 2√xy given that it’s less than 2p (it clearly cannot equal 2p). If r = 1 + ⌊2 √xy⌋, then r2 ≥ 4xy + 1, x + y ≥ r =⇒ r ≤ p (note 2p − x − y ≥ r), so by a simple computation we get that the minimum occurs when r = p and x = (p − 1)/2, y = (p + 1)/2. 33. Find all f : Q+ → Q+ such that f (x) + f (1/x) = 1 and f (2x + 1) = f (x)/2 for all x. Solution. If g(x) = (x + 1)f (x), then we ﬁnd g(1) = 1, g(2x + 1) = g(x), and g(x) + xg(1/x) = x + 1 =⇒ g(1/x) = (x + 1 − g(x))/x for x > 0. Now consider induction on p + q ≥ 2 where gcd(p, q) = 1 and we want to show g(p/q) = 1. If p > q and p, q have the same parity, then g(p/q) = g((p − q)/2q) means that we can ﬁnish by induction (then g(p/q) = 1 means g(q/p) = 1 as well). On the other hand, if p, q are of opposite parity, then consider the operation taking p/q → q/p if p < q and p/q → (p − q)/2q if p > q; as this operation preserves the sum of reduced numerator and denominator, which must be of opposite parity, this is reversible (for x < 1 with odd numerator and even denominator, we reverse to 2x + 1, for x > 1 with odd denominator and even numerator, we reverse to 1/x, and for x > 1 with even denominator and odd numerator, we reverse to 2x + 1). Observe that this reversal is well-deﬁned since if we start with p > q, we can never get to an x < 1 with odd denominator and even numerator. There are ﬁnitely many guys of ﬁxed sum p + q, so as we cycle through equal g values (it might only change at x → 1/x locations), we have x1, . . . , xℓ > 1 such that g(xi) = g(1/xi+1) = (xi+1 + 1 − g(xi+1))/xi+1 for 1 ≤ i ≤ ℓ. As x1 · · · xℓ > 1, a solution to this system must be unique. But g(xi) = 1 for all i is such a solution, so it must be the only solution. In particular, g(p/q) = 1 for any starting seed p/q > 1. But then g(q/p) = 1, so we’re done. 34. Show that lb(n!) ≥ ⌊logb(n + 1)⌋, where lb(n!) denotes the number of nonzero digits of n! in base b. Solution. Let m = ⌊logb(n + 1)⌋ so that bm − 1 | n!. Then since the sum of digits is sub-additive, we have sb(n!) ≥ (b − 1)m, whence the result. 18 Victor Wang Interesting problem solutions, storage 35. (Evan O’Dorney, ESL 2011) If a + b + c = a n + bn + cn = 0 for some positive integer n and complex a, b, c, show that two of a, b, c have the same magnitude. Solution. First get rid of nontrivial zero cases and stuﬀ. Now if (by scaling) abc = 1 and x = −(ab + bc + ca), then Pn(x) = xPn−2(x) + Pn−3(x) with initial conditions P0 = 3, P1 = 0, P2 = 2x. We want to show Pn(x) has real roots times a third root of unity, modulo trivial cases. We ﬁrst take out the 0 roots and do x3 → x to get new polynomials satisfying Qn = xQn−2 + Qn−3 whenever 3 | n and Qn = Qn−2 + Qn−3 otherwise (starting with 3, 0, 2). We induct in groups of six to show that for all m ≥ 1, the degrees for Q6m, Q6m+2, . . . , Q6m+5 are m and Q6m+1 has degree m − 1, and ordering the roots from least to greatest (coeﬃcients are all positive, so roots are clearly all negative), we have −∞ < r6m+2,1 < r6m,1 < r6m+1,1 < r6m+2,2 < · · · < r6m+1,m−1 < r6m+2,m < r6m,m < 0 and −∞ < r6m+4,1 < r6m+5,1 < r6m+3,1 < r6m+4,2 < · · · < r6m+3,m−1 < r6m+4,m < r6m+5,m < r6m+3,m < 0. For the ﬁrst induction case, use IVT ﬁrst for 6m + 3, 6m + 4 to get −∞ < r6m+4,1 < r6m+2,1 < r6m,1 < r6m+3,1 < r6m+1,1 < r6m+4,2 < r6m+2,2 < · · · < r6m+1,m−1 < r6m+4,m < r6m+2,m < r6m,m < r6m+3,m < 0. Now we use Q6m+5 = Q6m+3 + Q6m+2 to get r6m+2,i < r6m+5,i < r6m+3,i for all i, so −∞ < r6m+4,1 < r6m+2,1 < r6m+5,1 < r6m+3,1 < r6m+1,1 < r6m+4,2 < r6m+2,2 < · · · < r6m+1,m−1 < r6m+4,m < r6m+2,m < r6m+5,m < r6m+3,m < 0. For the second induction case, use IVT ﬁrst for 6m + 6, 6m + 7 to get −∞ < r6m+6,1 < r6m+4,1 < r6m+7,1 < r6m+5,1 < r6m+3,1 < r6m+6,2 < r6m+4,2 < · · · < r6m+3,m−1 < r6m+6,m < r6m+4,m < r6m+7,m < r6m+5,m < r6m+3,m < r6m+6,m+1 < 0. Now we use Q6m+8 = Q6m+6 + Q6m+5 to get −∞ < r6m+8,1 < r6m+6,1 < r6m+4,1 < r6m+7,1 < r6m+5,1 < r6m+8,2 < r6m+6,2 < r6m+4,2 < · · · < r6m+6,m < r6m+4,m < r6m+7,m < r6m+5,m < r6m+8,m+1 < r6m+6,m+1 < 0, completing the induction. 36. (MOP 1999) Given n points on the unit circle such that the product of the distances from any point on the circle to the given points does not exceed 2, prove that the points must be vertices of a regular n-gon. Solution. Discussion at AoPS and generalization at MO. One way is to sum over some suitable choice of roots of unity after scaling, using the triangle inequality. Another way to view this is by comparing to g(x) = (x − 1)(x − ω) · · · (x − ωn−1), if f (x) = (x − α1) · · · (x − αn) has α1 · · · αn = 1. Then consider ℜ(g(x) − f (x)), which must be greater than 0 at some vertices of regular polygon (arc midpoints of g’s roots), which is a contradiction by summing over these special points. A dumb way to see this is by taking ai to be the arguments of the vertices of f ’s roots, then set x as the varying argument; now if t = tan x/4, ui = cos ai/2, and vi = sin ai/2, then we get a comparison between the new polynomial corresponding to f and the new polynomial corresponding to g (which will have to have the same leading coeﬃcients), and use IVT and alternating root things to show that the modiﬁed polynomials (and thus originals) must be equal. This is a sort of analog of the Chebyshev polynomials problem of minimum deviation on [−1, 1]. 19 Victor Wang Interesting problem solutions, storage 37. (MOP 2007) Let a be a real number. Prove that f (x) = x2n + ax2n−1 + · · · + ax + 1 has at most 2 real roots and all nonreal roots on the unit circle. Solution. For the silly real zeros part, ﬁrst write it as z2n+1 + az2n = az + 1 and use Descartes rule of signs to show that there are at most 3 real roots (with multiplicity) in this modiﬁed polynomial and thus at most 2 in the original. Write z = re iθ (for nonreal roots z); then to show that |z| = 1, it’s enough to show | sin 2nθ| < 2n| sin θ| if sin θ ̸= 0, which can be proven a number of ways... (e.g. induction with sine addition formula). Alternatively, use the x + 1/x trick and write in terms of Chebyshev polynomials (this is equivalent to the original solution, actually). Then use IVT by plugging in stuﬀ to get n − 1 real roots to this modiﬁed equation, which translates to 2n − 2 in the original. 38. (Descartes’ rule of signs) Let z(p) denote the number of positive zeros and v(p) the number of sign changes; show that z(p) ≤ v(p) and 2 | z(p) − v(p). Solution. The parity part is easy, so we do the rest by induction. There are two clean ways of induction: one is ﬁrst make sure the constant term is nonzero and then use Rolle’s theorem to get z(p′) ≥ z(p) − 1 (there are two cases depending on whether the coeﬃcients a0, a1 have opposite or same parity where a1 is smallest nonzero coeﬃcient after a0). The other way is to show that v((x − r)p(x)) ≥ v(p(x)) and then use the parity condition to ﬁnish by induction (r is a positive number). 39. (Putnam 2004) Let A be a set of positive integers and let b1 < b2 < · · · be the positive integers which can be written as a diﬀerence of two elements of A. If the sequences bn+1 − bn is unbounded, prove that A has density zero. Solution. In other words, we have arbitrarily long strings of unobtainable diﬀerences. Thus we can construct an increasing sequence of integers 0 = x0 < x1 < · · · such that for every r, the sets A + xi are pairwise disjoint for i ∈ [0, r]. Indeed, the base case r = 0 is obvious, and once we ﬁnd x1, . . . , xr for some r ≥ 0, we just need to ﬁnd xr+1 > xr such that A + xi ∩ A + xr+1 = ∅ for every i ∈ [0, r], or equivalently, A ∩ A + xr+1 − xi = ∅, which is easy to ﬁnd through any large sequence of xr + 5 consecutive unobtainable diﬀerences. Taking r arbitrarily large shows that A has zero density. 40. (Miklos) Let f, g be two polynomials with real coeﬃcients such that f (Q) = g(Q). Prove that there exist rational numbers a, b such that f (x) = g(ax + b) for all x. Solution. Take a rational basis over the coeﬃcients of f, g so that we can individually consider polynomials fi, gi ∈ Q[x] for i ∈ [1, n] and then piece everything together. Indeed, if we show fi(x) = gi(aix + bi) for all x, i for some ai, bi ∈ Q, then for every x ∈ Q there exists t(x) ∈ Q[x] such that gi(t(x)) = gi(aix + bi) for all i. By binomial expansion we can show via the rational root theorem that |t(n)| = |ain + bi| for all suﬃciently large positive integers n. Hence there exist a, b ∈ Q such that (ai, bi) = ±(a, b) for every i, and WLOG t(n) = an + b for inﬁnitely many n. But then fi(x) = gi(aix + bi) = gi(ax + b) for all i and x (nonzero polynomials have ﬁnitely many roots), as desired. So it’s enough to solve the case in which f, g ∈ Q[x]. But then we can deﬁne a sequence of rationals xn with bounded denominators such that f (xn) = g(n) for every integer n; similarly deﬁne yn. The rest is standard analytic fare: if deg g < deg f , for instance, we will eventually contradict the bounded denominators condition on xn, so by symmetry deg f = deg g; now taking d th roots of both sides and using Van der Waerden we’re done. 41. (ISL 1990) Prove that every integer k > 1 has a multiple less than k4 with at most four diﬀerent digits. Solution. We can assume k ≥ 10 5 or else the problem is obvious. Now consider all numbers with ℓ + 1 digits, all in {0, 1}: it’s enough to have 2ℓ+1 ≥ k, where ℓ = ⌊log10 k4⌋ − 1; this is trivial. 20 Victor Wang Interesting problem solutions, storage 42. (RMM 2010) Suppose f ∈ Q[x] has degree at least 2, and deﬁne the sets f 0(Q) = Q and f n(Q) = f (f n−1(Q)). Show that ∩ ∞ n=0f n(Q) is a ﬁnite set. Solution. If some a ∈ f n(Q) for all n ≥ 0, then by a simple induction there exists an inﬁnite sequence a0 = a, a1, a2, . . . such that ai = f (ai+1) for all i ≥ 0. Clearly |a| is bounded above, and because all we care about is proving we have a ﬁnite set, we can show that if a works, then bda ∈ Z, where f (x) = (bdxd + · · · + b0)/g for some bi, g ∈ Z and d ≥ 2. The idea is that if vp(a −1 i+1) > vp(bd) ≥ 0 (we take vp(0) = ∞), then vp(a −1 i ) = vp(g/bd) + dvp(a −1 i+1) ≥ vp(g/bd) + d + dvp(bd) = vp(g) + (d − 1)vp(bd) + d ≥ vp(bd) + d. Hence the sequence {vp(a −1 i )}i≥0 is bounded above, so by the earlier size observation we know it must be eventually periodic and thus purely periodic (as au = av means au−1 = av−1). But then we must in fact have vp(a −1 i ) ≤ vp(bd) for all i ≥ 0, and we’re done. 43. Do there exist positive integers a < b (with b − a > 1) such that gcd(a, k) > 1 or gcd(b, k) > 1 whenever k ∈ [a, b]? Solution. Yes. If b = a + r, the condition boils down to gcd(i(r − i), a + i) > 1 for all i ∈ {0, . . . , r}. A good way to do this is to let p, q be primes with q ≡ 1 (mod p) and p2 ≥ p + q (for instance, the smallest pair is (p, q) = (5, 11)). Then take r = p + q + 1 and a ≡ 0 (mod s) for every prime in [1, r − 1] except s = p, q, and let a ≡ −q (mod p), a ≡ −p (mod q). Then a + i is satisﬁed whenever i is not 1, p, q (since p 2 ≥ p + q). So (a, b) = (2184, 2200) works. 44. (Miklos) Let F (n) be the number of functions f : {1, 2, . . . , n} → {1, 2, . . . , n} with the property that if i is in the range of f , then so is j for all j ≤ i. Prove that F (n) = ∑ k≥0 kn 2k+1 . Solution. If we generalize this to {1, 2, . . . , m} → {1, 2, . . . , n} (say F (m, n)), where m, n ≥ 0, then choosing the set of guys such that f (k) = 1 gives the recursion F (m, n) = m∑ k=1 (m k )F (m − k, n − 1) whenever m, n ≥ 1 (we have F (0, n) = 1 for n ≥ 0 and F (m, 0) = 0 for m ≥ 1). Computing G(x, y) = ∑ m,n≥0 F (m, n) xm m! yn gives G(x, y) = 1 (1−y)[1−y(ex−1)] , so it’s easy to ﬁnd [xnyn]G(x, y) = [xn](ex − 1) n + · · · + (ex − 1)0 = [xn] 1 1 − (ex − 1) ; the rest is obvious. We can also do this directly without generalizing: there is an obvious combinatorial interpretation for (ex − 1)n. 45. Find all positive integers n for which there exist four not necessarily distinct primitive nth roots of unity adding up to 1. Solution. For n = 10, take the four roots of unity to be −e2kπi/5 for k = 1, 2, 3, 4. Now we show n = 10; the condition implies Φn(x) | xa+xb+xc+xd−1 for some positive integers a, b, c, d coprime to n. Summing up za+zb+zc+zd = 1 over all primitive roots of unity (use xm−1 = ∏ d|m Φd(x) and induction/Mobius inversion) we get ϕ(n) = 4µ(n), whence n is squarefree and has an even number of prime factors. If n has at least three prime factors p, q, r, then ϕ(n) ≥ (p−1)(q−1)(r−1) > 2·2·2 > 4, so n must have exactly two prime factors p, q. Thus, (p − 1)(q − 1) = 4pq =⇒ {p, q} = {2, 5} =⇒ n = 10. 21 Victor Wang Interesting problem solutions, storage 46. (Russia 2011) A 2010 × 2010 board is divided into L-trominos. Prove that it’s possible to mark one cell in each L-tromino such that every row and each column has the number of marked cells. Solution. We want to smooth in some way. The simplest way to do view this is to start with all the tromino corners marked, so we want to keep some guys the same, and move others in one of the two directions. Observe that every tromino belongs in exactly one pair of neighboring columns (and one pair of neighboring rows). In the original marking, let ri be the number of marked cells in row i and deﬁne cj similarly. We ﬁrst analyze what smoothing does to columns individually, for simplicity (although this is not guaranteed to work, it’s a starting point and we have a lot of symmetry). There are four diﬀerent kinds of trominos aﬀecting column i: they can either lie in columns i − 1, i or i, i + 1, and either have 1 or 2 squares in column i. But if we write out algebraic expressions for the changes in number of marked squares in column i, we see that we have a “telescoping” sum and it will be nicer to instead consider the changes in the quantities Ri = r1 + · · · + ri and Cj = c1 + · · · + cj, because now there are only two diﬀerent types of trominos that can change Ci. Let ai, bi denote the number of trominos in columns i, i + 1 with 2 cells in column i and 2 in column i+1, respectively. Clearly Ci = 2010i+ai+2bi 3 −bi = 670i+ ai−bi 3 . The key now is that ∆Ci = −(xi −yi), where xi, yi of horizontal moves of type-ai, bi trominos, respectively: it’s completely pointless to operate to have both xi, yi > 0, since it can only help for the vertical row-changing operations later on. So we’ll take xi = max(0, ai−bi 3 ) ≤ ai 3 and yi = max(0, bi−ai 3 ) ≤ bi 3 (note that xiyi = 0). Clearly we have no restrictions on the choice of which ai, bi-type trominos to operate on, as long as xi ≤ ai and yi ≤ bi. The rest is easy: take a bipartite graph G = U ∪ V , where U has the 4020 vertices Ri, Cj for 1 ≤ i, j ≤ 2010 and V has the trominos, and we draw edges from Ci (for ﬁxed i) to the trominos of type ai if xi > 0 and the trominos of type bi if yi > 0. Then it’s enough to ﬁnd an edge-subgraph H ⊆ G such that degH (u) ≥ 1 3 degG(u) for all u ∈ U and degH (v) ≤ 1 for all v ∈ V , because by construction we have degG(Ci) ≥ 3| ai−bi 3 |. But degG(v) ≤ 2 for all v ∈ V , so we get a union of pairwise edge-disjpoint paths and even cycles (in fact, cycle lengths must be multiples of 4), where every vertex u ∈ U is an end of at most one (full) path. Now take every other edge of each full cycle and path in H (we can just do this arbitrarily), so that deg H(u) ≥ min(0, degG(v)−1 2 ) ≥ 1 3 degG(u) for every u ∈ U , as desired (if degG(u) > 0, then it’s at least 3 since (ai − bi)/3 is an integer for all i). Observe that nothing in this solution was tricky, as every step simply rewords the problem in increas- ingly convenient fashions. 47. (Bondy’s theorem) Let A1, . . . , An be pairwise distinct subsets of [n]. Show that there exists an element x such that the Ai \\ {x} are also pairwise distinct. Solution. An element x fails iﬀ modulo 2, Ai + Aj = {x} for some indices i, j. So go by contradiction and draw a graph with edges labeled with symmetric diﬀerences (and vertices the n sets). Now remove edges until we have exactly n remaining, one of each {x} (by assumption). Then there must be a cycle, contradiction. Another way to see this is if we let Ai(x) + Aj(x) = {x} for some choice of i(x), j(x) for every x ∈ [n]. But then we don’t have any cycles, so in this way we can reverse-engineer the motivation for the graph. 48. (Classical) If x m + x−m and xn + x−n are both integers (x > 1 is a real number) and gcd(m, n) = 1, show that x + x−1 is also an integer. Solution. First note that if a = xn + 1 xn is an integer, then so is xkn + 1 xkn = 2Tk ( a 2 ) (since 2Tn ( x 2 ) ∈ Z[x]), where Tk(x) denotes the kth Chebyshev polynomial of the ﬁrst kind. Since m, n are relatively prime, we can ﬁnd integers such that jm − kn = 1, so WLOG m = n + 1. Then if a = xn + 1 xn and b = xn+1 + 1 xn+1 , the quadratic formula yields (note that a, b > 2 are integers and x > 1) xn = a + √a2 − 4 2 , x n+1 = b + √b2 − 4 2 . 22 Victor Wang Interesting problem solutions, storage It follows that x + 1 x = ab − √(a2 − 4)(b2 − 4) 2 . But x, 1/x are clearly algebraic integers by the quadratic equations in x n, x n+1, so by the rational root theorem it suﬃces to show that (a 2 − 4)(b 2 − 4) is a rational square. However, this follows trivially by equating the (nonzero) irrational terms in the equation ( a + √a2 − 4 2 )n+1 = ( b + √b2 − 4 2 )n . Alternatively, consider the minimal polynomial of x (over Q), which in particular divides x2n − axn + 1 and x2n+2 − bxn+1 + 1, and so noting that we can generate all roots of these two polynomials by taking xe 2πi/n, for instance, it’s not hard to show that their gcd must be quadratic and by Gauss’s lemma, primitive and monic, as desired. Of course, this is true for any complex number x. 49. (Colosimo Open 2011) Find all n such that there exists a permutation (a1, . . . , an) of [n] with the a1 + · · · + ai (mod n) pairwise distinct. Solution. n = 1 and n even: for n = 2m, take 2m, 1, 2m − 2, 3, 2m − 4, 5, . . . , 2, 2m − 1, which can be found by small cases or guessing simple things. For n odd, note that a1 = n or else two consecutive sums will be equal somewhere, but also n | 1 + · · · + n = a1 + · · · + an, contradiction. 50. (Russia 2011, 11.4) Ten cars, which do not necessarily start at the same place, are all going one way on a highway which does not loop around. The highway goes through several towns. Every car goes with some constant speed in those towns and with some other constant speed out of those towns. For diﬀerent cards these speeds can be diﬀerent. 2011 ﬂags are put in diﬀerent places next to the highway. Every car went by every ﬂag, and no car passed another right next to any of the ﬂags. Prove that there are at least two ﬂags at which all cars went by in the same order. Solution.Let ti denote the time it takes for car i to get to the ﬁrst ﬂag (choose a starting time arbitrarily). Suppose car i takes time per unit distance 0 < ai, bi < ∞ when in and out of town, respectively; let xk, yk ≥ 0 (not both zero) be the distances from ﬂag 1 to ﬂag k along in and out of town routes. Then car i takes Ti(k) = ti + aixk + biyk to get to ﬂag k. If ti = tj for some i ̸= j, then we must have Ti(k) = Tj(k) for all k (or else we violate the “no passing at ﬂags” rule), whence car i is essentially a “clone” of car j. Since clones are ranked the same at each ﬂag, we can remove all clones to get (WLOG) 1 ≤ m ≤ 10 pairwise distinct cars (WLOG cars 1 through m). Then Ti(k) ̸= Tj(k) for all 1 ≤ k ≤ 2011 and 1 ≤ i < j ≤ m. Now note that for i ̸= j, Ti(k) > Tj(k) iﬀ (xk, yk) ∈ Si,j = {(x, y) | Li,j(x, y) = (ai − aj)x + (bi − bj)y + (ti − tj) > 0}, and Ti(k) < Tj(k) iﬀ (xk, yk) /∈ Si,j. Graphing Li,j(x, y) = 0 in the Cartesian plane for 1 ≤ i < j ≤ m (note the symmetry between Li,j and Lj,i), we get at most (M 2 ) + (M 1 ) + (M 0 ) ≤ 1036 (where M = (m 2 ) is the number of lines) distinct regions (well-known, e.g. this). But (xr, yr) and (xs, ys) are in the same region iﬀ the orderings at ﬂags r, s are equal, so we’re done by pigeonhole. Comment. This is not ridiculous or anything, but doing the 1-d case helps a bit. Indeed, this generalizes to any number of dimensions, and the bound should be basically tight and not hard to ﬁnd. 51. (Russia 2002, 11.8) Show that the numerator of Hn (in reduced form) is inﬁnitely often not a prime power. Solution. Outline: Bound denominators using powers of 2 and primes from n/2 to n. Consider pk − 1 for k ≥ 1, and note that vp(Hpn) ≥ vp(Hn) − 1, so consider p k − p as well. Subtracting dudes, get a contradiction. 23 Victor Wang Interesting problem solutions, storage 52. (Sierpinski) Prove that for all N there exists a k such that more than N prime numbers can be written in the form f (T ) + k for some integer T , where f ∈ Z[x] is a nonconstant monic polynomial. Solution. Let d = deg f . For ﬁxed k, let g(k) denote the number of positive T such that f (T ) + k is prime, and suppose for the sake of contradiction that there exists some N such that g(k) ≤ N for all k ≥ 1. Fix a real s > 1; if P is the set of primes, then N ∑ k≥1 1 ks ≥ ∑ k≥1 g(k) ks = ∑ p∈P ∑ 1≤f (T )<p 1 (p − f (T ))s ≥ ∑ p∈P p 1/d − c ps for some c independent of p. Any 1 < s ≤ 1 + 1/d gives the desired contradiction, since the sum of the reciprocals of the primes diverges. This is also not diﬃcult using elementary forms of the PNT. Indeed, if we consider f (1), . . . , f (n) for some ﬁxed n and for every prime p ≤ c1nd, take the smallest i such that f (i) < p and consider k = p − f (i), then by pigeonhole some k ≤ c2nd−1 (the size of the largest “gap” between consecutive f (i)) will appear at least cn/ log(nd) times, which is unbounded. 53. (ROM TST 1996) Let n ≥ 3 and consider a set S of 3n2 pairwise distinct positive integers smaller than or equal to n3. Prove that one can ﬁnd nine distinct numbers a1, . . . , a9 ∈ S and three nonzero integers x, y, z ∈ Z such that a1x + a2y + a3z = 0, a4x + a5y + a6z = 0, and a7x + a8y + a9z = 0. Solution. The key is to realize that we probably want to use pigeonhole somehow (the 3n2 and n3 are rather ugly for an inductive argument). But this is not really related to the geometry of numbers since we have at least as many equations as variables, so we want to “ﬁx” some sort of vector (x, y, z) and then ﬁnd the ai’s from there (the three vectors (a1, a2, a3), etc. are orthogonal to (x, y, z)). Now we want to get a feel of the most natural way to ﬁx (x, y, z). Note that we can parameterize all solutions to ax + by + cz = 0 by (x, y, z) = (sb − tc, rc − sa, ta − rb). This gives us the idea of ﬁxing r, s, t (all nonzero for pigeonhole to work out). Intuitively, to get the best bounds for this simplest case, we want to take r = s = t = 1 (or all −1). (Furthermore, if we had, say, s ̸= t, then it would be hard to control the requirement that x, y, z are all nonzero.) Luckily, the rest works out easily: to make x, y, z as small as possible (for pigeonhole to work optimally, since we know all the ai are less than or equal to n3), let the elements of S be s1 < s2 < · · · < s3n2, and for the a1, a4, a7, choose from the ﬁrst set of n2 indices, for a2, a5, a8, choose from the second set of n2 indices, and for a3, a6, a9, choose from the last set of n2 indices. We get a total of N = (n 2) 3 (optimal by AM-GM) (x, y, z) (note that x + y + z = 0 and x, z < 0), yet only M = (n3 − 1)(n3 − 2)/2 < N/2 triples with x + y + z = 0 and x, z < 0 are possible in the ﬁrst place (to count all possible triples, we can assume the smallest number chosen is 1 and then choose two larger values in the range [2, n 3]), so by pigeonhole, some (x, y, z) must occur at least ⌈N/M ⌉ = 3 times, as desired. 54. (USA TST 2003) For a pair a, b of integers with 0 < a < b < 1000, a subset S of {1, 2, . . . , 2003} is called a skipping set for (a, b) if |s1 − s2| ̸∈ {a, b} for any (s1, s2) ∈ S2. Let f (a, b) be the maximum size of a skipping set for (a, b). Determine the maximum and minimum values of f . Solution. Let T = {1, 2, . . . , 2003}. For the minimum, note that we can keep doing the following: take min T , which kills at most two others in T (min T + a, min T + b if they’re in T ), and repeat with the new set T ′. Each time we remove at most 3 elements, so we end up with at least ⌈2003/3⌉ = 668 elements, which is realized for (a, b) = (1, 2). For the maximum, we ﬁrst analyze the one variable case to gain some intuition: of course, for ﬁxed a, we can just consider each residue modulo a separately (and it’s just alternating in S, out S, etc. for 24 Victor Wang Interesting problem solutions, storage a ﬁxed residue), where the best ratio is around (2/3)|T |, achieved for S = {1, 2, . . . , j, k, . . . , 2003} for j, 2003 − k ≈ 2003/3. With the proof and construction for the one variable case in mind, we suspect that f (a, a + 1) for a ≈ 2003/3 will give the maximum (we know it can’t be far). Indeed, we can get f (667, 668) ≥ 1334 with S = {1, 2, . . . , 667, 1337, 1338, . . . , 2003}. It remains to show that f (a, b) ≤ 1334 always. Assume for the sake of contradiction that f (a, b) ≥ 1335 for some 0 < a < b < 1000. First we get some crude estimations from f (a) alone: letting 2003 = qa + r = (q + 1)r + q(a − r) for q = ⌊2003/a⌋ and 0 ≤ r < a, we get 1335 ≤ f (a, b) ≤ f (a) = ⌈(q + 1)/2⌉r + ⌈q/2⌉(a − r). If q is odd, this becomes 1335 ≤ (qa + a)/2 ≤ (2003 + a)/2 =⇒ a ≥ 667, and if q is even, then 1335 ≤ qa/2 + r = (2003 + r)/2 =⇒ a > r ≥ 667. Hence a ≥ 667. If a > 667, then a < 1000 =⇒ q = 2, so r = 2003 − 2a and from the previous paragraph, 1335 ≤ a+r = 2003−a =⇒ a ≤ 668. Thus a = 668, so because equality holds everywhere, we must have S = {1, 2, . . . , 668, . . . , 1337, 1338, . . . , 2003}, which contradicts 1000 > b ≥ a + 1 = 669. Otherwise, if a = 667, then q = 3, so 1335 ≤ (q + 1)a/2 = 2a =⇒ a ≥ 667.5, contradiction. 55. (Erdos and Selfridge) Find all positive integers n > 1 with the following property: for any real numbers a1, . . . , an, knowing the numbers ai + aj, i < j, determines the values a1, . . . , an uniquely. Solution. The property (say, goodness) holds iﬀ for every two “polynomials” f (x) = ∑n i=1 xai and g(x) = ∑n i=1 xbi (with real but not necessarily integer exponents), then f (x)2 − f (x2) = g(x) 2 − g(x2) =⇒ f (x) = g(x). We’ll show that n is good iﬀ it’s not a power of 2. To do this, we want to do some sort of bounding with values in [0, 1] (maybe > 1), algebraic manipulation (especially either using f (x) 2 − g(x) 2 = f (x2) − g(x2) to telescope products some way or diﬀerentiation), or just special values. Screwing around, it turns out diﬀerentiation is pretty helpful here. If n is not a power of 2, then by the general Leibniz rule on [f (x)f (x)] (m) and the fact that [f (x2)] (m) = (2x) mf (m)(x2) + m−1∑ j=0 Pm,j(x)f (j)(x2) for some polynomials Pm,j (both facts are easily proven by induction), we can show by induction on m ≥ 0 (base case is just f (1) = g(1) = n) that (sorry for sloppiness, but this is assuming the strong inductive hypothesis for ≤ m − 1) 2 m(f (m)(1) − g(m)(1)) = 2n[f (m)(1) − g(m)(1)], which implies f (m)(1) = g(m)(1) for all m ≥ 0. Thus (by induction/Stirling numbers) ∑ a r i = ∑ br i for all integers r ≥ 0, so by easy bounding considerations f (x) = g(x). Otherwise, let n = 2 m. For the construction, we take f, g to be actual polynomials (i.e. with integer exponents), so taking the induction from the previous paragraph up until m, we have that f (x)−g(x) = (x−1)m+1h(x) for some polynomial h(x). Plugging this in, we have f (x)+g(x) = (x+1)m+1h(x2)/h(x). We can just take h(x) = 1 (identically); then the sets of numbers corresponding to f (x) = [(x+1) m+1 + (x − 1)m+1]/2 and g(x) = [(x + 1)m+1 − (x − 1) m+1]/2 suﬃce. Edit: There’s a cleaner way using rational approximation (assume all the guys are large integers). If 1 is a root of f (x) − g(x) with multiplicity k, then f (x) − g(x) = (x − 1)ku(x) for some u(1) ̸= 0. But then f (x2) − g(x2) = (x − 1) k(x + 1)ku(x2) means that f (1) + g(1) is a power of 2, as desired. 56. (Brouwer-Schrijver) Prove that the minimal cardinality of a subset of (Z/pZ) d that intersects all hy- perplanes is d(p − 1) + 1. 25 Victor Wang Interesting problem solutions, storage Solution. Suppose by way of contradiction that there’s a set S intersecting all hyperplanes with |S| ≤ d(p − 1). WLOG (0, 0, . . . , 0) ∈ S; now consider the polynomial (over Fp) f (x) = ∏ s∈S′=S\\0(⟨x, s⟩ − 1) + C d∏ i=1 p−1∏ j=1(xi − j), where C ̸= 0 is taken so that f (0) = 0. Since |S′| ≤ d(p − 1) − 1, deg f = d(p − 1). Since the coeﬃcient of xp−1 1 · · · xp−1 d in f is nonzero, CNS guarantees y ∈ F d p such that f (y) ̸= 0 (C ̸= 0 =⇒ y ̸= 0), whence S does not intersect the plane ⟨y, t⟩ = 1 (obviously t = (0, 0, . . . , 0) does not belong to it, and because y ̸= 0, the second part of f vanishes at y and so the ﬁrst cannot, whence S′ does not intersect the plane either), contradiction. On the other hand, the construction for d(p − 1) + 1 is obvious: just take S the set of (s1, . . . , sd) with at least d − 1 of the si’s zero (if a plane does not contain the origin, it’s WLOG of the form x1s1 + · · · + xdsd = 1 with x1 ̸= 0, and so (1/s1, 0, . . . , 0) works). Comment. This extends directly to any ﬁnite ﬁeld Fq. 57. (MOP 2007) In triangle ABC, point L lies on side BC. Extend segment AB through B to M such that ∠ALC = 2∠AM C. Extend segment AC through C to N such that ∠ALB = 2∠AN B. Let O be the circumcenter of triangle AM N . Prove that OL ⊥ BC. Solution. Extend M C and N B to hit (AM N ) at M ′ and N ′, respectively. By easy angle chasing, ∠N ′M M ′ = 90◦, so O is the midpoint of N ′M ′; let L ′ denote the foot of the perpendicular from O to BC (we want to show L = L ′). By Pascal’s theorem on AAM M ′N ′N , there exists a point X = AA ∩ M ′N ′ ∩ BC, so XAOL′ is cyclic. Thus ∠AL ′B = ∠AL ′X = ∠AOX = ∠AON ′ = 2∠AN N ′ = 2∠AN B and similarly ∠AL ′C = 2∠AM C, as desired. Alternatively, trig bash with POP to show that OB2 − OC 2 = LB2 − LC 2. 58. (MOP 2010) Fix n points in space in such a way that no four of them are in the same plane, and choose any ⌊n2/4⌋ + 1 segments determined by the given points. Determine the least number of points that are the vertices of a triangle formed by the chosen segments. Solution. Interpret this as a graph G = G1 ∪ G2, where all v ∈ G1 are good (i.e. belong to some triangle) and all v ∈ G2 are bad. We induct on n ≥ 1 to show that |G1| ≥ 2 + ⌊n/2⌋, where the base cases n = 1, 2 are vacuously true. Now suppose n ≥ 3. By Turn’s theorem, we have a triangle uvw. Suppose that |G1| ≤ 1 + ⌊n/2⌋. If deg u + deg v − 1 ≤ n − 1, then removing u, v (and the edges incident to them) and noting that n2/4 = n − 1 + (n − 2)2/4, the inductive hypothesis gives us at least 2 + (2 + ⌊(n − 2)/2⌋) = 3 + ⌊n/2⌋ > 2 + ⌊n/2⌋ vertices in G1 (the 2 comes from u, v). Otherwise, if deg u + deg v ≥ n + 1, then by pigeonhole, WLOG deg u ≥ ⌈(n + 1)/2⌉ = 1 + ⌊n/2⌋ ≥ |G1|, so u is connected to some x ∈ G2. Since x ∈ G2, deg u + deg x ≤ 1 + (n − 2) = n − 1, so removing u, x and applying the inductive hypothesis gives us |G1| ≥ 1 + (2 + ⌊(n − 2)/2⌋) = 2 + ⌊n/2⌋, contradiction (the 1 comes from u). 26 Victor Wang Interesting problem solutions, storage 59. (Bulgarian solitaire) Suppose we have N = 1 + 2 + · · · + n cards total among some number of stacks. In each move, Bob takes one card from each stack and forms a new stack with them. Show that Bob eventually ends up with 1, 2, . . . , n in some order. Solution. We want to ﬁnd some monovariant I. First, it’s convenient to visualize the stacks as consecutive sets of lattice points in the ﬁrst quadrant (e.g. lower left at (1, 1)). For simplicity, arrange the stacks in nonincreasing order (although it turns out this doesn’t matter). Motivated by the ﬁnal conﬁguration, we take I = ∑ x + y over all points (x, y) corresponding to cards in our conﬁguration. Suppose we have stacks of size a1 ≥ · · · ≥ ak ≥ 1 > 0 = ak+1, and 1 ≤ i ≤ k + 1 is the smallest index such that ai ≤ k + 1. Then to compute ∆I, visualize the process as reﬂecting the points on y = 1 over the line y = x, shifting the points with y > 1 via (x, y) 7→ (x + 1, y − 1) (up to this point, ∆ ∑ x + y = 0), and then reordering the columns/stacks (here, ∆ ∑ x ≤ 0, with equality iﬀ i = 1). Thus ∆I ≤ 0, with equality iﬀ a1 ≤ k + 1. (*) There are ﬁnitely many conﬁgurations, so suppose we get into a loop with constant I. Then we cannot have any of the nontrivial “reordering” mentioned in (*), i.e. in any step, we have (x, y) 7→ (x+1, y −1) if y ≥ 2 and (x, y) 7→ (y, x) if y = 1 (so x + y is preserved for each card). In particular, for ﬁxed ℓ ≥ 2, the points with coordinates summing up to ℓ “cycle” along the line x + y = ℓ. Considering maximal ℓ, it’s easy to see that because N is a triangular number, this ﬁnal loop must be a constant loop with k = n and aj = n + 1 − j for 1 ≤ j ≤ k, as desired. Note that this method also determines the possible ﬁnal states for N not necessarily triangular. 60. (Russia 2003, 11.4) Ana and Bora start with the letters A and B, respectively. Every minute, one of them either prepends or appends to his/her own word the other person’s word (not necessarily operating one after another). Prove that Ana’s word can always be partitioned into two palindromes. Solution. Call a word good if it can be partitioned into two palindromes. The possible operations are {X, Y } 7→ {X, XY }, {X, Y X}, {Y, XY }, {Y, Y X}. So there are basically two ways to look at the process: we can either think of it as directly showing XY and Y X are good given X, Y , or we can think of it as “preserving” goodness through X 7→ XY , etc. (basically stupid, forward induction vs. “reverse” induction). The ﬁrst way gets too messy quickly, so we focus on the more natural second way, i.e. by induction, it suﬃces to show that goodness is preserved by any of the substitutions A 7→ AB, A 7→ BA, B 7→ AB, and B 7→ BA. Hence we consider what A 7→ AB does to a palindrome P (the other cases are analogous); it’s easy to show (by comparing the left-to-right and right-to-left orientations) that if P 7→ P ′, then BP ′ and P ′/B (sorry for terrible notation) are palindromes. Therefore if P 7→ P ′ and Q 7→ Q ′ for palindromes P, Q, then P ′Q ′ = (P ′/B)(BQ′), as desired. 61. (Motzkin-Rabin) Let S be a ﬁnite set of points in the plane (not all collinear), each colored red or blue. Show that there exists a monochromatic line passing through at least two points of S. Solution. After playing around with this setup a bit (with contradiction), we see that the most annoying issue is “betweenness”, which screws up a lot of positioning by forcing a lot of cases on us. So we prove the projective dual instead, since lines are generally much more ﬂexible with positioning: for a ﬁnite set S of lines in the projective plane (not all concurrent), each colored red or blue, we prove that there exists a monochromatic point belonging to at least two lines of S. Indeed, suppose the contrary (WLOG, we work in the Euclidean plane by taking a suitable projection to ensure that no two lines intersect at inﬁnity). Clearly, the blue lines are not all concurrent (same for the red lines). 27 Victor Wang Interesting problem solutions, storage Consider two lines ℓ1, ℓ2 of the same color α passing through point A. Then there exists a line ℓ3 of the other color β passing through A as well. Since not all lines of color β pass through A, there exists a line ℓ4 of color β passing through a point B ∈ ℓ3 \\ {A}. Let C = ℓ4 ∩ ℓ1 and D = ℓ4 ∩ ℓ2. The rest is easy: taking such a conﬁguration with minimal area [ACBD], B must be monochromatic (color β), or else there exists a line through B of color α, and we get a smaller conﬁguration (the line must intersect either segment AC or segment AD). 62. (KMaL) Let k be an integer and a1, a2, . . . , an be integers that give at least k + 1 distinct remainders when divided by n + k. Prove that some of these n numbers add up to a multiple of n + k. Solution. Assume for the sake of contradiction that no nonempty zero-sum subset exists. To use pigeonhole modulo n + k (which is really the only reasonable way), we need to get both k and n involved. The easiest way to do this is to WLOG let a1, . . . , ak+1 (mod n + k) be pairwise distinct (we know such numbers exist by the problem hypothesis) and consider the partial sums sk+1 = a1 + · · · + ak+1, . . . , sn = a1 + · · · + an (mod n + k) (which are pairwise distinct and nonzero by our assumption; we start at the (k+1)th partial sum so that when we subtract elements from {a1, . . . , ak+1} we still have a sum of distinct ai). Now we need another set of at least (n + k) − (k + 1) − (n − k) = k − 1 nonzero elements for pigeonhole to work; something like {−a1, . . . , −ak+1} quickly comes to mind (since the ai are distinct, at most one of them can satisfy ai ≡ −ai (mod n + k), and we can aﬀord to lose a few), provided we make it compatible with {sk+1, . . . , sn}. But this is easy, since adding sk+1 to every entry to get {sk+1 − a1, . . . , sk+1 − ak+1} does not make it less compatible with {a1, . . . , ak+1}. WLOG ai ̸≡ sk+1 − ai (mod n + k) for 1 ≤ i ≤ k − 1 (we can assign the roles to i = k and i = k + 1 if necessary); then the sets {a1, . . . , ak+1}, {sk+1 − a1, . . . , sk+1 − ak−1}, and {sk+1, . . . , sn} each contain pairwise distinct nonzero elements modulo n+k. But they have (k+1)+(k−1)+(n−k) = n+k elements in all, so by pigeonhole some two sets must intersect (we are only dealing with the n + k − 1 nonzero elements). If the third set intersects with either the ﬁrst or the second, we obviously get a nonempty zero-sum subset; otherwise, if the ﬁrst two sets intersect, then we must have k − 1 ≥ 1 =⇒ k ≥ 2 and sk+1 − ai − aj ≡ 0 (mod n + k) for some i ̸= j, which also gets a nonempty zero-sum subset since sk+1 − ai − aj contains at least (k + 1) − 2 = k − 1 ≥ 1 terms. 63. (AMM) Let P0, P1, . . . , Pn−1 be some points on the unit circle. Also let A1A2 · · · An be a regular polygon inscribed on this circle. Fix an integer k with 1 ≤ k ≤ n/2. Prove that one can ﬁnd i, j such that AiAj ≥ A1Ak ≥ PiPj. Solution. For a real number x, let |x|n = d(x, nZ) denote how far x is from its closest integer multiple of n (i.e. absolute value (mod n)). If we go by contradiction, then we have that |pi − pj|n ≤ k − 1 =⇒ |i − j|n ≤ k − 2, where p0, . . . , pn−1 ∈ R represent the positions of P0, . . . , Pn−1 on an angular scale. To utilize this local information (which restricts what points can be close to each other) in the context of our global situation of n reals spread out (mod n), we want to get a lot of the pi in some interval [r, r + k − 1] (mod n). On average, [r, r + k − 1] (mod n) contains n · (k − 1)/n = k − 1 of the pi. If some [r, r + k − 1] (mod n) contains k or more of the pi, then two of the indices u, v must satisfy |u − v|n ≥ k − 1, contradiction. Otherwise, the interval [r, r + k − 1] (mod n) contains exactly k − 1 of the pi for almost all r (except for a set of zero density), which is impossible as we consider r ∈ [pm − ϵ, pm + ϵ] for any m and suﬃciently small ϵ > 0 unless pim = pm + k − 1 for some im; but then we get k or more pi in [pm, pm + k − 1] (mod n). 64. (1998 C1) A rectangular array of numbers is given. In each row and each column, the sum of all numbers is an integer. Prove that each nonintegral number x in the array can be changed into either ⌈x⌉ or ⌊x⌋ so that the row-sums and column-sums remain unchanged. (Note that ⌈x⌉ is the least integer greater than or equal to x, while ⌊x⌋ is the greatest integer less than or equal to x.) Solution. We want to reduce the number of non-integers while preserving row and column sums. Intuitively, if we change x to ⌊x⌋, then if we can increase by {x} something else in the same row or column and keep alternately increasing/decreasing stuﬀ, we’ll eventually have to “cycle” back to x (and 28 Victor Wang Interesting problem solutions, storage the cycle must have even length, since we switch between modifying in the same row and modifying in the same column). This motivates us to take a bipartite graph R ∪ C where R is the set of rows, C is the set of columns, and the grid numbers are written on corresponding edges. Furthermore, we can take out all edges with integer labels; we want to get down to zero edges. Because all rows and columns have integer sums, each vertex has degree at least 2, and so we can ﬁnd an (even) cycle. Then the rest is clear: taking an edge label x in the cycle that minimizes |[x] − x| (where [x] denotes the nearest integer function), we can proceed as described in the ﬁrst paragraph. 65. (2003 HMMT Guts) A teacher must divide a apples evenly among b students, where a ≤ b. What is the minimal number of pieces into which she must cut the apples? (A whole uncut apple counts as one piece.) Solution. Trying some small cases really helps to ﬁnd this crucial lemma... Lemma. If gcd(p, q) = 1 and p ≤ q, then the teacher can divide p apples evenly among q students with just p + q − 1 pieces in all. Proof. One way is just inducting on p + q. Otherwise, motivated by the previous problem, we interpret this as a bipartite graph G = A ∪ S the edges represent the portions of apple students in S get from the vertices in A. At ﬁrst, label each edge with 1/q. We want to reduce to p + q − 1 edges (i.e. a tree) by modifying edges and deleting the zero labels. To this end, suppose we have a cycle C, which must be even since G is bipartite. If the edge label 0 ≤ x ≤ p/q minimizes ϵ = min{x, p/q − x} in the cycle, then change x to 0 or p/q accordingly and alternately modify the other edges in the cycle by ±ϵ, preserving both the sum of edges emanating from vertices in A (which must be 1) and the sum of edges emanating from vertices in S (which must be p/q), as well as the positiveness of the edge labels. If we change x to 0 in the process, then we lose at least one edge; otherwise, if we change it to p/q, then the vertex in S belonging to it goes from ≥ 2 edges (necessary to participate in the cycle) to exactly 1 edge (since all its other edges must become 0), and we still lose at least one edge. Clearly this process terminates when we reach a tree of p + q − 1 vertices, as desired.■ Let (a, b) = (gp, gq) for g = gcd(a, b), so gcd(p, q) = 1. The bipartite graph G = A ∪ S only has connected components with u vertices in A and v vertices in S with u = (p/q)v and thus at least pr + qr − 1 edges for some r ≥ 1. Since the sum of all such r is g, there are at most g components and thus at least pg + qg − g = a + b − gcd(a, b) edges, with equality achievable by the lemma. 66. (2009 AMP Team Contest) Given a set of positive integers ranging from 1 to n with sum no less than 2n!, show that there exists a subset of them summing up to exactly n!. Solution. Induction is clearly the most natural path, as long as we ﬁnd a reasonable way to go down from [1, n] and n! to [1, n − 1] and (n − 1)!. Lemma. Given ≥ n integers, we can ﬁnd ≤ n of them with sum divisible by n. Proof. Well-known pigeonhole on partial sums (mod n).■ Directly using this lemma and inducting does not work, because we can be left with n − 1 numbers in [1, n − 1]. However, (n − 1) · (n − 1) is quadratic, so with a little ﬁddling we weaken the hypothesis to “≥ 2n! − n”, with the base case n = 1 being clear. Now it works smoothly, since if we use the lemma to break our set into groups of ≤ n numbers with sum both divisible by n and at most n(n − 1) (ﬁrst we put the n’s in their own groups, and then just work with the numbers in [1, n − 1]), then dividing each of these groups’ sums by n, we have a new sum at least ⌈ 2n! − n − (n − 1) 2 n ⌉ = 2(n − 1)! − (n − 1), for n ≥ 2, as desired. Alternative method by Palmer: Induct. n = 1 is obvious. First of all, given the problem statement is true for n, we easily generalize it to the following: Given a sequence for which the sum is at least k · n!, we can ﬁnd k − 1 pairwise disjoint subsequences each 29 Victor Wang Interesting problem solutions, storage of which sum to n!. Given all up to n, consider the sum of all terms in the sequence equal to n. If it as at least n!, then we just pick them. If it is less than n! − (n − 1)!, then the sequence formed of the terms from 1, 2, . . . , n − 1 has sum at least n! + (n − 1)! = (n + 1)(n − 1)! so we use the generalization above to get n sequences summing to (n − 1)! and we just combine them. So if the sum of ns in the sequence is sn, we have n! − (n − 1)! < sn < n!. In particular the sum of all of the terms not equal to n is greater than n!. So that means we can ﬁnd n − 1 disjoint subsequences that sum to (n − 1)!, and we will still have at least one term left over. Pick one of those terms and let it be m. Consider the sequence (n − 1)!, 2(n − 1)!, . . . , (n − 1)(n − 1)!. Either one of these is divisible by n or all of the residues are distinct mod n. In the ﬁrst case, take the term divisible by n and include as many terms equal to n as needed to get the sum to n!. This is possible since sn > n! − (n − 1)!. In the second case, we cover all nonzero residues. Find the one with residue −m and include it with m. Now we have a sum divisible by n that is at least (n − 1)!, so proceed as in the previous case. This bound can probably be brought way lower, but I didn’t feel like analyzing the case where was prime in that much detail, which is when case (ii) occurs. 67. (China 2007) Prove that for any given positive integer n, there exists a unique polynomial f (x) of degree n with integer coeﬃcients such that f (0) = 1 and (x + 1)f (x)2 − 1 is odd. Solution. We will show that up to sign, there is in fact a unique polynomial in R[x]. Let f (x) = p(x2)+xq(x2), so (x+1)f (x) 2 −1 = −[(−x+1)f (−x) 2 −1] rewrites as x[p(x)+q(x)] 2 +(1−x)p(x)2 = 1. (*) Let r(x) = p(x) + q(x). Diﬀerentiating both sides, we have r(x)[r(x) + 2xr′(x)] = p(x)[p(x) + 2(x − 1)p ′(x)]. Clearly deg p = deg r or else (*) can’t hold (the leading coeﬃcients must be the same up to sign), so because gcd(p(x), r(x)) = 1, p(x) must divide r(x) + 2xr′(x) and so there exists a constant c such that p(x) = c[r(x) + 2xr′(x)]. Plugging this into (*), we get the diﬀerential equation 1 = [x + c 2(1 − x)]r(x) 2 + 4c 2x(1 − x)r′(x)r(x) + 4c 2x2(1 − x)r′(x)2. From the quadratic formula, we ﬁnd r′(x) = − c(x − 1)r(x) ± √(x − 1)[xr(x)2 − 1] 2cx(x − 1) , or letting s(x) = r(x)√x so that 2xr′(x)√x = 2xs ′(x) − s(x) and simplifying, 2cs ′(x) √s(x)2 − 1 = √ 1 (2x − 1)2 − 1 , where WLOG limx→∞ s(x) = ∞. Anyway, it’s easy to ﬁnd that ∫ 1 √x2 − 1 dx = ln(x + √ x2 − 1) + C, so for some constant C0 we have c ln(s(x) + √s(x)2 − 1) = ln( √x + √x − 1) + C0, i.e. 1 s(x) − √s(x)2 − 1 = s(x) + √ s(x)2 − 1 = eC0/c( √x + √x − 1)1/c, so there exist constants C1, C2 such that r(x) = eC1 ( √x + √x − 1)C2 + e−C1(√x − √x − 1)C2 2 √x . 30 Victor Wang Interesting problem solutions, storage Since r is a polynomial, we clearly have C2 ∈ Z and thus C1 = 0. Now we can easily compute f (x) = (1 − x)p(x2) + xr(x2) = Tn+1(x) − (x − 1)Un(x) (up to sign of course). Note that (*) rearranges to the Pell equation u(x)2 − (x2 − 1)v(x) 2 = 1 upon the substitutions u(x) = xr(x2), v(x) = p(x2). As for actually using Chebyshev polynomials in number theory... well it turns out that T2n+1(x) x is almost never a perfect square for integers x, n. 68. (Albania 2009) Find all diﬀerentiable functions f : R → R such that f (x) = f (x/2) + (x/2)f ′(x) for all x ∈ R. Solution. First we show that f ′ is continuous everywhere. For x ̸= 0, this is obvious by the continuity of f (of course, f ′ is in fact diﬀerentiable at x). To show f ′ is continuous at 0, we ﬁnd by the deﬁnition of f ′(0) that f (x) = xf ′(0) + f (0) + o(x) and observe that lim x→0 f ′(x) = lim x→0 f (x) − f (x/2) x/2 = lim x→0 f ′(0) + o(1) = f ′(0), as desired. Now observe that for any x ̸= 0, there exists x′ strictly between x/2 and x satisfying f ′(x′) = f ′(x) (by the mean value theorem). (*) Assume for the sake of contradiction that some y ̸= f ′(0) lies in the range of f ′, and take the inﬁmum m ≥ 0 of S = {|x| : f ′(x) = y}. By (*), S has an inﬁnite subsequence of decreasing absolute value tending to ±m (for a ﬁxed sign), whence m ∈ S by continuity and m ̸= 0 by assumption. Then if we take x0 of absolute value m such that f ′(x0) = y, there exists (again by (*)) x′ 0 strictly between x0/2 and x0 satisfying f ′(x ′ 0) = f ′(x0) = y, contradicting the deﬁnition of m. Thus f ′(x) is constant, so f (x) = ax + b for some reals a, b; this clearly works. 69. (St. Petersburg) Is it possible to partition the set of all 12-digit numbers into groups of four numbers such that the numbers in each group have the same digits in 11 places and four consecutive digits in the remaining place? Solution. We show that even the weakening to sums of digits does not allow such a partition. Indeed, depending on interpretation, this would require ∑ xsi(1 + x + x2 + x3) ∈ {(x + · · · + x 9)(1 + · · · + x9)11, (1 + · · · + x9) 12, whence reducing modulo 1 + x + x2 + x3, we must have either (1 + x)11 or (1 + x)12 divisible by 1 + x + x2 + x 3. Taking x = i, for instance, shows this is not possible. 70. (St. Petersburg 2003) Let p be a prime and let n ≥ p and a1, . . . , an be integers. Deﬁne f0 = 1 and fk the number of subsets B ⊆ {1, 2, . . . , n} having k elements such that p | ∑ i∈B ai. Show that p divides f0 − f1 ± · · · + (−1)nfn. Solution. If F (x, y) = ∏n i=1(1 + xaiy), then we just need to show that xp − 1 | F (x, −1) in Fp, which is easy since n ≥ p means (x − 1)p | F (x, −1). Alternatively, we can get a bit of a strenghtening for n ≥ 2p by considering extensions of vp (working in Qp instead?) to things like vp(1 − ωk), where ω is a primitive p th root of unity. 71. (M. Haiman, D. Richman, AMM 6458) Let x, y be noncommutative variables. Express in terms of n the constant term of the expression (x + y + x−1 + y−1) n. Solution. I think it is actually A035610. (The proof also works for “the number of length 2n words over an alphabet of size 4 that can be built by repeatedly inserting doublets into the initially empty word”. A direct bijection shouldn’t be hard to ﬁnd, although it seems a bit annoying to describe explicitly.) Let f (n) (for n ≥ 0) be the constant term of (x + y + x−1 + y−1) 2n (of course, the answer is 0 for odd exponents), or equivalently, the number of expressions w1w2 · · · w2n evaluating to 1 in the free group generated by x, y, x−1, y−1 (call these n-words). In the same vein as the Catalan left/right parentheses 31 Victor Wang Interesting problem solutions, storage bijection (where we match the leftmost parenthesis with its partner to get a recursion), it will be convenient to deﬁne g(n) (for n ≥ 1) as the number of primitive n-words w1w2 · · · w2n evaluating to 1 such that there does not exist m ∈ (0, 2n) satisfying w1w2 · · · wm = 1 (of course, m would have to be even for this to happen). Clearly f (0) = 1 and g(1) = 4, and considering the smallest index m such that w1w2 · · · w2m = 1 given an n-word w1w2 · · · w2n, we ﬁnd f (n) = g(n)f (0) + g(n − 1)f (1) + · · · + g(1)f (n − 1) for n ≥ 1. It remains to compute g(n). First we prove by a simple induction on m ≥ 1 that a primitive m-word w1w2 · · · w2m must have w1w2m = 1: the claim is obvious for m = 1 and for m ≥ 2, there exists an index i ∈ [1, 2m+1] such that wiwi+1 = 1, where by primitiveness i ∈ (1, 2m+1); now by the inductive hypothesis on w1 · · · wi−1wi+2 · · · w2m the claim follows. (*) Now it is not too diﬃcult to ﬁnd a recursion for g(n) (although it is trickier than the Catalan case), as an n-word W = w1 · · · w2n is primitive iﬀ it’s of the form wU1U2 · · · Urw−1 for some letter w and non- empty primitive words U1, U2, . . . , Ur (r ≥ 0) that do not start with w−1. Indeed, if W is a primitive n-word then by (*) w1w2n = 1, so expressing the n − 1-word w2 · · · w2n−2 as a product of non-empty primitive words U1 · · · Ur for some r ≥ 0 and noting that wU1 · · · Ukw−1 = 1 for all k ∈ [0, r], we see that no Ui can start with w−1. On the other hand, if W is of the form wU1U2 · · · Urw−1 but not primitive, then take the smallest m such that w1 · · · w2m = 1 (which must be a primitive m-word), so w1w2m = 1. But the Ui are all primitive, so w2 · · · w2m−1 = 1 is of the form U1 · · · Uk for some k ∈ (0, r), contradicting the fact that by construction, Uk+1 (which must start with w2m = w−1 1 ) does not start with w−1. Thus g(n) = ∑ ( 3 4 g(ℓ1)) ( 3 4 g(ℓ2) ) · · · ( 3 4 g(ℓr) ) , where the sum runs over all r-tuples of positive integers satisfying ℓ1 + · · · + ℓr = n − 1. Equivalently by induction (we can also get this directly by noting that wU2U3 · · · Urw−1 is also primitive), g(n) = 3 4 n−1∑ k=1 g(k)g(n − k), whence G(x) = ∑ n≥1 g(n)xn = 4x + 3 4 G(x) 2. From earlier, we have F (x) = ∑ n≥0 f (n)xn = 1 + F (x)G(x), so now we can solve to get G(x) = 2 3 (1 − √1 − 12x) = ∑ n≥1 4 · 3 nCn−1xn and F (x) = 1 1 − G(x) = ∑ n≥0(16x)n ( 1 − n∑ r=1 ( 3 16 )r Cr−1 ) , where Cn denotes the nth Catalan number. Comment. There is also a more visual block walking proof (Mark Sellke showed me this). Start from the origin in the Cartesian plane (we will always stay on or above the x-axis). At the kth step (k ≥ 1), suppose we’re at (k − 1, t), and move up by (+1, +1) if there exists j ∈ [1, k − 1] such that 32 Victor Wang Interesting problem solutions, storage wjwj+1 · · · wk = 1; otherwise move down by (+1, −1). It’s not hard to show that we always stay above the y-axis, so using a similar notion to the primitiveness described earlier, we can directly ﬁnd the continued fraction of F (x), i.e. 1 1 − 4x 1 − 3x 1 − 3x 1 − 3x 1 − . . . , from which it’s standard to derive a closed form for F (we get a quadratic equation, as above). 72. Generating functions for Catalan numbers modulo p: from (1 − 4x) −1/2 = ∑ n≥0 (2n n )xn, we have (1 − 4x) (p−1)/2 = ∑p−1 n=0 (2n n )x n in Fp. “Integrating,” we can get a nice expression for the Catalan generating function as well. 73. Show that ∑p−1 k=1 (2k k ) 1 k ≡ 0 (mod p) for p > 3 prime. Solution. Converting to mod p 2 in the standard way, we just need to show that ∑p−1 k=1(−1)k(p k)(2k k ) ≡ 0 (mod p 2). Observe that (2p−k p ) ≡ 1 (mod p) for k ∈ (0, p). So it’s enough to show that n∑ k=0 (−1) k(n k )(2n − k n )(2k k ) = 0 whenever 3 ∤ n. relevant paper 74. Let a, b, c be positive real numbers such that 3 + 1/a + 1/b + 1/c ≤ 2(a + b + c). Prove that∑ cyc 1/ √a + b3 + c5 ≤ 3/√a + b + c. Solution. The denominators are ugly, and stuﬀ is in the wrong direction for Holder/Cauchy in the usual way, so we just kill the denominators. This is easy: (a + b3 + c5)(a + 1 + 1/c)(a + 1 + 1/c) ≥ (a + b + c) 3 =⇒ √ a + b + c a + b3 + c5 ≤ a + 1 + 1/c a + b + c , so we’re done by summing up. 75. For a positive integer n with prime factorization n = ∏k i=1 p αi i (where p1 < · · · < pk), deﬁne d(n) = ∏k i=1(αi + 1) and let d1 < · · · < dd(n) be the divisors of n. For a ﬁxed positive integer j < d(n), let t be the smallest integer such that ∏t i=1(αi + 1) ∤ j. Prove that dj+1/dj ≤ pt. Solution. We need an extra condition like p1 < · · · < pk, or else n = 5·2·q1 ·q2 ·· · · is a counterexample for suﬃciently large primes qi. Indeed, αi = 1 for all i, so taking j = 2, we have t = 2. But d3/d2 = 5/2 > pt = 2, contradiction. (This can be easily generalized, especially when all the αi = 1 for all i, as then we would need dj+1/dj ≤ 2 for all j by taking suitable permutations of the pi but in general 2d(n) < n.) Suppose dj+1 > djpt > dj for contradiction. Then we can prove that for any i ∈ (0, j) such that gcd(di, p1 · · · pt) = 1, dip α1 1 · · · p αt t ≤ dj. Indeed, di < dj implies there is a largest M with prime factors among p1, . . . , pt such that diM ≤ dj, and if there exists l ∈ [1, t] such that vpl (M ) < αl, diM pl ∈ (dj, djpt] by maximality and the fact that pl ≤ pt, contradicting the fact that dj+1 > djpt (since diM pl | n). On the other hand, we can divide out some powers of p1, . . . , pt from any dr < dj to get such a di, so ∏t i=1(αi + 1) | j, contradiction. 76. On some planet, there are 2 N countries, where N ≥ 4. Each country has a ﬂag N units wide and one unit high composed of N ﬁelds of size 1 × 1, each ﬁeld being either yellow or blue. No two countries have the same ﬂag. We say that a set of N ﬂags is diverse if these ﬂags can be arranged into an N × N 33 Victor Wang Interesting problem solutions, storage square so that all N ﬁelds on its main diagonal will have the same color. Determine the smallest positive integer M such that among any M distinct ﬂags, there exist N ﬂags forming a diverse set. Solution. By taking the set of guys starting with 10, we have f (n) ≥ 2n−2 + 1 for n ≥ 2. We now show that f (n) ≤ 2 n−2 + 1 for n ≥ 4. One way is induction, where the base case n = 4 can be done by analyzing the left and right halves of strings separately and combining things together (it’s slightly tedious though). For n ≥ 5, if we assume the induction hypothesis, then consider a set S of 2n−2+1 n-ﬂags. Now take a non-monochrome column, say the ﬁrst, and say there are at least 2n−3 +1 1s in this column by pigeonhole. Now removing the ﬁrst column the rest follows easily by induction (since we chose a non-monochrome column, we have both 0s and 1s left to satisfy the top left corner). A cleaner, more insightful way is via Hall. We can construct two bipartite graphs G0, G1 in the obvious ways, letting F denote the set of ﬂags and C the set of columns, drawing an edge between f and c if f has a 0 in column c for G0 and similar for G1. Suppose a set D = {c1, . . . , ck} of columns fails the hall condition in G0: then F \\N (S) has all 1s in columns c1 through ck, so 2n−2 +1 = |F | ≤ |N (S)|+2 n−k ≤ k − 1 + 2 n−k, so k − 2 ≥ 2 k−2 − 1 (since n ≥ k), which means k ≤ 3. But if k = 3, then n ≥ 4 screws things up, so k ≤ 2. The case k = 1 corresponds to |N (S)| = 0, i.e. a monochrome column of 1s. On the other hand, the case k = 2 corresponds to |N (S)| = 1 and 2n−2 = |F \\ N (S)| (since equality must hold), in which case F \\ N (S) contains every ﬂag starting with 11 and since 2n−2 ≥ n (since n ≥ 4), we can take the n − 2 ﬂags 1110 . . ., 11110 . . ., 111110 . . ., etc. in addition to any two remaining ﬂags starting with 11. So we only need to consider the case k = 1: since there’s at most one monochrome column, we’re done. (The oﬃcial solution doesn’t do this explicitly, instead just taking a failing set of columns from each of the graphs and getting a contradiction.) 77. Given 2n + 1 points, no four concyclic and no three collinear, show that exactly n2 distinct circles pass through three of them and contain n − 1 points inside and n − 1 outside. Solution. The most natural way is smoothing and induction. Say we have P1, . . . , P2n+1 and we want to show that moving P1 to Q1 doesn’t change the number of halving circles. It’s enough to prove this when P1Q1 is a line crossing only one boundary determined by P2, . . . , P2n+1 (circumcircles through any three and lines through any two), because the only way the number of halving circles can change is if P1 changes position relative to some (PiPjPk) (with i, j, k ̸= 1) or some Pi changes position relative to (P1PjPk), (Q1PjPk) (j, k ̸= 1), and this can only happen if P1Q1 (the segment) intersects the boundary of some (PiPjPk) or some line PjPk (the latter only in the second case). Now it’s easy to see that only crossing a line PiPk does nothing except swap outside and inside points of (P1PiPk) and (Q1PiPk) (which preserves halving property), so we just have to deal with the case when we cross WLOG arc PiPk not containing Pj of (PiPjPk), and further WLOG P1 moves out (as long as we show P1 and Q1 are “exchangeable” we can reverse if necessary). By the minimality assumption (that we only cross one boundary), P1PiPkPj is convex, so it is easy to then show (using minimality more) that (P1PiPk), (PjPiPk) are of type (a, b) and change to type (a − 1, b + 1) (we lose Pj) and (P1PjPi), (P1PjPk) are of type (a − 1, b + 1) and change to type (a, b) (we gain Pk, Pi respectively), where (u, v) means u on inside and v on outside. So it’s enough to construct one example (and we can also exploit inductive hypothesis). So we want to use symmetry, starting with an approximately regular (2n − 1)-gon and letting another point O be its center (which is contained in all circumcircles from the regular polygon). Now the simplest way to ﬁnish is if we can add a point T such that the remaining 2n − 1 halving circles are of the form (T PiO) for 1 ≤ i ≤ 2n − 1. This is easy if we let T be a point outside of all circles determined by the other 2n points. By construction, (T XY ) is a halving circle iﬀ XY is a halving line of the 2n points not equal to T . For the sake of completeness, I’ll mention two solutions to the generalized problem with a set S of 2n + 1 points (n ≥ 1). The ﬁrst is Federico Ardila’s smoothing argument, which someone linked to in another thread. The second (which is not as motivated, but perhaps more beautiful) is based on ideas from a paper on the connection between balancing lines and halving triangles (in particular, Theorem 2.2 from here, 34 Victor Wang Interesting problem solutions, storage which is essentially a subtler application of the invariant used in IMO 2011.2). Here we use (a special case of) the inverted form of Theorem 2.2, i.e. the fact that for a ﬁxed point P ∈ S and circle C passing through P but no other points of S, there are exactly min(m, 2n − m) ordered pairs of points (Q, R) ∈ S2 with (P QR) a separator of S, Q inside C, and R outside C, where m is the number of points in S lying inside C. Take a point O such that OP ̸= OQ for any two distinct points P, Q ∈ S, and label the points Pi (1 ≤ i ≤ 2n + 1) of S so that OP1 < · · · OP2n+1 (this may be more natural with stereographic projection, interpreting this as ”decreasing z-coordinates” instead); let Ci denote the circle centered at O passing through Pi. Then we can identify each separator (PiPjPk) (where i < j < k) with Cj, the unique circle Cl passing through one of Pi, Pj, Pk and ”separating” the other two. Furthermore, Ci contains exactly i − 1 points in its interior for every i, so by the previous paragraph, there must be exactly 2n+1∑ i=1 min(i − 1, 2n − i + 1) = n2 separators, as desired. And as noted in Ardila’s paper, we can just as easily count the total number of separators of type (a, b) or (b, a) (where there are either exactly a inside and b outside or a outside and b inside) whenever a + b = 2n − 2 (the original problem is just (n − 1, n − 1)). But the general inverted form of Theorem 2.2 still applies, except we have to sum up 2 min(i − 1, 2n − i + 1, a + 1, b + 1) instead of min(i, 2n − i), where the extra factor of 2 accounts for our inability (with this method) to distinguish between types (a, b) and (b, a) whenever a ̸= b. 78. Let z1, . . . , zn be the roots of f (x) = xn + an−1xn−1 + · · · + a0, where ai ∈ C. Show that 1 n ∑ |zk| 2 < 1 + max0≤k≤n−1 |ak| 2. Solution. Go by contradiction. Then by the classical Mahler measure bound, n∑ k=1 |zk| 2 ≥ n + |a0| 2 + · · · + |an−1|2 ≥ (n − 1) + n∏ k=1 max(1, |zk|2). If some zi ≤ 1, then subtracting 1 from both sides we can just WLOG remove it (the corresponding n − 1 inequality then still holds), so suppose zk > 1 for all k WLOG. But by induction or smoothing we can show that x1 · · · xn + n − 1 > x1 + · · · + xn whenever x1, . . . , xn > 1. 79. (Finite projective planes) Let G = P ∪ L be a bipartite graph (with |P |, |L| ≥ 2) such that |N (Pi) ∩ N (Pj)| = 1 and |N (Li) ∩ N (Lj)| = 1 for distinct i, j. Characterize all such non-regular graphs. Solution. If N (l) = P for some l ∈ L, then since |L| > 1, we see that there must exist a point p ∈ P such that N (l′) = {p} for all l′ ̸= l in L: this is one “degenerate” case. Of course, there is also the case with L, P swapped: but this is equivalent. Now suppose neither of these is the case; there is only one more degenerate case. (*) Now we show everything has degree at least 2. Since |P |, |L| > 1, everything has degree at least 1, so suppose N (l) = {p} for some l ∈ L; then p ∈ N (l′) for all l′ ̸= l in L, contradicting (*). The key idea is this: if we ﬁx L1 ∈ L with neighbors P1, . . . , Pr (r ≥ 2 by the previous paragraph), then any two of Pi, Pj with i, j ≤ r share only the neighbor L1. Thus for any p /∈ {P1, . . . , Pr}, the N (p) ∩ N (Pi) are distinct. On the other hand, every l ∈ L shares a neighbor with L1, so |N (p)| = |N (L1)|. So whenever p1 ̸= p2 are in P and |N (p1) ∪ N (p2)| < |L|, |N (p1)| = |N (p2)|. However, if |N (p1) ∪ N (p2)| = |L|, then l = N (p1) ∩ N (p2) has degree exactly 2 (as each of N (l)’s neighbors only share l as a common neighbor, and we need N (p1)∪N (p2) = L). So |N (p)| = |N (l)| = 2 whenever p ̸= p1, p2 (since then p is not adjacent to l). On the other hand, if l′ = N (p) ∩ N (p2) and deg l′ = 2, then deg p1 = 2. But if deg l′ > 2, then since l′ ̸= l we must have P = N (l′) ∪ N (l) (or else 2 < |N (l′)| = |N (l)| = 2), and by dual logic we know N (l′) ∩ N (l) = p2 must have degree exactly 2. So if such l′ doesn’t exist, we must have deg pt = 2 for all pt ∈ P in this case, whence |L| = 3. Summing up degrees, we have |P | = 3 and G isomorphic to C6. )But this is regular anyway.) 35 Victor Wang Interesting problem solutions, storage In the more interesting case where such l′ exists, then N (p1) ∪ N (p2) = L and N (l′) ∪ N (l) = P , so by our above logic we know all p ̸= p1 have degree 2 and (similarly) all li ̸= l′ have degree 2. So we essentially have p1, . . . , pr for P and l1, . . . , ls for L, where N (p1) = {l2, . . . , ls}, N (l1) = {p2, . . . , pr}. But deg pi = deg lj = 2 for i, j ̸= 1, so it’s easy to see r = s and WLOG we have N (pi) = {l1, li}, N (li) = {p1, pi} for i = 2, . . . , r. This is the other degenerate case. Otherwise, if |N (p1) ∪ N (p2)| < |L| and |N (l1) ∪ N (l2)| < |P | always, then N (p) is constant for p ∈ P and also equal to some N (lp); but N (l) must also be constant, so we conclude that G is regular and |L| = |P |. Suppose it is d-regular (d > 1); then considering N (l) for l ∈ N (p) for a ﬁxed p, we conclude that |L| = |P | = 1 + (d − 1)d. 80. Show that we can ﬁll a p 2 + p + 1 × p2 + p + 1 board with 0s and 1s such that every row and column has exactly p + 1 1s and if the centers of four unit squares form a rectangle whose edges are parallel to the edges of the board, at least one of these squares contains a 0. Solution. This is the incidence matrix of the ﬁnite projective plane of order p! We can in fact prove it has to be this up to ordering. Label the rows P1, . . . , Pn and the columns L1, . . . , Ln (n = p 2 + p + 1), where (i, j) has a 1 iﬀ Pi ∈ Lj. Then the conditions force |Li ∩ Lj| ≤ 1 for distinct i, j, so summing up and using regularity we get n(p+1 2 ) = ∑ |Li ∩ Lj| ≤ (n 2). But equality must hold, so in fact |Li ∩ Lj| = 1 for all i ̸= j. Considering the dual sets P1, . . . , Pn (abuse of notation here), we can also get |Pi ∩ Pj| = 1 for all i ̸= j, which along with regularity implies that we must have a projective plane. We base the construction on Fp. Take the points to be of the form p = (a, b, c) ∈ F 3 p, where not all a, b, c are zero and (x, y, z) is considered the same as (tx, ty, tz) for any t ̸= 0. Then considering the ﬁrst nonzero coordinate we see we have n points. On the other hand, we can just take the line corresponding to l = (a, b, c) to consist of the points (x, y, z) such that ax + by + cz = 0. Then it is easy to verify that every two lines intersect in a unique point up to scaling and every two points determine a unique line, as desired. (It is easy to see that every line contains p2−1 p−1 = p + 1 points, and every point lies on p2−1 p−1 = p + 1 lines by duality/symmetry.) 81. (AoPS) Consider the sequence deﬁned by x1 = 1 and xn+1 = 1 + n xn . Find all n such that xn is an integer. Solution. Let an = x1 · · · xn for n ≥ 0 (where a0 = 1 is the empty product) so that the recurrence becomes the more wieldy an+1 = an+nan−1 (for n ≥ 1). Rewriting the recurrence as an+1 n! = an n! + an−1 (n−1)! and letting f (x) = ∑ n≥0 an n! xn denote the exponential generating function of (an), we have f ′(x) = ∑ n≥1 an (n − 1)! xn−1 = a1 0! + ∑ n≥1 an+1 n! xn = a1 0! + ∑ n≥1 an n! xn + ∑ n≥1 an−1 (n − 1)! xn = a1 + (1 + x)f (x) − a0 = (1 + x)f (x). But f (0) = 1, so dividing both sides by f (x) and integrating we get log f (x) = x + x2/2 and f (x) = exp (x + x2 2 ) = ∑ n≥0 1 n! ( x + x2 2 )n = ∑ n≥0 1 n! n∑ k=0 (n k ) ( x2 2 )k xn−k, from which we can easily ﬁnd an = ⌊n/2⌋∑ k=0 ( n 2k )(2k)!!. (Note that we can also directly use the recurrence relation and induction to show that an is the number of ways to partition [n] into sets of size 1 or 2, by considering the size of the set n + 1 belongs to.) 36 Victor Wang Interesting problem solutions, storage For odd primes p it directly follows that anp ≡ 1 (mod p) for n ≥ 0 (for n ≥ 1, observe that the (2k)!! terms vanish modulo p for k ≥ (p + 1)/2, and (np 2k) = np 2k (np−1 2k−1) for k ≥ 1). Now suppose for contradiction that p | an0, an0+1 with n0 ≥ 0 minimal; then a0 = a1 = 1 =⇒ n0 ≥ 2. But we know p ∤ n0, so an0+1 = an0 + nan0−1 implies p | an0−1, an0, contradicting the minimality of n0. Thus an | an+1 can only occur if an is a power of 2. But it’s easy to show by induction that ℓn = min(v2(an), v2(an+1)) ≤ v2(n!) for n ≥ 1, as 2 ℓn+1 | (pn+1, pn+2) = (pn+1, (n + 1)pn) | (n + 1)(pn+1, pn) (we can also ﬁnd the exact value of v2(an) as Rust did, but this is unnecessary). So if an | an+1 for some n > 3, then 2n−1 ≥ 2 v2(n!) ≥ 2 ℓn = an = ⌊n/2⌋∑ k=0 ( n 2k )(2k)!! > ⌊n/2⌋∑ k=0 ( n 2k ) = 2 n−1, which is absurd. But a3 = 4 ∤ 10 = a4, so we see that only n = 0, 1, 2 work, corresponding to x1, x2, x3 ∈ Z in the original sequence. 82. (generatingfunctionology) Show that ∑2n k=0(−1)n−k(2n k )2 = (2n n ). Solution. We use DIE (Description, Involution, Exception). The LHS is an alternating sum of the number of ways to choose k elements of {1, . . . , 2n} and k of {2n + 1, . . . , 4n}, so consider the pairs {i, 2n + i}. If we toggle (i.e. symmetric diﬀerence operate) the ﬁrst pair with an even number of elements chosen (i.e. 0 or 2), then we have an involution with things canceling out, except when every pair has exactly 1 element chosen. In this case, we have k = n, corresponding to a leftover contribution of (−1)n−n(2n n ), so we’re done. We can also generalize the identity and use snake oil (as is, there are too many ns, making it hard to do directly). Doing (n k)(m k ) doesn’t help much, but rewriting one of the coeﬃcients as ( n n−k) and replacing the bottom n with m does: we get ∑ m,n,k≥0 (−1)k( n k )( n m − k ) xmyn = 1 1 − y(1 − x2) , from which the rest is obvious. 83. (David Yang) Find the smallest positive integer k such that for any simple directed graph G (with 2-cycles permitted, but not 1-cycles) with all out-degrees equal to 2, we can assign one of k colors to each of its vertices so that no vertex v ∈ V (G) has the same color as both of its out-neighbors. Solution. The answer is 3. First we show k = 2 doesn’t work: suppose it does (let our color sets be A, B) for G deﬁned by V (G) = Z/7Z and (u, v) ∈ E(G) iﬀ v − u ∈ {1, 3}. As 7 is odd, there exist two neighboring residues of the same color, say C(0) = C(1) = A. Then (0, 1), (0, 3) ∈ E(G) =⇒ C(3) = B. If C(2) = A, then (1, 2), (1, 4) =⇒ C(4) = B, so (3, 4), (3, 6) =⇒ C(6) = A, whence (6, 0), (6, 2) ∈ E(A), contradiction. Thus C(2) = B, so C(2) = C(3) = B =⇒ C(5) = A. Now (4, 5), (4, 0) =⇒ C(4) = B, and (5, 6), (5, 1) =⇒ C(6) = B. But then C(3) = C(4) = C(6) = B, contradicting (3, 4), (3, 6). Now we show k = 3 works, by inducting on the obvious generalization to deg+(v) ≤ 2 always, with the base case vacuously true. First suppose there exists v ∈ G with deg−(v) ≤ 1, and ﬁnd a good 3-coloring in A, B, C for G \\ {v}. Suppose for contradiction that we cannot place v in any subset without violating the conditions. But we only violate a ﬁxed S if u, w ∈ S and (u, v), (u, w) ∈ E(G) or if N (v) ⊆ S, contradicting (by pigeonhole) the fact that deg−(v) ≤ 1 implies there’s at most one violation of the ﬁrst type and (obviously) at most one of the second type. The only case remaining is deg−(v) ≥ 2 for all v: but summing up and using deg+(v) ≤ 2 always, we get that in fact deg+(v) = deg−(v) = 2 for all v ∈ V (G). So take a partition A ∪ B ∪ C maximizing 37 Victor Wang Interesting problem solutions, storage the number of edges between vertices of distinct subsets (i.e. total between A, B, B, C, C, A), and suppose for contradiction that there exist u, v, w ∈ A with (u, v), (u, w) ∈ E(G). As deg−(u) = 2, we can WLOG |N −(u) ∩ B| ≤ 1. Then moving u to B gives a net contribution of at least +2 − 1 > 0, contradiction. 84. (China 2010) Given a positive integer n, ﬁnd the largest real number λ = λ(n) such that for any degree n polynomial with complex coeﬃcients f (x) = anxn + an−1xn−1 + · · · + a0 and any permutation x0, x1, . . . , xn of 0, 1, . . . , n, the following inequality holds: ∑n k=0 |f (xk) − f (xk+1)| ≥ λ|an|, where xn+1 = x0. Solution. I think the answer is λ(n) = n! 2n−2 . Let f (k) = tk for k = 0, 1, . . . , n so matching leading coeﬃcients from Lagrange interpolation (note that deg f < n + 1) we have f (x) = n∑ k=0 tk ∏ j̸=k x − j k − j =⇒ an = n∑ k=0 tk(−1)n−k k!(n − k)! . (Clearly deg f = n iﬀ an ̸= 0.) This gives us our equality case easily: letting tk = (−1)k and (x0, . . . , xn) = (0, 2, . . . , 2⌊n/2⌋, 1, 3, . . . , 2⌊(n − 1)/2⌋ + 1), we have ∑n k=0 |f (xk) − f (xk+1)| |an| = ∑n k=0 |txk − txk+1| | ∑n k=0 tk(−1)n−k k!(n−k)! | = 2|1 − (−1)|n! 2n = n! 2n−2 , where we note that an = ±2 n ̸= 0. So it remains to show that n∑ k=0 2 n−2|txk − txk+1| ≥ \f \f \f \f \f n∑ k=0 tk(−1) k(n k )\f \f \f \f \f always holds. By the triangle inequality, it suﬃces to show that there exist reals α0, . . . , αn such that |αk| ≤ 2 n−2 and αk − αk−1 = (−1)xk ( n xk) for all k. Indeed, we would then have n∑ k=0 txk (−1)xk ( n xk ) = n∑ k=0 txk (αk − αk−1) = n∑ k=0 αk(txk − txk+1). But this is easy: let m = min0≤k≤n ∑k i=1(−1)xi( n xi) and M = max0≤k≤n ∑k i=1(−1)xi( n xi), and observe that 0 ≤ M − m ≤ 2 n−1. So taking αk = −m − M 2 + k∑ i=1(−1)xi( n xi ) for all k, we get αk − αk−1 = (−1)xk ( n xk) and −2n−2 ≤ m − M 2 ≤ −m − M 2 + m ≤ αk ≤ −m − M 2 + M = M − m 2 ≤ 2 n−2, as desired. 85. (MOP 2008) Let F be a collection of 2n−1 subsets A1, A2, . . . of {1, 2, . . . , n} such that any three subsets have nonempty intersection. Prove that there is a common element x contained in every Ai. Solution. As there are 2 n−1 subsets, we must have exactly one of each complementary pair of sets. If {i} ∈ F for some i, then we’re done, so suppose otherwise. Then [n] \\ {1}, . . . ∈ F. But {i, j} ∩ [n] \\ {i} ∩ [n] \\ {j} = ∅, so [n] \\ {i, j} ∈ F always. Continuing, we have {i, j, k} ∩ [n] \\ {i, j} ∩ [n] \\ {k} = ∅, so [n] \\ {i, j, k} ∈ F but {i, j, k} /∈ F, etc. so by induction {1, 2, . . . , n − 1} /∈ F, contradiction. 38 Victor Wang Interesting problem solutions, storage 86. (MOP 2011, Ricky Liu) Let k be a positive integer, and divide the region R between the parallel lines x = 0 and x = 2k in the Cartesian plane into 2k stripes of equal width, alternately colored white and black. Consider a convex polygon P lying completely inside R with at least one vertex on each of the lines x = 0, x = 2k. Prove that at least 2k−1 4k of P ’s interior must be black. Solution. We prove a slight generalization by induction: for every positive integer m ≥ 0, if we divide the region R between the parallel lines x = 0 and x = m into m strips of equal width and the ﬁrst strip is black, then at least m−1 2m of P ’s interior is white. Lemma. For m ≥ 2, any triangle with its vertices on x = 0, x = m − 1, and x = m is half white and half black. Proof. Induction, where we note that by symmetry we can generalize this statement to when the region between x = 0 and x = 1 is white as well. For m = 2 this is obvious. Suppose A, B, C are the vertices from left to right, and let AC intersect x = 1 at T . Then split into AT B and BT C.■ For m = 1 this is obvious, so suppose m > 1 and assume the result for m − 1. Suppose the boundary of P intersects the lines x = i for i = 0, 1, . . . , m such that the upper half of intersection points forms a convex polygon Q0Q1 . . . Qm and the lower half forms R0R1 . . . Rm (where Qi, Ri lie on x = i). Then it’s not hard to show that the polygon P ′ formed by the sides R0Q0, Q1Q2, Q3Q4, . . . , Q2⌊m/2⌋−1Q2⌊m/2⌋, QmRm, R2⌊m/2⌋R2⌊m/2⌋−1, . . . , R4R3, R2R1 is convex, has black area at most that of P , and white area at least that of P (e.g. by deﬁnition of Q2i−1, Q2i, every point of P lies above Q2i−1Q2i between x = 2i − 1 and x = 2i or below Q2i−1Q2i, proving the relevant area increases and decreases; we have convexity since R0Q0Q1 . . . QmRm . . . R1 is convex, and we are just “extending” every other side to form P ′). So it’s enough to prove the claim for polygons of the form P ′ with extreme vertices (i.e. actual ones not on edges) on x = 0, x = m, or in between x = 2i − 1 and x = 2i for some i. Suppose such P ′ intersects the lines x = i at Ai and Bi with y(Ai) ≥ y(Bi) (for i ∈ {0, m}, we might have Ai = Bi). Then it’s enough to show that the regions A0AmBmB0, the part of P ′ above A0Am, and the part of P ′ below B0Bm are each at least m−1 2m white. Now observe that no vertex T of P ′ lies above Bm−1Bm in the region between x = m − 1 and x = m: if it’s colored white, then this true by construction (i.e. the smoothing), and if it’s colored black, then the intersection of Bm−1T and x = m is a vertex of P ′ by construction, contradicting the fact that T is above Bm−1Bm. By convexity, the part of P ′ above A0Am is thus bounded by the lines A0Am, x = 0, and Am−1Am, so by the inductive hypothesis (consider the part of P ′ above A0Am−1 bounded by x = 0 and x = m − 1) we have a white density of at least m − 1 m (m − 1) − 1 2(m − 1) + 1 m 1 2 = m − 1 2m , where we use the lemma to deal with △A0Am−1Am. By symmetry, this also works for the part below Bm−1Bm. We can just compute A0AmBmB0’s density directly: if m is odd, we get [(a + d) + (a + 2d)] + · · · + [(a + (m − 2)d) + (a + (m − 1)d)] m(a + (a + md)) = m − 1 2m by a symmetry argument, and if m is even we get [(a + d) + (a + 2d)] + · · · + [(a + (m − 1)d) + (a + md)] m(a + (a + md)) = 1 + d 2a+md 2 ≥ m − 1 2m , where we use the fact that a, a + md ≥ 0. Equality cases are isosceles trapezoid for m odd and isosceles triangle for m even. 87. (WOOT 2013) Given that f (x, y) is a polynomial in x for any ﬁxed real number y, and f (x, y) is a polynomial in y for each ﬁxed real number x, must f (x, y) be a polynomial in x and y? Solution. If we restrict ourselves to real inputs, then yes (otherwise f (x, y) = [x ∈ C] is an obvious counterexample). 39 Victor Wang Interesting problem solutions, storage By the problem conditions there exist functions gn(y) and hm(x) such that f (x, y) = ∑ n≥0 (x n )gn(y) = ∑ m≥0 ( y m ) hm(x), where for ﬁxed (real) y we have gn(y) = 0 for all n > N (y) (where N (y) = degx f (x, y)) and for ﬁxed (real) x we have hm(x) = 0 for all m > M (x) (where M (x) = degy f (x, y)). But if we ﬁx y to be a nonnegative integer u, then N (u)∑ n=0 (x n )gn(u) = u∑ m=0 ( u m )hm(x) for all (real) x, whence hu(x) is a polynomial in x for all u ≥ 0 by induction. (Similarly, we can show gv(y) is a polynomial in y for all v ≥ 0, but this is unnecessary.) Finally, because the reals are uncountable, there exists a nonnegative integer M such that M (x) = M for inﬁnitely many (real) x, whence for every m > M (x), the polynomial hm(x) has inﬁnitely many zeros and is thus identically zero, so we’re done. 88. (WOOT Practice Olympiad) Let P be a convex polygon with n vertices, such that no four vertices are concyclic. If A, B, and C are three vertices of P such that the remaining n − 3 vertices of P lie in the interior of the circumcircle of triangle ABC, then triangle ABC is said to be a covering triangle of polygon P. Show that P has exactly n − 2 covering triangles. Solution. The idea is just to characterize covering triangles ABC: if X is opposite BC of A, then ∠BY C + ∠BXC > 180◦ for any Y on the same side of BC as A, so we can call all such segments BC major. This condition holds vacuously for sides of P, and we see that every covering triangle consists of major segments (and any triangle with major segments is covering). It’s easy to see no two major segments intersect (except possibly at endpoints). Furthermore, every major side belongs to exactly one covering triangle and every major diagonal belongs to exactly two covering triangles, so pushing these facts forward we see that the major segments form a triangulation of P. More generally, there are fn(k) = (k + 1)((n − 3 − k) + 1) triangles covering all but k points: induct with the double-counting relation (n + 1)fn(k) = ((n + 1 − 3) − k)fn+1(k) + (k + 1)fn+1(k + 1). 89. (RMM 2011) The cells of a square 2011 × 2011 array are labelled with the integers 1, 2, . . . , 2011 2, in such a way that every label is used exactly once. We then identify the left-hand and right-hand edges, and then the top and bottom, in the normal way to form a torus (the surface of a doughnut). Determine the largest positive integer M such that, no matter which labelling we choose, there exist two neighbouring cells with the diﬀerence of their labels at least M . (Cells with coordinates (x, y) and (x′, y′) are considered to be neighbours if x = x′ and y − y′ ≡ ±1 (mod 2011), or if y = y′ and x − x′ ≡ ±1 (mod 2011).) Solution. After trying small cases we conjecture an answer of 2N − 1 for N ≥ 3 (for N = 2 everything only has two instead of four neighbors). Inspired by the classical problem where the board doesn’t wrap around, we try to ﬁnd k such that when 1 through k are ﬁlled in, there are at least 2N − 1 “border” squares (ﬁlled squares that are next to an unﬁlled square). (In a sense, a suitable isoperimetric inequality.) The most obvious thing (which works for the classical version) to try is to go up to the smallest k for which every row and column has at least one ﬁlled square, or its dual (the ﬁrst time some row or column is completely ﬁlled). This doesn’t work for the new toroidal version, though, because we might only be able to get one “border” square if, in the ﬁrst method, we last ﬁlled a row and end up with a column with only one ﬁlled square. Instead, we go until all rows have at least 2 ﬁlled in or all columns have at least 2. (Actually, this works for the original too, if we wait for 1 instead of 2.) If this happens for rows, then at most one row 40 Victor Wang Interesting problem solutions, storage is completely ﬁlled in (or else either the rows or columns would’ve been satisﬁed before, depending on whether k is in or out of one of the complete rows). Now we can easily ﬁnish: the potential ﬁlled row will get at least 1 and the others at least 2 “border” squares—note that the “boundary” that exists in the classical version would’ve prevented this from working there. For the construction just do a spiral after experimenting small cases. 90. (Engel NT, also http://oeis.org/A121319) Prove that 2n has decimal representation ending in n in- ﬁnitely often. Solution. 2 36 ≡ 736 (mod 10 3). Now it’s enough to show that if 10k < n < 10k+1 (k ≥ 1) and 2 n ≡ 10k+1d + n (mod 10k+2) for some d ∈ [0, 9], then 2 10 k+1d+n ≡ 10k+1d + n (mod 10k+2). By CRT, there are two obvious things: (1) ϕ(5k+2) = 4·5k+1 | 10 k+1d, so 210 k+1d+n ≡ 2n (mod 10k+2); and (2) 2 n > 10k+1 > 2k+1 =⇒ n ≥ k + 2, so 2 10 k+1d+n ≡ 2n ≡ 0 (mod 2 k+2). But we also need to make sure the “lifting” gives us an inﬁnite sequence since d = 0 could mess things up. So we actually want to write 2 n − n = 10 k+1+ℓ(d + 10m) where ℓ ≥ 0 and d is a nonzero digit. Let n′ = 10 k+1+ℓd + n; then 2n ≡ n′ (mod 10k+2+ℓ), so as above we just need to verify that 2 k+2+ℓ and 5 k+2+ℓ both divide 2 n(210 k+1+ℓd − 1), which just follows from 2n > 10k+1+ℓ and ϕ(5k+2+ℓ) = 4 · 5 k+1+ℓ. Actually, if we increase k by 1 even if d = 0, we don’t need the second case. 91. (IMO 2007) Consider ﬁve points A, B, C, D, and E such that ABCD is a parallelogram and BCED is a cyclic quadrilateral. Let ℓ be a line passing through A. Suppose that ℓ intersects the interior of the segment DC at F and intersects line BC at G. Suppose also that EF = EG = EC. Prove that ℓ is the bisector of angle DAB. Solution. This is equivalent to CF = CG, AB = BG, and ﬁnally AD = DF . Either angle chasing to get ∠BDE = ∠ECG and ∠DBE = ∠DCE, or noting that AD = BC means it’s basically equivalent (by acute/obtuseness) for spiral similarity, we need to show ED = EB, our most natural condition yet. One way to ﬁnish is to use the E-Simson line of △BCD. Alternatively, phantom point the spiral center taking DF C to BCG. We can also use complex numbers centered at unit circle (CF G). The converse is also true, if we set the phantom point E′ the midpoint of arc BCD. 92. Form a m × n screen with unit screens. Initially, there are at least (m − 1)(n − 1) + 1 unit screens turned on. In any 2 × 2 screen, as soon as there are 3 unit screens that are turned oﬀ, the 4th screen turns oﬀ automatically. Prove that the whole screen can never be totally oﬀ. Solution. Perimeter invariant isn’t enough. But analyzing some small cases it’s easy to come up with the following invariant: if we construct the bipartite graph R ∪ C with an edge iﬀ (r, c) is oﬀ, then the set of connected components remains the same. If it’s completely oﬀ eventually we need the whole graph to be connected, which is impossible unless there are at least m + n − 1 edges in the original. 93. Let S(f ) be the set of roots (without multiplicity) of a polynomial f ∈ C[x]. Are there two distinct polynomials P, Q ∈ C[x] such that S(P ) = S(Q) and S(P + 1) = S(Q + 1). Solution. No. Go by contradiction and suppose for disjoint sets of roots a1, . . . , am and b1, . . . , bn, 1 = [P (x) + 1] − P (x) = c(x − a1) r1 · · · (x − am)rm − c(x − b1) s1 · · · (x − bn) sn and 1 = [Q(x) + 1] − Q(x) = d(x − a1) t1 · · · (x − am) tm − d(x − b1) u1 · · · (x − bn) un . By diﬀerentiating, we get 2 deg(P ) − m − n = (r1 − 1) + · · · + (rm − 1) + (s1 − 1) + · · · + (sn − 1) ≤ deg(P ) − 1, 41 Victor Wang Interesting problem solutions, storage whence deg(P ) ≤ m + n − 1 and similarly, deg Q ≤ m + n − 1. Then we have (x − b1) · · · (x − bn) | c(x − a1)r1−1 · · · (x − am) rm−1 − d(x − a1) t1−1 · · · (x − am)tm−1 ̸= 0, so n ≤ max(deg P − m, deg Q − m) ≤ n − 1, contradiction. Equivalent wording by Alex Zhu: Let S and T be the sets of roots of P and P + 1, respectively, and let deg P = n ≥ deg Q. Then P ′ has at least n − |S| roots from S and at least n − |T | from T , so n − |S| + n − |T | ≤ deg P ′, so |S| + |T | ≤ n − 1. On the other hand, all elements of S and T are also roots of P − Q = (P + 1) − (Q + 1), so |S| + |T | ≥ n, contradiction. 94. For a function f : R → R, not necessarily continuous, we say f is periodic if there exists a nonzero real number t such that f (x) = f (x + t) for all reals x. Let P be a polynomial of degree n with real coeﬃcients. Show that P cannot be written as the sum of n periodic functions. Solution. Induction and ﬁnite diﬀerences. 95. 3-D proofs for Brianchon and Pascal. Solution. This proof only works for non-degenerate cases (for Brianchon, ABCDEF all distinct points on opposite sides; for Pascal, no two opposite sides parallel) ABCDEF circumscribes the circle with tangency points P QRST U (P on AB, Q on BC, etc.) lift stuﬀ alternately by constant angles so that A′ is above, B′ is below B, etc. so that A′B′D′E′ is a plane, etc. now we get three planes of the form A′B′D′E′, B′C ′E′F ′, etc. that are not the same, but have pairwise intersections exactly equal to lines A′D′, B′E′, C ′F ′, which means that the three planes must intersect in a point, which must lie on all three lines; now project everything onto the plane of ABCDEF to get a proof of brianchon for pascal, note that P Q, A1B1, B1C1 are coplanar, so P Q and ST intersect at a point on the line equal to the intersection of planes A′B′C ′ and D′E′F ′, which also contains A′B′ ∩ D′E′ and B′C ′ ∩ E′F ′ if L = A′B′ ∩ D′E′, M = B′C ′ ∩ E′F ′, N = C ′D′ ∩ F ′A′, then the plane LM N (possibly degenerate, but then the result’s obvious) intersects plane ABCDEF at a line containing P Q ∩ ST , QR ∩ T U , RS ∩ U P , so we’re done 96. No 4 × n closed knight’s tour for n ≥ 1. Solution. The intuition is that we have to use the middle two rows to transport most of the time, yet the boundary rows have the same number of squares as the middle two. If we color rows 1 and 4 A and rows 2 and 3 B, then each A must be followed by a B in a knight’s tour, whence the tour must take the form (AB) 2n (indeed, we require a B after each of 2n occurences of A, so there can’t be any others stuck in between two consecutive AB’s). But then the standard chessboard coloring yields a contradiction. 97. Let a1, a2, . . . , an be positive rational numbers and let k1, k2, . . . , kn be integers greater than 1. If∑n i=1 ki √ai ∈ Q, show that ki √ai ∈ Q for all i. Solution. Let S = ∑n i=1 a1/ki i and go by contradiction. For motivation we look at the n = 2 case. WLOG k1, k2 are “minimal” in the sense that a j/ki i /∈ Q for j = 1, 2, . . . , ki − 1. Then our assumption is equivalent to ki > 1 for all i. Note that xk1 − a1 is the minimal polynomial of a1/k1 1 over the rationals, so xk1 − a1 | (S − x) k2 − a2. But then k2 ≥ k1; by symmetry k1 ≤ k2 and we can easily get a contradiction by considering the [xk1−1] coeﬃcients. In a similar vein, xk1 − a1 | ∏ ωki i =1,2≤i≤n(S − x − n∑ i=1 ωia1/ki i ) ∈ Q[x], 42 Victor Wang Interesting problem solutions, storage so for some choice of kith roots of unity ωi and (any) nontrivial k1th root of unity ω1, we have S = ω1a 1/k1 1 + ∑n i=2 ωia 1/ki i . But then 0 = ℜ(S − S) = ℜ(a 1/k1 1 (1 − ω1)) + n∑ i=2 ℜ((1 − ωi)a 1/ki i ) > n∑ i=2 ℜ((1 − ωi)a 1/ki i ) ≥ 0, contradiction. (We can also take magnitudes and use the triangle inequality: for equality, the ωi must be in the same positive direction since the ai are all positive, but then S would be in Rω1 ∩ R = ∅.) Comment. By induction we can show ∑n i=1 ±√ai ∈ Q iﬀ √ai ∈ Q for all i, but this doesn’t work as well when ki > 2. 98. (Russia 1998) Each square of a 2n − 1 × 2 n − 1 square board contains either +1 or −1. Such an arrangement is deemed successful if each number is the product of its neighbors. Find the number of successful arrangements. Solution. For n = 1 there are two; we restrict our attention to n ≥ 2. Let N = 2 n − 1. Take the log−1 of each entry so we’re working in F2 instead; we’re choosing some of the N 2 entires to be 1. Viewing this as the equation ai,j = ai−1,j + ai+1,j + ai,j−1 + ai,j+1 (where boundary cases are 0 for convenience), we can set up a matrix equation Av = 0 where Ai,j = 1 iﬀ entries i and j (there are (N )2 total) are neighboring, and v ∈ F N 2 2 has a 1 for each entry i we include in the successful arrangement. We show by induction on n ≥ 1 that det A = 1 (whence v must be the all-zero vector and there’s exactly one solution)—note that for n = 1 the matrix equation doesn’t actually correspond to the original problem, but this is not an issue. To do this, observe that det A = ∑ π A1,π(1) · · · AN 2,π(N 2) (as we’re working F2). Now for a ﬁxed permutation π that contributes 1 to the sum (i.e. doesn’t vanish), draw an arrow from i to π(i) for each i; we get a partition of the original N × N board into disjoint directed cycles of size 1 or 2k for some k ≥ 1 (arrows connect neighboring elements—these directed cycles correspond to permutation cycles). These cycles are nontrivially “reversible” iﬀ k ≥ 2, so pairing up the permutations with their reversals (this corresponds to π−1), we’re left (mod 2, of course) with the number of tilings of the N × N grid using 1 × 2, 2 × 1, and 1 × 1 tiles. Reﬂecting over the horizontal axis we’re left with horizontally symmetric tilings; now reﬂecting over the vertical axis we’re left with tilings that are both horizontally and vertically symmetric. For odd N it’s easy to check that xN ≡ x N −1 2 F 2 1+ N −1 2 where F0 = 0, F1 = 1, Fm = Fm−1 + Fm−2 is Fibonacci, as all dominoes intersecting one of two axes must lie within the axes (by symmetry). By induction we get det A = xN = 1. Comment. We can use this kind of symmetry argument directly on the original problem (e.g. consider the product of a successful arrangement with its vertical reﬂection, which results in another successful arrangement), which is slightly weaker but still works for the particular problem (we don’t immediately get 3 | N + 1 =⇒ xN ≡ 0 (mod 2)), but the linear algebra setting is perhaps more motivated. It may be possible to do nontrivial general analysis on m × n boards using the same recursive linear algebra ideas, but when both of m, n are even it seems hard to reduce the problem. 99. (Putnam 2011 A2) Induct and notice the general form of the numerator is something like 1 2 ( ∏(xi +2)−∏ xi)/ ∏ (xi + 2) (when expanded). Alternatively, divide the recursion bn = anbn−1 − 2 by a1 · · · an; this is not as versatile a stragey though. Maybe guess the answer is the same regardless of xi, as it would likely be ugly otherwise (especially with only the “bounded” restraint a nice closed form’s unlikely). 100. (Putnam 2011 A3) Find a real number c and a positive number L for which lim r→∞ rc ∫ π/2 0 xr sin x dx ∫ π/2 0 xr cos x dx = L. Solution. If this were discrete then obviously we would focus on the largest exponential/base power in each sum. 43 Victor Wang Interesting problem solutions, storage It turns out the same intuition works here (consider, for instance, multiplying the integral by (2/π)r): we focus on the sin integral since xr and sin are both increasing. Integration by parts deals with the cos part. So the estimation 2 π x ≤ sin x ≤ 1 on [0, π/2] suﬃces. We could also use 1 − (π/2−x) 2 2 ≤ sin x ≤ 1 and beta function: ∫ π 2 0 xr ( π 2 − x)2 dx = 2 (r+1)(r+2)(r+3) ( π 2 )r+3. The point is to deal with the small error terms in a simple way as the details don’t matter so much. Note. (mavropnevma) In some circles, it is common knowledge that for an elementary function f , one has limr→∞ ∫ 1 0 xrf (x) dx = 0, and limr→∞ r ∫ 1 0 xrf (x) dx = f (1); typically this is done by breaking the interval [0, 1] into [0, 1 − δ] and [1 − δ, 1], with δ as close to 0 as needed. 101. (Russia 2010) Let G be a connected graph disconnected by the removal of (all of the edges of) any odd cycle. Prove that G is 4-partite. Solution. Since we need to ﬁnd a 4-(vertex)-coloring, the following lemma will help: Lemma. Let m, n ≥ 2 be two positive integers. A graph G(V, E) is mn-colorable iﬀ there exists an edge partition E = E1 ∪ E2 such that G1 = G(V, E1) and G2 = G(V, E2) are m- and n-colorable, respectively. Proof. Just use product coloring for the “if” direction: we can assign the color (c1, c2) to a vertex colored c1, c2 in G1, G2, respectively. Conversely, if G is mn-colorable, then split the graph into m sets A1, . . . , Am, each containing the vertices of exactly n colors; we can then take G1, G2 deﬁned by E1 = {xy ∈ E : x ∈ Ai, y ∈ Aj, i ̸= j} and E2 = {xy ∈ E : x, y ∈ Ai} = E \\ E1, which are m- and n-colorable, respectively. Alternatively, label the mn colors (i, j) for i = 1, 2, . . . , m and j = 1, 2, . . . , n and deﬁne E1, E2 by the ﬁrst and second coordinates, respectively—the induced subgraphs G1, G2 are clearly m- and n-colorable, and we can then remove duplicate edges from E1, E2 until we get an edge partition. (The idea is that independent sets behave like single vertices, and Kmn can easily be split in the desired form.) ■ In view of the lemma, we try to ﬁnd an edge partition such that G1 and G2 are both bipartite. Let G1 = G(V, E1) be a maximal bipartite subgraph; then we can’t add any more edges to E1 without inducing an odd cycle. Now assume for the sake of contradiction that G2 = G(V, E2) (where E2 = E \\ E1) has an odd cycle C = v1v2 . . . vℓv1, ℓ ≥ 3. By the maximality of G1, vi and vi+1 (indices modulo ℓ) are connected by a (simple) path of even length in G1 (i.e. with edges in E1) for all i, so in particular vi, vj are connected in G ′ = G(V, E \\ E(C)) for all i ̸= j. Then since G is connected, every vertex v /∈ C is connected in G′ to at least one vertex of C, whence G ′ must be connected as well, contradicting the problem hypothesis. Hence G2 must be bipartite and since G1 is bipartite by construction, we’re done by the lemma. Comment. In fact, we could’ve taken G1 to be a maximal forest (any spanning tree) instead of a maximal bipartite graph. 102. (USAMTS 2012 Year 24) Let P, Q ∈ R[x] be two polynomials of degree greater than 1 such that P (Q(x)) = P (P (x)) + P (x). Prove that P (−x) = P (x) + x. Solution. Let P (x) = ∑ akxk and Q(x) = ∑ bkxk, and expanding out (comparing coeﬃcients), note that deg P (x)n − Q(x) n ≤ n(n − 1). But using ω = e2πi/n factorization the rest is clear. 103. (consistency of Thurston’s height function) A domino tiling of a simple lattice polygon with all sides parallel to the x- and y-axes can be split into two smaller simply connected tilings. Solution. Consider a domino D sharing a side with the boundary/perimeter of the polygon P . If we treat the dominos as vertices of a graph adjacent iﬀ they share a side (not just a corner), then removing D divides the polygon into at most 3 connected components (a fairly clean way to conceptualize this is by tracing the boundary of P and looking at its intersections with D—there are at most 3 disjoint intersections since the path repeats no points or sides). If there’s 1 then we can remove D and we’re ﬁne. If there’s at least two we can remove one of them to get a simply connected tiling. Why do we need to take a domino sharing a side with P ? This guarantees that the regions left when D is removed are simple. (Again, a good way to rigorize this is by visualizing the boundary of P .) 44 Victor Wang Interesting problem solutions, storage 104. Let a, b, c, d be positive reals such that a + b + c + d = 4. Show that 4 abcd ≥ ∑ a b . Solution. Rearrangement. Equality occurs when all are equal, or if we allow zeros and multiply both sides by abcd, also cyclic permutations of (0, 1, 1, 2). 105. (Putnam 1999) Let S be a ﬁnite set of positive integers greater than 1 such that for any positive integer n, there exists some s ∈ S such that either s | n or s ⊥ n. Prove that there exist two elements of S (possibly the same) whose greatest common divisor is prime. Solution. A helpful observation is that we only need to work with squarefree n in the condition. So to start we note that if there’s a prime in S then we’re done, and there must exist s ∈ S dividing rad S. Thus there exists a maximal squarefree n such that s ∤ n for all s ∈ S (and n > 1). Then we must be able to ﬁnd t ∈ S such that t ⊥ n, so if we take a prime p | t then by the maximality of n, there exists u ∈ S dividing np (note that p ∤ n, so pn is squarefree). But if p ⊥ u, then u | n, contradicting the deﬁnition of n, so p | u forces gcd(t, u) = p(t/p, u/p). Yet (t/p, u/p) | (t, n) = 1, so gcd(t, u) = p and we’re done. Alternatively, we can look at this from the “dual” perspective (this may not be accurate strictly speak- ing, but intuitively we have a minimal “cover” of S here and a maximal “anti-cover” of S previously). Indeed, if we take the smallest n such that gcd(s, n) > 1 for all s ∈ S (note rad(S) works, so a minimal element exists), then there exists t ∈ S such that t | n. If p | n (clearly n is squarefree), then there exists u ∈ S such that u ⊥ n/p; yet (u, n) > 1 by deﬁnition, so p | u and gcd(t, u) = p. Comment. Observe that p | t (by construction) in the ﬁrst method while p | u (by deduction) in the second. In any case, the concept of minimality/maximality is key. 106. (2012 Winter OMO Problem 50) SABC tetrahedron Solution. Let r = 35, I, ω, u, O, and Ω be the inradius, incenter (given), insphere, circumradius, circumcenter, and circumsphere of SABC, respectively. Let s = SI = 125; Q be the reﬂection of S over O; F be the foot from S to plane ABC; h = SF be the length of the S-altitude; IA, IB, IC be the feet from I to SBC, SCA, SAB, respectively; OA, OB, OC, OS be the circumcenters of triangles SAB, SBC, SCA, ABC, respectively; and a = 108 be the common circumradius of triangles SAB, SBC, SCA. For convenience, deﬁne v = SIA = SIB = SIC = √ s2 − r2 = 120. First, we note that OO2 A = OO2 B = OO2 C = u 2 − a 2 by the Pythagorean theorem, so O is equidistant from the three planes SAB, SBC, SCA. Taking the cross section formed by △OOBOC, we see that O lies on one of the two planes bisecting the angle formed by planes SAB and SAC: either the interior one or the exterior one (these correspond naturally to the two-dimensional interior and exterior angle bisectors). Now assume for the sake of contradiction that O lies on the exterior bisector (which is perpendicular to the interior one), and WLOG suppose plane SAB separates O and C. Since O is the center of Ω = (SABC), we then have a = RSAC < RSAB = a, a contradiction. Thus O must lie on the interior angle bisector PA of ∠(SAB, SAC). If we similarly deﬁne PB, PC, then S, O, I ∈ PA ∩ PB ∩ PC (as I lies completely inside P ABC). But the intersection of three distinct planes can only form a point, a line, or the empty set, so S, O, I must be collinear. Let ϵ equal +1 if O, S are on the same side of plane ABC and −1 otherwise. Clearly O cannot be higher than S (relative to plane ABC), since the line SI = SO intersects the interior of △ABC. In particular, S and Q must lie on opposite sides of ABC. (*) Using similar triangles and the Pythagorean theorem, we get h − ϵOOS h − r = SO SI = SOA SIA =⇒ h − ϵ√u2 − R2 h − r = u s = a v . (1) It immediately follows that u = as/v = 225/2. We will now compute h using inversion (this is natural because several circles and spheres in our diagram pass through S, and when we invert about X, the circumcenter of △XY Z is simply mapped to the reﬂection of X over Y ′Z ′). Invert about S with radius α, and let JA, JB, JC be the midpoints of 45 Victor Wang Interesting problem solutions, storage I ′ A, I ′ B, I ′ C, respectively. Observe that SQ is a diameter of Ω, so ∠SQ ′A′ = ∠SQ ′B′ = ∠SQ ′C ′ = 90 ◦, whence Q ′ is the foot from S to A′B′C ′ (the spheres with diameters SA ′, SB′, SC ′ intersect at S and its reﬂection over the plane formed by their centers). But JA is the foot from S to B′C ′, so Q ′P is minimized over P ∈ B′C ′ at P = JA (by the Pythagorean theorem) and JA is the foot from Q ′ to B′C ′. On the other hand, SJA = SJB = SJC = α 2 2SIA implies Q ′JA = Q ′JB = Q ′JC, whence △A′B′C ′ has incircle (JAJBJC) and inradius t = Q ′JA = √( α2 2SIA )2 − ( α2 2SO )2 = α2 2 √ 1 a2 − 1 u2 = α2 2 r as . (2) (Indeed, according to (*), Q ′ cannot be an excenter of △A′B′C ′, since Q ′ lies on the same side of planes SB′C ′ = SBC, SC ′A′ = SCA, SA′B′ = SAB as A′, B′, C ′, respectively.) It remains to analyze F ′. ∠SA ′F ′ = ∠SB′F ′ = ∠SC ′F ′ = 90 ◦, so A′, B′, C ′ lie on the sphere Γ with diameter SF ′. Let K be the midpoint of SF ′ and L be the foot from K to A′B′C ′; then K is the center of Γ and L is the circumcenter of △A′B′C ′. If x = SK denotes the radius of Γ, then 2x = SF ′ = α2/SF = α2/h. Fortunately, Q ′, the foot of S, lies in the interior of △A′B′C ′, so K cannot be higher than S (relative to plane A′B′C ′); hence T lies on ray −−→ SQ ′. Since the (acute) angle θ between lines SF ′ = SF and SQ ′ = SQ is ﬁxed under inversion, we get Q ′L x = T K SK = sin θ = √ SI 2 − (h − r)2 SI = √s2 − (h − r)2 s and KL = T Q ′ = |SQ ′ − ST | = \f \f \f \f α2 2u − SK cos θ\f \f \f \f = \f \f \f \f xh u − x h − r SI \f \f \f \f = x \f \f \f \f h u − h − r s \f \f \f \f . Plugging the previous two equations and (2) into Euler’s formula (for △A′B′C ′) yields x2 − x2 (h − r)2 s2 = x2 s 2 − (h − r) 2 s2 = Q ′L 2 = R2 A′B′C′ − 2tRA′B′C′ = (x2 − KL 2) − α2 r as √ x2 − KL2 = x2 − x2 ( h u − h − r s )2 − 2xh r as x √ 1 − ( h u − h − r s )2. Adding −x2 to both sides, substituting as = uv, and multiplying both sides by −x−2u2s 2, we get u 2(h − r) 2 = (sh − u(h − r))2 + 2hrs v √ u2s2 − (sh − u(h − r))2 −s 2h 2 + 2shu(h − r) = 2hrs v √ u2s2 − (sh − u(h − r))2 v(−sh + 2u(h − r)) = 2r√ u2s2 − (sh − u(h − r))2 (s 2 − r2)[h 2(2u − s) 2 − 4h(2u − s)ur + 4u 2r2] = 4r2[−h 2(s − u) 2 − 2h(s − u)ur − u 2(r2 − s 2)] v2[h(2u − s) 2 − 4(2u − s)ur] = 4r2[−h(s − u)2 − 2(s − u)ur], whence h = 4ur v2(2u − s) − 2r2(s − u) v2(2u − s)2 + 4r2(s − u)2 = 4 225 2 35 1202(225 − 125) − (35) 2(2 · 125 − 225) 1202(225 − 125)2 + (35)2(2 · 125 − 225)2 = 70 · 15 2 1202 · 10 2 − 352 · 52 1202 · 104 + 352 · 54 = 70 · 3 2 242 · 2 2 − 72 242 · 24 + 72 = 284130 1853 . 46 Victor Wang Interesting problem solutions, storage We can ﬁnd ϵ now (actually, h > u, so we trivially have ϵ = +1), but this is unnecessary: plugging h into (1) yields R2 = u 2 − (h − a v (h − r))2 = 2252 22 − ( 284130 1853 (1 − 108 120 ) + 108 · 35 120 )2 = 9 2 · 25 2 22 − ( 28413 1853 + 9 · 7 2 )2 = 9 2 · 25 2 22 − ( 28413 1853 + 9 · 7 2 )2 = (9 2 − 28413 1853 ) ( 9 · 16 + 28413 1853 ) = 121680 · 295245 18532 = 35925411600 3433609 . Thus the answer is 35925411600 + 3433609 = 35928845209. (Sketch of Existence.) For existence, we work with the S-inverted form. If we start with a triangle A′B′C ′ satisfying RA′B′C′ = 234 78925 α2 ( √x2 − KL2, where x, KL are as deﬁned above; x = 1853 568260 α2 = α 2 2h and KL = 551 405900 α2) and rA′B′C′ = 7 5400 α2 (t = (α2/2)(r/as)), and then take S so that the S- altitude of SA ′B′C ′ (SQ ′ in the above notation) passes through the incenter of △A′B′C ′ and has length 1 225 α2 (α2/2u), then it is not diﬃcult to show that SI = 125, rSABC = 35, and RSAB = RSBC = RSCA = 108 (this is mostly just running the solution’s arguments in reverse). It’s nicer to do everything in terms of r = 35, a = 108, s = 125, but since this is just a sketch it’s easier to include the worked out values. 107. (Russia 1999) If x, y > 0 satisfy x2 + y3 ≥ x3 + y4, show that x3 + y3 ≤ 2. Solution. By AM-GM, x2 − x3 ≥ y3 − y4 ≥ y3 − y2 (alternate motivation: want to get x3 + y3 on lesser side). The rest follows by homogenization. In fact, the stronger result x5 + y5 ≤ 2 also follows. 108. (Aaron Pixton, MOP 2012) good sets 3n, 3n + 1 Solution. Interpret as a pair of matchings on K2n for the 3n one, one with As on the left and Bs on the right and the other with Bs on the left and Cs on the right: As correspond to smallest elements of sets, Bs middle, Cs largest. This gets ((2n − 1)!!) 2 for the ﬁrst one. for the second one it’s the same thing, but we have an additional “space” denoted by X. in both cases we can interpret the X as an unmatched B, so we have n As and n+1 Bs. we want the Xs to have the same index among Bs in the two matchings. note however the orientation of the two matchings is B, so if we ﬁx an orientation (say the BC one) and let ui be the number of ways to get X in the ith position among Bs, then uk = 2n+2−2kn!(2k−2 k−1 ). the answer is thus ∑n+1 i=1 uiun+2−i = 2(n+2)−2(n+2)n! 24n = ((2n)!!) 2, where we use the classical (2k k ) convolution thing. note that we can interpret this as number of good sets of 3n + 3 where one of the sets has smallest element 1 and largest element 3n + 3 109. (MOP 2004/2005?) Let n be an integer greater than 1. Let a1, a2, . . . , an, b1, b2, . . . , bn be nonnegative real numbers with a1a2 · · · an = b1b2 · · · bn, b1 + b2 + · · · + bn = 1, and ∑ 1≤i<j≤n |ai − aj| ≤ ∑ 1≤i<j≤n |bi − bj|. Determine the maximum value of a1 + a2 + · · · + an. Solution. Small cases are very helpful for realizing what kinds of bounding to do. n = 2 is not particularly helpful, but n = 3 is already very messy without the “right” idea (to use AM-GM to get 47 Victor Wang Interesting problem solutions, storage rid of the weird product condition when the ai are all positive). n = 4 checks our intuition for n = 3 after that. Equality is for (0, 1, . . . , 1) and (0, . . . , 0, 1) for a, b, respectively (we get n − 1). Order a1 ≤ · · · ≤ an and b1 ≤ · · · ≤ bn. If x1 + · · · + xm = 1 for nonnegative xi, we can prove ∑ |xi − xj| ≤ m − 1, e.g. by looking at |xj+1 − xj| + · · · + |xm − xj| (which has an obvious upper bound of 1 − (x1 + · · · + xj), even though we can do better). Actually, m − 1 − ∑ |xi − xj| = ∑m−1 i=1 2(m − i)xi, although we can get away without the factor of 2. This works directly when a1 = 0, and if a1, b1 > 0, we just use na1 ≥ ∑n i=1 ai − ∑ |ai − aj| (motivation: n = 3 and n = 4 cases. The factor of 1 is mostly so we can get rid of the n − 1 on the RHS of a1 + · · · + an > n − 1, but this really mostly based on aesthetics and small cases as well). Then just an > (n − 1)/n to get a contradiction (if we assume a1 + · · · + an > n − 1). Use b1b2 · · · bn−1 = (a1a2 · · · an)/bn ≥ a1a2 · · · an−1(n − 1)/n to ﬁnish. 110. (ISL 2010 C7) Let P1, . . . , Ps be s arithmetic progressions of integers such that (a) each integer belongs to at least one progression; (b) each progression contains a number which does not belong to any other progression. Denote by n the least common multiple of the diﬀerences of these progressions; let n = p α1 1 · · · p αk k be its prime factorization. Prove that s ≥ 1 + k∑ i=1 αi(pi − 1). Solution. For the sake of completeness, here’s a (IMO) somewhat simpliﬁed version of Simpson’s proof, with a little motivation. I meant to post a while ago but got caught up in some things (also this is really annoying to write up...). Deﬁne f (n) = ∑k i=1 αi(pi − 1) (f (1) = 0 for convenience), S = {Pi}, and suppose Pi = ai (mod di) for i = 1, 2, . . . , s. For a set of indices A, let L(A) = lcmi∈A(di), so we want to show |S| ≥ 1 + f (L(S)). Note that f (mn) = f (m) + f (n) for positive integers m, n. For i = 0, 1, . . . , p1 − 1, let Si be the set of indices of a minimal cover of the residues i (mod p1). Clearly S = ⋃p1−1 i=0 Si and by (ii), each Si contains j with p1 | dj (which of course requires aj ≡ i (mod p1)). Similarly, Si, Sj can only intersect at indices l with p1 ∤ l. Furthermore, for ﬁxed j, there must exist i such that p αj j | L(Si). When k = 1, it’s obvious how to proceed: WLOG L(S0) = p α1 1 ; then noting that Pj ∩ 0 (mod p1) is an AP with step divisible by p1, we get |S| ≥ |S0| + |S1 \\ S0| + · · · + |Sp1−1 \\ S0, . . . , Sp1−2| ≥ 1 + f (L(S0)/p1) + p − 1 = 1 + f (L(S)) by the inductive hypothesis (base case is trivial), as desired. For k > 1, we’ll need something a bit stronger, but it’s natural to conjecture something like |Si \\Ti−1| ≥ 1 + f ( L(Ti) L(Ti−1) ) for i ≥ 1, where Ti = ⋃i j=0 Sj (which clearly suﬃces). Thus we try to prove the following: If S is a minimal covering set of the integers with n = L(S), then for any m | n with m < n, S has at least 1 + f (n/m) progressions Pj = aj (mod dj) with dj ∤ m. Equality holds, for instance, when S consists of 0 (mod n) and for each i, jpℓ−1 i (mod pℓ i ) for j = 1, 2, . . . , pi − 1, ℓ = 1, 2, . . . , k. To set an inductive proof (on n) up, let M = {j : dj | m}. WLOG p1 | n/m (since m < n) and p α1 1 | L(S0). Fix i; for Pj ∈ Si, deﬁne P (i) j = a (i) j (mod d (i) j ) so that Pj ∩ i (mod p1) = p1P (i) j . Note that d (i) j = dj gcd(p1,dj ) and S(i) i (slight abuse of notation here) must be a minimal cover of the integers (since Si is a minimal cover of i (mod p1)). Observe that L(S(i) i ) = L(Si)/p1 and for any positive integer t, d(i) j ∤ t (t,p1) =⇒ dj ∤ t. (*) First we consider S0 \\ M . If L(S0)/p1 = (m, L(S0))/(m, L(S0), p1), this is obvious from pα1 1 | L(S0). Otherwise, dj | m iﬀ dj | (m, L(S0)), so by (*), |S0 \\ M | is at least the number of j ∈ S0 such that 48 Victor Wang Interesting problem solutions, storage d (0) j ∤ (m, L(S0))/(m, L(S0), p1), which is at least 1 + f ( |S(0) 0 | (m, L(S0))/(m, L(S0), p1) ) = 1 + f ( L(S0)/p1 (m, L(S0))/(m, L(S0), p1) ) = 1 + f ( (m, L(S0), p1) p1 lcm(m, L(S0)) m ) by the inductive hypothesis, since (m, L(S0)) | L(S0) forces (m, L(S0))/(m, L(S0), p1) | L(S0)/p1. For i ≥ 1, Si \\ M, Ti−1 contains all j ∈ Si such that dj ∤ m and dj ∤ L(Ti−1), and thus all j with dj ∤ lcm(m, L(Ti−1)) (although this is a weaker condition), or equivalently, dj ∤ (L(Si), lcm(m, L(Ti−1))). Using (*) as in the previous paragraph, |Si \\ M, Ti−1| is at least the number of j ∈ Si such that d (i) j ∤ (L(Si), lcm(m, L(Ti−1)))/p1 = L(Si) lcm(m, L(Ti−1))/p1 lcm(m, L(Ti)) (note p1 | T0 | L(Ti−1) and of course p1 | L(Si)). If L(Si)/p1 > (L(Si), lcm(m, L(Ti−1)))/p1, we get a lower bound of 1 + f ( L(Si)/p1 L(Si) lcm(m, L(Ti−1))/p1 lcm(m, L(Ti)) ) = 1 + f ( lcm(m, L(Ti)) lcm(m, L(Ti−1)) ) . Otherwise, if lcm(m, L(Ti)) = lcm(m, L(Ti−1)), we get a lower bound of ≥ 1 = 1 + f ( lcm(m,L(Ti)) lcm(m,L(Ti−1)) ) when p1 ∤ m (as Si has at least one j with p1 | dj, which clearly must be unique to Si) and obviously ≥ 0 = f ( lcm(m,L(Ti)) lcm(m,L(Ti−1)) ) when p1 | m. Case 1. p1 ∤ m. Then S \\ M has at least p1 + f ( (m,L(S0),p1) p1 lcm(m,L(Tp1−1)) m ) = 1 + f ( n m ) elements, as desired. Case 2. p1 | m. Then S \\ M has at least 1 + f ( (m,L(S0),p1) p1 lcm(m,L(Tp1−1)) m ) = 1 + f ( n m ) elements, so we’re done in this case too. 111. Suppose n coins have been placed in piles on the integers on the real line. (A pile may contain zero coins.) Let T denote the following sequence of operations. (a) Move piles 0, 1, 2, . . . to 1, 2, 3 . . ., respectively. (b) Remove one coin from each nonempty pile from among piles 1, 2, 3, . . ., then place the removed coins in pile 0. (c) Swap piles i and −i for i = 1, 2, 3, . . .. Prove that successive applications of T from any starting position eventually lead to some sequence of positions being repeated, and describe all possible positions that can occur in such a sequence. Solution. First, since we expect coins to gravitate towards the origin, we note that ∑ |x| + |y| over all coins decreases by ∑ ai − (i − 1) 112. (related to Putnam 2000 B6) Let n be a positive integer and m ∈ {1, 2, . . . , 2 n}. Prove that there exists a 2 n-coloring f : {0, 1} 2 n → {1, 2, . . . , 2n} such that for any v ∈ {0, 1} 2n, there exists u ∈ {0, 1}2 n with d(u, v) = 1 (exactly one bit diﬀerent) such that f (u) = m. tenuously related problem (trivial): Find g : {0, 1}n → {0, 1}n such that for any v ∈ {0, 1} n, exists u ∈ {0, 1}n with d(u, v) = 1 and g(u) = v. Solution. Let e1, . . . , e2n be the unit vectors in coordinates 1, 2, . . . , 2 n. Then we want f such that f (v + e1 (mod 2)), . . . , f (v + e2n (mod 2)) (input vector addition modulo 2) is a permutation of the colors 1, 2, . . . , 2 n. For simplicity, we take f (a1e1 + · · · + a2n e2n ) of the form f1(a1) + · · · + f2n (a2n ) (in some group G—probably abelian—of size 2 n). In view of the natural modulo 2 deﬁnition of d(u, v) = 1 in coordinate i (u ≡ v + ei (mod 2))—we would like the result of changing 0 → 1 to be the same as that of 1 → 0—we take G = (Z/2Z) n, with fi(0) = ⃗0 and fi(1) equal to the vector corresponding to i’s binary representation. Now we can ﬁnish by arbitrarily ordering the elements of G from 1 to 2 n. 49 Victor Wang Interesting problem solutions, storage Solution. For the tenuously related problem, we need a vertex-partition of the unit graph into cycles (allowing 2-cycles). But then we can just set f (v) = v + e1 (mod 2). We can also overkill using Hall’s marriage lemma, since our graph is clearly a n-regular bipartite graph (based on parity of coordinate sum). So we can partition into n matchings, any two of which induce the desired cycle structure. (Note that if we use the same two matchings, we just get a bunch of 2-cycles). 50","libVersion":"0.3.1","langs":""}
{"path":"iCloudDrive/bks/Combinatorics/Combinatorics/2011 ARML Advanced Combinatorics - Boundary Conditions.pdf","text":"ARML 2011 – Advanced Combinatorics: Boundary Conditions 3/03/11 Andre Kessler Once you understand and can apply basic concepts of combinatorics, most of the contest problems you need to solve deal with boundary conditions on counting some set of objects. The main prob- lem then becomes being able to systematically deal with the cases present. Two common types of boundary representations supplied are conditions on the digit representation of some numbers, or inequalities relating variables in a Diophantine equation. These conditions are usually quite easy to solve if one begins with the proper approach, although the “proper approach” may not be obvious on ﬁrst sight. For example, suppose we want to seat m boys and n girls at a round table with m + n chairs in such a way that no two boys sit next to each other. In how many ways can this be done? First, once we’ve selected the places for the boys, they can sit in those chairs in m! ways, and likewise for the girls (n!). We can reduce the problem to a “linear” problem via the aid of a simple trick: choose an arbitrary ﬁxed chair denoted X, and divide all choices of chairs into two disjoint groups depending on whether the person in seat X is a boy or girl. In the ﬁrst case - X is a boy - then both neighboring chairs must be girls, so there are exactly ( n − 1 m − 1 ) choices of chairs left for the boys. In the second case, there are ( n m ) people. Thus the number of all possible seatings is m!n! [( n − 1 m − 1 ) + ( n m )] = m!n! m + n n ( n m ). 1 Number Theoretic Applications 1. Find the number of integer solutions to the inequality |x| + |y| ≤ 1000. Solution: Since |x| + |y| ≤ 1000, we certainly have |x| ≤ 1000. If |x| = k is ﬁxed, then the inequality |y| ≤ 1000 − |x| = 1000 − k has exactly the 2 · (1000 − k) + 1 solutions y = −1000 + k, −999 + k, . . . , −1, 0, 1, . . . , 999 − k, 1000 − k. Since |x| = k holds just when x = ±k, the total number of solutions to the given inequality is (2(1000 − 0) + 1) + 2 1000∑ k=1 (2(1000 − k) + 1) = 2001 + 2000 + 4 1000∑ k=1 (1000 − k) = 2002001. 2. Find the number of all non-negative solutions to the equation x + y = n under the condition that x ≤ y. Solution: Let r denote the desired number of solutions. Our boundary condition is x ≤ y. The equation x + y = n without the boundary condition has 2r solutions if n is odd, or 2r − 1 solutions if n is even. In both cases, this number is clearly equal to n + 1. Thus, for odd values of n, we have r = (n + 1)/2; for even values of n, we have r = n/2 + 1. In either case, we have r = ⌊ n 2 ⌋ + 1. 1 Note: We could have solved this more simply by noting that x ≤ y if and only if x ≤ n 2 . There are ⌊ n 2 ⌋ + 1 such x and each x uniquely determines a solution. While this argument is shorter, and good for this particular problem, there are many cases where the ﬁrst solution can be generalized (not so for the second, shorter solution). The next problem is a good example of this phenomenon. 3. Find the number of all non-negative solutions to the equation x+y+z = n under the condition that x ≤ y ≤ z. Solution: Let’s denote by r1, r2, r3, and r4 the number of all solutions of the given equation under the condition that, respectively, x < y < z, x = y < z, x < y = z, and x = y = z. These are our boundary conditions. Clearly, the total number of solutions without any boundary conditions is expressed by (n + 2 2 ) via a standard balls-and-urns argument. Thus, we can write (n + 2 2 ) = 6r1 + 3r2 + 3r3 + r4 where the coeﬃcients of the ri come from the ways we can order x, y, z. The desired number of non-negative integer solutions is given by r1 + r2 + r3 + r4. From this we will try to determine r1 after ﬁnding r4 and r2 + r3. Clearly, if 3|n, then there is exactly one solution r4 = 1 for the case where x = y = z; otherwise r4 = 0. In any case, we may express r4 = ⌊ n 3 ⌋ − ⌊ n − 1 3 ⌋. Next, to determine r2 + r3 + r4, we note that this number is equal to the number of non- negative integer solutions to the equation 2u + v = n. Substituting s = u, t = u + v, this reduces to s + t = n with the condition s ≤ t. By the previous example, the number of solutions to this is ⌊ n 2 ⌋ + 1, so we obtain r2 + r3 + r4 = ⌊ n 2 ⌋ + 1 which implies r2 + r3 = ⌊ n 2 ⌋ − ⌊ n 3 ⌋ + ⌊ n − 1 3 ⌋ + 1 This allows us to solve for the desired sum r1 + r2 + r3 + r4 as follows. r1 + r2 + r3 + r4 = 1 6 ((n + 2 2 ) − 3r2 − 3r3 − r4 ) + r2 + r3 + r4 = 1 6 ((n + 2 2 ) + 3(r2 + r3) + 5r4 ) = (n + 1)(n + 2) 12 + 1 2 + 1 2 ⌊ n 2 ⌋ + 1 3 ⌊ n 3 ⌋ − 1 3 ⌊ n − 1 3 ⌋ 4. Find the number of ways in which a given integer n > 1 can be written as a product n = x·y·z, where x, y, z are positive integers and x|y as well as y|z. Solution: Let the prime factorization of n be n = pe1 1 pe2 2 · · · pek k . We’ll also write x, y, z in their prime factorizations as x = pα1 1 pα2 2 · · · pαk k , y = pβ1 1 pβ2 2 · · · pβk k , and z = pγ1 1 pγ2 2 · · · pγk k , where αi, βi, γi ∈ N0. For the conditions of the problem to hold, we must have ei = αi + βi + γi and 2 αi ≤ βi ≤ γi. This is exactly the previous problem with the results muliplied over all primes in the factorization of n. Hence, the number R of desired representations of n is given by R = k∏ i=1 ( (ei + 1)(ei + 2) 12 + 1 2 + 1 2 ⌊ ei 2 ⌋ + 1 3 ⌊ ei 3 ⌋ − 1 3 ⌊ ei − 1 3 ⌋) Note: This problem appeared on this year’s Combinatorics Performance Test with the number n = 33 3 · 106, although in that case n is small enough that the solutions to αi + βi + γi = · · · could be enumerated by hand. You should try to get a sense of when ﬁnding a general formula like in the solution to this problem is better strategically than simply brute-forcing the problem. Sometimes, it’s clear; othertimes, it’s a matter of judgement. 2 Lining Up at the Movie Theater Suppose there is a line of m + k mathletes waiting outside of a movie theater to purchase tickets, where m people have a ten-dollar bill and k people have a ﬁve-dollar bill. Each ticket costs $5 and at the beginning of the tickey sales there is no money in the cash register. In how many ways can the mathletes line up at the box oﬃce so that they can buy tickets without delays; that is, no one has to wait until the cashier has enough change? To solve this problem, we’re going to encode each line with a sequence of ﬁves and ones in such a way that each person carrying a ﬁve-dollar bill is associated with a ﬁve and every person carrying a ten-dollar bill is associated with a one. This makes the problem “ﬁnd the number f (m, k) of m + k-term sequences consisting of m ones and k ﬁves with the property that for each i = 1, 2, . . . , m + k among the ﬁrst i terms of the sequence the number of ﬁves is greater than or equal to the number of ones.” Clearly, this problem has a solution if and only if m ≤ k, as otherwise the cashier will deﬁnitely run out of change at some point. Thus, f (m, k) = 0 for all m > k. For m ≤ k, we will count the complement of the legal conﬁgurations of the line - all “bad” compositions. Each one of these sequences consists of a set of m ones and k ﬁves such that for some i, among the ﬁrst i terms of the sequence the number of ones is greater than the number of ﬁves. The se of these bad sequences will be denoted by X. Since the number of all sequences - legal or illegal - is clearly (m + k m ), we have f (m, k) = (m + k m ) − |X|. Our next step is to construct a bijection between the elements of X and all sequences of m − 1 ones and k + 1 ﬁves. Let’s take an arbitrary bad sequence a = (a1, a2, a3, . . . , am+k). Clearly there exists some least index d such that there are more ones than ﬁves in the set {a1, a2, . . . , ad}; also, ad = 1 and among the elements {a1, a2, . . . , ad−1} there are an equal number of ones and ﬁves. This means that the sequence b = (6 − a1, 6 − a2, . . . , 6 − ad−1, 5, ad+1, . . . , am+k) consists of m − 1 ones and k + 1 ﬁves. Additionally, any sequence b constructed in this way allows the index d to be recovered - it’s the smallest index i such that among the elements {b1, b2, . . . , bi} there are more ﬁves than ones. Simply because m ≤ k, we are guaranteed that such a d exists for every sequence b meaning we can transform back to the sequence a ∈ X: a = (6 − b1, 6 − b2, . . . , 6 − bd−1, 1, bd+1, . . . , bm+k) 3 Since the set of sequences consisting of m − 1 ones and k + 1 ﬁves has (m + k m − 1 ) elements, we have that f (m, k) = (m + k m ) − (m + k m − 1 ) = k − m + 1 k + 1 (m + k m ). 3 Problems 1. In how many ways can one select three integers from the set {1, 2, 3, . . . , 30} such that their sum is divisible by 3? 2. Find the number of integer solutions to |x| + |y| + |z| ≤ n. 3. Find the number of integer solutions to |x1| + |x2| + · · · + |xk| ≤ n. 4. Find the number of ways in which the integer 1728 can be decomposed into a product of three positive integer factors x, y, z if (a) Decompositions that diﬀer in the order of factors are counted as distinct. (b) The order of factors x, y, z is irrelevant. 5. Find the number of 4-digit positive integers with digit sum 5. 6. Find the number of all even 4-digit positive integers composed of exactly two distinct digits. 7. Find the number of all 6-digit positive integers composed of exactly three distinct digits. 8. Find the number of positive integer solutions to the equation n = x 3y2z. 9. In how many ways can 2k people of diﬀerent heights be placed into a double row such that they are ordered according to height in each row, and such that each person in the ﬁrst row is taller than the one in the second row standing immediately behind this person? 10. Suppose the box oﬃce attendant in the Movie Theater problem came prepared with q ﬁve- dollar bills for change. How does the formula change then? 11. A set S containing four positive integers is called connected if for every x ∈ S at least one of the numbers x − 1 and x + 1 belongs to S. Determine the number of connected subsets of the set {1, 2, 3, . . . , 100}. 12. Find the number of all n-term nondecreasing sequences {ai}n i=1 of positive integers such that for 1 ≤ i ≤ n we have ai ≤ i. 4","libVersion":"0.3.1","langs":""}